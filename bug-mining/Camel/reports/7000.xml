<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:09:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-21442] camel-jbang export is not working when local-kamelet-dir set to current dir</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-21442</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;it is a regression introduced in Camel 4.8.1, it is working fine with Camel 4.8.0&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;jbang &apos;-Dcamel.jbang.version=4.8.1&apos; camel@apache/camel init &apos;test.camel.yaml&apos;&lt;/li&gt;
	&lt;li&gt;jbang &apos;-Dcamel.jbang.version=4.8.1&apos; camel@apache/camel run test.camel.yaml --dev --logging-level=info --local-kamelet-dir=.&lt;/li&gt;
	&lt;li&gt;jbang &apos;-Dcamel.jbang.version=4.8.1&apos; camel@apache/camel export --runtime=quarkus --gav=com.acme:myproject:1.0-SNAPSHOT&lt;/li&gt;
&lt;/ul&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Reusing existing run data
Exporting as Quarkus project to: .
java.nio.file.NoSuchFileException: .camel-jbang/work/src/main/resources/kamelets/test.camel.yaml
        at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
        at java.base/sun.nio.fs.UnixFileSystem.copyFile(UnixFileSystem.java:668)
        at java.base/sun.nio.fs.UnixFileSystem.copy(UnixFileSystem.java:1060)
        at java.base/sun.nio.fs.UnixFileSystemProvider.copy(UnixFileSystemProvider.java:300)
        at java.base/java.nio.file.Files.copy(Files.java:1304)
        at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.safeCopy(ExportBaseCommand.java:911)
        at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.safeCopy(ExportBaseCommand.java:888)
        at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.copySourceFiles(ExportBaseCommand.java:581)
        at org.apache.camel.dsl.jbang.core.commands.ExportQuarkus.export(ExportQuarkus.java:105)
        at org.apache.camel.dsl.jbang.core.commands.Export.export(Export.java:150)
        at org.apache.camel.dsl.jbang.core.commands.Export.export(Export.java:63)
        at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.doCall(ExportBaseCommand.java:248)
        at org.apache.camel.dsl.jbang.core.commands.CamelCommand.call(CamelCommand.java:71)
        at org.apache.camel.dsl.jbang.core.commands.CamelCommand.call(CamelCommand.java:37)
        at picocli.CommandLine.executeUserObject(CommandLine.java:2045)
        at picocli.CommandLine.access$1500(CommandLine.java:148)
        at picocli.CommandLine$RunLast.executeUserObjectOfLastSubcommandWithSameParent(CommandLine.java:2465)
        at picocli.CommandLine$RunLast.handle(CommandLine.java:2457)
        at picocli.CommandLine$RunLast.handle(CommandLine.java:2419)
        at picocli.CommandLine$AbstractParseResultHandler.execute(CommandLine.java:2277)
        at picocli.CommandLine$RunLast.execute(CommandLine.java:2421)
        at picocli.CommandLine.execute(CommandLine.java:2174)
        at org.apache.camel.dsl.jbang.core.commands.CamelJBangMain.run(CamelJBangMain.java:173)
        at org.apache.camel.dsl.jbang.core.commands.CamelJBangMain.run(CamelJBangMain.java:62)
        at main.CamelJBang.main(CamelJBang.java:36)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Using jbang &apos;-Dcamel.jbang.version=4.8.0&apos; camel@apache/camel export --runtime=quarkus --gav=com.acme:myproject:1.0-SNAPSHOT is exporting successfully and then calling mvn quarkus:dev is working fine&lt;/p&gt;


&lt;p&gt;Potential workarounds:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;delete .camel-jbang folder&lt;/li&gt;
	&lt;li&gt;or remove property`camel.jbang.localKameletDir` in the .camel-jbang/camel-jbang-run.properties&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13598486">CAMEL-21442</key>
            <summary>camel-jbang export is not working when local-kamelet-dir set to current dir</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tdiesler">Thomas Diesler</assignee>
                                    <reporter username="apupier">Aur&#233;lien Pupier</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Nov 2024 13:31:19 +0000</created>
                <updated>Sat, 25 Jan 2025 07:31:18 +0000</updated>
                            <resolved>Sat, 25 Jan 2025 07:31:18 +0000</resolved>
                                    <version>4.8.1</version>
                    <version>4.8.2</version>
                    <version>4.9.0</version>
                                    <fixVersion>4.8.4</fixVersion>
                    <fixVersion>4.10.0</fixVersion>
                                    <component>camel-jbang</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17898141" author="davsclaus" created="Thu, 14 Nov 2024 06:31:07 +0000"  >&lt;p&gt;This command looks a bit wrong - as you have both * and *.xsl as the args to select the files to run. Also local-kamelet-dir is not intended to be current dir, but some shared dir.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
jbang &lt;span class=&quot;code-quote&quot;&gt;&apos;-Dcamel.jbang.version=4.8.1&apos;&lt;/span&gt; camel@apache/camel run * --dev --logging-level=info --local-kamelet-dir=. *.xsl &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17898142" author="davsclaus" created="Thu, 14 Nov 2024 06:31:38 +0000"  >&lt;p&gt;Can you attach the files you use for this, it would be much easier to reproduce instead of we have to make up a project on our own which does not match what you attempt to do&lt;/p&gt;</comment>
                            <comment id="17898163" author="apupier" created="Thu, 14 Nov 2024 07:49:51 +0000"  >&lt;p&gt;About kamelet-dir, hitting same kind of problem that the project structure needs to be reinvented. Usually users are creating kamelet at the same level than Camel routes. Also the Camel Jbang init is not giving any guidance and by default creating at the same level. So providing --kamelet-dir to current dir is the way to have it working by default.&lt;/p&gt;

&lt;p&gt;using `jbang &apos;-Dcamel.jbang.version=4.8.1&apos; camel@apache/camel run test-with-xsl.camel.yaml --dev --logging-level=info --local-kamelet-dir=. *.xsl` is giving the same result. The *.xsl is used to select additional files to add the classpath, not to select files to run.&lt;/p&gt;

&lt;p&gt;Added the project after the 3 steps  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13072821/13072821_example-test-with-xsl-before-export.zip&quot; title=&quot;example-test-with-xsl-before-export.zip attached to CAMEL-21442&quot;&gt;example-test-with-xsl-before-export.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; :&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;jbang &apos;-Dcamel.jbang.version=4.8.1&apos; camel@apache/camel init &apos;test-with-xsl.camel.yaml&apos;&lt;/li&gt;
	&lt;li&gt;create an empty dummy.xsl file&lt;/li&gt;
	&lt;li&gt;jbang &apos;-Dcamel.jbang.version=4.8.1&apos; camel@apache/camel run test-with-xsl.camel.yaml --dev --logging-level=info --local-kamelet-dir=. *.xsl&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17898200" author="apupier" created="Thu, 14 Nov 2024 09:10:22 +0000"  >&lt;p&gt;when using a name for the Camel route file without &apos;xsl&apos; in it, the error stacktrace is slightly different (or a coincidence and just picking one or the other?):&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.nio.file.NoSuchFileException: .camel-jbang/work/src/main/resources/kamelets/my.xsl
        at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
        at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
        at java.base/sun.nio.fs.UnixFileSystem.copyFile(UnixFileSystem.java:668)
        at java.base/sun.nio.fs.UnixFileSystem.copy(UnixFileSystem.java:1060)
        at java.base/sun.nio.fs.UnixFileSystemProvider.copy(UnixFileSystemProvider.java:300)
        at java.base/java.nio.file.Files.copy(Files.java:1304)
        at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.safeCopy(ExportBaseCommand.java:911)
        at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.safeCopy(ExportBaseCommand.java:888)
        at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.copySourceFiles(ExportBaseCommand.java:581)
        at org.apache.camel.dsl.jbang.core.commands.ExportQuarkus.export(ExportQuarkus.java:105)
        at org.apache.camel.dsl.jbang.core.commands.Export.export(Export.java:150)
        at org.apache.camel.dsl.jbang.core.commands.Export.export(Export.java:63)
        at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.doCall(ExportBaseCommand.java:248)
        at org.apache.camel.dsl.jbang.core.commands.CamelCommand.call(CamelCommand.java:71)
        at org.apache.camel.dsl.jbang.core.commands.CamelCommand.call(CamelCommand.java:37)
        at picocli.CommandLine.executeUserObject(CommandLine.java:2045)
        at picocli.CommandLine.access$1500(CommandLine.java:148)
        at picocli.CommandLine$RunLast.executeUserObjectOfLastSubcommandWithSameParent(CommandLine.java:2465)
        at picocli.CommandLine$RunLast.handle(CommandLine.java:2457)
        at picocli.CommandLine$RunLast.handle(CommandLine.java:2419)
        at picocli.CommandLine$AbstractParseResultHandler.execute(CommandLine.java:2277)
        at picocli.CommandLine$RunLast.execute(CommandLine.java:2421)
        at picocli.CommandLine.execute(CommandLine.java:2174)
        at org.apache.camel.dsl.jbang.core.commands.CamelJBangMain.run(CamelJBangMain.java:173)
        at org.apache.camel.dsl.jbang.core.commands.CamelJBangMain.run(CamelJBangMain.java:62)
        at main.CamelJBang.main(CamelJBang.java:36)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17898201" author="apupier" created="Thu, 14 Nov 2024 09:12:52 +0000"  >&lt;p&gt;when commenting out the line `camel.jbang.localKameletDir=file\:.` in the .camel-jbang/camel-jbang-run.properties file, the export is working&lt;/p&gt;</comment>
                            <comment id="17898202" author="apupier" created="Thu, 14 Nov 2024 09:14:37 +0000"  >&lt;p&gt;now im reproducing without the xsl so I will simplify the steps and update the title. It is related only to the kamelet-dir parameter&lt;/p&gt;</comment>
                            <comment id="17898212" author="apupier" created="Thu, 14 Nov 2024 09:50:57 +0000"  >&lt;p&gt;note that `jbang &apos;-Dcamel.jbang.version=4.8.1&apos; camel@apache/camel export --runtime=quarkus --gav=com.acme:myproject:1.0-SNAPSHOT --local-kamelet-dir=.` is working when there wasn&apos;t a run done, so when there is no .camel-jbang/camel-jbang-run.properties&lt;/p&gt;

&lt;p&gt;EDIT: in fact it seems that the parameter is ignored and it is workign by the side effect that the kamelet is at same level than the Camel route file&lt;/p&gt;</comment>
                            <comment id="17899702" author="apupier" created="Wed, 20 Nov 2024 09:31:41 +0000"  >&lt;p&gt;completely sidetracked by other priorities.&lt;br/&gt;
branch on which I started to write some tests &lt;a href=&quot;https://github.com/apupier/camel/pull/new/21442-FixRegressionExportWithLocalKameletDirSetToCurrentDir&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apupier/camel/pull/new/21442-FixRegressionExportWithLocalKameletDirSetToCurrentDir&lt;/a&gt; (but parameters doesn&apos;t seem to be passed correctly)&lt;/p&gt;</comment>
                            <comment id="17911435" author="JIRAUSER301007" created="Thu, 9 Jan 2025 11:17:06 +0000"  >&lt;p&gt;Would it be possible to increase the priority a bit on this? I think is a common pattern to test an integration locally first and then migrate it over into a project &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17911442" author="davsclaus" created="Thu, 9 Jan 2025 11:38:04 +0000"  >&lt;p&gt;Use --fresh when exporting&lt;/p&gt;</comment>
                            <comment id="17911884" author="davsclaus" created="Fri, 10 Jan 2025 09:47:08 +0000"  >&lt;p&gt;Did you try with --fresh during export&lt;/p&gt;</comment>
                            <comment id="17911991" author="apupier" created="Fri, 10 Jan 2025 14:00:41 +0000"  >&lt;p&gt;same errro with --fresh (tried with 4.8.1 and 4.9.0)&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;apupier@localhost:~/ws/test-jbang-export$ jbang &apos;-Dcamel.jbang.version=4.8.1&apos; camel@apache/camel export --runtime=quarkus --gav=com.acme:myproject:1.0-SNAPSHOT --fresh
Generating fresh run data
java.nio.file.NoSuchFileException: .camel-jbang/work/src/main/resources/kamelets/test.camel.yaml
	at java.base/sun.nio.fs.UnixException.translateToIOException(UnixException.java:92)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:106)
	at java.base/sun.nio.fs.UnixException.rethrowAsIOException(UnixException.java:111)
	at java.base/sun.nio.fs.UnixFileSystem.copyFile(UnixFileSystem.java:668)
	at java.base/sun.nio.fs.UnixFileSystem.copy(UnixFileSystem.java:1060)
	at java.base/sun.nio.fs.UnixFileSystemProvider.copy(UnixFileSystemProvider.java:300)
	at java.base/java.nio.file.Files.copy(Files.java:1304)
	at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.safeCopy(ExportBaseCommand.java:911)
	at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.safeCopy(ExportBaseCommand.java:888)
	at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.copySourceFiles(ExportBaseCommand.java:581)
	at org.apache.camel.dsl.jbang.core.commands.ExportQuarkus.export(ExportQuarkus.java:105)
	at org.apache.camel.dsl.jbang.core.commands.Run.runQuarkus(Run.java:912)
	at org.apache.camel.dsl.jbang.core.commands.Run.run(Run.java:414)
	at org.apache.camel.dsl.jbang.core.commands.Run.runExport(Run.java:330)
	at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.runSilently(ExportBaseCommand.java:318)
	at org.apache.camel.dsl.jbang.core.commands.ExportQuarkus.export(ExportQuarkus.java:72)
	at org.apache.camel.dsl.jbang.core.commands.Export.export(Export.java:150)
	at org.apache.camel.dsl.jbang.core.commands.Export.export(Export.java:63)
	at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.doCall(ExportBaseCommand.java:248)
	at org.apache.camel.dsl.jbang.core.commands.CamelCommand.call(CamelCommand.java:71)
	at org.apache.camel.dsl.jbang.core.commands.CamelCommand.call(CamelCommand.java:37)
	at picocli.CommandLine.executeUserObject(CommandLine.java:2045)
	at picocli.CommandLine.access$1500(CommandLine.java:148)
	at picocli.CommandLine$RunLast.executeUserObjectOfLastSubcommandWithSameParent(CommandLine.java:2465)
	at picocli.CommandLine$RunLast.handle(CommandLine.java:2457)
	at picocli.CommandLine$RunLast.handle(CommandLine.java:2419)
	at picocli.CommandLine$AbstractParseResultHandler.execute(CommandLine.java:2277)
	at picocli.CommandLine$RunLast.execute(CommandLine.java:2421)
	at picocli.CommandLine.execute(CommandLine.java:2174)
	at org.apache.camel.dsl.jbang.core.commands.CamelJBangMain.run(CamelJBangMain.java:173)
	at org.apache.camel.dsl.jbang.core.commands.CamelJBangMain.run(CamelJBangMain.java:62)
	at main.CamelJBang.main(CamelJBang.java:36)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17916613" author="davsclaus" created="Fri, 24 Jan 2025 06:51:31 +0000"  >&lt;p&gt;Thomas can you backport this to 4.8.x branch&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13072821" name="example-test-with-xsl-before-export.zip" size="1472" author="apupier" created="Thu, 14 Nov 2024 07:48:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1sicw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>