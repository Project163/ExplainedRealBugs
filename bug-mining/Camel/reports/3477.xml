<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:12:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-9270] rest-dsl - CORS support doesn&apos;t work with Restlet 2.3</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-9270</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;camel-restlet has upgraded to Restlet 2.3 (nice!), but this broke rest-dsl CORS support, because Restlet 2.3 no longer supports setting CORS headers via attributes. There are now API methods for these headers and attributes are ignored with a warning.&lt;/p&gt;

&lt;p&gt;Example of the new API method:&lt;br/&gt;
&lt;a href=&quot;http://restlet.com/technical-resources/restlet-framework/javadocs/2.3/jse/api/org/restlet/Response.html#setAccessControlAllowOrigin%28java.lang.String%29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://restlet.com/technical-resources/restlet-framework/javadocs/2.3/jse/api/org/restlet/Response.html#setAccessControlAllowOrigin%28java.lang.String%29&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12908832">CAMEL-9270</key>
            <summary>rest-dsl - CORS support doesn&apos;t work with Restlet 2.3</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="koscejev">Anton Koscejev</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Oct 2015 08:42:38 +0000</created>
                <updated>Mon, 30 Nov 2015 15:45:22 +0000</updated>
                            <resolved>Sun, 22 Nov 2015 14:50:10 +0000</resolved>
                                    <version>2.16.0</version>
                                    <fixVersion>2.16.2</fixVersion>
                    <fixVersion>2.17.0</fixVersion>
                                    <component>camel-restlet</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14980064" author="koscejev" created="Thu, 29 Oct 2015 08:53:20 +0000"  >&lt;p&gt;Warnings in log: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2015-10-29 09:44:16,762 WARN [Restlet-1916677384] o.r.C.LogFilter [Slf4jLogger.java:283] Addition of the standard header &lt;span class=&quot;code-quote&quot;&gt;&quot;Access-Control-Allow-Headers&quot;&lt;/span&gt; is not allowed. Please use the equivalent property in the Restlet API.
2015-10-29 09:44:16,762 WARN [Restlet-1916677384] o.r.C.LogFilter [Slf4jLogger.java:283] Addition of the standard header &lt;span class=&quot;code-quote&quot;&gt;&quot;Access-Control-Allow-Methods&quot;&lt;/span&gt; is not allowed. Please use the equivalent property in the Restlet API.
2015-10-29 09:44:16,762 WARN [Restlet-1916677384] o.r.C.LogFilter [Slf4jLogger.java:283] Addition of the standard header &lt;span class=&quot;code-quote&quot;&gt;&quot;Access-Control-Allow-Origin&quot;&lt;/span&gt; is not allowed. Please use the equivalent property in the Restlet API.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Workaround using custom RestletBinding:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; com.google.common.base.Splitter;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.restlet.data.Header;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.restlet.data.Method;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.restlet.util.Series;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; com.google.common.collect.Sets.newHashSet;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; org.restlet.engine.header.HeaderConstants.ATTRIBUTE_HEADERS;
...
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CustomRestletBinding &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; DefaultRestletBinding {
	&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Splitter headerValueSplitter = Splitter.on(&lt;span class=&quot;code-quote&quot;&gt;&apos;,&apos;&lt;/span&gt;).trimResults().omitEmptyStrings();

	@Override
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void populateRestletResponseFromExchange(Exchange exchange, Response response) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
		&lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.populateRestletResponseFromExchange(exchange, response);
		convertHeadersSupportedByRestletAPI(response);
	}

	/**
	 * Some headers are now supported by Restlet API and Restlet ignores them, &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; not set via API.
	 * This method sets them to Restlet Response via API and then removes these headers.
	 */
	&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void convertHeadersSupportedByRestletAPI(Response response) {
		Iterator&amp;lt;Header&amp;gt; iterator = response.getHeaders().iterator();
		&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (iterator.hasNext()) {
			Header header = iterator.next();
			&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;Access-Control-Allow-Origin&quot;&lt;/span&gt;.equals(header.getName())) {
				response.setAccessControlAllowOrigin(header.getValue());
			} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;Access-Control-Allow-Methods&quot;&lt;/span&gt;.equals(header.getName())) {
				response.setAccessControlAllowMethods(asMethods(header.getValue()));
			} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-quote&quot;&gt;&quot;Access-Control-Allow-Headers&quot;&lt;/span&gt;.equals(header.getName())) {
				response.setAccessControlAllowHeaders(asHeaders(header.getValue()));
			} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
				&lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;; &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not remove all other headers
&lt;/span&gt;			}
			iterator.remove();
		}
	}

	@NotNull
	&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Set&amp;lt;Method&amp;gt; asMethods(@NotNull &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value) {
		&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; StreamSupport.stream(headerValueSplitter.split(value).spliterator(), &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
				.map(Method::valueOf)
				.collect(toSet());
	}

	@NotNull
	&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; HashSet&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; asHeaders(@NotNull &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value) {
		&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; newHashSet(headerValueSplitter.split(value));
	}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14980106" author="koscejev" created="Thu, 29 Oct 2015 09:23:49 +0000"  >&lt;p&gt;Proper solution should probably involve org.restlet.service.CorsService or org.restlet.engine.application.CorsFilter. Some non-camel example: &lt;a href=&quot;http://stackoverflow.com/questions/28988671/how-to-use-cors-in-restlet-2-3-1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/28988671/how-to-use-cors-in-restlet-2-3-1&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="15031761" author="koscejev" created="Mon, 30 Nov 2015 13:27:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;, current fix is flawed (details below). I have a solution that I can provide a PR - should I create a new issue or reopen this one?&lt;/p&gt;

&lt;p&gt;I found this out while trying to implement &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-9371&quot; title=&quot;Add support of Swagger for restlet component&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-9371&quot;&gt;&lt;del&gt;CAMEL-9371&lt;/del&gt;&lt;/a&gt;, which should&apos;ve been a tiny fix. Restlet rejects headers that are not trimmed, and there&apos;s a small bug where Access-Control-Expose-Headers is actually treated as a Set of Method. The result is that Restlet&apos;s internal StringWriter fails with IllegalArgumentException at HeaderWriter.java:286 (because header is not trimmed and space is not allowed), and this results in HTTP status code being 500 instead of 200 with no details regarding what happened (pretty bad restlet behavior, btw).&lt;/p&gt;</comment>
                            <comment id="15031773" author="davsclaus" created="Mon, 30 Nov 2015 13:36:15 +0000"  >&lt;p&gt;A new PR is fine&lt;/p&gt;</comment>
                            <comment id="15031872" author="githubbot" created="Mon, 30 Nov 2015 14:49:47 +0000"  >&lt;p&gt;GitHub user koscejev opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/702&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/702&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-9270&quot; title=&quot;rest-dsl - CORS support doesn&amp;#39;t work with Restlet 2.3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-9270&quot;&gt;&lt;del&gt;CAMEL-9270&lt;/del&gt;&lt;/a&gt; trim headers before setting them via Restlet API&lt;/p&gt;

&lt;p&gt;    As discussed in &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-9270&quot; title=&quot;rest-dsl - CORS support doesn&amp;#39;t work with Restlet 2.3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-9270&quot;&gt;&lt;del&gt;CAMEL-9270&lt;/del&gt;&lt;/a&gt;, providing a PR with CORS header trimming and minor related fixes.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/koscejev/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/koscejev/camel&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-9270&quot; title=&quot;rest-dsl - CORS support doesn&amp;#39;t work with Restlet 2.3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-9270&quot;&gt;&lt;del&gt;CAMEL-9270&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/702.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/702.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #702&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e6a8e156556c1bc698508f102aad867fe3879ed6&lt;br/&gt;
Author: Anton Koscejev &amp;lt;anton.koscejev@zoomint.com&amp;gt;&lt;br/&gt;
Date:   2015-11-30T14:27:09Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-9270&quot; title=&quot;rest-dsl - CORS support doesn&amp;#39;t work with Restlet 2.3&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-9270&quot;&gt;&lt;del&gt;CAMEL-9270&lt;/del&gt;&lt;/a&gt; trim headers before setting them via Restlet API&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15031976" author="githubbot" created="Mon, 30 Nov 2015 15:45:22 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/702&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/702&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 51 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2nofr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>