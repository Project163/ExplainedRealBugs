<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:07:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-20844] UseOriginalAggregationStrategy doesn&apos;t set EXCEPTION_CAUGHT property on exception propagation</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-20844</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I have the following problem: &lt;tt&gt;onCompletion&lt;/tt&gt; processor on a route can&#8217;t find a caught exception in Exchange that occurred inside &lt;tt&gt;Split&lt;/tt&gt; with &lt;tt&gt;UseOriginalAggregationStrategy&lt;/tt&gt; aggregation strategy.&lt;br/&gt;
&#160;&lt;br/&gt;
Long story short:&#160;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;Split&lt;/tt&gt; processor got only one message from the split expression&lt;/li&gt;
	&lt;li&gt;Sending it down to the next processor failed because of exception&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;RedeliveryErrorHandler&lt;/tt&gt; sets &lt;tt&gt;EXCEPTION_CAUGHT&lt;/tt&gt; property on the exchange (&lt;tt&gt;prepareExchangeAfterFailure&lt;/tt&gt; method)&lt;/li&gt;
	&lt;li&gt;On Aggregation: &lt;font color=&quot;#000000&quot;&gt;&lt;tt&gt;UseOriginalAggregationStrategy&lt;/tt&gt; &lt;tt&gt;aggregate&lt;/tt&gt; method took the exception and set it to the original exchange (didn&#8217;t copy the &lt;/font&gt;&lt;tt&gt;EXCEPTION_CAUGHT&lt;/tt&gt; property though)&lt;/li&gt;
	&lt;li&gt;The &lt;font color=&quot;#000000&quot;&gt;&lt;tt&gt;OnCompletionProcessor&lt;/tt&gt; in the &lt;tt&gt;doProcess&lt;/tt&gt; method clears the exception sending it down to the &lt;tt&gt;onCompletion&lt;/tt&gt; processors&lt;/font&gt;&lt;/li&gt;
	&lt;li&gt;&lt;font color=&quot;#000000&quot;&gt;Exchange in the &lt;tt&gt;onCompletion&lt;/tt&gt; processor doesn&#8217;t have an exception and has no &#160;&lt;/font&gt;&lt;tt&gt;EXCEPTION_CAUGHT&lt;/tt&gt; property.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;br/&gt;
&lt;font color=&quot;#000000&quot;&gt;Is this an expected behavior?&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#000000&quot;&gt;Should the&#160;&lt;/font&gt;&lt;tt&gt;UseOriginalAggregationStrategy&lt;/tt&gt; copy the&#160;&lt;tt&gt;EXCEPTION_CAUGHT&lt;/tt&gt; property&#160;as well?&#160;&lt;br/&gt;
Or probably it would be better if&#160;&lt;font color=&quot;#000000&quot;&gt;&lt;tt&gt;OnCompletionProcessor&lt;/tt&gt; sets it in case of clearing the exception, wouldn&#8217;t it?&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#000000&quot;&gt;&#160;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#000000&quot;&gt;Thank you in advance for sharing your thoughts.&lt;/font&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13581755">CAMEL-20844</key>
            <summary>UseOriginalAggregationStrategy doesn&apos;t set EXCEPTION_CAUGHT property on exception propagation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="Gomoliako">Eduard Gomoliako</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Jun 2024 07:48:57 +0000</created>
                <updated>Mon, 19 Aug 2024 11:09:22 +0000</updated>
                            <resolved>Mon, 19 Aug 2024 11:09:22 +0000</resolved>
                                    <version>4.4.0</version>
                                    <fixVersion>4.8.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17852675" author="davsclaus" created="Thu, 6 Jun 2024 08:01:33 +0000"  >&lt;p&gt;See the &lt;b&gt;shareUnitOfWork option&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="17852684" author="JIRAUSER292949" created="Thu, 6 Jun 2024 08:34:25 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;, will check it out.&lt;/p&gt;

&lt;p&gt;Though my question still stands considering that&#160;&lt;tt&gt;UseOriginalAggregationStrategy&lt;/tt&gt; copies the exception, why the other related mechanism shouldn&apos;t work?&#160;&lt;/p&gt;

&lt;p&gt;Thinking out loud: if the Unit of Work is the scope for failures, then why&#160;&lt;tt&gt;UseOriginalAggregationStrategy&lt;/tt&gt; propagates the exception?&lt;/p&gt;</comment>
                            <comment id="17855921" author="davsclaus" created="Tue, 18 Jun 2024 12:36:24 +0000"  >&lt;p&gt;Put together your sample code/project as that is easier to take a look at&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 21 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1pnao:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>