<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:46:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-4476] Camel splitter/aggregator 2x slower in 2.8.1 vs 2.7.3</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-4476</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I noticed a sharp decline in the performance of my application when I upgraded from Camel 2.7.3 to 2.8.1. I discovered that the splitter/aggregator had become the bottleneck in my app. I have created a sample app that demonstrates the issue. The aggregator uses a lock, and I suspect lock contention may be at the root of this, but didn&apos;t notice any changes around that in the code diff between the versions.&lt;/p&gt;

&lt;p&gt;I uploaded the sample app to &lt;a href=&quot;http://www.vancameron.net/CamelPerf.zip&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.vancameron.net/CamelPerf.zip&lt;/a&gt;. It uses gradle. Unzip to a directory then run &quot;gradle&quot; from the command line. To change the version from 2.8.1 to 2.7.3, edit the build.gradle file and run again.&lt;/p&gt;

&lt;p&gt;The app loads 10 files with 100k lines each. It prints the current time in msec per batch.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Oracle JDK 1.6.0_26 64-bit, CentOS 6 64-bit&lt;/p&gt;</environment>
        <key id="12524221">CAMEL-4476</key>
            <summary>Camel splitter/aggregator 2x slower in 2.8.1 vs 2.7.3</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="bryanck">Bryan Keller</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Sep 2011 00:12:03 +0000</created>
                <updated>Thu, 22 Sep 2011 13:42:55 +0000</updated>
                            <resolved>Thu, 22 Sep 2011 13:42:55 +0000</resolved>
                                    <version>2.8.1</version>
                                    <fixVersion>2.8.2</fixVersion>
                    <fixVersion>2.9.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13112362" author="bryanck" created="Thu, 22 Sep 2011 06:42:39 +0000"  >&lt;p&gt;This looks like it was caused by using &amp;lt;simple&amp;gt;xxx&amp;lt;/simple&amp;gt; expressions for the completion timeout and completion size. It seems that the expression is being evaluated for each batch in 2.8 but that was not the behavior in 2.7. That caused the performance degradation. Changing to &amp;lt;constant&amp;gt; expressions fixed the performance problem I was having.&lt;/p&gt;</comment>
                            <comment id="13112393" author="bryanck" created="Thu, 22 Sep 2011 07:55:51 +0000"  >&lt;p&gt;Though I uncovered a problem. When using a constant expression, there is no way to inject a property value. So if I want the batch size configurable, it seems the only way to do this is to use a &quot;simple&quot; expression. But using the &quot;simple&quot; expression causes the aforementioned performance issue.&lt;/p&gt;</comment>
                            <comment id="13112510" author="davsclaus" created="Thu, 22 Sep 2011 12:47:54 +0000"  >&lt;p&gt;With constant: Time taken 68040 ms&lt;br/&gt;
With simple: Time taken 100913 ms&lt;/p&gt;</comment>
                            <comment id="13112514" author="davsclaus" created="Thu, 22 Sep 2011 12:56:06 +0000"  >&lt;p&gt;Okay got it optimized so its as fast again:&lt;br/&gt;
With simple: Time taken 68876 ms&lt;/p&gt;</comment>
                            <comment id="13112572" author="davsclaus" created="Thu, 22 Sep 2011 13:42:55 +0000"  >&lt;p&gt;Thanks for reporting. &lt;/p&gt;

&lt;p&gt;I added a test AggregateSimpleExpressionIssueTest which is similar to yours. It can be run manually. And the test now runs as fast for constant/simple language.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13767</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 9 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0215z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9790</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>