<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:52:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-17491] camel-openapi-java - Operation paths are incorrect if contextPath is set</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-17491</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Consider this REST configuration:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
restConfiguration()
    .host(&lt;span class=&quot;code-quote&quot;&gt;&quot;localhost&quot;&lt;/span&gt;)
    .apiHost(&lt;span class=&quot;code-quote&quot;&gt;&quot;localhost&quot;&lt;/span&gt;)
    .contextPath(&lt;span class=&quot;code-quote&quot;&gt;&quot;/api&quot;&lt;/span&gt;)
    .port(8080)
    .apiContextPath(&lt;span class=&quot;code-quote&quot;&gt;&quot;/api-docs&quot;&lt;/span&gt;);


&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;(&lt;span class=&quot;code-quote&quot;&gt;&quot;/service&quot;&lt;/span&gt;)
    .get(&lt;span class=&quot;code-quote&quot;&gt;&quot;/testing&quot;&lt;/span&gt;).description(&lt;span class=&quot;code-quote&quot;&gt;&quot;Test Service&quot;&lt;/span&gt;)
    .outType(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.class)
    .route().setBody().constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &apos;paths&apos; object in the generated OpenAPI document is incorrect. It should not have the &apos;/api&apos; context path prefix.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;openapi&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;3.0.2&quot;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;info&quot;&lt;/span&gt; : { },
  &lt;span class=&quot;code-quote&quot;&gt;&quot;servers&quot;&lt;/span&gt; : [ {
    &lt;span class=&quot;code-quote&quot;&gt;&quot;url&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;/api&quot;&lt;/span&gt;
  } ],
  &lt;span class=&quot;code-quote&quot;&gt;&quot;paths&quot;&lt;/span&gt; : {
    &lt;span class=&quot;code-quote&quot;&gt;&quot;/api/service/testing&quot;&lt;/span&gt; : {
      &lt;span class=&quot;code-quote&quot;&gt;&quot;get&quot;&lt;/span&gt; : {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;tags&quot;&lt;/span&gt; : [ &lt;span class=&quot;code-quote&quot;&gt;&quot;/service&quot;&lt;/span&gt; ],
        &lt;span class=&quot;code-quote&quot;&gt;&quot;responses&quot;&lt;/span&gt; : {
          &lt;span class=&quot;code-quote&quot;&gt;&quot;200&quot;&lt;/span&gt; : { }
        },
        &lt;span class=&quot;code-quote&quot;&gt;&quot;operationId&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;verb1&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;summary&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;Test Service&quot;&lt;/span&gt;
      }
    }
  },
  &lt;span class=&quot;code-quote&quot;&gt;&quot;components&quot;&lt;/span&gt; : { },
  &lt;span class=&quot;code-quote&quot;&gt;&quot;tags&quot;&lt;/span&gt; : [ {
    &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;/service&quot;&lt;/span&gt;
  } ]
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The OpenAPI spec states: &lt;/p&gt;

&lt;p&gt;&quot;Unless specified otherwise, all properties that are URLs MAY be relative references as defined by RFC3986. Relative references are resolved using the URLs defined in the Server Object as a Base URI.&quot;.&lt;/p&gt;

&lt;p&gt;If you try to execute the service in the Swagger UI, then it tries to hit &lt;a href=&quot;http://localhost:8080/api/api/service/testing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/api/api/service/testing&lt;/a&gt; (duplicate /api/api in the path).&lt;/p&gt;

&lt;p&gt;Maybe the code we had before &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-17063&quot; title=&quot;camel-openapi-java - Generated api-doc must use contextPath rest configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-17063&quot;&gt;&lt;del&gt;CAMEL-17063&lt;/del&gt;&lt;/a&gt; was implemented was more correct?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13422751">CAMEL-17491</key>
            <summary>camel-openapi-java - Operation paths are incorrect if contextPath is set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="klease78">Karen Lease</assignee>
                                    <reporter username="jamesnetherton">James Netherton</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Jan 2022 14:44:15 +0000</created>
                <updated>Fri, 21 Jan 2022 16:37:22 +0000</updated>
                            <resolved>Fri, 21 Jan 2022 16:37:22 +0000</resolved>
                                    <version>3.13.0</version>
                    <version>3.14.0</version>
                                    <fixVersion>3.15.0</fixVersion>
                                    <component>camel-openapi-java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17476178" author="jamesnetherton" created="Fri, 14 Jan 2022 14:45:41 +0000"  >&lt;p&gt;Originally reported here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/camel-quarkus/issues/3457&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel-quarkus/issues/3457&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17476267" author="davsclaus" created="Fri, 14 Jan 2022 16:43:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=klease78&quot; class=&quot;user-hover&quot; rel=&quot;klease78&quot;&gt;klease78&lt;/a&gt; you have fixed before in openapi, wonder if you could take a look later?&lt;/p&gt;</comment>
                            <comment id="17476883" author="klease78" created="Sun, 16 Jan 2022 21:56:35 +0000"  >&lt;p&gt;Sure, I think it must be similar to the other issue.&lt;/p&gt;</comment>
                            <comment id="17477332" author="klease78" created="Mon, 17 Jan 2022 17:26:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; I found that when I remove the context path from the operations in the generated swagger, the camel-spring-boot-examples/rest-openapi-springdoc is broken because the generated server URL doesn&apos;t include the &quot;/api&quot;.&lt;/p&gt;

&lt;p&gt;The main reason for this is the following comment in SpringdocAutoConfiguration.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// Note: &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not copy servers, since we use the spring-boot configured setting&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So the configured context path is ignored.&lt;br/&gt;
Maybe there is some other way to specify it in the spring-boot configuration, but so far the only way I found is to add an annotation in the spring-boot Application.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@io.swagger.v3.oas.annotations.OpenAPIDefinition(
        servers = {@Server(url = &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8080/api&quot;&lt;/span&gt;)}    
&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It seems to make more sense to use the information in the generated OpenAPI which uses the RestConfiguration instead of having to specify it separately. I tried this and it works. If the annotation is also present it overrides the values in the openapi servers configuration.&lt;br/&gt;
I also noticed that the BeanConfig passed to RestOpenApiReader.read() in SpringdocAutoConfiguration doesn&apos;t read the same values from the RestConfiguration as the code in the camel-openapi-java component, for example, it actually ignores the contextPath. I could fix this.&lt;/p&gt;

&lt;p&gt;Any feedback?&lt;/p&gt;</comment>
                            <comment id="17477821" author="davsclaus" created="Tue, 18 Jan 2022 12:35:49 +0000"  >&lt;p&gt;Thanks Karen for diving into this.&lt;/p&gt;

&lt;p&gt;Yeah I think it makes sense to make the rest-dsl similar/consistent across runtimes, and that it primary uses the restConfiguration from Camel itself.&lt;br/&gt;
That annotation is from swagger and not spring boot so that would be general swagger, and so I think you are right that we can use it.&lt;/p&gt;

&lt;p&gt;When you have fixes ready then send a PR then it helps review and also understand what we are doing better.&lt;br/&gt;
And also if we need to add a note to the 3.15 upgrade guide to alter users about changes when upgrading Camel.&lt;/p&gt;</comment>
                            <comment id="17479605" author="klease78" created="Thu, 20 Jan 2022 18:53:25 +0000"  >&lt;p&gt;I created a PR for the change in camel-openapi-java. For the moment I didn&apos;t change the springdoc component.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310760">
                    <name>Testing</name>
                                            <outwardlinks description="Testing discovered">
                                        <issuelink>
            <issuekey id="13424057">CAMEL-17535</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ylm8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>