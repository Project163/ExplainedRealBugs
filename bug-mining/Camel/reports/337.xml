<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:28:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-807] HttpProducer premature out message creation</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-807</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I believe there is incorrect flow in the HttpProducer which can subvert error handling in the route:&lt;/p&gt;

&lt;p&gt;in Camel 1.4.0 in HttpProducer on line 76 a &quot;blank&quot; out message is set on the exchange:&lt;/p&gt;

&lt;p&gt;Message out = exchange.getOut(true);&lt;br/&gt;
        try {&lt;br/&gt;
            int responseCode = httpClient.executeMethod(method);&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;1. If an IO error occurs on connect, the out message will be passed to the error handling code and if the originating endpoint was a JmsMessage it will cause an NPE when JmsMessage.getMessageId() is called. It also obscures the offending message I believe.&lt;br/&gt;
2. A similar situation will happen if the HTTP service returned an error code; the out message will contain a reply message even though the processing resulted in an error (e.g. HTTP Status 500) &lt;br/&gt;
3. Also, shouldn&apos;t this code test whether the exchange expects an &quot;out&quot; altogether, and if not, perhaps, put just put the return HTTP status into the &quot;in&quot; message header.&lt;/p&gt;

&lt;p&gt;--Bill&lt;/p&gt;</description>
                <environment></environment>
        <key id="12486000">CAMEL-807</key>
            <summary>HttpProducer premature out message creation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="tourist604">Bill Skrypnyk</reporter>
                        <labels>
                    </labels>
                <created>Sun, 10 Aug 2008 22:22:11 +0000</created>
                <updated>Mon, 16 Feb 2009 05:51:49 +0000</updated>
                            <resolved>Thu, 25 Sep 2008 23:27:51 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.5.0</fixVersion>
                                    <component>camel-http</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12948382" author="davsclaus" created="Tue, 12 Aug 2008 08:48:50 +0000"  >&lt;p&gt;Thanks for reporting this. Will target this for Camel 1.5.&lt;/p&gt;

&lt;p&gt;Ad 1)&lt;br/&gt;
Can you provide a unit test the demonstrates this bug? Or at least a routebuilder with the setup? Helps a lot with something to start with.&lt;/p&gt;

&lt;p&gt;Ad 2)&lt;br/&gt;
Yeah it should test for != 200 and set a fault message or the like for all the non OK result.&lt;/p&gt;

&lt;p&gt;Ad 3)&lt;br/&gt;
The MEP (InOnly, InOut) is a bit confusing in Camel right now. The components doesn&apos;t isn&apos;t strict about them. They were added becasue of JBI to my knowledge.&lt;br/&gt;
We are discussing to do something about it in Camel 2.0. For now we wont change the current behavior.&lt;/p&gt;

&lt;p&gt;But yes doing a isOutCapable is a good idea. and set on in if not.&lt;/p&gt;

&lt;p&gt;BTW: If you fancy then patches is highly appreciated&lt;br/&gt;
&lt;a href=&quot;http://activemq.apache.org/camel/contributing.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://activemq.apache.org/camel/contributing.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12948987" author="njiang" created="Thu, 25 Sep 2008 09:01:09 +0000"  >&lt;p&gt;For &lt;br/&gt;
1) I  fixed the NPE in &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-785&quot; title=&quot;NPE happens when the JmsMessage&amp;#39;s jmsMessage is null&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-785&quot;&gt;&lt;del&gt;CAMEL-785&lt;/del&gt;&lt;/a&gt;. Please check out the Camel 1.5 snapshot for verification.&lt;/p&gt;

&lt;p&gt;2) I just updated the code if the responseCode != 200, we put the result into the fault message.&lt;/p&gt;

&lt;p&gt;3) Since we are thinking the InMessage should be a mutable, I&apos;d like to keep the out  message for store the result.&lt;/p&gt;

&lt;p&gt;Maybe we will review this in the Camel2.0.&lt;/p&gt;


</comment>
                            <comment id="12948907" author="hadrian" created="Thu, 25 Sep 2008 14:48:44 +0000"  >&lt;p&gt;@Willem, I think for things like 500 (transient errors) it should still be exception.&lt;/p&gt;</comment>
                            <comment id="12948839" author="hadrian" created="Thu, 25 Sep 2008 23:27:51 +0000"  >&lt;p&gt;On a second thought, let&apos;s close this one.  We&apos;ll have quite some cleanup to do across all components after &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-316&quot; title=&quot;Merge Fault and Exception semantics&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-316&quot;&gt;&lt;del&gt;CAMEL-316&lt;/del&gt;&lt;/a&gt; is fixed.&lt;/p&gt;</comment>
                            <comment id="12950844" author="davsclaus" created="Mon, 16 Feb 2009 05:51:49 +0000"  >&lt;p&gt;Closing all 1.5.0 issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>83294</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 41 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01ein:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6121</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>