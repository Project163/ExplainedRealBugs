<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:01:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-19381] Infinite loop creating processes with Camel JBang</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-19381</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I used the command:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;jbang camel@apache/camel run &apos;src/main/java/org/acme/timer/log/TimerRoute.java&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the file is coming from &lt;a href=&quot;https://github.com/apache/camel-quarkus-examples/blob/ed3523e9c8d3343922eba3a34f6b248d90493782/timer-log/src/main/java/org/acme/timer/log/TimerRoute.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel-quarkus-examples/blob/ed3523e9c8d3343922eba3a34f6b248d90493782/timer-log/src/main/java/org/acme/timer/log/TimerRoute.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;there is this log repeating indefinitely:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Running integration with the following configuration:
    --camel-version=3.20.4
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;it creates a new CamelJBang on each time it writes the previous log block:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;jps | grep CamelJBang
532586 CamelJBang
532743 CamelJBang
532666 CamelJBang
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The main thread dump on them is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Name: main
State: WAITING on java.lang.ProcessImpl@e90900f
Total blocked: 0  Total waited: 1

Stack trace: 
java.base@17.0.3/java.lang.Object.wait(Native Method)
java.base@17.0.3/java.lang.Object.wait(Object.java:338)
java.base@17.0.3/java.lang.ProcessImpl.waitFor(ProcessImpl.java:434)
app//org.apache.camel.dsl.jbang.core.commands.Run.runCamelVersion(Run.java:637)
app//org.apache.camel.dsl.jbang.core.commands.Run.run(Run.java:566)
app//org.apache.camel.dsl.jbang.core.commands.Run.doCall(Run.java:227)
app//org.apache.camel.dsl.jbang.core.commands.CamelCommand.call(CamelCommand.java:70)
app//org.apache.camel.dsl.jbang.core.commands.CamelCommand.call(CamelCommand.java:35)
app//picocli.CommandLine.executeUserObject(CommandLine.java:2041)
app//picocli.CommandLine.access$1500(CommandLine.java:148)
app//picocli.CommandLine$RunLast.executeUserObjectOfLastSubcommandWithSameParent(CommandLine.java:2461)
app//picocli.CommandLine$RunLast.handle(CommandLine.java:2453)
app//picocli.CommandLine$RunLast.handle(CommandLine.java:2415)
app//picocli.CommandLine$AbstractParseResultHandler.execute(CommandLine.java:2273)
app//picocli.CommandLine$RunLast.execute(CommandLine.java:2417)
app//picocli.CommandLine.execute(CommandLine.java:2170)
app//org.apache.camel.dsl.jbang.core.commands.CamelJBangMain.run(CamelJBangMain.java:154)
app//main.CamelJBang.main(CamelJBang.java:36)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13537304">CAMEL-19381</key>
            <summary>Infinite loop creating processes with Camel JBang</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="apupier">Aur&#233;lien Pupier</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 May 2023 09:44:06 +0000</created>
                <updated>Fri, 9 Jun 2023 13:57:13 +0000</updated>
                            <resolved>Fri, 9 Jun 2023 13:57:13 +0000</resolved>
                                    <version>3.20.4</version>
                    <version>3.20.5</version>
                                    <fixVersion>3.20.6</fixVersion>
                    <fixVersion>3.21.0</fixVersion>
                    <fixVersion>4.0-RC1</fixVersion>
                    <fixVersion>4.0.0</fixVersion>
                                    <component>camel-jbang</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17725332" author="apupier" created="Tue, 23 May 2023 09:52:57 +0000"  >&lt;p&gt;if I unset the Camel version:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;jbang camel@apache/camel config unset camel-version
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;there is no more the loop.&lt;/p&gt;

&lt;p&gt;When I set the version to 3.20.4 or 3.20.3, I reproduce it&lt;/p&gt;</comment>
                            <comment id="17725334" author="davsclaus" created="Tue, 23 May 2023 09:55:56 +0000"  >&lt;p&gt;try with 3.20.5 when its released&lt;/p&gt;</comment>
                            <comment id="17725335" author="apupier" created="Tue, 23 May 2023 10:00:38 +0000"  >&lt;p&gt;Attempt to use 3.20.5-SNAPSHOT is nto working (but unrelated to this issue):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;(base) [apupier@localhost timer-log]$ jbang camel@apache/camel config set camel-version=3.20.5-SNAPSHOT
(base) [apupier@localhost timer-log]$ jbang camel@apache/camel config set camel.jbang.repos=https://repository.apache.org/snapshots/
(base) [apupier@localhost timer-log]$ jbang camel@apache/camel run &apos;src/main/java/org/acme/timer/log/TimerRoute.java&apos;
Running integration with the following configuration:
    --camel-version=3.20.5-SNAPSHOT
[jbang] Resolving dependencies...
[jbang]    org.apache.camel:camel-bom:3.20.5-SNAPSHOT@pom
[jbang]    org.apache.camel:camel-core:3.20.5-SNAPSHOT
[jbang]    org.apache.camel:camel-core-engine:3.20.5-SNAPSHOT
[jbang]    org.apache.camel:camel-main:3.20.5-SNAPSHOT
[jbang]    org.apache.camel:camel-java-joor-dsl:3.20.5-SNAPSHOT
[jbang]    org.apache.camel:camel-kamelet:3.20.5-SNAPSHOT
[jbang]    org.apache.camel:camel-jbang-core:3.20
[jbang]    org.apache.camel:camel-kamelet-main:3.20
[jbang]    org.apache.camel:camel-resourceresolver-github:3.20
[jbang]    org.apache.camel:camel-cli-connector:3.20
[jbang]    org.apache.camel.kamelets:camel-kamelets:3.20.3
[jbang] [ERROR] Could not resolve dependencies: The following artifacts could not be resolved: org.apache.camel:camel-jbang-core:jar:3.20, org.apache.camel:camel-kamelet-main:jar:3.20, org.apache.camel:camel-resourceresolver-github:jar:3.20, org.apache.camel:camel-cli-connector:jar:3.20: Could not find artifact org.apache.camel:camel-jbang-core:jar:3.20 in mavencentral (https://repo1.maven.org/maven2/)
[jbang] Run with --verbose for more details
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17725369" author="apupier" created="Tue, 23 May 2023 11:19:01 +0000"  >&lt;p&gt;Camel 3.20.5 should be available in few days as the vote for the release has been started today: &lt;a href=&quot;https://lists.apache.org/thread/d2bk9dgm1bb5ffcl266rd567b0b5s67w&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread/d2bk9dgm1bb5ffcl266rd567b0b5s67w&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17727373" author="apupier" created="Tue, 30 May 2023 07:50:00 +0000"  >&lt;p&gt;I reproduce with Camel 3.20.5:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;jbang camel@apache/camel init test.xml
jbang camel@apache/camel config set camel-version=3.20.5
jbang camel@apache/camel run test.xml
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17727528" author="apupier" created="Tue, 30 May 2023 13:47:34 +0000"  >&lt;p&gt;updated stack with 3.20.5:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Name: main
State: WAITING on java.lang.ProcessImpl@2e0efc98
Total blocked: 0  Total waited: 1

Stack trace: 
java.base@17.0.3/java.lang.Object.wait(Native Method)
java.base@17.0.3/java.lang.Object.wait(Object.java:338)
java.base@17.0.3/java.lang.ProcessImpl.waitFor(ProcessImpl.java:434)
app//org.apache.camel.dsl.jbang.core.commands.Run.runCamelVersion(Run.java:679)
app//org.apache.camel.dsl.jbang.core.commands.Run.run(Run.java:574)
app//org.apache.camel.dsl.jbang.core.commands.Run.doCall(Run.java:231)
app//org.apache.camel.dsl.jbang.core.commands.CamelCommand.call(CamelCommand.java:73)
app//org.apache.camel.dsl.jbang.core.commands.CamelCommand.call(CamelCommand.java:36)
app//picocli.CommandLine.executeUserObject(CommandLine.java:2041)
app//picocli.CommandLine.access$1500(CommandLine.java:148)
app//picocli.CommandLine$RunLast.executeUserObjectOfLastSubcommandWithSameParent(CommandLine.java:2461)
app//picocli.CommandLine$RunLast.handle(CommandLine.java:2453)
app//picocli.CommandLine$RunLast.handle(CommandLine.java:2415)
app//picocli.CommandLine$AbstractParseResultHandler.execute(CommandLine.java:2273)
app//picocli.CommandLine$RunLast.execute(CommandLine.java:2417)
app//picocli.CommandLine.execute(CommandLine.java:2170)
app//org.apache.camel.dsl.jbang.core.commands.CamelJBangMain.run(CamelJBangMain.java:154)
app//main.CamelJBang.main(CamelJBang.java:36)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17727970" author="apupier" created="Wed, 31 May 2023 13:40:17 +0000"  >&lt;p&gt;it also affects camel version specified in a profile:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;jbang camel@apache/camel init test.xml
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;create application.properties files with content:
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;camel.jbang.camel-version=3.20.5
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;jbang camel@apache/camel run test.xml
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17727971" author="apupier" created="Wed, 31 May 2023 13:42:51 +0000"  >&lt;p&gt;if I understand well, it iw orking when specifyin gthe version from command-line with --camel-version because it is explcitely removed at this place &lt;a href=&quot;https://github.com/apache/camel/blob/f00a7a8e7b534e3b0f67091bb46e7604a642e825/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/Run.java#L671&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/f00a7a8e7b534e3b0f67091bb46e7604a642e825/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/Run.java#L671&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For other cases, there is a camelVersion specified and so it tried to spin a new process all the time: &lt;a href=&quot;https://github.com/apache/camel/blob/f00a7a8e7b534e3b0f67091bb46e7604a642e825/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/Run.java#L583&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/f00a7a8e7b534e3b0f67091bb46e7604a642e825/dsl/camel-jbang/camel-jbang-core/src/main/java/org/apache/camel/dsl/jbang/core/commands/Run.java#L583&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17730955" author="davsclaus" created="Fri, 9 Jun 2023 13:36:42 +0000"  >&lt;p&gt;This will only work on never Camel version forward, 3.20.6, 3.21 etc. For older version you need to use the command line args.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 22 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1i2y0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>