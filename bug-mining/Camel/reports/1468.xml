<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:44:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-4047] javax.script dependency in camel-core</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-4047</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>
&lt;p&gt;The OSGi imports for camel-core ends up with a non-optional dependency on javax.script due to it being used in the Activator.    However, the karaf feature for camel-core doesn&apos;t have a dependency on org.apache.servicemix.specs.scripting-api-1.0 .&lt;/p&gt;

&lt;p&gt;One of two things should be done:&lt;br/&gt;
1) mark javax.script as optional.  This MAY require some updates to the Activator to work when it&apos;s not available.&lt;/p&gt;

&lt;p&gt;2) Update the karaf features file to add:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;bundle dependency=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;mvn:org.apache.servicemix.specs/org.apache.servicemix.specs.scripting-api-1.0/${servicemix-specs-version}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/bundle&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12509215">CAMEL-4047</key>
            <summary>javax.script dependency in camel-core</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dkulp">Daniel Kulp</assignee>
                                    <reporter username="dkulp">Daniel Kulp</reporter>
                        <labels>
                    </labels>
                <created>Fri, 3 Jun 2011 17:56:21 +0000</created>
                <updated>Wed, 8 Jun 2011 03:05:35 +0000</updated>
                            <resolved>Wed, 8 Jun 2011 03:05:35 +0000</resolved>
                                    <version>2.8.0</version>
                                    <fixVersion>2.8.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13043918" author="hadrian" created="Fri, 3 Jun 2011 18:02:45 +0000"  >&lt;p&gt;Dan, thanks for reporting this!&lt;br/&gt;
I don&apos;t see 2) as being an option and have a strong preference towards 1).&lt;/p&gt;</comment>
                            <comment id="13043968" author="dkulp" created="Fri, 3 Jun 2011 18:55:02 +0000"  >
&lt;p&gt;Actually, #2 is really the correct solution to this.  In OSGi, the smx scripting-api jar is really the version of the API jar with  the factory (ScriptEngineMaker) that works in OSGi.   You cannot really use the in-jdk versions.   This is the same as all the other api jars we use.&lt;/p&gt;

&lt;p&gt;Thus, we need to make sure we depend on that version up front in the features file.  Otherwise, you can end up with a path like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;features:install ....camel-core...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which would depend on the in-jdk version.  Then, later, I install something like camel-bean-validator or something else that would pull in the smx api version.   Any scripting engine installed after that will result in classcasts in camel as the javax.script classes will be different as the new bundles will get the smx version and Camel will expect the in-jdk version.&lt;/p&gt;
</comment>
                            <comment id="13044044" author="hadrian" created="Fri, 3 Jun 2011 20:56:15 +0000"  >&lt;p&gt;More I think about it, more my head spins... I agree 2) would completely solve the problem, but it is the right solution?&lt;/p&gt;

&lt;p&gt;We cannot use the jre version of the ScriptEngineFactory in an OSGi deployment, that much is clear. Both 1) and 2) do not have &lt;b&gt;any&lt;/b&gt; impact on non-OSGi deployments, so we&apos;re good there.&lt;/p&gt;

&lt;p&gt;Assumption &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/star_yellow.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;: There is a fair percentage of deployments that do &lt;b&gt;not&lt;/b&gt; need/use a script engine (say x%).&lt;/p&gt;

&lt;p&gt;Solution 2) brings the extra feature dependency for the camel-core on all &lt;b&gt;osgi&lt;/b&gt; deployments. If x is relatively small e.g. x &amp;lt;= 20, I don&apos;t think it&apos;s a big problem, especially given the meager 32k the extra bundle is bringing.&lt;/p&gt;

&lt;p&gt;If x is larger, say x &amp;gt;= 80, would it make sense to make the dependency optional? Of course we then have the problem Dan explained. We can get activation to fail for things like camel-bean-validator if camel-core was using the jre version of the ScriptEngine. 3rd party component writers would have to be aware of that too.&lt;/p&gt;

&lt;p&gt;I don&apos;t know it may be overkill for just the 32k... On the plus side, we should be able to reach a consensus quickly on this though.&lt;/p&gt;
</comment>
                            <comment id="13044050" author="jbonofre" created="Fri, 3 Jun 2011 21:01:05 +0000"  >&lt;p&gt;My preference is more on the 2/ because I think it&apos;s the most secure way.&lt;/p&gt;

&lt;p&gt;It requires:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;to exclude javax.script from the system package (by tuning the jre.properties file)&lt;/li&gt;
	&lt;li&gt;add the ServiceMix Specs bundle in the feature&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Like this, we can guarantee that it works, which is more hazardous just flagging the javax.script package as optional.&lt;/p&gt;</comment>
                            <comment id="13044067" author="dkulp" created="Fri, 3 Jun 2011 21:21:17 +0000"  >
&lt;p&gt;The other option MAY be to move all  the javax.script stuff into the camel-script component.  It already has a bundle Activator in there that could handle this.   &lt;/p&gt;

&lt;p&gt;That said, I&apos;m not 100% sure if that&apos;s acceptable as there COULD be use cases of the script things without camel-script.   Thoughts?&lt;/p&gt;</comment>
                            <comment id="13044157" author="hadrian" created="Sat, 4 Jun 2011 01:12:14 +0000"  >&lt;p&gt;+1. This sounds great, camel-script SHOULD be used with jsr-223 languages.&lt;/p&gt;</comment>
                            <comment id="13044976" author="dkulp" created="Mon, 6 Jun 2011 17:38:01 +0000"  >
&lt;p&gt;May need to use &quot;git apply&quot; to apply the patch due to the removal of a file.&lt;/p&gt;

&lt;p&gt;I&apos;ve tested a bit in a standalone OSGi container (TSF) installing the camel-script feature and such.   However, I haven&apos;t been able to run the camel-ittest-osgi stuff yet due to them being broken.&lt;/p&gt;</comment>
                            <comment id="13045736" author="hadrian" created="Wed, 8 Jun 2011 01:02:51 +0000"  >&lt;p&gt;@Dan, patch looks good. I started a full test and will commit when done (could take a while...). Thanks for the contribution.&lt;/p&gt;</comment>
                            <comment id="13045762" author="hadrian" created="Wed, 8 Jun 2011 03:05:35 +0000"  >&lt;p&gt;Fixed in r1133232. Thanks Dan for patch and keep them coming.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12481593" name="CAMEL-4047.patch" size="26999" author="dkulp" created="Mon, 6 Jun 2011 17:38:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13985</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 25 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01yiv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9362</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>