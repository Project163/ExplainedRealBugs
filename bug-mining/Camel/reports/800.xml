<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:35:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-2102] Transacted routes don&apos;t allow custom error handlers to mark exception as handled AND set rollback only</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-2102</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;If a route is transacted using transacted(), and a custom error handler is registered using onException() which handles the exception using handled(), creates a custom error response, and marks the transaction to be rolled back using rollback(), Camel wraps a non-existent &apos;null&apos; exception with a TransactedRuntimeCamelException in TransactionErrorHandler.wrapTransactedRuntimeException() and throws the TRCE, causing the custom error response to be ignored. &lt;/p&gt;

&lt;p&gt;Route looks like:&lt;/p&gt;

&lt;p&gt;		// configure error handler for all routes&lt;br/&gt;
		onException(Exception.class).handled(true).to(&quot;bean:transformerBean?method=exceptionToResponse&quot;).rollback();&lt;/p&gt;

&lt;p&gt;		from(&quot;cxfrs://bean:categoriesEndpoint&quot;).transacted()&lt;br/&gt;
			.choice()...&lt;/p&gt;

&lt;p&gt;Basically the application wants to handle exceptions by sending a custom error message back to the route client, and also mark transactions for rollback. &lt;/p&gt;

&lt;p&gt;Attached patch checks for the presence of an exception, and only raises a TRCE if its not null. &lt;/p&gt;</description>
                <environment>&lt;p&gt;All platforms&lt;/p&gt;</environment>
        <key id="12486899">CAMEL-2102</key>
            <summary>Transacted routes don&apos;t allow custom error handlers to mark exception as handled AND set rollback only</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="dhirajsb">Dhiraj Sureshkumar Bokde</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Oct 2009 21:14:57 +0000</created>
                <updated>Thu, 3 Jun 2010 07:25:03 +0000</updated>
                            <resolved>Mon, 26 Oct 2009 10:37:17 +0000</resolved>
                                    <version>2.0.0</version>
                                    <fixVersion>2.1.0</fixVersion>
                                    <component>camel-spring</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12953168" author="dhirajsb" created="Thu, 22 Oct 2009 21:16:12 +0000"  >&lt;p&gt;Patch for not throwing a TransactedRuntimeCamelException when it has been handled in an error handler. &lt;/p&gt;</comment>
                            <comment id="12953213" author="davsclaus" created="Fri, 23 Oct 2009 07:43:21 +0000"  >&lt;p&gt;Cool&lt;/p&gt;

&lt;p&gt;It would be great if you could also create an unit test that tests this patch.&lt;/p&gt;</comment>
                            <comment id="12951620" author="davsclaus" created="Mon, 26 Oct 2009 10:37:17 +0000"  >&lt;p&gt;trunk: 829746.&lt;/p&gt;

&lt;p&gt;You can now use &lt;tt&gt;.markRollbackOnly()&lt;/tt&gt; to mark a route to rollback and at the same time provide you custom response as you did in your onException&lt;/p&gt;</comment>
                            <comment id="12952191" author="dhirajsb" created="Mon, 26 Oct 2009 18:38:41 +0000"  >&lt;p&gt;Claus, do you still need a testcase or are you going to build one for the new &lt;tt&gt;markRollbackOnly()&lt;/tt&gt;?&lt;/p&gt;</comment>
                            <comment id="12952230" author="davsclaus" created="Mon, 26 Oct 2009 20:10:16 +0000"  >&lt;p&gt;Its fine I used the new markRollbackOnly.&lt;/p&gt;

&lt;p&gt;Can you test the new code on your system?&lt;/p&gt;

&lt;p&gt;And if you have an unit test that you think is good to add then you can attach it.&lt;br/&gt;
You can check the unit tests I added by the commit log and the new added tests from the source. &lt;/p&gt;</comment>
                            <comment id="12956399" author="davsclaus" created="Thu, 3 Jun 2010 07:25:03 +0000"  >&lt;p&gt;Closing old resolved issues&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12486898">CAMEL-2107</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12462988" name="camel-spring-patch.txt" size="835" author="dhirajsb" created="Thu, 22 Oct 2009 21:16:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76635</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01min:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7417</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>