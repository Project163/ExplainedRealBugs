<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:58:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-6309] Sftp upload to subdirectory does not work if home directory is root (&quot;/&quot; or &quot;\&quot;)</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-6309</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;It is not possible to upload a file to a sub directory via sftp if the home directory (the directory where you end up directly after login) is root (&quot;/&quot; or &quot;\&quot;).&lt;/p&gt;

&lt;p&gt;The reason is that after having checked that the sub directory exists (and perhaps created it), Camel tries to go back to the original directory which is &quot;/&quot;. The SftpOperations.changeCurrentDirectory() method calls the FileUtil.compactPath() method that incorrecly changes &quot;/&quot; to &quot;//&quot;. The bug thus resides in the FileUtil class which is part of camel-core.&lt;/p&gt;

&lt;p&gt;I think this bug may cause a number of other errors than the one I have enountered. E g it cannot be possible to change direcotory to &quot;/&quot; at all. And, other protocols (like ftp/ftps) might also be affected.&lt;/p&gt;

&lt;p&gt;This has been discussed on Camel user list:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://camel.465427.n5.nabble.com/Problems-with-sftp-in-Camel-2-11-0-td5731359.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.465427.n5.nabble.com/Problems-with-sftp-in-Camel-2-11-0-td5731359.html&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12644321">CAMEL-6309</key>
            <summary>Sftp upload to subdirectory does not work if home directory is root (&quot;/&quot; or &quot;\&quot;)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ay">Akitoshi Yoshida</assignee>
                                    <reporter username="rodehav">Bengt Rodehav</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Apr 2013 09:27:41 +0000</created>
                <updated>Mon, 29 Jul 2013 13:10:13 +0000</updated>
                            <resolved>Tue, 23 Jul 2013 11:52:56 +0000</resolved>
                                    <version>2.10.2</version>
                    <version>2.10.3</version>
                    <version>2.10.4</version>
                    <version>2.11.0</version>
                                    <fixVersion>2.10.7</fixVersion>
                    <fixVersion>2.11.2</fixVersion>
                    <fixVersion>2.12.0</fixVersion>
                                    <component>camel-ftp</component>
                        <due></due>
                            <votes>3</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13640290" author="rodehav" created="Wed, 24 Apr 2013 09:34:48 +0000"  >&lt;p&gt;When looking closer at the FileUtil.compactPath() method I notice that it uses the normalizePath() method which in turn does some weird checking of operating system to determine what separator to use. This functionality checks the local operating system (where Camel is running) but does not take into account what separator is being used on the remote server (the sftp server in my case).&lt;/p&gt;

&lt;p&gt;The FileUtil class is a generic class that does not know anything about any remote file system&apos;s separator - and I don&apos;t think it should. Therefore, the FileUtil class can&apos;t really be used in SftpOperations since it makes assumptions about separators that it really can&apos;t know anything about.&lt;/p&gt;

&lt;p&gt;I haven&apos;t encountered any erors regarding this yet but it&apos;s easy to see that the logic is failing.&lt;/p&gt;</comment>
                            <comment id="13640342" author="rodehav" created="Wed, 24 Apr 2013 11:08:48 +0000"  >&lt;p&gt;I noticed that FtpOperations also call the FileUtil.compactPath() method. This probably means that ftp/ftps will have the same error as sftp.&lt;/p&gt;</comment>
                            <comment id="13641513" author="rodehav" created="Thu, 25 Apr 2013 07:22:18 +0000"  >&lt;p&gt;Patches for verifying the error (FileUtilTest) and fixing the error (FileUtil).&lt;/p&gt;</comment>
                            <comment id="13641527" author="rodehav" created="Thu, 25 Apr 2013 07:34:00 +0000"  >&lt;p&gt;Uploaded patches for extending the FileUtilTest as well as fixing the problem in FileUtil. In FileUtilTest i added four more asserts in testCompactPath(). All of those failed for me before applying the fix. Note that I added the four asserts both for the &quot;Windows&quot; case and the &quot;non-Windows&quot; case but I have only tested on Windows.&lt;/p&gt;</comment>
                            <comment id="13641530" author="rodehav" created="Thu, 25 Apr 2013 07:42:17 +0000"  >&lt;p&gt;I looked further into the &quot;weird checking of operating systems&quot; that I wrote about in a previous comment. Although I still think it is kind of weird that the normalizePath() method is checking the local operating system to determine what separator to use, I am now of the opinion that it really doesn&apos;t affect the final outcome. This is because the compactPath() method is called with a separator set to &quot;/&quot; which means that the produced path will use &quot;/&quot; as separator even if the normalized path will use &quot;\&quot; (on Windows anyway). So, this probably works.&lt;/p&gt;</comment>
                            <comment id="13706180" author="louisparks" created="Thu, 11 Jul 2013 20:22:04 +0000"  >&lt;p&gt;I do not get this error when connecting to a windows based Filezilla ftp server.  But I do get it when connecting to a RHEL box.&lt;br/&gt;
Has anyone gotten around this?  I would imagine this would affect a lot of people. I know all my FTP routes no longer work.&lt;/p&gt;</comment>
                            <comment id="13715233" author="xandroalmeida" created="Mon, 22 Jul 2013 14:16:20 +0000"  >&lt;p&gt;I encountered this problem using a ftp route .&lt;br/&gt;
The work around for this problem is to add one &quot;/ &quot; in the path of the FTP directory. ex&lt;/p&gt;

&lt;p&gt;/export/home/userone/path =&amp;gt; //export/home/userone/path&lt;/p&gt;</comment>
                            <comment id="13716328" author="ay" created="Tue, 23 Jul 2013 11:52:11 +0000"  >&lt;p&gt;Hi Bengt,&lt;br/&gt;
thanks for the patch and test cases.&lt;br/&gt;
I applied a slightly simpler patch.&lt;br/&gt;
regards, aki&lt;/p&gt;</comment>
                            <comment id="13722435" author="rodehav" created="Mon, 29 Jul 2013 13:10:13 +0000"  >&lt;p&gt;Thanks a lot for fixing Aki!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12580496" name="FileUtil.java.patch" size="566" author="rodehav" created="Thu, 25 Apr 2013 07:22:18 +0000"/>
                            <attachment id="12580497" name="FileUtilTest.java.patch" size="1399" author="rodehav" created="Thu, 25 Apr 2013 07:22:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>324688</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 17 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1k0mv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>325033</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>