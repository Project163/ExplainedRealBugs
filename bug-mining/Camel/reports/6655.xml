<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:04:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-20356] camel-core - LoggerHelper returns wrong name for source code line precise</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-20356</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I noticed that the source for logging and message history was incorrect for this route.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Component
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestRoutes &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; EndpointRouteBuilder {

&#160; &#160; @Override
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void configure() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {

&#160; &#160; &#160; &#160; from(timer(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;).repeatCount(1))
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; .routeId(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; .log(&lt;span class=&quot;code-quote&quot;&gt;&quot;Hello world&quot;&lt;/span&gt;)
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; .throwException(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Exception(&lt;span class=&quot;code-quote&quot;&gt;&quot;Exception message&quot;&lt;/span&gt;)); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The following logging is what I got:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2024-01-22 16:54:19.103 &#160;INFO 19752 --- [ - timer:&lt;span class=&quot;code-comment&quot;&gt;//test] java:15 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;: Hello world
&lt;/span&gt;2024-01-22 16:54:19.108 ERROR 19752 --- [ - timer:&lt;span class=&quot;code-comment&quot;&gt;//test] o.a.c.p.e.DefaultErrorHandler &#160; &#160; &#160; &#160; &#160; &#160;: Failed delivery &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (MessageId: F49EB5D651EC2D3-0000000000000000 on ExchangeId: F49EB5D651EC2D3-0000000000000000). Exhausted after delivery attempt: 1 caught: java.lang.Exception: Exception messageMessage History
&lt;/span&gt;---------------------------------------------------------------------------------------------------------------------------------------
Source &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ID &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Processor &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;Elapsed (ms)
java:13 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;test/test &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;from[timer:&lt;span class=&quot;code-comment&quot;&gt;//test?repeatCount=1] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;632443839
&lt;/span&gt;java:15 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;test/log1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;log &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 2
java:16 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;test/throwException1 &#160; &#160; &#160; &#160; &#160; throwException[java.lang.Exception] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; 0
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Wherever it says: &lt;b&gt;java&lt;/b&gt; I would expect &lt;b&gt;TestRoutes&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;Did some digging on my own and I think it&apos;s because of this piece of code in the LoggerHelper.getLineNumberLoggerName&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// classname so let us only grab the name
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; pos = name.lastIndexOf(&lt;span class=&quot;code-quote&quot;&gt;&apos;.&apos;&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (pos &amp;gt; 0) {
&#160; &#160; name = name.substring(pos + 1);
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The name in this case is &lt;b&gt;TestRoutes.java&lt;/b&gt; and the substring method grabs &lt;b&gt;java&lt;/b&gt; instead of &lt;b&gt;TestRoutes.&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13565681">CAMEL-20356</key>
            <summary>camel-core - LoggerHelper returns wrong name for source code line precise</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="mbergsma">Marco Bergsma</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Jan 2024 16:04:17 +0000</created>
                <updated>Thu, 25 Jan 2024 09:32:41 +0000</updated>
                            <resolved>Wed, 24 Jan 2024 10:00:59 +0000</resolved>
                                    <version>3.20.9</version>
                    <version>3.21.3</version>
                    <version>3.22.0</version>
                    <version>4.3.0</version>
                                    <fixVersion>3.21.5</fixVersion>
                    <fixVersion>3.22.1</fixVersion>
                    <fixVersion>4.0.4</fixVersion>
                    <fixVersion>4.4.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17809568" author="davsclaus" created="Mon, 22 Jan 2024 16:53:49 +0000"  >&lt;p&gt;Can you check 3.21, 3.22 releases source code. And main branch as well.&lt;/p&gt;

&lt;p&gt;You are welcome to work on a patch, as the substring should be (0, pos) instead to grab the before part&lt;/p&gt;</comment>
                            <comment id="17809808" author="mbergsma" created="Tue, 23 Jan 2024 08:53:18 +0000"  >&lt;p&gt;Can confirm the same code is being used in branches 3.21.x, 3.22.x and the main branch. I&apos;ve added a patch to the ticket&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13066199" name="CAMEL-20356 - LoggerHelper.patch" size="764" author="mbergsma" created="Tue, 23 Jan 2024 08:52:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1mx4o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>