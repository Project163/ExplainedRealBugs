<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:25:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-410] Exception handling of the ErrorHandlerSupport class</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-410</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When you configure your route builder and say you want to configure two exceptions lets say: NullPointer and Exception. &lt;/p&gt;

&lt;p&gt;Now say the bean you call as your end point throws a NullPointer, wouldn&apos;t you think the NullPointer policy would handle that exception? &lt;/p&gt;

&lt;p&gt;Well I&apos;m seeing sometimes it does and sometimes it doesn&apos;t due to the map not keeping the exceptions in any particular order.  Is there anyway this could be changed to a LinkedHashMap or a List?&lt;/p&gt;

&lt;p&gt;Issue with class: org.apache.camel.processor.ErrorHandlerSupport&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12484817">CAMEL-410</key>
            <summary>Exception handling of the ErrorHandlerSupport class</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="ddudley">Dan Dudley</reporter>
                        <labels>
                    </labels>
                <created>Fri, 28 Mar 2008 19:51:00 +0000</created>
                <updated>Sun, 6 Jul 2008 06:30:55 +0000</updated>
                            <resolved>Sat, 5 Apr 2008 11:23:27 +0000</resolved>
                                    <version>1.2.0</version>
                    <version>1.3.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                                                            <comments>
                            <comment id="12946574" author="davsclaus" created="Sun, 30 Mar 2008 10:08:40 +0000"  >&lt;p&gt;Dan could you re attach you patch with the license to ASF granted.&lt;br/&gt;
We can not apply patches that we do not hold rights for.&lt;/p&gt;

&lt;p&gt;When you attach a file to an existing ticket there is a tick box to grant this license.&lt;/p&gt;</comment>
                            <comment id="12946642" author="davsclaus" created="Tue, 1 Apr 2008 18:59:59 +0000"  >&lt;p&gt;Dan do you have a snippet of your camel context cofiguration where you have the exce&#229;tions configured.&lt;/p&gt;

&lt;p&gt;I would like to create a unit test that tests this problem.&lt;/p&gt;

&lt;p&gt;Looking at the ErrorHandlerSupport code it would use the first found Exception that isInstanceof so it could potentially find a less specific type exception that was not the best suited.&lt;/p&gt;</comment>
                            <comment id="12946713" author="ddudley" created="Wed, 2 Apr 2008 15:21:27 +0000"  >&lt;p&gt;That&apos;s the problem we are experiencing.  The camel context configuration only encounters this problem sometimes.  I would be more than happy to make a unit test to prove that this is a problem, but it seems to be...impossible since the IdentityHashMap is ignoring the hashcode method and is going directly to a native method to resolve the hashcode.&lt;/p&gt;

&lt;p&gt;If you discover a way to test this and get it consistently to fail I would like to see how you did it.&lt;/p&gt;</comment>
                            <comment id="12946577" author="ddudley" created="Wed, 2 Apr 2008 15:32:28 +0000"  >&lt;p&gt;Here is the unit test I was working on.  It was consistently failing for me, but you may see different results. :0(&lt;/p&gt;</comment>
                            <comment id="12946666" author="davsclaus" created="Wed, 2 Apr 2008 17:48:41 +0000"  >&lt;p&gt;Thanks Dan for the unit test.&lt;/p&gt;

&lt;p&gt;I was also looking for a camel context configuration eg. with the fluent builder (DSL) that demonstrates the use-case with configuration using several exceptions and an exchange between endpoints etc.&lt;/p&gt;

&lt;p&gt;Dan if you have relevant parts of the camel context configuration in question that only encounters the problem sometimes, then please attach this material also.&lt;/p&gt;</comment>
                            <comment id="12946705" author="davsclaus" created="Thu, 3 Apr 2008 04:36:09 +0000"  >&lt;p&gt;Dan I can not get the unit test to fail on my system.&lt;/p&gt;

&lt;p&gt;However I do think we need an example using the DSL configuration to see how the ExecptionType configures the DeadLetterChannel that extends the ErrorHandlerSupport.&lt;br/&gt;
So this is why I am calling for your camel route configuration that only encounters this problem sometimes.&lt;/p&gt;</comment>
                            <comment id="12946578" author="ddudley" created="Thu, 3 Apr 2008 14:48:08 +0000"  >&lt;p&gt;This is our base RouteBuilder that sets up the general error handling.&lt;/p&gt;</comment>
                            <comment id="12946736" author="davsclaus" created="Thu, 3 Apr 2008 18:09:09 +0000"  >&lt;p&gt;Dan, thanks for the new attachment. I can reproduce the bug here. Camel pick ups java.lang.Exception at first even though there is a exact match such as NPE.&lt;/p&gt;</comment>
                            <comment id="12946696" author="davsclaus" created="Thu, 3 Apr 2008 19:44:12 +0000"  >&lt;p&gt;I got something better now that finds the best suited exception type configured for the given thrown exception.&lt;/p&gt;

&lt;p&gt;The code need a little polishing and some more testing.&lt;/p&gt;</comment>
                            <comment id="12946687" author="davsclaus" created="Fri, 4 Apr 2008 07:49:03 +0000"  >&lt;p&gt;Target for 1.3 release&lt;/p&gt;</comment>
                            <comment id="12946728" author="davsclaus" created="Fri, 4 Apr 2008 07:49:31 +0000"  >
&lt;p&gt;I am introducing a strategy to resolve which is the best exception type to handle the thrown exception in questions. The default strategy will be to use the exception that is the closets match to the thrown exception.&lt;/p&gt;

&lt;p&gt;eg. java.net.ConnectionException will match java.io.IOException&lt;br/&gt;
eg. CamelExchangeException will match CamelException&lt;br/&gt;
eg. MyBusinessException will match MyBaseBusinessException&lt;br/&gt;
eg. NullPointerException will match Exception&lt;/p&gt;

&lt;p&gt;Well you might get the picture.&lt;/p&gt;

&lt;p&gt;A different strategy could be to use the ordering of how the exceptions was configured. Use the fist match that can handle it etc (top-down).&lt;/p&gt;</comment>
                            <comment id="12946702" author="davsclaus" created="Sat, 5 Apr 2008 06:26:08 +0000"  >&lt;p&gt;Moving it to 1.4 release.&lt;/p&gt;

&lt;p&gt;1.3 is about to be released really soon.&lt;/p&gt;</comment>
                            <comment id="12946650" author="davsclaus" created="Sat, 5 Apr 2008 11:23:27 +0000"  >&lt;p&gt;Fixed in trunk now wtih wiki documentation at Error Handler and Dead Letter Channel.&lt;/p&gt;

&lt;p&gt;See also the unit tests for details etc.&lt;/p&gt;</comment>
                            <comment id="12947872" author="davsclaus" created="Sun, 6 Jul 2008 06:30:55 +0000"  >&lt;p&gt;Closing 1.4 issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12462415" name="BaseRouteBuilder.java" size="2326" author="ddudley" created="Thu, 3 Apr 2008 14:48:08 +0000"/>
                            <attachment id="12462340" name="ErrorHandlerSupportTest.java" size="1385" author="ddudley" created="Wed, 2 Apr 2008 15:32:28 +0000"/>
                            <attachment id="12462339" name="patch.txt" size="1124" author="ddudley" created="Mon, 31 Mar 2008 14:49:55 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12485192">CAMEL-440</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>83133</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 21 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01c27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5723</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>