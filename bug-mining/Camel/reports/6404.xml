<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:00:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-19136] camel-micrometer - Too many tags created by micrometer WebMvcTagsProvider</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-19136</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;From discussion&#160; in zulip &lt;a href=&quot;https://camel.zulipchat.com/#narrow/stream/257298-camel/topic/springboot.20micrometer.20http.20metrics.20issue/near/340948367&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://camel.zulipchat.com/#narrow/stream/257298-camel/topic/springboot.20micrometer.20http.20metrics.20issue/near/340948367&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;in &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-18754&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CAMEL-18754&lt;/a&gt; &lt;a href=&quot;https://github.com/apache/camel-spring-boot/commit/ac318f0418e55c56d0fb426607c67a5ceb1f6742&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel-spring-boot/commit/ac318f0418e55c56d0fb426607c67a5ceb1f6742&lt;/a&gt; new configuration has been introduced &lt;tt&gt;MicrometerTagsAutoConfiguration&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Request &lt;tt&gt;uri&lt;/tt&gt; with placeholders in the metrics tag is replaced with actual value e.g.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 @RequestMapping(value = &lt;span class=&quot;code-quote&quot;&gt;&quot;/users/{id}&quot;&lt;/span&gt; method = RequestMethod.GET)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;instead of &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
http_server_requests_seconds_bucket{application=&lt;span class=&quot;code-quote&quot;&gt;&quot;my-app&quot;&lt;/span&gt;,exception=&lt;span class=&quot;code-quote&quot;&gt;&quot;None&quot;&lt;/span&gt;,method=&lt;span class=&quot;code-quote&quot;&gt;&quot;GET&quot;&lt;/span&gt;,outcome=&lt;span class=&quot;code-quote&quot;&gt;&quot;SUCCESS&quot;&lt;/span&gt;,status=&lt;span class=&quot;code-quote&quot;&gt;&quot;200&quot;&lt;/span&gt;,uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;/users/{id}&quot;&lt;/span&gt;,le=&lt;span class=&quot;code-quote&quot;&gt;&quot;0.894784851&quot;&lt;/span&gt;,} 9999.0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;is reported as &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
http_server_requests_seconds_bucket{application=&lt;span class=&quot;code-quote&quot;&gt;&quot;my-app&quot;&lt;/span&gt;,exception=&lt;span class=&quot;code-quote&quot;&gt;&quot;None&quot;&lt;/span&gt;,method=&lt;span class=&quot;code-quote&quot;&gt;&quot;GET&quot;&lt;/span&gt;,outcome=&lt;span class=&quot;code-quote&quot;&gt;&quot;SUCCESS&quot;&lt;/span&gt;,status=&lt;span class=&quot;code-quote&quot;&gt;&quot;200&quot;&lt;/span&gt;,uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;/users/1&quot;&lt;/span&gt;,le=&lt;span class=&quot;code-quote&quot;&gt;&quot;0.894784851&quot;&lt;/span&gt;,} 1.0
http_server_requests_seconds_bucket{application=&lt;span class=&quot;code-quote&quot;&gt;&quot;my-app&quot;&lt;/span&gt;,exception=&lt;span class=&quot;code-quote&quot;&gt;&quot;None&quot;&lt;/span&gt;,method=&lt;span class=&quot;code-quote&quot;&gt;&quot;GET&quot;&lt;/span&gt;,outcome=&lt;span class=&quot;code-quote&quot;&gt;&quot;SUCCESS&quot;&lt;/span&gt;,status=&lt;span class=&quot;code-quote&quot;&gt;&quot;200&quot;&lt;/span&gt;,uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;/users/2&quot;&lt;/span&gt;,le=&lt;span class=&quot;code-quote&quot;&gt;&quot;0.894784851&quot;&lt;/span&gt;,} 1.0
http_server_requests_seconds_bucket{application=&lt;span class=&quot;code-quote&quot;&gt;&quot;my-app&quot;&lt;/span&gt;,exception=&lt;span class=&quot;code-quote&quot;&gt;&quot;None&quot;&lt;/span&gt;,method=&lt;span class=&quot;code-quote&quot;&gt;&quot;GET&quot;&lt;/span&gt;,outcome=&lt;span class=&quot;code-quote&quot;&gt;&quot;SUCCESS&quot;&lt;/span&gt;,status=&lt;span class=&quot;code-quote&quot;&gt;&quot;200&quot;&lt;/span&gt;,uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;/users/3&quot;&lt;/span&gt;,le=&lt;span class=&quot;code-quote&quot;&gt;&quot;0.894784851&quot;&lt;/span&gt;,} 1.0
http_server_requests_seconds_bucket{application=&lt;span class=&quot;code-quote&quot;&gt;&quot;my-app&quot;&lt;/span&gt;,exception=&lt;span class=&quot;code-quote&quot;&gt;&quot;None&quot;&lt;/span&gt;,method=&lt;span class=&quot;code-quote&quot;&gt;&quot;GET&quot;&lt;/span&gt;,outcome=&lt;span class=&quot;code-quote&quot;&gt;&quot;SUCCESS&quot;&lt;/span&gt;,status=&lt;span class=&quot;code-quote&quot;&gt;&quot;200&quot;&lt;/span&gt;,uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;/users/999999&quot;&lt;/span&gt;,le=&lt;span class=&quot;code-quote&quot;&gt;&quot;0.894784851&quot;&lt;/span&gt;,} 1.0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and of course will end up a lot of tags which is bad for prometheus.&lt;/p&gt;

&lt;p&gt;and spring reports warning&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
logger_name     org.springframework.boot.actuate.autoconfigure.metrics.OnlyOnceLoggingDenyMeterFilter
message     Reached the maximum number of URI tags &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;http.server.requests&apos;&lt;/span&gt;.
How can we preserve original uri tag? We combine camel with spring boot, so &lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt; api layer is provided by spring boot but integration layer (messaging, http client etc.. ) is done by camel, so would love to keep camel route stats but keep spring boot reported metrics
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;basically&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Bean
    WebMvcTagsProvider webMvcTagsProvider() {
....
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Tags.concat(
                        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.getTags(request, response, handler, exception),
                        Tags.of(Tag.of(&lt;span class=&quot;code-quote&quot;&gt;&quot;uri&quot;&lt;/span&gt;, uri))
                );
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;makes out of &lt;tt&gt;/users/{id&lt;/tt&gt;} -&amp;gt; &lt;tt&gt;/users/1&lt;/tt&gt;&lt;br/&gt;
by excluding &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@SpringBootApplication(exclude = {MicrometerTagsAutoConfiguration.class}) 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;we get the original behavior. But the risk is that if future versions add more beans into MicrometerTagsAutoConfiguration they will be ignored&lt;/p&gt;

&lt;p&gt;How can we preserve original uri tag or make it configurable?&lt;br/&gt;
may be regex/whitelist/blacklist on which it should apply?&#160;&lt;/p&gt;




&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13528136">CAMEL-19136</key>
            <summary>camel-micrometer - Too many tags created by micrometer WebMvcTagsProvider</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="Mustermann">Max</reporter>
                        <labels>
                    </labels>
                <created>Sun, 12 Mar 2023 19:41:50 +0000</created>
                <updated>Tue, 3 Dec 2024 12:33:17 +0000</updated>
                            <resolved>Sat, 18 Mar 2023 11:08:24 +0000</resolved>
                                    <version>3.20.0</version>
                    <version>3.20.1</version>
                    <version>3.20.2</version>
                                    <fixVersion>3.20.3</fixVersion>
                    <fixVersion>3.21.0</fixVersion>
                    <fixVersion>4.0-M3</fixVersion>
                    <fixVersion>4.0.0</fixVersion>
                                    <component>camel-micrometer</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17702105" author="davsclaus" created="Sat, 18 Mar 2023 11:08:24 +0000"  >&lt;p&gt;Okay its turned off and you can enable it&lt;/p&gt;

&lt;p&gt;camel.metrics.uriTagEnabled=true&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13529064">CAMEL-19168</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13600709">CAMEL-21504</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13505755">CAMEL-18754</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 34 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1giow:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>