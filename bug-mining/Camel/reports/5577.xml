<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:45:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-16104] ProducerCache does not close producers when cacheSize is 1 (potential memory leak)</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-16104</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I&apos;m using a route with a dynamic endpoint using toD and a cache size of 1.&lt;/p&gt;

&lt;p&gt;In my case, the dynamic URI changes once a day. When the day changes, I want a new producer to be created and the old one closed.&lt;/p&gt;

&lt;p&gt;However, the new producer is correctly created but the old one is not closed.&lt;/p&gt;

&lt;p&gt;When I use a cache size of 2, then when the day ends two new producers are created and the two old ones are closed correctly.&lt;/p&gt;

&lt;p&gt;I&apos;ve tracked down the problem to the last line of the ServicePool constructor, where a LRU cache is created only if the cache size is greater than one. This LRU cache is the one calling the evict method, so when there is no cache there is no eviction on the ServicePool used by the ProducerCache.&lt;/p&gt;

&lt;p&gt;Using the debugger, i confirmed that the service pool contains two producers even though its capacity is 1. I&apos;m afraid this could be a memory leak.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure of the best way to resolve this, but it&apos;s a problem for me because if the producer is not closed, then an operation I need is note performed (I&apos;m using the HDFS component, and it needs to rename a file when the producer is closed. Currently, the file is not renamed and I&apos;m afraid some data is not flushed to the server)&lt;/p&gt;

&lt;p&gt;I hope I was clear, please do ask if there is something unclear in my description of the problem.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13355234">CAMEL-16104</key>
            <summary>ProducerCache does not close producers when cacheSize is 1 (potential memory leak)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="BenoitAverty">Benoit AVERTY</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Jan 2021 16:29:45 +0000</created>
                <updated>Fri, 29 Jan 2021 08:53:30 +0000</updated>
                            <resolved>Fri, 29 Jan 2021 08:53:30 +0000</resolved>
                                    <version>3.3.0</version>
                    <version>3.7.1</version>
                                    <fixVersion>3.7.2</fixVersion>
                    <fixVersion>3.8.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17273832" author="ancosen" created="Thu, 28 Jan 2021 16:30:56 +0000"  >&lt;p&gt;Please try with Camel 3.7.1, which is an LTS release. 3.3.0 was a development release.&lt;/p&gt;</comment>
                            <comment id="17273838" author="benoitaverty" created="Thu, 28 Jan 2021 16:39:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=acosentino&quot; class=&quot;user-hover&quot; rel=&quot;acosentino&quot;&gt;acosentino&lt;/a&gt;Thanks for your answer. The problem seems to be the same with camel 3.7.1.&lt;/p&gt;</comment>
                            <comment id="17274249" author="davsclaus" created="Fri, 29 Jan 2021 08:53:30 +0000"  >&lt;p&gt;Thanks for the detailed report&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 41 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0n3io:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>