<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:53:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-17751] camel-saga - LRASagaService does not proceed to completion or compensation routes</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-17751</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When using LRASagaService for a saga, neither the completion or compensation routes are being triggered correctly.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The last version that the behaviour was correct seems to be v3.7.2&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;A project replicating the error can be found in &lt;a href=&quot;https://github.com/vagpap/camel-lra-example/tree/camel-3.14.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;GitHub&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The same project, with working v3.7.2, is located in branch&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/vagpap/camel-lra-example/tree/camel-3.14.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;camel-3.7.2.&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Narayana v5.12.x was used as the transaction manager in both versions.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13432177">CAMEL-17751</key>
            <summary>camel-saga - LRASagaService does not proceed to completion or compensation routes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="vagpap">Vangelis Papanastasatos</reporter>
                        <labels>
                    </labels>
                <created>Sat, 5 Mar 2022 15:45:40 +0000</created>
                <updated>Sun, 6 Mar 2022 18:14:35 +0000</updated>
                            <resolved>Sun, 6 Mar 2022 18:14:35 +0000</resolved>
                                    <version>3.14.1</version>
                                    <fixVersion>3.14.3</fixVersion>
                    <fixVersion>3.16.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17501762" author="JIRAUSER286188" created="Sat, 5 Mar 2022 15:56:22 +0000"  >&lt;p&gt;When setting logging level to DEBUG, the following log entries were observed:&lt;/p&gt;

&lt;p&gt;&lt;b&gt;v3.7.2&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;2022-03-05 17:21:13.429 DEBUG 37992 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; o.a.coyote.http11.Http11InputBuffer &#160; &#160; &#160;: Received [PUT /api/lra-participant/complete?Camel-Saga-Compensate=direct://sagaCompensated&amp;amp;Camel-Saga-Complete=direct://sagaCompleted HTTP/1.1&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Content-Type: text/plain&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Long-Running-Action: &lt;a href=&quot;http://localhost:50000/lra-coordinator/0_ffffc0a80165_caf4_62236d7c_191&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:50000/lra-coordinator/0_ffffc0a80165_caf4_62236d7c_191&lt;/a&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Long-Running-Action-Recovery: &lt;a href=&quot;http://localhost:50000/lra-coordinator/recoveryhttp%3A%2F%2Flocalhost%3A50000%2Flra-coordinator%2F0_ffffc0a80165_caf4_62236d7c_191/0_ffffc0a80165_caf4_62236d7c_193&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:50000/lra-coordinator/recoveryhttp%3A%2F%2Flocalhost%3A50000%2Flra-coordinator%2F0_ffffc0a80165_caf4_62236d7c_191/0_ffffc0a80165_caf4_62236d7c_193&lt;/a&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Content-Length: 0&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Host: localhost:8080&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Connection: Keep-Alive&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;User-Agent: Apache-HttpClient/4.5.12 (Java/11.0.7)&lt;/tt&gt;&lt;tt&gt;]&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:21:13.430 DEBUG 37992 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; org.apache.tomcat.util.http.Parameters &#160; : Set query string encoding to UTF-8&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:21:13.431 DEBUG 37992 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; o.a.c.authenticator.AuthenticatorBase &#160; &#160;: Security checking request PUT /api/lra-participant/complete&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:21:13.431 DEBUG 37992 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; org.apache.catalina.realm.RealmBase &#160; &#160; &#160;: &#160; No applicable constraints defined&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:21:13.431 DEBUG 37992 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; o.a.c.authenticator.AuthenticatorBase &#160; &#160;: Not subject to any constraint&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:21:13.432 DEBUG 37992 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; org.apache.tomcat.util.http.Parameters &#160; : Set encoding to UTF-8&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:21:13.433 DEBUG 37992 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; org.apache.tomcat.util.http.Parameters &#160; : Decoding query null UTF-8&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:21:13.433 DEBUG 37992 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; org.apache.tomcat.util.http.Parameters &#160; : Start processing with input &lt;span class=&quot;error&quot;&gt;&amp;#91;Camel-Saga-Compensate=direct://sagaCompensated&amp;amp;Camel-Saga-Complete=direct://sagaCompleted&amp;#93;&lt;/span&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:21:13.434 DEBUG 37992 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; o.a.camel.processor.FilterProcessor &#160; &#160; &#160;: &lt;b&gt;Filter matches: true for exchange: Exchange[]&lt;/b&gt;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&lt;b&gt;v3.14.2&lt;/b&gt;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;2022-03-05 17:50:41.563 DEBUG 43808 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; o.a.coyote.http11.Http11InputBuffer &#160; &#160; &#160;: Received [PUT /api/lra-participant/complete?Camel-Saga-Compensate=direct://sagaCompensated&amp;amp;Camel-Saga-Complete=direct://sagaCompleted HTTP/1.1&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Content-Type: text/plain&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Long-Running-Action: &lt;a href=&quot;http://localhost:50000/lra-coordinator/0_ffffc0a80165_caf4_62236d7c_1a7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:50000/lra-coordinator/0_ffffc0a80165_caf4_62236d7c_1a7&lt;/a&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Long-Running-Action-Recovery: &lt;a href=&quot;http://localhost:50000/lra-coordinator/recoveryhttp%3A%2F%2Flocalhost%3A50000%2Flra-coordinator%2F0_ffffc0a80165_caf4_62236d7c_1a7/0_ffffc0a80165_caf4_62236d7c_1a9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:50000/lra-coordinator/recoveryhttp%3A%2F%2Flocalhost%3A50000%2Flra-coordinator%2F0_ffffc0a80165_caf4_62236d7c_1a7/0_ffffc0a80165_caf4_62236d7c_1a9&lt;/a&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Content-Length: 0&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Host: localhost:8080&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;Connection: Keep-Alive&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;User-Agent: Apache-HttpClient/4.5.12 (Java/11.0.7)&lt;/tt&gt;&lt;tt&gt;]&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:50:41.564 DEBUG 43808 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; org.apache.tomcat.util.http.Parameters &#160; : Set query string encoding to UTF-8&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:50:41.564 DEBUG 43808 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; o.a.c.authenticator.AuthenticatorBase &#160; &#160;: Security checking request PUT /api/lra-participant/complete&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:50:41.565 DEBUG 43808 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; org.apache.catalina.realm.RealmBase &#160; &#160; &#160;: &#160; No applicable constraints defined&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:50:41.566 DEBUG 43808 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; o.a.c.authenticator.AuthenticatorBase &#160; &#160;: Not subject to any constraint&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:50:41.567 DEBUG 43808 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; org.apache.tomcat.util.http.Parameters &#160; : Set encoding to UTF-8&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:50:41.568 DEBUG 43808 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; org.apache.tomcat.util.http.Parameters &#160; : Decoding query null UTF-8&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:50:41.568 DEBUG 43808 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; org.apache.tomcat.util.http.Parameters &#160; : Start processing with input &lt;span class=&quot;error&quot;&gt;&amp;#91;Camel-Saga-Compensate=direct://sagaCompensated&amp;amp;Camel-Saga-Complete=direct://sagaCompleted&amp;#93;&lt;/span&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;2022-03-05 17:50:41.568 DEBUG 43808 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;nio-8080-exec-3&amp;#93;&lt;/span&gt; o.a.camel.processor.FilterProcessor &#160; &#160; &#160;: &lt;b&gt;Filter matches: false for exchange: Exchange[]&lt;/b&gt;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In both of the cases, the predicate that the filter tried to match is&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;header(Camel-Saga-Complete) is not null&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Narayana in both cases sends the following request:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;PUT /api/lra-participant/complete?Camel-Saga-Compensate=direct://sagaCompensated&amp;amp;Camel-Saga-Complete=direct://sagaCompleted&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;It seems that the query parameters are not correctly parsed and added as headers in the exchange, thus the filter is failing to match. Header CamelHttpQuery contains correctly the values.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 36 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z107h4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>