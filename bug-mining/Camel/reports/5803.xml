<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:48:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-16811] Cannot consume messages from sjms2 endpoint with deliveryMode set</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-16811</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;(Note: The component in question should be camel-sjms2, but that was not an option in the component list.)&lt;/p&gt;

&lt;p&gt;Messages cannot be consumed from an sjms2 endpoint with a delivery mode query parameter specified.&lt;/p&gt;

&lt;p&gt;To reproduce this issue, I was using InOnlyQueueProducerTest in both the camel-sjms and camel-sjms2 components. In both tests, I changed the first producer endpoint URI to the following (where component is sjms and sjms2, respectively):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.to(&lt;span class=&quot;code-quote&quot;&gt;&quot;[sjms,sjms2]:queue:&quot;&lt;/span&gt; + TEST_DESTINATION_NAME + &lt;span class=&quot;code-quote&quot;&gt;&quot;?deliveryMode=1&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The sjms test continues to succeed, but the sjms2 test fails due to the consumer not receiving the message before timing out.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I could not determine a root cause, but as a workaround, I did discover that manually setting the JMSDeliveryMode header in the route or in the send call did work as expected.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13390772">CAMEL-16811</key>
            <summary>Cannot consume messages from sjms2 endpoint with deliveryMode set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="sgalla">Shannon Gallagher</reporter>
                        <labels>
                    </labels>
                <created>Mon, 19 Jul 2021 20:08:41 +0000</created>
                <updated>Fri, 30 Jul 2021 08:46:18 +0000</updated>
                            <resolved>Fri, 30 Jul 2021 08:46:18 +0000</resolved>
                                    <version>3.8.0</version>
                                    <fixVersion>3.11.1</fixVersion>
                    <fixVersion>3.12.0</fixVersion>
                                    <component>camel-sjms</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17383585" author="sgalla" created="Mon, 19 Jul 2021 21:06:40 +0000"  >&lt;p&gt;Upon further investigation, I did find that I can consume a message from an sjms2 endpoint with deliveryMode specified, if I also set timeToLive.&lt;/p&gt;

&lt;p&gt;I&apos;m not sure if this is by design in the camel component or JMS 2.0, but I did not see any documentation indicating that I needed to set timeToLive in conjunction with deliveryMode.&lt;/p&gt;

&lt;p&gt;I suppose this may be a non-issue if that is by design&lt;/p&gt;</comment>
                            <comment id="17390353" author="davsclaus" created="Fri, 30 Jul 2021 07:16:14 +0000"  >&lt;p&gt;What message broker are you using, and what exact version is that.&lt;/p&gt;

&lt;p&gt;ActiveMQ v5 vs Artemis has a difference, and why the unit test of camel-sjms vs camel-sjms2 works differently.&lt;/p&gt;</comment>
                            <comment id="17390414" author="davsclaus" created="Fri, 30 Jul 2021 08:20:45 +0000"  >&lt;p&gt;Okay found a problem that the time to live was mistakenly used as -1 value, which Artemis handles differently than ActiveMQ v5. So adding a fix there.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0t528:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>