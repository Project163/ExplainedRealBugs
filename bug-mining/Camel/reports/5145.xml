<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:39:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-14332] camel-blueprint - Camel route does not consider the value of ShutdownStrategy timeout.</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-14332</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;In an OSGI context when Blueprint framework is used, if the shutdown strategy timeout is greater than one minute, the timeout is not effective.&lt;/p&gt;

&lt;p&gt;When the bundle is stopping, this is the call chain:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;BlueprintEventDispatcher (timeout 1 minute) --&amp;gt; BlueprintCamelContext.blueprintEvent --&amp;gt; BlueprintCamelContext.stop (timeout 5 minute by default)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So when the Shutdown strategy timeout is longer than one minute, the &lt;a href=&quot;https://github.com/apache/aries/blob/ee16fd21f22624947a991c80503d819424497567/blueprint/blueprint-core/src/main/java/org/apache/aries/blueprint/container/BlueprintEventDispatcher.java#L188-L193&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;BlueprintEventDispatcher timeout &lt;/a&gt;is triggered for first, making the shutdown strategy useless.&lt;/p&gt;

&lt;p&gt;The solution to this, is to remove the piece of code that handle the destroy event from &lt;a href=&quot;https://github.com/apache/camel/blob/568f9a1e0b0e8765bb4ff8a0f82b83dd85eeae24/components/camel-blueprint/src/main/java/org/apache/camel/blueprint/BlueprintCamelContext.java#L187-L194&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;BlueprintCamelContext&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13276231">CAMEL-14332</key>
            <summary>camel-blueprint - Camel route does not consider the value of ShutdownStrategy timeout.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jbonofre">Jean-Baptiste Onofr&#233;</assignee>
                                    <reporter username="ldemasi">Luigi De Masi</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Dec 2019 13:24:34 +0000</created>
                <updated>Wed, 2 Dec 2020 15:00:45 +0000</updated>
                            <resolved>Mon, 6 Jan 2020 09:27:02 +0000</resolved>
                                    <version>2.24.2</version>
                    <version>3.0.0</version>
                                    <fixVersion>3.0.1</fixVersion>
                    <fixVersion>2.25.0</fixVersion>
                    <fixVersion>3.1.0</fixVersion>
                                    <component>camel-blueprint</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="17004051" author="davsclaus" created="Fri, 27 Dec 2019 09:57:22 +0000"  >&lt;p&gt;Ah okay, yeah its maybe a trade-off with Camel shutdown is 5 minutes (too long) and blueprint having a limit of 1 min.&lt;/p&gt;
</comment>
                            <comment id="17004151" author="davsclaus" created="Fri, 27 Dec 2019 12:18:46 +0000"  >&lt;p&gt;Okay but blueprint is calling the destroy method first when its stopping right? So its already being stopped before that timeout triggers?&lt;/p&gt;
</comment>
                            <comment id="17004152" author="davsclaus" created="Fri, 27 Dec 2019 12:20:25 +0000"  >&lt;p&gt;And this also implies that if Camel takes &amp;gt; 1 minute to stop then this blueprint timeout is triggered, that then calls stop yet again (which wont hurt as camel is already stopping). So where is the issue/bug really?&lt;/p&gt;</comment>
                            <comment id="17006734" author="ldemasi" created="Thu, 2 Jan 2020 11:09:36 +0000"  >&lt;p&gt;What is happening is that when the blueprint timeout is triggered, the ShutdownStrategy is forced to shutdown earlier than its deadline so user defined or default timeout is not effective when it&apos;s longer than one minute.&lt;/p&gt;</comment>
                            <comment id="17008668" author="davsclaus" created="Mon, 6 Jan 2020 09:26:51 +0000"  >&lt;p&gt;Okay then lets try this&lt;/p&gt;</comment>
                            <comment id="17242414" author="jbonofre" created="Wed, 2 Dec 2020 15:00:45 +0000"  >&lt;p&gt;Is it really an issue or just a configuration issue between blueprint timeout and camel shutdown strategy ?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13337245">CAMEL-15760</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13276580">CAMEL-14336</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 49 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09yww:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>