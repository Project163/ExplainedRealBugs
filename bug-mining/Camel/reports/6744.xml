<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:05:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-20521] camel-amqp - AMQP publisher application is losing messages with local JMS transaction enabled</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-20521</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;camel-amqp with local transaction enabled loses messages because to invoke the commit, it uses a spring-jms routine that catch and ignore a couple of exceptions that occurs and should not be ignored:&lt;br/&gt;
In &lt;tt&gt;org.apache.camel.component.jms.JmsConfiguration.CamelJmsTemplate&lt;/tt&gt; :&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13067291/13067291_screenshot-1.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;that calls &lt;tt&gt;org.springframework.jms.support.JmsUtils&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13067296/13067296_screenshot-2.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;In the comment it says that &lt;tt&gt;jakarta.jms.TransactionInProgressException&lt;/tt&gt; and &lt;tt&gt;jakarta.jms.IllegalStateException&lt;/tt&gt; can only happen in case of a JTA transaction but it can happens &lt;br/&gt;
also in case of connection problems:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
javax.jms.IllegalStateException: The Session is closed
	at org.apache.qpid.jms.JmsSession.checkClosed(JmsSession.java:1113)
	at org.apache.qpid.jms.JmsSession.getTransacted(JmsSession.java:213)
	at org.messaginghub.pooled.jms.JmsPoolSession.getTransacted(JmsPoolSession.java:256)
	at nl.ns.hip.cci.jms.CamelJmsTemplate.doSendToDestination(CamelJmsTemplate.java:94)
	at nl.ns.hip.cci.jms.CamelJmsTemplate.lambda$send$0(CamelJmsTemplate.java:33)
	at org.springframework.jms.core.JmsTemplate.execute(JmsTemplate.java:504)
	at nl.ns.hip.cci.jms.CamelJmsTemplate.send(CamelJmsTemplate.java:31)
	at org.apache.camel.component.jms.JmsProducer.doSend(JmsProducer.java:425)
	at org.apache.camel.component.jms.JmsProducer.processInOnly(JmsProducer.java:392)
	at org.apache.camel.component.jms.JmsProducer.process(JmsProducer.java:159)
	at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:172)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.doRun(RedeliveryErrorHandler.java:818)
	at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$RedeliveryTask.run(RedeliveryErrorHandler.java:726)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:181)
	at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:59)
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:165)
	at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:392)
	at org.apache.camel.component.seda.SedaConsumer.sendToConsumers(SedaConsumer.java:269)
	at org.apache.camel.component.seda.SedaConsumer.doRun(SedaConsumer.java:187)
	at org.apache.camel.component.seda.SedaConsumer.run(SedaConsumer.java:130)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:829)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13570933">CAMEL-20521</key>
            <summary>camel-amqp - AMQP publisher application is losing messages with local JMS transaction enabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ldemasi">Luigi De Masi</assignee>
                                    <reporter username="ldemasi">Luigi De Masi</reporter>
                        <labels>
                    </labels>
                <created>Wed, 6 Mar 2024 08:00:31 +0000</created>
                <updated>Fri, 26 Apr 2024 04:00:18 +0000</updated>
                            <resolved>Mon, 15 Apr 2024 07:31:28 +0000</resolved>
                                    <version>3.20.9</version>
                    <version>3.22.1</version>
                    <version>4.0.4</version>
                    <version>4.4.0</version>
                                    <fixVersion>3.21.5</fixVersion>
                    <fixVersion>3.22.2</fixVersion>
                    <fixVersion>4.0.5</fixVersion>
                    <fixVersion>4.4.2</fixVersion>
                    <fixVersion>4.6.0</fixVersion>
                                    <component>camel-amqp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17829849" author="davsclaus" created="Fri, 22 Mar 2024 12:02:57 +0000"  >&lt;p&gt;This will be fixed by spring-jms, so we are awaiting they will do releases&lt;/p&gt;</comment>
                            <comment id="17831753" author="davsclaus" created="Thu, 28 Mar 2024 12:13:45 +0000"  >&lt;p&gt;there is new spring frameworks on the way in about 2 weeks that has this fix&lt;/p&gt;</comment>
                            <comment id="17836773" author="davsclaus" created="Sat, 13 Apr 2024 07:01:46 +0000"  >&lt;p&gt;We need to upgrade spring in the 4.0.x 3.22.x and 3.21.x branches. PRs is weclome&lt;/p&gt;</comment>
                            <comment id="17836979" author="davsclaus" created="Sun, 14 Apr 2024 16:48:46 +0000"  >&lt;p&gt;In the original PR we have merged the unit tests for main branch. What is outstanding is to upgrade spring in the LTS branches&lt;/p&gt;</comment>
                            <comment id="17837069" author="davsclaus" created="Mon, 15 Apr 2024 05:41:01 +0000"  >&lt;p&gt;TODO: main &lt;b&gt;DONE&lt;/b&gt;&lt;br/&gt;
TODO: 4.4.x &lt;b&gt;DONE&lt;/b&gt;&lt;br/&gt;
TODO: 4.0.x &lt;b&gt;DONE&lt;/b&gt;&lt;br/&gt;
TODO: 3.22.x &lt;b&gt;DONE&lt;/b&gt;&lt;br/&gt;
TODO: 3.21.x &lt;b&gt;DONE&lt;/b&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13571587">CAMEL-20553</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13067291" name="screenshot-1.png" size="57358" author="ldemasi" created="Wed, 6 Mar 2024 08:05:21 +0000"/>
                            <attachment id="13067296" name="screenshot-2.png" size="39230" author="ldemasi" created="Wed, 6 Mar 2024 08:27:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 30 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1nt1s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>