<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:07:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-21199] Camel-jackson not properly marshalling 4-byte characters</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-21199</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Camel-jackson doesn&apos;t handle 4-byte characters well. Marshalling a 4-byte Japanese kanji character results in two UTF-16 escapes to be written instead of the character itself. While this is ok for emoji an such, it&apos;s not for natural languages.&lt;/p&gt;

&lt;p&gt;Jackson issue:&#160;&lt;a href=&quot;https://github.com/FasterXML/jackson-core/issues/223&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;FasterXML/jackson-core#223&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Reproducer:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
from(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:data?file-name=input.txt&amp;amp;noop=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;)
    .log(&lt;span class=&quot;code-quote&quot;&gt;&quot;${body}&quot;&lt;/span&gt;)
    .unmarshal().json(JsonLibrary.Jackson)
    .log(&lt;span class=&quot;code-quote&quot;&gt;&quot;${body[0][&lt;span class=&quot;code-quote&quot;&gt;&apos;name&apos;&lt;/span&gt;]}&quot;&lt;/span&gt;)
    .marshal().json(JsonLibrary.Jackson, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;)
    .log(&lt;span class=&quot;code-quote&quot;&gt;&quot;${body}&quot;&lt;/span&gt;); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;br/&gt;
with the file input.txt containing:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&#12471;&#12473;&#12486;&#12512;&#171581;&quot;&lt;/span&gt;}] &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Expected output seen in the log: &lt;b&gt;&quot;&#12471;&#12473;&#12486;&#12512;&#171581;&quot;&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Actual output seen in the log:&#160;&lt;b&gt;&quot;&#12471;&#12473;&#12486;&#12512;\uD867\uDE3D&quot;&lt;/b&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13591790">CAMEL-21199</key>
            <summary>Camel-jackson not properly marshalling 4-byte characters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rnetuka">Radovan Netuka</assignee>
                                    <reporter username="rnetuka">Radovan Netuka</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Sep 2024 11:40:46 +0000</created>
                <updated>Thu, 17 Oct 2024 13:30:13 +0000</updated>
                            <resolved>Wed, 25 Sep 2024 14:19:57 +0000</resolved>
                                                    <fixVersion>4.9.0</fixVersion>
                                    <component>camel-jackson</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17880946" author="rnetuka" created="Wed, 11 Sep 2024 11:44:39 +0000"  >&lt;p&gt;It&apos;s problem of Jackson-core&apos;s&#160;&lt;em&gt;UTF8JsonGenerator&lt;/em&gt;. Their other generator - &lt;em&gt;WriterBasedJsonGenerator&lt;/em&gt; - doesn&apos;t seem to suffer from this issue.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;While it&apos;d be great to have this fixed on Jackson side, they keep the issue open from 2015 and rejected several PRs which were trying to provide a fix.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;PR bellow tries to avoid the issue by forcing Jackson to use &lt;em&gt;WriterBasedJsonGenerator.&lt;/em&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;PR:&lt;/p&gt;

&lt;p&gt;&lt;del&gt;&lt;a href=&quot;https://github.com/apache/camel/pull/15515&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/15515&lt;/a&gt;&lt;/del&gt;&lt;/p&gt;

&lt;p&gt;^ Closed as there will be (better) replacement utilizing a newly added Jackson option&lt;/p&gt;</comment>
                            <comment id="17882715" author="rnetuka" created="Wed, 18 Sep 2024 13:42:16 +0000"  >&lt;p&gt;Fixed in Jackson 2.18.0 - &lt;a href=&quot;https://github.com/FasterXML/jackson-core/pull/1335.&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/FasterXML/jackson-core/pull/1335.&lt;/a&gt; Once we upgrade to that version, all that needs to be done is to enable the new option (in Jackson) COMBINE_UNICODE_SURROGATES_IN_UTF8.&lt;/p&gt;</comment>
                            <comment id="17882723" author="davsclaus" created="Wed, 18 Sep 2024 13:53:58 +0000"  >&lt;p&gt;Thanks for getting this into jackson itself (best place).&lt;/p&gt;

&lt;p&gt;It will take a while as we need Spring Boot and Quarkus to also upgrade to jackson 2.18.x&lt;/p&gt;</comment>
                            <comment id="17884628" author="davsclaus" created="Wed, 25 Sep 2024 14:19:57 +0000"  >&lt;p&gt;Added your unit test with useWriter.&lt;/p&gt;

&lt;p&gt;When Jackson 2.18 is released then we can add an option in Camel to configure this new option, and deprecate useWriter option.&lt;/p&gt;</comment>
                            <comment id="17889629" author="rnetuka" created="Tue, 15 Oct 2024 11:52:05 +0000"  >&lt;p&gt;PR: &lt;a href=&quot;https://github.com/apache/camel/pull/15958&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/15958&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://github.com/FasterXML/jackson-core/issues/223]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1rd4w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>