<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:47:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-16530] AWS2-S3 component does not recognize or use proxy-host and proxy-port from application.properties</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-16530</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;when attempting to use AWS2 S3 resources via a proxy host and port, the configuration specified in the application.properties file is ignored. You can enter anything there as&lt;/p&gt;

&lt;p&gt;camel.component.aws2-s3.proxy-host=url.of.my.proxy&lt;br/&gt;
camel.component.aws2-s3.proxy-port=8099&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;but it is ignored and starting the route fails with SSL error&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.camel:camel-maven-plugin:3.9.0:run (default-cli) on project camel39-main: null: MojoExecutionException: InvocationTargetException: Failed to start route route1 because of null: Unable to execute HTTP request: Connection reset -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13373688">CAMEL-16530</key>
            <summary>AWS2-S3 component does not recognize or use proxy-host and proxy-port from application.properties</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="acosentino">Andrea Cosentino</assignee>
                                    <reporter username="gmaurizio">Gustavo Maurizio</reporter>
                        <labels>
                    </labels>
                <created>Mon, 19 Apr 2021 20:13:13 +0000</created>
                <updated>Thu, 30 Sep 2021 10:34:31 +0000</updated>
                            <resolved>Tue, 20 Apr 2021 06:57:37 +0000</resolved>
                                    <version>3.9.0</version>
                                    <fixVersion>3.7.4</fixVersion>
                    <fixVersion>3.10.0</fixVersion>
                                    <component>camel-aws2</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17325296" author="gmaurizio" created="Mon, 19 Apr 2021 20:20:38 +0000"  >&lt;p&gt;I performed an additional test from my home computer (that does not need proxy).&lt;/p&gt;

&lt;p&gt;When I use the application.properties to set the following values:&lt;/p&gt;

&lt;p&gt;camel.component.aws2-s3.use-default-credentials-provider=true&lt;/p&gt;

&lt;p&gt;camel.component.aws2-s3.autowired-enabled=true&lt;/p&gt;

&lt;p&gt;works fine! (again there is no proxy there)&lt;/p&gt;

&lt;p&gt;If I add&#160;&lt;/p&gt;

&lt;p&gt;camel.component.aws2-s3.proxy-host=myproxy.com&lt;/p&gt;

&lt;p&gt;camel.component.aws2-s3.proxy-port=8099&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;they are correctly read at start, but nothing changes, and of course the myproxy.com does not exist, so it should at least give a DNS or timeout error.&lt;/p&gt;

&lt;p&gt;From my work computer (that DOES need the proxy), no matter how i load the host (host name or IP), it is ignored as well.&lt;/p&gt;</comment>
                            <comment id="17325312" author="ancosen" created="Mon, 19 Apr 2021 20:58:15 +0000"  >&lt;p&gt;Can you please show your complete configuration while using the proxy? Thanks.&lt;/p&gt;</comment>
                            <comment id="17325324" author="gmaurizio" created="Mon, 19 Apr 2021 21:25:09 +0000"  >&lt;p&gt;application.properties from resources&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

# properties used in the route
bucketName=bucketnameedited
camel.component.aws2-s3.useDefaultCredentialsProvider=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
# camel.component.aws2-s3.trustAllCertificates=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
camel.component.aws2-s3.proxy-host=myproxy.com
camel.component.aws2-s3.proxy-port=8099

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;route below (from java main with routeloader defined in pom.xml. Dynamically loaded&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;routes xmlns=&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/schema/spring&quot;&lt;/span&gt;&amp;gt; 
&lt;/span&gt;  &amp;lt;route&amp;gt; &amp;lt;from uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;aws2-s3:&lt;span class=&quot;code-comment&quot;&gt;//{{bucketName}}&quot;&lt;/span&gt;/&amp;gt; 
&lt;/span&gt;  &amp;lt;log message=&lt;span class=&quot;code-quote&quot;&gt;&quot;FILE STORED ${headers}&quot;&lt;/span&gt;/&amp;gt; &amp;lt;/route&amp;gt; 
&amp;lt;/routes&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17325326" author="gmaurizio" created="Mon, 19 Apr 2021 21:27:57 +0000"  >&lt;p&gt;MyApplication.java&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; com.example.camel;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.main.Main;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyApplication {

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; MyApplication() {
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        Main main = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Main();
        main.run(args);
    }

}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17325328" author="gmaurizio" created="Mon, 19 Apr 2021 21:30:16 +0000"  >&lt;p&gt;I will appreciate, as a possible band-aid while we figure this out, if you can post an example of a java class file that defines an S3 client (like the one used with #s3client) that works for the aws2-s3 component. That might help bypass the defaults built. It seems that for some mysterious reason the proxy part is not being attached to the autowired client.&lt;/p&gt;</comment>
                            <comment id="17325506" author="ancosen" created="Tue, 20 Apr 2021 06:24:13 +0000"  >&lt;p&gt;The autowired client is a client set in the registry. In that case, is up to you to set the proxy setting in the client instance you&apos;re going to use in the route.&lt;/p&gt;

&lt;p&gt;If you want to use an autowired client and then specify the proxy host and proxy port it won&apos;t work, because camel component will pick up the client instance from the registry and ignore the configuration part.&lt;/p&gt;

&lt;p&gt;By the way I&apos;ll check.&lt;/p&gt;</comment>
                            <comment id="17325517" author="ancosen" created="Tue, 20 Apr 2021 06:33:46 +0000"  >&lt;p&gt;Ok, I spotted a little bug.&lt;/p&gt;

&lt;p&gt;I fix it today.&lt;/p&gt;

&lt;p&gt;With a local fix I&apos;m now getting correctly:&#160;Caused by: org.apache.http.conn.ConnectTimeoutException: Connect to myproxy.com:8099 &lt;span class=&quot;error&quot;&gt;&amp;#91;myproxy.com/52.219.112.235&amp;#93;&lt;/span&gt; failed: connect timed out&lt;/p&gt;</comment>
                            <comment id="17325519" author="ancosen" created="Tue, 20 Apr 2021 06:35:21 +0000"  >&lt;p&gt;As a workaround, follow the configuration done here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/camel/blob/master/components/camel-aws/camel-aws2-s3/src/main/java/org/apache/camel/component/aws2/s3/client/impl/AWS2S3ClientIAMOptimizedImpl.java#L60&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/master/components/camel-aws/camel-aws2-s3/src/main/java/org/apache/camel/component/aws2/s3/client/impl/AWS2S3ClientIAMOptimizedImpl.java#L60&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Add the proxy stuff and place the client into registry. With the autowired it should be picked up automatically&lt;/p&gt;</comment>
                            <comment id="17325770" author="gmaurizio" created="Tue, 20 Apr 2021 12:54:46 +0000"  >&lt;p&gt;Grazie Andrea! i added the AWS2S3ClientIAM... with the mod and it compiled and executed beautifully.&#160;&lt;/p&gt;

&lt;p&gt;I wonder if there are other AWS clients that might have the same challenge? When will these fixes be incorporated, can I assume the June 3.11 release?&lt;/p&gt;</comment>
                            <comment id="17325777" author="ancosen" created="Tue, 20 Apr 2021 13:00:37 +0000"  >&lt;p&gt;I updated all the components using useDefaultCredentialsProvider (currently s3, sns, sqs and kinesis). For 3.10 I&apos;m working on adding the useDefaultCredentialsProvider on all the aws components. The fix should be available for 3.10. We would like to release a 3.10 release in May, before the 3.11 LTS in June. Thanks for feedback and for reporting the issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 30 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0q7uw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>