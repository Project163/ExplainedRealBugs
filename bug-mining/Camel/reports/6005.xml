<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:51:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-17118] mapHttpMessageFormUrlEncodedBody does not work - it will always map the POST parameters to headers</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-17118</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Hi team,&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Issue&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;The parameter &lt;b&gt;mapHttpMessageFormUrlEncodedBody&lt;/b&gt;&#160; is not useful&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Root Issue&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;If you have a request with a POST parameter having a CR/LF in one of its values, it will be mapped to an HTTP Header, causing an Exception. CR/LF are not allowed header characters in HTTP protocol nor camel&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Analysis&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;I think where the problem is.&lt;/p&gt;

&lt;p&gt;Class:&#160;&#160;org.apache.camel.http.common.DefaultHttpBindingComponent.java&lt;/p&gt;

&lt;p&gt;Line: &lt;a href=&quot;https://github.com/apache/camel/blob/005765443f3161182b78c999b9f8b43052768800/components/camel-http-common/src/main/java/org/apache/camel/http/common/DefaultHttpBinding.java#L183&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/005765443f3161182b78c999b9f8b43052768800/components/camel-http-common/src/main/java/org/apache/camel/http/common/DefaultHttpBinding.java#L183&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Explanation&lt;/ins&gt;:&#160;&#160;The POST/GET parameters are always added as Headers in camel&lt;/p&gt;

&lt;p&gt;There is no any flag that can avoid that mapping.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Proposed solution&lt;/ins&gt;&lt;/p&gt;

&lt;p&gt;Use the&#160;&lt;b&gt;mapHttpMessageFormUrlEncodedBody&lt;/b&gt; to control where the GET/POST parameters should be mapped to headers&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Kind regards&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Kind regards&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13407781">CAMEL-17118</key>
            <summary>mapHttpMessageFormUrlEncodedBody does not work - it will always map the POST parameters to headers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="andresoviedo">Andres Oviedo</reporter>
                        <labels>
                    </labels>
                <created>Thu, 21 Oct 2021 14:01:22 +0000</created>
                <updated>Sun, 9 Jan 2022 11:32:58 +0000</updated>
                            <resolved>Sun, 9 Jan 2022 11:32:58 +0000</resolved>
                                    <version>2.20.4</version>
                                    <fixVersion>3.14.1</fixVersion>
                    <fixVersion>3.15.0</fixVersion>
                                    <component>camel-servlet</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17433026" author="davsclaus" created="Fri, 22 Oct 2021 14:54:28 +0000"  >&lt;p&gt;What version of Camel do you use?&lt;/p&gt;</comment>
                            <comment id="17433118" author="andresoviedo" created="Fri, 22 Oct 2021 18:36:53 +0000"  >&lt;p&gt;camel version: 2.20.4&lt;/p&gt;

&lt;p&gt;main branch should still have same issue&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17433229" author="federico mariani" created="Sat, 23 Oct 2021 07:13:23 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andresoviedo&quot; class=&quot;user-hover&quot; rel=&quot;andresoviedo&quot;&gt;andresoviedo&lt;/a&gt;, I tried to execute some tests, seems like that DefaultHttpBindinig.readHeaders is invoked by camel-servlet and camel-resteasy tests.&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;camel-servlet tests throws exception on&#160;ServletCamelRouterTestSupport.java:98 when using a carriage return character as parameter.&lt;/li&gt;
	&lt;li&gt;camel-resteasy handle the carriage return character by encoding it.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;m probably missing something here, do you have some kind of reproducer?&lt;/p&gt;</comment>
                            <comment id="17443111" author="davsclaus" created="Sat, 13 Nov 2021 14:42:23 +0000"  >&lt;p&gt;Camel 2.x is EOL soon and the reported did not provide a reproducer&lt;/p&gt;</comment>
                            <comment id="17450938" author="andresoviedo" created="Tue, 30 Nov 2021 08:11:19 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Sorry for the late response.&#160;You can reproduce the error with the following CURL request&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
curl --location --request POST &lt;span class=&quot;code-quote&quot;&gt;&apos;https:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8080/&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;/my-route&apos;&lt;/span&gt; \
&lt;/span&gt;--header &lt;span class=&quot;code-quote&quot;&gt;&apos;Content-Type: application/x-www-form-urlencoded&apos;&lt;/span&gt; \
--data-urlencode &lt;span class=&quot;code-quote&quot;&gt;&apos;foo=bar\nbaz&apos;&lt;/span&gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;What will happen is, Camel will map the Payload parameter &quot;foo&quot; to a header with the same name &quot;foo&quot;.&lt;/p&gt;

&lt;p&gt;Then it will crash because of the CR/LF character&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I see that that the 2.x major version will reach end-of-life (EOL) by January 2022&lt;/p&gt;

&lt;p&gt;I hope this is not anymore a bug in 3.x version&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;At your disposal&#160;&lt;/p&gt;

&lt;p&gt;Kind regards&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17471332" author="davsclaus" created="Sun, 9 Jan 2022 11:19:54 +0000"  >&lt;p&gt;On Camel 3.x I cannot reproduce any exception - I do get the header parsed by Camel though its value is bar\nbaz but there are no exceptions&lt;/p&gt;</comment>
                            <comment id="17471333" author="davsclaus" created="Sun, 9 Jan 2022 11:25:34 +0000"  >&lt;p&gt;Okay so the mapHttpMessageFormUrlEncodedBody is not set to false because you use rest-dsl where its &quot;fixed&quot;. Yeah we can look at improve this so it can be re-configured.&lt;br/&gt;
But if you use normal camel-servlet then you can configure it&lt;/p&gt;</comment>
                            <comment id="17471334" author="davsclaus" created="Sun, 9 Jan 2022 11:32:58 +0000"  >&lt;p&gt;Okay the mapHttpMessageFormUrlEncodedBody is now also used in rest-dsl&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10061"><![CDATA[Novice]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 44 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0w1yw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>