<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:36:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-2231] Exception during mail connection requires folder to be reset</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-2231</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I think that this problem may still be around with 2.1-SNAPSHOT:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://fusesource.com/forums/thread.jspa?threadID=746&amp;amp;tstart=0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://fusesource.com/forums/thread.jspa?threadID=746&amp;amp;tstart=0&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I noticed that I had a pop3 server outage and then subsequently had a similar problem i.e. IllegalStateException, folder not open.&lt;/p&gt;

&lt;p&gt;Here&apos;s when the outage started.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2009-11-26 11:57:55,316 [: MailComponent] WARN  ultPollingConsumerPollStrategy - Consumer Consumer[pop3:&lt;span class=&quot;code-comment&quot;&gt;//...] could not poll endpoint: pop3://... caused by: Connect failed
&lt;/span&gt;javax.mail.MessagingException: Connect failed;
  nested exception is:
        java.net.NoRouteToHostException: No route to host
        at com.sun.mail.pop3.POP3Store.protocolConnect(POP3Store.java:161)
        at javax.mail.Service.connect(Service.java:288)
        at org.apache.camel.component.mail.MailConsumer.ensureIsConnected(MailConsumer.java:241)
        at org.apache.camel.component.mail.MailConsumer.poll(MailConsumer.java:79)
        at org.apache.camel.impl.ScheduledPollConsumer.run(ScheduledPollConsumer.java:108)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
        at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)
        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:181)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:205)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:619)
Caused by: java.net.NoRouteToHostException: No route to host
        at java.net.PlainSocketImpl.socketConnect(Native Method)
        at java.net.PlainSocketImpl.doConnect(PlainSocketImpl.java:333)
        at java.net.PlainSocketImpl.connectToAddress(PlainSocketImpl.java:195)
        at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:182)
        at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:366)
        at java.net.Socket.connect(Socket.java:519)
        at java.net.Socket.connect(Socket.java:469)
        at com.sun.mail.util.SocketFetcher.createSocket(SocketFetcher.java:233)
        at com.sun.mail.util.SocketFetcher.getSocket(SocketFetcher.java:189)
        at com.sun.mail.pop3.Protocol.&amp;lt;init&amp;gt;(Protocol.java:94)
        at com.sun.mail.pop3.POP3Store.getPort(POP3Store.java:214)
        at com.sun.mail.pop3.POP3Store.protocolConnect(POP3Store.java:157)
        ... 13 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This went on for about a minute or so and there was no more in the log file until several hours later - in fact when an email appeared in the INBOX. I know this because my personal email account was copied on the email and so I have the timestamp.&lt;/p&gt;

&lt;p&gt;I then get the following message every time I poll the server and have to re-start my application to get over it:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2009-11-26 19:19:57,293 [: MailComponent] ERROR MailConsumer                   - Folder not open
java.lang.IllegalStateException: Folder not open
        at javax.mail.Folder.getMessages(Folder.java:938)
        at javax.mail.Folder.search(Folder.java:1226)
        at org.apache.camel.component.mail.MailConsumer.poll(MailConsumer.java:107)
        at org.apache.camel.impl.ScheduledPollConsumer.run(ScheduledPollConsumer.java:108)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)
        at java.util.concurrent.FutureTask$Sync.innerRunAndReset(FutureTask.java:317)
        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:150)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$101(ScheduledThreadPoolExecutor.java:98)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.runPeriodic(ScheduledThreadPoolExecutor.java:181)
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:205)
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:619)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I took a look at MailConsumer.java and note the following code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;236	        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!connected) {
237	            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isDebugEnabled()) {
238	                LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Connecting to MailStore: &quot;&lt;/span&gt; + endpoint.getConfiguration().getMailStoreLogInformation());
239	            }
240	            store = sender.getSession().getStore(config.getProtocol());
241	            store.connect(config.getHost(), config.getPort(), config.getUsername(), config.getPassword());
242	        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If you&apos;re not connected then how is it possible to have a folder? Following this logic my recommendation is to insert the following at line 242:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;241	            store.connect(config.getHost(), config.getPort(), config.getUsername(), config.getPassword());
                    folder = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
242	        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;2.1-SNAPSHOT&lt;/p&gt;</environment>
        <key id="12486413">CAMEL-2231</key>
            <summary>Exception during mail connection requires folder to be reset</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="huntc@internode.on.net">Christopher Hunt</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Nov 2009 11:13:36 +0000</created>
                <updated>Thu, 3 Jun 2010 07:25:46 +0000</updated>
                            <resolved>Thu, 26 Nov 2009 11:50:59 +0000</resolved>
                                    <version>1.6.2</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.6.3</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                    <component>camel-mail</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>
                            <timeestimate seconds="7200">2h</timeestimate>
                                        <comments>
                            <comment id="12953961" author="davsclaus" created="Thu, 26 Nov 2009 11:19:51 +0000"  >&lt;p&gt;Yeah good idea, the same as I concluded as well.&lt;/p&gt;

&lt;p&gt;Christopher can you try with updated code from trunk? And report your findings.&lt;/p&gt;

&lt;p&gt;trunk: 884525.&lt;/p&gt;
</comment>
                            <comment id="12953941" author="davsclaus" created="Thu, 26 Nov 2009 11:27:09 +0000"  >&lt;p&gt;Merged to 1.x: 884527.&lt;/p&gt;</comment>
                            <comment id="12953957" author="huntc@internode.on.net" created="Thu, 26 Nov 2009 11:29:47 +0000"  >&lt;p&gt;Gee that was a quick fix! Will this get automatically included in the next site build? I can rebuild my project in about 10 hours (late at night now). Should it not pick up your mod in the latest 2.1-snapshot?&lt;/p&gt;</comment>
                            <comment id="12953965" author="davsclaus" created="Thu, 26 Nov 2009 11:47:51 +0000"  >&lt;p&gt;Yeah I think i had the fix ready before you created the ticket &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I will attach my local build .jar you can use instead of waiting for Hudson to build a new SNAPSHOT at Apache repo&lt;/p&gt;</comment>
                            <comment id="12953963" author="davsclaus" created="Thu, 26 Nov 2009 11:50:07 +0000"  >&lt;p&gt;You can keep an eye on hudson if it has the fix in the deploy&lt;br/&gt;
&lt;a href=&quot;http://hudson.zones.apache.org/hudson/job/Camel/changes&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hudson.zones.apache.org/hudson/job/Camel/changes&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It deploys a new SNAPSHOT for every successful build&lt;/p&gt;</comment>
                            <comment id="12953966" author="davsclaus" created="Thu, 26 Nov 2009 11:50:59 +0000"  >&lt;p&gt;I will mark this as resolved for now in case Hadrian decides to build a RC of Camel as we want it to be released ASAP as SMX 4.1 is waiting for it as well.&lt;/p&gt;</comment>
                            <comment id="12953980" author="huntc@internode.on.net" created="Mon, 30 Nov 2009 02:15:38 +0000"  >&lt;p&gt;Looks as though your patch fixed things up. I had a 2.1-SNAPSHOT service running over the weekend. There was an outage with the POP service which showed itself in the log file. I was then able to send an email subsequently (a day or so later) and all was well.&lt;/p&gt;</comment>
                            <comment id="12956194" author="davsclaus" created="Thu, 3 Jun 2010 07:25:46 +0000"  >&lt;p&gt;Closing old resolved issues&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="12486267">CAMEL-1501</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12462899" name="camel-mail-2.1-SNAPSHOT.jar" size="49443" author="davsclaus" created="Thu, 26 Nov 2009 11:48:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76587</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01nbj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7547</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>