<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:21:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-10713] SCP not handling errors for failed transfers correctly</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-10713</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;If I try to transfer a file to a directory that does not exist using Camel SCP I see a warning like this in the log:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;scp&amp;#93;&lt;/span&gt; WARN scp: /home/user/scp/1234: No such file or directory&lt;br/&gt;
It looks like the code says that Camel will just log a warning when such an error occurs. There is no exception in the code, so it looks like the file was transferred when it was not.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/camel/blob/52a739feb9da8acd29067304c7c8356bbc5ef4dd/components/camel-jsch/src/main/java/org/apache/camel/component/scp/ScpOperations.java#L347&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/52a739feb9da8acd29067304c7c8356bbc5ef4dd/components/camel-jsch/src/main/java/org/apache/camel/component/scp/ScpOperations.java#L347&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The error codes for SCP are:&lt;/p&gt;

&lt;p&gt;1 General error in file copy &lt;br/&gt;
2 Destination is not directory, but it should be &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://support.attachmate.com/techdocs/2116.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://support.attachmate.com/techdocs/2116.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The fix should have the SCP Endpoint raise an error if the return code is not 0.  &lt;/p&gt;

&lt;p&gt;See the following discussion.  &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://camel.465427.n5.nabble.com/Camel-SCP-Warnings-td5792552.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.465427.n5.nabble.com/Camel-SCP-Warnings-td5792552.html&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13035428">CAMEL-10713</key>
            <summary>SCP not handling errors for failed transfers correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="patrickmcgloin">Patrick McGloin</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Jan 2017 08:45:43 +0000</created>
                <updated>Wed, 18 Jan 2017 09:31:03 +0000</updated>
                            <resolved>Wed, 18 Jan 2017 08:43:03 +0000</resolved>
                                                    <fixVersion>2.17.6</fixVersion>
                    <fixVersion>2.18.2</fixVersion>
                    <fixVersion>2.19.0</fixVersion>
                                    <component>camel-jsch</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15825686" author="davsclaus" created="Tue, 17 Jan 2017 09:12:51 +0000"  >&lt;p&gt;Are you working on a github PR or patch file?&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15825713" author="patrickmcgloin" created="Tue, 17 Jan 2017 09:34:13 +0000"  >&lt;p&gt;Yes, I will give it a go.&lt;/p&gt;</comment>
                            <comment id="15827530" author="githubbot" created="Wed, 18 Jan 2017 07:19:22 +0000"  >&lt;p&gt;GitHub user patrickmcgloin opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1405&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1405&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-10713&quot; title=&quot;SCP not handling errors for failed transfers correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-10713&quot;&gt;&lt;del&gt;CAMEL-10713&lt;/del&gt;&lt;/a&gt; SCP not handling errors for failed transfers correctly&lt;/p&gt;

&lt;p&gt;    This fix works for all existing Unit Tests and I can see the error in the logs when I use the new jar file to do an SCP transfer:&lt;/p&gt;

&lt;p&gt;    Throwable exception.getCause [java.io.IOException: &lt;span class=&quot;error&quot;&gt;&amp;#91;scp&amp;#93;&lt;/span&gt; Return Code &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; scp: /scpDemo/: Is a directory].&lt;/p&gt;

&lt;p&gt;    I tried to add a new Unit Test for this case but was unable to do so, the test past when it should have failed.  This is what I tried:&lt;/p&gt;

&lt;p&gt;        @Test&lt;br/&gt;
        public void testScpProduceWithFolderCausesError() throws Exception &lt;/p&gt;
{
            Assume.assumeTrue(this.isSetupComplete());
    
            getMockEndpoint(&quot;mock:result&quot;).expectedBodiesReceived(&quot;Hello World&quot;);
    
            String uri = getScpUri() + &quot;?username=admin&amp;amp;password=admin&amp;amp;knownHostsFile=&quot; + getKnownHostsFile();
            Map&amp;lt;String, Object&amp;gt; headers = new HashMap&amp;lt;String, Object&amp;gt;();
            headers.put(Exchange.FILE_PATH, &quot;folder/&quot;);
            headers.put(Exchange.FILE_NAME, &#8220;folder2/hello.txt&quot;);
    
            template.sendBodyAndHeaders(uri, &quot;Hello World&quot;, headers);
    
            assertMockEndpointsSatisfied();
        }
&lt;p&gt;  &lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/patrickmcgloin/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/patrickmcgloin/camel&lt;/a&gt; scp-error-handling&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1405.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1405.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1405&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 87f5913aa0cb9fc51d264762177db3214df802cb&lt;br/&gt;
Author: Patrick McGloin &amp;lt;patrickmcgloin@patricks-macbook-air.local&amp;gt;&lt;br/&gt;
Date:   2017-01-17T21:24:48Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-10713&quot; title=&quot;SCP not handling errors for failed transfers correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-10713&quot;&gt;&lt;del&gt;CAMEL-10713&lt;/del&gt;&lt;/a&gt; SCP not handling errors for failed transfers correctly&lt;/p&gt;

&lt;p&gt;commit b3b4ed1bf0bcae5c5c2d89ed64f4d9b3464a381e&lt;br/&gt;
Author: Patrick McGloin &amp;lt;patrickmcgloin@patricks-macbook-air.local&amp;gt;&lt;br/&gt;
Date:   2017-01-18T07:12:14Z&lt;/p&gt;

&lt;p&gt;    Indentation fix&lt;/p&gt;

&lt;p&gt;commit d36d0deb5dcf6f479b041a77eca1f5e76d53851f&lt;br/&gt;
Author: Patrick McGloin &amp;lt;patrickmcgloin@patricks-macbook-air.local&amp;gt;&lt;br/&gt;
Date:   2017-01-18T07:14:32Z&lt;/p&gt;

&lt;p&gt;    Newline at end of file&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15827714" author="githubbot" created="Wed, 18 Jan 2017 09:31:03 +0000"  >&lt;p&gt;Github user patrickmcgloin closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1405&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1405&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 44 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38sqv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>