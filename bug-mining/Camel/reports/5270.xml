<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:41:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-14937] ExpressionBuilder.headerExpression(&quot;name&quot;, class) results in ClassNotFoundException</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-14937</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;&lt;tt&gt;&#160;public static &amp;lt;T&amp;gt; Expression headerExpression(final String headerName, final Class&amp;lt;T&amp;gt; type) {&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160; return headerExpression(simpleExpression(headerName), constantExpression(type));&lt;/tt&gt;&lt;br/&gt;
{{ }}}&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;and&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;{{ public static Expression headerExpression(final Expression headerName, final Expression typeName)}}&lt;br/&gt;
&lt;tt&gt;}}{{&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;tries to resolve the type via&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;String text = typeName.evaluate(exchange, String.class);&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;which results in the String &quot;class xxx.yyy.type&quot;. Trying to resolve that as a class obviously is bound to fail. I&apos;m not sure whether the type converter should be changed here or the headerExpression code is wrong.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This worked in 3.1.0, btw.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13299919">CAMEL-14937</key>
            <summary>ExpressionBuilder.headerExpression(&quot;name&quot;, class) results in ClassNotFoundException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="jensgr@gmx.net">Jens Kleine-Herzbruch</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Apr 2020 08:51:17 +0000</created>
                <updated>Wed, 22 Apr 2020 12:46:44 +0000</updated>
                            <resolved>Wed, 22 Apr 2020 12:46:44 +0000</resolved>
                                    <version>3.2.0</version>
                                    <fixVersion>3.3.0</fixVersion>
                                    <component>came-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17089282" author="davsclaus" created="Wed, 22 Apr 2020 04:54:00 +0000"  >&lt;p&gt;Can you attach a reproducer or some more source code that better points out what the problem is. The code you have so far is a bit unclear.&lt;/p&gt;</comment>
                            <comment id="17089315" author="jensgr@gmx.net" created="Wed, 22 Apr 2020 06:02:49 +0000"  >&lt;p&gt;I don&apos;t have a rproducer at the ready but the main problem is that&lt;/p&gt;

&lt;p&gt;typeName.evaluate(exchange, String.class) with typeName being e.g. a constantExpression(String.class) results in the string &quot;class java.lang.String&quot;.&lt;/p&gt;

&lt;p&gt;When that gets fed into the class resolver, it fails.&lt;/p&gt;

&lt;p&gt;So either the class resolver needs to handle that case (probably not the correct solution), or the type converter needs to make sure to convert to &quot;java.lang.String&quot;, or the headerExpression code needs to use the passed in class parameter directly instead of converting to class name and back to class.&lt;/p&gt;</comment>
                            <comment id="17089445" author="jensgr@gmx.net" created="Wed, 22 Apr 2020 08:28:58 +0000"  >&lt;p&gt;Here&apos;s a simple test case and a possible fix.&lt;/p&gt;</comment>
                            <comment id="17089604" author="davsclaus" created="Wed, 22 Apr 2020 11:59:02 +0000"  >&lt;p&gt;Thanks we will take a look at this&lt;/p&gt;</comment>
                            <comment id="17089626" author="davsclaus" created="Wed, 22 Apr 2020 12:29:03 +0000"  >&lt;p&gt;Yeah Jens this looks good thanks for the patch. Running tests before merging.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13000807" name="camel-header-expression.diff" size="1670" author="jensgr@gmx.net" created="Wed, 22 Apr 2020 08:28:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 29 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0dvy8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>