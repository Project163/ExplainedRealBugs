<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:34:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-1922] BeanEndpoint fails in the presence of bridge methods</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-1922</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When a message is sent to a bean: endpoint, camel searches for a method with the right signature.  If multiple methods are found, an exception is thrown.&lt;/p&gt;

&lt;p&gt;If a have an interface like&lt;/p&gt;

&lt;p&gt;public interface &amp;lt;T&amp;gt; I {&lt;br/&gt;
  T function(T arg);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;and a class like&lt;/p&gt;

&lt;p&gt;public class C implements I&amp;lt;Number&amp;gt; {&lt;br/&gt;
  Number function(Number arg) &lt;/p&gt;
{
    return new Double(arg.doubleValue() * 2);
  }&lt;br/&gt;
}&lt;br/&gt;
&lt;br/&gt;
then I can&apos;t use an instance of C as an endpoint.&lt;br/&gt;
&lt;br/&gt;
The problem is that under the hood java has created a bridge method, and the &quot;real&quot; class C looks like&lt;br/&gt;
&lt;br/&gt;
public class C implements I&amp;lt;Number&amp;gt; {&lt;br/&gt;
  Number function(Number arg) {    return new Double(arg.doubleValue() * 2);  }

&lt;p&gt;  Object function(Object arg) &lt;/p&gt;
{
    return function((Number) arg);
  }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;Camel then discovers that there are two methods it could call (f(Object) and f(Number)) and throws an exception even though there&apos;s no real ambiguity because both methods do the same thing.&lt;/p&gt;

&lt;p&gt;I recommend rejecting bridge methods in BeanInfo.isValidMethod with somehting like&lt;/p&gt;

&lt;p&gt;if (method.isBridgeMethod()) return false;&lt;/p&gt;

&lt;p&gt;Does this sound reasonable?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Java SE 5&lt;/p&gt;</environment>
        <key id="12487131">CAMEL-1922</key>
            <summary>BeanEndpoint fails in the presence of bridge methods</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hadrian">Hadrian Zbarcea</assignee>
                                    <reporter username="adambrewster">Adam Brewster</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Aug 2009 00:38:49 +0000</created>
                <updated>Thu, 3 Jun 2010 07:23:48 +0000</updated>
                            <resolved>Sun, 23 Aug 2009 03:16:45 +0000</resolved>
                                    <version>1.6.1</version>
                                    <fixVersion>1.6.2</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="72000">20h</timeoriginalestimate>
                            <timeestimate seconds="72000">20h</timeestimate>
                                        <comments>
                            <comment id="12951897" author="hadrian" created="Thu, 20 Aug 2009 03:43:26 +0000"  >&lt;p&gt;Yes it does.  Would you like to submit a patch?  We highly appreciate contributions &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12951894" author="davsclaus" created="Thu, 20 Aug 2009 04:21:13 +0000"  >&lt;p&gt;Bean component have been improved quite a lot in 2.0 in relation to detecting method to use.&lt;/p&gt;

&lt;p&gt;Try 2.0 first to verify whether or not any such issues exist there.&lt;/p&gt;</comment>
                            <comment id="12952226" author="adambrewster" created="Sat, 22 Aug 2009 01:27:34 +0000"  >&lt;p&gt;Here&apos;s my previous comment in patch form.&lt;/p&gt;</comment>
                            <comment id="12952234" author="hadrian" created="Sat, 22 Aug 2009 02:43:36 +0000"  >&lt;p&gt;Thanks for the patch Adam.  A good idea is to also add a unit test that emphasizes the problem and the fix, but I will take care of it.&lt;/p&gt;</comment>
                            <comment id="12952199" author="adambrewster" created="Sat, 22 Aug 2009 05:04:32 +0000"  >&lt;p&gt;I wrote a unit test (the gist was FromBeanTest.java + the description field of this issue), but apparently I suck at maven because can&apos;t get  the test suite to run.&lt;/p&gt;

&lt;p&gt;Even after I checked out a fresh copy of the project, it still didn&apos;t work.&lt;/p&gt;

&lt;p&gt;Occasionally when `mvn test` decides not to complain that camel-core is missing (umm, didn&apos;t I just tell you to build that?) it takes ~ hours to finish (does it start a new JVM for every test?)  and finally complains about DataSet being broken.  I&apos;m considering `rm -rf ~/.m2` but that seems pretty brutal.&lt;/p&gt;

&lt;p&gt;I heard a rumor that with -Dtest=BridgeMethodTest, maven would only run my new test, but given that option it reverts to complaining about camel-core.&lt;/p&gt;

&lt;p&gt;I&apos;ll try again at some point.&lt;/p&gt;</comment>
                            <comment id="12952227" author="njiang" created="Sat, 22 Aug 2009 06:38:27 +0000"  >&lt;p&gt;@ Adam,&lt;/p&gt;

&lt;p&gt;You can use mvn clean install -Dtest=false to skip the test running and build the source.&lt;br/&gt;
Then you can use mvn test -Dtest=BridgeMethodTest to run your own test &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12952257" author="hadrian" created="Sat, 22 Aug 2009 14:49:11 +0000"  >&lt;p&gt;@Adam,&lt;/p&gt;

&lt;p&gt;Please follow Willem&apos;s instructions.  A few comments:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;mvn:test only &lt;b&gt;runs&lt;/b&gt; the tests, it assumes the project is already built.  If not you get the error you mentioned (so no, you did not tell it to build that, just test). mvn:install builds &lt;b&gt;and&lt;/b&gt; tests.  mvn:clean is sorta optional but needed sometimes when things get out of hands.  The command you want is probably `mvn test -Dtest=BridgeMethodTest`&lt;/li&gt;
	&lt;li&gt;DataSet: there is an issue with the test (wrong order of consumer creation may lead to loss of messages on faster boxes).  I fixed it in 2.0 but forgot to port it back to 1.x.  My bad, will take care of it.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thanks for pointing this out.&lt;/p&gt;</comment>
                            <comment id="12952197" author="adambrewster" created="Sat, 22 Aug 2009 20:46:58 +0000"  >&lt;p&gt;Sorry for last night&apos;s rant.  Maybe I was just upset about the score of the game I was watching.&lt;/p&gt;

&lt;p&gt;Here&apos;s what I&apos;ve got for a unit test.  It&apos;s a bit more complicated than I expected.  I tried out simpler versions, but this was the only one that actually failed the unpatched code (error&apos;ed it actually).&lt;/p&gt;

&lt;p&gt;Maybe the awkwardness of the unit test required to catch this issue speaks to the setup I was using when I discovered the problem in the first place.&lt;/p&gt;

&lt;p&gt;This (like the first patch I posted) is against tags/camel-1.6.1.  I&apos;m still working on getting 2.0 to do something useful.&lt;/p&gt;

&lt;p&gt;@Hadrian,&lt;br/&gt;
According to &lt;a href=&quot;http://maven.apache.org/guides/introduction/introduction-to-the-lifecycle.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;the docs&lt;/a&gt; &lt;tt&gt;mvn test&lt;/tt&gt; ought to validate and compile (and do a dozen other things) before attempting to test.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;if you call a build phase, it will execute not only that build phase, but also every build phase prior to the called build phase&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;@Willem,&lt;br/&gt;
also note&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;# test - test the compiled source code using a suitable unit testing framework. These tests should not require the code be packaged or deployed&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="12952293" author="hadrian" created="Sun, 23 Aug 2009 02:04:51 +0000"  >&lt;p&gt;Patch applied with thanks on the camel-1.x branch (r806919) and trunk (r806923)&lt;/p&gt;</comment>
                            <comment id="12956429" author="davsclaus" created="Thu, 3 Jun 2010 07:23:48 +0000"  >&lt;p&gt;Closing old resolved issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12462885" name="0001-Reject-bridge-methods-while-introspecting-POJO-consu.patch" size="1083" author="adambrewster" created="Sat, 22 Aug 2009 01:27:34 +0000"/>
                            <attachment id="12462921" name="0002-Unit-test.patch" size="3979" author="adambrewster" created="Sat, 22 Aug 2009 20:46:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76694</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01lef:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7236</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>