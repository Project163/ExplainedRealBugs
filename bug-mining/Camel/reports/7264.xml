<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:12:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-22458] flatpack converter accesses invalid column names for header and trailer record value retrieval of fixed width files</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-22458</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;&lt;b&gt;Errror Szenario&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;When org.apache.camel.component.flatpack.FlatpackConverter toMap function is called, for example while using the org.apache.camel.component.flatpack.DataSetList iterator, the putValues(Map&amp;lt;String, Object&amp;gt; map, Record recordObj) is called.&lt;/p&gt;

&lt;p&gt;In this method the recordObj.getColumns() is called to retrieve the available columns of the record. The columns are iterated over to retrieve the respective values.&lt;/p&gt;

&lt;p&gt;When a fixed with file with the following example.pzmap.xml scheme was parsed,&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&apos;1.0&apos;&lt;/span&gt;?&amp;gt;
&amp;lt;!-- DTD can be pulled from the Jar or over the web--&amp;gt;
&amp;lt;!DOCTYPE PZMAP SYSTEM	&lt;span class=&quot;code-quote&quot;&gt;&quot;flatpack.dtd&quot;&lt;/span&gt; &amp;gt;
&amp;lt;!--&amp;lt;!DOCTYPE PZMAP SYSTEM	&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//flatpack.sourceforge.net/flatpack.dtd&quot;&lt;/span&gt; &amp;gt;--&amp;gt;
&lt;/span&gt;&amp;lt;PZMAP&amp;gt;
    &amp;lt;RECORD id=&lt;span class=&quot;code-quote&quot;&gt;&quot;header&quot;&lt;/span&gt; indicator=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt; elementNumber=&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;COLUMN name=&lt;span class=&quot;code-quote&quot;&gt;&quot;RECORDINDICATOR&quot;&lt;/span&gt; length=&lt;span class=&quot;code-quote&quot;&gt;&quot;5&quot;&lt;/span&gt; /&amp;gt;
        &amp;lt;COLUMN name=&lt;span class=&quot;code-quote&quot;&gt;&quot;HEADERDATA&quot;&lt;/span&gt; length=&lt;span class=&quot;code-quote&quot;&gt;&quot;20&quot;&lt;/span&gt; /&amp;gt;
    &amp;lt;/RECORD&amp;gt; 
        &amp;lt;COLUMN name=&lt;span class=&quot;code-quote&quot;&gt;&quot;FIRSTNAME&quot;&lt;/span&gt; length=&lt;span class=&quot;code-quote&quot;&gt;&quot;35&quot;&lt;/span&gt; /&amp;gt;
	&amp;lt;COLUMN name=&lt;span class=&quot;code-quote&quot;&gt;&quot;LASTNAME&quot;&lt;/span&gt; length=&lt;span class=&quot;code-quote&quot;&gt;&quot;35&quot;&lt;/span&gt; /&amp;gt;
	&amp;lt;COLUMN name=&lt;span class=&quot;code-quote&quot;&gt;&quot;ADDRESS&quot;&lt;/span&gt; length=&lt;span class=&quot;code-quote&quot;&gt;&quot;100&quot;&lt;/span&gt; /&amp;gt;
	&amp;lt;COLUMN name=&lt;span class=&quot;code-quote&quot;&gt;&quot;CITY&quot;&lt;/span&gt; length=&lt;span class=&quot;code-quote&quot;&gt;&quot;100&quot;&lt;/span&gt; /&amp;gt;
	&amp;lt;COLUMN name=&lt;span class=&quot;code-quote&quot;&gt;&quot;STATE&quot;&lt;/span&gt; length=&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt; /&amp;gt;
	&amp;lt;COLUMN name=&lt;span class=&quot;code-quote&quot;&gt;&quot;ZIP&quot;&lt;/span&gt; length=&lt;span class=&quot;code-quote&quot;&gt;&quot;5&quot;&lt;/span&gt; /&amp;gt;
 &#160; &#160;&amp;lt;RECORD id=&lt;span class=&quot;code-quote&quot;&gt;&quot;trailer&quot;&lt;/span&gt; indicator=&lt;span class=&quot;code-quote&quot;&gt;&quot;9&quot;&lt;/span&gt; elementNumber=&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;&amp;gt;
        &amp;lt;COLUMN name=&lt;span class=&quot;code-quote&quot;&gt;&quot;RECORDINDICATOR&quot;&lt;/span&gt; length=&lt;span class=&quot;code-quote&quot;&gt;&quot;5&quot;&lt;/span&gt; /&amp;gt;
        &amp;lt;COLUMN name=&lt;span class=&quot;code-quote&quot;&gt;&quot;TRAILERDATA&quot;&lt;/span&gt; length=&lt;span class=&quot;code-quote&quot;&gt;&quot;15&quot;&lt;/span&gt; /&amp;gt;
    &amp;lt;/RECORD&amp;gt;
		
&amp;lt;/PZMAP&amp;gt;  &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;this leads to the following error being thrown:&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.util.NoSuchElementException: Column [FIRSTNAME] does not exist, check &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;/spelling. key:[header] at net.sf.flatpack.util.ParserUtils.getColumnIndex(ParserUtils.java:618) at net.sf.flatpack.RowRecord.getStringValue(RowRecord.java:269) at net.sf.flatpack.RowRecord.getString(RowRecord.java:315) at org.apache.camel.component.flatpack.FlatpackConverter.putValues(FlatpackConverter.java:117) at org.apache.camel.component.flatpack.FlatpackConverter.toMap(FlatpackConverter.java:48) at org.apache.camel.component.flatpack.DataSetList$1.next(DataSetList.java:90) at org.apache.camel.component.flatpack.DataSetList$1.next(DataSetList.java:68) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Error explanation&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;The first record is the header record, which differs from the rows below. But the recordObj.getColumns() method retrieves not the header records columns (RECORDINDICATOR, HEADERDATA), but the other rows columns (FIRSTNAME, LASTNAME, ADDRESS, CITY, STATE, ZIP), which do not match the record structure. This leads to error.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Solution Suggestion&lt;/b&gt;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;use the local getColumns(DataSet dataSet) method instead of recordObj.getColumns() to retrieve the correct colums&lt;/li&gt;
	&lt;li&gt;change the getColumns(DataSet dataSet) methods signature to getColumns(Record dataSet)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void putValues(Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; map, net.sf.flatpack.Record recordObj) {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] columns = getColumns(recordObj); &lt;span class=&quot;code-comment&quot;&gt;// !!!modified!!!
&lt;/span&gt; &#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; column : columns) {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value = recordObj.getString(column);
        map.put(column, value);
    }
}

&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] getColumns(Record dataSet) { &lt;span class=&quot;code-comment&quot;&gt;// !!!modified!!!
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// the columns can vary depending on header, body or trailer
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (dataSet.isRecordID(FlatpackComponent.HEADER_ID)) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; dataSet.getColumns(FlatpackComponent.HEADER_ID);
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (dataSet.isRecordID(FlatpackComponent.TRAILER_ID)) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; dataSet.getColumns(FlatpackComponent.TRAILER_ID);
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; dataSet.getColumns();
    }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;ul&gt;
	&lt;li&gt;probably all&lt;/li&gt;
	&lt;li&gt;discovered on camel 4 quarkus (after migrating from camel 2 fuse)
	&lt;ul&gt;
		&lt;li&gt;quarkus-camel-bom, quarkus-bom version: 3.16.2&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</environment>
        <key id="13630049">CAMEL-22458</key>
            <summary>flatpack converter accesses invalid column names for header and trailer record value retrieval of fixed width files</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="gandrinor">Gandrinor</reporter>
                        <labels>
                            <label>flatpack</label>
                    </labels>
                <created>Fri, 26 Sep 2025 09:15:45 +0000</created>
                <updated>Tue, 7 Oct 2025 12:06:54 +0000</updated>
                            <resolved>Tue, 7 Oct 2025 12:06:54 +0000</resolved>
                                    <version>4.14.0</version>
                                    <fixVersion>4.10.8</fixVersion>
                    <fixVersion>4.14.2</fixVersion>
                    <fixVersion>4.16.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="18023475" author="davsclaus" created="Mon, 29 Sep 2025 05:09:41 +0000"  >&lt;p&gt;You are welcome to work on a patch and send a PR&lt;/p&gt;</comment>
                            <comment id="18028062" author="davsclaus" created="Tue, 7 Oct 2025 12:06:54 +0000"  >&lt;p&gt;Thanks for reporting and the suggested fix&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10061"><![CDATA[Novice]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1xvz4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>