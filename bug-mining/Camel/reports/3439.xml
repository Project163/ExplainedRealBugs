<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:11:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-9243] Invocation of Bean fails when Bean extends and abstract which implements the actual method</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-9243</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;The issue described here does NOT exist in 2.15.2 and only manifests in 2.15.3.&lt;/p&gt;

&lt;p&gt;With the following definition of a Bean:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; MyBaseInterface {
        @Handler
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; hello(@Body &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; hi);
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyAbstractBean &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; MyBaseInterface {
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; hello(@Body &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; hi) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;Hello &quot;&lt;/span&gt; + hi;
        }
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; doCompute(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; input) {
            fail(&lt;span class=&quot;code-quote&quot;&gt;&quot;Should not invoke me&quot;&lt;/span&gt;);
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        }
    }

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyConcreteBean &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; MyAbstractBean {
    }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The following test case will fail to invoke the proper method:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;BeanHandlerMethodTest &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; ContextTestSupport {

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testInterfaceBeanMethod() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        BeanInfo info = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BeanInfo(context, MyConcreteBean.class);

        Exchange exchange = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DefaultExchange(context);
        MyConcreteBean pojo = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyConcreteBean();
        MethodInvocation mi = info.createInvocation(pojo, exchange);
        assertNotNull(mi);
        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;hello&quot;&lt;/span&gt;, mi.getMethod().getName());
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The issue is how BeanInfo.introspect determines which methods are available to be invoked.&lt;/p&gt;

&lt;p&gt;At line 344, if the class is public, the interface methods are added to the list:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (Modifier.isPublic(clazz.getModifiers())) {
            &lt;span class=&quot;code-comment&quot;&gt;// add additional &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; methods
&lt;/span&gt;            List&amp;lt;Method&amp;gt; extraMethods = getInterfaceMethods(clazz);
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Method target : extraMethods) {
                &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Method source : methods) {
                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (ObjectHelper.isOverridingMethod(source, target, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)) {
                        overrides.add(target);
                    }
                }
            }
            &lt;span class=&quot;code-comment&quot;&gt;// remove all the overrides methods
&lt;/span&gt;            extraMethods.removeAll(overrides);
            methods.addAll(extraMethods);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However, all the methods from the interface are &quot;abstract&quot;.  Later, when the real implementation is encountered as the code crawls up the tree, the abstract method is not replaced:&lt;/p&gt;

&lt;p&gt;Line 390:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        MethodInfo existingMethodInfo = overridesExistingMethod(methodInfo);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (existingMethodInfo != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            LOG.trace(&lt;span class=&quot;code-quote&quot;&gt;&quot;This method is already overridden in a subclass, so the method from the sub &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;is preferred: {}&quot;&lt;/span&gt;, existingMethodInfo);
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; existingMethodInfo;
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Finally, during the invocation, the following was added as part of 2.15.3 release:&lt;/p&gt;

&lt;p&gt;Line 561:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        removeAllAbstractMethods(localOperationsWithBody);
        removeAllAbstractMethods(localOperationsWithNoBody);
        removeAllAbstractMethods(localOperationsWithCustomAnnotation);
        removeAllAbstractMethods(localOperationsWithHandlerAnnotation);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As a result, the abstract method is removed and not invoked.&lt;/p&gt;

&lt;p&gt;I think the fix should be to see if the existingMethodInfo references an &quot;abstract&apos; method and if it does and methodInfo does not, replace the existingMethodInfo with methodInfo in the collection.&lt;/p&gt;

&lt;p&gt;This would preserve the preferences implied with the rest of the code while properly replacing the abstract method with their proper implementations.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12907143">CAMEL-9243</key>
            <summary>Invocation of Bean fails when Bean extends and abstract which implements the actual method</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="apara">Alex Paransky</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Oct 2015 17:15:51 +0000</created>
                <updated>Sat, 24 Oct 2015 14:01:02 +0000</updated>
                            <resolved>Sat, 24 Oct 2015 14:01:02 +0000</resolved>
                                    <version>2.15.3</version>
                                    <fixVersion>2.16.1</fixVersion>
                    <fixVersion>2.15.5</fixVersion>
                    <fixVersion>2.17.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14969493" author="apara" created="Thu, 22 Oct 2015 17:21:26 +0000"  >&lt;p&gt;Here is a modified BeanHandlerMethodTest.java which fails with with 2.15.3.&lt;/p&gt;</comment>
                            <comment id="14972610" author="davsclaus" created="Sat, 24 Oct 2015 14:01:02 +0000"  >&lt;p&gt;Thanks for reporting and with the unit test&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12768078" name="BeanHandlerMethodTest.java" size="6571" author="apara" created="Thu, 22 Oct 2015 17:23:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 4 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ne2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>