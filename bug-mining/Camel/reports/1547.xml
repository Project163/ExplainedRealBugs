<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:45:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-4311] Camel Bindy Parser One to Many KvP Unmarshall Issue</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-4311</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Bindy KvP unmarshall issue. &lt;/p&gt;

&lt;p&gt;While unmarshalling FIX messages, camel-bindy causing inconsistencies if the incoming fix messages are defined to map using &apos;OneToMany&apos; annotations.&lt;/p&gt;

&lt;p&gt;In a given route for eg:&lt;/p&gt;

&lt;p&gt; BindyKeyValuePairDataFormat kvpBindyDataFormat = new BindyKeyValuePairDataFormat(&quot;org.apache.camel.dataformat.bindy.model.fix.complex.onetomany&quot;);&lt;br/&gt;
        public void configure() &lt;/p&gt;
{
            from(URI_DIRECT_START).unmarshal(kvpBindyDataFormat).to(URI_MOCK_RESULT);
        }

&lt;p&gt;kvpBindyDataFormat is single instance for multiple threads and with in &apos;BindyKeyValuePairFactory&apos; class instance varialbe  below is shared across multiple threads causing data inconsistencies.&lt;/p&gt;

&lt;p&gt;private Map&amp;lt;String, List&amp;lt;Object&amp;gt;&amp;gt; lists = new HashMap&amp;lt;String, List&amp;lt;Object&amp;gt;&amp;gt;(); &lt;/p&gt;

&lt;p&gt;Values from previous thread/messages are retained in the current thread causing issues.&lt;/p&gt;

&lt;p&gt;For eg in the test case: public class BindyComplexOneToManyKeyValuePairUnMarshallTest extends CommonBindyTest &lt;/p&gt;

&lt;p&gt;if we send another message  with no repeating groups are sent.&lt;/p&gt;

&lt;p&gt;String message2 = &quot;8=FIX 4.19=2034=135=049=INVMGR56=BRKR&quot; + &quot;1=BE.CHM.00111=CHM0001-0158=this is a camel - bindy test&quot; &lt;br/&gt;
        				  + &quot;10=220&quot;;&lt;/p&gt;

&lt;p&gt;The output message has repeating group data from message processed in earlier thread are pouplated causing data inconsistencies.&lt;/p&gt;

&lt;p&gt;Please suggest the fix considering multi-threading scenario. I am willing to volunteer for the fix.&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Surya&lt;/p&gt;



</description>
                <environment>&lt;p&gt;Windows, Linux &lt;/p&gt;</environment>
        <key id="12518098">CAMEL-4311</key>
            <summary>Camel Bindy Parser One to Many KvP Unmarshall Issue</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="surya108">surya</reporter>
                        <labels>
                    </labels>
                <created>Sat, 6 Aug 2011 01:41:37 +0000</created>
                <updated>Fri, 2 Sep 2011 09:32:38 +0000</updated>
                            <resolved>Sun, 7 Aug 2011 10:32:13 +0000</resolved>
                                    <version>2.7.0</version>
                    <version>2.7.2</version>
                    <version>2.7.3</version>
                    <version>2.8.0</version>
                                    <fixVersion>2.8.1</fixVersion>
                    <fixVersion>2.9.0</fixVersion>
                                    <component>camel-bindy</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13080386" author="davsclaus" created="Sat, 6 Aug 2011 09:46:50 +0000"  >&lt;p&gt;You are welcome to try to fix this and work on a patch.&lt;/p&gt;</comment>
                            <comment id="13080450" author="surya108" created="Sat, 6 Aug 2011 20:20:54 +0000"  >&lt;p&gt;changed few files to handle instance variable causing issues while parsing messages in multi threaded situation.&lt;/p&gt;

&lt;p&gt;Changed instance variable to local.&lt;/p&gt;

&lt;p&gt;added new method     &lt;br/&gt;
public void bind(List&amp;lt;String&amp;gt; data, Map&amp;lt;String, Object&amp;gt; model, int line, Map&amp;lt;String, List&amp;lt;Object&amp;gt;&amp;gt; lists) throws Exception {&lt;/p&gt;

&lt;p&gt;Map&amp;lt;String, List&amp;lt;Object&amp;gt;&amp;gt; lists was instance variable root cause of bug.&lt;/p&gt;

&lt;p&gt;patches for two java classes and 1 test case. Existing test case updated, sending multiple messages would cause test case to fail without the fix.&lt;/p&gt;

&lt;p&gt;Please review and let me know if anything else need to be updated.&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Surya&lt;/p&gt;</comment>
                            <comment id="13080452" author="surya108" created="Sat, 6 Aug 2011 20:21:47 +0000"  >&lt;p&gt;patch files for 4133.&lt;/p&gt;</comment>
                            <comment id="13080453" author="surya108" created="Sat, 6 Aug 2011 20:25:02 +0000"  >&lt;p&gt;update comments in patch file. &lt;/p&gt;</comment>
                            <comment id="13080564" author="davsclaus" created="Sun, 7 Aug 2011 10:32:13 +0000"  >&lt;p&gt;Thanks for the patch. Keep &apos;em coming &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12489587" name="BindyComplexOneToManyKeyValuePairUnMarshallTest_patch_4311.txt" size="1129" author="surya108" created="Sat, 6 Aug 2011 20:21:46 +0000"/>
                            <attachment id="12489588" name="BindyKeyValuePairDataFormat_patch_4311.txt" size="1361" author="surya108" created="Sat, 6 Aug 2011 20:21:46 +0000"/>
                            <attachment id="12489590" name="BindyKeyValuePairFactory_patch_4311.txt" size="2912" author="surya108" created="Sat, 6 Aug 2011 20:25:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>62853</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 16 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0205j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9626</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>