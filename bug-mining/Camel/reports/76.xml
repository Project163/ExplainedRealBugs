<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:25:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-324] bad content length header value in http response</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-324</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;By default HttpBinding class copies all request header attributes from the request to the response including &apos;Content-Length&apos;. So the consequence is that the response is declaring the same size as the request which can lead to serious truncation problems! &lt;/p&gt;

&lt;p&gt;the workaround is simply to add the line:&lt;br/&gt;
out.removeHeader(&quot;Content-Length&quot;); &lt;br/&gt;
in the writeResponse method of the httpbinding class allowing jetty to set the right value.  &lt;/p&gt;</description>
                <environment></environment>
        <key id="12485119">CAMEL-324</key>
            <summary>bad content length header value in http response</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gtully">Gary Tully</assignee>
                                    <reporter username="alexc">Alex Cichowski</reporter>
                        <labels>
                    </labels>
                <created>Sun, 10 Feb 2008 10:30:07 +0000</created>
                <updated>Mon, 12 May 2008 12:45:32 +0000</updated>
                            <resolved>Thu, 28 Feb 2008 03:52:42 +0000</resolved>
                                    <version>1.3.0</version>
                                    <fixVersion>1.3.0</fixVersion>
                                    <component>camel-http</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                                                            <comments>
                            <comment id="12946337" author="gtully" created="Tue, 12 Feb 2008 18:35:17 +0000"  >&lt;p&gt;Hi Alex,&lt;br/&gt;
I am having difficulty reproducing the behaviour you describe. In writeResponse&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; on trunk,  the headers are correctly copied from the out message, not from the request. The out message defaults to an empty DefaultMessage which would have no headers.&lt;/p&gt;

&lt;p&gt;Would it be possible to provide a test route or xml config fragment or some more detail?&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Gary.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc/activemq/camel/trunk/components/camel-http/src/main/java/org/apache/camel/component/http/HttpBinding.java?view=markup&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/activemq/camel/trunk/components/camel-http/src/main/java/org/apache/camel/component/http/HttpBinding.java?view=markup&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="12946324" author="alexc" created="Tue, 12 Feb 2008 21:06:05 +0000"  >&lt;p&gt;Sure, here is a route that reproduces the problem. This simply routes a java serialized, base64 encoded request (and returns the response back) to the echoService on a http channel: &lt;/p&gt;

&lt;p&gt;               from(&quot;direct:echoService&quot;).marshal().serialization().beanRef(&quot;base64Encoder&quot;)&lt;br/&gt;
		.to(&quot;http://localhost:8088/echoService&quot;).beanRef(&quot;base64Decoder&quot;).unmarshal().serialization();&lt;/p&gt;

&lt;p&gt;		from(&quot;jetty:&lt;a href=&quot;http://localhost:8088/echoService&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8088/echoService&lt;/a&gt;&quot;).beanRef(&quot;base64Decoder&quot;)&lt;br/&gt;
		.unmarshal().serialization().to(&quot;bean:echoService&quot;).marshal().serialization().beanRef(&quot;base64Encoder&quot;);	&lt;/p&gt;

&lt;p&gt;I think the problem comes from the &lt;span class=&quot;error&quot;&gt;&amp;#91;un&amp;#93;&lt;/span&gt;marshall processor that copies the complete in message (with headers) to the out message before setting the &lt;span class=&quot;error&quot;&gt;&amp;#91;un&amp;#93;&lt;/span&gt;marshalled body in the out message. Here is the code:&lt;/p&gt;

&lt;p&gt;        Message in = exchange.getIn();&lt;br/&gt;
        Object body = in.getBody();&lt;/p&gt;

&lt;p&gt;        // lets setup the out message before we invoke the dataFormat&lt;br/&gt;
        // so that it can mutate it if necessary&lt;br/&gt;
        Message out = exchange.getOut(true);&lt;br/&gt;
        out.copyFrom(in);&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Alex.&lt;/p&gt;</comment>
                            <comment id="12946315" author="gtully" created="Wed, 13 Feb 2008 19:06:27 +0000"  >&lt;p&gt;yea, it is the marshaller that does the copy, but going to any different exchange would do it.&lt;/p&gt;

&lt;p&gt;One option is to add a .removeHeader(&quot;Content-Length&quot;) to your route rather than in the camel source. However I don&apos;t think this should be necessary, imho the Content-Length headers should never be copied/propagated from a HttpMessage.&lt;/p&gt;

&lt;p&gt;I have posted to the dev list to get some feedback before I prepare a patch for this.&lt;/p&gt;</comment>
                            <comment id="12945884" author="romkal" created="Wed, 13 Feb 2008 23:05:52 +0000"  >&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-254&quot; title=&quot;Support for http request headers for http component&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-254&quot;&gt;&lt;del&gt;CAMEL-254&lt;/del&gt;&lt;/a&gt; there was similar problem described. The solution implemented there was to skip a set of headers while building the HTTP request, so headers was on Camel message, but were ignored by the endpoint.&lt;/p&gt;</comment>
                            <comment id="12946376" author="gtully" created="Wed, 27 Feb 2008 22:30:16 +0000"  >&lt;p&gt;This patch takes the lead from the jmsBinding and the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-254&quot; title=&quot;Support for http request headers for http component&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-254&quot;&gt;&lt;del&gt;CAMEL-254&lt;/del&gt;&lt;/a&gt;. I pulled the skip code from HttpProducer into HttpBinding so it can be reused in the jetty component.&lt;br/&gt;
The option to override the set of ignored headers is provided via the IgnoredHeaders accessors&lt;/p&gt;</comment>
                            <comment id="12946397" author="hadrian" created="Thu, 28 Feb 2008 03:52:42 +0000"  >&lt;p&gt;Patch applied with thanks!&lt;/p&gt;</comment>
                            <comment id="12947005" author="davsclaus" created="Mon, 12 May 2008 12:45:32 +0000"  >&lt;p&gt;Closed all 1.3 tickets&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12462469" name="jetty_no_propagate_content_length.patch" size="12669" author="gtully" created="Wed, 27 Feb 2008 22:30:16 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12484867">CAMEL-254</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>83249</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 29 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01bj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5637</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>