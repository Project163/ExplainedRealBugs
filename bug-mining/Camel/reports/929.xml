<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:37:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-2452] HttpHeaderFilterStrategy dosn&apos;t filters out &apos;Cache-Control&apos;, &apos;Connection&apos;, &apos;Pragma&apos;, &apos;Trailer&apos;, &apos;Transfer-Encoding&apos;, &apos;Upgrade&apos;, &apos;Via&apos; and &apos;Warning&apos; in method applyFilterToCamelHeaders</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-2452</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;HttpHeaderFilterStrategy uses the HTTP headers with upper case characters on the beginning (e. g. &apos;Transfer-Encoding&apos; instead of &apos;transfer-encoding&apos;).&lt;/p&gt;</description>
                <environment>&lt;p&gt;All&lt;/p&gt;</environment>
        <key id="12487843">CAMEL-2452</key>
            <summary>HttpHeaderFilterStrategy dosn&apos;t filters out &apos;Cache-Control&apos;, &apos;Connection&apos;, &apos;Pragma&apos;, &apos;Trailer&apos;, &apos;Transfer-Encoding&apos;, &apos;Upgrade&apos;, &apos;Via&apos; and &apos;Warning&apos; in method applyFilterToCamelHeaders</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="muellerc">Christian M&#252;ller</assignee>
                                    <reporter username="muellerc">Christian M&#252;ller</reporter>
                        <labels>
                    </labels>
                <created>Sat, 6 Feb 2010 13:56:38 +0000</created>
                <updated>Wed, 3 Nov 2010 22:04:04 +0000</updated>
                            <resolved>Wed, 3 Nov 2010 22:04:04 +0000</resolved>
                                    <version>2.1.0</version>
                                    <fixVersion>2.3.0</fixVersion>
                                    <component>camel-http</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12954810" author="davsclaus" created="Sat, 6 Feb 2010 15:03:31 +0000"  >&lt;p&gt;http headers are case &lt;b&gt;insensitive&lt;/b&gt; so you can spell them how you like&lt;/p&gt;</comment>
                            <comment id="12954817" author="davsclaus" created="Sat, 6 Feb 2010 16:23:08 +0000"  >&lt;p&gt;I have moved this to 2.3 as I do not want Hadrian to hold up building the 2.2 release if he things this ticket must be fixed first.&lt;/p&gt;

&lt;p&gt;Christian can you describe a bit more what you think is the problem?&lt;br/&gt;
Doesn&apos;t the filter ignore case when filtering? If not you can add that into the reg exp to tell it to ignore case.&lt;/p&gt;</comment>
                            <comment id="12954815" author="muellerc" created="Sat, 6 Feb 2010 16:37:11 +0000"  >&lt;p&gt;Hey Claus,&lt;br/&gt;
you are too fast for me... &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I attached a unit test to show what the problem is (in my opinion).&lt;br/&gt;
You are right, the http header are case intensive, but the HttpHeaderFilterStrategy (extends DefaultHeaderFilterStrategy) expect the filter keys in lower case, if the &apos;lowerCase&apos; attribute is set to true (which is the case for HttpHeaderFilterStrategy). If the filter keys are defined in upper case or camel case, the filter will never applied.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (filter != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isLowerCase()) {
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (filter.contains(headerName.toLowerCase())) {
                    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
                }
            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (filter.contains(headerName)) {
                    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
                }
            }
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Christian&lt;/p&gt;</comment>
                            <comment id="12954854" author="muellerc" created="Wed, 10 Feb 2010 09:21:53 +0000"  >&lt;p&gt;Claus,&lt;br/&gt;
could you please have a look on this issue and patch. &lt;a href=&quot;https://issues.apache.org/activemq/browse/CAMEL-1530&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CAMEL-1530&lt;/a&gt; depends on this and I planed to deliver the patch for &lt;a href=&quot;https://issues.apache.org/activemq/browse/CAMEL-1530&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CAMEL-1530&lt;/a&gt; in the next tree days.&lt;/p&gt;

&lt;p&gt;The &quot;problem&quot; is, that HttpClient 4.0.1 checks the request header of the presents of some header which must not in, e.g. Transfer-Encoding. This header (and the other headers list in the issue name) should be filtered by the HttpHeaderFilterStrategy:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;HttpHeaderFilterStrategy.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;HttpHeaderFilterStrategy &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; DefaultHeaderFilterStrategy {

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; HttpHeaderFilterStrategy() {
        initialize();
    }

    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void initialize() {
        getOutFilter().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;content-length&quot;&lt;/span&gt;);
        getOutFilter().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;content-type&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-comment&quot;&gt;// Add the filter &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the Generic Message header
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.5
&lt;/span&gt;        getOutFilter().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cache-Control&quot;&lt;/span&gt;);
        getOutFilter().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;Connection&quot;&lt;/span&gt;);
        getOutFilter().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;Pragma&quot;&lt;/span&gt;);
        getOutFilter().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;Trailer&quot;&lt;/span&gt;);
        getOutFilter().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;Transfer-Encoding&quot;&lt;/span&gt;);
        getOutFilter().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;Upgrade&quot;&lt;/span&gt;);
        getOutFilter().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;Via&quot;&lt;/span&gt;);
        getOutFilter().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;Warning&quot;&lt;/span&gt;);

    setLowerCase(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);

        &lt;span class=&quot;code-comment&quot;&gt;// filter headers begin with &lt;span class=&quot;code-quote&quot;&gt;&quot;Camel&quot;&lt;/span&gt; or &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.camel&quot;&lt;/span&gt;
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// must ignore &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Http based transports
&lt;/span&gt;        setOutFilterPattern(&lt;span class=&quot;code-quote&quot;&gt;&quot;(?i)(Camel|org\\.apache\\.camel)[\\.|a-z|A-z|0-9]*&quot;&lt;/span&gt;);
        }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But DefaultHeaderFilterStrategy compares the lower case strings, if lowerCase is set to true (which is the case for HttpHeaderFilterStrategy)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;DefaultHeaderFilterStrategy .java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (filter != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isLowerCase()) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (filter.contains(headerName.toLowerCase())) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        }
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (filter.contains(headerName)) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This imply, that &apos;Transfer-Encoding&apos; is comparing with &apos;transfer-encoding&apos; what never match and this header will be never filtered out.&lt;/p&gt;

&lt;p&gt;Tanks,&lt;br/&gt;
Christian&lt;/p&gt;</comment>
                            <comment id="12954869" author="davsclaus" created="Wed, 10 Feb 2010 14:19:39 +0000"  >&lt;p&gt;Okay let me look at the patches&lt;/p&gt;</comment>
                            <comment id="12954868" author="davsclaus" created="Wed, 10 Feb 2010 14:25:14 +0000"  >&lt;p&gt;What about &lt;tt&gt;Date&lt;/tt&gt; header?&lt;br/&gt;
&lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec4.html#sec4.5&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12954870" author="davsclaus" created="Wed, 10 Feb 2010 14:29:48 +0000"  >&lt;p&gt;trunk: 908517.&lt;/p&gt;

&lt;p&gt;Thanks for the patch Christian.&lt;/p&gt;</comment>
                            <comment id="12957309" author="unmarshall" created="Tue, 2 Nov 2010 20:54:49 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;In Camel 2.5 HttpHeaderFilterStrategy still contains:&lt;br/&gt;
getOutFilter().add(&quot;transfer-encoding&quot;);&lt;br/&gt;
As per the issue the case should be camel case and not all lower case.&lt;/p&gt;

&lt;p&gt;Can we expect a patch for 2.5 version?&lt;/p&gt;

&lt;p&gt;Regards,&lt;br/&gt;
Madhav&lt;/p&gt;</comment>
                            <comment id="12957304" author="muellerc" created="Tue, 2 Nov 2010 22:23:05 +0000"  >&lt;p&gt;I don&apos;t see any problems with this code. The patch changed the camel case headers to lower case headers because HttpHeaderFilterStrategy set lower case to true and compares the lower case String of &quot;Transfer-Encoding&quot; which is &quot;transfer-encoding&quot; with the filter entry which is also &quot;transfer-encoding&quot;. What is your problem in concrete?&lt;/p&gt;

&lt;p&gt;Cheers,&lt;br/&gt;
Christian&lt;/p&gt;</comment>
                            <comment id="12957321" author="unmarshall" created="Wed, 3 Nov 2010 06:48:19 +0000"  >&lt;p&gt;Hi Christian,&lt;/p&gt;

&lt;p&gt;Please refer to the issue posted @ &lt;a href=&quot;http://camel.465427.n5.nabble.com/CXF-http-conduit-AllowChunking-does-not-work-td3247495.html#a3247495&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.465427.n5.nabble.com/CXF-http-conduit-AllowChunking-does-not-work-td3247495.html#a3247495&lt;/a&gt;&lt;br/&gt;
I initially felt that this was causing the problem but then after seeing your comment it seems that this is not the problem.&lt;/p&gt;

&lt;p&gt;Unless you feel otherwise, please close the issue.&lt;/p&gt;

&lt;p&gt;regards,&lt;br/&gt;
madhav&lt;/p&gt;</comment>
                            <comment id="12957284" author="muellerc" created="Wed, 3 Nov 2010 22:04:04 +0000"  >&lt;p&gt;Madhav opened &lt;a href=&quot;https://issues.apache.org/activemq/browse/CAMEL-3306&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CAMEL-3306&lt;/a&gt; to track his issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12463122" name="HttpHeaderFilterStrategy.patch" size="1430" author="muellerc" created="Sat, 6 Feb 2010 16:37:11 +0000"/>
                            <attachment id="12463101" name="HttpHeaderFilterStrategyTest.patch" size="6045" author="muellerc" created="Sat, 6 Feb 2010 16:37:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76518</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 3 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01oo7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7766</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>