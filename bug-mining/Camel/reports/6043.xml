<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:52:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-17514] BreadcrumbId MDC Value not set even MDCLogging is true during ErrorHandling Processor</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-17514</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;&lt;b&gt;Expected Behaviour:&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;If UseMDCLogging=true and UseBreadcrumb=true is set then i expect then everywhere the MDC Value camel.breadcrumbId is set.&lt;/p&gt;

&lt;p&gt;like it works in Camel Version &amp;lt; 3.12&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Reproducable&lt;/b&gt;&#160;&lt;br/&gt;
&lt;b&gt;Camel Version &amp;gt; 3.11&lt;/b&gt;&lt;br/&gt;
&#160;&lt;br/&gt;
Hint: If I use a custom UnitOfWorkFactory it works as expected. But I would assume that If MDCLogging is enabled then the DefaultUnitOfWork would handle this.&lt;br/&gt;
&#160;&lt;br/&gt;
&lt;b&gt;Log without MDC camel.Breadcrumb:&lt;/b&gt;&lt;br/&gt;
2022-01-19 12:01:00,335 INFO &#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;1 - timer://foo&amp;#93;&lt;/span&gt; route1 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;route1 0141fbc5-bb47-4458-a982-1e6585109b8a&amp;#93;&lt;/span&gt; - Received exchange with breadcrumbID: 0141fbc5-bb47-4458-a982-1e6585109b8a&lt;br/&gt;
2022-01-19 12:01:00,337 INFO &#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;1 - timer://foo&amp;#93;&lt;/span&gt; c.t.a.r.h.HelloBreadcrumbRoute &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;route1 0141fbc5-bb47-4458-a982-1e6585109b8a&amp;#93;&lt;/span&gt; - Process with bug&lt;br/&gt;
2022-01-19 12:01:00,338 INFO &#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;1 - timer://foo&amp;#93;&lt;/span&gt; c.t.a.r.h.OnExceptionProcessor &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;&lt;font color=&quot;#FF0000&quot;&gt;***&lt;b&gt;breadcrumbMissing&lt;/b&gt;***&lt;/font&gt;&amp;#93;&lt;/span&gt; - Some OnException process&lt;br/&gt;
2022-01-19 12:01:00,344 INFO &#160;&lt;span class=&quot;error&quot;&gt;&amp;#91;1 - timer://foo&amp;#93;&lt;/span&gt; route2 &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;route2&#160;&lt;font color=&quot;#FF0000&quot;&gt;***&lt;b&gt;breadcrumbMissing&lt;/b&gt;***&lt;/font&gt;&amp;#93;&lt;/span&gt; - Deadletter receive&lt;br/&gt;
&#160;&lt;br/&gt;
&lt;b&gt;Example:&lt;/b&gt;&lt;br/&gt;
@Override&lt;br/&gt;
public void configure() throws Exception {&lt;/p&gt;

&lt;p&gt;&#160; &#160;getContext().setUseMDCLogging(true);&lt;br/&gt;
&#160; &#160;getContext().setUseBreadcrumb(true);&lt;/p&gt;

&lt;p&gt;&#160; &#160;DeadLetterChannelBuilder errorHandlerBuilder = new DeadLetterChannelBuilder();&lt;br/&gt;
&#160; &#160;errorHandlerBuilder.setDeadLetterUri(&quot;direct:deadletterTest&quot;);&lt;br/&gt;
&#160; &#160;errorHandlerBuilder.setOnExceptionOccurred(onExceptionProcessor);&lt;br/&gt;
&#160; &#160;errorHandler(errorHandlerBuilder);&lt;/p&gt;

&lt;p&gt;&#160; &#160;from(&quot;timer://foo?fixedRate=true&amp;amp;period=10000&quot;)&lt;br/&gt;
&#160; &#160; &#160; .log(&quot;Received exchange with breadcrumbID: ${in.headers.breadcrumbId}&quot;)&lt;br/&gt;
&#160; &#160; &#160; .process(exchange -&amp;gt; &lt;/p&gt;
{
&#160; &#160; &#160; &#160; &#160; throw new Exception(&quot;Some Bug&quot;);
&#160; &#160; &#160; }
&lt;p&gt;);&lt;/p&gt;

&lt;p&gt;&#160; &#160;from(&quot;direct:deadletterTest&quot;)&lt;br/&gt;
&#160; &#160; &#160; .log(&quot;Deadletter received ${body}&quot;);&lt;br/&gt;
&#160; &#160;}&lt;/p&gt;

&lt;p&gt;&#160;&lt;br/&gt;
&lt;b&gt;OnExceptionProcessor:&lt;/b&gt;&lt;br/&gt;
@Component&lt;br/&gt;
public class OnExceptionProcessor implements Processor {&lt;/p&gt;

&lt;p&gt;&#160; &#160;private static final Logger LOG = LoggerFactory.getLogger(OnExceptionProcessor.class);&lt;/p&gt;

&lt;p&gt;&#160; &#160;@Override&lt;br/&gt;
&#160; &#160;public void process(Exchange exchange) throws Exception &lt;/p&gt;
{
&#160; &#160; &#160; LOG.info(&quot;Some OnException process&quot;);
&#160; &#160;}
&lt;p&gt;}&lt;br/&gt;
&#160;&lt;br/&gt;
&#160;&lt;br/&gt;
&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13423506">CAMEL-17514</key>
            <summary>BreadcrumbId MDC Value not set even MDCLogging is true during ErrorHandling Processor</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="rambichler">Michael Rambichler</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Jan 2022 12:45:21 +0000</created>
                <updated>Thu, 17 Feb 2022 16:25:38 +0000</updated>
                            <resolved>Sat, 22 Jan 2022 17:54:41 +0000</resolved>
                                    <version>3.13.0</version>
                    <version>3.14.0</version>
                                    <fixVersion>3.14.1</fixVersion>
                    <fixVersion>3.15.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17480384" author="davsclaus" created="Sat, 22 Jan 2022 09:08:00 +0000"  >&lt;p&gt;Have a pending fix. Needs some polish and improvements to unit tests.&lt;/p&gt;</comment>
                            <comment id="17488131" author="vandenbrink@zorgdomein.nl" created="Mon, 7 Feb 2022 14:04:32 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;, I&apos;m running into this issue as well, but the fix applied to 3.14.1 and 3.15.0 doesn&apos;t work for me. All MDC values are missing in the actual log output, the camel values (like breadcrumbId and routeId), but also values I add from my own code. I had to revert back to 3.11.5 to get it working again.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13403655">CAMEL-17009</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13429146">CAMEL-17676</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 40 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0yq9k:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>