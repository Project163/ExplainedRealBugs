<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:26:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-653] Bean method lost when sending a message from one JMS queue to another</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-653</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I noticed a problem in JmsBinding.java. If Camel has read a JMS message from a queue and that message has a bean method specified in the header (&quot;org.apache.camel.MethodName&quot;), the method header will removed if that message is written to another queue. Here&apos;s the offending code: &lt;/p&gt;

&lt;p&gt;    protected boolean shouldOutputHeader(org.apache.camel.Message camelMessage, String headerName, &lt;br/&gt;
                                         Object headerValue) &lt;/p&gt;
{ 
        return headerValue != null &amp;amp;&amp;amp; !getIgnoreJmsHeaders().contains(headerName) 
               &amp;amp;&amp;amp; ObjectHelper.isJavaIdentifier(headerName); 
    }
&lt;p&gt; &lt;/p&gt;

&lt;p&gt;&quot;org.apache.camel.MethodName&quot; fails the check isJavaIdentifier and is excluded from the headers written to the new message. I&apos;m not sure the purpose of this check, but this might be an unintended side effect. &lt;/p&gt;

&lt;p&gt;The call chain is something like this: &lt;/p&gt;

&lt;p&gt;JmsProducer.process &lt;br/&gt;
JmsBinding.makeJmsMessage &lt;br/&gt;
JmsBinding.appendJmsProperties &lt;br/&gt;
JmsBinding.shouldOutputHeader &lt;/p&gt;

&lt;p&gt;Update: Experimenting later with WebLogic&apos;s JMS, I noticed that WebLogic (9.2) does not allow this header name. Maybe this was the original motivation for this check. In order to be compatible with WebLogic, perhaps the method header name should changed to something like &quot;CamelMethod&quot;. I believe this would correct both problems.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP, ActiveMQ&lt;/p&gt;</environment>
        <key id="12484992">CAMEL-653</key>
            <summary>Bean method lost when sending a message from one JMS queue to another</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                            <parent id="12485958">CAMEL-227</parent>
                                    <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="belmore">Bruce Elmore</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 Jun 2008 12:57:16 +0000</created>
                <updated>Sun, 6 Jul 2008 06:30:56 +0000</updated>
                            <resolved>Wed, 2 Jul 2008 18:45:20 +0000</resolved>
                                    <version>1.3.0</version>
                    <version>1.4.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>camel-jms</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12947762" author="davsclaus" created="Mon, 30 Jun 2008 13:14:09 +0000"  >&lt;p&gt;Yes the JMS spec doesn&apos;t allow dots in header names for JMS properties.&lt;/p&gt;

&lt;p&gt;So either there should be some convention to substitute dots to underscore and reverse when receive the message (not nice).&lt;br/&gt;
Or to use simpler header names without dots.&lt;/p&gt;</comment>
                            <comment id="12947660" author="davsclaus" created="Mon, 30 Jun 2008 13:15:12 +0000"  >&lt;p&gt;We should agree how to handle properties on exchanges. Maybe all the dot should be removed, even though we favor to use keys that has a package name of some sort.&lt;/p&gt;</comment>
                            <comment id="12947787" author="davsclaus" created="Mon, 30 Jun 2008 13:16:33 +0000"  >&lt;p&gt;Marat has a patch to the transactional client not working properly that uses an helper (ExchangeProperties) to access properties on exchanges. Using this indirection we can ensure that dots and other non wanted names is not used.&lt;/p&gt;

&lt;p&gt;However we could break old application that still uses dots in the headers. Okay we should discuss this on the dev forum.&lt;/p&gt;</comment>
                            <comment id="12947764" author="davsclaus" created="Tue, 1 Jul 2008 09:44:58 +0000"  >&lt;p&gt;Also affected by 1.4.&lt;/p&gt;

&lt;p&gt;Target for 1.5 to address this. We could for being backwards compatible add two headers&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the original long name with package name with dots&lt;/li&gt;
	&lt;li&gt;without packagename&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;And let the bean component look for the header in the two keys?&lt;/p&gt;

&lt;p&gt;Later we could use the ExchangeProperty feature where we have a mean to address more generally the dot problem with JMS destinations.&lt;/p&gt;

&lt;p&gt;Bruce are you in a desperate need for a fix? Or can you wait for 1.5?&lt;/p&gt;</comment>
                            <comment id="12947747" author="belmore" created="Tue, 1 Jul 2008 13:06:00 +0000"  >&lt;p&gt;Claus,&lt;/p&gt;

&lt;p&gt;I&apos;d rather not resort to changing the Camel source myself. On the hand, I know a simple change that I could make (changing the method header name constant in the BeanInfo) that would fix the problem.&lt;br/&gt;
Thanks!&lt;/p&gt;

&lt;p&gt;Bruce&lt;/p&gt;
</comment>
                            <comment id="12947794" author="davsclaus" created="Tue, 1 Jul 2008 16:15:16 +0000"  >&lt;p&gt;If you have a unit test or route example that demonstrates the bug then we will be faster to implement a fix for it.&lt;/p&gt;</comment>
                            <comment id="12947790" author="davsclaus" created="Wed, 2 Jul 2008 04:46:01 +0000"  >&lt;p&gt;There are some tickets for the JMS header exclusion stuff as using illegal characters in MQ / WebLogic is prohibited and what we should do to avoid this problem.&lt;/p&gt;</comment>
                            <comment id="12947856" author="davsclaus" created="Wed, 2 Jul 2008 05:33:08 +0000"  >&lt;p&gt;I am adding a workaround special for BeanProcessor so we can send &lt;tt&gt;org.apache.camel.MethodName&lt;/tt&gt; over the wire, and being backwards compatible so end-users doesn&apos;t need to change their code.&lt;/p&gt;

&lt;p&gt;The workaround is to send &lt;tt&gt;org.apache.camel.MethodName&lt;/tt&gt; as &lt;tt&gt;org_apache_camel_MethodName&lt;/tt&gt; and have BeanProcessor fallback to the underscore if the regular key wasn&apos;t found.&lt;/p&gt;</comment>
                            <comment id="12947670" author="davsclaus" created="Wed, 2 Jul 2008 06:43:53 +0000"  >&lt;p&gt;The workaround works but I am not satisfied. Asking for thoughts on this in the dev forum.&lt;br/&gt;
We have the same problem for the FileComponent.&lt;/p&gt;

&lt;p&gt;My best shot is to fix Camel headers only by&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the key must start with &quot;org.apache.camel&quot;&lt;/li&gt;
	&lt;li&gt;will use underscore and restore the key when Camel consumes the message again&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12947792" author="belmore" created="Wed, 2 Jul 2008 13:00:02 +0000"  >&lt;p&gt;Keep in mind that if the user is using WebLogic&apos;s JMS (at least WL 9.2), a message with the header named &quot;org.apache.camel.Method&quot; will be rejected when you initially try to add it to a queue.&lt;/p&gt;

&lt;p&gt;The problem that I was initially describing (the header getting stripped off when writing to second queue) would be true regardless of the implementation of the JMS queue (even ActiveMQ).&lt;/p&gt;

&lt;p&gt;Off the top of my head, I&apos;d think a solution would be to change the constant to use the underscores and change the logic in the BeanProcessor and BeanInfo to handle the method being specified by either &quot;org.apache.camel.Method&quot; or &quot;org_apache_camel_Method&quot;.&lt;/p&gt;
</comment>
                            <comment id="12947855" author="davsclaus" created="Wed, 2 Jul 2008 15:18:57 +0000"  >&lt;p&gt;Bruce that was also my first shot on the solution = hacking BeanProcessor to accept headers with underscore as well.&lt;br/&gt;
But then again I wanted to try a generic solution that also works for the FileProducer and other areas in Camel where headers use package name.&lt;/p&gt;

&lt;p&gt;So a solution to handle &lt;tt&gt;org.apache.camel&lt;/tt&gt; specially would be ideal for a first shot solution. Or maybe even better replacing all dots with underscore and if the headerkey is a valid java identifier then its accepted.&lt;/p&gt;</comment>
                            <comment id="12947837" author="davsclaus" created="Wed, 2 Jul 2008 18:45:20 +0000"  >&lt;p&gt;Okay got it into the trunk now.&lt;/p&gt;

&lt;p&gt;See JmsBeanMethodHeaderTest added to jms component unit tests&lt;br/&gt;
And there is also one for the file example as well.&lt;/p&gt;

&lt;p&gt;Notice only dot to underscore is supported and the header key must still be a java identifier to be accepted, so no other funny chars in the name is allowed.&lt;/p&gt;</comment>
                            <comment id="12947878" author="davsclaus" created="Sun, 6 Jul 2008 06:30:56 +0000"  >&lt;p&gt;Closing 1.4 issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>83181</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 21 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01dkf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5967</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>