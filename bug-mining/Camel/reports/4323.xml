<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:26:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-11387] SFTP is delivered into incorrect location, without exception (file in subfolder + temp file is created + Camel running on Window &amp; SFTP server running on LINUX)</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-11387</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;The bug only happens when:&lt;br/&gt;
i) file in subfolder&lt;br/&gt;
ii) temp file is created &lt;br/&gt;
iii) Camel running on Window &amp;amp; SFTP server running on LINUX&lt;/p&gt;

&lt;p&gt;Route Configuration:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; from(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder?recursive=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;delay=60000&quot;&lt;/span&gt;).
&lt;/span&gt; to(&lt;span class=&quot;code-quote&quot;&gt;&quot;sftp:&lt;span class=&quot;code-comment&quot;&gt;//username@linuxServer?tempFileName=${file:onlyname}.part&quot;&lt;/span&gt;);&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;NOTES: added separator=UNIX or AUTO, I got the same issue.&lt;/p&gt;

&lt;p&gt;Window Local File: sourceFolder/myfolder1/myfolder2/test.txt&lt;br/&gt;
FTPS Remote File Delivered: $linuxServer/myfolder1myfolder2test.txt&lt;/p&gt;

&lt;p&gt;NOTES: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;There is no exception throw in 2.19.0, even though the file delivered into incorrect location.&lt;/li&gt;
	&lt;li&gt;In 2.17.3, exception throw at org.apache.camel.component.file.remote.SftpOperations.renameFile(SftpOperations.java:431)&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-ftp-2.17.3.jar:2.17.3&amp;#93;&lt;/span&gt;&lt;/li&gt;
	&lt;li&gt;Without tempFileName, it works perfectly.  Issue is around the rename area.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;camel is running on Window, and SFTP server is LINUX&lt;/p&gt;</environment>
        <key id="13078475">CAMEL-11387</key>
            <summary>SFTP is delivered into incorrect location, without exception (file in subfolder + temp file is created + Camel running on Window &amp; SFTP server running on LINUX)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="onders">Onder Sezgin</assignee>
                                    <reporter username="cherryn">Cherry Ngai</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Jun 2017 00:16:47 +0000</created>
                <updated>Sat, 28 Oct 2017 11:47:12 +0000</updated>
                            <resolved>Fri, 27 Oct 2017 15:59:14 +0000</resolved>
                                    <version>2.19.0</version>
                                    <fixVersion>2.19.4</fixVersion>
                    <fixVersion>2.20.1</fixVersion>
                    <fixVersion>2.21.0</fixVersion>
                                    <component>camel-sftp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="604800">168h</timeoriginalestimate>
                            <timeestimate seconds="604800">168h</timeestimate>
                                        <comments>
                            <comment id="16094326" author="davsclaus" created="Thu, 20 Jul 2017 08:03:25 +0000"  >&lt;p&gt;Can you be more specific what is the wrong location, maybe write down an file example and say step by step what is happening.&lt;/p&gt;</comment>
                            <comment id="16144235" author="cherryn" created="Mon, 28 Aug 2017 19:27:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;, the file is delivered to &quot;$linuxServer/myfolder1myfolder2test.txt&quot;.   It is expected to be delivered $linuxServer/myfolder1/myfolder2/test.txt.  &lt;/p&gt;


&lt;p&gt;Camel route with v2.19.0: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; from(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder?recursive=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;delay=60000&quot;&lt;/span&gt;).
&lt;/span&gt; to(&lt;span class=&quot;code-quote&quot;&gt;&quot;sftp:&lt;span class=&quot;code-comment&quot;&gt;//username@linuxServer?tempFileName=${file:onlyname}.part&quot;&lt;/span&gt;);&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Step 1: Camel is running on Window server&lt;br/&gt;
Step 2: File is placed in $windowServer/sourceFolder/myfolder1/myfolder2/test.txt, and expecting to delivery to $linuxServer/myfolder1/myfolder2/test.txt.  &lt;br/&gt;
Step 3: $linuxServer/myfolder1/myfolder2/test.txt.part is created&lt;br/&gt;
Step 4: File is renamed to $linuxServer/myfolder1myfolder2test.txt, and there is no exception.&lt;/p&gt;


&lt;p&gt;Debug message:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] SftpOperations                 DEBUG Connected to sftp://username@linuxServer:22
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] RemoteFileProducer             DEBUG Connected and logged in to: sftp://username@linuxServer?tempFileName=%24%7Bfile%3Aonlyname%7D.part
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] SftpOperations                 DEBUG Trying to build remote directory: myfolder1/myfolder2
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] GenericFileConverter           DEBUG Read file sourceFolder\myfolder1\myfolder2\test.txt (no charset)
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] SftpOperations                 DEBUG About to store file: test.txt.part using stream: java.io.BufferedInputStream@75c2d4bc
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] SftpOperations                 DEBUG Took 0.015 seconds (15 millis) to store file: test.txt.part and FTP client returned: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] RemoteFileProducer             DEBUG Wrote [myfolder1/myfolder2/test.txt.part] to [sftp://username@linuxServer?tempFileName=%24%7Bfile%3Aonlyname%7D.part]
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] SftpOperations                 DEBUG Renaming file: myfolder1/myfolder2/test.txt.part to: myfolder1\myfolder2\test.txt
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] Tracer                         INFO  ID-WINDOWSERVER-55268-1503948136624-0-2 &amp;gt;&amp;gt;&amp;gt; (route2) sftp://username@linuxServer?tempFileName=%24%7Bfile%3Aonlyname%7D.part --&amp;gt; log[file ${file:absolute.path} is processed] &amp;lt;&amp;lt;&amp;lt; Pattern:InOnly, Headers:{breadcrumbId=ID-WINDOWSERVER-55268-1503948136624-0-1, CamelFileAbsolute=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, CamelFileAbsolutePath=E:\relay\sourceFolder\myfolder1\myfolder2\test.txt, CamelFileLastModified=1503948089127, CamelFileLength=4, CamelFileName=myfolder1\myfolder2\test.txt, CamelFileNameConsumed=myfolder1\myfolder2\test.txt, CamelFileNameOnly=test.txt, CamelFileNameProduced=myfolder1\myfolder2\test.txt, CamelFileParent=sourceFolder\myfolder1\myfolder2, CamelFilePath=sourceFolder\myfolder1\myfolder2\test.txt, CamelFileRelativePath=myfolder1\myfolder2\test.txt}, BodyType:org.apache.camel.component.file.GenericFile, Body:[Body is file based: GenericFile[myfolder1\myfolder2\test.txt]]
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] route2                         INFO  file E:\relay\sourceFolder\myfolder1\myfolder2\test.txt is processed
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] GenericFileOnCompletion        DEBUG Done processing file: GenericFile[myfolder1\myfolder2\test.txt] using exchange: Exchange[ID-WINDOWSERVER-55268-1503948136624-0-2]
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] FileUtil                       DEBUG Retrying attempt 0 to delete file: sourceFolder\myfolder1\myfolder2\.camel\test.txt
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] FileUtil                       DEBUG Tried 1 to delete file: sourceFolder\myfolder1\myfolder2\.camel\test.txt with result: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] nericFileRenameProcessStrategy DEBUG Renaming file: GenericFile[myfolder1\myfolder2\test.txt] to: GenericFile[myfolder1\myfolder2\.camel\test.txt]
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] FileUtil                       DEBUG Tried 1 to rename file: E:\relay\sourceFolder\myfolder1\myfolder2\test.txt to: sourceFolder\myfolder1\myfolder2\.camel\test.txt with result: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] FileUtil                       DEBUG Retrying attempt 0 to delete file: E:\relay\sourceFolder\myfolder1\myfolder2\test.txt.camelLock
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] FileUtil                       DEBUG Tried 1 to delete file: E:\relay\sourceFolder\myfolder1\myfolder2\test.txt.camelLock with result: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


</comment>
                            <comment id="16144245" author="cherryn" created="Mon, 28 Aug 2017 19:40:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;, &lt;/p&gt;

&lt;p&gt;Same code with camel v2.17.3.  The temp file is created ($linuxServer/myfolder1/myfolder2/test.txt.part), but exception when renaming.&lt;/p&gt;

&lt;p&gt;Step 1: Camel v2.17.3 is running on Window server&lt;br/&gt;
Step 2: File is placed in $windowServer/sourceFolder/myfolder1/myfolder2/test.txt, and expecting to delivery to $linuxServer/myfolder1/myfolder2/test.txt. &lt;br/&gt;
Step 3: $linuxServer/myfolder1/myfolder2/test.txt.part is created&lt;br/&gt;
Step 4: exception to rename to the file $linuxServer/myfolder1/myfolder2/test.txt.part to $linuxServer/myfolder1/myfolder2/test.txt.&lt;/p&gt;

&lt;p&gt;Debug message:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] SftpOperations                 INFO  Connected to sftp://username@linuxServer:22
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] RemoteFileProducer             DEBUG Connected and logged in to: Endpoint[sftp://username@linuxServer?tempFileName=%24%7Bfile%3Aonlyname%7D.part]
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] SftpOperations                 DEBUG Trying to build remote directory: myfolder1/myfolder2
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] GenericFileConverter           DEBUG Read file sourceFolder\myfolder1\myfolder2\test.txt (no charset)
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] SftpOperations                 DEBUG About to store file: test.txt.part using stream: java.io.BufferedInputStream@755bc403
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] SftpOperations                 DEBUG Took 0.031 seconds (31 millis) to store file: test.txt.part and FTP client returned: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] RemoteFileProducer             DEBUG Wrote [myfolder1\myfolder2\test.txt.part] to [Endpoint[sftp://username@linuxServer?tempFileName=%24%7Bfile%3Aonlyname%7D.part]]
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] SftpOperations                 DEBUG Renaming file: myfolder1\myfolder2\test.txt.part to: myfolder1\myfolder2\test.txt
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] RemoteFileProducer             WARN  Writing file failed with: Cannot rename file from: myfolder1\myfolder2\test.txt.part to: myfolder1\myfolder2\test.txt
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] RemoteFileProducer             DEBUG Disconnecting from: Endpoint[sftp://username@linuxServer?tempFileName=%24%7Bfile%3Aonlyname%7D.part]
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] DefaultErrorHandler            DEBUG Failed delivery &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (MessageId: ID-WINDOWSERVER-55343-1503948693519-0-1 on ExchangeId: ID-WINDOWSERVER-55343-1503948693519-0-2). On delivery attempt: 0 caught: org.apache.camel.component.file.GenericFileOperationFailedException: Cannot rename file from: myfolder1\myfolder2\test.txt.part to: myfolder1\myfolder2\test.txt
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] DefaultErrorHandler            ERROR Failed delivery &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (MessageId: ID-WINDOWSERVER-55343-1503948693519-0-1 on ExchangeId: ID-WINDOWSERVER-55343-1503948693519-0-2). Exhausted after delivery attempt: 1 caught: org.apache.camel.component.file.GenericFileOperationFailedException: Cannot rename file from: myfolder1\myfolder2\test.txt.part to: myfolder1\myfolder2\test.txt
&lt;/span&gt;
Message History
---------------------------------------------------------------------------------------------------------------------------------------
RouteId              ProcessorId          Processor                                                                        Elapsed (ms)
[route2            ] [route2            ] [file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder?delay=60000&amp;amp;recursive=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;                                ] [     22188]
&lt;/span&gt;[route2            ] [log3              ] [log                                                                           ] [        35]
[route2            ] [to5               ] [sftp:&lt;span class=&quot;code-comment&quot;&gt;//username@linuxServer?tempFileName=${file:onlyname}.part                ] [     21660]
&lt;/span&gt;
Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------
org.apache.camel.component.file.GenericFileOperationFailedException: Cannot rename file from: myfolder1\myfolder2\test.txt.part to: myfolder1\myfolder2\test.txt
	at org.apache.camel.component.file.remote.SftpOperations.renameFile(SftpOperations.java:431)[camel-ftp-2.17.3.jar:2.17.3]
	at org.apache.camel.component.file.GenericFileProducer.processExchange(GenericFileProducer.java:198)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.component.file.remote.RemoteFileProducer.process(RemoteFileProducer.java:58)[camel-ftp-2.17.3.jar:2.17.3]
	at org.apache.camel.util.AsyncProcessorConverterHelper$ProcessorToAsyncProcessorBridge.process(AsyncProcessorConverterHelper.java:61)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.processor.SendProcessor$2.doInAsyncProducer(SendProcessor.java:173)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.impl.ProducerCache.doInAsyncProducer(ProducerCache.java:341)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:168)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:77)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:163)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:468)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:197)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:121)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.processor.Pipeline.process(Pipeline.java:83)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.processor.CamelInternalProcessor.process(CamelInternalProcessor.java:197)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.component.file.GenericFileConsumer.processExchange(GenericFileConsumer.java:454)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.component.file.GenericFileConsumer.processBatch(GenericFileConsumer.java:226)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:190)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.impl.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:175)[camel-core-2.17.3.jar:2.17.3]
	at org.apache.camel.impl.ScheduledPollConsumer.run(ScheduledPollConsumer.java:102)[camel-core-2.17.3.jar:2.17.3]
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)[:1.8.0_131]
	at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)[:1.8.0_131]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)[:1.8.0_131]
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)[:1.8.0_131]
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)[:1.8.0_131]
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)[:1.8.0_131]
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)[:1.8.0_131]
[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] Pipeline                       DEBUG Message exchange has failed: so breaking out of pipeline &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; exchange: Exchange[ID-VACSWVNGAI02-55343-1503948693519-0-2] Exception: org.apache.camel.component.file.GenericFileOperationFailedException: Cannot rename file from: myfolder1\myfolder2\test.txt.part to: myfolder1\myfolder2\test.txt
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] GenericFileOnCompletion        DEBUG Done processing file: GenericFile[myfolder1\myfolder2\test.txt] using exchange: Exchange[ID-VACSWVNGAI02-55343-1503948693519-0-2]
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] GenericFileOnCompletion        WARN  Rollback file strategy: org.apache.camel.component.file.strategy.GenericFileRenameProcessStrategy@4dbe767f &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; file: GenericFile[myfolder1\myfolder2\test.txt]
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] FileUtil                       DEBUG Retrying attempt 0 to delete file: E:\relay\sourceFolder\myfolder1\myfolder2\test.txt.camelLock
&lt;/span&gt;[hread #6 - file:&lt;span class=&quot;code-comment&quot;&gt;//sourceFolder] FileUtil                       DEBUG Tried 1 to delete file: E:\relay\sourceFolder\myfolder1\myfolder2\test.txt.camelLock with result: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16174574" author="davsclaus" created="Thu, 21 Sep 2017 11:02:36 +0000"  >&lt;p&gt;Can you try with stepwise=false option configured on the ftp endpoints&lt;/p&gt;</comment>
                            <comment id="16222198" author="onders" created="Fri, 27 Oct 2017 11:34:53 +0000"  >&lt;p&gt;today, i had a chance to test the case from windows client against unix ftp.&lt;br/&gt;
&lt;tt&gt;stepwise=false&lt;/tt&gt; does not seem to help. The problem is because the folder structure seems to get created on unix Server with Windows separators and jcraft&apos;s rename method needs &apos;/&apos; even if it is on windows. Sending PR soon.&lt;/p&gt;</comment>
                            <comment id="16222213" author="githubbot" created="Fri, 27 Oct 2017 11:52:36 +0000"  >&lt;p&gt;onders86 opened a new pull request #2066: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11387&quot; title=&quot;SFTP is delivered into incorrect location, without exception (file in subfolder + temp file is created + Camel running on Window &amp;amp; SFTP server running on LINUX)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11387&quot;&gt;&lt;del&gt;CAMEL-11387&lt;/del&gt;&lt;/a&gt; - adjust destination filename by calling existing method &#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2066&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2066&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &#8230;to make it compact as jcraft seems to need it&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16222215" author="githubbot" created="Fri, 27 Oct 2017 11:52:37 +0000"  >&lt;p&gt;GitHub user onders86 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2066&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2066&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11387&quot; title=&quot;SFTP is delivered into incorrect location, without exception (file in subfolder + temp file is created + Camel running on Window &amp;amp; SFTP server running on LINUX)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11387&quot;&gt;&lt;del&gt;CAMEL-11387&lt;/del&gt;&lt;/a&gt; - adjust destination filename by calling existing method &#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;to make it compact as jcraft seems to need it&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/onders86/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/onders86/camel&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11387&quot; title=&quot;SFTP is delivered into incorrect location, without exception (file in subfolder + temp file is created + Camel running on Window &amp;amp; SFTP server running on LINUX)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11387&quot;&gt;&lt;del&gt;CAMEL-11387&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2066.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2066.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2066&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9bb3b342516ac6362de72da0e5a220d0018edcf7&lt;br/&gt;
Author: onders86 &amp;lt;ondersezgin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-10-27T11:46:08Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11387&quot; title=&quot;SFTP is delivered into incorrect location, without exception (file in subfolder + temp file is created + Camel running on Window &amp;amp; SFTP server running on LINUX)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11387&quot;&gt;&lt;del&gt;CAMEL-11387&lt;/del&gt;&lt;/a&gt; - adjust destination filename by calling existing method to make it compact as jcraft seems to need it&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16222261" author="githubbot" created="Fri, 27 Oct 2017 12:19:48 +0000"  >&lt;p&gt;davsclaus commented on a change in pull request #2066: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11387&quot; title=&quot;SFTP is delivered into incorrect location, without exception (file in subfolder + temp file is created + Camel running on Window &amp;amp; SFTP server running on LINUX)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11387&quot;&gt;&lt;del&gt;CAMEL-11387&lt;/del&gt;&lt;/a&gt; - adjust destination filename by calling existing method &#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2066#discussion_r147395660&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2066#discussion_r147395660&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/FtpOperations.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -269,6 +269,9 @@ public boolean deleteFile(String name) throws GenericFileOperationFailedExceptio&lt;br/&gt;
     public boolean renameFile(String from, String to) throws GenericFileOperationFailedException {&lt;br/&gt;
         log.debug(&quot;Renaming file: {} to: {}&quot;, from, to);&lt;br/&gt;
         try {&lt;br/&gt;
+            //make use of the &apos;/&apos; separator because JSch expects this &lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   JSch is only used for SftpOperations. So this comment is a bit mis-leading. ftp is using commons-net&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16222262" author="githubbot" created="Fri, 27 Oct 2017 12:22:35 +0000"  >&lt;p&gt;onders86 commented on a change in pull request #2066: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11387&quot; title=&quot;SFTP is delivered into incorrect location, without exception (file in subfolder + temp file is created + Camel running on Window &amp;amp; SFTP server running on LINUX)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11387&quot;&gt;&lt;del&gt;CAMEL-11387&lt;/del&gt;&lt;/a&gt; - adjust destination filename by calling existing method &#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2066#discussion_r147396213&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2066#discussion_r147396213&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/FtpOperations.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -269,6 +269,9 @@ public boolean deleteFile(String name) throws GenericFileOperationFailedExceptio&lt;br/&gt;
     public boolean renameFile(String from, String to) throws GenericFileOperationFailedException {&lt;br/&gt;
         log.debug(&quot;Renaming file: {} to: {}&quot;, from, to);&lt;br/&gt;
         try {&lt;br/&gt;
+            //make use of the &apos;/&apos; separator because JSch expects this &lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   good catch. i will update soon.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16222304" author="githubbot" created="Fri, 27 Oct 2017 12:48:41 +0000"  >&lt;p&gt;davsclaus commented on issue #2066: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11387&quot; title=&quot;SFTP is delivered into incorrect location, without exception (file in subfolder + temp file is created + Camel running on Window &amp;amp; SFTP server running on LINUX)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11387&quot;&gt;&lt;del&gt;CAMEL-11387&lt;/del&gt;&lt;/a&gt; - adjust destination filename by calling existing method &#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2066#issuecomment-339962015&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2066#issuecomment-339962015&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   The ticket was reporting SFTP only (eg JCraft). Can this PR only change that one - as the other FTP client has not been reported issues like this, and its better not to change it.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16222601" author="githubbot" created="Fri, 27 Oct 2017 15:57:33 +0000"  >&lt;p&gt;onders86 closed pull request #2066: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11387&quot; title=&quot;SFTP is delivered into incorrect location, without exception (file in subfolder + temp file is created + Camel running on Window &amp;amp; SFTP server running on LINUX)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11387&quot;&gt;&lt;del&gt;CAMEL-11387&lt;/del&gt;&lt;/a&gt; - adjust destination filename by calling existing method &#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2066&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2066&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/SftpOperations.java b/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/SftpOperations.java&lt;br/&gt;
index 1721c40da12..84d427f875c 100644&lt;br/&gt;
&amp;#8212; a/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/SftpOperations.java&lt;br/&gt;
+++ b/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/SftpOperations.java&lt;br/&gt;
@@ -447,6 +447,9 @@ public synchronized boolean renameFile(String from, String to) throws GenericFil&lt;br/&gt;
         LOG.debug(&quot;Renaming file: {} to: {}&quot;, from, to);&lt;br/&gt;
         try &lt;/p&gt;
{
             reconnectIfNecessary();
+            //make use of the &apos;/&apos; separator because JSch expects this 
+            // as the file separator even on Windows
+            to = FileUtil.compactPath(to, &apos;/&apos;);
             channel.rename(from, to);
             return true;
         }
&lt;p&gt; catch (SftpException e) {&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16222602" author="githubbot" created="Fri, 27 Oct 2017 15:57:34 +0000"  >&lt;p&gt;Github user onders86 closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2066&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2066&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16222691" author="onders" created="Fri, 27 Oct 2017 17:08:53 +0000"  >&lt;p&gt;Backport needed?&lt;/p&gt;</comment>
                            <comment id="16223294" author="davsclaus" created="Sat, 28 Oct 2017 07:15:02 +0000"  >&lt;p&gt;Great work Onder.&lt;/p&gt;

&lt;p&gt;Yeah I think its a good idea to backport to 2.20.x and 2.19.x as well.&lt;/p&gt;</comment>
                            <comment id="16223438" author="onders" created="Sat, 28 Oct 2017 11:46:52 +0000"  >&lt;p&gt;backported 2.19.x and 2.20.x.&lt;br/&gt;
thanks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 3 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3g2db:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>