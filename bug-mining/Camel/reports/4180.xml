<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:24:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-11509] Cannot set content type with parameters without specifying charset</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-11509</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When setting a content type that does not contain a charset parameter, for example this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;.setHeader(&quot;Content-Type&quot;, constant(&quot;application/json;odata=verbose&quot;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the route will fail with the following exception:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.IllegalArgumentException: MIME type may not contain reserved characters
	at org.apache.http.util.Args.check(Args.java:36)
	at org.apache.http.entity.ContentType.create(ContentType.java:206)
	at org.apache.http.entity.ContentType.create(ContentType.java:218)
	at org.apache.camel.component.http4.HttpProducer.createRequestEntity(HttpProducer.java:511)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;although this is clearly a valid content type according to the RFC: &lt;a href=&quot;https://tools.ietf.org/html/rfc2045#section-5.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://tools.ietf.org/html/rfc2045#section-5.1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This only affects version 2.19+, because in version 4.4.6 of the httpcomponents-core library, they changed the behavior of &lt;tt&gt;create&lt;/tt&gt; to check the mime type for semicolons, which it previously didn&apos;t. If we, however, also use a charset parameter, you will call the &lt;tt&gt;parse&lt;/tt&gt; method instead:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;if (contentTypeString != null) {
    if (contentTypeString.indexOf(&quot;charset&quot;) &amp;gt; 0) {
        contentType = ContentType.parse(contentTypeString);
    } else {
        contentType = ContentType.create(contentTypeString);
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There can be all kind of different parameters, though. Instead of checking for charset, it should rather check for the existence of a semicolon. &lt;/p&gt;</description>
                <environment></environment>
        <key id="13084528">CAMEL-11509</key>
            <summary>Cannot set content type with parameters without specifying charset</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="onders">Onder Sezgin</assignee>
                                    <reporter username="sflor">Steffen F.</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Jul 2017 12:04:46 +0000</created>
                <updated>Fri, 14 Jul 2017 23:40:55 +0000</updated>
                            <resolved>Fri, 14 Jul 2017 23:40:26 +0000</resolved>
                                    <version>2.19.0</version>
                    <version>2.19.1</version>
                                    <fixVersion>2.19.2</fixVersion>
                    <fixVersion>2.20.0</fixVersion>
                                    <component>camel-http4</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16073553" author="davsclaus" created="Tue, 4 Jul 2017 12:12:53 +0000"  >&lt;p&gt;You are welcome to provide a patch or better as a github PR with a fix&lt;br/&gt;
&lt;a href=&quot;http://camel.apache.org/contributing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.apache.org/contributing&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16073634" author="sflor" created="Tue, 4 Jul 2017 12:58:49 +0000"  >&lt;p&gt;No idea what to do really, because there seems to be a workaround for something (according to the comments):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;//Check the contentType is valid or not, If not it throws an exception.
//When ContentType.parse parse method parse &quot;multipart/form-data;boundary=---------------------------j2radvtrk&quot;,
//it removes &quot;boundary&quot; from Content-Type; I have to use contentType.create method.
if (contentTypeString != null) {
    // using ContentType.parser for charset
    if (contentTypeString.indexOf(&quot;charset&quot;) &amp;gt; 0) {
        contentType = ContentType.parse(contentTypeString);
    } else {
        contentType = ContentType.create(contentTypeString);
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;which, then again, shouldn&apos;t work anymore, because &lt;tt&gt;ContentType.create&lt;/tt&gt; will now throw an exception for any content type containing a semicolon.&lt;/p&gt;</comment>
                            <comment id="16073639" author="sflor" created="Tue, 4 Jul 2017 13:03:17 +0000"  >&lt;p&gt;See also &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-7886&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CAMEL-7886&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Maybe we can now use only use &lt;tt&gt;parse&lt;/tt&gt; instead without any checks. &lt;/p&gt;</comment>
                            <comment id="16074721" author="githubbot" created="Wed, 5 Jul 2017 13:09:24 +0000"  >&lt;p&gt;GitHub user onders86 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1805&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11509&quot; title=&quot;Cannot set content type with parameters without specifying charset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11509&quot;&gt;&lt;del&gt;CAMEL-11509&lt;/del&gt;&lt;/a&gt; - check for semicolon added to call ContentType.create&lt;/p&gt;

&lt;p&gt;    As mentioned in the issue when ContentType.create is called for such cases, it breaks HttpProducerContentTypeTest.java.&lt;br/&gt;
    if not, the issue is up.&lt;/p&gt;

&lt;p&gt;    As a workaround issue, simple check is added.&lt;br/&gt;
    We may need to check why ContentType.create fails whereas ContentType.parse not as @WillemJiang commented on &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-7886&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CAMEL-7886&lt;/a&gt;&lt;br/&gt;
    and fixed in the issue like &lt;/p&gt;

&lt;p&gt;    `&lt;br/&gt;
    //Check the contentType is valid or not, If not it throws an exception.&lt;br/&gt;
    //When ContentType.parse parse method parse &quot;multipart/form-data;boundary=---------------------------j2radvtrk&quot;,&lt;br/&gt;
    //it removes &quot;boundary&quot; from Content-Type; I have to use contentType.create method.&lt;br/&gt;
    if (contentTypeString != null) {&lt;br/&gt;
        // using ContentType.parser for charset&lt;br/&gt;
        if (contentTypeString.indexOf(&quot;charset&quot;) &amp;gt; 0) &lt;/p&gt;
{
            contentType = ContentType.parse(contentTypeString);
        }
&lt;p&gt; else &lt;/p&gt;
{
            contentType = ContentType.create(contentTypeString);
        }
&lt;p&gt;    }&lt;br/&gt;
    `&lt;/p&gt;

&lt;p&gt;    I will also try to catch up with httpcomponents and revisit the issue.&lt;/p&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/onders86/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/onders86/camel&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11509&quot; title=&quot;Cannot set content type with parameters without specifying charset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11509&quot;&gt;&lt;del&gt;CAMEL-11509&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1805.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1805.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1805&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 3a5551a4188c53bb3b9cce06f64078fb647a7aa5&lt;br/&gt;
Author: onders86 &amp;lt;ondersezgin@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-07-05T12:33:27Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11509&quot; title=&quot;Cannot set content type with parameters without specifying charset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11509&quot;&gt;&lt;del&gt;CAMEL-11509&lt;/del&gt;&lt;/a&gt; - httpcomponents-core 4.4.6 ContentType.create changed. so use ContentType.parse instead&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16074730" author="onders" created="Wed, 5 Jul 2017 13:15:01 +0000"  >&lt;p&gt;even if you pass like this,&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;.setHeader(&quot;Content-Type&quot;, constant(&quot;application/json;odata=verbose&quot;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the endpoint sees the content-type like &quot;application/json; odata=verbose&quot;.&lt;/p&gt;

&lt;p&gt;please notice the space after ;&lt;/p&gt;

&lt;p&gt;that&apos;s why there is a trick in this line;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/camel/pull/1805#discussion-diff-125638439R92&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1805#discussion-diff-125638439R92&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16085697" author="onders" created="Thu, 13 Jul 2017 13:27:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sflor&quot; class=&quot;user-hover&quot; rel=&quot;sflor&quot;&gt;sflor&lt;/a&gt; please see Oleg&apos;s comment&apos;s in the issue &lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-476&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/HTTPCORE-476&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;.setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt;, constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;application/json;odata=verbose&quot;&lt;/span&gt;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;seems to be wrong.&lt;br/&gt;
Apart from that the fix in the PR will help for other cases where &lt;tt&gt;ContentType#create&lt;/tt&gt; fails with the header you may provide like &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;multipart/form-data;boundary=---------------------------j2radvtrk
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and if containing &apos;;&apos; char, parse will be called.&lt;/p&gt;

&lt;p&gt;I will check-in PR to master and backport to camel-2.19.x soon.&lt;/p&gt;

&lt;p&gt;Cheers&lt;/p&gt;</comment>
                            <comment id="16088298" author="githubbot" created="Fri, 14 Jul 2017 23:40:55 +0000"  >&lt;p&gt;Github user onders86 closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1805&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                            <customfield id="customfield_12311024" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>External issue ID</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>&lt;a href=&quot;https://issues.apache.org/jira/browse/HTTPCORE-476&quot;&gt;https://issues.apache.org/jira/browse/HTTPCORE-476&lt;/a&gt;</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://issues.apache.org/jira/browse/HTTPCORE-476]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3h2sv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>