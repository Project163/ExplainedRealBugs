<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:56:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-18042] doCatch of a rollback only executes one line after doCatch and prune the rest of the route</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-18042</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I have following route (simplified)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        from(&lt;span class=&quot;code-quote&quot;&gt;&quot;quartz:&lt;span class=&quot;code-comment&quot;&gt;//MY_CTRL?cron=0+0/10+8-12+?+*+MON-FRI&quot;&lt;/span&gt;).routeId(&lt;span class=&quot;code-quote&quot;&gt;&quot;MY_CTRL&quot;&lt;/span&gt;).
&lt;/span&gt;                transacted(&lt;span class=&quot;code-quote&quot;&gt;&quot;PROPAGATION_NEVER&quot;&lt;/span&gt;).
.
.
.
                doTry().
                to(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:MY_CSV&quot;&lt;/span&gt;).
                doCatch(Throwable.class).
                log(&lt;span class=&quot;code-quote&quot;&gt;&quot;CSV generation or upload failed. So delete azure blob&quot;&lt;/span&gt;).
                log(&lt;span class=&quot;code-quote&quot;&gt;&quot;blahblahblah&quot;&lt;/span&gt;).
                end(); &lt;span class=&quot;code-comment&quot;&gt;// end &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
&lt;/span&gt;
        from(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:MY_CSV&quot;&lt;/span&gt;).routeId(&lt;span class=&quot;code-quote&quot;&gt;&quot;MY_CSV&quot;&lt;/span&gt;).
                transacted().
.
.
.
                filter(body().isNotEqualTo(&lt;span class=&quot;code-object&quot;&gt;Boolean&lt;/span&gt;.TRUE)).
                rollback()
                stop().
                end().
.
.
.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;that doesn&apos;t print &lt;tt&gt;blahblahblah&lt;/tt&gt;. When I replace &lt;tt&gt;rolback()&lt;/tt&gt; with &lt;tt&gt;throwException(new RuntimeException(&quot;Failed to upload&quot;))&lt;/tt&gt; it does.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13442961">CAMEL-18042</key>
            <summary>doCatch of a rollback only executes one line after doCatch and prune the rest of the route</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="yasserzamani">Yasser Zamani</reporter>
                        <labels>
                    </labels>
                <created>Tue, 3 May 2022 13:10:24 +0000</created>
                <updated>Mon, 6 Jun 2022 10:19:19 +0000</updated>
                            <resolved>Mon, 6 Jun 2022 10:19:19 +0000</resolved>
                                    <version>3.16.0</version>
                                    <fixVersion>3.18.0</fixVersion>
                                    <component>came-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17531188" author="davsclaus" created="Tue, 3 May 2022 13:23:26 +0000"  >&lt;p&gt;You added `stop` which tells Camel to not continue routing, so the doFinally will stop too. &lt;/p&gt;</comment>
                            <comment id="17531231" author="yasser.zamani" created="Tue, 3 May 2022 14:39:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; Firstly I&apos;m not talking about doFinally, but about doCatch. It&apos;s not the case anyway. Furthermore everyone rationally expects stopping the rest of the route when exception occurs, you&apos;re right, but I&apos;m talking about the first route.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Sorry I think you haven&apos;t read description carefully please. Again, when I use &lt;tt&gt;throwException(new RuntimeException(&quot;Failed to upload&quot;))&lt;/tt&gt; instead of &lt;tt&gt;rollback()&lt;/tt&gt; in the second route, I see both logs in the first route (i.e. it doesn&apos;t stop in your words). But with &lt;tt&gt;rollback()&lt;/tt&gt; I see only the first log. Trust me. I struggled a lot with it. In summary we can&apos;t catch the exception thrown by &lt;tt&gt;rolback()&lt;/tt&gt; in Camel, because I don&apos;t know what Camel does internally but anyway it causes to execute only one step after doCatch and prunes the rest of the route.&lt;/p&gt;</comment>
                            <comment id="17533723" author="yasser.zamani" created="Mon, 9 May 2022 09:42:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; I accidentally (because of another app another route) realized that looks like in new versions of Camel, doTry doCatch needs &lt;b&gt;two&lt;/b&gt; &lt;tt&gt;.end()&lt;/tt&gt; s! (it doesn&apos;t match Camel docs). That being said, when I add another &lt;tt&gt;.end() // end catch&lt;/tt&gt; before last &lt;tt&gt;.end()&lt;/tt&gt; in the first route above, it starts working with &lt;tt&gt;.rollback()&lt;/tt&gt;!!!&lt;/p&gt;</comment>
                            <comment id="17547945" author="yasser.zamani" created="Sat, 4 Jun 2022 10:16:17 +0000"  >&lt;p&gt;So I faced the issue again. I&apos;m sure that&#160;&lt;tt&gt;.doCatch&lt;/tt&gt; doesn&apos;t work properly with &lt;tt&gt;.rollback&lt;/tt&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 23 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z120uw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>