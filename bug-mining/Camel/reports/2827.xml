<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:03:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-7662] MQTTProducerTest fails once enables it</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-7662</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;MQTTProducerTest fails once you enable this testcase. This is disabled here:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/blob/master/components/camel-mqtt/pom.xml#L84&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/master/components/camel-mqtt/pom.xml#L84&lt;/a&gt;&lt;br/&gt;
Although this may be a known issue as it&apos;s explicitly disabled, I&apos;m filing this anyway since I couldn&apos;t find any corresponding JIRA.&lt;/p&gt;

&lt;p&gt;It fails with different error on 2.12.2 and current upstream master, but both case show the producer can&apos;t send messages through the MQTT producer correctly. I think there is an issue in camel-mqtt since I hit same issue in our application (&lt;a href=&quot;https://issues.jboss.org/browse/SWITCHYARD-2221&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://issues.jboss.org/browse/SWITCHYARD-2221&lt;/a&gt;), but even if the problem is in the testcase, it still needs to be replaced with appropriate testcase to verify MQTT producer works correctly.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12731963">CAMEL-7662</key>
            <summary>MQTTProducerTest fails once enables it</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="igarashitm">Tomohisa Igarashi</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Aug 2014 08:36:05 +0000</created>
                <updated>Mon, 17 Nov 2014 08:01:39 +0000</updated>
                            <resolved>Mon, 17 Nov 2014 08:01:39 +0000</resolved>
                                    <version>2.12.2</version>
                    <version>2.14.0</version>
                                    <fixVersion>2.13.4</fixVersion>
                    <fixVersion>2.14.1</fixVersion>
                    <fixVersion>2.15.0</fixVersion>
                                    <component>camel-mqtt</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14087271" author="igarashitm" created="Wed, 6 Aug 2014 05:28:53 +0000"  >&lt;p&gt;&lt;a href=&quot;http://camel.465427.n5.nabble.com/Dispatch-queue-mqtt-client-was-not-executing-error-from-camel-mqtt-producer-td5753937.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.465427.n5.nabble.com/Dispatch-queue-mqtt-client-was-not-executing-error-from-camel-mqtt-producer-td5753937.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14094010" author="igarashitm" created="Tue, 12 Aug 2014 12:17:42 +0000"  >&lt;p&gt;This attaching example reproduces the issue by CamelMQTTExampleTest - it fails with following error in spite of it succeeds if it runs with &quot;mvn exec:java -PExample -DskipTests=true&quot;. CamelMQTTExampleTest just kicks CamelMQTTExample. No difference between exec:java and test. So this strange behavior is only shown in unit test.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.lang.AssertionError: Dispatch queue &lt;span class=&quot;code-quote&quot;&gt;&apos;mqtt client&apos;&lt;/span&gt; was not executing, (currently executing: &lt;span class=&quot;code-quote&quot;&gt;&apos;&amp;lt;not-dispatched&amp;gt;&apos;&lt;/span&gt;)
	at org.fusesource.hawtdispatch.internal.SerialDispatchQueue.assertExecuting(SerialDispatchQueue.java:145)
	at org.fusesource.mqtt.client.CallbackConnection.publish(CallbackConnection.java:585)
	at org.fusesource.mqtt.client.CallbackConnection.publish(CallbackConnection.java:581)
	at org.apache.camel.component.mqtt.MQTTEndpoint.publish(MQTTEndpoint.java:160)
	at org.apache.camel.component.mqtt.MQTTProducer.process(MQTTProducer.java:58)
	at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:120)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14094049" author="njiang" created="Tue, 12 Aug 2014 13:23:52 +0000"  >&lt;p&gt;Hi Tomohisa,&lt;/p&gt;

&lt;p&gt;Can you explain why there is an file of byteman.btm?&lt;br/&gt;
Does it have something with running the unit test?&lt;/p&gt;
</comment>
                            <comment id="14094052" author="igarashitm" created="Tue, 12 Aug 2014 13:30:01 +0000"  >&lt;p&gt;Hi Willem,&lt;/p&gt;

&lt;p&gt;Just ignore the byteman.btm - you can run the unit test with byteman if you add -PByteman, but not necessarily.&lt;/p&gt;</comment>
                            <comment id="14096754" author="njiang" created="Thu, 14 Aug 2014 08:48:43 +0000"  >&lt;p&gt;Hi Tomohisa,&lt;/p&gt;

&lt;p&gt;I managed to find out why the unit test cannot work, even it does the same work as the example does.&lt;br/&gt;
First the exception is java &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/technotes/guides/language/assert.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;assertion&lt;/a&gt; exception, it is thrown from &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.lang.AssertionError: Dispatch queue &lt;span class=&quot;code-quote&quot;&gt;&apos;mqtt client&apos;&lt;/span&gt; was not executing, (currently executing: &lt;span class=&quot;code-quote&quot;&gt;&apos;&amp;lt;not-dispatched&amp;gt;&apos;&lt;/span&gt;)
	at org.fusesource.hawtdispatch.internal.SerialDispatchQueue.assertExecuting(SerialDispatchQueue.java:145)
	at org.fusesource.mqtt.client.CallbackConnection.publish(CallbackConnection.java:585)
	at org.fusesource.mqtt.client.CallbackConnection.publish(CallbackConnection.java:581)
	at org.apache.camel.component.mqtt.MQTTEndpoint.publish(MQTTEndpoint.java:160)
	at org.apache.camel.component.mqtt.MQTTProducer.process(MQTTProducer.java:58)
	at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:120)
	... 36 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;By default, JVM assertions are disabled at runtime, but Surefire enables JVM assertions for the execution of your test cases by default. That could explain why you can get the different result here in the unit test.&lt;br/&gt;
If you disable the assertion in the surefire configuration just like this, the test is passed.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;          &amp;lt;plugin&amp;gt;
                &amp;lt;artifactId&amp;gt;maven-surefire-plugin&amp;lt;/artifactId&amp;gt;
                &amp;lt;configuration&amp;gt;
                    &amp;lt;forkMode&amp;gt;perTest&amp;lt;/forkMode&amp;gt;
                    &amp;lt;enableAssertions&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;lt;/enableAssertions&amp;gt;
                &amp;lt;/configuration&amp;gt;
            &amp;lt;/plugin&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I will ping Hiram for the assertion in the hawtdispatch at the mean time.&lt;/p&gt;</comment>
                            <comment id="14096902" author="igarashitm" created="Thu, 14 Aug 2014 12:10:14 +0000"  >&lt;p&gt;Ah good catch! I didn&apos;t notice that. Thanks for handling this.&lt;/p&gt;</comment>
                            <comment id="14105229" author="njiang" created="Thu, 21 Aug 2014 09:09:30 +0000"  >&lt;p&gt;Enable the test by disable the assertion when running the unit test in Apache Camel trunk.&lt;/p&gt;</comment>
                            <comment id="14149128" author="chirino" created="Fri, 26 Sep 2014 13:18:15 +0000"  >&lt;p&gt;Disabling the assertions is the wrong thing to do.  The assertion failure is telling you that camel is using the MQTT client incorrectly.&lt;/p&gt;</comment>
                            <comment id="14213900" author="githubbot" created="Sun, 16 Nov 2014 10:10:50 +0000"  >&lt;p&gt;GitHub user igarashitm opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/333&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/333&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-7662&quot; title=&quot;MQTTProducerTest fails once enables it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-7662&quot;&gt;&lt;del&gt;CAMEL-7662&lt;/del&gt;&lt;/a&gt; MQTTProducerTest fails once enables it&lt;/p&gt;

&lt;p&gt;    The assertion expects MQTT publish/disconnect call to be submitted as a async task, i.e. enqueued in a dispatch queue&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/igarashitm/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/igarashitm/camel&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-7662&quot; title=&quot;MQTTProducerTest fails once enables it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-7662&quot;&gt;&lt;del&gt;CAMEL-7662&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/333.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/333.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #333&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit f686fcb0d3c1a97a561474eb75d934310b8f9e44&lt;br/&gt;
Author: Tomohisa Igarashi &amp;lt;tm.igarashi@gmail.com&amp;gt;&lt;br/&gt;
Date:   2014-11-16T07:55:45Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-7662&quot; title=&quot;MQTTProducerTest fails once enables it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-7662&quot;&gt;&lt;del&gt;CAMEL-7662&lt;/del&gt;&lt;/a&gt; MQTTProducerTest fails once enables it&lt;/p&gt;

&lt;p&gt;    The assertion expects MQTT publish/disconnect call to be submitted as a async task, i.e. enqueued in a dispatch queue&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="14213902" author="igarashitm" created="Sun, 16 Nov 2014 10:27:22 +0000"  >&lt;p&gt;I looked into this issue again and finally found what should be done. So the assertion expects MQTT publish call to be enqueued in a dispatch queue, but camel MQTTEndpoint was invoking it directly. For the same reason, disconnect was also failing, it was just a WARN on shutdown though. &lt;/p&gt;</comment>
                            <comment id="14214234" author="githubbot" created="Mon, 17 Nov 2014 03:54:31 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/333&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/333&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14214399" author="njiang" created="Mon, 17 Nov 2014 08:01:39 +0000"  >&lt;p&gt;Merged the patch into camel master, camel-2.14.x and camel-2.13.x branches.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12734028">CAMEL-7697</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12661205" name="camel-example-mqtt.tar.gz" size="9990" author="igarashitm" created="Tue, 12 Aug 2014 12:17:42 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>409992</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 1 week, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1yjfz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>409986</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>