<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:26:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-584] BeanWithPropertiesAndHeadersAndBodyInjectionTest causes java.lang.StackOverflowError</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-584</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;This unit test cases infinitive loop&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.lang.StackOverflowError
	at java.util.HashMap$HashIterator.&amp;lt;init&amp;gt;(HashMap.java:822)
	at java.util.HashMap$EntryIterator.&amp;lt;init&amp;gt;(HashMap.java:881)
	at java.util.HashMap$EntryIterator.&amp;lt;init&amp;gt;(HashMap.java:881)
	at java.util.HashMap.newEntryIterator(HashMap.java:895)
	at java.util.HashMap$EntrySet.iterator(HashMap.java:988)
	at java.util.AbstractMap.toString(AbstractMap.java:584)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.valueOf(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.java:2615)
	at java.lang.StringBuilder.append(StringBuilder.java:116)
	at org.apache.camel.component.bean.BeanWithPropertiesAndHeadersAndBodyInjectionTest$MyBean.toString(BeanWithPropertiesAndHeadersAndBodyInjectionTest.java:91)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.valueOf(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.java:2615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;StringBuffer&lt;/span&gt;.append(&lt;span class=&quot;code-object&quot;&gt;StringBuffer&lt;/span&gt;.java:220)
	at java.util.AbstractMap.toString(AbstractMap.java:598)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.valueOf(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.java:2615)
	at java.lang.StringBuilder.append(StringBuilder.java:116)
	at org.apache.camel.component.bean.BeanWithPropertiesAndHeadersAndBodyInjectionTest$MyBean.toString(BeanWithPropertiesAndHeadersAndBodyInjectionTest.java:91)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.valueOf(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.java:2615)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12485436">CAMEL-584</key>
            <summary>BeanWithPropertiesAndHeadersAndBodyInjectionTest causes java.lang.StackOverflowError</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="davsclaus">Claus Ibsen</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Jun 2008 11:33:22 +0000</created>
                <updated>Sun, 6 Jul 2008 06:29:28 +0000</updated>
                            <resolved>Fri, 6 Jun 2008 12:27:33 +0000</resolved>
                                    <version>1.4.0</version>
                                    <fixVersion>1.4.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12947387" author="davsclaus" created="Fri, 6 Jun 2008 11:47:44 +0000"  >&lt;p&gt;The bug is in BeanProcessor that adds the bean itself as a propery the the exchange&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void process(Exchange exchange) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isDebugEnabled()) {
            LOG.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;gt;&amp;gt;&amp;gt;&amp;gt; invoking method &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;: &quot;&lt;/span&gt; + exchange);
        }

        &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; bean = beanHolder.getBean();
        exchange.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;CamelBean&quot;&lt;/span&gt;, bean);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And then when you do a toString() as the unit test does with the properties:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; toString() {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;MyBean[foo: &quot;&lt;/span&gt; + foo + &lt;span class=&quot;code-quote&quot;&gt;&quot; bar: &quot;&lt;/span&gt; + bar + &lt;span class=&quot;code-quote&quot;&gt;&quot; body: &quot;&lt;/span&gt; + body + &lt;span class=&quot;code-quote&quot;&gt;&quot;]&quot;&lt;/span&gt;;
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the properties is the foo argument, then you get circular dependency.&lt;/p&gt;


&lt;p&gt;Why do Camel set the bean itself as a property? Is this used by end-users at all?&lt;br/&gt;
&quot;CamelBean&quot; is not used anywhere else in the java code, so I do think its safe to delete the codeline but then end-users that this property existed isn&apos;t there anymore.&lt;/p&gt;

&lt;p&gt;We could remedy this by setting the BeanHolder instead of the bean directly.&lt;/p&gt;</comment>
                            <comment id="12947298" author="davsclaus" created="Fri, 6 Jun 2008 11:56:17 +0000"  >&lt;p&gt;The fix is now:&lt;/p&gt;

&lt;p&gt;Bean component sets a reference to the bean that is being invoked as a property on the Exchange. This property has change its key from &quot;CamelBean&quot; to &quot;org.apache.camel.bean.BeanHolder&quot; and the type is now a BeanHolder.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>83345</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01d53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5898</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>