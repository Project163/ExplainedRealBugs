<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:47:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-16419] Adding core-main dependency throws a NoTypeConversionAvailableException on Duration converter</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-16419</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;This project &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; uses the&#160;maven-assembly-plugin to build fat JARs for the Camel applications it provides; if fat JARs are built and run they work perfectly.&lt;/p&gt;

&lt;p&gt;I tried to add the camel-main dependency to the root pom and to the f1-telemetry-udp-kafka project pom as well, in order to change the application to use the Main class but I noticed that even if without using that class but just adding the camel-main in the pom, the JAR doesn&apos;t work anymore.&lt;/p&gt;

&lt;p&gt;If you try to do so, doing a mvn package and then running&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java -jar f1-telemetry-udp-kafka/target/f1-telemetry-udp-kafka-1.0-SNAPSHOT-jar-with-dependencies.jar
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;it fails with the following error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2021-03-28 22:11:19 ERROR F1UdpKafkaApp:52 - Error starting CamelContext
org.apache.camel.FailedToCreateRouteException: Failed to create route route1 at: &amp;gt;&amp;gt;&amp;gt; Aggregate[io.ppatierno.formula1.DriversRouteBuilder$1@1649b0e6 -&amp;gt; [Split[bean[ref:drivers-splitter method:splitDrivers] -&amp;gt; [process[Processor@0x5f8edcc5], To[kafka:f1-telemetry-drivers?brokers=localhost:9092&amp;amp;clientId=drivers&amp;amp;valueSerializer=io.ppatierno.formula1.DriverSerializer], Log[${body}], Log[Driver[id = ${body.participantData.driverId}, hashtag = ${body.hashtag}]]]]]] &amp;lt;&amp;lt;&amp;lt; in route: Route(route1)[From[direct:drivers] -&amp;gt; [Aggregate[io.ppatiern... because of Error parsing [10000] as a java.time.Duration.
        at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:240)
        at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:74)
        at org.apache.camel.impl.DefaultModelReifierFactory.createRoute(DefaultModelReifierFactory.java:49)
        at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:604)
        at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:556)
        at org.apache.camel.impl.engine.AbstractCamelContext.doInit(AbstractCamelContext.java:2756)
        at org.apache.camel.support.service.BaseService.init(BaseService.java:83)
        at org.apache.camel.impl.engine.AbstractCamelContext.init(AbstractCamelContext.java:2475)
        at org.apache.camel.support.service.BaseService.start(BaseService.java:111)
        at org.apache.camel.impl.engine.AbstractCamelContext.start(AbstractCamelContext.java:2492)
        at io.ppatierno.formula1.F1UdpKafkaApp.main(F1UdpKafkaApp.java:49)
Caused by: java.lang.IllegalArgumentException: Error parsing [10000] as a java.time.Duration.
        at org.apache.camel.support.CamelContextHelper.parse(CamelContextHelper.java:556)
        at org.apache.camel.support.CamelContextHelper.parseDuration(CamelContextHelper.java:500)
        at org.apache.camel.reifier.AbstractReifier.parseDuration(AbstractReifier.java:74)
        at org.apache.camel.reifier.AggregateReifier.createAggregator(AggregateReifier.java:138)
        at org.apache.camel.reifier.AggregateReifier.createProcessor(AggregateReifier.java:52)
        at org.apache.camel.reifier.ProcessorReifier.makeProcessor(ProcessorReifier.java:835)
        at org.apache.camel.reifier.ProcessorReifier.addRoutes(ProcessorReifier.java:576)
        at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:236)
        ... 10 more
Caused by: org.apache.camel.NoTypeConversionAvailableException: No type converter available to convert from type: java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; to the required type: java.time.Duration with value 10000
        at org.apache.camel.impl.converter.CoreTypeConverterRegistry.mandatoryConvertTo(CoreTypeConverterRegistry.java:275)
        at org.apache.camel.impl.converter.CoreTypeConverterRegistry.mandatoryConvertTo(CoreTypeConverterRegistry.java:207)
        at org.apache.camel.support.CamelContextHelper.parse(CamelContextHelper.java:553)
        ... 17 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13368232">CAMEL-16419</key>
            <summary>Adding core-main dependency throws a NoTypeConversionAvailableException on Duration converter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10008">Information Provided</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ppatierno">Paolo Patierno</reporter>
                        <labels>
                    </labels>
                <created>Sun, 28 Mar 2021 20:12:27 +0000</created>
                <updated>Mon, 5 Apr 2021 06:01:58 +0000</updated>
                            <resolved>Tue, 30 Mar 2021 07:43:07 +0000</resolved>
                                    <version>3.8.0</version>
                                                    <component>camel-main</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17310416" author="davsclaus" created="Mon, 29 Mar 2021 04:55:07 +0000"  >&lt;p&gt;See this FAQ&lt;br/&gt;
&lt;a href=&quot;https://camel.apache.org/manual/latest/faq/how-do-i-use-a-big-uber-jar.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://camel.apache.org/manual/latest/faq/how-do-i-use-a-big-uber-jar.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17310418" author="davsclaus" created="Mon, 29 Mar 2021 04:56:57 +0000"  >&lt;p&gt;it smells like you do not include all the metadata files from META-INF when building fat jar.&lt;br/&gt;
In this case its some type converter metadata files that would be missing.&lt;/p&gt;</comment>
                            <comment id="17311205" author="davsclaus" created="Tue, 30 Mar 2021 07:14:26 +0000"  >&lt;p&gt;Okay trying to reproduce, found your code at&lt;br/&gt;
&lt;a href=&quot;https://github.com/ppatierno/formula1-telemetry-kafka&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ppatierno/formula1-telemetry-kafka&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;BTW you can use BOM for camel&lt;br/&gt;
&lt;a href=&quot;https://search.maven.org/artifact/org.apache.camel/camel-bom&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://search.maven.org/artifact/org.apache.camel/camel-bom&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17311223" author="davsclaus" created="Tue, 30 Mar 2021 07:31:46 +0000"  >&lt;p&gt;So its the jar-with-dependencies goal that assemble a fat jar which causes service files from camel to be overridden.&lt;br/&gt;
So when adding camel-main the order of the JARs is shifted and the plugin then causes the services files to be overriden in different order causing it to fail.&lt;/p&gt;

&lt;p&gt;So that it worked before, was a &quot;bit of luck&quot;.&lt;/p&gt;</comment>
                            <comment id="17311235" author="ppatierno" created="Tue, 30 Mar 2021 07:43:27 +0000"  >&lt;p&gt;So what&apos;s the best solution in your opinion? Using the maven shade plugin?&lt;/p&gt;</comment>
                            <comment id="17311252" author="davsclaus" created="Tue, 30 Mar 2021 08:11:06 +0000"  >&lt;p&gt;Okay I got something working. Attaching an old fashioned diff file.&lt;/p&gt;</comment>
                            <comment id="17311253" author="davsclaus" created="Tue, 30 Mar 2021 08:13:06 +0000"  >&lt;p&gt;I had to use a custom assembly descriptor where I work around the TypeConverterLoader clash. &lt;/p&gt;

&lt;p&gt;There is 2 JARs generated, but the my-jar works. I think you can twinker with this to make only 1 jar generated and with the name you want.&lt;/p&gt;

&lt;p&gt;Then in your source code you have in src/main/resources the TypeConverterLoader file, you can then add missing converters as you need.&lt;br/&gt;
I also made you use camel-core-engine so you can trim down the number of camel JARs you need.&lt;/p&gt;</comment>
                            <comment id="17311287" author="davsclaus" created="Tue, 30 Mar 2021 08:48:18 +0000"  >&lt;p&gt;I created a JIRA to research if we can come up with a way to make assembly plugin for fat-jar just work out of the box - as its only the type converter loader files that clashes. The other files are unique folders / names.&lt;/p&gt;</comment>
                            <comment id="17313177" author="davsclaus" created="Thu, 1 Apr 2021 13:32:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ppatierno&quot; class=&quot;user-hover&quot; rel=&quot;ppatierno&quot;&gt;ppatierno&lt;/a&gt; in Camel 3.10 onwards you can do this in the pom.xml of that module where you use Camel&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &amp;lt;build&amp;gt;
    &amp;lt;plugins&amp;gt;
      &amp;lt;plugin&amp;gt;
        &amp;lt;groupId&amp;gt;org.apache.camel&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;camel-maven-plugin&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;${camel.version}&amp;lt;/version&amp;gt;
        &amp;lt;executions&amp;gt;
          &amp;lt;execution&amp;gt;
            &amp;lt;goals&amp;gt;
              &amp;lt;goal&amp;gt;prepare-fatjar&amp;lt;/goal&amp;gt;
            &amp;lt;/goals&amp;gt;
          &amp;lt;/execution&amp;gt;
        &amp;lt;/executions&amp;gt;
      &amp;lt;/plugin&amp;gt;
      &amp;lt;plugin&amp;gt;
        &amp;lt;groupId&amp;gt;org.apache.maven.plugins&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;maven-assembly-plugin&amp;lt;/artifactId&amp;gt;
        &amp;lt;configuration&amp;gt;
          &amp;lt;archive&amp;gt;
            &amp;lt;manifest&amp;gt;
              &amp;lt;mainClass&amp;gt;io.ppatierno.formula1.F1UdpKafkaApp&amp;lt;/mainClass&amp;gt;
            &amp;lt;/manifest&amp;gt;
          &amp;lt;/archive&amp;gt;
        &amp;lt;/configuration&amp;gt;
      &amp;lt;/plugin&amp;gt;
    &amp;lt;/plugins&amp;gt;
  &amp;lt;/build&amp;gt;
  &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then the fatjar works - and you can add camel-main and any other Camel JARs and not get in trouble.&lt;/p&gt;</comment>
                            <comment id="17314515" author="ppatierno" created="Sun, 4 Apr 2021 15:17:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;&#160;that&apos;s cool! Is there an ETA for the 3.10 release to be out?&lt;/p&gt;</comment>
                            <comment id="17314676" author="davsclaus" created="Mon, 5 Apr 2021 06:01:58 +0000"  >&lt;p&gt;We aim for may in 5-6 weeks&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13368590">CAMEL-16429</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13023162" name="patch.diff" size="4746" author="davsclaus" created="Tue, 30 Mar 2021 08:11:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 32 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0paw0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>