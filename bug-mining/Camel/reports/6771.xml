<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:06:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-20769] camel-jms: TemporaryReplyQueueExceptionListener may be causing an endless lock</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-20769</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Looking at the logs for a test that has been hang up on my CI for several hours I noticed that the logs are full of messages like:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2024-05-14 13:08:46,501 [sComponentTest]] WARN &#160;TemporaryQueueReplyManager &#160; &#160; - Exception inside the DMLC &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Temporary ReplyTo Queue &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; destination JmsComponentTest, refreshing ReplyTo destination (stacktrace in DEBUG logging level).
2024-05-14 13:08:46,501 [sComponentTest]] ERROR ultJmsMessageListenerContainer - Could not refresh JMS Connection &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; destination &lt;span class=&quot;code-quote&quot;&gt;&apos;temporary&apos;&lt;/span&gt; - retrying using FixedBackOff{interval=9000, currentAttempts=1908, maxAttempts=unlimited}. Cause: Failed to create session factory; nested exception is ActiveMQNotConnectedException[errorType=NOT_CONNECTED message=AMQ219007: Cannot connect to server(s). Tried with all available servers.]&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The code is in an endless loop on my CI for 6 hours:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
cat target/camel-jms-test.log | grep &lt;span class=&quot;code-quote&quot;&gt;&quot;Exception inside the DMLC &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; Temporary&quot;&lt;/span&gt; | wc -l
1912&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13579226">CAMEL-20769</key>
            <summary>camel-jms: TemporaryReplyQueueExceptionListener may be causing an endless lock</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="orpiske">Otavio Rodolfo Piske</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 May 2024 13:11:22 +0000</created>
                <updated>Wed, 15 May 2024 17:07:33 +0000</updated>
                            <resolved>Wed, 15 May 2024 17:07:33 +0000</resolved>
                                    <version>4.6.0</version>
                                    <fixVersion>4.7.0</fixVersion>
                                    <component>camel-jms</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17846610" author="davsclaus" created="Wed, 15 May 2024 12:29:04 +0000"  >&lt;p&gt;Are you able to see if its a specific test that hangs and keep looping there?&lt;/p&gt;</comment>
                            <comment id="17846611" author="davsclaus" created="Wed, 15 May 2024 12:29:23 +0000"  >&lt;p&gt;Or maybe you have camel-jms-test.log you can attach&lt;/p&gt;</comment>
                            <comment id="17846612" author="davsclaus" created="Wed, 15 May 2024 12:37:06 +0000"  >&lt;p&gt;Okay if I do some dirty thread hacking I can maybe simulate that camel-jms cannot create a temporary queue due to JMS broker failure, and it keeps looping. And then at the same timer the JMS producer is waiting for that reply to queue to be ready. However it uses some old thread await that never gets signalled due to that endless exception. And then in fact we have code afterwards that has a 10 sec timeout waiting for reply to be ready. &lt;/p&gt;</comment>
                            <comment id="17846630" author="davsclaus" created="Wed, 15 May 2024 13:30:19 +0000"  >&lt;p&gt;Okay changing the thread locking code to be similar to wait for provisional message id to be updated, which is more thread safe.&lt;br/&gt;
This could very likely fix this problem.&lt;/p&gt;</comment>
                            <comment id="17846633" author="orpiske" created="Wed, 15 May 2024 13:36:29 +0000"  >&lt;p&gt;Nice one Claus, thanks for looking at it!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1p7q0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>