<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:55:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-5925] NullPointerException in RouteContextProcessor</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-5925</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I am trying to implement a fork/join process where work is read by a single thread, distributed to several parallel threads then joined back to another single thread. I am using Camel SEDA components for interfacing between threads. The single thread at the end must process the messages in the correct order which is why I add a stream resequencer in the route.&lt;/p&gt;

&lt;p&gt;I have built a small prototype that works correctly with a small number of messages (1000 messages, 10 threads in parallel). However if I increase the number of messages (10000 messages, 10 threads) I start getting null pointer exceptions:&lt;br/&gt;
01:35:49.719 &lt;a href=&quot;#0 - Resequencer Delivery&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Camel (camel-1) thread #0 - Resequencer Delivery&lt;/a&gt; WARN  o.a.c.processor.StreamResequencer - Caused by: &lt;span class=&quot;error&quot;&gt;&amp;#91;java.lang.NullPointerException - null&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.lang.NullPointerException: null&lt;br/&gt;
        at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:42) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:303) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:99) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:290) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer.sendElement(StreamResequencer.java:185) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer.sendElement(StreamResequencer.java:65) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.resequencer.ResequencerEngine.deliverNext(ResequencerEngine.java:261) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.resequencer.ResequencerEngine.deliver(ResequencerEngine.java:225) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer$Delivery.run(StreamResequencer.java:242) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;I have tried adjusting the resequencer time-out and capacity without any result. My CPU is only lightly loaded as there is plenty of sleep in the dummy processor. If anybody could tell me what I am doing wrong I would be very grateful. Here is the complete code of my prototype class:&lt;/p&gt;

&lt;p&gt;package camelTest;&lt;/p&gt;

&lt;p&gt;import org.apache.camel.CamelContext;&lt;br/&gt;
import org.apache.camel.Exchange;&lt;br/&gt;
import org.apache.camel.Processor;&lt;br/&gt;
import org.apache.camel.ProducerTemplate;&lt;br/&gt;
import org.apache.camel.builder.RouteBuilder;&lt;br/&gt;
import org.apache.camel.impl.DefaultCamelContext;&lt;br/&gt;
import org.slf4j.Logger;&lt;br/&gt;
import org.slf4j.LoggerFactory;&lt;/p&gt;

&lt;p&gt;/**&lt;br/&gt;
 *&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Simulation of a fork / join parallel processing.&lt;br/&gt;
 *&lt;/li&gt;
	&lt;li&gt;Work is created by the main method, distributed (seda:fork) to several&lt;/li&gt;
	&lt;li&gt;parallel workers, joined back to a single queue (seda:join) and resequenced.&lt;br/&gt;
 *&lt;br/&gt;
 */&lt;br/&gt;
public class MainApp {&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;        private static final Logger LOG = LoggerFactory.getLogger(MainApp.class);&lt;br/&gt;
        private static final int NUMBER_OF_MESSAGES = 10000;&lt;/p&gt;

&lt;p&gt;        public static void main(String... args) throws Exception {&lt;br/&gt;
                CamelContext context = new DefaultCamelContext();&lt;br/&gt;
                context.addRoutes(new MyRouteBuilder());&lt;br/&gt;
                context.start();&lt;/p&gt;

&lt;p&gt;                LOG.info(&quot;Started&quot;);&lt;/p&gt;

&lt;p&gt;                ProducerTemplate template = context.createProducerTemplate();&lt;br/&gt;
                for (int i = 0; i &amp;lt; NUMBER_OF_MESSAGES; i++) &lt;/p&gt;
{
                        template.sendBodyAndHeader(&quot;seda:fork&quot;, &quot;Test Message: &quot; + i,
                                        &quot;seqnum&quot;, new Long(i));
                }

&lt;p&gt;                long expectedTime = NUMBER_OF_MESSAGES&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(RandomSleepProcessor.MAX_PROCESS_TIME + RandomSleepProcessor.MIN_PROCESS_TIME)&lt;br/&gt;
                                / 2 / MyRouteBuilder.CONCURRENCY + MyRouteBuilder.TIMEOUT;&lt;br/&gt;
                LOG.info(&quot;Expected time: {}&quot;, expectedTime);&lt;br/&gt;
                Thread.sleep(expectedTime);&lt;br/&gt;
                LOG.info(&quot;Stopping&quot;);&lt;br/&gt;
                context.stop();&lt;br/&gt;
                LOG.info(&quot;Stopped&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;        }&lt;/p&gt;

&lt;p&gt;        public static class MyRouteBuilder extends RouteBuilder {&lt;br/&gt;
                // Number of concurrent processing threads&lt;br/&gt;
                public static final int CONCURRENCY = 10;&lt;/p&gt;

&lt;p&gt;                // Additional resequencer time-out above theoretical time-out&lt;br/&gt;
                public static final long SAFETY_TIMEOUT = 100;&lt;/p&gt;

&lt;p&gt;                // Additional resequencer capacity above theoretical capacity&lt;br/&gt;
                public static final int SAFETY_CAPACITY = 10;&lt;/p&gt;

&lt;p&gt;                // Resequencer time-out&lt;br/&gt;
                public static final long TIMEOUT = SAFETY_TIMEOUT&lt;br/&gt;
                                + (RandomSleepProcessor.MAX_PROCESS_TIME - RandomSleepProcessor.MIN_PROCESS_TIME);&lt;/p&gt;

&lt;p&gt;                // Resequencer capacity&lt;br/&gt;
                public static final int CAPACITY = SAFETY_CAPACITY&lt;br/&gt;
                                + (int) (CONCURRENCY * TIMEOUT / RandomSleepProcessor.MIN_PROCESS_TIME);&lt;/p&gt;

&lt;p&gt;                public void configure() {&lt;br/&gt;
                        LOG.info(&quot;Number of processor threads: {}&quot;, CONCURRENCY);&lt;br/&gt;
                        LOG.info(&quot;Resequencer time-out: {}&quot;, TIMEOUT);&lt;br/&gt;
                        LOG.info(&quot;Resequencer capacity: {}&quot;, CAPACITY);&lt;br/&gt;
                        Processor myProcessor = new RandomSleepProcessor();&lt;br/&gt;
                        from(&quot;seda:fork?concurrentConsumers=&quot; + CONCURRENCY).process(&lt;br/&gt;
                                        myProcessor).to(&quot;seda:join&quot;);&lt;br/&gt;
                        from(&quot;seda:join&quot;).resequence(header(&quot;seqnum&quot;)).stream()&lt;br/&gt;
                                        .capacity(CAPACITY).timeout(TIMEOUT).to(&quot;mock:result&quot;);&lt;br/&gt;
                }&lt;/p&gt;

&lt;p&gt;        }&lt;/p&gt;

&lt;p&gt;        /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Simulation processor that sleeps a random time between MIN_PROCESS_TIME&lt;/li&gt;
	&lt;li&gt;and MAX_PROCESS_TIME milliseconds.&lt;br/&gt;
         *&lt;br/&gt;
         */&lt;br/&gt;
        public static class RandomSleepProcessor implements Processor {&lt;br/&gt;
                public static final long MIN_PROCESS_TIME = 5;&lt;br/&gt;
                public static final long MAX_PROCESS_TIME = 50;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;                @Override&lt;br/&gt;
                public void process(Exchange arg0) throws Exception {&lt;br/&gt;
                        long processTime = (long) (MIN_PROCESS_TIME + Math.random()&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(MAX_PROCESS_TIME - MIN_PROCESS_TIME));&lt;br/&gt;
                        LOG.debug(&quot;Process time: {}&quot;, processTime);&lt;br/&gt;
                        Thread.sleep(processTime);&lt;br/&gt;
                }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;        }&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;And here is the full log of a run:&lt;br/&gt;
01:35:45.632 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  camelTest.MainApp - Number of processor threads: 10&lt;br/&gt;
01:35:45.635 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  camelTest.MainApp - Resequencer time-out: 145&lt;br/&gt;
01:35:45.635 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  camelTest.MainApp - Resequencer capacity: 300&lt;br/&gt;
01:35:45.674 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.camel.impl.DefaultCamelContext - Apache Camel 2.10.3 (CamelContext: camel-1) is starting&lt;br/&gt;
01:35:45.733 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.c.m.ManagementStrategyFactory - JMX enabled.&lt;br/&gt;
01:35:45.938 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.c.i.c.DefaultTypeConverter - Loaded 172 type converters&lt;br/&gt;
01:35:46.333 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.camel.impl.DefaultCamelContext - Route: route1 started and consuming from: Endpoint&lt;span class=&quot;error&quot;&gt;&amp;#91;seda://fork?concurrentConsumers=10&amp;#93;&lt;/span&gt;&lt;br/&gt;
01:35:46.348 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.camel.impl.DefaultCamelContext - Route: route2 started and consuming from: Endpoint&lt;span class=&quot;error&quot;&gt;&amp;#91;seda://join&amp;#93;&lt;/span&gt;&lt;br/&gt;
01:35:46.348 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.c.m.DefaultManagementLifecycleStrategy - StatisticsLevel at All so enabling load performance statistics&lt;br/&gt;
01:35:46.360 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.camel.impl.DefaultCamelContext - Total 2 routes, of which 2 is started.&lt;br/&gt;
01:35:46.360 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.camel.impl.DefaultCamelContext - Apache Camel 2.10.3 (CamelContext: camel-1) started in 0.688 seconds&lt;br/&gt;
01:35:46.360 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  camelTest.MainApp - Started&lt;br/&gt;
01:35:48.061 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  camelTest.MainApp - Expected time: 27645&lt;br/&gt;
01:35:49.719 &lt;a href=&quot;#0 - Resequencer Delivery&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Camel (camel-1) thread #0 - Resequencer Delivery&lt;/a&gt; WARN  o.a.c.processor.StreamResequencer - Caused by: &lt;span class=&quot;error&quot;&gt;&amp;#91;java.lang.NullPointerException - null&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.lang.NullPointerException: null&lt;br/&gt;
        at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:42) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:303) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:99) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:290) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer.sendElement(StreamResequencer.java:185) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer.sendElement(StreamResequencer.java:65) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.resequencer.ResequencerEngine.deliverNext(ResequencerEngine.java:261) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.resequencer.ResequencerEngine.deliver(ResequencerEngine.java:225) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer$Delivery.run(StreamResequencer.java:242) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
01:36:02.994 &lt;a href=&quot;#0 - Resequencer Delivery&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Camel (camel-1) thread #0 - Resequencer Delivery&lt;/a&gt; WARN  o.a.c.processor.StreamResequencer - Caused by: &lt;span class=&quot;error&quot;&gt;&amp;#91;java.lang.NullPointerException - null&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.lang.NullPointerException: null&lt;br/&gt;
        at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:42) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:303) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:99) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:290) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer.sendElement(StreamResequencer.java:185) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer.sendElement(StreamResequencer.java:65) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.resequencer.ResequencerEngine.deliverNext(ResequencerEngine.java:261) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.resequencer.ResequencerEngine.deliver(ResequencerEngine.java:225) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer$Delivery.run(StreamResequencer.java:242) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
01:36:10.913 &lt;a href=&quot;#0 - Resequencer Delivery&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Camel (camel-1) thread #0 - Resequencer Delivery&lt;/a&gt; WARN  o.a.c.processor.StreamResequencer - Caused by: &lt;span class=&quot;error&quot;&gt;&amp;#91;java.lang.NullPointerException - null&amp;#93;&lt;/span&gt;&lt;br/&gt;
java.lang.NullPointerException: null&lt;br/&gt;
        at org.apache.camel.processor.RouteContextProcessor.processNext(RouteContextProcessor.java:42) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:90) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:303) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:99) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.interceptor.DefaultChannel.process(DefaultChannel.java:290) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer.sendElement(StreamResequencer.java:185) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer.sendElement(StreamResequencer.java:65) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.resequencer.ResequencerEngine.deliverNext(ResequencerEngine.java:261) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.resequencer.ResequencerEngine.deliver(ResequencerEngine.java:225) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.camel.processor.StreamResequencer$Delivery.run(StreamResequencer.java:242) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.10.3.jar:2.10.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
01:36:15.706 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  camelTest.MainApp - Stopping&lt;br/&gt;
01:36:15.706 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.camel.impl.DefaultCamelContext - Apache Camel 2.10.3 (CamelContext: camel-1) is shutting down&lt;br/&gt;
01:36:15.707 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.c.impl.DefaultShutdownStrategy - Starting to graceful shutdown 2 routes (timeout 300 seconds)&lt;br/&gt;
01:36:16.778 &lt;a href=&quot;#14 - ShutdownTask&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Camel (camel-1) thread #14 - ShutdownTask&lt;/a&gt; INFO  o.a.c.impl.DefaultShutdownStrategy - Route: route2 shutdown complete, was consuming from: Endpoint&lt;span class=&quot;error&quot;&gt;&amp;#91;seda://join&amp;#93;&lt;/span&gt;&lt;br/&gt;
01:36:16.779 &lt;a href=&quot;#14 - ShutdownTask&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;Camel (camel-1) thread #14 - ShutdownTask&lt;/a&gt; INFO  o.a.c.impl.DefaultShutdownStrategy - Route: route1 shutdown complete, was consuming from: Endpoint&lt;span class=&quot;error&quot;&gt;&amp;#91;seda://fork?concurrentConsumers=10&amp;#93;&lt;/span&gt;&lt;br/&gt;
01:36:16.779 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.c.impl.DefaultShutdownStrategy - Graceful shutdown of 2 routes completed in 1 seconds&lt;br/&gt;
01:36:16.784 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.c.i.c.DefaultTypeConverter - TypeConverterRegistry utilization&lt;span class=&quot;error&quot;&gt;&amp;#91;attempts=264380, hits=264380, misses=0, failures=0&amp;#93;&lt;/span&gt; mappings&lt;span class=&quot;error&quot;&gt;&amp;#91;total=172, misses=0&amp;#93;&lt;/span&gt;&lt;br/&gt;
01:36:16.786 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  o.a.camel.impl.DefaultCamelContext - Apache Camel 2.10.3 (CamelContext: camel-1) is shutdown in 1.079 seconds. Uptime 31.114 seconds.&lt;br/&gt;
01:36:16.786 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  camelTest.MainApp - Stopped&lt;/p&gt;

&lt;p&gt;Vincent &lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu Linux 12.04 (amd64), openjdk 6 (6b24-1.11.5-0ubuntu1~12.04.1)&lt;/p&gt;</environment>
        <key id="12625887">CAMEL-5925</key>
            <summary>NullPointerException in RouteContextProcessor</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="lombart">Vincent Lombart</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Jan 2013 18:20:48 +0000</created>
                <updated>Sat, 5 Jan 2013 07:41:59 +0000</updated>
                            <resolved>Sat, 5 Jan 2013 07:41:59 +0000</resolved>
                                    <version>2.10.3</version>
                                    <fixVersion>2.9.6</fixVersion>
                    <fixVersion>2.10.4</fixVersion>
                    <fixVersion>2.11.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13543968" author="taariql" created="Fri, 4 Jan 2013 15:52:22 +0000"  >&lt;p&gt;Attaching a possible patch&lt;/p&gt;</comment>
                            <comment id="13543978" author="taariql" created="Fri, 4 Jan 2013 16:05:51 +0000"  >&lt;p&gt;Possible patch, see Nabble &lt;a href=&quot;http://camel.465427.n5.nabble.com/Fork-join-with-resequencing-td5724727.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.465427.n5.nabble.com/Fork-join-with-resequencing-td5724727.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The unit test provided is based on Vincent&apos;s main class and demonstrates the issue once every couple of runs, often the test will pass.&lt;br/&gt;
With the attached patch the error no longer occurs and the test always passes.&lt;br/&gt;
All camel-core tests also pass.&lt;/p&gt;

&lt;p&gt;Any other implications? And should the unit of work from line 41 be reused at 49?&lt;/p&gt;</comment>
                            <comment id="13544019" author="davsclaus" created="Fri, 4 Jan 2013 16:52:22 +0000"  >&lt;p&gt;Yeah ideally we should use the same UoW in the done logic. &lt;/p&gt;</comment>
                            <comment id="13544621" author="davsclaus" created="Sat, 5 Jan 2013 07:41:43 +0000"  >&lt;p&gt;Vincent thanks for reporting, and Taariq for the patch.&lt;/p&gt;

&lt;p&gt;I fixed some checkstyle errors which you can run as documented here (eg about code formatting, import ordering etc)&lt;br/&gt;
&lt;a href=&quot;http://camel.apache.org/building.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.apache.org/building.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And as well reuse the UoW in the done as suggested.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12563306" name="CAMEL-5925_NullPointerException_in_RouteContextProcessor.patch" size="5678" author="taariql" created="Fri, 4 Jan 2013 16:06:25 +0000"/>
                            <attachment id="12563304" name="CAMEL-5925_NullPointerException_in_RouteContextProcessor.patch" size="5678" author="taariql" created="Fri, 4 Jan 2013 16:05:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>302468</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 46 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i173dr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>249515</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>