<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:33:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-1645] Can&apos;t set the outgoing mail&apos;s content-type and charset</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-1645</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;The document at &lt;a href=&quot;http://camel.apache.org/mail.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.apache.org/mail.html&lt;/a&gt; suggests that contentType header should set the Content-Type of the out going mail, but that doesn&apos;t work.&lt;/p&gt;

&lt;p&gt;I am trying to set the content type of the mail I send using the contentType header. That doesn&apos;t work, but it works if I put the contentType in the endpoint uri. i.e. - &lt;/p&gt;

&lt;p&gt;            &amp;lt;camel:setHeader headerName=&quot;contentType&quot;&amp;gt; &lt;br/&gt;
                &amp;lt;camel:constant&amp;gt;text/html&amp;lt;/camel:constant&amp;gt; &lt;br/&gt;
            &amp;lt;/camel:setHeader&amp;gt; &lt;/p&gt;

&lt;p&gt;Has no effect, while this works - &lt;br/&gt;
             smtp://rohitr@xyzab.pramati.com?password=32478hds78&amp;amp;contentType=text/html &lt;/p&gt;

&lt;p&gt;But I am not able to set the charset and it always takes us-ascii &lt;/p&gt;

&lt;p&gt;So for the mail the content type header comes as - &lt;br/&gt;
Content-Type: text/html; charset=us-ascii&lt;/p&gt;

&lt;p&gt;I tried using &lt;br/&gt;
            &amp;lt;camel:setHeader headerName=&quot;contentType&quot;&amp;gt; &lt;br/&gt;
                &amp;lt;camel:constant&amp;gt;text/html;charset=UTF-8&amp;lt;/camel:constant&amp;gt; &lt;br/&gt;
            &amp;lt;/camel:setHeader&amp;gt; &lt;/p&gt;

&lt;p&gt;and also &lt;/p&gt;

&lt;p&gt;            &amp;lt;camel:setHeader headerName=&quot;content-type&quot;&amp;gt; &lt;br/&gt;
                &amp;lt;camel:constant&amp;gt;text/html;charset=UTF-8&amp;lt;/camel:constant&amp;gt; &lt;br/&gt;
            &amp;lt;/camel:setHeader&amp;gt; &lt;/p&gt;

&lt;p&gt;and &lt;br/&gt;
smtp://rohitr@xyzab.pramati.com?password= 32478hds78&amp;amp;contentType=text/html;charset=UTF-8 &lt;/p&gt;

&lt;p&gt;but nothing works&lt;/p&gt;</description>
                <environment></environment>
        <key id="12486533">CAMEL-1645</key>
            <summary>Can&apos;t set the outgoing mail&apos;s content-type and charset</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="rohitbrai">Rohit Rai</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 May 2009 09:40:18 +0000</created>
                <updated>Sat, 21 Nov 2009 11:58:02 +0000</updated>
                            <resolved>Thu, 11 Jun 2009 05:47:06 +0000</resolved>
                                    <version>1.6.0</version>
                    <version>2.0-M1</version>
                    <version>1.6.1</version>
                                    <fixVersion>1.6.2</fixVersion>
                    <fixVersion>2.0-M2</fixVersion>
                                    <component>camel-mail</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12952333" author="davsclaus" created="Wed, 27 May 2009 12:43:11 +0000"  >&lt;p&gt;trunk: 779143.&lt;br/&gt;
1.x: 779149.&lt;/p&gt;</comment>
                            <comment id="12952564" author="rohitbrai" created="Wed, 10 Jun 2009 10:36:00 +0000"  >&lt;p&gt;The change works only in case of non multipart message i.e. message without alternative message body and without attachments, but in case of multipart messages the following code is executed -&lt;/p&gt;

&lt;p&gt;protected void addBodyToMultipart(org.apache.camel.Message camelMessage, MailConfiguration configuration, MimeMultipart activeMultipart) throws MessagingException &lt;/p&gt;
{
        BodyPart bodyMessage = new MimeBodyPart();
        bodyMessage.setContent(camelMessage.getBody(String.class), configuration.getContentType());
        activeMultipart.addBodyPart(bodyMessage);
 }

&lt;p&gt;which takes contentType from configuration and doesn&apos;t respect the header passed.&lt;/p&gt;

&lt;p&gt;We should use the contentType header value if passed to set the contentType and fall back to configuration.getContentType only if required.&lt;/p&gt;

&lt;p&gt;Will that take care of applying the charset to the body, if the contentType header is defined as - text/html; charset=UTF-8?&lt;/p&gt;</comment>
                            <comment id="12952563" author="davsclaus" created="Wed, 10 Jun 2009 11:29:11 +0000"  >&lt;p&gt;Rohit thanks for reporting.&lt;/p&gt;

&lt;p&gt;Arrrrggghh why is that every API that SUN does it terrible low level and a pain to work with.&lt;/p&gt;

&lt;p&gt;Yeah I have to a bit of refator to let the I put the content on this part of the mime message being able to detect content type and set it correctly as either text or content and handle the charset as well &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="12952603" author="davsclaus" created="Thu, 11 Jun 2009 05:46:56 +0000"  >&lt;p&gt;trunk: 783632.&lt;br/&gt;
1.x : 783638.&lt;/p&gt;

&lt;p&gt;I did a fix on 1.x that did not involve API changes. In 2.0 I did cleanup the API a bit.&lt;/p&gt;

&lt;p&gt;Rohit can you test it?&lt;/p&gt;</comment>
                            <comment id="12953729" author="davsclaus" created="Sat, 21 Nov 2009 11:58:02 +0000"  >&lt;p&gt;Closing all 2.0M2 tickets&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76785</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 1 week, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01jov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6959</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>