<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:09:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-21575] camel-main: concurrency issues on Java 21</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-21575</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;We have lots of tests failing with ConcurrentModificationException on Java 21.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.util.ConcurrentModificationException  at java.base/java.util.TreeMap$PrivateEntryIterator.nextEntry(TreeMap.java:1521)  at java.base/java.util.TreeMap$KeyIterator.next(TreeMap.java:1575)  at org.apache.camel.main.MainHelper.setPropertiesOnTarget(MainHelper.java:323)  at org.apache.camel.main.BaseMainSupport.autoConfigurationMainConfiguration(BaseMainSupport.java:2286)  at org.apache.camel.main.BaseMainSupport.autoconfigure(BaseMainSupport.java:558)  at org.apache.camel.main.MainSupport.autoconfigure(MainSupport.java:79)  at org.apache.camel.main.BaseMainSupport.postProcessCamelContext(BaseMainSupport.java:902)  at org.apache.camel.main.MainSupport.initCamelContext(MainSupport.java:346)  at org.apache.camel.main.Main.doInit(Main.java:133)  at org.apache.camel.support.service.BaseService.init(BaseService.java:85)  at org.apache.camel.support.service.BaseService.start(BaseService.java:115)  at org.apache.camel.main.MainIoCBeanPostProcessorDisabledTest.testMainIoCEnabled(MainIoCBeanPostProcessorDisabledTest.java:35)  at java.base/java.lang.reflect.Method.invoke(Method.java:580)  at java.base/java.util.concurrent.ForkJoinTask.doExec(ForkJoinTask.java:387)  at java.base/java.util.concurrent.ForkJoinPool$WorkQueue.topLevelExec(ForkJoinPool.java:1312)  at java.base/java.util.concurrent.ForkJoinPool.scan(ForkJoinPool.java:1843)  at java.base/java.util.concurrent.ForkJoinPool.runWorker(ForkJoinPool.java:1808)  at java.base/java.util.concurrent.ForkJoinWorkerThread.run(ForkJoinWorkerThread.java:188)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13603476">CAMEL-21575</key>
            <summary>camel-main: concurrency issues on Java 21</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="orpiske">Otavio Rodolfo Piske</reporter>
                        <labels>
                            <label>help-wanted</label>
                    </labels>
                <created>Tue, 31 Dec 2024 10:22:13 +0000</created>
                <updated>Thu, 2 Jan 2025 08:08:43 +0000</updated>
                            <resolved>Thu, 2 Jan 2025 08:08:43 +0000</resolved>
                                    <version>4.9.0</version>
                    <version>4.10.0</version>
                                    <fixVersion>4.10.0</fixVersion>
                                    <component>camel-main</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17909052" author="orpiske" created="Tue, 31 Dec 2024 10:24:48 +0000"  >&lt;p&gt;The following tests are failing: &lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;testEvents &#8211; org.apache.camel.main.ContextEventsTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;addDynamicRoute &#8211; org.apache.camel.main.MainAddDynamicRouteTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testBindBeans &#8211; org.apache.camel.main.MainBeansConstructorTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testAutowiredTrue &#8211; org.apache.camel.main.MainComponentAutowiredFalseTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testContextCustomizer &#8211; org.apache.camel.main.MainCustomizerTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testMain &#8211; org.apache.camel.main.MainGlobalOptionsTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testMainRoutesHealthCheckExcluded &#8211; org.apache.camel.main.MainHealthCheckExcludedPatternTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testMainIoC &#8211; org.apache.camel.main.MainIoCBeanConfigInjectConfigurerTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testMainIoC &#8211; org.apache.camel.main.MainIoCBeanConfigInjectPropertiesTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testMainIoC &#8211; org.apache.camel.main.MainIoCBeanConfigInjectTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testMainIoCEnabled &#8211; org.apache.camel.main.MainIoCBeanPostProcessorDisabledTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testMainIoC &#8211; org.apache.camel.main.MainIoCNewRouteBuilderComplexTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testMainIoC &#8211; org.apache.camel.main.MainIoCNewRouteBuilderTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testMainIoC &#8211; org.apache.camel.main.MainIoCTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testBindLambdaRouteBuilder &#8211; org.apache.camel.main.MainLambdaRouteBuilderTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testMain &#8211; org.apache.camel.main.MainLogPlaceholderTest&amp;lt;1s&lt;/li&gt;
	&lt;li&gt;testSimpleMain &#8211; org.apache.camel.main.SimpleMainTest&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17909141" author="davsclaus" created="Wed, 1 Jan 2025 15:54:41 +0000"  >&lt;p&gt;I cannot reproduce this locally with&lt;/p&gt;

&lt;p&gt;$ java --version&lt;/p&gt;

&lt;p&gt;openjdk 21.0.4 2024-07-16 LTS&lt;br/&gt;
OpenJDK Runtime Environment Zulu21.36+17-CA (build 21.0.4+7-LTS)&lt;br/&gt;
OpenJDK 64-Bit Server VM Zulu21.36+17-CA (build 21.0.4+7-LTS, mixed mode, sharing)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;$ uname -a&lt;br/&gt;
Darwin davsclaus-mini4.local 24.2.0 Darwin Kernel Version 24.2.0: Fri Dec &#160;6 19:03:40 PST 2024; root:xnu-11215.61.5~2/RELEASE_ARM64_T6041 arm64&lt;/p&gt;</comment>
                            <comment id="17909143" author="davsclaus" created="Wed, 1 Jan 2025 15:57:48 +0000"  >&lt;p&gt;Upgraded Java to latest release (cannot reproduce locally)&lt;/p&gt;

&lt;p&gt;openjdk 21.0.5 2024-10-15 LTS&lt;br/&gt;
OpenJDK Runtime Environment Zulu21.38+21-CA (build 21.0.5+11-LTS)&lt;br/&gt;
OpenJDK 64-Bit Server VM Zulu21.38+21-CA (build 21.0.5+11-LTS, mixed mode, sharing)&lt;/p&gt;</comment>
                            <comment id="17909144" author="davsclaus" created="Wed, 1 Jan 2025 16:09:41 +0000"  >&lt;p&gt;Okay here is a PR that may help&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/camel/pull/16679&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/16679&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think the issue is that the ALL_OPTIONS is cleared when the bootstrap is done and that is not really needed. And maybe this happens if tests are executed in paralllel.&lt;/p&gt;</comment>
                            <comment id="17909211" author="orpiske" created="Thu, 2 Jan 2025 08:08:19 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;! Looking at the latest CI results, it seems to have fixed it.&lt;/p&gt;</comment>
                            <comment id="17909212" author="orpiske" created="Thu, 2 Jan 2025 08:08:43 +0000"  >&lt;p&gt;Fixed with the latest patch from Claus.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10061"><![CDATA[Novice]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            44 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1tcvk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>