<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:10:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-21958] camel-core - Java DSL wrong &quot;otherwise&quot; is triggered when having nested choice</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-21958</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description> &lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
   from(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:_getEmployeeContacts&quot;&lt;/span&gt;)
      .errorHandler(noErrorHandler())
      .choice()
        .when(exchangeProperty(EMPLOYEE_CONTACTS))
          .transform(exchangeProperty(EMPLOYEE_CONTACTS))
        .otherwise()
          .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:_processHeaders&quot;&lt;/span&gt;)
          .setHeader(Exchange.HTTP_METHOD, constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;GET&quot;&lt;/span&gt;))
          .log(&lt;span class=&quot;code-quote&quot;&gt;&quot;Getting employee contacts &quot;&lt;/span&gt;)
          .toD(&lt;span class=&quot;code-quote&quot;&gt;&quot;https:&lt;span class=&quot;code-comment&quot;&gt;//${exchangeProperty.&quot;&lt;/span&gt;+INPUT_MESSAGE+&lt;span class=&quot;code-quote&quot;&gt;&quot;?.metadata?.url}/{{api.base}}/employees/${exchangeProperty.&quot;&lt;/span&gt;+EMPLOYEE_ID+&lt;span class=&quot;code-quote&quot;&gt;&quot;}/employeeContacts?throwExceptionOnFailure=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;)
&lt;/span&gt;          .choice()
            .when(simple(&lt;span class=&quot;code-quote&quot;&gt;&quot;${header.&quot;&lt;/span&gt;+Exchange.HTTP_RESPONSE_CODE+&lt;span class=&quot;code-quote&quot;&gt;&quot;} == 200&quot;&lt;/span&gt;))
              .unmarshal(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ListJacksonDataFormat(EmployeeContactAPIModel.class))
              .endChoice()
            .otherwise()
              .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:_httpError&quot;&lt;/span&gt;)
          .end()
      .end();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This code stopped working after Camel upgrade from 4.0 to 4.11.&lt;br/&gt;
The last otherwise is always hit.&lt;br/&gt;
&lt;a href=&quot;https://camel.zulipchat.com/#narrow/channel/257298-camel/topic/Nested.20choice/near/511800701&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://camel.zulipchat.com/#narrow/channel/257298-camel/topic/Nested.20choice/near/511800701&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13615069">CAMEL-21958</key>
            <summary>camel-core - Java DSL wrong &quot;otherwise&quot; is triggered when having nested choice</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="denisdm">Denis Misin</reporter>
                        <labels>
                    </labels>
                <created>Sat, 12 Apr 2025 13:18:11 +0000</created>
                <updated>Wed, 16 Apr 2025 16:27:04 +0000</updated>
                            <resolved>Wed, 16 Apr 2025 05:20:51 +0000</resolved>
                                    <version>4.10.3</version>
                    <version>4.11.0</version>
                                    <fixVersion>4.10.4</fixVersion>
                    <fixVersion>4.12.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17944774" author="davsclaus" created="Tue, 15 Apr 2025 15:43:40 +0000"  >&lt;p&gt;You can remove the `endChoice` as in your example its not really needed, but there can be more advanced use-cases where it would be.&lt;/p&gt;

&lt;p&gt;As we are doing some changes inside Camel then this is better for upcoming 4.12 release.&lt;/p&gt;</comment>
                            <comment id="17944816" author="JIRAUSER302951" created="Tue, 15 Apr 2025 17:59:53 +0000"  >&lt;p&gt;Yeah I added it just in case, hoping it would fix the issue. &lt;br/&gt;
Thanks, appreciate your help!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            30 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1vbw0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>