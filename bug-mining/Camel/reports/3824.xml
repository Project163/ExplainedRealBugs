<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:19:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-10342] WebSockets options are ignored</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-10342</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Setting maxTextMessageSize or maxBinaryMessageSize has no effect, messages above the limit are still consumed and the route is started.&lt;/p&gt;

&lt;p&gt;I was debugging it to understand what was wrong and I came to the conclusion that parameters are set correctly on the camel WebSocketEndpoint and then on the ServletContextHandler (in camel method WebSocketComponent.setWebSocketComponentServletInitialParameter).&lt;/p&gt;

&lt;p&gt;But then the same values are null in jetty method WebSocketServlet.init() and they are not set on the WebSocketFactory.&lt;/p&gt;

&lt;p&gt;When I open a WebSocket connection I can see the default values are used instead of my settings in jetty WebSocketFactory.upgrade method.&lt;/p&gt;

&lt;p&gt;I think the problem is the init parameters that are set on the camel ServletContextHandler are not copied on the jetty ServletHolder.&lt;/p&gt;

&lt;p&gt;If I override the websocket bean in blueprint.xml with my own and override the createServlet method to copy the parameters then everything works correctly.&lt;/p&gt;

&lt;p&gt;So effectively changing the line in createServlet&lt;br/&gt;
	handler.addServlet(new ServletHolder(servlet), pathSpec);&lt;br/&gt;
By&lt;br/&gt;
	ServletHolder servletHolder = new ServletHolder(servlet);&lt;br/&gt;
	servletHolder.setInitParameters(handler.getInitParams());&lt;br/&gt;
	handler.addServlet(servletHolder, pathSpec);&lt;/p&gt;

&lt;p&gt;Also I think the unit test WebscoketEndpointConfigurationTest.testSetServletInitalparameters is wrong, it simply verifies that the values are set in camel but never checks they are set correctly on the jetty side.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13007574">CAMEL-10342</key>
            <summary>WebSockets options are ignored</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="dcendents">Daniel Beland</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Sep 2016 13:37:08 +0000</created>
                <updated>Tue, 27 Sep 2016 06:33:22 +0000</updated>
                            <resolved>Tue, 27 Sep 2016 06:33:22 +0000</resolved>
                                    <version>2.16.3</version>
                                    <fixVersion>2.18.0</fixVersion>
                                    <component>camel-websocket</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15524085" author="githubbot" created="Mon, 26 Sep 2016 20:27:41 +0000"  >&lt;p&gt;GitHub user dcendents opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1187&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1187&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-10342&quot; title=&quot;WebSockets options are ignored&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-10342&quot;&gt;&lt;del&gt;CAMEL-10342&lt;/del&gt;&lt;/a&gt;: correctly set the web socket parameters&lt;/p&gt;


&lt;p&gt;    Fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-10342&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CAMEL-10342&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/dcendents/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/dcendents/camel&lt;/a&gt; websocket_parameters&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1187.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1187.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1187&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 97476b994009852df5af9d1a8c6d0f537f074004&lt;br/&gt;
Author: Daniel Beland &amp;lt;daniel.beland@ca.thalesgroup.com&amp;gt;&lt;br/&gt;
Date:   2016-09-26T20:19:37Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-10342&quot; title=&quot;WebSockets options are ignored&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-10342&quot;&gt;&lt;del&gt;CAMEL-10342&lt;/del&gt;&lt;/a&gt;: correctly set the web socket parameters from the endpoint uri&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15525237" author="githubbot" created="Tue, 27 Sep 2016 06:33:01 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1187&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1187&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 8 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i342uv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>