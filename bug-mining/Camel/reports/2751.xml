<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:02:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-7471] SOAP with attachments not mapped correctly from CXF to Camel for CXF_MESSAGE</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-7471</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;SOAP with attachments messages are not mapped correctly from CXF to Camel and back if using CXF_MESSAGE message format. &lt;/p&gt;

&lt;p&gt;We are having following simple camel route:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;route&amp;gt;
    &amp;lt;from uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;cxf:bean:Endpoint1&quot;&lt;/span&gt; /&amp;gt;
    &amp;lt;to uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;cxf:bean:Endpoint2&quot;&lt;/span&gt; /&amp;gt;
&amp;lt;/route&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So mapping between CXF Endpoint 1 and Camel creates attachments in Camel exchange and sets the Camel IN message as a soap message. However, it&apos;s missing a bit of removing the attachments from the message as they are already added to the Camel Exchange.&lt;/p&gt;

&lt;p&gt;Mapping from Camel and CXF Endpoint 2 maps Camel IN message (Soap with attachments) to CXF and then adds the attachments from Camel exchange which results in a messed up soap message that appears to contain twice as many attachments and it has messed up MIME boundaries as well as some of them are from the input message and some of them are generated during the last mapping.&lt;/p&gt;

&lt;p&gt;As a workaround we have added a Camel processor that clears the attachments from the IN Message in Camel .&lt;/p&gt;</description>
                <environment></environment>
        <key id="12717049">CAMEL-7471</key>
            <summary>SOAP with attachments not mapped correctly from CXF to Camel for CXF_MESSAGE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="joeluo">Joe Luo</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 May 2014 14:01:45 +0000</created>
                <updated>Tue, 10 Jun 2014 06:59:45 +0000</updated>
                            <resolved>Tue, 10 Jun 2014 06:59:45 +0000</resolved>
                                    <version>2.10.4</version>
                                    <fixVersion>2.12.4</fixVersion>
                    <fixVersion>2.13.2</fixVersion>
                    <fixVersion>2.14.0</fixVersion>
                                    <component>camel-cxf</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14011117" author="joeluo" created="Wed, 28 May 2014 14:08:08 +0000"  >&lt;p&gt;Here I attached a new CXF mtom junit test CxfMtomConsumerCxfMessageModeTest here to demonstrate the problem. Here is the code snippet:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void configure() {
                from(MTOM_ENDPOINT_URI).process(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Processor() {
                    @SuppressWarnings(&lt;span class=&quot;code-quote&quot;&gt;&quot;unchecked&quot;&lt;/span&gt;)
                    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void process(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Exchange exchange) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
                        Message in = exchange.getIn();
                        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;We should not get any attachements here.&quot;&lt;/span&gt;, 2, in.getAttachments().size());
                        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;Get a wrong Content-Type header&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;application/xop+xml&quot;&lt;/span&gt;, in.getHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt;));
                        exchange.getOut().setBody(&lt;span class=&quot;code-quote&quot;&gt;&quot;OK&quot;&lt;/span&gt;);

                    }
                });
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can see this assertion:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;We should not get any attachements here.&quot;&lt;/span&gt;, 2, in.getAttachments().size());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It has to be 2 here in order to make the junit test case to pass. Which means that it had 2 attachments in Camel as well as 2 attachments in the Soap message.&lt;/p&gt;</comment>
                            <comment id="14012305" author="njiang" created="Thu, 29 May 2014 12:04:12 +0000"  >&lt;p&gt;Hi Joe,&lt;/p&gt;

&lt;p&gt;I tried you junit patch in camel master and camel-2.12.x branch, I cannot reproduce the error.&lt;br/&gt;
I will try to run the tests in camel-2.10.x branch.&lt;/p&gt;</comment>
                            <comment id="14012338" author="njiang" created="Thu, 29 May 2014 12:57:53 +0000"  >&lt;p&gt;Hi Joe,&lt;/p&gt;

&lt;p&gt;I can verify the issue by checking out the log file after running the test of CxfMtomRouterCxfMessageModeTest.&lt;br/&gt;
CXF producer should avoid to add the attachement into CXF message context in CXF_MESSAGE data format, as the camel-cxf already put the attachment into message stream. &lt;/p&gt;
</comment>
                            <comment id="14026184" author="njiang" created="Tue, 10 Jun 2014 06:59:45 +0000"  >&lt;p&gt;Applied the patch into master, camel-2.13.x and camel-2.12.x branches.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12647137" name="junit_test.diff" size="8634" author="joeluo" created="Wed, 28 May 2014 14:02:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>395257</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 24 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1w1wn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>395388</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>