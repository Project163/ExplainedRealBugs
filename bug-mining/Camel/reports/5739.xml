<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:47:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-16604] camel-kamelet - YAML DSL: Specify an option as optional results in a mandatory option</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-16604</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;If you have something like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
apiVersion: camel.apache.org/v1alpha1
kind: Kamelet
metadata:
 name: kafka-not-secured-source
 annotations:
 camel.apache.org/kamelet.icon: &lt;span class=&quot;code-quote&quot;&gt;&quot;data:image/svg+xml;base64,PD94bWwgdmVyc2lvbj0iMS4wIiBlbmNvZGluZz0idXRmLTgiPz4NCjwhLS0gR2VuZXJhdG9yOiBBZG9iZSBJbGx1c3RyYXRvciAxOS4wLjAsIFNWRyBFeHBvcnQgUGx1Zy1JbiAuIFNWRyBWZXJzaW9uOiA2LjAwIEJ1aWxkIDApICAtLT4NCjxzdmcgdmVyc2lvbj0iMS4xIiBpZD0iTGF5ZXJfMSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIiB4bWxuczp4bGluaz0iaHR0cDovL3d3dy53My5vcmcvMTk5OS94bGluayIgeD0iMHB4IiB5PSIwcHgiDQoJIHZpZXdCb3g9IjAgMCA1MDAgNTAwIiBzdHlsZT0iZW5hYmxlLWJhY2tncm91bmQ6bmV3IDAgMCA1MDAgNTAwOyIgeG1sOnNwYWNlPSJwcmVzZXJ2ZSI+DQo8ZyBpZD0iWE1MSURfMV8iPg0KCTxwYXRoIGlkPSJYTUxJRF85XyIgZD0iTTMxNC44LDI2OS43Yy0xNC4yLDAtMjcsNi4zLTM1LjcsMTYuMkwyNTYuOCwyNzBjMi40LTYuNSwzLjctMTMuNiwzLjctMjAuOWMwLTcuMi0xLjMtMTQuMS0zLjYtMjAuNg0KCQlsMjIuMy0xNS43YzguNyw5LjksMjEuNCwxNi4xLDM1LjYsMTYuMWMyNi4yLDAsNDcuNi0yMS4zLDQ3LjYtNDcuNnMtMjEuMy00Ny42LTQ3LjYtNDcuNnMtNDcuNiwyMS4zLTQ3LjYsNDcuNg0KCQljMCw0LjcsMC43LDkuMiwyLDEzLjVsLTIyLjMsMTUuN2MtOS4zLTExLjYtMjIuOC0xOS42LTM4LjEtMjIuMXYtMjYuOWMyMS42LTQuNSwzNy44LTIzLjcsMzcuOC00Ni42YzAtMjYuMi0yMS4zLTQ3LjYtNDcuNi00Ny42DQoJCWMtMjYuMiwwLTQ3LjYsMjEuMy00Ny42LDQ3LjZjMCwyMi42LDE1LjgsNDEuNSwzNi45LDQ2LjN2MjcuM2MtMjguOCw1LjEtNTAuOCwzMC4yLTUwLjgsNjAuNWMwLDMwLjQsMjIuMiw1NS43LDUxLjIsNjAuNXYyOC44DQoJCWMtMjEuMyw0LjctMzcuNCwyMy43LTM3LjQsNDYuNGMwLDI2LjIsMjEuMyw0Ny42LDQ3LjYsNDcuNmMyNi4yLDAsNDcuNi0yMS4zLDQ3LjYtNDcuNmMwLTIyLjctMTYtNDEuOC0zNy40LTQ2LjR2LTI4LjgNCgkJYzE1LTIuNSwyOC4yLTEwLjQsMzcuNC0yMS44bDIyLjUsMTUuOWMtMS4yLDQuMy0xLjksOC43LTEuOSwxMy40YzAsMjYuMiwyMS4zLDQ3LjYsNDcuNiw0Ny42czQ3LjYtMjEuMyw0Ny42LTQ3LjYNCgkJQzM2Mi40LDI5MSwzNDEuMSwyNjkuNywzMTQuOCwyNjkuN3ogTTMxNC44LDE1OC40YzEyLjcsMCwyMy4xLDEwLjQsMjMuMSwyMy4xYzAsMTIuNy0xMC4zLDIzLjEtMjMuMSwyMy4xcy0yMy4xLTEwLjQtMjMuMS0yMy4xDQoJCUMyOTEuOCwxNjguOCwzMDIuMSwxNTguNCwzMTQuOCwxNTguNHogTTE3NiwxMTUuMWMwLTEyLjcsMTAuMy0yMy4xLDIzLjEtMjMuMWMxMi43LDAsMjMuMSwxMC40LDIzLjEsMjMuMQ0KCQljMCwxMi43LTEwLjMsMjMuMS0yMy4xLDIzLjFDMTg2LjMsMTM4LjIsMTc2LDEyNy44LDE3NiwxMTUuMXogTTIyMi4xLDM4NC45YzAsMTIuNy0xMC4zLDIzLjEtMjMuMSwyMy4xDQoJCWMtMTIuNywwLTIzLjEtMTAuNC0yMy4xLTIzLjFjMC0xMi43LDEwLjMtMjMuMSwyMy4xLTIzLjFDMjExLjgsMzYxLjgsMjIyLjEsMzcyLjIsMjIyLjEsMzg0Ljl6IE0xOTkuMSwyODEuMw0KCQljLTE3LjcsMC0zMi4yLTE0LjQtMzIuMi0zMi4yYzAtMTcuNywxNC40LTMyLjIsMzIuMi0zMi4yYzE3LjcsMCwzMi4yLDE0LjQsMzIuMiwzMi4yQzIzMS4yLDI2Ni45LDIxNi44LDI4MS4zLDE5OS4xLDI4MS4zeg0KCQkgTTMxNC44LDM0MC4zYy0xMi43LDAtMjMuMS0xMC40LTIzLjEtMjMuMWMwLTEyLjcsMTAuMy0yMy4xLDIzLjEtMjMuMXMyMy4xLDEwLjQsMjMuMSwyMy4xQzMzNy45LDMzMCwzMjcuNSwzNDAuMywzMTQuOCwzNDAuM3oiLz4NCjwvZz4NCjwvc3ZnPg0K&quot;&lt;/span&gt;
 camel.apache.org/provider: &lt;span class=&quot;code-quote&quot;&gt;&quot;Apache Software Foundation&quot;&lt;/span&gt;
 camel.apache.org/kamelet.group: &lt;span class=&quot;code-quote&quot;&gt;&quot;Kafka&quot;&lt;/span&gt;
 labels:
 camel.apache.org/kamelet.type: &lt;span class=&quot;code-quote&quot;&gt;&quot;source&quot;&lt;/span&gt;
spec:
 definition:
 title: &lt;span class=&quot;code-quote&quot;&gt;&quot;Kafka Not Secured Source&quot;&lt;/span&gt;
 description: |-
 Receive data from Kafka topics on an insecure broker.
 required:
 - topic
 - brokers
 type: object
 properties:
 topic:
 title: Topic Names
 description: Comma separated list of Kafka topic names
 type: string
 brokers:
 title: Brokers
 description: Comma separated list of Kafka Broker URLs
 type: string
 autoCommitEnable:
 title: Auto Commit Enable
 description: If &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, periodically commit to ZooKeeper the offset of messages already fetched by the consumer
 type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;
 &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
 x-descriptors:
 - &lt;span class=&quot;code-quote&quot;&gt;&apos;urn:alm:descriptor:com.tectonic.ui:checkbox&apos;&lt;/span&gt;
 allowManualCommit:
 title: Allow Manual Commit
 description: Whether to allow doing manual commits
 type: &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;
 &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
 x-descriptors:
 - &lt;span class=&quot;code-quote&quot;&gt;&apos;urn:alm:descriptor:com.tectonic.ui:checkbox&apos;&lt;/span&gt;
 pollOnError:
 title: Poll On Error Behavior
 description: What to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; kafka threw an exception &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; polling &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; messages. There are 5 enums and the value can be one of DISCARD, ERROR_HANDLER, RECONNECT, RETRY, STOP
 type: string
 &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;ERROR_HANDLER&quot;&lt;/span&gt;
 autoOffsetReset:
 title: Auto Offset Reset
 description: What to &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; when there is no initial offset. There are 3 enums and the value can be one of latest, earliest, none
 type: string
 &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;latest&quot;&lt;/span&gt;
 clientId:
 title: Client Id
 description: The client id is a user-specified string sent in each request to help trace calls.
 type: string
 dependencies:
 - &lt;span class=&quot;code-quote&quot;&gt;&quot;camel:kafka&quot;&lt;/span&gt;
 - &lt;span class=&quot;code-quote&quot;&gt;&quot;camel:kamelet&quot;&lt;/span&gt;
 flow:
 from:
 uri: &lt;span class=&quot;code-quote&quot;&gt;&quot;kafka:{{topic}}&quot;&lt;/span&gt;
 parameters:
 brokers: &lt;span class=&quot;code-quote&quot;&gt;&quot;{{brokers}}&quot;&lt;/span&gt;
 autoCommitEnable: &lt;span class=&quot;code-quote&quot;&gt;&quot;{{autoCommitEnable}}&quot;&lt;/span&gt;
 allowManualCommit: &lt;span class=&quot;code-quote&quot;&gt;&quot;{{allowManualCommit}}&quot;&lt;/span&gt;
 pollOnError: &lt;span class=&quot;code-quote&quot;&gt;&quot;{{pollOnError}}&quot;&lt;/span&gt;
 autoOffsetReset: &lt;span class=&quot;code-quote&quot;&gt;&quot;{{autoOffsetReset}}&quot;&lt;/span&gt;
 clientId: &lt;span class=&quot;code-quote&quot;&gt;&quot;{{?clientId}}&quot;&lt;/span&gt;
 steps:
 - to: &lt;span class=&quot;code-quote&quot;&gt;&quot;kamelet:sink&quot;&lt;/span&gt;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If I don&apos;t specify the clientId I shouldn&apos;t have any kind of problem, but as result I&apos;m getting:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; 2021-05-11 12:02:16,329 ERROR &lt;span class=&quot;error&quot;&gt;&amp;#91;io.qua.run.Application&amp;#93;&lt;/span&gt; (main) Failed to start application (with profile prod): java.lang.IllegalArgumentException: Route template kafka-not-secured-source the following mandatory parameters must be provided: clientId&lt;/p&gt;</description>
                <environment></environment>
        <key id="13377857">CAMEL-16604</key>
            <summary>camel-kamelet - YAML DSL: Specify an option as optional results in a mandatory option</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="acosentino">Andrea Cosentino</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 May 2021 12:14:40 +0000</created>
                <updated>Wed, 12 May 2021 07:26:16 +0000</updated>
                            <resolved>Wed, 12 May 2021 07:26:16 +0000</resolved>
                                                    <fixVersion>3.10.0</fixVersion>
                                    <component>camel-kamelet</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17342581" author="davsclaus" created="Tue, 11 May 2021 13:55:08 +0000"  >&lt;p&gt;Okay so ideally the kamelet spec should have a way to define something as optional when you specify the parameter, eg&lt;/p&gt;

&lt;p&gt;clientId:&lt;br/&gt;
 title: Client Id&lt;br/&gt;
 description: The client id is a user-specified string sent in each request to help trace calls.&lt;br/&gt;
 type: string&lt;br/&gt;
 optional: true.  (&amp;lt;-- new in the spec)&lt;/p&gt;

&lt;p&gt;Without that information, then there is no way to know this in advanced, without having to &quot;guess from the route template DSL code, which is not ideal. eg when you have the template coded in java, kotlin etc, then its not just a blurb of text like yaml/xml which you can do an ugly regexp to check for &lt;tt&gt;?xxx&lt;/tt&gt; to see if the parameter is only used as optional in the DSL.&lt;/p&gt;</comment>
                            <comment id="17342582" author="davsclaus" created="Tue, 11 May 2021 13:55:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nferraro&quot; class=&quot;user-hover&quot; rel=&quot;nferraro&quot;&gt;nferraro&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lburgazzoli&quot; class=&quot;user-hover&quot; rel=&quot;lburgazzoli&quot;&gt;lburgazzoli&lt;/a&gt; ^^^^&lt;/p&gt;</comment>
                            <comment id="17342587" author="nferraro" created="Tue, 11 May 2021 14:03:56 +0000"  >&lt;p&gt;I think all parameters are optional unless they&apos;re present in the &quot;required&quot; list, at least, that&apos;s the semantic...&lt;/p&gt;

&lt;p&gt;There may be something in the operator/runtime that breaks with empty values. Did you check if the issue happens on KameletBinding or also in standard routes (i.e. using kamelets as from(&quot;kamelet:xx&quot;)).&lt;/p&gt;</comment>
                            <comment id="17342590" author="davsclaus" created="Tue, 11 May 2021 14:09:31 +0000"  >&lt;p&gt;The problem is that in the camel-core-model we do not have the required: true|false information to well defined in the model class.&lt;/p&gt;

&lt;p&gt;public class RouteTemplateParameterDefinition &lt;/p&gt;
{
    @XmlAttribute(required = true)
    String name;
    @XmlAttribute
    String defaultValue;
    @XmlAttribute
    String description;
}

&lt;p&gt;So it may be worth to add &lt;/p&gt;

&lt;p&gt;Boolean required&lt;/p&gt;

&lt;p&gt;in the camel-core-model, which camel-k can then explicit set &lt;/p&gt;</comment>
                            <comment id="17342597" author="davsclaus" created="Tue, 11 May 2021 14:18:20 +0000"  >&lt;p&gt;Okay I have a fix by adding &lt;/p&gt;

&lt;p&gt;Boolean required&lt;/p&gt;

&lt;p&gt;to the camel-core-model. Then camel-k-runtime can set that flag accordingly when it builds the model class from the kamelet spec.&lt;/p&gt;</comment>
                            <comment id="17342691" author="davsclaus" created="Tue, 11 May 2021 15:58:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lburgazzoli&quot; class=&quot;user-hover&quot; rel=&quot;lburgazzoli&quot;&gt;lburgazzoli&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Is this the place in does camel-k-runtime where it setup the template parameters?&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel-k-runtime/blob/76c64d88932a2090f8f832fc48475b06de0be5c4/camel-k-core/support/src/main/java/org/apache/camel/k/support/SourcesSupport.java#L125&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel-k-runtime/blob/76c64d88932a2090f8f832fc48475b06de0be5c4/camel-k-core/support/src/main/java/org/apache/camel/k/support/SourcesSupport.java#L125&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;That line only set the template parameter name. Where are the default value? And I am look at if there is a place where we check for if the parameter is requred: true|false as in the kamelet spec&lt;/p&gt;</comment>
                            <comment id="17342699" author="lb" created="Tue, 11 May 2021 16:07:54 +0000"  >&lt;p&gt;No at the moment the default parameters are set by the camel-k operator&lt;/p&gt;</comment>
                            <comment id="17343020" author="davsclaus" created="Wed, 12 May 2021 06:01:15 +0000"  >&lt;p&gt;The kamelet yaml file needs to be updated to mark that option as not requireed&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
clientId:
 title: Client Id
 description: The client id is a user-specified string sent in each request to help trace calls.
 type: string
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;should be&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
clientId:
 title: Client Id
 description: The client id is a user-specified string sent in each request to help trace calls.
 type: string
 required: &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17343050" author="lb" created="Wed, 12 May 2021 07:05:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; I&apos;ll implement this in the kamelet loader later today so changes to the json schema specs are not required&lt;/p&gt;</comment>
                            <comment id="17343062" author="davsclaus" created="Wed, 12 May 2021 07:19:47 +0000"  >&lt;p&gt;Okay - I just added a yaml dsl test&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/pull/5545/commits/33fa5b21894708a81635b4628667610b543c205f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/5545/commits/33fa5b21894708a81635b4628667610b543c205f&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0qxjc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>