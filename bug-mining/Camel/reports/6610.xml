<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:03:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-19828] camel-twilio: conversion to PhoneNumber, .. fails after recent general converter change</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-19828</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When adopting the latest Camel into camel-quarkus I noticed an error.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
NoTypeConversionAvailableException: No type converter available to convert from type: java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; to the required type: com.twilio.type.Endpoint
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Problem is caused by this change: &lt;a href=&quot;https://github.com/apache/camel/pull/11225/commits/e4007f2b1dfc982e5ea6a45427cbec8835ea58a5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/11225/commits/e4007f2b1dfc982e5ea6a45427cbec8835ea58a5&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;As you can see &lt;a href=&quot;https://github.com/apache/camel/blob/main/components/camel-twilio/src/main/java/org/apache/camel/component/twilio/TwilioConverter.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;, 2 converters are registered (i.e. String -&amp;gt; PhoneNumber). Unfortunately the Twilio API uses common interface `com.twilio.type.Endpoint`. See this &lt;a href=&quot;https://github.com/apache/camel/blob/main/components/camel-twilio/src/generated/java/org/apache/camel/component/twilio/CallEndpointConfiguration.java#L27&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;line&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Therefore the mechanism for selection converters is not able to find converter `String -&amp;gt; Endpoint`.&lt;/p&gt;

&lt;p&gt;The behavior could be simply tested by following code added into `TwilioEndpointTest`:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        te = context.getEndpoint(
                &lt;span class=&quot;code-quote&quot;&gt;&quot;twilio:&lt;span class=&quot;code-comment&quot;&gt;//call/create?from=RAW(+15005550006)&amp;amp;to=RAW(+14108675310)&amp;amp;url=http://demo.twilio.com/docs/voice.xml&quot;&lt;/span&gt;,
&lt;/span&gt;                TwilioEndpoint.class);

        Assertions.assertTrue(te.getConfiguration() &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; CallEndpointConfiguration);
        CallEndpointConfiguration cee = (CallEndpointConfiguration) te.getConfiguration();
        Assertions.assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;+15005550006&quot;&lt;/span&gt;, cee.getFrom().getEndpoint());
        Assertions.assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;+14108675310&quot;&lt;/span&gt;, cee.getTo().getEndpoint());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I&apos;m not sure how it was possible, but the test wold succeed before the change introduced by e4007f2b1dfc982e5ea6a45427cbec8835ea58a5.&lt;/p&gt;

&lt;p&gt;I think that the conversion before the change might not be correct in this twilio case (the conversion was probably possible because of the fallback conversion and was depending on the order of the registered converters - I don&apos;t see a way how to decide which conversion should be used `PhoneNumber` or `Sip` from the registered converters from the link above)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13549570">CAMEL-19828</key>
            <summary>camel-twilio: conversion to PhoneNumber, .. fails after recent general converter change</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jondruse">Jiri Ondrusek</assignee>
                                    <reporter username="jondruse">Jiri Ondrusek</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Sep 2023 13:37:50 +0000</created>
                <updated>Mon, 19 Feb 2024 14:01:07 +0000</updated>
                            <resolved>Mon, 13 Nov 2023 11:45:46 +0000</resolved>
                                    <version>4.x</version>
                                    <fixVersion>4.2.0</fixVersion>
                                    <component>camel-core</component>
                    <component>camel-twilio</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17761833" author="jondruse" created="Mon, 4 Sep 2023 13:38:16 +0000"  >&lt;p&gt;FYI &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=orpiske&quot; class=&quot;user-hover&quot; rel=&quot;orpiske&quot;&gt;orpiske&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17761835" author="orpiske" created="Mon, 4 Sep 2023 14:04:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jondruse&quot; class=&quot;user-hover&quot; rel=&quot;jondruse&quot;&gt;jondruse&lt;/a&gt; Yeah, the converter is a bit more strict now, as it requires the types to match. Previously it would succeed in the first match (and the order was: Phone, SIP). I am curious if previously it was working for SIP - but I don&apos;t know.&lt;/p&gt;

&lt;p&gt;So, to reproduce the previous behavior, you can try adding the following converter:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Converter
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Endpoint toEndpoint(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; (Endpoint) &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PhoneNumber(value);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can you give it a try and let me know, please?&lt;/p&gt;</comment>
                            <comment id="17761837" author="jondruse" created="Mon, 4 Sep 2023 14:10:19 +0000"  >&lt;p&gt;Sure, thanks for the tip!&lt;/p&gt;</comment>
                            <comment id="17761840" author="jondruse" created="Mon, 4 Sep 2023 14:13:13 +0000"  >&lt;p&gt;I already tested this code and it works. I see it as a workaround, because it can not convert to a Sip.&lt;br/&gt;
I can create a PR with it.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Perhaps some better solution can be implemented (in twilio comp) to allow conversion to i.e Sip. I can try to propose something later (as this will be a very small severity)&lt;/p&gt;</comment>
                            <comment id="17761851" author="orpiske" created="Mon, 4 Sep 2023 14:41:12 +0000"  >&lt;p&gt;&lt;cite&gt;I already tested this code and it works. I see it as a workaround, because it can not convert to a Sip.&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;I agree with you. I believe it is only restoring the previous behavior (which would convert to Phone), but it does not look like an adequate solution. &lt;/p&gt;

&lt;p&gt;&lt;cite&gt;Perhaps some better solution can be implemented (in twilio comp) to allow conversion to i.e Sip. I can try to propose something later (as this will be a very small severity)&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;Great!!&lt;/p&gt;</comment>
                            <comment id="17781773" author="fil512" created="Wed, 1 Nov 2023 14:50:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=orpiske&quot; class=&quot;user-hover&quot; rel=&quot;orpiske&quot;&gt;orpiske&lt;/a&gt; we hit the same issue.&#160; Looks like a legit regression to me.&#160; Compare:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Camel 3&#160;CoreTypeConverterRegistry Line 666 - 669&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
TypeConverter converter = typeMappings.getFirst(
        toType::isAssignableFrom,
        &lt;span class=&quot;code-comment&quot;&gt;// skip &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; based we &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; them last
&lt;/span&gt;        from -&amp;gt; !from.equals(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;.class) &amp;amp;&amp;amp; from.isAssignableFrom(fromType)); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;this logic got reversed in Camel 4 TypeResolverHelper Line 117-120&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; entry : converters.entrySet()) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (entry.getKey().isAssignableMatch(typeConvertible)) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; entry.getValue();
    }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Notice in Camel 3 isAssignableFrom it calls toType.isAssignableFrom(entry.getKey() whereas in Camel 4 it effectively calls entry.getKey().isAssignableFrom(toType).&lt;/p&gt;</comment>
                            <comment id="17781783" author="fil512" created="Wed, 1 Nov 2023 15:04:12 +0000"  >&lt;p&gt;This fixed it for me:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; entry : converters.entrySet()) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (typeConvertible.isAssignableMatch(entry.getKey())) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; entry.getValue();
    }
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17781849" author="fil512" created="Wed, 1 Nov 2023 17:58:05 +0000"  >&lt;p&gt;Here&apos;s a PR with a test and the fix:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/camel/pull/11882&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/11882&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17785299" author="davsclaus" created="Sun, 12 Nov 2023 17:52:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=orpiske&quot; class=&quot;user-hover&quot; rel=&quot;orpiske&quot;&gt;orpiske&lt;/a&gt; did you type converter changes fix this in the 4.2 release &lt;/p&gt;</comment>
                            <comment id="17785464" author="orpiske" created="Mon, 13 Nov 2023 11:45:46 +0000"  >&lt;p&gt;This should have been resolved in 4.2.0 by the linked PRs.&lt;/p&gt;</comment>
                            <comment id="17785466" author="orpiske" created="Mon, 13 Nov 2023 11:46:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; yes it should. There were a couple of additional fixes from me and other contributors that should have fixed this.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1k63s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>