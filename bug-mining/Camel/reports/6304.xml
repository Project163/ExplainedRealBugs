<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:58:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-18717] camel-kafka: investigate offset not increasing</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-18717</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Quoting the report from an user on the users mailing list:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;Hi All,&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;I&apos;m upgrading Camel from 3.16 to 3.17 and found a problem that OffsetRepository didn&apos;t get update after manual commit.&lt;/cite&gt;&lt;br/&gt;
&lt;cite&gt;It is a Spring boot project and MemoryStateRepository as follows.&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;&#160; &#160; &#160; &#160; @Bean&lt;/cite&gt;&lt;br/&gt;
&lt;cite&gt;&#160; &#160; &#160; &#160; public MemoryStateRepository offsetRepo() {&lt;/cite&gt;&lt;br/&gt;
&lt;cite&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; MemoryStateRepository stateRepository = new MemoryStateRepository();&lt;/cite&gt;&lt;br/&gt;
&lt;cite&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; stateRepository.setState(topic + &quot;/0&quot;, &quot;&quot;);&lt;/cite&gt;&lt;br/&gt;
&lt;cite&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; return stateRepository;&lt;/cite&gt;&lt;br/&gt;
&lt;cite&gt;&#160; &#160; &#160; &#160; }&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;Here is the method I use when commit:&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;&#160; &#160; &#160; &#160; private void commitOffsetToKafka(Exchange exchange) {&lt;/cite&gt;&lt;br/&gt;
&lt;cite&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; KafkaManualCommit manual = exchange.getIn().getHeader(KafkaConstants.MANUAL_COMMIT, KafkaManualCommit.class);&lt;/cite&gt;&lt;br/&gt;
&lt;cite&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; manual.commit();&lt;/cite&gt;&lt;br/&gt;
&lt;cite&gt;&#160; &#160; &#160; &#160; }&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;Here is my Kafka endpoint&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;kafka:integration_test _topic?brokers=&lt;a href=&quot;http://127.0.0.1:41478/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;127.0.0.1:41478&lt;/a&gt;&amp;amp;autoCommitEnable=false&amp;amp;allowManualCommit=true&amp;amp;seekTo=beginning&amp;amp;maxPollRecords=2&amp;amp;groupId=ANE&amp;amp;autoOffsetReset=earliest&amp;amp;offsetRepository=#offsetRepo&amp;amp;kafkaManualCommitFactory=#class:org.apache.camel.component.kafka.consumer.DefaultKafkaManualCommitFactory&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;It is working fine in 3.16. When DefaultkafkaManualSyncCommit.commit() is invoked. The offsetRepository.setState() get invoked so the offset increased.&lt;/cite&gt;&lt;br/&gt;
&lt;cite&gt;However, in 3.17, DefaultkafkaManualSyncCommit.commit() doesn&apos;t have a reference to offsetRepository so the offset in offsetRepository won&apos;t get increased.&lt;/cite&gt;&lt;/p&gt;

&lt;p&gt;&lt;cite&gt;Is this a bug or there is a different way to get the offset after committing. Could you please suggest what I should do to test if the offset get increased after manual commit&lt;/cite&gt;?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This happened even after upgrading to Camel 3.18.3 as requested on the thread.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This needs to be investigated further.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13501185">CAMEL-18717</key>
            <summary>camel-kafka: investigate offset not increasing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="orpiske">Otavio Rodolfo Piske</assignee>
                                    <reporter username="orpiske">Otavio Rodolfo Piske</reporter>
                        <labels>
                    </labels>
                <created>Sat, 12 Nov 2022 08:02:33 +0000</created>
                <updated>Thu, 24 Nov 2022 10:26:12 +0000</updated>
                            <resolved>Thu, 24 Nov 2022 10:26:12 +0000</resolved>
                                    <version>3.18.3</version>
                    <version>3.19.0</version>
                                    <fixVersion>3.18.4</fixVersion>
                    <fixVersion>3.20.0</fixVersion>
                                    <component>camel-kafka</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17638239" author="orpiske" created="Thu, 24 Nov 2022 10:25:51 +0000"  >&lt;p&gt;Backported to 3.18 with &lt;a href=&quot;https://github.com/apache/camel/pull/8757&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/8757&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1bwz4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>