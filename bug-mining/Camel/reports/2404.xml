<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:58:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-6630] Validation using JAXB format is not thread safe</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-6630</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I&apos;m using JAXB format for unmarshaling. It is defined like this:&lt;/p&gt;

&lt;p&gt;&amp;lt;dataFormats&amp;gt;&lt;br/&gt;
  &amp;lt;jaxb id=&quot;kofax&quot; contextPath=&quot;com.indracompany.telefonica.assignmanager&quot;&lt;br/&gt;
      schema=&quot;classpath:DocumentsDataForAssignManager.xsd&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/dataFormats&amp;gt;&lt;/p&gt;

&lt;p&gt;And used in route like this:&lt;/p&gt;

&lt;p&gt;&amp;lt;unmarshal ref=&quot;kofax&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;Sometimes however I get following exception:&lt;/p&gt;

&lt;p&gt;org.xml.sax.SAXException: FWK005 parse may not be called while parsing.&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.jaxp.validation.Util.toSAXException(Util.java:65) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;na:1.7.0_21&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at com.sun.org.apache.xerces.internal.jaxp.validation.XMLSchemaFactory.newSchema(XMLSchemaFactory.java:244) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;na:1.7.0_21&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.camel.converter.jaxb.JaxbDataFormat.createUnmarshaller(JaxbDataFormat.java:347) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-jaxb-2.11.1.jar:2.11.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.camel.converter.jaxb.JaxbDataFormat.unmarshal(JaxbDataFormat.java:171) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-jaxb-2.11.1.jar:2.11.1&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.camel.processor.UnmarshalProcessor.process(UnmarshalProcessor.java:57) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.11.1.jar:2.11.1&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Seems that the problem is same as in &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-1565&quot; title=&quot;Make camel-validation thread-safe&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-1565&quot;&gt;&lt;del&gt;CAMEL-1565&lt;/del&gt;&lt;/a&gt;. That ticket was however related to &amp;lt;validate&amp;gt; element.&lt;/p&gt;

&lt;p&gt;Right now I have disabled validation on the jaxb format used for unmarshalling and put extra &amp;lt;validate&amp;gt; in the route. It would be however fine to have this issue fixed as well.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12663379">CAMEL-6630</key>
            <summary>Validation using JAXB format is not thread safe</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="muellerc">Christian M&#252;ller</assignee>
                                    <reporter username="ales_d">Ales Dolecek</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Aug 2013 09:32:21 +0000</created>
                <updated>Tue, 20 Aug 2013 21:34:11 +0000</updated>
                            <resolved>Tue, 20 Aug 2013 21:34:11 +0000</resolved>
                                    <version>2.11.1</version>
                                    <fixVersion>2.11.2</fixVersion>
                    <fixVersion>2.12.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="14400">4h</timeoriginalestimate>
                            <timeestimate seconds="14400">4h</timeestimate>
                                        <comments>
                            <comment id="13742649" author="muellerc" created="Fri, 16 Aug 2013 22:13:53 +0000"  >&lt;p&gt;The reason is, the &lt;a href=&quot;http://download.java.net/jdk7/archive/b123/docs/api/javax/xml/validation/SchemaFactory.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;SchemaFactory&lt;/a&gt; is not thread safe. WTF...&lt;/p&gt;</comment>
                            <comment id="13745445" author="muellerc" created="Tue, 20 Aug 2013 21:21:03 +0000"  >&lt;p&gt;I created an unit test which shows this issue.&lt;/p&gt;

&lt;p&gt;The current implementation needs 9.9 seconds on my machine to unmarshall and 5.8 seconds to marshall 10000 sample xml strings/java objects (single threaded). Of course is fails in the multi threaded case...&lt;/p&gt;

&lt;p&gt;By implementing the simplest solution (creating a new SchemaFactory instance per exchange), we got a performance penalty by 20% - 30%.&lt;br/&gt;
Because of this, I solved this by pooling the SchemaFactory instances using a LinkedBlockingQueue like we do it already in org.apache.camel.converter.jaxp.StaxConverter.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343380</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n7uf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343684</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>