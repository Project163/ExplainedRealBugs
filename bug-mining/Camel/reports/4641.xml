<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:31:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-12829] An autocreated CXF Bus not shut down in CxfSpringEndpoint</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-12829</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;&lt;tt&gt;CxfSpringEndpoint.setApplicationContext(ApplicationContext)&lt;/tt&gt; creates a &lt;tt&gt;org.apache.cxf.Bus&lt;/tt&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; whose &lt;tt&gt;shutdown()&lt;/tt&gt; method is never called. This is one of the causes for a memory leak in WildFly Camel (WFC) &lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt;. &lt;/p&gt;

&lt;p&gt;The steps to reproduce for WFC are as follows:&lt;/p&gt;

&lt;p&gt;1. Start the WFC &lt;br/&gt;
2. run the CXFWSConsumerIntegrationTest several times&lt;br/&gt;
3. Force GC on WFC&lt;br/&gt;
4. Get a heap dump&lt;br/&gt;
NOT OK: There are as many stale SpringBus instances as many times the test was run.&lt;br/&gt;
Expected: no SpringBus instances there &lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/camel/blob/c69affc49415b190645ce25536ffd62348c4fe34/components/camel-cxf/src/main/java/org/apache/camel/component/cxf/CxfSpringEndpoint.java#L251&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/c69affc49415b190645ce25536ffd62348c4fe34/components/camel-cxf/src/main/java/org/apache/camel/component/cxf/CxfSpringEndpoint.java#L251&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/wildfly-extras/wildfly-camel/issues/2649&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/wildfly-extras/wildfly-camel/issues/2649&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13187005">CAMEL-12829</key>
            <summary>An autocreated CXF Bus not shut down in CxfSpringEndpoint</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ppalaga">Peter Palaga</assignee>
                                    <reporter username="ppalaga">Peter Palaga</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Sep 2018 12:24:07 +0000</created>
                <updated>Wed, 26 Sep 2018 12:51:42 +0000</updated>
                            <resolved>Mon, 24 Sep 2018 12:44:27 +0000</resolved>
                                                    <fixVersion>2.21.3</fixVersion>
                    <fixVersion>2.22.2</fixVersion>
                    <fixVersion>2.23.0</fixVersion>
                                    <component>camel-cxf</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16625755" author="githubbot" created="Mon, 24 Sep 2018 12:36:12 +0000"  >&lt;p&gt;ppalaga opened a new pull request #2530: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12829&quot; title=&quot;An autocreated CXF Bus not shut down in CxfSpringEndpoint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12829&quot;&gt;&lt;del&gt;CAMEL-12829&lt;/del&gt;&lt;/a&gt;: An autocreated CXF Bus not shut down in CxfSpringEndpoint&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2530&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2530&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12829&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CAMEL-12829&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16625756" author="githubbot" created="Mon, 24 Sep 2018 12:36:14 +0000"  >&lt;p&gt;GitHub user ppalaga opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2530&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2530&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12829&quot; title=&quot;An autocreated CXF Bus not shut down in CxfSpringEndpoint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12829&quot;&gt;&lt;del&gt;CAMEL-12829&lt;/del&gt;&lt;/a&gt;: An autocreated CXF Bus not shut down in CxfSpringEndpoint&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12829&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CAMEL-12829&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/ppalaga/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ppalaga/camel&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12829&quot; title=&quot;An autocreated CXF Bus not shut down in CxfSpringEndpoint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12829&quot;&gt;&lt;del&gt;CAMEL-12829&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2530.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2530.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2530&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 4a867ef5376932a78d2677785dd261e812b12c78&lt;br/&gt;
Author: Peter Palaga &amp;lt;ppalaga@...&amp;gt;&lt;br/&gt;
Date:   2018-09-24T06:00:53Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12829&quot; title=&quot;An autocreated CXF Bus not shut down in CxfSpringEndpoint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12829&quot;&gt;&lt;del&gt;CAMEL-12829&lt;/del&gt;&lt;/a&gt;: An autocreated CXF Bus not shut down in CxfSpringEndpoint&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16625762" author="githubbot" created="Mon, 24 Sep 2018 12:40:44 +0000"  >&lt;p&gt;davsclaus closed pull request #2530: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12829&quot; title=&quot;An autocreated CXF Bus not shut down in CxfSpringEndpoint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12829&quot;&gt;&lt;del&gt;CAMEL-12829&lt;/del&gt;&lt;/a&gt;: An autocreated CXF Bus not shut down in CxfSpringEndpoint&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2530&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2530&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/components/camel-cxf/src/main/java/org/apache/camel/component/cxf/CxfEndpoint.java b/components/camel-cxf/src/main/java/org/apache/camel/component/cxf/CxfEndpoint.java&lt;br/&gt;
index 25b72b70ce4..1247d4302a9 100644&lt;br/&gt;
&amp;#8212; a/components/camel-cxf/src/main/java/org/apache/camel/component/cxf/CxfEndpoint.java&lt;br/&gt;
+++ b/components/camel-cxf/src/main/java/org/apache/camel/component/cxf/CxfEndpoint.java&lt;br/&gt;
@@ -128,7 +128,7 @@&lt;br/&gt;
     protected Bus bus;&lt;/p&gt;

&lt;p&gt;     private AtomicBoolean getBusHasBeenCalled = new AtomicBoolean(false);&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private volatile boolean createBus;&lt;br/&gt;
+    protected volatile boolean createBus;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;     private BindingConfiguration bindingConfig;&lt;br/&gt;
     private DataBinding dataBinding;&lt;br/&gt;
diff --git a/components/camel-cxf/src/main/java/org/apache/camel/component/cxf/CxfSpringEndpoint.java b/components/camel-cxf/src/main/java/org/apache/camel/component/cxf/CxfSpringEndpoint.java&lt;br/&gt;
index 0671b1632cd..f837dd01ec2 100644&lt;br/&gt;
&amp;#8212; a/components/camel-cxf/src/main/java/org/apache/camel/component/cxf/CxfSpringEndpoint.java&lt;br/&gt;
+++ b/components/camel-cxf/src/main/java/org/apache/camel/component/cxf/CxfSpringEndpoint.java&lt;br/&gt;
@@ -248,6 +248,7 @@ public void setApplicationContext(ApplicationContext ctx) throws BeansException&lt;br/&gt;
         applicationContext = ctx;&lt;/p&gt;

&lt;p&gt;         if (bus == null) &lt;/p&gt;
{
+            createBus = true;
             bus = BusWiringBeanFactoryPostProcessor.addDefaultBus(ctx);
         }
&lt;p&gt;     }&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16625763" author="githubbot" created="Mon, 24 Sep 2018 12:40:45 +0000"  >&lt;p&gt;Github user davsclaus closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2530&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2530&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16625767" author="davsclaus" created="Mon, 24 Sep 2018 12:44:27 +0000"  >&lt;p&gt;Thanks for reporting and the PR&lt;/p&gt;</comment>
                            <comment id="16628707" author="ppalaga" created="Wed, 26 Sep 2018 12:51:42 +0000"  >&lt;p&gt;Cloned to &lt;a href=&quot;https://issues.jboss.org/browse/ENTESB-9537&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://issues.jboss.org/browse/ENTESB-9537&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 7 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3yf1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>