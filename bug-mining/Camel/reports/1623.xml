<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:46:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-4503] Recipient List cannot vary destination by changing property in an expression</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-4503</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;This is probably due to producers being cached based on unresolved endpoint URI, rather than the resolved endpoint URI. Haven&apos;t tested this theory out though.&lt;/p&gt;

&lt;p&gt;See message on user list &lt;a href=&quot;http://markmail.org/message/sdysp6sspq5lomf4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://markmail.org/message/sdysp6sspq5lomf4&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12525193">CAMEL-4503</key>
            <summary>Recipient List cannot vary destination by changing property in an expression</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="janstey">Jonathan Anstey</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Sep 2011 14:50:52 +0000</created>
                <updated>Fri, 21 Oct 2011 09:42:24 +0000</updated>
                            <resolved>Fri, 21 Oct 2011 09:42:24 +0000</resolved>
                                    <version>2.8.1</version>
                                    <fixVersion>2.8.3</fixVersion>
                    <fixVersion>2.9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13117345" author="janstey" created="Thu, 29 Sep 2011 14:59:10 +0000"  >&lt;p&gt;IRC chat on this here &lt;a href=&quot;http://irclogs.dankulp.com/logs/irclogger_log/karaf?date=2011-09-29,Thu&amp;amp;sel=335#l331&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://irclogs.dankulp.com/logs/irclogger_log/karaf?date=2011-09-29,Thu&amp;amp;sel=335#l331&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13120732" author="achim_nierbeck" created="Wed, 5 Oct 2011 07:29:13 +0000"  >&lt;p&gt;Unfortunately I just realized that the mentioned workaround doesn&apos;t work &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I&apos;m investigating why it isn&apos;t I&apos;m down to the following right now: &lt;/p&gt;

&lt;p&gt;answer = endpoints.get(getEndpointKey(uri));&lt;/p&gt;

&lt;p&gt;in DefaultCamelContext does give me the wrong Endpoint, at least it&apos;s bound to the wrong URI. &lt;/p&gt;

&lt;p&gt;it&apos;s called from &lt;/p&gt;

&lt;p&gt;endpoint = resolveEndpoint(exchange, recipient);&lt;/p&gt;

&lt;p&gt;in RecipientListProcessor.createProcessorExchangePairs(...)&lt;/p&gt;

&lt;p&gt;The following scenario doesn&apos;t work right now for the workaround, this might be a different bug though: &lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Recipient A is resolved the way it should work and can be called&lt;/li&gt;
	&lt;li&gt;if Recipient B is questioned it also works and can be used.&lt;/li&gt;
	&lt;li&gt;if Recipient A is questioned from the cache again, Recipient B is provided and therefore the requests end up&lt;br/&gt;
  on the wrong host. &lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I also added a comment to the mailing-list about this. &lt;/p&gt;</comment>
                            <comment id="13130708" author="davsclaus" created="Wed, 19 Oct 2011 15:52:27 +0000"  >&lt;p&gt;Okay the bug seems to be in camel-cxf, in CxfComponent.createEndpoint. As it return the same endpoint instance even though the ?address is different.&lt;/p&gt;</comment>
                            <comment id="13130720" author="davsclaus" created="Wed, 19 Oct 2011 16:09:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-4139&quot; title=&quot;Unify blueprint and spring namespace parsing in camel-cxf&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-4139&quot;&gt;&lt;del&gt;CAMEL-4139&lt;/del&gt;&lt;/a&gt; causes this problem, it will lookup existing bean by its id, and reuse that as CxfEndpoint.&lt;br/&gt;
Even if CxfComponent is creating a new CxfEndpoint.&lt;/p&gt;

&lt;p&gt;It seems the problem is that if you omit the address in the &amp;lt;cxf:cxfEndpoint&amp;gt; in the XML file.&lt;br/&gt;
And then you want to use that &amp;lt;cxf:cxfEndpoint&amp;gt; bean but specific the address at runtime. Then CxfComponent&lt;br/&gt;
will still hand out a shared CxfEndpoint. &lt;/p&gt;

&lt;p&gt;It guess the tricky part is that with cxf:bean:xxx you refer to a bean, and then you &lt;b&gt;also&lt;/b&gt; provide additional configurations which should override.&lt;br/&gt;
This seems a hard path to support. Maybe cxf:bean:xxx should be made to not accept any parameters at all, if that makes sense.&lt;/p&gt;

&lt;p&gt;Alternative the cxf:bean:xxx should be sort of a template, and then being able to create &quot;clones&quot; of itself.&lt;/p&gt;</comment>
                            <comment id="13131380" author="njiang" created="Thu, 20 Oct 2011 05:04:32 +0000"  >&lt;p&gt;In most case the configure of cxfEndpoint bean will not be changed, it should be OK if you just reuse the bean endpoint.&lt;br/&gt;
If there are some parameter which can be used to override the configuration in the endpoint uri, we could clone a new endpoint to use.&lt;/p&gt;</comment>
                            <comment id="13131432" author="davsclaus" created="Thu, 20 Oct 2011 07:47:21 +0000"  >&lt;p&gt;Willem I have committed an unit tests that reproduces the issue&lt;br/&gt;
tests/camel-itest/src/test/java/org/apache/camel/itest/greeter/RecipientListCxf2Test.java&lt;/p&gt;

&lt;p&gt;With your recent fix on trunk (eg the clone) the problem with picking up the wrong bean is resolved as far.&lt;br/&gt;
But we get a NPE exception later.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Caused by: java.lang.NullPointerException
	at org.apache.camel.component.cxf.CxfProducer.prepareRequest(CxfProducer.java:168)
	at org.apache.camel.component.cxf.CxfProducer.process(CxfProducer.java:89)
	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:321)
	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:212)
	at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:102)
	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:73)
	at org.apache.camel.processor.MulticastProcessor.doProcessSequential(MulticastProcessor.java:575)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The CxfBinding is null on the endpoint. So I guess a little more fix is needed. Do you mind digging into this?&lt;/p&gt;</comment>
                            <comment id="13131439" author="njiang" created="Thu, 20 Oct 2011 08:13:43 +0000"  >&lt;p&gt;@Claus&lt;br/&gt;
That&apos;s my bad, I will update the copy method of CxfEndpoint by setting the list reference with a deep copy one.&lt;/p&gt;</comment>
                            <comment id="13131466" author="njiang" created="Thu, 20 Oct 2011 09:02:50 +0000"  >&lt;p&gt;The NPE is caused by the clone method of CxfEndpoint, as you know CxfEndpoint extends the ServiceSupport object which has lots of AutomBoolean objects.&lt;br/&gt;
If the CxfEndpoint instance is started, the cloned CxfEndpoint will not start again.&lt;br/&gt;
It looks like calling the clone method is not a idea way to resolve such issue. I&apos;m still looking for a good solution. &lt;/p&gt;</comment>
                            <comment id="13132557" author="njiang" created="Fri, 21 Oct 2011 09:42:24 +0000"  >&lt;p&gt;This is fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-4561&quot; title=&quot;CxfComponent should create a new CxfEndpoint instance if the instance is lookup from configuration registry&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-4561&quot;&gt;&lt;del&gt;CAMEL-4561&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12527878">CAMEL-4561</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>40003</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 5 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i021c7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9818</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>