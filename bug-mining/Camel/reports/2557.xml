<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:00:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-7009] RabbitMQ Consumer does not pick up REPLY_TO</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-7009</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When using RPC in RabbitMQ, the producer sets up an exclusive queue and specifies that queue as the reply_to on outgoing messages.  When the consumer in camel-rabbitmq receives the messages, the reply_to isn&apos;t available on the exchange, so no RPC calls can be completed.&lt;/p&gt;

&lt;p&gt;The following Python script (from RabbitMQ In Action) produces the message with a reply_to property:&lt;/p&gt;

&lt;p&gt;import time, json, pika&lt;/p&gt;

&lt;p&gt;creds_broker = pika.PlainCredentials(&quot;guest&quot;, &quot;guest&quot;)&lt;br/&gt;
conn_params = pika.ConnectionParameters(&quot;localhost&quot;,&lt;br/&gt;
                                         virtual_host = &quot;/&quot;,&lt;br/&gt;
                                         credentials = creds_broker)&lt;br/&gt;
conn_broker = pika.BlockingConnection(conn_params)&lt;br/&gt;
channel = conn_broker.channel()&lt;/p&gt;

&lt;p&gt;msg = json.dumps(&lt;/p&gt;
{&quot;client_name&quot;: &quot;RPC Client 1.0&quot;,
                  &quot;time&quot; : time.time()}
&lt;p&gt;)&lt;br/&gt;
result = channel.queue_declare(exclusive=True, auto_delete=True)&lt;br/&gt;
msg_props = pika.BasicProperties()&lt;br/&gt;
msg_props.reply_to = result.method.queue&lt;/p&gt;

&lt;p&gt;channel.basic_publish(body=msg,&lt;br/&gt;
                      exchange=&quot;talentsprout.rpc&quot;,&lt;br/&gt;
                      properties=msg_props,&lt;br/&gt;
                      routing_key=&quot;ping&quot;)&lt;/p&gt;

&lt;p&gt;print &quot;Sent &apos;Ping&apos; RPC call.  Waiting for reply...&quot;&lt;/p&gt;

&lt;p&gt;def reply_callback(channel, method, header, body):&lt;br/&gt;
     &quot;&quot;&quot;Receives RPC server replies.&quot;&quot;&quot;&lt;br/&gt;
     print &quot;RPC Reply &amp;#8212; &quot; + body&lt;br/&gt;
     channel.stop_consuming()&lt;/p&gt;

&lt;p&gt;channel.basic_consume(reply_callback,&lt;br/&gt;
                      queue=result.method.queue,&lt;br/&gt;
                      consumer_tag=result.method.queue)&lt;/p&gt;

&lt;p&gt;channel.start_consuming()&lt;/p&gt;



&lt;p&gt;The following route in Camel would consume messages from this queue:&lt;/p&gt;

&lt;p&gt;		from(&quot;rabbitmq://192.168.213.130/talentsprout.rpc?queue=ping&amp;amp;routingKey=ping&amp;amp;durable=False&amp;amp;autoDelete=False&amp;amp;autoAck=False&amp;amp;username=guest&amp;amp;password=guest&quot;)&lt;br/&gt;
		.log(&quot;Headers: ${headers}&quot;);&lt;/p&gt;

&lt;p&gt;The log statement from that route shows that no reply_to header is added.&lt;/p&gt;

&lt;p&gt;Without this feature, RPC from external producers cannot work.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12681194">CAMEL-7009</key>
            <summary>RabbitMQ Consumer does not pick up REPLY_TO</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="jrfoster67">Jason Foster</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Nov 2013 03:35:27 +0000</created>
                <updated>Tue, 3 Dec 2013 00:38:09 +0000</updated>
                            <resolved>Tue, 3 Dec 2013 00:38:08 +0000</resolved>
                                    <version>2.12.1</version>
                                    <fixVersion>2.12.2</fixVersion>
                                    <component>camel-rabbitmq</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13832376" author="njiang" created="Tue, 26 Nov 2013 07:32:41 +0000"  >&lt;p&gt;I just checked the code of RabbitMQConsumer, it just put the REPLY_TO into the message header.&lt;br/&gt;
Can you double check if the message properties is set rightly?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (properties.getReplyTo() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                exchange.getIn().setHeader(RabbitMQConstants.REPLY_TO, properties.getReplyTo());
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13832404" author="njiang" created="Tue, 26 Nov 2013 08:22:37 +0000"  >&lt;p&gt;I just ran a simple tests and verified the REPLY_TO message header is set rightly.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;rabbitmq.REPLY_TO=myReply
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13832757" author="jrfoster67" created="Tue, 26 Nov 2013 16:54:39 +0000"  >&lt;p&gt;I downloaded the source from here &lt;a href=&quot;http://www.interior-dsgn.com/apache/camel/apache-camel/2.12.1/apache-camel-2.12.1-src.zip&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.interior-dsgn.com/apache/camel/apache-camel/2.12.1/apache-camel-2.12.1-src.zip&lt;/a&gt; and looked in apache-camel-2.12.1\components\camel-rabbitmq\src\main\java\org\apache\camel\component\rabbitmq\RabbitMQConsumer.java and don&apos;t see the code you posted in the comment.  I also did a full search through the entire camel 2.12.1 source tree for that constant (using ultra-edit), and only found the following two references:&lt;/p&gt;

&lt;p&gt;----------------------------------------&lt;br/&gt;
Find &apos;RabbitMQConstants.REPLY_TO&apos; in &apos;C:\DevJava\Workspaces\apache-camel-2.12.1\components\camel-rabbitmq\src\main\java\org\apache\camel\component\rabbitmq\RabbitMQProducer.java&apos; (11/26/2013 10:01:38 AM; 9/18/2013 9:35:08 PM):&lt;br/&gt;
C:\DevJava\Workspaces\apache-camel-2.12.1\components\camel-rabbitmq\src\main\java\org\apache\camel\component\rabbitmq\RabbitMQProducer.java(90):         final Object replyTo = exchange.getIn().getHeader(RabbitMQConstants.REPLY_TO);&lt;br/&gt;
Found &apos;RabbitMQConstants.REPLY_TO&apos; 1 time(s).&lt;br/&gt;
----------------------------------------&lt;br/&gt;
Find &apos;RabbitMQConstants.REPLY_TO&apos; in &apos;C:\DevJava\Workspaces\apache-camel-2.12.1\components\camel-rabbitmq\src\test\java\org\apache\camel\component\rabbitmq\RabbitMQProducerTest.java&apos; (11/26/2013 10:01:38 AM; 9/18/2013 9:35:08 PM):&lt;br/&gt;
C:\DevJava\Workspaces\apache-camel-2.12.1\components\camel-rabbitmq\src\test\java\org\apache\camel\component\rabbitmq\RabbitMQProducerTest.java(101):         message.setHeader(RabbitMQConstants.REPLY_TO, &quot;bbbbdfgdfg&quot;);&lt;br/&gt;
Found &apos;RabbitMQConstants.REPLY_TO&apos; 1 time(s).&lt;br/&gt;
Search complete, found &apos;RabbitMQConstants.REPLY_TO&apos; 2 time(s). (2 file(s)).&lt;/p&gt;

&lt;p&gt;Not sure if the trunk has been updated and not released, or if we&apos;re not talking about the same code.&lt;/p&gt;

&lt;p&gt;However, if I run the above route in camel, and run the above python script, these are the headers I see:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;#2 - RabbitMQConsumer&quot; target=&quot;_blank&quot; rel=&quot;noopener&quot;&gt;) thread #2 - RabbitMQConsumer&lt;/a&gt; route1                         INFO  Headers: &lt;/p&gt;
{rabbitmq.EXCHANGE_NAME=talentsprout.rpc, breadcrumbId=ID-DENORALT852-61351-1385483624264-0-1, rabbitmq.ROUTING_KEY=ping, rabbitmq.DELIVERY_TAG=1}
</comment>
                            <comment id="13836917" author="jrfoster67" created="Mon, 2 Dec 2013 21:00:10 +0000"  >&lt;p&gt;I looked at  and re-tested with 2.12.2 I can now see that the REPLY_TO header (and others) do get correctly set on the consumer, so must have been code in the trunk you were looking at.&lt;/p&gt;</comment>
                            <comment id="13837153" author="njiang" created="Tue, 3 Dec 2013 00:38:09 +0000"  >&lt;p&gt;It is already fixed in camel-2.12.2.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>360459</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 51 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1q4yv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>360758</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>