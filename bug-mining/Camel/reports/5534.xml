<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:44:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-13024] Camel-Mail breaks some attachment names with many special characters</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-13024</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;The patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12630&quot; title=&quot;Better attachment handling in camel-mail component&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12630&quot;&gt;&lt;del&gt;CAMEL-12630&lt;/del&gt;&lt;/a&gt; introduced the following line for Attachment file names in the MailBinding class.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fileName = FileUtil.stripPath(part.getFileName());&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This code usually makes sense, it strips paths from attachment names. However, if the file name of the attachment contains many non-ASCII characters (more than ASCII characters) the file name provided by the mail is Base64 encoded, e.g.: &quot;=?UTF-8?B?6Kq/5pW0?=&quot;&lt;/p&gt;

&lt;p&gt;As the / is a valid character in Base64 encoding (but is not a path delimiter there) the stripPath() call on that string will mutilate the filename to &quot;5pW0?=&quot;.&lt;/p&gt;

&lt;p&gt;A workaround for this issue is to set the Java system property &quot;mail.mime.decodefilename&quot; to &quot;true&quot;. In this case the part.getFileName() will decode the filename before stripping paths.&lt;/p&gt;

&lt;p&gt;The attached unit test might demonstrate the issue.&lt;/p&gt;

&lt;p&gt;I am not sure how this can be fixed in a compatible way. One option would be to perform a MimeUtility.decodeText() call on the file name (if it is not null), which will essentially have the same effect as setting the system property (which means that the attachment filename is decoded before processing it further), but this will be kind of incompatible.&lt;/p&gt;

&lt;p&gt;Note: The issue will not occur if there are more ASCII characters than non-ASCII characters in the filename, because in that case the non-ASCII characters will be encoded using quoted printable encoding (which does not include a &quot;/&quot; character), and even if the file name is Base64 encoded it does not necessarily mean that the Base64 encoded filename contains a &quot;/&quot;, so you might hardly see that issue in real life.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13205743">CAMEL-13024</key>
            <summary>Camel-Mail breaks some attachment names with many special characters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="siano">Stephan Siano</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Dec 2018 14:37:24 +0000</created>
                <updated>Thu, 17 Dec 2020 19:38:52 +0000</updated>
                            <resolved>Thu, 17 Dec 2020 19:38:52 +0000</resolved>
                                    <version>2.23.0</version>
                                    <fixVersion>3.8.0</fixVersion>
                                    <component>camel-mail</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17251311" author="davsclaus" created="Thu, 17 Dec 2020 19:38:52 +0000"  >&lt;p&gt;I added an option to configure on the component/endpoint whether to encode the file name or not.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12952545" name="MailBindingAttachmentEncodedFilenameTest.java" size="2757" author="siano" created="Thu, 20 Dec 2018 14:18:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 47 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|u00708:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>