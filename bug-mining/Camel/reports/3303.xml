<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:09:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-8646] Camel doesn&apos;t allow intercept and advice on the same route</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-8646</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Let&apos;s assume we have a route, defined in a RouteBuilder. It allows us to define an interceptor that would be executed before every route step, via an intercept(Processor) call.&lt;/p&gt;

&lt;p&gt;Routes can also have an advice attached to them, via RouteDefinition.adviceWith(AdviceWithRouteBuilder) call.&lt;/p&gt;

&lt;p&gt;If these two methods of weaving custom processing into existing routes are combined, Camel throws an exception:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Exception in thread &quot;main&quot; java.lang.IllegalArgumentException: There are no outputs which matches: * in the route: Route(main)[[From[direct:main]] -&amp;gt; [Intercept[[Log[Intercept ${body} ${headers}]]], Log[Main ${body} ${headers}]]]
	at org.apache.camel.builder.AdviceWithTasks$3.task(AdviceWithTasks.java:257)
	at org.apache.camel.model.RouteDefinition.adviceWith(RouteDefinition.java:270)
	at camel.Test.main(Test.java:20)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Simple test to illustrate the issue:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;import org.apache.camel.builder.AdviceWithRouteBuilder;
import org.apache.camel.builder.RouteBuilder;
import org.apache.camel.impl.DefaultCamelContext;
import org.apache.camel.model.ModelCamelContext;

public class Test {
	public static void main(String[] args) throws Exception {
		ModelCamelContext context = new DefaultCamelContext();
		RouteBuilder route = new RouteBuilder() {
			@Override
			public void configure() throws Exception {
				from(&quot;direct:advice&quot;).log(&quot;Advice ${body} ${headers}&quot;);
				from(&quot;direct:main&quot;).routeId(&quot;main&quot;).log(&quot;Main ${body} ${headers}&quot;);
			}
		};
		route.intercept().log(&quot;Intercept ${body} ${headers}&quot;);
		context.addRoutes(route);
		context.getRouteDefinition(&quot;main&quot;).adviceWith(context, new AdviceWithRouteBuilder() {
			@Override
			public void configure() throws Exception {
				weaveAddFirst().to(&quot;direct:advice&quot;);
			}
		});
	}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12821529">CAMEL-8646</key>
            <summary>Camel doesn&apos;t allow intercept and advice on the same route</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="alex_savitsky">Alex Savitsky</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Apr 2015 14:02:24 +0000</created>
                <updated>Sun, 12 Jul 2015 14:11:00 +0000</updated>
                            <resolved>Sun, 12 Jul 2015 14:11:00 +0000</resolved>
                                    <version>2.15.0</version>
                                    <fixVersion>2.15.3</fixVersion>
                    <fixVersion>2.16.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14620254" author="davsclaus" created="Thu, 9 Jul 2015 10:18:15 +0000"  >&lt;p&gt;Works with latest code, maybe also with 2.15.2&lt;/p&gt;</comment>
                            <comment id="14620453" author="alex_savitsky" created="Thu, 9 Jul 2015 12:52:57 +0000"  >&lt;p&gt;What do you mean by &quot;latest code&quot;? The latest I see in Maven is 2.15.2, and the code certainly fails there. Will attach a complete Maven project to illustrate the issue.&lt;/p&gt;</comment>
                            <comment id="14620455" author="alex_savitsky" created="Thu, 9 Jul 2015 12:54:16 +0000"  >&lt;p&gt;Import into Eclipse, and run Test class (default package)&lt;/p&gt;</comment>
                            <comment id="14623824" author="davsclaus" created="Sun, 12 Jul 2015 14:11:00 +0000"  >&lt;p&gt;You must do the intercept before the from in the routes - you are doing that wrong.&lt;/p&gt;

&lt;p&gt;If you did&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                from(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:advice&quot;&lt;/span&gt;).log(&lt;span class=&quot;code-quote&quot;&gt;&quot;Advice ${body} ${headers}&quot;&lt;/span&gt;);
                from(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:main&quot;&lt;/span&gt;).routeId(&lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt;).log(&lt;span class=&quot;code-quote&quot;&gt;&quot;Main ${body} ${headers}&quot;&lt;/span&gt;);

                intercept().log(&lt;span class=&quot;code-quote&quot;&gt;&quot;Intercept ${body}&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then Camel will complain about this fact.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12744483" name="test.zip" size="8316" author="alex_savitsky" created="Thu, 9 Jul 2015 12:54:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 19 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2dchj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>