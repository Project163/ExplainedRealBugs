<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:42:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-15455] EndpointDSL breaks expressions in query parameters</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-15455</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Expressions in parameters are destroyed by url-encoding during url creation in AbstractEndpointBuilder (using little non-sensical example to make reproduction setup easier).&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.toD(seda(&lt;span class=&quot;code-quote&quot;&gt;&quot;someName&quot;&lt;/span&gt;).size(&lt;span class=&quot;code-quote&quot;&gt;&quot;${header.size}&quot;&lt;/span&gt;))&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;will be translated by AbstractEndpointBuilder#computeUri (which uses URISupport#createQueryString) to&lt;/p&gt;

&lt;p&gt;&lt;em&gt;seda://someName?size=%24%7Bheader.size%7D&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;This will, of course, throw exception on endpoint creation.&lt;/p&gt;

&lt;p&gt;For some reason, thrown exception is url-decoded, so parameter names will look OK, even when they are broken (this makes the error more difficult to spot)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
...
java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; to the required type: &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; with value ${header.size} due to org.apache.camel.TypeConversionException: Error during type conversion from type: java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; to the required type: java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; with value ${header.size} due to java.lang.NumberFormatException: For input string: &lt;span class=&quot;code-quote&quot;&gt;&quot;${header.size}&quot;&lt;/span&gt;
...


&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Enclosing expressions in RAW(..), fixes the issue, it is however quite suboptimal.&lt;/p&gt;

&lt;p&gt;Following workaround will work:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.toD(seda(&lt;span class=&quot;code-quote&quot;&gt;&quot;someName&quot;&lt;/span&gt;).size(&lt;span class=&quot;code-quote&quot;&gt;&quot;RAW(${header.size})&quot;&lt;/span&gt;))&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13324203">CAMEL-15455</key>
            <summary>EndpointDSL breaks expressions in query parameters</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="vdobos">Vladimir Dobos</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Aug 2020 08:22:52 +0000</created>
                <updated>Tue, 25 Aug 2020 08:03:19 +0000</updated>
                            <resolved>Tue, 25 Aug 2020 08:03:19 +0000</resolved>
                                    <version>3.4.3</version>
                                    <fixVersion>3.5.0</fixVersion>
                    <fixVersion>3.4.4</fixVersion>
                                    <component>camel-endpointdsl</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17183376" author="davsclaus" created="Mon, 24 Aug 2020 15:17:18 +0000"  >&lt;p&gt;So this is more about toD being dynamic and you are using simple expressions for those parameters. A regular to would not accept ${header.xxx} in the size parameter. And therefore we may not have noticed this before.&lt;/p&gt;</comment>
                            <comment id="17183475" author="vdobos" created="Mon, 24 Aug 2020 17:09:23 +0000"  >&lt;p&gt;Yes, it is about using expression in parameters in toD (originally noticed this because I have requestTimeout in jms-component dependant on few runtime parameters)&lt;br/&gt;
From what I found in my limited debugging time, when getUrl() is called on AbstractEndpointBuilder, url query parameters are assembled url-encoded (default behaviour of URISupport#createQueryString), which then makes SendDynamicProcessor not evaluate the parameter values as expressions when creating/retrieving dynamic endpoint.&lt;br/&gt;
 When passing plain string in toD, it is not be url-encoded before expressions are evaluated.&lt;/p&gt;</comment>
                            <comment id="17183498" author="davsclaus" created="Mon, 24 Aug 2020 17:40:36 +0000"  >&lt;p&gt;Yeah that is a good observation, so we may want to allow the endpoint dsl to build with encoded and non encoding depending on the EIP pattern. As others would depend on current behaviour. And then check if those options are using simple expressions, eg ${ } or $simple{ } style which is what you used in your example.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 12 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0i0zs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>