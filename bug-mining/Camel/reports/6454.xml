<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:01:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-19295] Concurrency issues with dynamicMap in AbstractDynamicRegistry</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-19295</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Hello everyone,&lt;/p&gt;

&lt;p&gt;We have detected concurrency issues related to the dynamicMap attribute of the AbstractDynamicRegistry class. By default, dynamicMap is an object of the SimpleLRUCache class, which inherits from LinkedHashMap.&lt;/p&gt;

&lt;p&gt;We have resolved the issue by creating our own LRUCacheFactory which returns a thread-safe synchronized map backed by the specified map.&lt;/p&gt;

&lt;p&gt;Could you please review it?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13533883">CAMEL-19295</key>
            <summary>Concurrency issues with dynamicMap in AbstractDynamicRegistry</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rhuanrocha">Rhuan Rocha</assignee>
                                    <reporter username="adavila">Alan D&#225;vila</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Apr 2023 17:48:24 +0000</created>
                <updated>Sun, 28 May 2023 10:23:09 +0000</updated>
                            <resolved>Fri, 26 May 2023 09:58:24 +0000</resolved>
                                    <version>3.14.2</version>
                                    <fixVersion>3.21.0</fixVersion>
                    <fixVersion>4.0-RC1</fixVersion>
                    <fixVersion>4.0.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17715942" author="JIRAUSER297305" created="Mon, 24 Apr 2023 18:57:08 +0000"  >&lt;p&gt;Hi, I&apos;m not sure if the issue is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-19014&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CAMEL-19014&lt;/a&gt; which is already resolved. Is it happening just to 3.14.2? Have you tested with newer versions?&lt;/p&gt;</comment>
                            <comment id="17716217" author="JIRAUSER300034" created="Tue, 25 Apr 2023 10:46:35 +0000"  >&lt;p&gt;Hi, yes, I have also tried it in version 3.14.7 and the same error occurs. I have attached a code snippet to force the error.&lt;/p&gt;</comment>
                            <comment id="17716470" author="JIRAUSER297305" created="Tue, 25 Apr 2023 23:27:32 +0000"  >&lt;p&gt;Yes, but have you tried it in version 3.21.x or 4? The issue I sent solves the problem to 2.21.x and 4. I will try to test it with the reproducer you attached.&#160;&lt;/p&gt;</comment>
                            <comment id="17716599" author="JIRAUSER300034" created="Wed, 26 Apr 2023 08:24:33 +0000"  >&lt;p&gt;Hi, yes, I have tried with version 3.20.3 and 4.0.0-M2 and the same error occurs. Creating LRUCacheFactory instance from this class serves as a stopgap solution for the tested versions.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;SynchronizedLRUCacheFactory &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; DefaultLRUCacheFactory {  
   
    ...

 &#160;  @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &amp;lt;K, V&amp;gt; Map&amp;lt;K, V&amp;gt; createLRUCache(&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; maximumCacheSize) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Collections.synchronizedMap(&lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.createLRUCache(maximumCacheSize));
    }

    ...

}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17724197" author="davsclaus" created="Fri, 19 May 2023 08:55:25 +0000"  >&lt;p&gt;You can just add camel-caffeine-lrucache to your classpath and Camel should automatic use this cache instead of SimpleLRUCache&lt;/p&gt;</comment>
                            <comment id="17726336" author="JIRAUSER285918" created="Thu, 25 May 2023 17:59:15 +0000"  >&lt;p&gt;The backport for 3.21 &lt;a href=&quot;https://github.com/apache/camel/pull/10213&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/10213&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310660">
                    <name>Completes</name>
                                            <outwardlinks description="fixes">
                                        <issuelink>
            <issuekey id="13537921">CAMEL-19397</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13534741">CAMEL-19311</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13057558" name="OOMECamelEndpointRegistry.java" size="2915" author="adavila" created="Tue, 25 Apr 2023 10:44:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 24 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1hi1s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>