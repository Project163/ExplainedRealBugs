<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:41:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-3317] HawtDB throws IOPagingException</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-3317</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When running Camel when the HawtDB file does not exist, and is created on startup we see errors like this after running for a short time:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2010-11-30 11:51:21.649587500 [DefaultMessageListenerContainer-1] WARN  org.apache.camel.component.hawtdb.HawtDBFile - Error executing work Removing key [24053] will do rollback.
2010-11-30 11:51:21.649589500 org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 2
2010-11-30 11:51:21.649589500 	at org.fusesource.hawtdb.internal.page.Extent.readHeader(Extent.java:85)
2010-11-30 11:51:21.649590500 	at org.fusesource.hawtdb.internal.page.Extent.freeLinked(Extent.java:234)
2010-11-30 11:51:21.649601500 	at org.fusesource.hawtdb.internal.page.Extent.pagesLinked(Extent.java:190)
2010-11-30 11:51:21.649602500 	at org.fusesource.hawtdb.api.AbstractStreamPagedAccessor.pagesLinked(AbstractStreamPagedAccessor.java:77)
2010-11-30 11:51:21.649602500 	at org.fusesource.hawtdb.internal.page.Batch.performDeferredUpdates(Batch.java:184)
2010-11-30 11:51:21.649603500 	at org.fusesource.hawtdb.internal.page.HawtTxPageFile.storeBatches(HawtTxPageFile.java:599)
2010-11-30 11:51:21.649605500 	at org.fusesource.hawtdb.internal.page.HawtTxPageFile.flush(HawtTxPageFile.java:522)
2010-11-30 11:51:21.649605500 	at org.apache.camel.component.hawtdb.HawtDBFile.doExecute(HawtDBFile.java:163)
2010-11-30 11:51:21.649606500 	at org.apache.camel.component.hawtdb.HawtDBFile.execute(HawtDBFile.java:106)
2010-11-30 11:51:21.649606500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository.remove(HawtDBAggregationRepository.java:179)
2010-11-30 11:51:21.649609500 	at org.apache.camel.processor.aggregate.AggregateProcessor.onCompletion(AggregateProcessor.java:352)
2010-11-30 11:51:21.649610500 	at org.apache.camel.processor.aggregate.AggregateProcessor.doAggregation(AggregateProcessor.java:264)
2010-11-30 11:51:21.649610500 	at org.apache.camel.processor.aggregate.AggregateProcessor.process(AggregateProcessor.java:185)
2010-11-30 11:51:21.649612500 	at org.apache.camel.impl.converter.AsyncProcessorTypeConverter$ProcessorToAsyncProcessorBridge.process(AsyncProcessorTypeConverter.java:50)
2010-11-30 11:51:21.649613500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.649613500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.649613500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.649615500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.649616500 	at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:99)
2010-11-30 11:51:21.649616500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.649629500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.649629500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.649630500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.649630500 	at org.apache.camel.processor.DefaultChannel.process(DefaultChannel.java:256)
2010-11-30 11:51:21.649632500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.649633500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.649633500 	at org.apache.camel.processor.Pipeline.process(Pipeline.java:143)
2010-11-30 11:51:21.649633500 	at org.apache.camel.processor.Pipeline.process(Pipeline.java:78)
2010-11-30 11:51:21.649634500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.649635500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.649636500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.649636500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.649638500 	at org.apache.camel.spring.spi.TransactionErrorHandler.processByErrorHandler(TransactionErrorHandler.java:198)
2010-11-30 11:51:21.649639500 	at org.apache.camel.spring.spi.TransactionErrorHandler$1.doInTransactionWithoutResult(TransactionErrorHandler.java:152)
2010-11-30 11:51:21.649640500 	at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:33)
2010-11-30 11:51:21.649641500 	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:130)
2010-11-30 11:51:21.649642500 	at org.apache.camel.spring.spi.TransactionErrorHandler.doInTransactionTemplate(TransactionErrorHandler.java:145)
2010-11-30 11:51:21.649642500 	at org.apache.camel.spring.spi.TransactionErrorHandler.processInTransaction(TransactionErrorHandler.java:120)
2010-11-30 11:51:21.649644500 	at org.apache.camel.spring.spi.TransactionErrorHandler.process(TransactionErrorHandler.java:91)
2010-11-30 11:51:21.649645500 	at org.apache.camel.spring.spi.TransactionErrorHandler.process(TransactionErrorHandler.java:100)
2010-11-30 11:51:21.649645500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.649647500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.649648500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.649648500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.649649500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.649650500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.649651500 	at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:99)
2010-11-30 11:51:21.649651500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.649652500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.649653500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.649654500 	at org.apache.camel.processor.DefaultChannel.process(DefaultChannel.java:256)
2010-11-30 11:51:21.649654500 	at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:99)
2010-11-30 11:51:21.649657500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.649657500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.649658500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.649658500 	at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:68)
2010-11-30 11:51:21.649668500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.649668500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:85)
2010-11-30 11:51:21.649669500 	at org.apache.camel.component.jms.EndpointMessageListener.onMessage(EndpointMessageListener.java:91)
2010-11-30 11:51:21.649669500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:560)
2010-11-30 11:51:21.649671500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:498)
2010-11-30 11:51:21.649672500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:467)
2010-11-30 11:51:21.649675500 	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:323)
2010-11-30 11:51:21.649676500 	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:241)
2010-11-30 11:51:21.649677500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1056)
2010-11-30 11:51:21.649678500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1048)
2010-11-30 11:51:21.649679500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:947)
2010-11-30 11:51:21.649681500 	at java.lang.Thread.run(Thread.java:662)
2010-11-30 11:51:21.650683500 [DefaultMessageListenerContainer-1] ERROR org.apache.camel.processor.DefaultErrorHandler - Failed delivery for exchangeId: ID:a511-qa.boi.kount.net-43748-1289356219750-4:78314:-1:1:1. Exhausted after delivery attempt: 1 caught: org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 2
2010-11-30 11:51:21.650685500 org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 2
2010-11-30 11:51:21.650686500 	at org.fusesource.hawtdb.internal.page.Extent.readHeader(Extent.java:85)
2010-11-30 11:51:21.650690500 	at org.fusesource.hawtdb.internal.page.Extent.freeLinked(Extent.java:234)
2010-11-30 11:51:21.650691500 	at org.fusesource.hawtdb.internal.page.Extent.pagesLinked(Extent.java:190)
2010-11-30 11:51:21.650691500 	at org.fusesource.hawtdb.api.AbstractStreamPagedAccessor.pagesLinked(AbstractStreamPagedAccessor.java:77)
2010-11-30 11:51:21.650692500 	at org.fusesource.hawtdb.internal.page.Batch.performDeferredUpdates(Batch.java:184)
2010-11-30 11:51:21.650694500 	at org.fusesource.hawtdb.internal.page.HawtTxPageFile.storeBatches(HawtTxPageFile.java:599)
2010-11-30 11:51:21.650694500 	at org.fusesource.hawtdb.internal.page.HawtTxPageFile.flush(HawtTxPageFile.java:522)
2010-11-30 11:51:21.650697500 	at org.apache.camel.component.hawtdb.HawtDBFile.doExecute(HawtDBFile.java:163)
2010-11-30 11:51:21.650697500 	at org.apache.camel.component.hawtdb.HawtDBFile.execute(HawtDBFile.java:106)
2010-11-30 11:51:21.650698500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository.remove(HawtDBAggregationRepository.java:179)
2010-11-30 11:51:21.650698500 	at org.apache.camel.processor.aggregate.AggregateProcessor.onCompletion(AggregateProcessor.java:352)
2010-11-30 11:51:21.650700500 	at org.apache.camel.processor.aggregate.AggregateProcessor.doAggregation(AggregateProcessor.java:264)
2010-11-30 11:51:21.650700500 	at org.apache.camel.processor.aggregate.AggregateProcessor.process(AggregateProcessor.java:185)
2010-11-30 11:51:21.650701500 	at org.apache.camel.impl.converter.AsyncProcessorTypeConverter$ProcessorToAsyncProcessorBridge.process(AsyncProcessorTypeConverter.java:50)
2010-11-30 11:51:21.650713500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.650713500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.650714500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.650715500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.650718500 	at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:99)
2010-11-30 11:51:21.650718500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.650719500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.650719500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.650721500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.650721500 	at org.apache.camel.processor.DefaultChannel.process(DefaultChannel.java:256)
2010-11-30 11:51:21.650722500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.650722500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.650724500 	at org.apache.camel.processor.Pipeline.process(Pipeline.java:143)
2010-11-30 11:51:21.650724500 	at org.apache.camel.processor.Pipeline.process(Pipeline.java:78)
2010-11-30 11:51:21.650725500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.650725500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.650727500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.650728500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.650728500 	at org.apache.camel.spring.spi.TransactionErrorHandler.processByErrorHandler(TransactionErrorHandler.java:198)
2010-11-30 11:51:21.650729500 	at org.apache.camel.spring.spi.TransactionErrorHandler$1.doInTransactionWithoutResult(TransactionErrorHandler.java:152)
2010-11-30 11:51:21.650730500 	at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:33)
2010-11-30 11:51:21.650731500 	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:130)
2010-11-30 11:51:21.650732500 	at org.apache.camel.spring.spi.TransactionErrorHandler.doInTransactionTemplate(TransactionErrorHandler.java:145)
2010-11-30 11:51:21.650733500 	at org.apache.camel.spring.spi.TransactionErrorHandler.processInTransaction(TransactionErrorHandler.java:120)
2010-11-30 11:51:21.650734500 	at org.apache.camel.spring.spi.TransactionErrorHandler.process(TransactionErrorHandler.java:91)
2010-11-30 11:51:21.650736500 	at org.apache.camel.spring.spi.TransactionErrorHandler.process(TransactionErrorHandler.java:100)
2010-11-30 11:51:21.650736500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.650737500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.650737500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.650739500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.650739500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.650740500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.650740500 	at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:99)
2010-11-30 11:51:21.650749500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.650749500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.650750500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.650753500 	at org.apache.camel.processor.DefaultChannel.process(DefaultChannel.java:256)
2010-11-30 11:51:21.650753500 	at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:99)
2010-11-30 11:51:21.650753500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.650754500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.650756500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.650756500 	at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:68)
2010-11-30 11:51:21.650757500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.650757500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:85)
2010-11-30 11:51:21.650759500 	at org.apache.camel.component.jms.EndpointMessageListener.onMessage(EndpointMessageListener.java:91)
2010-11-30 11:51:21.650759500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:560)
2010-11-30 11:51:21.650760500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:498)
2010-11-30 11:51:21.650762500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:467)
2010-11-30 11:51:21.650763500 	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:323)
2010-11-30 11:51:21.650763500 	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:241)
2010-11-30 11:51:21.650765500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1056)
2010-11-30 11:51:21.650766500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1048)
2010-11-30 11:51:21.650768500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:947)
2010-11-30 11:51:21.650768500 	at java.lang.Thread.run(Thread.java:662)
2010-11-30 11:51:21.650960500 [DefaultMessageListenerContainer-1] WARN  org.apache.camel.spring.spi.TransactionErrorHandler - Transaction rollback (0x2eb80f1c) for ExchangeId: ID:a511-qa.boi.kount.net-43748-1289356219750-4:78314:-1:1:1 due exception: org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 2
2010-11-30 11:51:21.651647500 [DefaultMessageListenerContainer-1] ERROR org.apache.camel.component.jms.EndpointMessageListener - Caused by: [org.apache.camel.RuntimeCamelException - org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 2]
2010-11-30 11:51:21.651648500 org.apache.camel.RuntimeCamelException: org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 2
2010-11-30 11:51:21.651649500 	at org.apache.camel.util.ObjectHelper.wrapRuntimeCamelException(ObjectHelper.java:1140)
2010-11-30 11:51:21.651653500 	at org.apache.camel.spring.spi.TransactionErrorHandler$1.doInTransactionWithoutResult(TransactionErrorHandler.java:163)
2010-11-30 11:51:21.651654500 	at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:33)
2010-11-30 11:51:21.651655500 	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:130)
2010-11-30 11:51:21.651662500 	at org.apache.camel.spring.spi.TransactionErrorHandler.doInTransactionTemplate(TransactionErrorHandler.java:145)
2010-11-30 11:51:21.651662500 	at org.apache.camel.spring.spi.TransactionErrorHandler.processInTransaction(TransactionErrorHandler.java:120)
2010-11-30 11:51:21.651665500 	at org.apache.camel.spring.spi.TransactionErrorHandler.process(TransactionErrorHandler.java:91)
2010-11-30 11:51:21.651666500 	at org.apache.camel.spring.spi.TransactionErrorHandler.process(TransactionErrorHandler.java:100)
2010-11-30 11:51:21.651666500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.651667500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.651668500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.651669500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.651669500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.651670500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.651671500 	at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:99)
2010-11-30 11:51:21.651672500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.651672500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.651674500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.651675500 	at org.apache.camel.processor.DefaultChannel.process(DefaultChannel.java:256)
2010-11-30 11:51:21.651675500 	at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:99)
2010-11-30 11:51:21.651676500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.651677500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.651678500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.651678500 	at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:68)
2010-11-30 11:51:21.651679500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.651680500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:85)
2010-11-30 11:51:21.651681500 	at org.apache.camel.component.jms.EndpointMessageListener.onMessage(EndpointMessageListener.java:91)
2010-11-30 11:51:21.651681500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:560)
2010-11-30 11:51:21.651684500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:498)
2010-11-30 11:51:21.651684500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:467)
2010-11-30 11:51:21.651685500 	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:323)
2010-11-30 11:51:21.651687500 	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:241)
2010-11-30 11:51:21.651687500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1056)
2010-11-30 11:51:21.651689500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1048)
2010-11-30 11:51:21.651690500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:947)
2010-11-30 11:51:21.651696500 	at java.lang.Thread.run(Thread.java:662)
2010-11-30 11:51:21.651696500 Caused by: org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 2
2010-11-30 11:51:21.651697500 	at org.fusesource.hawtdb.internal.page.Extent.readHeader(Extent.java:85)
2010-11-30 11:51:21.651697500 	at org.fusesource.hawtdb.internal.page.Extent.freeLinked(Extent.java:234)
2010-11-30 11:51:21.651699500 	at org.fusesource.hawtdb.internal.page.Extent.pagesLinked(Extent.java:190)
2010-11-30 11:51:21.651700500 	at org.fusesource.hawtdb.api.AbstractStreamPagedAccessor.pagesLinked(AbstractStreamPagedAccessor.java:77)
2010-11-30 11:51:21.651700500 	at org.fusesource.hawtdb.internal.page.Batch.performDeferredUpdates(Batch.java:184)
2010-11-30 11:51:21.651701500 	at org.fusesource.hawtdb.internal.page.HawtTxPageFile.storeBatches(HawtTxPageFile.java:599)
2010-11-30 11:51:21.651702500 	at org.fusesource.hawtdb.internal.page.HawtTxPageFile.flush(HawtTxPageFile.java:522)
2010-11-30 11:51:21.651703500 	at org.apache.camel.component.hawtdb.HawtDBFile.doExecute(HawtDBFile.java:163)
2010-11-30 11:51:21.651703500 	at org.apache.camel.component.hawtdb.HawtDBFile.execute(HawtDBFile.java:106)
2010-11-30 11:51:21.651703500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository.remove(HawtDBAggregationRepository.java:179)
2010-11-30 11:51:21.651706500 	at org.apache.camel.processor.aggregate.AggregateProcessor.onCompletion(AggregateProcessor.java:352)
2010-11-30 11:51:21.651706500 	at org.apache.camel.processor.aggregate.AggregateProcessor.doAggregation(AggregateProcessor.java:264)
2010-11-30 11:51:21.651707500 	at org.apache.camel.processor.aggregate.AggregateProcessor.process(AggregateProcessor.java:185)
2010-11-30 11:51:21.651708500 	at org.apache.camel.impl.converter.AsyncProcessorTypeConverter$ProcessorToAsyncProcessorBridge.process(AsyncProcessorTypeConverter.java:50)
2010-11-30 11:51:21.651709500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.651709500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.651710500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.651711500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.651712500 	at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:99)
2010-11-30 11:51:21.651712500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.651715500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.651715500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.651715500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.651716500 	at org.apache.camel.processor.DefaultChannel.process(DefaultChannel.java:256)
2010-11-30 11:51:21.651718500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.651718500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.651718500 	at org.apache.camel.processor.Pipeline.process(Pipeline.java:143)
2010-11-30 11:51:21.651719500 	at org.apache.camel.processor.Pipeline.process(Pipeline.java:78)
2010-11-30 11:51:21.651719500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.651721500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.651721500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.651722500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.651728500 	at org.apache.camel.spring.spi.TransactionErrorHandler.processByErrorHandler(TransactionErrorHandler.java:198)
2010-11-30 11:51:21.651729500 	at org.apache.camel.spring.spi.TransactionErrorHandler$1.doInTransactionWithoutResult(TransactionErrorHandler.java:152)
2010-11-30 11:51:21.651729500 	... 34 more
2010-11-30 11:51:21.653106500 [DefaultMessageListenerContainer-1] WARN  org.springframework.jms.listener.DefaultMessageListenerContainer - Execution of JMS message listener failed, and no ErrorHandler has been set.
2010-11-30 11:51:21.653107500 org.apache.camel.RuntimeCamelException: org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 2
2010-11-30 11:51:21.653108500 	at org.apache.camel.util.ObjectHelper.wrapRuntimeCamelException(ObjectHelper.java:1140)
2010-11-30 11:51:21.653108500 	at org.apache.camel.spring.spi.TransactionErrorHandler$1.doInTransactionWithoutResult(TransactionErrorHandler.java:163)
2010-11-30 11:51:21.653113500 	at org.springframework.transaction.support.TransactionCallbackWithoutResult.doInTransaction(TransactionCallbackWithoutResult.java:33)
2010-11-30 11:51:21.653114500 	at org.springframework.transaction.support.TransactionTemplate.execute(TransactionTemplate.java:130)
2010-11-30 11:51:21.653114500 	at org.apache.camel.spring.spi.TransactionErrorHandler.doInTransactionTemplate(TransactionErrorHandler.java:145)
2010-11-30 11:51:21.653116500 	at org.apache.camel.spring.spi.TransactionErrorHandler.processInTransaction(TransactionErrorHandler.java:120)
2010-11-30 11:51:21.653117500 	at org.apache.camel.spring.spi.TransactionErrorHandler.process(TransactionErrorHandler.java:91)
2010-11-30 11:51:21.653119500 	at org.apache.camel.spring.spi.TransactionErrorHandler.process(TransactionErrorHandler.java:100)
2010-11-30 11:51:21.653120500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.653120500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.653121500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.653123500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.653123500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.653124500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.653124500 	at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:99)
2010-11-30 11:51:21.653126500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.653126500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.653127500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.653129500 	at org.apache.camel.processor.DefaultChannel.process(DefaultChannel.java:256)
2010-11-30 11:51:21.653129500 	at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:99)
2010-11-30 11:51:21.653130500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:70)
2010-11-30 11:51:21.653130500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.653132500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.653132500 	at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:68)
2010-11-30 11:51:21.653133500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.653133500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:85)
2010-11-30 11:51:21.653140500 	at org.apache.camel.component.jms.EndpointMessageListener.onMessage(EndpointMessageListener.java:91)
2010-11-30 11:51:21.653141500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.doInvokeListener(AbstractMessageListenerContainer.java:560)
2010-11-30 11:51:21.653144500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.invokeListener(AbstractMessageListenerContainer.java:498)
2010-11-30 11:51:21.653144500 	at org.springframework.jms.listener.AbstractMessageListenerContainer.doExecuteListener(AbstractMessageListenerContainer.java:467)
2010-11-30 11:51:21.653145500 	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.doReceiveAndExecute(AbstractPollingMessageListenerContainer.java:323)
2010-11-30 11:51:21.653147500 	at org.springframework.jms.listener.AbstractPollingMessageListenerContainer.receiveAndExecute(AbstractPollingMessageListenerContainer.java:241)
2010-11-30 11:51:21.653147500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.invokeListener(DefaultMessageListenerContainer.java:1056)
2010-11-30 11:51:21.653149500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.executeOngoingLoop(DefaultMessageListenerContainer.java:1048)
2010-11-30 11:51:21.653150500 	at org.springframework.jms.listener.DefaultMessageListenerContainer$AsyncMessageListenerInvoker.run(DefaultMessageListenerContainer.java:947)
2010-11-30 11:51:21.653152500 	at java.lang.Thread.run(Thread.java:662)
2010-11-30 11:51:21.653152500 Caused by: org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 2
2010-11-30 11:51:21.653153500 	at org.fusesource.hawtdb.internal.page.Extent.readHeader(Extent.java:85)
2010-11-30 11:51:21.653154500 	at org.fusesource.hawtdb.internal.page.Extent.freeLinked(Extent.java:234)
2010-11-30 11:51:21.653155500 	at org.fusesource.hawtdb.internal.page.Extent.pagesLinked(Extent.java:190)
2010-11-30 11:51:21.653155500 	at org.fusesource.hawtdb.api.AbstractStreamPagedAccessor.pagesLinked(AbstractStreamPagedAccessor.java:77)
2010-11-30 11:51:21.653156500 	at org.fusesource.hawtdb.internal.page.Batch.performDeferredUpdates(Batch.java:184)
2010-11-30 11:51:21.653156500 	at org.fusesource.hawtdb.internal.page.HawtTxPageFile.storeBatches(HawtTxPageFile.java:599)
2010-11-30 11:51:21.653158500 	at org.fusesource.hawtdb.internal.page.HawtTxPageFile.flush(HawtTxPageFile.java:522)
2010-11-30 11:51:21.653158500 	at org.apache.camel.component.hawtdb.HawtDBFile.doExecute(HawtDBFile.java:163)
2010-11-30 11:51:21.653159500 	at org.apache.camel.component.hawtdb.HawtDBFile.execute(HawtDBFile.java:106)
2010-11-30 11:51:21.653159500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository.remove(HawtDBAggregationRepository.java:179)
2010-11-30 11:51:21.653162500 	at org.apache.camel.processor.aggregate.AggregateProcessor.onCompletion(AggregateProcessor.java:352)
2010-11-30 11:51:21.653162500 	at org.apache.camel.processor.aggregate.AggregateProcessor.doAggregation(AggregateProcessor.java:264)
2010-11-30 11:51:21.653163500 	at org.apache.camel.processor.aggregate.AggregateProcessor.process(AggregateProcessor.java:185)
2010-11-30 11:51:21.653164500 	at org.apache.camel.impl.converter.AsyncProcessorTypeConverter$ProcessorToAsyncProcessorBridge.process(AsyncProcessorTypeConverter.java:50)
2010-11-30 11:51:21.653165500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.653165500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.653166500 	at org.apache.camel.processor.DelegateAsyncProcessor.processNext(DelegateAsyncProcessor.java:98)
2010-11-30 11:51:21.653167500 	at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:89)
2010-11-30 11:51:21.653168500 	at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:99)
2010-11-30 11:51:21.653168500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.653169500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.653175500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.653175500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.653176500 	at org.apache.camel.processor.DefaultChannel.process(DefaultChannel.java:256)
2010-11-30 11:51:21.653176500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.653178500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.653178500 	at org.apache.camel.processor.Pipeline.process(Pipeline.java:143)
2010-11-30 11:51:21.653179500 	at org.apache.camel.processor.Pipeline.process(Pipeline.java:78)
2010-11-30 11:51:21.653179500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:91)
2010-11-30 11:51:21.653180500 	at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:62)
2010-11-30 11:51:21.653181500 	at org.apache.camel.processor.RedeliveryErrorHandler.processErrorHandler(RedeliveryErrorHandler.java:299)
2010-11-30 11:51:21.653181500 	at org.apache.camel.processor.RedeliveryErrorHandler.process(RedeliveryErrorHandler.java:208)
2010-11-30 11:51:21.653182500 	at org.apache.camel.spring.spi.TransactionErrorHandler.processByErrorHandler(TransactionErrorHandler.java:198)
2010-11-30 11:51:21.653184500 	at org.apache.camel.spring.spi.TransactionErrorHandler$1.doInTransactionWithoutResult(TransactionErrorHandler.java:152)
2010-11-30 11:51:21.653185500 	... 34 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It appears that Camel can continue to process messages until we see almost the exact same error, but instead of &quot;Error executing work Removing key&quot; we see &quot;Error executing work Getting key&quot; and in both cases, the key shown is the value of the correlation expression for the aggregator. Once these errors start showing up Camel does not process any more messages. I infer from their text that the error of &quot;Removing key&quot; occurs after aggregation is complete, but the error of &quot;Getting key&quot; occurs when trying to aggregate a new message. It&apos;s therefore understandable why camel would stop being able to process messages if it&apos;s unable to retrieve the already aggregated exchange from the repository.&lt;/p&gt;

&lt;p&gt;When you restart Camel and the HawtDB file that was created from the previous run still exists, Camel fails to properly start and you get:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2010-11-30 14:16:15.579433500 [main] INFO  org.apache.camel.impl.MainSupport - Apache Camel 2.5.0 starting
2010-11-30 14:16:15.604250500 [main] INFO  org.springframework.context.support.FileSystemXmlApplicationContext - Refreshing org.springframework.context.support.FileSystemXmlApplicationContext@4d125127: startup date [Tue Nov 30 14:16:15 PST 2010]; root of context hierarchy
2010-11-30 14:16:15.646720500 [main] INFO  org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from URL [file:/opt/camel/etc/camel.xml]
2010-11-30 14:16:15.913909500 [main] INFO  org.apache.camel.spring.handler.CamelNamespaceHandler - OSGi environment not detected.
2010-11-30 14:16:16.374117500 [main] INFO  org.springframework.beans.factory.xml.XmlBeanDefinitionReader - Loading XML bean definitions from file [/opt/camel/deploy/ens/ens.xml]
2010-11-30 14:16:16.438684500 [main] INFO  org.springframework.beans.factory.support.DefaultListableBeanFactory - Pre-instantiating singletons in org.springframework.beans.factory.support.DefaultListableBeanFactory@2682d210: defining beans [activemqPrefetchPolicy,jmsConnectionFactory,jmsTransactionManager,activemq,template,consumerTemplate,camel:beanPostProcessor,camel,ensRouteBuilder]; root of factory hierarchy
2010-11-30 14:16:16.866101500 [main] INFO  org.apache.camel.impl.converter.AnnotationTypeConverterLoader - Found 5 packages with 17 @Converter classes to load
2010-11-30 14:16:16.904649500 [main] INFO  org.apache.camel.impl.converter.DefaultTypeConverter - Loaded 158 type converters in 0.302 seconds
2010-11-30 14:16:17.016405500 [main] INFO  org.apache.camel.impl.DefaultCamelContext - Apache Camel 2.5.0 (CamelContext: camel) is starting
2010-11-30 14:16:17.016490500 [main] INFO  org.apache.camel.impl.DefaultCamelContext - JMX enabled. Using ManagedManagementStrategy.
2010-11-30 14:16:17.772785500 [main] INFO  org.apache.camel.component.hawtdb.HawtDBFile - Aggregation repository data store loaded using file: /opt/activemq/data/camel/ens/hawtdb.dat containing 2 repositories.
2010-11-30 14:16:17.804277500 [main] WARN  org.apache.camel.component.hawtdb.HawtDBFile - Error executing work Size[kountAg] will do rollback.
2010-11-30 14:16:17.804278500 org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 195
2010-11-30 14:16:17.804279500 	at org.fusesource.hawtdb.internal.page.Extent.readHeader(Extent.java:85)
2010-11-30 14:16:17.804279500 	at org.fusesource.hawtdb.internal.page.Extent.readOpen(Extent.java:94)
2010-11-30 14:16:17.804280500 	at org.fusesource.hawtdb.internal.page.ExtentInputStream.read(ExtentInputStream.java:92)
2010-11-30 14:16:17.804288500 	at java.io.DataInputStream.readFully(DataInputStream.java:178)
2010-11-30 14:16:17.804288500 	at java.io.DataInputStream.readFully(DataInputStream.java:152)
2010-11-30 14:16:17.804288500 	at org.fusesource.hawtbuf.codec.AbstractBufferCodec.decode(AbstractBufferCodec.java:40)
2010-11-30 14:16:17.804289500 	at org.fusesource.hawtbuf.codec.AbstractBufferCodec.decode(AbstractBufferCodec.java:30)
2010-11-30 14:16:17.804291500 	at org.fusesource.hawtdb.internal.index.BTreeNode.read(BTreeNode.java:207)
2010-11-30 14:16:17.804291500 	at org.fusesource.hawtdb.internal.index.BTreeNode$DataPagedAccessor.decode(BTreeNode.java:228)
2010-11-30 14:16:17.804292500 	at org.fusesource.hawtdb.internal.index.BTreeNode$DataPagedAccessor.decode(BTreeNode.java:214)
2010-11-30 14:16:17.804306500 	at org.fusesource.hawtdb.api.AbstractStreamPagedAccessor.load(AbstractStreamPagedAccessor.java:64)
2010-11-30 14:16:17.804306500 	at org.fusesource.hawtdb.internal.page.HawtTxPageFile$ReadCache.cacheLoad(HawtTxPageFile.java:907)
2010-11-30 14:16:17.804307500 	at org.fusesource.hawtdb.internal.page.HawtTransaction.get(HawtTransaction.java:151)
2010-11-30 14:16:17.804307500 	at org.fusesource.hawtdb.internal.index.BTreeIndex.loadNode(BTreeIndex.java:231)
2010-11-30 14:16:17.804309500 	at org.fusesource.hawtdb.internal.index.BTreeIndex.root(BTreeIndex.java:158)
2010-11-30 14:16:17.804309500 	at org.fusesource.hawtdb.internal.index.BTreeIndex.size(BTreeIndex.java:101)
2010-11-30 14:16:17.804310500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository$8.execute(HawtDBAggregationRepository.java:360)
2010-11-30 14:16:17.804310500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository$8.execute(HawtDBAggregationRepository.java:357)
2010-11-30 14:16:17.804312500 	at org.apache.camel.component.hawtdb.HawtDBFile.doExecute(HawtDBFile.java:159)
2010-11-30 14:16:17.804312500 	at org.apache.camel.component.hawtdb.HawtDBFile.execute(HawtDBFile.java:106)
2010-11-30 14:16:17.804313500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository.size(HawtDBAggregationRepository.java:357)
2010-11-30 14:16:17.804315500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository.doStart(HawtDBAggregationRepository.java:492)
2010-11-30 14:16:17.804315500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804316500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804316500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804318500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.804318500 	at org.apache.camel.processor.aggregate.AggregateProcessor.doStart(AggregateProcessor.java:776)
2010-11-30 14:16:17.804319500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804319500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804321500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804321500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.804322500 	at org.apache.camel.processor.DelegateProcessor.doStart(DelegateProcessor.java:76)
2010-11-30 14:16:17.804322500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804322500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804325500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804325500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.804326500 	at org.apache.camel.processor.DelegateAsyncProcessor.doStart(DelegateAsyncProcessor.java:77)
2010-11-30 14:16:17.804326500 	at org.apache.camel.processor.interceptor.TraceInterceptor.doStart(TraceInterceptor.java:423)
2010-11-30 14:16:17.804328500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804328500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804328500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804329500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.804330500 	at org.apache.camel.processor.RedeliveryErrorHandler.doStart(RedeliveryErrorHandler.java:841)
2010-11-30 14:16:17.804331500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804331500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804332500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804337500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.804339500 	at org.apache.camel.processor.DefaultChannel.doStart(DefaultChannel.java:143)
2010-11-30 14:16:17.804340500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804340500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804340500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:77)
2010-11-30 14:16:17.804341500 	at org.apache.camel.processor.MulticastProcessor.doStart(MulticastProcessor.java:644)
2010-11-30 14:16:17.804342500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804343500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804343500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804344500 	at org.apache.camel.processor.WrapProcessor.doStart(WrapProcessor.java:42)
2010-11-30 14:16:17.804344500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804345500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804346500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804346500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.804347500 	at org.apache.camel.processor.DelegateAsyncProcessor.doStart(DelegateAsyncProcessor.java:77)
2010-11-30 14:16:17.804349500 	at org.apache.camel.processor.interceptor.TraceInterceptor.doStart(TraceInterceptor.java:423)
2010-11-30 14:16:17.804349500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804350500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804350500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804352500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.804352500 	at org.apache.camel.processor.RedeliveryErrorHandler.doStart(RedeliveryErrorHandler.java:841)
2010-11-30 14:16:17.804353500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804353500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804354500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804355500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.804355500 	at org.apache.camel.processor.DefaultChannel.doStart(DefaultChannel.java:143)
2010-11-30 14:16:17.804356500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804356500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804358500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804359500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.804359500 	at org.apache.camel.processor.DelegateAsyncProcessor.doStart(DelegateAsyncProcessor.java:77)
2010-11-30 14:16:17.804359500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804361500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804361500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804362500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.804362500 	at org.apache.camel.processor.DelegateAsyncProcessor.doStart(DelegateAsyncProcessor.java:77)
2010-11-30 14:16:17.804364500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804364500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804365500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.804365500 	at org.apache.camel.impl.RouteService.startChildService(RouteService.java:233)
2010-11-30 14:16:17.804370500 	at org.apache.camel.impl.RouteService.warmUp(RouteService.java:136)
2010-11-30 14:16:17.804373500 	at org.apache.camel.impl.DefaultCamelContext.doWarmUpRoutes(DefaultCamelContext.java:1694)
2010-11-30 14:16:17.804373500 	at org.apache.camel.impl.DefaultCamelContext.safelyStartRouteServices(DefaultCamelContext.java:1620)
2010-11-30 14:16:17.804374500 	at org.apache.camel.impl.DefaultCamelContext.doStartOrResumeRoutes(DefaultCamelContext.java:1419)
2010-11-30 14:16:17.804374500 	at org.apache.camel.impl.DefaultCamelContext.doStartCamel(DefaultCamelContext.java:1314)
2010-11-30 14:16:17.804376500 	at org.apache.camel.impl.DefaultCamelContext.doStart(DefaultCamelContext.java:1213)
2010-11-30 14:16:17.804376500 	at org.apache.camel.spring.SpringCamelContext.doStart(SpringCamelContext.java:164)
2010-11-30 14:16:17.804377500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.804377500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.804378500 	at org.apache.camel.impl.DefaultCamelContext.start(DefaultCamelContext.java:1191)
2010-11-30 14:16:17.804379500 	at org.apache.camel.spring.SpringCamelContext.maybeStart(SpringCamelContext.java:203)
2010-11-30 14:16:17.804379500 	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:101)
2010-11-30 14:16:17.804380500 	at org.apache.camel.spring.CamelContextFactoryBean.onApplicationEvent(CamelContextFactoryBean.java:237)
2010-11-30 14:16:17.805978500 	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:97)
2010-11-30 14:16:17.805979500 	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:303)
2010-11-30 14:16:17.805979500 	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:911)
2010-11-30 14:16:17.805986500 	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:428)
2010-11-30 14:16:17.805986500 	at org.springframework.context.support.FileSystemXmlApplicationContext.&amp;lt;init&amp;gt;(FileSystemXmlApplicationContext.java:140)
2010-11-30 14:16:17.805987500 	at org.springframework.context.support.FileSystemXmlApplicationContext.&amp;lt;init&amp;gt;(FileSystemXmlApplicationContext.java:94)
2010-11-30 14:16:17.805989500 	at org.apache.camel.spring.Main.createDefaultApplicationContext(Main.java:209)
2010-11-30 14:16:17.805989500 	at org.apache.camel.spring.Main.doStart(Main.java:173)
2010-11-30 14:16:17.805990500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.805990500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.805993500 	at org.apache.camel.impl.MainSupport.run(MainSupport.java:114)
2010-11-30 14:16:17.805993500 	at org.apache.camel.impl.MainSupport.run(MainSupport.java:291)
2010-11-30 14:16:17.805994500 	at org.apache.camel.spring.Main.main(Main.java:97)
2010-11-30 14:16:17.807821500 [main] INFO  org.apache.camel.impl.DefaultCamelContext - Apache Camel 2.5.0 (CamelContext:camel) is shutting down
2010-11-30 14:16:17.808227500 [main] INFO  org.apache.camel.impl.DefaultShutdownStrategy - Starting to graceful shutdown 0 routes (timeout 300 seconds)
2010-11-30 14:16:17.809961500 [main] INFO  org.apache.camel.impl.DefaultShutdownStrategy - Graceful shutdown of 0 routes completed in 0 seconds
2010-11-30 14:16:17.814781500 [main] INFO  org.apache.camel.impl.DefaultInflightRepository - Shutting down with no inflight exchanges.
2010-11-30 14:16:17.815443500 [main] INFO  org.apache.camel.impl.DefaultCamelContext - Uptime: 0.799 seconds
2010-11-30 14:16:17.815545500 [main] INFO  org.apache.camel.impl.DefaultCamelContext - Apache Camel 2.5.0 (CamelContext: camel) is shutdown in 0.008 seconds
2010-11-30 14:16:17.815665500 [main] INFO  org.apache.camel.impl.MainSupport - Apache Camel 2.5.0 stopping
2010-11-30 14:16:17.815764500 Exception in thread &quot;main&quot; org.apache.camel.RuntimeCamelException: org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 195
2010-11-30 14:16:17.815892500 	at org.apache.camel.util.ObjectHelper.wrapRuntimeCamelException(ObjectHelper.java:1140)
2010-11-30 14:16:17.815928500 	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:103)
2010-11-30 14:16:17.815962500 	at org.apache.camel.spring.CamelContextFactoryBean.onApplicationEvent(CamelContextFactoryBean.java:237)
2010-11-30 14:16:17.815995500 	at org.springframework.context.event.SimpleApplicationEventMulticaster.multicastEvent(SimpleApplicationEventMulticaster.java:97)
2010-11-30 14:16:17.816031500 	at org.springframework.context.support.AbstractApplicationContext.publishEvent(AbstractApplicationContext.java:303)
2010-11-30 14:16:17.816067500 	at org.springframework.context.support.AbstractApplicationContext.finishRefresh(AbstractApplicationContext.java:911)
2010-11-30 14:16:17.816102500 	at org.springframework.context.support.AbstractApplicationContext.refresh(AbstractApplicationContext.java:428)
2010-11-30 14:16:17.816137500 	at org.springframework.context.support.FileSystemXmlApplicationContext.&amp;lt;init&amp;gt;(FileSystemXmlApplicationContext.java:140)
2010-11-30 14:16:17.816171500 	at org.springframework.context.support.FileSystemXmlApplicationContext.&amp;lt;init&amp;gt;(FileSystemXmlApplicationContext.java:94)
2010-11-30 14:16:17.816205500 	at org.apache.camel.spring.Main.createDefaultApplicationContext(Main.java:209)
2010-11-30 14:16:17.816237500 	at org.apache.camel.spring.Main.doStart(Main.java:173)
2010-11-30 14:16:17.816269500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.816301500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.816333500 	at org.apache.camel.impl.MainSupport.run(MainSupport.java:114)
2010-11-30 14:16:17.816364500 	at org.apache.camel.impl.MainSupport.run(MainSupport.java:291)
2010-11-30 14:16:17.816396500 	at org.apache.camel.spring.Main.main(Main.java:97)
2010-11-30 14:16:17.816446500 Caused by: org.fusesource.hawtdb.api.IOPagingException: Invalid extent read request.  The requested page was not an extent: 195
2010-11-30 14:16:17.816481500 	at org.fusesource.hawtdb.internal.page.Extent.readHeader(Extent.java:85)
2010-11-30 14:16:17.816514500 	at org.fusesource.hawtdb.internal.page.Extent.readOpen(Extent.java:94)
2010-11-30 14:16:17.816547500 	at org.fusesource.hawtdb.internal.page.ExtentInputStream.read(ExtentInputStream.java:92)
2010-11-30 14:16:17.816579500 	at java.io.DataInputStream.readFully(DataInputStream.java:178)
2010-11-30 14:16:17.816611500 	at java.io.DataInputStream.readFully(DataInputStream.java:152)
2010-11-30 14:16:17.816644500 	at org.fusesource.hawtbuf.codec.AbstractBufferCodec.decode(AbstractBufferCodec.java:40)
2010-11-30 14:16:17.816678500 	at org.fusesource.hawtbuf.codec.AbstractBufferCodec.decode(AbstractBufferCodec.java:30)
2010-11-30 14:16:17.816714500 	at org.fusesource.hawtdb.internal.index.BTreeNode.read(BTreeNode.java:207)
2010-11-30 14:16:17.816749500 	at org.fusesource.hawtdb.internal.index.BTreeNode$DataPagedAccessor.decode(BTreeNode.java:228)
2010-11-30 14:16:17.816783500 	at org.fusesource.hawtdb.internal.index.BTreeNode$DataPagedAccessor.decode(BTreeNode.java:214)
2010-11-30 14:16:17.816818500 	at org.fusesource.hawtdb.api.AbstractStreamPagedAccessor.load(AbstractStreamPagedAccessor.java:64)
2010-11-30 14:16:17.816852500 	at org.fusesource.hawtdb.internal.page.HawtTxPageFile$ReadCache.cacheLoad(HawtTxPageFile.java:907)
2010-11-30 14:16:17.816885500 	at org.fusesource.hawtdb.internal.page.HawtTransaction.get(HawtTransaction.java:151)
2010-11-30 14:16:17.816918500 	at org.fusesource.hawtdb.internal.index.BTreeIndex.loadNode(BTreeIndex.java:231)
2010-11-30 14:16:17.816950500 	at org.fusesource.hawtdb.internal.index.BTreeIndex.root(BTreeIndex.java:158)
2010-11-30 14:16:17.816982500 	at org.fusesource.hawtdb.internal.index.BTreeIndex.size(BTreeIndex.java:101)
2010-11-30 14:16:17.817018500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository$8.execute(HawtDBAggregationRepository.java:360)
2010-11-30 14:16:17.817085500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository$8.execute(HawtDBAggregationRepository.java:357)
2010-11-30 14:16:17.817122500 	at org.apache.camel.component.hawtdb.HawtDBFile.doExecute(HawtDBFile.java:159)
2010-11-30 14:16:17.817153500 	at org.apache.camel.component.hawtdb.HawtDBFile.execute(HawtDBFile.java:106)
2010-11-30 14:16:17.817183500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository.size(HawtDBAggregationRepository.java:357)
2010-11-30 14:16:17.817212500 	at org.apache.camel.component.hawtdb.HawtDBAggregationRepository.doStart(HawtDBAggregationRepository.java:492)
2010-11-30 14:16:17.817241500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.817271500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.817299500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.817327500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.817355500 	at org.apache.camel.processor.aggregate.AggregateProcessor.doStart(AggregateProcessor.java:776)
2010-11-30 14:16:17.817382500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.817410500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.817437500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.817464500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.817492500 	at org.apache.camel.processor.DelegateProcessor.doStart(DelegateProcessor.java:76)
2010-11-30 14:16:17.817519500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.817546500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.817573500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.817601500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.817629500 	at org.apache.camel.processor.DelegateAsyncProcessor.doStart(DelegateAsyncProcessor.java:77)
2010-11-30 14:16:17.817657500 	at org.apache.camel.processor.interceptor.TraceInterceptor.doStart(TraceInterceptor.java:423)
2010-11-30 14:16:17.817684500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.817711500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.817739500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.817766500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.817793500 	at org.apache.camel.processor.RedeliveryErrorHandler.doStart(RedeliveryErrorHandler.java:841)
2010-11-30 14:16:17.817821500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.817848500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.817875500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.817903500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.817930500 	at org.apache.camel.processor.DefaultChannel.doStart(DefaultChannel.java:143)
2010-11-30 14:16:17.817957500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.817985500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.818012500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:77)
2010-11-30 14:16:17.818040500 	at org.apache.camel.processor.MulticastProcessor.doStart(MulticastProcessor.java:644)
2010-11-30 14:16:17.818067500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.818094500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.818121500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.818156500 	at org.apache.camel.processor.WrapProcessor.doStart(WrapProcessor.java:42)
2010-11-30 14:16:17.818184500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.818211500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.818239500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.818267500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.818294500 	at org.apache.camel.processor.DelegateAsyncProcessor.doStart(DelegateAsyncProcessor.java:77)
2010-11-30 14:16:17.818322500 	at org.apache.camel.processor.interceptor.TraceInterceptor.doStart(TraceInterceptor.java:423)
2010-11-30 14:16:17.818349500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.818377500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.818404500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.818431500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.818459500 	at org.apache.camel.processor.RedeliveryErrorHandler.doStart(RedeliveryErrorHandler.java:841)
2010-11-30 14:16:17.818486500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.818513500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.818540500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.818567500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.818595500 	at org.apache.camel.processor.DefaultChannel.doStart(DefaultChannel.java:143)
2010-11-30 14:16:17.818622500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.818649500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.818676500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.818704500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.818731500 	at org.apache.camel.processor.DelegateAsyncProcessor.doStart(DelegateAsyncProcessor.java:77)
2010-11-30 14:16:17.818759500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.818786500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.818814500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.818841500 	at org.apache.camel.util.ServiceHelper.startServices(ServiceHelper.java:63)
2010-11-30 14:16:17.818869500 	at org.apache.camel.processor.DelegateAsyncProcessor.doStart(DelegateAsyncProcessor.java:77)
2010-11-30 14:16:17.818896500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.818923500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.818950500 	at org.apache.camel.util.ServiceHelper.startService(ServiceHelper.java:52)
2010-11-30 14:16:17.818978500 	at org.apache.camel.impl.RouteService.startChildService(RouteService.java:233)
2010-11-30 14:16:17.819005500 	at org.apache.camel.impl.RouteService.warmUp(RouteService.java:136)
2010-11-30 14:16:17.819033500 	at org.apache.camel.impl.DefaultCamelContext.doWarmUpRoutes(DefaultCamelContext.java:1694)
2010-11-30 14:16:17.819061500 	at org.apache.camel.impl.DefaultCamelContext.safelyStartRouteServices(DefaultCamelContext.java:1620)
2010-11-30 14:16:17.819096500 	at org.apache.camel.impl.DefaultCamelContext.doStartOrResumeRoutes(DefaultCamelContext.java:1419)
2010-11-30 14:16:17.819124500 	at org.apache.camel.impl.DefaultCamelContext.doStartCamel(DefaultCamelContext.java:1314)
2010-11-30 14:16:17.819152500 	at org.apache.camel.impl.DefaultCamelContext.doStart(DefaultCamelContext.java:1213)
2010-11-30 14:16:17.819179500 	at org.apache.camel.spring.SpringCamelContext.doStart(SpringCamelContext.java:164)
2010-11-30 14:16:17.819207500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:65)
2010-11-30 14:16:17.819247500 	at org.apache.camel.impl.ServiceSupport.start(ServiceSupport.java:52)
2010-11-30 14:16:17.819277500 	at org.apache.camel.impl.DefaultCamelContext.start(DefaultCamelContext.java:1191)
2010-11-30 14:16:17.819304500 	at org.apache.camel.spring.SpringCamelContext.maybeStart(SpringCamelContext.java:203)
2010-11-30 14:16:17.819332500 	at org.apache.camel.spring.SpringCamelContext.onApplicationEvent(SpringCamelContext.java:101)
2010-11-30 14:16:17.819364500 	... 14 more
2010-11-30 14:16:17.819904500 [Thread-1] INFO  org.apache.camel.spring.Main$HangupInterceptor - Received hang up - stopping the main instance.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The page number (in this case 34) varies from run to run.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12487434">CAMEL-3317</key>
            <summary>HawtDB throws IOPagingException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="gim">Glenn Moss</reporter>
                        <labels>
                    </labels>
                <created>Fri, 5 Nov 2010 18:25:28 +0000</created>
                <updated>Tue, 25 Oct 2011 11:35:35 +0000</updated>
                            <resolved>Fri, 25 Feb 2011 06:58:59 +0000</resolved>
                                    <version>2.5.0</version>
                                    <fixVersion>2.7.0</fixVersion>
                                    <component>camel-hawtdb</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12957407" author="davsclaus" created="Sat, 6 Nov 2010 08:28:44 +0000"  >&lt;p&gt;Can you try with Camel 2.5.0 which has been released.&lt;br/&gt;
And make sure you use the latest release of HawtDB (It should be 1.5.0 afair)&lt;/p&gt;

&lt;p&gt;And what do you mean by &quot;still running&quot;?&lt;/p&gt;

&lt;p&gt;And how do you start/stop your application?&lt;/p&gt;</comment>
                            <comment id="12957442" author="gim" created="Mon, 8 Nov 2010 17:24:44 +0000"  >&lt;p&gt;We were using HawtDB 1.5, but were still using the 2.5-SNAPSHOT. I will try again with the official 2.5 release code.&lt;/p&gt;

&lt;p&gt;What I meant was that if the HawtDB repository file does not exist on startup, it is created, and Camel starts &quot;successfully&quot; (but we still see these errors.) When Camel is stopped and then started again, (the same HawtDB repository file exists that was created from the first run) it does not successfully start, as I showed in the above log. After producing an error, Camel terminates itself.&lt;/p&gt;

&lt;p&gt;We run Camel by invoking the org.apache.camel.spring.Main class, passing it a Spring bean file with the -fa argument.&lt;/p&gt;</comment>
                            <comment id="12957480" author="davsclaus" created="Thu, 11 Nov 2010 12:01:31 +0000"  >&lt;p&gt;Do you have a lot of data in the repo?&lt;/p&gt;

&lt;p&gt;Do you see this issue immediately? Or do you have to pump in a lot of data to see it?&lt;/p&gt;

&lt;p&gt;And what OS and JDK are you using?&lt;/p&gt;
</comment>
                            <comment id="12965465" author="gim" created="Tue, 30 Nov 2010 22:35:42 +0000"  >&lt;p&gt;I have tested this again with the official 2.5.0 code, and I see almost the same behavior. The error messages are slightly different, so I will update the issue description with the latest output I&apos;ve seen.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Do you have a lot of data in the repo?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Initially, the repository file does not exists, so it is empty. After seeing these kinds of errors, if Camel is shut down, then started again, it will fail to successfully start, unless the repository file is removed again.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Do you see this issue immediately? Or do you have to pump in a lot of data to see it?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We&apos;re putting somewhere on the order of 3 messages per second in to the ActiveMQ queue, and we see the errors show up in about 8 seconds.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;And what OS and JDK are you using?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Ubuntu 8.04&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ /usr/bin/java -version
java version &quot;1.6.0_22&quot;
Java(TM) SE Runtime Environment (build 1.6.0_22-b04)
Java HotSpot(TM) 64-Bit Server VM (build 17.1-b03, mixed mode)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12965471" author="gim" created="Tue, 30 Nov 2010 22:56:12 +0000"  >&lt;p&gt;Please note that in addition to updating the log output, I also provided some addition explanation of my problem.&lt;/p&gt;</comment>
                            <comment id="12968712" author="davsclaus" created="Tue, 7 Dec 2010 13:00:03 +0000"  >&lt;p&gt;Can you post the Camel route you use?&lt;/p&gt;</comment>
                            <comment id="12968847" author="gim" created="Tue, 7 Dec 2010 17:54:02 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;from(&lt;span class=&quot;code-quote&quot;&gt;&quot;activemq:events&quot;&lt;/span&gt;)
  .transacted()
  .log(&lt;span class=&quot;code-quote&quot;&gt;&quot;Aggregating event ${header.ens-event-id} &quot;&lt;/span&gt; +
      &lt;span class=&quot;code-quote&quot;&gt;&quot;on callback ${header.ens-callback-id}&quot;&lt;/span&gt;)
  .aggregate(header(&lt;span class=&quot;code-quote&quot;&gt;&quot;ens-callback-id&quot;&lt;/span&gt;), &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; EnsAggregationStrategy())
  .aggregationRepository(
      &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HawtDBAggregationRepository(
        &lt;span class=&quot;code-quote&quot;&gt;&quot;events&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.persistenceFile))
  .completionSize(header(&lt;span class=&quot;code-quote&quot;&gt;&quot;ens-batch-size&quot;&lt;/span&gt;))
  .completionInterval(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.completionInterval)
  .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;activemq:eventOutbox&quot;&lt;/span&gt;)
  .log(&lt;span class=&quot;code-quote&quot;&gt;&quot;Aggregated events ${header.ens-event-ids} &quot;&lt;/span&gt; +
      &lt;span class=&quot;code-quote&quot;&gt;&quot;on callback ${header.ens-callback-id}&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12969283" author="davsclaus" created="Wed, 8 Dec 2010 11:40:51 +0000"  >&lt;p&gt;I have added an unit test to Camel source code which is based on your route.&lt;/p&gt;

&lt;p&gt;I cannot reproduce the issue.&lt;br/&gt;
Can you try this test on your system and maybe try to adjust it? For example try to use the same kind of payloads you use?&lt;/p&gt;

&lt;p&gt;commit log&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?rev=1043354&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1043354&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It most likely need a 2nd test case where it uses more groups so the db store contains multiple inprogress exchanges.&lt;br/&gt;
When you see the problem? Has any aggregated messages been completed yet?&lt;/p&gt;

&lt;p&gt;And what parameters do you use the completion interval? And whats the typical completion size?&lt;/p&gt;

&lt;p&gt;And what logic do you have in your aggregation strategy? It could potential affect because it dictates what is to be stored as data.&lt;/p&gt;</comment>
                            <comment id="12969297" author="davsclaus" created="Wed, 8 Dec 2010 13:25:53 +0000"  >&lt;p&gt;btw if you run long lasting tests then consider removing the mocks because they store the received exchanges in memory, so you will eat up memory over time.&lt;/p&gt;</comment>
                            <comment id="12976226" author="davsclaus" created="Fri, 31 Dec 2010 11:22:36 +0000"  >&lt;p&gt;Glenn any update on this?&lt;/p&gt;

&lt;p&gt;Can you post the source code for your &lt;tt&gt;EnsAggregationStrategy&lt;/tt&gt; ?&lt;/p&gt;</comment>
                            <comment id="12977317" author="gim" created="Tue, 4 Jan 2011 15:43:34 +0000"  >&lt;p&gt;I haven&apos;t had a chance to run the unit test you wrote, or come up with one that reproduces the problem. I will do this as soon as I can.&lt;/p&gt;

&lt;p&gt;Here&apos;s the source for EnsAggregationStrategy:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; com.kount.ens.camel;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.io.StringReader;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.io.StringWriter;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.parsers.DocumentBuilder;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.parsers.DocumentBuilderFactory;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.parsers.ParserConfigurationException;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.transform.dom.DOMSource;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.transform.OutputKeys;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.transform.stream.StreamResult;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.transform.Transformer;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.transform.TransformerConfigurationException;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.transform.TransformerException;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; javax.xml.transform.TransformerFactory;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.Exchange;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.Message;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.processor.aggregate.AggregationStrategy;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.log4j.Logger;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.w3c.dom.Document;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.w3c.dom.Element;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.w3c.dom.Node;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.xml.sax.InputSource;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.xml.sax.SAXException;

/**
 * ENS Aggregation Strategy.
 *
 * @author Glenn Moss &amp;lt;gim@keynetics.com&amp;gt;
 * @version SVN: $Id$
 * @copyright 2010 Keynetics Inc.
 */
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;EnsAggregationStrategy &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; AggregationStrategy {

  /**
   * Logger.
   */
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Logger log;

  /**
   * Document builder.
   */
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; DocumentBuilder db;

  /**
   * Transformer.
   */
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Transformer trans;

  /**
   * Constructor.
   */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; EnsAggregationStrategy () {
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.log = Logger.getLogger(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.getClass());

    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.db = DocumentBuilderFactory.newInstance().newDocumentBuilder();
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (ParserConfigurationException e) {
      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; EnsConfigurationException(
          &lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to instantiate a DocumentBuilder&quot;&lt;/span&gt;, e);
    }
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.trans = TransformerFactory.newInstance().newTransformer();
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.trans.setOutputProperty(OutputKeys.INDENT, &lt;span class=&quot;code-quote&quot;&gt;&quot;yes&quot;&lt;/span&gt;);
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (TransformerConfigurationException e) {
      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; EnsConfigurationException(
          &lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to instantiate a Transformer&quot;&lt;/span&gt;, e);
    }
  }

  /**
   * Aggregates an old and &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; exchange together to create a single combined
   * exchange.
   *
   * @param oldExchange the oldest exchange (is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; on first aggregation as we
   * only have the &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; exchange)
   * @param newExchange the newest exchange (can be &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; there was no data
   * possible to acquire)
   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; a combined composite of the two exchanges
   */
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Exchange aggregate (Exchange oldExchange, Exchange newExchange) {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; ids = &quot;&quot;;
    Document oldDoc;
    Element root;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; == oldExchange) {
      &lt;span class=&quot;code-comment&quot;&gt;// No old message, so create a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; XML DOM
&lt;/span&gt;      oldDoc = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.db.newDocument();
      root = oldDoc.createElement(&lt;span class=&quot;code-quote&quot;&gt;&quot;events&quot;&lt;/span&gt;);
      root.setAttribute(&lt;span class=&quot;code-quote&quot;&gt;&quot;total&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;);
      oldDoc.appendChild(root);

      oldExchange = newExchange;
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
      &lt;span class=&quot;code-comment&quot;&gt;// Turn the old message into an XML DOM
&lt;/span&gt;      &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; oldBody = oldExchange.getIn().getBody(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.class);
      oldDoc = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.parseDocument(oldBody);
      root = (Element) oldDoc.getFirstChild();

      &lt;span class=&quot;code-comment&quot;&gt;// Get the Event IDs represented in the old message
&lt;/span&gt;      ids = (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) oldExchange.getIn().getHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;ens-event-ids&quot;&lt;/span&gt;);
    }

    Message newMessage = newExchange.getIn();
    Message oldMessage = oldExchange.getIn();

    &lt;span class=&quot;code-comment&quot;&gt;// Add the incoming Event&apos;s ID to the list of aggregated IDs
&lt;/span&gt;    ids += newMessage.getHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;ens-event-id&quot;&lt;/span&gt;) + &lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;;
    oldMessage.removeHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;ens-event-id&quot;&lt;/span&gt;);

    oldMessage.setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;ens-event-ids&quot;&lt;/span&gt;, ids);

    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; newBody = newMessage.getBody(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.class);
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      &lt;span class=&quot;code-comment&quot;&gt;// Get the Event XML from the &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; message and append it to the aggregated
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// XML, incrementing the &lt;span class=&quot;code-quote&quot;&gt;&quot;total&quot;&lt;/span&gt; attribute
&lt;/span&gt;      Document newDoc = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.parseDocument(newBody);
      Node newEvent = newDoc.getFirstChild();

      Node impEvent = oldDoc.importNode(newEvent, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
      root.appendChild(impEvent);

      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; oldTotal = &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.parseInt(root.getAttribute(&lt;span class=&quot;code-quote&quot;&gt;&quot;total&quot;&lt;/span&gt;));
      root.setAttribute(&lt;span class=&quot;code-quote&quot;&gt;&quot;total&quot;&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.toString(oldTotal + 1));

      &lt;span class=&quot;code-comment&quot;&gt;// Output the resulting aggregated XML text as the body of the
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// aggregated message
&lt;/span&gt;      StreamResult result = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamResult(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringWriter());
      &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.trans.transform(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DOMSource(oldDoc), result);
      oldMessage.setBody(result.getWriter().toString());
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (TransformerException e) {
      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; EnsAggregationException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to transform DOM to XML text&quot;&lt;/span&gt;,
          e);
    }

    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.log.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Aggregated events &quot;&lt;/span&gt; + ids);

    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; oldExchange;
  }

  /**
   * Parse XML text.
   *
   * @param input XML text
   * @&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Parsed Document
   */
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Document parseDocument (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; input) {
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.db.parse(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InputSource(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringReader(input)));
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (SAXException e) {
      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; EnsAggregationException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to parse XML text&quot;&lt;/span&gt;, e);
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException e) {
      &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; EnsAggregationException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to read XML text&quot;&lt;/span&gt;, e);
    }
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12981704" author="davsclaus" created="Fri, 14 Jan 2011 10:20:29 +0000"  >&lt;p&gt;We spotted a bug in the aggregator under certain conditions may omit confirm exchanges. See &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-3535&quot; title=&quot;Aggregation fails to call onComplete for exchanges if the aggregation is after a bean or process.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-3535&quot;&gt;&lt;del&gt;CAMEL-3535&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;When the fix is committed you should rebuild from source and test with that.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12495418">CAMEL-3535</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76287</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 45 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01tzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8629</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>