<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:30:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-12741] SjmsMessage should set Exchange in copyFrom</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-12741</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When a copy of the &lt;tt&gt;SjmsMessage&lt;/tt&gt; is created using &lt;tt&gt;copyFrom(Message)&lt;/tt&gt; the resulting message copy doesn&apos;t have the &lt;tt&gt;Exchange&lt;/tt&gt; set. This prevents the use of &lt;tt&gt;TypeConverter&lt;/tt&gt; when &lt;tt&gt;Message:getBody(Class)&lt;/tt&gt; is invoked.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13179920">CAMEL-12741</key>
            <summary>SjmsMessage should set Exchange in copyFrom</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="zregvart">Zoran Regvart</assignee>
                                    <reporter username="zregvart">Zoran Regvart</reporter>
                        <labels>
                    </labels>
                <created>Mon, 20 Aug 2018 09:46:34 +0000</created>
                <updated>Wed, 22 Aug 2018 21:57:24 +0000</updated>
                            <resolved>Wed, 22 Aug 2018 10:25:43 +0000</resolved>
                                                    <fixVersion>2.23.0</fixVersion>
                                    <component>camel-sjms</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16585718" author="zregvart" created="Mon, 20 Aug 2018 09:51:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; I need some help here, it&apos;s easy to set the &lt;tt&gt;Exchange&lt;/tt&gt; in &lt;tt&gt;SjmsMessage::copyFrom(Message)&lt;/tt&gt;, I&apos;m not sure if this is the right thing to do. Perhaps we should support type conversion in &lt;tt&gt;Message:getBody(Class, Object)&lt;/tt&gt; if no &lt;tt&gt;Exchange&lt;/tt&gt; is set on the message and &lt;tt&gt;CamelContext&lt;/tt&gt; is set i.e. perform type conversion without exchange.&lt;/p&gt;</comment>
                            <comment id="16585736" author="githubbot" created="Mon, 20 Aug 2018 09:59:26 +0000"  >&lt;p&gt;zregvart opened a new pull request #2483: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;: type conversion with SjmsMessage&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2483&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2483&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   If we don&apos;t copy Exchange in `SjmsMessage::copyFrom` then type conversion doesn&apos;t work.&lt;/p&gt;

&lt;p&gt;   I&apos;m not sure what approach to take for resolving &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CAMEL-12741&lt;/a&gt;). &lt;/p&gt;

&lt;p&gt;   I&apos;ve created two commits with two options that could help here, not sure what option (or both?) should we implement.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16585737" author="githubbot" created="Mon, 20 Aug 2018 09:59:27 +0000"  >&lt;p&gt;GitHub user zregvart opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2483&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2483&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;: type conversion with SjmsMessage&lt;/p&gt;

&lt;p&gt;    If we don&apos;t copy Exchange in `SjmsMessage::copyFrom` then type conversion doesn&apos;t work.&lt;/p&gt;

&lt;p&gt;    I&apos;m not sure what approach to take for resolving &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CAMEL-12741&lt;/a&gt;). &lt;/p&gt;

&lt;p&gt;    I&apos;ve created two commits with two options that could help here, not sure what option (or both?) should we implement.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/zregvart/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/zregvart/camel&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2483.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2483.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2483&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 8731e90d2ac680a40b90bb21406b688e95c8e5bd&lt;br/&gt;
Author: Zoran Regvart &amp;lt;zregvart@...&amp;gt;&lt;br/&gt;
Date:   2018-08-20T09:55:18Z&lt;/p&gt;

&lt;p&gt;    Option A: set the Exchange of the original message&lt;/p&gt;

&lt;p&gt;commit 6ac7c7b3cc4020f17a939d79d86b57d8abcde189&lt;br/&gt;
Author: Zoran Regvart &amp;lt;zregvart@...&amp;gt;&lt;br/&gt;
Date:   2018-08-20T09:55:39Z&lt;/p&gt;

&lt;p&gt;    Option B: support type conversion without Exchange&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16585799" author="davsclaus" created="Mon, 20 Aug 2018 11:16:47 +0000"  >&lt;p&gt;Do you have an use-case where this happens?&lt;/p&gt;

&lt;p&gt;Usually the exchange is set in the configureMessage method in DefaultExchange, so just wonder when you have this situation. We have a few other components that has special message like camel-jms, camel-mail (AFAIR) and a few others, and haven&apos;t heard of any issues before.&lt;/p&gt;
</comment>
                            <comment id="16585824" author="zregvart" created="Mon, 20 Aug 2018 11:45:18 +0000"  >&lt;p&gt;In Syndesis to help Atlasmap access messages from all processors along the route we create a copy of the Message and store it in a Exchange property. I&apos;ve workaround it in &lt;a href=&quot;https://github.com/syndesisio/syndesis/pull/3406&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Syndesis PR#3406&lt;/a&gt; to set the Exchange from the original message if not set, I wonder if this should be done always? I see several places where copy of the message is created via &lt;tt&gt;copyFrom&lt;/tt&gt; (via &lt;tt&gt;grep -B 4 -A 4 -r --include=&apos;*.java&apos; copyFrom&lt;/tt&gt;), not sure if for all of those the copied message has &lt;tt&gt;Exchange&lt;/tt&gt; set.&lt;/p&gt;</comment>
                            <comment id="16585905" author="davsclaus" created="Mon, 20 Aug 2018 13:08:25 +0000"  >&lt;p&gt;Ah okay, yeah it should potentially have copied over the exchange from the beginning, but we had this behaviour in Camel since its creation. And the EIPs that create sub exchanges are using copy on exchange instead of message etc, so its likely not been an issue at all before this special use-case from atlastmap.&lt;/p&gt;

&lt;p&gt;And yeah we could try to fix this in all those copyFrom methods on classes extending DefaultMessage and set the exchange as well, and on its base class too. They dont call super.copyFrom so we need to do it in both places.&lt;/p&gt;</comment>
                            <comment id="16586149" author="davsclaus" created="Mon, 20 Aug 2018 16:07:16 +0000"  >&lt;p&gt;Okay so its 4 components and camel-core that needs an adjustment&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;camel-core&lt;/li&gt;
	&lt;li&gt;camel-jms&lt;/li&gt;
	&lt;li&gt;camel-sjms&lt;/li&gt;
	&lt;li&gt;camel-mail&lt;/li&gt;
	&lt;li&gt;camel-spring-integration&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16586153" author="davsclaus" created="Mon, 20 Aug 2018 16:07:56 +0000"  >&lt;p&gt;Working on an attempt fix and giving a test of those modules before doing a PR.&lt;/p&gt;</comment>
                            <comment id="16586222" author="githubbot" created="Mon, 20 Aug 2018 17:03:18 +0000"  >&lt;p&gt;davsclaus opened a new pull request #2488: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;: The copy method on Message should by default set the exc&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2488&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &#8230;hange on the copied message to the same instance as from the source. If the copied message is re-attached to another exchange it will reset the exchange anyway.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16586223" author="githubbot" created="Mon, 20 Aug 2018 17:03:18 +0000"  >&lt;p&gt;GitHub user davsclaus opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2488&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;: The copy method on Message should by default set the exc&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;hange on the copied message to the same instance as from the source. If the copied message is re-attached to another exchange it will reset the exchange anyway.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/apache/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel&lt;/a&gt; camel-12741&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2488.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2488.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2488&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit fe75c444740fe48361c93decfe10ec508d95d566&lt;br/&gt;
Author: Claus Ibsen &amp;lt;claus.ibsen@...&amp;gt;&lt;br/&gt;
Date:   2018-08-20T17:02:40Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;: The copy method on Message should by default set the exchange on the copied message to the same instance as from the source. If the copied message is re-attached to another exchange it will reset the exchange anyway.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16586224" author="davsclaus" created="Mon, 20 Aug 2018 17:03:33 +0000"  >&lt;p&gt;A PR with a proposed implementation&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/pull/2488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2488&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16587443" author="githubbot" created="Tue, 21 Aug 2018 13:34:34 +0000"  >&lt;p&gt;davsclaus commented on issue #2488: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;: The copy method on Message should by default set the exc&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2488#issuecomment-414675545&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2488#issuecomment-414675545&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @zregvart here is a extended PR for this problem, you are welcome to take a look&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16588445" author="githubbot" created="Wed, 22 Aug 2018 06:49:28 +0000"  >&lt;p&gt;davsclaus commented on issue #2483: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;: type conversion with SjmsMessage&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2483#issuecomment-414929703&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2483#issuecomment-414929703&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   This PR has more fixes than these here.&lt;br/&gt;
   &lt;a href=&quot;https://github.com/apache/camel/pull/2488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2488&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;   @zregvart could you take a quick look at that&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16588467" author="githubbot" created="Wed, 22 Aug 2018 07:23:08 +0000"  >&lt;p&gt;zregvart commented on issue #2483: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;: type conversion with SjmsMessage&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2483#issuecomment-414937362&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2483#issuecomment-414937362&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Closed in favour of #2488&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16588468" author="githubbot" created="Wed, 22 Aug 2018 07:23:08 +0000"  >&lt;p&gt;zregvart closed pull request #2483: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;: type conversion with SjmsMessage&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2483&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2483&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/camel-core/src/main/java/org/apache/camel/impl/MessageSupport.java b/camel-core/src/main/java/org/apache/camel/impl/MessageSupport.java&lt;br/&gt;
index a2ae7e73a2a..3307c145820 100644&lt;br/&gt;
&amp;#8212; a/camel-core/src/main/java/org/apache/camel/impl/MessageSupport.java&lt;br/&gt;
+++ b/camel-core/src/main/java/org/apache/camel/impl/MessageSupport.java&lt;br/&gt;
@@ -94,6 +94,18 @@ public Object getMandatoryBody() throws InvalidPayloadException {&lt;br/&gt;
             if (answer != null) &lt;/p&gt;
{
                 return answer;
             }
&lt;p&gt;+        } else if (camelContext != null) {&lt;br/&gt;
+            TypeConverter converter = camelContext.getTypeConverter();&lt;br/&gt;
+&lt;br/&gt;
+            T answer = converter.convertTo(type, body);&lt;br/&gt;
+            if (answer != null) &lt;/p&gt;
{
+                return answer;
+            }&lt;br/&gt;
+&lt;br/&gt;
+            answer = converter.tryConvertTo(type, this);&lt;br/&gt;
+            if (answer != null) {+                return answer;+            }
&lt;p&gt;         }&lt;/p&gt;

&lt;p&gt;         // not possible to convert&lt;br/&gt;
diff --git a/components/camel-sjms/src/main/java/org/apache/camel/component/sjms/SjmsMessage.java b/components/camel-sjms/src/main/java/org/apache/camel/component/sjms/SjmsMessage.java&lt;br/&gt;
index d3520346ccb..bdac87e6326 100644&lt;br/&gt;
&amp;#8212; a/components/camel-sjms/src/main/java/org/apache/camel/component/sjms/SjmsMessage.java&lt;br/&gt;
+++ b/components/camel-sjms/src/main/java/org/apache/camel/component/sjms/SjmsMessage.java&lt;br/&gt;
@@ -101,6 +101,8 @@ public void copyFrom(org.apache.camel.Message that) {&lt;br/&gt;
         if (that.hasAttachments()) &lt;/p&gt;
{
             getAttachmentObjects().putAll(that.getAttachmentObjects());
         }
&lt;p&gt;+&lt;br/&gt;
+        setExchange(that.getExchange());&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;     public JmsBinding getBinding() {&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16588469" author="githubbot" created="Wed, 22 Aug 2018 07:23:09 +0000"  >&lt;p&gt;Github user zregvart closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2483&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2483&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16588667" author="githubbot" created="Wed, 22 Aug 2018 10:25:17 +0000"  >&lt;p&gt;davsclaus closed pull request #2488: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12741&quot; title=&quot;SjmsMessage should set Exchange in copyFrom&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12741&quot;&gt;&lt;del&gt;CAMEL-12741&lt;/del&gt;&lt;/a&gt;: The copy method on Message should by default set the exc&#8230;&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2488&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16588668" author="githubbot" created="Wed, 22 Aug 2018 10:25:18 +0000"  >&lt;p&gt;Github user davsclaus closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2488&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16589393" author="zregvart" created="Wed, 22 Aug 2018 21:57:24 +0000"  >&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 12 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3x7on:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>