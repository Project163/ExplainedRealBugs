<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:13:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-9566] camel-asf-ws component does not reconnect to the web socket </title>
                <link>https://issues.apache.org/jira/browse/CAMEL-9566</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Create a web socket consumer route &lt;br/&gt;
Ensure that the web socket provider is available&lt;br/&gt;
Create connection to the web socket provider from the consumer&lt;br/&gt;
Send a message from the provider (send to all)&lt;br/&gt;
Message gets consumed in the consumer route&lt;br/&gt;
Bring down the producer&lt;br/&gt;
Bring up the producer &lt;br/&gt;
Create connection to the web socket provider from the consumer&lt;br/&gt;
Send a message from the provider (send to all)&lt;br/&gt;
Message is not printed as reconnect was not done&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Any&lt;/p&gt;</environment>
        <key id="12936629">CAMEL-9566</key>
            <summary>camel-asf-ws component does not reconnect to the web socket </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="mohitmutha">Mohit</reporter>
                        <labels>
                    </labels>
                <created>Thu, 4 Feb 2016 06:59:23 +0000</created>
                <updated>Fri, 18 Mar 2016 13:56:33 +0000</updated>
                            <resolved>Thu, 17 Mar 2016 17:03:41 +0000</resolved>
                                    <version>2.16.1</version>
                                    <fixVersion>2.16.3</fixVersion>
                    <fixVersion>2.17.0</fixVersion>
                                    <component>camel-ahc-ws</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="7200">2h</timeoriginalestimate>
                            <timeestimate seconds="7200">2h</timeestimate>
                                        <comments>
                            <comment id="15155465" author="davsclaus" created="Sat, 20 Feb 2016 08:04:07 +0000"  >&lt;p&gt;Can you build a sample project that can reproduce this?&lt;/p&gt;</comment>
                            <comment id="15155466" author="davsclaus" created="Sat, 20 Feb 2016 08:08:31 +0000"  >&lt;p&gt;Are you sure its camel-ahc-ws and not camel-websocket ?&lt;/p&gt;</comment>
                            <comment id="15197923" author="rizon" created="Wed, 16 Mar 2016 18:55:50 +0000"  >&lt;p&gt;I&apos;m having the same issue.&lt;/p&gt;

&lt;p&gt;Take a look at the WsListener class.  The onClose() and onError() methods only log the issue and never raise the exception to the camel route.  &lt;a href=&quot;https://github.com/apache/camel/blob/master/components/camel-ahc-ws/src/main/java/org/apache/camel/component/ahc/ws/WsEndpoint.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/master/components/camel-ahc-ws/src/main/java/org/apache/camel/component/ahc/ws/WsEndpoint.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15199098" author="davsclaus" created="Thu, 17 Mar 2016 07:41:13 +0000"  >&lt;p&gt;I pushed some code changes to master branch. Feel free to build and give that a test.&lt;/p&gt;</comment>
                            <comment id="15199536" author="rizon" created="Thu, 17 Mar 2016 13:45:50 +0000"  >&lt;p&gt;Thank you Claus.  In order to test I did have to clone the 2.16.x branch and migrate your changes to 2.16.3-SNAPSHOT since all my other dependencies required 2.16.  However, this did not resolve the issue.  There simply is no detection of the lost socket connection.  When I shutdown the websocket server (i.e another camel endpoint using the camel-websocket component) I don&apos;t think the onClose() method is ever invoked.&lt;/p&gt;

&lt;p&gt;Perhaps we could add a condition in the WsProducer for sendMessage() to check the connection state and throw an Exception if the connection is closed.&lt;/p&gt;

&lt;p&gt;Question:  Is there a way to enable debugging for a single bundle in Karaf? &lt;/p&gt;</comment>
                            <comment id="15199543" author="davsclaus" created="Thu, 17 Mar 2016 13:48:45 +0000"  >&lt;p&gt;Ah okay, what exception does the producer throw? Maybe we can detect a ConnectionException or somerhing and then use that to force a re-connection?&lt;/p&gt;

&lt;p&gt;In karaf you can set log levels from the karaf shell&lt;/p&gt;

&lt;p&gt;something like:&lt;br/&gt;
log:level set org.apache.camel.xxx INFO&lt;/p&gt;

&lt;p&gt;There should be some --help on the log command&lt;/p&gt;</comment>
                            <comment id="15199551" author="rizon" created="Thu, 17 Mar 2016 13:52:49 +0000"  >&lt;p&gt;As of right now there is no exception thrown by the WsProducer when the connection is closed.  Right now I&apos;m testing adding a condition in the process() method of WsProducer to check getWebsocket().isOpen and throw ConnectionException.  However, I&apos;m unsure how to trigger the reconnect...&lt;/p&gt;

&lt;p&gt;Thanks for the debug info.&lt;/p&gt;</comment>
                            <comment id="15199569" author="rizon" created="Thu, 17 Mar 2016 14:02:14 +0000"  >&lt;p&gt;Ah I figured how to trigger reconnect...&lt;/p&gt;

&lt;p&gt;this.getEndpoint().reConnect();&lt;/p&gt;

&lt;p&gt;Testing it now.&lt;/p&gt;</comment>
                            <comment id="15199580" author="rizon" created="Thu, 17 Mar 2016 14:14:20 +0000"  >&lt;p&gt;Actually my test was invalid.  For some reason when I copied the camel-ahc-ws component into the deploy folder it didn&apos;t install.  Although the log said it did.  When I do a feature:list it still shows 2.16 instead of 2.16.3-SNAPSHOT.  I tried uninstalling the 2.16 version but that didn&apos;t work.  What&apos;s the preferred way to install a particular dependency?&lt;/p&gt;</comment>
                            <comment id="15199842" author="rizon" created="Thu, 17 Mar 2016 16:28:33 +0000"  >&lt;p&gt;Claus - I was able to successfully test your changes and they worked perfectly without any of my modifications.  The changes you&apos;ve committed to 2.17, could they be released under rev 2.16.3 of Camel? &lt;/p&gt;

&lt;p&gt;If not, do you have a suggested method of using a different component version?  Currently I&apos;m deploying to Karaf 3 using Camel 2.16.  Thank you!&lt;/p&gt;</comment>
                            <comment id="15199934" author="davsclaus" created="Thu, 17 Mar 2016 17:03:41 +0000"  >&lt;p&gt;Thanks for testing. I backported to 2.16.x&lt;/p&gt;</comment>
                            <comment id="15201421" author="rizon" created="Fri, 18 Mar 2016 12:52:32 +0000"  >&lt;p&gt;Claus - The change didn&apos;t got into last night&apos;s 2.16.3-SNAPSHOT build.  I see that the maven metadata xml files where updated but not the JAR.  Is there a process that I should know about for changes to the repo to go into the build?&lt;br/&gt;
&lt;a href=&quot;https://repository.apache.org/content/groups/snapshots/org/apache/camel/camel-ahc/2.16.3-SNAPSHOT/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/groups/snapshots/org/apache/camel/camel-ahc/2.16.3-SNAPSHOT/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks again&lt;/p&gt;</comment>
                            <comment id="15201494" author="davsclaus" created="Fri, 18 Mar 2016 13:56:33 +0000"  >&lt;p&gt;Build from source manually as those mvn servers are not reliable building&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2sen3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>