<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:32:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-12933] Camel FTP regression: RemoteFile does not override populateHeaders method</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-12933</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;After upgrade from Camel 2.14 to 2.22.1, I have noticed it no longer sets &quot;CamelFileHost&quot; header for Exchange input. After debugging and comparing differences between old and new execution, I have noticed that Camel stopped setting CamelFileHost header after changes in &lt;a href=&quot;https://github.com/apache/camel/commit/e3a1bdb6a278b5e4910ba4caf3ebe95751cceaee#diff-f9d7a01c99e5d4239aae6b6834cdfc65&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/commit/e3a1bdb6a278b5e4910ba4caf3ebe95751cceaee#diff-f9d7a01c99e5d4239aae6b6834cdfc65&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;This happens because previously we had execution chain:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
FtpConsumer-&amp;gt;RemoteFileEndpoint.createExchange-&amp;gt;GenericFile.bindToExchange-&amp;gt;RemoteFile.populateHeaders(msg)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But after this change we have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
FtpConsumer-&amp;gt;RemoteFileEndpoint.createExchange-&amp;gt;GenericFile.bindToExchange-&amp;gt;GenericFile.populateHeaders(msg, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This happens because bindToExchange method sets all the headers via populateHeaders. This method is overriden in RemoteFile, and it adds CamelFileHost header.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void populateHeaders(GenericFileMessage&amp;lt;T&amp;gt; message) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (message != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        &lt;span class=&quot;code-comment&quot;&gt;// because there is not probeContentType option 
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// in other file based components, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; may be passed
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// as the second argument.
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.populateHeaders(message, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
        message.setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;CamelFileHost&quot;&lt;/span&gt;, getHostname());
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But after changes the signature of the parent method was changed from&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void populateHeaders(GenericFileMessage&amp;lt;T&amp;gt; message) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void populateHeaders(GenericFileMessage&amp;lt;T&amp;gt; message, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isProbeContentTypeFromEndpoint) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But its signature was not changed in RemoteFile. Since it is missing the @Override annotation, it compiled well and was unnoticed. But now the overridden method in&#160;RemoteFile does not get executed, and we end up without CamelFileHost header. It may be unnoticed by those who do not use this header, but if we rely on it, it may be an issue.&lt;/p&gt;

&lt;p&gt;My proposed changes will be:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Add @Override annotation to populateHeaders method in RemoteFile, so the same bug will not happen.&lt;/li&gt;
	&lt;li&gt;Change its signature to
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void populateHeaders(GenericFileMessage&amp;lt;T&amp;gt; message, &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isProbeContentTypeFromEndpoint)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So it will be called instead of the parent method. If we assume someone already uses this method somehow and we want to make these changes backward compatible, we may just add a new method with this signature and @Override annotation, leaving existing populateHeaders(GenericFileMessage&amp;lt;T&amp;gt; message) without changes.&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment></environment>
        <key id="13198040">CAMEL-12933</key>
            <summary>Camel FTP regression: RemoteFile does not override populateHeaders method</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="onders">Onder Sezgin</assignee>
                                    <reporter username="mshalak">Maksym Shalak</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Nov 2018 12:18:34 +0000</created>
                <updated>Wed, 14 Nov 2018 12:21:09 +0000</updated>
                            <resolved>Wed, 14 Nov 2018 12:09:56 +0000</resolved>
                                    <version>2.22.1</version>
                                    <fixVersion>2.21.4</fixVersion>
                    <fixVersion>2.22.3</fixVersion>
                    <fixVersion>2.23.0</fixVersion>
                                    <component>camel-ftp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16685120" author="ancosen" created="Tue, 13 Nov 2018 12:23:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=onderson&quot; class=&quot;user-hover&quot; rel=&quot;onderson&quot;&gt;onderson&lt;/a&gt;, since the referenced commit is yours, can you please have a look at this Jira issue if you get a chance? Thanks!&lt;/p&gt;</comment>
                            <comment id="16685967" author="githubbot" created="Wed, 14 Nov 2018 01:17:30 +0000"  >&lt;p&gt;onderson opened a new pull request #2613: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12933&quot; title=&quot;Camel FTP regression: RemoteFile does not override populateHeaders method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12933&quot;&gt;&lt;del&gt;CAMEL-12933&lt;/del&gt;&lt;/a&gt; - override populateHeaders  considering backward compatibility&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2613&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2613&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16686411" author="githubbot" created="Wed, 14 Nov 2018 11:48:10 +0000"  >&lt;p&gt;onderson closed pull request #2613: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12933&quot; title=&quot;Camel FTP regression: RemoteFile does not override populateHeaders method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12933&quot;&gt;&lt;del&gt;CAMEL-12933&lt;/del&gt;&lt;/a&gt; - override populateHeaders  considering backward compatibility&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2613&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2613&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/RemoteFile.java b/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/RemoteFile.java&lt;br/&gt;
index cd1d18eb340..e29c2484889 100644&lt;br/&gt;
&amp;#8212; a/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/RemoteFile.java&lt;br/&gt;
+++ b/components/camel-ftp/src/main/java/org/apache/camel/component/file/remote/RemoteFile.java&lt;br/&gt;
@@ -42,6 +42,11 @@ public void populateHeaders(GenericFileMessage&amp;lt;T&amp;gt; message) &lt;/p&gt;
{
             message.setHeader(&quot;CamelFileHost&quot;, getHostname());
         }
&lt;p&gt;     }&lt;br/&gt;
+    &lt;br/&gt;
+    @Override&lt;br/&gt;
+    public void populateHeaders(GenericFileMessage&amp;lt;T&amp;gt; message, boolean isProbeContentTypeFromEndpoint) &lt;/p&gt;
{
+        populateHeaders(message);
+    }

&lt;p&gt;     public String getHostname() {&lt;br/&gt;
         return hostname;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s00fkw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>