<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:21:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-10587] Extending SQS message invisibility timeout not working in some cases</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-10587</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;org.apache.camel.component.aws.sqs.SqsConsumer creates a TimeoutExtender task for each message received in a batch, but these tasks should be started &lt;b&gt;before&lt;/b&gt; processing the messages.&lt;/p&gt;

&lt;p&gt;Error can be reproduced as follows:&lt;/p&gt;

&lt;p&gt;1. Create an SQS-consuming route using maxMessagesPerPoll=10, extendMessageVisibility=true, visibilityTimeout=30, waitTimeSeconds=20.&lt;br/&gt;
2. Add a process step in the route which just sleeps for a long time.&lt;br/&gt;
3. Put 20-30 messages on the SQS queue.&lt;br/&gt;
4. Start the route.&lt;br/&gt;
5. Let&apos;s say the SQS consumer reads off 10 messages.&lt;br/&gt;
6. Observe in the AWS SQS console that 10 messages are in-flight.&lt;br/&gt;
7. After 30 seconds you can observe that only 1 message is in-flight. This is incorrect.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13027409">CAMEL-10587</key>
            <summary>Extending SQS message invisibility timeout not working in some cases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10101">Abandoned</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sindre.mehus">Sindre Mehus</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Dec 2016 09:48:31 +0000</created>
                <updated>Thu, 17 Dec 2020 15:28:38 +0000</updated>
                            <resolved>Thu, 17 Dec 2020 15:28:23 +0000</resolved>
                                    <version>2.18.0</version>
                                    <fixVersion>Future</fixVersion>
                                    <component>camel-aws</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15889856" author="davsclaus" created="Wed, 1 Mar 2017 09:41:44 +0000"  >&lt;p&gt;Can you turn on trace logging on: org.apache.camel.component.aws.sqs.SqsConsumer&lt;/p&gt;

&lt;p&gt;As it should do a TRACE log when it extends the visibility, and then observe if it does that for all 10 messages.&lt;/p&gt;

&lt;p&gt;I also change the code to start the scheduler before the consumer so the extender is always created in case of some startup race condition otherwise.&lt;/p&gt;</comment>
                            <comment id="15889859" author="davsclaus" created="Wed, 1 Mar 2017 09:44:02 +0000"  >&lt;p&gt;As the extender task is one per message, I think it would make more sense to make it one per batch, and then let it loop all the messages in the batch. Otherwise if you have 100 messages in a batch its 100 tasks on the thread pool to execute and there is only 1 thread.&lt;/p&gt;

&lt;p&gt;In Camel JMX you should see the SqsTimeoutExtender thread pool and you can see how deep its task queue is at runtime and see if there is outstanding tasks that are not run.&lt;/p&gt;</comment>
                            <comment id="15889861" author="davsclaus" created="Wed, 1 Mar 2017 09:46:07 +0000"  >&lt;p&gt;We can maybe use the batch request instead (up to 10 messages)&lt;br/&gt;
&lt;a href=&quot;http://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_ChangeMessageVisibilityBatch.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.aws.amazon.com/AWSSimpleQueueService/latest/APIReference/API_ChangeMessageVisibilityBatch.html&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="16159893" author="davsclaus" created="Sat, 9 Sep 2017 11:15:55 +0000"  >&lt;p&gt;We had a little code fix, so anyone is welcome to test if this is still a problem with latest release&lt;/p&gt;</comment>
                            <comment id="16376837" author="davsclaus" created="Mon, 26 Feb 2018 13:18:00 +0000"  >&lt;p&gt;Would be good to get tested on latest release&lt;/p&gt;</comment>
                            <comment id="17251165" author="davsclaus" created="Thu, 17 Dec 2020 15:28:38 +0000"  >&lt;p&gt;Try with latest release since many years has passed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 47 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37h3b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>