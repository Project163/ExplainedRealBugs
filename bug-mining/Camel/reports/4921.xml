<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:35:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-13491] CamelTestSupport.isCreateCamelContextPerClass no longer works for junit4 tests</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-13491</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;With the changes in&#160;&lt;/p&gt;

&lt;p&gt;org.apache.camel.test.junit4.CamelTestSupport done during the work on&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12534&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/CAMEL-12534&lt;/a&gt;&#160;the camel context is now recreated for every test regardless of the return value from&lt;/p&gt;

&lt;p&gt;isCreateCamelContextPerClass()&lt;/p&gt;

&lt;p&gt;. Since junit4 creates a new instance of the class for every test the variable tests will be recreated and initialized to 0 for every test.&lt;/p&gt;

&lt;p&gt;This condition in tearDown will always be true&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// code placeholder
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (tests.compareAndSet(v, v - 1)) {
&#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (v == 1) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;which stops the camel context after every test.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13231993">CAMEL-13491</key>
            <summary>CamelTestSupport.isCreateCamelContextPerClass no longer works for junit4 tests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="hallonbat">Jan Hallonsten</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 May 2019 11:57:07 +0000</created>
                <updated>Thu, 6 Jun 2019 10:59:42 +0000</updated>
                            <resolved>Thu, 6 Jun 2019 10:59:42 +0000</resolved>
                                    <version>2.23.0</version>
                                    <fixVersion>3.0.0.M4</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>camel-test</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16838029" author="davsclaus" created="Sun, 12 May 2019 09:47:13 +0000"  >&lt;p&gt;You are welcome to work on a fix and submit a PR&lt;/p&gt;</comment>
                            <comment id="16838329" author="hallonbat" created="Mon, 13 May 2019 07:31:41 +0000"  >&lt;p&gt;I can sure give it a try, I just have to set up a dev environment for Camel.&lt;/p&gt;</comment>
                            <comment id="16841179" author="davsclaus" created="Thu, 16 May 2019 10:10:41 +0000"  >&lt;p&gt;Jan, how is it going?&lt;/p&gt;</comment>
                            <comment id="16841187" author="hallonbat" created="Thu, 16 May 2019 10:17:51 +0000"  >&lt;p&gt;I have been busy working on other things unfortunately, I am cloning Camel from Github now so that it is easy to get started when I am done with my other task (hopefully later today).&lt;/p&gt;</comment>
                            <comment id="16854949" author="davsclaus" created="Mon, 3 Jun 2019 18:57:33 +0000"  >&lt;p&gt;Any update on this&lt;/p&gt;</comment>
                            <comment id="16854952" author="hallonbat" created="Mon, 3 Jun 2019 19:02:00 +0000"  >&lt;p&gt;I have been struggling to get Camel to build and get it configured in Intellij. I managed to build it via command line now but Intellij is still having issues. It did not import all poms as Maven modules. Should I base the pull request on master or some other branch?&lt;/p&gt;</comment>
                            <comment id="16854954" author="davsclaus" created="Mon, 3 Jun 2019 19:04:45 +0000"  >&lt;p&gt;master, and I really suggest to just only open the module you work on, eg camel-test and then just open its pom.xml file.&lt;/p&gt;

&lt;p&gt;You should not import the entire project as its too massive&lt;/p&gt;</comment>
                            <comment id="16855004" author="hallonbat" created="Mon, 3 Jun 2019 20:10:01 +0000"  >&lt;p&gt;Do you ever run the Camel unit tests in parallel? Do they have to support running the tests with the surefire parallel parameter set to methods?&lt;/p&gt;</comment>
                            <comment id="16855120" author="hallonbat" created="Mon, 3 Jun 2019 22:41:24 +0000"  >&lt;p&gt;I have been looking at the code now and I must admit that my knowledge of JUnit internals is not the best so I might have missed something. Is there any way to know in the @After annotated tearDown method that the currently running test method is the last in the test class and that it is time to stop the camel context? From my point of view that is why we have the @AfterClass annotation to be able to run code after all test methods have been executed. So for now I am inclined to move the tearDown back to a static @AfterClass annotated method. Since the @AfterClass method needs to be static, doing that would mess up test classes that override&#160;doPostTearDown and/or&#160;cleanupResources, expecting them to be executed after the camel context is stopped. Any input or suggestions on how to fix it?&lt;/p&gt;</comment>
                            <comment id="16857345" author="davsclaus" created="Thu, 6 Jun 2019 06:35:38 +0000"  >&lt;p&gt;Yeah this is a bit tricky to do. I took a look and created a PR with a fix&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/pull/2963&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2963&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Feedback is welcome&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 23 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02gm8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>