<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:42:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-14533] camel-ftp: fileExist=Append and tempPrefix options do not work together</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-14533</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;If you both have fileExist=Append and tempPrefix=&amp;lt;something&amp;gt; options on a sftp to-endpoint, the de facto behaviour of the route is as if it was configured with fileExist=Override.&lt;/p&gt;

&lt;p&gt;When you think about how fileExist and tempPrefix works, this bug actually makes sense. The temporary prefix makes it so that a &quot;new&quot; file is written every time, and therefore fileExist=Append is just working like it does when there isn&apos;t an existing file to append to.&lt;/p&gt;

&lt;p&gt;I think there are a couple of possible solutions to this problem:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Document this behaviour in the camel documentation, and let the user be responsible for knowing that these two options are incompatible&lt;/li&gt;
	&lt;li&gt;Throw an exception when building the route if these two mutually exclusive options are used on the same route&lt;/li&gt;
	&lt;li&gt;Make fileExist=Append and tempPrefix=&amp;lt;something&amp;gt; be compatible, by making the &apos;mv&apos; operation after writing the temporary file merge the two files, instead of replacing it&lt;/li&gt;
	&lt;li&gt;Some other brilliant solution that the camel maintainers will see, that has escaped me&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&lt;b&gt;Recreate the issue&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Define and start up the following route:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
from(&lt;span class=&quot;code-quote&quot;&gt;&quot;timer:&lt;span class=&quot;code-comment&quot;&gt;//loltimer?delay=5000&amp;amp;period=5000&quot;&lt;/span&gt;)
&lt;/span&gt; .setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;CamelFileName&quot;&lt;/span&gt;, constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo.txt&quot;&lt;/span&gt;))
 .setBody(constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;Davs&quot;&lt;/span&gt;))
 .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;sftp:&lt;span class=&quot;code-comment&quot;&gt;//mysftpserver:22/fileappendtest?username=myusername&amp;amp;password=mypassword&amp;amp;fileExist=Append&amp;amp;tempPrefix=.uploading&quot;&lt;/span&gt;);&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Then you can observe the folder on the sftp-server, and see that the file size never increases, but the files Last-Modified timestamp gets renewed every five seconds.&lt;/p&gt;

&lt;p&gt;If you remove the &quot;tempPrefix=.uploading&quot; option from the sftp uri it works like it should, and the file size increases every 5 seconds.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13284561">CAMEL-14533</key>
            <summary>camel-ftp: fileExist=Append and tempPrefix options do not work together</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="kalusn">Claus Skou Nielsen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Feb 2020 12:20:52 +0000</created>
                <updated>Mon, 3 Aug 2020 08:00:02 +0000</updated>
                            <resolved>Mon, 3 Aug 2020 08:00:02 +0000</resolved>
                                    <version>2.22.2</version>
                    <version>2.24.2</version>
                    <version>3.0.1</version>
                                    <fixVersion>2.25.2</fixVersion>
                    <fixVersion>3.4.3</fixVersion>
                    <fixVersion>3.5.0</fixVersion>
                                    <component>camel-ftp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17034431" author="davsclaus" created="Tue, 11 Feb 2020 13:13:29 +0000"  >&lt;p&gt;You are welcome to work on a PR with the option to throw an exception.&lt;/p&gt;</comment>
                            <comment id="17034451" author="kalusn" created="Tue, 11 Feb 2020 13:46:26 +0000"  >&lt;p&gt;Ok, I&apos;ll give it a go.&lt;/p&gt;</comment>
                            <comment id="17169788" author="davsclaus" created="Mon, 3 Aug 2020 07:42:29 +0000"  >&lt;p&gt;The file component throws an exception so lets do the same for ftp&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 15 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0bdao:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>