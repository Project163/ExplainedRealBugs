<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:29:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-12441] MulticastProcessor doProcessParallel blocks indefinitly if exception occurs in it.next()</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-12441</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;After upgrading from camel 2.17.5 to 2.21.0 the following problem was encountered:&lt;/p&gt;

&lt;p&gt;Context:&lt;br/&gt;
A camel RouteBuilder with a split :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;MyRouteBuilder.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyRouteBuilder &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; RouteBuilder {
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void configure() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
         from(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:in&quot;&lt;/span&gt;)
                 .split()
                      .xtokenize(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-comment&quot;&gt;//someTocken&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;i&apos;&lt;/span&gt;, NAMESPACES)
&lt;/span&gt;                      .aggregationStrategy(nw UseLatestAggregationStrategy())
                      .stopOnException()
                      .parallelAggregate()
                      .parallelProcessing()
                      .executorServiceRef(&lt;span class=&quot;code-quote&quot;&gt;&quot;splitExecutorService&quot;&lt;/span&gt;).stopOnException()
                      .streaming().stopOnException()
                      .id(&lt;span class=&quot;code-quote&quot;&gt;&quot;xml-splitter&quot;&lt;/span&gt;)
                .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:out&quot;&lt;/span&gt;)
                .routeId(getClass().getSimpleName());
    } 
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Problem encountered:&lt;br/&gt;
A malformed xml arrives on this route. it.hasNext() returns true but it.next() throws an exception. This causes an indefinite wait in MulticastProcessor at line 374.&lt;/p&gt;

&lt;p&gt;Reason:&lt;br/&gt;
A call to countDown on aggregationOnTheFlyDone is never performed and thus the latch waits indefinitely.&lt;/p&gt;

&lt;p&gt;Possible solution:&lt;br/&gt;
A call to aggregationOnTheFlyDone .countDown inside the catch corresponding to the try surrounding the while.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;Windows 8, java 1.8.0_162, camel 2.21.0&lt;/p&gt;</environment>
        <key id="13152202">CAMEL-12441</key>
            <summary>MulticastProcessor doProcessParallel blocks indefinitly if exception occurs in it.next()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="shellysoft">Bodor Maria Mihaela</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Apr 2018 08:00:20 +0000</created>
                <updated>Mon, 16 Apr 2018 09:00:52 +0000</updated>
                            <resolved>Mon, 16 Apr 2018 08:32:07 +0000</resolved>
                                    <version>2.20.3</version>
                    <version>2.21.0</version>
                                    <fixVersion>2.20.4</fixVersion>
                    <fixVersion>2.21.1</fixVersion>
                    <fixVersion>2.22.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16438276" author="davsclaus" created="Sat, 14 Apr 2018 07:51:41 +0000"  >&lt;p&gt;Can you post your XML sample&lt;/p&gt;</comment>
                            <comment id="16438637" author="shellysoft" created="Sun, 15 Apr 2018 08:54:05 +0000"  >&lt;p&gt;I&apos;ve created an example on my github account:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/shellysoft/CAMEL-12441&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/shellysoft/CAMEL-12441&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ve tried to mirror the context I have in my project where I discovered the issue. As javax.xml.stream.XMLInputFactory I use com.ctc.wstx.stax.WstxInputFactory.&lt;/p&gt;

&lt;p&gt;Please do not hesitate if you have any questions.&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;</comment>
                            <comment id="16439113" author="davsclaus" created="Mon, 16 Apr 2018 08:22:26 +0000"  >&lt;p&gt;Thanks I have reproduced the issue and have a fix. Mind that this problem is only on the first next call.&lt;/p&gt;</comment>
                            <comment id="16439121" author="davsclaus" created="Mon, 16 Apr 2018 08:32:07 +0000"  >&lt;p&gt;Thanks for the sample project.&lt;/p&gt;</comment>
                            <comment id="16439153" author="shellysoft" created="Mon, 16 Apr 2018 09:00:52 +0000"  >&lt;p&gt;You are most welcome!&lt;/p&gt;

&lt;p&gt;Ah, yes! Because after the first call the aggregateOnTheFlyTask is submitted to the aggregateExecutorService and the allTaskSubmitted flag does it&apos;s job.&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 31 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3sien:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>