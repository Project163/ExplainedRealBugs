<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:35:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-13376] camel-cxf - failure processor for custom exception handling cannot get the original message</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-13376</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I configured custom exception handling for a CXF consumer where I want to use my own processor.&lt;br/&gt;
&#160;&lt;br/&gt;
&#160;Lile this:&lt;br/&gt;
&#160;&lt;br/&gt;
&#160;onException(Exception.class)&lt;br/&gt;
&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; &#160;.handled(false)&lt;br/&gt;
&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; &#160;.useOriginalMessage()&lt;br/&gt;
&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; &#160;.process(failureResponseProcessor);&lt;br/&gt;
&#160;&lt;br/&gt;
&#160;or:&lt;br/&gt;
&#160;&lt;br/&gt;
&#160;&amp;lt;onException useOriginalMessage=&quot;true&quot;&amp;gt;&lt;br/&gt;
&#160;&#160; &#160;&amp;lt;exception&amp;gt;java.lang.Exception&amp;lt;/exception&amp;gt;&lt;br/&gt;
&#160;&#160; &#160;&amp;lt;handled&amp;gt;&amp;lt;constant&amp;gt;false&amp;lt;/constant&amp;gt;&amp;lt;/handled&amp;gt;&lt;br/&gt;
&#160;&#160; &#160;&amp;lt;process ref=&quot;failureResponseProcessor&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/onException&amp;gt;&lt;/p&gt;



&lt;p&gt;If allowStreaming is enabled on the CXF consumer endpoint, my FailureResponseProcessor cannot get the original body (the body part of CachedCxfPayload seems to be empty).&lt;/p&gt;

&lt;p&gt;If I set allowStreaming to false, the processor works as expected.&lt;/p&gt;


&lt;p&gt;I did a branch on my fork to create this reproducer:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jochenr/camel/tree/Reproducer-CXF-CustomExceptionHandling-in-StreamingMode/examples/camel-example-cxf-proxy&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jochenr/camel/tree/Reproducer-CXF-CustomExceptionHandling-in-StreamingMode/examples/camel-example-cxf-proxy&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;If you toggle the setting of allowStreaming between true and false, you see the different output to the console, right after the string&lt;br/&gt;
&quot;This was the original BODY that caused the fault:&quot;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Redhat Fuse 7.0 (on EAP)&lt;/p&gt;

&lt;p&gt;reproduced with current &quot;camel-example-cxf-proxy&quot; example&lt;/p&gt;</environment>
        <key id="13224597">CAMEL-13376</key>
            <summary>camel-cxf - failure processor for custom exception handling cannot get the original message</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ffang">Freeman Yue Fang</assignee>
                                    <reporter username="j_ri">Jochen Riedlinger</reporter>
                        <labels>
                    </labels>
                <created>Thu, 28 Mar 2019 14:01:29 +0000</created>
                <updated>Mon, 27 May 2019 19:06:30 +0000</updated>
                            <resolved>Mon, 27 May 2019 19:06:30 +0000</resolved>
                                    <version>2.21.0</version>
                                    <fixVersion>2.23.3</fixVersion>
                    <fixVersion>2.22.5</fixVersion>
                    <fixVersion>2.24.1</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                    <fixVersion>2.25.0</fixVersion>
                                    <component>camel-cxf</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16803960" author="ancosen" created="Thu, 28 Mar 2019 14:05:29 +0000"  >&lt;p&gt;For Red Hat product you need to contact RH support.&lt;/p&gt;</comment>
                            <comment id="16803996" author="davsclaus" created="Thu, 28 Mar 2019 14:37:05 +0000"  >&lt;p&gt;You likely need to turn on stream-caching as if something that is streamed may be read already and not re-readable&lt;br/&gt;
&lt;a href=&quot;http://camel.apache.org/why-is-my-message-body-empty.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.apache.org/why-is-my-message-body-empty.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16804018" author="j_ri" created="Thu, 28 Mar 2019 15:10:37 +0000"  >&lt;p&gt;sure, I&apos;m aware of this.&lt;/p&gt;

&lt;p&gt;if you take a look at&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/jochenr/camel/blob/Reproducer-CXF-CustomExceptionHandling-in-StreamingMode/examples/camel-example-cxf-proxy/src/main/resources/META-INF/spring/camel-config.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jochenr/camel/blob/Reproducer-CXF-CustomExceptionHandling-in-StreamingMode/examples/camel-example-cxf-proxy/src/main/resources/META-INF/spring/camel-config.xml&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;you see that in my reproducer (and in my real project) this is done:&lt;/p&gt;

&lt;p&gt;&amp;lt;route streamCache=&quot;true&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16804024" author="j_ri" created="Thu, 28 Mar 2019 15:13:57 +0000"  >&lt;p&gt;@&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ancosen&quot; class=&quot;user-hover&quot; rel=&quot;ancosen&quot;&gt;ancosen&lt;/a&gt;: I did contact the RH support in parallel, but I thought it&apos;s simpler to put it here and just send the link to RH...and I thought it could help other people, too.&lt;/p&gt;</comment>
                            <comment id="16804932" author="j_ri" created="Fri, 29 Mar 2019 12:57:08 +0000"  >&lt;p&gt;why did you lower the priority?&lt;/p&gt;

&lt;p&gt;IMHO it&apos;s quite essential that this works. As workaround I have to disable streaming or I have to wire-tap all messages to find the message that caused an error in a &quot;wire-tap archive&quot; and have to correlate it manually (beisdes that I need a lot of hard drive space).&lt;/p&gt;

&lt;p&gt;Actually I only want to archive/log messages that caused errors.....&lt;/p&gt;</comment>
                            <comment id="16849092" author="ffang" created="Mon, 27 May 2019 17:20:16 +0000"  >&lt;p&gt;We need to set the body back to original CxfPayload with cached stream source so&lt;br/&gt;
CxfPayload is re-readable&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 25 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z017g8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>