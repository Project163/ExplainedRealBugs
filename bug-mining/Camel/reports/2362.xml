<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:58:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-6335] Sftp cannot change to parent directory in a stepwise fashion</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-6335</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;The problem occurs when using the sftp protocol with the stepwise option enabled and when polling a subdirectory.&lt;/p&gt;

&lt;p&gt;When Camel has finished polling the subdirectory, it attempts to change directory back to the home directory in a stepwise fashion: Doing &quot;cd ..&quot; one step at a time. This logic has a bug that causes it to try to change to a non-existing directory.&lt;/p&gt;

&lt;p&gt;This has been discussed on the user mailing list:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/camel-users/201305.mbox/%3CCAJ0TPGJ6gdaEuYgjpKG42HR-ozbyC0e5Z=mi2xRDmnonBtY0Eg@mail.gmail.com%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/camel-users/201305.mbox/%3CCAJ0TPGJ6gdaEuYgjpKG42HR-ozbyC0e5Z=mi2xRDmnonBtY0Eg@mail.gmail.com%3E&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12646164">CAMEL-6335</key>
            <summary>Sftp cannot change to parent directory in a stepwise fashion</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ay">Akitoshi Yoshida</assignee>
                                    <reporter username="rodehav">Bengt Rodehav</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 May 2013 07:08:36 +0000</created>
                <updated>Tue, 30 Jul 2013 07:42:29 +0000</updated>
                            <resolved>Tue, 30 Jul 2013 07:42:29 +0000</resolved>
                                    <version>2.9.4</version>
                    <version>2.9.5</version>
                    <version>2.9.6</version>
                    <version>2.9.7</version>
                    <version>2.10.2</version>
                    <version>2.10.3</version>
                    <version>2.10.4</version>
                    <version>2.11.0</version>
                                    <fixVersion>2.10.7</fixVersion>
                    <fixVersion>2.11.2</fixVersion>
                    <fixVersion>2.12.0</fixVersion>
                                    <component>camel-ftp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13650718" author="rodehav" created="Tue, 7 May 2013 11:07:25 +0000"  >&lt;p&gt;Patch for removing the faulty code.&lt;/p&gt;</comment>
                            <comment id="13650721" author="rodehav" created="Tue, 7 May 2013 11:08:43 +0000"  >&lt;p&gt;I attached a patch for removing the code where I found the bug. It works for me but someone need to check why that code was created in the first place. It might have been for a good reason.&lt;/p&gt;</comment>
                            <comment id="13650725" author="rodehav" created="Tue, 7 May 2013 11:18:38 +0000"  >&lt;p&gt;Browsing through SVN I noticed that the bug was introduced in version 1382039 on 2012-09-07. Cross referencing with the releases announced in the news feed, it means that the following versions all are affected by this bug:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;2.9.4&lt;/li&gt;
	&lt;li&gt;2.9.5&lt;/li&gt;
	&lt;li&gt;2.9.6&lt;/li&gt;
	&lt;li&gt;2.9.7&lt;/li&gt;
	&lt;li&gt;2.10.2&lt;/li&gt;
	&lt;li&gt;2.10.3&lt;/li&gt;
	&lt;li&gt;2.10.4&lt;/li&gt;
	&lt;li&gt;2.11.0&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13667664" author="ay" created="Mon, 27 May 2013 09:40:59 +0000"  >&lt;p&gt;i think simply removing the code will reintroduce old issues. The code was solving the normal stepwise operations in which we ensure the stepwise traversal moves the path upwards from the current directory to where it started without touching its upper directory where you may not have authorization to access.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-5574&quot; title=&quot;camel-sftp&amp;#39;s stepwise behavior to walk up and down relatively to avoid potential traversal issues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-5574&quot;&gt;&lt;del&gt;CAMEL-5574&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;however, it appears that this code doesn&apos;t not work when the path is at the root (i.e., when the path is &quot;/&quot;).&lt;br/&gt;
in that case, this code needs to be skipped as this special traversal is not needed.&lt;/p&gt;

&lt;p&gt;regards, aki&lt;/p&gt;</comment>
                            <comment id="13692193" author="rodehav" created="Mon, 24 Jun 2013 18:02:41 +0000"  >&lt;p&gt;Sorry for the late comment. Aki, I don&apos;t understand why it is better to &quot;move the path upwards&quot; one directory at a time to avoid authorization problems. In fact, you will get more authorization problems if you change to every intermediate directory instead of changing directory &quot;in one go&quot;. You might not be authorized to access the intermediate directories at all. This really does not make sense to me.&lt;/p&gt;</comment>
                            <comment id="13692901" author="ay" created="Tue, 25 Jun 2013 10:05:40 +0000"  >&lt;p&gt;Bengt,&lt;br/&gt;
The assumption is, if your ftp server requires stepwise traversal, you will anyway need access right to the segment you traverse.&lt;/p&gt;

&lt;p&gt;While going down the path from the starting point using stepwise traversal, you can certainly go up stepwise to the starting point because you have accessed those segment before. The original stepwise traveral jumped to the root while going back and from there going down to the starting point. This can touch the segment outside of the previously accessed segment and resulted in the access error mentioned. And as I mentioned in my previous comment, this code must be skipped if the path is at the root but otherwise, it is needed.&lt;/p&gt;

&lt;p&gt;regards, aki&lt;/p&gt;</comment>
                            <comment id="13693058" author="rodehav" created="Tue, 25 Jun 2013 14:12:09 +0000"  >&lt;p&gt;Point well taken - if you are allowed to go down stepwise you are most likely allowed to go back up stepwise. I guess you want to go back up stepwise for the same reason you want to go down stepwise. I just have never understood what situations the stepwise functionality actually remedies. What ftp server does not allow you to change directory directly (&quot;CD subdirA/subdirB&quot;) but requires you to stop att every intermediate directory (&quot;CD subdirA&quot; then &quot;CD subdirB&quot;)? What does actually happen?&lt;/p&gt;

&lt;p&gt;I&apos;m not opposed to the stepwise functionality but I have never found a situation where I have needed it and I&apos;m just curious abou this since stepwise has been chosen as the default option for Camel.&lt;/p&gt;

&lt;p&gt;Anyway, I guess all that is needed is to fix the code according to your suggestion. Then we&apos;ll have the best of both worlds (stepwise and not).&lt;/p&gt;</comment>
                            <comment id="13693062" author="rodehav" created="Tue, 25 Jun 2013 14:16:09 +0000"  >&lt;p&gt;BTW, Aki, isn&apos;t the stepwise stepping up functionality also needed for ftp/ftps? For some reason this functionality is only added to sftp and not to ftp/ftps.&lt;/p&gt;</comment>
                            <comment id="13713437" author="ay" created="Fri, 19 Jul 2013 08:26:06 +0000"  >&lt;p&gt;Hi Bengt,&lt;br/&gt;
I committed the fix to trunk, 2.11.x, and 2.10.x. If you could try it out, that would be appreciated. &lt;/p&gt;

&lt;p&gt;Regarding the consolidation/refactoring of the ftp and sftp part of the code, you are right. This needs to be done. But for clarity, we should handle this explicitly in another ticket, as it will involve more changes.&lt;/p&gt;

&lt;p&gt;thanks.&lt;br/&gt;
regards, aki&lt;/p&gt;</comment>
                            <comment id="13722438" author="rodehav" created="Mon, 29 Jul 2013 13:14:40 +0000"  >&lt;p&gt;Just back from vacation will test as soon as I can.&lt;/p&gt;</comment>
                            <comment id="13723494" author="rodehav" created="Tue, 30 Jul 2013 07:02:51 +0000"  >&lt;p&gt;I tested version 2.11.2-SNAPSHOT built on July 24. My test case that fails with version 2.11.0 now works. Good job!&lt;/p&gt;</comment>
                            <comment id="13723524" author="ay" created="Tue, 30 Jul 2013 07:42:29 +0000"  >&lt;p&gt;Thanks to Bengt for his testing the patch.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12582074" name="SftpOperations.java.patch" size="802" author="rodehav" created="Tue, 7 May 2013 11:07:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>326522</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 17 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kbxz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>326867</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>