<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:45:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-16034] MDC Logging causing OutOfMemory with large split</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-16034</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;If using MDC logging and splitting a large amount of data it could cause OutOfMemory because internal memory consumption for MDC is growing enormous.&lt;/p&gt;

&lt;p&gt;DefaultReactiveExecutor.Worker.back in HeapDump seems to be correlated with MDCCallback&lt;/p&gt;

&lt;p&gt;See test case  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13018753/13018753_Main.java&quot; title=&quot;Main.java attached to CAMEL-16034&quot;&gt;Main.java&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;  run with -Xmx1G -XX:+HeapDumpOnOutOfMemoryError&lt;/p&gt;</description>
                <environment></environment>
        <key id="13352238">CAMEL-16034</key>
            <summary>MDC Logging causing OutOfMemory with large split</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="graben">Benjamin Graf</reporter>
                        <labels>
                    </labels>
                <created>Thu, 14 Jan 2021 11:40:57 +0000</created>
                <updated>Thu, 4 Apr 2024 13:04:39 +0000</updated>
                            <resolved>Wed, 3 Feb 2021 11:18:47 +0000</resolved>
                                    <version>3.7.0</version>
                                    <fixVersion>3.7.2</fixVersion>
                    <fixVersion>3.8.0</fixVersion>
                                    <component>came-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17277793" author="davsclaus" created="Wed, 3 Feb 2021 08:11:03 +0000"  >&lt;p&gt;MDC is not recommended to use in a reactive world&lt;/p&gt;</comment>
                            <comment id="17277798" author="davsclaus" created="Wed, 3 Feb 2021 08:19:33 +0000"  >&lt;p&gt;The MDCUnitOfWork will be garbage collected so there is no leak, but during splitting then a large number of them are in use.&lt;/p&gt;</comment>
                            <comment id="17277802" author="davsclaus" created="Wed, 3 Feb 2021 08:27:53 +0000"  >&lt;p&gt;The splitter should be in streaming mode, as otherwise it builds up the 1 million rows in memory before starting to split&lt;/p&gt;</comment>
                            <comment id="17277820" author="davsclaus" created="Wed, 3 Feb 2021 08:47:17 +0000"  >&lt;p&gt;Okay so it seems that the after work with the additional MDCUnitOfWork is put back in the queue in the reactive executor, and this causes pending tasks to pile up.&lt;/p&gt;</comment>
                            <comment id="17277824" author="davsclaus" created="Wed, 3 Feb 2021 08:56:08 +0000"  >&lt;p&gt;I can now run this app with 32M heap&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13469690">CAMEL-18255</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13018753" name="Main.java" size="1018" author="graben" created="Thu, 14 Jan 2021 11:41:08 +0000"/>
                            <attachment id="13018754" name="java_pid13864.001" size="61865984" author="graben" created="Thu, 14 Jan 2021 12:05:05 +0000"/>
                            <attachment id="13018755" name="java_pid13864.002" size="61865984" author="graben" created="Thu, 14 Jan 2021 12:09:46 +0000"/>
                            <attachment id="13018756" name="java_pid13864.003" size="61865984" author="graben" created="Thu, 14 Jan 2021 12:11:20 +0000"/>
                            <attachment id="13018757" name="java_pid13864.004" size="42425074" author="graben" created="Thu, 14 Jan 2021 12:12:13 +0000"/>
                            <attachment id="13018758" name="java_pid13864.crc" size="60" author="graben" created="Thu, 14 Jan 2021 12:13:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 41 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ml1c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>