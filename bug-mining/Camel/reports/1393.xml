<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:43:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-3806] SOAPAction HTTP header value not copied correctly to from CXF message to Camel message header</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-3806</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When using camel-cxf consumer endpoint with PAYLOAD data format, the SoapActionInInterceptor correctly strips off any double quotes surrounding the SOAPAction header value, e.g:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;SOAPAction: &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//apache.org/hello_world_soap_http/greetMe&quot;&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and then sets this header on the message again:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;SoapActionInInterceptor.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void handleMessage(SoapMessage message) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Fault {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; action = getSoapAction(message);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!StringUtils.isEmpty(action)) {
            getAndSetOperation(message, action);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After the execution of getAndSetOperation(message, action), there are two SOAPAction headers set on the message. The original SOAPAction header value (with surrounding quotes) is part of the org.apache.cxf.message.Message.PROTOCOL_HEADERS. In addition the getAndSetOperation() method also adds &lt;br/&gt;
SOAPAction=&lt;a href=&quot;http://apache.org/hello_world_soap_http/greetMe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache.org/hello_world_soap_http/greetMe&lt;/a&gt; header (without surrounding quotes). &lt;/p&gt;

&lt;p&gt;Later in org.apache.camel.component.cxf.DefaultCxfBinding.propagateHeadersFromCxfToCamel(), when the CXF message headers get copied to the Camel message, it only retrieves the org.apache.cxf.message.Message.PROTOCOL_HEADERS:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;&amp;gt; cxfHeaders = (Map)cxfMessage.get(Message.PROTOCOL_HEADERS);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The SOAPAction header in PROTOCOL_HEADERS wasn&apos;t changed by the SoapActionInInterceptor and hence still has enclosed double quotes. These headers then get copied to the Camel In message headers. The header that was set by the SoapActionInInterceptor SOAPAction=&lt;a href=&quot;http://apache.org/hello_world_soap_http/greetMe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache.org/hello_world_soap_http/greetMe&lt;/a&gt; does not get copied!&lt;/p&gt;

&lt;p&gt;If later in a Camel route a custom Camel Processor tries to resolve this SOAPAction header, it gets the the value with surrounding double quotes, but these should actually have been stripped off. &lt;/p&gt;

&lt;p&gt;This behavior is a bug.&lt;/p&gt;
</description>
                <environment>&lt;p&gt;camel-cxf, CXF consumer endpoint with PAYLOAD data format &lt;/p&gt;</environment>
        <key id="12502380">CAMEL-3806</key>
            <summary>SOAPAction HTTP header value not copied correctly to from CXF message to Camel message header</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="tmielke">Torsten Mielke</reporter>
                        <labels>
                            <label>CXF</label>
                            <label>HTTP</label>
                            <label>SOAPAction</label>
                            <label>header</label>
                    </labels>
                <created>Fri, 25 Mar 2011 14:06:33 +0000</created>
                <updated>Tue, 25 Oct 2011 11:35:22 +0000</updated>
                            <resolved>Tue, 29 Mar 2011 03:17:24 +0000</resolved>
                                    <version>2.6.0</version>
                                    <fixVersion>2.7.3</fixVersion>
                    <fixVersion>2.8.0</fixVersion>
                                    <component>camel-cxf</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13011209" author="tmielke" created="Fri, 25 Mar 2011 14:07:40 +0000"  >&lt;p&gt;Attaching JUnit test. It currently fails but will succeed if the SOAPAction header value is not enclosed by double quotes.&lt;/p&gt;</comment>
                            <comment id="13011210" author="tmielke" created="Fri, 25 Mar 2011 14:08:08 +0000"  >&lt;p&gt;I see two solutions:&lt;/p&gt;

&lt;p&gt;1) copy all CXF headers into Camel in message headers:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;org.apache.camel.component.cxf.DefaultCxfBinding.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// pseudo code
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void propagateHeadersFromCxfToCamel(Message cxfMessage,
            org.apache.camel.Message camelMessage, Exchange exchange) {
        Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;&amp;gt; cxfHeaders = (Map)cxfMessage.getHeaders()
        Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; camelHeaders = camelMessage.getHeaders();
        camelHeaders.put(CxfConstants.CAMEL_CXF_MESSAGE, cxfMessage);
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This should also copy the SOAPAction header that the SoapActionInInterceptor added to the message.&lt;/p&gt;

&lt;p&gt;2) Have the SoapActionInInterceptor strip off the surrounding double quote from the SOAPAction header (which it does already) and replace the SOAPAction header in the already populated org.apache.cxf.message.Message.PROTOCOL_HEADERS with the modified (stripped off) value. &lt;br/&gt;
That way org.apache.camel.component.cxf.DefaultCxfBinding.java does not need to be changed. &lt;/p&gt;

&lt;p&gt;I personally kinda prefer the second option.&lt;/p&gt;</comment>
                            <comment id="13011767" author="davsclaus" created="Sun, 27 Mar 2011 10:29:41 +0000"  >&lt;p&gt;Willem can you take a look? We should strip off double quotes from the value IMHO&lt;/p&gt;</comment>
                            <comment id="13011768" author="davsclaus" created="Sun, 27 Mar 2011 10:30:29 +0000"  >&lt;p&gt;Btw which client put quotes in the value? I actually wonder if that&apos;s really best practice, and allowed to do?&lt;/p&gt;</comment>
                            <comment id="13011946" author="njiang" created="Mon, 28 Mar 2011 07:51:44 +0000"  >&lt;p&gt;Because SOAP11 and SOAP12 send the SOAPAction with different protocol:&lt;br/&gt;
SOAP11 uses SOAPAction=&quot;xxx&quot; http header,&lt;br/&gt;
SOAP12 uses action=&quot;xxx&quot;  as a part of content-type&lt;br/&gt;
If we want to provides the user with consistence result, we need to store the result with key of &quot;SOAPAction&quot; for common using, CXF SOAPActionInterceptor takes care of it and strip the &quot;/&quot;&quot; for using. In camel-cxf we copy the PROTOCOL_HEADER directly into the Camel message header, if the user using SOAP11 binding, the SOAPAction is also a part of the PROTOOL_HEADER. If the user want to get the message header of SOAPAction, he will get.&lt;br/&gt;
If the user using SOAP12 binding, he can&apos;t get any value with the message header of SOAPAction.&lt;/p&gt;

&lt;p&gt;SO my suggestion is we just put the SOAPAction header from CXF message into camel message, in this way the user can get this kind of the message header directly from the camel message whatever the soap binding is.&lt;/p&gt;

&lt;p&gt;Willem&lt;/p&gt;</comment>
                            <comment id="13011955" author="tmielke" created="Mon, 28 Mar 2011 08:18:54 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Btw which client put quotes in the value? I actually wonder if that&apos;s really best practice, and allowed to do?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;According to the &lt;a href=&quot;http://www.w3.org/TR/2000/NOTE-SOAP-20000508/#_Toc478383528&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;SOAP 1.1 spec&lt;/a&gt;, the SOAPAction header value needs to be enclosed by double quotes. Here an extract of the grammar defining the SOAPAction header:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;soapaction    = &quot;SOAPAction&quot; &quot;:&quot; [ &amp;lt;&quot;&amp;gt; URI-reference &amp;lt;&quot;&amp;gt; ]&lt;br/&gt;
URI-reference = &amp;lt;as defined in RFC 2396 &lt;span class=&quot;error&quot;&gt;&amp;#91;4&amp;#93;&lt;/span&gt;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;CXF also generates double quotes around the SOAPAction header value. &lt;/p&gt;</comment>
                            <comment id="13012326" author="njiang" created="Tue, 29 Mar 2011 03:17:06 +0000"  >&lt;p&gt;Committed a patch to fix this issue.&lt;br/&gt;
For the Message data formate, as the SOAPActionInInterceptor is not installed, the use can still get the SOAPAction header with double quotes surrounding.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12474616" name="testcase.zip" size="10600" author="tmielke" created="Fri, 25 Mar 2011 14:07:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>14175</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 35 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01x0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9117</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>