<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:03:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-20152] camel-jetty - OutOfMemoryError with big file upload via multipart</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-20152</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I don&apos;t now if is related to jetty (maybe) but when i use camel with jetty and i upload a big file using multipart i get:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// espace r23:28:50.262 WARN [qtp1616084922-291] /email/myservice
&lt;/span&gt;java.lang.IllegalStateException: java.lang.OutOfMemoryError: Java heap space
&#160; &#160; &#160; &#160; at org.eclipse.jetty.http.MultiPartFormInputStream.throwIfError(MultiPartFormInputStream.java:517) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.http.MultiPartFormInputStream.getParts(MultiPartFormInputStream.java:470) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.MultiParts$MultiPartsHttpParser.getParts(MultiParts.java:74) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.Request.getParts(Request.java:2450) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.Request.getParts(Request.java:2420) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.apache.camel.component.jetty.MultiPartFilter.doFilter(MultiPartFilter.java:52) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.component.jetty.CamelFilterWrapper.doFilter(CamelFilterWrapper.java:49) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) [!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) [!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) [!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) [!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) [!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883) [!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034) [!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:833) [?:?]
Caused by: java.lang.OutOfMemoryError: Java heap space
&#160; &#160; &#160; &#160; at java.util.Arrays.copyOf(Arrays.java:3537) ~[?:?]
&#160; &#160; &#160; &#160; at java.io.ByteArrayOutputStream.ensureCapacity(ByteArrayOutputStream.java:100) ~[?:?]
&#160; &#160; &#160; &#160; at java.io.ByteArrayOutputStream.write(ByteArrayOutputStream.java:130) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.http.MultiPartFormInputStream$MultiPart.write(MultiPartFormInputStream.java:178) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.http.MultiPartFormInputStream$Handler.content(MultiPartFormInputStream.java:741) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.http.MultiPartParser.parseOctetContent(MultiPartParser.java:645) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.http.MultiPartParser.parse(MultiPartParser.java:214) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.http.MultiPartFormInputStream.parse(MultiPartFormInputStream.java:587) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.http.MultiPartFormInputStream.getParts(MultiPartFormInputStream.java:469) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.MultiParts$MultiPartsHttpParser.getParts(MultiParts.java:74) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.Request.getParts(Request.java:2450) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.Request.getParts(Request.java:2420) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.apache.camel.component.jetty.MultiPartFilter.doFilter(MultiPartFilter.java:52) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.component.jetty.CamelFilterWrapper.doFilter(CamelFilterWrapper.java:49) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:193) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.Server.handle(Server.java:516) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpChannel$$Lambda$828/0x00000007c0935678.dispatch(Unknown Source) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479) ~[!/:9.4.52.v20230823]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277) ~[?:?]
&#160; &#160; &#160; &#160; at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) ~[?:?]&#233;serv&#233; du code
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Here the simple route:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;InputHttpRoute &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; RouteBuilder {
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void configure() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        from(http()) &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160;
                .noStreamCaching()
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; .process(e -&amp;gt; {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; e.getIn(AttachmentMessage.class).getAttachments()
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; .forEach((s, dataHandler) -&amp;gt; {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; InputStream files = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; files = dataHandler.getInputStream();
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] buffer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[10500];
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; b;
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; ((b = files.read(buffer)) != -1) {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-comment&quot;&gt;// Convert &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt; to character
&lt;/span&gt;&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; data = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;(buffer, 0, b);
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(data);
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (IOException ex) {
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(ex);
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; }
&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; });;
    }

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; http() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringBuilder(&lt;span class=&quot;code-quote&quot;&gt;&quot;jetty:http:&lt;span class=&quot;code-comment&quot;&gt;//0.0.0.0:8787/myservice&quot;&lt;/span&gt;)
&lt;/span&gt;                .append(&lt;span class=&quot;code-quote&quot;&gt;&quot;?httpMethodRestrict=&quot;&lt;/span&gt;)
                .append(&lt;span class=&quot;code-quote&quot;&gt;&quot;POST&quot;&lt;/span&gt;)
                .toString();
    }
}&lt;span class=&quot;code-comment&quot;&gt;// espace r&#233;serv&#233; du code&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The file is fully loaded in memory before i can access it this is a unwanted behavior and it will be nice if it will be possible to start processing the file during the upload in streaming fashion mode&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;More about this =&amp;gt; &lt;a href=&quot;https://camel.zulipchat.com/#narrow/stream/257295-general/topic/camel-jetty.20Large.20file.20upload.20streaming.20mode&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://camel.zulipchat.com/#narrow/stream/257295-general/topic/camel-jetty.20Large.20file.20upload.20streaming.20mode&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/13064750/13064750_image-2023-11-28-09-12-11-951.png&quot; height=&quot;722&quot; width=&quot;770&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13559420">CAMEL-20152</key>
            <summary>camel-jetty - OutOfMemoryError with big file upload via multipart</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nfilotto">Nicolas Filotto</assignee>
                                    <reporter username="michael992">michael elbaz</reporter>
                        <labels>
                    </labels>
                <created>Sat, 25 Nov 2023 22:30:36 +0000</created>
                <updated>Wed, 29 Nov 2023 14:25:31 +0000</updated>
                            <resolved>Wed, 29 Nov 2023 14:25:31 +0000</resolved>
                                    <version>3.21.2</version>
                                    <fixVersion>3.20.9</fixVersion>
                    <fixVersion>3.21.3</fixVersion>
                    <fixVersion>3.22.0</fixVersion>
                    <fixVersion>4.0.4</fixVersion>
                    <fixVersion>4.3.0</fixVersion>
                                    <component>camel-jetty</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17790438" author="JIRAUSER285918" created="Tue, 28 Nov 2023 08:43:26 +0000"  >&lt;p&gt;Thanks for reporting, I confirm there is a bug, let me propose a bug fix&lt;/p&gt;</comment>
                            <comment id="17790465" author="michael992" created="Tue, 28 Nov 2023 09:28:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nfilotto&quot; class=&quot;user-hover&quot; rel=&quot;nfilotto&quot;&gt;nfilotto&lt;/a&gt; Ok perfect thanks you, also i think it will be very useful to be able to choose between&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;in memory + theshold&lt;/li&gt;
	&lt;li&gt;in directory + path to the directory
	&lt;ol&gt;
		&lt;li&gt;delete the file at end or not&lt;/li&gt;
	&lt;/ol&gt;
	&lt;/li&gt;
	&lt;li&gt;streaming processing that mean once the content available process it immediately without waiting for the whole upload (file or memory) like this =&amp;gt; &lt;a href=&quot;https://commons.apache.org/proper/commons-fileupload/streaming.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://commons.apache.org/proper/commons-fileupload/streaming.html&lt;/a&gt; &#160;&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="17790471" author="ancosen" created="Tue, 28 Nov 2023 10:04:08 +0000"  >&lt;p&gt;These are new features and they couldn&apos;t be add to 3.21.x, maybe they could go on Camel 4 or Camel 3.22.0 if there is capacity and if they are not invasive.&lt;/p&gt;</comment>
                            <comment id="17790564" author="michael992" created="Tue, 28 Nov 2023 13:20:45 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=acosentino&quot; class=&quot;user-hover&quot; rel=&quot;acosentino&quot;&gt;acosentino&lt;/a&gt;&#160; You right, but i think the 2 first point is the initial expected behavior, not a new features (maybe i&apos;m wrong) thanks&#160;&lt;/p&gt;</comment>
                            <comment id="17790605" author="JIRAUSER285918" created="Tue, 28 Nov 2023 14:37:19 +0000"  >&lt;p&gt;Here is the PR &lt;a href=&quot;https://github.com/apache/camel/pull/12240&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/12240&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;After a deeper analysis, it is due to the fact that the &lt;a href=&quot;https://github.com/apache/camel/blob/main/components/camel-jetty-common/src/main/java/org/apache/camel/component/jetty/JettyHttpComponent.java#L1153&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;fileSizeThreshold&lt;/tt&gt; is set to 0&lt;/a&gt; by default to have the content stored on disk like &lt;a href=&quot;https://github.com/jakartaee/servlet/blob/master/api/src/main/java/jakarta/servlet/MultipartConfigElement.java#L109-L110&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;it is mentioned in the Jakarta Javadoc&lt;/a&gt; but it is not what the Jetty code does, indeed the &lt;a href=&quot;https://github.com/jetty/jetty.project/blob/jetty-11.0.x/jetty-server/src/main/java/org/eclipse/jetty/server/MultiPartFormInputStream.java#L188&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Jetty code expects a value strictly higher than 0&lt;/a&gt;.&#160;&lt;/p&gt;</comment>
                            <comment id="17790607" author="michael992" created="Tue, 28 Nov 2023 14:44:33 +0000"  >&lt;p&gt;Look good thanks you !&lt;/p&gt;</comment>
                            <comment id="17790617" author="JIRAUSER285918" created="Tue, 28 Nov 2023 15:00:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=acosentino&quot; class=&quot;user-hover&quot; rel=&quot;acosentino&quot;&gt;acosentino&lt;/a&gt; I don&apos;t know what you think of the fix proposal but I think that it could be backported into the 3.x branch. For 3.20 and 3.21, what I can propose as a fix is to simply set &lt;tt&gt;fileSizeThreshold&lt;/tt&gt; to a different default value, high enough to limit the regressions but not too high to avoid OOME, something like 10 MB, WDYT?&lt;/p&gt;</comment>
                            <comment id="17790675" author="ancosen" created="Tue, 28 Nov 2023 17:05:29 +0000"  >&lt;p&gt;Sounds good to me&lt;/p&gt;</comment>
                            <comment id="17790676" author="ancosen" created="Tue, 28 Nov 2023 17:05:37 +0000"  >&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="17790727" author="JIRAUSER285918" created="Tue, 28 Nov 2023 19:12:19 +0000"  >&lt;p&gt;The corresponding ticket in the Jetty project &lt;a href=&quot;https://github.com/jetty/jetty.project/issues/10936&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jetty/jetty.project/issues/10936&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17791015" author="JIRAUSER285918" created="Wed, 29 Nov 2023 11:01:58 +0000"  >&lt;p&gt;The corresponding PRs:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;4.3 &lt;a href=&quot;https://github.com/apache/camel/pull/12240&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/12240&lt;/a&gt; (bug fixed by configuration)&lt;/li&gt;
	&lt;li&gt;3.22 &lt;a href=&quot;https://github.com/apache/camel/pull/12249&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/12249&lt;/a&gt; (bug fixed by configuration)&lt;/li&gt;
	&lt;li&gt;3.21 &lt;a href=&quot;https://github.com/apache/camel/pull/12252&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/12252&lt;/a&gt; (bug fixed by using a default threshold)&lt;/li&gt;
	&lt;li&gt;3.20 &lt;a href=&quot;https://github.com/apache/camel/pull/12255&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/12255&lt;/a&gt; (bug fixed by using a default threshold)&lt;/li&gt;
	&lt;li&gt;4.0 &lt;a href=&quot;https://github.com/apache/camel/pull/12256&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/12256&lt;/a&gt; (bug fixed by using a default threshold)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="13064750" name="image-2023-11-28-09-12-11-951.png" size="241849" author="michael992" created="Tue, 28 Nov 2023 08:12:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 50 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1luio:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>