<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:27:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-12112] Camel processing single file twice in &apos;file&apos; endpoint</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-12112</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt; we defined our route as:&lt;/p&gt;

&lt;p&gt;	from(&quot;file:stageDummy&quot;)&lt;br/&gt;
    	.threads(1)&lt;br/&gt;
    	.process(myProcess);&lt;/p&gt;

&lt;p&gt;   We first add 1000 file in stageDummy folder, then we run the code and we get exception as below&lt;/p&gt;



&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.camel.component.file.GenericFileOperationFailedException: Cannot rename file: GenericFile[newFile319] to: GenericFile[.camel/newFile319]
	at org.apache.camel.component.file.strategy.GenericFileProcessStrategySupport.renameFile(GenericFileProcessStrategySupport.java:115)
	at org.apache.camel.component.file.strategy.GenericFileRenameProcessStrategy.commit(GenericFileRenameProcessStrategy.java:88)
	at org.apache.camel.component.file.GenericFileOnCompletion.processStrategyCommit(GenericFileOnCompletion.java:127)
	at org.apache.camel.component.file.GenericFileOnCompletion.onCompletion(GenericFileOnCompletion.java:83)
	at org.apache.camel.component.file.GenericFileOnCompletion.onComplete(GenericFileOnCompletion.java:57)
	at org.apache.camel.util.UnitOfWorkHelper.doneSynchronizations(UnitOfWorkHelper.java:104)
	at org.apache.camel.impl.DefaultUnitOfWork.done(DefaultUnitOfWork.java:229)
	at org.apache.camel.util.UnitOfWorkHelper.doneUow(UnitOfWorkHelper.java:65)
	at org.apache.camel.processor.CamelInternalProcessor$UnitOfWorkProcessorAdvice.after(CamelInternalProcessor.java:654)
	at org.apache.camel.processor.CamelInternalProcessor$UnitOfWorkProcessorAdvice.after(CamelInternalProcessor.java:609)
	at org.apache.camel.processor.CamelInternalProcessor$InternalCallback.done(CamelInternalProcessor.java:239)
	at org.apache.camel.processor.CamelInternalProcessor$InternalCallback.done(CamelInternalProcessor.java:250)
	at org.apache.camel.processor.RedeliveryErrorHandler$1.done(RedeliveryErrorHandler.java:480)
	at org.apache.camel.management.InstrumentationProcessor$1.done(InstrumentationProcessor.java:86)
	at org.apache.camel.processor.Pipeline$1.done(Pipeline.java:148)
	at org.apache.camel.processor.ThreadsProcessor$ProcessCall.run(ThreadsProcessor.java:85)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
	at java.util.concurrent.FutureTask.run(FutureTask.java:262)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)


&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;As per our understanding camel picks up the file from the mentioned directory i.e in my case-stageDummy and processed by process-myProcess&lt;br/&gt;
and moves it to .camel sub folder.We noticed that if we were having more than or around 1000 files in the folder -stageDummy ,there were some exceptions&lt;br/&gt;
thrown &lt;/p&gt;

&lt;p&gt;This exception is thrown randomly for n number of files,where n changes everytime we execute our main.Note that we were not trying to access the exchange &lt;br/&gt;
instead we kept our process simple.We could see that if there are 1000 files in our folder then the processor is getting called 1000+x times ,where x changes everytime example it gets called 1024 times,and we could see that camel is trying to process  these x number of files again&lt;/p&gt;

&lt;p&gt;We are attaching the Sample Main class&lt;/p&gt;</description>
                <environment>&lt;p&gt;We are trying with Apache Camel core 2.18.5, 2.19.4, 2.20.1 Oracle Java 1.8, we have tried on Ubuntu and window 7 both.&lt;/p&gt;</environment>
        <key id="13128189">CAMEL-12112</key>
            <summary>Camel processing single file twice in &apos;file&apos; endpoint</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="Bhuvangu">Bhuvan Gupta</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Jan 2018 09:30:56 +0000</created>
                <updated>Thu, 11 Jan 2018 12:17:00 +0000</updated>
                            <resolved>Thu, 11 Jan 2018 11:26:22 +0000</resolved>
                                    <version>2.17.7</version>
                    <version>2.18.5</version>
                    <version>2.19.4</version>
                    <version>2.20.1</version>
                                    <fixVersion>2.20.2</fixVersion>
                    <fixVersion>2.21.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16309492" author="bhuvangu" created="Wed, 3 Jan 2018 11:12:15 +0000"  >&lt;p&gt;Error occurs like 2 out of 3 times when runing the project.&lt;/p&gt;

&lt;p&gt;Attached the sample maven project as well&lt;/p&gt;</comment>
                            <comment id="16309493" author="bhuvangu" created="Wed, 3 Jan 2018 11:12:49 +0000"  >&lt;p&gt;Sample Project .. just run the  project 3-4 time it will show the error&lt;/p&gt;</comment>
                            <comment id="16309673" author="davsclaus" created="Wed, 3 Jan 2018 13:53:25 +0000"  >&lt;p&gt;Get help on the mailing list first, also we cannot reproduce your problem.&lt;/p&gt;</comment>
                            <comment id="16316246" author="bhuvangu" created="Mon, 8 Jan 2018 12:48:21 +0000"  >&lt;p&gt;I have updated the scenario under which we will get the issue.&lt;br/&gt;
&lt;a href=&quot;http://camel.465427.n5.nabble.com/Fwd-Camel-processing-single-file-twice-in-file-endpoint-td5816380.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.465427.n5.nabble.com/Fwd-Camel-processing-single-file-twice-in-file-endpoint-td5816380.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16316255" author="ancosen" created="Mon, 8 Jan 2018 12:54:33 +0000"  >&lt;p&gt;Lets discuss on the mailing list, this issue is currently closed.&lt;/p&gt;</comment>
                            <comment id="16316442" author="bhuvangu" created="Mon, 8 Jan 2018 15:04:04 +0000"  >&lt;p&gt;Ok.. i will keep a close eye on the EMail-Box.&lt;/p&gt;</comment>
                            <comment id="16322030" author="davsclaus" created="Thu, 11 Jan 2018 10:45:04 +0000"  >&lt;p&gt;So in your use-case you should configure the thread to not use a task queue so you wont take in more files than you can concurrent process&lt;/p&gt;

&lt;p&gt;With this it should work&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.threads(1, 10).maxQueueSize(0)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16322075" author="davsclaus" created="Thu, 11 Jan 2018 11:26:22 +0000"  >&lt;p&gt;Increased the in-progress cache to use 50000 as default.&lt;br/&gt;
And as said set the queue size of the threads to 0.&lt;/p&gt;</comment>
                            <comment id="16322121" author="bhuvangu" created="Thu, 11 Jan 2018 12:17:00 +0000"  >&lt;p&gt;Thanks.. &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.threads(1, 10).maxQueueSize(0)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;this strategy makes sense now.&lt;/p&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12904361" name="App.java" size="2897" author="Bhuvangu" created="Wed, 3 Jan 2018 09:28:27 +0000"/>
                            <attachment id="12904374" name="myarchive1.7z" size="8483" author="Bhuvangu" created="Wed, 3 Jan 2018 11:12:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[http://camel.465427.n5.nabble.com/Fwd-Camel-processing-single-file-twice-in-file-endpoint-td5816380.html]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 44 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3oggn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>