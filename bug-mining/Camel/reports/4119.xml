<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:23:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-11298] Using chmodDirectory with full paths makes file producer to created directories relative to source</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-11298</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Tried using the chmodDirectory property on a file producer that writes to full system paths and noticed that with the chmodDirectory property the directories get created relative to the source/project.&lt;/p&gt;

&lt;p&gt;Without using the property the files get properly created using the full path that is given to them.&lt;/p&gt;

&lt;p&gt;I ran a debugger and found the source of the problem:&lt;/p&gt;

&lt;p&gt;Code is from org.apache.camel.component.file.FileOperations &lt;br/&gt;
in buildDirectory method&lt;br/&gt;
at lines 97 - 118&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (permissions == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || permissions.isEmpty()) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; dir.mkdirs();
        }

        &lt;span class=&quot;code-comment&quot;&gt;// create directory one part of a time and set permissions
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] parts = dir.getPath().split(&lt;span class=&quot;code-quote&quot;&gt;&quot;\\&quot;&lt;/span&gt; + File.separatorChar);
            File base = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;.&quot;&lt;/span&gt;);
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; part : parts) {
                File subDir = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(base, part);
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!subDir.exists()) {
                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (subDir.mkdir()) {
                        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isTraceEnabled()) {
                            LOG.trace(&lt;span class=&quot;code-quote&quot;&gt;&quot;Setting chmod: {} on directory: {} &quot;&lt;/span&gt;, PosixFilePermissions.toString(permissions), subDir);
                        }
                        Files.setPosixFilePermissions(subDir.toPath(), permissions);
                    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
                    }
                }
                base = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(base, subDir.getName());
            }
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Base File used to create all the folders and set their permissions is initialized with new File(&quot;.&quot;), effectively this always creates the directories given to it, relative to the source, and will not handle full system paths.&lt;/p&gt;

&lt;p&gt;Is there a reason I&apos;m unaware of that this is implemented this way?&lt;/p&gt;

&lt;p&gt;I tested running folder creation code with new File(&quot;&quot;) as a base and it worked fine, would that be enough to handle the issue if it indeed is an issue?&lt;/p&gt;

&lt;p&gt;I can do this my self by issuing a pull request, let me know.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Arch Linux&lt;/p&gt;</environment>
        <key id="13073126">CAMEL-11298</key>
            <summary>Using chmodDirectory with full paths makes file producer to created directories relative to source</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="Stabbz">Damyan Damyanov</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 May 2017 12:48:09 +0000</created>
                <updated>Tue, 23 May 2017 10:55:13 +0000</updated>
                            <resolved>Tue, 23 May 2017 09:48:59 +0000</resolved>
                                    <version>2.18.2</version>
                    <version>2.19.0</version>
                                    <fixVersion>2.18.5</fixVersion>
                    <fixVersion>2.19.1</fixVersion>
                    <fixVersion>2.20.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16017684" author="davsclaus" created="Fri, 19 May 2017 17:15:48 +0000"  >&lt;p&gt;Can you provide an example with the uri configuration to better explain this&lt;/p&gt;</comment>
                            <comment id="16017874" author="stabbz" created="Fri, 19 May 2017 19:15:04 +0000"  >&lt;p&gt;Sure, this route below will produce an exception that illustrates the problem, the chmodDirectory property will create the directory relative to the source but the file producer will look for that directory in its system path resulting in a FileNotFoundException.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Component
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestRouter &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; RouteBuilder {

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void configure() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {

        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; outputFileDir = &lt;span class=&quot;code-quote&quot;&gt;&quot;/home/damyan/Desktop/test/test2/&quot;&lt;/span&gt;;

        from(&lt;span class=&quot;code-quote&quot;&gt;&quot;timer:&lt;span class=&quot;code-comment&quot;&gt;//foo?fixedRate=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;period=10000&quot;&lt;/span&gt;)
&lt;/span&gt;                .setBody(simple (&lt;span class=&quot;code-quote&quot;&gt;&quot;Hello World&quot;&lt;/span&gt;))
                .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;//&quot;&lt;/span&gt; + outputFileDir + &lt;span class=&quot;code-quote&quot;&gt;&quot;?chmodDirectory=777&quot;&lt;/span&gt;);
&lt;/span&gt;    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16018717" author="davsclaus" created="Sun, 21 May 2017 07:19:59 +0000"  >&lt;p&gt;Yeah a PR is welcome we love contributions&lt;/p&gt;</comment>
                            <comment id="16019233" author="stabbz" created="Mon, 22 May 2017 07:39:16 +0000"  >&lt;p&gt;I&apos;m not sure which branch to use for such a PR, can you give me some direction? Thanks.&lt;/p&gt;</comment>
                            <comment id="16019236" author="davsclaus" created="Mon, 22 May 2017 07:40:54 +0000"  >&lt;p&gt;Always master, then the Camel team cherry-pick to older branches if necessary.&lt;/p&gt;</comment>
                            <comment id="16019652" author="githubbot" created="Mon, 22 May 2017 14:48:48 +0000"  >&lt;p&gt;GitHub user Stabbz opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1707&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1707&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11298&quot; title=&quot;Using chmodDirectory with full paths makes file producer to created directories relative to source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11298&quot;&gt;&lt;del&gt;CAMEL-11298&lt;/del&gt;&lt;/a&gt;: Fix, allowing usage of absolute and relative paths with chmodDirectory option&lt;/p&gt;

&lt;p&gt;    Reused the absolute boolean flag to handle absolute paths when using chmodDirectory option. Previously using absolute paths produced an exception.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/Stabbz/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Stabbz/camel&lt;/a&gt; chmod-dir-fix&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1707.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1707.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #1707&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 995ff7e1640fe285eb66c948d8f487c918991c26&lt;br/&gt;
Author: Damyan Damyanov &amp;lt;damyan.damyanov@scalefocus.com&amp;gt;&lt;br/&gt;
Date:   2017-05-22T11:41:34Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11298&quot; title=&quot;Using chmodDirectory with full paths makes file producer to created directories relative to source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11298&quot;&gt;&lt;del&gt;CAMEL-11298&lt;/del&gt;&lt;/a&gt;: Minor change to file constructor used in chmodDirectory. Should fix the issue.&lt;/p&gt;

&lt;p&gt;commit b91e1d21e3e0b50e95e12b793610c956ce1e7950&lt;br/&gt;
Author: Damyan Damyanov &amp;lt;damyan.damyanov@scalefocus.com&amp;gt;&lt;br/&gt;
Date:   2017-05-22T14:43:49Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-11298&quot; title=&quot;Using chmodDirectory with full paths makes file producer to created directories relative to source&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-11298&quot;&gt;&lt;del&gt;CAMEL-11298&lt;/del&gt;&lt;/a&gt;: Added additional logic to handle absolute and relative paths when using chmodDirectory.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16021034" author="githubbot" created="Tue, 23 May 2017 10:55:13 +0000"  >&lt;p&gt;Github user Stabbz closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/1707&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/1707&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 26 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3f653:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>