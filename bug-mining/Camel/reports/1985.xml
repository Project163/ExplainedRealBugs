<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:53:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-5464] camel-jms consumer doesn&apos;t send back a reply in all cases</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-5464</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;In a very simple route consuming from a Camel JMS endpoint receiving InOut exchanges (i.e. JMSReplyTo header present), the endpoint will not send back replies.&lt;/p&gt;

&lt;p&gt;This happens because Camel JMS only returns a reply if the OUT message is set. But if the route looks like: consumer =&amp;gt; processor, and Camel doesn&apos;t find the need to &quot;weave in&quot; an implicit Pipeline processor, no one will implicitly take care of mapping the IN message to an OUT message (unless the user knows about these internal aspects - but we shouldn&apos;t expect them too).&lt;/p&gt;

&lt;p&gt;As a result, these routes DON&apos;T WORK...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;route&amp;gt;
   &amp;lt;from uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;timer:foo?fixedRate=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;amp;period=10000&quot;&lt;/span&gt; /&amp;gt;
   &amp;lt;setBody&amp;gt;&amp;lt;constant&amp;gt;Hello Raul&amp;lt;/constant&amp;gt;&amp;lt;/setBody&amp;gt;
   &amp;lt;to uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;log:SendingRequest?showAll=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; /&amp;gt;
   &amp;lt;inOut uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;activemq:queue:test1?requestTimeout=1000&quot;&lt;/span&gt; /&amp;gt;
   &amp;lt;to uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;log:ReceivedReply?showAll=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; /&amp;gt;
&amp;lt;/route&amp;gt;
        
&amp;lt;route&amp;gt;
   &amp;lt;from uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;activemq:queue:test1&quot;&lt;/span&gt; /&amp;gt;
   &amp;lt;to uri=&lt;span class=&quot;code-quote&quot;&gt;&quot;log:ReceivedRequest?showAll=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; /&amp;gt;
&amp;lt;/route&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... but just by adding an additional log endpoint to the second route (or any other thing, for that matter), it starts to work because Camel weaves in the Pipeline processor.&lt;/p&gt;

&lt;p&gt;Other workarounds that work:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;del&gt;explicitly wrapping the log endpoint in a &amp;lt;pipeline&amp;gt; DSL&lt;/del&gt;&lt;/li&gt;
	&lt;li&gt;&amp;lt;setBody&amp;gt;&amp;lt;simple&amp;gt;${in.body}&amp;lt;/simple&amp;gt;&amp;lt;/setBody&amp;gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Or simply introducing anything that will force Camel to insert a Pipeline processor.&lt;/p&gt;

&lt;p&gt;IMHO, there are two solutions to avoid this issue:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Always weave in a Pipeline processor (adds overhead in simple routes and may cause regressions)&lt;/li&gt;
	&lt;li&gt;Adapt EndpointMessageListener to pick the IN message when the exchange is out capable and expectation of a reply exists&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I&apos;m happy to work on a patch for Camel 2.10.1.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;EDIT:&lt;/b&gt; Just wrapping the single endpoint in &amp;lt;pipeline /&amp;gt; doesn&apos;t function as a workaround.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12599998">CAMEL-5464</key>
            <summary>camel-jms consumer doesn&apos;t send back a reply in all cases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="raulvk">Ra&#250;l Kripalani</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 Jul 2012 13:01:06 +0000</created>
                <updated>Wed, 7 Nov 2012 10:30:32 +0000</updated>
                            <resolved>Wed, 7 Nov 2012 10:30:32 +0000</resolved>
                                    <version>2.8.6</version>
                    <version>2.9.2</version>
                    <version>2.10.0</version>
                                    <fixVersion>2.9.5</fixVersion>
                    <fixVersion>2.10.3</fixVersion>
                    <fixVersion>2.11.0</fixVersion>
                                    <component>camel-activemq</component>
                    <component>camel-jms</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13433072" author="davsclaus" created="Mon, 13 Aug 2012 11:31:10 +0000"  >&lt;p&gt;Yes #2 should be the case, as that is how the other components would have to do, eg cxf consumer etc.&lt;/p&gt;
</comment>
                            <comment id="13442900" author="jwcarman" created="Tue, 28 Aug 2012 02:21:10 +0000"  >&lt;p&gt;Here&apos;s a patch that implements option #2.  Let me know if you see any regressions.  I can&apos;t get the full Maven build working on my computer right now.&lt;/p&gt;</comment>
                            <comment id="13445750" author="njiang" created="Fri, 31 Aug 2012 07:56:18 +0000"  >&lt;p&gt;The patch broke some tests of the camel-jms. After digging the tests, I found the tests keep the out message null to no send the response back. It can be fixed easily by changing the MEP to InOnly.&lt;br/&gt;
As this feature break the backward compatibility, I don&apos;t plan to merge the patch back to other branch. &lt;/p&gt;</comment>
                            <comment id="13445765" author="njiang" created="Fri, 31 Aug 2012 08:27:22 +0000"  >&lt;p&gt;Applied patch with thanks to James.&lt;/p&gt;</comment>
                            <comment id="13445928" author="jwcarman" created="Fri, 31 Aug 2012 13:40:48 +0000"  >&lt;p&gt;Okay, cool!  Sorry about the regression.  I was (and still am) having a terrible time getting the build to run locally on my machine.  I&apos;ll keep tinkering.  This is my first Mac laptop, so getting used to Java development on here is somewhat of a chore.  Perhaps I&apos;ll just switch to a VM or something&lt;/p&gt;

&lt;p&gt;Are we going to update the fix versions/status?&lt;/p&gt;</comment>
                            <comment id="13452004" author="njiang" created="Mon, 10 Sep 2012 14:20:41 +0000"  >&lt;p&gt;Applied the patch into trunk, as it breaks the behavior of old Camel version, I don&apos;t want to port it back to other branches.&lt;/p&gt;</comment>
                            <comment id="13492226" author="davsclaus" created="Wed, 7 Nov 2012 09:40:03 +0000"  >&lt;p&gt;I think this fix is more important, than those odd unit-tests that was needed to change.&lt;/p&gt;

&lt;p&gt;If you do request/reply over JMS, then you would expect Camel to send back the reply always - also if the route, only do a single step like&lt;br/&gt;
from JMS&lt;br/&gt;
  to bean&lt;/p&gt;

&lt;p&gt;So I am working on backporting this to older branches.&lt;/p&gt;</comment>
                            <comment id="13492250" author="davsclaus" created="Wed, 7 Nov 2012 10:30:32 +0000"  >&lt;p&gt;Backported to 2.10 and 2.9 branches.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12542712" name="CAMEL-5464.patch" size="3918" author="jwcarman" created="Tue, 28 Aug 2012 02:21:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>241336</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0278v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10775</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>