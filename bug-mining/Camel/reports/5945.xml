<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:50:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-16370] Camel Salesforce component unable to reconnect after disconnect from Salesforce</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-16370</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;We are consuming Salesforce platform-events following the documented recommendations and our connection will not reconnect after being disconnected, apparently, from Salesforce.&#160; I am not quite certain as to the circumstances that Salesforce sends some sort of disconnect signal, but that is what&apos;s logged from the SubscriptionHelper class. Our initial connection to Salesforce is successful and we are able to receive platform-events up until the point of the spontaneous disconnection.&#160; Re-connection fails consistently and always in the same way.&#160; Logging is slightly different across version, but the behavior seems to always be the same.&lt;/p&gt;

&lt;p&gt;Our only work around for this is to run our service consuming this message like a cron job and restart it every 15 minutes (period we settled on through experimentation).&#160; This is not how we&apos;d prefer to sun this service, it&apos;s quite hacky and we&apos;d like to not have to force a restart to work around what appears to an issue with how the reconnect is handled.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Here is the stacktrace:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:30:48,513 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$5 &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-25 &amp;#93;&lt;/span&gt; - Received messages [&lt;/p&gt;
{clientId=[--------redacted--------], channel=/meta/connect, id=21, successful=true}]&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:30:48,513 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-25 &amp;#93;&lt;/span&gt; - &lt;span class=&quot;error&quot;&gt;&amp;#91;CHANNEL:META_CONNECT&amp;#93;&lt;/span&gt;: {clientId=[--------redacted--------], channel=/meta/connect, id=21, successful=true}
&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:32:38,588 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$5 &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-25 &amp;#93;&lt;/span&gt; - Received messages [&lt;/p&gt;
{clientId=[--------redacted--------], channel=/meta/connect, id=22, successful=true}]&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:32:38,589 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-25 &amp;#93;&lt;/span&gt; - &lt;span class=&quot;error&quot;&gt;&amp;#91;CHANNEL:META_CONNECT&amp;#93;&lt;/span&gt;: {clientId=[--------redacted--------], channel=/meta/connect, id=22, successful=true}
&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:34:28,665 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$5 &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-25 &amp;#93;&lt;/span&gt; - Received messages [&lt;/p&gt;
{clientId=[--------redacted--------], channel=/meta/connect, id=23, successful=true}]&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:34:28,666 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-25 &amp;#93;&lt;/span&gt; - &lt;span class=&quot;error&quot;&gt;&amp;#91;CHANNEL:META_CONNECT&amp;#93;&lt;/span&gt;: {clientId=[--------redacted--------], channel=/meta/connect, id=23, successful=true}
&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:34:28,766 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$5 &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-32 &amp;#93;&lt;/span&gt; - Received messages [&lt;/p&gt;
{channel=/meta/disconnect}
&lt;p&gt;, {clientId=&lt;span class=&quot;error&quot;&gt;&amp;#91;--------redacted--------&amp;#93;&lt;/span&gt;, advice=&lt;/p&gt;
{reconnect=none, interval=0}, channel=/meta/connect, id=24, error=401::Authentication invalid, successful=false}]&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO &amp;#93;&lt;/span&gt; 2021-03-17 13:34:28,769 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-26 &amp;#93;&lt;/span&gt; - Restarting on unexpected disconnect from Salesforce...&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:34:28,769 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-26 &amp;#93;&lt;/span&gt; - Waiting to disconnect...&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:34:28,770 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-32 &amp;#93;&lt;/span&gt; - &lt;span class=&quot;error&quot;&gt;&amp;#91;CHANNEL:META_CONNECT&amp;#93;&lt;/span&gt;: {clientId=&lt;span class=&quot;error&quot;&gt;&amp;#91;--------redacted--------&amp;#93;&lt;/span&gt;, advice={reconnect=none, interval=0}
&lt;p&gt;, channel=/meta/connect, id=24, error=401::Authentication invalid, successful=false}&lt;span class=&quot;error&quot;&gt;&amp;#91;WARN &amp;#93;&lt;/span&gt; 2021-03-17 13:34:28,771 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-32 &amp;#93;&lt;/span&gt; - Connect failure: {clientId=&lt;span class=&quot;error&quot;&gt;&amp;#91;--------redacted--------&amp;#93;&lt;/span&gt;, advice=&lt;/p&gt;
{reconnect=none, interval=0}
&lt;p&gt;, channel=/meta/connect, id=24, error=401::Authentication invalid, successful=false}&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:34:33,769 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-26 &amp;#93;&lt;/span&gt; - Pausing for 0 msecs before restart attempt&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:34:33,770 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-26 &amp;#93;&lt;/span&gt; - Stopped the helper and destroyed the client&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:34:33,862 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$5 &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-30 &amp;#93;&lt;/span&gt; - Received messages [{ext={sfdc=&lt;/p&gt;
{failureReason=401::Authentication invalid}
&lt;p&gt;, replay=true, payload.format=true}, advice=&lt;/p&gt;
{reconnect=none}, channel=/meta/handshake, id=25, error=403::Handshake denied, successful=false}]&lt;span class=&quot;error&quot;&gt;&amp;#91;DEBUG&amp;#93;&lt;/span&gt; 2021-03-17 13:34:33,863 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-30 &amp;#93;&lt;/span&gt; - &lt;span class=&quot;error&quot;&gt;&amp;#91;CHANNEL:META_HANDSHAKE&amp;#93;&lt;/span&gt;: {ext={sfdc={failureReason=401::Authentication invalid}, replay=true, payload.format=true}, advice={reconnect=none}
&lt;p&gt;, channel=/meta/handshake, id=25, error=403::Handshake denied, successful=false}&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;WARN &amp;#93;&lt;/span&gt; 2021-03-17 13:34:33,863 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-30 &amp;#93;&lt;/span&gt; - Handshake failure: {ext={sfdc=&lt;/p&gt;
{failureReason=401::Authentication invalid}
&lt;p&gt;, replay=true, payload.format=true}, advice=&lt;/p&gt;
{reconnect=none}
&lt;p&gt;, channel=/meta/handshake, id=25, error=403::Handshake denied, successful=false}&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO &amp;#93;&lt;/span&gt; 2021-03-17 13:34:33,863 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-30 &amp;#93;&lt;/span&gt; - Cleaning session (logout) from SalesforceSession before restarting client&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO &amp;#93;&lt;/span&gt; 2021-03-17 13:34:33,867 org.cometd.bayeux.client.ClientSession &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-30 &amp;#93;&lt;/span&gt; - Exception while invoking listener org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$1@7574cf75java.lang.NullPointerException: null    at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$1.onMessage(SubscriptionHelper.java:148)    at org.cometd.common.AbstractClientSession$AbstractSessionChannel.notifyOnMessage(AbstractClientSession.java:583)    at org.cometd.common.AbstractClientSession$AbstractSessionChannel.notifyMessageListeners(AbstractClientSession.java:568)    at org.cometd.common.AbstractClientSession.notifyListeners(AbstractClientSession.java:308)    at org.cometd.common.AbstractClientSession.lambda$receive$4(AbstractClientSession.java:269)    at org.cometd.bayeux.Promise$2.succeed(Promise.java:103)    at org.cometd.common.AsyncFoldLeft$AbstractLoop.run(AsyncFoldLeft.java:199)    at org.cometd.common.AsyncFoldLeft.run(AsyncFoldLeft.java:93)    at org.cometd.common.AbstractClientSession.extendIncoming(AbstractClientSession.java:103)    at org.cometd.common.AbstractClientSession.receive(AbstractClientSession.java:263)    at org.cometd.client.BayeuxClient.failHandshake(BayeuxClient.java:721)    at org.cometd.client.BayeuxClient.processHandshake(BayeuxClient.java:707)    at org.cometd.client.BayeuxClient.processMessages(BayeuxClient.java:615)    at org.cometd.client.BayeuxClient.access$2000(BayeuxClient.java:101)    at org.cometd.client.BayeuxClient$MessageTransportListener.onMessages(BayeuxClient.java:1260)    at org.cometd.client.transport.LongPollingTransport$2.onComplete(LongPollingTransport.java:240)    at org.eclipse.jetty.client.ResponseNotifier.notifyComplete(ResponseNotifier.java:218)    at org.eclipse.jetty.client.ResponseNotifier.notifyComplete(ResponseNotifier.java:210)    at org.eclipse.jetty.client.HttpReceiver.terminateResponse(HttpReceiver.java:481)    at org.eclipse.jetty.client.HttpReceiver.terminateResponse(HttpReceiver.java:461)    at org.eclipse.jetty.client.HttpReceiver.responseSuccess(HttpReceiver.java:424)    at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.messageComplete(HttpReceiverOverHTTP.java:365)    at org.eclipse.jetty.http.HttpParser.handleContentMessage(HttpParser.java:585)    at org.eclipse.jetty.http.HttpParser.parseContent(HttpParser.java:1702)    at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:1531)    at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.parse(HttpReceiverOverHTTP.java:204)    at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.process(HttpReceiverOverHTTP.java:144)    at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.receive(HttpReceiverOverHTTP.java:79)    at org.eclipse.jetty.client.http.HttpChannelOverHTTP.receive(HttpChannelOverHTTP.java:131)    at org.eclipse.jetty.client.http.HttpConnectionOverHTTP.onFillable(HttpConnectionOverHTTP.java:169)    at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)    at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)    at org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:540)    at org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:395)    at org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:161)    at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)    at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)    at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:336)    at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:313)    at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:171)    at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:129)    at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:375)    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:773)    at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:905)    at java.base/java.lang.Thread.run(Thread.java:834)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; 2021-03-17 13:36:23,773 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-26 &amp;#93;&lt;/span&gt; - Error restarting: Exception during HANDSHAKE: 401::Authentication invalidorg.apache.camel.CamelException: Exception during HANDSHAKE: 401::Authentication invalid    at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.connect(SubscriptionHelper.java:223)    at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.doStart(SubscriptionHelper.java:212)    at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.performClientRestart(SubscriptionHelper.java:304)    at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.access$1000(SubscriptionHelper.java:60)    at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$4.run(SubscriptionHelper.java:249)    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:773)    at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:905)    at java.base/java.lang.Thread.run(Thread.java:834)Caused by: org.apache.camel.component.salesforce.api.SalesforceException: 401::Authentication invalid    at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.getFailure(SubscriptionHelper.java:340)    at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.access$300(SubscriptionHelper.java:60)    at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$1.onMessage(SubscriptionHelper.java:132)    at org.cometd.common.AbstractClientSession$AbstractSessionChannel.notifyOnMessage(AbstractClientSession.java:583)    at org.cometd.common.AbstractClientSession$AbstractSessionChannel.notifyMessageListeners(AbstractClientSession.java:568)    at org.cometd.common.AbstractClientSession.notifyListeners(AbstractClientSession.java:308)    at org.cometd.common.AbstractClientSession.lambda$receive$4(AbstractClientSession.java:269)    at org.cometd.bayeux.Promise$2.succeed(Promise.java:103)    at org.cometd.common.AsyncFoldLeft$AbstractLoop.run(AsyncFoldLeft.java:199)    at org.cometd.common.AsyncFoldLeft.run(AsyncFoldLeft.java:93)    at org.cometd.common.AbstractClientSession.extendIncoming(AbstractClientSession.java:103)    at org.cometd.common.AbstractClientSession.receive(AbstractClientSession.java:263)    at org.cometd.client.BayeuxClient.failHandshake(BayeuxClient.java:721)    at org.cometd.client.BayeuxClient.processHandshake(BayeuxClient.java:707)    at org.cometd.client.BayeuxClient.processMessages(BayeuxClient.java:615)    at org.cometd.client.BayeuxClient.access$2000(BayeuxClient.java:101)    at org.cometd.client.BayeuxClient$MessageTransportListener.onMessages(BayeuxClient.java:1260)    at org.cometd.client.transport.LongPollingTransport$2.onComplete(LongPollingTransport.java:240)    at org.eclipse.jetty.client.ResponseNotifier.notifyComplete(ResponseNotifier.java:218)    at org.eclipse.jetty.client.ResponseNotifier.notifyComplete(ResponseNotifier.java:210)    at org.eclipse.jetty.client.HttpReceiver.terminateResponse(HttpReceiver.java:481)    at org.eclipse.jetty.client.HttpReceiver.terminateResponse(HttpReceiver.java:461)    at org.eclipse.jetty.client.HttpReceiver.responseSuccess(HttpReceiver.java:424)    at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.messageComplete(HttpReceiverOverHTTP.java:365)    at org.eclipse.jetty.http.HttpParser.handleContentMessage(HttpParser.java:585)    at org.eclipse.jetty.http.HttpParser.parseContent(HttpParser.java:1702)    at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:1531)    at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.parse(HttpReceiverOverHTTP.java:204)    at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.process(HttpReceiverOverHTTP.java:144)    at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.receive(HttpReceiverOverHTTP.java:79)    at org.eclipse.jetty.client.http.HttpChannelOverHTTP.receive(HttpChannelOverHTTP.java:131)    at org.eclipse.jetty.client.http.HttpConnectionOverHTTP.onFillable(HttpConnectionOverHTTP.java:169)    at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)    at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)    at org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:540)    at org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:395)    at org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:161)    at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)    at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)    at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:336)    at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:313)    at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:171)    at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:129)    at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:375)    ... 3 common frames omitted&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; 2021-03-17 13:36:23,774 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-26 &amp;#93;&lt;/span&gt; - Failed to restart after pausing for 0 msecs&lt;/p&gt;</description>
                <environment>&lt;p&gt;Running in a spring-boot (v2.1.18.RELEASE) app in a linux container deployed to openshift 3.11&lt;/p&gt;</environment>
        <key id="13366110">CAMEL-16370</key>
            <summary>Camel Salesforce component unable to reconnect after disconnect from Salesforce</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jasonholmberg">Jason</reporter>
                        <labels>
                    </labels>
                <created>Thu, 18 Mar 2021 15:12:22 +0000</created>
                <updated>Sun, 14 Nov 2021 09:02:38 +0000</updated>
                            <resolved>Sun, 14 Nov 2021 09:02:38 +0000</resolved>
                                    <version>3.8.0</version>
                    <version>3.11.0</version>
                                    <fixVersion>3.14.0</fixVersion>
                                    <component>camel-salesforce</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17305991" author="davsclaus" created="Mon, 22 Mar 2021 08:36:24 +0000"  >&lt;p&gt;It seems like you get a 401 and 403 auth error from Salesforce.&lt;/p&gt;

&lt;p&gt;You are welcome to try with Camel 3.9.0 when its released in a little while.&lt;/p&gt;</comment>
                            <comment id="17307121" author="jasonholmberg" created="Tue, 23 Mar 2021 14:28:00 +0000"  >&lt;p&gt;This works in in Camel 2.23.1 and auth only fails when a forced restart of the connection occurs. &lt;/p&gt;</comment>
                            <comment id="17307132" author="davsclaus" created="Tue, 23 Mar 2021 14:36:29 +0000"  >&lt;p&gt;So you are saying a very old Camel 2.23.1 works for you. But when using Camel 3.8.0 it does not&lt;/p&gt;</comment>
                            <comment id="17307407" author="jasonholmberg" created="Tue, 23 Mar 2021 20:30:08 +0000"  >&lt;p&gt;Yes, that is correct.&lt;/p&gt;</comment>
                            <comment id="17307833" author="jasonholmberg" created="Wed, 24 Mar 2021 13:39:33 +0000"  >&lt;p&gt;Yes, pre 3.x versions seem to work fine.  I have not done exhaustive testing on all 3.x version. The 3.x version authenticate correctly into Salesforce and work fine up until This is logged:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO &amp;#93;&lt;/span&gt; 2021-03-17 13:34:28,769 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper &lt;span class=&quot;error&quot;&gt;&amp;#91;SalesforceHttpClient@60c73e58-26 &amp;#93;&lt;/span&gt; - Restarting on unexpected disconnect from Salesforce...&lt;/p&gt;

&lt;p&gt;At that point the 3.x versions do not seem to be able to renegotiate a connection.  Under the same circumstances, the old versions like 2.23.1 are able to renegotiate the connection.&lt;/p&gt;</comment>
                            <comment id="17312143" author="davsclaus" created="Wed, 31 Mar 2021 07:26:06 +0000"  >&lt;p&gt;Can you try with Camel 3.9.0 ?&lt;/p&gt;</comment>
                            <comment id="17314847" author="jasonholmberg" created="Mon, 5 Apr 2021 13:12:11 +0000"  >&lt;p&gt;I will try with Camel 3.9.0 and report back with the results.&lt;/p&gt;</comment>
                            <comment id="17325258" author="davsclaus" created="Mon, 19 Apr 2021 18:59:12 +0000"  >&lt;p&gt;In the top comment above with the logging output, can you tell us which Camel version that is&lt;/p&gt;</comment>
                            <comment id="17343276" author="jasonholmberg" created="Wed, 12 May 2021 14:15:23 +0000"  >&lt;p&gt;I&apos;m pretty sure it is v2.23.1&lt;/p&gt;</comment>
                            <comment id="17358404" author="davsclaus" created="Mon, 7 Jun 2021 07:35:40 +0000"  >&lt;p&gt;There is a new 3.10.0 release did you try with that&lt;/p&gt;</comment>
                            <comment id="17360134" author="an.scaldaferri@gmail.com" created="Wed, 9 Jun 2021 14:51:24 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;we have same issue, but we use camel-quarkus-salesforce component (version 1.8.0). After the handshake we receive this error:&lt;/p&gt;

&lt;p&gt;Exception while invoking listener org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$1@7abb1619: java.lang.NullPointerException&lt;/p&gt;</comment>
                            <comment id="17372026" author="an.scaldaferri@gmail.com" created="Wed, 30 Jun 2021 14:34:42 +0000"  >&lt;p&gt;We have the same issue with the new&#160;release 3.10.0.&lt;/p&gt;</comment>
                            <comment id="17372059" author="davsclaus" created="Wed, 30 Jun 2021 15:00:16 +0000"  >&lt;p&gt;Do you mean 3.11.0 as this was just released&lt;/p&gt;</comment>
                            <comment id="17374849" author="an.scaldaferri@gmail.com" created="Mon, 5 Jul 2021 13:50:18 +0000"  >&lt;p&gt;We have the same issue with the new&#160;release 3.11.0.&lt;br/&gt;
&#160;&lt;/p&gt;</comment>
                            <comment id="17392232" author="an.scaldaferri@gmail.com" created="Tue, 3 Aug 2021 10:35:46 +0000"  >&lt;p&gt;We have found a workaround, use one user for each subscription to Salesforce.&lt;/p&gt;


&lt;p&gt;We have verified that the error is returned if the same username is used for multiple applications/subscriptions (e.g. the error occurred when application A uses user AA, application B uses user AA to connect to the other Salesforce Event).&lt;br/&gt;
We have not checked whether the application scales horizontally and the error is returned, but in our case this is not a requirement.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17431191" author="hemangajmera" created="Wed, 20 Oct 2021 12:46:00 +0000"  >&lt;p&gt;Hi&lt;/p&gt;

&lt;p&gt;&#160;&#160; I am user camel version 3.11.0 and facing same error. Here is the relevant section of the log...&lt;/p&gt;

&lt;p&gt;```&lt;/p&gt;

&lt;p&gt;2021-10-20 11:46:51,697 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.performClientRestart - Restarting on unexpected disconnect from Salesforce... &lt;br/&gt;
2021-10-20 11:46:51,699 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.onMessage - Connect failure: {clientId=1ah1n3glbijn0qkia6xuwk25k15d, advice=&lt;/p&gt;
{reconnect=none, interval=0}
&lt;p&gt;, channel=/meta/connect, id=99, error=401::Authentication invalid, successful=false} &lt;br/&gt;
2021-10-20 11:46:51,798 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.onMessage - Handshake failure: {ext={sfdc=&lt;/p&gt;
{failureReason=401::Authentication invalid}
&lt;p&gt;, replay=true, payload.format=true}, advice={reconnect=none}, channel=/meta/handshake, id=100, error=403::Handshake denied, successful=false} &lt;br/&gt;
2021-10-20 11:46:51,799 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.onMessage - Cleaning session (logout) from SalesforceSession before restarting client &lt;br/&gt;
2021-10-20 11:46:51,902 org.cometd.bayeux.client.ClientSession.notifyOnMessage - Exception while invoking listener org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$1@1e2d0dfa &lt;br/&gt;
java.lang.NullPointerException: null &lt;br/&gt;
 at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$1.onMessage(SubscriptionHelper.java:148) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession$AbstractSessionChannel.notifyOnMessage(AbstractClientSession.java:583) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession$AbstractSessionChannel.notifyMessageListeners(AbstractClientSession.java:568) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession.notifyListeners(AbstractClientSession.java:308) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession.lambda$receive$4(AbstractClientSession.java:269) &lt;br/&gt;
 at org.cometd.bayeux.Promise$2.succeed(Promise.java:103) &lt;br/&gt;
 at org.cometd.common.AsyncFoldLeft$AbstractLoop.run(AsyncFoldLeft.java:199) &lt;br/&gt;
 at org.cometd.common.AsyncFoldLeft.run(AsyncFoldLeft.java:93) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession.extendIncoming(AbstractClientSession.java:103) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession.receive(AbstractClientSession.java:263) &lt;br/&gt;
 at org.cometd.client.BayeuxClient.failHandshake(BayeuxClient.java:721) &lt;br/&gt;
 at org.cometd.client.BayeuxClient.processHandshake(BayeuxClient.java:707) &lt;br/&gt;
 at org.cometd.client.BayeuxClient.processMessages(BayeuxClient.java:615) &lt;br/&gt;
 at org.cometd.client.BayeuxClient.access$2000(BayeuxClient.java:101) &lt;br/&gt;
 at org.cometd.client.BayeuxClient$MessageTransportListener.onMessages(BayeuxClient.java:1260) &lt;br/&gt;
 at org.cometd.client.transport.LongPollingTransport$2.onComplete(LongPollingTransport.java:240) &lt;br/&gt;
 at org.eclipse.jetty.client.ResponseNotifier.notifyComplete(ResponseNotifier.java:218) &lt;br/&gt;
 at org.eclipse.jetty.client.ResponseNotifier.notifyComplete(ResponseNotifier.java:210) &lt;br/&gt;
 at org.eclipse.jetty.client.HttpReceiver.terminateResponse(HttpReceiver.java:481) &lt;br/&gt;
 at org.eclipse.jetty.client.HttpReceiver.terminateResponse(HttpReceiver.java:461) &lt;br/&gt;
 at org.eclipse.jetty.client.HttpReceiver.responseSuccess(HttpReceiver.java:424) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.messageComplete(HttpReceiverOverHTTP.java:365) &lt;br/&gt;
 at org.eclipse.jetty.http.HttpParser.handleContentMessage(HttpParser.java:591) &lt;br/&gt;
 at org.eclipse.jetty.http.HttpParser.parseContent(HttpParser.java:1716) &lt;br/&gt;
 at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:1545) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.parse(HttpReceiverOverHTTP.java:204) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.process(HttpReceiverOverHTTP.java:144) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.receive(HttpReceiverOverHTTP.java:79) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpChannelOverHTTP.receive(HttpChannelOverHTTP.java:131) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpConnectionOverHTTP.onFillable(HttpConnectionOverHTTP.java:172) &lt;br/&gt;
 at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) &lt;br/&gt;
 at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) &lt;br/&gt;
 at org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:555) &lt;br/&gt;
 at org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:410) &lt;br/&gt;
 at org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:164) &lt;br/&gt;
 at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) &lt;br/&gt;
 at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:383) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:882) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1036) &lt;br/&gt;
 at java.base/java.lang.Thread.run(Unknown Source) &lt;br/&gt;
2021-10-20 11:48:41,799 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.performClientRestart - Error restarting: Exception during HANDSHAKE: 401::Authentication invalid &lt;br/&gt;
org.apache.camel.CamelException: Exception during HANDSHAKE: 401::Authentication invalid &lt;br/&gt;
 at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.connect(SubscriptionHelper.java:223) &lt;br/&gt;
 at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.doStart(SubscriptionHelper.java:212) &lt;br/&gt;
 at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.performClientRestart(SubscriptionHelper.java:304) &lt;br/&gt;
 at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.access$1000(SubscriptionHelper.java:60) &lt;br/&gt;
 at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$4.run(SubscriptionHelper.java:249) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:882) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1036) &lt;br/&gt;
 at java.base/java.lang.Thread.run(Unknown Source) &lt;br/&gt;
Caused by: org.apache.camel.component.salesforce.api.SalesforceException: 401::Authentication invalid &lt;br/&gt;
 at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.getFailure(SubscriptionHelper.java:340) &lt;br/&gt;
 at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.access$300(SubscriptionHelper.java:60) &lt;br/&gt;
 at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$1.onMessage(SubscriptionHelper.java:132) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession$AbstractSessionChannel.notifyOnMessage(AbstractClientSession.java:583) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession$AbstractSessionChannel.notifyMessageListeners(AbstractClientSession.java:568) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession.notifyListeners(AbstractClientSession.java:308) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession.lambda$receive$4(AbstractClientSession.java:269) &lt;br/&gt;
 at org.cometd.bayeux.Promise$2.succeed(Promise.java:103) &lt;br/&gt;
 at org.cometd.common.AsyncFoldLeft$AbstractLoop.run(AsyncFoldLeft.java:199) &lt;br/&gt;
 at org.cometd.common.AsyncFoldLeft.run(AsyncFoldLeft.java:93) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession.extendIncoming(AbstractClientSession.java:103) &lt;br/&gt;
 at org.cometd.common.AbstractClientSession.receive(AbstractClientSession.java:263) &lt;br/&gt;
 at org.cometd.client.BayeuxClient.failHandshake(BayeuxClient.java:721) &lt;br/&gt;
 at org.cometd.client.BayeuxClient.processHandshake(BayeuxClient.java:707) &lt;br/&gt;
 at org.cometd.client.BayeuxClient.processMessages(BayeuxClient.java:615) &lt;br/&gt;
 at org.cometd.client.BayeuxClient.access$2000(BayeuxClient.java:101) &lt;br/&gt;
 at org.cometd.client.BayeuxClient$MessageTransportListener.onMessages(BayeuxClient.java:1260) &lt;br/&gt;
 at org.cometd.client.transport.LongPollingTransport$2.onComplete(LongPollingTransport.java:240) &lt;br/&gt;
 at org.eclipse.jetty.client.ResponseNotifier.notifyComplete(ResponseNotifier.java:218) &lt;br/&gt;
 at org.eclipse.jetty.client.ResponseNotifier.notifyComplete(ResponseNotifier.java:210) &lt;br/&gt;
 at org.eclipse.jetty.client.HttpReceiver.terminateResponse(HttpReceiver.java:481) &lt;br/&gt;
 at org.eclipse.jetty.client.HttpReceiver.terminateResponse(HttpReceiver.java:461) &lt;br/&gt;
 at org.eclipse.jetty.client.HttpReceiver.responseSuccess(HttpReceiver.java:424) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.messageComplete(HttpReceiverOverHTTP.java:365) &lt;br/&gt;
 at org.eclipse.jetty.http.HttpParser.handleContentMessage(HttpParser.java:591) &lt;br/&gt;
 at org.eclipse.jetty.http.HttpParser.parseContent(HttpParser.java:1716) &lt;br/&gt;
 at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:1545) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.parse(HttpReceiverOverHTTP.java:204) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.process(HttpReceiverOverHTTP.java:144) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpReceiverOverHTTP.receive(HttpReceiverOverHTTP.java:79) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpChannelOverHTTP.receive(HttpChannelOverHTTP.java:131) &lt;br/&gt;
 at org.eclipse.jetty.client.http.HttpConnectionOverHTTP.onFillable(HttpConnectionOverHTTP.java:172) &lt;br/&gt;
 at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311) &lt;br/&gt;
 at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) &lt;br/&gt;
 at org.eclipse.jetty.io.ssl.SslConnection$DecryptedEndPoint.onFillable(SslConnection.java:555) &lt;br/&gt;
 at org.eclipse.jetty.io.ssl.SslConnection.onFillable(SslConnection.java:410) &lt;br/&gt;
 at org.eclipse.jetty.io.ssl.SslConnection$2.succeeded(SslConnection.java:164) &lt;br/&gt;
 at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105) &lt;br/&gt;
 at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131) &lt;br/&gt;
 at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:383) &lt;br/&gt;
 ... 3 common frames omitted &lt;br/&gt;
2021-10-20 11:48:41,801 org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.performClientRestart - Failed to restart after pausing for 0 msecs&lt;/p&gt;

&lt;p&gt;```&lt;/p&gt;</comment>
                            <comment id="17431194" author="hemangajmera" created="Wed, 20 Oct 2021 12:48:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;, can you please change the affected version to 3.11.0.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I don&apos;t have way to reproduce it, but restart makes it works fine with the same connection parameters.&lt;/p&gt;</comment>
                            <comment id="17431198" author="hemangajmera" created="Wed, 20 Oct 2021 12:51:27 +0000"  >&lt;p&gt;Other related issues are &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12871&quot; title=&quot;Camel-salesforce component drops the streaming topic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12871&quot;&gt;&lt;del&gt;CAMEL-12871&lt;/del&gt;&lt;/a&gt;&#160;and &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12484&quot; title=&quot;Camel-salesforce component does not try to reconnect on specific error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12484&quot;&gt;&lt;del&gt;CAMEL-12484&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17433669" author="vsedykh" created="Mon, 25 Oct 2021 10:16:03 +0000"  >&lt;p&gt;Hello!&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I also faced the same issue on the 3.11 camel version.&lt;/p&gt;

&lt;p&gt;In most cases, restart works fine, but sometimes it failed and always in logs I see the same error:&lt;br/&gt;
&lt;b&gt;403::Handshake denied&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;When such an error happens, for some reason session is null and logout fails with NPE.&lt;/p&gt;

&lt;p&gt;Maybe it makes sense to add a check for null for a session before calling logout.&lt;/p&gt;

&lt;p&gt;Hope it helps.&lt;/p&gt;</comment>
                            <comment id="17433673" author="davsclaus" created="Mon, 25 Oct 2021 10:23:03 +0000"  >&lt;p&gt;Yeah avoiding the NPE makes sense. You are welcome to fix this by attaching a path to this JIRA or send a github PR&lt;/p&gt;</comment>
                            <comment id="17434730" author="vsedykh" created="Wed, 27 Oct 2021 08:16:13 +0000"  >&lt;p&gt;Sure I will, but first I wanted to make sure that checking for null resolves the problem. Unfortunattely not. NPE is fixed but there is another error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2021-10-27T07:52:11.307+0000 [SalesforceHttpClient@7e8279e5-22] WARN [,] o.a.c.c.s.i.s.SubscriptionHelper - Handshake failure: {ext={sfdc={failureReason=401::Authentication invalid}, replay=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, payload.format=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;}, advice={reconnect=none}, channel=/meta/handshake, id=784, error=403::Handshake denied, successful=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;}2021-10-27T07:52:11.309+0000 [SalesforceHttpClient@7e8279e5-22] INFO [,] o.a.c.c.s.i.s.SubscriptionHelper - Cleaning session (logout) from SalesforceSession before restarting client2021-10-27T07:52:11.327+0000 [SalesforceHttpClient@7e8279e5-22] INFO [,] o.a.c.c.s.i.s.SubscriptionHelper - Cleaning session is not possible, session is null2021-10-27T08:00:15.464+0000 [SalesforceHttpClient@7e8279e5-25] ERROR [,] o.a.c.c.s.i.s.SubscriptionHelper - Error restarting: Exception during HANDSHAKE: 401::Authentication invalidorg.apache.camel.CamelException: Exception during HANDSHAKE: 401::Authentication invalidat org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.connect(SubscriptionHelper.java:227)at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.doStart(SubscriptionHelper.java:216)at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.performClientRestart(SubscriptionHelper.java:308)at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.access$1000(SubscriptionHelper.java:60)at org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper$4.run(SubscriptionHelper.java:253)at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:882)at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1036)at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:829)Caused by: org.apache.camel.component.salesforce.api.SalesforceException: 401::Authentication invalidat org.apache.camel.component.salesforce.internal.streaming.SubscriptionHelper.getFailure(SubscriptionHelper.java:344)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I&apos;m not sure yet how to resolve such an issue. I would be grateful for any thoughts.&lt;/p&gt;</comment>
                            <comment id="17434738" author="davsclaus" created="Wed, 27 Oct 2021 08:27:02 +0000"  >&lt;p&gt;That new error is better than a NPE as it better tells that real problem, so its a great step on the way&lt;/p&gt;</comment>
                            <comment id="17443158" author="jeremyross" created="Sat, 13 Nov 2021 18:02:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jasonholmberg&quot; class=&quot;user-hover&quot; rel=&quot;jasonholmberg&quot;&gt;jasonholmberg&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=an.scaldaferri%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;an.scaldaferri@gmail.com&quot;&gt;an.scaldaferri@gmail.com&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hemangajmera&quot; class=&quot;user-hover&quot; rel=&quot;hemangajmera&quot;&gt;hemangajmera&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vsedykh&quot; class=&quot;user-hover&quot; rel=&quot;vsedykh&quot;&gt;vsedykh&lt;/a&gt; Just pushed a commit for this. Please test with 3.14.0-SNAPSHOT and let me know if this helps.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0oxts:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>