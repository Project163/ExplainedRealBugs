<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:51:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-17446] Trigger start time for Quartz causes confusion with short trigger intervals</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-17446</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;An issue reported on the users list shows that using trigger.repeatInterval=1200 causes the first 2 events to be fired sooner than expected after the scheduler is started.&lt;/p&gt;

&lt;p&gt;This is due to the delay between creating the Quartz Trigger and when the scheduler is started.&lt;/p&gt;

&lt;p&gt;Changing the log message to show the milliseconds in the trigger&apos;s next fire time would be helpful. In addition, it appears counter-intuitive that triggerStartDelay is ignored if positive, as shown in QuartzEndpoint.createTrigger() below:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (getComponent().getScheduler().isStarted() || triggerStartDelay &amp;lt; 0) {
&#160; &#160; triggerBuilder.startAt(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Date(&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis() + triggerStartDelay));
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is this intentional?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13421108">CAMEL-17446</key>
            <summary>Trigger start time for Quartz causes confusion with short trigger intervals</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="klease78">Karen Lease</assignee>
                                    <reporter username="klease78">Karen Lease</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Jan 2022 16:21:42 +0000</created>
                <updated>Fri, 21 Jan 2022 16:52:00 +0000</updated>
                            <resolved>Fri, 21 Jan 2022 16:52:00 +0000</resolved>
                                    <version>3.13.0</version>
                                    <fixVersion>3.15.0</fixVersion>
                                    <component>camel-quartz</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17470151" author="davsclaus" created="Thu, 6 Jan 2022 19:32:05 +0000"  >&lt;p&gt;I think its something that can be added to the documentation, as there will always be &quot;such problem&quot;. A quartz scheduler is not 100% accurate and fires exactly at 1200 millis between. &lt;/p&gt;

&lt;p&gt;Otherwise a big task would be to provisionally create triggers during bootstrap, and then after the scheduler is started, then schedule those provisional triggers to the scheduler. Then that problem is no longer.&lt;/p&gt;</comment>
                            <comment id="17470792" author="klease78" created="Fri, 7 Jan 2022 18:19:57 +0000"  >&lt;p&gt;I&apos;ll look into updating the documentation. It&apos;s mainly an issue with short intervals which are perhaps not that common. In any case, I notice the first run of the trigger takes longer to launch (20 to 30 msec in the test case) than the remaining ones, so the first one always appears to be delayed.&lt;/p&gt;

&lt;p&gt;Regarding the timestamp for the next fire time log, I see it depends on the actual logging implementation used; in the test case which uses log4j it is displaying the msec which helps to understand the issue. I&apos;d suggest forcing the format when constructing the log message.&lt;/p&gt;

&lt;p&gt;But is it normal not to set the triggerStartDelay when it&apos;s positive? The current code will only set it to some time in the past, likely causing several events to be generated immediately when the scheduler is started.&lt;/p&gt;</comment>
                            <comment id="17471303" author="davsclaus" created="Sun, 9 Jan 2022 08:41:50 +0000"  >&lt;p&gt;About the &amp;lt; 0 then see &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-17133&quot; title=&quot;camel-quartz: allow missfire execution for cron triggers&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-17133&quot;&gt;&lt;del&gt;CAMEL-17133&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
That idea is to simulate a &quot;fireNow&quot; by forcing a misfire&lt;/p&gt;</comment>
                            <comment id="17471305" author="davsclaus" created="Sun, 9 Jan 2022 08:44:48 +0000"  >&lt;p&gt;&amp;gt; Regarding the timestamp for the next fire time log, I see it depends on the actual logging implementation used; in the test case which uses log4j it is displaying the msec which helps to understand the issue. I&apos;d suggest forcing the format when constructing the log message.&lt;/p&gt;

&lt;p&gt;Yeah that is a good idea&lt;/p&gt;</comment>
                            <comment id="17472219" author="klease78" created="Mon, 10 Jan 2022 18:34:51 +0000"  >&lt;p&gt;&amp;gt;That idea is to simulate a &quot;fireNow&quot; by forcing a misfire&lt;/p&gt;

&lt;p&gt;Yes, I see that, and I see the documentation of the parameter related to the scheduler being started is consistent with the code.&lt;/p&gt;

&lt;p&gt;But Quartz allows to set an explicit start and end time on a simple trigger, and this isn&apos;t possible in Camel. That could be done with trigger.startTime and trigger.endTime properties, where startTime would then override the triggerStartDelay and be applied even when the scheduler is not yet started.&lt;/p&gt;

&lt;p&gt;For now I submitted a PR for the log message and the documentation for triggerParameters.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13408482">CAMEL-17133</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 44 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ybhs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>