<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:38:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-14126] stax component can cause infinite loop of file component</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-14126</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I discovered a situation where the stax component causes an infinite loop of the file component in case of invalid UTF-8 characters in the file. I attached a sample project with the most simplistic route that shows the behaviour:  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12984664/12984664_staxSample.zip&quot; title=&quot;staxSample.zip attached to CAMEL-14126&quot;&gt;staxSample.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;The input file containes invalid UTF-8 characters. The route definition is as following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
from(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;//inbound?moveFailed=.failed&quot;&lt;/span&gt;)
&lt;/span&gt;    .split(stax(Product.class))
        .log(&lt;span class=&quot;code-quote&quot;&gt;&quot;${body.name}&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I get the exceptions&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Error renaming file from C:\Users\...\inbound\products.xml to inbound\.failed\products.xml&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;and&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;[javax.xml.stream.XMLStreamException: ParseError at &lt;span class=&quot;error&quot;&gt;&amp;#91;row,col&amp;#93;&lt;/span&gt;:&lt;span class=&quot;error&quot;&gt;&amp;#91;4,29&amp;#93;&lt;/span&gt;&lt;br/&gt;
Message: Ung&#252;ltiges Byte 2 von 3-Byte-UTF-8-Sequenz.]&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;When I marshal the whole document at once I don&apos;t get the first exception. When I use the splitter with tokenizeXML I won&apos;t get any of the exceptions.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;The sample contains another example where a combination of Splitter with aggregation + seda route called by inOut and an exception in the seda route causes the infinite loop too (Message is &quot;error renaming file&quot; as above). &lt;/p&gt;

&lt;p&gt;I could figure out that the issue doesn&apos;t occur if at least one of the following changes:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;the Exception is thrown in the &quot;file&quot;-route instead of in the seda route&lt;/li&gt;
	&lt;li&gt;the aggregation returns the newExchange if the oldExchange is null instead of creating a new DefaultExchange&lt;/li&gt;
	&lt;li&gt;&quot;to&quot; instead of &quot;inOut&quot; is used to call the seda endpoint&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13265834">CAMEL-14126</key>
            <summary>stax component can cause infinite loop of file component</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="tomahi">tomahi</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Nov 2019 20:55:03 +0000</created>
                <updated>Wed, 13 Nov 2019 05:05:09 +0000</updated>
                            <resolved>Wed, 13 Nov 2019 05:05:09 +0000</resolved>
                                    <version>2.24.2</version>
                                    <fixVersion>3.0.0</fixVersion>
                                    <component>camel-stax</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16972256" author="davsclaus" created="Tue, 12 Nov 2019 10:22:15 +0000"  >&lt;p&gt;The first one smells like a problem with windows file system where a file input stream is not closed, then it can&apos;t move the file&lt;/p&gt;</comment>
                            <comment id="16972257" author="davsclaus" created="Tue, 12 Nov 2019 10:23:02 +0000"  >&lt;p&gt;And if you do custom aggregation strategy then do not create a new exchange, but use the existing ones!&lt;/p&gt;</comment>
                            <comment id="16973013" author="davsclaus" created="Wed, 13 Nov 2019 04:58:19 +0000"  >&lt;p&gt;Okay so this works on linux on also on master branch. The reader is getting closed when there is an invalid file&lt;/p&gt;</comment>
                            <comment id="16973018" author="davsclaus" created="Wed, 13 Nov 2019 05:05:09 +0000"  >&lt;p&gt;Added a explicit close. You can work around this on 2.x, by adding a convertBodyTo(byte[].class) before calling the splitter.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12984664" name="staxSample.zip" size="60057" author="tomahi" created="Fri, 1 Nov 2019 20:53:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 1 week ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z086r4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>