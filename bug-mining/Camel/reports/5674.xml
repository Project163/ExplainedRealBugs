<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:46:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-16016] Encoding special characters via UnsafeUriCharactersEncoder does not work in all cases</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-16016</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;we have the following FTP password:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; password= &lt;span class=&quot;code-quote&quot;&gt;&quot;%j#7%c6i&quot;&lt;/span&gt;;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;when encoded with camel (&lt;b&gt;we are using RAW()&lt;/b&gt;) this results in a gibberish string with &amp;lt;?&amp;gt; (unprintable characters)&lt;/p&gt;

&lt;p&gt;==&amp;gt; expected output:&lt;/p&gt;

&lt;p&gt;%25j%237%25c6i&lt;/p&gt;

&lt;p&gt;Sample test demonstrating the bug / reproducer:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Test
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testWrongEncoding(){
   &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; password= &lt;span class=&quot;code-quote&quot;&gt;&quot;%j#7%c6i&quot;&lt;/span&gt;;
   &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; result = UnsafeUriCharactersEncoder.encode(password);
   &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; expected = &lt;span class=&quot;code-quote&quot;&gt;&quot;%25j%237%25c6i&quot;&lt;/span&gt;;
   &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;expected -&amp;gt;  &quot;&lt;/span&gt;+expected);
   &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;vs&quot;&lt;/span&gt;);
   &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(result);
   &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!result.equals(expected)){
      &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;not the same , no no &quot;&lt;/span&gt;);
   }

}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13351499">CAMEL-16016</key>
            <summary>Encoding special characters via UnsafeUriCharactersEncoder does not work in all cases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10004">Not A Bug</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="koszta">Pavel Kostelnik</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Jan 2021 15:09:35 +0000</created>
                <updated>Thu, 25 Mar 2021 12:34:55 +0000</updated>
                            <resolved>Thu, 25 Mar 2021 06:25:24 +0000</resolved>
                                    <version>2.20.4</version>
                    <version>3.8.0</version>
                                    <fixVersion>3.8.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17264589" author="chardahe@redhat.com" created="Thu, 14 Jan 2021 04:58:21 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=koszta&quot; class=&quot;user-hover&quot; rel=&quot;koszta&quot;&gt;koszta&lt;/a&gt;&#160;for reporting it, I&apos;ll look into it&lt;/p&gt;</comment>
                            <comment id="17308412" author="davsclaus" created="Thu, 25 Mar 2021 06:25:09 +0000"  >&lt;p&gt;Its because the password have % which Camel uses to detect if part of the text is already decimal encoded, and it happens that %c6 is then a decimal.&lt;/p&gt;

&lt;p&gt;Because its a password and you want to use as-is, then you should enclose the password in RAW style and encode in raw mode enabled, eg this works&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testWrongEncoding(){
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; password= &lt;span class=&quot;code-quote&quot;&gt;&quot;RAW(%j#7%c6i)&quot;&lt;/span&gt;;
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; result = UnsafeUriCharactersEncoder.encode(password, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        &lt;span class=&quot;code-comment&quot;&gt;// remove RAW
&lt;/span&gt;        result = result.substring(4);
        result = result.substring(0, result.length() - 1);
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; expected = &lt;span class=&quot;code-quote&quot;&gt;&quot;%25j%237%25c6i&quot;&lt;/span&gt;;
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;expected -&amp;gt;  &quot;&lt;/span&gt;+expected);
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;vs&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(result);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!result.equals(expected)){
            &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.err.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;not the same , no no &quot;&lt;/span&gt;);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17308425" author="koszta" created="Thu, 25 Mar 2021 06:43:43 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;&#160;- ok I get your point but the problem originates from us using this in an endpoint URI definition.&lt;/p&gt;

&lt;p&gt;So:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;when using password without RAW in endpoint URI camel complains about invalid characters&lt;/li&gt;
	&lt;li&gt;when we wrap password in RAW in our camel endpoint URI it is encoded to gibberish&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I understand that&#160; by giving this special parameter it is fixed but this would mean we have to manually check for passwords every time and think about this and encode and the password appropriately. If this (&lt;br/&gt;
UnsafeUriCharactersEncoder.encode(password, true);&lt;br/&gt;
) is the definitive solution to the problem is there a reason why it is not used by default for encoding all passwords?&lt;/p&gt;</comment>
                            <comment id="17308614" author="davsclaus" created="Thu, 25 Mar 2021 11:44:31 +0000"  >&lt;p&gt;About gibberish then it sounds like its a display problem - the string value and its bytes should be encoded to US-ASCII so the password ought to be readable.&lt;/p&gt;

&lt;p&gt;Yes you can argue that the %c6 in your password is an unfortunate little but that it does not gets encoded also&lt;br/&gt;
So the only issue at this moment is with password of that combination.&lt;/p&gt;</comment>
                            <comment id="17308631" author="davsclaus" created="Thu, 25 Mar 2021 12:13:38 +0000"  >&lt;p&gt;Here is an unit test that shows your password works fine with camel-ftp&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/commit/d48befa92b991f76d4790a8dae4b9721807db17b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/commit/d48befa92b991f76d4790a8dae4b9721807db17b&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17308632" author="davsclaus" created="Thu, 25 Mar 2021 12:15:18 +0000"  >&lt;p&gt;When endpoints are build Camel does a bunch of stuff, so its not only that single encoder in use. And it may be that you have only tried old Camel 2.x.&lt;/p&gt;</comment>
                            <comment id="17308656" author="koszta" created="Thu, 25 Mar 2021 12:34:55 +0000"  >&lt;p&gt;Thanks for feedback. Yes - our primary problem is on 2.20&lt;/p&gt;

&lt;p&gt;We plan to eventually migrate to 3 in near future so that might take it away since the Junit passes. The reason why I put 3 in affected versions is I noticed that passwords got processed in the same way but there has to be something done differently in 3 since your test does pass.&#160;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13367553">CAMEL-16403</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 33 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0mghc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>