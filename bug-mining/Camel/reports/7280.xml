<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:13:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-22557] camel-as2 - Server-side DecryptingPrivateKey Conflict: Key from first route started is enforced for all subsequent routes on the same serverPortNumber</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-22557</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When configuring multiple inbound AS2 server routes that share the same &lt;tt&gt;serverPortNumber&lt;/tt&gt;, the security configuration from the &lt;b&gt;first route to successfully start&lt;/b&gt; is prioritized and enforced across all routes listening on that port.&lt;/p&gt;

&lt;p&gt;Subsequent routes that attempt to specify a different, distinct &lt;tt&gt;decryptingPrivateKey&lt;/tt&gt; in their configuration will successfully start and attach to the existing server instance, but any inbound encrypted traffic intended for them will fail with a decryption error, as the system is still using the initial route&apos;s private key (my guess).&lt;/p&gt;
&lt;h4&gt;&lt;a name=&quot;TestCaseContext%28AttachedReproducer%29&quot;&gt;&lt;/a&gt;Test Case Context (Attached Reproducer)&lt;/h4&gt;

&lt;p&gt;We can check this behavior by the following unit tests:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;&lt;b&gt;loadSingleAS2Server_outboundAs2Encrypted2_OK&lt;/b&gt; &lt;b&gt;(Successful)&lt;/b&gt;&lt;br/&gt;
A test where &lt;b&gt;only one AS2 server route&lt;/b&gt; is started with a single &lt;tt&gt;decryptingPrivateKey&lt;/tt&gt;. An outbound client message encrypted for this key is successfully decrypted by the server.&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;&lt;b&gt;loadMultipleAS2Server_outboundAs2Encrypted2_throwsException (Failing)&lt;/b&gt;&lt;br/&gt;
A test where &lt;b&gt;two AS2 server routes&lt;/b&gt; are started on the same &lt;tt&gt;serverPortNumber&lt;/tt&gt; (Port 9002), each specifying a different &lt;tt&gt;decryptingPrivateKey&lt;/tt&gt;. The same outbound client message as before, targeting the second route&apos;s URI fails, throwing the following exception:&lt;br/&gt;
&lt;b&gt;org.apache.camel.component.as2.api.exception.AS2DecryptionException: Failed to decrypt data&lt;/b&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;NOTE: both tests are green (I&apos;m not really testing the MDN responses), please check the logs&lt;/p&gt;</description>
                <environment>&lt;p&gt;&lt;b&gt;Camel Version:&lt;/b&gt; &lt;tt&gt;4.10.7&lt;/tt&gt;&lt;br/&gt;
&lt;b&gt;JDK Version:&lt;/b&gt; Java 21&lt;/p&gt;</environment>
        <key id="13631668">CAMEL-22557</key>
            <summary>camel-as2 - Server-side DecryptingPrivateKey Conflict: Key from first route started is enforced for all subsequent routes on the same serverPortNumber</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="brunovg">Bruno Gon&#231;alves</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Oct 2025 22:09:46 +0000</created>
                <updated>Fri, 31 Oct 2025 11:08:26 +0000</updated>
                            <resolved>Fri, 31 Oct 2025 08:49:45 +0000</resolved>
                                    <version>4.10.7</version>
                    <version>4.14.1</version>
                                    <fixVersion>4.16.0</fixVersion>
                                    <component>camel-as2</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="18031465" author="JIRAUSER303582" created="Tue, 21 Oct 2025 15:58:47 +0000"  >&lt;p&gt;Created the following PR: &lt;a href=&quot;https://github.com/apache/camel/pull/19649&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/19649&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="18034347" author="davsclaus" created="Fri, 31 Oct 2025 08:49:45 +0000"  >&lt;p&gt;Thanks for reporting and the PR&lt;/p&gt;</comment>
                            <comment id="18034355" author="JIRAUSER303582" created="Fri, 31 Oct 2025 09:19:03 +0000"  >&lt;p&gt;This is also be part of 4.10.8, right?&lt;/p&gt;</comment>
                            <comment id="18034376" author="davsclaus" created="Fri, 31 Oct 2025 11:08:26 +0000"  >&lt;p&gt;Yes we will backport but we want some feedback first before doing so. End users today that use camel-as2 should not be affected.&lt;/p&gt;

&lt;p&gt;And 4.10.8 would be the very last patch release so if anything is broken etc then we have extra trouble to fix that. So its often better to introduce changes only forward.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13078834" name="inbound-as2-reproducer.tar" size="161280" author="brunovg" created="Wed, 15 Oct 2025 21:52:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1y5yo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>