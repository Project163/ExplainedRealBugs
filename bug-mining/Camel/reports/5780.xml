<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:48:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-16763] camel-sjms - Null JMS Correlation ID using Camel-SJMS Request/Reply with Artemis JMS Client</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-16763</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;It appears that request/reply with Camel-SJMS 3.8.0 is incompatible with Artemis JMS Client. The InOut processor does not properly retrieve the JMSCorrelationID regardless of whether I set the JMSCorrelationID myself or let camel generate one.&lt;/p&gt;

&lt;p&gt;NPE due to the correlationID being null:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
17:47:07,308 | ERROR | r8-simulated-WPS | DefaultErrorHandler &#160; &#160; &#160; &#160; &#160; &#160; &#160; 205 | camel-core-processor | Failed delivery &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (MessageId: 66C3805CB230A74-0000000000000005 on ExchangeId: 66C3805CB230A74-0000000000000005). Exhausted after delivery attempt: 1 caught: java.lang.NullPointerException


Message History (complete message history is disabled)
---------------------------------------------------------------------------------------------------------------------------------------
RouteId&#160; &#160; &#160; &#160; &#160; &#160; &#160; ProcessorId&#160; &#160; &#160; &#160; &#160; Processor&#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; Elapsed (ms)
[8-simulated-WPS &#160; ] [8-simulated-WPS &#160; ] [from[timer:&lt;span class=&quot;code-comment&quot;&gt;//timer8-simulated-WPS?delay=3000&amp;amp;period=500000] &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; &#160; ] [&#160; &#160; &#160; &#160; 27]
&lt;/span&gt;&#160; &#160; &#160; &#160; ...
[8-simulated-WPS &#160; ] [to108 &#160; &#160; &#160; &#160; &#160; &#160; ] [sjms2:wps.v1.capabilities.req?exchangePattern=InOut&amp;amp;requestTimeout=30000&#160; &#160; &#160; ] [ &#160; &#160; &#160; &#160; 0]


Stacktrace
---------------------------------------------------------------------------------------------------------------------------------------


java.lang.NullPointerException: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
&#160; &#160; &#160; &#160; at java.util.concurrent.ConcurrentHashMap.putVal(ConcurrentHashMap.java:1011) ~[?:?]
&#160; &#160; &#160; &#160; at java.util.concurrent.ConcurrentHashMap.putIfAbsent(ConcurrentHashMap.java:1541) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.support.DefaultTimeoutMap.putIfAbsent(DefaultTimeoutMap.java:121) ~[bundleFile:3.8.0]
&#160; &#160; &#160; &#160; at org.apache.camel.component.sjms.reply.CorrelationTimeoutMap.putIfAbsent(CorrelationTimeoutMap.java:67) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.component.sjms.reply.ReplyManagerSupport.registerReply(ReplyManagerSupport.java:120) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.component.sjms.SjmsProducer$1.createMessage(SjmsProducer.java:306) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.component.sjms.SjmsTemplate$1.doInJms(SjmsTemplate.java:127) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.component.sjms.SjmsTemplate.execute(SjmsTemplate.java:91) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.component.sjms.SjmsTemplate.send(SjmsTemplate.java:158) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.component.sjms.SjmsProducer.doSend(SjmsProducer.java:521) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.component.sjms.SjmsProducer.processInOut(SjmsProducer.java:319) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.component.sjms.SjmsProducer.process(SjmsProducer.java:249) ~[?:?]
&#160; &#160; &#160; &#160; at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:169) ~[bundleFile:3.8.0]
&#160; &#160; &#160; &#160; at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:395) [bundleFile:3.8.0]
&#160; &#160; &#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:148) [bundleFile:3.8.0]
&#160; &#160; &#160; &#160; at org.apache.camel.impl.engine.DefaultReactiveExecutor.scheduleMain(DefaultReactiveExecutor.java:60) [bundleFile:3.8.0]
&#160; &#160; &#160; &#160; at org.apache.camel.processor.Pipeline.process(Pipeline.java:147) [bundleFile:3.8.0]
&#160; &#160; &#160; &#160; at org.apache.camel.impl.engine.CamelInternalProcessor.process(CamelInternalProcessor.java:312) [bundleFile:3.8.0]
&#160; &#160; &#160; &#160; at org.apache.camel.component.timer.TimerConsumer.sendTimerExchange(TimerConsumer.java:207) [bundleFile:3.8.0]
&#160; &#160; &#160; &#160; at org.apache.camel.component.timer.TimerConsumer$1.run(TimerConsumer.java:76) [bundleFile:3.8.0]
&#160; &#160; &#160; &#160; at java.util.TimerThread.mainLoop(Timer.java:556) [?:?]
&#160; &#160; &#160; &#160; at java.util.TimerThread.run(Timer.java:506) [?:?]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The JMSCorrelationID is set correctly on the message here:&#160; &lt;a href=&quot;https://github.com/apache/camel/blob/1541a742d1fa2633ee2251eeea72904f3447c8f5/components/camel-sjms/src/main/java/org/apache/camel/component/sjms/jms/JmsBinding.java#L287&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/1541a742d1fa2633ee2251eeea72904f3447c8f5/components/camel-sjms/src/main/java/org/apache/camel/component/sjms/jms/JmsBinding.java#L287&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Later on, however, the JMSCorrelationID is retrieved using `getJMSCorrelationIDAsBytes()` which will return null if the JMS Correlation ID is not a byte array (Artemis JMS Client Message implementation&#160;&lt;a href=&quot;https://github.com/apache/activemq-artemis/blob/0275630b7e9f2734fc732de95944fa73ceb77c43/artemis-core-client/src/main/java/org/apache/activemq/artemis/reader/MessageUtil.java#L68-L76&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;). This always results in a null JMS Correlation ID because in the previous call to set the JMS Correlation ID it was explicitly set to a string value.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13386356">CAMEL-16763</key>
            <summary>camel-sjms - Null JMS Correlation ID using Camel-SJMS Request/Reply with Artemis JMS Client</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sgalla">Shannon Gallagher</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Jun 2021 22:03:06 +0000</created>
                <updated>Wed, 30 Jun 2021 14:59:57 +0000</updated>
                            <resolved>Wed, 30 Jun 2021 14:59:57 +0000</resolved>
                                    <version>3.8.0</version>
                                    <fixVersion>3.11.1</fixVersion>
                    <fixVersion>3.12.0</fixVersion>
                                    <component>camel-sjms</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17370978" author="sgalla" created="Tue, 29 Jun 2021 01:50:07 +0000"  >&lt;p&gt;Is there a reason why the `SjmsProducer.determineCorrelationId()` method calls&#160;`message.getCorrelationIdAsBytes()` instead of `message.getCorrelationId()`?&lt;/p&gt;</comment>
                            <comment id="17371060" author="davsclaus" created="Tue, 29 Jun 2021 05:34:40 +0000"  >&lt;p&gt;Yeah there is no specific reason, can you send a PR that changes the code in the determineCorrelationId method&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 20 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0sdw0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>