<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:35:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-13400] Camel FTP Cannot list directory with &apos;File not found&apos; prepending additional &apos;/&apos; in front of directory automatically</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-13400</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I need to poll files form a dynamic folder based on a specific date, so I have provided the parent directory in endpoint URI, enabled recursive flag and add filterDirectory accordingly. But It is not able to poll from the directory, it says file not found for that directory. It is trying with an addition &apos;/&apos; while listing&#160;&lt;tt&gt;listFor(/XXXX)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Endpoint URI&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;{{sftp://XXXX:22051?connectTimeout=90000&amp;amp;disconnect=true&amp;amp;filterDirectory=%24%7Bfile%3Aname%7D+starts+with+%27%24%7Bbean%3AdateofExchange%3Fmethod%3DforLoc%28%22MY%22%29%7D%27&amp;amp;flatten=true&amp;amp;include=.&lt;b&gt;IMG&amp;amp;knownHostsFile=C%3A%5Cprogram+files%5Cascertain%5CI2R-MystiQ-Engine%5Cknown_hosts&amp;amp;noop=true&amp;amp;password=xxxxxx&amp;amp;preferredAuthentications=password&amp;amp;reconnectDelay=30000&amp;amp;recursive=true&amp;amp;scheduler=quartz2&amp;amp;scheduler.cron=0+0%2F5+&lt;/b&gt;&lt;ins&gt;&lt;b&gt;&lt;/ins&gt;&lt;/b&gt;+%3F&amp;amp;stepwise=false&amp;amp;username=XXXX_ftpuser }}&lt;/p&gt;

&lt;p&gt;&lt;b&gt;TRACE LOG&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;{{TRACE 2019-04-05T15:25:03,389 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Polling directory: TRACE 2019-04-05T15:25:03,389 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - listFiles() TRACE 2019-04-05T15:25:03,712 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Found 12 in directory: TRACE 2019-04-05T15:25:03,712 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=., longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:27 ., dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:03,712 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;.&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:03,712 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=.., longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 03:04 .., dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:03,712 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;..&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:03,728 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=20170526, longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 02:16 20170526, dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:04,413 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;20170526&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:04,413 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=20181119, longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:24 20181119, dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:05,117 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;20181119&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:05,117 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=20181121, longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:25 20181121, dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:05,837 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;20181121&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:05,840 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=20181122, longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:26 20181122, dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:06,561 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;20181122&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:06,563 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=20181123, longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:27 20181123, dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T15:25:07,258 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Polling sub directory: /20181123 from: sftp://XXXX:22051?connectTimeout=90000&amp;amp;disconnect=true&amp;amp;filterDirectory=%24%7Bfile%3Aname%7D+starts+with+%27%24%7Bbean%3AdateofExchange%3Fmethod%3DforLoc%28%22MY%22%29%7D%27&amp;amp;flatten=true&amp;amp;include=.&lt;b&gt;IMG&amp;amp;knownHostsFile=C%3A%5Cprogram+files%5Cascertain%5CI2R-MystiQ-Engine%5Cknown_hosts&amp;amp;noop=true&amp;amp;password=xxxxxx&amp;amp;preferredAuthentications=password&amp;amp;reconnectDelay=30000&amp;amp;recursive=true&amp;amp;scheduler=quartz2&amp;amp;scheduler.cron=0+0%2F5+&lt;/b&gt;&lt;ins&gt;&lt;b&gt;&lt;/ins&gt;&lt;/b&gt;&lt;ins&gt;%3F&amp;amp;stepwise=false&amp;amp;username=XXXX_ftpuser TRACE 2019-04-05T15:25:07,260 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - doPollDirectory from absolutePath: /20181123, dirName: 20181123 TRACE 2019-04-05T15:25:07,263 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Polling directory: /20181123 TRACE 2019-04-05T15:25:07,265 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - listFiles(/20181123) DEBUG 2019-04-05T15:25:07,281 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Caught exception Cannot list directory: /20181123 TRACE 2019-04-05T15:25:07,297 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Not ignoring file error Cannot list directory: /20181123 for /20181123 DEBUG 2019-04-05T15:25:07,297 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Error occurred during poll directory: due Cannot list directory: /20181123. Removing 0 files marked as in-progress. WARN 2019-04-05T15:25:07,297 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.RemoteFilePollingConsumerPollStrategy&amp;#93;&lt;/span&gt; - Trying to recover by force disconnecting from remote server and re-connecting at next poll: sftp://XXX@1XXXX:22051 DEBUG 2019-04-05T15:25:07,297 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Force disconnecting from: sftp://XXX@XXXX:22051 WARN 2019-04-05T15:25:07,297 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Consumer SftpConsumer&lt;span class=&quot;error&quot;&gt;&amp;#91;sftp://XXXX:22051?connectTimeout=90000&amp;amp;disconnect=true&amp;amp;filterDirectory=%24%7Bfile%3Aname%7D+starts+with+%27%24%7Bbean%3AdateofExchange%3Fmethod%3DforLoc%28%22MY%22%29%7D%27&amp;amp;flatten=true&amp;amp;include=.*IMG&amp;amp;knownHostsFile=C%3A%5Cprogram+files%5Cascertain%5CI2R-MystiQ-Engine%5Cknown_hosts&amp;amp;noop=true&amp;amp;password=xxxxxx&amp;amp;preferredAuthentications=password&amp;amp;reconnectDelay=30000&amp;amp;recursive=true&amp;amp;scheduler=quartz2&amp;amp;scheduler.cron=0+0%2F5+*+*+*+%3F&amp;amp;stepwise=false&amp;amp;username=XXXX_ftpuser&amp;#93;&lt;/span&gt; failed polling endpoint: sftp://XXXX:22051?connectTimeout=90000&amp;amp;disconnect=true&amp;amp;filterDirectory=%24%7Bfile%3Aname%7D+starts+with&lt;/ins&gt;%27%24%7Bbean%3AdateofExchange%3Fmethod%3DforLoc%28%22MY%22%29%7D%27&amp;amp;flatten=true&amp;amp;include=.&lt;b&gt;IMG&amp;amp;knownHostsFile=C%3A%5Cprogram+files%5Cascertain%5CI2R-MystiQ-Engine%5Cknown_hosts&amp;amp;noop=true&amp;amp;password=xxxxxx&amp;amp;preferredAuthentications=password&amp;amp;reconnectDelay=30000&amp;amp;recursive=true&amp;amp;scheduler=quartz2&amp;amp;scheduler.cron=0+0%2F5+&lt;/b&gt;&lt;ins&gt;&lt;b&gt;&lt;/ins&gt;&lt;/b&gt;+%3F&amp;amp;stepwise=false&amp;amp;username=XXXX_ftpuser. Will try again at next poll. Caused by: &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.GenericFileOperationFailedException - Cannot list directory: /20181123&amp;#93;&lt;/span&gt; org.apache.camel.component.file.GenericFileOperationFailedException: Cannot list directory: /20181123 at org.apache.camel.component.file.remote.SftpOperations.listFiles(SftpOperations.java:660) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-ftp-2.21.1.jar!/:2.21.1&amp;#93;&lt;/span&gt; at org.apache.camel.component.file.remote.SftpConsumer.doPollDirectory(SftpConsumer.java:128) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-ftp-2.21.1.jar!/:2.21.1&amp;#93;&lt;/span&gt; at org.apache.camel.component.file.remote.RemoteFileConsumer.doSafePollSubDirectory(RemoteFileConsumer.java:260) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-ftp-2.21.1.jar!/:2.21.1&amp;#93;&lt;/span&gt; at org.apache.camel.component.file.remote.SftpConsumer.pollSubDirectory(SftpConsumer.java:96) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-ftp-2.21.1.jar!/:2.21.1&amp;#93;&lt;/span&gt; at org.apache.camel.component.file.remote.SftpConsumer.doPollDirectory(SftpConsumer.java:178) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-ftp-2.21.1.jar!/:2.21.1&amp;#93;&lt;/span&gt; at org.apache.camel.component.file.remote.SftpConsumer.pollDirectory(SftpConsumer.java:87) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-ftp-2.21.1.jar!/:2.21.1&amp;#93;&lt;/span&gt; at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:124) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.21.1.jar!/:2.21.1&amp;#93;&lt;/span&gt; at org.apache.camel.impl.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:174) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.21.1.jar!/:2.21.1&amp;#93;&lt;/span&gt; at org.apache.camel.impl.ScheduledPollConsumer.run(ScheduledPollConsumer.java:101) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-core-2.21.1.jar!/:2.21.1&amp;#93;&lt;/span&gt; at org.apache.camel.pollconsumer.quartz2.QuartzScheduledPollConsumerJob.execute(QuartzScheduledPollConsumerJob.java:61) &lt;span class=&quot;error&quot;&gt;&amp;#91;camel-quartz2-2.21.1.jar!/:2.21.1&amp;#93;&lt;/span&gt; at org.quartz.core.JobRunShell.run(JobRunShell.java:202) &lt;span class=&quot;error&quot;&gt;&amp;#91;quartz-2.3.0.jar!/:?&amp;#93;&lt;/span&gt; at org.quartz.simpl.SimpleThreadPool$WorkerThread.run(SimpleThreadPool.java:573) &lt;span class=&quot;error&quot;&gt;&amp;#91;quartz-2.3.0.jar!/:?&amp;#93;&lt;/span&gt; Caused by: com.jcraft.jsch.SftpException: File not found: /20181123 at com.jcraft.jsch.ChannelSftp.throwStatusError(ChannelSftp.java:2873) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;jsch-0.1.54.jar!/:?&amp;#93;&lt;/span&gt; at com.jcraft.jsch.ChannelSftp._stat(ChannelSftp.java:2225) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;jsch-0.1.54.jar!/:?&amp;#93;&lt;/span&gt; at com.jcraft.jsch.ChannelSftp._stat(ChannelSftp.java:2242) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;jsch-0.1.54.jar!/:?&amp;#93;&lt;/span&gt; at com.jcraft.jsch.ChannelSftp.ls(ChannelSftp.java:1592) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;jsch-0.1.54.jar!/:?&amp;#93;&lt;/span&gt; at com.jcraft.jsch.ChannelSftp.ls(ChannelSftp.java:1553) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;jsch-0.1.54.jar!/:?&amp;#93;&lt;/span&gt; at org.apache.camel.component.file.remote.SftpOperations.listFiles(SftpOperations.java:651) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;camel-ftp-2.21.1.jar!/:2.21.1&amp;#93;&lt;/span&gt; ... 11 more }}&lt;/p&gt;

&lt;p&gt;When I try to hardcode that folder along with endpint URI, it simply can list that directory and poll files. This time there is no &apos;/&apos; before the directory while listing&#160;&lt;tt&gt;listFor(XXXX)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Endpoint URI&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;{{sftp://XXXX:22051/20181123?connectTimeout=90000&amp;amp;disconnect=true&amp;amp;flatten=true&amp;amp;include=.&lt;b&gt;IMG&amp;amp;knownHostsFile=C%3A%5Cprogram+files%5Cascertain%5CI2R-MystiQ-Engine%5Cknown_hosts&amp;amp;noop=true&amp;amp;password=xxxxxx&amp;amp;preferredAuthentications=password&amp;amp;reconnectDelay=30000&amp;amp;recursive=true&amp;amp;scheduler=quartz2&amp;amp;scheduler.cron=0+0%2F5+&lt;/b&gt;&lt;ins&gt;&lt;b&gt;&lt;/ins&gt;&lt;/b&gt;+%3F&amp;amp;separator=Auto&amp;amp;stepwise=false&amp;amp;username=XXXX_ftpuser }}&lt;/p&gt;

&lt;p&gt;&lt;b&gt;TRACE LOG&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;{{TRACE 2019-04-05T18:40:00,009 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - prePollCheck on sftp://XXX@XXXX:22051 DEBUG 2019-04-05T18:40:00,009 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Not connected/logged in, connecting to: sftp://XXX@XXXX:22051 TRACE 2019-04-05T18:40:00,009 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - Session isn&apos;t connected, trying to recreate and connect. DEBUG 2019-04-05T18:40:00,009 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - Using knownhosts file: C:\program files\ascertain\I2R-MystiQ-Engine\known_hosts DEBUG 2019-04-05T18:40:00,009 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - Using known hosts information from file: C:\program files\ascertain\I2R-MystiQ-Engine\known_hosts DEBUG 2019-04-05T18:40:00,025 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - Using StrickHostKeyChecking: no DEBUG 2019-04-05T18:40:00,025 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - Using PreferredAuthentications: password TRACE 2019-04-05T18:40:00,025 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - Connecting use connectTimeout: 90000 ... TRACE 2019-04-05T18:40:00,465 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - Channel isn&apos;t connected, trying to recreate and connect. TRACE 2019-04-05T18:40:00,465 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - Connecting use connectTimeout: 90000 ... DEBUG 2019-04-05T18:40:01,215 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - Connected to sftp://XXX@XXXX:22051 DEBUG 2019-04-05T18:40:01,215 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Connected and logged in to: sftp://XXX@XXXX:22051 TRACE 2019-04-05T18:40:01,215 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - doPollDirectory from absolutePath: 20181123, dirName: null TRACE 2019-04-05T18:40:01,215 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Polling directory: 20181123 TRACE 2019-04-05T18:40:01,215 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - listFiles(20181123) TRACE 2019-04-05T18:40:02,621 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Found 6 in directory: 20181123 TRACE 2019-04-05T18:40:02,621 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=., longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:27 ., dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,621 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;.&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,637 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=.., longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:27 .., dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,637 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;..&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,637 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=Consolidated, longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:26 Consolidated, dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,637 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Polling sub directory: 20181123/Consolidated from: sftp://XXXX:22051/20181123?connectTimeout=90000&amp;amp;disconnect=true&amp;amp;flatten=true&amp;amp;include=.&lt;b&gt;IMG&amp;amp;knownHostsFile=C%3A%5Cprogram+files%5Cascertain%5CI2R-MystiQ-Engine%5Cknown_hosts&amp;amp;noop=true&amp;amp;password=xxxxxx&amp;amp;preferredAuthentications=password&amp;amp;reconnectDelay=30000&amp;amp;recursive=true&amp;amp;scheduler=quartz2&amp;amp;scheduler.cron=0+0%2F5+&lt;/b&gt;&lt;ins&gt;&lt;b&gt;&lt;/ins&gt;&lt;/b&gt;&lt;ins&gt;%3F&amp;amp;separator=Auto&amp;amp;stepwise=false&amp;amp;username=XXXX_ftpuser TRACE 2019-04-05T18:40:02,637 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - doPollDirectory from absolutePath: 20181123/Consolidated, dirName: Consolidated TRACE 2019-04-05T18:40:02,637 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Polling directory: 20181123/Consolidated TRACE 2019-04-05T18:40:02,637 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - listFiles(20181123/Consolidated) TRACE 2019-04-05T18:40:02,715 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Found 5 in directory: 20181123/Consolidated TRACE 2019-04-05T18:40:02,715 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=., longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:26 ., dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,715 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/.&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,715 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=.., longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:27 .., dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,715 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/..&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,715 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=20181124020438943_021420181123INW.MYR, longName=-r-x------ 1 ftpadmin ftpadmin 408097 Nov 23 2018 20181124020438943_021420181123INW.MYR, dir=false&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,731 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/20181124020438943_021420181123INW.MYR&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,731 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=20181124020439099_035820181123INW.MYR, longName=-r-x------ 1 ftpadmin ftpadmin 21689 Nov 23 2018 20181124020439099_035820181123INW.MYR, dir=false&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,731 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/20181124020439099_035820181123INW.MYR&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,731 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=ToPPay, longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 06:41 ToPPay, dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,731 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Polling sub directory: 20181123/Consolidated/ToPPay from: sftp://XXXX:22051/20181123?connectTimeout=90000&amp;amp;disconnect=true&amp;amp;flatten=true&amp;amp;include=.&lt;b&gt;IMG&amp;amp;knownHostsFile=C%3A%5Cprogram+files%5Cascertain%5CI2R-MystiQ-Engine%5Cknown_hosts&amp;amp;noop=true&amp;amp;password=xxxxxx&amp;amp;preferredAuthentications=password&amp;amp;reconnectDelay=30000&amp;amp;recursive=true&amp;amp;scheduler=quartz2&amp;amp;scheduler.cron=0+0%2F5&lt;/ins&gt;&lt;/b&gt;&lt;ins&gt;&lt;b&gt;&lt;/ins&gt;&lt;/b&gt;&lt;ins&gt;%3F&amp;amp;separator=Auto&amp;amp;stepwise=false&amp;amp;username=XXXX_ftpuser TRACE 2019-04-05T18:40:02,731 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - doPollDirectory from absolutePath: 20181123/Consolidated/ToPPay, dirName: ToPPay TRACE 2019-04-05T18:40:02,731 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Polling directory: 20181123/Consolidated/ToPPay TRACE 2019-04-05T18:40:02,731 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - listFiles(20181123/Consolidated/ToPPay) TRACE 2019-04-05T18:40:02,777 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Found 8 in directory: 20181123/Consolidated/ToPPay TRACE 2019-04-05T18:40:02,777 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=., longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 06:41 ., dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,777 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/ToPPay/.&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,777 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=.., longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:26 .., dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,777 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/ToPPay/..&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,793 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=021420181123INW.MYR, longName=-r-x------ 1 ftpadmin ftpadmin 408097 Nov 23 2018 021420181123INW.MYR, dir=false&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,793 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/ToPPay/021420181123INW.MYR&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,793 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=021420181123INW1.MYR, longName=-r-x------ 1 ftpadmin ftpadmin 579829 Nov 23 2018 021420181123INW1.MYR, dir=false&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,793 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/ToPPay/021420181123INW1.MYR&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,793 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=035820181123INW.MYR, longName=-r-x------ 1 ftpadmin ftpadmin 21689 Nov 23 2018 035820181123INW.MYR, dir=false&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,793 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/ToPPay/035820181123INW.MYR&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,793 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=035820181123INW1.MYR, longName=-r-x------ 1 ftpadmin ftpadmin 30954 Nov 23 2018 035820181123INW1.MYR, dir=false&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,793 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/ToPPay/035820181123INW1.MYR&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,809 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=20181124020438943_021420181123INW.MYR, longName=-r-x------ 1 ftpadmin ftpadmin 408097 Nov 23 2018 20181124020438943_021420181123INW.MYR, dir=false&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,809 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/ToPPay/20181124020438943_021420181123INW.MYR&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,809 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=20181124020439099_035820181123INW.MYR, longName=-r-x------ 1 ftpadmin ftpadmin 21689 Nov 23 2018 20181124020439099_035820181123INW.MYR, dir=false&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,809 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Consolidated/ToPPay/20181124020439099_035820181123INW.MYR&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,809 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=Data, longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:26 Data, dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,809 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Polling sub directory: 20181123/Data from: sftp://XXXX:22051/20181123?connectTimeout=90000&amp;amp;disconnect=true&amp;amp;flatten=true&amp;amp;include=.&lt;b&gt;IMG&amp;amp;knownHostsFile=C%3A%5Cprogram+files%5Cascertain%5CI2R-MystiQ-Engine%5Cknown_hosts&amp;amp;noop=true&amp;amp;password=xxxxxx&amp;amp;preferredAuthentications=password&amp;amp;reconnectDelay=30000&amp;amp;recursive=true&amp;amp;scheduler=quartz2&amp;amp;scheduler.cron=0+0%2F5&lt;/ins&gt;&lt;/b&gt;&lt;ins&gt;&lt;b&gt;&lt;/ins&gt;&lt;/b&gt;+%3F&amp;amp;separator=Auto&amp;amp;stepwise=false&amp;amp;username=XXXX_ftpuser TRACE 2019-04-05T18:40:02,809 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - doPollDirectory from absolutePath: 20181123/Data, dirName: Data TRACE 2019-04-05T18:40:02,809 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Polling directory: 20181123/Data TRACE 2019-04-05T18:40:02,809 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpOperations&amp;#93;&lt;/span&gt; - listFiles(20181123/Data) TRACE 2019-04-05T18:40:02,871 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - Found 501 in directory: 20181123/Data TRACE 2019-04-05T18:40:02,871 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=., longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:26 ., dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,871 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Data/.&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,871 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=.., longName=dr-x------ 2 ftpadmin ftpadmin 0 Mar 12 05:27 .., dir=true&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,871 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Data/..&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,871 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - SftpFile&lt;span class=&quot;error&quot;&gt;&amp;#91;fileName=20181123021401015101004323IWNM.MMYR, longName=-r-x------ 1 ftpadmin ftpadmin 14846 Nov 23 2018 20181123021401015101004323IWNM.MMYR, dir=false&amp;#93;&lt;/span&gt; TRACE 2019-04-05T18:40:02,871 &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.remote.SftpConsumer&amp;#93;&lt;/span&gt; - File did not match. Will skip this file: RemoteFile&lt;span class=&quot;error&quot;&gt;&amp;#91;Data/20181123021401015101004323IWNM.MMYR&amp;#93;&lt;/span&gt; }}&lt;/p&gt;

&lt;p&gt;I am sure that the cause of the issue has to be the addition &apos;/&apos; prepending with directory name while listing&#160;&lt;tt&gt;listFor(/XXXX)&lt;/tt&gt;. How can I avoid it ! .. using&#160;&lt;tt&gt;seperator&lt;/tt&gt;&#160;parameter didn&apos;t effect i suppose it is only for producing files and not for consuming. I need to resolve this issue as soon as possible. Please suggest me some solution &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;EDITED :&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;I can reproduce the issue in latest version as well,I suppose the issue is when there is no base path only the &apos;/&apos; gets prepended which should not actually happen&lt;/p&gt;

&lt;p&gt;Code Snippet from SftpConsumer.java Camel 3.0.0.M1&lt;/p&gt;

&lt;p&gt;{{if (file.isDirectory()) { RemoteFile&amp;lt;SftpRemoteFile&amp;gt; remote = asRemoteFile(absolutePath, file, getEndpoint().getCharset()); if (endpoint.isRecursive() &amp;amp;&amp;amp; depth &amp;lt; endpoint.getMaxDepth() &amp;amp;&amp;amp; isValidFile(remote, true, files)) { // recursive scan and add the sub files and folders String subDirectory = file.getFilename(); String path = absolutePath + &quot;/&quot; + subDirectory; boolean canPollMore = pollSubDirectory(path, subDirectory, fileList, depth); if (!canPollMore) &lt;/p&gt;
{ return false; }
&lt;p&gt; } // we cannot use file.getAttrs().isLink on Windows, so we dont invoke the method // just assuming its a file we should poll } }}&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;String path = absolutePath + &quot;/&quot; + subDirectory;&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="13226876">CAMEL-13400</key>
            <summary>Camel FTP Cannot list directory with &apos;File not found&apos; prepending additional &apos;/&apos; in front of directory automatically</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="vsvdhsagar">Vidhya Sagar Jeevendran</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Apr 2019 07:54:56 +0000</created>
                <updated>Tue, 21 May 2019 08:11:03 +0000</updated>
                            <resolved>Tue, 21 May 2019 08:11:03 +0000</resolved>
                                    <version>3.0.0-M1</version>
                                    <fixVersion>2.23.3</fixVersion>
                    <fixVersion>2.22.5</fixVersion>
                    <fixVersion>2.24.1</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>camel-ftp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16813097" author="ancosen" created="Tue, 9 Apr 2019 07:56:24 +0000"  >&lt;p&gt;ask on the user mailing list first&lt;/p&gt;</comment>
                            <comment id="16813115" author="davsclaus" created="Tue, 9 Apr 2019 08:18:55 +0000"  >&lt;p&gt;This was first debated on SO which the user should have reported in this JIRA so others can see that we have talked about it there first:&lt;br/&gt;
&lt;a href=&quot;https://stackoverflow.com/questions/55570093/camel-ftp-cannot-list-directory-with-file-not-found-pre-pending-additional&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/55570093/camel-ftp-cannot-list-directory-with-file-not-found-pre-pending-additional&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I think it smells like a little bug, and a potential fix is to check if that absolutePath is empty and if so omit appending the slash.&lt;/p&gt;</comment>
                            <comment id="16813118" author="ancosen" created="Tue, 9 Apr 2019 08:22:13 +0000"  >&lt;p&gt;Reopened.&lt;/p&gt;</comment>
                            <comment id="16840995" author="betoflowv93" created="Thu, 16 May 2019 05:42:44 +0000"  >&lt;p&gt;It seems that the &apos;stepwise=false&apos; attribute is causing the problem.&#160; When it is set to false and no base path is provided in the endpoint URI (&lt;a href=&quot;ftp://ZZZ@XXX:YYY?password&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ftp://ZZZ@XXX:YYY?password&lt;/a&gt;...) the absolute paths used in the listFiles method are generated with the &apos;/&apos; prefix (&apos;/mock/foo&apos;), but if a base path is defined in the URI (&lt;a href=&quot;ftp://ZZZ@XXX:YYY/bar?password&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ftp://ZZZ@XXX:YYY/bar?password&lt;/a&gt;...)&#160; the resulting absolute paths do not have this prefix (&apos;bar/mock/foo&apos;).&lt;/p&gt;

&lt;p&gt;However, the issue depends of the server implementation since I tested with the embedded FTP server used in the tests and the files were returned normally using the absolute paths containing the prefix &apos;/&apos;.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16843645" author="betoflowv93" created="Mon, 20 May 2019 04:33:49 +0000"  >&lt;p&gt;Hi.&lt;/p&gt;

&lt;p&gt;I have just sent a PR. Could you please give it a look.&lt;/p&gt;

&lt;p&gt;Regards,&lt;/p&gt;

&lt;p&gt;Roberto.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 26 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z01l5c:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>