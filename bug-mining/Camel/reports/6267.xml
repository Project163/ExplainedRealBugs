<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:58:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-18588] Kafka consumer on any exception should repoll records after the committed offset</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-18588</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;In Camel-Kafka , if max poll records is set to more than 1 and breakOnFirstError is set to TRUE, then on any exception thrown on the first message in the batch will cause the KafkaConsumer to start repolling from zero offset because partitionLastOffset is -1 for the first message&lt;/p&gt;



&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; processException(
            Exchange exchange, TopicPartition partition, &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; partitionLastOffset,
            ExceptionHandler exceptionHandler) {

        &lt;span class=&quot;code-comment&quot;&gt;// processing failed due to an unhandled exception, what should we &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt;
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (configuration.isBreakOnFirstError()) {
            &lt;span class=&quot;code-comment&quot;&gt;// we are failing and we should &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt; out
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (LOG.isWarnEnabled()) {
                LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error during processing {} from topic: {}&quot;&lt;/span&gt;, exchange, partition.topic(), exchange.getException());
                LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Will seek consumer to offset {} and start polling again.&quot;&lt;/span&gt;, partitionLastOffset);
            }

            &lt;span class=&quot;code-comment&quot;&gt;// force commit, so we resume on next poll where we failed
&lt;/span&gt;            commitManager.forceCommit(partition, partitionLastOffset);

            &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt; to next partition
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-comment&quot;&gt;// will handle/log the exception and then &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt; to next
&lt;/span&gt;            exceptionHandler.handleException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error during processing&quot;&lt;/span&gt;, exchange, exchange.getException());
        }

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13484689">CAMEL-18588</key>
            <summary>Kafka consumer on any exception should repoll records after the committed offset</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="orpiske">Otavio Rodolfo Piske</assignee>
                                    <reporter username="geek.rupam">rupam</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Oct 2022 03:27:57 +0000</created>
                <updated>Tue, 3 Oct 2023 09:01:28 +0000</updated>
                            <resolved>Wed, 12 Oct 2022 16:20:24 +0000</resolved>
                                    <version>3.18.0</version>
                                    <fixVersion>3.18.3</fixVersion>
                    <fixVersion>3.20.0</fixVersion>
                                    <component>camel-kafka</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17615193" author="klease78" created="Mon, 10 Oct 2022 16:07:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=geek.rupam&quot; class=&quot;user-hover&quot; rel=&quot;geek.rupam&quot;&gt;geek.rupam&lt;/a&gt; I think the changes made for &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-18350&quot; title=&quot;camel-kafka: enabling &amp;quot;breakOnFirstError&amp;quot; causes camel to reconsume all records on error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-18350&quot;&gt;&lt;del&gt;CAMEL-18350&lt;/del&gt;&lt;/a&gt; should fix this.&lt;/p&gt;</comment>
                            <comment id="17615249" author="JIRAUSER293680" created="Mon, 10 Oct 2022 18:19:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-18350&quot; title=&quot;camel-kafka: enabling &amp;quot;breakOnFirstError&amp;quot; causes camel to reconsume all records on error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-18350&quot;&gt;&lt;del&gt;CAMEL-18350&lt;/del&gt;&lt;/a&gt; doesn&apos;t safeguard against the case when the Kafka consumer restarted after a few commits and fails at the first message in a poll&#160;&lt;/p&gt;</comment>
                            <comment id="17615542" author="orpiske" created="Tue, 11 Oct 2022 07:21:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=geek.rupam&quot; class=&quot;user-hover&quot; rel=&quot;geek.rupam&quot;&gt;geek.rupam&lt;/a&gt; thank you for the fix! I assigned the ticket to me - as your profile on Jira is not yet available for ticket assignment. I&apos;ll eval and, if needed, backport this to 3.18 codebase.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="13484688">CAMEL-18587</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13505916">CAMEL-18760</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10061"><![CDATA[Novice]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 5 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z193f4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>