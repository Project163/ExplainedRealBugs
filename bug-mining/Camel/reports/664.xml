<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:33:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-1749] Message body lost when message moved by exception clause</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-1749</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;(See: &lt;a href=&quot;http://www.nabble.com/Message-body-lost-when-message-moved-by-exception-clause-td24088536.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.nabble.com/Message-body-lost-when-message-moved-by-exception-clause-td24088536.html&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;After upgrading from 1.5.0 to 1.6.1, we find that an exception clause such as this one &lt;/p&gt;

&lt;p&gt;&amp;lt;onException&amp;gt;&lt;br/&gt;
	&amp;lt;exception&amp;gt;no.spk.ruting.feil.PersonIkkeFunnetNavException&amp;lt;/exception&amp;gt;&lt;br/&gt;
	&amp;lt;redeliveryPolicy maximumRedeliveries=&quot;0&quot; /&amp;gt;&lt;br/&gt;
	&amp;lt;handled&amp;gt;&lt;br/&gt;
		&amp;lt;constant&amp;gt;true&amp;lt;/constant&amp;gt;&lt;br/&gt;
	&amp;lt;/handled&amp;gt;&lt;br/&gt;
	&amp;lt;to ref=&quot;tpforholdArbeidskoe&quot; /&amp;gt;&lt;br/&gt;
&amp;lt;/onException&amp;gt;&lt;/p&gt;

&lt;p&gt;cause the message body to be &lt;b&gt;empty&lt;/b&gt; after the message has been moved to tpforholdArbeidskoe. The message was jaxb-unmarshalled in the process that led up to the exception.&lt;/p&gt;

&lt;p&gt;----------&lt;/p&gt;

&lt;p&gt;The attached application (which is a cut-down version of our real one) demonstrates the problem. To reproduce:&lt;/p&gt;

&lt;p&gt;1. Post a message with a text body like  this to queue &quot;tpforholdHoved&quot;:&lt;/p&gt;

&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;TPForholdHendelse&amp;gt;&lt;br/&gt;
	&amp;lt;type&amp;gt;Opprett&amp;lt;/type&amp;gt;&lt;br/&gt;
	&amp;lt;ordning&amp;gt;1015&amp;lt;/ordning&amp;gt;&lt;br/&gt;
	&amp;lt;datKundeFoedtNum&amp;gt;11223344&amp;lt;/datKundeFoedtNum&amp;gt;&lt;br/&gt;
	&amp;lt;ideKundePrsnr&amp;gt;12345&amp;lt;/ideKundePrsnr&amp;gt;&lt;br/&gt;
&amp;lt;/TPForholdHendelse&amp;gt;&lt;/p&gt;

&lt;p&gt;When this message gets consumed by TPForholdWSKlientImpl.opprettTPForholdNAV(), an exception is deliberately thrown, and the message gets moved to queue &quot;tpforholdArbeidskoe&quot;.&lt;/p&gt;

&lt;p&gt;When, in turn, the message gets consumed by HendelseKlientWSKlientImpl.lagArbeidskoeHendelsePersonIkkeFunnet(), the message&apos;s body has been lost. At least, the param to HendelseKlientWSKlientImpl.lagArbeidskoeHendelsePersonIkkeFunnet() is null. &lt;/p&gt;

&lt;p&gt;2. Now, change pom.xml som that the app uses Camel 1.5.0 instead. Rerun step 1. The problem does not occur now.&lt;/p&gt;





</description>
                <environment>&lt;p&gt;WIn XP,  JSE1.5, ActiveMQ 5.1.0&lt;/p&gt;</environment>
        <key id="12487185">CAMEL-1749</key>
            <summary>Message body lost when message moved by exception clause</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="rune.berg@spk.no">Rune Berg</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Jun 2009 12:07:24 +0000</created>
                <updated>Sun, 7 Feb 2010 09:58:26 +0000</updated>
                            <resolved>Wed, 24 Jun 2009 08:58:56 +0000</resolved>
                                    <version>1.6.0</version>
                    <version>1.6.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12952808" author="davsclaus" created="Wed, 24 Jun 2009 08:26:49 +0000"  >&lt;p&gt;As you use JMS queues and you want to store the JAXB object there you need to let your object be Serializable.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;To fix&lt;/b&gt;:&lt;br/&gt;
Your class TPForholdHendelse should implement Serializable&lt;/p&gt;

&lt;p&gt;What happens is that Camel detects the body class type when you send it to a JMS queue. And if it cannot determine a type that matches the javax.jms.XXX object it will fallback to a generic type.&lt;br/&gt;
And this generic type is &lt;b&gt;not&lt;/b&gt; a javax.jms.ObjectMessage, that is the type you need to use.&lt;/p&gt;
</comment>
                            <comment id="12952821" author="davsclaus" created="Wed, 24 Jun 2009 08:58:56 +0000"  >&lt;p&gt;trunk: 787947.&lt;/p&gt;

&lt;p&gt;Improved WARN logging when Camel uses a Generic JMS message instead of either&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Text&lt;/li&gt;
	&lt;li&gt;Bytes&lt;/li&gt;
	&lt;li&gt;Object&lt;/li&gt;
	&lt;li&gt;Map&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;that its supposed to use.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12463006" name="ruting-bodyloss.zip" size="14276" author="rune.berg@spk.no" created="Tue, 23 Jun 2009 12:08:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>103957</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01kbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7063</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>