<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:29:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-993] NPE in TraceFormatter</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-993</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;This configuration causes NPE:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;		from(&lt;span class=&quot;code-quote&quot;&gt;&quot;timer:&lt;span class=&quot;code-comment&quot;&gt;//kickoff_5?period=10000&quot;&lt;/span&gt;).
&lt;/span&gt;		setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;).constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;aa&quot;&lt;/span&gt;).setBody().constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;a b c a_1 b_1&quot;&lt;/span&gt;).
		splitter(body().tokenize(&lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt;)).
		setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;aggreagation_header&quot;&lt;/span&gt;).body().
		aggregator(header(&lt;span class=&quot;code-quote&quot;&gt;&quot;aggreagation_header&quot;&lt;/span&gt;)).
		to(&lt;span class=&quot;code-quote&quot;&gt;&quot;mock:out&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2008-10-17 07:47:11,321 [ Polling &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] DEBUG DefaultAggregationCollection   - put exchange:Exchange[Message: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;] &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; key:&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
2008-10-17 07:47:12,237 [ Polling &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;] ERROR Aggregator                     - 
java.lang.NullPointerException
	at org.apache.camel.processor.interceptor.TraceFormatter.getBreadCrumbID(TraceFormatter.java:150)
	at org.apache.camel.processor.interceptor.TraceFormatter.format(TraceFormatter.java:45)
	at org.apache.camel.processor.interceptor.TraceInterceptor.format(TraceInterceptor.java:94)
	at org.apache.camel.processor.Logger.logMessage(Logger.java:219)
	at org.apache.camel.processor.Logger.process(Logger.java:124)
	at org.apache.camel.processor.interceptor.TraceInterceptor.logException(TraceInterceptor.java:119)
	at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:87)
	at org.apache.camel.processor.BatchProcessor.processExchange(BatchProcessor.java:190)
	at org.apache.camel.processor.BatchProcessor.processBatch(BatchProcessor.java:168)
	at org.apache.camel.processor.BatchProcessor.run(BatchProcessor.java:68)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:619)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12487094">CAMEL-993</key>
            <summary>NPE in TraceFormatter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="vchekan">Vadim Chekan</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Oct 2008 07:50:24 +0000</created>
                <updated>Sun, 7 Feb 2010 09:54:17 +0000</updated>
                            <resolved>Tue, 9 Jun 2009 06:18:04 +0000</resolved>
                                    <version>1.5.0</version>
                                    <fixVersion>1.5.0</fixVersion>
                    <fixVersion>1.6.2</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                                                            <comments>
                            <comment id="12949239" author="davsclaus" created="Sat, 18 Oct 2008 11:32:03 +0000"  >&lt;p&gt;This bug is because of &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-393&quot; title=&quot;BatchProcessor always consumes directly from endpoint ignoring previous steps&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-393&quot;&gt;&lt;del&gt;CAMEL-393&lt;/del&gt;&lt;/a&gt; where the aggregator attaches itself directly to the consumer (from) so all the stuff in between is bypassed.&lt;/p&gt;

&lt;p&gt;So you need to divide the route into two parts, such as:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                from(&lt;span class=&quot;code-quote&quot;&gt;&quot;timer:&lt;span class=&quot;code-comment&quot;&gt;//kickoff?period=10000&quot;&lt;/span&gt;).
&lt;/span&gt;                    setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;).constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;).setBody().constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;a b c&quot;&lt;/span&gt;).
                    splitter(body().tokenize(&lt;span class=&quot;code-quote&quot;&gt;&quot; &quot;&lt;/span&gt;)).to(&lt;span class=&quot;code-quote&quot;&gt;&quot;seda:splitted&quot;&lt;/span&gt;);

                from(&lt;span class=&quot;code-quote&quot;&gt;&quot;seda:splitted&quot;&lt;/span&gt;).
                    aggregator(header(&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;)).
                    to(&lt;span class=&quot;code-quote&quot;&gt;&quot;mock:result&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12950855" author="davsclaus" created="Mon, 16 Feb 2009 05:51:55 +0000"  >&lt;p&gt;Closing all 1.5.0 issues&lt;/p&gt;</comment>
                            <comment id="12952509" author="rpollack" created="Mon, 8 Jun 2009 16:23:39 +0000"  >&lt;p&gt;I am experiencing the same problem in 1.6.0, without an aggregator. My route logic (in XML) is&lt;/p&gt;

&lt;p&gt;      &amp;lt;route errorHandlerRef=&quot;myErrorHandler&quot;&amp;gt;&lt;br/&gt;
         &amp;lt;from uri=&quot;jbi:service:urn:distributor.dmf.company.com:DistributorService&quot;/&amp;gt;&lt;br/&gt;
         &amp;lt;convertBodyTo type=&quot;java.lang.String&quot;/&amp;gt;&lt;br/&gt;
         &amp;lt;inOnly uri=&quot;direct:packetQueue&quot;/&amp;gt;&lt;br/&gt;
      &amp;lt;/route&amp;gt;&lt;/p&gt;

&lt;p&gt;My stack trace is&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
        at org.apache.camel.processor.interceptor.TraceFormatter.getBreadCrumbID(TraceFormatter.java:202)&lt;br/&gt;
        at org.apache.camel.processor.interceptor.TraceFormatter.getExchangeAndNode(TraceFormatter.java:271)&lt;br/&gt;
        at org.apache.camel.processor.interceptor.TraceFormatter.format(TraceFormatter.java:54)&lt;br/&gt;
        at org.apache.camel.processor.interceptor.TraceInterceptor.format(TraceInterceptor.java:97)&lt;br/&gt;
        at org.apache.camel.processor.Logger.logMessage(Logger.java:234)&lt;br/&gt;
        at org.apache.camel.processor.Logger.process(Logger.java:125)&lt;br/&gt;
        at org.apache.camel.processor.interceptor.TraceInterceptor.logException(TraceInterceptor.java:122)&lt;br/&gt;
        at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:90)&lt;br/&gt;
        at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:80)&lt;br/&gt;
        at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:41)&lt;br/&gt;
        at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:55)&lt;br/&gt;
        at org.apache.camel.processor.LoggingErrorHandler.process(LoggingErrorHandler.java:54)&lt;br/&gt;
        at org.apache.camel.impl.converter.AsyncProcessorTypeConverter$ProcessorToAsyncProcessorBridge.process(AsyncProcessorTypeConverter.java:43)&lt;br/&gt;
        at org.apache.camel.processor.Pipeline.process(Pipeline.java:115)&lt;br/&gt;
        at org.apache.camel.processor.Pipeline.process(Pipeline.java:89)&lt;br/&gt;
        at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:68)&lt;br/&gt;
        at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:41)&lt;br/&gt;
        at org.apache.camel.management.InstrumentationProcessor.process(InstrumentationProcessor.java:55)&lt;br/&gt;
        at org.apache.camel.processor.DelegateProcessor.processNext(DelegateProcessor.java:50)&lt;br/&gt;
        at org.apache.camel.processor.DelegateProcessor.proceed(DelegateProcessor.java:79)&lt;br/&gt;
        at org.apache.camel.processor.interceptor.TraceInterceptor.process(TraceInterceptor.java:84)&lt;br/&gt;
        at org.apache.camel.impl.converter.AsyncProcessorTypeConverter$ProcessorToAsyncProcessorBridge.process(AsyncProcessorTypeConverter.java:43)&lt;br/&gt;
        at org.apache.camel.processor.UnitOfWorkProcessor.process(UnitOfWorkProcessor.java:64)&lt;br/&gt;
        at org.apache.camel.util.AsyncProcessorHelper.process(AsyncProcessorHelper.java:41)&lt;br/&gt;
        at org.apache.camel.processor.DelegateAsyncProcessor.process(DelegateAsyncProcessor.java:66)&lt;br/&gt;
        at org.apache.servicemix.camel.CamelProviderEndpoint.handleActiveProviderExchange(CamelProviderEndpoint.java:109)&lt;br/&gt;
        at org.apache.servicemix.camel.CamelProviderEndpoint.process(CamelProviderEndpoint.java:81)&lt;br/&gt;
        at org.apache.servicemix.common.AsyncBaseLifeCycle.doProcess(AsyncBaseLifeCycle.java:631)&lt;br/&gt;
        at org.apache.servicemix.common.AsyncBaseLifeCycle.processExchange(AsyncBaseLifeCycle.java:585)&lt;br/&gt;
        at org.apache.servicemix.common.AsyncBaseLifeCycle.processExchangeInTx(AsyncBaseLifeCycle.java:480)&lt;br/&gt;
        at org.apache.servicemix.common.AsyncBaseLifeCycle$2.run(AsyncBaseLifeCycle.java:349)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:619)&lt;/p&gt;

&lt;p&gt;The code in TraceFormatter.java looks like this:&lt;/p&gt;

&lt;p&gt;    protected Object getBreadCrumbID(Exchange exchange) &lt;/p&gt;
{
        UnitOfWork unitOfWork = exchange.getUnitOfWork();
        return unitOfWork.getId();
    }

&lt;p&gt;But there is code in UnitOfWorkProcessor.process() which seems to indicate that exchange.getUnitOfWork() will sometimes return null. This method begins by saying&lt;/p&gt;

&lt;p&gt;        if (exchange.getUnitOfWork() == null) {&lt;br/&gt;
            // If there is no existing UoW, then we should start one and&lt;br/&gt;
            // terminate it once processing is completed for the exchange.&lt;/p&gt;

&lt;p&gt;Would it be possible to enhance TraceFormatter to simply check for this?  I&apos;m going to try&lt;/p&gt;

&lt;p&gt;    protected Object getBreadCrumbID(Exchange exchange) {&lt;br/&gt;
        UnitOfWork unitOfWork = exchange.getUnitOfWork();&lt;br/&gt;
        if (unitOfWork != null) &lt;/p&gt;
{
            return unitOfWork.getId();
        }
&lt;p&gt; else &lt;/p&gt;
{
           return &quot;[unknown UOW]&quot;;
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;If this doesn&apos;t work, I&apos;ll follow up with a message here.&lt;/p&gt;</comment>
                            <comment id="12952513" author="davsclaus" created="Tue, 9 Jun 2009 06:18:04 +0000"  >&lt;p&gt;Fixed the NPE in 1.x: 782893&lt;br/&gt;
Was already fixed in 2.0&lt;/p&gt;</comment>
                            <comment id="12952512" author="davsclaus" created="Tue, 9 Jun 2009 06:18:29 +0000"  >&lt;p&gt;Thanks Robert for reporting. I have fixed the NPE in 1.x. Will be in the next Camel release 1.6.2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12485892">CAMEL-393</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76978</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 25 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01fo7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6308</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>