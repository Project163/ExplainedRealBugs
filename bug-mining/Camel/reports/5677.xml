<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:46:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-15410] REST endpoint has inconsistent URL Encoding </title>
                <link>https://issues.apache.org/jira/browse/CAMEL-15410</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When passing query parameters to a REST producer the encoding behavior is inconsistent. Consider the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.to(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;:get:bw-web-api/v1/objects/employees?host=agresso&amp;amp;companyId=RD&amp;amp;select=personId,personName&amp;amp;disconnect=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The resulting request payload, as observed with Wireshark, is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
GET /bw-web-api/v1/objects/employees?companyId=RD&amp;amp;disconnect=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;select=personId%252CpersonName HTTP/1.1\r\n&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note that the comma has been double-encoded resulting in transmission of %252C instead of the expected %2C.&lt;/p&gt;

&lt;p&gt;If instead the problem string is passed as a parameter via a header, the comma is correctly encoded:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;select&quot;&lt;/span&gt;, simple(&lt;span class=&quot;code-quote&quot;&gt;&quot;personId,personName&quot;&lt;/span&gt;))
.to(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;:get:bw-web-api/v1/objects/employees?host=agresso&amp;amp;companyId=RD&amp;amp;select={select}&amp;amp;disconnect=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;)&#160;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13322572">CAMEL-15410</key>
            <summary>REST endpoint has inconsistent URL Encoding </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="kris.boutilier@gmail.com">Kris Boutilier</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Aug 2020 16:07:28 +0000</created>
                <updated>Tue, 30 Mar 2021 11:14:30 +0000</updated>
                            <resolved>Tue, 30 Mar 2021 11:14:30 +0000</resolved>
                                    <version>3.4.2</version>
                                    <fixVersion>3.10.0</fixVersion>
                                    <component>rest</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17177130" author="kris.boutilier@gmail.com" created="Thu, 13 Aug 2020 16:25:36 +0000"  >&lt;p&gt;It&apos;s not immediately clear if it&apos;s related to the above, but I&apos;m also having issues with + vs %20 encoding of spaces when passed in via headers and, because the target server is pedantic, requests that use application/x-www-form-urlencoded style encoding are failing.&lt;/p&gt;

&lt;p&gt;For example, this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;filter&quot;&lt;/span&gt;, simple(&lt;span class=&quot;code-quote&quot;&gt;&quot;date(time/date) ge 2020-06-01 and personId eq &lt;span class=&quot;code-quote&quot;&gt;&apos;R10019&apos;&lt;/span&gt;&quot;&lt;/span&gt;))
.to(&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;rest&lt;/span&gt;:get:bw-web-api/v1/objects/timesheets?host=agresso&amp;amp;companyId=RD&amp;amp;select={select}&amp;amp;filter={filter}&amp;amp;onWorkFlow=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;noWorkflow=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;)&#160;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;results in a payload of:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
GET /bw-web-api/v1/objects/timesheets?companyId=RD&amp;amp;filter=date%28time%2Fdate%29+ge+2020-06-01+and+personId+eq+%27R10019%27&amp;amp;noWorkflow=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;onWorkFlow=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;select=personId%2Cperiod%2Ctime%28*%29 HTTP/1.1\r\n&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;however the server is expecting to see this encoding:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
GET /bw-web-api/v1/objects/timesheets?companyId=RD&amp;amp;filter=date%28time%2Fdate%29%20ge%202020-06-01%20and%20personId%20eq%20%27R10019%27&amp;amp;onWorkflow=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;noWorkflow=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;select=personId%2Cperiod%2Ctime%28*%29 HTTP/1.1\r\n&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17308647" author="davsclaus" created="Thu, 25 Mar 2021 12:26:30 +0000"  >&lt;p&gt;Yeah its a PITA that spaces was encoded into + sign in Camel&apos;s creation. &lt;/p&gt;

&lt;p&gt;And I recall we had issues with some HTTP servers that expected + for spaces instead of %20.&lt;br/&gt;
However for correctness it would be better to use %20 (maybe have a global configuration in Camel to turn old style back on)&lt;/p&gt;</comment>
                            <comment id="17308659" author="davsclaus" created="Thu, 25 Mar 2021 12:39:13 +0000"  >&lt;p&gt;What camel component do you use as the http client, is that camel-http, camel-netty-http, or something else?&lt;/p&gt;</comment>
                            <comment id="17308663" author="davsclaus" created="Thu, 25 Mar 2021 12:53:02 +0000"  >&lt;p&gt;Here is a beginning of an unit test&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/commit/d7f3ad44922d638b4b3fb5b370bee7103d5dbb65&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/commit/d7f3ad44922d638b4b3fb5b370bee7103d5dbb65&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Would be good to add wireshark capture or similar and check the actual HTTP content being sent.&lt;/p&gt;</comment>
                            <comment id="17308738" author="davsclaus" created="Thu, 25 Mar 2021 14:57:35 +0000"  >&lt;p&gt;With a HTTP echo server I get&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
GET /bw-web-api/v1/objects/timesheets?companyId=RD&amp;amp;filter=date%28time%2Fdate%29+ge+2020-06-01+and+personId+eq+%27R10019%27&amp;amp;select=personId%2CpersonName HTTP/1.1&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So the plus sign is still there&lt;/p&gt;</comment>
                            <comment id="17308880" author="davsclaus" created="Thu, 25 Mar 2021 18:15:16 +0000"  >&lt;p&gt;The plus sign is now fixed to be %20&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;GET /bw-web-api/v1/objects/timesheets?companyId=RD&amp;amp;filter=date%28time%2Fdate%29%20ge%202020-06-01%20and%20personId%20eq%20%27R10019%27&amp;amp;select=personId%2CpersonName HTTP/1.1&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17309465" author="jeremyross" created="Fri, 26 Mar 2021 14:27:28 +0000"  >&lt;p&gt;Spaces should be encoded to &quot;%20&quot; in the path, and &quot;+&quot; in the query and fragment. So,&lt;/p&gt;

&lt;p&gt;Before &quot;?&quot;: %20&lt;br/&gt;
After &quot;?&quot;: +&lt;/p&gt;

&lt;p&gt;First two answers &lt;a href=&quot;https://stackoverflow.com/questions/1634271/url-encoding-the-space-character-or-20&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt; are pretty good.&lt;/p&gt;</comment>
                            <comment id="17311362" author="davsclaus" created="Tue, 30 Mar 2021 10:17:30 +0000"  >&lt;p&gt;Hi Jeremy&lt;/p&gt;

&lt;p&gt;I didnt spot your comment. There is a post on dev mailing list.&lt;/p&gt;

&lt;p&gt;Yes URL encoding is sadly yet another thing in IT that is ambiguous and can cause problems.&lt;/p&gt;

&lt;p&gt;The rule about + is for HTML forms, with content-type: application/x-www-form-urlencoded&lt;br/&gt;
&lt;a href=&quot;https://www.w3.org/TR/1999/REC-html401-19991224/interact/forms.html#h-17.13.4.1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.w3.org/TR/1999/REC-html401-19991224/interact/forms.html#h-17.13.4.1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The percent encoding with %20 as space is something all HTTP servers is capable of doing, so using %20 in URLs is safe.&lt;/p&gt;

&lt;p&gt;The special + rule is only for HTTP and something that potentially servers may struggle with. It may be that they only decode + as space, if there is a HTTP header with:&lt;/p&gt;

&lt;p&gt;Content-Type: application/x-www-form-urlencoded&lt;/p&gt;

&lt;p&gt;And Camel would not send that by default. Also if you use HTTP POST with content in the message body, and query parameters also in the URI that has spaces, then what Content-Type should you use? ie. if the HTTP POST body is json data.&lt;/p&gt;


&lt;p&gt;For non HTTP components then decimal encoding space as %20 makes it consistent&lt;/p&gt;

&lt;p&gt;sql:my-database?select%20from%20myorders&lt;/p&gt;

&lt;p&gt;vs&lt;/p&gt;

&lt;p&gt;sql:my-database?select+from+myorders&lt;/p&gt;

&lt;p&gt;And especially if the query ends up with + to be used as plus, eg&lt;br/&gt;
For example if you could so something ala (yes its not correct SQL)&lt;/p&gt;

&lt;p&gt;sql:my-database?update ages set age = age + 2&lt;/p&gt;

&lt;p&gt;Then it would be encoded as&lt;/p&gt;

&lt;p&gt;sql:my-database?update+ages+set+age+%3D+age+%2B+2&lt;/p&gt;

&lt;p&gt;And in pure decimal it would be&lt;/p&gt;

&lt;p&gt;sql:my-database?update%20ages%20set%20age%20%3D%20age%20%2B%202&lt;/p&gt;

&lt;p&gt;When you see % decimail encoding then you know its encoded, but if you do not and see a plus sign you may think its the math operator&lt;/p&gt;

&lt;p&gt;to(&quot;foo:bar?beer=2+3&quot;)&lt;/p&gt;



</comment>
                            <comment id="17311385" author="davsclaus" created="Tue, 30 Mar 2021 10:36:57 +0000"  >&lt;p&gt;I do think it may be better to make this configurable and keep the old behavior as default (so Camel stays the same).&lt;br/&gt;
And then allow to turn on to use %20 as spaces for the HTTP components so this can be used for HTTP servers that has problems.&lt;/p&gt;</comment>
                            <comment id="17311425" author="davsclaus" created="Tue, 30 Mar 2021 11:12:17 +0000"  >&lt;p&gt;Okay we are as before with using plus signs for spaces.&lt;/p&gt;</comment>
                            <comment id="17311430" author="davsclaus" created="Tue, 30 Mar 2021 11:14:30 +0000"  >&lt;p&gt;Lets leave it as this.&lt;/p&gt;

&lt;p&gt;Adding support for plus as space for all the http components is tedious work. We can look at this later if more Camel end users hit this problem with HTTP servers.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 33 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0hqxk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>