<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:59:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-6867] camel-hdfs - HdfsProducer filename collisions when Producer instance recreated</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-6867</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;The HdfsProducer uses an instance variable (long splitNum) that is incremented to create unique output filenames in a given directory (seg0, seg1, etc).  &lt;/p&gt;

&lt;p&gt;If the Producer instance is recreated (producer cache limit exceeded, server restart, etc), the splitNum variable is reset to 0.  This results in files being overwritten when using overwrite=true mode or throwing &quot;The file already exists&quot; errors when using overwrite=false mode.&lt;/p&gt;

&lt;p&gt;We should switch to using a timestamp or some other unique generator to prevent filename collisions regardless of the Producer instance lifecycle for the same hdfs directory URL...&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12674173">CAMEL-6867</key>
            <summary>camel-hdfs - HdfsProducer filename collisions when Producer instance recreated</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="boday">Benjamin P. O&apos;Day</assignee>
                                    <reporter username="boday">Benjamin P. O&apos;Day</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Oct 2013 18:38:14 +0000</created>
                <updated>Mon, 21 Oct 2013 03:47:10 +0000</updated>
                            <resolved>Mon, 21 Oct 2013 03:47:10 +0000</resolved>
                                                    <fixVersion>2.11.3</fixVersion>
                    <fixVersion>2.12.2</fixVersion>
                    <fixVersion>2.13.0</fixVersion>
                                    <component>camel-hdfs</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13797376" author="boday" created="Wed, 16 Oct 2013 22:37:24 +0000"  >&lt;p&gt;any objection to using System.nanoTime() for the file name unique Id instead of the the long splitNum++?&lt;/p&gt;</comment>
                            <comment id="13797648" author="davsclaus" created="Thu, 17 Oct 2013 06:16:19 +0000"  >&lt;p&gt;Maybe use messageId from Message which is what the Camel File/FTP components does if no explicit file name has been given?&lt;/p&gt;</comment>
                            <comment id="13798431" author="boday" created="Thu, 17 Oct 2013 21:15:57 +0000"  >&lt;p&gt;the issue with using the messageId is that the connectOnStartup mode creates the initial file stream on startup (no messageId to use in this case).  how about if we use the UUID generator from the CamelContext like this: getEndpoint().getCamelContext().getUuidGenerator().generateUuid()?&lt;/p&gt;

&lt;p&gt;also, any reason to continue to prepend the DEFAULT_SEGMENT_PREFIX with this new approach...the prefix &quot;seg&quot; seems pretty arbitrary and should probably be configurable if we need to keep it...&lt;/p&gt;</comment>
                            <comment id="13798941" author="davsclaus" created="Fri, 18 Oct 2013 09:19:21 +0000"  >&lt;p&gt;Yeah good point of using the uuid generator from Camel.&lt;/p&gt;

&lt;p&gt;And yeah fell free to change that prefix or make it configurable etc, as you think its the best.&lt;/p&gt;</comment>
                            <comment id="13799633" author="boday" created="Fri, 18 Oct 2013 22:58:10 +0000"  >&lt;p&gt;per discussion, changed the split filename logic to use the UUID generator and removed the &quot;seg&quot; prefix from the filenames&lt;/p&gt;

&lt;p&gt;thanks to Sergey Kozlovich (&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=skozlovich&quot; class=&quot;user-hover&quot; rel=&quot;skozlovich&quot;&gt;skozlovich&lt;/a&gt;) for helping find/fix/test this issue&lt;/p&gt;</comment>
                            <comment id="13799648" author="boday" created="Fri, 18 Oct 2013 23:24:11 +0000"  >&lt;p&gt;anyone see an issue with backporting this fix to the 2.10.x, 2.11.x, 2.12.x branches?&lt;/p&gt;</comment>
                            <comment id="13799819" author="davsclaus" created="Sat, 19 Oct 2013 07:10:08 +0000"  >&lt;p&gt;2.10 is no longer supported, so 2.11 onwards is fine.&lt;/p&gt;</comment>
                            <comment id="13800330" author="boday" created="Mon, 21 Oct 2013 03:33:33 +0000"  >&lt;p&gt;merging fixes into 2.11.x, 2.12.x branches&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353795</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 5 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ozwf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>354087</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>