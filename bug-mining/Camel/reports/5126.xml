<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:39:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-14299] camel-sql - Dynamic producer (toD) problem</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-14299</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Spring Boot: 2.2.1&lt;/p&gt;

&lt;p&gt;Camel: 3.0.0&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Works&lt;/b&gt; using &quot;to()&quot;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
from(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;//d:/tmp/?fileName=test&amp;amp;noop=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;)
&lt;/span&gt;.setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;val1&quot;&lt;/span&gt;, constant(1))
.setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;val2&quot;&lt;/span&gt;, constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;yo&quot;&lt;/span&gt;))
.to(&lt;span class=&quot;code-quote&quot;&gt;&quot;sql:insert into gbtemp (col1, col2) values (:#val1, :#val2)?dataSource=#dataSource&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Does &lt;b&gt;not work&lt;/b&gt; using &quot;.toD()&quot;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
from(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;//d:/tmp/?fileName=test&amp;amp;noop=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;)
&lt;/span&gt;.setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;val1&quot;&lt;/span&gt;, constant(1))
.setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;val2&quot;&lt;/span&gt;, constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;yo&quot;&lt;/span&gt;))
.setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;insertSql&quot;&lt;/span&gt;, constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;insert into gbtemp (col1, col2) values (:#val1, :#val2)&quot;&lt;/span&gt;))
.toD(&lt;span class=&quot;code-quote&quot;&gt;&quot;sql:${header.insertSql}?dataSource=#dataSource&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This used to work fine under Camel 2.x&lt;/p&gt;

&lt;p&gt;Example error lines:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: org.apache.camel.RuntimeCamelException: Cannot auto create component: sql

Caused by: org.apache.camel.PropertyBindingException: Error binding properties on bean: org.apache.camel.component.sql.SqlComponent@a72b3b2

org.apache.camel.ResolveEndpointFailedException: Failed to resolve endpoint: sql:&lt;span class=&quot;code-comment&quot;&gt;//insert...&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13274506">CAMEL-14299</key>
            <summary>camel-sql - Dynamic producer (toD) problem</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="Gurpal2000">Gurpal2000</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Dec 2019 22:13:55 +0000</created>
                <updated>Fri, 17 Jan 2020 20:49:02 +0000</updated>
                            <resolved>Tue, 24 Dec 2019 06:28:47 +0000</resolved>
                                    <version>3.0.0</version>
                                    <fixVersion>3.1.0</fixVersion>
                                    <component>camel-sql</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16996987" author="davsclaus" created="Mon, 16 Dec 2019 06:04:41 +0000"  >&lt;p&gt;Can you maybe try with master as we have fixed stuff since 3.0.0 release&lt;/p&gt;</comment>
                            <comment id="16996988" author="davsclaus" created="Mon, 16 Dec 2019 06:11:17 +0000"  >&lt;p&gt;I created a test that could not reproduce this&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/commit/59e26c8cfcdf82267d6bfeb0b7cc005a8df75e4d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/commit/59e26c8cfcdf82267d6bfeb0b7cc005a8df75e4d&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If you have still a problem then add a reproducer and/or provide more details from the stacktrace etc.&lt;/p&gt;</comment>
                            <comment id="16997446" author="gurpal2000" created="Mon, 16 Dec 2019 16:47:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; I created a simple test app with Spring Boot and minimal dependencies, and hopefully this show the behaviour&#160;&lt;a href=&quot;https://github.com/gurpal2000/camelproblemdemo&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/gurpal2000/camelproblemdemo&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Spring Boot 2.2.2.RELEASE + Camel 3.0.0.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Attached the log.&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16997651" author="gurpal2000" created="Mon, 16 Dec 2019 21:21:12 +0000"  >&lt;p&gt;More: in my application.yml I have&#160;&lt;/p&gt;

&lt;p&gt;camel.springboot.main-run-controller: true&lt;/p&gt;

&lt;p&gt;Removing this seems to solve this issue &lt;em&gt;in the particular case where web-starter is used.&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;The documentation says &quot;Applications using web modules (e.g. importing the&#160;&lt;tt&gt;org.springframework.boot:spring-boot-web-starter&lt;/tt&gt;&#160;module), usually don&#8217;t need to use this feature because the application is kept alive by the presence of other non-daemon threads.&quot;&lt;/p&gt;

&lt;p&gt;If I remove the web starter module and remove the h2 web console dependency things start going wrong again.&lt;/p&gt;</comment>
                            <comment id="16998113" author="davsclaus" created="Tue, 17 Dec 2019 11:40:36 +0000"  >&lt;p&gt;Ah for spring boot with Camel you should use camel-sql-starter as dependency, eg generally use -starter JARs&lt;/p&gt;</comment>
                            <comment id="16998121" author="davsclaus" created="Tue, 17 Dec 2019 11:54:42 +0000"  >&lt;p&gt;And your sample project dont run out of the box, can you update to make it work.&lt;/p&gt;</comment>
                            <comment id="16998716" author="gurpal2000" created="Wed, 18 Dec 2019 01:20:59 +0000"  >&lt;p&gt;Ah apologies, a missed the main class; should be good now.&lt;/p&gt;

&lt;p&gt;Also - I switched the camel-sql to camel-sql-starter (I see it&apos;s part of&#160;org.apache.camel.springboot) as per your advice. Removed/disabled web, etc.&lt;/p&gt;

&lt;p&gt;I added a query to read back the count as soon as the insert is done. Things work fine. Moment I remove the to(&quot;direct:query&quot;) start seeing errors again. Did I miss something?&lt;/p&gt;</comment>
                            <comment id="16998857" author="davsclaus" created="Wed, 18 Dec 2019 06:50:14 +0000"  >&lt;p&gt;This works fine for me, cannot reproduce any issue.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    from(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:tmp-datad&quot;&lt;/span&gt;)
      .setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;val1&quot;&lt;/span&gt;, constant(1))
      .setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;val2&quot;&lt;/span&gt;, constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;yo&quot;&lt;/span&gt;))
      .setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;insertSql&quot;&lt;/span&gt;, constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;insert into tmp (col1, col2) values (:#val1, :#val2)&quot;&lt;/span&gt;))
      .toD(&lt;span class=&quot;code-quote&quot;&gt;&quot;sql:${header.insertSql}?dataSource=#dataSource&quot;&lt;/span&gt;)
      &lt;span class=&quot;code-comment&quot;&gt;//.to(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:query&quot;&lt;/span&gt;)
&lt;/span&gt;    ;

    from(&lt;span class=&quot;code-quote&quot;&gt;&quot;timer:query&quot;&lt;/span&gt;)
      .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;sql:select count(*) from tmp?outputType=SelectOne&amp;amp;dataSource=#dataSource&quot;&lt;/span&gt;)
      .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;log:result&quot;&lt;/span&gt;)
    ;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This logs the 0 and 1 as output when a file is created in that folder&lt;/p&gt;

&lt;p&gt;2019-12-18 07:49:03.679  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 0&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:04.683  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 0&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:05.688  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 0&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:06.691  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 0&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:07.696  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 0&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:08.699  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 0&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:09.703  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 0&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:10.706  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 0&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:11.709  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:12.712  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:13.712  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:14.716  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
2019-12-18 07:49:15.718  INFO 58546 &amp;#8212; &lt;span class=&quot;error&quot;&gt;&amp;#91;- timer://query&amp;#93;&lt;/span&gt; result                                   : Exchange&lt;span class=&quot;error&quot;&gt;&amp;#91;ExchangePattern: InOnly, BodyType: Long, Body: 1&amp;#93;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="16999594" author="gurpal2000" created="Wed, 18 Dec 2019 23:42:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; Going crazy here. I&apos;ve done exactly the same as you except my from looks like this for example on windows&#160;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
from(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;//d:/tmp-data&quot;&lt;/span&gt;)&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And then comment out the timer:query. As soon as i create the &quot;test&quot; file in the directory I get the errors. And with the errors filling up my screen, when i remove the test file, the errors stop.&lt;/p&gt;

&lt;p&gt;I&apos;ve added a short video on github - &lt;a href=&quot;https://github.com/gurpal2000/camelproblemdemo/blob/master/CAMEL-14299.mp4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/gurpal2000/camelproblemdemo/blob/master/CAMEL-14299.mp4&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tried on a different PC same result. Code still works fine with 2.24.1&lt;/p&gt;

&lt;p&gt;If i put a sql select as the FIRST thing, then things work, eg:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
from(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:&lt;span class=&quot;code-comment&quot;&gt;//d:/tmp-data&quot;&lt;/span&gt;)
&lt;/span&gt;.to(&quot;sql:select 1?dataSource=...)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It&apos;s almost like there is a difference in how the datasource is initialised or autoconf&apos;d with camel between camel 2 and 3. For me unfortunately this is a blocker in using Camel 3 and I&apos;ve to continue with 2.x. I don&apos;t know where the root cause is Spring or Camel.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; Reopening - but please Close if you feel that is the right thing to do. I&apos;ll post on Stack if you do choose to close.&lt;/p&gt;</comment>
                            <comment id="17001989" author="gurpal2000" created="Sun, 22 Dec 2019 20:49:34 +0000"  >&lt;p&gt;See prior comments. Reopening - but please Close if you feel that is the right thing to do. I&apos;ll post on Stack if you do choose to close.&lt;/p&gt;</comment>
                            <comment id="17002000" author="bedla" created="Sun, 22 Dec 2019 22:14:03 +0000"  >&lt;p&gt;I can reproduce this with your code. The datasource is auto configured with spring boot. During this initialization there are some calls to openConnection, which causes HikariConfig to seal. Then comes in place Camel Introspection trying to set DataSource to HikariConfig object, which is already sealed and cannot be modified (fails with exception &lt;b&gt;&lt;tt&gt;The configuration of the pool is sealed once started. Use HikariConfigMXBean for runtime changes.&lt;/tt&gt;&lt;/b&gt;).&lt;/p&gt;

&lt;p&gt;Until we find solution, you can use one of these workarounds:&lt;/p&gt;

&lt;p&gt;Replace &lt;b&gt;toD&lt;/b&gt; with &lt;b&gt;to&lt;/b&gt; and &lt;b&gt;CamelSqlQuery&lt;/b&gt; header&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      .setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;insertSql&quot;&lt;/span&gt;, constant(&lt;span class=&quot;code-quote&quot;&gt;&quot;insert into tmp (col1, col2) values (:?val1, :?val2)&quot;&lt;/span&gt;)) &lt;span class=&quot;code-comment&quot;&gt;//Notice ? instead of #
&lt;/span&gt;      .setHeader(&lt;span class=&quot;code-quote&quot;&gt;&quot;CamelSqlQuery&quot;&lt;/span&gt;, header(&lt;span class=&quot;code-quote&quot;&gt;&quot;insertSql&quot;&lt;/span&gt;))
      .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;sql:insert?dataSource=#dataSource&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;OR downgrade hikari in your pom to lower version , where sealing mechanism was not implemented&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;dependency&amp;gt;
      &amp;lt;groupId&amp;gt;com.zaxxer&amp;lt;/groupId&amp;gt;
      &amp;lt;artifactId&amp;gt;HikariCP&amp;lt;/artifactId&amp;gt;
      &amp;lt;version&amp;gt;2.7.4&amp;lt;/version&amp;gt;
    &amp;lt;/dependency&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17002222" author="gurpal2000" created="Mon, 23 Dec 2019 11:42:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bedla&quot; class=&quot;user-hover&quot; rel=&quot;bedla&quot;&gt;bedla&lt;/a&gt; Thank you for your in depth analysis; a seasonal present &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Question: why would Camel try to set the DS to HikariConfig? I thought one benefit of using Spring/Boot with Camel was so that those sort of things are already taken care of to some extent.&lt;/p&gt;

&lt;p&gt;(Could it be related to: &lt;a href=&quot;https://github.com/brettwooldridge/HikariCP/issues/1095&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/brettwooldridge/HikariCP/issues/1095&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="17002418" author="davsclaus" created="Mon, 23 Dec 2019 18:10:53 +0000"  >&lt;p&gt;Jan can you post more details. I dont immediately see Camel setting or introspecting datasource.&lt;/p&gt;</comment>
                            <comment id="17002465" author="bedla" created="Mon, 23 Dec 2019 20:25:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; I also dont see any direct introspection in code, but it is happening. After increasing logging level with property&#160;&lt;b&gt;bean-introspection-logging-level: info&lt;/b&gt; then right before the exception is logged.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Invoked: 203 times (overall) [Method: setProperty, Target: HikariDataSource (HikariPool-1), Arguments: [dataSource, HikariDataSource (HikariPool-1)]]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;To see the exception you need to comment out the timer route in the reproducer code. Full log with logged introspection is here &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12989400/12989400_CAMEL-14299.log&quot; title=&quot;CAMEL-14299.log attached to CAMEL-14299&quot;&gt;CAMEL-14299.log&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Gurpal2000&quot; class=&quot;user-hover&quot; rel=&quot;Gurpal2000&quot;&gt;Gurpal2000&lt;/a&gt;&#160;Another workaround you can use in the meantime is to warmup sql component. Call&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
getContext().getComponent(&lt;span class=&quot;code-quote&quot;&gt;&quot;sql&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;on the beginning of configure method in RouteBuilder&#160;&lt;/p&gt;</comment>
                            <comment id="17002524" author="gurpal2000" created="Mon, 23 Dec 2019 22:42:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bedla&quot; class=&quot;user-hover&quot; rel=&quot;bedla&quot;&gt;bedla&lt;/a&gt; agreed the warmup works; requires less code alteration. Better than .to(&quot;sql:select 1&quot;) also.&lt;/p&gt;</comment>
                            <comment id="17002684" author="davsclaus" created="Tue, 24 Dec 2019 06:28:47 +0000"  >&lt;p&gt;This has been fixed for 3.1.&lt;/p&gt;
</comment>
                            <comment id="17018304" author="gurpal2000" created="Fri, 17 Jan 2020 20:49:02 +0000"  >&lt;p&gt;Fantastic thank you all.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13276184">CAMEL-14329</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12989400" name="CAMEL-14299.log" size="143110" author="bedla" created="Mon, 23 Dec 2019 20:20:51 +0000"/>
                            <attachment id="12988948" name="log.txt" size="41201" author="Gurpal2000" created="Mon, 16 Dec 2019 18:51:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 43 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09o9k:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>