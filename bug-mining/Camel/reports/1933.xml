<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:52:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-5411] MQTT Endpoint does not correctly return the MQTT-Payload</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-5411</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;MQTT Endpoint does not correctly return the MQTT-Payload. It returns the whole MQTT Message (header + payload).&lt;/p&gt;

&lt;p&gt;The bug is in line 89 of MQTTEndpoint.java (version 2.11, but also in 2.10)&lt;/p&gt;

&lt;p&gt; exchange.getIn().setBody(body.getData());&lt;/p&gt;

&lt;p&gt;must become&lt;/p&gt;

&lt;p&gt; exchange.getIn().setBody(body.toByteArray()); &lt;/p&gt;

&lt;p&gt;because getData() ignores the offset (to skip the MQTT header) set in the body byte array.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux 64bit, JDK 1.6, Mosquitto MQTT Broker&lt;/p&gt;</environment>
        <key id="12596395">CAMEL-5411</key>
            <summary>MQTT Endpoint does not correctly return the MQTT-Payload</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rajdavies">Robert Davies</assignee>
                                    <reporter username="ralfkornberger">Ralf Kornberger</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Jun 2012 13:02:09 +0000</created>
                <updated>Wed, 15 Aug 2012 17:27:54 +0000</updated>
                            <resolved>Wed, 15 Aug 2012 17:27:54 +0000</resolved>
                                    <version>2.10.0</version>
                                    <fixVersion>2.10.1</fixVersion>
                    <fixVersion>2.11.0</fixVersion>
                                    <component>camel-mqtt</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13403878" author="ralfkornberger" created="Fri, 29 Jun 2012 13:05:36 +0000"  >&lt;p&gt;Patch with bug fixed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13403885" author="davsclaus" created="Fri, 29 Jun 2012 13:13:50 +0000"  >&lt;p&gt;Isn&apos;t there some headers from MQTT, you would need to map into Camel Message Headers as well?&lt;/p&gt;</comment>
                            <comment id="13403895" author="ralfkornberger" created="Fri, 29 Jun 2012 13:31:47 +0000"  >&lt;p&gt;I use Camel to fetch a Message (XML, Protobuf, ...) from the Broker. Using Camel-MQTT, as it is, the message is fetched, but the body still includes the MQTT header (topic and binary stuff before) which I don&apos;t want. I only want the payload (=my xml or protobuf stuff). &lt;br/&gt;
Here is an example:&lt;/p&gt;

&lt;p&gt;I sent the String &apos;Test123&apos; via MQTT to Camel. Using the example code from your website &lt;/p&gt;


&lt;p&gt; from(&quot;mqtt:bar?subscribeTopicName=test.mqtt.topic&quot;).transform(body().convertToString()).bean (myProcessingBean);&lt;/p&gt;

&lt;p&gt;I expect body to be &apos;Test123&apos;. But instead body is something like &apos;0&#65533;&lt;sup&gt;C&lt;/sup&gt;@^Ktest.mqtt.topicTest123&apos; (the stuff before test.mqtt.topic are nonprintable chars).&lt;br/&gt;
So the body is the whole MQTT message instead of just the payload. I makes no sense to have the full MQTT message as body here because you can&apos;t really decode/spilt it well&lt;br/&gt;
without going deeply into the MQTT implemenation of the the MQTT Client (from org.fusesource.mqtt-client in my case). &lt;br/&gt;
But when you apply the patch, it (in my opinion) sets body corretly to &apos;Test123&apos;.&lt;/p&gt;





</comment>
                            <comment id="13403948" author="davsclaus" created="Fri, 29 Jun 2012 14:43:20 +0000"  >&lt;p&gt;Ralf, yeah your patch makes sense. But then we may also want to map headers from MQTT to Camel Message Headers. So you get both body + headers from MQTT mapped to the Camel Message.&lt;/p&gt;
</comment>
                            <comment id="13403949" author="davsclaus" created="Fri, 29 Jun 2012 14:43:42 +0000"  >&lt;p&gt;Rob, can you take a look&lt;/p&gt;</comment>
                            <comment id="13413611" author="rajdavies" created="Fri, 13 Jul 2012 09:42:17 +0000"  >&lt;p&gt;Added fix in Subversion: Committed revision 1361126. There&apos;s still some weirdness (timing issue) with publishing, which should be addressed in next release of ActiveMQ&lt;/p&gt;</comment>
                            <comment id="13435325" author="davsclaus" created="Wed, 15 Aug 2012 17:27:54 +0000"  >&lt;p&gt;Merged to 2.10 branch as well.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12533977" name="MQTTEndpoint.java.patch" size="571" author="ralfkornberger" created="Fri, 29 Jun 2012 13:05:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10062"><![CDATA[Moderate]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>241284</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i026xb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10723</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>