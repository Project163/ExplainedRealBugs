<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:11:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-22117] camel-openapi-validator doesn&apos;t use query params or headers for validation</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-22117</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;camel-openapi-validator doesn&apos;t provide query params or headers to the underlying OpenApiInteractionValidator for use in validation. Hence if the openapi specification contains required headers or query params, the validation will erroneously fail even if the query params or headers are present. They should be added to the context prior to the validation:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SimpleRequest.Builder builder = ...

&lt;span class=&quot;code-comment&quot;&gt;// Use all non-Camel headers
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Entry&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;&amp;gt; header : exchange.getMessage().getHeaders().entrySet()) {
    &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isCamelHeader = header.getKey().startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;Camel&quot;&lt;/span&gt;)
            || header.getKey().startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;camel&quot;&lt;/span&gt;)
            || header.getKey().startsWith(&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.camel.&quot;&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isCamelHeader) {
        builder.withHeader(header.getKey(), header.getValue().toString());
    }
}
&lt;span class=&quot;code-comment&quot;&gt;// Use query parameters, &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; present
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; query = exchange.getMessage().getHeader(Exchange.HTTP_QUERY, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;.class);
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (query != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] params = query.split(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;amp;&quot;&lt;/span&gt;);
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; param : params) {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] keyValue = param.split(&lt;span class=&quot;code-quote&quot;&gt;&quot;=&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (keyValue.length == 2) {
            builder.withQueryParam(keyValue[0], keyValue[1]);
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (keyValue.length == 1) {
            builder.withQueryParam(keyValue[0], &quot;&quot;);
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13619421">CAMEL-22117</key>
            <summary>camel-openapi-validator doesn&apos;t use query params or headers for validation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="beskow">Bjorn Beskow</reporter>
                        <labels>
                    </labels>
                <created>Wed, 28 May 2025 11:17:37 +0000</created>
                <updated>Sat, 31 May 2025 13:10:12 +0000</updated>
                            <resolved>Sat, 31 May 2025 13:10:12 +0000</resolved>
                                    <version>4.10.4</version>
                    <version>4.11.0</version>
                                    <fixVersion>4.8.8</fixVersion>
                    <fixVersion>4.10.6</fixVersion>
                    <fixVersion>4.13.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17954856" author="davsclaus" created="Thu, 29 May 2025 05:48:49 +0000"  >&lt;p&gt;Thanks are your PRs on the way as we will do a 4.10.x patch release soon&lt;/p&gt;</comment>
                            <comment id="17955124" author="beskow" created="Fri, 30 May 2025 07:18:27 +0000"  >&lt;p&gt;The pull request &lt;a href=&quot;https://github.com/apache/camel/pull/18233&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/18233&lt;/a&gt; is submitted now&lt;/p&gt;</comment>
                            <comment id="17955368" author="davsclaus" created="Sat, 31 May 2025 07:34:33 +0000"  >&lt;p&gt;the default validator has this logic&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/blob/main/core/camel-support/src/main/java/org/apache/camel/support/processor/DefaultRestClientRequestValidator.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/main/core/camel-support/src/main/java/org/apache/camel/support/processor/DefaultRestClientRequestValidator.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17955372" author="beskow" created="Sat, 31 May 2025 08:07:42 +0000"  >&lt;p&gt;Yes, the DefaultRestClientRequestValidator correctly validates both headers and query params (as well as content type and the presence of a required request body) But it doesn&apos;t validate a request body against the openapi schema, hence the need for a more sophisticated validation implementation.&lt;/p&gt;

&lt;p&gt;The camel-openapi-validator delegates the validation responsibility to&#160;&lt;br/&gt;
OpenApiInteractionValidator (from swagger-request-validator-core). In doing so, all available input data for validation (headers, query parameters as well as request body) must be provided to OpenApiInteractionValidator.&lt;/p&gt;</comment>
                            <comment id="17955373" author="davsclaus" created="Sat, 31 May 2025 08:16:37 +0000"  >&lt;p&gt;Yes that is correct but I just wanted to refer to the default how it does header / query etc. So maybe something can be done in the same way or improved on both sides&lt;/p&gt;

&lt;p&gt;The schema validator is in that big Atlassian library.&lt;/p&gt;</comment>
                            <comment id="17955381" author="beskow" created="Sat, 31 May 2025 08:43:46 +0000"  >&lt;p&gt;Yes, I see. Good discussion!&lt;/p&gt;

&lt;p&gt;Since DefaultRestClientRequestValidator behaves &quot;the other way around&quot; (comparing the required headers and query parameters to what is present in the exchange as headers), it performa a simpler task: it doesn&apos;t have to distinguish between camel headers and original headers, or to distinguish headers from query params (since all query params becomes headers on the exchange).&lt;/p&gt;

&lt;p&gt;In camel-openapi-validator, the original headers and the query parameters needs to be &quot;recomputed&quot; from the exchange headers, in order for them to be provided separately to OpenApiInteractionValidator.&lt;/p&gt;

&lt;p&gt;Maybe there is a simpler or more elegant way to do that, but it is not obvious to me. Any suggestions would be welcome!&lt;/p&gt;</comment>
                            <comment id="17955412" author="davsclaus" created="Sat, 31 May 2025 13:10:12 +0000"  >&lt;p&gt;Thanks for reporting and sending the PRs and taking in feedback&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            23 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1w2qw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>