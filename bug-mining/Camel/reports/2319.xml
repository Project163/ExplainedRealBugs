<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:57:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-6400] CamelContext fails to start using placeholder in &quot;simple&quot; in conjunction with BridgePropertyPlaceholder</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-6400</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Recently after upgrading from 2.10.3 to 2.11.0 I have encountered the following bug.&lt;br/&gt;
The problematic part was looking like this: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;from(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:start&quot;&lt;/span&gt;)
    .setHeader(Exchange.FILE_NAME, simple(&lt;span class=&quot;code-quote&quot;&gt;&quot;{{file.rootdir}}/${in.header.CamelFileName}&quot;&lt;/span&gt;))
    .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;mock:result&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 
&lt;p&gt;Camel was failing to start with the following exception&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.camel.FailedToCreateRouteException: Failed to create route route1 at: &amp;gt;&amp;gt;&amp;gt; SetHeader[CamelFileName, simple{Simple: {{file.rootdir}}/${in.header.CamelFileName}}] &amp;lt;&amp;lt;&amp;lt; in route: Route(route1)[[From[direct:start]] -&amp;gt; [SetHeader[CamelFileNa... because of Could not resolve placeholder &lt;span class=&quot;code-quote&quot;&gt;&apos;in.header.CamelFileName&apos;&lt;/span&gt; in string value &lt;span class=&quot;code-quote&quot;&gt;&quot;/root/dir/${in.header.CamelFileName}&quot;&lt;/span&gt;
	at org.apache.camel.model.RouteDefinition.addRoutes(RouteDefinition.java:883)
	at org.apache.camel.model.RouteDefinition.addRoutes(RouteDefinition.java:176)
	at org.apache.camel.impl.DefaultCamelContext.startRoute(DefaultCamelContext.java:755)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:1857)
	at org.apache.camel.impl.DefaultCamelContext.addRouteDefinitions(DefaultCamelContext.java:692)
	at org.apache.camel.builder.RouteBuilder.populateRoutes(RouteBuilder.java:337)
	at org.apache.camel.builder.RouteBuilder.addRoutesToCamelContext(RouteBuilder.java:264)
	at org.apache.camel.impl.DefaultCamelContext.addRoutes(DefaultCamelContext.java:654)
	at org.apache.camel.ContextTestSupport.setUp(ContextTestSupport.java:115)
	at org.apache.camel.spring.SpringTestSupport.setUp(SpringTestSupport.java:54)
	at org.apache.camel.TestSupport.runBare(TestSupport.java:58)
	at org.junit.internal.runners.JUnit38ClassRunner.run(JUnit38ClassRunner.java:84)
	at org.junit.runner.JUnitCore.run(JUnitCore.java:160)
	at com.intellij.rt.execution.junit.JUnitStarter.main(JUnitStarter.java:63)
Caused by: java.lang.IllegalArgumentException: Could not resolve placeholder &lt;span class=&quot;code-quote&quot;&gt;&apos;in.header.CamelFileName&apos;&lt;/span&gt; in string value &lt;span class=&quot;code-quote&quot;&gt;&quot;/root/dir/${in.header.CamelFileName}&quot;&lt;/span&gt;
	at org.springframework.util.PropertyPlaceholderHelper.parseStringValue(PropertyPlaceholderHelper.java:173)
	at org.springframework.util.PropertyPlaceholderHelper.replacePlaceholders(PropertyPlaceholderHelper.java:125)
	at org.apache.camel.spring.spi.BridgePropertyPlaceholderConfigurer.springResolvePlaceholders(BridgePropertyPlaceholderConfigurer.java:180)
	at org.apache.camel.spring.spi.BridgePropertyPlaceholderConfigurer.parseUri(BridgePropertyPlaceholderConfigurer.java:143)
	at org.apache.camel.component.properties.PropertiesComponent.parseUri(PropertiesComponent.java:161)
	at org.apache.camel.component.properties.PropertiesComponent.parseUri(PropertiesComponent.java:120)
	at org.apache.camel.impl.DefaultCamelContext.resolvePropertyPlaceholders(DefaultCamelContext.java:1100)
	at org.apache.camel.model.ProcessorDefinition.resolvePropertyPlaceholders(ProcessorDefinition.java:556)
	at org.apache.camel.model.ProcessorDefinition.makeProcessor(ProcessorDefinition.java:471)
	at org.apache.camel.model.ProcessorDefinition.addRoutes(ProcessorDefinition.java:197)
	at org.apache.camel.model.RouteDefinition.addRoutes(RouteDefinition.java:880)
	... 22 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;I have created a small test to reproduce the bug, and thanks to git bisect I found the commit that introduced this bug. It is commit ea4c0ab5 &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-6233&quot; title=&quot;BridgePropertyPlaceholderConfigurer does not support nested Spring properties&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-6233&quot;&gt;&lt;del&gt;CAMEL-6233&lt;/del&gt;&lt;/a&gt;: BridgePropertyPlaceholderConfigurer does not support nested Spring properties&quot;. The problem is that it is trying to resolve the whole simple with the property resolver but after resolving the spring property it treats &lt;tt&gt;$&amp;#123;in.header.CamelFileName&amp;#125;&lt;/tt&gt; as a spring placeholder and fails to find it.&lt;br/&gt;
There is a workaround. If &lt;tt&gt;&amp;#123;&amp;#123;file.rootdir&amp;#125;&amp;#125;&lt;/tt&gt; is replaced by &lt;tt&gt;$&amp;#123;properties:file.rootdir&amp;#125;&lt;/tt&gt; then Camel starts just fine.&lt;/p&gt;

&lt;p&gt;The test to reproduce is attached.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12649488">CAMEL-6400</key>
            <summary>CamelContext fails to start using placeholder in &quot;simple&quot; in conjunction with BridgePropertyPlaceholder</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="nerses_am">Nerses Aznauryan</reporter>
                        <labels>
                    </labels>
                <created>Sun, 26 May 2013 22:46:59 +0000</created>
                <updated>Mon, 16 Feb 2015 19:45:21 +0000</updated>
                            <resolved>Mon, 16 Feb 2015 19:45:21 +0000</resolved>
                                    <version>2.11.0</version>
                                    <fixVersion>Future</fixVersion>
                                    <component>camel-spring</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13667425" author="nerses_am" created="Sun, 26 May 2013 22:50:23 +0000"  >&lt;p&gt;test to reproduce &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-6400&quot; title=&quot;CamelContext fails to start using placeholder in &amp;quot;simple&amp;quot; in conjunction with BridgePropertyPlaceholder&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-6400&quot;&gt;&lt;del&gt;CAMEL-6400&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13668094" author="davsclaus" created="Tue, 28 May 2013 04:49:44 +0000"  >&lt;p&gt;You should use $simple{ } to avoid spring clashing with this, or set the option on the BridgePropertyPlaceholderConfigurer  to ignore unknown placeholderes.&lt;/p&gt;

&lt;p&gt;Its a caveat when using this BridgePropertyPlaceholderConfigurer &lt;/p&gt;</comment>
                            <comment id="13668109" author="davsclaus" created="Tue, 28 May 2013 05:51:41 +0000"  >&lt;p&gt;I added a note to the docs about this clash.&lt;/p&gt;</comment>
                            <comment id="13668617" author="nerses_am" created="Tue, 28 May 2013 20:04:07 +0000"  >&lt;p&gt;Not sure what you mean by $simple{}. Can you please correct the above example?&lt;/p&gt;

&lt;p&gt;But besides this still think there is a bug. Because when first time it replaces all &lt;tt&gt;&amp;#123;&amp;#123;file.rootdir&amp;#125;&amp;#125;&lt;/tt&gt; properties and returns the parsed one with nested spring placeholder it should not pass the whole &lt;tt&gt;$&amp;#123;spring.nested&amp;#125;/$&amp;#123;in.header.CamelFileName&amp;#125;&lt;/tt&gt; to resolve the nested ones but need to pass only the &lt;tt&gt;$&amp;#123;spring.nested&amp;#125;&lt;/tt&gt; part.&lt;/p&gt;</comment>
                            <comment id="14323178" author="davsclaus" created="Mon, 16 Feb 2015 19:45:04 +0000"  >&lt;p&gt;You should do&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    .setHeader(Exchange.FILE_NAME, simple(&lt;span class=&quot;code-quote&quot;&gt;&quot;{{file.rootdir}}/$simple{in.header.CamelFileName}&quot;&lt;/span&gt;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12640344">CAMEL-6233</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12584882" name="tests_to_reproduce_bug.patch" size="6591" author="nerses_am" created="Sun, 26 May 2013 22:50:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>329815</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 40 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kwgn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>330150</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>