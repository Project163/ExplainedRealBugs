<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:50:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-17128] MLLP charset is no longer overridable from the HL7 message MSH 18</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-17128</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Seems that in the latest 3.13 SNAPSHOT it is no longer possible for the charset to be set from the HL7 message sent to the MLLP consumer. The default charset does not appear to be overridable as it&apos;s always setting the charset exchange header.&lt;/p&gt;

&lt;p&gt;See also:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/camel-quarkus/issues/3225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel-quarkus/issues/3225&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Test case in camel-quarkus:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/camel-quarkus/blob/main/integration-tests/mllp/src/test/java/org/apache/camel/quarkus/component/mllp/it/MllpTest.java#L57-L78&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel-quarkus/blob/main/integration-tests/mllp/src/test/java/org/apache/camel/quarkus/component/mllp/it/MllpTest.java#L57-L78&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13408358">CAMEL-17128</key>
            <summary>MLLP charset is no longer overridable from the HL7 message MSH 18</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ffang">Freeman Yue Fang</assignee>
                                    <reporter username="jamesnetherton">James Netherton</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Oct 2021 06:33:52 +0000</created>
                <updated>Fri, 5 Nov 2021 21:07:20 +0000</updated>
                            <resolved>Fri, 5 Nov 2021 14:18:22 +0000</resolved>
                                    <version>3.13.0</version>
                                    <fixVersion>3.13.0</fixVersion>
                                    <component>camel-mllp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17438909" author="ffang" created="Thu, 4 Nov 2021 20:00:32 +0000"  >&lt;p&gt;If we change MllpCharsetHelper a bit to check charset firstly from the MSH 18 of the HL7 message like below, this can fix the mllp test case in camel-quarkus.&lt;/p&gt;

&lt;p&gt;So the logic is &lt;br/&gt;
1. check charset from MSH 18 of the HL7 message &lt;br/&gt;
2. if not find check the charset set in the exchange&lt;br/&gt;
3. if not find return the default charset.&lt;/p&gt;

&lt;p&gt;If this change(it won&apos;t break tests in camel-mllp component) is OK I will send a PR&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
git diff .
diff --git a/components/camel-mllp/src/main/java/org/apache/camel/component/mllp/MllpCharsetHelper.java b/components/camel-mllp/src/main/java/org/apache/camel/component/mllp/MllpCharsetHelper.java
index 52e15388eea3..b5b4faca4265 100644
--- a/components/camel-mllp/src/main/java/org/apache/camel/component/mllp/MllpCharsetHelper.java
+++ b/components/camel-mllp/src/main/java/org/apache/camel/component/mllp/MllpCharsetHelper.java
@@ -43,16 +43,6 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MllpCharsetHelper {
     }
 
     &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Charset getCharset(Exchange exchange, &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] hl7Bytes, Hl7Util hl7Util, Charset defaultCharset) {
-        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; exchangeCharsetName = ExchangeHelper.getCharsetName(exchange, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
-        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (exchangeCharsetName != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !exchangeCharsetName.isEmpty()) {
-            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
-                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (Charset.isSupported(exchangeCharsetName)) {
-                    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Charset.forName(exchangeCharsetName);
-                }
-            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception charsetEx) {
-                &lt;span class=&quot;code-comment&quot;&gt;// ignore
&lt;/span&gt;-            }
-        }
 
         &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; msh18 = hl7Util.findMsh18(hl7Bytes, defaultCharset);
         &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (msh18 != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !msh18.isEmpty()) {
@@ -68,6 +58,16 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MllpCharsetHelper {
             }
         }
 
+        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; exchangeCharsetName = ExchangeHelper.getCharsetName(exchange, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (exchangeCharsetName != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !exchangeCharsetName.isEmpty()) {
+            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
+                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (Charset.isSupported(exchangeCharsetName)) {
+                    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; Charset.forName(exchangeCharsetName);
+                }
+            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception charsetEx) {
+                &lt;span class=&quot;code-comment&quot;&gt;// ignore
&lt;/span&gt;+            }
+        }
         &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; defaultCharset;
     }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17439049" author="davsclaus" created="Fri, 5 Nov 2021 05:59:16 +0000"  >&lt;p&gt;Yes PR is welcome&lt;/p&gt;</comment>
                            <comment id="17439240" author="davsclaus" created="Fri, 5 Nov 2021 12:50:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ffang&quot; class=&quot;user-hover&quot; rel=&quot;ffang&quot;&gt;ffang&lt;/a&gt; do you have a PR soon as we cut the release on monday?&lt;/p&gt;</comment>
                            <comment id="17439246" author="ffang" created="Fri, 5 Nov 2021 12:59:24 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Yes, I will send PR very soon.&lt;/p&gt;

&lt;p&gt;Cheers&lt;br/&gt;
Freeman&lt;/p&gt;</comment>
                            <comment id="17439275" author="ffang" created="Fri, 5 Nov 2021 13:51:36 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;PR against main branch&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/pull/6389&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/6389&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;br/&gt;
Freeman&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 1 week, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0w5j4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>