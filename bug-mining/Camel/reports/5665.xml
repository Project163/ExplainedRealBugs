<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:46:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-13092] Gzipping HTTP response prevents writing chunked output</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-13092</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;This has been discussed in the users mailing list &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;, but there was no conclusion, and it looks like a bug or quirk so I&apos;m raising this issue to try to get resolution.&lt;/p&gt;

&lt;p&gt;The issue is that when writing the response of an HTTP request using a PipedInputStream to the Message body and with the `Content-Encoding: gzip` set as a response header the data does not seem to be sent until the entire stream has been written to the PipedInputStream. This means the client cannot start to read the response until the entire set of data has been written. When that header is not set the data is streamed immediately.&lt;/p&gt;

&lt;p&gt;Also, symptomatic of this, when using `Content-Encoding: gzip` the `Content-Length` header gets set, which can only happen after the entire stream has been processed. Without the gzip header the &apos;Transfer-Encoding: chunked&apos; header gets set and there is no Content-Length as you might expect. I would have expected this to happen even if the&#160;`Content-Encoding: gzip` header is set.&lt;/p&gt;

&lt;p&gt;Is this a bug, or am I missing some magical way to ensure that the response is streamed when it is being gzipped?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;http://mail-archives.apache.org/mod_mbox/camel-users/201901.mbox/%3C9cc4adf0-91f2-a111-edce-e7a18fde9fdf%40gmail.com%3E&lt;/p&gt;</description>
                <environment>&lt;p&gt;I encounter this using the REST DSL with the servlet component, but I imagine its a more general problem. I&lt;/p&gt;

&lt;p&gt;&apos;m using Camel 2.18.0, but I checked and the problem seem to also happen with the latest version.&lt;/p&gt;</environment>
        <key id="13210816">CAMEL-13092</key>
            <summary>Gzipping HTTP response prevents writing chunked output</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="tdudgeon">Tim Dudgeon</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Jan 2019 17:23:34 +0000</created>
                <updated>Wed, 24 Mar 2021 06:32:12 +0000</updated>
                            <resolved>Wed, 24 Mar 2021 06:32:11 +0000</resolved>
                                    <version>2.23.1</version>
                                    <fixVersion>3.10.0</fixVersion>
                                    <component>camel-servlet</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16901379" author="davsclaus" created="Tue, 6 Aug 2019 18:55:07 +0000"  >&lt;p&gt;Are you able to build a reproducer as either a sample project, or some unit test?&lt;/p&gt;</comment>
                            <comment id="17307280" author="davsclaus" created="Tue, 23 Mar 2021 17:54:02 +0000"  >&lt;p&gt;Have build an use case for plain text (not gzipped)&lt;/p&gt;</comment>
                            <comment id="17307292" author="davsclaus" created="Tue, 23 Mar 2021 18:08:41 +0000"  >&lt;p&gt;When in gzip mode then it seems its currently hardcoded to be non chunked in the doWriteGZIPResponse method&lt;/p&gt;

&lt;p&gt;            if (LOG.isDebugEnabled()) {&lt;br/&gt;
                LOG.debug(&quot;Streaming response as GZIP in non-chunked mode with content-length {} and buffer size: {}&quot;, data.length, response.getBufferSize());&lt;br/&gt;
            }&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 34 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi053s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>