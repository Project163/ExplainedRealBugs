<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:01:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-7052] PGPDataFormat: Unable to encrypt using subkey</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-7052</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Generate a keyring with a DSA key for signing and an Elgamal key for encryption, using the password &quot;secret&quot;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt;gpg --gen-key
gpg (GnuPG) 2.0.17; Copyright (C) 2011 Free Software Foundation, Inc.
This is free software: you are free to change and redistribute it.
There is NO WARRANTY, to the extent permitted by law.

Please select what kind of key you want:
   (1) RSA and RSA (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;)
   (2) DSA and Elgamal
   (3) DSA (sign only)
   (4) RSA (sign only)
Your selection? 2
DSA keys may be between 1024 and 3072 bits &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;.
What keysize &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; you want? (2048) 2048
Requested keysize is 2048 bits
Please specify how &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; the key should be valid.
         0 = key does not expire
      &amp;lt;n&amp;gt;  = key expires in n days
      &amp;lt;n&amp;gt;w = key expires in n weeks
      &amp;lt;n&amp;gt;m = key expires in n months
      &amp;lt;n&amp;gt;y = key expires in n years
Key is valid &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt;? (0) 0
Key does not expire at all
Is &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; correct? (y/N) y

GnuPG needs to construct a user ID to identify your key.

Real name: Testing
Email address: testing@foo.com
Comment:
You selected &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; USER-ID:
    &lt;span class=&quot;code-quote&quot;&gt;&quot;Testing &amp;lt;testing@foo.com&amp;gt;&quot;&lt;/span&gt;

Change (N)ame, (C)omment, (E)mail or (O)kay/(Q)uit? O
You need a Passphrase to protect your secret key.

We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; gives the random number
generator a better chance to gain enough entropy.
gpg: WARNING: some OpenPGP programs can&apos;t handle a DSA key with &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; digest size
We need to generate a lot of random bytes. It is a good idea to perform
some other action (type on the keyboard, move the mouse, utilize the
disks) during the prime generation; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; gives the random number
generator a better chance to gain enough entropy.
gpg: key C49B82A0 marked as ultimately trusted
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; and secret key created and signed.

gpg: checking the trustdb
gpg: 3 marginal(s) needed, 1 complete(s) needed, PGP trust model
gpg: depth: 0  valid:   1  signed:   0  trust: 0-, 0q, 0n, 0m, 0f, 1u
pub   2048D/C49B82A0 2013-12-09
      Key fingerprint = AB15 5E15 768E E6FE 96AB  2423 6488 CEA7 C49B 82A0
uid                  Testing &amp;lt;testing@foo.com&amp;gt;
sub   2048g/361D9AA1 2013-12-09&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;List the keys to make sure they look OK:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt;gpg --list-keys
pubring.gpg
---------------
pub   2048D/C49B82A0 2013-12-09
uid                  Testing &amp;lt;testing@foo.com&amp;gt;
sub   2048g/361D9AA1 2013-12-09&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Export to a file and then check the contents of the file:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt;gpg --export &amp;gt; pubring.pgp

&amp;gt;gpg pubring.pgp
pub  2048D/C49B82A0 2013-12-09 Testing &amp;lt;testing@foo.com&amp;gt;
sub  2048g/361D9AA1 2013-12-09&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We now have a keyring that contains a primary DSA key for signing, and an Elgamal subkey for encryption. The subkey does not have a user ID associated with it, because the user ID is associated with the corresponding primary / master key.&lt;/p&gt;

&lt;p&gt;The latest code in &lt;tt&gt;PGPDataFormatUtil.findPublicKeys(InputStream, List&amp;lt;String&amp;gt;, boolean)&lt;/tt&gt; cannot handle this scenario, because it expects the subkey to also have a user ID. Only the first key in a keychain (which is the primary / master key) will have a user ID. The subkeys don&apos;t have user IDs directly associated with them, and so they are not recognized as usable by Camel, when in fact they are usable.&lt;/p&gt;

&lt;p&gt;See this discussion for more info on how primary keys and subkeys are represented in the BouncyCastle model, and how this relates to user IDs:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://bouncy-castle.1462172.n4.nabble.com/How-to-find-PGP-subkeys-td1465289.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bouncy-castle.1462172.n4.nabble.com/How-to-find-PGP-subkeys-td1465289.html&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12683690">CAMEL-7052</key>
            <summary>PGPDataFormat: Unable to encrypt using subkey</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="sdanig">Daniel Gredler</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 Dec 2013 21:25:32 +0000</created>
                <updated>Mon, 6 Jan 2014 03:31:06 +0000</updated>
                            <resolved>Sat, 4 Jan 2014 13:27:43 +0000</resolved>
                                    <version>2.12.2</version>
                                    <fixVersion>2.12.3</fixVersion>
                    <fixVersion>2.13.0</fixVersion>
                                    <component> camel-crypto</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13843706" author="sdanig" created="Mon, 9 Dec 2013 23:43:36 +0000"  >&lt;p&gt;I think the PGPDataFormatElGamalTest is failing in master, but it&apos;s not visible in the build because the test is marked with the Ignore annotation (because JCE unlimited strength isn&apos;t on the build server). I&apos;ll provide a proposed patch soon.&lt;/p&gt;</comment>
                            <comment id="13843712" author="sdanig" created="Mon, 9 Dec 2013 23:47:11 +0000"  >&lt;p&gt;All tests (including the ignored Elgamal test) pass for me with this patch.&lt;/p&gt;</comment>
                            <comment id="13862301" author="davsclaus" created="Sat, 4 Jan 2014 13:27:43 +0000"  >&lt;p&gt;Thanks for reporting and the patch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12687343">CAMEL-7106</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12617924" name="camel-7052.patch" size="6744" author="sdanig" created="Mon, 9 Dec 2013 23:47:11 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>362762</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 46 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qj47:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>363056</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>