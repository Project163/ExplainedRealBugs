<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:50:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-4941] doStop() is called on Services which haven&apos;t been started when route autoStart=false</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-4941</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;While unit testing the new camel-mongodb component, I realised that my consumer&apos;s doStop() method is called even if the route had autoStart=false and was never started. &lt;/p&gt;

&lt;p&gt;This occurs because when autoStartup=false, and the route has never been started manually, the RouteService&apos;s state flags are all false. &lt;/p&gt;

&lt;p&gt;During the cascading stopping routine, the ServiceHelper.isStopped() method is used to determine whether a service should be stopped or not. Since this method only checks the stopped and stopping flags, it returns false which indicates to the caller that the service is either started or suspended.&lt;/p&gt;

&lt;p&gt;The stop routine will then proceed to call doStop on the service, which is erroneous.&lt;/p&gt;

&lt;p&gt;To fix this, I propose to add the following new logic to the ServiceHelper.isStopped() method:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; none of the flags is &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, consider that the service is uninitialized, equating &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; status to stopped
&lt;/span&gt;            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!(service.isStarted() || service.isStarting() || 
                    service.isStopped() || service.isStopping() || 
                    service.isSuspended() || service.isSuspending())) 
            {
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
            }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12539802">CAMEL-4941</key>
            <summary>doStop() is called on Services which haven&apos;t been started when route autoStart=false</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="raulvk">Ra&#250;l Kripalani</assignee>
                                    <reporter username="raulvk">Ra&#250;l Kripalani</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Jan 2012 18:37:01 +0000</created>
                <updated>Fri, 27 Jan 2012 13:41:25 +0000</updated>
                            <resolved>Fri, 27 Jan 2012 13:30:45 +0000</resolved>
                                    <version>2.9.0</version>
                                    <fixVersion>2.10.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13193206" author="raulvk" created="Wed, 25 Jan 2012 18:51:59 +0000"  >&lt;p&gt;Patch attached.&lt;/p&gt;</comment>
                            <comment id="13194700" author="davsclaus" created="Fri, 27 Jan 2012 13:28:23 +0000"  >&lt;p&gt;You should build your components so they are resilient for doStop calls.&lt;/p&gt;

&lt;p&gt;For example when Camel is shutting down it will stop and shutdown all its services, routes, components, and whatnot.&lt;/p&gt;</comment>
                            <comment id="13194701" author="davsclaus" created="Fri, 27 Jan 2012 13:30:45 +0000"  >&lt;p&gt;We should not change behavior of this. This has been the behavior always with Camel.&lt;/p&gt;</comment>
                            <comment id="13194707" author="davsclaus" created="Fri, 27 Jan 2012 13:41:25 +0000"  >&lt;p&gt;I have polished the javadoc to explain the behavior of the doStop method.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12511864" name="ServiceHelperHandleUninitialized.patch" size="1222" author="raulvk" created="Wed, 25 Jan 2012 18:51:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>225305</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 43 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0240n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10252</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>