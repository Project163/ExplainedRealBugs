<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:21:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-10951] Invalid default field values in Spring Boot ComponentConfiguration classes</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-10951</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Some components default their endpoint configuration using constant fields. For example, the camel-mail &lt;tt&gt;MailConfiguration&lt;/tt&gt; class has:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; from = MailConstants.MAIL_DEFAULT_FROM;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When the MailComponentConfiguration is generated, it has a field defaulted as follows:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; from = &lt;span class=&quot;code-quote&quot;&gt;&quot;MailConstants.MAIL_DEFAULT_FROM&quot;&lt;/span&gt;;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Not sure exactly how many components are impacted by this but there&apos;s a few listed if you do:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;grep &lt;span class=&quot;code-quote&quot;&gt;&quot;DEFAULT&quot;&lt;/span&gt; $(find . -name &lt;span class=&quot;code-quote&quot;&gt;&quot;*ComponentConfiguration.java&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13048548">CAMEL-10951</key>
            <summary>Invalid default field values in Spring Boot ComponentConfiguration classes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="nferraro">Nicola Ferraro</assignee>
                                    <reporter username="jamesnetherton">James Netherton</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 Mar 2017 15:13:54 +0000</created>
                <updated>Tue, 7 Mar 2017 15:27:24 +0000</updated>
                            <resolved>Tue, 7 Mar 2017 15:27:23 +0000</resolved>
                                    <version>2.18.2</version>
                                    <fixVersion>2.18.3</fixVersion>
                                    <component>build system</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15897514" author="davsclaus" created="Mon, 6 Mar 2017 15:33:10 +0000"  >&lt;p&gt;Ah yeah then we need to grab the field value it represent. We do have some code that does this in the camel-route-parser&lt;/p&gt;</comment>
                            <comment id="15897517" author="davsclaus" created="Mon, 6 Mar 2017 15:36:15 +0000"  >&lt;p&gt;The code is something a like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            FieldSource field = getField(clazz, block, (SimpleName) arg);

                    &lt;span class=&quot;code-comment&quot;&gt;// the field may be initialized using variables, so we need to evaluate those expressions
&lt;/span&gt;                    &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; fi = field.getInternal();
                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (fi &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; VariableDeclaration) {
                        Expression exp = ((VariableDeclaration) fi).getInitializer();
                        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; uri = CamelJavaParserHelper.getLiteralValue(clazz, block, exp);
                        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!Strings.isBlank(uri)) {
                            &lt;span class=&quot;code-comment&quot;&gt;// we want the position of the field, and not in the route
&lt;/span&gt;                            &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; position = ((VariableDeclaration) fi).getStartPosition();
                            uris.add(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ParserResult(node, position, uri));
                        }
                    }
                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;See the CamelJavaParserHelper&lt;/p&gt;

&lt;p&gt;Its that initialize stuff that is another expression you can then grab and then find its value is a string, integer or something&lt;/p&gt;</comment>
                            <comment id="15899010" author="davsclaus" created="Tue, 7 Mar 2017 09:09:10 +0000"  >&lt;p&gt;Just to be sure this is only a problem on master branch? 2.18.x are fine right?&lt;/p&gt;</comment>
                            <comment id="15899017" author="jamesnetherton" created="Tue, 7 Mar 2017 09:27:50 +0000"  >&lt;p&gt;Problem seems to be present on the 2.18.x branch too:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/camel/blob/camel-2.18.x/components-starter/camel-mail-starter/src/main/java/org/apache/camel/component/mail/springboot/MailComponentConfiguration.java#L119&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/camel-2.18.x/components-starter/camel-mail-starter/src/main/java/org/apache/camel/component/mail/springboot/MailComponentConfiguration.java#L119&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15899339" author="nferraro" created="Tue, 7 Mar 2017 12:05:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; I&apos;m trying your approach, but cannot get useful info. There&apos;s something I&apos;m missing...&lt;/p&gt;

&lt;p&gt;Even if manage to evaluate the initializer expression (the field initializer returns null), are you sure we can get its value? I mean, the maven plugin does not use the application classpath, so it should not be able to evaluate an expression like &quot;MailConstants.XXX&quot; because it doesn&apos;t know what &quot;MailConstants&quot; is.. unless we so some hacks with the classloader...&lt;/p&gt;

&lt;p&gt;I&apos;m trying a naive approach in the meantime.&lt;/p&gt;</comment>
                            <comment id="15899349" author="davsclaus" created="Tue, 7 Mar 2017 12:17:41 +0000"  >&lt;p&gt;Ah yeah that may be correct. We could at first skip those fields to not generate a default value. Then maybe later we can find a way&lt;/p&gt;</comment>
                            <comment id="15899351" author="davsclaus" created="Tue, 7 Mar 2017 12:18:38 +0000"  >&lt;p&gt;We could maybe log some kind of WARN or something and then see how many there are. We can always change  the source code to set the default value as a String directly instead of the constant reference.&lt;/p&gt;</comment>
                            <comment id="15899359" author="nferraro" created="Tue, 7 Mar 2017 12:24:28 +0000"  >&lt;p&gt;Let me check if the (simpler) approach I&apos;ve found works for other components..&lt;/p&gt;</comment>
                            <comment id="15899466" author="nferraro" created="Tue, 7 Mar 2017 14:01:45 +0000"  >&lt;p&gt;Committed upstream. The affected components are:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;box&lt;/li&gt;
	&lt;li&gt;ganglia&lt;/li&gt;
	&lt;li&gt;mail&lt;/li&gt;
	&lt;li&gt;netty&lt;/li&gt;
	&lt;li&gt;netty4&lt;/li&gt;
	&lt;li&gt;ssh&lt;/li&gt;
	&lt;li&gt;xmlsecurity&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Claus, the patch may not win the code award for 2017, but it makes what we need &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. Should we apply it also for 2.18.3?&lt;/p&gt;</comment>
                            <comment id="15899476" author="davsclaus" created="Tue, 7 Mar 2017 14:04:50 +0000"  >&lt;p&gt;Yeah backport please, you may need to regen the starters on 2.18.x so the code are fully aligned - yeah it takes some time but its important to have good spring boot support for camel&lt;/p&gt;</comment>
                            <comment id="15899599" author="nferraro" created="Tue, 7 Mar 2017 15:27:24 +0000"  >&lt;p&gt;Backported to branch 2.18.x.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 37 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3b01b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>