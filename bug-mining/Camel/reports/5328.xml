<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:41:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-15075] camel-kafka - Configuration via SSLContextParameters does not work as expected</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-15075</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;The ssl parameters in kafka can be set using a camel SSLContextParameter object (see&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-10705&quot; title=&quot;Allow to use an SSLContextParameters object for Kafka&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-10705&quot;&gt;&lt;del&gt;CAMEL-10705&lt;/del&gt;&lt;/a&gt;). But it doesn&apos;t work as expected.&lt;/p&gt;

&lt;p&gt;Camel allows many ways to specify a keystore location, ie a file path, a class path or an URL of the resource. Camel tries all possible ways to read the keystore. (Eg SSLContextParameters.getTrustManagers().getKeyStore().getResource()).&lt;/p&gt;

&lt;p&gt;For kafka this resolution doesn&apos;t take place. Kafka receives just the raw resource string (org.apache.camel.component.kafka.KafkaConfiguration:511):&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
addPropertyIfNotNull(props, SslConfigs.SSL_TRUSTSTORE_LOCATION_CONFIG, keyStore.getResource());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Kafka has a different expectation on this location from camel. In particular setting the camel keystore resource to a classpath location doesn&apos;t work for kafka (see also&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/KAFKA-7685&quot; title=&quot;Support loading trust stores from classpath&quot; class=&quot;issue-link&quot; data-issue-key=&quot;KAFKA-7685&quot;&gt;KAFKA-7685&lt;/a&gt; for an attempt to support classpath resources).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13305465">CAMEL-15075</key>
            <summary>camel-kafka - Configuration via SSLContextParameters does not work as expected</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10004">Not A Bug</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="balkup">Peter Kullmann</reporter>
                        <labels>
                    </labels>
                <created>Sun, 17 May 2020 09:23:32 +0000</created>
                <updated>Tue, 26 May 2020 07:28:29 +0000</updated>
                            <resolved>Mon, 25 May 2020 19:04:46 +0000</resolved>
                                    <version>3.2.0</version>
                                    <fixVersion>3.4.0</fixVersion>
                                    <component>camel-kafka</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17110014" author="davsclaus" created="Mon, 18 May 2020 08:04:30 +0000"  >&lt;p&gt;Thanks can you check Camel 3.3.0 release.&lt;/p&gt;

&lt;p&gt;If its still a problem then we should add a note that loading from classpath is a limitation in Kafka (Camel is just the facade on top). And that the location should be a file based resource.&lt;/p&gt;</comment>
                            <comment id="17110174" author="balkup" created="Mon, 18 May 2020 11:44:54 +0000"  >&lt;p&gt;I can see no difference in 3.3.0.&lt;/p&gt;</comment>
                            <comment id="17110301" author="davsclaus" created="Mon, 18 May 2020 13:53:28 +0000"  >&lt;p&gt;Okay so it looks like it just uses the SSLContextParameters as parameters to set them via that. And then copy its configuration into karaf configuration.&lt;/p&gt;

&lt;p&gt;So can you provide more details what you think is wrong such as sample code, configuration, a reproducer etc.&lt;/p&gt;</comment>
                            <comment id="17112336" author="balkup" created="Wed, 20 May 2020 15:14:19 +0000"  >&lt;p&gt;I think it&apos;s easy to reproduce: Just take the example in the docs:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// Configure the SSLContextParameters object
&lt;/span&gt;KeyStoreParameters ksp = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; KeyStoreParameters();
ksp.setResource(&lt;span class=&quot;code-quote&quot;&gt;&quot;/path/to/keystore.jks&quot;&lt;/span&gt;);
ksp.setPassword(&lt;span class=&quot;code-quote&quot;&gt;&quot;changeit&quot;&lt;/span&gt;);
KeyManagersParameters kmp = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; KeyManagersParameters();
kmp.setKeyStore(ksp);
kmp.setKeyPassword(&lt;span class=&quot;code-quote&quot;&gt;&quot;changeit&quot;&lt;/span&gt;);
SSLContextParameters scp = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SSLContextParameters();
scp.setKeyManagers(kmp);

&lt;span class=&quot;code-comment&quot;&gt;// Bind &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; SSLContextParameters into the Camel registry
&lt;/span&gt;Registry registry = createCamelRegistry();
registry.bind(&lt;span class=&quot;code-quote&quot;&gt;&quot;ssl&quot;&lt;/span&gt;, scp);

&lt;span class=&quot;code-comment&quot;&gt;// Configure the camel context
&lt;/span&gt;DefaultCamelContext camelContext = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DefaultCamelContext(registry);
camelContext.addRoutes(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RouteBuilder() {
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void configure() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        from(&lt;span class=&quot;code-quote&quot;&gt;&quot;kafka:&quot;&lt;/span&gt; + TOPIC + &lt;span class=&quot;code-quote&quot;&gt;&quot;?brokers=localhost:{{kafkaPort}}&quot;&lt;/span&gt; +
                     &lt;span class=&quot;code-comment&quot;&gt;// Setup the topic and broker address
&lt;/span&gt;                     &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;amp;groupId=A&quot;&lt;/span&gt; +
                     &lt;span class=&quot;code-comment&quot;&gt;// The consumer processor group ID
&lt;/span&gt;                     &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;amp;sslContextParameters=#ssl&quot;&lt;/span&gt; +
                     &lt;span class=&quot;code-comment&quot;&gt;// The security protocol
&lt;/span&gt;                     &quot;&amp;amp;securityProtocol=SSL)
                     &lt;span class=&quot;code-comment&quot;&gt;// Reference the SSL configuration
&lt;/span&gt;                .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;mock:result&quot;&lt;/span&gt;);
    }
});
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The /path/to/keystore.jks should point to a classpath resource. Then kafka will complain:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
[main] ERROR org.apache.kafka.common.security.ssl.SslEngineBuilder - Modification time of key store could not be obtained: blabla
java.nio.file.NoSuchFileException: blabla
	at sun.nio.fs.WindowsException.translateToIOException(WindowsException.java:79)
	at sun.nio.fs.WindowsException.rethrowAsIOException(WindowsException.java:97)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I tried to produce a small running example but the archetype produces non compilable code and gave up:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Main main = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Main();
main.addRouteBuilder(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MyRouteBuilder());
main.run(args);&#160;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I think, it would be enough to mention this in the docs.&lt;/p&gt;</comment>
                            <comment id="17113976" author="davsclaus" created="Fri, 22 May 2020 12:15:47 +0000"  >&lt;p&gt;Ah okay but Camel&apos;s SSLContextParameters uses classpath as default, so change your example to use &lt;a href=&quot;file:xxx&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:xxx&lt;/a&gt; in the configuration. &lt;/p&gt;</comment>
                            <comment id="17116187" author="davsclaus" created="Mon, 25 May 2020 19:04:46 +0000"  >&lt;p&gt;Okay so I tried the camel-kafka-example from camel, and copied over a keystore.jks file and modified the example to use SSL and read the keystore file. So when I type in the correct file path then its loaded by kafka.&lt;/p&gt;
</comment>
                            <comment id="17116466" author="balkup" created="Tue, 26 May 2020 06:04:49 +0000"  >&lt;p&gt;The point is: The javadoc in KeyStoreParameters.setResource says &quot;Sets the optional file path, class path resource, or URL of the resource used to load the key store.&quot;. But only file path works when used for kafka.&lt;/p&gt;</comment>
                            <comment id="17116506" author="davsclaus" created="Tue, 26 May 2020 07:28:29 +0000"  >&lt;p&gt;Thats a generic javadoc. I added a note in the kafka docs for Camel 3.4&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 25 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0etuo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>