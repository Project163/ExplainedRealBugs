<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:57:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-6219] FTPOperations changeCurrentDirectory uses local OS path separator, instead of FTP Server. File upload fails.</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-6219</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Summary:&lt;br/&gt;
When uploading a single file to a vsftpd server from Windows using a Camel ftp:// endpoint results in a 550 Failed to change directory error.&lt;br/&gt;
Likely because the changeCurrentDirectory() command in FTPOperations doesn&apos;t provide the server pathSeparator when compacting the url.&lt;/p&gt;

&lt;p&gt;Recreate:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Start a vsftpd server (this likely affects other FTP servers) in a *nix environment.&lt;/li&gt;
	&lt;li&gt;Set log4j properties to TRACE for Camel&lt;/li&gt;
	&lt;li&gt;In Windows, run a simple Java class that includes the following&lt;br/&gt;
ProducerTemplate pt = camelContext.createProducerTemplate();&lt;br/&gt;
pt.sendBody(&quot;ftp://user@host/subfolder?fileName=test.file&amp;amp;password=12345678&amp;amp;stepwise=false&amp;amp;separator=UNIX&quot;);&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Trace:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2013.03.27 14:53:56&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt;  TRACE FtpOperations -  buildDirectory(test)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2013.03.27 14:53:56&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt;  TRACE FtpOperations -  changeCurrentDirectory(/var/ftp/pub)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2013.03.27 14:53:56&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt;  TRACE FtpOperations -  Changing directory: \var\ftp\pub&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;2013.03.27 14:53:56&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt;  WARN  RemoteFileProducer -  Writing file failed with: File operation failed: 550 Failed to change directory.&lt;br/&gt;
 Cannot change directory to: \var\ftp\pub. Code: 550&lt;/p&gt;

&lt;p&gt;As you can see the path swaps from /var/ftp/pub to \var\ftp\pub which is the wrong path separator!&lt;/p&gt;

&lt;p&gt;Likely location:&lt;br/&gt;
org.apache.camel.component.file.remote.FTPOperations:656&lt;br/&gt;
    path = FileUtil.compactPath(path);&lt;br/&gt;
org.apache.camel.util.FileUtil:209&lt;br/&gt;
    return compactPath(path, File.separatorChar);&lt;/p&gt;


&lt;p&gt;File.separatorChar would return the LOCAL OS path, not the REMOTE OS path.&lt;br/&gt;
This should use the value specified by separator=UNIX (&quot;/&quot; not &quot;\&quot;).&lt;/p&gt;

&lt;p&gt;Possible fix would be to use the other compactPath(path,separator) method.&lt;/p&gt;

&lt;p&gt;Result:&lt;br/&gt;
You cannot upload a single file using FTP in this fashion from a Windows client to a vsftpd server on Linux. I&apos;ll have to switch to an alternative product for ftp until this is resolved, but look forward to returning to using Camel for FTP uploads in the future &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 7 with Oracle Java 6 JDK&lt;br/&gt;
Remote vsftpd server on a Redhat based Linux distribution&lt;/p&gt;</environment>
        <key id="12639338">CAMEL-6219</key>
            <summary>FTPOperations changeCurrentDirectory uses local OS path separator, instead of FTP Server. File upload fails.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="8">Not A Problem</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="mark.richards">Mark Richards</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Mar 2013 15:05:00 +0000</created>
                <updated>Fri, 23 Aug 2013 07:56:47 +0000</updated>
                            <resolved>Fri, 23 Aug 2013 07:56:47 +0000</resolved>
                                    <version>2.10.4</version>
                                                    <component>camel-ftp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13615361" author="mark.richards" created="Wed, 27 Mar 2013 15:07:33 +0000"  >&lt;p&gt;Possibly relates to: &lt;a href=&quot;http://camel.465427.n5.nabble.com/FTP-endpoint-FtpOperation-change-directory-error-tp5502517.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.465427.n5.nabble.com/FTP-endpoint-FtpOperation-change-directory-error-tp5502517.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13615363" author="davsclaus" created="Wed, 27 Mar 2013 15:09:04 +0000"  >&lt;p&gt;Give the 2.10.5-SNAPSHOT a test as we have fixed bugs in camel-ftp since.&lt;/p&gt;</comment>
                            <comment id="13628766" author="markdingram" created="Thu, 11 Apr 2013 08:25:27 +0000"  >&lt;p&gt;This is working for me against 2.10.5-SNAPSHOT, but not in the current 2.12-SNAPSHOT.&lt;/p&gt;</comment>
                            <comment id="13661580" author="rushalias" created="Sun, 19 May 2013 15:53:02 +0000"  >&lt;p&gt;I am seeing the same error in 2.11.0 Release. &lt;br/&gt;
Running the FTP client example (src/main/java/org/apache/camel/example/ftp/MyFtpClient.java) shipped with 2.11.0.&lt;/p&gt;

&lt;p&gt;I am getting &lt;br/&gt;
org.apache.camel.component.file.GenericFileOperationFailedException: File operation failed: 550 Failed to change directory.&lt;/p&gt;

&lt;p&gt;FTP server is running Linux Server.&lt;br/&gt;
Client is running on Mac Book Pro.  &lt;/p&gt;

&lt;p&gt;Additionally, same code works just fine in 2.10.4 release. &lt;/p&gt;

</comment>
                            <comment id="13662452" author="rushalias" created="Mon, 20 May 2013 23:24:01 +0000"  >&lt;p&gt;I think I have identified source of my observed error.  &lt;/p&gt;

&lt;p&gt;Apache Camel version 2.11.0 dependes on commons-net-3.2 while 2.10.4 dependes on commons-net-3.1.  And it seems commons-net&apos;s new implementation of __parsePathname method does not strip quotes from the path. &lt;/p&gt;

&lt;p&gt;Testing with commons-net-3.1, will update shortly.  &lt;/p&gt;</comment>
                            <comment id="13662459" author="rushalias" created="Mon, 20 May 2013 23:36:10 +0000"  >&lt;p&gt;Excluding commons-net-3.2 and replacing it with commons-net-3.1 seems to have fixed it.&lt;/p&gt;

&lt;p&gt;And here is the commons-net bug report: &lt;a href=&quot;https://issues.apache.org/jira/browse/NET-492&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/NET-492&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13662635" author="davsclaus" created="Tue, 21 May 2013 03:36:08 +0000"  >&lt;p&gt;Thanks for testing and discovering this bug in commons net. We will downgrade to 3.1 on trunk and 2.11 branch.&lt;/p&gt;</comment>
                            <comment id="13748378" author="davsclaus" created="Fri, 23 Aug 2013 07:56:47 +0000"  >&lt;p&gt;A problem in commons net 3.1&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>319808</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 13 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1j6in:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320149</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>