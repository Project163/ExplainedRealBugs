<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:11:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-9196] CLONE - DefaultShutdownStrategy shutdown timeout of 0 will never timeout and go in negative time</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-9196</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;A timeout of 0 won&apos;t timeout in the instant, the time will go negative. &lt;/p&gt;

&lt;p&gt;camelcontext.stopRoute(routeId, 0, TimeUnit.SECONDS, false); &lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; : Waiting as there are still 3 inflight and pending exchanges to complete, timeout in -1 seconds.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; : Waiting as there are still 3 inflight and pending exchanges to complete, timeout in -2 seconds.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; : Waiting as there are still 3 inflight and pending exchanges to complete, timeout in -3 seconds. &lt;/p&gt;

&lt;p&gt;Found a post related to it there : &lt;a href=&quot;http://camel.465427.n5.nabble.com/Forcefully-shutting-down-routes-td5722447.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.465427.n5.nabble.com/Forcefully-shutting-down-routes-td5722447.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Original issue was marked as fixed so I create clone:&lt;br/&gt;
I&apos;m using 2.15.3 and still have the same promlem - negative timeout and don&apos;t stop.&lt;/p&gt;

&lt;p&gt;12:48:59,864 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; (Camel (interprocCamelContext) thread #56904 - timer://InteractiveAppRetryProcessor) Waiting as there are still 1 inflight and pending exchanges to complete, timeout in -25754 seconds. Inflights per route: &lt;span class=&quot;error&quot;&gt;&amp;#91;InteractiveProcessor_Retry_4 = 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
12:49:00,865 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; (Camel (interprocCamelContext) thread #56904 - timer://InteractiveAppRetryProcessor) Waiting as there are still 1 inflight and pending exchanges to complete, timeout in -25755 seconds. Inflights per route: &lt;span class=&quot;error&quot;&gt;&amp;#91;InteractiveProcessor_Retry_4 = 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
12:49:01,865 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; (Camel (interprocCamelContext) thread #56904 - timer://InteractiveAppRetryProcessor) Waiting as there are still 1 inflight and pending exchanges to complete, timeout in -25756 seconds. Inflights per route: &lt;span class=&quot;error&quot;&gt;&amp;#91;InteractiveProcessor_Retry_4 = 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
12:49:02,866 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; (Camel (interprocCamelContext) thread #56904 - timer://InteractiveAppRetryProcessor) Waiting as there are still 1 inflight and pending exchanges to complete, timeout in -25757 seconds. Inflights per route: &lt;span class=&quot;error&quot;&gt;&amp;#91;InteractiveProcessor_Retry_4 = 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
12:49:03,866 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; (Camel (interprocCamelContext) thread #56904 - timer://InteractiveAppRetryProcessor) Waiting as there are still 1 inflight and pending exchanges to complete, timeout in -25758 seconds. Inflights per route: &lt;span class=&quot;error&quot;&gt;&amp;#91;InteractiveProcessor_Retry_4 = 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
12:49:04,866 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; (Camel (interprocCamelContext) thread #56904 - timer://InteractiveAppRetryProcessor) Waiting as there are still 1 inflight and pending exchanges to complete, timeout in -25759 seconds. Inflights per route: &lt;span class=&quot;error&quot;&gt;&amp;#91;InteractiveProcessor_Retry_4 = 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
12:49:05,867 INFO &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; (Camel (interprocCamelContext) thread #56904 - timer://InteractiveAppRetryProcessor) Waiting as there are still 1 inflight and pending exchanges to complete, timeout in -25760 seconds. Inflights per route: &lt;span class=&quot;error&quot;&gt;&amp;#91;InteractiveProcessor_Retry_4 = 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
When using hawtio it simply hangs when I try to view properties of Camel Contexts&lt;br/&gt;
I am using camel with activemq, but there are no inflight messages in activemq...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12902815">CAMEL-9196</key>
            <summary>CLONE - DefaultShutdownStrategy shutdown timeout of 0 will never timeout and go in negative time</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="6">Invalid</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="mykolap">Mykola Pavluchynskyi</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Oct 2015 20:37:07 +0000</created>
                <updated>Thu, 8 Oct 2015 03:30:57 +0000</updated>
                            <resolved>Wed, 7 Oct 2015 05:14:28 +0000</resolved>
                                    <version>2.15.3</version>
                                    <fixVersion>2.15.4</fixVersion>
                    <fixVersion>2.16.1</fixVersion>
                    <fixVersion>2.17.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14946249" author="davsclaus" created="Wed, 7 Oct 2015 05:02:26 +0000"  >&lt;p&gt;You cannot use timeout value of 0, use a positive value, such as 1 second. But ideally you should allow the route time to shutdown graceful such as 30 seconds or more.&lt;/p&gt;</comment>
                            <comment id="14946262" author="davsclaus" created="Wed, 7 Oct 2015 05:14:28 +0000"  >&lt;p&gt;Must use a positive timeout value&lt;/p&gt;</comment>
                            <comment id="14946297" author="mykolap" created="Wed, 7 Oct 2015 05:35:25 +0000"  >&lt;p&gt;Timeout in my case was 180 sec.&lt;/p&gt;

&lt;p&gt;This is the code of initialization my context:&lt;/p&gt;

&lt;p&gt;            camelContext = new DefaultCamelContext();&lt;br/&gt;
            camelContext.setName(&quot;interprocCamelContext&quot;);&lt;/p&gt;

&lt;p&gt;            camelContext.getShutdownStrategy().setTimeout(180); //300 sec is to long, wait only 180 sec instead&lt;/p&gt;

&lt;p&gt;            camelContext.addRoutes(this);&lt;br/&gt;
            camelContext.start();&lt;/p&gt;

&lt;p&gt;And usually it stop earlier than in 180 sec (from 0 to 2 seconds).&lt;br/&gt;
But in that case there was a long lasting operation, and it didn&apos;t stop.&lt;/p&gt;

&lt;p&gt;Code for the route&lt;br/&gt;
        from(&quot;activemq:queue:InteractiveProcessor_Retry_4?concurrentConsumers=2)&lt;br/&gt;
                .routeId(&quot;InteractiveProcessor_Retry_4&quot;)&lt;br/&gt;
                .autoStartup(false)&lt;br/&gt;
                .recipientList(simple(&quot;${header.originalAmqDestination}&quot;));&lt;/p&gt;

&lt;p&gt;&#1054;&#1073;&#1099;&#1095;&#1085;&#1086; &#1083;&#1086;&#1075; &#1079;&#1072;&#1074;&#1077;&#1088;&#1096;&#1077;&#1085;&#1080;&#1103; &#1074;&#1099;&#1075;&#1083;&#1103;&#1076;&#1080;&#1090; &#1090;&#1072;&#1082;:&lt;br/&gt;
08:32:14,441 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; (Camel (interprocCamelContext) thread #107 - timer://InteractiveAppRetryProcessor) Starting to graceful shutdown 1 routes (timeout 180 seconds)&lt;br/&gt;
08:32:14,442 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; (Camel (interprocCamelContext) thread #225 - ShutdownTask) Route: InteractiveProcessor_Retry_4 suspend complete, was consuming from: Endpoint&lt;span class=&quot;error&quot;&gt;&amp;#91;activemq://queue:InteractiveProcessor_Retry_4?concurrentConsumers=2&amp;#93;&lt;/span&gt;&lt;br/&gt;
08:32:14,442 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultShutdownStrategy&amp;#93;&lt;/span&gt; (Camel (interprocCamelContext) thread #107 - timer://InteractiveAppRetryProcessor) Graceful shutdown of 1 routes completed in 0 seconds&lt;br/&gt;
08:32:14,442 INFO  &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.impl.DefaultCamelContext&amp;#93;&lt;/span&gt; (Camel (interprocCamelContext) thread #107 - timer://InteractiveAppRetryProcessor) Route: InteractiveProcessor_Retry_4 is suspended, was consuming from: Endpoint&lt;span class=&quot;error&quot;&gt;&amp;#91;activemq://queue:InteractiveProcessor_Retry_4?concurrentConsumers=2&amp;#93;&lt;/span&gt;&lt;/p&gt;
</comment>
                            <comment id="14946303" author="davsclaus" created="Wed, 7 Oct 2015 05:40:18 +0000"  >&lt;p&gt;You override that when calling&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;camelcontext.stopRoute(routeId, 0, TimeUnit.SECONDS, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14946304" author="davsclaus" created="Wed, 7 Oct 2015 05:40:47 +0000"  >&lt;p&gt;I added an extra check for validating that in this case the timeout must be &amp;gt; 0&lt;/p&gt;</comment>
                            <comment id="14946323" author="mykolap" created="Wed, 7 Oct 2015 05:58:52 +0000"  >&lt;p&gt;In my case I stop route by using functions with one argument:&lt;br/&gt;
            context.stopRoute(routeName);&lt;br/&gt;
and&lt;br/&gt;
            context.suspendRoute(routeName);&lt;/p&gt;

&lt;p&gt;And usually get info message that timeout is 180 (my camel context value)&lt;/p&gt;</comment>
                            <comment id="14948015" author="njiang" created="Thu, 8 Oct 2015 03:30:57 +0000"  >&lt;p&gt;Merged the patch into camel-2.16.x branch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="12646433">CAMEL-6341</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10061"><![CDATA[Novice]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 6 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mnqf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>