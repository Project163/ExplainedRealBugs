<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:40:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-3121] Splitter EIP - The sub exchanges should not contains on completions from original Exchange</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-3121</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;See nabble&lt;br/&gt;
&lt;a href=&quot;http://camel.465427.n5.nabble.com/Camel-calling-commit-too-early-when-using-split-seda-file-endpoint-tp2830894p2830894.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://camel.465427.n5.nabble.com/Camel-calling-commit-too-early-when-using-split-seda-file-endpoint-tp2830894p2830894.html&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12487528">CAMEL-3121</key>
            <summary>Splitter EIP - The sub exchanges should not contains on completions from original Exchange</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="davsclaus">Claus Ibsen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Sep 2010 11:39:12 +0000</created>
                <updated>Sun, 24 Apr 2011 09:57:34 +0000</updated>
                            <resolved>Tue, 14 Sep 2010 12:00:54 +0000</resolved>
                                    <version>2.4.0</version>
                                    <fixVersion>2.5.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12956722" author="davsclaus" created="Tue, 14 Sep 2010 12:00:23 +0000"  >&lt;p&gt;Added unit test to trunk: 996857.&lt;/p&gt;

&lt;p&gt;Cannot re produce the error on trunk. &lt;/p&gt;</comment>
                            <comment id="12956721" author="davsclaus" created="Tue, 14 Sep 2010 12:00:54 +0000"  >&lt;p&gt;I fixed some stuff on file commit stuff due another ticket, so this bug should be resolved as well.&lt;/p&gt;</comment>
                            <comment id="12956701" author="smcduff@hotmail.com" created="Tue, 14 Sep 2010 12:09:52 +0000"  >&lt;p&gt;The following post contains 2 problems :&lt;/p&gt;

&lt;p&gt;Issue 1:&lt;br/&gt;
Cannot rename the file exception. It was found and fixed there:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/activemq/browse/CAMEL-2897&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://issues.apache.org/activemq/browse/CAMEL-2897&lt;/a&gt;&lt;br/&gt;
But  the problem only fix when streaming is used. If streaming isn&apos;t used... the problem persist. &lt;br/&gt;
Quick patch: &lt;br/&gt;
Splitter.java &lt;br/&gt;
private Iterable&amp;lt;ProcessorExchangePair&amp;gt; createProcessorExchangePairsList( &lt;br/&gt;
                        Exchange exchange, Object value) { &lt;br/&gt;
                List&amp;lt;ProcessorExchangePair&amp;gt; result; &lt;br/&gt;
                Integer collectionSize = CollectionHelper.size(value); &lt;br/&gt;
                if (collectionSize != null) &lt;/p&gt;
{ 
                        result = new ArrayList&amp;lt;ProcessorExchangePair&amp;gt;(collectionSize); 
                }
&lt;p&gt; else &lt;/p&gt;
{ 
                        result = new ArrayList&amp;lt;ProcessorExchangePair&amp;gt;(); 
                }
&lt;p&gt; &lt;br/&gt;
                Iterable&amp;lt;ProcessorExchangePair&amp;gt; createProcessorExchangePairsIterable = createProcessorExchangePairsIterable( &lt;br/&gt;
                                exchange, value); &lt;br/&gt;
                Iterator&amp;lt;ProcessorExchangePair&amp;gt; iterator = createProcessorExchangePairsIterable &lt;br/&gt;
                                .iterator(); &lt;br/&gt;
                while (iterator.hasNext()) &lt;/p&gt;
{ 
                        ProcessorExchangePair next = iterator.next(); 
                        result.add(next); 
                }
&lt;p&gt; &lt;br/&gt;
                return result; &lt;br/&gt;
        } &lt;/p&gt;


&lt;p&gt;Issue 2:&lt;br/&gt;
We found a problem of shutdown in the patch we submitted. Now we do not create a DefaultUNitOfWork we only set it at null.&lt;/p&gt;

&lt;p&gt;Quick patch: &lt;br/&gt;
public Object next() { &lt;br/&gt;
        Object part = iterator.next(); &lt;br/&gt;
        Exchange newExchange = exchange.copy(); &lt;br/&gt;
                if (iterator.hasNext()) &lt;/p&gt;
{ 
                        newExchange.setUnitOfWork(null); 
                        }
&lt;p&gt;                        if (part instanceof Message) &lt;/p&gt;
{ 
                                                        newExchange.setIn((Message) part); 
                                                }
&lt;p&gt; else &lt;/p&gt;
{ 
                                                        Message in = newExchange.getIn(); 
                                                        in.setBody(part); 
                                                }
&lt;p&gt; &lt;br/&gt;
                                                return createProcessorExchangePair(index++, &lt;br/&gt;
                                                                getProcessors().iterator().next(), newExchange); &lt;br/&gt;
                                        } &lt;/p&gt;
</comment>
                            <comment id="12956729" author="smcduff@hotmail.com" created="Tue, 14 Sep 2010 13:20:12 +0000"  >&lt;p&gt;Hi Claus,&lt;/p&gt;

&lt;p&gt;We are still able to reproduce it with 2.5.0. (both problems)&lt;/p&gt;

&lt;p&gt;Did you try it on Windows ?&lt;/p&gt;

&lt;p&gt;Issue 1:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;from(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:e:/test/camel&quot;&lt;/span&gt;).split(body().tokenize(&lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;)).process(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Processor() {
        @Override
        &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void process(Exchange arg0) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
                &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(2000);
        }
}); 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It looks like the testcase you`ve done for FileSplitStreamingWithChoiceTest.java except you need to remove streaming.&lt;br/&gt;
Quick patch: Splitter.java&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Iterable&amp;lt;ProcessorExchangePair&amp;gt; createProcessorExchangePairsList(
                        Exchange exchange, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; value) {
                List&amp;lt;ProcessorExchangePair&amp;gt; result;
                &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; collectionSize = CollectionHelper.size(value);
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (collectionSize != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                        result = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;ProcessorExchangePair&amp;gt;(collectionSize);
                } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                        result = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;ProcessorExchangePair&amp;gt;();
                }
                Iterable&amp;lt;ProcessorExchangePair&amp;gt; createProcessorExchangePairsIterable = createProcessorExchangePairsIterable(
                                exchange, value);
                Iterator&amp;lt;ProcessorExchangePair&amp;gt; iterator = createProcessorExchangePairsIterable
                                .iterator();
                &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (iterator.hasNext()) {
                        ProcessorExchangePair next = iterator.next();
                        result.add(next);
                }
                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; result;
        } 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Issue 2&lt;br/&gt;
Quick Patch:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; next() {
        &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; part = iterator.next();
        Exchange newExchange = exchange.copy();
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (iterator.hasNext()) {
                        newExchange.setUnitOfWork(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
                        }                        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (part &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; Message) {
                                                        newExchange.setIn((Message) part);
                                                } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                                                        Message in = newExchange.getIn();
                                                        in.setBody(part);
                                                }
                                                &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; createProcessorExchangePair(index++,
                                                                getProcessors().iterator().next(), newExchange);
                                        }
:
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="12956715" author="davsclaus" created="Wed, 15 Sep 2010 08:01:06 +0000"  >&lt;p&gt;Thanks Simon, I have fixed the windows issue. trunk: 997217&lt;/p&gt;</comment>
                            <comment id="13023851" author="davsclaus" created="Sun, 24 Apr 2011 09:57:34 +0000"  >&lt;p&gt;Closing all resolved tickets from 2010 or older&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76341</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 31 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01ssf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8433</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>