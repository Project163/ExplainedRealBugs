<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:27:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-12061] SFTP exception-handling more problemtatic than documented</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-12061</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;my poll-sftp-server-for-files-to-download route crashes fom time to time. i happend to get a stacktrace which indicates an IoException when the SFTP component changes the folder to inspect on the remote site. Can happen - however, contrary to the documentation, which says an exception produces a warning and is otherwise ignored, the whole application goes down.&lt;/p&gt;

&lt;p&gt;-------------------------------------------------------------------------&lt;br/&gt;
{{&lt;br/&gt;
Dez 04, 2017 3:45:34 PM org.apache.camel.component.file.remote.RemoteFilePolling&lt;br/&gt;
ConsumerPollStrategy rollback&lt;br/&gt;
WARNUNG: Trying to recover by disconnecting from remote server forcing a re-connect at next poll: sftp://XXXXXXXXXXXXXXXX&lt;br/&gt;
Dez 04, 2017 3:45:34 PM org.apache.camel.util.CamelLogger log&lt;br/&gt;
WARNUNG: Consumer Consumer[sftp://XXXXXXXXXXXXX/out/prod/?delay=30000&amp;amp;delete=true&amp;amp;localWorkDirectory=c%3A%2FMarta%2FHgmTkw14%2Femcs%2Ftemp%2F&amp;amp;password=&lt;br/&gt;
xxxxxx] failed polling endpoint: sftp://XXXXXXXXXXXXX/out/prod/?delay=30000&amp;amp;delete=true&amp;amp;localWorkDirectory=c%3A%2FMarta%2FHgmTkw14%2Femcs%2Ftemp%2F&amp;amp;pas&lt;br/&gt;
sword=xxxxxx. Will try again at next poll. Caused by: &lt;span class=&quot;error&quot;&gt;&amp;#91;org.apache.camel.component.file.GenericFileOperationFailedException - Cannot change directory to: out&amp;#93;&lt;/span&gt;&lt;br/&gt;
org.apache.camel.component.file.GenericFileOperationFailedException: Cannot change directory to: out&lt;br/&gt;
        at org.apache.camel.component.file.remote.SftpOperations.doChangeDirectory(SftpOperations.java:609)&lt;br/&gt;
        at org.apache.camel.component.file.remote.SftpOperations.changeCurrentDirectory(SftpOperations.java:597)&lt;br/&gt;
        at org.apache.camel.component.file.remote.SftpConsumer.doPollDirectory(SftpConsumer.java:108)&lt;br/&gt;
        at org.apache.camel.component.file.remote.SftpConsumer.pollDirectory(SftpConsumer.java:80)&lt;br/&gt;
        at org.apache.camel.component.file.GenericFileConsumer.poll(GenericFileConsumer.java:124)&lt;br/&gt;
        at org.apache.camel.impl.ScheduledPollConsumer.doRun(ScheduledPollConsumer.java:174)&lt;br/&gt;
        at org.apache.camel.impl.ScheduledPollConsumer.run(ScheduledPollConsumer.java:101)&lt;br/&gt;
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)&lt;br/&gt;
        at java.util.concurrent.FutureTask.runAndReset(FutureTask.java:308)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$301(ScheduledThreadPoolExecutor.java:180)&lt;br/&gt;
        at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:294)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
Caused by: 4:&lt;br/&gt;
        at com.jcraft.jsch.ChannelSftp.cd(ChannelSftp.java:359)&lt;br/&gt;
        at org.apache.camel.component.file.remote.SftpOperations.doChangeDirectory(SftpOperations.java:607)&lt;br/&gt;
        ... 13 more&lt;br/&gt;
Caused by: java.io.IOException: inputstream is closed&lt;br/&gt;
        at com.jcraft.jsch.ChannelSftp.fill(ChannelSftp.java:2911)&lt;br/&gt;
        at com.jcraft.jsch.ChannelSftp.header(ChannelSftp.java:2935)&lt;br/&gt;
        at com.jcraft.jsch.ChannelSftp._realpath(ChannelSftp.java:2355)&lt;br/&gt;
        at com.jcraft.jsch.ChannelSftp.cd(ChannelSftp.java:342)&lt;br/&gt;
        ... 14 more&lt;br/&gt;
}}&lt;/p&gt;</description>
                <environment>&lt;p&gt;java 8, windows 2008 r2, &lt;/p&gt;</environment>
        <key id="13122631">CAMEL-12061</key>
            <summary>SFTP exception-handling more problemtatic than documented</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="dvholten">Dieter von Holten</reporter>
                        <labels>
                            <label>ioexception</label>
                            <label>sftp</label>
                    </labels>
                <created>Mon, 4 Dec 2017 17:34:35 +0000</created>
                <updated>Wed, 17 Jan 2018 09:42:01 +0000</updated>
                            <resolved>Wed, 17 Jan 2018 09:42:01 +0000</resolved>
                                    <version>2.20.1</version>
                                    <fixVersion>2.21.0</fixVersion>
                                    <component>camel-sftp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16280176" author="dvholten" created="Wed, 6 Dec 2017 13:25:00 +0000"  >&lt;p&gt;i looked through the sources along the stacktrace - what happens during the attempted poll and the exception looks reasonable for me.&lt;br/&gt;
However, the restart/retry-things are a little bit unclear. One excepion claims &apos;will try to reconnect on next attempt..&apos; but i have yet to find the things which enforce a reconnect after a failed poll....&lt;/p&gt;</comment>
                            <comment id="16328519" author="davsclaus" created="Wed, 17 Jan 2018 09:07:43 +0000"  >&lt;p&gt;Can you try with disconnect=true&lt;/p&gt;</comment>
                            <comment id="16328526" author="davsclaus" created="Wed, 17 Jan 2018 09:19:48 +0000"  >&lt;p&gt;Can you try enabling DEBUG logging level on the ftp component, and do you see this line when Camel disconnects the FTP client&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;if (log.isDebugEnabled()) {&lt;br/&gt;
 log.debug(&quot;Disconnecting from: {}&quot;, remoteServer());&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;As Camel will attempt to disconnect if that poll failed, as the WARN message says.&lt;/p&gt;

&lt;p&gt;And do you get this error all the time, eg can you reproduce it? We could try to improve camel-ftp to do a hard disconnect and ensure the ftp client is fully re-created.&lt;/p&gt;</comment>
                            <comment id="16328550" author="davsclaus" created="Wed, 17 Jan 2018 09:41:52 +0000"  >&lt;p&gt;Okay we have improved this to do a hard/forced disconnect so the sftp client should be fresh on next poll (before some state may have been left). You can try the 2.21.0 release when its out, or build and try from master yourself.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 44 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3nibr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>