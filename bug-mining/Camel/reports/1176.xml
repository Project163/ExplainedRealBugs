<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:40:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-3144] camel-ftp: fileExist=Fail not honored when producer works in FTP root path</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-3144</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;when using a route with ftp producer such as :&lt;/p&gt;

&lt;p&gt; &amp;lt;to uri=&quot;ftp://user@host/?fileExist=Fail&amp;amp;fileName=test&amp;amp;password=mypass&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;The route will not correctly fail if the fileName already exists.&lt;/p&gt;

&lt;p&gt;It will work in any sub-directory:&lt;/p&gt;

&lt;p&gt; &amp;lt;to uri=&quot;ftp://user@host/mydir?fileExist=Fail&amp;amp;fileName=test&amp;amp;password=mypass&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;The root cause of the bug is an incorrect test in org.apache.camel.util.FileUtil.onlyPath() in component camel-core.&lt;br/&gt;
This method returns null when the parameter string is &quot;/&quot;. It should return &quot;/&quot;.&lt;/p&gt;

&lt;p&gt;The attached patch fixes the issue.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Camel on Linux; IIS FTP server &lt;/p&gt;</environment>
        <key id="12487632">CAMEL-3144</key>
            <summary>camel-ftp: fileExist=Fail not honored when producer works in FTP root path</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hadrian">Hadrian Zbarcea</assignee>
                                    <reporter username="raphael@apache.org">Rapha&#235;l Luta</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Sep 2010 19:59:32 +0000</created>
                <updated>Sun, 24 Apr 2011 09:57:57 +0000</updated>
                            <resolved>Wed, 22 Sep 2010 06:22:40 +0000</resolved>
                                    <version>2.4.0</version>
                                    <fixVersion>2.5.0</fixVersion>
                                    <component>camel-core</component>
                    <component>camel-ftp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12956827" author="hadrian" created="Wed, 22 Sep 2010 06:22:30 +0000"  >&lt;p&gt;Patch applied with minor changes and checkstyle fixes. Thanks Raphael for spotting this.&lt;/p&gt;</comment>
                            <comment id="12956725" author="davsclaus" created="Wed, 22 Sep 2010 06:26:19 +0000"  >&lt;p&gt;Hadrian I am adding additional unit test for this in camel-core and camel-ftp&lt;/p&gt;</comment>
                            <comment id="12956825" author="davsclaus" created="Wed, 22 Sep 2010 06:55:34 +0000"  >&lt;p&gt;Btw the patch is buggy. It should return null if there is no path, but it returns the name of the file. I have fixed that as well.&lt;br/&gt;
Running full tests before committing fixes and additional unit tests.&lt;/p&gt;

&lt;p&gt;Hadrian we should take time to add tests for patches when they discover a bug in which we don&apos;t have an unit test for.&lt;/p&gt;</comment>
                            <comment id="12956741" author="davsclaus" created="Wed, 22 Sep 2010 07:11:53 +0000"  >&lt;p&gt;Okay unit test added and file util fixed as well.&lt;/p&gt;</comment>
                            <comment id="12956828" author="raphael@apache.org" created="Wed, 22 Sep 2010 07:33:08 +0000"  >&lt;p&gt;You&apos;re right, the patch is buggy. I should have tested it with more use cases than my own before attaching, sorry about this.&lt;/p&gt;

&lt;p&gt;Actually, I&apos;m not even sure it is the correct fix because other components may depend on the FileUtil.onlyPath(&quot;/&quot;) == null behavior for correct operation.&lt;br/&gt;
I&apos;m unsure of the expected semantics of the operation in root directory on a file system rather than remote file system.&lt;/p&gt;

&lt;p&gt;An alternate fix with less potential side effects would be to directly fix FtpOperations to better handle a return null from onlyPath(), something like:&lt;/p&gt;

&lt;p&gt;&amp;#8212; FtpOperations.java	2010-09-22 09:16:25.000000000 +0200&lt;br/&gt;
+++ FtpOperations.java.patched	2010-09-22 09:18:51.000000000 +0200&lt;br/&gt;
@@ -381,7 +381,7 @@&lt;br/&gt;
         // check whether a file already exists&lt;br/&gt;
         String directory = FileUtil.onlyPath(name);&lt;br/&gt;
         if (directory == null) &lt;/p&gt;
{
-            return false;
+	    directory = &quot;/&quot;;
         }

&lt;p&gt;         String onlyName = FileUtil.stripPath(name);&lt;/p&gt;</comment>
                            <comment id="12956815" author="davsclaus" created="Wed, 22 Sep 2010 08:20:48 +0000"  >&lt;p&gt;Raphael can you test source from trunk as I also modified camel-ftp as well.&lt;/p&gt;</comment>
                            <comment id="12956847" author="raphael@apache.org" created="Thu, 23 Sep 2010 10:58:17 +0000"  >&lt;p&gt;I&apos;ve created a test environment using camel-2.5-SNAPSHOT artefacts and could not reproduce the bug.&lt;/p&gt;

&lt;p&gt;A tcpdump trace shows that camel-ftp now correctly tries to list the target directory before attempting to write the file.&lt;/p&gt;</comment>
                            <comment id="12956845" author="davsclaus" created="Thu, 23 Sep 2010 13:17:04 +0000"  >&lt;p&gt;Ah this is great news. Thanks for testing Raphael.&lt;/p&gt;</comment>
                            <comment id="13023995" author="davsclaus" created="Sun, 24 Apr 2011 09:57:57 +0000"  >&lt;p&gt;Closing all resolved tickets from 2010 or older&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12463398" name="FileUtil.patch" size="453" author="raphael@apache.org" created="Tue, 21 Sep 2010 20:00:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76330</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 31 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01sxj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8456</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>