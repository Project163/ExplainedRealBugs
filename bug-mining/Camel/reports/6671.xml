<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:04:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-20378] Languages that can take source from header or property is not thread safe</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-20378</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;The SingleInputTypedLanguageSupport is causing the shared language instance that uses the body as input to be changed to header etc. &lt;/p&gt;

&lt;p&gt;This affects jq, jsonpath, xpath and a few other languages that are SingleInputTypedLanguageSupport based.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13566671">CAMEL-20378</key>
            <summary>Languages that can take source from header or property is not thread safe</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="davsclaus">Claus Ibsen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Jan 2024 11:34:19 +0000</created>
                <updated>Thu, 8 Feb 2024 15:25:10 +0000</updated>
                            <resolved>Thu, 8 Feb 2024 15:25:10 +0000</resolved>
                                                    <fixVersion>4.4.0</fixVersion>
                                    <component>camel-core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="17812783" author="davsclaus" created="Wed, 31 Jan 2024 16:24:32 +0000"  >&lt;p&gt;We need to make the reifer grab the input source first, and send it to the language in a standard way (via a header, exchange property or thread-local) so the language can be thread-safe and reusable. A bit like send dynamic EIPs do.&lt;/p&gt;</comment>
                            <comment id="17813165" author="davsclaus" created="Thu, 1 Feb 2024 11:05:44 +0000"  >&lt;p&gt;TODO: tokenize, xtokenize could be typed input source so we do not have 2 classes, but can just have 1&lt;/p&gt;</comment>
                            <comment id="17813171" author="davsclaus" created="Thu, 1 Feb 2024 11:22:44 +0000"  >&lt;p&gt;TODO: SingleInputTypedLanguageSupport is not thread safe for resultType as well&lt;/p&gt;</comment>
                            <comment id="17813241" author="davsclaus" created="Thu, 1 Feb 2024 14:05:03 +0000"  >&lt;p&gt;Okay so its the Java DSL that has mostly this problem, as it does not create the languages in exactly the same way as XML/YAML DSLs. I think it would be worth to make this the same via reifiers as this would be needed to ensure thread-safety for those input sources and result type.&lt;/p&gt;
</comment>
                            <comment id="17813263" author="davsclaus" created="Thu, 1 Feb 2024 14:49:11 +0000"  >&lt;p&gt;Ensure that these languages are created the same way via reifier and properties&lt;/p&gt;

&lt;p&gt;datasonnet &lt;b&gt;DONE&lt;/b&gt;&lt;br/&gt;
hl7 &lt;b&gt;OK&lt;/b&gt;&lt;br/&gt;
java / joor &lt;b&gt;OK&lt;/b&gt;&lt;br/&gt;
jq &lt;b&gt;DONE&lt;/b&gt;&lt;br/&gt;
jsonpath &lt;b&gt;DONE&lt;/b&gt;&lt;br/&gt;
method &lt;b&gt;DONE&lt;/b&gt;&lt;br/&gt;
tokenize &lt;b&gt;DONE&lt;/b&gt;&lt;br/&gt;
wasm &lt;b&gt;OK&lt;/b&gt;&lt;br/&gt;
xpath &lt;b&gt;OK&lt;/b&gt;&lt;br/&gt;
xquery &lt;b&gt;OK&lt;/b&gt;&lt;br/&gt;
xtokenize &lt;b&gt;DONE&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Avoid to have setter/getter on the language instances as that is not thread-safe&lt;/p&gt;</comment>
                            <comment id="17813651" author="davsclaus" created="Fri, 2 Feb 2024 12:28:53 +0000"  >&lt;p&gt;TODO: languages that has source should use createExpression(source,...) &lt;b&gt;DONE&lt;/b&gt;&lt;br/&gt;
TODO: should throw exception if source is variable / property / header and its not present (such as jq language) &lt;b&gt;DONE&lt;/b&gt;&lt;br/&gt;
TODO: resultType should not be configurable on language (not thread safe) &lt;b&gt;DONE&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="17813898" author="davsclaus" created="Sat, 3 Feb 2024 09:35:55 +0000"  >&lt;p&gt;TODO: source header fallback to property should be removed (camel-jq unit tests etc) &lt;b&gt;DONE&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="17813908" author="davsclaus" created="Sat, 3 Feb 2024 10:49:00 +0000"  >&lt;p&gt;TODO: variable, header, property to be 1 option instead of 3 options&lt;/p&gt;</comment>
                            <comment id="17813909" author="davsclaus" created="Sat, 3 Feb 2024 11:00:41 +0000"  >&lt;p&gt;TODO: More languages could support source input (such as datasonnet) &lt;b&gt;DONE&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="17813910" author="davsclaus" created="Sat, 3 Feb 2024 11:08:07 +0000"  >&lt;p&gt;TODO: tokenize, xtokenize to use source and extend single input type so its the same as the others &lt;b&gt;DONE&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="17813911" author="davsclaus" created="Sat, 3 Feb 2024 11:11:20 +0000"  >&lt;p&gt;TODO: weird issue in kotlin-dsl and groovy-dsl with custom languages &lt;b&gt;DONE&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="17813928" author="davsclaus" created="Sat, 3 Feb 2024 12:08:32 +0000"  >&lt;p&gt;TODO: order properties[] for createExpression to be same ordering with resultType as index 0 &lt;b&gt;DONE&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="17814172" author="davsclaus" created="Mon, 5 Feb 2024 06:14:29 +0000"  >&lt;p&gt;TODO: tokenize/xtokenize - camel.util.Scanner to use type converter in its iterator next &lt;b&gt;DONE&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="17814388" author="davsclaus" created="Mon, 5 Feb 2024 14:45:12 +0000"  >&lt;p&gt;Last thing to consider is &lt;/p&gt;

&lt;p&gt;TODO: variable, header, property to be 1 option instead of 3 options &lt;b&gt;DONE&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;The naming of those options is not so intuitive as they are used as input source, and you cannot understand this in the beginning.&lt;br/&gt;
So if we have 1 option named: source where you can type&lt;/p&gt;

&lt;p&gt;source = header:foo&lt;br/&gt;
source = variable:bar&lt;br/&gt;
source = body (is default)&lt;/p&gt;

&lt;p&gt;then its only 1 option and have more flexibility.&lt;/p&gt;
</comment>
                            <comment id="17815634" author="davsclaus" created="Thu, 8 Feb 2024 11:15:50 +0000"  >&lt;p&gt;TODO: hl7, datasonnet language annotations need annotation factory to work &lt;b&gt;DONE&lt;/b&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13567060">CAMEL-20386</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13547437">CAMEL-19749</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13566547">CAMEL-20376</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 39 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1n38o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>