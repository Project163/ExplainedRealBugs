<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:35:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-2054] Mail Component: Content-ID reference in multipart broken</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-2054</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;It looks like Camel Mail Component does not set Content-ID mime header correctly or probably assumption is that BodyPart will take care of it. As a result embedded images in html body do not work ( img src=&quot;cid:somename.img&quot;).&lt;/p&gt;

&lt;p&gt;Currently Content-ID is set as -&lt;/p&gt;

&lt;p&gt;//MailBinding.java&lt;br/&gt;
// add a Content-ID header to the attachment&lt;br/&gt;
messageBodyPart.addHeader(&quot;Content-ID&quot;, attachmentFilename.substring(4));&lt;/p&gt;

&lt;p&gt;But according to RFC standards &lt;a href=&quot;http://www.ietf.org/rfc/rfc2392.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.ietf.org/rfc/rfc2392.txt&lt;/a&gt;, Content-ID value should be enclosed with in angle brackets, so it should be modified to -&lt;/p&gt;

&lt;p&gt;//MailBinding.java&lt;br/&gt;
// add a Content-ID header to the attachment&lt;br/&gt;
messageBodyPart.addHeader(&quot;Content-ID&quot;, &quot;&amp;lt;&quot; + attachmentFilename.substring(4) + &quot;&amp;gt;&quot;);&lt;/p&gt;

&lt;p&gt;Also, below should be modified which incorrectly sets fileName inclusive of &quot;cid:&quot;, but expectation would be strip off &quot;cid&quot; off it, similar to Content-ID&lt;/p&gt;

&lt;p&gt;// Set the filename&lt;br/&gt;
messageBodyPart.setFileName(attachmentFilename);&lt;/p&gt;

&lt;p&gt;Should be -&lt;/p&gt;

&lt;p&gt;// Set the filename&lt;br/&gt;
messageBodyPart.setFileName(attachmentFilename.substring(4));&lt;/p&gt;

&lt;p&gt;Also, RFC standard mentions that Content-ID should be globally unique but Camel Mail just sets it to filename instead. I understand this can be problematic as camel will have to replace references to each of such cid&apos;s  in any of the mail parts. &lt;/p&gt;

&lt;p&gt;As I understand from RFC document, is that this is required in case you send emails itself attachments, and attachments can same name can trample each other(I may be wrong here). I guess we can live with this for a while &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Email clients like gmail, zimbra. Outlook 2003 works&lt;/p&gt;</environment>
        <key id="12486956">CAMEL-2054</key>
            <summary>Mail Component: Content-ID reference in multipart broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="tide08">slad</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Oct 2009 00:20:39 +0000</created>
                <updated>Thu, 3 Jun 2010 07:24:43 +0000</updated>
                            <resolved>Fri, 16 Oct 2009 04:54:54 +0000</resolved>
                                    <version>1.6.1</version>
                    <version>1.6.2</version>
                    <version>2.0.0</version>
                                    <fixVersion>1.6.2</fixVersion>
                    <fixVersion>2.1.0</fixVersion>
                                    <component>camel-mail</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12952178" author="davsclaus" created="Thu, 8 Oct 2009 04:38:28 +0000"  >&lt;p&gt;See more details here:&lt;br/&gt;
&lt;a href=&quot;http://www.nabble.com/Camel-Mail-Component%3A-Content-ID-incorrect--td25760500.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.nabble.com/Camel-Mail-Component%3A-Content-ID-incorrect--td25760500.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12952221" author="davsclaus" created="Thu, 8 Oct 2009 09:32:57 +0000"  >&lt;p&gt;Yeah I wonder why/who decided to use the first 4 characters from the filename?&lt;/p&gt;

&lt;p&gt;We can use the ExchangeID + iterate number which then will be global unique.&lt;/p&gt;</comment>
                            <comment id="12952239" author="davsclaus" created="Thu, 8 Oct 2009 09:51:31 +0000"  >&lt;p&gt;I am not sure about the filename thing must be trunked to 4 as well.&lt;br/&gt;
I cannot see this in the RFC.&lt;/p&gt;

&lt;p&gt;I have however fixed the angle bracket thing.&lt;/p&gt;

&lt;p&gt;trunk: 823102.&lt;br/&gt;
1.x: 823105.&lt;/p&gt;</comment>
                            <comment id="12952299" author="davsclaus" created="Thu, 8 Oct 2009 11:38:41 +0000"  >&lt;p&gt;Just a test&lt;/p&gt;</comment>
                            <comment id="12952675" author="tide08" created="Fri, 9 Oct 2009 03:36:50 +0000"  >&lt;p&gt;Thanks Claus for the fix. Yes, truncating 4 char in filename is not RFC standard but the problem is filename shows up as &quot;cid:filename&quot; in email, which is not nice as users do not see readable filename in the email. I hope this gets fixed.&lt;/p&gt;

&lt;p&gt;I mentioned wrong fix above, it should be conditional i.e.&lt;/p&gt;

&lt;p&gt;+                    if (attachmentFilename.toLowerCase().startsWith(&quot;cid:&quot;)) &lt;/p&gt;
{
+                        messageBodyPart.setFileName(attachmentFilename.substring(4));
+                    }
&lt;p&gt; else &lt;/p&gt;
{
+                        messageBodyPart.setFileName(attachmentFilename);
+                    }

&lt;p&gt;Regarding, unique name for content-id, it can be tough one to resolve as camel generated content-id has to be than replace in any of the mail parts which are referencing it.&lt;/p&gt;

&lt;p&gt;For ex: If I have logo.gif as attachment, I may have referenced it in email body like &amp;lt;img src=&quot;cid:logo.gif&quot; /&amp;gt; &lt;/p&gt;

&lt;p&gt;So if camel generates unique content-id for this part as lets say - 123ABC than part will have Content-ID: &amp;lt;123ABC&amp;gt; than we have to change the reference for all logo.gif in body part &lt;/p&gt;

&lt;p&gt;i.e. above image reference should now get changed to &amp;lt;img src=&quot;123ABC&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="12952766" author="davsclaus" created="Fri, 9 Oct 2009 08:15:26 +0000"  >&lt;p&gt;@slad&lt;/p&gt;

&lt;p&gt;Yeah if we can get the attachment file name to appear as nice readable instead of cid:0001 then that would be great.&lt;/p&gt;

&lt;p&gt;In terms of unique global it may or may not be a bit overkill. I think we should leave it as is, as you can refer to them more easily when its cid:xxxx.&lt;br/&gt;
But the substring to 4 is something we should remove as well.&lt;/p&gt;</comment>
                            <comment id="12952618" author="davsclaus" created="Fri, 16 Oct 2009 04:54:47 +0000"  >&lt;p&gt;trunk: 825765&lt;br/&gt;
1.x: 825767&lt;/p&gt;

&lt;p&gt;Thanks I have fixed the filename.&lt;/p&gt;

&lt;p&gt;Would be great if you could test it on your system.&lt;/p&gt;</comment>
                            <comment id="12953337" author="tide08" created="Tue, 10 Nov 2009 22:27:18 +0000"  >&lt;p&gt;@Claus&lt;/p&gt;

&lt;p&gt;Sorry, it took so long but we were in release cycle. Updated camel to 2.1-SNAPSHOT and it works like charm!&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="12955664" author="davsclaus" created="Thu, 3 Jun 2010 07:24:43 +0000"  >&lt;p&gt;Closing old resolved issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>76654</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i01m7z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7369</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>