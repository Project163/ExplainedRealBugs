<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:25:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-11672] Input stream infinitive loop</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-11672</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Dear Camel team,&lt;br/&gt;
While working on one integration we found issue related to camel-http component when solution is deployed on IBM Liberty core.&lt;br/&gt;
Same issue is not reproducible on Jetty and Tomcat.&lt;/p&gt;

&lt;p&gt;Issue is connected to the code in IOHelper and CachedOutputStream$WrappedInputStream&lt;br/&gt;
We are using version 2.12.4 but I can see that same code is used also in latest versions.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/camel/blob/camel-2.12.4/camel-core/src/main/java/org/apache/camel/util/IOHelper.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/camel-2.12.4/camel-core/src/main/java/org/apache/camel/util/IOHelper.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Problematic part are lines 196, 198 and 204.&lt;br/&gt;
Basically stream reader which is used org.apache.camel.converter.stream.CachedOutputStream$WrappedInputStream is not returning -1 like response of read method if empty string is provided on input.&lt;br/&gt;
This is wrong by specification of InputReader interface.&lt;/p&gt;

&lt;p&gt;       // in the case there is input which is empty string&lt;br/&gt;
       while ( -1 != n) &lt;/p&gt;
{
         &#8230;
         int n = input.read(buffer);  ---&amp;gt; this is never -1 if string is empty &quot;&quot; already 0 and we have infinitive loop !!!
        }

&lt;p&gt;For our use case we have applied change in IOHelper to check and directly cover if stream reader produce same (non-valid) response to not produce infinitive loop.&lt;/p&gt;

&lt;p&gt;If any questions around reproducing issue please let me know&lt;/p&gt;

&lt;p&gt;Best regards,&lt;br/&gt;
Zeljko&lt;/p&gt;</description>
                <environment>&lt;p&gt;IBM Websphere Liberty Core 17.0.0.1&lt;br/&gt;
IBM Websphere Liberty Core 17.0.0.2&lt;br/&gt;
Reproducible using both IBM JDK 8 and Oracle JDK 8&lt;/p&gt;</environment>
        <key id="13094786">CAMEL-11672</key>
            <summary>Input stream infinitive loop</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="zeljkov">Zeljko Vukovic</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Aug 2017 15:42:11 +0000</created>
                <updated>Tue, 12 Sep 2017 09:56:09 +0000</updated>
                            <resolved>Tue, 12 Sep 2017 09:56:09 +0000</resolved>
                                    <version>2.12.4</version>
                                    <fixVersion>2.20.0</fixVersion>
                                    <component>camel-http</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16136036" author="davsclaus" created="Mon, 21 Aug 2017 23:51:46 +0000"  >&lt;p&gt;camel-http is deprecated&lt;/p&gt;</comment>
                            <comment id="16136569" author="zeljkov" created="Tue, 22 Aug 2017 09:38:25 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;,&lt;br/&gt;
Actually IOHelper is in camel-core but in our case call was made from DefaultHttpBinding in camel-http that is the reason why I have specified camel-http as component.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Zeljko&lt;/p&gt;</comment>
                            <comment id="16151741" author="davsclaus" created="Sun, 3 Sep 2017 08:21:56 +0000"  >&lt;p&gt;Try with newer Camel version even so as 2.12.x is EOL.&lt;/p&gt;</comment>
                            <comment id="16162719" author="davsclaus" created="Tue, 12 Sep 2017 09:21:40 +0000"  >&lt;p&gt;Okay working on adding a workaround where we regard it as EOL if the first read byte is a zero value&lt;/p&gt;</comment>
                            <comment id="16162753" author="davsclaus" created="Tue, 12 Sep 2017 09:56:09 +0000"  >&lt;p&gt;Copying streams in IOHelper from came-core now regard EOL of data if the first read byte is zero to work around issues on some application servers like IBM WebSphere. This can be turned off by setting JVM system property &quot;camel.zeroByteEOLEnabled=false&quot;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 10 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3it7j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>