<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:20:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-10602] camel:run with simple blueprint project failed &quot;waiting for BlueprintContainer&quot; although the route is active</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-10602</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Using a simple Content-based Router example leads to this issue.&lt;br/&gt;
With 2.17.3, it is working fine.&lt;/p&gt;

&lt;p&gt;we can notice that the route is up and running before the timeout occurs (I dropped a file to the endpoint and it was well executed)&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[INFO] Scanning for projects...
[INFO]                                                                         
[INFO] ------------------------------------------------------------------------
[INFO] Building Fuse CBR Quickstart 1.0.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO] 
[INFO] --- maven-clean-plugin:2.5:clean (default-clean) @ camel-blueprint-cbr ---
[INFO] Deleting C:\install\eclipse-neon\eclipse\ws_fusetooling_dev with space\cbr218\target
[INFO] 
[INFO] --- maven-resources-plugin:3.0.1:resources (default-resources) @ camel-blueprint-cbr ---
[INFO] Using &apos;UTF-8&apos; encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:compile (default-compile) @ camel-blueprint-cbr ---
[INFO] No sources to compile
[INFO] 
[INFO] --- maven-resources-plugin:3.0.1:testResources (default-testResources) @ camel-blueprint-cbr ---
[INFO] Not copying test resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (default-testCompile) @ camel-blueprint-cbr ---
[INFO] Not compiling test sources
[INFO] 
[INFO] --- maven-surefire-plugin:2.19.1:test (default-test) @ camel-blueprint-cbr ---
[INFO] Tests are skipped.
[INFO] 
[INFO] --- maven-bundle-plugin:3.2.0:bundle (default-bundle) @ camel-blueprint-cbr ---
[INFO] 
[INFO] &amp;gt;&amp;gt;&amp;gt; camel-maven-plugin:2.18.1:run (default-cli) &amp;gt; test-compile @ camel-blueprint-cbr &amp;gt;&amp;gt;&amp;gt;
[INFO] 
[INFO] --- maven-resources-plugin:3.0.1:resources (default-resources) @ camel-blueprint-cbr ---
[INFO] Using &apos;UTF-8&apos; encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:compile (default-compile) @ camel-blueprint-cbr ---
[INFO] No sources to compile
[INFO] 
[INFO] --- maven-resources-plugin:3.0.1:testResources (default-testResources) @ camel-blueprint-cbr ---
[INFO] Not copying test resources
[INFO] 
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (default-testCompile) @ camel-blueprint-cbr ---
[INFO] Not compiling test sources
[INFO] 
[INFO] &amp;lt;&amp;lt;&amp;lt; camel-maven-plugin:2.18.1:run (default-cli) &amp;lt; test-compile @ camel-blueprint-cbr &amp;lt;&amp;lt;&amp;lt;
[INFO] 
[INFO] --- camel-maven-plugin:2.18.1:run (default-cli) @ camel-blueprint-cbr ---
[INFO] Using org.apache.camel.test.blueprint.Main to initiate a CamelContext
[INFO] Starting Camel ...
[                      Thread-2] RawBuilder                     INFO  Copy thread finished.
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator starting
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator started
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator starting
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator started
[         Blueprint Extender: 1] BlueprintContainerImpl         INFO  Bundle cbr218/1.0.0.SNAPSHOT is waiting for namespace handlers [http://camel.apache.org/schema/blueprint]
[         Blueprint Extender: 1] BlueprintCamelContext          INFO  Apache Camel 2.18.1 (CamelContext: cbr-example-context) is starting
[         Blueprint Extender: 1] ManagedManagementStrategy      INFO  JMX is enabled
[         Blueprint Extender: 1] DefaultManagementAgent         INFO  ManagementAgent detected JVM system properties: {org.apache.camel.jmx.createRmiConnector=true}
[KTOP-9NT300B:1099/jmxrmi/camel] DefaultManagementAgent         INFO  JMX Connector thread started and listening at: service:jmx:rmi:///jndi/rmi://DESKTOP-9NT300B:1099/jmxrmi/camel
[         Blueprint Extender: 1] DefaultRuntimeEndpointRegistry INFO  Runtime endpoint registry is in extended mode gathering usage statistics of all incoming and outgoing endpoints (cache limit: 1000)
[         Blueprint Extender: 1] BlueprintCamelContext          INFO  StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
[         Blueprint Extender: 1] XPathBuilder                   INFO  Created default XPathFactory com.sun.org.apache.xpath.internal.jaxp.XPathFactoryImpl@3f24f264
[         Blueprint Extender: 1] BlueprintCamelContext          INFO  Route: cbr-route started and consuming from: file://work/cbr/input
[         Blueprint Extender: 1] BlueprintCamelContext          INFO  Total 1 routes, of which 1 are started.
[         Blueprint Extender: 1] BlueprintCamelContext          INFO  Apache Camel 2.18.1 (CamelContext: cbr-example-context) started in 0.535 seconds
[ead #2 - file://work/cbr/input] cbr-route                      INFO  Receiving order ID-DESKTOP-9NT300B-51935-1481791551205-0-1
[ead #2 - file://work/cbr/input] cbr-route                      INFO  Sending order ID-DESKTOP-9NT300B-51935-1481791551205-0-1 to another country
[ead #2 - file://work/cbr/input] cbr-route                      INFO  Done processing ID-DESKTOP-9NT300B-51935-1481791551205-0-1
[mel.test.blueprint.Main.main()] BlueprintExtender              INFO  Destroying BlueprintContainer for bundle org.apache.aries.blueprint.cm/1.0.6
[mel.test.blueprint.Main.main()] BlueprintExtender              INFO  Destroying BlueprintContainer for bundle cbr218/1.0.0.SNAPSHOT
[mel.test.blueprint.Main.main()] BlueprintCamelContext          INFO  Apache Camel 2.18.1 (CamelContext: cbr-example-context) is shutting down
[mel.test.blueprint.Main.main()] DefaultShutdownStrategy        INFO  Starting to graceful shutdown 1 routes (timeout 300 seconds)
[text) thread #3 - ShutdownTask] DefaultShutdownStrategy        INFO  Route: cbr-route shutdown complete, was consuming from: file://work/cbr/input
[mel.test.blueprint.Main.main()] DefaultShutdownStrategy        INFO  Graceful shutdown of 1 routes completed in 0 seconds
[mel.test.blueprint.Main.main()] BlueprintCamelContext          INFO  Apache Camel 2.18.1 (CamelContext: cbr-example-context) uptime 28.869 seconds
[mel.test.blueprint.Main.main()] BlueprintCamelContext          INFO  Apache Camel 2.18.1 (CamelContext: cbr-example-context) is shutdown in 0.019 seconds
[mel.test.blueprint.Main.main()] BlueprintExtender              INFO  Destroying BlueprintContainer for bundle org.apache.aries.blueprint.core/1.4.4
[mel.test.blueprint.Main.main()] BlueprintExtender              INFO  Destroying BlueprintContainer for bundle org.apache.camel.camel-blueprint/2.18.1
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator stopping
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator stopped
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator stopping
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator stopped
[mel.test.blueprint.Main.main()] CamelBlueprintHelper           INFO  Deleting work directory target/bundles/1481791550078
[ERROR] *************************************
[ERROR] Error occurred while running main from: org.apache.camel.test.blueprint.Main
[ERROR] 
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.apache.camel.maven.RunMojo$1.run(RunMojo.java:472)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.RuntimeException: Gave up waiting for BlueprintContainer from bundle &quot;MyBundle&quot;
	at org.apache.camel.test.blueprint.CamelBlueprintHelper.waitForBlueprintContainer(CamelBlueprintHelper.java:363)
	at org.apache.camel.test.blueprint.Main.doStart(Main.java:111)
	at org.apache.camel.support.ServiceSupport.start(ServiceSupport.java:61)
	at org.apache.camel.main.MainSupport.run(MainSupport.java:138)
	at org.apache.camel.main.MainSupport.run(MainSupport.java:390)
	at org.apache.camel.test.blueprint.Main.main(Main.java:82)
	... 6 more
[ERROR] *************************************
[WARNING] thread Thread[ForkJoinPool.commonPool-worker-1,5,org.apache.camel.test.blueprint.Main] was interrupted but is still alive after waiting at least 15000msecs
[WARNING] thread Thread[ForkJoinPool.commonPool-worker-1,5,org.apache.camel.test.blueprint.Main] will linger despite being asked to die via interruption
[WARNING] thread Thread[ForkJoinPool.commonPool-worker-5,5,org.apache.camel.test.blueprint.Main] will linger despite being asked to die via interruption
[WARNING] NOTE: 2 thread(s) did not finish despite being asked to  via interruption. This is not a problem with exec:java, it is a problem with the running code. Although not serious, it should be remedied.
[WARNING] Couldn&apos;t destroy threadgroup org.apache.camel.maven.RunMojo$IsolatedThreadGroup[name=org.apache.camel.test.blueprint.Main,maxpri=10]
java.lang.IllegalThreadStateException
	at java.lang.ThreadGroup.destroy(ThreadGroup.java:778)
	at org.apache.camel.maven.RunMojo.execute(RunMojo.java:505)
	at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:134)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:207)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:116)
	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:80)
	at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build(SingleThreadedBuilder.java:51)
	at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:128)
	at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:307)
	at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:193)
	at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:106)
	at org.apache.maven.cli.MavenCli.execute(MavenCli.java:863)
	at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:288)
	at org.apache.maven.cli.MavenCli.main(MavenCli.java:199)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:497)
	at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:289)
	at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:229)
	at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:415)
	at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:356)
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 49.194 s
[INFO] Finished at: 2016-12-15T09:46:35+01:00
[INFO] Final Memory: 44M/547M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.camel:camel-maven-plugin:2.18.1:run (default-cli) on project camel-blueprint-cbr: null: MojoExecutionException: InvocationTargetException: Gave up waiting for BlueprintContainer from bundle &quot;MyBundle&quot; -&amp;gt; [Help 1]
[ERROR] 
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR] 
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException
[                      Thread-1] MainSupport$HangupInterceptor  INFO  Received hang up - stopping the main instance.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;my first guess is that Camel 2.18.1 is starting faster and that some events occurs in the same milliseconds (considering the the jvm precision): &lt;a href=&quot;https://github.com/apache/camel/blame/master/components/camel-test-blueprint/src/main/java/org/apache/camel/test/blueprint/CamelBlueprintHelper.java#L344&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blame/master/components/camel-test-blueprint/src/main/java/org/apache/camel/test/blueprint/CamelBlueprintHelper.java#L344&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13028348">CAMEL-10602</key>
            <summary>camel:run with simple blueprint project failed &quot;waiting for BlueprintContainer&quot; although the route is active</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggrzybek">Grzegorz Grzybek</assignee>
                                    <reporter username="aurelien.pupier">Aurelien Pupier</reporter>
                        <labels>
                    </labels>
                <created>Thu, 15 Dec 2016 09:53:12 +0000</created>
                <updated>Fri, 16 Dec 2016 14:33:14 +0000</updated>
                            <resolved>Fri, 16 Dec 2016 09:21:43 +0000</resolved>
                                    <version>2.18.0</version>
                    <version>2.18.1</version>
                    <version>2.19.0</version>
                                    <fixVersion>2.18.2</fixVersion>
                    <fixVersion>2.19.0</fixVersion>
                                    <component>camel-blueprint</component>
                    <component>tooling</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15751009" author="davsclaus" created="Thu, 15 Dec 2016 10:24:03 +0000"  >&lt;p&gt;This can be re-produced using&lt;/p&gt;

&lt;p&gt;mvn archetype:generate&lt;br/&gt;
choose camel-archetype-blueprint&lt;br/&gt;
select 2.18.1 version&lt;br/&gt;
create the project&lt;br/&gt;
modify the pom.xml and remove &amp;lt;scope&amp;gt;test&amp;lt;/scope&amp;gt; for all the loggers&lt;br/&gt;
mvn compile camel:run&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;davsclaus:/Users/davsclaus/Documents/workspace/blue/$ mvn clean compile camel:run
[INFO] Scanning &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building A Camel Blueprint Route 1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] --- maven-clean-plugin:2.5:clean (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-clean) @ blue ---
[INFO] Deleting /Users/davsclaus/Documents/workspace/blue/target
[INFO]
[INFO] --- maven-resources-plugin:3.0.1:resources (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-resources) @ blue ---
[INFO] Using &lt;span class=&quot;code-quote&quot;&gt;&apos;UTF-8&apos;&lt;/span&gt; encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO]
[INFO] --- maven-compiler-plugin:3.5.1:compile (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-compile) @ blue ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 2 source files to /Users/davsclaus/Documents/workspace/blue/target/classes
[INFO]
[INFO] &amp;gt;&amp;gt;&amp;gt; camel-maven-plugin:2.18.1:run (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-cli) &amp;gt; test-compile @ blue &amp;gt;&amp;gt;&amp;gt;
[INFO]
[INFO] --- maven-resources-plugin:3.0.1:resources (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-resources) @ blue ---
[INFO] Using &lt;span class=&quot;code-quote&quot;&gt;&apos;UTF-8&apos;&lt;/span&gt; encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO]
[INFO] --- maven-compiler-plugin:3.5.1:compile (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-compile) @ blue ---
[INFO] Nothing to compile - all classes are up to date
[INFO]
[INFO] --- maven-resources-plugin:3.0.1:testResources (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-testResources) @ blue ---
[INFO] Using &lt;span class=&quot;code-quote&quot;&gt;&apos;UTF-8&apos;&lt;/span&gt; encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO]
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-testCompile) @ blue ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 3 source files to /Users/davsclaus/Documents/workspace/blue/target/test-classes
[INFO] /Users/davsclaus/Documents/workspace/blue/src/test/java/com/foo/BlueprintBeanPropertiesOverrideFromTestRouteTest.java: /Users/davsclaus/Documents/workspace/blue/src/test/java/com/foo/BlueprintBeanPropertiesOverrideFromTestRouteTest.java uses unchecked or unsafe operations.
[INFO] /Users/davsclaus/Documents/workspace/blue/src/test/java/com/foo/BlueprintBeanPropertiesOverrideFromTestRouteTest.java: Recompile with -Xlint:unchecked &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; details.
[INFO]
[INFO] &amp;lt;&amp;lt;&amp;lt; camel-maven-plugin:2.18.1:run (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-cli) &amp;lt; test-compile @ blue &amp;lt;&amp;lt;&amp;lt;
[INFO]
[INFO] --- camel-maven-plugin:2.18.1:run (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-cli) @ blue ---
[INFO] camel-blueprint detected on classpath
[INFO] OSGi Blueprint XML files detected in directory /Users/davsclaus/Documents/workspace/blue/src/main/resources/OSGI-INF/blueprint
[INFO] Using org.apache.camel.test.blueprint.Main to initiate a CamelContext
[INFO] Starting Camel ...
Dec 15, 2016 11:21:22 AM org.ops4j.pax.swissbox.tinybundles.core.metadata.RawBuilder run
INFO: Copy thread finished.
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator starting
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator started
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator starting
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator started
[mel.test.blueprint.Main.main()] BlueprintExtender              INFO  Destroying BlueprintContainer &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; bundle org.apache.aries.blueprint.cm/1.0.6
[mel.test.blueprint.Main.main()] BlueprintExtender              INFO  Destroying BlueprintContainer &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; bundle org.apache.aries.blueprint.core/1.4.4
[mel.test.blueprint.Main.main()] BlueprintExtender              INFO  Destroying BlueprintContainer &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; bundle org.apache.camel.camel-blueprint/2.18.1
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator stopping
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator stopped
[ERROR] *************************************
[ERROR] Error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running main from: org.apache.camel.test.blueprint.Main
[ERROR]
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.camel.maven.RunMojo$1.run(RunMojo.java:472)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: Gave up waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; BlueprintContainer from bundle &lt;span class=&quot;code-quote&quot;&gt;&quot;MyBundle&quot;&lt;/span&gt;
	at org.apache.camel.test.blueprint.CamelBlueprintHelper.waitForBlueprintContainer(CamelBlueprintHelper.java:363)
	at org.apache.camel.test.blueprint.Main.doStart(Main.java:111)
	at org.apache.camel.support.ServiceSupport.start(ServiceSupport.java:61)
	at org.apache.camel.main.MainSupport.run(MainSupport.java:138)
	at org.apache.camel.main.MainSupport.run(MainSupport.java:390)
	at org.apache.camel.test.blueprint.Main.main(Main.java:82)
	... 6 more
[ERROR] *************************************
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 40.306 s
[INFO] Finished at: 2016-12-15T11:21:55+01:00
[INFO] Final Memory: 31M/341M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.camel:camel-maven-plugin:2.18.1:run (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-cli) on project blue: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;: MojoExecutionException: InvocationTargetException: Gave up waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; BlueprintContainer from bundle &lt;span class=&quot;code-quote&quot;&gt;&quot;MyBundle&quot;&lt;/span&gt; -&amp;gt; [Help 1]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15751016" author="davsclaus" created="Thu, 15 Dec 2016 10:27:15 +0000"  >&lt;p&gt;Its also a problem with 2.18.0&lt;/p&gt;</comment>
                            <comment id="15751305" author="davsclaus" created="Thu, 15 Dec 2016 12:59:51 +0000"  >&lt;p&gt;The example: camel-example-transformer-blueprint&lt;br/&gt;
Will fail on shutdown instead, eg if you rub&lt;/p&gt;

&lt;p&gt;   mvn compile camel:run&lt;/p&gt;

&lt;p&gt;Then it startup and when it stops it fails&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2016-12-15 13:58:11,554 [&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;.Main.main()] INFO  BlueprintExtender              - Destroying BlueprintContainer &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; bundle org.apache.aries.blueprint.cm/1.0.6
2016-12-15 13:58:11,557 [&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;.Main.main()] INFO  BlueprintExtender              - Destroying BlueprintContainer &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; bundle org.apache.camel.camel-example-transformer-blueprint/2.19.0.SNAPSHOT
2016-12-15 13:58:11,558 [t Dispatcher: 1] INFO  BlueprintCamelContext          - Stopping Camel Context TransformerBlueprint
2016-12-15 13:58:11,558 [t Dispatcher: 1] INFO  BlueprintCamelContext          - Apache Camel 2.19.0-SNAPSHOT (CamelContext: TransformerBlueprint) is shutting down
2016-12-15 13:58:11,559 [t Dispatcher: 1] INFO  DefaultShutdownStrategy        - Starting to graceful shutdown 2 routes (timeout 300 seconds)
2016-12-15 13:58:11,563 [ - ShutdownTask] INFO  DefaultShutdownStrategy        - Route: timer-route shutdown complete, was consuming from: timer:&lt;span class=&quot;code-comment&quot;&gt;//foo?period=5s
&lt;/span&gt;2016-12-15 13:58:11,564 [ - ShutdownTask] INFO  DefaultShutdownStrategy        - Route: xslt-route shutdown complete, was consuming from: direct:&lt;span class=&quot;code-comment&quot;&gt;//a
&lt;/span&gt;2016-12-15 13:58:11,564 [t Dispatcher: 1] INFO  DefaultShutdownStrategy        - Graceful shutdown of 2 routes completed in 0 seconds
2016-12-15 13:58:11,598 [t Dispatcher: 1] INFO  BlueprintCamelContext          - Apache Camel 2.19.0-SNAPSHOT (CamelContext: TransformerBlueprint) uptime 28.194 seconds
2016-12-15 13:58:11,599 [t Dispatcher: 1] INFO  BlueprintCamelContext          - Apache Camel 2.19.0-SNAPSHOT (CamelContext: TransformerBlueprint) is shutdown in 0.040 seconds
2016-12-15 13:58:11,599 [&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;.Main.main()] INFO  BlueprintExtender              - Destroying BlueprintContainer &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; bundle org.apache.camel.camel-blueprint/2.19.0.SNAPSHOT
2016-12-15 13:58:11,600 [&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;.Main.main()] INFO  BlueprintExtender              - Destroying BlueprintContainer &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; bundle org.apache.aries.blueprint.core/1.4.4
2016-12-15 13:58:11,604 [&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;.Main.main()] INFO  Activator                      - Camel activator stopping
2016-12-15 13:58:11,605 [&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;.Main.main()] INFO  Activator                      - Camel activator stopped
[ERROR] *************************************
[ERROR] Error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; running main from: org.apache.camel.test.blueprint.Main
[ERROR]
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.apache.camel.maven.RunMojo$1.run(RunMojo.java:472)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.RuntimeException: Gave up waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; BlueprintContainer from bundle &lt;span class=&quot;code-quote&quot;&gt;&quot;MyBundle&quot;&lt;/span&gt;
	at org.apache.camel.test.blueprint.CamelBlueprintHelper.waitForBlueprintContainer(CamelBlueprintHelper.java:363)
	at org.apache.camel.test.blueprint.Main.doStart(Main.java:111)
	at org.apache.camel.support.ServiceSupport.start(ServiceSupport.java:61)
	at org.apache.camel.main.MainSupport.run(MainSupport.java:138)
	at org.apache.camel.main.MainSupport.run(MainSupport.java:390)
	at org.apache.camel.test.blueprint.Main.main(Main.java:82)
	... 6 more
[ERROR] *************************************
[WARNING] thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[ForkJoinPool.commonPool-worker-2,5,org.apache.camel.test.blueprint.Main] was interrupted but is still alive after waiting at least 2992msecs
[WARNING] thread &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[ForkJoinPool.commonPool-worker-2,5,org.apache.camel.test.blueprint.Main] will linger despite being asked to die via interruption
[WARNING] NOTE: 1 thread(s) did not finish despite being asked to  via interruption. This is not a problem with exec:java, it is a problem with the running code. Although not serious, it should be remedied.
[WARNING] Couldn&apos;t destroy threadgroup org.apache.camel.maven.RunMojo$IsolatedThreadGroup[name=org.apache.camel.test.blueprint.Main,maxpri=10]
java.lang.IllegalThreadStateException
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;ThreadGroup&lt;/span&gt;.destroy(&lt;span class=&quot;code-object&quot;&gt;ThreadGroup&lt;/span&gt;.java:778)
	at org.apache.camel.maven.RunMojo.execute(RunMojo.java:505)
	at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:132)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:208)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
	at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:116)
	at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:80)
	at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build(SingleThreadedBuilder.java:51)
	at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:120)
	at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:355)
	at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:155)
	at org.apache.maven.cli.MavenCli.execute(MavenCli.java:584)
	at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:216)
	at org.apache.maven.cli.MavenCli.main(MavenCli.java:160)
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:483)
	at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:289)
	at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:229)
	at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:415)
	at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:356)
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 54.780 s
[INFO] Finished at: 2016-12-15T13:58:26+01:00
[INFO] Final Memory: 56M/814M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.camel:camel-maven-plugin:2.19.0-SNAPSHOT:run (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-cli) on project camel-example-transformer-blueprint: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;: MojoExecutionException: InvocationTargetException: Gave up waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; BlueprintContainer from bundle &lt;span class=&quot;code-quote&quot;&gt;&quot;MyBundle&quot;&lt;/span&gt; -&amp;gt; [Help 1]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="15752497" author="gzres" created="Thu, 15 Dec 2016 20:58:48 +0000"  >&lt;p&gt;See my comments in &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-10476&quot; title=&quot;configAdminFile not used to populate property placeholders in camel-test-blueprint when run via camel-maven-plugin&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-10476&quot;&gt;&lt;del&gt;CAMEL-10476&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I&apos;m guessing (I wasn&apos;t here when it was designed) that &lt;tt&gt;camel:run&lt;/tt&gt; &lt;b&gt;should&lt;/b&gt; work after &lt;tt&gt;mvn clean compile&lt;/tt&gt; - when you have nice &lt;tt&gt;target/classes&lt;/tt&gt; filled with compiled java sources and processed resources - just like it was (probably) designed.&lt;/p&gt;

&lt;p&gt;And it may work with spring or CDI, because they&apos;re quite independent on what&apos;s contained in MANIFEST.MF.&lt;/p&gt;

&lt;p&gt;Blueprint is different (OSGi is different - but it&apos;s another topic) because MANIFEST.MF is crucial - that&apos;s how felix-connect (formerly known as PojoSR) finds &lt;em&gt;bundles&lt;/em&gt; - a &lt;em&gt;bundle&lt;/em&gt; is just classpath element that contains MANIFEST.MF.&lt;/p&gt;

&lt;p&gt;In camel-archetype-blueprint we use:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;      &amp;lt;!-- to generate the MANIFEST.MF of the bundle --&amp;gt;
      &amp;lt;plugin&amp;gt;
        &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;
        &amp;lt;artifactId&amp;gt;maven-bundle-plugin&amp;lt;/artifactId&amp;gt;
        &amp;lt;version&amp;gt;3.2.0&amp;lt;/version&amp;gt;
        &amp;lt;extensions&amp;gt;false&amp;lt;/extensions&amp;gt;
        &amp;lt;executions&amp;gt;
          &amp;lt;execution&amp;gt;
            &amp;lt;id&amp;gt;bundle-manifest&amp;lt;/id&amp;gt;
            &amp;lt;phase&amp;gt;prepare-package&amp;lt;/phase&amp;gt;
            &amp;lt;goals&amp;gt;
              &amp;lt;goal&amp;gt;manifest&amp;lt;/goal&amp;gt;
            &amp;lt;/goals&amp;gt;
          &amp;lt;/execution&amp;gt;
        &amp;lt;/executions&amp;gt;
      &amp;lt;/plugin&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;to generate manifest in ... &lt;tt&gt;prepare-package&lt;/tt&gt; phase.&lt;/p&gt;

&lt;p&gt;So minimal command that succeeds is &lt;tt&gt;mvn clean prepare-package camel:run&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;There are two uses of &lt;tt&gt;CamelBlueprintHelper.createBundleContext()&lt;/tt&gt;:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;a JUnit @Test that extends &lt;tt&gt;org.apache.camel.test.blueprint.CamelBlueprintTestSupport&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;a &lt;tt&gt;mvn camel:run&lt;/tt&gt; invocation (&lt;tt&gt;org.apache.camel.maven.RunMojo&lt;/tt&gt;) configured with &lt;tt&gt;&amp;lt;useBlueprint&amp;gt;&lt;/tt&gt; (or when blueprint descriptor is autodetected)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;These two cases call &lt;tt&gt;CamelBlueprintHelper.createBundleContext()&lt;/tt&gt; with &lt;tt&gt;includeTestBundle&lt;/tt&gt; flag:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;org.apache.camel.test.blueprint.CamelBlueprintTestSupport#includeTestBundle()&lt;/tt&gt; by default (no Camel test overrides it) returns &lt;tt&gt;true&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;RunMojo&lt;/tt&gt; calls (blueprint case) &lt;tt&gt;org.apache.camel.test.blueprint.Main.main()&lt;/tt&gt; with some arguments - but no argument changes &lt;tt&gt;org.apache.camel.test.blueprint.Main#includeSelfAsBundle&lt;/tt&gt; field which is always &lt;tt&gt;false&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So for JUnit test we have &lt;tt&gt;includeTestBundle==true&lt;/tt&gt; which means Tinybundles will be used to pack our test classes and add it to mini-registry (felix-connect)&lt;br/&gt;
For &lt;tt&gt;camel:run&lt;/tt&gt; we have &lt;tt&gt;includeTestBundle==false&lt;/tt&gt; which means we have to find a &lt;em&gt;bundle&lt;/em&gt; with blueprint descriptor describing our context differently - &lt;tt&gt;mvn prepare-package&lt;/tt&gt; is enough.&lt;/p&gt;

&lt;p&gt;There are of course quirks - if you do &lt;tt&gt;mvn clean package&lt;/tt&gt; and then &lt;tt&gt;mvn test&lt;/tt&gt; (without &lt;tt&gt;clean&lt;/tt&gt;) we may end up with &lt;b&gt;two&lt;/b&gt; &lt;em&gt;bundles&lt;/em&gt; having the same blueprint descriptor. That&apos;s another (more annoying actually) incarnation of &lt;tt&gt;mvn clean compile camel:run&lt;/tt&gt; problem where we have &lt;b&gt;no&lt;/b&gt; &lt;em&gt;bundles&lt;/em&gt; with blueprint descriptors.&lt;/p&gt;

&lt;p&gt;My view is - current state is ok, as unit tests (that&apos;s what camel-test-blueprint was for) run before packaging - we&apos;re testing &lt;b&gt;any&lt;/b&gt; blueprint descriptor - possibly one from &lt;tt&gt;src/main/resources&lt;/tt&gt; (main route) and maybe some mocks from &lt;tt&gt;src/test/resources&lt;/tt&gt;.&lt;br/&gt;
But with &lt;tt&gt;camel:run&lt;/tt&gt; we&apos;re actually running the main route/context of the artifact, so we need at least it&apos;s MANIFEST.MF.&lt;/p&gt;

&lt;p&gt;What do you think?&lt;/p&gt;</comment>
                            <comment id="15753759" author="aurelien.pupier" created="Fri, 16 Dec 2016 08:01:06 +0000"  >&lt;p&gt;1) this is a regression, so whatever was the issue, this can&apos;t be ok anyway (but if there are workarounds they are welcome)&lt;br/&gt;
2) I tried to simplify here, but I reproduce the issue even when calling &quot;clean package org.apache.camel:camel-maven-plugin:run&quot; which is what we were already doing by default&lt;br/&gt;
3) this is another issue that should be addressed that a prepare-package need to be called before the camel:run (but with less priority)&lt;br/&gt;
4) seems that you spotted other issues with combination of mvn clean package and mvn clean --&amp;gt; should be addressed also but it also a far lower priority&lt;/p&gt;</comment>
                            <comment id="15753788" author="davsclaus" created="Fri, 16 Dec 2016 08:15:30 +0000"  >&lt;p&gt;Ah yeah they changed how the project is built for 2.18 onwards due the older 2.x maven-bundle-plugin was not supporting Java 8. And to upgrade to maven-bundle-plugin 3.x several things changed how it does that, including how that manifest stuff is generated etc. We could maybe tie camel:run to prepare-package phase or something so its run prior or something.&lt;/p&gt;</comment>
                            <comment id="15753868" author="davsclaus" created="Fri, 16 Dec 2016 08:58:15 +0000"  >&lt;p&gt;Okay got it working if I change the phase to prepare-package, but then it runs the unit tests first&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;* @execute phase=&lt;span class=&quot;code-quote&quot;&gt;&quot;prepare-&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt;&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="15753870" author="gzres" created="Fri, 16 Dec 2016 08:59:03 +0000"  >&lt;p&gt;I&apos;ll check how maven-bundle-plugin affected the build.&lt;br/&gt;
+1 to camel:run (at least in useBlueprint=true) tied to prepare-package (just like maven-bundle-plugin:manifest goal)&lt;/p&gt;</comment>
                            <comment id="15753872" author="gzres" created="Fri, 16 Dec 2016 09:00:25 +0000"  >&lt;blockquote&gt;&lt;p&gt;but then it runs the unit tests first&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;IMO that&apos;s good and as-designed. camel:run may be used any time - with or without tests. so ordinary &lt;tt&gt;-DskipTests&lt;/tt&gt; could be used.&lt;/p&gt;</comment>
                            <comment id="15753875" author="davsclaus" created="Fri, 16 Dec 2016 09:01:05 +0000"  >&lt;p&gt;The unit tests can be skipped with&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mvn camel:run -Dmaven.test.skip=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which is something tooling etc can control, but I would like to see if we can do this by default in mvn camel:run&lt;/p&gt;</comment>
                            <comment id="15753876" author="gzres" created="Fri, 16 Dec 2016 09:01:21 +0000"  >&lt;p&gt;I&apos;m checking now what&apos;s the reason of:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[INFO] Starting Camel ...
[ERROR] *************************************
[ERROR] Error occurred while running main from: org.apache.camel.test.blueprint.Main
[ERROR] 
java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
	at java.lang.reflect.Method.invoke(Method.java:498)
	at org.apache.camel.maven.RunMojo$1.run(RunMojo.java:472)
	at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.NoClassDefFoundError: org/osgi/framework/InvalidSyntaxException
	at org.apache.camel.test.blueprint.Main.createBundleContext(Main.java:151)
	at org.apache.camel.test.blueprint.Main.createBundleContext(Main.java:147)
	at org.apache.camel.test.blueprint.Main.doStart(Main.java:107)
	at org.apache.camel.support.ServiceSupport.start(ServiceSupport.java:61)
	at org.apache.camel.main.MainSupport.run(MainSupport.java:138)
	at org.apache.camel.main.MainSupport.run(MainSupport.java:390)
	at org.apache.camel.test.blueprint.Main.main(Main.java:82)
	... 6 more
Caused by: java.lang.ClassNotFoundException: org.osgi.framework.InvalidSyntaxException
	at java.net.URLClassLoader.findClass(URLClassLoader.java:381)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:424)
	at java.lang.ClassLoader.loadClass(ClassLoader.java:357)
	... 13 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;when doing (yesterday it worked) &lt;tt&gt;mvn clean compile camel:run&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15753911" author="davsclaus" created="Fri, 16 Dec 2016 09:21:43 +0000"  >&lt;p&gt;Thanks for the diving into this. &lt;/p&gt;

&lt;p&gt;I have pushed fixes to master and 2.18.x branches.&lt;/p&gt;</comment>
                            <comment id="15753976" author="aurelien.pupier" created="Fri, 16 Dec 2016 09:55:22 +0000"  >&lt;p&gt;I don&apos;t understand why changing the phase tie for camel:run is fixing the issue as when calling &quot;clean package org.apache.camel:camel-maven-plugin:run&quot; I reproduce the issue.&lt;/p&gt;

&lt;p&gt;Seems a good thing to fix it anyway. It is fixing the point &quot;4) seems that you spotted other issues with combination of mvn clean package and mvn clean --&amp;gt; should be addressed also but it also a far lower priority&quot; that I mentioned before.&lt;/p&gt;

&lt;p&gt;Unfortunately, I don&apos;t understand why it is fixing the initial issue.&lt;/p&gt;</comment>
                            <comment id="15754093" author="aurelien.pupier" created="Fri, 16 Dec 2016 10:50:06 +0000"  >&lt;p&gt;I confirm that the initial issue is still present. I tried with the 2.18.2-SNAPSHOT which contains Claus&apos; commit.&lt;/p&gt;</comment>
                            <comment id="15754212" author="davsclaus" created="Fri, 16 Dec 2016 11:45:03 +0000"  >&lt;p&gt;2.18.2-SNAPSHOT works for me&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;davsclaus:/Users/davsclaus/Documents/workspace/blue/$ mvn camel:run -Dmaven.test.skip=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
[INFO] Scanning &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building A Camel Blueprint Route 1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] &amp;gt;&amp;gt;&amp;gt; camel-maven-plugin:2.18.2-SNAPSHOT:run (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-cli) &amp;gt; prepare-&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; @ blue &amp;gt;&amp;gt;&amp;gt;
[INFO]
[INFO] --- maven-resources-plugin:3.0.1:resources (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-resources) @ blue ---
[INFO] Using &lt;span class=&quot;code-quote&quot;&gt;&apos;UTF-8&apos;&lt;/span&gt; encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO]
[INFO] --- maven-compiler-plugin:3.5.1:compile (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-compile) @ blue ---
[INFO] Nothing to compile - all classes are up to date
[INFO]
[INFO] --- maven-resources-plugin:3.0.1:testResources (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-testResources) @ blue ---
[INFO] Not copying test resources
[INFO]
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-testCompile) @ blue ---
[INFO] Not compiling test sources
[INFO]
[INFO] --- maven-surefire-plugin:2.12.4:test (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-test) @ blue ---
[INFO] Tests are skipped.
[INFO]
[INFO] --- maven-bundle-plugin:3.2.0:manifest (bundle-manifest) @ blue ---
[INFO]
[INFO] &amp;lt;&amp;lt;&amp;lt; camel-maven-plugin:2.18.2-SNAPSHOT:run (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-cli) &amp;lt; prepare-&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; @ blue &amp;lt;&amp;lt;&amp;lt;
[INFO]
[INFO] --- camel-maven-plugin:2.18.2-SNAPSHOT:run (&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;-cli) @ blue ---
[INFO] camel-blueprint detected on classpath
[INFO] OSGi Blueprint XML files detected in directory /Users/davsclaus/Documents/workspace/blue/src/main/resources/OSGI-INF/blueprint
[INFO] Using org.apache.camel.test.blueprint.Main to initiate a CamelContext
[INFO] Starting Camel ...
Dec 16, 2016 12:44:33 PM org.ops4j.pax.swissbox.tinybundles.core.metadata.RawBuilder run
INFO: Copy thread finished.
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator starting
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator started
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator starting
[mel.test.blueprint.Main.main()] Activator                      INFO  Camel activator started
[         Blueprint Extender: 1] BlueprintContainerImpl         INFO  Bundle com.foo.blue/1.0.0.SNAPSHOT is waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; namespace handlers [http:&lt;span class=&quot;code-comment&quot;&gt;//aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0, http://camel.apache.org/schema/blueprint]
&lt;/span&gt;[         Blueprint Extender: 3] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is starting
[         Blueprint Extender: 3] ManagedManagementStrategy      INFO  JMX is enabled
[         Blueprint Extender: 3] DefaultRuntimeEndpointRegistry INFO  &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; endpoint registry is in extended mode gathering usage statistics of all incoming and outgoing endpoints (cache limit: 1000)
[         Blueprint Extender: 3] BlueprintCamelContext          INFO  StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http:&lt;span class=&quot;code-comment&quot;&gt;//camel.apache.org/stream-caching.html
&lt;/span&gt;[         Blueprint Extender: 3] BlueprintCamelContext          INFO  Route: timerToLog started and consuming from: timer:&lt;span class=&quot;code-comment&quot;&gt;//foo?period=5000
&lt;/span&gt;[         Blueprint Extender: 3] BlueprintCamelContext          INFO  Total 1 routes, of which 1 are started.
[         Blueprint Extender: 3] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) started in 0.450 seconds
[ntext) thread #0 - timer:&lt;span class=&quot;code-comment&quot;&gt;//foo] timerToLog                     INFO  The message contains Hi from Camel at 2016-12-16 12:44:37
&lt;/span&gt;^C[                      &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;-1] MainSupport$HangupInterceptor  INFO  Received hang up - stopping the main instance.
davsclaus:/Users/davsclaus/Documents/workspace/blue/$
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15754235" author="aurelien.pupier" created="Fri, 16 Dec 2016 11:55:30 +0000"  >&lt;p&gt;failing for me skipping test or not&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;C:\Users\Aurelien Pupier\test&amp;gt;mvn camel:run -Dmaven.test.skip=true
[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building A Camel Blueprint Route 1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] &amp;gt;&amp;gt;&amp;gt; camel-maven-plugin:2.18.2-SNAPSHOT:run (default-cli) &amp;gt; prepare-package @ test &amp;gt;&amp;gt;&amp;gt;
[INFO]
[INFO] --- maven-resources-plugin:3.0.1:resources (default-resources) @ test ---
[INFO] Using &apos;UTF-8&apos; encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO]
[INFO] --- maven-compiler-plugin:3.5.1:compile (default-compile) @ test ---
[INFO] Nothing to compile - all classes are up to date
[INFO]
[INFO] --- maven-resources-plugin:3.0.1:testResources (default-testResources) @ test ---
[INFO] Not copying test resources
[INFO]
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (default-testCompile) @ test ---
[INFO] Not compiling test sources
[INFO]
[INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ test ---
[INFO] Tests are skipped.
[INFO]
[INFO] --- maven-bundle-plugin:3.2.0:manifest (bundle-manifest) @ test ---
[INFO]
[INFO] &amp;lt;&amp;lt;&amp;lt; camel-maven-plugin:2.18.2-SNAPSHOT:run (default-cli) &amp;lt; prepare-package @ test &amp;lt;&amp;lt;&amp;lt;
[INFO]
[INFO] --- camel-maven-plugin:2.18.2-SNAPSHOT:run (default-cli) @ test ---
[INFO] camel-blueprint detected on classpath
[INFO] OSGi Blueprint XML files detected in directory C:\Users\Aurelien Pupier\test\src\main\resources\OSGI-INF\blueprint
[INFO] Using org.apache.camel.test.blueprint.Main to initiate a CamelContext
[INFO] Starting Camel ...
SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
Dec 16, 2016 12:54:19 PM org.ops4j.pax.swissbox.tinybundles.core.metadata.RawBuilder run
INFO: Copy thread finished.
                                                                                                                                                                                                                                                                                                                                                                                                                                       [ERROR] *************************************
[ERROR] Error occurred while running main from: org.apache.camel.test.blueprint.Main
[ERROR]
java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:497)
        at org.apache.camel.maven.RunMojo$1.run(RunMojo.java:479)
        at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.RuntimeException: Gave up waiting for BlueprintContainer from bundle &quot;MyBundle&quot;
        at org.apache.camel.test.blueprint.CamelBlueprintHelper.waitForBlueprintContainer(CamelBlueprintHelper.java:363)
        at org.apache.camel.test.blueprint.Main.doStart(Main.java:111)
        at org.apache.camel.support.ServiceSupport.start(ServiceSupport.java:61)
        at org.apache.camel.main.MainSupport.run(MainSupport.java:138)
        at org.apache.camel.main.MainSupport.run(MainSupport.java:390)
        at org.apache.camel.test.blueprint.Main.main(Main.java:82)
        ... 6 more
[ERROR] *************************************
[WARNING] thread Thread[ForkJoinPool.commonPool-worker-1,5,org.apache.camel.test.blueprint.Main] was interrupted but is still alive after waiting at least 15000msecs
[WARNING] thread Thread[ForkJoinPool.commonPool-worker-1,5,org.apache.camel.test.blueprint.Main] will linger despite being asked to die via interruption
[WARNING] thread Thread[ForkJoinPool.commonPool-worker-2,5,org.apache.camel.test.blueprint.Main] will linger despite being asked to die via interruption
[WARNING] thread Thread[ForkJoinPool.commonPool-worker-3,5,org.apache.camel.test.blueprint.Main] will linger despite being asked to die via interruption
[WARNING] NOTE: 3 thread(s) did not finish despite being asked to  via interruption. This is not a problem with exec:java, it is a problem with the running code. Although not serious, it should be remedied.
[WARNING] Couldn&apos;t destroy threadgroup org.apache.camel.maven.RunMojo$IsolatedThreadGroup[name=org.apache.camel.test.blueprint.Main,maxpri=10]
java.lang.IllegalThreadStateException
        at java.lang.ThreadGroup.destroy(ThreadGroup.java:778)
        at org.apache.camel.maven.RunMojo.execute(RunMojo.java:512)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:134)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:207)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:116)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:80)
        at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build(SingleThreadedBuilder.java:51)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:128)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:307)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:193)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:106)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:863)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:288)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:199)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:497)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:289)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:229)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:415)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:356)
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 48.642 s
[INFO] Finished at: 2016-12-16T12:55:04+01:00
[INFO] Final Memory: 37M/516M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.camel:camel-maven-plugin:2.18.2-SNAPSHOT:run (default-cli) on project test: null: MojoExecutionException: InvocationTargetException: Gave up waiting for BlueprintContainer from bundle &quot;MyBundle&quot; -&amp;gt; [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;C:\Users\Aurelien Pupier\test&amp;gt;mvn camel:run
[INFO] Scanning for projects...
[INFO]
[INFO] ------------------------------------------------------------------------
[INFO] Building A Camel Blueprint Route 1.0-SNAPSHOT
[INFO] ------------------------------------------------------------------------
[INFO]
[INFO] &amp;gt;&amp;gt;&amp;gt; camel-maven-plugin:2.18.2-SNAPSHOT:run (default-cli) &amp;gt; prepare-package @ test &amp;gt;&amp;gt;&amp;gt;
[INFO]
[INFO] --- maven-resources-plugin:3.0.1:resources (default-resources) @ test ---
[INFO] Using &apos;UTF-8&apos; encoding to copy filtered resources.
[INFO] Copying 2 resources
[INFO]
[INFO] --- maven-compiler-plugin:3.5.1:compile (default-compile) @ test ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 2 source files to C:\Users\Aurelien Pupier\test\target\classes
[INFO]
[INFO] --- maven-resources-plugin:3.0.1:testResources (default-testResources) @ test ---
[INFO] Using &apos;UTF-8&apos; encoding to copy filtered resources.
[INFO] Copying 1 resource
[INFO]
[INFO] --- maven-compiler-plugin:3.5.1:testCompile (default-testCompile) @ test ---
[INFO] Changes detected - recompiling the module!
[INFO] Compiling 3 source files to C:\Users\Aurelien Pupier\test\target\test-classes
[INFO] /C:/Users/Aurelien Pupier/test/src/test/java/test/BlueprintBeanPropertiesOverrideFromTestRouteTest.java: C:\Users\Aurelien Pupier\test\src\test\java\test\BlueprintBeanPropertiesOverrideFromTestRouteTest.java uses unchecked or unsafe operations.
[INFO] /C:/Users/Aurelien Pupier/test/src/test/java/test/BlueprintBeanPropertiesOverrideFromTestRouteTest.java: Recompile with -Xlint:unchecked for details.
[INFO]
[INFO] --- maven-surefire-plugin:2.12.4:test (default-test) @ test ---
[INFO] Surefire report directory: C:\Users\Aurelien Pupier\test\target\surefire-reports

-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running test.BlueprintBeanPropertiesOverrideFromFileRouteTest
[                          main] CamelBlueprintHelper           INFO  Using Blueprint XML file: /C:/Users/Aurelien%20Pupier/test/target/classes/OSGI-INF/blueprint/blueprint-bean.xml
Dec 16, 2016 12:52:02 PM org.ops4j.pax.swissbox.tinybundles.core.metadata.RawBuilder run
INFO: Copy thread finished.
Dec 16, 2016 12:52:02 PM org.ops4j.pax.swissbox.tinybundles.core.metadata.RawBuilder run
INFO: Copy thread finished.
[                          main] Activator                      INFO  Camel activator starting
[                          main] Activator                      INFO  Camel activator started
[                          main] Activator                      INFO  Camel activator starting
[                          main] Activator                      INFO  Camel activator started
[                          main] CamelBlueprintHelper           INFO  Updating ConfigAdmin Configuration PID=HelloBean, factoryPID=null, bundleLocation=null by overriding properties {greeting=Hello from file}
[         Blueprint Extender: 1] BlueprintContainerImpl         INFO  Bundle BlueprintBeanPropertiesOverrideFromFileRouteTest/1.0.0 is waiting for namespace handlers [http://aries.apache.org/blueprint/xmlns/blueprint-cm/v1.1.0, http://camel.apache.org/schema/blueprint]
[                          main] rtiesOverrideFromFileRouteTest INFO  ********************************************************************************
[                          main] rtiesOverrideFromFileRouteTest INFO  Testing: testRoute(test.BlueprintBeanPropertiesOverrideFromFileRouteTest)
[                          main] rtiesOverrideFromFileRouteTest INFO  ********************************************************************************
[                          main] rtiesOverrideFromFileRouteTest INFO  Skipping starting CamelContext as system property skipStartingCamelContext is set to be true.
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is starting
[                          main] ManagedManagementStrategy      INFO  JMX is enabled
[                          main] DefaultRuntimeEndpointRegistry INFO  Runtime endpoint registry is in extended mode gathering usage statistics of all incoming and outgoing endpoints (cache limit: 1000)
[                          main] BlueprintCamelContext          INFO  StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
[                          main] BlueprintCamelContext          INFO  Route: timerToLog started and consuming from: timer://foo?period=5000
[                          main] BlueprintCamelContext          INFO  Total 1 routes, of which 1 are started.
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) started in 0.239 seconds
[                          main] MockEndpoint                   INFO  Asserting: mock://result is satisfied
[ntext) thread #0 - timer://foo] timerToLog                     INFO  The message contains Hello from file at 2016-12-16 12:52:05
[                          main] rtiesOverrideFromFileRouteTest INFO  ********************************************************************************
[                          main] rtiesOverrideFromFileRouteTest INFO  Testing done: testRoute(test.BlueprintBeanPropertiesOverrideFromFileRouteTest)
[                          main] rtiesOverrideFromFileRouteTest INFO  Took: 1.252 seconds (1252 millis)
[                          main] rtiesOverrideFromFileRouteTest INFO  ********************************************************************************
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is shutting down
[                          main] DefaultShutdownStrategy        INFO  Starting to graceful shutdown 1 routes (timeout 10 seconds)
[text) thread #1 - ShutdownTask] DefaultShutdownStrategy        INFO  Route: timerToLog shutdown complete, was consuming from: timer://foo?period=5000
[                          main] DefaultShutdownStrategy        INFO  Graceful shutdown of 1 routes completed in 0 seconds
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) uptime 1.272 seconds
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is shutdown in 0.017 seconds
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 3.309 sec
Running test.BlueprintBeanPropertiesOverrideFromTestRouteTest
Dec 16, 2016 12:52:05 PM org.ops4j.pax.swissbox.tinybundles.core.metadata.RawBuilder run
INFO: Copy thread finished.
Dec 16, 2016 12:52:05 PM org.ops4j.pax.swissbox.tinybundles.core.metadata.RawBuilder run
INFO: Copy thread finished.
[                          main] rtiesOverrideFromTestRouteTest INFO  Updating ConfigAdmin Configuration PID=HelloBean, factoryPID=null, bundleLocation=null by overriding properties {greeting=Hello from test}
[                     Thread-10] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is shutting down
[                     Thread-10] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) uptime
[                     Thread-10] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is shutdown in 0.001 seconds
[                          main] rtiesOverrideFromTestRouteTest INFO  ********************************************************************************
[                          main] rtiesOverrideFromTestRouteTest INFO  Testing: testRoute(test.BlueprintBeanPropertiesOverrideFromTestRouteTest)
[                          main] rtiesOverrideFromTestRouteTest INFO  ********************************************************************************
[                          main] rtiesOverrideFromTestRouteTest INFO  Skipping starting CamelContext as system property skipStartingCamelContext is set to be true.
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is starting
[                          main] BlueprintCamelContext          INFO  StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
[                          main] BlueprintCamelContext          INFO  Route: timerToLog started and consuming from: timer://foo?period=5000
[                          main] BlueprintCamelContext          INFO  Total 1 routes, of which 1 are started.
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) started in 0.021 seconds
[ntext) thread #2 - timer://foo] timerToLog                     INFO  The message contains Hello from test at 2016-12-16 12:52:06
[                          main] rtiesOverrideFromTestRouteTest INFO  ********************************************************************************
[                          main] rtiesOverrideFromTestRouteTest INFO  Testing done: testRoute(test.BlueprintBeanPropertiesOverrideFromTestRouteTest)
[                          main] rtiesOverrideFromTestRouteTest INFO  Took: 1.022 seconds (1022 millis)
[                          main] rtiesOverrideFromTestRouteTest INFO  ********************************************************************************
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is shutting down
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) uptime 1.024 seconds
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is shutdown in 0.002 seconds
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.189 sec
Running test.BlueprintBeanRouteTest
Dec 16, 2016 12:52:07 PM org.ops4j.pax.swissbox.tinybundles.core.metadata.RawBuilder run
INFO: Copy thread finished.
Dec 16, 2016 12:52:07 PM org.ops4j.pax.swissbox.tinybundles.core.metadata.RawBuilder run
INFO: Copy thread finished.
[                          main] BlueprintBeanRouteTest         INFO  ********************************************************************************
[                          main] BlueprintBeanRouteTest         INFO  Testing: testRoute(test.BlueprintBeanRouteTest)
[                          main] BlueprintBeanRouteTest         INFO  ********************************************************************************
[                          main] BlueprintBeanRouteTest         INFO  Skipping starting CamelContext as system property skipStartingCamelContext is set to be true.
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is starting
[                          main] BlueprintCamelContext          INFO  StreamCaching is not in use. If using streams then its recommended to enable stream caching. See more details at http://camel.apache.org/stream-caching.html
[                          main] BlueprintCamelContext          INFO  Route: timerToLog started and consuming from: timer://foo?period=5000
[                          main] BlueprintCamelContext          INFO  Total 1 routes, of which 1 are started.
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) started in 0.032 seconds
[ntext) thread #4 - timer://foo] timerToLog                     INFO  The message contains Hi from Camel at 2016-12-16 12:52:08
[                          main] BlueprintBeanRouteTest         INFO  ********************************************************************************
[                          main] BlueprintBeanRouteTest         INFO  Testing done: testRoute(test.BlueprintBeanRouteTest)
[                          main] BlueprintBeanRouteTest         INFO  Took: 1.033 seconds (1033 millis)
[                          main] BlueprintBeanRouteTest         INFO  ********************************************************************************
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is shutting down
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) uptime 1.036 seconds
[                          main] BlueprintCamelContext          INFO  Apache Camel 2.18.2-SNAPSHOT (CamelContext: blueprint-bean-context) is shutdown in 0.003 seconds
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 2.165 sec

Results :

Tests run: 3, Failures: 0, Errors: 0, Skipped: 0

[INFO]
[INFO] --- maven-bundle-plugin:3.2.0:manifest (bundle-manifest) @ test ---
[INFO]
[INFO] &amp;lt;&amp;lt;&amp;lt; camel-maven-plugin:2.18.2-SNAPSHOT:run (default-cli) &amp;lt; prepare-package @ test &amp;lt;&amp;lt;&amp;lt;
[INFO]
[INFO] --- camel-maven-plugin:2.18.2-SNAPSHOT:run (default-cli) @ test ---
[INFO] You can skip tests from the command line using: mvn camel:run -Dmaven.test.skip=true
[INFO] camel-blueprint detected on classpath
[INFO] OSGi Blueprint XML files detected in directory C:\Users\Aurelien Pupier\test\src\main\resources\OSGI-INF\blueprint
[INFO] Using org.apache.camel.test.blueprint.Main to initiate a CamelContext
[INFO] Starting Camel ...
SLF4J: Failed to load class &quot;org.slf4j.impl.StaticLoggerBinder&quot;.
SLF4J: Defaulting to no-operation (NOP) logger implementation
SLF4J: See http://www.slf4j.org/codes.html#StaticLoggerBinder for further details.
Dec 16, 2016 12:52:11 PM org.ops4j.pax.swissbox.tinybundles.core.metadata.RawBuilder run
INFO: Copy thread finished.
[ERROR] *************************************
[ERROR] Error occurred while running main from: org.apache.camel.test.blueprint.Main
[ERROR]
java.lang.reflect.InvocationTargetException
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:497)
        at org.apache.camel.maven.RunMojo$1.run(RunMojo.java:479)
        at java.lang.Thread.run(Thread.java:745)
Caused by: java.lang.RuntimeException: Gave up waiting for BlueprintContainer from bundle &quot;MyBundle&quot;
        at org.apache.camel.test.blueprint.CamelBlueprintHelper.waitForBlueprintContainer(CamelBlueprintHelper.java:363)
        at org.apache.camel.test.blueprint.Main.doStart(Main.java:111)
        at org.apache.camel.support.ServiceSupport.start(ServiceSupport.java:61)
        at org.apache.camel.main.MainSupport.run(MainSupport.java:138)
        at org.apache.camel.main.MainSupport.run(MainSupport.java:390)
        at org.apache.camel.test.blueprint.Main.main(Main.java:82)
        ... 6 more
[ERROR] *************************************
                                                                           [WARNING] thread Thread[ForkJoinPool.commonPool-worker-1,5,org.apache.camel.test.blueprint.Main] was interrupted but is still alive after waiting at least 15000msecs
[WARNING] thread Thread[ForkJoinPool.commonPool-worker-1,5,org.apache.camel.test.blueprint.Main] will linger despite being asked to die via interruption
[WARNING] thread Thread[ForkJoinPool.commonPool-worker-2,5,org.apache.camel.test.blueprint.Main] will linger despite being asked to die via interruption
[WARNING] thread Thread[ForkJoinPool.commonPool-worker-4,5,org.apache.camel.test.blueprint.Main] will linger despite being asked to die via interruption
[WARNING] NOTE: 3 thread(s) did not finish despite being asked to  via interruption. This is not a problem with exec:java, it is a problem with the running code. Although not serious, it should be remedied.
[WARNING] Couldn&apos;t destroy threadgroup org.apache.camel.maven.RunMojo$IsolatedThreadGroup[name=org.apache.camel.test.blueprint.Main,maxpri=10]
java.lang.IllegalThreadStateException
        at java.lang.ThreadGroup.destroy(ThreadGroup.java:778)
        at org.apache.camel.maven.RunMojo.execute(RunMojo.java:512)
        at org.apache.maven.plugin.DefaultBuildPluginManager.executeMojo(DefaultBuildPluginManager.java:134)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:207)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:153)
        at org.apache.maven.lifecycle.internal.MojoExecutor.execute(MojoExecutor.java:145)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:116)
        at org.apache.maven.lifecycle.internal.LifecycleModuleBuilder.buildProject(LifecycleModuleBuilder.java:80)
        at org.apache.maven.lifecycle.internal.builder.singlethreaded.SingleThreadedBuilder.build(SingleThreadedBuilder.java:51)
        at org.apache.maven.lifecycle.internal.LifecycleStarter.execute(LifecycleStarter.java:128)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:307)
        at org.apache.maven.DefaultMaven.doExecute(DefaultMaven.java:193)
        at org.apache.maven.DefaultMaven.execute(DefaultMaven.java:106)
        at org.apache.maven.cli.MavenCli.execute(MavenCli.java:863)
        at org.apache.maven.cli.MavenCli.doMain(MavenCli.java:288)
        at org.apache.maven.cli.MavenCli.main(MavenCli.java:199)
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
        at java.lang.reflect.Method.invoke(Method.java:497)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launchEnhanced(Launcher.java:289)
        at org.codehaus.plexus.classworlds.launcher.Launcher.launch(Launcher.java:229)
        at org.codehaus.plexus.classworlds.launcher.Launcher.mainWithExitCode(Launcher.java:415)
        at org.codehaus.plexus.classworlds.launcher.Launcher.main(Launcher.java:356)
[INFO] ------------------------------------------------------------------------
[INFO] BUILD FAILURE
[INFO] ------------------------------------------------------------------------
[INFO] Total time: 58.326 s
[INFO] Finished at: 2016-12-16T12:52:57+01:00
[INFO] Final Memory: 51M/549M
[INFO] ------------------------------------------------------------------------
[ERROR] Failed to execute goal org.apache.camel:camel-maven-plugin:2.18.2-SNAPSHOT:run (default-cli) on project test: null: MojoExecutionException: InvocationTargetException: Gave up waiting for BlueprintContainer from bundle &quot;MyBundle&quot; -&amp;gt; [Help 1]
[ERROR]
[ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[ERROR] Re-run Maven using the -X switch to enable full debug logging.
[ERROR]
[ERROR] For more information about the errors and possible solutions, please read the following articles:
[ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15754355" author="gzres" created="Fri, 16 Dec 2016 13:00:06 +0000"  >&lt;p&gt;One more fix:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;master: &lt;a href=&quot;https://github.com/apache/camel/commit/ddcbd0f948d0f4b8c2a4a5b99f78f2880c4d21de&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/commit/ddcbd0f948d0f4b8c2a4a5b99f78f2880c4d21de&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;camel-2.18.x: &lt;a href=&quot;https://github.com/apache/camel/commit/74fd151016b0cc64e6eddd098bf355fc35743ce0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/commit/74fd151016b0cc64e6eddd098bf355fc35743ce0&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15754565" author="aurelien.pupier" created="Fri, 16 Dec 2016 14:33:14 +0000"  >&lt;p&gt;yeah it works, thank you!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13020538">CAMEL-10476</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13022622">CAMEL-10513</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 48 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i37mvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310080" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Regression</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10091"><![CDATA[Regression]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>