<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:46:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-4452] CXFConsumer may extract the request message as the response message and this can lead to problems</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-4452</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-4030&quot; title=&quot;Camel CxfConsumer should be able to populate the CxfResponse from camel exchange according to the exchange pattern&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-4030&quot;&gt;&lt;del&gt;CAMEL-4030&lt;/del&gt;&lt;/a&gt; with Revision 1129070 in trunk changed the way how the response message is retrieved from the exchange and this is causing some issue.&lt;/p&gt;

&lt;p&gt;In particular, the changed code may retrieve the request message as the response message when the call is oneway (when the condition camelExchange.getPattern().isOutCapable() is false).&lt;/p&gt;

&lt;p&gt;Subsequently, this is leading to an NPE when the output operation is used to extract the payload body from this request message because there is no output operations in the oneway case at:&lt;/p&gt;

&lt;p&gt;        for (MessagePartInfo partInfo : boi.getOutput().getMessageParts()) {&lt;/p&gt;

&lt;p&gt;and resulting in:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at org.apache.camel.component.cxf.DefaultCxfBinding.getResponsePayloadList(DefaultCxfBinding.java:394)&lt;br/&gt;
	at org.apache.camel.component.cxf.DefaultCxfBinding.populateCxfResponseFromExchange(DefaultCxfBinding.java:318)&lt;br/&gt;
	at org.apache.camel.component.cxf.CxfConsumer$1.setResponseBack(CxfConsumer.java:176)&lt;br/&gt;
	at org.apache.camel.component.cxf.CxfConsumer$1.syncInvoke(CxfConsumer.java:126)&lt;br/&gt;
	at org.apache.camel.component.cxf.CxfConsumer$1.invoke(CxfConsumer.java:71)&lt;br/&gt;
	at org.apache.cxf.interceptor.ServiceInvokerInterceptor$1.run(ServiceInvokerInterceptor.java:58)&lt;br/&gt;
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:441)&lt;br/&gt;
	at java.util.concurrent.FutureTask$Sync.innerRun(FutureTask.java:303)&lt;br/&gt;
	at java.util.concurrent.FutureTask.run(FutureTask.java:138)&lt;br/&gt;
	at org.apache.cxf.workqueue.SynchronousExecutor.execute(SynchronousExecutor.java:37)&lt;br/&gt;
	at org.apache.cxf.interceptor.ServiceInvokerInterceptor.handleMessage(ServiceInvokerInterceptor.java:106)&lt;br/&gt;
	at org.apache.cxf.phase.PhaseInterceptorChain.doIntercept(PhaseInterceptorChain.java:263)&lt;br/&gt;
	at org.apache.cxf.phase.PhaseInterceptorChain.resume(PhaseInterceptorChain.java:232)&lt;br/&gt;
	at org.apache.cxf.interceptor.OneWayProcessorInterceptor$1.run(OneWayProcessorInterceptor.java:130)&lt;br/&gt;
	at org.apache.cxf.workqueue.AutomaticWorkQueueImpl$2.run(AutomaticWorkQueueImpl.java:353)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:662)&lt;/p&gt;


&lt;p&gt;I see this change was introduced with &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-4030&quot; title=&quot;Camel CxfConsumer should be able to populate the CxfResponse from camel exchange according to the exchange pattern&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-4030&quot;&gt;&lt;del&gt;CAMEL-4030&lt;/del&gt;&lt;/a&gt; to support some sort of wire-tap short-cut:&lt;/p&gt;

&lt;p&gt;from(&quot;cxf:xxx&quot;).inonly(&quot;jms:xxx&quot;).to(&quot;xxx&quot;)&lt;/p&gt;

&lt;p&gt;I am not sure how this inbound/outbound switching operation relates to this use case.&lt;/p&gt;

&lt;p&gt;But in any case, this new behavior can lead to this problem and  I think the old behavior (skipping the response message part if there is no response) should be reinstated.&lt;/p&gt;

&lt;p&gt;I have a simple test case that can reproduce this problem, but the exception is thrown in an executor thread and only written to the log and the original test caller thread doesn&apos;t see the exception. So, it&apos;s not a useful automatic test case. Maybe, there is a way. Let me know, how you think.&lt;/p&gt;

&lt;p&gt;thanks.&lt;br/&gt;
regards, aki&lt;/p&gt;

</description>
                <environment></environment>
        <key id="12523162">CAMEL-4452</key>
            <summary>CXFConsumer may extract the request message as the response message and this can lead to problems</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="ay">Akitoshi Yoshida</reporter>
                        <labels>
                    </labels>
                <created>Thu, 15 Sep 2011 08:03:47 +0000</created>
                <updated>Fri, 16 Sep 2011 11:39:06 +0000</updated>
                            <resolved>Fri, 16 Sep 2011 06:31:39 +0000</resolved>
                                    <version>2.8.0</version>
                                    <fixVersion>2.8.2</fixVersion>
                    <fixVersion>2.9.0</fixVersion>
                                    <component>camel-cxf</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13105368" author="njiang" created="Thu, 15 Sep 2011 13:49:21 +0000"  >&lt;p&gt;Hi Aki,&lt;/p&gt;

&lt;p&gt;I checked the code of NPE, I don&apos;t think it relates to the change of &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-4030&quot; title=&quot;Camel CxfConsumer should be able to populate the CxfResponse from camel exchange according to the exchange pattern&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-4030&quot;&gt;&lt;del&gt;CAMEL-4030&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
The camelExchange is not same with the cxfExchange, I don&apos;t think the oneway invocation can cause the NPE that you mentioned.&lt;br/&gt;
I guess there are some thing wrong with the boi.getOutput() checking.&lt;/p&gt;

&lt;p&gt;Can  you submit the test case into this JIRA to let me have a look?&lt;/p&gt;

&lt;p&gt;Willem&lt;/p&gt;</comment>
                            <comment id="13105395" author="ay" created="Thu, 15 Sep 2011 14:46:37 +0000"  >&lt;p&gt;Hi Willem,&lt;br/&gt;
thanks for looking into this.&lt;/p&gt;

&lt;p&gt;Attached is a tar.gz file containing a test case (analogue to the other GreeterTest in camel-cxf) but using the wsdl and no service class.&lt;/p&gt;

&lt;p&gt;The logging for the camel cxf component needs to be activated to see the exception stack trace (org.apache.camel.component.cxf.level=INFO&lt;br/&gt;
). &lt;/p&gt;

&lt;p&gt;The exception comes from the greeter.greetMeOneWay when it tries to extract the response payload out of the request message.&lt;/p&gt;


&lt;p&gt;thanks.&lt;br/&gt;
regards, aki&lt;/p&gt;</comment>
                            <comment id="13105886" author="njiang" created="Fri, 16 Sep 2011 06:17:28 +0000"  >&lt;p&gt;I found the NPE are thrown from other GreeterPayLoad tests, it can be fix by adding an NP checking on the boi.getOutput incase of the boi is oneway operation.&lt;/p&gt;

&lt;p&gt;I will commit the fix shortly.&lt;/p&gt;</comment>
                            <comment id="13105899" author="njiang" created="Fri, 16 Sep 2011 06:31:39 +0000"  >&lt;p&gt;Applied the patch into trunk and 2.8.x branch.&lt;/p&gt;</comment>
                            <comment id="13106007" author="ay" created="Fri, 16 Sep 2011 11:39:06 +0000"  >&lt;p&gt;Hi Willem,&lt;br/&gt;
Checking boi.getOutput() != null, as you patched, will avoid the NPE for this oneway case. But I think this solution may lead to some unexpected result in those cases when the getOutput() isn&apos;t null but for some reason the response message is not available, no? &lt;/p&gt;

&lt;p&gt;I still find it strange to automatically take the request message for the response message.&lt;/p&gt;

&lt;p&gt;Or am I missing some point?&lt;/p&gt;

&lt;p&gt;regards, aki  &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12494627" name="test.tar.gz" size="1713" author="ay" created="Thu, 15 Sep 2011 14:46:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13766</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 10 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0210n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9766</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>