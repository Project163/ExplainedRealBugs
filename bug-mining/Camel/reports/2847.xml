<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:03:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-7673] subscribeTopicName leaks out as a property and used as a destination for mqtt producer, causes infinite delivery</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-7673</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;MQTT consumer sets its subscribeTopicName as a exchange property, and it will be used by MQTT producer as a destination if it exists in the route.&lt;/p&gt;

&lt;p&gt;If you have a following route:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;from(&lt;span class=&quot;code-quote&quot;&gt;&quot;mqtt:input?subscribeTopicName=topicIn&quot;&lt;/span&gt;)
        .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;mqtt:output?publishTopicName=topicOut&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;MQTT consumer put &quot;topicIn&quot; to &quot;MQTTTopicPropertyName&quot; exchange property, and MQTT producer uses this property to determine a destination topic to publish. Then MQTT producer ignores publishTopicName and send a message to &quot;topicIn&quot;, so MQTT consumer consumes the message again, eventually it causes infinite delivery. We need to stop this property to be used as a destination for producer.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12733021">CAMEL-7673</key>
            <summary>subscribeTopicName leaks out as a property and used as a destination for mqtt producer, causes infinite delivery</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="igarashitm">Tomohisa Igarashi</reporter>
                        <labels>
                    </labels>
                <created>Sat, 9 Aug 2014 07:35:34 +0000</created>
                <updated>Mon, 12 Jan 2015 09:06:47 +0000</updated>
                            <resolved>Wed, 27 Aug 2014 07:01:39 +0000</resolved>
                                    <version>2.12.2</version>
                    <version>2.14.0</version>
                                    <fixVersion>2.14.0</fixVersion>
                                    <component>camel-mqtt</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14092390" author="njiang" created="Mon, 11 Aug 2014 03:19:17 +0000"  >&lt;p&gt;You can workaround this issue by changing the route like this&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;from(&lt;span class=&quot;code-quote&quot;&gt;&quot;mqtt:input?subscribeTopicName=topicIn&quot;&lt;/span&gt;)
        .removeProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;MQTTTopicPropertyName&quot;&lt;/span&gt;)
        .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;mqtt:output?publishTopicName=topicOut&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I will add an option &quot;bridgeEndpoint&quot; to  the mqtt component to ignore the property header if the &quot;bridgeEndpoint&quot; option is true.&lt;/p&gt;</comment>
                            <comment id="14092483" author="davsclaus" created="Mon, 11 Aug 2014 06:02:54 +0000"  >&lt;p&gt;I think it should be similar as we do in camel-jms. &lt;/p&gt;

&lt;p&gt;The component should work out of the box as camel-jms would do, and only if you want to send a message to a special topic you need to use a special header - as done in camel-jms.&lt;/p&gt;

&lt;p&gt;We talked about this on the mailing list&lt;/p&gt;</comment>
                            <comment id="14092495" author="igarashitm" created="Mon, 11 Aug 2014 06:22:34 +0000"  >&lt;p&gt;I think the problem is that MQTT consumer and producer are using same property for different purpose, consumer set its susbcribeTopicName into the property so application can read it to know the topic name, and producer use the property for destination. I would prefer to use different property name for those since producer never sends back to the topic which is subscribed by consumer, otherwise it causes infinite delivery.&lt;/p&gt;</comment>
                            <comment id="14092498" author="igarashitm" created="Mon, 11 Aug 2014 06:31:33 +0000"  >&lt;p&gt;I would give +1 that the topic name property should be removed after it&apos;s used by producer as done in camel-jms producer btw.&lt;/p&gt;</comment>
                            <comment id="14096496" author="njiang" created="Thu, 14 Aug 2014 03:10:18 +0000"  >&lt;p&gt;I just take a look at the camel-jms component, it just put the destination into the message header with &quot;JMSDestination&quot; in the consumer and use &quot;CamelJMSDestination&quot; in the producer, so it doesn&apos;t hit the issue like of mqtt component.&lt;/p&gt;

&lt;p&gt;For the camel-rabbitmq, the consumer and producer use the same message header name of &quot;RabbitMQConstants.EXCHANGE_NAME&quot; and &quot;RabbitMQConstants.ROUTING_KEY&quot; so we use  &quot;bridgeEndpoint&quot; to avoid this kind of issue.&lt;/p&gt;

&lt;p&gt;As the mqtt consumer and producer treat the &quot;MQTTTopicPropertyName&quot; differently, I&apos;m +1 for  consumer and producer use different header name to store the topic,  and we need put that information into message header instead of exchange property.&lt;/p&gt;</comment>
                            <comment id="14111943" author="njiang" created="Wed, 27 Aug 2014 07:01:39 +0000"  >&lt;p&gt;Introduced CamelMQTTSubscribeTopic for MQTTConsumer and CamelMQTTPublishTopic MQTTProducer in camel master branch.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12766768">CAMEL-8228</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>411049</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 13 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ypvb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>411041</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>