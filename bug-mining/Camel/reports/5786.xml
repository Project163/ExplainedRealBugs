<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:48:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-16782] Getting FailedToCreateProducerException with reason java.util.ConcurrentModificationException randomly when using huge split</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-16782</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When splitting and then sending a huge list of strings(38 000) that create xml-documents for each line. Getting randomly this exception (so not for each line, about 5 times failed):&lt;/p&gt;

&lt;p&gt;org.apache.camel.FailedToCreateProducerException: Failed to create Producer for endpoint: sftp://serverHere?disconnect=true. Reason: java.util.ConcurrentModificationException&lt;br/&gt;
 at org.apache.camel.support.cache.DefaultProducerCache.acquireProducer(DefaultProducerCache.java:155) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.camel.support.cache.DefaultProducerCache.doInAsyncProducer(DefaultProducerCache.java:283) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.camel.processor.SendProcessor.process(SendProcessor.java:190) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.camel.processor.errorhandler.RedeliveryErrorHandler$SimpleTask.run(RedeliveryErrorHandler.java:463) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.camel.impl.engine.DefaultReactiveExecutor$Worker.schedule(DefaultReactiveExecutor.java:179) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.camel.impl.engine.DefaultReactiveExecutor.schedule(DefaultReactiveExecutor.java:59) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.camel.processor.MulticastProcessor.lambda$schedule$1(MulticastProcessor.java:348) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:515) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at java.util.concurrent.FutureTask.run(FutureTask.java:264) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at java.lang.Thread.run(Thread.java:829) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
Caused by: java.util.ConcurrentModificationException&lt;br/&gt;
 at java.util.ArrayList$Itr.checkForComodification(ArrayList.java:1043) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at java.util.ArrayList$Itr.next(ArrayList.java:997) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.camel.support.cache.ServicePool$MultiplePool.cleanupEvicts(ServicePool.java:318) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.camel.support.cache.ServicePool$MultiplePool.acquire(ServicePool.java:333) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.camel.support.cache.ServicePool$MultiplePool.acquire(ServicePool.java:296) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.camel.support.cache.ServicePool.acquire(ServicePool.java:109) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 at org.apache.camel.support.cache.DefaultProducerCache.acquireProducer(DefaultProducerCache.java:126) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 ... 11 more&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;two routes:&lt;/p&gt;

&lt;p&gt;&amp;lt;from uri=&quot;sftp: ...&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;split parallelProcessing=&quot;true&quot;&amp;gt;&lt;br/&gt;
&#160;&amp;lt;tokenize token=&quot;\r\n|\n&quot; xml=&quot;false&quot; trim=&quot;true&quot;/&amp;gt;&lt;br/&gt;
&#160;&amp;lt;convertBodyTo type=&quot;java.lang.String&quot; charset=&quot;UTF-8&quot;/&amp;gt;&lt;br/&gt;
&#160;&amp;lt;to uri=&quot;bean:createXML?method=collect&quot;/&amp;gt;&lt;br/&gt;
&#160;&amp;lt;to uri=&quot;direct:sendToSftpRoute&quot;/&amp;gt;&lt;br/&gt;
&amp;lt;/split&amp;gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&amp;lt;from uri=&quot;direct:sendToSftpRoute&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;to uri=&quot;sftp: ...?disconnect=true&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This issue came after upgrading from 3.4.2 -&amp;gt; 3.11.0&lt;/p&gt;</description>
                <environment></environment>
        <key id="13387199">CAMEL-16782</key>
            <summary>Getting FailedToCreateProducerException with reason java.util.ConcurrentModificationException randomly when using huge split</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="tapiiron">Tapio Piironen</reporter>
                        <labels>
                    </labels>
                <created>Fri, 2 Jul 2021 05:45:43 +0000</created>
                <updated>Mon, 5 Jul 2021 07:22:32 +0000</updated>
                            <resolved>Fri, 2 Jul 2021 15:08:50 +0000</resolved>
                                    <version>3.11.0</version>
                                    <fixVersion>3.11.1</fixVersion>
                    <fixVersion>3.12.0</fixVersion>
                                    <component>camel-core</component>
                    <component>camel-ftp</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17373577" author="davsclaus" created="Fri, 2 Jul 2021 14:58:57 +0000"  >&lt;p&gt;This is with camel-ftp that uses the multi service pool, 99% of the other components will use the singleton pool&lt;/p&gt;</comment>
                            <comment id="17373584" author="davsclaus" created="Fri, 2 Jul 2021 15:08:15 +0000"  >&lt;p&gt;Thanks for reporting. I have pushed a fix on the 3.11.x branch and also main.&lt;br/&gt;
You are welcome to test this - where you would need to build from source or try out 3.12.0-SNAPSHOT from apache snapshot maven server (takes a while for it to rebuild with latest fix as just commit now)&lt;/p&gt;</comment>
                            <comment id="17373585" author="davsclaus" created="Fri, 2 Jul 2021 15:08:44 +0000"  >&lt;p&gt;Potential fix&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/commit/95d62423c0c224985965575d142a902fa37247d2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/commit/95d62423c0c224985965575d142a902fa37247d2&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17374586" author="tapiiron" created="Mon, 5 Jul 2021 07:01:51 +0000"  >&lt;p&gt;Built 3.11.x and patched my camel-support jar with ServicePool fix. Confirming that this fixed the issue.&lt;/p&gt;</comment>
                            <comment id="17374599" author="davsclaus" created="Mon, 5 Jul 2021 07:22:32 +0000"  >&lt;p&gt;Thanks for checking the fix.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 19 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0sj34:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>