<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:57:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-18379] camel-mail: attachments with empty fileName</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-18379</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;camel-mail cannot consume mails having attachment with empty fileName, for example :&lt;/p&gt;



&lt;p&gt;------=_Part_16671_1906075314.1659698158276&lt;br/&gt;
Content-Type: image/png; name=&quot;&quot;&lt;br/&gt;
Content-Disposition: inline; filename=&quot;&quot;&lt;/p&gt;

&lt;p&gt;...&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;this mail produces the following error:&lt;br/&gt;
Caused by: java.lang.IllegalArgumentException: name must be specified and not empty&lt;br/&gt;
at org.apache.camel.util.StringHelper.notEmpty(StringHelper.java:335) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;!/:2.24.3&amp;#93;&lt;/span&gt;&lt;br/&gt;
at org.apache.camel.component.mail.DelegatingDataSource.&amp;lt;init&amp;gt;(DelegatingDataSource.java:35) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;!/:2.24.3&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;...&lt;/p&gt;

&lt;p&gt;proposition: implement same behavior as attachment with no fileName, ie attachment is ignored.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;workaround: use mapMailMessage=false option on camel source endpoint, so email is polled without error.&lt;/p&gt;

&lt;p&gt;then, in a Processor, on exchange object, overload binding class with custom &quot;MailBinding&quot; before reading attachments:&lt;br/&gt;
exchange.setProperty(Exchange.BINDING,new NoInlineMailBinding());&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;camel 2.24.3 on karaf 4.2.7, openjdk 11.0.15&lt;/p&gt;</environment>
        <key id="13476204">CAMEL-18379</key>
            <summary>camel-mail: attachments with empty fileName</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="rvigniel">Richard Vigniel</reporter>
                        <labels>
                    </labels>
                <created>Wed, 10 Aug 2022 15:44:52 +0000</created>
                <updated>Thu, 11 Aug 2022 12:21:06 +0000</updated>
                            <resolved>Thu, 11 Aug 2022 12:20:57 +0000</resolved>
                                    <version>2.24.3</version>
                    <version>3.18.0</version>
                                    <fixVersion>3.14.5</fixVersion>
                    <fixVersion>3.18.2</fixVersion>
                    <fixVersion>3.19.0</fixVersion>
                                    <component>camel-mail</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17578046" author="davsclaus" created="Wed, 10 Aug 2022 15:48:42 +0000"  >&lt;p&gt;Camel 2.x is EOL try with Camel 3 first&lt;/p&gt;</comment>
                            <comment id="17578366" author="rvigniel" created="Thu, 11 Aug 2022 09:55:34 +0000"  >&lt;p&gt;tested with camel 3.18.0, same behavior ( see test case attached )&lt;/p&gt;</comment>
                            <comment id="17578408" author="davsclaus" created="Thu, 11 Aug 2022 11:18:22 +0000"  >&lt;p&gt;Thanks for the test case. And what do you think should happen when the file has no name? Should a special name be assigned or the attachment skipped?&lt;/p&gt;</comment>
                            <comment id="17578438" author="rvigniel" created="Thu, 11 Aug 2022 12:02:43 +0000"  >&lt;p&gt;current implementaton already skips if fileName is null, so I suggest having the same behavior when fileName is empty.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;with more refactoring, the component could support attachments with no name, and multiple attachments with same name. but it would not fit with current camel Message interface, where attachments are named.&#160; ( Map&amp;lt;String,Attachment&amp;gt; )&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13048015" name="test-camel-mail-inline.zip" size="3422" author="rvigniel" created="Thu, 11 Aug 2022 09:54:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10061"><![CDATA[Novice]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 13 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z17ni0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>