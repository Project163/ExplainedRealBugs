<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:30:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-12732] Kafka manual commit to file repository doesn&apos;t work properly (using Spring boot)</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-12732</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I&apos;im trying to save the Kafka offset into FileStateRepository, the offset is correctly writing but it is not reading at route start so camel will read all the topic every time&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Component
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Route &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; RouteBuilder {
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void configure() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        from(kafka())
                .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;log:TEST?level=INFO&quot;&lt;/span&gt;)
                .process(Route::commitKafka);
    }

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; kafka() {

        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; kafkaEndpoint = &lt;span class=&quot;code-quote&quot;&gt;&quot;kafka:&quot;&lt;/span&gt;;

        kafkaEndpoint += &lt;span class=&quot;code-quote&quot;&gt;&quot;topictest&quot;&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-quote&quot;&gt;&quot;?brokers=&quot;&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-quote&quot;&gt;&quot;localhost:9092&quot;&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;amp;groupId=&quot;&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-quote&quot;&gt;&quot;TEST&quot;&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;amp;autoOffsetReset=&quot;&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-quote&quot;&gt;&quot;earliest&quot;&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;amp;autoCommitEnable=&quot;&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;amp;allowManualCommit=&quot;&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;amp;offsetRepository=&quot;&lt;/span&gt;;
        kafkaEndpoint += &lt;span class=&quot;code-quote&quot;&gt;&quot;#fileStore&quot;&lt;/span&gt;;

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; kafkaEndpoint;
    }

    @Bean(name = &lt;span class=&quot;code-quote&quot;&gt;&quot;fileStore&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; FileStateRepository fileStateRepository() {
        FileStateRepository fileStateRepository = FileStateRepository.fileStateRepository(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;/kafka/offset_repo/repo.dat&quot;&lt;/span&gt;));

        &lt;span class=&quot;code-comment&quot;&gt;// This will be empty
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(fileStateRepository.getCache());
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; fileStateRepository;
    }

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void commitKafka(Exchange exchange) {

        KafkaManualCommit manual = exchange.getIn().getHeader(KafkaConstants.MANUAL_COMMIT, KafkaManualCommit.class);
        manual.commitSync();
    }
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Spring boot&lt;/p&gt;

&lt;p&gt;kafka_2.11-1.1.0&lt;/p&gt;</environment>
        <key id="13179049">CAMEL-12732</key>
            <summary>Kafka manual commit to file repository doesn&apos;t work properly (using Spring boot)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="michael992">michael elbaz</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Aug 2018 10:45:21 +0000</created>
                <updated>Fri, 17 Aug 2018 07:28:38 +0000</updated>
                            <resolved>Thu, 16 Aug 2018 13:32:41 +0000</resolved>
                                    <version>2.22.0</version>
                                    <fixVersion>2.22.1</fixVersion>
                    <fixVersion>2.23.0</fixVersion>
                                    <component>camel-kafka</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16580921" author="michael992" created="Wed, 15 Aug 2018 10:54:29 +0000"  >&lt;p&gt;There is a second point even if i don&apos;t do the manual commit&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
.process(Route::commitKafka)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;camel will write into the repo file this is not supposed to happen i think.&lt;/p&gt;</comment>
                            <comment id="16580939" author="michael992" created="Wed, 15 Aug 2018 11:22:50 +0000"  >&lt;p&gt;I finally found a solution for the first post i need to do this to start the repo with Spring&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
    fileStateRepository.start();
} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
    e.printStackTrace();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But it does&apos;nt appear in the documentation.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16580969" author="dmvolod" created="Wed, 15 Aug 2018 11:50:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michael992&quot; class=&quot;user-hover&quot; rel=&quot;michael992&quot;&gt;michael992&lt;/a&gt;, you are welcome to add this info to the camel-kafka docs, but usually you can get more use cases from the unit-test, like FileStateRepositoryTest.java and others.&lt;/p&gt;</comment>
                            <comment id="16580978" author="michael992" created="Wed, 15 Aug 2018 11:59:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dmvolod&quot; class=&quot;user-hover&quot; rel=&quot;dmvolod&quot;&gt;dmvolod&lt;/a&gt;, Done for the documentation, still have a bug with the autocommit even when i set autocommit to false the offset is still immediatly writing to the file and when i call to the commitSync() method it will be written again.&lt;/p&gt;</comment>
                            <comment id="16580986" author="dmvolod" created="Wed, 15 Aug 2018 12:06:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michael992&quot; class=&quot;user-hover&quot; rel=&quot;michael992&quot;&gt;michael992&lt;/a&gt; could you please to create a simple JUnit test against your local Kafka server?&lt;/p&gt;</comment>
                            <comment id="16581101" author="michael992" created="Wed, 15 Aug 2018 13:56:16 +0000"  >&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.io.File;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.Properties;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.CamelContext;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.Endpoint;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.EndpointInject;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.builder.RouteBuilder;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.component.kafka.KafkaConstants;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.component.mock.MockEndpoint;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.impl.DefaultCamelContext;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.impl.FileStateRepository;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.impl.JndiRegistry;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.camel.test.junit4.CamelTestSupport;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.kafka.clients.producer.ProducerConfig;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.kafka.clients.producer.ProducerRecord;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.After;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.Before;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.Test;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;RouteTest &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; CamelTestSupport {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; TOPIC = &lt;span class=&quot;code-quote&quot;&gt;&quot;some_topic&quot;&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; TOPIC_PARTITION = TOPIC + &lt;span class=&quot;code-quote&quot;&gt;&quot;/0&quot;&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; BROKER = &lt;span class=&quot;code-quote&quot;&gt;&quot;localhost:9092&quot;&lt;/span&gt;;

    @EndpointInject(uri = &lt;span class=&quot;code-quote&quot;&gt;&quot;kafka:&quot;&lt;/span&gt; + TOPIC
            + &lt;span class=&quot;code-quote&quot;&gt;&quot;?brokers=&quot;&lt;/span&gt; + BROKER + &lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;amp;groupId=group1&amp;amp;autoCommitEnable=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;amp;allowManualCommit=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;offsetRepository=#offset&amp;amp;autoOffsetReset=earliest&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Endpoint from;

    @EndpointInject(uri = &lt;span class=&quot;code-quote&quot;&gt;&quot;mock:result&quot;&lt;/span&gt;)
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; MockEndpoint to;

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; org.apache.kafka.clients.producer.KafkaProducer&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; producer;

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; FileStateRepository fileStateRepository;

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void doPreSetup() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        fileStateRepository = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileStateRepository();
        fileStateRepository.setFileStore(
                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(getClass().getClassLoader().getResource(&lt;span class=&quot;code-quote&quot;&gt;&quot;repo.dat&quot;&lt;/span&gt;).getPath())
        );
        fileStateRepository.start();
    }

    @Before
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void before() {
        Properties props = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Properties();
        props.put(ProducerConfig.BOOTSTRAP_SERVERS_CONFIG, BROKER);
        props.put(ProducerConfig.KEY_SERIALIZER_CLASS_CONFIG, KafkaConstants.KAFKA_DEFAULT_SERIALIZER);
        props.put(ProducerConfig.VALUE_SERIALIZER_CLASS_CONFIG, KafkaConstants.KAFKA_DEFAULT_SERIALIZER);
        props.put(ProducerConfig.PARTITIONER_CLASS_CONFIG, KafkaConstants.KAFKA_DEFAULT_PARTITIONER);
        props.put(ProducerConfig.ACKS_CONFIG, &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;);
        producer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; org.apache.kafka.clients.producer.KafkaProducer&amp;lt;&amp;gt;(props);
    }

    @After
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void after() {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (producer != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            producer.close();
        }
    }

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; CamelContext createCamelContext() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        JndiRegistry registry = &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.createRegistry();
        registry.bind(&lt;span class=&quot;code-quote&quot;&gt;&quot;offset&quot;&lt;/span&gt;, fileStateRepository);

        DefaultCamelContext defaultCamelContext = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DefaultCamelContext(registry);
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; defaultCamelContext;
    }

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; RouteBuilder createRouteBuilder() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RouteBuilder() {

            @Override
            &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void configure() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
                from(from).id(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;)
                        .to(to);
            }
        };
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void autocommitDisabled() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; InterruptedException, IOException {
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; n = 1;
        to.expectedMessageCount(n);
        &lt;span class=&quot;code-comment&quot;&gt;// The LAST_RECORD_BEFORE_COMMIT header should include a value as we use manual commit
&lt;/span&gt;        to.allMessages().header(KafkaConstants.LAST_RECORD_BEFORE_COMMIT).isNotNull();

        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; k = 0; k &amp;lt; n; k++) {
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; msg = &lt;span class=&quot;code-quote&quot;&gt;&quot;message&quot;&lt;/span&gt;;
            ProducerRecord&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; data = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ProducerRecord&amp;lt;&amp;gt;(TOPIC, &lt;span class=&quot;code-quote&quot;&gt;&quot;KAFKA_KEY_&quot;&lt;/span&gt; + k, msg);
            producer.send(data);
        }

        to.assertIsSatisfied(500);

        assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;Since no commit its performed the state should not change&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;, fileStateRepository.getState(TOPIC_PARTITION));
    }
}

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;here the content of repo.dat in test/resources&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;some_topic/0=1&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16581402" author="githubbot" created="Wed, 15 Aug 2018 17:41:45 +0000"  >&lt;p&gt;mikadev opened a new pull request #2475: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2475&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2475&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Check if autocommit is enabled before setting the state&lt;/p&gt;

&lt;p&gt;   (Fix the manual commit for the state)&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16581403" author="githubbot" created="Wed, 15 Aug 2018 17:41:46 +0000"  >&lt;p&gt;GitHub user mikadev opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2475&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2475&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable&lt;/p&gt;

&lt;p&gt;    Check if autocommit is enabled before setting the state&lt;/p&gt;

&lt;p&gt;    (Fix the manual commit for the state)&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mikadev/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mikadev/camel&lt;/a&gt; patch-3&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2475.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2475.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2475&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 880656f64c35cb3f8cdac09236890917d2a0f2e9&lt;br/&gt;
Author: elbaz michael &amp;lt;michaelelbaz@...&amp;gt;&lt;br/&gt;
Date:   2018-08-15T17:40:22Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable&lt;/p&gt;

&lt;p&gt;    Check if autocommit is enabled before setting the state&lt;/p&gt;

&lt;p&gt;    (Fix the manual commit for the state)&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16581515" author="githubbot" created="Wed, 15 Aug 2018 19:25:51 +0000"  >&lt;p&gt;mikadev closed pull request #2475: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable for the state&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2475&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2475&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java b/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java&lt;br/&gt;
index 5f56270c4ab..5af185f9ffe 100644&lt;br/&gt;
&amp;#8212; a/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java&lt;br/&gt;
+++ b/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java&lt;br/&gt;
@@ -378,15 +378,19 @@ protected boolean doRun() {&lt;/p&gt;

&lt;p&gt;         private void commitOffset(StateRepository&amp;lt;String, String&amp;gt; offsetRepository, TopicPartition partition, long partitionLastOffset, boolean forceCommit) {&lt;br/&gt;
             if (partitionLastOffset != -1) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (offsetRepository != null) {&lt;br/&gt;
+                boolean autoCommitEnable = endpoint.getConfiguration().isAutoCommitEnable();&lt;br/&gt;
+                Optional&amp;lt;StateRepository&amp;lt;String, String&amp;gt;&amp;gt; offsetRepositoryOptional = Optional.ofNullable(offsetRepository);&lt;br/&gt;
+                BiConsumer&amp;lt;TopicPartition, Long&amp;gt; topicPartitionLongBiConsumer = (partition1, partitionLastOffset1) -&amp;gt; consumer.commitSync(Collections.singletonMap(partition1, new OffsetAndMetadata(partitionLastOffset1 + 1)));&lt;br/&gt;
+&lt;br/&gt;
+                if (autoCommitEnable &amp;amp;&amp;amp; offsetRepositoryOptional.isPresent()) {&lt;br/&gt;
                     log.debug(&quot;Saving offset repository state {} from topic {} with offset: {}&quot;, threadId, topicName, partitionLastOffset);&lt;br/&gt;
                     offsetRepository.setState(serializeOffsetKey(partition), serializeOffsetValue(partitionLastOffset));&lt;br/&gt;
                 } else if (forceCommit) {&lt;br/&gt;
                     log.debug(&quot;Forcing commitSync {} from topic {} with offset: {}&quot;, threadId, topicName, partitionLastOffset);&lt;/li&gt;
	&lt;li&gt;consumer.commitSync(Collections.singletonMap(partition, new OffsetAndMetadata(partitionLastOffset + 1)));&lt;/li&gt;
	&lt;li&gt;} else if (endpoint.getConfiguration().isAutoCommitEnable()) 
{
+                    topicPartitionLongBiConsumer.accept(partition, partitionLastOffset);
+                }
&lt;p&gt; else if (autoCommitEnable) {&lt;br/&gt;
                     log.debug(&quot;Auto commitSync {} from topic {} with offset: {}&quot;, threadId, topicName, partitionLastOffset);&lt;/p&gt;&lt;/li&gt;
	&lt;li&gt;consumer.commitSync(Collections.singletonMap(partition, new OffsetAndMetadata(partitionLastOffset + 1)));&lt;br/&gt;
+                    topicPartitionLongBiConsumer.accept(partition, partitionLastOffset);&lt;br/&gt;
                 }&lt;br/&gt;
             }&lt;br/&gt;
         }&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16581516" author="githubbot" created="Wed, 15 Aug 2018 19:25:51 +0000"  >&lt;p&gt;Github user mikadev closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2475&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2475&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16581611" author="githubbot" created="Wed, 15 Aug 2018 21:12:45 +0000"  >&lt;p&gt;mikadev opened a new pull request #2476: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable for the state&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2476&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2476&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Check if autocommitstate is enabled before setting the state&lt;/p&gt;

&lt;p&gt;   (Fix the manual commit for the state)&lt;/p&gt;

&lt;p&gt;   Warning! if the AutoCommitStateEnable is true and manual.commitSync is called when AllowManualCommit is true the state will be committed twice&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16581612" author="githubbot" created="Wed, 15 Aug 2018 21:12:45 +0000"  >&lt;p&gt;GitHub user mikadev opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2476&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2476&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable for the state&lt;/p&gt;

&lt;p&gt;    Check if autocommitstate is enabled before setting the state&lt;/p&gt;

&lt;p&gt;    (Fix the manual commit for the state)&lt;/p&gt;

&lt;p&gt;    Warning! if the AutoCommitStateEnable is true and manual.commitSync is called when AllowManualCommit is true the state will be committed twice&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mikadev/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mikadev/camel&lt;/a&gt; master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2476.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2476.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2476&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c3d89a59eb6bd9d78042e7e38972bc9d0ebd3dfc&lt;br/&gt;
Author: elbaz michael &amp;lt;elbazmichael92@...&amp;gt;&lt;br/&gt;
Date:   2018-08-15T21:02:39Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable for the state&lt;/p&gt;

&lt;p&gt;    Check if autocommitstate is enabled before setting the state&lt;/p&gt;

&lt;p&gt;    (Fix the manual commit for the state)&lt;/p&gt;

&lt;p&gt;    Warning! if the AutoCommitStateEnable is true and manual.commitSync is called when AllowManualCommit is true the state will be committed twice&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16582017" author="githubbot" created="Thu, 16 Aug 2018 06:23:05 +0000"  >&lt;p&gt;dmvolod commented on issue #2476: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable for the state&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2476#issuecomment-413438782&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2476#issuecomment-413438782&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   If some parameters are incompatible you can detect this and raise an exception or waiting.&lt;br/&gt;
   Please also add a JUnit test for this option. You can add real test and mark it with @Ignored. I&apos;m planning to add testcontainers option for Kafka component and able to run real test against container is possible.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16582019" author="githubbot" created="Thu, 16 Aug 2018 06:23:18 +0000"  >&lt;p&gt;dmvolod edited a comment on issue #2476: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable for the state&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2476#issuecomment-413438782&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2476#issuecomment-413438782&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   If some parameters are incompatible you can detect this and raise an exception or waiting.&lt;br/&gt;
   Please also add a JUnit test for this option. You can add real test and mark it with @Ignored. I&apos;m planning to add testcontainers option for Kafka component and able to run real test against container if possible.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16582071" author="githubbot" created="Thu, 16 Aug 2018 07:20:56 +0000"  >&lt;p&gt;davsclaus commented on a change in pull request #2476: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable for the state&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2476#discussion_r210497745&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2476#discussion_r210497745&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConfiguration.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -403,6 +405,7 @@ public Properties createConsumerProperties() {&lt;br/&gt;
         addPropertyIfNotNull(props, ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, getAutoOffsetReset());&lt;br/&gt;
         addPropertyIfNotNull(props, ConsumerConfig.CONNECTIONS_MAX_IDLE_MS_CONFIG, getConnectionMaxIdleMs());&lt;br/&gt;
         addPropertyIfNotNull(props, ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG, isAutoCommitEnable());&lt;br/&gt;
+        addPropertyIfNotNull(props, ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG, isAutoCommitStateEnable());&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   This is wrong where you override the same option&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16582074" author="davsclaus" created="Thu, 16 Aug 2018 07:21:52 +0000"  >&lt;p&gt;The file repo needs to be started / stopped as you found out.&lt;/p&gt;</comment>
                            <comment id="16582081" author="davsclaus" created="Thu, 16 Aug 2018 07:35:02 +0000"  >&lt;p&gt;We can look at making camel-kafka automatic start/stop the repo if needed.&lt;/p&gt;</comment>
                            <comment id="16582156" author="githubbot" created="Thu, 16 Aug 2018 08:17:16 +0000"  >&lt;p&gt;davsclaus commented on issue #2476: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable for the state&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2476#issuecomment-413464295&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2476#issuecomment-413464295&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @mikadev whats the reason for yet another option, can you try to explain a bit more about it? &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16582178" author="githubbot" created="Thu, 16 Aug 2018 08:26:39 +0000"  >&lt;p&gt;mikadev closed pull request #2476: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account autoCommitEnable for the state&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2476&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2476&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/components/camel-kafka/src/main/docs/kafka-component.adoc b/components/camel-kafka/src/main/docs/kafka-component.adoc&lt;br/&gt;
index 3a8cac53b8a..eef901ee3ea 100644&lt;br/&gt;
&amp;#8212; a/components/camel-kafka/src/main/docs/kafka-component.adoc&lt;br/&gt;
+++ b/components/camel-kafka/src/main/docs/kafka-component.adoc&lt;br/&gt;
@@ -86,6 +86,7 @@ with the following path and query parameters:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;autoCommitEnable&lt;/b&gt; (consumer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; If true, periodically commit to ZooKeeper the offset of messages already fetched by the consumer. This committed offset will be used when the process fails as the position from which the new consumer will begin. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; true &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Boolean&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;autoCommitIntervalMs&lt;/b&gt; (consumer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The frequency in ms that the consumer offsets are committed to zookeeper. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 5000 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Integer&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;autoCommitOnStop&lt;/b&gt; (consumer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Whether to perform an explicit auto commit when the consumer stops to ensure the broker has a commit from the last consumed message. This requires the option autoCommitEnable is turned on. The possible values are: sync, async, or none. And sync is the default value. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; sync &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; String&lt;br/&gt;
+&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;autoCommitStateEnable&lt;/b&gt; (consumer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; If false this will disable the auto commit of the state. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; true &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; boolean&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;autoOffsetReset&lt;/b&gt; (consumer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; What to do when there is no initial offset in ZooKeeper or if an offset is out of range: earliest : automatically reset the offset to the earliest offset latest : automatically reset the offset to the latest offset fail: throw exception to the consumer &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; latest &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; String&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;breakOnFirstError&lt;/b&gt; (consumer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; This options controls what happens when a consumer is processing an exchange and it fails. If the option is false then the consumer continues to the next message and processes it. If the option is true then the consumer breaks out, and will seek back to offset of the message that caused a failure, and then re-attempt to process this message. However this can lead to endless processing of the same message if its bound to fail every time, eg a poison message. Therefore its recommended to deal with that for example by using Camel&apos;s error handler. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; false &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; boolean&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;bridgeErrorHandler&lt;/b&gt; (consumer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Allows for bridging the consumer to the Camel routing Error Handler, which mean any exceptions occurred while the consumer is trying to pickup incoming messages, or the likes, will now be processed as a message and handled by the routing Error Handler. By default the consumer will use the org.apache.camel.spi.ExceptionHandler to deal with exceptions, that will be logged at WARN or ERROR level and ignored. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; false &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; boolean&lt;br/&gt;
diff --git a/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConfiguration.java b/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConfiguration.java&lt;br/&gt;
index e58caee72cc..0425d21f715 100644&lt;br/&gt;
&amp;#8212; a/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConfiguration.java&lt;br/&gt;
+++ b/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConfiguration.java&lt;br/&gt;
@@ -128,6 +128,8 @@&lt;br/&gt;
     //Consumer configuration properties&lt;br/&gt;
     @UriParam(label = &quot;consumer&quot;, defaultValue = &quot;true&quot;)&lt;br/&gt;
     private Boolean autoCommitEnable = true;&lt;br/&gt;
+    @UriParam(label = &quot;consumer&quot;, defaultValue = &quot;true&quot;)&lt;br/&gt;
+    private boolean autoCommitStateEnable = true;&lt;br/&gt;
     @UriParam(label = &quot;consumer&quot;)&lt;br/&gt;
     private boolean allowManualCommit;&lt;br/&gt;
     @UriParam(label = &quot;consumer&quot;, defaultValue = &quot;sync&quot;, enums = &quot;sync,async,none&quot;)&lt;br/&gt;
@@ -403,6 +405,7 @@ public Properties createConsumerProperties() {&lt;br/&gt;
         addPropertyIfNotNull(props, ConsumerConfig.AUTO_OFFSET_RESET_CONFIG, getAutoOffsetReset());&lt;br/&gt;
         addPropertyIfNotNull(props, ConsumerConfig.CONNECTIONS_MAX_IDLE_MS_CONFIG, getConnectionMaxIdleMs());&lt;br/&gt;
         addPropertyIfNotNull(props, ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG, isAutoCommitEnable());&lt;br/&gt;
+        addPropertyIfNotNull(props, ConsumerConfig.ENABLE_AUTO_COMMIT_CONFIG, isAutoCommitStateEnable());&lt;br/&gt;
         addPropertyIfNotNull(props, ConsumerConfig.PARTITION_ASSIGNMENT_STRATEGY_CONFIG, getPartitionAssignor());&lt;br/&gt;
         addPropertyIfNotNull(props, ConsumerConfig.RECEIVE_BUFFER_CONFIG, getReceiveBufferBytes());&lt;br/&gt;
         addPropertyIfNotNull(props, ConsumerConfig.REQUEST_TIMEOUT_MS_CONFIG, getConsumerRequestTimeoutMs());&lt;br/&gt;
@@ -643,6 +646,17 @@ public void setAutoCommitEnable(Boolean autoCommitEnable) 
{
         this.autoCommitEnable = autoCommitEnable;
     }&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;+    public boolean isAutoCommitStateEnable() &lt;/p&gt;
{
+        return autoCommitStateEnable;
+    }
&lt;p&gt;+&lt;br/&gt;
+    /**&lt;br/&gt;
+     * If false this will disable the autocommit of the state&lt;br/&gt;
+     */&lt;br/&gt;
+    public void setAutoCommitStateEnable(boolean autoCommitStateEnable) &lt;/p&gt;
{
+        this.autoCommitStateEnable = autoCommitStateEnable;
+    }
&lt;p&gt;+&lt;br/&gt;
     public boolean isAllowManualCommit() &lt;/p&gt;
{
         return allowManualCommit;
     }
&lt;p&gt;diff --git a/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java b/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java&lt;br/&gt;
index 5f56270c4ab..f6596daf3da 100644&lt;br/&gt;
&amp;#8212; a/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java&lt;br/&gt;
+++ b/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java&lt;br/&gt;
@@ -378,7 +378,7 @@ protected boolean doRun() {&lt;/p&gt;

&lt;p&gt;         private void commitOffset(StateRepository&amp;lt;String, String&amp;gt; offsetRepository, TopicPartition partition, long partitionLastOffset, boolean forceCommit) {&lt;br/&gt;
             if (partitionLastOffset != -1) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (offsetRepository != null) {&lt;br/&gt;
+                if (endpoint.getConfiguration().isAutoCommitStateEnable() &amp;amp;&amp;amp; offsetRepository != null) {&lt;br/&gt;
                     log.debug(&quot;Saving offset repository state {} from topic {} with offset: {}&quot;, threadId, topicName, partitionLastOffset);&lt;br/&gt;
                     offsetRepository.setState(serializeOffsetKey(partition), serializeOffsetValue(partitionLastOffset));&lt;br/&gt;
                 } else if (forceCommit) {&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16582179" author="githubbot" created="Thu, 16 Aug 2018 08:26:39 +0000"  >&lt;p&gt;Github user mikadev closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2476&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2476&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16582226" author="michael992" created="Thu, 16 Aug 2018 08:56:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt; &apos;We can look at making camel-kafka automatic start/stop the repo if needed.&apos; Yeah good idea&lt;/p&gt;</comment>
                            <comment id="16582346" author="githubbot" created="Thu, 16 Aug 2018 10:52:17 +0000"  >&lt;p&gt;mikadev opened a new pull request #2478: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account isAllowManualCommit&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2478&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2478&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Check  isAllowManualCommit before setting the state&lt;/p&gt;

&lt;p&gt;   (Fix the manual commit for the state)&lt;/p&gt;

&lt;p&gt;   Sorry for my previous pull request i think now is the right solution without adding parameters to the component.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16582347" author="githubbot" created="Thu, 16 Aug 2018 10:52:18 +0000"  >&lt;p&gt;GitHub user mikadev opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2478&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2478&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account isAllowManualCommit&lt;/p&gt;

&lt;p&gt;    Check  isAllowManualCommit before setting the state&lt;/p&gt;

&lt;p&gt;    (Fix the manual commit for the state)&lt;/p&gt;

&lt;p&gt;    Sorry for my previous pull request i think now is the right solution without adding parameters to the component.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/mikadev/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/mikadev/camel&lt;/a&gt; patch-2&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2478.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2478.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2478&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c540332c5e0711d1533632f47ca5a302ec728583&lt;br/&gt;
Author: elbaz michael &amp;lt;michaelelbaz@...&amp;gt;&lt;br/&gt;
Date:   2018-08-16T10:51:07Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account isAllowManualCommit&lt;/p&gt;

&lt;p&gt;    Check  isAllowManualCommit before setting the state&lt;/p&gt;

&lt;p&gt;    (Fix the manual commit for the state)&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16582506" author="githubbot" created="Thu, 16 Aug 2018 13:28:02 +0000"  >&lt;p&gt;davsclaus closed pull request #2478: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account isAllowManualCommit&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2478&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2478&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java b/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java&lt;br/&gt;
index e6913f3c698..df3b4b5769f 100644&lt;br/&gt;
&amp;#8212; a/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java&lt;br/&gt;
+++ b/components/camel-kafka/src/main/java/org/apache/camel/component/kafka/KafkaConsumer.java&lt;br/&gt;
@@ -399,7 +399,7 @@ protected boolean doRun() {&lt;/p&gt;

&lt;p&gt;         private void commitOffset(StateRepository&amp;lt;String, String&amp;gt; offsetRepository, TopicPartition partition, long partitionLastOffset, boolean forceCommit) {&lt;br/&gt;
             if (partitionLastOffset != -1) {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;if (offsetRepository != null) {&lt;br/&gt;
+                if (!endpoint.getConfiguration().isAllowManualCommit() &amp;amp;&amp;amp; offsetRepository != null) {&lt;br/&gt;
                     log.debug(&quot;Saving offset repository state {} from topic {} with offset: {}&quot;, threadId, topicName, partitionLastOffset);&lt;br/&gt;
                     offsetRepository.setState(serializeOffsetKey(partition), serializeOffsetValue(partitionLastOffset));&lt;br/&gt;
                 } else if (forceCommit) {&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16582507" author="githubbot" created="Thu, 16 Aug 2018 13:28:03 +0000"  >&lt;p&gt;Github user davsclaus closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2478&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2478&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16582515" author="davsclaus" created="Thu, 16 Aug 2018 13:32:41 +0000"  >&lt;p&gt;Okay the manual commit fix for commitOffset has been backported, thanks for the PR.&lt;/p&gt;</comment>
                            <comment id="16582516" author="davsclaus" created="Thu, 16 Aug 2018 13:33:02 +0000"  >&lt;p&gt;The auto startup of the offset repo has been introduced from Camel 2.23 onwards.&lt;/p&gt;</comment>
                            <comment id="16582655" author="githubbot" created="Thu, 16 Aug 2018 15:02:35 +0000"  >&lt;p&gt;mikadev commented on issue #2478: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account isAllowManualCommit&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2478#issuecomment-413577033&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2478#issuecomment-413577033&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Thanks when it will be deployed on mvn repo ?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16582697" author="githubbot" created="Thu, 16 Aug 2018 15:28:07 +0000"  >&lt;p&gt;davsclaus commented on issue #2478: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12732&quot; title=&quot;Kafka manual commit to file repository doesn&amp;#39;t work properly (using Spring boot)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12732&quot;&gt;&lt;del&gt;CAMEL-12732&lt;/del&gt;&lt;/a&gt; Take into account isAllowManualCommit&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2478#issuecomment-413585763&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2478#issuecomment-413585763&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   You mean a new release, then it take a bit we have new set of patch releases planned for Q3, you can find details in ASF JIRA.&lt;/p&gt;

&lt;p&gt;   For SNAPSHOT then they are usually build overnight&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13160708">CAMEL-12525</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 13 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3x2br:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>