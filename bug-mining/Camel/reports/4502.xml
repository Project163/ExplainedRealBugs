<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:29:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-12424] HTTPHelper.setCharsetFromContentType can&apos;t properly extract the charset if it isn&apos;t the last parameter</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-12424</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When our application recieves the Content-Type: application/json;charset=utf-8;profile=&quot;http://my.company.profile.errorSchema.4.json#&quot;, the HTTPHelper sets the wrong value for the Exchange.CHARSET_NAME in the Exchange.&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;&#160;@SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
 &#160;&#160;&#160; public static void setCharsetFromContentType(String contentType, Exchange exchange) {&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; if (contentType != null) {&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; // find the charset and set it to the Exchange&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; int index = contentType.indexOf(&quot;charset=&quot;);&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (index &amp;gt; 0) &lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {

 &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; String charset = contentType.substring(index + 8); //HERE IS THE PROBLEM &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; exchange.setProperty(Exchange.CHARSET_NAME, IOConverter.normalizeCharset(charset)); &#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }&lt;/span&gt; &lt;/div&gt;

&lt;p&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; }&lt;br/&gt;
 &#160;&#160;&#160; }&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Because of that, when the HTTPProducer tries to load the body we get the following error:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Exception: Error during type conversion from type: java.lang.String to the required type: java.lang.String with value &lt;span class=&quot;error&quot;&gt;&amp;#91;Body is instance of java.io.InputStream&amp;#93;&lt;/span&gt; due java.io.UnsupportedEncodingException: utf-8;profile=&quot;http://my.company.profile.errorSchema.4.json#&lt;br/&gt;
 org.apache.camel.TypeConversionException: Error during type conversion from type: java.lang.String to the required type: java.lang.String with value &lt;span class=&quot;error&quot;&gt;&amp;#91;Body is instance of java.io.InputStream&amp;#93;&lt;/span&gt; due java.io.UnsupportedEncodingException: utf-8;profile=&quot;http://my.company.profile.errorSchema.4.json#&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.impl.converter.BaseTypeConverterRegistry.createTypeConversionException(BaseTypeConverterRegistry.java:629) &lt;span class=&quot;error&quot;&gt;&amp;#91;178:org.apache.camel.camel-core:2.19.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.impl.converter.BaseTypeConverterRegistry.convertTo(BaseTypeConverterRegistry.java:150) &lt;span class=&quot;error&quot;&gt;&amp;#91;178:org.apache.camel.camel-core:2.19.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.core.osgi.OsgiTypeConverter.convertTo(OsgiTypeConverter.java:120) &lt;span class=&quot;error&quot;&gt;&amp;#91;176:org.apache.camel.camel-blueprint:2.19.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.component.http4.HttpProducer.populateHttpOperationFailedException(HttpProducer.java:305) &lt;span class=&quot;error&quot;&gt;&amp;#91;182:org.apache.camel.camel-http4:2.19.2&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.component.http4.HttpProducer.process(HttpProducer.java:207) &lt;span class=&quot;error&quot;&gt;&amp;#91;182:org.apache.camel.camel-http4:2.19.2&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Caused by: org.apache.camel.RuntimeCamelException: java.io.UnsupportedEncodingException: utf-8;profile=&quot;http://my.company.profile.errorSchema.4.json#&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.util.ObjectHelper.wrapRuntimeCamelException(ObjectHelper.java:1774) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.util.ObjectHelper.invokeMethod(ObjectHelper.java:1355) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.impl.converter.StaticMethodTypeConverter.convertTo(StaticMethodTypeConverter.java:59) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.impl.converter.BaseTypeConverterRegistry.doConvertTo(BaseTypeConverterRegistry.java:306) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.impl.converter.BaseTypeConverterRegistry.convertTo(BaseTypeConverterRegistry.java:133) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; ... 70 more&lt;br/&gt;
 Caused by: java.io.UnsupportedEncodingException: utf-8;profile=&quot;http://my.company.profile.errorSchema.4.json#&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.nio.cs.StreamDecoder.forInputStreamReader(StreamDecoder.java:71) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at java.io.InputStreamReader.&amp;lt;init&amp;gt;(InputStreamReader.java:100) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.converter.IOConverter.toReader(IOConverter.java:179) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.converter.IOConverter.toString(IOConverter.java:364) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at java.lang.reflect.Method.invoke(Method.java:498) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.util.ObjectHelper.invokeMethod(ObjectHelper.java:1351) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.impl.converter.StaticMethodTypeConverter.convertTo(StaticMethodTypeConverter.java:59) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.impl.converter.BaseTypeConverterRegistry.doConvertTo(BaseTypeConverterRegistry.java:306) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
 &#160;&#160;&#160;&#160;&#160;&#160;&#160; at org.apache.camel.impl.converter.BaseTypeConverterRegistry.convertTo(BaseTypeConverterRegistry.java:133) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Apache Camel 2.19.2&lt;/p&gt;

&lt;p&gt;Karaf 4.1.2&lt;/p&gt;

&lt;p&gt;JDK 1.8.0_161&lt;/p&gt;</environment>
        <key id="13150428">CAMEL-12424</key>
            <summary>HTTPHelper.setCharsetFromContentType can&apos;t properly extract the charset if it isn&apos;t the last parameter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="fabricio.pellegrini">Fabricio Guimar&#227;es Pellegrini</reporter>
                        <labels>
                            <label>easyfix</label>
                    </labels>
                <created>Thu, 5 Apr 2018 20:45:42 +0000</created>
                <updated>Fri, 13 Apr 2018 07:02:28 +0000</updated>
                            <resolved>Fri, 13 Apr 2018 07:02:28 +0000</resolved>
                                    <version>2.19.2</version>
                                    <fixVersion>2.20.4</fixVersion>
                    <fixVersion>2.21.1</fixVersion>
                    <fixVersion>2.22.0</fixVersion>
                                    <component>camel-http-common</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16428105" author="fabricio.pellegrini" created="Fri, 6 Apr 2018 08:33:33 +0000"  >&lt;p&gt;This is the temporary patch that I made locally to fix the issue.&lt;/p&gt;

&lt;p&gt;&#160;&#160;&#160; @SuppressWarnings(&quot;deprecation&quot;)&lt;br/&gt;
&#160;&#160;&#160; public static void setCharsetFromContentType(String contentType, Exchange exchange) {&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; if (contentType != null) &lt;/p&gt;
{
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; String charset = getCharsetFromContentType(contentType);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; exchange.setProperty(Exchange.CHARSET_NAME, charset);
&#160;&#160;&#160;&#160;&#160;&#160;&#160; }
&lt;p&gt;&#160;&#160;&#160; }&lt;/p&gt;</comment>
                            <comment id="16436927" author="davsclaus" created="Fri, 13 Apr 2018 07:02:28 +0000"  >&lt;p&gt;Thanks for reporting and providing the suggested patch&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10061"><![CDATA[Novice]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 31 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3s7hb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>