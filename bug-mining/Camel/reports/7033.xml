<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:09:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-21730] JBang export cannot validate route that depends on copied resources</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-21730</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;With a route like this ...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
- route:
    from:
      uri: &lt;span class=&quot;code-quote&quot;&gt;&quot;platform-http:/&quot;&lt;/span&gt;
      steps:
        - setBody:
            simple: &lt;span class=&quot;code-quote&quot;&gt;&quot;resource:classpath:META-INF/resources/index.html&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;on export I get ...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.camel.FailedToCreateRouteException: Failed to create route route1 at: &amp;gt;&amp;gt;&amp;gt; SetBody[simple{resource:classpath:META-INF/resources/index.html}] &amp;lt;&amp;lt;&amp;lt; in route: Route(route1)[From[platform-http:/] -&amp;gt; [SetBody[simple{resou... because of Illegal syntax: resource:classpath:META-INF/resources/index.html
	at org.apache.camel.reifier.RouteReifier.doCreateRoute(RouteReifier.java:235)
	at org.apache.camel.reifier.RouteReifier.createRoute(RouteReifier.java:86)
	at org.apache.camel.impl.DefaultModelReifierFactory.createRoute(DefaultModelReifierFactory.java:49)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:736)
	at org.apache.camel.impl.DefaultCamelContext.startRouteDefinitions(DefaultCamelContext.java:597)
	at org.apache.camel.impl.engine.AbstractCamelContext.doInit(AbstractCamelContext.java:2457)
	at org.apache.camel.support.service.BaseService.init(BaseService.java:85)
	at org.apache.camel.impl.engine.AbstractCamelContext.init(AbstractCamelContext.java:2087)
	at org.apache.camel.support.service.BaseService.start(BaseService.java:115)
	at org.apache.camel.impl.engine.AbstractCamelContext.start(AbstractCamelContext.java:2106)
	at org.apache.camel.impl.DefaultCamelContext.start(DefaultCamelContext.java:211)
	at org.apache.camel.main.KameletMain.doStart(KameletMain.java:384)
	at org.apache.camel.support.service.BaseService.start(BaseService.java:123)
	at org.apache.camel.dsl.jbang.core.commands.Run.runKameletMain(Run.java:1447)
	at org.apache.camel.dsl.jbang.core.commands.Run.run(Run.java:908)
	at org.apache.camel.dsl.jbang.core.commands.Run.runExport(Run.java:352)
	at org.apache.camel.dsl.jbang.core.commands.ExportBaseCommand.runSilently(ExportBaseCommand.java:344)
	at org.apache.camel.dsl.jbang.core.commands.ExportCamelMain.export(ExportCamelMain.java:66)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The issue seems to be that export is calling KameletMain.doStart() by which the referenced resources have not been copied.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13607618">CAMEL-21730</key>
            <summary>JBang export cannot validate route that depends on copied resources</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tdiesler">Thomas Diesler</assignee>
                                    <reporter username="tdiesler">Thomas Diesler</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Feb 2025 17:05:46 +0000</created>
                <updated>Wed, 19 Feb 2025 11:32:25 +0000</updated>
                            <resolved>Wed, 19 Feb 2025 11:32:25 +0000</resolved>
                                                    <fixVersion>4.8.4</fixVersion>
                    <fixVersion>4.10.1</fixVersion>
                    <fixVersion>4.11.0</fixVersion>
                                    <component>camel-jbang</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17924780" author="tdiesler" created="Fri, 7 Feb 2025 06:26:17 +0000"  >&lt;p&gt;Please remind me, why is it running the route with KameletMain? Is this for anything else, but route validation?&lt;br/&gt;
Perhaps it needs to be done after the resource copy phase.&lt;/p&gt;</comment>
                            <comment id="17928136" author="davsclaus" created="Tue, 18 Feb 2025 15:58:05 +0000"  >&lt;p&gt;You are not really expected to write prototypes where files are located in a old fashioned maven like structure with deep folders.&lt;/p&gt;

&lt;p&gt;You would have the files in the same folder, and just do camel run *. And then export will put the files in to src/java src/resources accordingly.&lt;/p&gt;

&lt;p&gt;Otherwise you would need to run/export with all the files and with those long folder names&lt;/p&gt;

&lt;p&gt;camel export foo.java META-INF/resources/index.html&lt;/p&gt;

&lt;p&gt;However the correct approach would be to have index.html in the same folder as the code/route and just do camel run *&lt;br/&gt;
After you export and if you desire to have those META-INF folder and what the .... then you move them manually to be more JEE / Maven like&lt;/p&gt;</comment>
                            <comment id="17928323" author="tdiesler" created="Wed, 19 Feb 2025 07:57:38 +0000"  >&lt;p&gt;I moved the webapp resources and route definition to a &lt;a href=&quot;https://github.com/tdiesler/camel-cloud-examples/tree/main/camel-main/platform-http-oauth/platform-http-files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;common directory&lt;/a&gt; and simplified the export cmd &lt;a href=&quot;https://github.com/tdiesler/camel-cloud-examples/blob/main/camel-main/platform-http-oauth/Makefile#L20&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;like this&lt;/a&gt; ...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
k8s-export:
	@$(CAMEL_CMD) kubernetes export platform-http-files/* \
	--dep=org.apache.camel.cloud:camel-oauth:0.1.0-SNAPSHOT \
	--gav=examples:platform-http-oauth:1.0.0 \
	--property=camel.oauth.baseUri=https:&lt;span class=&quot;code-comment&quot;&gt;//keycloak.local:30443/realms/camel \
&lt;/span&gt;	--property=camel.oauth.redirectUri=http:&lt;span class=&quot;code-comment&quot;&gt;//127.0.0.1:8080/auth \
&lt;/span&gt;	--property=camel.oauth.logout.redirectUri=http:&lt;span class=&quot;code-comment&quot;&gt;//127.0.0.1:8080/ \
&lt;/span&gt;	--property=camel.oauth.clientId=camel-client \
	--property=camel.oauth.clientSecret=camel-client-secret \
	--trait container.image-pull-policy=IfNotPresent \
	--ignore-loading-error=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; \
	--image-builder=docker \
	--image-push=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; \
	--runtime=camel-main
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;References to these resources in the route do not change, and the error from above still shows when --ignore-loading-error=false&lt;/p&gt;

&lt;p&gt;Hence, the provided patch is still needed and I&apos;d suggest to backport it to the LTS branches.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            38 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1u2e8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>