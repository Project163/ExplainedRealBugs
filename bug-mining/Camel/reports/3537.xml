<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:13:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-9431] camel-spring-boot - TypeConverter autoconfiguration leads to invalid shutdown sequence</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-9431</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When using autoconfiguration provided by the &lt;tt&gt;camel-spring-boot&lt;/tt&gt; artifact,  a &lt;tt&gt;TypeConverter&lt;/tt&gt; bean is automatically registered into the Spring context: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;TypeConversionConfiguration.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Bean
TypeConverter typeConverter(CamelContext camelContext) {
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; camelContext.getTypeConverter();
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The returned bean is an instance of &lt;tt&gt;DefaultTypeConverter&lt;/tt&gt;, which in turn implements &lt;tt&gt;ServiceSupport&lt;/tt&gt; and its method &lt;tt&gt;public void shutdown()&lt;/tt&gt;. This method is infered as a &lt;em&gt;destroy-method&lt;/em&gt; by Spring, and called during the shutdown of the ApplicationContext. &lt;/p&gt;

&lt;p&gt;As a consequence, the TypeConverter will be destroyed before the CamelContext, effectively preventing any type conversion support for the inflight messages that have still to be processed during the graceful shutdown period of Camel. &lt;/p&gt;

&lt;p&gt;AFAIK the simple fix would be to disable the destroy-method inference using &lt;tt&gt;@Bean(destroyMethod=&quot;&quot;)&lt;/tt&gt;. This will let Camel have a chance to perform a clean shutdown in the right sequence. &lt;/p&gt;

&lt;p&gt;As a workaround, it is possible to entirely disable the registration of the type converter in Spring using the property&lt;br/&gt;
&lt;tt&gt;camel.springboot.type-conversion = false&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12922719">CAMEL-9431</key>
            <summary>camel-spring-boot - TypeConverter autoconfiguration leads to invalid shutdown sequence</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="lchdev">Laurent Chiarello</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Dec 2015 14:12:50 +0000</created>
                <updated>Fri, 19 May 2017 09:20:51 +0000</updated>
                            <resolved>Wed, 10 Feb 2016 14:04:09 +0000</resolved>
                                    <version>2.16.1</version>
                                    <fixVersion>2.16.3</fixVersion>
                    <fixVersion>2.17.0</fixVersion>
                                    <component>camel-spring-boot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15062084" author="lchdev" created="Thu, 17 Dec 2015 14:13:35 +0000"  >&lt;p&gt;Attached a JUnit Test Case to demonstrate the bug&lt;/p&gt;</comment>
                            <comment id="15125275" author="davsclaus" created="Sun, 31 Jan 2016 10:17:38 +0000"  >&lt;p&gt;Can you try with Camel 2.16.2&lt;/p&gt;</comment>
                            <comment id="15125921" author="lchdev" created="Mon, 1 Feb 2016 08:15:33 +0000"  >&lt;p&gt;Same issue with &lt;tt&gt;2.16.2&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="15138602" author="davsclaus" created="Tue, 9 Feb 2016 09:17:04 +0000"  >&lt;p&gt;Can you attach a modified version of the unit test that do not have that (c) notice, eg we cannot accept and use this at ASF.&lt;/p&gt;</comment>
                            <comment id="15138692" author="lchdev" created="Tue, 9 Feb 2016 10:01:30 +0000"  >&lt;p&gt;Reupload test case without copyright notice&lt;/p&gt;</comment>
                            <comment id="15140805" author="davsclaus" created="Wed, 10 Feb 2016 14:04:09 +0000"  >&lt;p&gt;Thanks for reporting and with the suggested solution and the unit test.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13055752">CAMEL-11008</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13071072">CAMEL-11261</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12787036" name="CamelSpringBootShutdownTest.java" size="3950" author="lchdev" created="Tue, 9 Feb 2016 10:01:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 40 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2q1dr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>