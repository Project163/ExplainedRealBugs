<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:00:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-6185] http4 component should always filter &apos;host&apos; header</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-6185</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Exchanges originating from a CXF consumer get an incorrect &apos;host&apos; http-header when directed to a http4 producer. The problem is that the cxf consumer copies the incoming &apos;host&apos; header to the message, and the http4 producer copies this to the outgoing message. The http component does not do that.&lt;/p&gt;

&lt;p&gt;When sending a http request the HttpProducer copies headers from the incomming message to the HTTP request. The &apos;host&apos; header should not be copied since it (according to the http spec) should always contain the name of the server the request is sent to.&lt;br/&gt;
This has already been addressed for bridge endpoints (&lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-5757&quot; title=&quot;HTTP 1.1 Host header not set correctly with camel-http4&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-5757&quot;&gt;&lt;del&gt;CAMEL-5757&lt;/del&gt;&lt;/a&gt;), but is always an issue.&lt;/p&gt;

&lt;p&gt;The easiest fix seems to be to add the &apos;host&apos; header to the list of out going filters in org.apache.camel.component.http4.HttpHeaderFilterStrategy.initialize() i.e.:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;getOutFilter().add(&lt;span class=&quot;code-quote&quot;&gt;&quot;host&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Once this is done the special handling (i.e. removal of) of &apos;host&apos; header in case of bridgeEndpoint inside HttpProducer can be removed (since the strategy will remove it):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            &lt;span class=&quot;code-comment&quot;&gt;// Need to remove the Host key as it should be not used 
&lt;/span&gt;            exchange.getIn().getHeaders().remove(&lt;span class=&quot;code-quote&quot;&gt;&quot;host&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12637957">CAMEL-6185</key>
            <summary>http4 component should always filter &apos;host&apos; header</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ceposta">Christian Posta</assignee>
                                    <reporter username="fhoeben">Fried Hoeben</reporter>
                        <labels>
                    </labels>
                <created>Wed, 20 Mar 2013 11:44:02 +0000</created>
                <updated>Mon, 4 Nov 2013 20:57:29 +0000</updated>
                            <resolved>Mon, 4 Nov 2013 20:57:29 +0000</resolved>
                                    <version>2.10.4</version>
                                    <fixVersion>2.12.2</fixVersion>
                    <fixVersion>2.13.0</fixVersion>
                                    <component>camel-ahc</component>
                    <component>camel-http</component>
                    <component>camel-http4</component>
                    <component>camel-jetty</component>
                    <component>camel-netty-http</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13777877" author="ceposta" created="Wed, 25 Sep 2013 18:34:21 +0000"  >&lt;p&gt;I&apos;ll take a look and what is the best patch, and tests...&lt;/p&gt;</comment>
                            <comment id="13800652" author="davsclaus" created="Mon, 21 Oct 2013 13:43:39 +0000"  >&lt;p&gt;Some details about host header&lt;br/&gt;
&lt;a href=&quot;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.23&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.w3.org/Protocols/rfc2616/rfc2616-sec14.html#sec14.23&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Need to make the same fix in&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;camel-http&lt;/li&gt;
	&lt;li&gt;camel-http4&lt;/li&gt;
	&lt;li&gt;camel-ahc&lt;/li&gt;
	&lt;li&gt;camel-jetty&lt;/li&gt;
	&lt;li&gt;camel-netty-http&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;As we have several http clients.&lt;/p&gt;</comment>
                            <comment id="13808313" author="ceposta" created="Tue, 29 Oct 2013 19:02:41 +0000"  >&lt;p&gt;Thanks Claus. You&apos;re right &amp;#8211; all of the previously listed components also have a header filter strategy that doesn&apos;t take into account HOST. I have a patch almost complete.&lt;/p&gt;

&lt;p&gt;The camel-jetty component, however, has a dependency on the camel-http component. So it does not directly need any patching.&lt;/p&gt;

&lt;p&gt;Should have this fixed shortly.&lt;/p&gt;
</comment>
                            <comment id="13808706" author="ceposta" created="Wed, 30 Oct 2013 03:16:21 +0000"  >&lt;p&gt;Claus, &lt;br/&gt;
can you review my patch before I commit?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="13810283" author="davsclaus" created="Thu, 31 Oct 2013 14:24:37 +0000"  >&lt;p&gt;Patch looks good.&lt;/p&gt;</comment>
                            <comment id="13813258" author="ceposta" created="Mon, 4 Nov 2013 20:57:29 +0000"  >&lt;p&gt;This is now fixed on master.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12610978" name="CAMEL-6185-3.patch" size="20770" author="ceposta" created="Wed, 30 Oct 2013 03:16:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10061"><![CDATA[Novice]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>318435</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 3 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1iy1j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>318776</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>