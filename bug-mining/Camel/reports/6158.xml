<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:56:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-17949] camel-netty-http - Infinite loop when setting retries</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-17949</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;When setting re-deliveries in case of `NettyHttpOperationFailedException` it seems that the exchange is submitted back to netty&apos;s executor group without incrementing the attempts counter, resulting to an infinite loop. This example works as expected when using the `camel-http` component.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    onException(NettyHttpOperationFailedException.class)
        .maximumRedeliveries(2)
        .retryAttemptedLogLevel(LoggingLevel.WARN)
        .backOffMultiplier(5)
        .maximumRedeliveryDelay(500)
        .useExponentialBackOff()
        .handled(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;



&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;12-04-2022 17:41:57[Test worker] [INFO ] o.a.camel.test.junit5.CamelTestSupport - Testing: retry_when_destination_fails_to_consume() (route.WebhooksRouteBuilderTest)
12-04-2022 17:41:57[Test worker] [INFO ] o.a.camel.test.junit5.CamelTestSupport - ********************************************************************************
12-04-2022 17:41:59[Test worker] [INFO ] o.a.camel.component.netty.NettyComponent - Creating shared NettyConsumerExecutorGroup with 25 threads
12-04-2022 17:41:59[Test worker] [INFO ] o.a.c.impl.engine.AbstractCamelContext - Routes startup (total:1 started:1)
12-04-2022 17:41:59[Test worker] [INFO ] o.a.c.impl.engine.AbstractCamelContext -     Started mo-webhook (direct://mo-queue)
12-04-2022 17:41:59[Test worker] [INFO ] o.a.c.impl.engine.AbstractCamelContext - Apache Camel 3.14.2 (camel-1) started in 450ms (build:116ms init:225ms start:109ms)
12-04-2022 17:42:02[Camel Thread #1 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 0 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
12-04-2022 17:42:02[Camel Thread #2 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 1 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
12-04-2022 17:42:03[Camel Thread #3 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 1 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
12-04-2022 17:42:03[Camel Thread #4 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 1 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
12-04-2022 17:42:04[Camel Thread #5 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 1 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
12-04-2022 17:42:04[Camel Thread #6 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 1 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
12-04-2022 17:42:05[Camel Thread #7 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 1 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
12-04-2022 17:42:05[Camel Thread #8 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 1 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
12-04-2022 17:42:06[Camel Thread #9 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 1 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
12-04-2022 17:42:06[Camel Thread #10 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 1 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
12-04-2022 17:42:07[Camel Thread #11 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 1 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
12-04-2022 17:42:07[Camel Thread #12 - NettyClientTCPWorker] [WARN ] o.a.c.p.errorhandler.DefaultErrorHandler - Failed delivery for (MessageId: 0C03F6022475684-0000000000000000 on ExchangeId: 0C03F6022475684-0000000000000000). On delivery attempt: 1 caught: org.apache.camel.component.netty.http.NettyHttpOperationFailedException: Netty HTTP operation failed invoking null with statusCode: 500
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</description>
                <environment></environment>
        <key id="13439226">CAMEL-17949</key>
            <summary>camel-netty-http - Infinite loop when setting retries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="orpiske">Otavio Rodolfo Piske</assignee>
                                    <reporter username="memas.kal">Gerasimos Kalouris</reporter>
                        <labels>
                    </labels>
                <created>Tue, 12 Apr 2022 14:58:33 +0000</created>
                <updated>Wed, 1 Jun 2022 13:28:59 +0000</updated>
                            <resolved>Wed, 1 Jun 2022 07:41:41 +0000</resolved>
                                    <version>3.14.2</version>
                                    <fixVersion>3.14.4</fixVersion>
                    <fixVersion>3.18.0</fixVersion>
                                    <component>camel-netty-http</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17521233" author="davsclaus" created="Tue, 12 Apr 2022 16:16:51 +0000"  >&lt;p&gt;Are you able to build an unit test that reproduces this, and attach to this JIRA or send as github PR&lt;/p&gt;</comment>
                            <comment id="17530929" author="memas.kal" created="Mon, 2 May 2022 19:54:11 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;, I created a minimal example attached above, hope it helps. As I found out, the &quot;bug&quot; doesn&apos;t occur when using an InOut exchange pattern.&lt;/p&gt;</comment>
                            <comment id="17543731" author="rhuanrcoha" created="Mon, 30 May 2022 00:00:31 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I sent a PR that solve this issue. &lt;a href=&quot;https://github.com/apache/camel/pull/7687&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/7687&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17544000" author="rhuanrcoha" created="Mon, 30 May 2022 16:35:01 +0000"  >&lt;p&gt;Should I assign this ticket to me? Any action here?&lt;/p&gt;</comment>
                            <comment id="17544176" author="orpiske" created="Tue, 31 May 2022 07:29:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rhuanrcoha&quot; class=&quot;user-hover&quot; rel=&quot;rhuanrcoha&quot;&gt;rhuanrcoha&lt;/a&gt; I think you can assign the ticket to yourself if you are planning to work on it (as you have a PR opened for it already).&lt;/p&gt;</comment>
                            <comment id="17544181" author="davsclaus" created="Tue, 31 May 2022 07:33:09 +0000"  >&lt;p&gt;Only contributors whom have done more work can assign tickets. Until then you just write a comment that you work on this.&lt;/p&gt;</comment>
                            <comment id="17544750" author="orpiske" created="Wed, 1 Jun 2022 07:41:41 +0000"  >&lt;p&gt;Closing the ticket since the code was merged to main and back-ported to 3.14.x. Thanks to everyone that has contributed with code, reproducers and reviews to this ticket.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I also logged a future improvement to the solution in the ticket &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-18158&quot; title=&quot;camel-netty-http: investigate using HeaderFilterStrategy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-18158&quot;&gt;&lt;del&gt;CAMEL-18158&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13447862">CAMEL-18158</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13043177" name="netty-http-bug.zip" size="64454" author="memas.kal" created="Mon, 2 May 2022 19:39:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 24 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z11eao:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>