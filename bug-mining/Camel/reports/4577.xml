<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:30:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-12654] RabbitMQ Headers - Headers with null value are skipped.</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-12654</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Reference: Conversation with Claus Ibsen on &lt;a href=&quot;https://stackoverflow.com/questions/50583749/apache-camel-how-to-setheader-value-as-null&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Stackoverflow&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;org.apache.camel.component.rabbitmq.RabbitMQMessageConverter.buildProperties() skips the headers which have value null. The actual java client for RabbitMQ does not have this check. It accepts a basic Map&amp;lt;String,Object&amp;gt; which can accept null value. &lt;a href=&quot;https://rabbitmq.github.io/rabbitmq-java-client/api/current/com/rabbitmq/client/AMQP.BasicProperties.Builder.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Reference&lt;/a&gt; . Check the definition of headers() method&lt;/p&gt;

&lt;p&gt;&lt;b&gt;The business scenario where we use it&lt;/b&gt;. On the RabbitMQ, we accept messages from multiple sources. Depending on whether a specific header is null or not, we route these message downstream in our processing pipeline.&lt;/p&gt;

&lt;p&gt;If required, I could provide a working example of rabbitmq java-client to demonstrate that the headers with null value are not skipped&lt;/p&gt;</description>
                <environment></environment>
        <key id="13172363">CAMEL-12654</key>
            <summary>RabbitMQ Headers - Headers with null value are skipped.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dmvolod">Dmitry Volodin</assignee>
                                    <reporter username="Srivastav">Prakhar</reporter>
                        <labels>
                            <label>headers</label>
                            <label>rabbitmq</label>
                    </labels>
                <created>Mon, 16 Jul 2018 10:34:33 +0000</created>
                <updated>Tue, 24 Jul 2018 11:07:47 +0000</updated>
                            <resolved>Tue, 24 Jul 2018 11:07:47 +0000</resolved>
                                    <version>2.21.1</version>
                                    <fixVersion>2.21.3</fixVersion>
                    <fixVersion>2.22.1</fixVersion>
                    <fixVersion>2.23.0</fixVersion>
                                    <component>camel-rabbitmq</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16545123" author="dmvolod" created="Mon, 16 Jul 2018 12:12:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Srivastav&quot; class=&quot;user-hover&quot; rel=&quot;Srivastav&quot;&gt;Srivastav&lt;/a&gt; you can check if the header not found this means it&apos;s a null. Could you please provide an example where null header values are required but header absence is not enough.&lt;/p&gt;</comment>
                            <comment id="16550831" author="srivastav" created="Fri, 20 Jul 2018 14:39:09 +0000"  >&lt;p&gt;Consider this scenario.&lt;/p&gt;

&lt;p&gt;System A produces a message (For example Customer submitting his electric meter reading) to rabbitmq exchange. This message is passed in sequence through 3 systems&lt;br/&gt;
--&amp;gt; System 1 (performs a check if submitted through the Online interface)&lt;br/&gt;
&#160;&#160;&#160;&#160; --&amp;gt; Adds header (Online : &amp;lt;online-case-id&amp;gt;/null)&lt;br/&gt;
--&amp;gt; System 2 (more checks...)&lt;br/&gt;
&#160;&#160;&#160;&#160; --&amp;gt; Adds header (PreviousBalance : &amp;lt;some_id&amp;gt;/null)&lt;br/&gt;
--&amp;gt; System 3 (more chesks)&lt;br/&gt;
&#160;&#160;&#160;&#160; --&amp;gt; Adds header (ClearByInvoiceService : &amp;lt;some_other_id&amp;gt;/null)&lt;br/&gt;
...&lt;br/&gt;
...&lt;br/&gt;
...&lt;br/&gt;
--&amp;gt; System B&lt;br/&gt;
&#160;&#160;&#160; --&amp;gt; Does final processing&lt;/p&gt;

&lt;p&gt;System B processes this message. If either of the headers is set, it does a microservice lookup to get more details to enrich the base message. This works fine until we started reading the message from another system C. System C can directly send this message to System B, but it needs to setup headers with a null value.&lt;/p&gt;

&lt;p&gt;So far we have been using a set of POJO based rabbit-mq consumers and producers to read messages and do ETL operations. Now we have started porting many of our integrations to apache camel, but we are not able to use camel-rabbitmq component, because headers with null values are skipped. It would be good to have camel-rabbitmq not to filter out the header with null values like the original rabbitmq java-client does.&lt;/p&gt;

&lt;p&gt;Another factor which adds to the complexity is, there are multiple systems similar to System A, owned by different IT teams (and different programming languages). Making changes to System B would mean breaking message structure for rest of the parties which is additional cost and effort.&lt;/p&gt;

&lt;p&gt;We can actually fork the camel-rabbitmq component and fix the changes. But that would mean, we have to maintain this fork for all the versions that we would use.&lt;/p&gt;</comment>
                            <comment id="16550845" author="dmvolod" created="Fri, 20 Jul 2018 14:51:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Srivastav&quot; class=&quot;user-hover&quot; rel=&quot;Srivastav&quot;&gt;Srivastav&lt;/a&gt;, thanks for explanation. Looks like this is useful feature, but it must be added as an option (allowNullHeaders or something else) to provide backward compatibility.&lt;/p&gt;</comment>
                            <comment id="16552451" author="srivastav" created="Mon, 23 Jul 2018 07:56:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dmvolod&quot; class=&quot;user-hover&quot; rel=&quot;dmvolod&quot;&gt;dmvolod&lt;/a&gt; Yes I agree. Something like setNullHeader(&apos;headerName&apos;) should suffice. We don&apos;t need to pass any value, as it would be null anyway.&lt;/p&gt;</comment>
                            <comment id="16552496" author="dmvolod" created="Mon, 23 Jul 2018 08:47:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Srivastav&quot; class=&quot;user-hover&quot; rel=&quot;Srivastav&quot;&gt;Srivastav&lt;/a&gt; I&apos;ve done some unit test with the headers (null and non-null values) and logger info if following:&lt;/p&gt;

&lt;p&gt;AMQP.BasicProperties: #contentHeader&amp;lt;basic&amp;gt;(content-type=null, content-encoding=null, headers={breadcrumbId=ID-dvolodin-redhat-local-1532335144940-0-1, CustomHeader=customheader}, delivery-mode=null, priority=null, correlation-id=null, reply-to=null, expiration=null, message-id=null, timestamp=null, type=null, user-id=null, app-id=null, cluster-id=null)&lt;/p&gt;

&lt;p&gt;You can see that&apos;s possible to pass null values in headers which are mapped to the AMQP properties, i.e. user-id, app-id, etc. but not custom headers or RabbitMQ specific headers, for example rabbitmq.EXCHANGE_NAME.&lt;/p&gt;

&lt;p&gt;We will continue to work on unit tests and add allowNullHeaders to the endpoint property to implement your requirements.&lt;/p&gt;</comment>
                            <comment id="16552603" author="srivastav" created="Mon, 23 Jul 2018 10:17:38 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dmvolod&quot; class=&quot;user-hover&quot; rel=&quot;dmvolod&quot;&gt;dmvolod&lt;/a&gt; Yes, actually I should have mentioned that specifically that this problem occurs for the custom headers. Proposal for allowNullHeaders looks good.&lt;/p&gt;</comment>
                            <comment id="16553943" author="githubbot" created="Tue, 24 Jul 2018 08:12:20 +0000"  >&lt;p&gt;dmvolod opened a new pull request #2436: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12654&quot; title=&quot;RabbitMQ Headers - Headers with null value are skipped.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12654&quot;&gt;&lt;del&gt;CAMEL-12654&lt;/del&gt;&lt;/a&gt;: RabbitMQ Headers - Headers with null value are skipped&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2436&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16553944" author="githubbot" created="Tue, 24 Jul 2018 08:12:20 +0000"  >&lt;p&gt;GitHub user dmvolod opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2436&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12654&quot; title=&quot;RabbitMQ Headers - Headers with null value are skipped.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12654&quot;&gt;&lt;del&gt;CAMEL-12654&lt;/del&gt;&lt;/a&gt;: RabbitMQ Headers - Headers with null value are skipped&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/dmvolod/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/dmvolod/camel&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12654&quot; title=&quot;RabbitMQ Headers - Headers with null value are skipped.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12654&quot;&gt;&lt;del&gt;CAMEL-12654&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2436.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2436.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2436&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit fddedbc44de60ccc214c0c40be420dad7e1d13da&lt;br/&gt;
Author: Dmitry Volodin &amp;lt;dmvolod@...&amp;gt;&lt;br/&gt;
Date:   2018-07-24T08:08:45Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12654&quot; title=&quot;RabbitMQ Headers - Headers with null value are skipped.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12654&quot;&gt;&lt;del&gt;CAMEL-12654&lt;/del&gt;&lt;/a&gt;: RabbitMQ Headers - Headers with null value are skipped&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16553948" author="githubbot" created="Tue, 24 Jul 2018 08:16:20 +0000"  >&lt;p&gt;dmvolod commented on issue #2436: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12654&quot; title=&quot;RabbitMQ Headers - Headers with null value are skipped.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12654&quot;&gt;&lt;del&gt;CAMEL-12654&lt;/del&gt;&lt;/a&gt;: RabbitMQ Headers - Headers with null value are skipped&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2436#issuecomment-407321828&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2436#issuecomment-407321828&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @oscerd what do you think about backport this component to 2.21 and 2.22. I&apos;ve added a new option but it doesn&apos;t change the default behaviour? &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16553950" author="githubbot" created="Tue, 24 Jul 2018 08:20:14 +0000"  >&lt;p&gt;oscerd commented on issue #2436: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12654&quot; title=&quot;RabbitMQ Headers - Headers with null value are skipped.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12654&quot;&gt;&lt;del&gt;CAMEL-12654&lt;/del&gt;&lt;/a&gt;: RabbitMQ Headers - Headers with null value are skipped&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2436#issuecomment-407322949&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2436#issuecomment-407322949&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Should be fine if the behavior doesn&apos;t change it would be good.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16553951" author="githubbot" created="Tue, 24 Jul 2018 08:21:19 +0000"  >&lt;p&gt;dmvolod commented on issue #2436: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12654&quot; title=&quot;RabbitMQ Headers - Headers with null value are skipped.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12654&quot;&gt;&lt;del&gt;CAMEL-12654&lt;/del&gt;&lt;/a&gt;: RabbitMQ Headers - Headers with null value are skipped&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2436#issuecomment-407323263&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2436#issuecomment-407323263&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @oscerd , thanks. Will do it.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16553955" author="githubbot" created="Tue, 24 Jul 2018 08:26:25 +0000"  >&lt;p&gt;asfgit closed pull request #2436: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12654&quot; title=&quot;RabbitMQ Headers - Headers with null value are skipped.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12654&quot;&gt;&lt;del&gt;CAMEL-12654&lt;/del&gt;&lt;/a&gt;: RabbitMQ Headers - Headers with null value are skipped&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2436&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/components/camel-rabbitmq/src/main/docs/rabbitmq-component.adoc b/components/camel-rabbitmq/src/main/docs/rabbitmq-component.adoc&lt;br/&gt;
index e6e330c384e..823f22b7fbc 100644&lt;br/&gt;
&amp;#8212; a/components/camel-rabbitmq/src/main/docs/rabbitmq-component.adoc&lt;br/&gt;
+++ b/components/camel-rabbitmq/src/main/docs/rabbitmq-component.adoc&lt;br/&gt;
@@ -47,14 +47,14 @@ exchange name determines which exchange the queue will bind to.&lt;br/&gt;
 === Options&lt;/p&gt;

&lt;p&gt; // component options: START&lt;br/&gt;
-The RabbitMQ component supports 49 options, which are listed below.&lt;br/&gt;
+The RabbitMQ component supports 50 options, which are listed below.&lt;/p&gt;



&lt;p&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;width=&amp;quot;100%&amp;quot;,cols=&amp;quot;2,5,^1,2&amp;quot;,options=&amp;quot;header&amp;quot;&amp;#93;&lt;/span&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;===&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Name &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Description &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Default &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Type&lt;br/&gt;
-&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;hostname&lt;/b&gt; (common) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The hostname of the running rabbitmq instance or cluster. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; String&lt;br/&gt;
+&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;hostname&lt;/b&gt; (common) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The hostname of the running RabbitMQ instance or cluster. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; String&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;portNumber&lt;/b&gt; (common) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Port number for the host with the running rabbitmq instance or cluster. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 5672 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; int&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;username&lt;/b&gt; (security) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Username in case of authenticated access &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; guest &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; String&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;password&lt;/b&gt; (security) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Password for authenticated access &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; guest &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; String&lt;br/&gt;
@@ -102,6 +102,7 @@ The RabbitMQ component supports 49 options, which are listed below.&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;deadLetterQueue&lt;/b&gt; (common) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The name of the dead letter queue &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; String&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;deadLetterRoutingKey&lt;/b&gt; (common) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The routing key for the dead letter exchange &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; String&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;deadLetterExchangeType&lt;/b&gt; (common) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The type of the dead letter exchange &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; direct &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; String&lt;br/&gt;
+&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;allowNullHeaders&lt;/b&gt; (producer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Allow pass null values to header &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; false &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; boolean&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;resolveProperty Placeholders&lt;/b&gt; (advanced) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Whether the component should resolve property placeholders on itself when starting. Only properties which are of String type can use property placeholders. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; true &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; boolean&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;===&lt;br/&gt;
 // component options: END&lt;br/&gt;
@@ -126,7 +127,7 @@ with the following path and query parameters:&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;===&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;



&lt;p&gt;-==== Query Parameters (61 parameters):&lt;br/&gt;
+==== Query Parameters (62 parameters):&lt;/p&gt;


&lt;p&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;width=&amp;quot;100%&amp;quot;,cols=&amp;quot;2,5,^1,2&amp;quot;,options=&amp;quot;header&amp;quot;&amp;#93;&lt;/span&gt;&lt;br/&gt;
@@ -163,6 +164,7 @@ with the following path and query parameters:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;exceptionHandler&lt;/b&gt; (consumer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; To let the consumer use a custom ExceptionHandler. Notice if the option bridgeErrorHandler is enabled then this options is not in use. By default the consumer will deal with exceptions, that will be logged at WARN or ERROR level and ignored. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; ExceptionHandler&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;exchangePattern&lt;/b&gt; (consumer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Sets the exchange pattern when the consumer creates an exchange. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&amp;nbsp;&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; ExchangePattern&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;threadPoolSize&lt;/b&gt; (consumer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The consumer uses a Thread Pool Executor with a fixed number of threads. This setting allows you to set that number of threads. &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 10 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; int&lt;br/&gt;
+&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;allowNullHeaders&lt;/b&gt; (producer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Allow pass null values to header &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; false &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; boolean&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;bridgeEndpoint&lt;/b&gt; (producer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; If the bridgeEndpoint is true, the producer will ignore the message header of rabbitmq.EXCHANGE_NAME and rabbitmq.ROUTING_KEY &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; false &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; boolean&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;channelPoolMaxSize&lt;/b&gt; (producer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Get maximum number of opened channel in pool &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 10 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; int&lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;b&gt;channelPoolMaxWait&lt;/b&gt; (producer) &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Set the maximum number of milliseconds to wait for a channel from the pool &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; 1000 &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; long&lt;br/&gt;
diff --git a/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQComponent.java b/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQComponent.java&lt;br/&gt;
index 96c1ac8dfac..69a3e8ac34d 100644&lt;br/&gt;
&amp;#8212; a/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQComponent.java&lt;br/&gt;
+++ b/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQComponent.java&lt;br/&gt;
@@ -81,6 +81,8 @@&lt;br/&gt;
     private String deadLetterQueue;&lt;br/&gt;
     @Metadata(label = &quot;common&quot;, defaultValue = &quot;direct&quot;, enums = &quot;direct,fanout,headers,topic&quot;)&lt;br/&gt;
     private String deadLetterExchangeType = &quot;direct&quot;;&lt;br/&gt;
+    @Metadata(label = &quot;producer&quot;)&lt;br/&gt;
+    private boolean allowNullHeaders;&lt;br/&gt;
     @Metadata(label = &quot;security&quot;)&lt;br/&gt;
     private String sslProtocol;&lt;br/&gt;
     @Metadata(label = &quot;security&quot;)&lt;br/&gt;
@@ -241,6 +243,7 @@ protected RabbitMQEndpoint createEndpoint(String uri,&lt;br/&gt;
         endpoint.setDeadLetterExchangeType(getDeadLetterExchangeType());&lt;br/&gt;
         endpoint.setDeadLetterQueue(getDeadLetterQueue());&lt;br/&gt;
         endpoint.setDeadLetterRoutingKey(getDeadLetterRoutingKey());&lt;br/&gt;
+        endpoint.setAllowNullHeaders(isAllowNullHeaders());&lt;br/&gt;
         setProperties(endpoint, params);&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;         if (LOG.isDebugEnabled()) &lt;/p&gt;
{
@@ -262,6 +265,8 @@ protected RabbitMQEndpoint createEndpoint(String uri,
         endpoint.getExchangeArgs().putAll(IntrospectionSupport.extractProperties(argsCopy, EXCHANGE_ARG_PREFIX));
         endpoint.getQueueArgs().putAll(IntrospectionSupport.extractProperties(argsCopy, QUEUE_ARG_PREFIX));
         endpoint.getBindingArgs().putAll(IntrospectionSupport.extractProperties(argsCopy, BINDING_ARG_PREFIX));
+        // Change null headers processing for message converter
+        endpoint.getMessageConverter().setAllowNullHeaders(endpoint.isAllowNullHeaders());
 
         return endpoint;
     }
&lt;p&gt;@@ -271,7 +276,7 @@ public String getHostname() {&lt;br/&gt;
     }&lt;/p&gt;

&lt;p&gt;     /**&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;* The hostname of the running rabbitmq instance or cluster.&lt;br/&gt;
+     * The hostname of the running RabbitMQ instance or cluster.&lt;br/&gt;
      */&lt;br/&gt;
     public void setHostname(String hostname) {&lt;br/&gt;
         this.hostname = hostname;&lt;br/&gt;
@@ -859,4 +864,14 @@ public void setDeadLetterExchangeType(String deadLetterExchangeType) 
{
         this.deadLetterExchangeType = deadLetterExchangeType;
     }&lt;br/&gt;
 &lt;br/&gt;
+    /**&lt;br/&gt;
+     * Allow pass null values to header&lt;br/&gt;
+     */&lt;br/&gt;
+    public boolean isAllowNullHeaders() {
+        return allowNullHeaders;
+    }&lt;br/&gt;
+&lt;br/&gt;
+    public void setAllowNullHeaders(boolean allowNullHeaders) {
+        this.allowNullHeaders = allowNullHeaders;
+    }&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQEndpoint.java b/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQEndpoint.java&lt;br/&gt;
index 837ca59def6..9cdbf341b98 100644&lt;br/&gt;
&amp;#8212; a/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQEndpoint.java&lt;br/&gt;
+++ b/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQEndpoint.java&lt;br/&gt;
@@ -175,6 +175,8 @@&lt;br/&gt;
     private long publisherAcknowledgementsTimeout;&lt;br/&gt;
     @UriParam(label = &quot;producer&quot;)&lt;br/&gt;
     private boolean guaranteedDeliveries;&lt;br/&gt;
+    @UriParam(label = &quot;producer&quot;)&lt;br/&gt;
+    private boolean allowNullHeaders;&lt;br/&gt;
     // camel-jms supports this setting but it is not currently configurable in camel-rabbitmq&lt;br/&gt;
     private boolean useMessageIDAsCorrelationID = true;&lt;br/&gt;
     // camel-jms supports this setting but it is not currently configurable in camel-rabbitmq&lt;br/&gt;
@@ -999,6 +1001,17 @@ public void setExclusiveConsumer(boolean exclusiveConsumer) {
         this.exclusiveConsumer = exclusiveConsumer;
     }&lt;br/&gt;
 &lt;br/&gt;
+    /**&lt;br/&gt;
+     * Allow pass null values to header&lt;br/&gt;
+     */&lt;br/&gt;
+    public boolean isAllowNullHeaders() {+        return allowNullHeaders;+    }&lt;br/&gt;
+&lt;br/&gt;
+    public void setAllowNullHeaders(boolean allowNullHeaders) {
+        this.allowNullHeaders = allowNullHeaders;
+    }&lt;br/&gt;
+&lt;br/&gt;
     public boolean isPassive() {
         return passive;
     }&lt;br/&gt;
diff --git a/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQMessageConverter.java b/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQMessageConverter.java&lt;br/&gt;
index 6cb535e988e..07902ca14ee 100644&lt;br/&gt;
&amp;#8212; a/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQMessageConverter.java&lt;br/&gt;
+++ b/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/RabbitMQMessageConverter.java&lt;br/&gt;
@@ -37,6 +37,8 @@&lt;br/&gt;
 public class RabbitMQMessageConverter {&lt;br/&gt;
     protected static final Logger LOG = LoggerFactory.getLogger(RabbitMQMessageConverter.class);&lt;br/&gt;
 &lt;br/&gt;
+    private boolean allowNullHeaders;&lt;br/&gt;
+    &lt;br/&gt;
     /**&lt;br/&gt;
      * Will take an {@link Exchange} and add header values back to the {@link Exchange#getIn()}&lt;br/&gt;
      */&lt;br/&gt;
@@ -165,7 +167,8 @@ public void mergeAmqpProperties(Exchange exchange, AMQP.BasicProperties properti&lt;br/&gt;
         for (Map.Entry&amp;lt;String, Object&amp;gt; header : headers.entrySet()) {&lt;br/&gt;
             // filter header values.&lt;br/&gt;
             Object value = getValidRabbitMQHeaderValue(header.getValue());&lt;br/&gt;
-            if (value != null) {&lt;br/&gt;
+            &lt;br/&gt;
+            if (value != null || isAllowNullHeaders()) {
                 filteredHeaders.put(header.getKey(), header.getValue());
             } else if (LOG.isDebugEnabled()) {&lt;br/&gt;
                 if (header.getValue() == null) {&lt;br/&gt;
@@ -305,4 +308,12 @@ private boolean hasHeaders(final AMQP.BasicProperties properties) {&lt;br/&gt;
     private Object isSerializeHeaderEnabled(final AMQP.BasicProperties properties) {
         return properties.getHeaders().get(RabbitMQEndpoint.SERIALIZE_HEADER);
     }&lt;br/&gt;
+&lt;br/&gt;
+    public boolean isAllowNullHeaders() {
+        return allowNullHeaders;
+    }&lt;br/&gt;
+&lt;br/&gt;
+    public void setAllowNullHeaders(boolean allowNullHeaders) {+        this.allowNullHeaders = allowNullHeaders;+    }&lt;br/&gt;
 }&lt;br/&gt;
diff --git a/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/reply/ReplyManagerSupport.java b/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/reply/ReplyManagerSupport.java&lt;br/&gt;
index 15b990a7c2c..1ddf056385e 100644&lt;br/&gt;
&amp;#8212; a/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/reply/ReplyManagerSupport.java&lt;br/&gt;
+++ b/components/camel-rabbitmq/src/main/java/org/apache/camel/component/rabbitmq/reply/ReplyManagerSupport.java&lt;br/&gt;
@@ -224,6 +224,7 @@ protected void doStart() throws Exception {&lt;br/&gt;
         ObjectHelper.notNull(executorService, &quot;executorService&quot;, this);&lt;br/&gt;
         ObjectHelper.notNull(endpoint, &quot;endpoint&quot;, this);&lt;br/&gt;
 &lt;br/&gt;
+        messageConverter.setAllowNullHeaders(endpoint.isAllowNullHeaders());&lt;br/&gt;
         // timeout map to use for purging messages which have timed out, while waiting for an expected reply&lt;br/&gt;
         // when doing request/reply over JMS&lt;br/&gt;
         log.debug(&quot;Using timeout checker interval with {} millis&quot;, endpoint.getRequestTimeoutCheckerInterval());&lt;br/&gt;
diff --git a/components/camel-rabbitmq/src/test/java/org/apache/camel/component/rabbitmq/RabbitMQComponentTest.java b/components/camel-rabbitmq/src/test/java/org/apache/camel/component/rabbitmq/RabbitMQComponentTest.java&lt;br/&gt;
index 4b594432529..f732e6e38f5 100644&lt;br/&gt;
&amp;#8212; a/components/camel-rabbitmq/src/test/java/org/apache/camel/component/rabbitmq/RabbitMQComponentTest.java&lt;br/&gt;
+++ b/components/camel-rabbitmq/src/test/java/org/apache/camel/component/rabbitmq/RabbitMQComponentTest.java&lt;br/&gt;
@@ -45,6 +45,7 @@ public void testDefaultProperties() throws Exception {&lt;br/&gt;
         assertEquals(true, endpoint.isAutoDelete());&lt;br/&gt;
         assertEquals(true, endpoint.isDurable());&lt;br/&gt;
         assertEquals(false, endpoint.isExclusiveConsumer());&lt;br/&gt;
+        assertEquals(false, endpoint.isAllowNullHeaders());&lt;br/&gt;
         assertEquals(&quot;direct&quot;, endpoint.getExchangeType());&lt;br/&gt;
         assertEquals(ConnectionFactory.DEFAULT_CONNECTION_TIMEOUT, endpoint.getConnectionTimeout());&lt;br/&gt;
         assertEquals(ConnectionFactory.DEFAULT_CHANNEL_MAX, endpoint.getRequestedChannelMax());&lt;br/&gt;
@@ -70,6 +71,7 @@ public void testPropertiesSet() throws Exception {&lt;br/&gt;
         params.put(&quot;requestedFrameMax&quot;, 789);&lt;br/&gt;
         params.put(&quot;requestedHeartbeat&quot;, 321);&lt;br/&gt;
         params.put(&quot;exclusiveConsumer&quot;, true);&lt;br/&gt;
+        params.put(&quot;allowNullHeaders&quot;, true);&lt;br/&gt;
 &lt;br/&gt;
         RabbitMQEndpoint endpoint = createEndpoint(params);&lt;br/&gt;
 &lt;br/&gt;
@@ -89,6 +91,7 @@ public void testPropertiesSet() throws Exception {
         assertEquals(789, endpoint.getRequestedFrameMax());
         assertEquals(321, endpoint.getRequestedHeartbeat());
         assertEquals(true, endpoint.isExclusiveConsumer());
+        assertEquals(true, endpoint.isAllowNullHeaders());
     }&lt;br/&gt;
 &lt;br/&gt;
     private RabbitMQEndpoint createEndpoint(Map&amp;lt;String, Object&amp;gt; params) throws Exception {&lt;br/&gt;
diff --git a/components/camel-rabbitmq/src/test/java/org/apache/camel/component/rabbitmq/RabbitMQProducerIntTest.java b/components/camel-rabbitmq/src/test/java/org/apache/camel/component/rabbitmq/RabbitMQProducerIntTest.java&lt;br/&gt;
index 77bb1c1b321..d91bcc4bf73 100644&lt;br/&gt;
&amp;#8212; a/components/camel-rabbitmq/src/test/java/org/apache/camel/component/rabbitmq/RabbitMQProducerIntTest.java&lt;br/&gt;
+++ b/components/camel-rabbitmq/src/test/java/org/apache/camel/component/rabbitmq/RabbitMQProducerIntTest.java&lt;br/&gt;
@@ -18,7 +18,9 @@&lt;br/&gt;
 &lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.util.ArrayList;&lt;br/&gt;
+import java.util.HashMap;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
+import java.util.Map;&lt;br/&gt;
 import java.util.concurrent.TimeoutException;&lt;br/&gt;
 &lt;br/&gt;
 import com.rabbitmq.client.AMQP;&lt;br/&gt;
@@ -30,15 +32,22 @@&lt;br/&gt;
 import org.apache.camel.ProducerTemplate;&lt;br/&gt;
 import org.apache.camel.RuntimeCamelException;&lt;br/&gt;
 import org.apache.camel.builder.RouteBuilder;&lt;br/&gt;
+import org.apache.camel.util.ObjectHelper;&lt;br/&gt;
 import org.junit.After;&lt;br/&gt;
 import org.junit.Before;&lt;br/&gt;
 import org.junit.Test;&lt;br/&gt;
+import org.slf4j.Logger;&lt;br/&gt;
+import org.slf4j.LoggerFactory;&lt;br/&gt;
 &lt;br/&gt;
 public class RabbitMQProducerIntTest extends AbstractRabbitMQIntTest {&lt;br/&gt;
+    private static final Logger LOGGER = LoggerFactory.getLogger(RabbitMQProducerIntTest.class);&lt;br/&gt;
+    &lt;br/&gt;
     private static final String EXCHANGE = &quot;ex1&quot;;&lt;br/&gt;
     private static final String ROUTE = &quot;route1&quot;;&lt;br/&gt;
+    private static final String CUSTOM_HEADER = &quot;CustomHeader&quot;;&lt;br/&gt;
     private static final String BASIC_URI_FORMAT = &quot;rabbitmq:localhost:5672/%s?routingKey=%s&amp;amp;username=cameltest&amp;amp;password=cameltest&amp;amp;skipQueueDeclare=true&quot;;&lt;br/&gt;
     private static final String BASIC_URI = String.format(BASIC_URI_FORMAT, EXCHANGE, ROUTE);&lt;br/&gt;
+    private static final String ALLOW_NULL_HEADERS = BASIC_URI + &quot;&amp;amp;allowNullHeaders=true&quot;;&lt;br/&gt;
     private static final String PUBLISHER_ACKNOWLEDGES_URI = BASIC_URI + &quot;&amp;amp;mandatory=true&amp;amp;publisherAcknowledgements=true&quot;;&lt;br/&gt;
     private static final String PUBLISHER_ACKNOWLEDGES_BAD_ROUTE_URI = String.format(BASIC_URI_FORMAT, EXCHANGE, &quot;route2&quot;) + &quot;&amp;amp;publisherAcknowledgements=true&quot;;&lt;br/&gt;
     private static final String GUARANTEED_DELIVERY_URI = BASIC_URI + &quot;&amp;amp;mandatory=true&amp;amp;guaranteedDeliveries=true&quot;;&lt;br/&gt;
@@ -47,6 +56,9 @@&lt;br/&gt;
 &lt;br/&gt;
     @Produce(uri = &quot;direct:start&quot;)&lt;br/&gt;
     protected ProducerTemplate template;&lt;br/&gt;
+    &lt;br/&gt;
+    @Produce(uri = &quot;direct:start-allow-null-headers&quot;)&lt;br/&gt;
+    protected ProducerTemplate templateAllowNullHeaders;&lt;br/&gt;
 &lt;br/&gt;
     @Produce(uri = &quot;direct:start-with-confirms&quot;)&lt;br/&gt;
     protected ProducerTemplate templateWithConfirms;&lt;br/&gt;
@@ -73,6 +85,7 @@ protected RouteBuilder createRouteBuilder() throws Exception {&lt;br/&gt;
             @Override&lt;br/&gt;
             public void configure() throws Exception {
                 from(&quot;direct:start&quot;).to(BASIC_URI);
+                from(&quot;direct:start-allow-null-headers&quot;).to(ALLOW_NULL_HEADERS);
                 from(&quot;direct:start-with-confirms&quot;).to(PUBLISHER_ACKNOWLEDGES_URI);
                 from(&quot;direct:start-with-confirms-bad-route&quot;).to(PUBLISHER_ACKNOWLEDGES_BAD_ROUTE_URI);
                 from(&quot;direct:start-with-guaranteed-delivery&quot;).to(GUARANTEED_DELIVERY_URI);
@@ -105,6 +118,38 @@ public void producedMessageIsReceived() throws InterruptedException, IOException
 
         assertThatBodiesReceivedIn(received, &quot;new message&quot;);
     }&lt;br/&gt;
+    &lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void producedMessageWithNotNullHeaders() throws InterruptedException, IOException, TimeoutException {
+        final List&amp;lt;String&amp;gt; received = new ArrayList&amp;lt;&amp;gt;();
+        final Map&amp;lt;String, Object&amp;gt; receivedHeaders = new HashMap&amp;lt;String, Object&amp;gt;();
+        Map&amp;lt;String, Object&amp;gt; headers = new HashMap&amp;lt;String, Object&amp;gt;();
+        
+        headers.put(RabbitMQConstants.EXCHANGE_NAME, EXCHANGE);
+        headers.put(CUSTOM_HEADER, CUSTOM_HEADER.toLowerCase());
+        
+        channel.basicConsume(&quot;sammyq&quot;, true, new ArrayPopulatingConsumer(received, receivedHeaders));
+
+        template.sendBodyAndHeaders(&quot;new message&quot;, headers);
+
+        assertThatBodiesAndHeadersReceivedIn(receivedHeaders, headers, received, &quot;new message&quot;);
+    }&lt;br/&gt;
+    &lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void producedMessageAllowNullHeaders() throws InterruptedException, IOException, TimeoutException {
+        final List&amp;lt;String&amp;gt; received = new ArrayList&amp;lt;&amp;gt;();
+        final Map&amp;lt;String, Object&amp;gt; receivedHeaders = new HashMap&amp;lt;String, Object&amp;gt;();
+        Map&amp;lt;String, Object&amp;gt; headers = new HashMap&amp;lt;String, Object&amp;gt;();
+        
+        headers.put(RabbitMQConstants.EXCHANGE_NAME, null);
+        headers.put(CUSTOM_HEADER, null);
+        
+        channel.basicConsume(&quot;sammyq&quot;, true, new ArrayPopulatingConsumer(received, receivedHeaders));
+
+        templateAllowNullHeaders.sendBodyAndHeaders(&quot;new message&quot;, headers);
+
+        assertThatBodiesAndHeadersReceivedIn(receivedHeaders, headers, received, &quot;new message&quot;);
+    }&lt;br/&gt;
 &lt;br/&gt;
     private void assertThatBodiesReceivedIn(final List&amp;lt;String&amp;gt; received, final String... expected) throws InterruptedException {
         Thread.sleep(500);
@@ -114,6 +159,25 @@ private void assertThatBodiesReceivedIn(final List&amp;lt;String&amp;gt; received, final Strin
             assertEquals(body, received.get(0));
         }&lt;br/&gt;
     }&lt;br/&gt;
+    &lt;br/&gt;
+    private void assertThatBodiesAndHeadersReceivedIn(Map&amp;lt;String, Object&amp;gt; receivedHeaders, Map&amp;lt;String, Object&amp;gt; expectedHeaders,&lt;br/&gt;
+                                                      final List&amp;lt;String&amp;gt; received, final String... expected) throws InterruptedException {&lt;br/&gt;
+        Thread.sleep(500);&lt;br/&gt;
+&lt;br/&gt;
+        assertListSize(received, expected.length);&lt;br/&gt;
+        for (String body : expected) {
+            assertEquals(body, received.get(0));
+        }&lt;br/&gt;
+        &lt;br/&gt;
+        for (Map.Entry&amp;lt;String, Object&amp;gt; headers : expectedHeaders.entrySet()) {
+            Object receivedValue = receivedHeaders.get(headers.getKey());
+            Object expectedValue = headers.getValue();
+            
+            assertTrue(&quot;Header key &quot; + headers.getKey() + &quot; not found&quot;, receivedHeaders.containsKey(headers.getKey()));
+            assertEquals(0, ObjectHelper.compare(receivedValue == null ? &quot;&quot; : receivedValue.toString(), expectedValue == null ? &quot;&quot; : expectedValue.toString()));
+        }&lt;br/&gt;
+        &lt;br/&gt;
+    }&lt;br/&gt;
 &lt;br/&gt;
     @Test&lt;br/&gt;
     public void producedMessageIsReceivedWhenPublisherAcknowledgementsAreEnabled() throws InterruptedException, IOException, TimeoutException {&lt;br/&gt;
@@ -162,10 +226,18 @@ public void shouldSuccessfullyProduceMessageWhenGuaranteedDeliveryIsActivatedOnA&lt;br/&gt;
 &lt;br/&gt;
     private class ArrayPopulatingConsumer extends DefaultConsumer {&lt;br/&gt;
         private final List&amp;lt;String&amp;gt; received;&lt;br/&gt;
+        private final Map&amp;lt;String, Object&amp;gt; receivedHeaders;&lt;br/&gt;
 &lt;br/&gt;
         ArrayPopulatingConsumer(final List&amp;lt;String&amp;gt; received) {
             super(RabbitMQProducerIntTest.this.channel);
             this.received = received;
+            receivedHeaders = new HashMap&amp;lt;String, Object&amp;gt;();
+        }&lt;br/&gt;
+        &lt;br/&gt;
+        ArrayPopulatingConsumer(final List&amp;lt;String&amp;gt; received, Map&amp;lt;String, Object&amp;gt; receivedHeaders) {
+            super(RabbitMQProducerIntTest.this.channel);
+            this.received = received;
+            this.receivedHeaders = receivedHeaders;
         }&lt;br/&gt;
 &lt;br/&gt;
         @Override&lt;br/&gt;
@@ -173,6 +245,9 @@ public void handleDelivery(String consumerTag,&lt;br/&gt;
                                    Envelope envelope,&lt;br/&gt;
                                    AMQP.BasicProperties properties,&lt;br/&gt;
                                    byte[] body) throws IOException {&lt;br/&gt;
+            LOGGER.info(&quot;AMQP.BasicProperties: {}&quot;, properties);&lt;br/&gt;
+            &lt;br/&gt;
+            receivedHeaders.putAll(properties.getHeaders());&lt;br/&gt;
             received.add(new String(body));&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;br/&gt;
diff --git a/platforms/spring-boot/components-starter/camel-rabbitmq-starter/src/main/java/org/apache/camel/component/rabbitmq/springboot/RabbitMQComponentConfiguration.java b/platforms/spring-boot/components-starter/camel-rabbitmq-starter/src/main/java/org/apache/camel/component/rabbitmq/springboot/RabbitMQComponentConfiguration.java&lt;br/&gt;
index b2a40b24c3f..d9da3f6dde9 100644&lt;br/&gt;
&amp;#8212; a/platforms/spring-boot/components-starter/camel-rabbitmq-starter/src/main/java/org/apache/camel/component/rabbitmq/springboot/RabbitMQComponentConfiguration.java&lt;br/&gt;
+++ b/platforms/spring-boot/components-starter/camel-rabbitmq-starter/src/main/java/org/apache/camel/component/rabbitmq/springboot/RabbitMQComponentConfiguration.java&lt;br/&gt;
@@ -38,7 +38,7 @@&lt;br/&gt;
      */&lt;br/&gt;
     private Boolean enabled;&lt;br/&gt;
     /**&lt;br/&gt;
-     * The hostname of the running rabbitmq instance or cluster.&lt;br/&gt;
+     * The hostname of the running RabbitMQ instance or cluster.&lt;br/&gt;
      */&lt;br/&gt;
     private String hostname;&lt;br/&gt;
     /**&lt;br/&gt;
@@ -281,6 +281,10 @@&lt;br/&gt;
      * The type of the dead letter exchange&lt;br/&gt;
      */&lt;br/&gt;
     private String deadLetterExchangeType = &quot;direct&quot;;&lt;br/&gt;
+    /**&lt;br/&gt;
+     * Allow pass null values to header&lt;br/&gt;
+     */&lt;br/&gt;
+    private Boolean allowNullHeaders = false;&lt;br/&gt;
     /**&lt;br/&gt;
      * Whether the component should resolve property placeholders on itself when&lt;br/&gt;
      * starting. Only properties which are of String type can use property&lt;br/&gt;
@@ -675,6 +679,14 @@ public void setDeadLetterExchangeType(String deadLetterExchangeType) {         this.deadLetterExchangeType = deadLetterExchangeType;     }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;+    public Boolean getAllowNullHeaders() &lt;/p&gt;
{
+        return allowNullHeaders;
+    }
&lt;p&gt;+&lt;br/&gt;
+    public void setAllowNullHeaders(Boolean allowNullHeaders) &lt;/p&gt;
{
+        this.allowNullHeaders = allowNullHeaders;
+    }
&lt;p&gt;+&lt;br/&gt;
     public Boolean getResolvePropertyPlaceholders() &lt;/p&gt;
{
         return resolvePropertyPlaceholders;
     }




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16553956" author="githubbot" created="Tue, 24 Jul 2018 08:26:26 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2436&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16553976" author="srivastav" created="Tue, 24 Jul 2018 08:47:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dmvolod&quot; class=&quot;user-hover&quot; rel=&quot;dmvolod&quot;&gt;dmvolod&lt;/a&gt;. Amazing work. Few questions?&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;These updates would be available for which camel versions?&lt;/li&gt;
	&lt;li&gt;Could you please provide quick steps on how to use this feature. I will update the original question on StackOverflow.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16553983" author="dmvolod" created="Tue, 24 Jul 2018 09:11:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Srivastav&quot; class=&quot;user-hover&quot; rel=&quot;Srivastav&quot;&gt;Srivastav&lt;/a&gt;, I will backport this feature to the 2.22.1 and 2.21.3 versions.&lt;/p&gt;

&lt;p&gt;To be able pass null values to the headers the allowNullHeaders endpoint and component parameters were introduced.&lt;/p&gt;

&lt;p&gt;Please see following test file as sample config &lt;a href=&quot;https://github.com/apache/camel/commit/fddedbc44de60ccc214c0c40be420dad7e1d13da#diff-24dcd05dc15db65884aaba68ed79880b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;RabbitMQProducerIntTest.java&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 17 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3vxdz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>