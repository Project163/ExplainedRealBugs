<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:37:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-13878] Message is forwarded to the wrong Kafka Topic</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-13878</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I have 3 Apache Spring Boot applications and 3 topics.&lt;/p&gt;

&lt;p&gt;Let&apos;s call them Topic A, B and C and the Spring Boot applications FirstApp, SecondApp and ThridApp. I use Java DSL for the Kafka configuration.&lt;/p&gt;

&lt;p&gt;The FirstApp creates a message to Kafka Topic A.&lt;/p&gt;

&lt;p&gt;The SecondApp reads from Topic A makes transformations and passes each value to Topic B.&lt;/p&gt;

&lt;p&gt;The ThirdApp reads from Topic B and after transformations tries to pass it to Topic C.&lt;/p&gt;

&lt;p&gt;At this point through the debugger I saw that at the class&#160;&#160;org.apache.camel.component.kafka.KafkaProducer and at the method&#160;&lt;/p&gt;

&lt;p&gt;protected Iterator&amp;lt;ProducerRecord&amp;gt; createRecorder(Exchange exchange) something strange is happening.&lt;br/&gt;
The headerTopic (line 140) from the following line:&lt;/p&gt;

&lt;p&gt;String headerTopic = exchange.getIn().getHeader(KafkaConstants.TOPIC, String.class);&lt;/p&gt;

&lt;p&gt;contains the topic A! The correct topic that I have clearly set through the Java DSL can be found under the line 137:&#160;&lt;/p&gt;

&lt;p&gt;String topic = endpoint.getConfiguration().getTopic();&lt;/p&gt;

&lt;p&gt;As a workaround I have entered the following line inside a processor at the SecondProgram:&lt;/p&gt;

&lt;p&gt;exchange.getIn().setHeader(KafkaConstants.TOPIC, null);&lt;/p&gt;

&lt;p&gt;This has the side-effect that the headerTopic at line 140 is empty and thus the correct topic from line 137 is used.&lt;/p&gt;

&lt;p&gt;I believe that since I have clearly set the destination topic at the ThirdProgram to Topic C then Apache Camel should not override this with Topic A.&lt;/p&gt;

&lt;p&gt;It looks like a bug since from the method description I understand that we try to avoid circular loops.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13251699">CAMEL-13878</key>
            <summary>Message is forwarded to the wrong Kafka Topic</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="kklear">Klearchos Klearchou</reporter>
                        <labels>
                    </labels>
                <created>Mon, 19 Aug 2019 21:18:36 +0000</created>
                <updated>Tue, 1 Oct 2019 10:20:38 +0000</updated>
                            <resolved>Tue, 1 Oct 2019 10:20:38 +0000</resolved>
                                    <version>2.24.1</version>
                                    <fixVersion>3.0.0.RC2</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>camel-kafka</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16941649" author="davsclaus" created="Tue, 1 Oct 2019 08:56:06 +0000"  >&lt;p&gt;You can set bridgeEndpoint=true in Camel 2.x&lt;/p&gt;</comment>
                            <comment id="16941685" author="davsclaus" created="Tue, 1 Oct 2019 09:33:04 +0000"  >&lt;p&gt;For Camel 3 lets add a new OVERRIDE_TOPIC that you should use instead of TOPIC as a header, then we wont have this issue anymore&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 7 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z05tao:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>