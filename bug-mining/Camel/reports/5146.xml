<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:39:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-14327] Jt400PgmProducer doStop() method called on actively used instance</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-14327</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Today I migrated to 3.0.0 version and there seems to be an issue with Service pooling for the Jt400PgmpProducer.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Here&apos;s what I have:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    from(
        &lt;span class=&quot;code-quote&quot;&gt;&quot;seda:someName?concurrentConsumers=2&amp;amp;size=10&quot;&lt;/span&gt;)
            .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;jt400:&lt;span class=&quot;code-comment&quot;&gt;//{{as400.user}}:{{as400.password}}@{{as400.host}}/QSYS.LIB/PROGRAM.LIB/KFKEVR.SRVPGM?fieldsLength=200,2000,4,8,8,1000&amp;amp;outputFieldsIdx=0,1,2,3,4,5&amp;amp;connectionPool=#as400ConnectionPool&amp;amp;format=binary&amp;amp;procedureName=RECEIVEEVENT&quot;&lt;/span&gt;);&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;When concurrentConsumers attribute of seda endpoint is set to 1 everything works fine, but when it is greater than 1 then it looks like the evict method from MultiplePool class calls stop method on a Jt400PgmProducer instance that is still being used (the process method on it is still getting called). This results in nulling the iSeries object inside Jt400PgmProducer instance:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void doStop() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (iSeries != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Releasing connection to {}&quot;&lt;/span&gt;, getISeriesEndpoint());
            getISeriesEndpoint().releaseSystem(iSeries);
            iSeries = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and when the process method gets called later on this instance, it fails with NPE while constructing ServiceProgramCall:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void process(Exchange exchange) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
...
            pgmCall = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ServiceProgramCall(iSeries);
...            
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I believe this may be related to producer caching in ServicePool class, some sort of key issue in the cache Map maybe?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13276075">CAMEL-14327</key>
            <summary>Jt400PgmProducer doStop() method called on actively used instance</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="rgala">Rafa&#322; Ga&#322;a</reporter>
                        <labels>
                    </labels>
                <created>Mon, 23 Dec 2019 17:02:24 +0000</created>
                <updated>Mon, 30 Dec 2019 09:11:43 +0000</updated>
                            <resolved>Mon, 30 Dec 2019 09:11:43 +0000</resolved>
                                    <version>3.0.0</version>
                                    <fixVersion>3.0.1</fixVersion>
                    <fixVersion>3.1.0</fixVersion>
                                    <component>camel-jt400</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17002414" author="davsclaus" created="Mon, 23 Dec 2019 18:05:21 +0000"  >&lt;p&gt;Are you sure its the evict method? Maybe you can breakpoint in that doStop and see the stacktrace. &lt;/p&gt;

&lt;p&gt;Also as workaround you can try to increate the default capacity from 100, to a higher value.&lt;/p&gt;</comment>
                            <comment id="17002430" author="rgala" created="Mon, 23 Dec 2019 18:39:30 +0000"  >&lt;p&gt;Here&apos;s the stack, I believe the doStop method is called from onEvict lambda passed to LRUCache instance.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Daemon Thread [ForkJoinPool.commonPool-worker-6] (Suspended (breakpoint at line 212 in Jt400PgmProducer))	
	owns: Object  (id=386)	
	Jt400PgmProducer.doStop() line: 212	
	Jt400PgmProducer(ServiceSupport).stop() line: 159	
	ServiceHelper.stopService(Object) line: 119	
	AsyncProcessorConverterHelper$ProducerToAsyncProducerBridge(AsyncProcessorConverterHelper$ProcessorToAsyncProcessorBridge).stop() line: 112	
	ServicePool&amp;lt;S&amp;gt;.stop(S) line: 214	
	ServicePool$MultiplePool.evict(S) line: 324	
	ServicePool$MultiplePool.evict(Object) line: 283	
	ServicePool&amp;lt;S&amp;gt;.onEvict(S) line: 88	
	451064016.accept(Object) line: not available	
	CaffeineLRUCache&amp;lt;K,V&amp;gt;.onRemoval(K, V, RemovalCause) line: 239	
	SSLMS&amp;lt;K,V&amp;gt;(BoundedLocalCache&amp;lt;K,V&amp;gt;).lambda$notifyRemoval$1(Object, Object, RemovalCause) line: 333	
	38917799.run() line: not available	
	ForkJoinTask$RunnableExecuteAction.exec() line: 1402	
	ForkJoinTask$RunnableExecuteAction(ForkJoinTask&amp;lt;V&amp;gt;).doExec() line: 289	
	ForkJoinPool$WorkQueue.runTask(ForkJoinTask&amp;lt;?&amp;gt;) line: 1056	
	ForkJoinPool.runWorker(ForkJoinPool$WorkQueue) line: 1692	
	ForkJoinWorkerThread.run() line: 157	
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I don&apos;t think increasing cache would do any good. From what I see less than 10 instances of Jt400PgmProducer are created.&lt;/p&gt;</comment>
                            <comment id="17002711" author="rgala" created="Tue, 24 Dec 2019 07:45:35 +0000"  >&lt;p&gt;Tried to increase producer cache size, but it looks like it is always set to 1, here is part of the code from SendProcessor class:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void doStart() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (producerCache == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-comment&quot;&gt;// use a single producer cache as we need to only hold reference &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; one destination
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// and use a regular HashMap as we &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not want a soft reference store that may get re-claimed when low on memory
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// as we want to ensure the producer is kept around, to ensure its lifecycle is fully managed,
&lt;/span&gt;            &lt;span class=&quot;code-comment&quot;&gt;// eg stopping the producer when we stop etc.
&lt;/span&gt;            producerCache = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DefaultProducerCache(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, camelContext, 1);
            &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not add as service as we &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not want to manage the producer cache
&lt;/span&gt;        }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17002757" author="rgala" created="Tue, 24 Dec 2019 09:45:54 +0000"  >&lt;p&gt;I think I got it.&lt;/p&gt;

&lt;p&gt;Evictions are done in a separate thread. When the following method is executed:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void onEvict(S s) {
        Endpoint e = getEndpoint.apply(s);
        Pool&amp;lt;S&amp;gt; p = pool.get(e);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (p != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (p.evict(s)) {
                pool.remove(e);
            }
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            ServicePool.stop(s);
            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                e.getCamelContext().removeService(s);
            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception ex) {
                LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;Error removing service {}&quot;&lt;/span&gt;, s, ex);
            }
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;the call to &lt;b&gt;p.evict(s)&lt;/b&gt; results in &lt;b&gt;doStop()&lt;/b&gt; method of &lt;b&gt;Jt400PgmProducer&lt;/b&gt; instance being called. After the p.evict(s) method has finished, but before pool.remove(e) call, the producer can still be acquired from the pool, but because the &lt;b&gt;doStop&lt;/b&gt; has already been called and the &lt;b&gt;iSeries&lt;/b&gt; field is already nulled, exchange processing fails on NPE.&lt;/p&gt;

&lt;p&gt;I set breakpoints in &lt;b&gt;onEvict(S)&lt;/b&gt; method of &lt;b&gt;ServicePool&lt;/b&gt; and in &lt;b&gt;acquire(Endpoint endpoint)&lt;/b&gt; method, they evict/acquire the same &lt;b&gt;Jt400PgmProducer&lt;/b&gt; instance at the same time.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Daemon Thread [ForkJoinPool.commonPool-worker-6] (Suspended (breakpoint at line 85 in ServicePool))	
	ServicePool&amp;lt;S&amp;gt;.onEvict(S) line: 85	
	146690937.accept(Object) line: not available	
	CaffeineLRUCache&amp;lt;K,V&amp;gt;.onRemoval(K, V, RemovalCause) line: 239	
	SSLMS&amp;lt;K,V&amp;gt;(BoundedLocalCache&amp;lt;K,V&amp;gt;).lambda$notifyRemoval$1(Object, Object, RemovalCause) line: 333	
	1106690494.run() line: not available	
	ForkJoinTask$RunnableExecuteAction.exec() line: 1402	
	ForkJoinTask$RunnableExecuteAction(ForkJoinTask&amp;lt;V&amp;gt;).doExec() line: 289	
	ForkJoinPool$WorkQueue.runTask(ForkJoinTask&amp;lt;?&amp;gt;) line: 1056	
	ForkJoinPool.runWorker(ForkJoinPool$WorkQueue) line: 1692	
	ForkJoinWorkerThread.run() line: 157	
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Daemon Thread [Camel (camel-1) thread #17 - seda://seda] (Suspended (breakpoint at line 113 in ServicePool))	
	ServicePool&amp;lt;S&amp;gt;.acquire(Endpoint) line: 113	
	DefaultProducerCache.acquireProducer(Endpoint) line: 112	
	DefaultProducerCache.doInAsyncProducer(Endpoint, Exchange, AsyncCallback, ProducerCache$AsyncProducerCallback) line: 264	
	SendProcessor.process(Exchange, AsyncCallback) line: 162	
	RedeliveryErrorHandler$RedeliveryState.run() line: 476	
	DefaultReactiveExecutor$Worker.schedule(Runnable, boolean, boolean, boolean) line: 185	
	DefaultReactiveExecutor.scheduleMain(Runnable, String) line: 59	
	Pipeline.process(Exchange, AsyncCallback) line: 87	
	CamelInternalProcessor.process(Exchange, AsyncCallback) line: 228	
	SedaConsumer.sendToConsumers(Exchange) line: 266	
	SedaConsumer.doRun() line: 180	
	SedaConsumer.run() line: 125	
	RejectableThreadPoolExecutor(ThreadPoolExecutor).runWorker(ThreadPoolExecutor$Worker) line: 1149	
	ThreadPoolExecutor$Worker.run() line: 624	
	Thread.run() line: 748	

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Maybe the p.evict() should be called after pool.remove()?&lt;/p&gt;</comment>
                            <comment id="17004025" author="davsclaus" created="Fri, 27 Dec 2019 08:57:05 +0000"  >&lt;p&gt;Ah thanks for spotting this. Yeah we need to find a better solution. &lt;/p&gt;

&lt;p&gt;If its removed then we may need to add it back again if it was not intended to removed yet. Or come up with some locking during evicting so acquire/release are waiting for this task to complete etc.&lt;/p&gt;</comment>
                            <comment id="17004035" author="rgala" created="Fri, 27 Dec 2019 09:24:07 +0000"  >&lt;p&gt;I wonder what the purpose of LRUCache is anyway. In ServicePool class I see that objects are put in this cache but never seem to be retrieved:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; S acquire(Endpoint endpoint) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isStarted()) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        }
        S s = getPool(endpoint).acquire();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (s != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; cache != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            cache.putIfAbsent(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Key&amp;lt;&amp;gt;(s), s);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; s;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and the getPool():&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; Pool&amp;lt;S&amp;gt; getPool(Endpoint endpoint) {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; pool.computeIfAbsent(endpoint, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;::createPool);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Pool&amp;lt;S&amp;gt; createPool(Endpoint endpoint) {
        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; singleton = endpoint.isSingleton();
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            S s = producer.apply(endpoint);
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (s &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; IsSingleton) {
                singleton = ((IsSingleton) s).isSingleton();
            }
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
            &lt;span class=&quot;code-comment&quot;&gt;// Ignore
&lt;/span&gt;        }
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (singleton &amp;amp;&amp;amp; capacity &amp;gt; 0) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SinglePool(endpoint);
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MultiplePool(endpoint);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17004041" author="davsclaus" created="Fri, 27 Dec 2019 09:42:44 +0000"  >&lt;p&gt;This only affects components that are non singleton, which is very rare, but the jt400 is that. Another way is to rewrite this to be singleton which it ought to be in the first place.&lt;/p&gt;</comment>
                            <comment id="17004042" author="davsclaus" created="Fri, 27 Dec 2019 09:44:11 +0000"  >&lt;p&gt;Yeah this code is rewrite by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gnodet&quot; class=&quot;user-hover&quot; rel=&quot;gnodet&quot;&gt;gnodet&lt;/a&gt; and possibly a bit too complex.&lt;/p&gt;

&lt;p&gt;The 2.x code is&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/blob/camel-2.x/camel-core/src/main/java/org/apache/camel/impl/DefaultServicePool.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/camel-2.x/camel-core/src/main/java/org/apache/camel/impl/DefaultServicePool.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17004091" author="rgala" created="Fri, 27 Dec 2019 10:52:48 +0000"  >&lt;p&gt;I think that Jt400Endpoint can be converted to a singleton. There is a comment saying that it cannot be because the AS400 instance is stored in configuration, but imo this is not true. The AS400ConnectionPool is stored in Configuration, AS400 instances are retrieved using getConnection() method.&lt;/p&gt;</comment>
                            <comment id="17004142" author="davsclaus" created="Fri, 27 Dec 2019 12:01:05 +0000"  >&lt;p&gt;Yeah its using a connection pool so this ought to be safe&lt;/p&gt;</comment>
                            <comment id="17004179" author="rgala" created="Fri, 27 Dec 2019 13:02:02 +0000"  >&lt;p&gt;I changed &lt;b&gt;isSingleton()&lt;/b&gt; method to return true, but as a result, all threads were executing the process method on the same &lt;b&gt;Jt400PgmProducer&lt;/b&gt; instance, so they shared the same iSeries object (connection). This may lead to unpredictable results. I modified the code to obtain &lt;b&gt;AS400&lt;/b&gt; instance within &lt;b&gt;process()&lt;/b&gt; method and release it back to the connection pool upon finishing.&lt;/p&gt;

&lt;p&gt;Please take a look at proposed patch. I checked and the code worked. The amount of connections that were open to iSeries system were equal to amount of consumers on seda endpoint.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12989543/12989543_jt400.patch&quot; title=&quot;jt400.patch attached to CAMEL-14327&quot;&gt;jt400.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17004182" author="davsclaus" created="Fri, 27 Dec 2019 13:09:33 +0000"  >&lt;p&gt;Yeah that patch looks good. One thing to improve is maybe to have the release in a try .. finally block so its released in case of an exception was thrown&lt;/p&gt;</comment>
                            <comment id="17004187" author="rgala" created="Fri, 27 Dec 2019 13:22:45 +0000"  >&lt;p&gt;Ok, here&apos;s another one &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12989543/12989543_jt400.patch&quot; title=&quot;jt400.patch attached to CAMEL-14327&quot;&gt;jt400.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17004192" author="davsclaus" created="Fri, 27 Dec 2019 13:38:15 +0000"  >&lt;p&gt;Thanks for the patch, its applied to master for Camel 3.1. The bug in the service pool is still there.&lt;/p&gt;</comment>
                            <comment id="17004193" author="rgala" created="Fri, 27 Dec 2019 13:42:04 +0000"  >&lt;p&gt;The same needs to be done also for the Jt400DataQueueProducer. I will provide a patch this weekend.&lt;/p&gt;</comment>
                            <comment id="17005204" author="davsclaus" created="Mon, 30 Dec 2019 08:47:05 +0000"  >&lt;p&gt;Thanks Rafal.&lt;/p&gt;

&lt;p&gt;I created a ticket for the bug in the multi pool so we have a dedicated ticket for that bug.&lt;/p&gt;</comment>
                            <comment id="17005210" author="rgala" created="Mon, 30 Dec 2019 09:00:13 +0000"  >&lt;p&gt;Hello. Please find attached the patch for Jt400DataQueueProducer&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12989654/12989654_jt400_2.patch&quot; title=&quot;jt400_2.patch attached to CAMEL-14327&quot;&gt;jt400_2.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17005214" author="davsclaus" created="Mon, 30 Dec 2019 09:11:43 +0000"  >&lt;p&gt;Thanks for the patches. The bug in multipool is in another JIRA ticket&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="13276833">CAMEL-14340</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12989543" name="jt400.patch" size="7410" author="rgala" created="Fri, 27 Dec 2019 13:21:33 +0000"/>
                            <attachment id="12989540" name="jt400.patch" size="4412" author="rgala" created="Fri, 27 Dec 2019 12:56:42 +0000"/>
                            <attachment id="12989654" name="jt400_2.patch" size="3621" author="rgala" created="Mon, 30 Dec 2019 08:59:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 46 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09xy8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>