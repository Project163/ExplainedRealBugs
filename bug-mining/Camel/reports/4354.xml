<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:26:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-12062] Jaxb component does not communicate charset when explicitly set</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-12062</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;This test will cause a UnmappableCharacterException, since jaxb does not communicate the encoding of the bytes it outputs causing the file endpoint to assume it is UTF-8.&lt;/p&gt;

&lt;p&gt;This can be mitigated by adding an explicit reader in the route, but it would be nice if it worked OOTB.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
/**
 * @version 
 */
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ExplicitFileEncodingTest &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; CamelTestSupport {

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setUp() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        deleteDirectory(&lt;span class=&quot;code-quote&quot;&gt;&quot;target/charset&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.setUp();
    }

    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testISOFileEncoding() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        PurchaseOrder order = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PurchaseOrder();
        &lt;span class=&quot;code-comment&quot;&gt;//Data containing characters &#198;&#216;&#197;&#230;&#248;&#229; that differ in utf-8 and iso
&lt;/span&gt;        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name = &lt;span class=&quot;code-quote&quot;&gt;&quot;\u00c6\u00d8\u00C5\u00e6\u00f8\u00e5&quot;&lt;/span&gt;;
        order.setName(name);
        order.setAmount(123.45);
        order.setPrice(2.22);

        MockEndpoint result = getMockEndpoint(&lt;span class=&quot;code-quote&quot;&gt;&quot;mock:file&quot;&lt;/span&gt;);
        result.expectedFileExists(&lt;span class=&quot;code-quote&quot;&gt;&quot;target/charset/output.txt&quot;&lt;/span&gt;);

        template.sendBody(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:start&quot;&lt;/span&gt;, order);
        assertMockEndpointsSatisfied();

        JAXBContext jaxbContext = JAXBContext.newInstance(&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.camel.example&quot;&lt;/span&gt;);
        Unmarshaller unmarshaller = jaxbContext.createUnmarshaller();
        PurchaseOrder obj = (PurchaseOrder)unmarshaller.unmarshal(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(&lt;span class=&quot;code-quote&quot;&gt;&quot;target/charset/output.txt&quot;&lt;/span&gt;));
        assertEquals(obj.getName(), name);
    }

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; RouteBuilder createRouteBuilder() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RouteBuilder() {
            @Override
            &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void configure() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
                JaxbDataFormat jaxb = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; JaxbDataFormat(&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.camel.example&quot;&lt;/span&gt;);
                jaxb.setEncoding(&lt;span class=&quot;code-quote&quot;&gt;&quot;iso-8859-1&quot;&lt;/span&gt;);

                from(&lt;span class=&quot;code-quote&quot;&gt;&quot;direct:start&quot;&lt;/span&gt;)
                        .marshal(jaxb)
                        .to(&lt;span class=&quot;code-quote&quot;&gt;&quot;file:target/charset/?fileName=output.txt&amp;amp;charset=iso-8859-1&quot;&lt;/span&gt;);
            }
        };
    }

}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13122712">CAMEL-12062</key>
            <summary>Jaxb component does not communicate charset when explicitly set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="acosentino">Andrea Cosentino</assignee>
                                    <reporter username="MadMod">Jonas Waage</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Dec 2017 23:26:23 +0000</created>
                <updated>Thu, 7 Dec 2017 09:02:28 +0000</updated>
                            <resolved>Thu, 7 Dec 2017 09:02:28 +0000</resolved>
                                    <version>2.20.1</version>
                                    <fixVersion>2.21.0</fixVersion>
                                    <component>camel-jaxb</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16277760" author="githubbot" created="Mon, 4 Dec 2017 23:41:18 +0000"  >&lt;p&gt;IIlllII opened a new pull request #2130: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12062&quot; title=&quot;Jaxb component does not communicate charset when explicitly set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12062&quot;&gt;&lt;del&gt;CAMEL-12062&lt;/del&gt;&lt;/a&gt;:  Propagate encoding in charset property from jaxb component&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2130&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2130&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16277761" author="githubbot" created="Mon, 4 Dec 2017 23:41:18 +0000"  >&lt;p&gt;GitHub user IIlllII opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2130&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2130&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12062&quot; title=&quot;Jaxb component does not communicate charset when explicitly set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12062&quot;&gt;&lt;del&gt;CAMEL-12062&lt;/del&gt;&lt;/a&gt;:  Propagate encoding in charset property from jaxb component&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/IIlllII/camel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/IIlllII/camel&lt;/a&gt; master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2130.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2130.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #2130&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 64169aed7e0c8f07853565fac4e9822f26c83647&lt;br/&gt;
Author: Jonas Waage &amp;lt;jonas.h.waage@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-12-04T23:34:55Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12062&quot; title=&quot;Jaxb component does not communicate charset when explicitly set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12062&quot;&gt;&lt;del&gt;CAMEL-12062&lt;/del&gt;&lt;/a&gt; Propagate encoding in property&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16278379" author="githubbot" created="Tue, 5 Dec 2017 10:44:50 +0000"  >&lt;p&gt;oscerd commented on a change in pull request #2130: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12062&quot; title=&quot;Jaxb component does not communicate charset when explicitly set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12062&quot;&gt;&lt;del&gt;CAMEL-12062&lt;/del&gt;&lt;/a&gt;:  Propagate encoding in charset property from jaxb component&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2130#discussion_r154907417&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2130#discussion_r154907417&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: components/camel-jaxb/src/main/java/org/apache/camel/converter/jaxb/JaxbDataFormat.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -136,6 +136,10 @@ public void marshal(Exchange exchange, Object graph, OutputStream stream) throws&lt;br/&gt;
             String charset = exchange.getProperty(Exchange.CHARSET_NAME, String.class);&lt;br/&gt;
             if (charset == null) {&lt;br/&gt;
                 charset = encoding;&lt;br/&gt;
+                //Propagate the encoding of the exchange&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   This looks a bit ugly. &lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16278380" author="githubbot" created="Tue, 5 Dec 2017 10:44:50 +0000"  >&lt;p&gt;oscerd commented on a change in pull request #2130: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12062&quot; title=&quot;Jaxb component does not communicate charset when explicitly set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12062&quot;&gt;&lt;del&gt;CAMEL-12062&lt;/del&gt;&lt;/a&gt;:  Propagate encoding in charset property from jaxb component&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2130#discussion_r154907494&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2130#discussion_r154907494&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: components/camel-jaxb/src/main/java/org/apache/camel/converter/jaxb/JaxbDataFormat.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -136,6 +136,10 @@ public void marshal(Exchange exchange, Object graph, OutputStream stream) throws&lt;br/&gt;
             String charset = exchange.getProperty(Exchange.CHARSET_NAME, String.class);&lt;br/&gt;
             if (charset == null) {&lt;br/&gt;
                 charset = encoding;&lt;br/&gt;
+                //Propagate the encoding of the exchange&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Maybe we can find a better way.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16278586" author="githubbot" created="Tue, 5 Dec 2017 13:59:07 +0000"  >&lt;p&gt;IIlllII commented on a change in pull request #2130: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12062&quot; title=&quot;Jaxb component does not communicate charset when explicitly set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12062&quot;&gt;&lt;del&gt;CAMEL-12062&lt;/del&gt;&lt;/a&gt;:  Propagate encoding in charset property from jaxb component&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2130#discussion_r154951751&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2130#discussion_r154951751&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: components/camel-jaxb/src/main/java/org/apache/camel/converter/jaxb/JaxbDataFormat.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -136,6 +136,10 @@ public void marshal(Exchange exchange, Object graph, OutputStream stream) throws&lt;br/&gt;
             String charset = exchange.getProperty(Exchange.CHARSET_NAME, String.class);&lt;br/&gt;
             if (charset == null) {&lt;br/&gt;
                 charset = encoding;&lt;br/&gt;
+                //Propagate the encoding of the exchange&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Ok, what is the appropriate way to communicate the encoding?&lt;/p&gt;

&lt;p&gt;   This is what is done by the file endpoint, and afaik how that is able to accomplish the same feature:&lt;br/&gt;
   `/**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Set up the exchange properties with the options of the file endpoint&lt;br/&gt;
        */&lt;br/&gt;
       public void configureExchange(Exchange exchange) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {           // Now we just set the charset property here           if (getCharset() != null) {
               exchange.setProperty(Exchange.CHARSET_NAME, getCharset());
           }       }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;`&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16278587" author="githubbot" created="Tue, 5 Dec 2017 13:59:56 +0000"  >&lt;p&gt;IIlllII commented on a change in pull request #2130: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12062&quot; title=&quot;Jaxb component does not communicate charset when explicitly set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12062&quot;&gt;&lt;del&gt;CAMEL-12062&lt;/del&gt;&lt;/a&gt;:  Propagate encoding in charset property from jaxb component&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2130#discussion_r154951751&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2130#discussion_r154951751&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: components/camel-jaxb/src/main/java/org/apache/camel/converter/jaxb/JaxbDataFormat.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -136,6 +136,10 @@ public void marshal(Exchange exchange, Object graph, OutputStream stream) throws&lt;br/&gt;
             String charset = exchange.getProperty(Exchange.CHARSET_NAME, String.class);&lt;br/&gt;
             if (charset == null) {&lt;br/&gt;
                 charset = encoding;&lt;br/&gt;
+                //Propagate the encoding of the exchange&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   Ok, what is the appropriate way to communicate the encoding?&lt;/p&gt;

&lt;p&gt;   This is what is done by the file endpoint, and afaik how that is able to accomplish the same feature:&lt;br/&gt;
   ```   &lt;br/&gt;
       /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Set up the exchange properties with the options of the file endpoint&lt;br/&gt;
        */&lt;br/&gt;
       public void configureExchange(Exchange exchange) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {           // Now we just set the charset property here           if (getCharset() != null) {
               exchange.setProperty(Exchange.CHARSET_NAME, getCharset());
           }       }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;```&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16278627" author="githubbot" created="Tue, 5 Dec 2017 14:32:15 +0000"  >&lt;p&gt;IIlllII commented on a change in pull request #2130: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12062&quot; title=&quot;Jaxb component does not communicate charset when explicitly set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12062&quot;&gt;&lt;del&gt;CAMEL-12062&lt;/del&gt;&lt;/a&gt;:  Propagate encoding in charset property from jaxb component&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2130#discussion_r154951751&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2130#discussion_r154951751&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: components/camel-jaxb/src/main/java/org/apache/camel/converter/jaxb/JaxbDataFormat.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -136,6 +136,10 @@ public void marshal(Exchange exchange, Object graph, OutputStream stream) throws&lt;br/&gt;
             String charset = exchange.getProperty(Exchange.CHARSET_NAME, String.class);&lt;br/&gt;
             if (charset == null) {&lt;br/&gt;
                 charset = encoding;&lt;br/&gt;
+                //Propagate the encoding of the exchange&lt;/p&gt;

&lt;p&gt; Review comment:&lt;br/&gt;
   @oscerd &lt;br/&gt;
   Ok, what is the appropriate way to communicate the encoding?&lt;/p&gt;

&lt;p&gt;   I based this on what is done by the file endpoint, and AFAIK how that is able to accomplish the same feature:&lt;br/&gt;
   ```   &lt;br/&gt;
       /**&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Set up the exchange properties with the options of the file endpoint&lt;br/&gt;
        */&lt;br/&gt;
       public void configureExchange(Exchange exchange) 
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {           // Now we just set the charset property here           if (getCharset() != null) {
               exchange.setProperty(Exchange.CHARSET_NAME, getCharset());
           }       }&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;```&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16281523" author="githubbot" created="Thu, 7 Dec 2017 09:02:19 +0000"  >&lt;p&gt;oscerd commented on issue #2130: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12062&quot; title=&quot;Jaxb component does not communicate charset when explicitly set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12062&quot;&gt;&lt;del&gt;CAMEL-12062&lt;/del&gt;&lt;/a&gt;:  Propagate encoding in charset property from jaxb component&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2130#issuecomment-349905071&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2130#issuecomment-349905071&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Thanks the PR has been merged. We&apos;ll see if we can do something better in future.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16281524" author="githubbot" created="Thu, 7 Dec 2017 09:02:27 +0000"  >&lt;p&gt;oscerd closed pull request #2130: &lt;a href=&quot;https://issues.apache.org/jira/browse/CAMEL-12062&quot; title=&quot;Jaxb component does not communicate charset when explicitly set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;CAMEL-12062&quot;&gt;&lt;del&gt;CAMEL-12062&lt;/del&gt;&lt;/a&gt;:  Propagate encoding in charset property from jaxb component&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/camel/pull/2130&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2130&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/components/camel-jaxb/src/main/java/org/apache/camel/converter/jaxb/JaxbDataFormat.java b/components/camel-jaxb/src/main/java/org/apache/camel/converter/jaxb/JaxbDataFormat.java&lt;br/&gt;
index b78d5169c08..0782e2197c5 100644&lt;br/&gt;
&amp;#8212; a/components/camel-jaxb/src/main/java/org/apache/camel/converter/jaxb/JaxbDataFormat.java&lt;br/&gt;
+++ b/components/camel-jaxb/src/main/java/org/apache/camel/converter/jaxb/JaxbDataFormat.java&lt;br/&gt;
@@ -136,6 +136,10 @@ public void marshal(Exchange exchange, Object graph, OutputStream stream) throws&lt;br/&gt;
             String charset = exchange.getProperty(Exchange.CHARSET_NAME, String.class);&lt;br/&gt;
             if (charset == null) {&lt;br/&gt;
                 charset = encoding;&lt;br/&gt;
+                //Propagate the encoding of the exchange&lt;br/&gt;
+                if (charset != null) &lt;/p&gt;
{
+                    exchange.setProperty(Exchange.CHARSET_NAME, charset);
+                }
&lt;p&gt;             }&lt;br/&gt;
             if (charset != null) {&lt;br/&gt;
                 marshaller.setProperty(Marshaller.JAXB_ENCODING, charset);&lt;br/&gt;
diff --git a/components/camel-jaxb/src/test/java/org/apache/camel/example/ExplicitFileEncodingTest.java b/components/camel-jaxb/src/test/java/org/apache/camel/example/ExplicitFileEncodingTest.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 00000000000..b045821f005&lt;br/&gt;
&amp;#8212; /dev/null&lt;br/&gt;
+++ b/components/camel-jaxb/src/test/java/org/apache/camel/example/ExplicitFileEncodingTest.java&lt;br/&gt;
@@ -0,0 +1,77 @@&lt;br/&gt;
+/**&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one or more&lt;br/&gt;
+ * contributor license agreements.  See the NOTICE file distributed with&lt;br/&gt;
+ * this work for additional information regarding copyright ownership.&lt;br/&gt;
+ * The ASF licenses this file to You under the Apache License, Version 2.0&lt;br/&gt;
+ * (the &quot;License&quot;); you may not use this file except in compliance with&lt;br/&gt;
+ * the License.  You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ *      &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing, software&lt;br/&gt;
+ * distributed under the License is distributed on an &quot;AS IS&quot; BASIS,&lt;br/&gt;
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.&lt;br/&gt;
+ * See the License for the specific language governing permissions and&lt;br/&gt;
+ * limitations under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+package org.apache.camel.example;&lt;br/&gt;
+&lt;br/&gt;
+import java.io.File;&lt;br/&gt;
+&lt;br/&gt;
+import javax.xml.bind.JAXBContext;&lt;br/&gt;
+import javax.xml.bind.Unmarshaller;&lt;br/&gt;
+&lt;br/&gt;
+import org.apache.camel.builder.RouteBuilder;&lt;br/&gt;
+import org.apache.camel.component.mock.MockEndpoint;&lt;br/&gt;
+import org.apache.camel.converter.jaxb.JaxbDataFormat;&lt;br/&gt;
+import org.apache.camel.test.junit4.CamelTestSupport;&lt;br/&gt;
+import org.junit.Test;&lt;br/&gt;
+&lt;br/&gt;
+/**&lt;br/&gt;
+ * @version &lt;br/&gt;
+ */&lt;br/&gt;
+public class ExplicitFileEncodingTest extends CamelTestSupport {&lt;br/&gt;
+&lt;br/&gt;
+    @Override&lt;br/&gt;
+    public void setUp() throws Exception &lt;/p&gt;
{
+        deleteDirectory(&quot;target/charset&quot;);
+        super.setUp();
+    }
&lt;p&gt;+&lt;br/&gt;
+    @Test&lt;br/&gt;
+    public void testISOFileEncoding() throws Exception &lt;/p&gt;
{
+        PurchaseOrder order = new PurchaseOrder();
+        //Data containing characters &#198;&#216;&#197;&#230;&#248;&#229; that differ in utf-8 and iso
+        String name = &quot;\u00c6\u00d8\u00C5\u00e6\u00f8\u00e5&quot;;
+        order.setName(name);
+        order.setAmount(123.45);
+        order.setPrice(2.22);
+
+        MockEndpoint result = getMockEndpoint(&quot;mock:file&quot;);
+        result.expectedFileExists(&quot;target/charset/output.txt&quot;);
+
+        template.sendBody(&quot;direct:start&quot;, order);
+        assertMockEndpointsSatisfied();
+
+        JAXBContext jaxbContext = JAXBContext.newInstance(&quot;org.apache.camel.example&quot;);
+        Unmarshaller unmarshaller = jaxbContext.createUnmarshaller();
+        PurchaseOrder obj = (PurchaseOrder)unmarshaller.unmarshal(new File(&quot;target/charset/output.txt&quot;));
+        assertEquals(obj.getName(), name);
+    }
&lt;p&gt;+&lt;br/&gt;
+    @Override&lt;br/&gt;
+    protected RouteBuilder createRouteBuilder() throws Exception {&lt;br/&gt;
+        return new RouteBuilder() {&lt;br/&gt;
+            @Override&lt;br/&gt;
+            public void configure() throws Exception &lt;/p&gt;
{
+                JaxbDataFormat jaxb = new JaxbDataFormat(&quot;org.apache.camel.example&quot;);
+                jaxb.setEncoding(&quot;iso-8859-1&quot;);
+
+                from(&quot;direct:start&quot;)
+                        .marshal(jaxb)
+                        .to(&quot;file:target/charset/?fileName=output.txt&amp;amp;charset=iso-8859-1&quot;);
+            }
&lt;p&gt;+        };&lt;br/&gt;
+    }&lt;br/&gt;
+&lt;br/&gt;
+}&lt;/p&gt;




&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16281525" author="githubbot" created="Thu, 7 Dec 2017 09:02:28 +0000"  >&lt;p&gt;Github user oscerd closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/camel/pull/2130&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/pull/2130&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 49 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3nitb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>