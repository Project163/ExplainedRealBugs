<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:03:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-20210] camel-core - Rest DSL Narrow content-type with charset fails clientRequestValidation</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-20210</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;We recently upgraded an application to latest camel stable and got an error report from consumers when submitting a charset parameter in the content type header.&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Expected: a request with content-type header `application/xml; charset=utf-8` is correctly validated as part of a rest specification with `.consumes(MediaType.APPLICATION_XML_VALUE)`. We run with bindingmode.off&#160;&lt;/p&gt;

&lt;p&gt;Actual: fails with 415 MediaType error&lt;/p&gt;

&lt;p&gt;What changed?&#160;&lt;/p&gt;

&lt;p&gt;In commit &lt;a href=&quot;https://github.com/apache/camel/commit/2ce60e76a5c8496c1468558e0b6d3043c4eb0eac&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/commit/2ce60e76a5c8496c1468558e0b6d3043c4eb0eac&lt;/a&gt; a change in client Request Validation was introduced which defaults validation to return false instead of true.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The charset parameter is part of the Content-Type superset and is not per se a MediaType. We expect setting the correct MediaType would lead to a validation of MediaType and not fail on an additional charset parameter.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13561141">CAMEL-20210</key>
            <summary>camel-core - Rest DSL Narrow content-type with charset fails clientRequestValidation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="chrysophylax">Billy Jaime Beltran</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Dec 2023 12:32:48 +0000</created>
                <updated>Thu, 29 Feb 2024 15:19:37 +0000</updated>
                            <resolved>Mon, 11 Dec 2023 08:40:38 +0000</resolved>
                                    <version>4.2.0</version>
                                    <fixVersion>3.22.2</fixVersion>
                    <fixVersion>4.3.0</fixVersion>
                                    <component>camel-core</component>
                    <component>rest</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17794675" author="davsclaus" created="Fri, 8 Dec 2023 12:35:40 +0000"  >&lt;p&gt;Can you put together a small sample project of what you do and how to run and test with it&lt;/p&gt;</comment>
                            <comment id="17794705" author="JIRAUSER284297" created="Fri, 8 Dec 2023 13:14:42 +0000"  >&lt;p&gt;I added a zip file containing a minimum project&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Run with&#160;&lt;/p&gt;

&lt;p&gt;mvn clean compile -Dmaven.test.skip=true&lt;/p&gt;

&lt;p&gt;mvn camel:run&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Then call it with&lt;/p&gt;

&lt;p&gt;curl -vv &lt;a href=&quot;http://localhost:8080/test/xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8080/test/xml&lt;/a&gt; -d &quot;bleepbloop&quot; - H &quot;Content-Type: application/xml; charset=utf-8&quot;&lt;/p&gt;</comment>
                            <comment id="17794711" author="JIRAUSER284297" created="Fri, 8 Dec 2023 13:21:15 +0000"  >&lt;p&gt;I think to be correct the method should separately validate mediatype and any potential parameters in the content-type header&lt;/p&gt;</comment>
                            <comment id="17795230" author="davsclaus" created="Mon, 11 Dec 2023 08:19:35 +0000"  >&lt;p&gt;Yes I will correct this, and your example now works&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
curl -vv http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8080/test/xml -d &lt;span class=&quot;code-quote&quot;&gt;&quot;bleepbloop&quot;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&quot;Content-Type: application/xml; charset=utf-8&quot;&lt;/span&gt;
&lt;/span&gt;*   Trying 127.0.0.1:8080...
* Connected to localhost (127.0.0.1) port 8080 (#0)
&amp;gt; POST /test/xml HTTP/1.1
&amp;gt; Host: localhost:8080
&amp;gt; User-Agent: curl/7.88.1
&amp;gt; Accept: */*
&amp;gt; Content-Type: application/xml; charset=utf-8
&amp;gt; Content-Length: 10
&amp;gt;
&amp;lt; HTTP/1.1 200 OK
&amp;lt; Server: Jetty(12.0.4)
&amp;lt; Content-Type: application/xml; charset=utf-8
&amp;lt; Accept: */*
&amp;lt; User-Agent: curl/7.88.1
&amp;lt; Transfer-Encoding: chunked
&amp;lt;
* Connection #0 to host localhost left intact
hello from the xml route%
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13065125" name="camel-20210-example.zip" size="4889" author="chrysophylax" created="Fri, 8 Dec 2023 13:11:44 +0000"/>
                            <attachment id="13065121" name="tCYuXsuHaeo9.png" size="81561" author="chrysophylax" created="Fri, 8 Dec 2023 12:32:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 48 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1m54o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>