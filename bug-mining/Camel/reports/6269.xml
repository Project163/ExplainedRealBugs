<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:58:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-18603] Camel-Jbang: When using aws-ddb-sink Kamelet dependency are not resolved</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-18603</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;If you have a route like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
# camel-k: dependency=mvn:software.amazon.awssdk:dynamodb:2.17.290
- route:
&#160; &#160; from:
&#160; &#160; &#160; uri: &lt;span class=&quot;code-quote&quot;&gt;&quot;kamelet:kafka-not-secured-source&quot;&lt;/span&gt;
&#160; &#160; &#160; parameters:
&#160; &#160; &#160; &#160; bootstrapServers: localhost:9092
&#160; &#160; &#160; &#160; topic: ddb-topic
&#160; &#160; &#160; steps:
&#160; &#160; &#160; &#160; - to: 
&#160; &#160; &#160; &#160; &#160; &#160; uri: &lt;span class=&quot;code-quote&quot;&gt;&quot;kamelet:aws-ddb-sink&quot;&lt;/span&gt;
&#160; &#160; &#160; &#160; &#160; &#160; parameters:
&#160; &#160; &#160; &#160; &#160; &#160; &#160; accessKey: access
&#160; &#160; &#160; &#160; &#160; &#160; &#160; secretKey: sec
&#160; &#160; &#160; &#160; &#160; &#160; &#160; region: reg
&#160; &#160; &#160; &#160; &#160; &#160; &#160; table: &lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Then camel-jbang will fail with&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Caused by: java.lang.ClassNotFoundException: software.amazon.awssdk.services.dynamodb.model.AttributeValue
&#160; &#160; at java.base/jdk.internal.loader.BuiltinClassLoader.loadClass(BuiltinClassLoader.java:581)
&#160; &#160; at java.base/jdk.internal.loader.ClassLoaders$AppClassLoader.loadClass(ClassLoaders.java:178)
&#160; &#160; at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.loadClass(&lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.java:522)
&#160; &#160; ... 44 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;the command is: jbang run --fresh -Dcamel.jbang.version=3.19.0 camel@apache/camel run kafka-source-ddb.yaml&lt;/p&gt;

&lt;p&gt;This will fail with 3.20.0-SNAPSHOT too and by using --deps from cli&lt;/p&gt;</description>
                <environment></environment>
        <key id="13485647">CAMEL-18603</key>
            <summary>Camel-Jbang: When using aws-ddb-sink Kamelet dependency are not resolved</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="acosentino">Andrea Cosentino</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Oct 2022 11:43:34 +0000</created>
                <updated>Wed, 12 Oct 2022 13:53:14 +0000</updated>
                            <resolved>Wed, 12 Oct 2022 13:53:14 +0000</resolved>
                                    <version>3.19.0</version>
                                    <fixVersion>3.18.3</fixVersion>
                    <fixVersion>3.20.0</fixVersion>
                                    <component>camel-jbang</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17615896" author="gzres" created="Tue, 11 Oct 2022 15:04:47 +0000"  >&lt;p&gt;The problem is that there are two classloaders involved:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;one is the app classloader containing JARs being part of &lt;tt&gt;-classpath&lt;/tt&gt; prepared by JBang itself - this involves all transitive dependencies of the &lt;tt&gt;DEPS&lt;/tt&gt; specified in &lt;tt&gt;dsl/camel-jbang/camel-jbang-main/dist/CamelJBang.java&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;the other one is &lt;tt&gt;org.apache.camel.main.download.DependencyDownloaderClassLoader&lt;/tt&gt; prepared for the camel context created for &lt;tt&gt;jbang run camel@camel run&lt;/tt&gt; command.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;camel-kamelet-utils was not seeing the amazonsdk jars, because of two different classloaders.&lt;/p&gt;

&lt;p&gt;When I removed &lt;tt&gt;org.apache.camel.kamelets:camel-kamelets-utils&lt;/tt&gt; from &lt;tt&gt;main.CamelJBang&lt;/tt&gt; and added it to the route itself:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-yaml&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;# camel-&lt;span class=&quot;code-keyword&quot;&gt;k: &lt;/span&gt;dependency=mvn:software.amazon.awssdk:dynamodb:&lt;span class=&quot;code-object&quot;&gt;2&lt;/span&gt;.&lt;span class=&quot;code-object&quot;&gt;17&lt;/span&gt;.&lt;span class=&quot;code-object&quot;&gt;290&lt;/span&gt;
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;# camel-&lt;span class=&quot;code-keyword&quot;&gt;k: &lt;/span&gt;dependency=mvn:org.apache.camel.kamelets:camel-kamelets-utils:&lt;span class=&quot;code-object&quot;&gt;0&lt;/span&gt;.&lt;span class=&quot;code-object&quot;&gt;9&lt;/span&gt;.&lt;span class=&quot;code-object&quot;&gt;0&lt;/span&gt;
&lt;/span&gt;- &lt;span class=&quot;code-keyword&quot;&gt;route: &lt;/span&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;from: &lt;/span&gt;
      &lt;span class=&quot;code-keyword&quot;&gt;uri: &lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;kamelet:kafka-not-secured-source&quot;&lt;/span&gt;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;everything worked fine.&lt;/p&gt;</comment>
                            <comment id="17615903" author="JIRAUSER285918" created="Tue, 11 Oct 2022 15:17:43 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggrzybek&quot; class=&quot;user-hover&quot; rel=&quot;ggrzybek&quot;&gt;ggrzybek&lt;/a&gt; Can&apos;t you just add an archive with all your files or add your files in a github repository and propose the link?&lt;/p&gt;</comment>
                            <comment id="17615925" author="gzres" created="Tue, 11 Oct 2022 15:49:53 +0000"  >&lt;p&gt;If &lt;tt&gt;camel-aws2-ddb&lt;/tt&gt; wasn&apos;t a provided dependency of camel-kamelets-utils:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.camel&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;camel-aws2-ddb&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;scope&amp;gt;&lt;/span&gt;provided&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/scope&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;it&apos;d work as well, because JBang itself would add it to AppClassPath together with &lt;tt&gt;software.amazon.awssdk:dynamodb&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="17615926" author="gzres" created="Tue, 11 Oct 2022 15:52:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=nfilotto&quot; class=&quot;user-hover&quot; rel=&quot;nfilotto&quot;&gt;nfilotto&lt;/a&gt; sorry for the mess - it was mistaken (&lt;a href=&quot;https://www.getdroidtips.com/logitech-g502-right-left-click-not-holding/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.getdroidtips.com/logitech-g502-right-left-click-not-holding/&lt;/a&gt;) drag&amp;amp;drop of entire folder into Jira - a chance 1 in a million, but just happened...&lt;br/&gt;
I created CAMEL-18606, moved the attachments there (because it was hard to remove one by one). Please delete CAMEL-18606 (cc: &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=davsclaus&quot; class=&quot;user-hover&quot; rel=&quot;davsclaus&quot;&gt;davsclaus&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=acosentino&quot; class=&quot;user-hover&quot; rel=&quot;acosentino&quot;&gt;acosentino&lt;/a&gt;).&lt;/p&gt;</comment>
                            <comment id="17616048" author="davsclaus" created="Tue, 11 Oct 2022 19:40:04 +0000"  >&lt;p&gt;Ah thanks, yeah we should move camel-kamelets-util out of the pom.xml, and then automatic include it when kamelets are in use&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/camel/blob/main/dsl/camel-kamelet-main/src/main/java/org/apache/camel/main/download/DependencyDownloaderKamelet.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/camel/blob/main/dsl/camel-kamelet-main/src/main/java/org/apache/camel/main/download/DependencyDownloaderKamelet.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17616423" author="davsclaus" created="Wed, 12 Oct 2022 13:28:30 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggrzybek&quot; class=&quot;user-hover&quot; rel=&quot;ggrzybek&quot;&gt;ggrzybek&lt;/a&gt; I have now a fix in the works&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 4 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z199ag:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>