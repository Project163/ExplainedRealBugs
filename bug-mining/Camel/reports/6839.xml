<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 11:07:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-21034] DefaultInjector created instead of SpringInjector when using custom ModelReifierFactory in Spring Boot app</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-21034</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;I&apos;m referencing a custom model reifier factory in &lt;em&gt;META-INF/services/org/apache/camel/model-reifier-factory&lt;/em&gt; which is causing DefaultInjector to be used instead of the expected SpringInjector. &lt;/p&gt;

&lt;p&gt;SpringCamelContext creates the injector when loading a custom ModelReifierFactory. SpringInjector requires the application context, but since the application context hasn&apos;t yet been set on SpringCamelContext, the SpringInjector cannot be created so SpringCamelContext falls back to DefaultInjector.  I&apos;ve attached the call stack of this behaviour.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Spring Boot&lt;/p&gt;</environment>
        <key id="13587353">CAMEL-21034</key>
            <summary>DefaultInjector created instead of SpringInjector when using custom ModelReifierFactory in Spring Boot app</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="claude.mamo">Claude Mamo</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Jul 2024 15:45:12 +0000</created>
                <updated>Mon, 5 Aug 2024 15:25:24 +0000</updated>
                            <resolved>Mon, 5 Aug 2024 15:25:24 +0000</resolved>
                                    <version>4.6.0</version>
                                    <fixVersion>4.8.0</fixVersion>
                                    <component>came-core</component>
                    <component>camel-spring-boot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17870949" author="davsclaus" created="Mon, 5 Aug 2024 06:56:48 +0000"  >&lt;p&gt;Why are you using a custom model reifier ?&lt;/p&gt;</comment>
                            <comment id="17870990" author="claude.mamo" created="Mon, 5 Aug 2024 08:53:51 +0000"  >&lt;p&gt;So far it&apos;s only for prototyping purposes but I&apos;m&#160; customising the route reifier to add a dummy output when none are defined on the route. Camel complains when a route consists of only a &lt;em&gt;from(...)&lt;/em&gt; but this is might be a legitimate use case when the endpoint is a kamelet.&lt;/p&gt;</comment>
                            <comment id="17870993" author="davsclaus" created="Mon, 5 Aug 2024 09:01:03 +0000"  >&lt;p&gt;Okay so why do you need the spring injector as you said its chicken-and-egg. The factory is intended to be basic and not do a lot of fancy autowiring and dependency injection&lt;/p&gt;</comment>
                            <comment id="17871002" author="claude.mamo" created="Mon, 5 Aug 2024 09:20:27 +0000"  >&lt;p&gt;The problem is that the context&apos;s injector isn&apos;t changed later to &lt;em&gt;SpringInjector&lt;/em&gt;, as I would expect, so beans registered in Spring are not injected into beans defined in Camel which means that @Autowired references remain null. I got around this by registering the following &lt;em&gt;BeanPostProcessor&lt;/em&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;CamelContextBeanPostProcessor &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; BeanPostProcessor {

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ConfigurableApplicationContext applicationContext;

    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; CamelContextBeanPostProcessor(ConfigurableApplicationContext applicationContext) {
        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.applicationContext = applicationContext;
    }

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; postProcessBeforeInitialization(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; bean, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; beanName) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; BeansException {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (bean &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; CamelContext) {
            ((CamelContext) bean).setInjector(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SpringInjector(applicationContext));
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; bean;
    }

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; postProcessAfterInitialization(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; bean, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; beanName) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; BeansException {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; bean;
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17871010" author="davsclaus" created="Mon, 5 Aug 2024 09:50:45 +0000"  >&lt;p&gt;Ah okay, yeah we should make sure spring always sets the injector to spring based if its the default already&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13070569" name="call-stack.txt" size="6440" author="claude.mamo" created="Tue, 30 Jul 2024 15:41:10 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 14 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1qlsw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>