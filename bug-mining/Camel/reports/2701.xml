<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 10:02:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-7141] Custom HeaderFilterStrategy does not work when set it on either component or endpoint uri</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-7141</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Setting custom HeaderFilterStrategy on either NettyHttpComponent or NettyHttpEndpoint uri does not work. The only way to get it to work is to create a NettyHttpBinding bean and set the custom HeaderFilterStrategy as a property of the NettyHttpBinding bean and then set the custom NettyHttpBinding bean onto either NettyHttpComponent and NettyHttpEndpoint uri.&lt;/p&gt;

&lt;p&gt;The reason it does not work was that when applying the custom HeaderFilterStrategy, it is not set on NettyHttpBinding object as the NettyHttpBinding object always uses default HeaderFilterStrategy. &lt;/p&gt;

&lt;p&gt;I have attached the patch file. It might not be necessary to modify NettyHttpComponent class but I thought it&apos;d be better to initialize configuration, nettyBinding and headerFilterStrategy in their getter method only when needed rather than in constructor of the NettyHttpComponent.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12689524">CAMEL-7141</key>
            <summary>Custom HeaderFilterStrategy does not work when set it on either component or endpoint uri</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="njiang">Willem Jiang</assignee>
                                    <reporter username="joeluo">Joe Luo</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Jan 2014 17:20:36 +0000</created>
                <updated>Tue, 15 Apr 2014 03:21:55 +0000</updated>
                            <resolved>Tue, 15 Apr 2014 03:21:55 +0000</resolved>
                                    <version>2.12.2</version>
                                    <fixVersion>2.12.4</fixVersion>
                    <fixVersion>2.13.1</fixVersion>
                    <fixVersion>2.14.0</fixVersion>
                                    <component>camel-netty-http</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13875596" author="njiang" created="Sat, 18 Jan 2014 08:53:40 +0000"  >&lt;p&gt;Applied the patch into master and camel-2.12.x branches.&lt;/p&gt;</comment>
                            <comment id="13962225" author="joeluo" created="Mon, 7 Apr 2014 20:39:25 +0000"  >&lt;p&gt;Hi, Willem&lt;/p&gt;

&lt;p&gt;Apologies but I have to reopen this JIRA since the previous patch I provided caused a new problem. I&apos;ll attach a revised patch with a new junit test case to this ticket.&lt;/p&gt;

&lt;p&gt;Here is the code changes in NettyHttpEndpoint.java class:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;     &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void setHeaderFilterStrategy(HeaderFilterStrategy headerFilterStrategy) {
         &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.headerFilterStrategy = headerFilterStrategy;
+        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (getNettyHttpBinding() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
+            getNettyHttpBinding().setHeaderFilterStrategy(headerFilterStrategy);
+        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Basically it allows this method to modify NettyHttpComponent&apos;s member object &quot;nettyHttpBinding&quot; simply by setting a new headerFilterStrategy to it. As a result, the component&apos;s member object contains a different headerFilterStrategy rather than default one that created in component&apos;s default constructor. It is ok if we only have one netty http endpoint created. Otherwise, the next endpoint will be created with a non-default headerFilterStrategy that is from previous endpoint. &lt;/p&gt;

&lt;p&gt;The fix is quite simple: in this case, we should not touch component&apos;s nettyHttpBinding object at all. Instead, if we have configured a custom headerFilterStrategy on endpoint uri, we should create a new DefaultNettyHttpBinding object with the headerFilterStrategy for the current endpoint.&lt;/p&gt;

&lt;p&gt;I also reverted back some changes to initialize default NettyHttpConfiguration, NettyHttpHeaderFilterStrategy and DefaultNettyHttpBinding object in NettyHttpComponent&apos;s default constructor since it is reasonable to create them upfront for the component.&lt;/p&gt;</comment>
                            <comment id="13962980" author="njiang" created="Tue, 8 Apr 2014 13:36:59 +0000"  >&lt;p&gt;Applied the patch into camel master, camel-2.13.x and camel-2.12.x with thanks to Joe.&lt;br/&gt;
I also did some changes on the joe&apos;s patch to support setting the CustomDefaultNettyHttpBinding to the CamelNettyHttpComponent.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12623682" name="NettyHttpHeaderFilterBug.patch" size="3006" author="joeluo" created="Fri, 17 Jan 2014 17:21:16 +0000"/>
                            <attachment id="12639055" name="revised_patch.txt" size="7341" author="joeluo" created="Mon, 7 Apr 2014 20:39:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>368491</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 33 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12310041" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Patch Info</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10042"><![CDATA[Patch Available]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1rihj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>368795</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>