<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 09:59:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[CAMEL-6832] camel-qaurtz - Memory leak - when an exception is thrown during the scheduling phase</title>
                <link>https://issues.apache.org/jira/browse/CAMEL-6832</link>
                <project id="12311211" key="CAMEL">Camel</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I have observed a memory leak for Quartz worker thread in case an exception is thrown during&lt;br/&gt;
the scheduling phase when schedule is set to past time.&lt;br/&gt;
I have observed this issue with camel-quart 2.10.4, 2.11.0, 2.11.2 versions.&lt;/p&gt;

&lt;p&gt;For ex, assuming today is 4-Oct; If a schedule is provided for yesterday (i.e 3-Oct) then&lt;br/&gt;
below sequence happen:&lt;/p&gt;

&lt;p&gt;1. Quartz create worker thread for new schedule &lt;span class=&quot;error&quot;&gt;&amp;#91;generally TEN Threads with name &amp;#39;DefaultQuartzScheduler&amp;#39;&amp;#93;&lt;/span&gt;&lt;br/&gt;
2. Camel-quartz increment jobCounter for scheduler context &lt;span class=&quot;error&quot;&gt;&amp;#91;using QuartzComponent.incrementJobCounter()&amp;#93;&lt;/span&gt;&lt;br/&gt;
3. Camel-quartz tries to create new schedule &lt;span class=&quot;error&quot;&gt;&amp;#91;using Scheduler.scheduleJob()&amp;#93;&lt;/span&gt;&lt;br/&gt;
4. scheduleJob() throws SchedulerException with the message - &apos;Based on configured schedule,&lt;br/&gt;
the given trigger will never fire&apos;&lt;br/&gt;
5. Camel-quartz does NOT decrement the job counter and jobCounter value remains &apos;1&apos;&lt;br/&gt;
6. Later Camel-Quartz stops the route and call QuartzComponent.doStop()&lt;br/&gt;
7. In doStop(), Scheduler.shutdown() supposed to be called so that those TEN threads are&lt;br/&gt;
removed but to call shutdown() the pre-condition is that the jobCounter should be &apos;0&apos;.  In&lt;br/&gt;
this case jobCounter is &apos;1&apos; and Scheduler.shutdown() will NOT be called and those TEN threads&lt;br/&gt;
are NOT removed.  This is memory leak.&lt;/p&gt;

&lt;p&gt;Please find the stack trace in attachment &apos;memory_leak_scheduler_stack_trace.log&apos; [with Camel-Quartz 2.11.2 and org.apache.servicemix.bundles.quartz-1.8.6_1&lt;br/&gt;
which wrapped Quartz Scheduler as OSGi bundle] when SchedulerException is thrown at step&lt;br/&gt;
4 in above sequence.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Nurali&lt;/p&gt;</description>
                <environment>&lt;p&gt;OS - Windows 7 and Unix.  Server &#8211; OSGi equinox&lt;/p&gt;</environment>
        <key id="12672568">CAMEL-6832</key>
            <summary>camel-qaurtz - Memory leak - when an exception is thrown during the scheduling phase</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="davsclaus">Claus Ibsen</assignee>
                                    <reporter username="nurali.techie@yahoo.com">Nurali</reporter>
                        <labels>
                            <label>quartz</label>
                            <label>scheduler</label>
                    </labels>
                <created>Mon, 7 Oct 2013 02:58:47 +0000</created>
                <updated>Sat, 12 Oct 2013 10:19:10 +0000</updated>
                            <resolved>Sat, 12 Oct 2013 10:18:59 +0000</resolved>
                                    <version>2.10.4</version>
                    <version>2.11.0</version>
                    <version>2.11.2</version>
                                    <fixVersion>2.11.3</fixVersion>
                    <fixVersion>2.12.2</fixVersion>
                    <fixVersion>2.13.0</fixVersion>
                                    <component>camel-quartz</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13793321" author="davsclaus" created="Sat, 12 Oct 2013 10:18:59 +0000"  >&lt;p&gt;Thanks for reporting and providing the stacktrace.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12607122" name="memory_leak_scheduler_stack_trace.log" size="7156" author="nurali.techie@yahoo.com" created="Mon, 7 Oct 2013 03:01:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310060" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Estimated Complexity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10060"><![CDATA[Unknown]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>352191</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 6 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1oq07:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>352479</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        </customfields>
    </item>
</channel>
</rss>