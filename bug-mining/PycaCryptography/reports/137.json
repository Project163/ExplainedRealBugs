{"url":"https://api.github.com/repos/pyca/cryptography/issues/11037","repository_url":"https://api.github.com/repos/pyca/cryptography","labels_url":"https://api.github.com/repos/pyca/cryptography/issues/11037/labels{/name}","comments_url":"https://api.github.com/repos/pyca/cryptography/issues/11037/comments","events_url":"https://api.github.com/repos/pyca/cryptography/issues/11037/events","html_url":"https://github.com/pyca/cryptography/issues/11037","id":2323148512,"node_id":"I_kwDOALYunM6KeG7g","number":11037,"title":"NULL is not accepted as hash function parameters","user":{"login":"kajinamit","id":6630918,"node_id":"MDQ6VXNlcjY2MzA5MTg=","avatar_url":"https://avatars.githubusercontent.com/u/6630918?v=4","gravatar_id":"","url":"https://api.github.com/users/kajinamit","html_url":"https://github.com/kajinamit","followers_url":"https://api.github.com/users/kajinamit/followers","following_url":"https://api.github.com/users/kajinamit/following{/other_user}","gists_url":"https://api.github.com/users/kajinamit/gists{/gist_id}","starred_url":"https://api.github.com/users/kajinamit/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kajinamit/subscriptions","organizations_url":"https://api.github.com/users/kajinamit/orgs","repos_url":"https://api.github.com/users/kajinamit/repos","events_url":"https://api.github.com/users/kajinamit/events{/privacy}","received_events_url":"https://api.github.com/users/kajinamit/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2024-05-29T12:02:37Z","updated_at":"2024-08-28T03:04:01Z","closed_at":"2024-05-30T02:18:38Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I'm trying to use cryptography to load the VCEK (Versioned Chip Endorsement Key) certificate published by AMD but it consistently fails.\r\n\r\nContent of the certificate (PEM format):\r\n```\r\n-----BEGIN CERTIFICATE-----\r\nMIIFTTCCAvygAwIBAgIBADBGBgkqhkiG9w0BAQowOaAPMA0GCWCGSAFlAwQCAgUA\r\noRwwGgYJKoZIhvcNAQEIMA0GCWCGSAFlAwQCAgUAogMCATCjAwIBATB7MRQwEgYD\r\nVQQLDAtFbmdpbmVlcmluZzELMAkGA1UEBhMCVVMxFDASBgNVBAcMC1NhbnRhIENs\r\nYXJhMQswCQYDVQQIDAJDQTEfMB0GA1UECgwWQWR2YW5jZWQgTWljcm8gRGV2aWNl\r\nczESMBAGA1UEAwwJU0VWLU1pbGFuMB4XDTI0MDUyODA5NDAyOVoXDTMxMDUyODA5\r\nNDAyOVowejEUMBIGA1UECwwLRW5naW5lZXJpbmcxCzAJBgNVBAYTAlVTMRQwEgYD\r\nVQQHDAtTYW50YSBDbGFyYTELMAkGA1UECAwCQ0ExHzAdBgNVBAoMFkFkdmFuY2Vk\r\nIE1pY3JvIERldmljZXMxETAPBgNVBAMMCFNFVi1WQ0VLMHYwEAYHKoZIzj0CAQYF\r\nK4EEACIDYgAEtPdxxQ2pW3rYbNncrk9DPG7iJ+9Gj90i71F/oE3FiCr3l6rgnKKv\r\nzzEZVfQayvd3YbI+eiOSgBepoZoPftZf1Eb/eTWW4irg1QJYynmdmSkZN9v9g5oc\r\n+q1e+rcFJ+C5o4IBFzCCARMwEAYJKwYBBAGceAEBBAMCAQAwFwYJKwYBBAGceAEC\r\nBAoWCE1pbGFuLUIwMBEGCisGAQQBnHgBAwEEAwIBAjARBgorBgEEAZx4AQMCBAMC\r\nAQAwEQYKKwYBBAGceAEDBAQDAgEAMBEGCisGAQQBnHgBAwUEAwIBADARBgorBgEE\r\nAZx4AQMGBAMCAQAwEQYKKwYBBAGceAEDBwQDAgEAMBEGCisGAQQBnHgBAwMEAwIB\r\nBjASBgorBgEEAZx4AQMIBAQCAgDRME0GCSsGAQQBnHgBBARAdC0UfRi6ZfCRPZ5W\r\nFZYtt1vaJ1jr+mPf64EvkhO/TvZnzbJVsATWTiefZX5jIyj6ZBveaOvAzFZp8nnK\r\nF8ip/DBGBgkqhkiG9w0BAQowOaAPMA0GCWCGSAFlAwQCAgUAoRwwGgYJKoZIhvcN\r\nAQEIMA0GCWCGSAFlAwQCAgUAogMCATCjAwIBAQOCAgEARf/THBS0dZxZtXSYkS2s\r\nb7Qr9cXuFtPs7ZXZGFksslbXq162ihty+LfkPOPM8nnykSAPRqHvUQ55jarJXda4\r\n5bwPlYHWCnVjSjWplYWiTWz4p8/cWwoNyGvnSs2wIt7ZJDBclYQIW88h6XcPIjHx\r\n0MCcDUY2IFtaAPtCwJhV16Jylc1GkRmpTAf554ES/nzAfCSuOa0Bop1gz60SNzXq\r\nRlUIbGs8Fo9hB9S/jkYYsZq/1N6TNPPA0ES9/OgEQ+4i96cxE6jpiVqEps/Wm9YH\r\ndDPsdnbuUH2Mw/luUQ02Se0jKjPplqV/zHF6E1kBppoISN4J28xsWbE5+ZbKCAUO\r\nrDuwSv3uSuIgzy3f3euefsORGcNeMoHw2EZJsdZKAbSWIbgWBOz+SRoGgn9BRnet\r\nriE1m1Dbt7i3wkK7hsuRDuH4Ruqcy+K1Z0L2s6dqTfOS7I2C1bjQWO45TxuUo6b4\r\nK/foZqUQODdVXm+ASIzUKEEa2jDjyGczryRg38DSoAtci59drkTM2C5t/3RWPGdk\r\n02WqTjiEDShpOmdYWNcsEottnJuNZe1sk6dSaD61g+mdMMiT6SNODm3bjasCEaki\r\nZHQT5+03v0Z1/IXpEKeioDeK/O8e5nS6YDHNnKY0GfoMqxFYQTiAzD91/i01JrnJ\r\n+0lgIYFlg66h8A0nU9wQq98=\r\n-----END CERTIFICATE-----\r\n```\r\n\r\nThe (ugly) example code block to reproduce the failure:\r\n```\r\n>>> from cryptography import x509\r\n>>> data = open('vcek.pem', 'rb').read()\r\n>>> x509.load_pem_x509_certificate(data)\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nValueError: error parsing asn1 value: ParseError { kind: EncodedDefault, location: [\"Certificate::tbs_cert\", \"TbsCertificate::signature_alg\", \"AlgorithmIdentifier::params\", \"RsaPssParameters::_trailer_field\"] }\r\n```\r\n\r\nThe locations in the error indicate that NULL values(*) for hash function parameters are the problems.\r\n```\r\n    0:d=0  hl=4 l=1357 cons: SEQUENCE\r\n    4:d=1  hl=4 l= 764 cons:  SEQUENCE\r\n    8:d=2  hl=2 l=   3 cons:   cont [ 0 ]\r\n   10:d=3  hl=2 l=   1 prim:    INTEGER           :02\r\n   13:d=2  hl=2 l=   1 prim:   INTEGER           :00\r\n   16:d=2  hl=2 l=  70 cons:   SEQUENCE\r\n   18:d=3  hl=2 l=   9 prim:    OBJECT            :rsassaPss\r\n   29:d=3  hl=2 l=  57 cons:    SEQUENCE\r\n   31:d=4  hl=2 l=  15 cons:     cont [ 0 ]\r\n   33:d=5  hl=2 l=  13 cons:      SEQUENCE\r\n   35:d=6  hl=2 l=   9 prim:       OBJECT            :sha384\r\n   46:d=6  hl=2 l=   0 prim:       NULL <========(*)\r\n   48:d=4  hl=2 l=  28 cons:     cont [ 1 ]\r\n   50:d=5  hl=2 l=  26 cons:      SEQUENCE\r\n   52:d=6  hl=2 l=   9 prim:       OBJECT            :mgf1\r\n   63:d=6  hl=2 l=  13 cons:       SEQUENCE\r\n   65:d=7  hl=2 l=   9 prim:        OBJECT            :sha384\r\n   76:d=7  hl=2 l=   0 prim:        NULL <========(*)\r\n   78:d=4  hl=2 l=   3 cons:     cont [ 2 ]\r\n   80:d=5  hl=2 l=   1 prim:      INTEGER           :30\r\n   83:d=4  hl=2 l=   3 cons:     cont [ 3 ]\r\n   85:d=5  hl=2 l=   1 prim:      INTEGER           :01\r\n```\r\n\r\nHowever according to RFC, NULL should be accepted.\r\n\r\nhttps://datatracker.ietf.org/doc/html/rfc5758#section-2\r\n```\r\n   When one of these OIDs appears in an AlgorithmIdentifier, all\r\n   implementations MUST accept both NULL and absent parameters as legal\r\n   and equivalent encodings.\r\n```\r\n\r\nVersion infromation\r\n* Python 3.10.12 (built-in version in Ubuntu 22.04)\r\n* cryptography 42.0.7 (installed by pip)\r\n* pip 22.0.2\r\n* setuptools 59.6.0\r\n\r\nThe issue is not reproduced with cryptography 40.0.2 , but is reproduced with cryptography 41.0.7. So I suspect this is the regression in cryptography 41.0.0 (A similar problem was reported in https://github.com/pyca/cryptography/issues/9253 )","closed_by":{"login":"reaperhulk","id":161495,"node_id":"MDQ6VXNlcjE2MTQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/161495?v=4","gravatar_id":"","url":"https://api.github.com/users/reaperhulk","html_url":"https://github.com/reaperhulk","followers_url":"https://api.github.com/users/reaperhulk/followers","following_url":"https://api.github.com/users/reaperhulk/following{/other_user}","gists_url":"https://api.github.com/users/reaperhulk/gists{/gist_id}","starred_url":"https://api.github.com/users/reaperhulk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reaperhulk/subscriptions","organizations_url":"https://api.github.com/users/reaperhulk/orgs","repos_url":"https://api.github.com/users/reaperhulk/repos","events_url":"https://api.github.com/users/reaperhulk/events{/privacy}","received_events_url":"https://api.github.com/users/reaperhulk/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pyca/cryptography/issues/11037/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyca/cryptography/issues/11037/timeline","performed_via_github_app":null,"state_reason":"completed"}