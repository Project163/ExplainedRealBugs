{"url":"https://api.github.com/repos/pyca/cryptography/issues/6804","repository_url":"https://api.github.com/repos/pyca/cryptography","labels_url":"https://api.github.com/repos/pyca/cryptography/issues/6804/labels{/name}","comments_url":"https://api.github.com/repos/pyca/cryptography/issues/6804/comments","events_url":"https://api.github.com/repos/pyca/cryptography/issues/6804/events","html_url":"https://github.com/pyca/cryptography/issues/6804","id":1098286685,"node_id":"I_kwDOALYunM5BdoZd","number":6804,"title":"ValueError: error parsing asn1 value: ParseError when handling Cert with Unicode Chars","user":{"login":"BeryJu","id":1932513,"node_id":"MDQ6VXNlcjE5MzI1MTM=","avatar_url":"https://avatars.githubusercontent.com/u/1932513?v=4","gravatar_id":"","url":"https://api.github.com/users/BeryJu","html_url":"https://github.com/BeryJu","followers_url":"https://api.github.com/users/BeryJu/followers","following_url":"https://api.github.com/users/BeryJu/following{/other_user}","gists_url":"https://api.github.com/users/BeryJu/gists{/gist_id}","starred_url":"https://api.github.com/users/BeryJu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BeryJu/subscriptions","organizations_url":"https://api.github.com/users/BeryJu/orgs","repos_url":"https://api.github.com/users/BeryJu/repos","events_url":"https://api.github.com/users/BeryJu/events{/privacy}","received_events_url":"https://api.github.com/users/BeryJu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":198687536,"node_id":"MDU6TGFiZWwxOTg2ODc1MzY=","url":"https://api.github.com/repos/pyca/cryptography/labels/x509","name":"x509","color":"fef2c0","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/pyca/cryptography/milestones/39","html_url":"https://github.com/pyca/cryptography/milestone/39","labels_url":"https://api.github.com/repos/pyca/cryptography/milestones/39/labels","id":7308423,"node_id":"MI_kwDOALYunM4Ab4SH","number":39,"title":"Thirty Seventh Release","description":"","creator":{"login":"reaperhulk","id":161495,"node_id":"MDQ6VXNlcjE2MTQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/161495?v=4","gravatar_id":"","url":"https://api.github.com/users/reaperhulk","html_url":"https://github.com/reaperhulk","followers_url":"https://api.github.com/users/reaperhulk/followers","following_url":"https://api.github.com/users/reaperhulk/following{/other_user}","gists_url":"https://api.github.com/users/reaperhulk/gists{/gist_id}","starred_url":"https://api.github.com/users/reaperhulk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reaperhulk/subscriptions","organizations_url":"https://api.github.com/users/reaperhulk/orgs","repos_url":"https://api.github.com/users/reaperhulk/repos","events_url":"https://api.github.com/users/reaperhulk/events{/privacy}","received_events_url":"https://api.github.com/users/reaperhulk/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":28,"state":"closed","created_at":"2021-10-31T03:37:49Z","updated_at":"2022-04-26T15:25:12Z","due_on":null,"closed_at":"2022-04-26T15:25:12Z"},"comments":14,"created_at":"2022-01-10T19:28:04Z","updated_at":"2022-06-01T00:01:36Z","closed_at":"2022-02-07T03:42:59Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Source issue: https://github.com/goauthentik/authentik/issues/2082\r\n\r\nWhen loading a certificate with Umlauts in issuer and subject, and attempting to do anything with it, an error is raised.\r\n\r\nExpected values from `openssl x509 -in cert.pem -text -noout`:\r\n```\r\n[...]\r\n        Issuer: CN=Internal-CA, C=FR, ST=Auvergne-Rh\\xF4ne-Alpes, L=Saint-Marcellin, O=Giordana Home\r\n        Validity\r\n            Not Before: Jan  9 22:42:51 2022 GMT\r\n            Not After : Jan 11 22:42:51 2023 GMT\r\n        Subject: CN=authentik.company, C=FR, ST=Unicode \\xF4, L=city, O=org\r\n[...]\r\n```\r\n\r\nWhen loading with cryptography (all versions should be visible below):\r\n\r\n```\r\n❯ docker run -it --rm --entrypoint /bin/bash docker.io/python:3.10.1-slim-bullseye\r\nroot@7251b805458d:/# pip install -U pip setuptools\r\nRequirement already satisfied: pip in /usr/local/lib/python3.10/site-packages (21.2.4)\r\nCollecting pip\r\n  Downloading pip-21.3.1-py3-none-any.whl (1.7 MB)\r\n     |████████████████████████████████| 1.7 MB 2.8 MB/s\r\nRequirement already satisfied: setuptools in /usr/local/lib/python3.10/site-packages (57.5.0)\r\nCollecting setuptools\r\n  Downloading setuptools-60.5.0-py3-none-any.whl (958 kB)\r\n     |████████████████████████████████| 958 kB 5.6 MB/s\r\nInstalling collected packages: setuptools, pip\r\n  Attempting uninstall: setuptools\r\n    Found existing installation: setuptools 57.5.0\r\n    Uninstalling setuptools-57.5.0:\r\n      Successfully uninstalled setuptools-57.5.0\r\n  Attempting uninstall: pip\r\n    Found existing installation: pip 21.2.4\r\n    Uninstalling pip-21.2.4:\r\n      Successfully uninstalled pip-21.2.4\r\nSuccessfully installed pip-21.3.1 setuptools-60.5.0\r\nWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\r\nroot@7251b805458d:/# pip install cryptography\r\nCollecting cryptography\r\n  Downloading cryptography-36.0.1-cp36-abi3-manylinux_2_17_aarch64.manylinux2014_aarch64.manylinux_2_24_aarch64.whl (3.3 MB)\r\n     |████████████████████████████████| 3.3 MB 3.0 MB/s\r\nCollecting cffi>=1.12\r\n  Downloading cffi-1.15.0-cp310-cp310-manylinux_2_17_aarch64.manylinux2014_aarch64.whl (448 kB)\r\n     |████████████████████████████████| 448 kB 7.5 MB/s\r\nCollecting pycparser\r\n  Downloading pycparser-2.21-py2.py3-none-any.whl (118 kB)\r\n     |████████████████████████████████| 118 kB 6.5 MB/s\r\nInstalling collected packages: pycparser, cffi, cryptography\r\nSuccessfully installed cffi-1.15.0 cryptography-36.0.1 pycparser-2.21\r\nWARNING: Running pip as the 'root' user can result in broken permissions and conflicting behaviour with the system package manager. It is recommended to use a virtual environment instead: https://pip.pypa.io/warnings/venv\r\nroot@7251b805458d:/# python\r\nPython 3.10.1 (main, Dec 21 2021, 06:25:50) [GCC 10.2.1 20210110] on linux\r\nType \"help\", \"copyright\", \"credits\" or \"license\" for more information.\r\n>>> cert = \"\"\"-----BEGIN CERTIFICATE-----\r\n... MIIFtjCCA56gAwIBAgIBGzANBgkqhkiG9w0BAQsFADB0MRQwEgYDVQQDEwtJbnRl\r\n... cm5hbC1DQTELMAkGA1UEBhMCRlIxHTAbBgNVBAgUFEF1dmVyZ25lLVJo9G5lLUFs\r\n... cGVzMRgwFgYDVQQHEw9TYWludC1NYXJjZWxsaW4xFjAUBgNVBAoTDUdpb3JkYW5h\r\n... IEhvbWUwHhcNMjIwMTA5MjI0MjUxWhcNMjMwMTExMjI0MjUxWjBaMRowGAYDVQQD\r\n... ExFhdXRoZW50aWsuY29tcGFueTELMAkGA1UEBhMCRlIxEjAQBgNVBAgUCVVuaWNv\r\n... ZGUg9DENMAsGA1UEBxMEY2l0eTEMMAoGA1UEChMDb3JnMIIBIjANBgkqhkiG9w0B\r\n... AQEFAAOCAQ8AMIIBCgKCAQEAxj9t6OM7y5hbpnhxhUVh8A0yXNB7v8kx2Bb/dC32\r\n... QBSJGNXG2p0bYfOc4dlQj6Es4ocrqZchxnwRblgmhknomCwPlPUsXGqW+7/pUGf6\r\n... CyZYroQdLLX8KzdrrPFNljBkuxBgH+3D2G367C6GWPIvOY2jalgAs7lKY3UnsuEg\r\n... utSmcFss+TnkkMFtrBTQNVEZsHIAer9QUcMI07R0OrRh/iaEBc8LEKTvBBYKKtsT\r\n... JFMcU5M1DeLS4VoQpHMmtFw0rZZGZhUV0G+alNqUFHKDXZeZoMlzZqsGEZdgxAYa\r\n... rUFAvLN44E42LbpheuX7/2TNeL84VZ508hF7hKv8WXN37wIDAQABo4IBazCCAWcw\r\n... CQYDVR0TBAIwADARBglghkgBhvhCAQEEBAMCBkAwCwYDVR0PBAQDAgWgMDMGCWCG\r\n... SAGG+EIBDQQmFiRPcGVuU1NMIEdlbmVyYXRlZCBTZXJ2ZXIgQ2VydGlmaWNhdGUw\r\n... HQYDVR0OBBYEFKgMqYm+NouE7fkE1Wl/KuXIXm/5MIGeBgNVHSMEgZYwgZOAFJsm\r\n... iWncuuPunTPxo8BPisp8XrvmoXikdjB0MRQwEgYDVQQDEwtJbnRlcm5hbC1DQTEL\r\n... MAkGA1UEBhMCRlIxHTAbBgNVBAgUFEF1dmVyZ25lLVJo9G5lLUFscGVzMRgwFgYD\r\n... VQQHEw9TYWludC1NYXJjZWxsaW4xFjAUBgNVBAoTDUdpb3JkYW5hIEhvbWWCAQAw\r\n... JwYDVR0lBCAwHgYIKwYBBQUHAwEGCCsGAQUFBwMCBggrBgEFBQgCAjAcBgNVHREE\r\n... FTATghFhdXRoZW50aWsuY29tcGFueTANBgkqhkiG9w0BAQsFAAOCAgEAHZjk6KrP\r\n... 744Xlk8ykreJ4fiQE9EiVgR8aoE7eKk21xX3HJaeU2fq9voxTn85drGUMNlG7NrR\r\n... CNaiAZCwqEy7fV264QRLCOz7p0hx7x4eDQnFd2PuQNstB34jzR8UBHVPREkxdGn8\r\n... QNxN9i4CMOT2oc0mpF6+gWdf/y1a3VgbAgvvVLa27bkkCjSy5HIyErrZG2Qt+hmf\r\n... EvMH1u4lQgffLbDhWeWNd7qFG+zKp78VAvZxbVEjEfMhWbTXz1iIzXY+Anq6mOP2\r\n... K/I8xF6urlnBCSmVgaeMoXKZnFq5FGxC9sSyp6TP8GnTsy5+zP9lZFLpFdnh7fw5\r\n... xc06Uz2Gj6gZnogngh1eVOeS92LRuUP32kb2m+DNPSkBH4+5EIC90c21GcDEpS1U\r\n... DVlSJe3m0yS+3SXWNp8U/M0UYTMEwDGW5KR0y3PJ5YM32jW0TErO25DteA1fe7VS\r\n... 9mD3+2cPwrbaPXH6vhNBi5xzZnsiAeOP6Wx4hbElviHWVee00kD5+FnUBp7FMq4E\r\n... iryTkKlMbqVJLTs4H6sc5Ov2BRCcAa/3RuPhkK+apQz6VyTZLoePz5nVvUdF7mvg\r\n... LSgCKfDU2kNCMas0OzuZk145WxAnAl2ZTty2PyqgK2Hfeill++j31Of9voUQLCIe\r\n... iNBmQCLvdE1eBC8zsGsZbG2D4/IlOoRDnkw=\r\n... -----END CERTIFICATE-----\r\n... \"\"\"\r\n>>> from cryptography.x509 import load_pem_x509_certificate\r\n>>> from cryptography.hazmat.backends import default_backend\r\n>>>\r\n>>> load_pem_x509_certificate(cert.encode(), default_backend())\r\nTraceback (most recent call last):\r\n  File \"<stdin>\", line 1, in <module>\r\nValueError: error parsing asn1 value: ParseError { kind: InvalidValue }\r\n>>>\r\n```\r\n\r\nMind you, after some more testing, I can successfully load the certificate when I assign it to a variable, but afterwards calling anything on that variable will cause the same error.","closed_by":{"login":"reaperhulk","id":161495,"node_id":"MDQ6VXNlcjE2MTQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/161495?v=4","gravatar_id":"","url":"https://api.github.com/users/reaperhulk","html_url":"https://github.com/reaperhulk","followers_url":"https://api.github.com/users/reaperhulk/followers","following_url":"https://api.github.com/users/reaperhulk/following{/other_user}","gists_url":"https://api.github.com/users/reaperhulk/gists{/gist_id}","starred_url":"https://api.github.com/users/reaperhulk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reaperhulk/subscriptions","organizations_url":"https://api.github.com/users/reaperhulk/orgs","repos_url":"https://api.github.com/users/reaperhulk/repos","events_url":"https://api.github.com/users/reaperhulk/events{/privacy}","received_events_url":"https://api.github.com/users/reaperhulk/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pyca/cryptography/issues/6804/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyca/cryptography/issues/6804/timeline","performed_via_github_app":null,"state_reason":"completed"}