{"url":"https://api.github.com/repos/pyca/cryptography/issues/11450","repository_url":"https://api.github.com/repos/pyca/cryptography","labels_url":"https://api.github.com/repos/pyca/cryptography/issues/11450/labels{/name}","comments_url":"https://api.github.com/repos/pyca/cryptography/issues/11450/comments","events_url":"https://api.github.com/repos/pyca/cryptography/issues/11450/events","html_url":"https://github.com/pyca/cryptography/issues/11450","id":2472111718,"node_id":"I_kwDOALYunM6TWW5m","number":11450,"title":"OpenSSL legacy provider isn't always installed on Debian unstable","user":{"login":"cjwatson","id":2429141,"node_id":"MDQ6VXNlcjI0MjkxNDE=","avatar_url":"https://avatars.githubusercontent.com/u/2429141?v=4","gravatar_id":"","url":"https://api.github.com/users/cjwatson","html_url":"https://github.com/cjwatson","followers_url":"https://api.github.com/users/cjwatson/followers","following_url":"https://api.github.com/users/cjwatson/following{/other_user}","gists_url":"https://api.github.com/users/cjwatson/gists{/gist_id}","starred_url":"https://api.github.com/users/cjwatson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cjwatson/subscriptions","organizations_url":"https://api.github.com/users/cjwatson/orgs","repos_url":"https://api.github.com/users/cjwatson/repos","events_url":"https://api.github.com/users/cjwatson/events{/privacy}","received_events_url":"https://api.github.com/users/cjwatson/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":49,"created_at":"2024-08-18T19:27:53Z","updated_at":"2025-06-16T03:29:30Z","closed_at":"2025-03-17T14:13:50Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"This is an attempt to get a conversation started.  I wasn't responsible for the original change here, but I've been cleaning up after it in Debian's Python team and I'm not convinced my current approach is really ideal.\r\n\r\nThe OpenSSL packages in Debian unstable recently [changed](https://bugs.debian.org/965041) to move the legacy provider into a separate package, `openssl-provider-legacy`.  There's a `Recommends` relationship from the main library package (`libssl3t64`) which means that it's installed on typical user systems, but it's not a `Depends` so it's now possible for users not to have the legacy provider installed.  In particular, `Recommends` are not normally installed in package builds and automatic test environments (deliberately, to ensure that declared dependencies are sufficient), and as a result we find ourselves having to apply workarounds to a fairly large number of Python packages in Debian to get their tests working again.\r\n\r\nI'd like to find out what approach you'd recommend here.  I can think of a bunch of possibilities:\r\n\r\n* Just set `CRYPTOGRAPHY_OPENSSL_NO_LEGACY=1` in the Debian build rules for lots of Python packages (this is pretty much what I'm doing at the moment, but it's repetitive)\r\n* Make affected Python packages in Debian depend/build-depend on `openssl-provider-legacy` (also repetitive and feels heavy-handed)\r\n* Make Debian's `python3-cryptography` package depend on `openssl-provider-legacy`\r\n* Effectively revert the Debian OpenSSL packaging change (perhaps just by upgrading the `Recommends` to `Depends`)\r\n* Change the logic in `cryptography/src/rust/src/lib.rs` in some way\r\n* Something else I haven't thought of\r\n\r\nDo you have any opinions on this?  Ideally I wouldn't be passing messages back and forward, so I'll see if I can get Debian's OpenSSL maintainers to show up on this issue.","closed_by":{"login":"reaperhulk","id":161495,"node_id":"MDQ6VXNlcjE2MTQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/161495?v=4","gravatar_id":"","url":"https://api.github.com/users/reaperhulk","html_url":"https://github.com/reaperhulk","followers_url":"https://api.github.com/users/reaperhulk/followers","following_url":"https://api.github.com/users/reaperhulk/following{/other_user}","gists_url":"https://api.github.com/users/reaperhulk/gists{/gist_id}","starred_url":"https://api.github.com/users/reaperhulk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reaperhulk/subscriptions","organizations_url":"https://api.github.com/users/reaperhulk/orgs","repos_url":"https://api.github.com/users/reaperhulk/repos","events_url":"https://api.github.com/users/reaperhulk/events{/privacy}","received_events_url":"https://api.github.com/users/reaperhulk/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pyca/cryptography/issues/11450/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyca/cryptography/issues/11450/timeline","performed_via_github_app":null,"state_reason":"completed"}