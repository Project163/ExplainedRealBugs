{"url":"https://api.github.com/repos/pyca/cryptography/issues/7005","repository_url":"https://api.github.com/repos/pyca/cryptography","labels_url":"https://api.github.com/repos/pyca/cryptography/issues/7005/labels{/name}","comments_url":"https://api.github.com/repos/pyca/cryptography/issues/7005/comments","events_url":"https://api.github.com/repos/pyca/cryptography/issues/7005/events","html_url":"https://github.com/pyca/cryptography/issues/7005","id":1182455703,"node_id":"I_kwDOALYunM5GeteX","number":7005,"title":"Invalid ecdsa certificate can trigger \"cryptography.exceptions.InternalError: Unknown OpenSSL error.\"","user":{"login":"hannob","id":990588,"node_id":"MDQ6VXNlcjk5MDU4OA==","avatar_url":"https://avatars.githubusercontent.com/u/990588?v=4","gravatar_id":"","url":"https://api.github.com/users/hannob","html_url":"https://github.com/hannob","followers_url":"https://api.github.com/users/hannob/followers","following_url":"https://api.github.com/users/hannob/following{/other_user}","gists_url":"https://api.github.com/users/hannob/gists{/gist_id}","starred_url":"https://api.github.com/users/hannob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hannob/subscriptions","organizations_url":"https://api.github.com/users/hannob/orgs","repos_url":"https://api.github.com/users/hannob/repos","events_url":"https://api.github.com/users/hannob/events{/privacy}","received_events_url":"https://api.github.com/users/hannob/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":83603179,"node_id":"MDU6TGFiZWw4MzYwMzE3OQ==","url":"https://api.github.com/repos/pyca/cryptography/labels/bugs","name":"bugs","color":"e11d21","default":false,"description":null}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/pyca/cryptography/milestones/39","html_url":"https://github.com/pyca/cryptography/milestone/39","labels_url":"https://api.github.com/repos/pyca/cryptography/milestones/39/labels","id":7308423,"node_id":"MI_kwDOALYunM4Ab4SH","number":39,"title":"Thirty Seventh Release","description":"","creator":{"login":"reaperhulk","id":161495,"node_id":"MDQ6VXNlcjE2MTQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/161495?v=4","gravatar_id":"","url":"https://api.github.com/users/reaperhulk","html_url":"https://github.com/reaperhulk","followers_url":"https://api.github.com/users/reaperhulk/followers","following_url":"https://api.github.com/users/reaperhulk/following{/other_user}","gists_url":"https://api.github.com/users/reaperhulk/gists{/gist_id}","starred_url":"https://api.github.com/users/reaperhulk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reaperhulk/subscriptions","organizations_url":"https://api.github.com/users/reaperhulk/orgs","repos_url":"https://api.github.com/users/reaperhulk/repos","events_url":"https://api.github.com/users/reaperhulk/events{/privacy}","received_events_url":"https://api.github.com/users/reaperhulk/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":28,"state":"closed","created_at":"2021-10-31T03:37:49Z","updated_at":"2022-04-26T15:25:12Z","due_on":null,"closed_at":"2022-04-26T15:25:12Z"},"comments":3,"created_at":"2022-03-27T09:09:31Z","updated_at":"2022-07-02T00:01:07Z","closed_at":"2022-04-02T01:40:36Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Trying to access the public numbers of an ECDSA key where the public key is \"0\" (which I believe is the encoding for point at infinity, it's not a valid key, but one can of course encode such a key) causes an InternalError. Based on the error output I believe this is not supposed to happen.\r\n\r\nSuch a key is part of OpenSSL's test suite:\r\nhttps://github.com/openssl/openssl/blob/master/test/recipes/91-test_pkey_check_data/ec_p256_bad_0.pem\r\n\r\nreproducer:\r\n```\r\n#!/usr/bin/python3\r\n\r\nfrom cryptography.hazmat.primitives.serialization import load_pem_private_key\r\n\r\nprivkey = \"\"\"-----BEGIN PRIVATE KEY-----\r\nMEECAQAwEwYHKoZIzj0CAQYIKoZIzj0DAQcEJzAlAgEBBCD/////AAAAAP//////\r\n////vOb6racXnoTzucrC/GMlUQ==\r\n-----END PRIVATE KEY-----\"\"\"\r\n\r\npk = load_pem_private_key(privkey.encode(), password=None)\r\n\r\nprint(pk.public_key().public_numbers())\r\n```\r\n\r\nException message:\r\n```\r\ncryptography.exceptions.InternalError: Unknown OpenSSL error. This error is commonly encountered when another library is not cleaning up the OpenSSL error stack. If you are using cryptography with another library that uses OpenSSL try disabling it before reporting a bug. Otherwise please file an issue at https://github.com/pyca/cryptography/issues with information on how to reproduce this. ([_OpenSSLErrorWithText(code=269635690, lib=16, reason=106, reason_text=b'error:1012506A:elliptic curve routines:EC_POINT_get_affine_coordinates:point at infinity')])\r\n```","closed_by":{"login":"reaperhulk","id":161495,"node_id":"MDQ6VXNlcjE2MTQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/161495?v=4","gravatar_id":"","url":"https://api.github.com/users/reaperhulk","html_url":"https://github.com/reaperhulk","followers_url":"https://api.github.com/users/reaperhulk/followers","following_url":"https://api.github.com/users/reaperhulk/following{/other_user}","gists_url":"https://api.github.com/users/reaperhulk/gists{/gist_id}","starred_url":"https://api.github.com/users/reaperhulk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reaperhulk/subscriptions","organizations_url":"https://api.github.com/users/reaperhulk/orgs","repos_url":"https://api.github.com/users/reaperhulk/repos","events_url":"https://api.github.com/users/reaperhulk/events{/privacy}","received_events_url":"https://api.github.com/users/reaperhulk/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pyca/cryptography/issues/7005/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyca/cryptography/issues/7005/timeline","performed_via_github_app":null,"state_reason":"completed"}