{"url":"https://api.github.com/repos/pyca/cryptography/issues/12746","repository_url":"https://api.github.com/repos/pyca/cryptography","labels_url":"https://api.github.com/repos/pyca/cryptography/issues/12746/labels{/name}","comments_url":"https://api.github.com/repos/pyca/cryptography/issues/12746/comments","events_url":"https://api.github.com/repos/pyca/cryptography/issues/12746/events","html_url":"https://github.com/pyca/cryptography/issues/12746","id":2981838137,"node_id":"I_kwDOALYunM6xuz05","number":12746,"title":"cryptography.exceptions.InternalError when importing malformed / too large ed25519 key","user":{"login":"hannob","id":990588,"node_id":"MDQ6VXNlcjk5MDU4OA==","avatar_url":"https://avatars.githubusercontent.com/u/990588?v=4","gravatar_id":"","url":"https://api.github.com/users/hannob","html_url":"https://github.com/hannob","followers_url":"https://api.github.com/users/hannob/followers","following_url":"https://api.github.com/users/hannob/following{/other_user}","gists_url":"https://api.github.com/users/hannob/gists{/gist_id}","starred_url":"https://api.github.com/users/hannob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hannob/subscriptions","organizations_url":"https://api.github.com/users/hannob/orgs","repos_url":"https://api.github.com/users/hannob/repos","events_url":"https://api.github.com/users/hannob/events{/privacy}","received_events_url":"https://api.github.com/users/hannob/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2025-04-09T07:23:06Z","updated_at":"2025-07-09T03:29:55Z","closed_at":"2025-04-09T13:36:07Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Trying to import a malformed ed25519 key which has too many bits leads to this:\n```\ncryptography.exceptions.InternalError: Unknown OpenSSL error. This error is commonly encountered\n                    when another library is not cleaning up the OpenSSL error\n                    stack. If you are using cryptography with another library\n                    that uses OpenSSL try disabling it before reporting a bug.\n                    Otherwise please file an issue at\n                    https://github.com/pyca/cryptography/issues with\n                    information on how to reproduce this. (error:030000B4:digital envelope routines:new_raw_key_int:key setup failed:../openssl-3.4.1/crypto/evp/p_lib.c:437:)\n```\n\nThis should cause a clean error (probably a ValueError).\n\nPoC:\n```\n#!/usr/bin/python3\nfrom cryptography.hazmat.primitives.serialization import load_pem_public_key\n\nload_pem_public_key(b\"\"\"-----BEGIN PUBLIC KEY-----\nMCswBQYDK2VwAyIA////////////////////////////////////////////\n-----END PUBLIC KEY-----\n\"\"\")\n```","closed_by":{"login":"reaperhulk","id":161495,"node_id":"MDQ6VXNlcjE2MTQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/161495?v=4","gravatar_id":"","url":"https://api.github.com/users/reaperhulk","html_url":"https://github.com/reaperhulk","followers_url":"https://api.github.com/users/reaperhulk/followers","following_url":"https://api.github.com/users/reaperhulk/following{/other_user}","gists_url":"https://api.github.com/users/reaperhulk/gists{/gist_id}","starred_url":"https://api.github.com/users/reaperhulk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reaperhulk/subscriptions","organizations_url":"https://api.github.com/users/reaperhulk/orgs","repos_url":"https://api.github.com/users/reaperhulk/repos","events_url":"https://api.github.com/users/reaperhulk/events{/privacy}","received_events_url":"https://api.github.com/users/reaperhulk/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pyca/cryptography/issues/12746/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyca/cryptography/issues/12746/timeline","performed_via_github_app":null,"state_reason":"completed"}