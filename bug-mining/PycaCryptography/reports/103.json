{"url":"https://api.github.com/repos/pyca/cryptography/issues/7513","repository_url":"https://api.github.com/repos/pyca/cryptography","labels_url":"https://api.github.com/repos/pyca/cryptography/issues/7513/labels{/name}","comments_url":"https://api.github.com/repos/pyca/cryptography/issues/7513/comments","events_url":"https://api.github.com/repos/pyca/cryptography/issues/7513/events","html_url":"https://github.com/pyca/cryptography/issues/7513","id":1339387799,"node_id":"I_kwDOALYunM5P1W-X","number":7513,"title":"x509.Name.from_rfc4514_string not strictly compliant with RFC 4514","user":{"login":"axmachado","id":1927177,"node_id":"MDQ6VXNlcjE5MjcxNzc=","avatar_url":"https://avatars.githubusercontent.com/u/1927177?v=4","gravatar_id":"","url":"https://api.github.com/users/axmachado","html_url":"https://github.com/axmachado","followers_url":"https://api.github.com/users/axmachado/followers","following_url":"https://api.github.com/users/axmachado/following{/other_user}","gists_url":"https://api.github.com/users/axmachado/gists{/gist_id}","starred_url":"https://api.github.com/users/axmachado/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/axmachado/subscriptions","organizations_url":"https://api.github.com/users/axmachado/orgs","repos_url":"https://api.github.com/users/axmachado/repos","events_url":"https://api.github.com/users/axmachado/events{/privacy}","received_events_url":"https://api.github.com/users/axmachado/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2022-08-15T19:19:51Z","updated_at":"2022-11-15T00:01:19Z","closed_at":"2022-08-16T19:57:36Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"According with section 2.1 of the RFC:\r\n\r\n~~~txt\r\n[2.1].  Converting the RDNSequence\r\n\r\n   If the RDNSequence is an empty sequence, the result is the empty or\r\n   zero-length string.\r\n\r\n   Otherwise, the output consists of the string encodings of each\r\n   RelativeDistinguishedName in the RDNSequence (according to Section 2.2), \r\n   starting with the last element of the sequence and moving\r\n   backwards toward the first.\r\n\r\n   The encodings of adjoining RelativeDistinguishedNames are separated\r\n   by a comma (',' U+002C) character.\r\n~~~\r\n\r\nThe `rfc4514_string` method is doing it right, reversing the order of the RDNs from the sequence that makes the Name, but the parser is not reversing it back when constructing the sequence. \r\n\r\nThe side effect of it is evidenced on the code fragment:\r\n\r\n~~~python\r\nfrom cryptography import x509\r\n\r\ncomponents = [\r\n    x509.NameAttribute(x509.NameOID.COUNTRY_NAME, 'BR'),\r\n    x509.NameAttribute(x509.NameOID.ORGANIZATION_NAME, 'Test Organization'),\r\n    x509.NameAttribute(x509.NameOID.ORGANIZATIONAL_UNIT_NAME, 'TEST OU 1'),\r\n    x509.NameAttribute(x509.NameOID.ORGANIZATIONAL_UNIT_NAME, 'Test OU 2'),\r\n    x509.NameAttribute(x509.NameOID.LOCALITY_NAME, 'Test City'),\r\n    x509.NameAttribute(x509.NameOID.COMMON_NAME, 'Test Name')\r\n]\r\n\r\nname1 = x509.Name(components)\r\nname1_string = name1.rfc4514_string()\r\nname3 = x509.Name.from_rfc4514_string(name2.rfc4514_string())\r\n\r\nif name1 != name2:\r\n    print('Error... should be the same name')\r\nif name1 == name3:\r\n    print('Now we have the same name')\r\n~~~\r\n\r\nI just cloned the main repository and will send a pull request later today with the fix.\r\n\r\n* Python 3.10.5\r\n* cffi==1.15.1\r\n* pip 22.2.2\r\n* cryptography==37.0.4\r\n* ","closed_by":{"login":"reaperhulk","id":161495,"node_id":"MDQ6VXNlcjE2MTQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/161495?v=4","gravatar_id":"","url":"https://api.github.com/users/reaperhulk","html_url":"https://github.com/reaperhulk","followers_url":"https://api.github.com/users/reaperhulk/followers","following_url":"https://api.github.com/users/reaperhulk/following{/other_user}","gists_url":"https://api.github.com/users/reaperhulk/gists{/gist_id}","starred_url":"https://api.github.com/users/reaperhulk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reaperhulk/subscriptions","organizations_url":"https://api.github.com/users/reaperhulk/orgs","repos_url":"https://api.github.com/users/reaperhulk/repos","events_url":"https://api.github.com/users/reaperhulk/events{/privacy}","received_events_url":"https://api.github.com/users/reaperhulk/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pyca/cryptography/issues/7513/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyca/cryptography/issues/7513/timeline","performed_via_github_app":null,"state_reason":"completed"}