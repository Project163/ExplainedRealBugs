{"url":"https://api.github.com/repos/pyca/cryptography/issues/13050","repository_url":"https://api.github.com/repos/pyca/cryptography","labels_url":"https://api.github.com/repos/pyca/cryptography/issues/13050/labels{/name}","comments_url":"https://api.github.com/repos/pyca/cryptography/issues/13050/comments","events_url":"https://api.github.com/repos/pyca/cryptography/issues/13050/events","html_url":"https://github.com/pyca/cryptography/issues/13050","id":3126712629,"node_id":"I_kwDOALYunM66Xdk1","number":13050,"title":"Internal openssl error with too small DH key","user":{"login":"hannob","id":990588,"node_id":"MDQ6VXNlcjk5MDU4OA==","avatar_url":"https://avatars.githubusercontent.com/u/990588?v=4","gravatar_id":"","url":"https://api.github.com/users/hannob","html_url":"https://github.com/hannob","followers_url":"https://api.github.com/users/hannob/followers","following_url":"https://api.github.com/users/hannob/following{/other_user}","gists_url":"https://api.github.com/users/hannob/gists{/gist_id}","starred_url":"https://api.github.com/users/hannob/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/hannob/subscriptions","organizations_url":"https://api.github.com/users/hannob/orgs","repos_url":"https://api.github.com/users/hannob/repos","events_url":"https://api.github.com/users/hannob/events{/privacy}","received_events_url":"https://api.github.com/users/hannob/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2025-06-07T08:30:35Z","updated_at":"2025-11-07T03:23:23Z","closed_at":"2025-08-08T22:03:46Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Importing this key from some older OpenSSL tests results in an internal error:\nhttps://github.com/openssl/openssl/blob/8efc4a9c656b8b3eabeac64c54efdeb07dd42f8e/test/recipes/30-test_evp_pkey_provided/DH.priv.pem\n\nExample code:\n```\n#!/usr/bin/python3\n\nfrom cryptography.hazmat.primitives.serialization import load_pem_private_key\n\nx=b\"\"\"-----BEGIN PRIVATE KEY-----\nMCQCAQAwFwYJKoZIhvcNAQMBMAoCBQCLtF9TAgECBAYCBGZsKwY=\n-----END PRIVATE KEY-----\n\"\"\"\n\nload_pem_private_key(x, password=None)\n```\n\nError message:\n```\nTraceback (most recent call last):\n  File \"/tmp/foo.py\", line 10, in <module>\n    load_pem_private_key(x, password=None)\n    ~~~~~~~~~~~~~~~~~~~~^^^^^^^^^^^^^^^^^^\ncryptography.exceptions.InternalError: Unknown OpenSSL error. This error is commonly encountered\n                    when another library is not cleaning up the OpenSSL error\n                    stack. If you are using cryptography with another library\n                    that uses OpenSSL try disabling it before reporting a bug.\n                    Otherwise please file an issue at\n                    https://github.com/pyca/cryptography/issues with\n                    information on how to reproduce this. (error:0280007E:Diffie-Hellman routines:generate_key:modulus too small:../openssl-3.5.0/crypto/dh/dh_key.c:287:)\n\n```","closed_by":{"login":"reaperhulk","id":161495,"node_id":"MDQ6VXNlcjE2MTQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/161495?v=4","gravatar_id":"","url":"https://api.github.com/users/reaperhulk","html_url":"https://github.com/reaperhulk","followers_url":"https://api.github.com/users/reaperhulk/followers","following_url":"https://api.github.com/users/reaperhulk/following{/other_user}","gists_url":"https://api.github.com/users/reaperhulk/gists{/gist_id}","starred_url":"https://api.github.com/users/reaperhulk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reaperhulk/subscriptions","organizations_url":"https://api.github.com/users/reaperhulk/orgs","repos_url":"https://api.github.com/users/reaperhulk/repos","events_url":"https://api.github.com/users/reaperhulk/events{/privacy}","received_events_url":"https://api.github.com/users/reaperhulk/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pyca/cryptography/issues/13050/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyca/cryptography/issues/13050/timeline","performed_via_github_app":null,"state_reason":"completed"}