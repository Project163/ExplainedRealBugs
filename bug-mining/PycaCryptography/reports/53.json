{"url":"https://api.github.com/repos/pyca/cryptography/issues/5885","repository_url":"https://api.github.com/repos/pyca/cryptography","labels_url":"https://api.github.com/repos/pyca/cryptography/issues/5885/labels{/name}","comments_url":"https://api.github.com/repos/pyca/cryptography/issues/5885/comments","events_url":"https://api.github.com/repos/pyca/cryptography/issues/5885/events","html_url":"https://github.com/pyca/cryptography/issues/5885","id":818479350,"node_id":"MDU6SXNzdWU4MTg0NzkzNTA=","number":5885,"title":"AES-XTS failing for plaintext less then 16 bytes","user":{"login":"yeblank","id":19684308,"node_id":"MDQ6VXNlcjE5Njg0MzA4","avatar_url":"https://avatars.githubusercontent.com/u/19684308?v=4","gravatar_id":"","url":"https://api.github.com/users/yeblank","html_url":"https://github.com/yeblank","followers_url":"https://api.github.com/users/yeblank/followers","following_url":"https://api.github.com/users/yeblank/following{/other_user}","gists_url":"https://api.github.com/users/yeblank/gists{/gist_id}","starred_url":"https://api.github.com/users/yeblank/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yeblank/subscriptions","organizations_url":"https://api.github.com/users/yeblank/orgs","repos_url":"https://api.github.com/users/yeblank/repos","events_url":"https://api.github.com/users/yeblank/events{/privacy}","received_events_url":"https://api.github.com/users/yeblank/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/pyca/cryptography/milestones/37","html_url":"https://github.com/pyca/cryptography/milestone/37","labels_url":"https://api.github.com/repos/pyca/cryptography/milestones/37/labels","id":6240794,"node_id":"MDk6TWlsZXN0b25lNjI0MDc5NA==","number":37,"title":"Thirty Fifth Release","description":"","creator":{"login":"alex","id":772,"node_id":"MDQ6VXNlcjc3Mg==","avatar_url":"https://avatars.githubusercontent.com/u/772?v=4","gravatar_id":"","url":"https://api.github.com/users/alex","html_url":"https://github.com/alex","followers_url":"https://api.github.com/users/alex/followers","following_url":"https://api.github.com/users/alex/following{/other_user}","gists_url":"https://api.github.com/users/alex/gists{/gist_id}","starred_url":"https://api.github.com/users/alex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alex/subscriptions","organizations_url":"https://api.github.com/users/alex/orgs","repos_url":"https://api.github.com/users/alex/repos","events_url":"https://api.github.com/users/alex/events{/privacy}","received_events_url":"https://api.github.com/users/alex/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":26,"state":"closed","created_at":"2020-12-23T14:42:59Z","updated_at":"2021-09-30T02:44:54Z","due_on":null,"closed_at":"2021-09-30T02:44:54Z"},"comments":6,"created_at":"2021-03-01T05:29:01Z","updated_at":"2021-06-21T00:00:50Z","closed_at":"2021-03-22T00:14:02Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I am using version 2.6.1 (Python 2)\r\nEncrypting plaintext less then 16 bytes in AES XTS mode throws the following exception:\r\n\r\n> \"_cryptography.exceptions.InternalError: Unknown OpenSSL error. This error is commonly encountered when another library is not cleaning up the OpenSSL error stack. If you are using cryptography with another library that uses OpenSSL try disabling it before reporting a bug. Otherwise please file an issue at https://github.com/pyca/cryptography/issues with information on how to reproduce this.\"\r\n\r\nSee code snippet below\r\nThanks\r\n\r\n`from cryptography.hazmat.primitives.ciphers import (\r\n            Cipher, algorithms, modes\r\n    )\r\n    from cryptography.hazmat.backends import default_backend\r\n\r\n    limit = 10000\r\n    failures =  []\r\n    for i in range(limit):\r\n        key = os.urandom(64)\r\n        tweak = os.urandom(16)\r\n        \r\n        txtLen = i\r\n        plaintext = os.urandom(txtLen)\r\n        \r\n        encryptor = Cipher(\r\n            algorithms.AES(key),\r\n            modes.XTS(tweak),\r\n            backend=default_backend()\r\n        ).encryptor()\r\n        \r\n        ciphertext = encryptor.update(plaintext) + encryptor.finalize()\r\n        try:\r\n            ciphertext = encryptor.update(plaintext) + encryptor.finalize()\r\n        except Exception as e:\r\n            if (not txtLen in failures):\r\n                failures.append(txtLen)\r\n            \r\n        \r\n    for i in failures:\r\n        print i,\r\n        `","closed_by":{"login":"alex","id":772,"node_id":"MDQ6VXNlcjc3Mg==","avatar_url":"https://avatars.githubusercontent.com/u/772?v=4","gravatar_id":"","url":"https://api.github.com/users/alex","html_url":"https://github.com/alex","followers_url":"https://api.github.com/users/alex/followers","following_url":"https://api.github.com/users/alex/following{/other_user}","gists_url":"https://api.github.com/users/alex/gists{/gist_id}","starred_url":"https://api.github.com/users/alex/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alex/subscriptions","organizations_url":"https://api.github.com/users/alex/orgs","repos_url":"https://api.github.com/users/alex/repos","events_url":"https://api.github.com/users/alex/events{/privacy}","received_events_url":"https://api.github.com/users/alex/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pyca/cryptography/issues/5885/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyca/cryptography/issues/5885/timeline","performed_via_github_app":null,"state_reason":"completed"}