{"url":"https://api.github.com/repos/pyca/cryptography/issues/13118","repository_url":"https://api.github.com/repos/pyca/cryptography","labels_url":"https://api.github.com/repos/pyca/cryptography/issues/13118/labels{/name}","comments_url":"https://api.github.com/repos/pyca/cryptography/issues/13118/comments","events_url":"https://api.github.com/repos/pyca/cryptography/issues/13118/events","html_url":"https://github.com/pyca/cryptography/issues/13118","id":3183763834,"node_id":"I_kwDOALYunM69xGF6","number":13118,"title":"Improve error message with mismatched PEM headers","user":{"login":"johnhar","id":22464603,"node_id":"MDQ6VXNlcjIyNDY0NjAz","avatar_url":"https://avatars.githubusercontent.com/u/22464603?v=4","gravatar_id":"","url":"https://api.github.com/users/johnhar","html_url":"https://github.com/johnhar","followers_url":"https://api.github.com/users/johnhar/followers","following_url":"https://api.github.com/users/johnhar/following{/other_user}","gists_url":"https://api.github.com/users/johnhar/gists{/gist_id}","starred_url":"https://api.github.com/users/johnhar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/johnhar/subscriptions","organizations_url":"https://api.github.com/users/johnhar/orgs","repos_url":"https://api.github.com/users/johnhar/repos","events_url":"https://api.github.com/users/johnhar/events{/privacy}","received_events_url":"https://api.github.com/users/johnhar/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2025-06-27T18:36:48Z","updated_at":"2025-10-04T13:47:17Z","closed_at":"2025-10-04T13:47:17Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I have a RSA private key for a SaaS API that I access. The SaaS vendor creates the RSA private key.\n\nserialization.load_pem_private_key() up to v44.0.3 worked with the key.  V45.0.0 and later raises this exception:\nValueError: Could not deserialize key data. The data may be in an incorrect format, it may be encrypted with an unsupported algorithm, or it may be an unsupported key type (e.g. EC curves with explicit parameters). Details: ASN.1 parsing error: unexpected tag (got Tag { value: 16, constructed: true, class: Universal })\n\nIt turns out that this is a PKCS#8 format but the PEM file has -----BEGIN RSA PRIVATE KEY----- and -----END RSA PRIVATE KEY----- which apparently is for PKCS#1 format.  If I change the file to change \"RSA PRIVATE KEY\" to \"PRIVATE KEY\" (expected for PKCS#8), then I can serialize.\n\nWhile I will work with the vendor to get this changed, I have no guarantee that they will.  So, is it possible to provide more details in the exception as to what to look for and fix, or provide some debugging script/method that analyzes for any issues like this?","closed_by":{"login":"reaperhulk","id":161495,"node_id":"MDQ6VXNlcjE2MTQ5NQ==","avatar_url":"https://avatars.githubusercontent.com/u/161495?v=4","gravatar_id":"","url":"https://api.github.com/users/reaperhulk","html_url":"https://github.com/reaperhulk","followers_url":"https://api.github.com/users/reaperhulk/followers","following_url":"https://api.github.com/users/reaperhulk/following{/other_user}","gists_url":"https://api.github.com/users/reaperhulk/gists{/gist_id}","starred_url":"https://api.github.com/users/reaperhulk/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/reaperhulk/subscriptions","organizations_url":"https://api.github.com/users/reaperhulk/orgs","repos_url":"https://api.github.com/users/reaperhulk/repos","events_url":"https://api.github.com/users/reaperhulk/events{/privacy}","received_events_url":"https://api.github.com/users/reaperhulk/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pyca/cryptography/issues/13118/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pyca/cryptography/issues/13118/timeline","performed_via_github_app":null,"state_reason":"completed"}