diff --git a/src/rust/src/x509/extensions.rs b/src/rust/src/x509/extensions.rs
index 44bb4a9ad..b3cdcfdef 100644
--- a/src/rust/src/x509/extensions.rs
+++ b/src/rust/src/x509/extensions.rs
@@ -135,12 +135,17 @@ pub(crate) fn encode_extension(
             certificate::set_bit(&mut bs, 7, ext.getattr("encipher_only")?.is_true()?);
             certificate::set_bit(&mut bs, 8, ext.getattr("decipher_only")?.is_true()?);
         }
-        let bits = if bs[1] == 0 { &bs[..1] } else { &bs[..] };
-        let unused_bits = bits.last().unwrap().trailing_zeros() as u8;
-        Ok(Some(asn1::write_single(&asn1::BitString::new(
-            bits,
-            unused_bits,
-        ))))
+        let (bits, unused_bits) = if bs[1] == 0 {
+            if bs[0] == 0 {
+                (&[][..], 0)
+            } else {
+                (&bs[..1], bs[0].trailing_zeros() as u8)
+            }
+        } else {
+            (&bs[..], bs[1].trailing_zeros() as u8)
+        };
+        let v = asn1::BitString::new(bits, unused_bits).unwrap();
+        Ok(Some(asn1::write_single(&v)))
     } else if oid == &*oid::AUTHORITY_INFORMATION_ACCESS_OID
         || oid == &*oid::SUBJECT_INFORMATION_ACCESS_OID
     {
diff --git a/tests/x509/test_x509_ext.py b/tests/x509/test_x509_ext.py
index f1361a03c..f9d117ffe 100644
--- a/tests/x509/test_x509_ext.py
+++ b/tests/x509/test_x509_ext.py
@@ -1137,6 +1137,20 @@ class TestKeyUsage:
                 ),
                 b"\x03\x02\x02\x94",
             ),
+            (
+                x509.KeyUsage(
+                    digital_signature=False,
+                    content_commitment=False,
+                    key_encipherment=False,
+                    data_encipherment=False,
+                    key_agreement=False,
+                    key_cert_sign=False,
+                    crl_sign=False,
+                    encipher_only=False,
+                    decipher_only=False,
+                ),
+                b"\x03\x01\x00",
+            ),
         ],
     )
     def test_public_bytes(self, ext, serialized):
