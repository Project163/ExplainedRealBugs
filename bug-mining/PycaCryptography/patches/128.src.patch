diff --git a/src/rust/src/backend/hmac.rs b/src/rust/src/backend/hmac.rs
index 13509b859..d035a6156 100644
--- a/src/rust/src/backend/hmac.rs
+++ b/src/rust/src/backend/hmac.rs
@@ -46,7 +46,12 @@ impl Hmac {
         let _ = backend;
 
         let md = message_digest_from_algorithm(py, algorithm)?;
-        let ctx = cryptography_openssl::hmac::Hmac::new(key.as_bytes(), md)?;
+        let ctx = cryptography_openssl::hmac::Hmac::new(key.as_bytes(), md).map_err(|_| {
+            exceptions::UnsupportedAlgorithm::new_err((
+                "Digest is not supported for HMAC",
+                exceptions::Reasons::UNSUPPORTED_HASH,
+            ))
+        })?;
 
         Ok(Hmac {
             ctx: Some(ctx),
diff --git a/tests/hazmat/primitives/test_hmac.py b/tests/hazmat/primitives/test_hmac.py
index 862b8340d..04c3e8588 100644
--- a/tests/hazmat/primitives/test_hmac.py
+++ b/tests/hazmat/primitives/test_hmac.py
@@ -83,6 +83,9 @@ class TestHMAC:
         with raises_unsupported_algorithm(_Reasons.UNSUPPORTED_HASH):
             hmac.HMAC(b"key", DummyHashAlgorithm(), backend)
 
+        with raises_unsupported_algorithm(_Reasons.UNSUPPORTED_HASH):
+            hmac.HMAC(b"key", hashes.SHAKE256(digest_size=256), backend)
+
     def test_buffer_protocol(self, backend):
         key = bytearray(b"2b7e151628aed2a6abf7158809cf4f3c")
         h = hmac.HMAC(key, hashes.SHA256(), backend)
