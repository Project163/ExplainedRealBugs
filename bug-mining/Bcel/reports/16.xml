<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:13:28 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BCEL-161] InstructionTargeters not being properly cleaned up.</title>
                <link>https://issues.apache.org/jira/browse/BCEL-161</link>
                <project id="12314220" key="BCEL">Commons BCEL</project>
                    <description>&lt;p&gt;It seems that InstructionTargeters are not being properly cleaned up when they are not used anymore. That is, when a targeter is replaced or removed (e.g., a LocalVariableGen is removed from a method), the targeter remains in the targeters list of its targets.&lt;/p&gt;

&lt;p&gt;For example, MethodGen&apos;s constructor which receives a Method uses its other constructor to initialize the object:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; MethodGen(Method m, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; class_name, ConstantPoolGen cp) {
   &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;(
       m.getAccessFlags(), 
       Type.getReturnType(m.getSignature()),
       Type.getArgumentTypes(m.getSignature()),
       &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-comment&quot;&gt;/* may be overridden anyway */&lt;/span&gt;,
       m.getName(), 
       class_name,
       ((m.getAccessFlags() &amp;amp; (Constants.ACC_ABSTRACT | Constants.ACC_NATIVE)) == 0) ? &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InstructionList(m.getCode().getCode()) : &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, cp);
...
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because this call passes null as its 4th argument, the constructor will create placeholder LocalVariableGen for the arguments (like arg0, arg1, etc). Later in this constructor the arguments will be overridden (as indicated by the comment). However, the LocalVariableGens of the placeholder arguments (as well as the LocalVariableGen for the &quot;this&quot; variable) will remain in the targeter lists of the first and last instructions of the instruction list.&lt;/p&gt;

&lt;p&gt;To avoid this problem I am submitting a patch in attachment. It adds a new method to InstructionTargeter:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    /**
     * Removes all targets of &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; targeter.
     */
    void removeTargets();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and implements it to remove the targeter from the target&apos;s lists. The patch also calls removeTargets() when discarding targeters in MethodGen.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12619327">BCEL-161</key>
            <summary>InstructionTargeters not being properly cleaned up.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="issues@commons.apache.org">Apache Commons Developers</assignee>
                                    <reporter username="thiagobart@gmail.com">Thiago</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 Jan 2012 16:30:23 +0000</created>
                <updated>Thu, 7 Dec 2023 21:04:08 +0000</updated>
                            <resolved>Fri, 20 Feb 2015 23:55:17 +0000</resolved>
                                    <version>6.8.1</version>
                                    <fixVersion>6.0</fixVersion>
                                    <component>Main</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13511993" author="thiagobart@gmail.com" created="Mon, 9 Jan 2012 16:30:23 +0000"  >&lt;p&gt;Attachment patch.diff has been added with description: New method to InstructionTargeter for target cleanup.&lt;/p&gt;</comment>
                            <comment id="14329783" author="ebourg" created="Fri, 20 Feb 2015 23:51:10 +0000"  >&lt;p&gt;Thank you very much for the report Thiago. I didn&apos;t notice this issue before fixing &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-207&quot; title=&quot;RemoveLocalVariable(s) doesn&amp;#39;t remove the associated Targetters.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-207&quot;&gt;&lt;del&gt;BCEL-207&lt;/del&gt;&lt;/a&gt; with a very similar approach. I added a package private &lt;tt&gt;dispose()&lt;/tt&gt; method to &lt;tt&gt;LocalVariableGen&lt;/tt&gt; which is called from &lt;tt&gt;MethodGen.removeLocalVariable&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;You suggested adding a call to &lt;tt&gt;this.removeLocalVariables()&lt;/tt&gt; in the &lt;tt&gt;MethodGen&lt;/tt&gt; constructor, but if I&apos;m not mistaken this is not necessary since the method is already called bellow when the attributes are parsed and the LocalVariableTable is encountered.&lt;/p&gt;

&lt;p&gt;It seems the &lt;tt&gt;removeTargets()&lt;/tt&gt; method in &lt;tt&gt;CodeExceptionGen&lt;/tt&gt;, &lt;tt&gt;Select&lt;/tt&gt; and &lt;tt&gt;BranchInstruction&lt;/tt&gt; aren&apos;t used so I&apos;ll pass on them for now, but I like the idea.&lt;/p&gt;

&lt;p&gt;I applied your documentation improvements to InstructionTargeter.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310060">
                    <name>Container</name>
                                            <outwardlinks description="contains">
                                        <issuelink>
            <issuekey id="12772725">BCEL-207</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12556473" name="patch.diff" size="4878" author="thiagobart@gmail.com" created="Mon, 9 Jan 2012 16:30:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12311024" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>External issue ID</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>52441</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://issues.apache.org/bugzilla/show_bug.cgi?id=52441]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>306601</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 39 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i19wjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>265905</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>