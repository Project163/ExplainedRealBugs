<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:14:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BCEL-295] Incorrect live range information in LocalVariableGen</title>
                <link>https://issues.apache.org/jira/browse/BCEL-295</link>
                <project id="12314220" key="BCEL">Commons BCEL</project>
                    <description>&lt;p&gt;(Not sure of priority - blocker for me, but probably of little consequence for most clients.)&lt;/p&gt;

&lt;p&gt;There is a design flaw with the treatment of local variable live ranges.  In the .class file these are demarcated via byte code offsets into the method&apos;s instructions.  The range is from start up to, but not including, the length. If the live range lasts through the end of the method, then length points to the first byte &apos;past&apos; the end of the method.  BCEL converts these offsets into InstructionHandles and in doing so can no longer differentiate between a live range that ends prior to the last instruction of the method or one that includes the last instruction of the method.&lt;/p&gt;

&lt;p&gt;How to fix this is a bit of a problem.  The &apos;correct&apos; solution would seem to be to keep end as a null InstructionHandle as indicated by some of the comments.  Unfortunately, LocalVariableGen does not have access to the method&apos;s InstructionList and thus cannot easily convert this null pointer back to the correct length for output.  We could grab the InstructionHandle for start and then count the instruction bytes as we iterate to the end.&lt;/p&gt;

&lt;p&gt;But all this still begs the question of the fact this would be a change in behavior - a client would now have to check for a null end handle before dereferencing.  The proposed fix I have attached takes another approach.  It sets a flag in the constructor if the initial value for end is null and then lets all else proceed unchanged.  A client may test this flag to see if the special case is active.  Also, the getLocalVariable method uses this flag to correctly set the length on output.  &lt;/p&gt;

&lt;p&gt;I believe this approach would have no effect on existing code.  We would only need to document the new flag for clients that might care.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13108318">BCEL-295</key>
            <summary>Incorrect live range information in LocalVariableGen</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="markro">Mark Roberts</reporter>
                        <labels>
                    </labels>
                <created>Tue, 10 Oct 2017 15:17:56 +0000</created>
                <updated>Sat, 2 Dec 2017 20:25:32 +0000</updated>
                            <resolved>Sat, 2 Dec 2017 20:25:32 +0000</resolved>
                                                    <fixVersion>6.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16199046" author="garydgregory" created="Tue, 10 Oct 2017 17:38:58 +0000"  >&lt;p&gt;The patch is small and seems OK at first glance but I am not comfortable applying without a matching unit test. I do appreciate the low/no impact WRT compatibility. That&apos;s a plus &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; What do others think?&lt;/p&gt;</comment>
                            <comment id="16199060" author="markro" created="Tue, 10 Oct 2017 17:45:52 +0000"  >&lt;p&gt;I might have time to provide a unit test next week.&lt;/p&gt;</comment>
                            <comment id="16204114" author="githubbot" created="Fri, 13 Oct 2017 20:09:19 +0000"  >&lt;p&gt;GitHub user markro49 opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/commons-bcel/pull/17&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-bcel/pull/17&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-295&quot; title=&quot;Incorrect live range information in LocalVariableGen&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-295&quot;&gt;&lt;del&gt;BCEL-295&lt;/del&gt;&lt;/a&gt; fix local variable live range length; add test case&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/markro49/commons-bcel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/markro49/commons-bcel&lt;/a&gt; bcel295&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/commons-bcel/pull/17.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-bcel/pull/17.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #17&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9bda4c39979c184c4aa73bf99c93387bbbbf30d1&lt;br/&gt;
Author: Mark Roberts &amp;lt;markro@cs.washington.edu&amp;gt;&lt;br/&gt;
Date:   2017-10-13T20:06:11Z&lt;/p&gt;

&lt;p&gt;    fix local variable live range length; add test case&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16206579" author="githubbot" created="Mon, 16 Oct 2017 20:45:52 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/commons-bcel/pull/17&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-bcel/pull/17&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16275732" author="garydgregory" created="Sat, 2 Dec 2017 20:25:32 +0000"  >&lt;p&gt;In svn trunk already.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12891284" name="LocalVariableGen.diff" size="2056" author="markro" created="Tue, 10 Oct 2017 15:18:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 49 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3l35j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>