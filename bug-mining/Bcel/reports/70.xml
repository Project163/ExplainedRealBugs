<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:14:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BCEL-221] BCELifier is not working for Java8Example</title>
                <link>https://issues.apache.org/jira/browse/BCEL-221</link>
                <project id="12314220" key="BCEL">Commons BCEL</project>
                    <description>&lt;p&gt;org.apache.bcel.util.BCELifier Java8Example fails:&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; org.apache.bcel.classfile.ClassFormatException: Constant pool at index 0 is null.&lt;br/&gt;
	at org.apache.bcel.classfile.ConstantPool.getConstant(ConstantPool.java:259)&lt;br/&gt;
	at org.apache.bcel.classfile.ConstantPool.getConstantString(ConstantPool.java:294)&lt;br/&gt;
	at org.apache.bcel.generic.FieldOrMethod.getClassName(FieldOrMethod.java:89)&lt;br/&gt;
	at org.apache.bcel.util.BCELFactory.visitInvokeInstruction(BCELFactory.java:162)&lt;br/&gt;
	at org.apache.bcel.generic.INVOKEDYNAMIC.accept(INVOKEDYNAMIC.java:117)&lt;br/&gt;
	at org.apache.bcel.util.BCELFactory.start(BCELFactory.java:101)&lt;br/&gt;
	at org.apache.bcel.util.BCELifier.visitMethod(BCELifier.java:181)&lt;br/&gt;
	at org.apache.bcel.classfile.Method.accept(Method.java:106)&lt;br/&gt;
	at org.apache.bcel.util.BCELifier.visitJavaClass(BCELifier.java:120)&lt;br/&gt;
	at org.apache.bcel.util.BCELifier.start(BCELifier.java:69)&lt;br/&gt;
	at org.apache.bcel.util.BCELifier.main(BCELifier.java:270)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12849134">BCEL-221</key>
            <summary>BCELifier is not working for Java8Example</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="chonton">Charles Honton</reporter>
                        <labels>
                    </labels>
                <created>Sun, 26 Jul 2015 05:16:03 +0000</created>
                <updated>Fri, 1 Mar 2019 20:22:50 +0000</updated>
                                            <version>6.0</version>
                                                    <component>Verifier</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14712090" author="sebb@apache.org" created="Tue, 25 Aug 2015 22:31:58 +0000"  >&lt;p&gt;I can confirm this.&lt;/p&gt;

&lt;p&gt;There is a comment in the ctor ConstantPool(DataInput input) which says:&lt;/p&gt;

&lt;p&gt;        /* constant_pool&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt; is unused by the compiler and may be used freely&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;by the implementation.&lt;br/&gt;
         */&lt;br/&gt;
However CONSTANT_InvokeDynamic appears to create itself with index 0; looks like it is reading the class file incorrectly.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14712335" author="charles_honton@intuit.com" created="Wed, 26 Aug 2015 01:42:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.10&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/specs/jvms/se8/html/jvms-4.html#jvms-4.4.10&lt;/a&gt; defines the second attribute of CONSTANT_InvokeDynamic_info to be bootstrap_method_attr_index (an index into the bootstrap_methods array of the bootstrap method table)&lt;/p&gt;

&lt;p&gt;I suspect we&apos;re using bootstrap_method_attr_index as an index into constant pool.&lt;/p&gt;</comment>
                            <comment id="14712696" author="sebb@apache.org" created="Wed, 26 Aug 2015 08:27:01 +0000"  >&lt;p&gt;Yes, the ID class is a currently a subclass of ConstantCP which was originally for the Fieldref, Methodref, InterfaceMethodref constants&lt;/p&gt;

&lt;p&gt;That does not work properly; ID has 2 parameters but they are not class_index and name_and_type_index as ConstantCP expects.&lt;/p&gt;

&lt;p&gt;They are bootstrap_method_attr_index and name_and_type_index instead, and the former is 0-based unlike class_index which is why the crash occurs&lt;/p&gt;

&lt;p&gt;It looks like the intention in &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-209&quot; title=&quot;Bug fixes and improvements to InvokeDynamic and BootStrapMethods implementation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-209&quot;&gt;&lt;del&gt;BCEL-209&lt;/del&gt;&lt;/a&gt; was to share code, but the InvokeDynamic instruction is not really compatible&lt;/p&gt;</comment>
                            <comment id="14740714" author="sebb@apache.org" created="Fri, 11 Sep 2015 12:38:47 +0000"  >&lt;p&gt;I applied a fix which seems to work; not sure if it&apos;s correct. Need more unit tests.&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1702447&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1702447&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-221&quot; title=&quot;BCELifier is not working for Java8Example&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-221&quot;&gt;BCEL-221&lt;/a&gt; BCELifier is not working for Java8Example&lt;br/&gt;
Workround for crash; may need further work&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/bcel/trunk/src/changes/changes.xml&lt;br/&gt;
    commons/proper/bcel/trunk/src/main/java/org/apache/commons/bcel6/generic/INVOKEDYNAMIC.java&lt;br/&gt;
    commons/proper/bcel/trunk/src/test/java/org/apache/commons/bcel6/util/BCELifierTestCase.java&lt;/p&gt;</comment>
                            <comment id="14741797" author="sebb@apache.org" created="Sat, 12 Sep 2015 00:48:38 +0000"  >&lt;p&gt;Definitely needs further work - the generated code is wrong for InvokeDynamic - e.g. it does not create the correct CP and bootstrap entries.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310361">
                    <name>Blocked</name>
                                            <outwardlinks description="Blocked">
                                        <issuelink>
            <issuekey id="13078686">BCEL-290</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 10 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2hxqf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>