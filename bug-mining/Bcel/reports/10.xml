<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:13:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BCEL-186] Performance degradation with the UTF8 cache</title>
                <link>https://issues.apache.org/jira/browse/BCEL-186</link>
                <project id="12314220" key="BCEL">Commons BCEL</project>
                    <description>&lt;p&gt;I&apos;d love to see 6.0 released.&lt;/p&gt;

&lt;p&gt;Here was the last vote:&lt;br/&gt;
&lt;a href=&quot;http://apache-commons.680414.n4.nabble.com/VOTE-Release-BCEL-6-0-based-on-RC3-td4667129.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache-commons.680414.n4.nabble.com/VOTE-Release-BCEL-6-0-based-on-RC3-td4667129.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Konstantin Kolinko reported some issues with caching that blocked the release:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I noted new methods that introduced caching into classfile.ConstantUtf8 class. BCEL_DONT_CACHE should at least have static setter, or a static setter for a cache instance / a factory class. RELEASE-NOTES.txt describes this change as &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-163&quot; title=&quot;Incorporate patch file from Findbugs?&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-163&quot;&gt;&lt;del&gt;BCEL-163&lt;/del&gt;&lt;/a&gt; Incorporate patch file from Findbugs which does not say much about this change. Actually this change introduced caching for ConstantUtf8 and ObjectType instances.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Emmanuel Bourg did some investigation and testing and reported back:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If nobody object I&apos;ll remove this cache, the impact on the performance is too important to enable it by default, and the static state smells like a quick and dirty implementation. This feature could return as a pluggable cache if someone wants to provide a patch.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;garydgregory suggested adding a flush method to clear the cache in ObjectType&lt;/p&gt;</description>
                <environment></environment>
        <key id="12764209">BCEL-186</key>
            <summary>Performance degradation with the UTF8 cache</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="chengas123">Java Developer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Dec 2014 14:59:30 +0000</created>
                <updated>Thu, 14 Jul 2016 12:48:45 +0000</updated>
                            <resolved>Wed, 4 Feb 2015 18:38:09 +0000</resolved>
                                    <version>6.0</version>
                                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14261145" author="ebourg" created="Tue, 30 Dec 2014 15:08:45 +0000"  >&lt;p&gt;Thank you for offering your help but JIRA is not the right place to discuss releases. Please join us on the dev list instead.&lt;/p&gt;</comment>
                            <comment id="14261152" author="chengas123" created="Tue, 30 Dec 2014 15:17:45 +0000"  >&lt;p&gt;This patch removes the cache in ConstantUtf8. Konstantin Kolinko and Emmanuel Bourg investigated and found it had a negative impact on performance. Also the feature isn&apos;t well implemented due to the static state it introduces.&lt;/p&gt;</comment>
                            <comment id="14261153" author="chengas123" created="Tue, 30 Dec 2014 15:20:22 +0000"  >&lt;p&gt;Hi Emmanuel. I opened the bug as a place to attach patches for release blockers. I&apos;m afraid you saw the bug before I had a chance to attach the patch so that wasn&apos;t clear. Perhaps we can reopen and possibly rename this issue? In any case, I hope you&apos;ll take a look at the attached patch which resolves the issue brought up in the last RC vote. Thanks again for your help.&lt;/p&gt;</comment>
                            <comment id="14261164" author="ebourg" created="Tue, 30 Dec 2014 15:31:26 +0000"  >&lt;p&gt;Ok, let&apos;s retitle the ticket and focus on a single issue then.&lt;/p&gt;</comment>
                            <comment id="14263088" author="chengas123" created="Fri, 2 Jan 2015 17:59:04 +0000"  >&lt;p&gt;Thanks Emmanuel. Is this something we could check in yet? I&apos;m not sure what the process is for reviewing and merging. Thanks!&lt;/p&gt;</comment>
                            <comment id="14267443" author="chengas123" created="Wed, 7 Jan 2015 09:11:31 +0000"  >&lt;p&gt;Could we merge this? I believe this was wanted from the discussion on the mailing list&lt;/p&gt;</comment>
                            <comment id="14271744" author="sebb@apache.org" created="Fri, 9 Jan 2015 19:20:23 +0000"  >&lt;p&gt;It might be better to keep the getInstance() method, and change it so that it creates a new instance instead of returning a cache entry.&lt;/p&gt;

&lt;p&gt;This would make it easier to provide caching later if a more performant way of doing it is found.&lt;/p&gt;

&lt;p&gt;i.e. keep the Constant class as it is, and just update the ConstantUtf8.getInstance method.&lt;/p&gt;</comment>
                            <comment id="14271969" author="chengas123" created="Fri, 9 Jan 2015 22:25:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sebb%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;sebb@apache.org&quot;&gt;sebb@apache.org&lt;/a&gt; Sure, that works for me. I think either way would be fine. I attached patch2.diff that does that. Thanks so much for taking a look&lt;/p&gt;</comment>
                            <comment id="14275376" author="chengas123" created="Tue, 13 Jan 2015 15:28:15 +0000"  >&lt;p&gt;Would you guys be able to take a look at the patch? Thanks!&lt;/p&gt;</comment>
                            <comment id="14280738" author="chengas123" created="Fri, 16 Jan 2015 19:55:40 +0000"  >&lt;p&gt;Could we get this change in? Thanks&lt;/p&gt;</comment>
                            <comment id="14280956" author="sebb@apache.org" created="Fri, 16 Jan 2015 23:02:32 +0000"  >&lt;p&gt;I added a different fix, merely changing getInstance to&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; ConstantUtf8 getInstance(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; s) {
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConstantUtf8(s);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This leaves the cache implementation in place. I can see some simple changes that might improve the performance. Keeping the alternate implementation allows this to be tested.&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1652541&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1652541&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-186&quot; title=&quot;Performance degradation with the UTF8 cache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-186&quot;&gt;&lt;del&gt;BCEL-186&lt;/del&gt;&lt;/a&gt; Performance degradation with the UTF8 cache&lt;br/&gt;
getInstance no longer uses the cache&lt;/p&gt;</comment>
                            <comment id="14281055" author="sebb@apache.org" created="Sat, 17 Jan 2015 00:34:10 +0000"  >&lt;p&gt;Have tried using IODH to create the HashMap. Still about 4 times slower.&lt;/p&gt;</comment>
                            <comment id="14281190" author="chengas123" created="Sat, 17 Jan 2015 03:10:17 +0000"  >&lt;p&gt;Great, thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=sebb%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;sebb@apache.org&quot;&gt;sebb@apache.org&lt;/a&gt;! I&apos;d love to see a new release of BCEL now that this issue is fixed. Should we mark this bug as resolved?&lt;/p&gt;</comment>
                            <comment id="14305693" author="chengas123" created="Wed, 4 Feb 2015 18:38:09 +0000"  >&lt;p&gt;Fixed here: &lt;a href=&quot;https://github.com/apache/commons-bcel/commit/fbcd823d35677e12d3bc37db531f3f18cdb17535&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-bcel/commit/fbcd823d35677e12d3bc37db531f3f18cdb17535&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12691410" name="patch2.diff" size="3928" author="chengas123" created="Fri, 9 Jan 2015 22:24:08 +0000"/>
                            <attachment id="12689512" name="revert-ConstantUtf8-cache.diff" size="4229" author="chengas123" created="Tue, 30 Dec 2014 15:17:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 41 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i23umn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12311021" key="com.atlassian.jira.plugin.system.customfieldtypes:select">
                        <customfieldname>Severity</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10569"><![CDATA[blocker]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>