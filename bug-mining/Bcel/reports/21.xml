<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:13:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BCEL-209] Bug fixes and improvements to InvokeDynamic and BootStrapMethods implementation</title>
                <link>https://issues.apache.org/jira/browse/BCEL-209</link>
                <project id="12314220" key="BCEL">Commons BCEL</project>
                    <description>&lt;p&gt;(Apologies in advance - this is a very large diff.)&lt;br/&gt;
During the past year, both the Apache Commons BCEL team and our group here at the UW independently completed the support for InvokeDynamic .  Some things we chose to do the same way, but there are a few items that are quite different.  Trying not to be too biased, I believe our method is better.  One of the larger differences is your decision to add the abstract class NameSignatureMethod between FieldOrMethod and CPInstruction and then have InvokeDynamic extend from that instead of from InvokeInstruction.  To me this seems wrong.   In addition to forcing InvokeDynamic to duplicate all the methods from InvokeInstruction and FieldOrMethod, it is awkward that it is the only form of the Invoke Instruction that doesn&apos;t derive from InvokeInstruction. &lt;/p&gt;

&lt;p&gt;This patch also includes several methods missing from the current implementation: alternative initializers, toString, and support for the Visitor paradigm.&lt;/p&gt;

&lt;p&gt;There are bug fixes to Constants.java and InstructionFinder.java as well.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12772767">BCEL-209</key>
            <summary>Bug fixes and improvements to InvokeDynamic and BootStrapMethods implementation</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="chonton">Charles Honton</assignee>
                                    <reporter username="markro">Mark Roberts</reporter>
                        <labels>
                    </labels>
                <created>Thu, 5 Feb 2015 18:29:11 +0000</created>
                <updated>Thu, 14 Jul 2016 12:48:30 +0000</updated>
                            <resolved>Sun, 19 Jul 2015 21:11:23 +0000</resolved>
                                                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>2</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14313006" author="markro" created="Mon, 9 Feb 2015 22:21:49 +0000"  >&lt;p&gt;These changes cause the CounterVisitor test case to fail.  I have attached a patch to update this test case.&lt;/p&gt;</comment>
                            <comment id="14313128" author="markro" created="Mon, 9 Feb 2015 23:14:26 +0000"  >&lt;p&gt;These changes also cause Class2HTMLTestCase to fail.  The fixes are in classfile/ConstantPool.java and util/CodeHTML.java.  I have updated the patch to reflect these changes.  Note that I removed invoke3.diff and added invoke4.diff.&lt;/p&gt;</comment>
                            <comment id="14337556" author="chengas123" created="Thu, 26 Feb 2015 00:26:20 +0000"  >&lt;p&gt;This change would fix the issue reported in &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-213&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/BCEL-213&lt;/a&gt;. invokedynamic support for InstructionFinder. InstructionFinder doesn&apos;t currently know about invokedynamic and is unable to match it.&lt;/p&gt;</comment>
                            <comment id="14338310" author="ebourg" created="Thu, 26 Feb 2015 12:18:52 +0000"  >&lt;p&gt;If we change &lt;tt&gt;INVOKEDYNAMIC&lt;/tt&gt; to extend &lt;tt&gt;InvokeInstruction&lt;/tt&gt;, what should be the value returned by &lt;tt&gt;getReferenceType()&lt;/tt&gt;? null, java.lang.Object or an exception?&lt;/p&gt;</comment>
                            <comment id="14338320" author="ebourg" created="Thu, 26 Feb 2015 12:31:38 +0000"  >&lt;p&gt;AspectJ maintains a fork of BCEL where invokedynamic has also been implemented as a subclass of &lt;tt&gt;InvokeInstruction&lt;/tt&gt;. And &lt;tt&gt;getReferenceType()&lt;/tt&gt; throws an &lt;tt&gt;IllegalStateException&lt;/tt&gt;:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://git.eclipse.org/c/aspectj/org.aspectj.git/tree/bcel-builder/src/org/aspectj/apache/bcel/generic/InvokeDynamic.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git.eclipse.org/c/aspectj/org.aspectj.git/tree/bcel-builder/src/org/aspectj/apache/bcel/generic/InvokeDynamic.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14341780" author="dbrosius" created="Sat, 28 Feb 2015 21:08:40 +0000"  >&lt;p&gt;haven&apos;t really tested it, but the approach seems fine to me.&lt;/p&gt;</comment>
                            <comment id="14343999" author="ebourg" created="Mon, 2 Mar 2015 23:30:26 +0000"  >&lt;p&gt;Mark, why adding &lt;tt&gt;num_bootstrap_arguments&lt;/tt&gt; to &lt;tt&gt;BootstrapMethod&lt;/tt&gt;? The number of arguments could be retrieved with &lt;tt&gt;getBootstrapArguments().length&lt;/tt&gt;, and there is no need to keep in sync &lt;tt&gt;num_bootstrap_arguments&lt;/tt&gt; with the actual number of elements in &lt;tt&gt;bootstrap_arguments&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="14344136" author="markro" created="Tue, 3 Mar 2015 00:27:18 +0000"  >&lt;p&gt;I guess I was reflecting the fact that this field is in the class file format.  Also, if you don&apos;t make it a member of BootStrapMethod, it makes it a little messier to write the three different constructors.  I like the recursive call to the &apos;basic&apos; constructor.  But you could certainly code it the way you describe if you wish.&lt;/p&gt;</comment>
                            <comment id="14350743" author="chengas123" created="Fri, 6 Mar 2015 19:13:38 +0000"  >&lt;p&gt;Are there any other questions before we can commit this code?&lt;/p&gt;</comment>
                            <comment id="14632928" author="charles_honton@intuit.com" created="Sun, 19 Jul 2015 21:11:23 +0000"  >&lt;p&gt;Committed revision 1691855.&lt;/p&gt;</comment>
                            <comment id="14713066" author="sebb@apache.org" created="Wed, 26 Aug 2015 12:59:18 +0000"  >&lt;p&gt;It&apos;s still possible to keep the recursive call - just ensure the array is set up in the common ctor.&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1697916&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1697916&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
Follow-up to &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-209&quot; title=&quot;Bug fixes and improvements to InvokeDynamic and BootStrapMethods implementation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-209&quot;&gt;&lt;del&gt;BCEL-209&lt;/del&gt;&lt;/a&gt; Drop the field num_bootstrap_arguments&lt;br/&gt;
it is not necessary, and was not kept in sync if the arguments were updated&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/bcel/trunk/src/main/java/org/apache/commons/bcel6/classfile/BootstrapMethod.java&lt;/p&gt;</comment>
                            <comment id="14713393" author="sebb@apache.org" created="Wed, 26 Aug 2015 13:14:34 +0000"  >&lt;p&gt;Oops!&lt;/p&gt;

&lt;p&gt;URL: &lt;a href=&quot;http://svn.apache.org/r1697925&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/r1697925&lt;/a&gt;&lt;br/&gt;
Log:&lt;br/&gt;
Follow-up to &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-209&quot; title=&quot;Bug fixes and improvements to InvokeDynamic and BootStrapMethods implementation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-209&quot;&gt;&lt;del&gt;BCEL-209&lt;/del&gt;&lt;/a&gt; Drop the field num_bootstrap_arguments&lt;br/&gt;
it is not necessary, and was not kept in sync if the arguments were updated&lt;br/&gt;
Oops - incomplete fix, now working&lt;/p&gt;

&lt;p&gt;Modified:&lt;br/&gt;
    commons/proper/bcel/trunk/src/main/java/org/apache/commons/bcel6/classfile/BootstrapMethod.java&lt;/p&gt;

&lt;p&gt;Modified: commons/proper/bce&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12776396">BCEL-213</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12697578" name="counter.diff" size="644" author="markro" created="Mon, 9 Feb 2015 22:22:28 +0000"/>
                            <attachment id="12697593" name="invoke4.diff" size="52808" author="markro" created="Mon, 9 Feb 2015 23:14:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 12 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i258zj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>