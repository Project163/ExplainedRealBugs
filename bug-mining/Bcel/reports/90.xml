<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:14:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[BCEL-304] ClassPath.getClassFile() and friends do not work with JDK 9 and higher</title>
                <link>https://issues.apache.org/jira/browse/BCEL-304</link>
                <project id="12314220" key="BCEL">Commons BCEL</project>
                    <description>&lt;p&gt;When trying to get the class file for Java classes (ie. java.lang.String), an IOException is thrown:&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.io.IOException: Couldn&apos;t find: java.lang.String.class&lt;br/&gt;
 at org.apache.bcel.util.ClassPath.getClassFile(ClassPath.java:279)&lt;br/&gt;
 at org.apache.bcel.util.ClassPath.getClassFile(ClassPath.java:301)&lt;br/&gt;
 at bcel.test.GetClassFileTest.main(GetClassFileTest.java:12)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The root cause appears to be the restructuring of Java starting with Java 9. Specifically, the removal of the rt.jar. The above excpetion can be reproduced using a simple application:&lt;/p&gt;


&lt;p&gt;package bcel.test;&lt;/p&gt;

&lt;p&gt;import java.io.IOException;&lt;/p&gt;

&lt;p&gt;import org.apache.bcel.util.ClassPath;&lt;/p&gt;

&lt;p&gt;public class GetClassFileTest {&lt;/p&gt;

&lt;p&gt;&#160; &#160;public static void main(String[] args) throws IOException {&lt;br/&gt;
&#160; &#160; &#160; String className = &quot;java.lang.String&quot;;&lt;br/&gt;
&#160; &#160; &#160; System.out.println(&quot;Looking up ClassPath.ClassFile for: &quot; + className);&lt;br/&gt;
&#160; &#160; &#160; ClassPath.ClassFile classFile = ClassPath.SYSTEM_CLASS_PATH.getClassFile(className);&lt;br/&gt;
&#160; &#160; &#160; if (classFile != null) &lt;/p&gt;
{
&#160; &#160; &#160; &#160; &#160;System.out.println(&quot;Class file base: &quot; + classFile.getBase());
&#160; &#160; &#160; &#160; &#160;System.out.println(&quot;Class file path: &quot; + classFile.getPath());
&#160; &#160; &#160; }
&lt;p&gt;&#160; &#160;}&lt;/p&gt;

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Running this on Java 8 produces the following output, whereas running it on Java 9+ produces the IOException:&lt;/p&gt;

&lt;p&gt;Class file base: C:\jdk1.8.0_161\jre\lib\rt.jar&lt;br/&gt;
Class file path: java/lang/String.class&lt;/p&gt;</description>
                <environment></environment>
        <key id="13172733">BCEL-304</key>
            <summary>ClassPath.getClassFile() and friends do not work with JDK 9 and higher</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggregory">Gary D. Gregory</assignee>
                                    <reporter username="epavlak">Ed Pavlak</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Jul 2018 18:53:36 +0000</created>
                <updated>Sat, 6 Oct 2018 05:00:44 +0000</updated>
                            <resolved>Sat, 28 Jul 2018 05:01:57 +0000</resolved>
                                    <version>6.2</version>
                                    <fixVersion>6.3</fixVersion>
                                    <component>Main</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16546994" author="epavlak" created="Tue, 17 Jul 2018 19:05:25 +0000"  >&lt;p&gt;I pulled the commons-bcel code to investigate and found a potential solution:&lt;/p&gt;

&lt;p&gt;1. In ClassPath.getClassPath(), add the *.jomd files in JAVA_HOME/jmods to the classpath list. (Perhaps include a property for greater flexibility.)&lt;/p&gt;

&lt;p&gt;2. In ClassPath.Zip.getClassFile(String, String), include logic to look up a ZipEntry in a .jmod file. The structure of the jmod file differs slightly from a jar file in that the .class files are in a classes directory so the zip.getEntry call needs to be told to look in that directory instead of the root.&lt;/p&gt;</comment>
                            <comment id="16553066" author="garydgregory" created="Mon, 23 Jul 2018 16:21:20 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=epavlak&quot; class=&quot;user-hover&quot; rel=&quot;epavlak&quot;&gt;epavlak&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;If you can provide a test case and/or solution via a GitHub PR &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;, that would greatly accelerate any possible resolution.&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/commons-bcel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-bcel&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16560235" author="githubbot" created="Fri, 27 Jul 2018 20:02:10 +0000"  >&lt;p&gt;GitHub user epavlak opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/commons-bcel/pull/22&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-bcel/pull/22&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-304&quot; title=&quot;ClassPath.getClassFile() and friends do not work with JDK 9 and higher&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-304&quot;&gt;&lt;del&gt;BCEL-304&lt;/del&gt;&lt;/a&gt; Include Java 9+ modules in path used by ClassPath.java&lt;/p&gt;

&lt;p&gt;    With the restructuring of Java .class files in Java 9 and higher to be in modules instead of the rt.jar, the ClassPath.getClassFile method would fail to find Java class files (ex: String.class). These modifications include the Java 9+ modules in the path used by ClassPath.java so that the .class files can be located.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/epavlak/commons-bcel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/epavlak/commons-bcel&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-304&quot; title=&quot;ClassPath.getClassFile() and friends do not work with JDK 9 and higher&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-304&quot;&gt;&lt;del&gt;BCEL-304&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/commons-bcel/pull/22.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-bcel/pull/22.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #22&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit e331171f168ab335b9756294406e85d9995731bd&lt;br/&gt;
Author: epavlak &amp;lt;epavlak@...&amp;gt;&lt;br/&gt;
Date:   2018-07-27T19:50:30Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-304&quot; title=&quot;ClassPath.getClassFile() and friends do not work with JDK 9 and higher&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-304&quot;&gt;&lt;del&gt;BCEL-304&lt;/del&gt;&lt;/a&gt; Include Java 9+ modules in path used by ClassPath.java&lt;/p&gt;

&lt;p&gt;commit 98157fb61a547d8d4fe40826d1f863a1c1f1c374&lt;br/&gt;
Author: epavlak &amp;lt;epavlak@...&amp;gt;&lt;br/&gt;
Date:   2018-07-27T19:53:58Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-304&quot; title=&quot;ClassPath.getClassFile() and friends do not work with JDK 9 and higher&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-304&quot;&gt;&lt;del&gt;BCEL-304&lt;/del&gt;&lt;/a&gt; Include Java 9+ modules in path used by ClassPath.java&lt;/p&gt;

&lt;p&gt;commit d5a73b6987eb262d90f809e3a2b77845fcce95d2&lt;br/&gt;
Author: epavlak &amp;lt;epavlak@...&amp;gt;&lt;br/&gt;
Date:   2018-07-27T19:56:57Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/BCEL-304&quot; title=&quot;ClassPath.getClassFile() and friends do not work with JDK 9 and higher&quot; class=&quot;issue-link&quot; data-issue-key=&quot;BCEL-304&quot;&gt;&lt;del&gt;BCEL-304&lt;/del&gt;&lt;/a&gt; Include Java 9+ modules in path used by ClassPath.java&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16560239" author="epavlak" created="Fri, 27 Jul 2018 20:02:58 +0000"  >&lt;p&gt;I have created a PR. This is my first time doing so. If I have done anything incorrectly, please let me know.&lt;/p&gt;</comment>
                            <comment id="16560504" author="garydgregory" created="Sat, 28 Jul 2018 00:03:15 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=epavlak&quot; class=&quot;user-hover&quot; rel=&quot;epavlak&quot;&gt;epavlak&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Thank you for your patch.&lt;/p&gt;

&lt;p&gt;The patch only works on a JDK, it does not solve the problem when running on a JRE since there is no jmods directory in a JRE &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="16560616" author="garydgregory" created="Sat, 28 Jul 2018 05:01:57 +0000"  >&lt;p&gt;I applied a&#160;quite reworked version of the patch and changed this ticket description to say &quot;JDK&quot; instead of &quot;Java&quot;. Dealing with a JRE will be in a new ticket.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=epavlak&quot; class=&quot;user-hover&quot; rel=&quot;epavlak&quot;&gt;epavlak&lt;/a&gt;: Please verifty and close.&lt;/p&gt;</comment>
                            <comment id="16560631" author="githubbot" created="Sat, 28 Jul 2018 05:45:52 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/commons-bcel/pull/22&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-bcel/pull/22&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16562299" author="epavlak" created="Mon, 30 Jul 2018 18:34:50 +0000"  >&lt;p&gt;Everything appears to be working as it should. Closing the defect.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;, thanks for everything on this one. Do you have any information on when this will be included in a release?&lt;/p&gt;</comment>
                            <comment id="16562345" author="garydgregory" created="Mon, 30 Jul 2018 18:47:46 +0000"  >&lt;p&gt;Nothing is scheduled ATM. If I were you I would tests the SNAPSHOT build out the wazoo on your Java 9 or above set up and report back on the dev mailing list once you are certain that nothing is missing or broken WRT Java &amp;gt;= 9.&lt;/p&gt;</comment>
                            <comment id="16632085" author="epavlak" created="Fri, 28 Sep 2018 16:23:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;, I wanted to follow-up and see if you had any information on when the 6.3 release will be available. It&apos;s becoming somewhat of a hot topic for us as we move applications to Java 9+. Thanks.&lt;/p&gt;</comment>
                            <comment id="16640562" author="garydgregory" created="Sat, 6 Oct 2018 05:00:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=epavlak&quot; class=&quot;user-hover&quot; rel=&quot;epavlak&quot;&gt;epavlak&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;We do not have a release planned ATM. You might want to ping the dev mailing list and raise awareness for your need for a release.&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13175315">BCEL-305</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 6 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                            <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3vzo7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>