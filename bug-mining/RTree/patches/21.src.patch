diff --git a/src/main/java/com/github/davidmoten/rtree/geometry/Line.java b/src/main/java/com/github/davidmoten/rtree/geometry/Line.java
index 0bedee9..c86f5a5 100644
--- a/src/main/java/com/github/davidmoten/rtree/geometry/Line.java
+++ b/src/main/java/com/github/davidmoten/rtree/geometry/Line.java
@@ -3,13 +3,8 @@ package com.github.davidmoten.rtree.geometry;
 import com.github.davidmoten.guavamini.Objects;
 import com.github.davidmoten.guavamini.Optional;
 import com.github.davidmoten.rtree.internal.Line2D;
+import com.github.davidmoten.rtree.internal.Rectangle2D;
 import com.github.davidmoten.rtree.internal.util.ObjectsHelper;
-import com.vividsolutions.jts.geom.Coordinate;
-import com.vividsolutions.jts.geom.GeometryFactory;
-import com.vividsolutions.jts.geom.LineSegment;
-import com.vividsolutions.jts.geom.Polygon;
-import com.vividsolutions.jts.operation.predicate.RectangleIntersects;
-import com.vividsolutions.jts.util.GeometricShapeFactory;
 
 /**
  * A line segment.
@@ -77,14 +72,8 @@ public final class Line implements Geometry {
 
     @Override
     public boolean intersects(Rectangle r) {
-        GeometryFactory gf = new GeometryFactory();
-        GeometricShapeFactory f = new GeometricShapeFactory(gf);
-        f.setBase(new Coordinate(r.x1(), r.y1()));
-        f.setWidth(r.x2() - r.x1());
-        f.setHeight(r.y2() - r.y1());
-        Polygon rect = f.createRectangle();
-        LineSegment line = new LineSegment(x1, y1, x2, y2);
-        return RectangleIntersects.intersects(rect, line.toGeometry(gf));
+        return Rectangle2D.rectangleIntersectsLine(r.x1(), r.y1(), r.x2() - r.x1(), r.y2() - r.y1(),
+                x1, y1, x2, y2);
     }
 
     public float x1() {
@@ -190,5 +179,5 @@ public final class Line implements Geometry {
         }
 
     }
-    
+
 }
diff --git a/src/main/java/com/github/davidmoten/rtree/internal/Line2D.java b/src/main/java/com/github/davidmoten/rtree/internal/Line2D.java
index 26bd783..09332b5 100644
--- a/src/main/java/com/github/davidmoten/rtree/internal/Line2D.java
+++ b/src/main/java/com/github/davidmoten/rtree/internal/Line2D.java
@@ -283,5 +283,4 @@ public final class Line2D {
         }
         return (ccw < 0.0) ? -1 : ((ccw > 0.0) ? 1 : 0);
     }
-
 }
diff --git a/src/main/java/com/github/davidmoten/rtree/internal/Rectangle2D.java b/src/main/java/com/github/davidmoten/rtree/internal/Rectangle2D.java
new file mode 100644
index 0000000..057589c
--- /dev/null
+++ b/src/main/java/com/github/davidmoten/rtree/internal/Rectangle2D.java
@@ -0,0 +1,86 @@
+package com.github.davidmoten.rtree.internal;
+
+public class Rectangle2D {
+
+    /**
+     * The bitmask that indicates that a point lies to the left of this
+     * <code>Rectangle2D</code>.
+     * 
+     * @since 1.2
+     */
+    public static final int OUT_LEFT = 1;
+
+    /**
+     * The bitmask that indicates that a point lies above this
+     * <code>Rectangle2D</code>.
+     * 
+     * @since 1.2
+     */
+    public static final int OUT_TOP = 2;
+
+    /**
+     * The bitmask that indicates that a point lies to the right of this
+     * <code>Rectangle2D</code>.
+     * 
+     * @since 1.2
+     */
+    public static final int OUT_RIGHT = 4;
+
+    /**
+     * The bitmask that indicates that a point lies below this
+     * <code>Rectangle2D</code>.
+     * 
+     * @since 1.2
+     */
+    public static final int OUT_BOTTOM = 8;
+
+    public static boolean rectangleIntersectsLine(double rectX, double rectY, double rectWidth,
+            double rectHeight, double x1, double y1, double x2, double y2) {
+        int out1, out2;
+        if ((out2 = outcode(rectX, rectY, rectWidth, rectHeight, x2, y2)) == 0) {
+            return true;
+        }
+        while ((out1 = outcode(rectX, rectY, rectWidth, rectHeight, x1, y1)) != 0) {
+            if ((out1 & out2) != 0) {
+                return false;
+            }
+            if ((out1 & (OUT_LEFT | OUT_RIGHT)) != 0) {
+                double x = rectX;
+                if ((out1 & OUT_RIGHT) != 0) {
+                    x += rectWidth;
+                }
+                y1 = y1 + (x - x1) * (y2 - y1) / (x2 - x1);
+                x1 = x;
+            } else {
+                double y = rectY;
+                if ((out1 & OUT_BOTTOM) != 0) {
+                    y += rectHeight;
+                }
+                x1 = x1 + (y - y1) * (x2 - x1) / (y2 - y1);
+                y1 = y;
+            }
+        }
+        return true;
+    }
+
+    private static int outcode(double rectX, double rectY, double rectWidth, double rectHeight,
+            double x, double y) {
+        int out = 0;
+        if (rectWidth <= 0) {
+            out |= OUT_LEFT | OUT_RIGHT;
+        } else if (x < rectX) {
+            out |= OUT_LEFT;
+        } else if (x > rectX + rectWidth) {
+            out |= OUT_RIGHT;
+        }
+        if (rectHeight <= 0) {
+            out |= OUT_TOP | OUT_BOTTOM;
+        } else if (y < rectY) {
+            out |= OUT_TOP;
+        } else if (y > rectY + rectHeight) {
+            out |= OUT_BOTTOM;
+        }
+        return out;
+    }
+
+}
