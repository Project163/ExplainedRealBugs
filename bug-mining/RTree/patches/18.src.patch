diff --git a/src/main/java/com/github/davidmoten/rtree/fbs/SerializerFlatBuffers.java b/src/main/java/com/github/davidmoten/rtree/fbs/SerializerFlatBuffers.java
index aa1a46c..575a571 100644
--- a/src/main/java/com/github/davidmoten/rtree/fbs/SerializerFlatBuffers.java
+++ b/src/main/java/com/github/davidmoten/rtree/fbs/SerializerFlatBuffers.java
@@ -160,9 +160,15 @@ public final class SerializerFlatBuffers<T, S extends Geometry> implements Seria
     @VisibleForTesting
     static byte[] readFully(InputStream is, int numBytes) throws IOException {
         byte[] b = new byte[numBytes];
-        int n = is.read(b);
-        if (n != numBytes)
-            throw new RuntimeException("unexpected");
+        int count = 0;
+        do {
+            int n = is.read(b, count, numBytes - count);
+            if (n > 0) {
+                count += n;
+            } else {
+                throw new RuntimeException("unexpected");
+            }
+        } while (count < numBytes);
         return b;
     }
 
diff --git a/src/test/java/com/github/davidmoten/rtree/fbs/SerializerFlatBuffersTest.java b/src/test/java/com/github/davidmoten/rtree/fbs/SerializerFlatBuffersTest.java
index 695957f..12ba447 100644
--- a/src/test/java/com/github/davidmoten/rtree/fbs/SerializerFlatBuffersTest.java
+++ b/src/test/java/com/github/davidmoten/rtree/fbs/SerializerFlatBuffersTest.java
@@ -108,6 +108,30 @@ public class SerializerFlatBuffersTest {
     public void testInputStreamNotAsLongAsExpected() throws IOException {
         SerializerFlatBuffers.readFully(new ByteArrayInputStream(new byte[10]), 12);
     }
+    
+    @Test
+    public void testInputStreamReturnsArrayInSmallChunks() throws IOException {
+        InputStream is = new InputStream() {
+
+            int i = 0;
+            @Override
+            public int read() throws IOException {
+                i +=1;
+                if (i == 1) {
+                    return 1;
+                } else if (i==2){
+                    throw new IOException();
+                } else {
+                    return 1;
+                }
+            }
+            
+        };
+        byte[] b = SerializerFlatBuffers.readFully(is, 2);
+        assertEquals(2, b.length);
+        assertEquals(1, b[0]);
+        assertEquals(1, b[0]);
+    }
 
     public static void main(String[] args) throws Exception {
         // use this with jvisualvm and heap dump, find biggest objects to check
