<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:32:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-344] Log4j2 doesnt work with Weblogic 12c</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-344</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;I get a &quot;Context destroyed before it was initialized&quot; exception, the problem seems to be that the servlet filters init method is not being called by WebLogic, not sure why...&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows XP SP 3&lt;/p&gt;</environment>
        <key id="12663178">LOG4J2-344</key>
            <summary>Log4j2 doesnt work with Weblogic 12c</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="beamerblvd">Nick Williams</assignee>
                                    <reporter username="keirlawson">Keir</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Aug 2013 09:46:36 +0000</created>
                <updated>Tue, 28 Jan 2014 05:04:02 +0000</updated>
                            <resolved>Tue, 28 Jan 2014 05:04:02 +0000</resolved>
                                    <version>2.0-beta8</version>
                                    <fixVersion>2.0-rc1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>11</watches>
                                                                                                                <comments>
                            <comment id="13736768" author="remkop@yahoo.com" created="Mon, 12 Aug 2013 11:19:58 +0000"  >&lt;p&gt;Could you post a full stack trace, your log4j config, and which log4j jars your have in your classpath?&lt;/p&gt;</comment>
                            <comment id="13741934" author="remkop@yahoo.com" created="Fri, 16 Aug 2013 05:24:39 +0000"  >&lt;p&gt;Keir, do you have any additional information? This does not give us much to go on...&lt;/p&gt;</comment>
                            <comment id="13742017" author="keirlawson" created="Fri, 16 Aug 2013 08:06:51 +0000"  >&lt;p&gt;Sorry, been away, will post up later today&lt;/p&gt;</comment>
                            <comment id="13742319" author="keirlawson" created="Fri, 16 Aug 2013 15:44:15 +0000"  >&lt;p&gt;&amp;lt;16-Aug-2013 16:42:48 o&apos;clock BST&amp;gt; &amp;lt;Error&amp;gt; &amp;lt;HTTP&amp;gt; &amp;lt;BEA-101020&amp;gt; &amp;lt;[ServletContext@21622502&lt;span class=&quot;error&quot;&gt;&amp;#91;app:_auto_generated_ear_ module:myapp path:null spec-version:3.0&amp;#93;&lt;/span&gt;] Servlet failed with an Exception&lt;br/&gt;
java.lang.NullPointerException&lt;br/&gt;
	at org.apache.logging.log4j.core.web.Log4jServletFilter.doFilter(Log4jServletFilter.java:68)&lt;br/&gt;
	at weblogic.servlet.internal.FilterChainImpl.doFilter(FilterChainImpl.java:74)&lt;br/&gt;
	at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.wrapRun(WebAppServletContext.java:3288)&lt;br/&gt;
	at weblogic.servlet.internal.WebAppServletContext$ServletInvocationAction.run(WebAppServletContext.java:3254)&lt;br/&gt;
	at weblogic.security.acl.internal.AuthenticatedSubject.doAs(AuthenticatedSubject.java:321)&lt;br/&gt;
	Truncated. see log file for complete stacktrace&lt;/p&gt;</comment>
                            <comment id="13742320" author="keirlawson" created="Fri, 16 Aug 2013 15:44:52 +0000"  >&lt;p&gt;&amp;lt;dependency&amp;gt;&lt;br/&gt;
			&amp;lt;groupId&amp;gt;org.apache.logging.log4j&amp;lt;/groupId&amp;gt;&lt;br/&gt;
			&amp;lt;artifactId&amp;gt;log4j-api&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
			&amp;lt;version&amp;gt;2.0-beta8&amp;lt;/version&amp;gt;&lt;br/&gt;
		&amp;lt;/dependency&amp;gt;&lt;br/&gt;
		&amp;lt;dependency&amp;gt;&lt;br/&gt;
			&amp;lt;groupId&amp;gt;org.apache.logging.log4j&amp;lt;/groupId&amp;gt;&lt;br/&gt;
			&amp;lt;artifactId&amp;gt;log4j-core&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
			&amp;lt;version&amp;gt;2.0-beta8&amp;lt;/version&amp;gt;&lt;br/&gt;
		&amp;lt;/dependency&amp;gt;&lt;br/&gt;
		 &amp;lt;dependency&amp;gt;&lt;br/&gt;
			&amp;lt;groupId&amp;gt;org.apache.logging.log4j&amp;lt;/groupId&amp;gt;&lt;br/&gt;
			&amp;lt;artifactId&amp;gt;log4j-slf4j-impl&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
			&amp;lt;version&amp;gt;2.0-beta8&amp;lt;/version&amp;gt;&lt;br/&gt;
		&amp;lt;/dependency&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13742323" author="keirlawson" created="Fri, 16 Aug 2013 15:46:21 +0000"  >&lt;p&gt;&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;configuration&amp;gt;&lt;br/&gt;
	&amp;lt;appenders&amp;gt;&lt;br/&gt;
		&amp;lt;Console name=&quot;Console&quot; target=&quot;SYSTEM_OUT&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;PatternLayout pattern=&quot;[%d&lt;/p&gt;
{HH:mm:ss}
&lt;p&gt; %-5level]%msg (%logger&lt;/p&gt;
{3.}
&lt;p&gt;)%n&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;/Console&amp;gt;&lt;br/&gt;
	&amp;lt;/appenders&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;loggers&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;!-- Application Loggers --&amp;gt;&lt;br/&gt;
		&amp;lt;logger name=&quot;com.myapp&quot; level=&quot;info&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;!-- 3rdparty Loggers --&amp;gt;&lt;br/&gt;
		&amp;lt;logger name=&quot;org.springframework.core&quot; level=&quot;warn&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;logger name=&quot;org.springframework.beans&quot; level=&quot;warn&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;logger name=&quot;org.springframework.context&quot; level=&quot;warn&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;logger name=&quot;org.springframework.web&quot; level=&quot;warn&quot;/&amp;gt;&lt;br/&gt;
		&amp;lt;logger name=&quot;org.springframework.security&quot; level=&quot;warn&quot;/&amp;gt;&lt;/p&gt;

&lt;p&gt;		&amp;lt;!-- Root Logger --&amp;gt;&lt;br/&gt;
		&amp;lt;root level=&quot;info&quot;&amp;gt;&lt;br/&gt;
			&amp;lt;appender-ref ref=&quot;Console&quot; /&amp;gt;&lt;br/&gt;
		&amp;lt;/root&amp;gt;&lt;/p&gt;

&lt;p&gt;	&amp;lt;/loggers&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;/configuration&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13742334" author="garydgregory" created="Fri, 16 Aug 2013 15:55:12 +0000"  >&lt;p&gt;Hm... it looks like the &lt;tt&gt;initializer&lt;/tt&gt; is null. We must have one of:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;The thread that assigned the filter&apos;s &lt;tt&gt;initializer&lt;/tt&gt; is different from the thread calling &lt;tt&gt;doFilter()&lt;/tt&gt; and the change to &lt;tt&gt;initializer&lt;/tt&gt; is not visible to the &lt;tt&gt;doFilter()&lt;/tt&gt; thread, making the initializer volatile may be required.&lt;/li&gt;
	&lt;li&gt;A race condition whereby the filter&apos;s init method is not done before doFilter is called from a different thread.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13742370" author="ralph.goers@dslextreme.com" created="Fri, 16 Aug 2013 16:36:36 +0000"  >&lt;p&gt;The javadoc for init says - &quot;The init method must complete successfully before the filter is asked to do any filtering work.&quot;.  Neither of your two possibilities are allowed with this required behavior.&lt;/p&gt;

&lt;p&gt;Actually, I guess I could see how the first bullet could happen except every servlet filter example you will find doesn&apos;t do that.&lt;/p&gt;</comment>
                            <comment id="13742601" author="garydgregory" created="Fri, 16 Aug 2013 21:01:55 +0000"  >&lt;p&gt;And yet there is the NPE &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13742618" author="beamerblvd" created="Fri, 16 Aug 2013 21:29:24 +0000"  >&lt;p&gt;The stack trace in question can &lt;em&gt;&lt;b&gt;ONLY&lt;/b&gt;&lt;/em&gt; happen if WebLogic is in violation of the spec. WebLogic is either calling &lt;tt&gt;doFilter&lt;/tt&gt; before it calls &lt;tt&gt;init&lt;/tt&gt; or calling &lt;tt&gt;doFilter&lt;/tt&gt; after it calls &lt;tt&gt;destroy&lt;/tt&gt;, both of which are illegal behaviors. You need to contact WebLogic support for assistance.&lt;/p&gt;</comment>
                            <comment id="13742647" author="garydgregory" created="Fri, 16 Aug 2013 22:11:35 +0000"  >&lt;p&gt;Should we bullet-proof our filter such that it logs errors instead of throwing NPEs?&lt;/p&gt;</comment>
                            <comment id="13742657" author="beamerblvd" created="Fri, 16 Aug 2013 22:20:00 +0000"  >&lt;p&gt;I thought about it, but doing so makes me nervous. This would mask implementation problems in the container. If thousands of Log4j users complain to WebLogic because their applications won&apos;t work, such a bug is going to get fixed really quickly...&lt;/p&gt;

&lt;p&gt;I think we should probably contact Oracle and report the problem and see whether we think they&apos;ll act on it in a reasonable timeframe before we make such a move.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Important&lt;/b&gt;&lt;br/&gt;
I suppose it&apos;s &lt;em&gt;possible&lt;/em&gt; there&apos;s something wrong with &lt;tt&gt;org.apache.logging.log4j.core.web.Log4jWebInitializerImpl#getLog4jWebInitializer(ServletContext)&lt;/tt&gt;, such that it can return a &lt;tt&gt;null&lt;/tt&gt; value, but:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Reading the code again, I can&apos;t for the life of me understand how it could possibly return &lt;tt&gt;null&lt;/tt&gt;; and,&lt;/li&gt;
	&lt;li&gt;If it did return &lt;tt&gt;null&lt;/tt&gt;, we should also be seeing an NPE from line 52 in &lt;tt&gt;init&lt;/tt&gt;.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13742664" author="remkop@yahoo.com" created="Fri, 16 Aug 2013 22:25:49 +0000"  >&lt;p&gt;Keir,&lt;/p&gt;

&lt;p&gt;Your stacktrace says &quot;Truncated. see log file for complete stacktrace&quot;.&lt;br/&gt;
Can you attach the full stack trace from the log?&lt;br/&gt;
It may be possible to answer the questions raised above when we have more information...&lt;/p&gt;</comment>
                            <comment id="13742672" author="beamerblvd" created="Fri, 16 Aug 2013 22:30:21 +0000"  >&lt;p&gt;Keir, just for kicks, can you also post your &lt;tt&gt;web.xml&lt;/tt&gt; configuration? It&apos;s &lt;em&gt;possible&lt;/em&gt; this is related to &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-359&quot; title=&quot;Log4jServletContextListener does not work on Weblogic 12.1.1 (12c) with web-app version &amp;quot;2.5&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-359&quot;&gt;&lt;del&gt;LOG4J2-359&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13742690" author="remkop@yahoo.com" created="Fri, 16 Aug 2013 22:50:37 +0000"  >&lt;p&gt;Keir, it would also be good to know if your log contains the string &quot;Log4jServletFilter initialized.&quot; before the error occurred.&lt;/p&gt;</comment>
                            <comment id="13743613" author="keirlawson" created="Mon, 19 Aug 2013 08:01:13 +0000"  >&lt;p&gt;Don&apos;t see &quot;Log4jServletFilter initialized.&quot; though my log level is set to info so if its a debug message then I wouldn&apos;t. Not sure where to find the log file, I have only specified a console appender? Will attach web.xml.&lt;/p&gt;</comment>
                            <comment id="13774493" author="spacetom" created="Mon, 23 Sep 2013 12:07:10 +0000"  >&lt;p&gt;I had the same issue. My investigation showed that when you add servlet filter using ServletContext.addFilter(java.lang.String filterName, Filter filter) WebLogic does not invoke filter&apos;s init method. Most probably assuming that you were to do it as you created the instance. When I changed it to addFilter(java.lang.String filterName, java.lang.String className) everything worked in order.&lt;/p&gt;</comment>
                            <comment id="13774594" author="beamerblvd" created="Mon, 23 Sep 2013 14:45:27 +0000"  >&lt;p&gt;Thanks for discovering this, Tomasz! I don&apos;t have access to a WebLogic environment, so it&apos;s hard for me to troubleshoot. I &lt;em&gt;suspect&lt;/em&gt; that WebLogic&apos;s behavior here is a violation of the spec (reasoning: it would be invalid to initialize the filter at the time you call &lt;tt&gt;addFilter&lt;/tt&gt;, because the filter is supposed to be initialized at a later phase of the application lifecycle). However, now it looks like we have a non-hacky approach to solving this problem.&lt;/p&gt;

&lt;p&gt;Can you try out one thing for me? I&apos;m wondering if using &lt;tt&gt;addFilter(String filterName, Class&amp;lt;? extends Filter&amp;gt; filterClass)&lt;/tt&gt; works as well. This would be preferable, as it would be more compile safe. Let me know whether that works, and then I&apos;ll make the change.&lt;/p&gt;</comment>
                            <comment id="13775582" author="spacetom" created="Mon, 23 Sep 2013 19:14:17 +0000"  >&lt;p&gt;I switched addFilter to the one with Class parameter and it worked well so if this solution works with other containers you got the solution &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. For test purposes I used 2.0-beta9 code and WebLogic 12.1.1.0.&lt;/p&gt;

&lt;p&gt;My guess was not thoroughly thought through. It seems that there is a bug in WebLogic. I tried to find any information on the internet but without success.&lt;/p&gt;</comment>
                            <comment id="13800129" author="mothsolutions" created="Sun, 20 Oct 2013 11:57:55 +0000"  >&lt;p&gt;Just confirming I&apos;ve seen the same issue on WebLogic 12c and the changes recommended above were successful. The change has also been successfully tested on Glassfish (3.1 and 4.0) and Tomcat 7.0.42.  We&apos;ve also tested on Weblogic 10.3.6 but this is a 2.5 Servlet container so different configuration approach.&lt;/p&gt;</comment>
                            <comment id="13820635" author="henkawaza" created="Tue, 12 Nov 2013 23:20:30 +0000"  >&lt;p&gt;In which class is the method addFilter that you commmented?&lt;/p&gt;</comment>
                            <comment id="13820677" author="mothsolutions" created="Tue, 12 Nov 2013 23:48:21 +0000"  >&lt;p&gt;Change is carried out in org.apache.logging.log4j.core.web.Log4jServletContainerInitializer &lt;/p&gt;
</comment>
                            <comment id="13862680" author="jvz" created="Sun, 5 Jan 2014 22:52:37 +0000"  >&lt;p&gt;These seem like similar bugs.&lt;/p&gt;</comment>
                            <comment id="13881015" author="marcoantonelli" created="Fri, 24 Jan 2014 14:50:33 +0000"  >&lt;p&gt;Hi there, any news on this issue?&lt;/p&gt;</comment>
                            <comment id="13883755" author="beamerblvd" created="Tue, 28 Jan 2014 05:04:02 +0000"  >&lt;p&gt;Sorry for the delay. This has been fixed with r1561937.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12664156">LOG4J2-359</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12669209">SYNCOPE-414</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12598719" name="web.xml" size="1840" author="keirlawson" created="Mon, 19 Aug 2013 08:02:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343179</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 43 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n6lr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343483</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>