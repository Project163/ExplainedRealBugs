<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:40:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2564] Error using %K in pattern : MapPatternConverter cannot contain multiple static newInstance method</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2564</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;When using a %K in a pattern, the MapPatterConverter is used and there is an error message :&lt;/p&gt;

&lt;p&gt;ERROR Class class org.apache.logging.log4j.core.pattern.MapPatternConverter cannot contain multiple static newInstance methods&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The control is done by org.apache.logging.log4j.core.pattern.PatternParser.createConverter here :&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160;&lt;em&gt;// Work around the regression bug in Class.getDeclaredMethods() in Oracle Java in version &amp;gt; 1.6.0_17:&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; _// &lt;a href=&quot;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6815786_&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://bugs.sun.com/bugdatabase/view_bug.do?bug_id=6815786_&lt;/a&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;final Method[] methods = converterClass.getDeclaredMethods();&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;Method newInstanceMethod = null;&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;for (final Method method : methods) {&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;if (Modifier.isStatic(method.getModifiers()) &amp;amp;&amp;amp; method.getDeclaringClass().equals(converterClass)&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;&amp;amp;&amp;amp; method.getName().equals(&quot;newInstance&quot;)) {&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;if (newInstanceMethod == null) {&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;newInstanceMethod = method;&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;} else if (method.getReturnType().equals(newInstanceMethod.getReturnType())) {&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;LOGGER.error(&quot;Class &quot; + converterClass + &quot; cannot contain multiple static newInstance methods&quot;);&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;return null;&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;}&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;}&lt;/em&gt;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;}&lt;/em&gt;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The class org.apache.logging.log4j.core.pattern.MapPatternConverter contains 2 &lt;b&gt;newInstances&lt;/b&gt; message (teh second introduced in 2.11.2)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;em&gt;/**&lt;/em&gt;&lt;br/&gt;
&#160;&#160;&#160;&#160; &lt;em&gt;* Obtains an instance of {@link MapPatternConverter}.&lt;/em&gt;&lt;br/&gt;
&#160;&#160;&#160;&#160; &lt;em&gt;*&lt;/em&gt;&lt;br/&gt;
&#160;&#160;&#160;&#160; &lt;em&gt;* @param options options, may be null or first element contains name of property to format.&lt;/em&gt;&lt;br/&gt;
&#160;&#160;&#160;&#160; &lt;em&gt;* @return instance of {@link MapPatternConverter}.&lt;/em&gt;&lt;br/&gt;
&#160;&#160;&#160;&#160; &lt;em&gt;*/&lt;/em&gt;&lt;br/&gt;
&#160;&#160;&#160; &lt;em&gt;public static MapPatternConverter newInstance(final String[] options) {&lt;/em&gt;&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;return new MapPatternConverter(options, JAVA_UNQUOTED);&lt;/em&gt;&lt;br/&gt;
&#160;&#160;&#160; &lt;em&gt;}&lt;/em&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#d04437&quot;&gt;&#160;&#160;&#160; &lt;em&gt;/**&lt;/em&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#d04437&quot;&gt;&#160;&#160;&#160;&#160; &lt;em&gt;* Obtain an instance of {@link MapPatternConverter}.&lt;/em&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#d04437&quot;&gt;&#160;&#160;&#160;&#160; &lt;em&gt;*&lt;/em&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#d04437&quot;&gt;&#160;&#160;&#160;&#160; &lt;em&gt;* @param options options, may be null or first element contains name of property to format.&lt;/em&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#d04437&quot;&gt;&#160;&#160;&#160;&#160; &lt;em&gt;* @param format the format to use if no options are given (i.e., options is null). Ignored if options is non-null.&lt;/em&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#d04437&quot;&gt;&#160;&#160;&#160;&#160; &lt;em&gt;* @return instance of {@link MapPatternConverter}.&lt;/em&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#d04437&quot;&gt;&#160;&#160;&#160;&#160; &lt;em&gt;* @since 2.11.2&lt;/em&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#d04437&quot;&gt;&#160;&#160;&#160;&#160; &lt;em&gt;*/&lt;/em&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#d04437&quot;&gt;&#160;&#160;&#160; &lt;em&gt;public static MapPatternConverter newInstance(final String[] options, final MapFormat format) {&lt;/em&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#d04437&quot;&gt;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;em&gt;return new MapPatternConverter(options, Objects.toString(format, JAVA_UNQUOTED));&lt;/em&gt;&lt;/font&gt;&lt;br/&gt;
&lt;font color=&quot;#d04437&quot;&gt;&#160;&#160;&#160; &lt;em&gt;}&lt;/em&gt;&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13221340">LOG4J2-2564</key>
            <summary>Error using %K in pattern : MapPatternConverter cannot contain multiple static newInstance method</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ckozak">Carter Kozak</assignee>
                                    <reporter username="anthonyC">Anthony Communier</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 Mar 2019 08:59:33 +0000</created>
                <updated>Sun, 23 Jun 2019 05:36:01 +0000</updated>
                            <resolved>Tue, 14 May 2019 15:02:59 +0000</resolved>
                                    <version>2.11.2</version>
                                    <fixVersion>2.12.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16792869" author="garydgregory" created="Thu, 14 Mar 2019 17:10:28 +0000"  >&lt;p&gt;It seems we are missing a unit test to catch this case.&lt;/p&gt;</comment>
                            <comment id="16838926" author="falmarri" created="Mon, 13 May 2019 22:51:25 +0000"  >&lt;p&gt;Any update on this? What is the desired fix? Remove a newinstance method? Or allow multiple?&lt;/p&gt;</comment>
                            <comment id="16838965" author="ralph.goers@dslextreme.com" created="Tue, 14 May 2019 00:17:42 +0000"  >&lt;p&gt;It isn&apos;t clear to me why the second newInstance method was added. It is only used in a test. Before proceeding we need to create a test that exercises this. That should be easy.&lt;/p&gt;</comment>
                            <comment id="16839055" author="ckozak" created="Tue, 14 May 2019 03:50:53 +0000"  >&lt;p&gt;Potential fix, with a test that fails on master: &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/268&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/268&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It&apos;s unfortunate that there&apos;s no way to configure the map format from a pattern, that would be better than the second newInstance factory.&lt;/p&gt;</comment>
                            <comment id="16839084" author="ralph.goers@dslextreme.com" created="Tue, 14 May 2019 05:15:55 +0000"  >&lt;p&gt;Other than my one comment the fix looks good. It also needs to be applied to release-2.x.&lt;/p&gt;</comment>
                            <comment id="16839445" author="ckozak" created="Tue, 14 May 2019 14:14:13 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ralph.goers%40dslextreme.com&quot; class=&quot;user-hover&quot; rel=&quot;ralph.goers@dslextreme.com&quot;&gt;ralph.goers@dslextreme.com&lt;/a&gt;. Did you submit the review comment? I don&apos;t see it on the commit or PR. Apologies if I&apos;ve missed it.&lt;/p&gt;</comment>
                            <comment id="16839481" author="ralph.goers@dslextreme.com" created="Tue, 14 May 2019 14:43:10 +0000"  >&lt;p&gt;I thought I did. My comment was that it looked like you added the action to changes.xml in 2 places; once under 2.11.2 and again in 3.0. If it is added in 2.11.2 then it should not be added to 3.0 as it won&apos;t be a new feature/fix in that release.&lt;/p&gt;</comment>
                            <comment id="16839486" author="jira-bot" created="Tue, 14 May 2019 14:49:26 +0000"  >&lt;p&gt;Commit a6b1cbfc9d4257baaa6760e58426f0f4dfa99b0f in logging-log4j2&apos;s branch refs/heads/master from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=a6b1cbf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=a6b1cbf&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2564&quot; title=&quot;Error using %K in pattern : MapPatternConverter cannot contain multiple static newInstance method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2564&quot;&gt;&lt;del&gt;LOG4J2-2564&lt;/del&gt;&lt;/a&gt;: PatternParser chooses newInstance methods with known parameters&lt;/p&gt;

&lt;p&gt;Fixes MapPatternConverter, which contains two newInstance methods where&lt;br/&gt;
only one can be created using the PatternParser factory.&lt;/p&gt;</comment>
                            <comment id="16839490" author="jira-bot" created="Tue, 14 May 2019 14:51:43 +0000"  >&lt;p&gt;Commit 173cda59736e3a5f9d01fa1e5999b9c588d4841d in logging-log4j2&apos;s branch refs/heads/release-2.x from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=173cda5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=173cda5&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2564&quot; title=&quot;Error using %K in pattern : MapPatternConverter cannot contain multiple static newInstance method&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2564&quot;&gt;&lt;del&gt;LOG4J2-2564&lt;/del&gt;&lt;/a&gt;: PatternParser chooses newInstance methods with known parameters&lt;/p&gt;

&lt;p&gt;Fixes MapPatternConverter, which contains two newInstance methods where&lt;br/&gt;
only one can be created using the PatternParser factory.&lt;/p&gt;</comment>
                            <comment id="16839504" author="ckozak" created="Tue, 14 May 2019 14:51:58 +0000"  >&lt;p&gt;Oh that&apos;s a good point, thanks Ralph. I&apos;ve updated and merged.&lt;/p&gt;</comment>
                            <comment id="16839538" author="ckozak" created="Tue, 14 May 2019 15:05:37 +0000"  >&lt;p&gt;Verifying this as I was able to fully reproduce the problem in a test, then fix the broken test.&lt;/p&gt;</comment>
                            <comment id="16870436" author="falmarri" created="Sun, 23 Jun 2019 05:08:09 +0000"  >&lt;p&gt;Is there a timeline for a release that will include this fix?&lt;/p&gt;</comment>
                            <comment id="16870440" author="ralph.goers@dslextreme.com" created="Sun, 23 Jun 2019 05:36:01 +0000"  >&lt;p&gt;I plan to perform the release build for 2.12.0 tomorrow. After the build is done it has to be voted on. If there are no problems the vote will remain open for 72hrs. If there are problems then a new release candidate would have to be created and voted on.&#160;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 21 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z00neo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>