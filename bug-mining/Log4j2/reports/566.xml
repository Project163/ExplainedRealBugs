<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:34:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-962] Main Arguments Lookup not working</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-962</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;It is not possible to use the Main Arguments Lookup in the current version. The &quot;main&quot; prefix is not present in the corresponding Interpolator object and thus the resolution of the variable is not working as advertised in the documentation, e.g. using the following variable in the log4j2.xml:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;${main:0}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As far as I can tell, the problem seems to stem from the PluginManger.collectPlugins-Method that does not acknowledge the existence of the Main Arguments Lookup.&lt;/p&gt;

&lt;p&gt;I&apos;m following the documentation on the website with the following sample log4j2.xml:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;File name=&lt;span class=&quot;code-quote&quot;&gt;&quot;GLOBAL&quot;&lt;/span&gt; fileName=&lt;span class=&quot;code-quote&quot;&gt;&quot;${env:DATA_DIR}/log/${env:APP_NAME}.log&quot;&lt;/span&gt; &amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;PatternLayout pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;%m%n&quot;&lt;/span&gt; header=&lt;span class=&quot;code-quote&quot;&gt;&quot;File: ${main:0}&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
    ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...and following code in my application:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
    MapLookup.setMainArguments(args);
    ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Windows 7 x64, Java Batch Application&lt;/p&gt;</environment>
        <key id="12777530">LOG4J2-962</key>
            <summary>Main Arguments Lookup not working</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="johannes.siebel@debeka.de">Johannes Siebel</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Feb 2015 13:26:34 +0000</created>
                <updated>Wed, 2 Sep 2015 16:59:18 +0000</updated>
                            <resolved>Wed, 2 Sep 2015 16:58:49 +0000</resolved>
                                    <version>2.1</version>
                                    <fixVersion>2.4</fixVersion>
                                    <component>Lookups</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14342500" author="garydgregory" created="Sun, 1 Mar 2015 22:19:28 +0000"  >&lt;p&gt;Do you call &lt;tt&gt;MapLookup.setMainArguments(args);&lt;/tt&gt; as documented on &lt;a href=&quot;https://logging.apache.org/log4j/2.x/manual/lookups.html#AppMainArgsLookup&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://logging.apache.org/log4j/2.x/manual/lookups.html#AppMainArgsLookup&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="14342914" author="johannes.siebel@debeka.de" created="Mon, 2 Mar 2015 08:30:14 +0000"  >&lt;p&gt;Yes. I&apos;ve added that information to the ticket. I&apos;m also using Weld SE in the same application and I&apos;m not sure if there&apos;s some possibility that these components interfere with each other.&lt;/p&gt;</comment>
                            <comment id="14644388" author="fleuryro" created="Tue, 28 Jul 2015 13:52:19 +0000"  >&lt;p&gt;Hello, do you plan to provide a fix for this ticket ?&lt;br/&gt;
Actually, it is impossible to use the same log4j2 config file in 2 different webapps, and log in 2 different files :&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;we cannot use global system properties&lt;/li&gt;
	&lt;li&gt;we cannot rely on servlet-specific web solution&lt;/li&gt;
	&lt;li&gt;the static call to main arguments does not work as described here&lt;br/&gt;
Any other workaround ?&lt;br/&gt;
&amp;#8212;&lt;br/&gt;
That said, you should really remove unsupported features from your official documentation : it still does not work in 2.3 !&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14644673" author="garydgregory" created="Tue, 28 Jul 2015 17:15:21 +0000"  >&lt;p&gt;The best way to get an issue resolved to your liking is to provide a patch. &lt;/p&gt;

&lt;p&gt;This will put it to the top of my (or other dev&apos;s) log4j to-do list, limited as my time may be.&lt;/p&gt;</comment>
                            <comment id="14653770" author="fleuryro" created="Tue, 4 Aug 2015 15:01:45 +0000"  >&lt;p&gt;Hello,&lt;br/&gt;
We have no idea of the internal model, and if this important issue exists and has not been fixed since so much time, we think it is probably not that easy to fix.&lt;br/&gt;
Do you know if this feature (ability to inject variables from java) works with log4j1 or logback ?&lt;br/&gt;
Shouldn&apos;t you indicate in the official doc that the feature does not work ?&lt;br/&gt;
&lt;a href=&quot;https://logging.apache.org/log4j/2.x/manual/lookups.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://logging.apache.org/log4j/2.x/manual/lookups.html&lt;/a&gt;&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="14653831" author="ralph.goers@dslextreme.com" created="Tue, 4 Aug 2015 15:49:28 +0000"  >&lt;p&gt;1. As far as I know Log4j 1 or Logback don&apos;t have anything similar to this.&lt;br/&gt;
2. Gary, in looking at the code I see MainMapLookup that has a @since 2.4 that was implemented to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-1013&quot; title=&quot;Log4j2 Main Arguments Lookup by name doesn&amp;#39;t work&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-1013&quot;&gt;&lt;del&gt;LOG4J2-1013&lt;/del&gt;&lt;/a&gt;. Should he try using a SNAPSHOT version? I am not sure how this was implemented previously&lt;/p&gt;</comment>
                            <comment id="14654021" author="garydgregory" created="Tue, 4 Aug 2015 17:40:04 +0000"  >&lt;p&gt;Hi Romuald,&lt;/p&gt;

&lt;p&gt;&quot;We have no idea of the internal model, and if this important issue exists and has not been fixed since so much time, we think it is probably not that easy to fix.&quot;&lt;/p&gt;

&lt;p&gt;How long an issue is left unaddressed may not be correlated to the difficulty of addressing it. We are all volunteers here. This is why providing tests and patches for issues you care about is the best way to move an issue forward.&lt;/p&gt;</comment>
                            <comment id="14654024" author="garydgregory" created="Tue, 4 Aug 2015 17:41:00 +0000"  >&lt;p&gt;Using a snapshot will not hurt. But I have no idea if it will solve his use case. I can&apos;t dig into this today. Work...&lt;/p&gt;</comment>
                            <comment id="14654938" author="fleuryro" created="Wed, 5 Aug 2015 07:22:21 +0000"  >&lt;p&gt;Thanks for your responses.&lt;br/&gt;
You can reproduce the problem very easily with the following:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Test
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testLog4j2() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception
    {   
        MapLookup.setMainArguments(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]{&lt;span class=&quot;code-quote&quot;&gt;&quot;main-arg&quot;&lt;/span&gt;});
        LOG.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;INFO MESSAGE&quot;&lt;/span&gt;);
        LOG.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;INFO MESSAGE&quot;&lt;/span&gt;);
        LOG.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;INFO MESSAGE&quot;&lt;/span&gt;);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;...
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;File name=&lt;span class=&quot;code-quote&quot;&gt;&quot;MainSys&quot;&lt;/span&gt; fileName=&lt;span class=&quot;code-quote&quot;&gt;&quot;app-${main:0}.log&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;PatternLayout&amp;gt;&lt;/span&gt;
           &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Pattern&amp;gt;&lt;/span&gt;%d %p %c{1.} [%t] %m%n&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Pattern&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/PatternLayout&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/File&amp;gt;&lt;/span&gt;
...			
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;MainSys&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
       &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.logging.log4j&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
       &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;log4j-api&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;2.2&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.logging.log4j&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;log4j-core&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;2.2&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;dependency&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.logging.log4j&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;log4j-web&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;2.2&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/dependency&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14725136" author="fleuryro" created="Tue, 1 Sep 2015 10:21:55 +0000"  >&lt;p&gt;Hello,&lt;br/&gt;
Any news ? As it is a main feature that is not working at all (Lookups), shouldn&apos;t we put it as Blocker ?&lt;br/&gt;
Thanks.&lt;/p&gt;</comment>
                            <comment id="14725904" author="garydgregory" created="Tue, 1 Sep 2015 19:13:59 +0000"  >&lt;p&gt;Hm... it&apos;s possible that lookups do not work 100% of the places in a config file. I am not sure. You could try 2.3 and 2.4-SNAPSHOT just so that we know if this use-case is still an issue. I would guess yes.&lt;/p&gt;</comment>
                            <comment id="14727235" author="fleuryro" created="Wed, 2 Sep 2015 12:15:44 +0000"  >&lt;p&gt;Hi Gary,&lt;br/&gt;
As indicated in my first comment, it does not work in 2.3. I do not have access to the 2.4 snapshot.&lt;br/&gt;
Any reason to expect it to be fixed in the current snapshot ?&lt;br/&gt;
If you have any workaround in mind, feel free to share &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Romuald&lt;/p&gt;</comment>
                            <comment id="14727304" author="ralph.goers@dslextreme.com" created="Wed, 2 Sep 2015 13:05:38 +0000"  >&lt;p&gt;See my comment above. Changes were made that may fix this issue in the current code. Please give it a try.&lt;/p&gt;</comment>
                            <comment id="14727619" author="garydgregory" created="Wed, 2 Sep 2015 16:51:29 +0000"  >&lt;p&gt;For the case of a &lt;tt&gt;header&lt;/tt&gt; in a &lt;tt&gt;PatternLayout&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;PatternLayout pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;%m%n&quot;&lt;/span&gt; header=&lt;span class=&quot;code-quote&quot;&gt;&quot;File: ${main:0}&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The current code works. Please try &lt;b&gt;Git master&lt;/b&gt; or a &lt;b&gt;2.4-SNAPSHOT&lt;/b&gt; build from &lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/org/apache/logging/log4j/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/org/apache/logging/log4j/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The test is &lt;tt&gt;org.apache.logging.log4j.core.layout.PatternLayoutMainMapLookupTest&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;The test also passes for the &lt;tt&gt;FileAppender&lt;/tt&gt;&apos;s &lt;tt&gt;fileName&lt;/tt&gt; attribute.&lt;/p&gt;

&lt;p&gt;Please verify and close.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2618n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>