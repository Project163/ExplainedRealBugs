<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:40:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2693] @PluginValue does not support attribute names besides &quot;value&quot;</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2693</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;While working in the plugin system recently, I discovered an inconsistent behavior in how &lt;tt&gt;@PluginValue&lt;/tt&gt; works compared to &lt;tt&gt;@PluginAttribute&lt;/tt&gt;. If a &lt;tt&gt;value&lt;/tt&gt; is specified other than &quot;value&quot;, then I&apos;d expect that the contents of that value to be the attribute name in the configuration file.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Plugin(name = &lt;span class=&quot;code-quote&quot;&gt;&quot;Foo&quot;&lt;/span&gt;, category = &lt;span class=&quot;code-quote&quot;&gt;&quot;Core&quot;&lt;/span&gt;, ...)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Foo {
&lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;@PluginFactory
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Foo createFoo(@PluginValue(&lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;) &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; bar) {
  &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Foo(bar);
}
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Expected XML config:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Foo bar=&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Actual XML config:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Foo value=&lt;span class=&quot;code-quote&quot;&gt;&quot;baz&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13256746">LOG4J2-2693</key>
            <summary>@PluginValue does not support attribute names besides &quot;value&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mattsicker">Matt Sicker</assignee>
                                    <reporter username="mattsicker">Matt Sicker</reporter>
                        <labels>
                    </labels>
                <created>Sun, 15 Sep 2019 18:56:50 +0000</created>
                <updated>Sun, 6 Oct 2019 21:28:20 +0000</updated>
                            <resolved>Sun, 6 Oct 2019 20:25:03 +0000</resolved>
                                    <version>2.12.1</version>
                                    <fixVersion>3.0.0</fixVersion>
                    <fixVersion>2.13.0</fixVersion>
                                    <component>Plugins</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16930051" author="jvz" created="Sun, 15 Sep 2019 19:03:54 +0000"  >&lt;p&gt;I bring this up because this seems strange to have the &lt;tt&gt;value&lt;/tt&gt; attribute on &lt;tt&gt;@PluginValue&lt;/tt&gt; if it&apos;s not used for anything. In XML, you can specify a value using &lt;tt&gt;&amp;lt;Foo&amp;gt;baz&amp;lt;/Foo&amp;gt;&lt;/tt&gt;, but this only works in XML. For JSON, YAML, and properties files, you&apos;d have to specify a pseudo &lt;tt&gt;value&lt;/tt&gt; attribute. If I specify a different attribute name than &quot;value&quot; in the annotation, should that make that a pseudo-attribute for &lt;tt&gt;value&lt;/tt&gt;?&lt;/p&gt;

&lt;p&gt;There are only two uses of &lt;tt&gt;@PluginValue&lt;/tt&gt; in log4j-core:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;In &lt;tt&gt;Properties&lt;/tt&gt; where it uses the value &lt;tt&gt;value&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;In &lt;tt&gt;Script&lt;/tt&gt; where it uses the value &lt;tt&gt;scriptText&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I can&apos;t find any tests that use &lt;tt&gt;scriptText&lt;/tt&gt; in a config file, so there are no examples of expected behavior other than my own question here. I&apos;ll note that this behavior dates back at least as far as the initial injection visitor refactoring a few years ago, and from what I recall, that refactoring ported existing behavior (which has since been &lt;a href=&quot;https://github.com/apache/logging-log4j2/blame/master/log4j-plugins/src/main/java/org/apache/logging/log4j/plugins/inject/PluginValueBuilder.java#L36&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;changed a few times&lt;/a&gt;), so it&apos;s hard to determine what the original expectation was.&lt;/p&gt;</comment>
                            <comment id="16930066" author="ralph.goers@dslextreme.com" created="Sun, 15 Sep 2019 19:41:08 +0000"  >&lt;p&gt;The original code did:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
                &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (a &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; PluginValue) {
                    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name = ((PluginValue) a).value();
                    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; v = node.getValue();
                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (v == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                        v = getAttrValue(&lt;span class=&quot;code-quote&quot;&gt;&quot;value&quot;&lt;/span&gt;, attrs);
                    }
                    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; value = subst.replace(event, v);
                    sb.append(name).append(&lt;span class=&quot;code-quote&quot;&gt;&quot;=\&quot;&lt;/span&gt;&lt;span class=&quot;code-quote&quot;&gt;&quot;).append(value).append(&quot;&lt;/span&gt;\&quot;&quot;);
                    parms[index] = value;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The intent of this was that each Node object can contain a value. If it has a value then that is what should be used. If it does not have a value then look for an attribute named value and use that.&lt;/p&gt;

&lt;p&gt;I expect that scriptText would expect:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;Script name=&lt;span class=&quot;code-quote&quot;&gt;&quot;something&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;ScriptText&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; is the script to execute&amp;lt;/scriptText&amp;gt;
&amp;lt;/Script&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The fact that a particular configuration format doesn&apos;t support a Node having a value doesn&apos;t mean we should toss that capability for formats that do.&lt;/p&gt;

&lt;p&gt;FWIW, the example of &quot;Actual XML config&quot; would normally be expected to be:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;Foo&amp;gt;baz&amp;lt;/Foo&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The format you show is to allow for other configuration formats that don&apos;t support a Node having a value such as:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
SomeItem:
    Foo.value: baz

or 

SomeItem.Foo.value=baz&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;That said, you can see that the StringBuilder would have printed &apos;bar=&quot;baz&quot;&apos; in your example, so it probably would have made sense to have getAttrValue use the name if it was not null or empty and only use &quot;value&quot; as the default value.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16945417" author="jvz" created="Sun, 6 Oct 2019 18:03:50 +0000"  >&lt;p&gt;I have a fix for this in my refactoring for the master branch. I still need to backport the fix minus the refactoring for release-2.x, though that should be fairly simple.&lt;/p&gt;</comment>
                            <comment id="16945424" author="jira-bot" created="Sun, 6 Oct 2019 18:29:41 +0000"  >&lt;p&gt;Commit a1c3c7829e2fe3edea415a25121e31fb0afc0f1a in logging-log4j2&apos;s branch refs/heads/master from Matt Sicker&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=a1c3c78&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=a1c3c78&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Extract binder, injector, and name provider APIs&lt;/p&gt;

&lt;p&gt;This refactors some of the strategies used for configuring and&lt;br/&gt;
instantiating plugins. The previously named&lt;br/&gt;
ConfigurationInjectionBuilder classes have been renamed to be&lt;br/&gt;
ConfigurationInjector as they are no longer builder classes.&lt;br/&gt;
This API has been simplified to find an appropriate injector&lt;br/&gt;
given an AnnotatedElement which can automatically set both&lt;br/&gt;
the AnnotatedElement and the Annotation. Conversion types have&lt;br/&gt;
been weakened to use java.lang.reflect.Type rather than Class.&lt;br/&gt;
This introduces a new plugin SPI named OptionBinder for&lt;br/&gt;
abstracting the binding strategies previously used in the&lt;br/&gt;
massive PluginBuilder class as desired by &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-860&quot; title=&quot;Unify plugin builders and plugin factories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-860&quot;&gt;&lt;del&gt;LOG4J2-860&lt;/del&gt;&lt;/a&gt;. This SPI&lt;br/&gt;
is extended to include support for method-based configuration&lt;br/&gt;
injection into plugin builder classes as specified in&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2700&quot; title=&quot;Add support for injecting plugin configuration via builder methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2700&quot;&gt;&lt;del&gt;LOG4J2-2700&lt;/del&gt;&lt;/a&gt;. This introduces another plugin SPI for specifying&lt;br/&gt;
the name of an annotated element rather than relying on Java&lt;br/&gt;
reflection to calculate the name. This SPI also fixes&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2693&quot; title=&quot;@PluginValue does not support attribute names besides &amp;quot;value&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2693&quot;&gt;&lt;del&gt;LOG4J2-2693&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Signed-off-by: Matt Sicker &amp;lt;boards@gmail.com&amp;gt;&lt;/p&gt;</comment>
                            <comment id="16945441" author="jira-bot" created="Sun, 6 Oct 2019 20:24:04 +0000"  >&lt;p&gt;Commit dc5b6b912623a68828c31fc58d0dd9a79282e484 in logging-log4j2&apos;s branch refs/heads/release-2.x from Matt Sicker&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=dc5b6b9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=dc5b6b9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2693&quot; title=&quot;@PluginValue does not support attribute names besides &amp;quot;value&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2693&quot;&gt;&lt;del&gt;LOG4J2-2693&lt;/del&gt;&lt;/a&gt; Use @PluginValue value&lt;/p&gt;

&lt;p&gt;This fixes the @PluginValue annotation handling to use the specified&lt;br/&gt;
string as the attribute name to look up rather than defaulting to the&lt;br/&gt;
&quot;value&quot; attribute.&lt;/p&gt;

&lt;p&gt;This fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2647&quot; title=&quot;Validation blocks definition of script in properties configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2647&quot;&gt;&lt;del&gt;LOG4J2-2647&lt;/del&gt;&lt;/a&gt; as well.&lt;/p&gt;</comment>
                            <comment id="16945444" author="jvz" created="Sun, 6 Oct 2019 20:25:04 +0000"  >&lt;p&gt;Backported to release-2.x.&lt;/p&gt;</comment>
                            <comment id="16945445" author="ralph.goers@dslextreme.com" created="Sun, 6 Oct 2019 20:31:56 +0000"  >&lt;p&gt;How do I review these changes? When I go to the gitbox link and select diff on a file I got a 401 error.&lt;/p&gt;</comment>
                            <comment id="16945470" author="jvz" created="Sun, 6 Oct 2019 21:28:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;a=commitdiff;h=dc5b6b9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;a=commitdiff;h=dc5b6b9&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Or via GitHub. I got a 401 error trying to click &quot;diff&quot; on individual files; that&apos;s likely a bug. Clicking &quot;commitdiff&quot; at the top of the page seems to work.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13242492">LOG4J2-2647</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311120" key="com.pyxis.greenhopper.jira:gh-epic-link">
                        <customfieldname>Epic Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>LOG4J2-2694</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 6 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z06nk8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>