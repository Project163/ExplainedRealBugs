<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:37:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-1573] Layout is no longer optional</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-1573</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;This configuration used to work in 2.6.2:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Configuration status=&lt;span class=&quot;code-quote&quot;&gt;&quot;warn&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Appenders&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Console name=&lt;span class=&quot;code-quote&quot;&gt;&quot;myConsole&quot;&lt;/span&gt; target=&lt;span class=&quot;code-quote&quot;&gt;&quot;SYSTEM_OUT&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Async name=&lt;span class=&quot;code-quote&quot;&gt;&quot;myConsoleAsync&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
         &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;myConsole&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Async&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Appenders&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Loggers&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AsyncRoot level=&lt;span class=&quot;code-quote&quot;&gt;&quot;info&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Loggers&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Configuration&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With the current &lt;tt&gt;master&lt;/tt&gt; (i.e. the upcoming 2.7) this does not work any more. The validator complains because the field &quot;layout&quot; is missing in&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt; &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Console name=&lt;span class=&quot;code-quote&quot;&gt;&quot;myConsole&quot;&lt;/span&gt; target=&lt;span class=&quot;code-quote&quot;&gt;&quot;SYSTEM_OUT&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;According to the current documentation this is a bug:&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Parameter Name&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;Type&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;	Description&lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; layout &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Layout &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; The Layout to use to format the LogEvent. If no layout is supplied the default pattern layout of &quot;%m%n&quot; will be used.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;With this configuration it works:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Configuration status=&lt;span class=&quot;code-quote&quot;&gt;&quot;warn&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Appenders&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Console name=&lt;span class=&quot;code-quote&quot;&gt;&quot;myConsole&quot;&lt;/span&gt; target=&lt;span class=&quot;code-quote&quot;&gt;&quot;SYSTEM_OUT&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
         &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;DetailsLayout/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Console&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Async name=&lt;span class=&quot;code-quote&quot;&gt;&quot;myConsoleAsync&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
         &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;myConsole&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Async&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Appenders&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Loggers&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AsyncRoot level=&lt;span class=&quot;code-quote&quot;&gt;&quot;info&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
   &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Loggers&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Configuration&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</description>
                <environment></environment>
        <key id="13003788">LOG4J2-1573</key>
            <summary>Layout is no longer optional</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggregory">Gary D. Gregory</assignee>
                                    <reporter username="SteffenO">Steffen Offermann</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Sep 2016 08:52:55 +0000</created>
                <updated>Thu, 15 Sep 2016 16:42:02 +0000</updated>
                            <resolved>Thu, 15 Sep 2016 16:42:01 +0000</resolved>
                                    <version>2.7</version>
                                    <fixVersion>2.7</fixVersion>
                                    <component>Appenders</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15476393" author="steffeno" created="Fri, 9 Sep 2016 08:56:38 +0000"  >&lt;p&gt;Test case:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.concurrent.TimeUnit;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.After;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.junit.Test;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.logging.log4j.core.LoggerContext;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.logging.log4j.core.config.Configurator;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; org.hamcrest.MatcherAssert.assertThat;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; org.hamcrest.Matchers.not;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; org.hamcrest.Matchers.nullValue;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestForLog4j2_Jira1573
{
   @After
   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void tearDown()
   {
      Configurator.shutdown( &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, 10L, TimeUnit.SECONDS );
   }

   @Test
   &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void verifyThatAsyncAppendersAreAvailable()
   {
      &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; LoggerContext context = Configurator.initialize( &lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;log4j2-xml-async.xml&quot;&lt;/span&gt; );

      assertThat( context, not( nullValue() ) );

      context.start();
      context.getLogger( &lt;span class=&quot;code-quote&quot;&gt;&quot;&quot; ).info( &quot;&lt;/span&gt;Test&quot; );
      context.stop();
   }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15476899" author="steffeno" created="Fri, 9 Sep 2016 11:59:33 +0000"  >&lt;p&gt;The field is inherited from &lt;tt&gt;AbstractAppender.Builder&lt;/tt&gt;. That abstract class was introduced in commit  2207cae2a1213fda34cf94e5f08c49c2c9433e50:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Committer: Gary Gregory &amp;lt;ggregory@apache.org&amp;gt; 2016-08-11 05:09:29
Refactor for ConsoleAppender (and others next) to use inherited Builders.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="15477575" author="garydgregory" created="Fri, 9 Sep 2016 16:53:45 +0000"  >&lt;p&gt;I am pretty sure this has nothing to do with the builder because &lt;tt&gt;org.apache.logging.log4j.core.appender.ConsoleAppender.Builder.build()&lt;/tt&gt; calls &lt;tt&gt;getOrCreateLayout()&lt;/tt&gt; and I get the default pattern layout with this config file. This has to do with the set up... &lt;/p&gt;

&lt;p&gt;This works:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AsyncRoot level=&lt;span class=&quot;code-quote&quot;&gt;&quot;info&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;myConsole&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/AsyncRoot&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This does not:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AsyncRoot level=&lt;span class=&quot;code-quote&quot;&gt;&quot;info&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/AsyncRoot&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15477584" author="garydgregory" created="Fri, 9 Sep 2016 16:56:23 +0000"  >&lt;blockquote&gt;
&lt;p&gt;The validator complains because the field &quot;layout&quot; is missing in&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I do not see that, what do you see? Are you using the latest from Git master?&lt;/p&gt;</comment>
                            <comment id="15483317" author="steffeno" created="Mon, 12 Sep 2016 07:09:57 +0000"  >&lt;p&gt;This is the stack trace from the debugger (the test class has a different name in that stack, but the logic is the same):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Thread [main] (Suspended (breakpoint at line 191 in PluginBuilder))	
	PluginBuilder.injectFields(Builder&amp;lt;?&amp;gt;) line: 191	
	PluginBuilder.build() line: 121	
	XmlConfiguration(AbstractConfiguration).createPluginObject(PluginType&amp;lt;?&amp;gt;, Node, LogEvent) line: 933	
	XmlConfiguration(AbstractConfiguration).createConfiguration(Node, LogEvent) line: 873	
	XmlConfiguration(AbstractConfiguration).createConfiguration(Node, LogEvent) line: 865	
	XmlConfiguration(AbstractConfiguration).doConfigure() line: 489	
	XmlConfiguration(AbstractConfiguration).initialize() line: 226	
	XmlConfiguration(AbstractConfiguration).start() line: 238	
	LoggerContext.setConfiguration(Configuration) line: 525	
	LoggerContext.start(Configuration) line: 258	
	Log4jContextFactory.getContext(String, ClassLoader, Object, boolean, URI, String) line: 239	
	Configurator.initialize(String, ClassLoader, URI, Object) line: 159	
	Configurator.initialize(String, ClassLoader, String, Object) line: 131	
	Configurator.initialize(String, ClassLoader, String) line: 101	
	Configurator.initialize(String, String) line: 188	
	DependencyTest.verifyThatAsyncAppendersAreAvailable() line: 87	
	NativeMethodAccessorImpl.invoke0(Method, Object, Object[]) line: not available [native method]	
	NativeMethodAccessorImpl.invoke(Object, Object[]) line: 57	
	DelegatingMethodAccessorImpl.invoke(Object, Object[]) line: 43	
	Method.invoke(Object, Object...) line: 606	
	FrameworkMethod$1.runReflectiveCall() line: 50	
	FrameworkMethod$1(ReflectiveCallable).run() line: 12	
	FrameworkMethod.invokeExplosively(Object, Object...) line: 47	
	InvokeMethod.evaluate() line: 17	
	RunAfters.evaluate() line: 27	
	BlockJUnit4ClassRunner(ParentRunner&amp;lt;T&amp;gt;).runLeaf(Statement, Description, RunNotifier) line: 325	
	BlockJUnit4ClassRunner.runChild(FrameworkMethod, RunNotifier) line: 78	
	BlockJUnit4ClassRunner.runChild(Object, RunNotifier) line: 57	
	ParentRunner$3.run() line: 290	
	ParentRunner$1.schedule(Runnable) line: 71	
	BlockJUnit4ClassRunner(ParentRunner&amp;lt;T&amp;gt;).runChildren(RunNotifier) line: 288	
	ParentRunner&amp;lt;T&amp;gt;.access$000(ParentRunner, RunNotifier) line: 58	
	ParentRunner$2.evaluate() line: 268	
	BlockJUnit4ClassRunner(ParentRunner&amp;lt;T&amp;gt;).run(RunNotifier) line: 363	
	JUnit4TestReference.run(TestExecution) line: 86	
	TestExecution.run(ITestReference[]) line: 38	
	RemoteTestRunner.runTests(String[], String, TestExecution) line: 459	
	RemoteTestRunner.runTests(TestExecution) line: 678	
	RemoteTestRunner.run() line: 382	
	RemoteTestRunner.main(String[]) line: 192	
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The relevant method in &lt;tt&gt;PluginBuilder.java&lt;/tt&gt; is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void injectFields(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Builder&amp;lt;?&amp;gt; builder) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IllegalAccessException {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; List&amp;lt;Field&amp;gt; fields = TypeUtil.getAllDeclaredFields(builder.getClass());
        AccessibleObject.setAccessible(fields.toArray(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Field[] {}), &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; StringBuilder log = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringBuilder();
        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; invalid = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Field field : fields) {
            log.append(log.length() == 0 ? simpleName(builder) + &lt;span class=&quot;code-quote&quot;&gt;&quot;(&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;, &quot;&lt;/span&gt;);
            &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Annotation[] annotations = field.getDeclaredAnnotations();
            &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] aliases = extractPluginAliases(annotations);
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Annotation a : annotations) {
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (a &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; PluginAliases) {
                    &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;; &lt;span class=&quot;code-comment&quot;&gt;// already processed
&lt;/span&gt;                }
                &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; PluginVisitor&amp;lt;? &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Annotation&amp;gt; visitor =
                    PluginVisitors.findVisitor(a.annotationType());
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (visitor != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; value = visitor.setAliases(aliases)
                        .setAnnotation(a)
                        .setConversionType(field.getType())
                        .setStrSubstitutor(configuration.getStrSubstitutor())
                        .setMember(field)
                        .visit(configuration, node, event, log);
                    &lt;span class=&quot;code-comment&quot;&gt;// don&apos;t overwrite &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; values &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; the visitor gives us no value to inject
&lt;/span&gt;                    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (value != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                        field.set(builder, value);
                    }
                }
            }
            &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Collection&amp;lt;ConstraintValidator&amp;lt;?&amp;gt;&amp;gt; validators =
                ConstraintValidators.findValidators(annotations);
            &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; value = field.get(builder);
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ConstraintValidator&amp;lt;?&amp;gt; validator : validators) {
                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!validator.isValid(field.getName(), value)) {
                    invalid = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
                }
            }
        }
        log.append(log.length() == 0 ? builder.getClass().getSimpleName() + &lt;span class=&quot;code-quote&quot;&gt;&quot;()&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;)&quot;&lt;/span&gt;);
        LOGGER.debug(log.toString());
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (invalid) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ConfigurationException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Arguments given &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; element &quot;&lt;/span&gt; + node.getName() + &lt;span class=&quot;code-quote&quot;&gt;&quot; are invalid&quot;&lt;/span&gt;);
        }
        checkForRemainingAttributes();
        verifyNodeChildrenUsed();
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The builder is of type &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.logging.log4j.core.appender.ConsoleAppender$Builder@29523ccf
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the fields are gathered in the line &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;TypeUtil.getAllDeclaredFields(builder.getClass());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;tt&gt;ConsoleAppender.Builder&lt;/tt&gt; extends &lt;tt&gt;AbstractOutputStreamAppender&lt;/tt&gt;, which extends &lt;tt&gt;AbstractAppender.Builder&lt;/tt&gt;, and there we find:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Builder&amp;lt;B &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Builder&amp;lt;B&amp;gt;&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; AbstractFilterable.Builder&amp;lt;B&amp;gt; {

        @PluginBuilderAttribute
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; ignoreExceptions = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
        
        @PluginElement(&lt;span class=&quot;code-quote&quot;&gt;&quot;Layout&quot;&lt;/span&gt;)
        @Required
        &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Layout&amp;lt;? &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Serializable&amp;gt; layout;
        ... 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;In &lt;tt&gt;PluginBuilder.injectFields()&lt;/tt&gt; the part &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!validator.isValid(field.getName(), value)) {
                    invalid = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
                }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;tries to validate the field&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; org.apache.logging.log4j.core.Layout org.apache.logging.log4j.core.appender.AbstractAppender$Builder.layout
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;with &lt;tt&gt;field.getName()&lt;/tt&gt; equaling &lt;em&gt;&quot;layout&quot;&lt;/em&gt;, and the validator is&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.logging.log4j.core.config.plugins.validation.validators.RequiredValidator@71ac6d5
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The method &lt;tt&gt;RequiredValidator.isValid()&lt;/tt&gt; returns false because the value is &lt;tt&gt;null&lt;/tt&gt;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isValid(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; value) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (value == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; err(name);
        }
    ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Regards,&lt;br/&gt;
  Steffen&lt;/p&gt;</comment>
                            <comment id="15483321" author="steffeno" created="Mon, 12 Sep 2016 07:12:14 +0000"  >&lt;p&gt;This &lt;em&gt;was&lt;/em&gt; the latest build at the time I reported the issue. I noticed that you discussed the property issue in a different context on the mailing list during the weekend, so I&apos;ll check this again using the current &lt;tt&gt;master&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15483370" author="steffeno" created="Mon, 12 Sep 2016 07:35:14 +0000"  >&lt;p&gt;The problem still exists with the latest &lt;tt&gt;master&lt;/tt&gt;, and removing the &lt;tt&gt;@Required&lt;/tt&gt; annotation from the field &lt;tt&gt;layout&lt;/tt&gt; in &lt;tt&gt;AbstractAppender.Builder&lt;/tt&gt; breaks at least half of our test-cases.&lt;/p&gt;
</comment>
                            <comment id="15492579" author="garydgregory" created="Thu, 15 Sep 2016 06:55:57 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=SteffenO&quot; class=&quot;user-hover&quot; rel=&quot;SteffenO&quot;&gt;SteffenO&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Can you please clarify how your tests are breaking?&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="15492583" author="steffeno" created="Thu, 15 Sep 2016 06:56:58 +0000"  >&lt;p&gt;I just did the test again with the latest &lt;tt&gt;master&lt;/tt&gt; as of Thu Sep 15 08:54:43 CEST 2016, and I could &lt;em&gt;not&lt;/em&gt; reproduce it any more.&lt;/p&gt;

&lt;p&gt;I&apos;ll have to check the test cases though, before I can give the all-clear, because I had done a couple of adjustments during the previous tests, so I can&apos;t be sure if the original tests would be green.&lt;/p&gt;

&lt;p&gt;I&apos;ll be in a meeting for the rest of the day, so I probably won&apos;t be able to provide any more information before the end of the day (or tomorrow).&lt;/p&gt;</comment>
                            <comment id="15492589" author="garydgregory" created="Thu, 15 Sep 2016 07:00:18 +0000"  >&lt;p&gt;Thank you for the update. See you here later then.&lt;/p&gt;</comment>
                            <comment id="15493226" author="steffeno" created="Thu, 15 Sep 2016 12:56:55 +0000"  >&lt;p&gt;I don&apos;t have the time for a full application test now, but I had a couple of minutes to retry the tests based on the original version of our test cases. Everything seems to be working ok now according to those test cases. &lt;/p&gt;
</comment>
                            <comment id="15493879" author="garydgregory" created="Thu, 15 Sep 2016 16:42:02 +0000"  >&lt;p&gt;Closing per &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=SteffenO&quot; class=&quot;user-hover&quot; rel=&quot;SteffenO&quot;&gt;SteffenO&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12932884">LOG4J2-1259</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 9 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33fjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>