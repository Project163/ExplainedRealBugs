<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:42:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-3297] Disable remote loading of log4j configuration to prevent MiTM Attacks</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-3297</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;The fix for &lt;b&gt;CVE-2021-44832&lt;/b&gt; in release &lt;b&gt;2.17.1&lt;/b&gt; of log4j-core prevents remote JNDI injection via the JDBC Appender.&lt;/p&gt;

&lt;p&gt;Given the nature of that CVE, an attacker requires local access to the configuration to be able to exploit it, OR in the rare chance the &lt;b&gt;log4j2.configurationFile&lt;/b&gt; property is set to a remote HTTP location, an attacker can use a Man in the Middle Attack (MiTM) and inject their own malicious configuration which could disable logging for an application entirely.&lt;/p&gt;

&lt;p&gt;Is it possible to disable remote loading of log4j configurations entirely?&lt;/p&gt;

&lt;p&gt;If that feature is required, it may be necessary to create a log4j configuration server that provides signed configs to the application, but that seems like overkill to me.&#160;&lt;/p&gt;

&lt;p&gt;I would opt for limiting the scope of the &lt;b&gt;log4j2.configurationFile&lt;/b&gt; to local configurations, and if remote configuration is a feature you cannot remove, limiting it with a flag/variable and also limiting it to HTTPS for remote configs.&lt;/p&gt;

&lt;p&gt;I don&apos;t think the priority on this is extremely urgent, but someone may try to get a CVE under their belt by demonstrating this vector, and given the pressure you&apos;ve been under I did not feel the need to get a CVE for this.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13419888">LOG4J2-3297</key>
            <summary>Disable remote loading of log4j configuration to prevent MiTM Attacks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rgoers">Ralph Goers</assignee>
                                    <reporter username="pmalone">Peter Malone</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Dec 2021 14:40:59 +0000</created>
                <updated>Thu, 17 Feb 2022 15:09:38 +0000</updated>
                            <resolved>Thu, 17 Feb 2022 05:43:35 +0000</resolved>
                                    <version>2.17.1</version>
                    <version>2.17.0</version>
                                    <fixVersion>2.17.2</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="17466514" author="ralph.goers@dslextreme.com" created="Wed, 29 Dec 2021 16:36:50 +0000"  >&lt;p&gt;This would not qualify for a CVE. Simply doing bad or incorrect things isn&apos;t a security issue. We have many things that fall into this category that could fall into &quot;disable by default&quot;. We are looking into how to best achieve that without needing a thousand system properties.&lt;/p&gt;</comment>
                            <comment id="17466531" author="JIRAUSER282309" created="Wed, 29 Dec 2021 17:01:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgoers&quot; class=&quot;user-hover&quot; rel=&quot;rgoers&quot;&gt;rgoers&lt;/a&gt; if I can explain it another way, loading configurations over HTTP allows anyone on the same network as the application to intercept that request and get log4j2 to load their own malicious configuration which could do something like disable logging altogether, or to log information that shouldn&apos;t be logged.&lt;/p&gt;

&lt;p&gt;It&apos;s a classic MiTM vulnerability. That is the security issue with this feature. It should be CVE worthy, albeit a pretty low CVSS, but again I didn&apos;t feel the need to try go that route given the activity over the last few weeks.&lt;/p&gt;

&lt;p&gt;Limiting remote configuration loading to HTTPS prevents this (as does turning it off altogether), but you want to be sure with HTTPS/TLS that you are verifying the certificate from the server hosting the configuration too, to rule out dns spoofing attacks.&lt;/p&gt;

&lt;p&gt;I hope this makes sense. It&apos;s been a long few days for me as well so I&apos;m not firing on all cylinders.&#160;&lt;/p&gt;</comment>
                            <comment id="17466535" author="ralph.goers@dslextreme.com" created="Wed, 29 Dec 2021 17:12:05 +0000"  >&lt;p&gt;Yes, I fully understand your point of view. It is precisely why Maven now defaults to use https to connect to a local Nexus repository, although it still allows an override to continue to use http. But it didn&apos;t create a CVE for that. I am fine with improving this but I still don&apos;t think it needs a CVE.&lt;/p&gt;</comment>
                            <comment id="17469438" author="osvdb" created="Wed, 5 Jan 2022 17:07:50 +0000"  >&lt;p&gt;To be clear, does Log4j load a remote config over HTTP by default, or is the remote config specified by the administrator which could load it over HTTPS based on their configuration?&#160;&lt;/p&gt;</comment>
                            <comment id="17469668" author="ralph.goers@dslextreme.com" created="Thu, 6 Jan 2022 04:22:13 +0000"  >&lt;p&gt;By default, Log4j looks for one of log42-test.&lt;span class=&quot;error&quot;&gt;&amp;#91;yaml, json, properties, xml&amp;#93;&lt;/span&gt; or log4j2.&lt;span class=&quot;error&quot;&gt;&amp;#91;yaml, json, properties, xml&amp;#93;&lt;/span&gt; on the classpath. If none of these are found Log4j will default to logging errors to the console.&lt;/p&gt;

&lt;p&gt;So no, remote loading of configuration files will never happen by default.&lt;/p&gt;

&lt;p&gt;If the log4j2.configurationFile system property is set to a URL Log4j will attempt to load from the url. If it is not a URL Log4j will attempt to resolve it as a path to a file. If logging.auth.username and logging.auth.password are set as system properties Log4j will use them for basic authentication. If the user desires some other form of authorization they can implement an AuthorizationProvider and specify the class name on the log4j2.authorizatoinProvider system property. All of these properties may be defined in a file named log4j2.component.properties on the classpath instead of specifying them on the command line.&lt;/p&gt;

&lt;p&gt;If the app is a spring boot app and it includes the log4j-spring-boot jar then the location of the configuration file can be specified in bootstrap.yml as&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
spring:
  application:
    name: some-service
  cloud:
    config:
      uri: https:&lt;span class=&quot;code-comment&quot;&gt;//spring-configuration-server.apache.org
&lt;/span&gt;      username: sccuser
      password: sccpassword
logging:
 label: ${spring.cloud.config.label:master}
 config: &lt;span class=&quot;code-quote&quot;&gt;&quot;${spring.cloud.config.uri}/${spring.application.name}/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/${logging.label}/log4j2.xml?override=${spring.cound.config.uri}/${spring.application.name}/&lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;/${logging.label}/log4j2-${spring.application.name}.xml&quot;&lt;/span&gt; &#160; 
  auth:
    username: ${spring.cloud.config.username}
    password: ${spring.cloud.config.password} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Note that with the above you would be retrieving both the application configuration and logging configuration from Spring Cloud Configuration Server.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17469670" author="ralph.goers@dslextreme.com" created="Thu, 6 Jan 2022 04:47:44 +0000"  >&lt;p&gt;The action I am planning on taking with this would be to limit the remote url to https. If the user wants to use http or some other protocol I am not exactly sure what could/should be done to accommodate that. As I said, Maven still provides a way to allow http but I suspect that will be removed in the future.&#160;&lt;/p&gt;

&lt;p&gt;Your input on this would be welcome.&lt;/p&gt;</comment>
                            <comment id="17469683" author="remkop@yahoo.com" created="Thu, 6 Jan 2022 05:59:31 +0000"  >&lt;p&gt;I would not disable this since it is the user&#8217;s choice to configure the HTTP url.&#160;&lt;/p&gt;

&lt;p&gt;If we want to be super careful we can add a hoop for users to jump through and introduce a system property&lt;tt&gt;enableUnsafeHttpConfiguration&lt;/tt&gt; that needs to be set to true for http URLs to work.&#160;&lt;/p&gt;</comment>
                            <comment id="17469939" author="ralph.goers@dslextreme.com" created="Thu, 6 Jan 2022 14:33:01 +0000"  >&lt;p&gt;Would you disallow other protocols? I seem to recall that the JBoss VFS protocol (I am not sure if that is still a thing) required its own URL connection handling and wouldn&apos;t work with the existing code, but allowing any protocol seems risky.&lt;/p&gt;</comment>
                            <comment id="17493014" author="jira-bot" created="Wed, 16 Feb 2022 05:45:21 +0000"  >&lt;p&gt;Commit e8dab8c5d652437ff61d2e797bfbe4e4e6cdd1bb in logging-log4j2&apos;s branch refs/heads/release-2.x from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=e8dab8c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=e8dab8c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3297&quot; title=&quot;Disable remote loading of log4j configuration to prevent MiTM Attacks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3297&quot;&gt;&lt;del&gt;LOG4J2-3297&lt;/del&gt;&lt;/a&gt; - Limit loading of configuration via a url to https by default&lt;/p&gt;</comment>
                            <comment id="17493015" author="jira-bot" created="Wed, 16 Feb 2022 05:45:23 +0000"  >&lt;p&gt;Commit 5f37d176f706c33132e5316a4bc7099644ce8ac1 in logging-log4j2&apos;s branch refs/heads/release-2.x from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=5f37d17&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=5f37d17&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3297&quot; title=&quot;Disable remote loading of log4j configuration to prevent MiTM Attacks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3297&quot;&gt;&lt;del&gt;LOG4J2-3297&lt;/del&gt;&lt;/a&gt; - Limit loading of configuration via a url to https by default&lt;/p&gt;</comment>
                            <comment id="17493650" author="jira-bot" created="Thu, 17 Feb 2022 05:12:52 +0000"  >&lt;p&gt;Commit 3bd53c14f53c8178320a95fd27be8eac05081257 in logging-log4j2&apos;s branch refs/heads/release-2.x from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=3bd53c1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=3bd53c1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3297&quot; title=&quot;Disable remote loading of log4j configuration to prevent MiTM Attacks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3297&quot;&gt;&lt;del&gt;LOG4J2-3297&lt;/del&gt;&lt;/a&gt; - Limit loading of configuration via a url to https by default&lt;/p&gt;</comment>
                            <comment id="17493659" author="jira-bot" created="Thu, 17 Feb 2022 05:40:59 +0000"  >&lt;p&gt;Commit 2f615e82e36087837c7f79aa91d6fc5e47d64abb in logging-log4j2&apos;s branch refs/heads/master from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=2f615e8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=2f615e8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3297&quot; title=&quot;Disable remote loading of log4j configuration to prevent MiTM Attacks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3297&quot;&gt;&lt;del&gt;LOG4J2-3297&lt;/del&gt;&lt;/a&gt; - Limit loading of configuration via a url to https by default&lt;/p&gt;</comment>
                            <comment id="17493662" author="ralph.goers@dslextreme.com" created="Thu, 17 Feb 2022 05:43:35 +0000"  >&lt;p&gt;Loading via a url is now restricted to https by default. Other protocols may be added by a system property or all protocols may be disabled. Please verify and close.&lt;/p&gt;</comment>
                            <comment id="17493996" author="JIRAUSER282309" created="Thu, 17 Feb 2022 15:09:38 +0000"  >&lt;p&gt;Looks great - thank you!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 38 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0y3zk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>