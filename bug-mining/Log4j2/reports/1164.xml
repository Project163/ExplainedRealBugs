<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:39:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2129] Log4j2 throws NoClassDefFoundError in Java 9</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2129</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;When I execute a sample project (&lt;a href=&quot;https://github.com/bbucko/log4j2-jpms-sample&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bbucko/log4j2-jpms-sample&lt;/a&gt;) in Java 9 a following exception is thrown:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.NoClassDefFoundError: Could not initialize &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.logging.log4j.util.PropertiesUtil
	at org.apache.logging.log4j/org.apache.logging.log4j.status.StatusLogger.&amp;lt;clinit&amp;gt;(StatusLogger.java:71)
	at org.apache.logging.log4j/org.apache.logging.log4j.LogManager.&amp;lt;clinit&amp;gt;(LogManager.java:60)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Exception is a little bit misleading because it seems that true root cause can be found here:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.util.ServiceConfigurationError: org.apache.logging.log4j.util.PropertySource: module org.apache.logging.log4j does not declare `uses`
	at java.base/java.util.ServiceLoader.fail(ServiceLoader.java:588)
	at java.base/java.util.ServiceLoader.checkCaller(ServiceLoader.java:574)
	at java.base/java.util.ServiceLoader.&amp;lt;init&amp;gt;(ServiceLoader.java:503)
	at java.base/java.util.ServiceLoader.load(ServiceLoader.java:1684)
	at org.apache.logging.log4j/org.apache.logging.log4j.util.PropertiesUtil$Environment.&amp;lt;init&amp;gt;(PropertiesUtil.java:319)
	at org.apache.logging.log4j/org.apache.logging.log4j.util.PropertiesUtil$Environment.&amp;lt;init&amp;gt;(PropertiesUtil.java:310)
	at org.apache.logging.log4j/org.apache.logging.log4j.util.PropertiesUtil.&amp;lt;init&amp;gt;(PropertiesUtil.java:69)
	at org.apache.logging.log4j/org.apache.logging.log4j.util.PropertiesUtil.&amp;lt;clinit&amp;gt;(PropertiesUtil.java:49)
	at org.apache.logging.log4j/org.apache.logging.log4j.util.Constants.&amp;lt;clinit&amp;gt;(Constants.java:30)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName0(Native Method)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.forName(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:375)
	at org.apache.logging.log4j/org.apache.logging.log4j.spi.AbstractLogger.createClassForProperty(AbstractLogger.java:198)
	at org.apache.logging.log4j/org.apache.logging.log4j.spi.AbstractLogger.&amp;lt;clinit&amp;gt;(AbstractLogger.java:88)
	at org.apache.logging.log4j/org.apache.logging.log4j.LogManager.&amp;lt;clinit&amp;gt;(LogManager.java:60)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Java 9&lt;/p&gt;</environment>
        <key id="13120808">LOG4J2-2129</key>
            <summary>Log4j2 throws NoClassDefFoundError in Java 9</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="blejzu">Blazej</reporter>
                        <labels>
                    </labels>
                <created>Sun, 26 Nov 2017 20:46:29 +0000</created>
                <updated>Thu, 12 Apr 2018 08:39:15 +0000</updated>
                            <resolved>Tue, 9 Jan 2018 05:48:29 +0000</resolved>
                                    <version>2.10.0</version>
                    <version>2.11.0</version>
                                    <fixVersion>2.11.0</fixVersion>
                                    <component>API</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="16266177" author="blejzu" created="Sun, 26 Nov 2017 20:48:04 +0000"  >&lt;p&gt;One more addition: same code runs fine if executed with previous version of log4j2 and an auto-generated module name in module-info.java.&lt;/p&gt;</comment>
                            <comment id="16266192" author="githubbot" created="Sun, 26 Nov 2017 21:27:57 +0000"  >&lt;p&gt;GitHub user bbucko opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/136&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2129&quot; title=&quot;Log4j2 throws NoClassDefFoundError in Java 9&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2129&quot;&gt;&lt;del&gt;LOG4J2-2129&lt;/del&gt;&lt;/a&gt; Added missing entries in module-info.java for Log4J API&lt;/p&gt;

&lt;p&gt;    This is only a quick fix for my sample project (&lt;a href=&quot;https://github.com/bbucko/log4j2-jpms-sample&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bbucko/log4j2-jpms-sample&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/bbucko/logging-log4j2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bbucko/logging-log4j2&lt;/a&gt; master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/136.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/136.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #136&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 3417e3a5044d6064f8d323d125130e3833b5c6c7&lt;br/&gt;
Author: Blazej Bucko &amp;lt;blazej.bucko@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-11-26T21:17:34Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2129&quot; title=&quot;Log4j2 throws NoClassDefFoundError in Java 9&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2129&quot;&gt;&lt;del&gt;LOG4J2-2129&lt;/del&gt;&lt;/a&gt; Added missing entries in module-info.java for Log4J API&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16266241" author="ralph.goers@dslextreme.com" created="Sun, 26 Nov 2017 23:07:13 +0000"  >&lt;p&gt;I see that we are calling ServiceLoader to load a PropertySource from PropertiesUtil. I don&apos;t see why a uses for PropertiesUtil is necessary. However, I do see another ServiceLoader call to load a ThreadInfoFactory class in ThreadDumpMessage, so that needs to be added as well.&lt;/p&gt;</comment>
                            <comment id="16266252" author="blejzu" created="Sun, 26 Nov 2017 23:33:54 +0000"  >&lt;p&gt;Ok, i&#8217;ll check that tomorrow. I created this PR to fix a sample JPMS app with my first j9 module so it&#8217;s far from complete. &lt;/p&gt;</comment>
                            <comment id="16266254" author="ralph.goers@dslextreme.com" created="Sun, 26 Nov 2017 23:38:08 +0000"  >&lt;p&gt;That&apos;s OK. Did you verify that a uses for PropertiesUtil is necessary or will it work with just the uses for PropertySource?&lt;/p&gt;</comment>
                            <comment id="16266507" author="blejzu" created="Mon, 27 Nov 2017 08:31:59 +0000"  >&lt;p&gt;Yes, you are right. PropertySource is not loaded by the ServiceLoader and is not needed. I fixed the PR.&lt;/p&gt;</comment>
                            <comment id="16266852" author="blejzu" created="Mon, 27 Nov 2017 14:10:00 +0000"  >&lt;p&gt;I&apos;ve been also playing with jlink to create a self-contained image and I think that some additional tweaking is needed. I&apos;ll try to fix travis and prepare a jdk9 build plus a sample application to demonstrate the problem.&lt;/p&gt;</comment>
                            <comment id="16316180" author="githubbot" created="Mon, 8 Jan 2018 12:02:55 +0000"  >&lt;p&gt;Github user timofonic commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/136&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @bbucko @remkop @Vampire @mikaelstaldal @garydgregory @rgoers @mikaelstaldal &lt;/p&gt;

&lt;p&gt;    What about this code? Any review or opinions about it? Any news?&lt;/p&gt;</comment>
                            <comment id="16316186" author="githubbot" created="Mon, 8 Jan 2018 12:08:15 +0000"  >&lt;p&gt;Github user remkop commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/136&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Sorry, can you explain a bit more what this is about? What problem are you trying to solve? &lt;/p&gt;</comment>
                            <comment id="16316216" author="githubbot" created="Mon, 8 Jan 2018 12:33:39 +0000"  >&lt;p&gt;Github user Vampire commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/136&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @timofonic what do I have to do with this?&lt;/p&gt;</comment>
                            <comment id="16316398" author="githubbot" created="Mon, 8 Jan 2018 14:27:23 +0000"  >&lt;p&gt;Github user bbucko commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/136&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @remkop current version is not working with java 9. Two Service Providers were not defined/exported in module-info.java.&lt;/p&gt;</comment>
                            <comment id="16316440" author="githubbot" created="Mon, 8 Jan 2018 14:59:21 +0000"  >&lt;p&gt;Github user remkop commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/136&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Can you be more specific? What is the error? Do you have a failing test or at least steps to reproduce? Why does the proposed change fix the problem? &lt;/p&gt;</comment>
                            <comment id="16316499" author="githubbot" created="Mon, 8 Jan 2018 15:42:32 +0000"  >&lt;p&gt;Github user bbucko commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/136&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @remkop Sure, everything is described in &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2129&quot; title=&quot;Log4j2 throws NoClassDefFoundError in Java 9&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2129&quot;&gt;&lt;del&gt;LOG4J2-2129&lt;/del&gt;&lt;/a&gt;(&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2129&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/LOG4J2-2129&lt;/a&gt;). I&apos;ve also prepared a sample project that fails when executed on java 9.&lt;/p&gt;</comment>
                            <comment id="16317744" author="jira-bot" created="Tue, 9 Jan 2018 05:39:00 +0000"  >&lt;p&gt;Commit 34a310442c075aa73d4607cd8cf40171dafd0da3 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=blejzu&quot; class=&quot;user-hover&quot; rel=&quot;blejzu&quot;&gt;blejzu&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=34a3104&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=34a3104&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2129&quot; title=&quot;Log4j2 throws NoClassDefFoundError in Java 9&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2129&quot;&gt;&lt;del&gt;LOG4J2-2129&lt;/del&gt;&lt;/a&gt; Added missing entries in module-info.java for Log4J API&lt;/p&gt;</comment>
                            <comment id="16317746" author="githubbot" created="Tue, 9 Jan 2018 05:39:13 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/136&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/136&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16317776" author="jira-bot" created="Tue, 9 Jan 2018 05:47:38 +0000"  >&lt;p&gt;Commit 1341bb6690ea2e24a9cd0377523a845f0a466b61 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ralphgoers&quot; class=&quot;user-hover&quot; rel=&quot;ralphgoers&quot;&gt;ralphgoers&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=1341bb6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=1341bb6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2129&quot; title=&quot;Log4j2 throws NoClassDefFoundError in Java 9&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2129&quot;&gt;&lt;del&gt;LOG4J2-2129&lt;/del&gt;&lt;/a&gt; - Log4j2 throws NoClassDefFoundError in Java 9 in java.util.ServiceLoader.&lt;/p&gt;</comment>
                            <comment id="16317787" author="ralph.goers@dslextreme.com" created="Tue, 9 Jan 2018 05:48:29 +0000"  >&lt;p&gt;Patch applied. Please verify and close.&lt;/p&gt;</comment>
                            <comment id="16318968" author="blejzu" created="Tue, 9 Jan 2018 19:04:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ralph.goers%40dslextreme.com&quot; class=&quot;user-hover&quot; rel=&quot;ralph.goers@dslextreme.com&quot;&gt;ralph.goers@dslextreme.com&lt;/a&gt; There&apos;s a new problem with log4j-core. automatic-module-name entry is missing from manifest.mf. I can investigate what&apos;s wrong. Should I create a new ticket or can I reuse this one and just create a new PR?&lt;/p&gt;</comment>
                            <comment id="16319060" author="blejzu" created="Tue, 9 Jan 2018 20:07:56 +0000"  >&lt;p&gt;I think that this commit: &lt;a href=&quot;https://github.com/apache/logging-log4j2/commit/81458cf2c8383abbd4a50a3bd79bc11c4add8610&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/commit/81458cf2c8383abbd4a50a3bd79bc11c4add8610&lt;/a&gt; removes all automatic-module-name entries from modules with changed poms. &lt;/p&gt;</comment>
                            <comment id="16402115" author="vampire" created="Fri, 16 Mar 2018 16:14:41 +0000"  >&lt;p&gt;Just in case someone needs a workaround because he cannot update, here is an easy one.&lt;br/&gt;
Compile a class named &lt;tt&gt;Log4JModulePatch&lt;/tt&gt; that lies in package &lt;tt&gt;org.apache.logging.log4j&lt;/tt&gt;.&lt;br/&gt;
Content of the class:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.apache.logging.log4j;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.logging.log4j.message.ThreadDumpMessage.ThreadInfoFactory;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.logging.log4j.util.PropertiesUtil;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.logging.log4j.util.PropertySource;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Log4JModulePatch {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void patch() {
        &lt;span class=&quot;code-comment&quot;&gt;//TODO: Remove with log4j 2.11.0 or newer
&lt;/span&gt;        Module log4jApiModule = PropertiesUtil.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;getModule();
        log4jApiModule.addUses(PropertySource.class);
        log4jApiModule.addUses(ThreadInfoFactory.class);
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Package it as a JAR and use &lt;tt&gt;--patch-module org.apache.logging.log4j=path/to/log4j-api-patch.jar&lt;/tt&gt; on execution.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;You can also simple use the attached &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12914888/12914888_log4j-api-patch.jar&quot; title=&quot;log4j-api-patch.jar attached to LOG4J2-2129&quot;&gt;log4j-api-patch.jar&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; and use the &lt;tt&gt;--patch-module&lt;/tt&gt; parameter mentioned above.&lt;/p&gt;</comment>
                            <comment id="16426333" author="johnston" created="Wed, 4 Apr 2018 23:42:06 +0000"  >&lt;p&gt;I get a similar error (jdk 9.0.4) using log4j 2.11.0 during runtime of an executable jar. I extracted the jar and the classes are there, but java -jar MyClass.jar outputs:&lt;/p&gt;

&lt;p&gt;Exception in thread &quot;main&quot; java.lang.NoClassDefFoundError: Could not initialize class org.apache.logging.log4j.util.PropertiesUtil&lt;br/&gt;
 at org.apache.logging.log4j.status.StatusLogger.&amp;lt;clinit&amp;gt;(StatusLogger.java:78)&lt;br/&gt;
 at org.apache.logging.log4j.LogManager.&amp;lt;clinit&amp;gt;(LogManager.java:60)&lt;br/&gt;
 at com.myco.project.subproject.MyClass.&amp;lt;clinit&amp;gt;(MyClass.java:37)&lt;/p&gt;

&lt;p&gt;private static final Logger LOGGER = LogManager.getLogger(MyClass.class); // 37&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16426521" author="vampire" created="Thu, 5 Apr 2018 06:26:18 +0000"  >&lt;p&gt;Do you mean a nasty fat JAR when you say executable?&lt;/p&gt;

&lt;p&gt;While &quot;executable&quot; actually is the wrong word, as the JAR is not really executed, or only means that the main class attribute is set in the manifest.&lt;/p&gt;

&lt;p&gt;If you meant a fat JAR, did you maybe forget to package the services files from META-INF too?&lt;/p&gt;

&lt;p&gt;If not, do you have an MCVE that you can provide?&lt;/p&gt;</comment>
                            <comment id="16427332" author="johnston" created="Thu, 5 Apr 2018 17:51:41 +0000"  >&lt;p&gt;The&#160;issue is related to using the shade plugin to build my jar. If I don&apos;t set minimizeJar to true log4j is callable during runtime. If I don&apos;t set minimizeJar, the error is generated at runtime. I&apos;m not sure what the intended functionality is to be. Here is my example:&lt;/p&gt;

&lt;p&gt;&amp;lt;!-- example\src\main\resources\log4j2.xml --&amp;gt;&lt;br/&gt;
&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;&lt;br/&gt;
&amp;lt;Configuration status=&quot;INFO&quot;&amp;gt;&lt;br/&gt;
 &amp;lt;Appenders&amp;gt;&lt;br/&gt;
 &amp;lt;Console name=&quot;Console&quot; target=&quot;SYSTEM_OUT&quot;&amp;gt;&lt;br/&gt;
 &amp;lt;PatternLayout pattern=&quot;%msg%n&quot;/&amp;gt;&lt;br/&gt;
 &amp;lt;/Console&amp;gt;&lt;br/&gt;
 &amp;lt;/Appenders&amp;gt;&lt;br/&gt;
 &amp;lt;Loggers&amp;gt;&lt;br/&gt;
 &amp;lt;Root level= &quot;info&quot;&amp;gt;&lt;br/&gt;
 &amp;lt;AppenderRef ref=&quot;Console&quot; /&amp;gt;&lt;br/&gt;
 &amp;lt;/Root&amp;gt;&lt;br/&gt;
 &amp;lt;/Loggers&amp;gt;&lt;br/&gt;
&amp;lt;/Configuration&amp;gt;&lt;/p&gt;

&lt;p&gt;// example\src\main\java\myco\mypro\MyClass.java&lt;br/&gt;
package com.myco.mypro;&lt;br/&gt;
import org.apache.logging.log4j.LogManager;&lt;br/&gt;
import org.apache.logging.log4j.Logger;&lt;br/&gt;
public class MyClass {&lt;br/&gt;
 private static final Logger LOGGER = LogManager.getLogger(MyClass.class); &lt;br/&gt;
 public static void main(String[] args) throws Exception &lt;/p&gt;
{
 LOGGER.info(&quot;Here\n&quot;);
 }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;&amp;lt;!-- example\pom.xml --&amp;gt;&lt;br/&gt;
&amp;lt;project xmlns=&quot;http://maven.apache.org/POM/4.0.0&quot; xmlns:xsi=&quot;http://www.w3.org/2001/XMLSchema-instance&quot;&lt;br/&gt;
 xsi:schemaLocation=&quot;http://maven.apache.org/POM/4.0.0 &lt;a href=&quot;http://maven.apache.org/xsd/maven-4.0.0.xsd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://maven.apache.org/xsd/maven-4.0.0.xsd&lt;/a&gt;&quot;&amp;gt;&lt;br/&gt;
 &amp;lt;modelVersion&amp;gt;4.0.0&amp;lt;/modelVersion&amp;gt;&lt;br/&gt;
 &amp;lt;groupId&amp;gt;com.myco&amp;lt;/groupId&amp;gt;&lt;br/&gt;
 &amp;lt;artifactId&amp;gt;mypro&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
 &amp;lt;version&amp;gt;0.01&amp;lt;/version&amp;gt;&lt;br/&gt;
 &amp;lt;properties&amp;gt;&lt;br/&gt;
 &amp;lt;log4japi.version&amp;gt;2.11.0&amp;lt;/log4japi.version&amp;gt;&lt;br/&gt;
 &amp;lt;log4jcore.version&amp;gt;2.11.0&amp;lt;/log4jcore.version&amp;gt;&lt;br/&gt;
 &amp;lt;/properties&amp;gt;&lt;br/&gt;
 &amp;lt;dependencies&amp;gt; &lt;br/&gt;
 &amp;lt;dependency&amp;gt;&lt;br/&gt;
 &amp;lt;groupId&amp;gt;org.apache.logging.log4j&amp;lt;/groupId&amp;gt;&lt;br/&gt;
 &amp;lt;artifactId&amp;gt;log4j-api&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
 &amp;lt;version&amp;gt;${log4japi.version}&amp;lt;/version&amp;gt;&lt;br/&gt;
 &amp;lt;/dependency&amp;gt;&lt;br/&gt;
 &amp;lt;dependency&amp;gt;&lt;br/&gt;
 &amp;lt;groupId&amp;gt;org.apache.logging.log4j&amp;lt;/groupId&amp;gt;&lt;br/&gt;
 &amp;lt;artifactId&amp;gt;log4j-core&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
 &amp;lt;version&amp;gt;${log4jcore.version}&amp;lt;/version&amp;gt;&lt;br/&gt;
 &amp;lt;/dependency&amp;gt;&lt;br/&gt;
 &amp;lt;/dependencies&amp;gt;&lt;br/&gt;
 &amp;lt;build&amp;gt;&lt;br/&gt;
 &amp;lt;finalName&amp;gt;MyClass&amp;lt;/finalName&amp;gt;&lt;br/&gt;
 &amp;lt;pluginManagement&amp;gt;&lt;br/&gt;
 &amp;lt;plugins&amp;gt;&lt;br/&gt;
 &amp;lt;plugin&amp;gt;&lt;br/&gt;
 &amp;lt;groupId&amp;gt;org.apache.maven.plugins&amp;lt;/groupId&amp;gt;&lt;br/&gt;
 &amp;lt;artifactId&amp;gt;maven-compiler-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
 &amp;lt;version&amp;gt;3.7.0&amp;lt;/version&amp;gt;&lt;br/&gt;
 &amp;lt;configuration&amp;gt;&lt;br/&gt;
 &amp;lt;source&amp;gt;1.8&amp;lt;/source&amp;gt;&lt;br/&gt;
 &amp;lt;target&amp;gt;1.8&amp;lt;/target&amp;gt;&lt;br/&gt;
 *&lt;b&gt;&amp;lt;encoding&amp;gt;${project.build.sourceEncoding}&amp;lt;/encoding&amp;gt;&lt;/b&gt;* &lt;br/&gt;
 &amp;lt;/configuration&amp;gt;&lt;br/&gt;
 &amp;lt;/plugin&amp;gt;&lt;br/&gt;
 &amp;lt;/plugins&amp;gt;&lt;br/&gt;
 &amp;lt;/pluginManagement&amp;gt; &lt;br/&gt;
 &amp;lt;plugins&amp;gt; &lt;br/&gt;
 &amp;lt;plugin&amp;gt;&lt;br/&gt;
 &amp;lt;groupId&amp;gt;org.apache.maven.plugins&amp;lt;/groupId&amp;gt; &lt;br/&gt;
 &amp;lt;artifactId&amp;gt;maven-shade-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
 &amp;lt;version&amp;gt;3.1.0&amp;lt;/version&amp;gt;&lt;br/&gt;
 &amp;lt;executions&amp;gt;&lt;br/&gt;
 &amp;lt;execution&amp;gt;&lt;br/&gt;
 &amp;lt;phase&amp;gt;package&amp;lt;/phase&amp;gt;&lt;br/&gt;
 &amp;lt;goals&amp;gt;&lt;br/&gt;
 &amp;lt;goal&amp;gt;shade&amp;lt;/goal&amp;gt;&lt;br/&gt;
 &amp;lt;/goals&amp;gt;&lt;br/&gt;
 &amp;lt;configuration&amp;gt; &lt;br/&gt;
 &amp;lt;!-- &amp;lt;minimizeJar&amp;gt;true&amp;lt;/minimizeJar&amp;gt; --&amp;gt;&lt;br/&gt;
 &amp;lt;minimizeJar&amp;gt;true&amp;lt;/minimizeJar&amp;gt;&lt;br/&gt;
 &amp;lt;transformers&amp;gt;&lt;br/&gt;
 &amp;lt;transformer implementation=&quot;org.apache.maven.plugins.shade.resource.ManifestResourceTransformer&quot;&amp;gt;&lt;br/&gt;
 &amp;lt;mainClass&amp;gt;com.myco.mypro.MyClass&amp;lt;/mainClass&amp;gt;&lt;br/&gt;
 &amp;lt;/transformer&amp;gt;&lt;br/&gt;
 &amp;lt;/transformers&amp;gt;&lt;br/&gt;
 &amp;lt;/configuration&amp;gt;&lt;br/&gt;
 &amp;lt;/execution&amp;gt;&lt;br/&gt;
 &amp;lt;/executions&amp;gt;&lt;br/&gt;
 &amp;lt;/plugin&amp;gt;&lt;br/&gt;
 &amp;lt;/plugins&amp;gt;&lt;br/&gt;
 &amp;lt;/build&amp;gt;&lt;br/&gt;
&amp;lt;/project&amp;gt;&lt;/p&gt;</comment>
                            <comment id="16435160" author="vampire" created="Thu, 12 Apr 2018 08:39:15 +0000"  >&lt;p&gt;Well, if you have to use that evil plugin &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Johnston&quot; class=&quot;user-hover&quot; rel=&quot;Johnston&quot;&gt;Johnston&lt;/a&gt;, then at least configure it correctly.&lt;/p&gt;

&lt;p&gt;Your problem has nothing to do with this bug, but that you leave out necessary files.&lt;/p&gt;

&lt;p&gt;It is surely significant, that the plugins documentation even uses &lt;tt&gt;log4j&lt;/tt&gt; as example for preventing the minimizing: &lt;a href=&quot;https://maven.apache.org/plugins/maven-shade-plugin/examples/includes-excludes.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://maven.apache.org/plugins/maven-shade-plugin/examples/includes-excludes.html&lt;/a&gt; last example&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13136454">LOG4J2-2241</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13138467">LOG4J2-2249</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12914888" name="log4j-api-patch.jar" size="1309" author="vampire" created="Fri, 16 Mar 2018 16:13:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 31 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3n74v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>