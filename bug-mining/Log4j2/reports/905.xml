<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:37:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-1542] java.lang.ArrayIndexOutOfBoundsException in ParameterizedMessage.formatTo(ParameterizedMessage.java:221)</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-1542</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;This error is reproducible when method fomarTo of the class ParameterizedMessage is invoked.&lt;/p&gt;

&lt;p&gt;This root cause is the method init of same class where is invoked, in the this.indices is initializaded with messagePattern.length() &amp;gt;&amp;gt; 1 run to equals zero because that messagePattern.length() is 1 (string with one character).&lt;/p&gt;

&lt;p&gt;I used File Appender in my XML config and I wrote my code with logger.trace(&quot;a&quot;).&lt;br/&gt;
My PatternLayout used is pattern=&quot;%m&quot; (simplest).&lt;/p&gt;</description>
                <environment>&lt;p&gt;Array length logic causes throw java.lang.ArrayIndexOutOfBoundsException&lt;/p&gt;</environment>
        <key id="12999215">LOG4J2-1542</key>
            <summary>java.lang.ArrayIndexOutOfBoundsException in ParameterizedMessage.formatTo(ParameterizedMessage.java:221)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rpopma">Remko Popma</assignee>
                                    <reporter username="RogerioLLeite">Rog&#233;rio Lecari&#227;o Leite</reporter>
                        <labels>
                            <label>easyfix</label>
                    </labels>
                <created>Tue, 23 Aug 2016 13:16:45 +0000</created>
                <updated>Mon, 5 Sep 2016 17:41:54 +0000</updated>
                            <resolved>Mon, 5 Sep 2016 17:41:54 +0000</resolved>
                                    <version>2.6.2</version>
                                    <fixVersion>2.7</fixVersion>
                                    <component>API</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="15432835" author="ralph.goers@dslextreme.com" created="Tue, 23 Aug 2016 13:59:28 +0000"  >&lt;p&gt;If you can provide a patch with a test and a fix that would be awesome.&lt;/p&gt;</comment>
                            <comment id="15432870" author="rogeriolleite" created="Tue, 23 Aug 2016 14:18:19 +0000"  >&lt;p&gt;Hi Ralph,&lt;br/&gt;
I am newbie on Jira, but the correction is like as Math.max(-1,1) or Math.max(0,1).&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;ParameterizedMessage.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void init(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; messagePattern) {
	&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.messagePattern = messagePattern;
	&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.indices = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[messagePattern == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? 0 : messagePattern.length() &amp;gt;&amp;gt; 1]; &lt;span class=&quot;code-comment&quot;&gt;// divide by 2
&lt;/span&gt;	&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; placeholders = ParameterFormatter.countArgumentPlaceholders2(messagePattern, indices);
	initThrowable(argArray, placeholders);
	&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.usedCount = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.min(placeholders, argArray == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? 0 : argArray.length);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Changed to:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;ParameterizedMessage.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void init(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; messagePattern) {
	&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; arraySize = messagePattern == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? 0 : &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.max(messagePattern.length() &amp;gt;&amp;gt; 1, 1);
	&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.messagePattern = messagePattern;
	&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.indices = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[arraySize]; 
        Arrays.fill(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.indices, -1);&lt;span class=&quot;code-comment&quot;&gt;//grant indices &amp;lt; 0
&lt;/span&gt;	&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; placeholders = ParameterFormatter.countArgumentPlaceholders2(messagePattern, indices);
	initThrowable(argArray, placeholders);
	&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.usedCount = &lt;span class=&quot;code-object&quot;&gt;Math&lt;/span&gt;.min(placeholders, argArray == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? 0 : argArray.length);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Some Tests:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Test with empty string&lt;/li&gt;
	&lt;li&gt;Test with one character string&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;This would be enough? &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/biggrin.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15432983" author="garydgregory" created="Tue, 23 Aug 2016 15:10:49 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RogerioLLeite&quot; class=&quot;user-hover&quot; rel=&quot;RogerioLLeite&quot;&gt;RogerioLLeite&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;Can you please add a stack trace to the ticket description? This will give users in the future using search engines a chance to find this ticket. &lt;/p&gt;

&lt;p&gt;It&apos;s a nice thing to do anyway when reporting an exception &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thank you,&lt;br/&gt;
Gary&lt;/p&gt;</comment>
                            <comment id="15433777" author="rogeriolleite" created="Tue, 23 Aug 2016 22:40:35 +0000"  >&lt;p&gt;Hi Gary,&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;run:
2016/08/23 19:30:57.683 TRACE [@Application-Client][THREAD(main)](Utils.java:46)
                              [m]a[/m]
2016-08-23 19:30:57,686 AsyncAppender-AsyncFile ERROR An exception occurred processing Appender FileLog java.lang.ArrayIndexOutOfBoundsException: 0
	at org.apache.logging.log4j.message.ParameterizedMessage.formatTo(ParameterizedMessage.java:221)
	at org.apache.logging.log4j.core.pattern.MessagePatternConverter.format(MessagePatternConverter.java:65)
	at org.apache.logging.log4j.core.pattern.PatternFormatter.formatWithInfo(PatternFormatter.java:45)
	at org.apache.logging.log4j.core.pattern.PatternFormatter.format(PatternFormatter.java:40)
	at org.apache.logging.log4j.core.layout.PatternLayout$PatternSerializer.toSerializable(PatternLayout.java:294)
	at org.apache.logging.log4j.core.layout.PatternLayout.toText(PatternLayout.java:195)
	at org.apache.logging.log4j.core.layout.PatternLayout.encode(PatternLayout.java:180)
	at org.apache.logging.log4j.core.layout.PatternLayout.encode(PatternLayout.java:57)
	at org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.directEncodeEvent(AbstractOutputStreamAppender.java:120)
	at org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.tryAppend(AbstractOutputStreamAppender.java:113)
	at org.apache.logging.log4j.core.appender.AbstractOutputStreamAppender.append(AbstractOutputStreamAppender.java:104)
	at org.apache.logging.log4j.core.config.AppenderControl.tryCallAppender(AppenderControl.java:155)
	at org.apache.logging.log4j.core.config.AppenderControl.callAppender0(AppenderControl.java:128)
	at org.apache.logging.log4j.core.config.AppenderControl.callAppenderPreventRecursion(AppenderControl.java:119)
	at org.apache.logging.log4j.core.config.AppenderControl.callAppender(AppenderControl.java:84)
	at org.apache.logging.log4j.core.appender.AsyncAppender$AsyncThread.callAppenders(AsyncAppender.java:338)
	at org.apache.logging.log4j.core.appender.AsyncAppender$AsyncThread.run(AsyncAppender.java:291)

BUILD SUCCESSFUL (total time: 5 seconds)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;log4j.xml&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;Configuration name=&lt;span class=&quot;code-quote&quot;&gt;&quot;ProjectApplicationClient&quot;&lt;/span&gt; status=&lt;span class=&quot;code-quote&quot;&gt;&quot;WARN&quot;&lt;/span&gt; monitorInterval=&lt;span class=&quot;code-quote&quot;&gt;&quot;2000&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;Properties&amp;gt;
        &amp;lt;Property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;fileoutname&quot;&lt;/span&gt;&amp;gt;log_$${date:yyyy-MM-dd_HH-mm-ss}.txt&amp;lt;/Property&amp;gt;
        &amp;lt;Property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;fileoutpath&quot;&lt;/span&gt;&amp;gt;file:&lt;span class=&quot;code-comment&quot;&gt;//${fileoutname}&amp;lt;/Property&amp;gt;
&lt;/span&gt;        &amp;lt;Property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;patternlayout&quot;&lt;/span&gt;&amp;gt;%d{yyyy/MM/dd HH:mm:ss.SSS} %-5p [@Application-Client][CLASS(%-1.64c{10})][THREAD(%-1.32t)](%F:%L)%n                              [m]%-1.2048m[/m]%n&amp;lt;/Property&amp;gt;

	&amp;lt;/Properties&amp;gt;
    &amp;lt;Appenders&amp;gt;
        &amp;lt;Console name=&lt;span class=&quot;code-quote&quot;&gt;&quot;ConsoleOut&quot;&lt;/span&gt; target=&lt;span class=&quot;code-quote&quot;&gt;&quot;SYSTEM_OUT&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;Filters&amp;gt;
                &amp;lt;ThresholdFilter level=&lt;span class=&quot;code-quote&quot;&gt;&quot;TRACE&quot;&lt;/span&gt; onMatch=&lt;span class=&quot;code-quote&quot;&gt;&quot;ACCEPT&quot;&lt;/span&gt; onMismatch=&lt;span class=&quot;code-quote&quot;&gt;&quot;DENY&quot;&lt;/span&gt;/&amp;gt;
            &amp;lt;/Filters&amp;gt;
            &amp;lt;PatternLayout pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;${patternlayout}&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;/Console&amp;gt;
        &amp;lt;Console name=&lt;span class=&quot;code-quote&quot;&gt;&quot;ConsoleErr&quot;&lt;/span&gt; target=&lt;span class=&quot;code-quote&quot;&gt;&quot;SYSTEM_ERR&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;Filters&amp;gt;
                &amp;lt;ThresholdFilter level=&lt;span class=&quot;code-quote&quot;&gt;&quot;ERROR&quot;&lt;/span&gt; onMatch=&lt;span class=&quot;code-quote&quot;&gt;&quot;ACCEPT&quot;&lt;/span&gt; onMismatch=&lt;span class=&quot;code-quote&quot;&gt;&quot;DENY&quot;&lt;/span&gt;/&amp;gt;
            &amp;lt;/Filters&amp;gt;
            &amp;lt;PatternLayout&amp;gt;
                &amp;lt;Pattern&amp;gt;${patternlayout}&amp;lt;/Pattern&amp;gt;
            &amp;lt;/PatternLayout&amp;gt;
        &amp;lt;/Console&amp;gt;
        &amp;lt;File name=&lt;span class=&quot;code-quote&quot;&gt;&quot;FileLog&quot;&lt;/span&gt;
              fileName=&lt;span class=&quot;code-quote&quot;&gt;&quot;${fileoutname}&quot;&lt;/span&gt;
              bufferSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;
              bufferedIO=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;
              advertiseURI=&lt;span class=&quot;code-quote&quot;&gt;&quot;${fileoutpath}&quot;&lt;/span&gt;
              advertise=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;
              append=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;PatternLayout pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;${patternlayout}&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;/File&amp;gt;
        &amp;lt;Async name=&lt;span class=&quot;code-quote&quot;&gt;&quot;AsyncFile&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;FileLog&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;/Async&amp;gt;
    &amp;lt;/Appenders&amp;gt;
    &amp;lt;Loggers&amp;gt;
        &amp;lt;Root level=&lt;span class=&quot;code-quote&quot;&gt;&quot;trace&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;AsyncFile&quot;&lt;/span&gt;/&amp;gt;
            &amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;ConsoleOut&quot;&lt;/span&gt;/&amp;gt;
            &amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;ConsoleErr&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;/Root&amp;gt;
    &amp;lt;/Loggers&amp;gt;
&amp;lt;/Configuration&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;Utils.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        Logger log = LogManager.getLogger();
        Logger log2 = LogManager.getLogger(&lt;span class=&quot;code-quote&quot;&gt;&quot;mylog&quot;&lt;/span&gt;);
        log2.trace(&lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;item&quot;&lt;/span&gt;);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;See the comments ;D&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;ParameterizedMessage.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;@Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void formatTo(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; StringBuilder buffer) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (formattedMessage != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            buffer.append(formattedMessage);
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (indices[0] &amp;lt; 0) {&lt;span class=&quot;code-comment&quot;&gt;/*LOG4J2-1542: &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; point indices.length is equals to zero. Check array length first? */&lt;/span&gt;
                ParameterFormatter.formatMessage(buffer, messagePattern, argArray, usedCount);
            } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
                ParameterFormatter.formatMessage2(buffer, messagePattern, argArray, usedCount, indices);
            }
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15434654" author="lqbweb" created="Wed, 24 Aug 2016 10:19:10 +0000"  >&lt;p&gt;I can confirm this bug, simply log something like:&lt;/p&gt;

&lt;p&gt;logger.warn(&quot;&quot;, exception);&lt;/p&gt;

&lt;p&gt;And then in a ListAppender try to receive the event, by calling getFormattedMessage in the ParameterizedMessage it crashes due to this problem.&lt;/p&gt;

&lt;p&gt;A workaround for me is something like:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;			&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(last.getMessage().getFormat() == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || last.getMessage().getFormat().isEmpty()) {
				&lt;span class=&quot;code-comment&quot;&gt;//no message, lets &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; the exception message
&lt;/span&gt;				&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; last.getThrown().getMessage();
			} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
				&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; last.getMessage().getFormattedMessage();
			}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I can confirm the solution provided by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RogerioLLeite&quot; class=&quot;user-hover&quot; rel=&quot;RogerioLLeite&quot;&gt;RogerioLLeite&lt;/a&gt; looks good to me.&lt;/p&gt;</comment>
                            <comment id="15438736" author="lqbweb" created="Fri, 26 Aug 2016 09:56:33 +0000"  >&lt;p&gt;Also, when you log something like this:&lt;/p&gt;

&lt;p&gt;logger.info(&quot;&quot;, &quot;another string&quot;);&lt;/p&gt;

&lt;p&gt;it simply crashes!&lt;/p&gt;</comment>
                            <comment id="15463840" author="remkop@yahoo.com" created="Mon, 5 Sep 2016 01:41:36 +0000"  >&lt;p&gt;The suggested fix looks good. I will try to put this in master in about 8 hours if somebody does not beat me to it.&lt;/p&gt;</comment>
                            <comment id="15465474" author="remkop@yahoo.com" created="Mon, 5 Sep 2016 17:41:54 +0000"  >&lt;p&gt;Fixed in master in commit 8bd80f3. &lt;br/&gt;
Please verify and close.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10431"><![CDATA[Important]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 11 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i32ncv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>