<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:36:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-1368] Status logger drops/ignores exception</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-1368</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Internal log4j logging like below will just log the message but will not report the specified exception:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
    someProcess();
} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception exception) {
    StatusLogger.getLogger().warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;error occurred during {}&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;some process&quot;&lt;/span&gt;, exception);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is caused by a bug in ParameterizedNoReferenceMessageFactory (the factory used by StatusLogger):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; formatted = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ParameterizedMessage(message, params).getFormattedMessage();
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleMessage(formatted); &lt;span class=&quot;code-comment&quot;&gt;// exception is dropped&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This factory was introduced to resolve memory leaks that appeared in web containers because StatusLogger keeps a ring buffer of previously logged messages and ParameterizedMessage keeps a reference to its parameter objects (&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-1176&quot; title=&quot;Memory leak from first loaded web app when log4j jars are in Tomcat&amp;#39;s lib folder&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-1176&quot;&gt;&lt;del&gt;LOG4J2-1176&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;AbstractLogger depends on the Message to get the Throwable when logging a message with parameters, so SimpleMessage is not good enough. I&apos;m thinking to introduce a new class &lt;tt&gt;StatusMessage&lt;/tt&gt; (perhaps as an inner class of ParameterizedNoReferenceMessageFactory in order to keep the API surface small). StatusMessage would have the formatted string and the Throwable (which may be null). That should solve this issue.&lt;/p&gt;

&lt;p&gt;If the Throwable is a custom Log4j class like AppenderLoggingException then keeping a reference to it may re-introduce memory leaks again though, but I guess that is a fight for another day...&lt;/p&gt;</description>
                <environment></environment>
        <key id="12959022">LOG4J2-1368</key>
            <summary>Status logger drops/ignores exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rpopma">Remko Popma</assignee>
                                    <reporter username="rpopma">Remko Popma</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Apr 2016 00:32:27 +0000</created>
                <updated>Sat, 18 Jun 2016 23:38:45 +0000</updated>
                            <resolved>Fri, 15 Apr 2016 15:53:01 +0000</resolved>
                                    <version>2.5</version>
                                    <fixVersion>2.6</fixVersion>
                                    <component>API</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15243139" author="remkop@yahoo.com" created="Fri, 15 Apr 2016 15:53:01 +0000"  >&lt;p&gt;Fixed in master in commit afb7207.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12972328">LOG4J2-1392</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 31 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2w5jj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>