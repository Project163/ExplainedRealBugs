<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:34:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-1158] Log4J JUL adapter is using MessageFormat on String passed by java.util.function.Supplier&lt;String&gt;</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-1158</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Log4J JUL is attempting to &lt;em&gt;MessageFormat&lt;/em&gt; a String passed by &lt;em&gt;&lt;b&gt;java.util.logging&lt;/b&gt;&lt;/em&gt;.Logger.info(java.util.function.&lt;em&gt;Supplier&lt;/em&gt;&amp;lt;&lt;b&gt;String&lt;/b&gt;&amp;gt;) and fails with java.lang.&lt;em&gt;&lt;b&gt;IllegalArgumentException&lt;/b&gt;&lt;/em&gt; when the String contains &lt;b&gt;&lt;em&gt;{ }&lt;/em&gt;&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;In the following example, line #2 will throw an &lt;em&gt;&lt;b&gt;IllegalArgumentException&lt;/b&gt;&lt;/em&gt;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// writing the configuration file on the fly &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the purpose of &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; demo only
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (java.io.PrintStream p = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; java.io.PrintStream(&lt;span class=&quot;code-quote&quot;&gt;&quot;./log4j-jul-test.xml&quot;&lt;/span&gt;)) {
    p.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;Configuration/&amp;gt;&quot;&lt;/span&gt;);
}

&lt;span class=&quot;code-comment&quot;&gt;// specifying the java.util.logging.LogManager implementation
&lt;/span&gt;&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;java.util.logging.manager&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.logging.log4j.jul.LogManager&quot;&lt;/span&gt;);
&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.setProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;log4j.configurationFile&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;log4j-jul-test.xml&quot;&lt;/span&gt;);

java.util.logging.LogManager.getLogManager().getLogger(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;).severe(&lt;span class=&quot;code-quote&quot;&gt;&quot;This 1st {will} be logged correctly by log4J&quot;&lt;/span&gt;);
&lt;span class=&quot;code-comment&quot;&gt;// output is: 11:15:40.492 [main] ERROR test - This 1st {will} be logged correctly by log4J
&lt;/span&gt;
java.util.logging.LogManager.getLogManager().getLogger(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;).severe(() -&amp;gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;This 2nd {will not} be logged correctly by log4J&quot;&lt;/span&gt;);
&lt;span class=&quot;code-comment&quot;&gt;// output is: 2015-10-10 11:15:40,523 main ERROR An exception occurred processing Appender Console java.lang.IllegalArgumentException: can&apos;t parse argument number: will not
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//    at java.text.MessageFormat.makeFormat(MessageFormat.java:1429)
&lt;/span&gt;&lt;span class=&quot;code-comment&quot;&gt;//    at java.text.MessageFormat.applyPattern(MessageFormat.java:479)&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;See also example on &lt;a href=&quot;http://stackoverflow.com/a/33050986/495987&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/a/33050986/495987&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Window 7 Business 64 bit&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.8.0_25-b18)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 25.25-b02, mixed mode)&lt;br/&gt;
(log4j-jul-2.4.jar, log4j-core-2.4.jar, log4j-api-2.4.jar)&lt;/p&gt;</environment>
        <key id="12903981">LOG4J2-1158</key>
            <summary>Log4J JUL adapter is using MessageFormat on String passed by java.util.function.Supplier&lt;String&gt;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggregory">Gary D. Gregory</assignee>
                                    <reporter username="mollix">Michael Fortin</reporter>
                        <labels>
                    </labels>
                <created>Sat, 10 Oct 2015 15:19:04 +0000</created>
                <updated>Tue, 19 Jan 2016 13:59:29 +0000</updated>
                            <resolved>Tue, 13 Oct 2015 07:31:54 +0000</resolved>
                                    <version>2.4</version>
                    <version>2.4.1</version>
                                    <fixVersion>2.5</fixVersion>
                                    <component>JUL adapter</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14953658" author="garydgregory" created="Mon, 12 Oct 2015 20:10:24 +0000"  >&lt;p&gt;This will be best addressed when we update Log4j to require Java 8. Alternatively we can create a log4j-jul8 module. I&apos;m not a fan of updating the current code with reflection trickery but that&apos;s also a way to go.&lt;/p&gt;</comment>
                            <comment id="14953695" author="ralph.goers@dslextreme.com" created="Mon, 12 Oct 2015 20:46:35 +0000"  >&lt;p&gt;I know we discussed the issues with our JUL compatibility with Java 8 and you expressed your reservations about using reflection for that, but I am not sure how that relates to this particular issue. Here the user wants to pass a string with &quot;{NULL}&quot; in it but it fails because we are assuming it is a MessageFormatMessage instead of just a StringMessage.&lt;/p&gt;
</comment>
                            <comment id="14954547" author="garydgregory" created="Tue, 13 Oct 2015 07:31:54 +0000"  >&lt;p&gt;In Git master now. Please verify and close.&lt;/p&gt;</comment>
                            <comment id="14956018" author="ralph.goers@dslextreme.com" created="Wed, 14 Oct 2015 00:33:23 +0000"  >&lt;p&gt;I think it might be a mistake to just use SimpleMessage for this. I would think that using FormattedMessage might make more sense here. It still allows for logEvents that expect to use MessageFormat but should avoid the exception being complained about here.&lt;/p&gt;

&lt;p&gt;It would be nice if there was some way to configure which MessageFactory to use.&lt;/p&gt;</comment>
                            <comment id="14957791" author="garydgregory" created="Wed, 14 Oct 2015 21:17:54 +0000"  >&lt;p&gt;I think you are right based on this new test: &lt;tt&gt;org.apache.logging.log4j.jul.AbstractLoggerTest.testLogParamMarkers()&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;I think we need a custom JUL message that knows how to only handle {0}, {1}, and so on.&lt;/p&gt;</comment>
                            <comment id="14958016" author="mollix" created="Wed, 14 Oct 2015 23:38:40 +0000"  >&lt;p&gt;Hi guys,&lt;/p&gt;

&lt;p&gt;I have a basic observation: If the interface is &lt;b&gt;Supplier&amp;lt;String&amp;gt;&lt;/b&gt;, there&lt;br/&gt;
is no way to pass any parameters. In this case, shouldn&apos;t the message to be&lt;br/&gt;
logged be interpreted as a simple String?&lt;/p&gt;

&lt;p&gt;java.util.logging.Logger.info(Supplier&amp;lt;&lt;b&gt;String&lt;/b&gt;&amp;gt;)&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Mike.&lt;/p&gt;

&lt;p&gt;On Wed, Oct 14, 2015 at 5:18 PM, Gary Gregory (JIRA) &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="15106747" author="romain.lalaut" created="Tue, 19 Jan 2016 13:59:29 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I have a similar error with 2.5 :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ERROR An exception occurred processing Appender console java.lang.IllegalArgumentException: can&apos;t parse argument number: 
        Member [localhost]:2434 &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;

        at java.text.MessageFormat.makeFormat(MessageFormat.java:1429)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The complete log message is (yes, with new lines) :&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Members [1] {
        Member [localhost]:2434 &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
}
 [TcpIpJoiner] 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 44 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2muqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>