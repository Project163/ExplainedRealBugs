<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:38:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-1961] Reconfigure breaks DirectWriteRolloverStrategy</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-1961</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;A reconfigure breaks &lt;tt&gt;DirectWriteRolloverStrategy&lt;/tt&gt; which leads to the errors similar to that one:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2017-06-30 10:45:56,010 Log4j2-TF-4-Scheduled-3 ERROR Log4j2 ConfigurationScheduler caught error running command java.lang.NullPointerException: activeFileName
	at java.util.Objects.requireNonNull(Objects.java:228)
	at org.apache.logging.log4j.core.appender.rolling.RolloverDescriptionImpl.&amp;lt;init&amp;gt;(RolloverDescriptionImpl.java:60)
	at org.apache.logging.log4j.core.appender.rolling.DirectWriteRolloverStrategy.rollover(DirectWriteRolloverStrategy.java:220)
	at org.apache.logging.log4j.core.appender.rolling.RollingFileManager.rollover(RollingFileManager.java:388)
	at org.apache.logging.log4j.core.appender.rolling.RollingFileManager.rollover(RollingFileManager.java:304)
	at org.apache.logging.log4j.core.appender.rolling.CronTriggeringPolicy.rollover(CronTriggeringPolicy.java:153)
	at org.apache.logging.log4j.core.appender.rolling.CronTriggeringPolicy.access$100(CronTriggeringPolicy.java:43)
	at org.apache.logging.log4j.core.appender.rolling.CronTriggeringPolicy$CronTrigger.run(CronTriggeringPolicy.java:176)
	at org.apache.logging.log4j.core.config.ConfigurationScheduler$CronRunnable.run(ConfigurationScheduler.java:230)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.access$201(ScheduledThreadPoolExecutor.java:180)
	at java.util.concurrent.ScheduledThreadPoolExecutor$ScheduledFutureTask.run(ScheduledThreadPoolExecutor.java:293)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Durring the rollover the system is using the field &lt;tt&gt;currentFileName&lt;/tt&gt;, which might be null after an reconfigure:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;org.apache.logging.log4j.core.appender.rolling.DirectWriteRolloverStrategy#rollover&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
Action compressAction = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; sourceName = currentFileName;
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; compressedName = sourceName;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Instead of that I&apos;d propose to use &lt;tt&gt;getCurrentFileName()&lt;/tt&gt; directly, to access the field. Doing so the field would be initialised again, if necessary.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;org.apache.logging.log4j.core.appender.rolling.DirectWriteRolloverStrategy#rollover&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
Action compressAction = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; sourceName = getCurrentFileName(manager);
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; compressedName = sourceName;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13083717">LOG4J2-1961</key>
            <summary>Reconfigure breaks DirectWriteRolloverStrategy</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="cvent">Christian Vent</reporter>
                        <labels>
                    </labels>
                <created>Fri, 30 Jun 2017 08:57:38 +0000</created>
                <updated>Fri, 1 Sep 2017 07:24:13 +0000</updated>
                            <resolved>Thu, 6 Jul 2017 10:05:03 +0000</resolved>
                                    <version>2.8</version>
                                    <fixVersion>2.9.0</fixVersion>
                                    <component>Plugins</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16069739" author="cvent" created="Fri, 30 Jun 2017 08:59:40 +0000"  >&lt;p&gt;I added a patch to fix the issue, including a test to rebuild the error&lt;/p&gt;</comment>
                            <comment id="16076286" author="jira-bot" created="Thu, 6 Jul 2017 10:04:33 +0000"  >&lt;p&gt;Commit 5e92ed9fad60b6034676ac74f7ac4f3c072eb315 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cvent&quot; class=&quot;user-hover&quot; rel=&quot;cvent&quot;&gt;cvent&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=5e92ed9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=5e92ed9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-1961&quot; title=&quot;Reconfigure breaks DirectWriteRolloverStrategy&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-1961&quot;&gt;&lt;del&gt;LOG4J2-1961&lt;/del&gt;&lt;/a&gt; Reconfigure breaks DirectWriteRolloverStrategy.&lt;/p&gt;</comment>
                            <comment id="16076287" author="garydgregory" created="Thu, 6 Jul 2017 10:05:03 +0000"  >&lt;p&gt;In Git master now. Please verify and close.&lt;/p&gt;</comment>
                            <comment id="16088665" author="mikaelstaldal" created="Sat, 15 Jul 2017 17:03:08 +0000"  >&lt;p&gt;The new test fails on Java 8 and Java 9:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[ERROR] Failures:
[ERROR] RollingAppenderDirectWriteWithReconfigureTest.testRollingFileAppenderWithReconfigure:68
Expected: is &amp;lt;2&amp;gt;
     but: was &amp;lt;1&amp;gt; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16090375" author="mikaelstaldal" created="Mon, 17 Jul 2017 19:20:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cvent&quot; class=&quot;user-hover&quot; rel=&quot;cvent&quot;&gt;cvent&lt;/a&gt; Have you tried this on Java 7 or Java 8?&lt;/p&gt;

&lt;p&gt;If you have tried only on Java 7, would it be possible for you to test it on Java 8 as well?&lt;/p&gt;</comment>
                            <comment id="16098256" author="cvent" created="Mon, 24 Jul 2017 12:05:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mikaelstaldal&quot; class=&quot;user-hover&quot; rel=&quot;mikaelstaldal&quot;&gt;mikaelstaldal&lt;/a&gt; I&apos;m using Java 8 in my JDK and the test is still woking locally. I removed the assume and run the test several times in my IDE and with mvn.&lt;/p&gt;</comment>
                            <comment id="16103694" author="mikaelstaldal" created="Thu, 27 Jul 2017 18:53:04 +0000"  >&lt;p&gt;Which OS are you using? Can you show the output of &quot;java -version&quot;&lt;/p&gt;</comment>
                            <comment id="16150163" author="cvent" created="Fri, 1 Sep 2017 07:24:13 +0000"  >&lt;p&gt;Sure, I&apos;m using MacOS Sierra (10.12.x).&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Java -version
java version &quot;1.8.0_121&quot;
Java(TM) SE Runtime Environment (build 1.8.0_121-b13)
Java HotSpot(TM) 64-Bit Server VM (build 25.121-b13, mixed mode)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13073357">LOG4J2-1916</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12875212" name="DirectWriteRolloverStrategy.patch" size="6482" author="cvent" created="Fri, 30 Jun 2017 08:58:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 11 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3gxt3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>