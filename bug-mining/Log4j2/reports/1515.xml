<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:42:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-3237] Log4j 1.2 bridge API hard codes the Syslog protocol to TCP</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-3237</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;&lt;b&gt;Log4j 1.2 bridge API hard codes protocol to TCP and host address and port to localhost:514&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;b&gt;-Dlog4j1.compatibility=true -jar&lt;/b&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;backtrace&lt;/b&gt; :-&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2021-12-16 00:35:32,904 main ERROR TcpSocketManager (TCP:localhost:514) caught exception and will &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt;: java.io.IOException: Unable to create socket &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; localhost at port 514 using ip addresses and ports , 0:0:0:0:0:0:0:1:514
at org.apache.logging.log4j.core.net.TcpSocketManager$TcpSocketManagerFactory.createSocket(TcpSocketManager.java:509)
at org.apache.logging.log4j.core.net.TcpSocketManager$TcpSocketManagerFactory.createManager(TcpSocketManager.java:478)
at org.apache.logging.log4j.core.net.TcpSocketManager$TcpSocketManagerFactory.createManager(TcpSocketManager.java:459)
at org.apache.logging.log4j.core.appender.AbstractManager.getManager(AbstractManager.java:113)
at org.apache.logging.log4j.core.appender.OutputStreamManager.getManager(OutputStreamManager.java:100)
at org.apache.logging.log4j.core.net.TcpSocketManager.getSocketManager(TcpSocketManager.java:202)
at org.apache.logging.log4j.core.appender.SocketAppender.createSocketManager(SocketAppender.java:443)
at org.apache.logging.log4j.core.appender.SocketAppender$Builder.build(SocketAppender.java:221)
at org.apache.log4j.builders.appender.SyslogAppenderBuilder.createAppender(SyslogAppenderBuilder.java:150)
at org.apache.log4j.builders.appender.SyslogAppenderBuilder.parseAppender(SyslogAppenderBuilder.java:121)
at org.apache.log4j.builders.BuilderManager.parseAppender(BuilderManager.java:76)
at org.apache.log4j.config.PropertiesConfiguration.parseAppender(PropertiesConfiguration.java:427)
at org.apache.log4j.config.PropertiesConfiguration.parseLogger(PropertiesConfiguration.java:405)
at org.apache.log4j.config.PropertiesConfiguration.configureRoot(PropertiesConfiguration.java:325)
at org.apache.log4j.config.PropertiesConfiguration.doConfigure(PropertiesConfiguration.java:302)
at org.apache.log4j.config.PropertiesConfiguration.doConfigure(PropertiesConfiguration.java:92)
at org.apache.log4j.config.Log4j1Configuration.initialize(Log4j1Configuration.java:59)
at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:289)
at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:626)
at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:699)
at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:716)
at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:270)
at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:155)
at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:47)
at org.apache.logging.log4j.LogManager.getContext(LogManager.java:309)
at org.apache.log4j.Logger$PrivateManager.getContext(Logger.java:59)
at org.apache.log4j.Logger.getLogger(Logger.java:37)
at test.logger.Example.&amp;lt;clinit&amp;gt;(Example.java:12)
Caused by: java.net.ConnectException: Connection refused: connect
at java.net.DualStackPlainSocketImpl.connect0(Native Method)
at java.net.DualStackPlainSocketImpl.socketConnect(DualStackPlainSocketImpl.java:79)
at java.net.AbstractPlainSocketImpl.doConnect(AbstractPlainSocketImpl.java:350)
at java.net.AbstractPlainSocketImpl.connectToAddress(AbstractPlainSocketImpl.java:206)
at java.net.AbstractPlainSocketImpl.connect(AbstractPlainSocketImpl.java:188)
at java.net.PlainSocketImpl.connect(PlainSocketImpl.java:172)
at java.net.SocksSocketImpl.connect(SocksSocketImpl.java:392)
at java.net.Socket.connect(Socket.java:607)
at org.apache.logging.log4j.core.net.TcpSocketManager.createSocket(TcpSocketManager.java:409)
at org.apache.logging.log4j.core.net.TcpSocketManager$TcpSocketManagerFactory.createSocket(TcpSocketManager.java:504)
... 27 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Relevant code&lt;/b&gt;&#160; &#160;&lt;b&gt;SyslogAppenderBuilder.java :-&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;{{@Override
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Appender parseAppender(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; appenderPrefix, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; layoutPrefix,
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; filterPrefix, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Properties props, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; PropertiesConfiguration configuration) {
Filter filter = configuration.parseAppenderFilters(props, filterPrefix, name);
Layout layout = configuration.parseLayout(layoutPrefix, name, props);
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; level = getProperty(THRESHOLD_PARAM);
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; facility = getProperty(FACILITY_PARAM, &lt;span class=&quot;code-quote&quot;&gt;&quot;LOCAL0&quot;&lt;/span&gt;);
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; syslogHost = getProperty(SYSLOG_HOST_PARAM, &lt;span class=&quot;code-quote&quot;&gt;&quot;localhost:514&quot;&lt;/span&gt;);
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; createAppender(name, configuration, layout, facility, filter, syslogHost, level);
}
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Appender createAppender(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Log4j1Configuration configuration, Layout layout,
&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; facility, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Filter filter, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; syslogHost, &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; level) {
Holder&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; host = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Holder&amp;lt;&amp;gt;();
Holder&amp;lt;&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;&amp;gt; port = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Holder&amp;lt;&amp;gt;();
resolveSyslogHost(syslogHost, host, port);
org.apache.logging.log4j.core.Layout appenderLayout;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (layout &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; LayoutWrapper)
{ appenderLayout = ((LayoutWrapper) layout).getLayout(); }
&lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (layout != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
appenderLayout = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LayoutAdapter(layout);
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
appenderLayout = SyslogLayout.newBuilder()
.setFacility(Facility.toFacility(facility))
.setConfiguration(configuration)
.build();
}
org.apache.logging.log4j.core.Filter fileFilter = buildFilters(level, filter);
&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; AppenderWrapper(SyslogAppender.newBuilder()
.setName(name)
.setConfiguration(configuration)
.setLayout(appenderLayout)
.setFilter(fileFilter)
.withPort(port.get())
.withProtocol(Protocol.TCP)
.withHost(host.get())
.build());
}}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;tt&gt;log4j.properties file&#160;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;log4j.rootLogger=DEBUG,SYSLOG
log4j.appender.SYSLOG=org.apache.log4j.net.SyslogAppender
log4j.appender.SYSLOG.Threshold=DEBUG
log4j.appender.SYSLOG.syslogHost=10.133.68.197
log4j.appender.SYSLOG.port=514
log4j.appender.SYSLOG.protocol=UDP
log4j.appender.SYSLOG.header=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
log4j.appender.SYSLOG.Facility=LOCAL3
log4j.appender.SYSLOG.layout=org.apache.log4j.PatternLayout
log4j.appender.SYSLOG.layout.conversionPattern=Main[%pid] :%t: %c %-4p - %m\n
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;&lt;b&gt;JDK .1.8 :-&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;copy-jdk-configs-3.3-10.el7_5.noarch&lt;br/&gt;
java-1.8.0-openjdk-1.8.0.242.b08-0.el7_7.i686&lt;br/&gt;
java-1.8.0-openjdk-devel-1.8.0.242.b08-0.el7_7.i686&lt;br/&gt;
java-1.8.0-openjdk-headless-1.8.0.242.b08-0.el7_7.i686&lt;/p&gt;

&lt;p&gt;&lt;b&gt;JVM arguments :-&lt;/b&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;b&gt;-Dlog4j1.compatibility=true -jar&lt;/b&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Jar used :-&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;log4j-1.2-api-2.16.0.jar &#160;&lt;/p&gt;

&lt;p&gt;log4j-api-2.16.0.jar &#160;&lt;/p&gt;

&lt;p&gt;log4j-core-2.16.0.jar&lt;/p&gt;</environment>
        <key id="13417803">LOG4J2-3237</key>
            <summary>Log4j 1.2 bridge API hard codes the Syslog protocol to TCP</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggregory">Gary D. Gregory</assignee>
                                    <reporter username="TukeshK">Tukesh</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Dec 2021 19:32:47 +0000</created>
                <updated>Fri, 17 Dec 2021 20:11:05 +0000</updated>
                            <resolved>Fri, 17 Dec 2021 03:38:50 +0000</resolved>
                                    <version>2.16.0</version>
                                    <fixVersion>2.17.1</fixVersion>
                                    <component>API</component>
                    <component>Appenders</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17461126" author="garydgregory" created="Thu, 16 Dec 2021 23:46:21 +0000"  >&lt;p&gt;Your configuration file uses port 514 so you must be reporting that the protocol is hardcoded (which it is), not the port.&lt;/p&gt;</comment>
                            <comment id="17461180" author="jira-bot" created="Fri, 17 Dec 2021 03:37:44 +0000"  >&lt;p&gt;Commit 885ca8deb335065323323e78bbb6e52841d884bd in logging-log4j2&apos;s branch refs/heads/release-2.x from Gary Gregory&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=885ca8d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=885ca8d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3237&quot; title=&quot;Log4j 1.2 bridge API hard codes the Syslog protocol to TCP&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3237&quot;&gt;&lt;del&gt;LOG4J2-3237&lt;/del&gt;&lt;/a&gt; Log4j 1.2 bridge API hard codes protocol to TCP.&lt;/p&gt;</comment>
                            <comment id="17461181" author="garydgregory" created="Fri, 17 Dec 2021 03:38:50 +0000"  >&lt;p&gt;In git branch &lt;tt&gt;release-2.x&lt;/tt&gt;.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 47 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0xr54:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>