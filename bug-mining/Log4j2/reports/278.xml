<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:32:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-469] FailoverAppender does not retry back for Primary target</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-469</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;     In my product, I am using log4j2 for logging onto MySQL database. For that I am using JDBC as Primary and RollingRandomAccessFile as Secondary Appender.&lt;br/&gt;
     It works well and logs goes to Secondary appender when Primary appender fails (due to MySQL connection lost). But when MySQL connection comes back, it does not logs back to MySQL until I restart the JBoss Server.&lt;br/&gt;
    Is this a expected behavior? Or I am missing something in configuration file.&lt;/p&gt;

&lt;p&gt;Following is the my log4j2.xml file.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Configuration status=&lt;span class=&quot;code-quote&quot;&gt;&quot;error&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Appenders&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;JDBC name=&lt;span class=&quot;code-quote&quot;&gt;&quot;databaseAppender&quot;&lt;/span&gt; tableName=&lt;span class=&quot;code-quote&quot;&gt;&quot;system_log&quot;&lt;/span&gt; ignoreExceptions=&lt;span class=&quot;code-quote&quot;&gt;&quot;false&quot;&lt;/span&gt; bufferSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;10&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
			&amp;lt;DriverManager url=&lt;span class=&quot;code-quote&quot;&gt;&quot;jdbc:mysql://localhost:3306/xxxid_db&quot;&lt;/span&gt;
				username=&lt;span class=&quot;code-quote&quot;&gt;&quot;root&quot;&lt;/span&gt; password=&lt;span class=&quot;code-quote&quot;&gt;&quot;xxxxxxwing&quot;&lt;/span&gt; /&amp;gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Column name=&lt;span class=&quot;code-quote&quot;&gt;&quot;log_id&quot;&lt;/span&gt; pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;%x&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Column name=&lt;span class=&quot;code-quote&quot;&gt;&quot;log_dated&quot;&lt;/span&gt; isEventTimestamp=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Column name=&lt;span class=&quot;code-quote&quot;&gt;&quot;log_logger&quot;&lt;/span&gt; pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;%logger&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Column name=&lt;span class=&quot;code-quote&quot;&gt;&quot;log_level&quot;&lt;/span&gt; pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;%level&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Column name=&lt;span class=&quot;code-quote&quot;&gt;&quot;log_message&quot;&lt;/span&gt; pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;%message&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Column name=&lt;span class=&quot;code-quote&quot;&gt;&quot;log_throwable&quot;&lt;/span&gt; pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;%ex{full}&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/JDBC&amp;gt;&lt;/span&gt;
		&amp;lt;RollingRandomAccessFile name=&lt;span class=&quot;code-quote&quot;&gt;&quot;RollingRandomAccessFile&quot;&lt;/span&gt;
			fileName=&lt;span class=&quot;code-quote&quot;&gt;&quot;${sys:jboss.server.log.dir}/app.log&quot;&lt;/span&gt; filePattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;${sys:jboss.server.log.dir}/$${date:yyyy-MM}/app-%d{MM-dd-yyyy}-%i.log.gz&quot;&lt;/span&gt;&amp;gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;PatternLayout&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Pattern&amp;gt;&lt;/span&gt;%d %p %c{1.} [%t] %m%n&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Pattern&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/PatternLayout&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Policies&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;TimeBasedTriggeringPolicy /&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;SizeBasedTriggeringPolicy size=&lt;span class=&quot;code-quote&quot;&gt;&quot;250 MB&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Policies&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/RollingRandomAccessFile&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Failover name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Failover&quot;&lt;/span&gt; primary=&lt;span class=&quot;code-quote&quot;&gt;&quot;databaseAppender&quot;&lt;/span&gt; ignoreExceptions=&lt;span class=&quot;code-quote&quot;&gt;&quot;false&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Failovers&amp;gt;&lt;/span&gt;
				&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;RollingRandomAccessFile&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Failovers&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Failover&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Appenders&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Loggers&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Root level=&lt;span class=&quot;code-quote&quot;&gt;&quot;warn&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
			&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;Failover&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
		&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Root&amp;gt;&lt;/span&gt;
	&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Loggers&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Configuration&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thank You,&lt;br/&gt;
Indrajit&lt;/p&gt;</description>
                <environment>&lt;p&gt;JBoss 6.1.1, Spring-MVC, Log4j2 beta-9, Windows 7, Eclipse Kelper&lt;/p&gt;</environment>
        <key id="12685353">LOG4J2-469</key>
            <summary>FailoverAppender does not retry back for Primary target</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rgoers">Ralph Goers</assignee>
                                    <reporter username="indrajit3010">Indrajit Pingale</reporter>
                        <labels>
                            <label>features</label>
                    </labels>
                <created>Wed, 18 Dec 2013 10:14:42 +0000</created>
                <updated>Mon, 12 May 2014 06:23:47 +0000</updated>
                            <resolved>Mon, 12 May 2014 06:23:47 +0000</resolved>
                                    <version>2.0-beta9</version>
                                    <fixVersion>2.0-rc2</fixVersion>
                                    <component>Appenders</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13851890" author="ralph.goers@dslextreme.com" created="Wed, 18 Dec 2013 16:35:28 +0000"  >&lt;p&gt;In looking at the code I definitely see a problem, although not exactly what you are are reporting.  Once a failure occurs a boolean flag is set.  The failover appender will retry the primary appender periodically (the interval is controlled by the retryInterval attribute which defaults to 60 seconds). However, when the primary is again successful the flag is not reset.  Instead, every subsequent call is going to try the primary, discover it doesn&apos;t work (or that it does) and then go to the failover via exception handling instead of waiting for the next retry interval.&lt;/p&gt;

&lt;p&gt;The problem you are experiencing is more than likely that the JDBC Appender may not be attempting to reconnect after the connection database connection fails.&lt;/p&gt;</comment>
                            <comment id="13852640" author="indrajit3010" created="Thu, 19 Dec 2013 05:42:55 +0000"  >&lt;p&gt;Thanks Ralph for quick reply.&lt;br/&gt;
You are correct, JDBC Appender is not reconnecting after 60 seconds/ retrying to connect at every logger event. So do you have any suggestion over this (workaround/strategy)?&lt;/p&gt;

&lt;p&gt;Thanks again.&lt;/p&gt;</comment>
                            <comment id="13994848" author="ralph.goers@dslextreme.com" created="Mon, 12 May 2014 06:20:53 +0000"  >&lt;p&gt;The JDBC connection issue was resolved in &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-407&quot; title=&quot;JDBCAppender cannot recover from loss of database connectivity&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-407&quot;&gt;&lt;del&gt;LOG4J2-407&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13994852" author="ralph.goers@dslextreme.com" created="Mon, 12 May 2014 06:23:47 +0000"  >&lt;p&gt;Fix for FailoverAppender applied in revision 1593892. Please verify and close.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12669607">LOG4J2-407</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>364430</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 28 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qtdb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>364730</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>