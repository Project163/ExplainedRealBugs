<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:41:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2739] Combination of async logging and log4j-jul results in recursive call warnings</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2739</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;When disruptor based asynchronous logging is enabled and log4j-jul is configured as the JUL log manager, the &quot;Recursive call to getLogger&quot; line is triggered by jmx initialization.&lt;/p&gt;

&lt;p&gt;This can be worked around by disabling jmx using &lt;tt&gt;log4j2.disableJmx = true&lt;/tt&gt; in log4j2.component.properties.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2019-12-17 02:00:56,722 main INFO Registered Log4j as the java.util.logging.LogManager.
2019-12-17 02:00:57,502 main WARN Recursive call to getLogger for javax.management ignored.
2019-12-17 02:00:57,518 main WARN Recursive call to getLogger for javax.management.mbeanserver ignored.
2019-12-17 02:00:57,519 main WARN Recursive call to getLogger for javax.management.mlet ignored.
2019-12-17 02:00:57,519 main WARN Recursive call to getLogger for javax.management.monitor ignored.
2019-12-17 02:00:57,537 main WARN Recursive call to getLogger for javax.management.timer ignored.
2019-12-17 02:00:57,537 main WARN Recursive call to getLogger for javax.management.notification ignored.
2019-12-17 02:00:57,538 main WARN Recursive call to getLogger for javax.management.relation ignored.
2019-12-17 02:00:57,539 main WARN Recursive call to getLogger for javax.management.modelmbean ignored.
2019-12-17 02:00:57,539 main WARN Recursive call to getLogger for javax.management.misc ignored.
2019-12-17 02:00:57,539 main WARN Recursive call to getLogger for javax.management.snmp ignored.
2019-12-17 02:00:57,541 main WARN Recursive call to getLogger for javax.management.snmp.daemon ignored. 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Stack trace of the first instance:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;getLogger:92, LogManager (org.apache.logging.log4j.jul) [2]
demandLogger:551, LogManager (java.util.logging)
demandLogger:455, Logger (java.util.logging)
getLogger:502, Logger (java.util.logging)
&amp;lt;init&amp;gt;:55, ClassLogger (com.sun.jmx.remote.util)
&amp;lt;clinit&amp;gt;:365, NotificationBroadcasterSupport (javax.management)
&amp;lt;init&amp;gt;:72, MBeanServerDelegate (javax.management)
&amp;lt;init&amp;gt;:100, MBeanServerDelegateImpl (com.sun.jmx.mbeanserver)
newMBeanServerDelegate:1374, JmxMBeanServer (com.sun.jmx.mbeanserver)
newMBeanServerDelegate:66, MBeanServerBuilder (javax.management)
newMBeanServer:321, MBeanServerFactory (javax.management)
createMBeanServer:231, MBeanServerFactory (javax.management)
createMBeanServer:192, MBeanServerFactory (javax.management)
getPlatformMBeanServer:469, ManagementFactory (java.lang.management)
reregisterMBeansAfterReconfigure:140, Server (org.apache.logging.log4j.core.jmx)
setConfiguration:629, LoggerContext (org.apache.logging.log4j.core)
reconfigure:691, LoggerContext (org.apache.logging.log4j.core)
reconfigure:708, LoggerContext (org.apache.logging.log4j.core)
start:263, LoggerContext (org.apache.logging.log4j.core)
start:76, AsyncLoggerContext (org.apache.logging.log4j.core.async)
getContext:153, Log4jContextFactory (org.apache.logging.log4j.core.impl)
getContext:45, Log4jContextFactory (org.apache.logging.log4j.core.impl)
getContext:194, LogManager (org.apache.logging.log4j)
getContext:138, AbstractLoggerAdapter (org.apache.logging.log4j.spi)
getContext:34, AbstractLoggerAdapter (org.apache.logging.log4j.jul)
getLogger:48, AbstractLoggerAdapter (org.apache.logging.log4j.spi)
getLogger:97, LogManager (org.apache.logging.log4j.jul) [1]
demandLogger:551, LogManager (java.util.logging)
demandLogger:455, Logger (java.util.logging)
getLogger:502, Logger (java.util.logging)
&amp;lt;clinit&amp;gt;:27, FatalExceptionHandler (com.lmax.disruptor)
&amp;lt;init&amp;gt;:8, ExceptionHandlerWrapper (com.lmax.disruptor.dsl)
&amp;lt;init&amp;gt;:65, Disruptor (com.lmax.disruptor.dsl)
&amp;lt;init&amp;gt;:136, Disruptor (com.lmax.disruptor.dsl)
start:102, AsyncLoggerDisruptor (org.apache.logging.log4j.core.async)
maybeStartHelper:97, AsyncLoggerContext (org.apache.logging.log4j.core.async)
start:86, AsyncLoggerContext (org.apache.logging.log4j.core.async)
getContext:207, Log4jContextFactory (org.apache.logging.log4j.core.impl)
initialize:221, Configurator (org.apache.logging.log4j.core.config)
initialize:207, Configurator (org.apache.logging.log4j.core.config)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is a little bit funny because log4j-core asynchronous logging uses disruptor, which internally uses JUL, so startup order can be odd. We may want to consider returning a deferred initializing logger in the recursive case instead of a no-op logger.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13274995">LOG4J2-2739</key>
            <summary>Combination of async logging and log4j-jul results in recursive call warnings</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ckozak">Carter Kozak</assignee>
                                    <reporter username="ckozak">Carter Kozak</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Dec 2019 13:35:52 +0000</created>
                <updated>Wed, 1 Jan 2020 19:21:17 +0000</updated>
                            <resolved>Tue, 24 Dec 2019 16:11:25 +0000</resolved>
                                    <version>2.13.0</version>
                                    <fixVersion>2.13.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16998276" author="ckozak" created="Tue, 17 Dec 2019 14:41:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgoers&quot; class=&quot;user-hover&quot; rel=&quot;rgoers&quot;&gt;rgoers&lt;/a&gt; I can take a look at fixing this, but I&apos;d like to get your opinion on the deferred jul logger idea before I implement it. Instead of returning a no-op logger, I&apos;d like to return a delayed logger which routes all calls to a &apos;getDelegate()&apos; method, which can either initialize a real logger, or return a no-op logger and log a warning.&lt;/p&gt;</comment>
                            <comment id="16998305" author="ralph.goers@dslextreme.com" created="Tue, 17 Dec 2019 15:10:47 +0000"  >&lt;p&gt;This reminds me of the discussion last week in &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2738&quot; title=&quot;Message &amp;quot;ERROR Recursive call to appender&amp;quot; needs more diagnostic information.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2738&quot;&gt;LOG4J2-2738&lt;/a&gt;, although that is an actual logging call while this is a call to getLogger.&#160; I think we need to look at both of these situations and find better ways around them.&#160;&lt;/p&gt;

&lt;p&gt;In this current case we also need to make sure the recursive check is for the same Logger. I may have made the check for any Logger.&lt;/p&gt;</comment>
                            <comment id="17002911" author="jira-bot" created="Tue, 24 Dec 2019 16:09:50 +0000"  >&lt;p&gt;Commit e2b34f9c5a6304b133ebad9d5373f7a67f444a84 in logging-log4j2&apos;s branch refs/heads/release-2.x from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=e2b34f9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=e2b34f9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2739&quot; title=&quot;Combination of async logging and log4j-jul results in recursive call warnings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2739&quot;&gt;&lt;del&gt;LOG4J2-2739&lt;/del&gt;&lt;/a&gt;: Fix erroneous log4j-jul recursive logger detection&lt;/p&gt;

&lt;p&gt;The new implementation takes the requested logger name into account.&lt;br/&gt;
Invocations of jul LogManager.getLogger may become slightly less&lt;br/&gt;
performant due to string hashing and allocaiton overhead, but in&lt;br/&gt;
these scenarios it&apos;s best to reuse logger instances.&lt;/p&gt;</comment>
                            <comment id="17002912" author="jira-bot" created="Tue, 24 Dec 2019 16:10:20 +0000"  >&lt;p&gt;Commit c40db0f8e04d8ff301f0f57d77a3e0a3bdc078f0 in logging-log4j2&apos;s branch refs/heads/master from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=c40db0f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=c40db0f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2739&quot; title=&quot;Combination of async logging and log4j-jul results in recursive call warnings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2739&quot;&gt;&lt;del&gt;LOG4J2-2739&lt;/del&gt;&lt;/a&gt;: Fix erroneous log4j-jul recursive logger detection&lt;/p&gt;

&lt;p&gt;The new implementation takes the requested logger name into account.&lt;br/&gt;
Invocations of jul LogManager.getLogger may become slightly less&lt;br/&gt;
performant due to string hashing and allocaiton overhead, but in&lt;br/&gt;
these scenarios it&apos;s best to reuse logger instances.&lt;/p&gt;</comment>
                            <comment id="17002914" author="ckozak" created="Tue, 24 Dec 2019 16:11:17 +0000"  >&lt;p&gt;&amp;gt; In this current case we also need to make sure the recursive check is for the same Logger. I may have made the check for any Logger.&lt;/p&gt;

&lt;p&gt;That&apos;s correct, I&apos;ve added a fix to take the name of the logger into account.&lt;/p&gt;</comment>
                            <comment id="17002916" author="ckozak" created="Tue, 24 Dec 2019 16:12:26 +0000"  >&lt;p&gt;I&apos;m planning to test from a snapshot where I originally discovered this issue, but likely won&apos;t be able to get to that for a few days.&lt;/p&gt;</comment>
                            <comment id="17006468" author="ckozak" created="Wed, 1 Jan 2020 19:21:17 +0000"  >&lt;p&gt;I&apos;ve verified this in the application where I originally discovered the problem.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 46 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09ra8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>