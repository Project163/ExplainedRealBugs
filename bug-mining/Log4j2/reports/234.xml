<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:32:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-502] HTMLLayout: adding locationInfo parameter leads to error</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-502</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;If I configure log4j2.xml like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;SMTP name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Mailer&quot;&lt;/span&gt; suppressExceptions=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;
              subject=&lt;span class=&quot;code-quote&quot;&gt;&quot;${subject}&quot;&lt;/span&gt; to=&lt;span class=&quot;code-quote&quot;&gt;&quot;${receipients}&quot;&lt;/span&gt; from=&lt;span class=&quot;code-quote&quot;&gt;&quot;${from}&quot;&lt;/span&gt;
              smtpHost=&lt;span class=&quot;code-quote&quot;&gt;&quot;${smtpHost}&quot;&lt;/span&gt; smtpPort=&lt;span class=&quot;code-quote&quot;&gt;&quot;${smtpPort}&quot;&lt;/span&gt;
              smtpProtocol=&lt;span class=&quot;code-quote&quot;&gt;&quot;${smtpProtocol}&quot;&lt;/span&gt; smtpUsername=&lt;span class=&quot;code-quote&quot;&gt;&quot;${smtpUser}&quot;&lt;/span&gt;
              smtpPassword=&lt;span class=&quot;code-quote&quot;&gt;&quot;${smtpPassword}&quot;&lt;/span&gt; smtpDebug=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt; bufferSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;10&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;HTMLLayout locationInfo=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; fontSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;small&quot;&lt;/span&gt; /&amp;gt;
        &amp;lt;/SMTP&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m getting NPE error during logging error in my application:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2014-01-15 21:15:30,951 ERROR An exception occurred processing Appender Mailer org.apache.logging.log4j.LoggingException: Error occurred &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; sending email
	at org.apache.logging.log4j.core.net.SMTPManager.sendEvents(SMTPManager.java:159)
	at org.apache.logging.log4j.core.appender.SMTPAppender.append(SMTPAppender.java:172)
	at org.apache.logging.log4j.core.config.AppenderControl.callAppender(AppenderControl.java:99)
	at org.apache.logging.log4j.core.appender.AsyncAppender$AsyncThread.run(AsyncAppender.java:229)
Caused by: java.lang.NullPointerException
	at org.apache.logging.log4j.core.layout.HTMLLayout.toSerializable(HTMLLayout.java:158)
	at org.apache.logging.log4j.core.layout.HTMLLayout.toSerializable(HTMLLayout.java:46)
	at org.apache.logging.log4j.core.layout.AbstractStringLayout.toByteArray(AbstractStringLayout.java:45)
	at org.apache.logging.log4j.core.net.SMTPManager.writeBuffer(SMTPManager.java:188)
	at org.apache.logging.log4j.core.net.SMTPManager.writeContent(SMTPManager.java:174)
	at org.apache.logging.log4j.core.net.SMTPManager.formatContentToBytes(SMTPManager.java:166)
	at org.apache.logging.log4j.core.net.SMTPManager.sendEvents(SMTPManager.java:141)
	... 3 more 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12689047">LOG4J2-502</key>
            <summary>HTMLLayout: adding locationInfo parameter leads to error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="2">Won&apos;t Fix</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="itepikin">Ilya Tepikin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 15 Jan 2014 17:27:55 +0000</created>
                <updated>Thu, 16 Jan 2014 14:10:36 +0000</updated>
                            <resolved>Thu, 16 Jan 2014 13:05:00 +0000</resolved>
                                    <version>2.0-beta9</version>
                                                    <component>Layouts</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13872418" author="garydgregory" created="Wed, 15 Jan 2014 18:53:02 +0000"  >&lt;p&gt;Can you please test with the trunk version of the code? You will have to check out trunk and build it locally.&lt;/p&gt;

&lt;p&gt;I cannot duplicate this with the current unit tests: &lt;a href=&quot;https://svn.apache.org/repos/asf/logging/log4j/log4j2/trunk/log4j-core/src/test/java/org/apache/logging/log4j/core/layout/HTMLLayoutTest.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/repos/asf/logging/log4j/log4j2/trunk/log4j-core/src/test/java/org/apache/logging/log4j/core/layout/HTMLLayoutTest.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If you can still reproduce this with the trunk code, then we need a better test!&lt;/p&gt;

&lt;p&gt;Thank you,&lt;br/&gt;
Gary&lt;/p&gt;
</comment>
                            <comment id="13873200" author="itepikin" created="Thu, 16 Jan 2014 09:44:23 +0000"  >&lt;p&gt;I&apos;ve just tested the same issue with trunk version of the log4j2 and result is the same: NPE at line 158 in HTMLLayout.java.&lt;br/&gt;
There is code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (locationInfo) {
			&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; StackTraceElement element = event.getSource();
			sbuf.append(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;td&amp;gt;&quot;&lt;/span&gt;);
			sbuf.append(Transform.escapeHtmlTags(element.getFileName()));
			sbuf.append(&lt;span class=&quot;code-quote&quot;&gt;&apos;:&apos;&lt;/span&gt;);
			sbuf.append(element.getLineNumber());
			sbuf.append(&lt;span class=&quot;code-quote&quot;&gt;&quot;&amp;lt;/td&amp;gt;&quot;&lt;/span&gt;).append(Constants.LINE_SEP);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and the line 158 is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;sbuf.append(Transform.escapeHtmlTags(element.getFileName()));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13873241" author="remkop@yahoo.com" created="Thu, 16 Jan 2014 10:39:40 +0000"  >&lt;p&gt;Ilya, can you post your full log4j2.xml config? Also, are you using Async Loggers?&lt;/p&gt;</comment>
                            <comment id="13873273" author="itepikin" created="Thu, 16 Jan 2014 11:09:15 +0000"  >&lt;p&gt;Remko, sure.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;Configuration status=&lt;span class=&quot;code-quote&quot;&gt;&quot;WARN&quot;&lt;/span&gt; name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Server&quot;&lt;/span&gt; packages=&quot;&quot;&amp;gt;

    &amp;lt;!-- Mail server configuration --&amp;gt;
    &amp;lt;properties&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;from&quot;&lt;/span&gt;&amp;gt;mail@from.com&amp;lt;/property&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;receipients&quot;&lt;/span&gt;&amp;gt;mail@to.com&amp;lt;/property&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;smtpHost&quot;&lt;/span&gt;&amp;gt;email.host.com&amp;lt;/property&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;smtpPort&quot;&lt;/span&gt;&amp;gt;25&amp;lt;/property&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;smtpProtocol&quot;&lt;/span&gt;&amp;gt;smtp&amp;lt;/property&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;smtpUser&quot;&lt;/span&gt;&amp;gt;user&amp;lt;/property&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;smtpPassword&quot;&lt;/span&gt;&amp;gt;password&amp;lt;/property&amp;gt;
        &amp;lt;property name=&lt;span class=&quot;code-quote&quot;&gt;&quot;subject&quot;&lt;/span&gt;&amp;gt;Error log&amp;lt;/property&amp;gt;
    &amp;lt;/properties&amp;gt;

    &amp;lt;Appenders&amp;gt;
        &amp;lt;RollingRandomAccessFile name=&lt;span class=&quot;code-quote&quot;&gt;&quot;RollingRandomAccessFile&quot;&lt;/span&gt;
                                 fileName=&lt;span class=&quot;code-quote&quot;&gt;&quot;/log.log&quot;&lt;/span&gt;
                                 filePattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;/log-%d{yyyy-MM-dd-HH.mm.ss}.log.zip&quot;&lt;/span&gt;
                                 immediateFlush=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;
                                 append=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;PatternLayout&amp;gt;
                &amp;lt;Pattern&amp;gt;%-5p %d{yyyy-MM-dd HH:mm:ss,SSS} [%X{sid}] %-30c{1} %-30M %4L %m%n&amp;lt;/Pattern&amp;gt;
            &amp;lt;/PatternLayout&amp;gt;
            &amp;lt;Policies&amp;gt;
                &amp;lt;SizeBasedTriggeringPolicy size=&lt;span class=&quot;code-quote&quot;&gt;&quot;100 MB&quot;&lt;/span&gt;/&amp;gt;
            &amp;lt;/Policies&amp;gt;
            &amp;lt;DefaultRolloverStrategy max=&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt; compressionLevel=&lt;span class=&quot;code-quote&quot;&gt;&quot;5&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;/RollingRandomAccessFile&amp;gt;

        &amp;lt;SMTP name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Mailer&quot;&lt;/span&gt; suppressExceptions=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;
              subject=&lt;span class=&quot;code-quote&quot;&gt;&quot;${subject}&quot;&lt;/span&gt; to=&lt;span class=&quot;code-quote&quot;&gt;&quot;${receipients}&quot;&lt;/span&gt; from=&lt;span class=&quot;code-quote&quot;&gt;&quot;${from}&quot;&lt;/span&gt;
              smtpHost=&lt;span class=&quot;code-quote&quot;&gt;&quot;${smtpHost}&quot;&lt;/span&gt; smtpPort=&lt;span class=&quot;code-quote&quot;&gt;&quot;${smtpPort}&quot;&lt;/span&gt;
              smtpProtocol=&lt;span class=&quot;code-quote&quot;&gt;&quot;${smtpProtocol}&quot;&lt;/span&gt; smtpUsername=&lt;span class=&quot;code-quote&quot;&gt;&quot;${smtpUser}&quot;&lt;/span&gt;
              smtpPassword=&lt;span class=&quot;code-quote&quot;&gt;&quot;${smtpPassword}&quot;&lt;/span&gt; smtpDebug=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt; bufferSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;10&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;HTMLLayout locationInfo=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; fontSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;small&quot;&lt;/span&gt; /&amp;gt;
        &amp;lt;/SMTP&amp;gt;

        &amp;lt;Async name=&lt;span class=&quot;code-quote&quot;&gt;&quot;AsyncMailer&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;Mailer&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;/Async&amp;gt;
    &amp;lt;/Appenders&amp;gt;
    &amp;lt;Loggers&amp;gt;
        &amp;lt;Root level=&lt;span class=&quot;code-quote&quot;&gt;&quot;info&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;RollingRandomAccessFile&quot;&lt;/span&gt; level=&lt;span class=&quot;code-quote&quot;&gt;&quot;info&quot;&lt;/span&gt;/&amp;gt;
            &amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;AsyncMailer&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;/Root&amp;gt;
    &amp;lt;/Loggers&amp;gt;
&amp;lt;/Configuration&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13873338" author="remkop@yahoo.com" created="Thu, 16 Jan 2014 13:05:00 +0000"  >&lt;p&gt;For Async appender, you need to specify &lt;tt&gt;includeLocation=&quot;true&quot;&lt;/tt&gt; if you want to pass location information to the layout. Without this configuration, the location information is &lt;tt&gt;null&lt;/tt&gt;. I think the NullPointerException is expected behaviour.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://logging.apache.org/log4j/2.0/manual/appenders.html#AsyncAppender&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://logging.apache.org/log4j/2.0/manual/appenders.html#AsyncAppender&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please close if this solves the problem, re-open otherwise.&lt;/p&gt;</comment>
                            <comment id="13873419" author="itepikin" created="Thu, 16 Jan 2014 14:10:36 +0000"  >&lt;p&gt;Thanks for patience.&lt;br/&gt;
Not a bug. Closing issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>368014</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 44 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1rflb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>368321</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>