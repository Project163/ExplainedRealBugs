<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:39:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2102] MapMessage JSON encoding should escape keys and values</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2102</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Writing a map message as json does not currently escape quotes, resulting in invalid json&lt;/p&gt;</description>
                <environment></environment>
        <key id="13116479">LOG4J2-2102</key>
            <summary>MapMessage JSON encoding should escape keys and values</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikaelstaldal">Mikael St&#229;ldal</assignee>
                                    <reporter username="ckozak">Carter Kozak</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 Nov 2017 18:49:15 +0000</created>
                <updated>Thu, 30 Nov 2017 19:28:25 +0000</updated>
                            <resolved>Sat, 11 Nov 2017 21:49:06 +0000</resolved>
                                    <version>2.9.1</version>
                                    <fixVersion>2.10.0</fixVersion>
                                    <component>Layouts</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16240692" author="githubbot" created="Mon, 6 Nov 2017 18:50:58 +0000"  >&lt;p&gt;GitHub user cakofony opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/125&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/125&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2102&quot; title=&quot;MapMessage JSON encoding should escape keys and values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2102&quot;&gt;&lt;del&gt;LOG4J2-2102&lt;/del&gt;&lt;/a&gt;: MapMessage Json encoding escapes key and value strings&lt;/p&gt;



&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/cakofony/logging-log4j2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/cakofony/logging-log4j2&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2102&quot; title=&quot;MapMessage JSON encoding should escape keys and values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2102&quot;&gt;&lt;del&gt;LOG4J2-2102&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/125.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/125.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #125&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 163f3db588b4b46a9bbddbd28f64fb65b5e4e292&lt;br/&gt;
Author: Carter Kozak &amp;lt;c4kofony@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-11-06T18:49:36Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2102&quot; title=&quot;MapMessage JSON encoding should escape keys and values&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2102&quot;&gt;&lt;del&gt;LOG4J2-2102&lt;/del&gt;&lt;/a&gt;: MapMessage Json encoding escapes key and value strings&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16240695" author="githubbot" created="Mon, 6 Nov 2017 18:51:37 +0000"  >&lt;p&gt;Github user cakofony commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/125#discussion_r149168416&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/125#discussion_r149168416&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: log4j-core/src/main/java/org/apache/logging/log4j/core/pattern/EncodingPatternConverter.java &amp;#8212;&lt;br/&gt;
    @@ -86,100 +87,4 @@ public void format(final LogEvent event, final StringBuilder toAppendTo) {&lt;br/&gt;
             }&lt;br/&gt;
             escapeFormat.escape(toAppendTo, start);&lt;br/&gt;
         }&lt;br/&gt;
    -&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private enum EscapeFormat {&lt;/li&gt;
	&lt;li&gt;HTML {&lt;/li&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;void escape(final StringBuilder toAppendTo, final int start) {&lt;/li&gt;
	&lt;li&gt;for (int i = toAppendTo.length() - 1; i &amp;gt;= start; i--) { // backwards: length may change&lt;/li&gt;
	&lt;li&gt;final char c = toAppendTo.charAt&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;/li&gt;
	&lt;li&gt;switch (c) 
{
    -                        case &apos;\r&apos;:
    -                            toAppendTo.setCharAt(i, &apos;\\&apos;);
    -                            toAppendTo.insert(i + 1, &apos;r&apos;);
    -                            break;
    -                        case &apos;\n&apos;:
    -                            toAppendTo.setCharAt(i, &apos;\\&apos;);
    -                            toAppendTo.insert(i + 1, &apos;n&apos;);
    -                            break;
    -                        case &apos;&amp;amp;&apos;:
    -                            toAppendTo.setCharAt(i, &apos;&amp;amp;&apos;);
    -                            toAppendTo.insert(i + 1, &quot;amp;&quot;);
    -                            break;
    -                        case &apos;&amp;lt;&apos;:
    -                            toAppendTo.setCharAt(i, &apos;&amp;amp;&apos;);
    -                            toAppendTo.insert(i + 1, &quot;lt;&quot;);
    -                            break;
    -                        case &apos;&amp;gt;&apos;:
    -                            toAppendTo.setCharAt(i, &apos;&amp;amp;&apos;);
    -                            toAppendTo.insert(i + 1, &quot;gt;&quot;);
    -                            break;
    -                        case &apos;&quot;&apos;:
    -                            toAppendTo.setCharAt(i, &apos;&amp;amp;&apos;);
    -                            toAppendTo.insert(i + 1, &quot;quot;&quot;);
    -                            break;
    -                        case &apos;\&apos;&apos;:
    -                            toAppendTo.setCharAt(i, &apos;&amp;amp;&apos;);
    -                            toAppendTo.insert(i + 1, &quot;apos;&quot;);
    -                            break;
    -                        case &apos;/&apos;:
    -                            toAppendTo.setCharAt(i, &apos;&amp;amp;&apos;);
    -                            toAppendTo.insert(i + 1, &quot;#x2F;&quot;);
    -                            break;
    -                    }&lt;/li&gt;
	&lt;li&gt;}&lt;/li&gt;
	&lt;li&gt;}&lt;/li&gt;
	&lt;li&gt;},&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;/**&lt;/li&gt;
	&lt;li&gt;* JSON string escaping as defined in RFC 4627.&lt;/li&gt;
	&lt;li&gt;*&lt;/li&gt;
	&lt;li&gt;* @see &amp;lt;a href=&quot;https://www.ietf.org/rfc/rfc4627.txt&quot;&amp;gt;RFC 4627&amp;lt;/a&amp;gt;&lt;/li&gt;
	&lt;li&gt;*/&lt;/li&gt;
	&lt;li&gt;JSON {&lt;/li&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;void escape(final StringBuilder toAppendTo, final int start) {&lt;/li&gt;
	&lt;li&gt;for (int i = toAppendTo.length() - 1; i &amp;gt;= start; i--) { // backwards: length may change&lt;/li&gt;
	&lt;li&gt;final char c = toAppendTo.charAt&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;/li&gt;
	&lt;li&gt;if (Character.isISOControl(c)) 
{
    -                        // all iso control characters are in U+00xx
    -                        toAppendTo.setCharAt(i, &apos;\\&apos;);
    -                        toAppendTo.insert(i + 1, &quot;u0000&quot;);
    -                        toAppendTo.setCharAt(i + 4, Chars.getUpperCaseHex((c &amp;amp; 0xF0) &amp;gt;&amp;gt; 4));
    -                        toAppendTo.setCharAt(i + 5, Chars.getUpperCaseHex(c &amp;amp; 0xF));
    -                    }
&lt;p&gt; else if (c == &apos;&quot;&apos; || c == &apos;&lt;br class=&quot;atl-forced-newline&quot; /&gt;&apos;) &lt;/p&gt;
{
    -                        // only &quot; and \ need to be escaped; other escapes are optional
    -                        toAppendTo.insert(i, &apos;\\&apos;);
    -                    }&lt;/li&gt;
	&lt;li&gt;}&lt;/li&gt;
	&lt;li&gt;}&lt;/li&gt;
	&lt;li&gt;},&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;CRLF {&lt;/li&gt;
	&lt;li&gt;@Override&lt;/li&gt;
	&lt;li&gt;void escape(final StringBuilder toAppendTo, final int start) {&lt;/li&gt;
	&lt;li&gt;for (int i = toAppendTo.length() - 1; i &amp;gt;= start; i--) { // backwards: length may change&lt;/li&gt;
	&lt;li&gt;final char c = toAppendTo.charAt&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/information.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;;&lt;/li&gt;
	&lt;li&gt;switch (c) 
{
    -                        case &apos;\r&apos;:
    -                            toAppendTo.setCharAt(i, &apos;\\&apos;);
    -                            toAppendTo.insert(i + 1, &apos;r&apos;);
    -                            break;
    -                        case &apos;\n&apos;:
    -                            toAppendTo.setCharAt(i, &apos;\\&apos;);
    -                            toAppendTo.insert(i + 1, &apos;n&apos;);
    -                            break;
    -                    }&lt;/li&gt;
	&lt;li&gt;}&lt;/li&gt;
	&lt;li&gt;}&lt;/li&gt;
	&lt;li&gt;};&lt;br/&gt;
    -&lt;/li&gt;
	&lt;li&gt;/**&lt;/li&gt;
	&lt;li&gt;* Escapes text using a standardized format from a given starting point to the end of the string.&lt;/li&gt;
	&lt;li&gt;*&lt;/li&gt;
	&lt;li&gt;* @param toAppendTo string buffer to escape&lt;/li&gt;
	&lt;li&gt;* @param start      where to start escaping from&lt;/li&gt;
	&lt;li&gt;*/&lt;/li&gt;
	&lt;li&gt;abstract void escape(final StringBuilder toAppendTo, final int start);&lt;/li&gt;
	&lt;li&gt;}
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;End diff &amp;#8211;&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Alternatively I can pull the json implementation into a shared utility class elsewhere.&lt;/p&gt;</comment>
                            <comment id="16240835" author="githubbot" created="Mon, 6 Nov 2017 20:29:57 +0000"  >&lt;p&gt;Github user mikaelstaldal commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/125&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/125&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    We should do the same for the XML format, you can use the new XML format in `EncodingPatternConverter` for that (pull from master). Good to place that in a shared utility class.&lt;/p&gt;</comment>
                            <comment id="16241236" author="githubbot" created="Tue, 7 Nov 2017 00:26:16 +0000"  >&lt;p&gt;Github user cakofony commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/125&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/125&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Updated, thanks!&lt;/p&gt;</comment>
                            <comment id="16245996" author="githubbot" created="Thu, 9 Nov 2017 16:43:21 +0000"  >&lt;p&gt;Github user cakofony commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/125&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/125&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Feel free to close this in favor of #129 if you prefer to iterate there.&lt;/p&gt;</comment>
                            <comment id="16248681" author="githubbot" created="Sat, 11 Nov 2017 21:48:23 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/125&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/125&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16248689" author="mikaelstaldal" created="Sat, 11 Nov 2017 21:49:06 +0000"  >&lt;p&gt;In Git master, please verify and close.&lt;/p&gt;</comment>
                            <comment id="16273238" author="mikaelstaldal" created="Thu, 30 Nov 2017 19:28:25 +0000"  >&lt;p&gt;Released.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3mghr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>