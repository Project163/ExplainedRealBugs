<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:42:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-3404] Leak of DefaultConfiguration instances</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-3404</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;If an appender does not specify a layout a default &lt;tt&gt;PatternLayout&lt;/tt&gt; is created&#160;&lt;b&gt;together&lt;/b&gt; with a &lt;tt&gt;DefaultConfiguration&lt;/tt&gt;, which is never stopped nor attached to a &lt;tt&gt;LoggerContext&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;For example, if we using a simple file appender:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160; appenders:
&#160; &#160; File:
&#160; &#160; &#160; name: FILE
&#160; &#160; &#160; fileName: logs/myfile.log &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and running:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
LogManager.getLogger(&lt;span class=&quot;code-quote&quot;&gt;&quot;test&quot;&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;will result in the following (redacted and commented) status logger output:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
# DefaultConfiguration from LoggerContext constructor
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;-1
DEBUG StatusLogger Starting LoggerContext[name=2437c6dc, org.apache.logging.log4j.core.LoggerContext@45752059]...
DEBUG StatusLogger Reconfiguration started &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; context[name=2437c6dc] at URI &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; (org.apache.logging.log4j.core.LoggerContext@45752059) with optional &lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;
# Spurious DefaultConfiguration used to create &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; PatternLayout
# This manager will **never** stop
DEBUG StatusLogger Starting OutputStreamManager SYSTEM_OUT.&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;-2
# My appender
DEBUG StatusLogger Starting FileManager logs/myfile.log
DEBUG StatusLogger Starting configuration YamlConfiguration[location=D:\Examples\log4j\target\classes\log4j2.yml]
DEBUG StatusLogger Started configuration YamlConfiguration[location=D:\Examples\log4j\target\classes\log4j2.yml] OK.
# The first DefaultConfiguration stops
#
TRACE StatusLogger Stopping org.apache.logging.log4j.core.config.DefaultConfiguration@145f66e3...
DEBUG StatusLogger Shutting down OutputStreamManager SYSTEM_OUT.&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;-1
DEBUG StatusLogger OutputStream closed
DEBUG StatusLogger Shut down OutputStreamManager SYSTEM_OUT.&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;-1, all resources released: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
DEBUG StatusLogger Appender DefaultConsole-1 stopped with status &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
TRACE StatusLogger DefaultConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger DefaultConfiguration cleaning Appenders from 1 LoggerConfigs.
DEBUG StatusLogger Stopped org.apache.logging.log4j.core.config.DefaultConfiguration@145f66e3 OK
# At JVM shutdown
TRACE StatusLogger Stopping YamlConfiguration[location=D:\Examples\log4j\target\classes\log4j2.yml]...
TRACE StatusLogger YamlConfiguration notified 2 ReliabilityStrategies that config will be stopped.
TRACE StatusLogger YamlConfiguration stopping 1 LoggerConfigs.
TRACE StatusLogger YamlConfiguration stopping root LoggerConfig.
TRACE StatusLogger YamlConfiguration notifying ReliabilityStrategies that appenders will be stopped.
TRACE StatusLogger YamlConfiguration stopping remaining Appenders.
DEBUG StatusLogger Appender CONSOLE stopped with status &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
TRACE StatusLogger YamlConfiguration stopped 1 remaining Appenders.
TRACE StatusLogger YamlConfiguration cleaning Appenders from 2 LoggerConfigs.
DEBUG StatusLogger Stopped YamlConfiguration[location=D:\Examples\log4j\target\classes\log4j2.yml] OK&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I can provide a PR to prevent the leaking of &lt;tt&gt;DefaultConfiguration&lt;/tt&gt; s.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13428796">LOG4J2-3404</key>
            <summary>Leak of DefaultConfiguration instances</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ckozak">Carter Kozak</assignee>
                                    <reporter username="pkarwasz">Piotr Karwasz</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Feb 2022 12:01:56 +0000</created>
                <updated>Fri, 11 Mar 2022 16:18:06 +0000</updated>
                            <resolved>Fri, 18 Feb 2022 17:19:43 +0000</resolved>
                                    <version>2.17.1</version>
                                                    <component>Configuration</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17493314" author="ralph.goers@dslextreme.com" created="Wed, 16 Feb 2022 15:55:21 +0000"  >&lt;p&gt;Yes, please provide a PR that demonstrates the problem and, if possible, the fix.&lt;/p&gt;</comment>
                            <comment id="17494741" author="jira-bot" created="Fri, 18 Feb 2022 17:11:30 +0000"  >&lt;p&gt;Commit 9ffa643d69cdca4764bc2c4c0fe529379d17db2b in logging-log4j2&apos;s branch refs/heads/release-2.x from ppkarwasz&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=9ffa643&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=9ffa643&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3404&quot; title=&quot;Leak of DefaultConfiguration instances&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3404&quot;&gt;&lt;del&gt;LOG4J2-3404&lt;/del&gt;&lt;/a&gt; Create default layouts using the available Configuration (#756)&lt;/p&gt;

&lt;p&gt;This PR provides a `Configuration` argument whenever possible.&lt;br/&gt;
`PatternLayout` no longer creates (and leaks) DefaultConfiguration instances&lt;/p&gt;</comment>
                            <comment id="17494743" author="jira-bot" created="Fri, 18 Feb 2022 17:18:46 +0000"  >&lt;p&gt;Commit 77f04501f73b5255e9993b1da8c57db54372a4aa in logging-log4j2&apos;s branch refs/heads/release-2.x from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=77f0450&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=77f0450&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3404&quot; title=&quot;Leak of DefaultConfiguration instances&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3404&quot;&gt;&lt;del&gt;LOG4J2-3404&lt;/del&gt;&lt;/a&gt; changelog&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 38 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0zmq0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>