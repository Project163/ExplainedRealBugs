<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:42:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-3440] Log4j 1.2 bridge getAllAppenders() returns null enumeration</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-3440</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Old application using Log4j 1.2.x relies on Logger.getAllAppenders() to decide if Log4j it&apos;s already configured (returned Enumeration has at least 1 appender) or not (empty returned Enumeration).&lt;/p&gt;

&lt;p&gt;Some recent code audits mandate to remove log4j v1 component(s) and to upgrade to latest 2.17.2 release, so we&apos;re using Log4j 1.2 Bridge to comply and not to change application code.&lt;/p&gt;

&lt;p&gt;However, we&apos;re facing the issue describe here &lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; for&#160;Logger.getRootLogger().getAllAppenders() although with latest Log4j release 2.17.2 the issue seems to be that data structure aai is never updated with the proper configured appenders, given that now most of the work happens in the Log4j v2 Core implementation, thus using LoggerContext&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://stackoverflow.com/questions/32864929/log4j-getallappenders-returns-null-enumeration&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;java - Log4j getAllAppenders() returns null enumeration - Stack Overflow&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13434984">LOG4J2-3440</key>
            <summary>Log4j 1.2 bridge getAllAppenders() returns null enumeration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pkarwasz">Piotr Karwasz</assignee>
                                    <reporter username="pablojr">Pablo Rogina</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Mar 2022 20:25:36 +0000</created>
                <updated>Sat, 28 Sep 2024 17:13:26 +0000</updated>
                            <resolved>Sun, 10 Apr 2022 04:24:14 +0000</resolved>
                                    <version>2.17.2</version>
                                    <fixVersion>2.18.0</fixVersion>
                                    <component>Log4j 1.2 bridge</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="17510365" author="pkarwasz" created="Tue, 22 Mar 2022 09:32:59 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pablojr&quot; class=&quot;user-hover&quot; rel=&quot;pablojr&quot;&gt;pablojr&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Your diagnosis is correct: the &lt;tt&gt;getAllAppenders&lt;/tt&gt;, &lt;tt&gt;addAppender&lt;/tt&gt; and &lt;tt&gt;callAppenders&lt;/tt&gt; methods are not connected to the Log4j 2.x backend. The &lt;tt&gt;getAppender(String)&lt;/tt&gt; method can retrieve the appender from Log4j2&apos;s configuration, but it will not necessarily be of the expected type.&lt;/p&gt;

&lt;p&gt;Can you expand your use case for the &lt;tt&gt;getAllAppenders&lt;/tt&gt; method? What do you do if there are no appenders? Remark that in Log4j2 the default configuration already has a console appender, so trivially retrieving the Log4j2 appenders connected to the root logger would not work with your logic.&lt;/p&gt;</comment>
                            <comment id="17510375" author="garydgregory" created="Tue, 22 Mar 2022 09:50:52 +0000"  >&lt;p&gt;Hi all,&lt;/p&gt;

&lt;p&gt;The bridge code has greatly improved in 2.17.2 but it is not perfect, so I would like us to keep making it better. I think we are already way above the 80/20 rule FWIW. Any help is appreciated and your reporting this issue does help: -)&lt;/p&gt;</comment>
                            <comment id="17510532" author="JIRAUSER286891" created="Tue, 22 Mar 2022 14:42:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pkarwasz&quot; class=&quot;user-hover&quot; rel=&quot;pkarwasz&quot;&gt;pkarwasz&lt;/a&gt; if there are no appenders, the application considers Log4j as no configured yet and do the configuration via PropertyConfigurator.configure(someProperties).&lt;/p&gt;

&lt;p&gt;I guess I forgot to mention that this &quot;application&quot; is indeed a library, so it can be used directly by some other program and thus doing its own Log4j configuration makes sense, but it could be part of other solution involving other libraries that in turn use it, so at that point doing configuration again (calling PropertyConfigurator.configure(someProperties) once more) messes up with existing Log4j configuration (i.e. sets log level ERROR overriding the actual log level setting from topmost application).&lt;/p&gt;</comment>
                            <comment id="17510684" author="ralph.goers@dslextreme.com" created="Tue, 22 Mar 2022 15:23:07 +0000"  >&lt;p&gt;Just my 2 cents. Generally, it never makes sense for a library to configure logging. It would be expected that the user of the library would always provide that.&lt;/p&gt;</comment>
                            <comment id="17510697" author="garydgregory" created="Tue, 22 Mar 2022 15:37:01 +0000"  >&lt;p&gt;For good or bad, I see this type of behavior all the time. If there is no config found, then an app creates one on the fly. If some condition is met, could be some admin&#160; request or other signal, then reconfigue on the fly to some other settings.&#160;&lt;/p&gt;</comment>
                            <comment id="17510724" author="JIRAUSER286891" created="Tue, 22 Mar 2022 16:07:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgoers&quot; class=&quot;user-hover&quot; rel=&quot;rgoers&quot;&gt;rgoers&lt;/a&gt; yes, you&apos;re right; your suggestion is good in an ideal world or when you&apos;re starting from scratch.&lt;/p&gt;

&lt;p&gt;Unfortunately here the application has almost 20 years, and there&apos;s still code in it providing its &quot;own logging&quot; framework to &quot;avoid dependencies&quot; with actual logging frameworks (i.e. log4j, logback, etc.) for users that like to use it at the early years (when logging frameworks were not that much mature and widespread).&lt;/p&gt;</comment>
                            <comment id="17510770" author="pkarwasz" created="Tue, 22 Mar 2022 17:17:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pablojr&quot; class=&quot;user-hover&quot; rel=&quot;pablojr&quot;&gt;pablojr&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;To provide a backup configuration, there is an easier way: write your own &lt;tt&gt;ConfigurationFactory&lt;/tt&gt;. You just need a class:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.log4j.config.PropertiesConfiguration;

@Plugin(name = &lt;span class=&quot;code-quote&quot;&gt;&quot;MyConfigurationFactory&quot;&lt;/span&gt;, category = ConfigurationFactory.CATEGORY)
@Order(-10)
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MyConfigurationFactory &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; ConfigurationFactory {

    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] TYPES = { &lt;span class=&quot;code-quote&quot;&gt;&quot;.my&quot;&lt;/span&gt; };

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] getSupportedTypes() {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; TYPES;
    }

    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; Configuration getConfiguration(LoggerContext loggerContext, ConfigurationSource source) {
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Properties props = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Properties();
        &lt;span class=&quot;code-comment&quot;&gt;// Load the properties
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PropertiesConfiguration(loggerContext, props);
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and a dummy &quot;log4j2.my&quot; file in your library&apos;s classpath to trigger the configuration. Compile the bunch using the annotation processor in &lt;tt&gt;log4j-core&lt;/tt&gt;. This way Log4j2 will take care of using your configuration if no configuration with higher order value is available.&lt;/p&gt;</comment>
                            <comment id="17510772" author="pkarwasz" created="Tue, 22 Mar 2022 17:20:58 +0000"  >&lt;p&gt;Anyway, we can consider implementing the &lt;tt&gt;getAllAppenders&lt;/tt&gt; method in the bridge.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt;, any ideas on what it should do? Returning all the appenders used by the associated Log4j2 logger seems excessive. Maybe it should just return the native Log4j 1.x appenders?&lt;/p&gt;</comment>
                            <comment id="17512040" author="garydgregory" created="Thu, 24 Mar 2022 19:15:00 +0000"  >&lt;p&gt;It seems that we should do something that is a close to Log4j 1.2 as possible. Internally, the whole &quot;aai&quot; implementation feels wrong since this is now a bridge rather than an implementation. We can do something simple for now and 2.17.3 just so that we do not return an empty enumeration, so just the 1.2 specific appenders I would say.&lt;/p&gt;</comment>
                            <comment id="17512151" author="ralph.goers@dslextreme.com" created="Fri, 25 Mar 2022 01:32:57 +0000"  >&lt;p&gt;I&apos;d have a concern here as whatever we do it seems it is going to incomplete in some way. We could just return the 1.2 appenders as Gary suggests, or we could return the Log4j 2 Appenders enclosed in AppenderWrappers. But if the user is then inspecting the wrappers it is likely they will fail.&lt;/p&gt;</comment>
                            <comment id="17512467" author="JIRAUSER286891" created="Fri, 25 Mar 2022 16:29:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pkarwasz&quot; class=&quot;user-hover&quot; rel=&quot;pkarwasz&quot;&gt;pkarwasz&lt;/a&gt; &amp;gt; Returning all the appenders used by the associated Log4j2 logger seems excessive&lt;/p&gt;

&lt;p&gt;Should those be the only appenders within the whole framework?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ggregory&quot; class=&quot;user-hover&quot; rel=&quot;ggregory&quot;&gt;ggregory&lt;/a&gt; &amp;gt;the whole &quot;aai&quot; implementation feels wrong since this is now a bridge rather than an implementation&lt;/p&gt;

&lt;p&gt;Yes, I agree. The bridge should be like an interpreter between what&apos;s already coded for 1.2.x API and the underlying 2.x API + implementation&lt;/p&gt;

&lt;p&gt;So not to influence your final work, this is what I&apos;ve done just as interim solution for my issue (given the time constraints and deadlines to meet), so to get the appenders of the root logger:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;pseudo-code&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;if LOG4J_CORE_PRESENT }}{{{&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;{{ &#160; &#160; root = org.log4j.logging.LogManager.getRootLogger()}}&lt;/p&gt;

&lt;p&gt;{{ &#160; &#160; ctx = root.getContext() &#160; &#160; }}&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160; &#160; config = ctx.getConfiguration()&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;{{ &#160; &#160; rootConfig = config.getRootLogger()}}&lt;/p&gt;

&lt;p&gt;{{ &#160; &#160; appenders = rootConfig.getAppenders()}}&lt;/p&gt;

&lt;p&gt;{{ }}}&lt;/p&gt;

&lt;p&gt;I&apos;ve tested with something like rootLogger=INFO (not specifying any appender) and in such case rootConfig.getAppenders() returns an empty array (which is expected for me).&lt;/p&gt;</comment>
                            <comment id="17512502" author="ralph.goers@dslextreme.com" created="Fri, 25 Mar 2022 17:39:23 +0000"  >&lt;p&gt;I&apos;m not really sure how your test succeeds. When you reference LogManager it has a static block that will initialize Log4j. By default, it will configure the DefaultConfiguration, which has a root LoggerConfig at ERROR and a Console Appender. See &lt;a href=&quot;https://github.com/apache/logging-log4j2/blob/release-2.x/log4j-core/src/main/java/org/apache/logging/log4j/core/config/AbstractConfiguration.java#L723&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;setDefault() in AbstractConfiguration&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Log4j-spring-boot tests to see if Log4j has initialized by calling LogManagerStatus.isInitialized(). Unfortunately, that class is considered internal. The isInitialized doesn&apos;t need to be - we only want to protect the setter.I&apos;ll have to figure out how to split things so that can happen.&lt;/p&gt;</comment>
                            <comment id="17512505" author="JIRAUSER286891" created="Fri, 25 Mar 2022 17:45:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgoers&quot; class=&quot;user-hover&quot; rel=&quot;rgoers&quot;&gt;rgoers&lt;/a&gt; thank you for the heads up. I should have clarified that the code snippet is run at a level/library where the topmost application already configured Log4j&lt;/p&gt;</comment>
                            <comment id="17512697" author="ralph.goers@dslextreme.com" created="Sat, 26 Mar 2022 08:11:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pablojr&quot; class=&quot;user-hover&quot; rel=&quot;pablojr&quot;&gt;pablojr&lt;/a&gt; I don&apos;t see how that helps. The call to LogManager.getRootLogger() will always ensure Log4j is configured, even if it previously was not.&#160; In your code snippet the appenders variable should never be null or empty UNLESS you specifically configured Log4j without the root logger referencing an Appender. Without having looked at the code I would suspect even then Log4j would add a ConsoleAppender.&lt;/p&gt;</comment>
                            <comment id="17520025" author="jira-bot" created="Sat, 9 Apr 2022 21:15:46 +0000"  >&lt;p&gt;Commit dfc215713abbd211e60a81074f177f49bbd9e406 in logging-log4j2&apos;s branch refs/heads/release-2.x from Piotr P. Karwasz&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=dfc215713a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=dfc215713a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3440&quot; title=&quot;Log4j 1.2 bridge getAllAppenders() returns null enumeration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3440&quot;&gt;&lt;del&gt;LOG4J2-3440&lt;/del&gt;&lt;/a&gt; Synchronize Log4j 1.x and Log4j 2.x appenders&lt;/p&gt;

&lt;p&gt;Forwards the `addAppender`, `callAppenders`, `getAllAppenders` and&lt;br/&gt;
`getAppender` calls the the corresponding Log4j 2.x objects if Log4j 2.x&lt;br/&gt;
Core is present.&lt;/p&gt;

&lt;p&gt;The `getAllAppenders` method only returns those appenders, which are&lt;br/&gt;
attached to homonymous logger config and are native Log4j 1.x appenders.&lt;/p&gt;</comment>
                            <comment id="17520064" author="pkarwasz" created="Sun, 10 Apr 2022 04:24:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pablojr&quot; class=&quot;user-hover&quot; rel=&quot;pablojr&quot;&gt;pablojr&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;In the last snapshot of version &lt;tt&gt;2.17.3-SNAPSHOT&lt;/tt&gt; I added support for the &lt;tt&gt;Category#getAllAppenders&lt;/tt&gt; and &lt;tt&gt;Category#addAppender&lt;/tt&gt;. The former returns only those appenders that are native Log4j 1.x appenders.&lt;/p&gt;

&lt;p&gt;Can you check if this solves your issue and close it?&lt;/p&gt;</comment>
                            <comment id="17520622" author="JIRAUSER286891" created="Mon, 11 Apr 2022 14:40:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pkarwasz&quot; class=&quot;user-hover&quot; rel=&quot;pkarwasz&quot;&gt;pkarwasz&lt;/a&gt; thank you for the quick update.&lt;/p&gt;

&lt;p&gt;&amp;gt; Can you check if this solves your issue and close it?&lt;/p&gt;

&lt;p&gt;I&apos;ll try as soon as I can get back to some test environment using Log4j v1 appenders.&lt;/p&gt;

&lt;p&gt;Please expect some days for a reply about this. Regards&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17527234" author="jira-bot" created="Sun, 24 Apr 2022 18:00:24 +0000"  >&lt;p&gt;Commit e0d25b863a1732ce4a56775b66438abce6838ecd in logging-log4j2&apos;s branch refs/heads/master from Piotr P. Karwasz&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=e0d25b863a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=e0d25b863a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3440&quot; title=&quot;Log4j 1.2 bridge getAllAppenders() returns null enumeration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3440&quot;&gt;&lt;del&gt;LOG4J2-3440&lt;/del&gt;&lt;/a&gt; Synchronize Log4j 1.x and Log4j 2.x appenders&lt;/p&gt;

&lt;p&gt;Forwards the `addAppender`, `callAppenders`, `getAllAppenders` and&lt;br/&gt;
`getAppender` calls the the corresponding Log4j 2.x objects if Log4j 2.x&lt;br/&gt;
Core is present.&lt;/p&gt;

&lt;p&gt;The `getAllAppenders` method only returns those appenders, which are&lt;br/&gt;
attached to homonymous logger config and are native Log4j 1.x appenders.&lt;/p&gt;

&lt;p&gt;Conflicts:&lt;br/&gt;
	log4j-1.2-api/src/test/java/org/apache/log4j/CategoryTest.java&lt;/p&gt;</comment>
                            <comment id="17883814" author="chaostya" created="Mon, 23 Sep 2024 10:37:34 +0000"  >&lt;p&gt;Log4j-core + log4j-1.2-api,&#160; both @2.23.1&lt;/p&gt;

&lt;p&gt;Configuration performed via:&lt;br/&gt;
DOMConfigurator.configure(configuration);&lt;br/&gt;
log4j.xml is attached.&lt;br/&gt;
this code:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Logger.getRootLogger().getAllAppenders().hasMoreElements(); &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Still returns false.&lt;/p&gt;</comment>
                            <comment id="17884054" author="pkarwasz" created="Mon, 23 Sep 2024 21:13:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chaostya&quot; class=&quot;user-hover&quot; rel=&quot;chaostya&quot;&gt;chaostya&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;That is by design.&lt;/p&gt;

&lt;p&gt;The Log4j 1-to-Log4j 2 Bridge will never instantiate &lt;tt&gt;org.apache.log4j.ConsoleAppender&lt;/tt&gt;, but a wrapped &lt;tt&gt;org.apache.logging.log4j.core.ConsoleAppender&lt;/tt&gt;. Since your Log4j 1 code probably expects an appender of type &lt;tt&gt;org.apache.log4j.ConsoleAppender&lt;/tt&gt;, it doesn&apos;t make sense to return the wrapper and the wrappers of Log4j 2 appenders are omitted in the enumeration.&lt;/p&gt;

&lt;p&gt;If you want to modify the Log4j 2 Core configuration, you need to do it using the Log4j 2 Core API. See &lt;a href=&quot;https://logging.apache.org/log4j/2.x/manual/customconfig.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://logging.apache.org/log4j/2.x/manual/customconfig.html&lt;/a&gt; for details.&lt;/p&gt;</comment>
                            <comment id="17885307" author="chaostya" created="Fri, 27 Sep 2024 10:26:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pkarwasz&quot; class=&quot;user-hover&quot; rel=&quot;pkarwasz&quot;&gt;pkarwasz&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;Original issue description states that an old library relies on Logger.getAllAppenders(), in my case the old library relies on&lt;br/&gt;
Logger.getRootLogger().getAllAppenders().hasMoreElements(); &lt;br/&gt;
in an attempt to check if logging was configured, and if it receives 0 appenders, it will try to apply it&apos;s &quot;default&quot; configuration.&lt;/p&gt;

&lt;p&gt;Your fix does not actually fix the original issue, that&apos;s all I&apos;m saying.&lt;/p&gt;</comment>
                            <comment id="17885410" author="pkarwasz" created="Fri, 27 Sep 2024 15:53:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=chaostya&quot; class=&quot;user-hover&quot; rel=&quot;chaostya&quot;&gt;chaostya&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;&amp;gt; Your fix does not actually fix the original issue, that&apos;s all I&apos;m saying.&lt;/p&gt;

&lt;p&gt;Yes, you are right, it doesn&apos;t. Feel free to propose a PR to solve the problem.&lt;/p&gt;

&lt;p&gt;If you are referring to a public library, can you give a link to it? Note that unlike Log4j 1, if no configuration file is present Log4j 2 Core will use a default configuration with a single appender (see &lt;a href=&quot;https://logging.apache.org/log4j/2.x/manual/configuration.html#automatic-configuration&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;documentation&lt;/a&gt;), so the code based on &lt;tt&gt;Logger.getRootLogger().getAllAppenders().hasMoreElements()&lt;/tt&gt; will not work as expected.&lt;/p&gt;</comment>
                            <comment id="17885603" author="chaostya" created="Sat, 28 Sep 2024 17:13:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pkarwasz&quot; class=&quot;user-hover&quot; rel=&quot;pkarwasz&quot;&gt;pkarwasz&lt;/a&gt;&#160;&lt;/p&gt;

&lt;p&gt;It&apos;s not a public library, unfortunately. I cannot change the way it works. Basically, it will first do the DOMConfigurator.configure(&quot;/valid/path/log4j.xml&quot;) but then, it will try to check if the configuration succeeded by doing Logger.getRootLogger().getAllAppenders().hasMoreElements(). And once it returns false, it will apply it&apos;s own default configuration.&lt;/p&gt;

&lt;p&gt;As for the PR - will try to do it. My idea would be to change some base class for Console/File/Rolling Appenders in log4j1 bridge an then change getAllAppeners() to return log4j1 ConsoleAppender, constructed with an internal reference to log4j2 ConsoleAppender and the same for File and RollingFile appenders, kind of similar to what AdapterWrapper does.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13071721" name="log4j.xml" size="685" author="chaostya" created="Mon, 23 Sep 2024 10:37:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 6 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10oq0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>