<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:34:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-1117] OutputStreamManager in ConsoleAppender leaking managers</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-1117</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;I&apos;m actually confused about the intention here, so this is more a question than a bug report, though I&apos;m quite sure that something is wrong here.&lt;/p&gt;

&lt;p&gt;I ran into this issue while writing unit tests for a custom layout and using InitialLoggerContext to setup my logging. I was expecting to always get a fresh start with my actual logger. And I always set a new custom PrintStream for System.out in order to capture the finished output. &lt;br/&gt;
That just worked once, even when I set &quot;follow&quot; (&quot;If true will follow changes to the underlying output stream.&quot;) on the console appender, due to the caching in the AbstractManager/OutputSteamManager output.&lt;/p&gt;

&lt;p&gt;The issue is that ConsoleAppender.getManager does the following:&lt;br/&gt;
OutputStreamManager.getManager(target.name() + &apos;.&apos; + follow, new FactoryData(os, type, layout), factory);&lt;/p&gt;

&lt;p&gt;So the key that ends up in AbstractManager.MAP is something like &quot;SYSTEM_OUT.true&quot;. ConsoleAppenders.ConsoleManagerFactory just uses data.type as the name for the manager, so this will be something like &quot;SYSTEM_OUT&quot; in this case.&lt;/p&gt;

&lt;p&gt;But AbstractManager.release uses the &quot;name&quot; field of the Manager for removing from the map, thus an entry with &quot;SYSTEM_OUT.true&quot; will never be removed, which leads to the issue that changes to System.out will not be visible for the ConsoleAppender.&lt;/p&gt;





</description>
                <environment></environment>
        <key id="12862991">LOG4J2-1117</key>
            <summary>OutputStreamManager in ConsoleAppender leaking managers</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggregory">Gary D. Gregory</assignee>
                                    <reporter username="marcus@thiesen.org">Marcus Thiesen</reporter>
                        <labels>
                    </labels>
                <created>Thu, 10 Sep 2015 09:15:52 +0000</created>
                <updated>Fri, 11 Sep 2015 23:52:56 +0000</updated>
                            <resolved>Fri, 11 Sep 2015 23:52:56 +0000</resolved>
                                    <version>2.1</version>
                                    <fixVersion>2.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14741749" author="garydgregory" created="Fri, 11 Sep 2015 23:52:56 +0000"  >&lt;p&gt;Thank you for your report and digging into the code.&lt;/p&gt;

&lt;p&gt;The keys look fishy to me as well.&lt;/p&gt;

&lt;p&gt;I&apos;ve committed a patch to Git master to use the same key in both places you mention.&lt;/p&gt;

&lt;p&gt;Please verify and close this ticket.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 10 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2jzif:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>