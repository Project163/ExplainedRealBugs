<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:39:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2036] CompositeConfiguration with monitorInterval fails to reload full configuration</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2036</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Steps to reproduce:&lt;/p&gt;

&lt;p&gt;1. Create two configuration files, in my case I use a &quot;default&quot; embedded configuration on the classpath, and a second configuration on disk for overrides (this configuration uses monitorInterval=30).&lt;/p&gt;

&lt;p&gt;2. Configurator.initialize(null, classLoader, ImmutableList.of(defaultUri, diskUri), null)&lt;/p&gt;

&lt;p&gt;3. On initial startup, the two configurations are merged perfectly, everything works as expected.&lt;/p&gt;

&lt;p&gt;4. Modify the on disk (override) configuration while the application is running, the failure is most apparent if I update a logger to reference an appender only defined in the &quot;default&quot; configuration. Reconfiguration executes but only using the file on disk, as though the first configuration has disappeared.&lt;/p&gt;

&lt;p&gt;This is a regression from 2.8.2, so I have rolled back to that version. Unfortunately 2.8.2 is affected by &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-1912&quot; title=&quot;CompositeConfiguration logs warning &amp;quot;Unable to determine URI for configuration.&amp;quot; However, the reconfiguration is completed.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-1912&quot;&gt;&lt;del&gt;LOG4J2-1912&lt;/del&gt;&lt;/a&gt; and complains with misleading warning messages so I&apos;ve had to update the status logger to error level from info.&lt;/p&gt;</description>
                <environment>&lt;p&gt;I have pushed a very simple repro here:&lt;br/&gt;
&lt;a href=&quot;https://github.com/cakofony/log4j2-composite-config-repro&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/cakofony/log4j2-composite-config-repro&lt;/a&gt;&lt;/p&gt;</environment>
        <key id="13100508">LOG4J2-2036</key>
            <summary>CompositeConfiguration with monitorInterval fails to reload full configuration</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ckozak">Carter Kozak</reporter>
                        <labels>
                    </labels>
                <created>Thu, 7 Sep 2017 15:59:31 +0000</created>
                <updated>Tue, 3 Apr 2018 15:50:04 +0000</updated>
                            <resolved>Tue, 3 Apr 2018 15:49:46 +0000</resolved>
                                    <version>2.9.0</version>
                                                    <component>Configurators</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16200846" author="githubbot" created="Wed, 11 Oct 2017 19:45:59 +0000"  >&lt;p&gt;GitHub user cakofony opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/115&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2036&quot; title=&quot;CompositeConfiguration with monitorInterval fails to reload full configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2036&quot;&gt;&lt;del&gt;LOG4J2-2036&lt;/del&gt;&lt;/a&gt; CompositeConfiguration supports Reconfiguration&lt;/p&gt;

&lt;p&gt;    Regression was introduced by the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-1912&quot; title=&quot;CompositeConfiguration logs warning &amp;quot;Unable to determine URI for configuration.&amp;quot; However, the reconfiguration is completed.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-1912&quot;&gt;&lt;del&gt;LOG4J2-1912&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/cakofony/logging-log4j2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/cakofony/logging-log4j2&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2036&quot; title=&quot;CompositeConfiguration with monitorInterval fails to reload full configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2036&quot;&gt;&lt;del&gt;LOG4J2-2036&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/115.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/115.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #115&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 9bb0496cdef96a043c493e90d5df582b402a1afa&lt;br/&gt;
Author: Carter Kozak &amp;lt;c4kofony@gmail.com&amp;gt;&lt;br/&gt;
Date:   2017-10-11T19:43:50Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2036&quot; title=&quot;CompositeConfiguration with monitorInterval fails to reload full configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2036&quot;&gt;&lt;del&gt;LOG4J2-2036&lt;/del&gt;&lt;/a&gt; CompositeConfiguration supports Reconfiguration&lt;/p&gt;

&lt;p&gt;    Regression was introduced by the fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-1912&quot; title=&quot;CompositeConfiguration logs warning &amp;quot;Unable to determine URI for configuration.&amp;quot; However, the reconfiguration is completed.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-1912&quot;&gt;&lt;del&gt;LOG4J2-1912&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16200847" author="githubbot" created="Wed, 11 Oct 2017 19:48:00 +0000"  >&lt;p&gt;Github user cakofony commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/115&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @garydgregory issue appears to have been introduced here: 5b4f3db4f5e7b24862c147b790806bca0b2d1892&lt;/p&gt;</comment>
                            <comment id="16200958" author="githubbot" created="Wed, 11 Oct 2017 21:03:32 +0000"  >&lt;p&gt;Github user garydgregory commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/115&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    By me to boot! &lt;/p&gt;</comment>
                            <comment id="16201046" author="jira-bot" created="Wed, 11 Oct 2017 22:00:30 +0000"  >&lt;p&gt;Commit d647c0b1ac0bdee60f392083bd523a83d765e47e in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=d647c0b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=d647c0b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2036&quot; title=&quot;CompositeConfiguration with monitorInterval fails to reload full configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2036&quot;&gt;&lt;del&gt;LOG4J2-2036&lt;/del&gt;&lt;/a&gt; CompositeConfiguration supports Reconfiguration. Full&lt;br/&gt;
build with &apos;mvn clean install&apos; OK. This closes #115.&lt;/p&gt;</comment>
                            <comment id="16201047" author="githubbot" created="Wed, 11 Oct 2017 22:00:46 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/115&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16219010" author="githubbot" created="Wed, 25 Oct 2017 16:30:36 +0000"  >&lt;p&gt;Github user cakofony commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/115&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @garydgregory The fix you provided also seems broken, after a couple reloads I&apos;m seeing:&lt;/p&gt;

&lt;p&gt;    ```&lt;/p&gt;

&lt;p&gt;    java.lang.NullPointerException&lt;br/&gt;
    &amp;#8211;&lt;br/&gt;
    at org.apache.logging.log4j.core.config.composite.DefaultMergeStrategy.mergConfigurations(DefaultMergeStrategy.java:139)&lt;br/&gt;
    at org.apache.logging.log4j.core.config.composite.CompositeConfiguration.setup(CompositeConfiguration.java:122)&lt;br/&gt;
    at org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:235)&lt;br/&gt;
    at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:249)&lt;br/&gt;
    at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:545)&lt;br/&gt;
    at org.apache.logging.log4j.core.LoggerContext.onChange(LoggerContext.java:667)&lt;br/&gt;
    at org.apache.logging.log4j.core.config.ConfiguratonFileWatcher$ReconfigurationRunnable.run(ConfiguratonFileWatcher.java:68)&lt;br/&gt;
    at java.lang.Thread.run(Thread.java:748)&lt;br/&gt;
    ```&lt;/p&gt;

&lt;p&gt;    Also, if factory.getConfiguration returns null, currentConfig is left null instead of currentConfig.&lt;/p&gt;</comment>
                            <comment id="16221111" author="githubbot" created="Thu, 26 Oct 2017 19:51:03 +0000"  >&lt;p&gt;Github user garydgregory commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/115&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Avoiding the NPE is easy but that might not solve the actual underlying problem. Do you have a unit test for us? Or solution patch?&lt;/p&gt;</comment>
                            <comment id="16221140" author="jira-bot" created="Thu, 26 Oct 2017 20:14:57 +0000"  >&lt;p&gt;Commit b50a2378784ae5e91cc44d8f8c81e2151d29cf57 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=b50a237&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=b50a237&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2036&quot; title=&quot;CompositeConfiguration with monitorInterval fails to reload full configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2036&quot;&gt;&lt;del&gt;LOG4J2-2036&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
CompositeConfiguration with monitorInterval fails to reload full&lt;br/&gt;
configuration. Avoid NPE.&lt;/p&gt;</comment>
                            <comment id="16225498" author="githubbot" created="Mon, 30 Oct 2017 18:28:50 +0000"  >&lt;p&gt;Github user cakofony commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/115&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @garydgregory The change in this PR does not cause the failure, the change that was merged instead introduced the bug.&lt;/p&gt;

&lt;p&gt;    I have a repo here which I&apos;ve used to reproduce the issue: &lt;a href=&quot;https://github.com/cakofony/log4j2-composite-config-repro&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/cakofony/log4j2-composite-config-repro&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I&apos;m not sure the best way to add such a test in this codebase (it gets a bit funky to write out a file, then modify it at runtime, and clean up). I can take a look at putting something together though&lt;/p&gt;</comment>
                            <comment id="16255933" author="mikaelstaldal" created="Thu, 16 Nov 2017 20:37:51 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt; is this issue fixed?&lt;/p&gt;</comment>
                            <comment id="16256407" author="garydgregory" created="Fri, 17 Nov 2017 03:11:44 +0000"  >&lt;p&gt;Not sure, just got off a plane.&lt;/p&gt;</comment>
                            <comment id="16307081" author="ralph.goers@dslextreme.com" created="Sun, 31 Dec 2017 05:14:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt; Any update?&lt;/p&gt;</comment>
                            <comment id="16307095" author="garydgregory" created="Sun, 31 Dec 2017 06:07:20 +0000"  >&lt;p&gt;Dang, I lost track of this issue. I&apos;ll try to take a look over the next couple of days.&lt;/p&gt;</comment>
                            <comment id="16424196" author="ckozak" created="Tue, 3 Apr 2018 15:49:46 +0000"  >&lt;p&gt;I&apos;m unable to reproduce this issue again using 2.11.0, closing it out.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 33 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3jrrr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>