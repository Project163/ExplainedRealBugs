<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:40:55 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2650] ArrayIndexOutOfBoundsException in the initialization of UuidUtil</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2650</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Hi,&#160;&lt;/p&gt;

&lt;p&gt;I&#160;found a&#160;problem in the UuidUtil initialization.&lt;/p&gt;

&lt;p&gt;The code that generate the exception&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Logger log = LogManager.getLogger(MyClass.class);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This code return a ip address of localhost and when the stack is IPv4 return 4 bytes but when the default stack is IPv6 it&apos;s going to return 16 bytes.&lt;br/&gt;
 &#160;&lt;a href=&quot;https://github.com/apache/logging-log4j2/blob/da539329d528d979f4dd385a6ebb639793ef37bd/log4j-core/src/main/java/org/apache/logging/log4j/core/util/NetUtils.java#L108&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;NetUtils.java#L108&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (mac == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || mac.length == 0) { 
   mac = localHost.getAddress(); 
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is the part that generate the&#160;ArrayIndexOutOfBoundsException&lt;/p&gt;

&lt;p&gt;&#160;&lt;a href=&quot;https://github.com/apache/logging-log4j2/blob/da539329d528d979f4dd385a6ebb639793ef37bd/log4j-core/src/main/java/org/apache/logging/log4j/core/util/UuidUtil.java#L81&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;UuidUtil.java#L81&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.arraycopy(mac, index, node, index + 2, length);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;These 16 bytes will generate a wrong destination index that exceed the length of the node array.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mac = {byte[16]@3217} 
length = 6 
index = 10 
node = {byte[8]@3222}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is the complete exception&#160;&#160;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.ExceptionInInitializerError at org.apache.logging.log4j.core.util.WatchManager.&amp;lt;init&amp;gt;(WatchManager.java:53) at org.apache.logging.log4j.core.config.AbstractConfiguration.&amp;lt;init&amp;gt;(AbstractConfiguration.java:135) at org.apache.logging.log4j.core.config.NullConfiguration.&amp;lt;init&amp;gt;(NullConfiguration.java:32) at org.apache.logging.log4j.core.LoggerContext.&amp;lt;clinit&amp;gt;(LoggerContext.java:79) at org.apache.logging.log4j.core.selector.ClassLoaderContextSelector.createContext(ClassLoaderContextSelector.java:171) at org.apache.logging.log4j.core.selector.ClassLoaderContextSelector.locateContext(ClassLoaderContextSelector.java:145) at org.apache.logging.log4j.core.selector.ClassLoaderContextSelector.getContext(ClassLoaderContextSelector.java:70) at org.apache.logging.log4j.core.selector.ClassLoaderContextSelector.getContext(ClassLoaderContextSelector.java:57) at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:148) at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:45) at org.apache.logging.log4j.LogManager.getContext(LogManager.java:194) at org.apache.logging.log4j.LogManager.getLogger(LogManager.java:581) at cc.arduino.contributions.packages.ContributionInstaller.&amp;lt;clinit&amp;gt;(ContributionInstaller.java:66) at processing.app.Base.&amp;lt;init&amp;gt;(Base.java:291) at processing.app.Base.main(Base.java:150) Caused by: java.lang.ArrayIndexOutOfBoundsException at java.lang.&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.arraycopy(Native Method) at org.apache.logging.log4j.core.util.UuidUtil.&amp;lt;clinit&amp;gt;(UuidUtil.java:81) ... 15 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To reproduce the exception you need&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;disconnect every network interface&lt;/li&gt;
	&lt;li&gt;verify that java will use the IPv6 stack&#160;-Djava.net.preferIPv4Stack=false -Djava.net.preferIPv6Addresses=true&lt;/li&gt;
	&lt;li&gt;Initialize a log of log4j&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I suggest different solution:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Remove &#160;&lt;a href=&quot;https://github.com/apache/logging-log4j2/blob/da539329d528d979f4dd385a6ebb639793ef37bd/log4j-core/src/main/java/org/apache/logging/log4j/core/util/NetUtils.java#L108&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;NetUtils.java#L108&lt;/a&gt;&#160;and return always null (when the other code fail to init the mac variable ) because in general the method is called getMacAddress but in that particular case will return and IP address&#160;&lt;/li&gt;
	&lt;li&gt;Mange the IPv6 case in the static part of the class UuidUtil&#160;&lt;a href=&quot;https://github.com/apache/logging-log4j2/blob/da539329d528d979f4dd385a6ebb639793ef37bd/log4j-core/src/main/java/org/apache/logging/log4j/core/util/UuidUtil.java#L81&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;UuidUtil.java#L81&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment>&lt;p&gt;os :&#160;Mac OS&lt;/p&gt;

&lt;p&gt;java: 1.8 (jdk1.8.0_172.jdk)&lt;/p&gt;

&lt;p&gt;none network interfaces connected&lt;/p&gt;</environment>
        <key id="13242734">LOG4J2-2650</key>
            <summary>ArrayIndexOutOfBoundsException in the initialization of UuidUtil</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mattiab">Mattia Bertorello</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Jul 2019 12:32:31 +0000</created>
                <updated>Mon, 21 Dec 2020 13:13:49 +0000</updated>
                            <resolved>Mon, 29 Jul 2019 02:30:03 +0000</resolved>
                                    <version>2.12.0</version>
                                    <fixVersion>2.12.1</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="16877046" author="garydgregory" created="Tue, 2 Jul 2019 15:13:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mattiab&quot; class=&quot;user-hover&quot; rel=&quot;mattiab&quot;&gt;mattiab&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Feel free to provide a patch on GitHub &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16878536" author="mattiab" created="Thu, 4 Jul 2019 10:42:16 +0000"  >&lt;p&gt;Done&#160;&lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/290&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/290&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16894865" author="jira-bot" created="Mon, 29 Jul 2019 02:12:17 +0000"  >&lt;p&gt;Commit 4cc4482cc9bc83e68caa991bf7f65c881ef5969b in logging-log4j2&apos;s branch refs/heads/master from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=4cc4482&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=4cc4482&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merge pull request #290 from mattiabertorello/&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2650&quot; title=&quot;ArrayIndexOutOfBoundsException in the initialization of UuidUtil&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2650&quot;&gt;&lt;del&gt;LOG4J2-2650&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2650&quot; title=&quot;ArrayIndexOutOfBoundsException in the initialization of UuidUtil&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2650&quot;&gt;&lt;del&gt;LOG4J2-2650&lt;/del&gt;&lt;/a&gt; Fix ArrayIndexOutOfBoundsException when the mac variable is an ipv6&lt;/p&gt;</comment>
                            <comment id="16894866" author="jira-bot" created="Mon, 29 Jul 2019 02:12:18 +0000"  >&lt;p&gt;Commit 4cc4482cc9bc83e68caa991bf7f65c881ef5969b in logging-log4j2&apos;s branch refs/heads/master from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=4cc4482&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=4cc4482&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merge pull request #290 from mattiabertorello/&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2650&quot; title=&quot;ArrayIndexOutOfBoundsException in the initialization of UuidUtil&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2650&quot;&gt;&lt;del&gt;LOG4J2-2650&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2650&quot; title=&quot;ArrayIndexOutOfBoundsException in the initialization of UuidUtil&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2650&quot;&gt;&lt;del&gt;LOG4J2-2650&lt;/del&gt;&lt;/a&gt; Fix ArrayIndexOutOfBoundsException when the mac variable is an ipv6&lt;/p&gt;</comment>
                            <comment id="16894877" author="jira-bot" created="Mon, 29 Jul 2019 02:29:17 +0000"  >&lt;p&gt;Commit e50c485380f23fb4c84173757c1808952b257d8b in logging-log4j2&apos;s branch refs/heads/master from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=e50c485&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=e50c485&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2650&quot; title=&quot;ArrayIndexOutOfBoundsException in the initialization of UuidUtil&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2650&quot;&gt;&lt;del&gt;LOG4J2-2650&lt;/del&gt;&lt;/a&gt; - Support emulating a MAC address when using ipv6&lt;/p&gt;</comment>
                            <comment id="16894878" author="jira-bot" created="Mon, 29 Jul 2019 02:29:23 +0000"  >&lt;p&gt;Commit 6d02d668a306872d7cc6d1d0bd01bab3c8413ea6 in logging-log4j2&apos;s branch refs/heads/release-2.x from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=6d02d66&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=6d02d66&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2650&quot; title=&quot;ArrayIndexOutOfBoundsException in the initialization of UuidUtil&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2650&quot;&gt;&lt;del&gt;LOG4J2-2650&lt;/del&gt;&lt;/a&gt; - Support emulating a MAC address when using ipv6&lt;/p&gt;</comment>
                            <comment id="16894880" author="ralph.goers@dslextreme.com" created="Mon, 29 Jul 2019 02:30:03 +0000"  >&lt;p&gt;Patch applied. Please verify and close.&lt;/p&gt;</comment>
                            <comment id="17190805" author="andreas12" created="Fri, 4 Sep 2020 16:05:59 +0000"  >&lt;p&gt;Sorry for the blunt question: Has this really been fixed with 2.12.1? We are getting the same error with that version.&lt;/p&gt;</comment>
                            <comment id="17252852" author="michel.graciano" created="Mon, 21 Dec 2020 13:13:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andreas12&quot; class=&quot;user-hover&quot; rel=&quot;andreas12&quot;&gt;andreas12&lt;/a&gt; there was another fix in &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2707&quot; title=&quot;ArrayIndexOutOfBoundsException in UuidUtil, when MAC address is longer than 6 bytes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2707&quot;&gt;&lt;del&gt;LOG4J2-2707&lt;/del&gt;&lt;/a&gt;. Please take a look at 2.13.0 or newer versions.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                                                <inwardlinks description="is cloned by">
                                        <issuelink>
            <issuekey id="13346780">LOG4J2-2980</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 47 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z04aq0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>