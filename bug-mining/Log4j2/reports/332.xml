<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:32:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-373] Classloader issue in OSGi-environment</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-373</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Using Log4j2 in a bundle causes following error:&lt;br/&gt;
ERROR StatusLogger org.apache.logging.log4j.core.impl.Log4jContextFactory does not implement org.apache.logging.log4j.spi.LoggerContextFactory&lt;br/&gt;
ERROR StatusLogger Unable to locate a logging implementation, using SimpleLogger&lt;/p&gt;

&lt;p&gt;printing the ClassLoaders in LogManager gives me following output:&lt;/p&gt;

&lt;p&gt;org.apache.logging.log4j.spi.LoggerContextFactory loaded by org.apache.logging.log4j-api &lt;span class=&quot;error&quot;&gt;&amp;#91;13&amp;#93;&lt;/span&gt;&lt;br/&gt;
org.apache.logging.log4j.core.impl.Log4jContextFactory loaded by sun.misc.Launcher$AppClassLoader@35a16869&lt;/p&gt;

&lt;p&gt;We have two different ClassLoaders. That&apos;s why the implementation is not assignable. The core uses the bootstrap-classloader and the api uses the bundle-classloader.&lt;/p&gt;

&lt;p&gt;Workaround needed. Thx&lt;/p&gt;

&lt;p&gt;addendum:&lt;br/&gt;
ProviderUtil.findClassLoader() returns the bootstrap-classloader but not the bundle-classloader of the log4j2-core. The log4j2-core is a fragment of the log4j2-api bundle. Thus, ProviderUtil.findClassLoader() must return the bundle-classloader of log4j2-api. This a bug for the case that log4j2-core is used as the implementation. There are other cases that will also cause problems. Further investigations are necessary.&lt;/p&gt;

&lt;p&gt;Workaround:&lt;br/&gt;
1. check if log4j2 runs in an OSGI container.&lt;br/&gt;
Bundle mybundle = org.osgi.framework.FrameworkUtil.getBundle(MyClass.this);&lt;br/&gt;
2. if(mybundle != null), than get bundle-classloader of log4j2-impl.&lt;br/&gt;
mybundle.adapt(BundleWiring.class).getClassLoader();&lt;/p&gt;</description>
                <environment>&lt;p&gt;OSGi R5 / R4 (Apache Felix 4.x)&lt;/p&gt;</environment>
        <key id="12665660">LOG4J2-373</key>
            <summary>Classloader issue in OSGi-environment</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mattsicker">Matt Sicker</assignee>
                                    <reporter username="rol">Roland Weiglhofer</reporter>
                        <labels>
                            <label>ClassLoader</label>
                            <label>OSGI</label>
                    </labels>
                <created>Tue, 27 Aug 2013 07:19:29 +0000</created>
                <updated>Thu, 3 Dec 2015 17:11:23 +0000</updated>
                            <resolved>Sun, 20 Jul 2014 02:16:51 +0000</resolved>
                                    <version>2.0-beta9</version>
                                    <fixVersion>2.0.1</fixVersion>
                                    <component>API</component>
                    <component>Core</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>12</watches>
                                                                                                                                                            <comments>
                            <comment id="13751115" author="rol" created="Tue, 27 Aug 2013 09:28:18 +0000"  >&lt;p&gt;works for me but is not fully tested.&lt;/p&gt;</comment>
                            <comment id="13835421" author="chalin" created="Fri, 29 Nov 2013 15:25:55 +0000"  >&lt;p&gt;Thanks for the patch; it works for me as well.&lt;/p&gt;</comment>
                            <comment id="13846754" author="nkumar@acemetrix.com" created="Thu, 12 Dec 2013 21:25:24 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I also see the same errors on the console.&lt;/p&gt;

&lt;p&gt;ERROR StatusLogger org.apache.logging.log4j.core.impl.Log4jContextFactory does not implement org.apache.logging.log4j.spi.LoggerContextFactory&lt;br/&gt;
ERROR StatusLogger Unable to locate a logging implementation, using SimpleLogger&lt;/p&gt;

&lt;p&gt;How can I download this patch &amp;amp; apply? Your help is appreciated.&lt;/p&gt;

&lt;p&gt;I am using  2.0-beta9 version.&lt;/p&gt;

&lt;p&gt;        &amp;lt;dependency&amp;gt;&lt;br/&gt;
            &amp;lt;groupId&amp;gt;org.apache.logging.log4j&amp;lt;/groupId&amp;gt;&lt;br/&gt;
            &amp;lt;artifactId&amp;gt;log4j-core&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
            &amp;lt;version&amp;gt;${log4j.version}&amp;lt;/version&amp;gt;&lt;br/&gt;
        &amp;lt;/dependency&amp;gt;&lt;/p&gt;

&lt;p&gt;        &amp;lt;dependency&amp;gt;&lt;br/&gt;
            &amp;lt;groupId&amp;gt;org.apache.logging.log4j&amp;lt;/groupId&amp;gt;&lt;br/&gt;
            &amp;lt;artifactId&amp;gt;log4j-api&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
            &amp;lt;version&amp;gt;${log4j.version}&amp;lt;/version&amp;gt;&lt;br/&gt;
      &amp;lt;/dependency&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13862627" author="jvz" created="Sun, 5 Jan 2014 18:47:54 +0000"  >&lt;p&gt;To apply the patch, download the source zip or tar.gz, download the patch file, then run &lt;tt&gt;patch -p1 &amp;lt; log4j-api.patch&lt;/tt&gt; inside the source directory. Then you can run &lt;tt&gt;mvn install&lt;/tt&gt; as per usual to put it in your local &lt;tt&gt;~/.m2/&lt;/tt&gt; repository. Or if you&apos;ve got your own internal Nexus, you can use the deploy target with your own profile (I&apos;m not sure on the details; I&apos;m more of a gradle guy myself).&lt;/p&gt;</comment>
                            <comment id="13862761" author="remkop@yahoo.com" created="Mon, 6 Jan 2014 04:45:39 +0000"  >&lt;p&gt;At the moment log4j2 users need at least log4j-api and log4j-core.&lt;/p&gt;

&lt;p&gt;If I understand correctly, this patch would introduce dependencies from log4j-api to org.osgi.compendium and org.osgi.core. Does that mean that all log4j2 users would need to have these 2 jars in the classpath in order to use log4j2? I would prefer a solution that does not introduce such a dependency for non-OSGi users of log4j2.&lt;/p&gt;</comment>
                            <comment id="13882132" author="jvz" created="Sun, 26 Jan 2014 01:27:36 +0000"  >&lt;p&gt;Shouldn&apos;t you be loading core as a bundle too?&lt;/p&gt;</comment>
                            <comment id="13882238" author="ralph.goers@dslextreme.com" created="Sun, 26 Jan 2014 09:08:07 +0000"  >&lt;p&gt;In core the osgi core jar is marked as provided since it would be expected to already be present in an OSGi environment. I would expect the same should be done for these dependencies. However, in core that code path will only execute if a bundleresource url is encountered. In this case it seems like it will invoke the OSGi framework for everything which clearly isn&apos;t OK. The patch should be reworked to detect if an OSGi environment is present (i.e. - detect if the FrameworkUtil class is present) before attempting to call it.&lt;/p&gt;</comment>
                            <comment id="13882421" author="jvz" created="Sun, 26 Jan 2014 20:37:48 +0000"  >&lt;p&gt;I meant log4j-core, not osgi.&lt;/p&gt;</comment>
                            <comment id="13889088" author="jvz" created="Sun, 2 Feb 2014 22:29:54 +0000"  >&lt;p&gt;Shouldn&apos;t you be loading the bundles like so: log4j-api is the host bundle, and then use the OSGi bundles from there. Log4j-api should be using its own class loader in this case.&lt;/p&gt;

&lt;p&gt;I&apos;ve got some ideas on how to approach this in an API modification, but I&apos;ll have to flesh them out first.&lt;/p&gt;</comment>
                            <comment id="13893035" author="nrhope" created="Thu, 6 Feb 2014 04:53:59 +0000"  >&lt;p&gt;Just wanted to add a note that this is not purely an OSGi issue and also broke unit tests we were running using the maven surefire plugin. Given this is probably a pretty common use case you make want to consider including the patch in your next rc / release.&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="13893107" author="remkop@yahoo.com" created="Thu, 6 Feb 2014 06:48:30 +0000"  >&lt;p&gt;Norval, it may be a good idea to raise the problem you are experiencing in a separate Jira ticket and link to this ticket.&lt;/p&gt;

&lt;p&gt;That way you can provide more detail about the problem you are seeing (stack trace, perhaps source code for a failing unit test or some other way for us to reproduce the issue) by attaching to that ticket. &lt;/p&gt;

&lt;p&gt;It is possible that the underlying cause is the same but it is difficult to tell at the moment. &lt;/p&gt;

&lt;p&gt;EDIT:&lt;br/&gt;
Or did you mean that you have a unit test that fails with trunk but passes after applying the patch that is attached to this Jira? I think that would be useful!&lt;/p&gt;</comment>
                            <comment id="13893877" author="jvz" created="Thu, 6 Feb 2014 22:07:23 +0000"  >&lt;p&gt;The patch provided is not realistic since it adds OSGi dependencies to the API. I have a better solution that involves pulling out the static initialization in LogManager into its own class. That way, the OSGi bundles can register the correct class loader when they get loaded.&lt;/p&gt;</comment>
                            <comment id="13903291" author="remkop@yahoo.com" created="Mon, 17 Feb 2014 14:55:45 +0000"  >&lt;p&gt;Matt, you mentioned that what you have in mind may require API changes.&lt;/p&gt;

&lt;p&gt;I think previously we were thinking to work on OSGi after the 2.0 GA release, but if proper OSGi support requires API changes then perhaps we should make these changes &lt;em&gt;before&lt;/em&gt; the 2.0 GA release.&lt;/p&gt;

&lt;p&gt;Could you clarify what you have in mind for the API changes you mentioned, or perhaps provide a patch?&lt;/p&gt;</comment>
                            <comment id="13903770" author="jvz" created="Tue, 18 Feb 2014 04:26:27 +0000"  >&lt;p&gt;Oh wow, never mind. I found a super simple fix for this. The API change that I mean is an OSGi API change. It would be preferable to have them match with the project version to some degree. There may be a need to automate an API change analyzer to enforce proper version numbering in the bundle.&lt;/p&gt;</comment>
                            <comment id="13903772" author="jvz" created="Tue, 18 Feb 2014 04:28:14 +0000"  >&lt;p&gt;Wait, scratch that, the core-reduced bundle shouldn&apos;t be the one exporting the log4j API. Let me rework that a little bit.&lt;/p&gt;</comment>
                            <comment id="13903792" author="jvz" created="Tue, 18 Feb 2014 05:22:03 +0000"  >&lt;p&gt;I&apos;m looking into this bug right now. In the meantime, let me clarify that most of the API changes that would be useful for bundles would be focused in the log4j-core package structure. If that API can change in 2.x version upgrades, then that won&apos;t be a problem. We&apos;d be able to get a nice modular OSGi version of core to really make it useful. This might also offer an alternative to the &quot;fat&quot; JARs like log4j-core.&lt;/p&gt;</comment>
                            <comment id="13903823" author="remkop@yahoo.com" created="Tue, 18 Feb 2014 06:35:07 +0000"  >&lt;p&gt;I see. Personally, if changes to log4j-core are necessary, I would prefer to make them before the 2.0 GA release.&lt;/p&gt;

&lt;p&gt;Are you suggesting to split up the log4j-core jar? Hopefully that would only result in many small jars for OSGi users, and non-OSGi users can continue to use the single log4j-core jar that exists currently, does that match what you have in mind?&lt;/p&gt;
</comment>
                            <comment id="13912997" author="christophe.bordier" created="Wed, 26 Feb 2014 15:08:22 +0000"  >&lt;p&gt;I&apos;m surprised that nobody uploaded a correct jar with the patch applied. Here it is. I called it &quot;RC 2&quot; but please note  that this is NOT an official release ! &lt;a href=&quot;https://drive.google.com/file/d/0B-wGewYKm47hRjA4U2E1eFA2Q2s/edit?usp=sharing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://drive.google.com/file/d/0B-wGewYKm47hRjA4U2E1eFA2Q2s/edit?usp=sharing&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13982452" author="jvz" created="Sun, 27 Apr 2014 20:16:38 +0000"  >&lt;p&gt;This issue may be solved with the recent OSGi updates. I&apos;ll follow up later with the results of my own testing, but in theory, this should work now.&lt;/p&gt;</comment>
                            <comment id="14067763" author="jvz" created="Sun, 20 Jul 2014 02:16:51 +0000"  >&lt;p&gt;Fixed in revision 1612002. Please verify and close.&lt;/p&gt;</comment>
                            <comment id="14122001" author="ssethia" created="Thu, 4 Sep 2014 21:32:51 +0000"  >&lt;p&gt;I&apos;m get the following message on an OSGi project. &quot;ERROR StatusLogger Log4j2 could not find a logging implementation. Please add log4j-core to the classpath. Using SimpleLogger to log to the console...&quot;, I&apos;m using log4j-api v2.0.2 and log4j-core v2.0.2; The logger works very well on a stand alone java project but fails on an eclipse project. Any pointers?&lt;/p&gt;</comment>
                            <comment id="14122318" author="jvz" created="Fri, 5 Sep 2014 02:53:01 +0000"  >&lt;p&gt;I think I found a race condition between the bundle activator and LogManager. I&apos;ve fixed this in the master branch. Could you try out the latest git version?&lt;/p&gt;</comment>
                            <comment id="14122911" author="ssethia" created="Fri, 5 Sep 2014 13:14:06 +0000"  >&lt;p&gt;I get Compilation errors on the log4j-api project&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; COMPILATION ERROR :&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; -------------------------------------------------------------&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; c:\Users\SD\Desktop\log4j master\logging-log4j2\log4j-api\src\test\java\org\apache\logging\log4j\message\LocalizedMessageTest.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;36,45&amp;#93;&lt;/span&gt; type parameters of &amp;lt;T&amp;gt;T cannot be determi&lt;br/&gt;
ned; no unique maximal instance exists for type variable T with upper bounds T,java.lang.Object&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; 1 error&lt;/p&gt;

&lt;p&gt;for the time being I&apos;ve commented the test and proceed with mvn clean install on the project.&lt;br/&gt;
I checked out master from here &lt;a href=&quot;https://github.com/apache/logging-log4j2.git&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2.git&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I still don&apos;t see the issue being resolved. I still get the same error (I verified that the jars in the class path were log4j-api-2.1-SNAPSHOT and log4j-core-2.1-SNAPSHOT)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jvz&quot; class=&quot;user-hover&quot; rel=&quot;jvz&quot;&gt;jvz&lt;/a&gt; I see the pom version as 2.1-SNAPSHOT, did you fix it on 2.0.1 or 2.0.2? &lt;/p&gt;</comment>
                            <comment id="14123120" author="garydgregory" created="Fri, 5 Sep 2014 16:34:49 +0000"  >&lt;p&gt;Make sure you have the latest Java 6 JDK (or Java 7)&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="14123125" author="jvz" created="Fri, 5 Sep 2014 16:38:21 +0000"  >&lt;p&gt;The race condition part was fixed in 2.1-SNAPSHOT. The general ClassLoader issue was fixed in 2.0.1 to some extent. There&apos;s still probably more issues to work out, but the main showstoppers seem to be all fixed.&lt;/p&gt;</comment>
                            <comment id="14123191" author="ssethia" created="Fri, 5 Sep 2014 17:24:48 +0000"  >&lt;p&gt;I&apos;m on Java6u45, I built the 2.1-SNAPSHOT and still see the same issue on all 3 versions (2.1-SNAPSHOT, 2.0.1 and 2.0.2).&lt;/p&gt;

&lt;p&gt;Should the manifest have something specific that I&apos;m missing? Can you point me to a sample plugin project that seems to work for you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jvz&quot; class=&quot;user-hover&quot; rel=&quot;jvz&quot;&gt;jvz&lt;/a&gt;. &lt;/p&gt;</comment>
                            <comment id="14123207" author="jvz" created="Fri, 5 Sep 2014 17:34:30 +0000"  >&lt;p&gt;Are you using any custom plugins? Or is this purely log4j-api and log4j-core?&lt;/p&gt;</comment>
                            <comment id="14123212" author="ssethia" created="Fri, 5 Sep 2014 17:37:12 +0000"  >&lt;p&gt;The plugin has a few other dependencies including junit and powermock. The product has a lot of custom plugins.&lt;/p&gt;</comment>
                            <comment id="14123216" author="jvz" created="Fri, 5 Sep 2014 17:39:33 +0000"  >&lt;p&gt;I mean custom Log4j plugins.&lt;/p&gt;</comment>
                            <comment id="14123222" author="ssethia" created="Fri, 5 Sep 2014 17:41:38 +0000"  >&lt;p&gt;none except log4j-api and log4j-core&lt;/p&gt;</comment>
                            <comment id="14123224" author="garydgregory" created="Fri, 5 Sep 2014 17:41:48 +0000"  >&lt;p&gt;I am sorry you are having trouble.&lt;/p&gt;

&lt;p&gt;Here, I was able to run &lt;tt&gt;mvn clean compile&lt;/tt&gt; OK using:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mvn -version

Apache Maven 3.2.3 (33f8c3e1027c3ddde99d3cdebad2656a31e8fdf4; 2014-08-11T16:58:10-04:00)
Maven home: C:\Java\apache-maven-3.2.3
Java version: 1.6.0_45, vendor: Sun Microsystems Inc.
Java home: C:\Program Files\Java\jdk1.6.0_45\jre
Default locale: en_US, platform encoding: Cp1252
OS name: &quot;windows 7&quot;, version: &quot;6.1&quot;, arch: &quot;amd64&quot;, family: &quot;windows&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14123256" author="garydgregory" created="Fri, 5 Sep 2014 17:55:28 +0000"  >&lt;p&gt;Just to make sure the obvious has been taken care of: you ran &quot;mvn clean install&quot; to put the 2.1-SNAPSHOT in your local repo? Or, are you putting the jar files on your classpath differently?&lt;/p&gt;</comment>
                            <comment id="14123338" author="ssethia" created="Fri, 5 Sep 2014 18:34:55 +0000"  >&lt;p&gt;I ran &quot;mvn clean install&quot; to install it to my local m2 repo. The issue building 2.1-SNAPSHOT was maven version, I was using 2.2.1 and later switched to 3.1.0 and it seems to install fine.&lt;/p&gt;

&lt;p&gt;Step taken so far&lt;br/&gt;
1. Ran mvn clean install on log4j-api and log4j-core cloned from &lt;a href=&quot;https://github.com/apache/logging-log4j2.git&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2.git&lt;/a&gt; and git checkout master&lt;br/&gt;
2. Ran &quot;mvn eclipse:eclipse -DdownloadSources=true -Declipse.useProjectReferences=false -DdownloadJavadocs=true -U&quot; on the plugin whose pom.xml has log4j-api and log4j-core as dependencies&lt;br/&gt;
3. Ram mvn copyresource to generate MANIFEST.MF on the plugin project&lt;br/&gt;
4. Ran &quot;mvn eclipse:eclipse -DdownloadSources=true -Declipse.useProjectReferences=false -DdownloadJavadocs=true -U&quot; on the main product&lt;br/&gt;
5. Ran &quot;mvn clean install&quot; on the main product&lt;br/&gt;
6. Ran the main product and get the exception &quot;ERROR StatusLogger Log4j2 could not find a logging implementation. Please add log4j-core to the classpath. Using SimpleLogger to log to the console...&quot;&lt;/p&gt;

&lt;p&gt;I&apos;m using &lt;br/&gt;
jdk1.6.0_45 (32 bit)&lt;br/&gt;
maven 3 to build the log4j jars&lt;br/&gt;
maven 2 to build the plugin and the product (we have a maven 2 constraint on the product)&lt;br/&gt;
org.eclipse.osgi version &quot;3.8.1-SDK-4.2.1&quot;&lt;/p&gt;

</comment>
                            <comment id="14123731" author="jvz" created="Fri, 5 Sep 2014 22:46:22 +0000"  >&lt;p&gt;Could you check out the latest code from here: &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/logging-log4j2.git&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/logging-log4j2.git&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;And check out the branch called &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-809&quot; title=&quot;Move caller class reflection utils to API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-809&quot;&gt;&lt;del&gt;LOG4J2-809&lt;/del&gt;&lt;/a&gt;. I&apos;ve been working on some ClassLoader-related code there which might affect this issue.&lt;/p&gt;</comment>
                            <comment id="14125667" author="ssethia" created="Mon, 8 Sep 2014 15:21:38 +0000"  >&lt;p&gt;I tried branch &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-809&quot; title=&quot;Move caller class reflection utils to API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-809&quot;&gt;&lt;del&gt;LOG4J2-809&lt;/del&gt;&lt;/a&gt; from the link mentioned above, but still get the same issue. &lt;br/&gt;
A few things to note are the versions that I&apos;m using, I&apos;m not sure if these are conflicting/causing the trouble.&lt;/p&gt;

&lt;p&gt;&amp;lt;org.osgi.core&amp;gt;4.3.1&amp;lt;/org.osgi.core&amp;gt;&lt;br/&gt;
&amp;lt;org.eclipse.osgi.services&amp;gt;3.3.100-SDK-4.2.1&amp;lt;/org.eclipse.osgi.services&amp;gt;&lt;br/&gt;
&amp;lt;org.eclipse.osgi&amp;gt;3.8.1-SDK-4.2.1&amp;lt;/org.eclipse.osgi&amp;gt;&lt;/p&gt;</comment>
                            <comment id="14307078" author="honey goyal" created="Thu, 5 Feb 2015 11:31:45 +0000"  >&lt;p&gt;Is it really resolved? In Karaf 3.0.3, i am getting the same error &quot;ERROR StatusLogger Log4j2 could not find a logging implementation. Please add log4j-core to the classpath. Using SimpleLogger to log to the console...&quot;&lt;/p&gt;

&lt;p&gt;As karaf 3.0.3 comes with pax logging version 1.8.1(which support log4j2).  I installed bundles log4j-api(2.1) and log4j-core(2.1) manually in karaf.&lt;/p&gt;

&lt;p&gt;Any workaround?&lt;/p&gt;</comment>
                            <comment id="14313816" author="honey goyal" created="Tue, 10 Feb 2015 08:33:24 +0000"  >&lt;p&gt;I checked LoaderUtil.java&apos;s static block, I found below class loader in karaf runtime container.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[sun.misc.Launcher$AppClassLoader@f4b2263, org.apache.logging.log4j.api [65], sun.misc.Launcher$AppClassLoader@f4b2263]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It tried to find &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;META-INF/log4j-provider.properties&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; file in resources, which it not able to found. That&apos;s why this &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ProviderUtil.hasProviders()&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; returns false.&lt;br/&gt;
I am using log4j-api 2.1 and log4j-core 2.1. Both bundles i have installed in karaf container.&lt;/p&gt;

&lt;p&gt;Any suggestions?&lt;/p&gt;</comment>
                            <comment id="15038099" author="jvz" created="Thu, 3 Dec 2015 16:58:57 +0000"  >&lt;p&gt;This seems to work fine with pax-logging-log4j2, but that might be because they patched ResolverUtil to add bundle URL support.&lt;/p&gt;

&lt;p&gt;Edit: looking at the patched ResolverUtil, all they added was an alias for bundleresource: URIs as just bundle: URIs.&lt;/p&gt;

&lt;p&gt;Edit2: they shaded log4j-api and log4j-core together. This might have something to do with it.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12691240">LOG4J2-513</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12600124" name="log4j-api.patch" size="1952" author="rol" created="Tue, 27 Aug 2013 09:28:18 +0000"/>
                    </attachments>
                <subtasks>
                            <subtask id="12691240">LOG4J2-513</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311120" key="com.pyxis.greenhopper.jira:gh-epic-link">
                        <customfieldname>Epic Link</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>LOG4J2-515</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>345600</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1nlhz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>345901</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>