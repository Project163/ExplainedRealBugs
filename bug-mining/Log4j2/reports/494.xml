<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:34:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-1037] Backward compatibility issue in log4j-1.2-api NDC pop() and peek()</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-1037</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;While going through and migrating our projects to log4j 2.2, there are several apps and 3rd party libraries that we use that depend on log4j 1.2.&lt;/p&gt;

&lt;p&gt;Whilst the log4j-1.2-api library pretty much works flawlessly for us, I ran into an issue today with the opensaml1 library which breaks when it tries to call NDC.pop().&lt;/p&gt;

&lt;p&gt;In log4j 1.2, NDC.pop() would check to see if the stack was empty and if it was, returned an empty string but with the log4j-1.2-api library, the DefaultThreadContextStack.pop() ends up throwing a NoSuchElementException which causes everything to fall over for us.&lt;/p&gt;

&lt;p&gt;Given the library is meant to provide backwards compatibility, shouldn&apos;t the behaviour also be the same?  At present, upgrading the OpenSAML library isn&apos;t an option, frustratingly.&lt;/p&gt;

&lt;p&gt;] Unhandled exception:  - java.util.NoSuchElementException: The ThreadContext stack is empty&lt;br/&gt;
        at org.apache.logging.log4j.spi.DefaultThreadContextStack.pop(DefaultThreadContextStack.java:185)&lt;br/&gt;
        at org.apache.logging.log4j.ThreadContext.pop(ThreadContext.java:391)&lt;br/&gt;
        at org.apache.log4j.NDC.pop(NDC.java:121)&lt;br/&gt;
        at org.opensaml.SAMLException.getInstance(Unknown Source)&lt;br/&gt;
        at org.opensaml.SAMLResponse.fromDOM(Unknown Source)&lt;br/&gt;
       at org.opensaml.SAMLResponse.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
        at org.jasig.cas.client.validation.Saml11TicketValidator.parseResponseFromServer(Saml11TicketValidator.java:51)&lt;br/&gt;
        at &lt;/p&gt;</description>
                <environment></environment>
        <key id="12834486">LOG4J2-1037</key>
            <summary>Backward compatibility issue in log4j-1.2-api NDC pop() and peek()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="h4xmd">Marc Dergacz</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Jun 2015 06:13:07 +0000</created>
                <updated>Tue, 2 Jun 2015 18:16:28 +0000</updated>
                            <resolved>Tue, 2 Jun 2015 18:03:17 +0000</resolved>
                                    <version>2.2</version>
                    <version>2.3</version>
                                    <fixVersion>2.4</fixVersion>
                                    <component>Log4j 1.2 bridge</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14569230" author="garydgregory" created="Tue, 2 Jun 2015 15:02:45 +0000"  >&lt;p&gt;Should be easy to fix. But... at which level? It looks like we copied the v1.2 Javadoc all the way down to &lt;tt&gt;org.apache.logging.log4j.ThreadContext.pop()&lt;/tt&gt; but left the implementation as a &quot;plain&quot; pop that throws a &lt;tt&gt;NoSuchElementException&lt;/tt&gt;. What do we want in the core? Fix the Javadoc to match the code or fix the code to match the Javadoc? We can then adjust the API module as needed.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ralphgoers&quot; class=&quot;user-hover&quot; rel=&quot;ralphgoers&quot;&gt;ralphgoers&lt;/a&gt;: What was the intention for 2.0 here?&lt;/p&gt;</comment>
                            <comment id="14569272" author="ralph.goers@dslextreme.com" created="Tue, 2 Jun 2015 15:31:04 +0000"  >&lt;p&gt;I am not much of a fan of the NDC but implemented the ThreadContext stack so we could be compatible with Log4j 1.x.  If the behavior of the context stack isn&apos;t the same as the NDC then it should be changed. IOW - the fix should go in to ThreadContext.pop to behave as 1.x does.&lt;/p&gt;</comment>
                            <comment id="14569506" author="garydgregory" created="Tue, 2 Jun 2015 18:03:17 +0000"  >&lt;p&gt;Fixed in Git master. Please verify and close.&lt;/p&gt;</comment>
                            <comment id="14569518" author="garydgregory" created="Tue, 2 Jun 2015 18:16:28 +0000"  >&lt;p&gt;I also uploaded snapshots to &lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots&lt;/a&gt; (except for the log4j-perf module).&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 25 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2fhvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>