<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:42:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-3168] RollingFileAppender: Overwritting rotated log file when using zip</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-3168</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;We use log4j2 for logging and have observed the phenomenon that when using zipping, existing logs are overwritten when rotating logs.&lt;/p&gt;

&lt;p&gt;The used LogConfig:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Configuration  name=&lt;span class=&quot;code-quote&quot;&gt;&quot;base&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Appenders&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Console name=&lt;span class=&quot;code-quote&quot;&gt;&quot;console&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;JSONLayout compact=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt; eventEol=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt; locationInfo=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Console&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;RollingFile name=&lt;span class=&quot;code-quote&quot;&gt;&quot;file&quot;&lt;/span&gt; append=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;fileName&amp;gt;&lt;/span&gt;./file.log&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/fileName&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;filePattern&amp;gt;&lt;/span&gt;./file.%d{yyyyMMdd&lt;span class=&quot;code-quote&quot;&gt;&apos;T&apos;&lt;/span&gt;HHmmssZ}.%i.log.zip&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/filePattern&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;PatternLayout pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;%d{HH:mm:ss,SSS} [%15.15t] %-5p %30.30c@%-4L %x - %m%n&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Policies&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;OnStartupTriggeringPolicy/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;SizeBasedTriggeringPolicy size=&lt;span class=&quot;code-quote&quot;&gt;&quot;15 MB&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Policies&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;DefaultRolloverStrategy&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Delete basePath=&lt;span class=&quot;code-quote&quot;&gt;&quot;./&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;IfFileName glob=&lt;span class=&quot;code-quote&quot;&gt;&quot;file.*.log.zip&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;IfLastModified age=&lt;span class=&quot;code-quote&quot;&gt;&quot;7d&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/IfFileName&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Delete&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/DefaultRolloverStrategy&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/RollingFile&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;&amp;lt;!-- Just for testing to verify if the log files get lost by zipping them--&amp;gt;&lt;/span&gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;RollingFile name=&lt;span class=&quot;code-quote&quot;&gt;&quot;file-unzipped-bug-verification&quot;&lt;/span&gt; append=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;fileName&amp;gt;&lt;/span&gt;./file-fallback.log&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/fileName&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;filePattern&amp;gt;&lt;/span&gt;./file-fallback.%d{yyyyMMdd&lt;span class=&quot;code-quote&quot;&gt;&apos;T&apos;&lt;/span&gt;HHmmssZ}.%i.log&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/filePattern&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;PatternLayout pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;%d{HH:mm:ss,SSS} [%15.15t] %-5p %30.30c@%-4L %x - %m%n&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Policies&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;OnStartupTriggeringPolicy/&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;SizeBasedTriggeringPolicy size=&lt;span class=&quot;code-quote&quot;&gt;&quot;15 MB&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Policies&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;DefaultRolloverStrategy&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Delete basePath=&lt;span class=&quot;code-quote&quot;&gt;&quot;./&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;IfFileName glob=&lt;span class=&quot;code-quote&quot;&gt;&quot;./file-fallback.*.log&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
                        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;IfLastModified age=&lt;span class=&quot;code-quote&quot;&gt;&quot;7d&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
                    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/IfFileName&amp;gt;&lt;/span&gt;
                &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Delete&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/DefaultRolloverStrategy&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/RollingFile&amp;gt;&lt;/span&gt;        
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Appenders&amp;gt;&lt;/span&gt;

    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Loggers&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Logger name=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.example.project&quot;&lt;/span&gt; level=&lt;span class=&quot;code-quote&quot;&gt;&quot;debug&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Root level=&lt;span class=&quot;code-quote&quot;&gt;&quot;info&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;console&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;file&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;
            &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;file-unzipped-bug-verification&quot;&lt;/span&gt; /&amp;gt;&lt;/span&gt;			
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Root&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Loggers&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Configuration&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It turns out that at any point in time, the rotation behavior changes and the last time stamp of the log is no longer used as the file name, but the first.&lt;/p&gt;

&lt;p&gt;This results in the following circumstance:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;file.20210914T144224+0200.1.log
	&lt;ul&gt;
		&lt;li&gt;first line:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
13:50:21,789 [lt-executor-194] DEBUG StreamHandler@68 [] - RPC stream completed&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;last line:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
14:42:24,974 [D_2400_supply-1] DEBUG ActionDispatcher@291 [] - Waiting at action ...&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;file.20210914T155051+0200.1.log
	&lt;ul&gt;
		&lt;li&gt;first line:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
15:50:51,988 [ mc-exe-10] DEBUG ResourceSchedule@215 [] - discarding MutexReservation&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;
	&lt;ul&gt;
		&lt;li&gt;last line:
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
16:03:27,839 [ool-58-thread-1] DEBUG Repository@111 [] - Repository@1d41309 changed, publishing updates&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Another file between these times does not exist.&lt;/p&gt;

&lt;p&gt;We verified this by adding a second appender without zipping, which contained all logs. The files `./file-fallback.XXXXXXXXX.log` contain all logs&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 10 + java&#160;1.8.0_201&lt;/p&gt;</environment>
        <key id="13403444">LOG4J2-3168</key>
            <summary>RollingFileAppender: Overwritting rotated log file when using zip</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ma_ke">Markus Ke</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Sep 2021 07:46:19 +0000</created>
                <updated>Thu, 25 Nov 2021 08:19:11 +0000</updated>
                            <resolved>Sun, 21 Nov 2021 00:11:57 +0000</resolved>
                                    <version>2.13.3</version>
                                    <fixVersion>2.15.0</fixVersion>
                                    <component>Appenders</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17435900" author="bwoester" created="Fri, 29 Oct 2021 10:40:03 +0000"  >&lt;p&gt;I think this is actually caused by the timezone being part of the filename pattern. It can easily expand to something like +0200, which causes issues with the regEx being used to find already existing log files matching the pattern.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;A PR trying to fix the issue has been provided here:&#160;&lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/594&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/594&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17446912" author="jira-bot" created="Sat, 20 Nov 2021 23:46:09 +0000"  >&lt;p&gt;Commit 9f55c387b951016e8011f042ecd817b31668f2c8 in logging-log4j2&apos;s branch refs/heads/release-2.x from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=9f55c38&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=9f55c38&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3168&quot; title=&quot;RollingFileAppender: Overwritting rotated log file when using zip&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3168&quot;&gt;&lt;del&gt;LOG4J2-3168&lt;/del&gt;&lt;/a&gt; - Fix bug when file names contain regex characters.&lt;/p&gt;</comment>
                            <comment id="17446913" author="jira-bot" created="Sun, 21 Nov 2021 00:10:27 +0000"  >&lt;p&gt;Commit 9df31f73b62ba23e335d548843547f72b3684a66 in logging-log4j2&apos;s branch refs/heads/master from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=9df31f7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=9df31f7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3168&quot; title=&quot;RollingFileAppender: Overwritting rotated log file when using zip&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3168&quot;&gt;&lt;del&gt;LOG4J2-3168&lt;/del&gt;&lt;/a&gt; - Fix bug when file names contain regex characters.&lt;/p&gt;</comment>
                            <comment id="17446914" author="ralph.goers@dslextreme.com" created="Sun, 21 Nov 2021 00:11:57 +0000"  >&lt;p&gt;Patch applied. Please verify and close.&lt;/p&gt;</comment>
                            <comment id="17447240" author="ma_ke" created="Mon, 22 Nov 2021 08:13:05 +0000"  >&lt;p&gt;A quick test indicates that it should be fixed.&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgoers&quot; class=&quot;user-hover&quot; rel=&quot;rgoers&quot;&gt;rgoers&lt;/a&gt; can you tell me when the patch will be released?&lt;/p&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bwoester&quot; class=&quot;user-hover&quot; rel=&quot;bwoester&quot;&gt;bwoester&lt;/a&gt; Thanks for your help and PR&lt;/p&gt;</comment>
                            <comment id="17447480" author="ralph.goers@dslextreme.com" created="Mon, 22 Nov 2021 15:21:06 +0000"  >&lt;p&gt;It will be included in 2.15.0. I have finished going through the list of pull requests and will be taking a look at the open Jira issues to see if there is any low hanging fruit. I should start the release process in the next few days.&lt;/p&gt;</comment>
                            <comment id="17449010" author="ma_ke" created="Thu, 25 Nov 2021 08:19:11 +0000"  >&lt;p&gt;Ok thanks &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/thumbs_up.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 50 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0vb8g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>