<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:39:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2269] Memory leaking of replacement parameters in case of enableThreadlocals=true</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2269</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Use case:&lt;br/&gt;
1) I have a thread pool with quite large number of threads (around 100)&lt;br/&gt;
2) Threads from the pool sometimes process some heavy objects. Threads are not actively writing into logs (so, a thread may process a task and does not log any message).&lt;br/&gt;
3) As a part of processing for some objects in some non-frequently used branch a thread logged a message with heavy replacement parameters (parameterized log message is used).&lt;/p&gt;

&lt;p&gt;In this case such heavy replacement parameters are not garbage collected until another message will not written within the same thread because thread-local ReusableParameterizedMessage and MutableLogEvent objects keep references to the replacement parameters.&lt;/p&gt;


&lt;p&gt;Is it possible to cleanup such references when a message is released (for example as a part of org.apache.logging.log4j.message.ReusableMessageFactory#release and org.apache.logging.log4j.core.impl.ReusableLogEventFactory#release) to avoid such kind of leaks?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13140567">LOG4J2-2269</key>
            <summary>Memory leaking of replacement parameters in case of enableThreadlocals=true</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rpopma">Remko Popma</assignee>
                                    <reporter username="dnk">Dmitry Konstantinov</reporter>
                        <labels>
                    </labels>
                <created>Fri, 23 Feb 2018 18:08:52 +0000</created>
                <updated>Tue, 5 Feb 2019 20:28:28 +0000</updated>
                            <resolved>Mon, 23 Apr 2018 18:53:38 +0000</resolved>
                                                    <fixVersion>3.0.0</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="16375271" author="remkop@yahoo.com" created="Sat, 24 Feb 2018 03:08:52 +0000"  >&lt;p&gt;I see what you mean. Some cleanup only happens on the next event instead of when the first event is released.&lt;br/&gt;
Can you provide a failing unit test?&lt;/p&gt;</comment>
                            <comment id="16394482" author="dnk" created="Sun, 11 Mar 2018 11:52:44 +0000"  >&lt;p&gt;Please find in attach a code to reproduce the problem -&#160;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12913933/12913933_test_to_reproduce.zip&quot; title=&quot;test_to_reproduce.zip attached to LOG4J2-2269&quot;&gt;test_to_reproduce.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;. It is not pure Unit test, it is quite tricky to reproduce the problem in format of a usual unit test because the observable effects are side ones.&lt;/p&gt;

&lt;p&gt;If we run the test with -Dlog4j2.enableThreadlocals=true (default) we got a result like: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Used heap size: 101 Mb, max heap size: 245 Mb 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;at the end of execution.&lt;br/&gt;
For  -Dlog4j2.enableThreadlocals=false the same test gives:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Used heap size: 3 Mb, max heap size: 245 Mb
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Heap dumps for both cases are also attached to the ticket:  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12913934/12913934_heap_dump_threadLocals_false.hprof.zip&quot; title=&quot;heap_dump_threadLocals_false.hprof.zip attached to LOG4J2-2269&quot;&gt;heap_dump_threadLocals_false.hprof.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; ,  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12913935/12913935_heap_dump_threadLocals_true.hprof.zip&quot; title=&quot;heap_dump_threadLocals_true.hprof.zip attached to LOG4J2-2269&quot;&gt;heap_dump_threadLocals_true.hprof.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;/p&gt;

&lt;p&gt;In heap dump  &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12913935/12913935_heap_dump_threadLocals_true.hprof.zip&quot; title=&quot;heap_dump_threadLocals_true.hprof.zip attached to LOG4J2-2269&quot;&gt;heap_dump_threadLocals_true.hprof.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;  we see that the application level heavy objects (TaskContext) are kept in memory because of log4j2 references in thread locals:&lt;br/&gt;
 &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12913936/12913936_heap_dump_references.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;
</comment>
                            <comment id="16438212" author="githubbot" created="Sat, 14 Apr 2018 03:05:16 +0000"  >&lt;p&gt;GitHub user cakofony opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/165&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/165&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2269&quot; title=&quot;Memory leaking of replacement parameters in case of enableThreadlocals=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2269&quot;&gt;&lt;del&gt;LOG4J2-2269&lt;/del&gt;&lt;/a&gt;: ReusableLogEventFactory.release clears MutableLogEvent&lt;/p&gt;

&lt;p&gt;    Fixes a memory leak where parameter references were held beyond&lt;br/&gt;
    MutableLogEvent usage.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/cakofony/logging-log4j2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/cakofony/logging-log4j2&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2269&quot; title=&quot;Memory leaking of replacement parameters in case of enableThreadlocals=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2269&quot;&gt;&lt;del&gt;LOG4J2-2269&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/165.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/165.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #165&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 4a175be48266704cd1a84365324ae0766d1a5016&lt;br/&gt;
Author: Carter Kozak &amp;lt;ckozak@...&amp;gt;&lt;br/&gt;
Date:   2018-04-14T02:27:54Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2269&quot; title=&quot;Memory leaking of replacement parameters in case of enableThreadlocals=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2269&quot;&gt;&lt;del&gt;LOG4J2-2269&lt;/del&gt;&lt;/a&gt;: ReusableLogEventFactory.release clears MutableLogEvent&lt;/p&gt;

&lt;p&gt;    Fixes a memory leak where parameter references were held beyond&lt;br/&gt;
    MutableLogEvent usage.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16438213" author="ckozak" created="Sat, 14 Apr 2018 03:08:14 +0000"  >&lt;p&gt;I wonder if something along these lines would do the trick?&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/165&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/165&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This issue would affect gc-free non-asynchronous logging (We&apos;re more diligent about clearing async events, and the MutableLogEvent trades its parameter buffer to an event on the ringbuffer when async is enabled).&lt;/p&gt;</comment>
                            <comment id="16448298" author="ckozak" created="Mon, 23 Apr 2018 15:23:41 +0000"  >&lt;p&gt;I&apos;ve written a test to reproduce the issue and added it to the above PR. Planning to merge later today unless you have concerns &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=remkop%40yahoo.com&quot; class=&quot;user-hover&quot; rel=&quot;remkop@yahoo.com&quot;&gt;remkop@yahoo.com&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16448693" author="jira-bot" created="Mon, 23 Apr 2018 18:46:57 +0000"  >&lt;p&gt;Commit b28496e325663f770bc0889d7f5ed2e07505851d in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ckozak&quot; class=&quot;user-hover&quot; rel=&quot;ckozak&quot;&gt;ckozak&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=b28496e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=b28496e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2269&quot; title=&quot;Memory leaking of replacement parameters in case of enableThreadlocals=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2269&quot;&gt;&lt;del&gt;LOG4J2-2269&lt;/del&gt;&lt;/a&gt;: ReusableLogEventFactory.release clears MutableLogEvent&lt;/p&gt;

&lt;p&gt;Fixes a memory leak where parameter references were held beyond&lt;br/&gt;
MutableLogEvent usage.&lt;/p&gt;</comment>
                            <comment id="16448694" author="githubbot" created="Mon, 23 Apr 2018 18:47:23 +0000"  >&lt;p&gt;Github user cakofony commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/165&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/165&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    merged&lt;/p&gt;</comment>
                            <comment id="16448695" author="githubbot" created="Mon, 23 Apr 2018 18:47:23 +0000"  >&lt;p&gt;Github user cakofony closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/165&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/165&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16448705" author="ckozak" created="Mon, 23 Apr 2018 18:53:38 +0000"  >&lt;p&gt;Fix has merged, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dnk&quot; class=&quot;user-hover&quot; rel=&quot;dnk&quot;&gt;dnk&lt;/a&gt; would you like to verify and close out this ticket?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="16449268" author="ralph.goers@dslextreme.com" created="Tue, 24 Apr 2018 04:31:53 +0000"  >&lt;p&gt;Is there a reason the fix wasn&apos;t merged to the release-2.x branch?&lt;/p&gt;</comment>
                            <comment id="16449866" author="jira-bot" created="Tue, 24 Apr 2018 13:40:17 +0000"  >&lt;p&gt;Commit 9496c0c2d7c25257933d523664896920789d6610 in logging-log4j2&apos;s branch refs/heads/release-2.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ckozak&quot; class=&quot;user-hover&quot; rel=&quot;ckozak&quot;&gt;ckozak&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=9496c0c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=9496c0c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2269&quot; title=&quot;Memory leaking of replacement parameters in case of enableThreadlocals=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2269&quot;&gt;&lt;del&gt;LOG4J2-2269&lt;/del&gt;&lt;/a&gt;: ReusableLogEventFactory.release clears MutableLogEvent&lt;/p&gt;

&lt;p&gt;Fixes a memory leak where parameter references were held beyond&lt;br/&gt;
MutableLogEvent usage.&lt;/p&gt;</comment>
                            <comment id="16761125" author="wilkystorm" created="Tue, 5 Feb 2019 19:10:10 +0000"  >&lt;p&gt;Hello, I am not sure if the issue I am seeing is related to this fix or not but I am seeing a behavior change from log4j2 2.11.0 to 2.11.1 which is that the MutableLogEvent.getLoggerName() method returns the name of the Logger that logged the event in 2.11.0 but in 2.11.1 the call returns null.&lt;/p&gt;</comment>
                            <comment id="16761128" author="ckozak" created="Tue, 5 Feb 2019 19:21:25 +0000"  >&lt;p&gt;Are you sure that you&apos;re accessing the event inside of the proper scope? Holding a reference to a reusable event for later would result in that behavior after MutableLogEvent.clear() has been called.&lt;/p&gt;</comment>
                            <comment id="16761144" author="wilkystorm" created="Tue, 5 Feb 2019 19:36:00 +0000"  >&lt;p&gt;Hi Carter,&lt;/p&gt;

&lt;p&gt;Thank you so much for your prompt reply.&lt;/p&gt;

&lt;p&gt;Here is the code that is running in a JUnit test which in log4j2 2.11.0 and&lt;br/&gt;
 below works but in 2.11.1 does not&lt;/p&gt;

&lt;p&gt;ApplicationAuditor.log(AuditTopics.HIPAA, hipaaData);&lt;br/&gt;
 Assert.assertEquals(mockAppender.getLogs().size(), 1);&lt;br/&gt;
 LogEvent event =&lt;br/&gt;
 mockAppender.getLogs().get(0);&lt;br/&gt;
 System.out.println(&quot;!!!!!!!!!!!!!!! event.toString() ==============&lt;br/&gt;
 &quot; + event.toString());&lt;br/&gt;
 System.out.println(&quot;!!!!!!!!!!!!!!! event.getLoggerName()&lt;br/&gt;
 ============== &quot; + event.getLoggerName()); // prints out null in 2.11.1&lt;br/&gt;
 prior versions print logger name&lt;br/&gt;
 Assert.assertEquals(&quot;AuditHIPAA&quot;, event.getLoggerName()); // this&lt;br/&gt;
 line fails because getLoggerName() returns null in 2.11.1&lt;/p&gt;

&lt;p&gt;Here is the logging code in ApplicationAuditor&lt;/p&gt;

&lt;p&gt;public final class ApplicationAuditor {&lt;/p&gt;


&lt;p&gt; private static final String unknown = &quot;UNKNOWN&quot;;&lt;br/&gt;
 private static final String topicHeader = &quot;TOPIC:&quot;;&lt;br/&gt;
 private static final String separator = &quot;&lt;del&gt;SEPARATOR&lt;/del&gt;&quot;;&lt;br/&gt;
 private static final ObjectMapper mapper = new ObjectMapper()&lt;br/&gt;
 .registerModule(new&lt;br/&gt;
 JodaModule())&lt;/p&gt;

&lt;p&gt;.configure(com.fasterxml.jackson.databind.SerializationFeature.WRITE_DATES_AS_TIMESTAMPS,&lt;br/&gt;
 false)&lt;br/&gt;
 .registerModule(new&lt;br/&gt;
 SimpleModule(&quot;ExceptionHandlerModule&quot;).addSerializer(Exception.class,new&lt;br/&gt;
 ExceptionSerializer()));&lt;/p&gt;

&lt;p&gt;private static org.apache.logging.log4j.Logger cachedLogger = null;&lt;/p&gt;

&lt;p&gt;private ApplicationAuditor() {&lt;br/&gt;
 }&lt;/p&gt;

&lt;p&gt;/**&lt;br/&gt;
 *&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;@param topic - Topic for log&lt;/li&gt;
	&lt;li&gt;@param data - The data that you want to log - Error data container&lt;br/&gt;
 is already provided for logging exceptions&lt;/li&gt;
	&lt;li&gt;-If provided containers don&apos;t fit your needs. Inherit&lt;br/&gt;
 from LogData Container and add fields you want.&lt;/li&gt;
	&lt;li&gt;Make sure the data types you use are serializable using&lt;br/&gt;
 Jackson as JSON.&lt;br/&gt;
 */&lt;br/&gt;
 public static void log(Topic topic, LogData data) {&lt;br/&gt;
 try 
{
 if (topic == null || topic.getTopic() == null ||
 topic.getTopic().trim().equals(&quot;&quot;)) \{ topic = AuditTopics.HIPAA; }&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;if (data != null) {&lt;/p&gt;

&lt;p&gt;validateLogData(data);&lt;/p&gt;

&lt;p&gt;if (cachedLogger == null)&lt;/p&gt;

{ cachedLogger = LogManager.getLogger(&quot;AuditHIPAA&quot;); }

&lt;p&gt;System.out.println(&quot;!!!!!!!!!!!!!!!!!!!!!!!!!!!&lt;br/&gt;
 cachedLogger.getName() ============== &quot; + cachedLogger.getName()); // this&lt;br/&gt;
 prints out the proper logger name&lt;br/&gt;
 data.setLoggerName(cachedLogger.getName());&lt;br/&gt;
 String s = topicHeader + topic.getTopic().toLowerCase() +&lt;br/&gt;
 separator + mapper.writeValueAsString(data);&lt;br/&gt;
 cachedLogger.log(Level.INFO, s);&lt;br/&gt;
 }&lt;/p&gt;

&lt;p&gt;} catch (Exception ex)&lt;/p&gt;

{ throw new RuntimeException(ex); }

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;private static void validateLogData(LogData data)&lt;br/&gt;
 {&lt;br/&gt;
 if(data.getUserId() == null || data.getUserId().trim().equals(&quot;&quot;))&lt;/p&gt;

{ data.setUserId(unknown); }

&lt;p&gt;if(data.getApplication() == null || data.getApplication().getName()&lt;br/&gt;
 == null&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; data.getApplication().getName().trim().equals(&quot;&quot;)) { data.setApplication(new ApplicationInfo(unknown,unknown,unknown,null,unknown)); }}&lt;/th&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;Please let me know if you need any further information or if I should&lt;br/&gt;
 possibly open an issue and if I should open an issue, can you please send&lt;br/&gt;
 me the link to where to file an issue?&lt;/p&gt;

&lt;p&gt;Thank you very much for your prompt reply!!!!&lt;/p&gt;

&lt;p&gt;Mike&lt;/p&gt;</comment>
                            <comment id="16761154" author="wilkystorm" created="Tue, 5 Feb 2019 19:50:45 +0000"  >&lt;p&gt;also I apologize as I am struggling to get the code snippets above to format in a more readable format&lt;/p&gt;</comment>
                            <comment id="16761156" author="ckozak" created="Tue, 5 Feb 2019 19:55:53 +0000"  >&lt;p&gt;The problem is that after a MutableLogEvent is written to an appender, it is cleared and reset for reuse. This shouldn&apos;t be an issue in practice, however for the above test you&apos;ll want to Log4jLogEvent.createMemento(event) in the stub appender to capture a snapshot of the event, which may be verified later.&lt;/p&gt;

&lt;p&gt;See ListAppender for an example:&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/logging-log4j2/blob/master/log4j-core/src/test/java/org/apache/logging/log4j/test/appender/ListAppender.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/blob/master/log4j-core/src/test/java/org/apache/logging/log4j/test/appender/ListAppender.java&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16761180" author="wilkystorm" created="Tue, 5 Feb 2019 20:28:28 +0000"  >&lt;p&gt;Thank you so much Carter! I added the createMemento  in the stub appender and that resolved my issue. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12913936" name="heap_dump_references.png" size="460379" author="dnk" created="Sun, 11 Mar 2018 11:49:35 +0000"/>
                            <attachment id="12913934" name="heap_dump_threadLocals_false.hprof.zip" size="1344734" author="dnk" created="Sun, 11 Mar 2018 11:41:45 +0000"/>
                            <attachment id="12913935" name="heap_dump_threadLocals_true.hprof.zip" size="1494358" author="dnk" created="Sun, 11 Mar 2018 11:41:45 +0000"/>
                            <attachment id="12913933" name="test_to_reproduce.zip" size="3190" author="dnk" created="Sun, 11 Mar 2018 11:40:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 41 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3qj9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>