<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:37:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-1608] ServletAppender does not provide throwable object to ServletContext</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-1608</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;The method &lt;tt&gt;org.apache.logging.log4j.web.appender.ServletAppender.append(LogEvent)&lt;/tt&gt; is defined as:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void append(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; LogEvent event) {
        servletContext.log(((AbstractStringLayout) getLayout()).toSerializable(event));
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Instead of:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void append(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; LogEvent event) {
        servletContext.log(((AbstractStringLayout) getLayout()).toSerializable(event), event.getThrown());
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We should use &lt;tt&gt;javax.servlet.ServletContext.log(String, Throwable)&lt;/tt&gt; instead of &lt;tt&gt;javax.servlet.ServletContext.log(String)&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;We do not give the best information we have to the servlet context logging.&lt;/p&gt;

&lt;p&gt;The tricky part is that to avoid logging the exception twice like in our test &lt;tt&gt;org.apache.logging.log4j.web.ServletAppenderTest&lt;/tt&gt;. To avoid the double logging, we could (1) document not using a %exception in the pattern layout.&lt;/p&gt;

&lt;p&gt;That or (yikes) (2) provide a variation of the toSerializable(event) like toSerializable(event, false), where the boolean is an ignoreException parameter. It seems there are plenty of places where exceptions are treated specially already, this would be another.&lt;/p&gt;

&lt;p&gt;I like (1) better because it is simpler.&lt;/p&gt;

&lt;p&gt;In addition the test and documentation should mention the use of &lt;tt&gt;%ex{none&lt;/tt&gt;} to avoid appending exceptions to messages when using the ServletAppender.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13006879">LOG4J2-1608</key>
            <summary>ServletAppender does not provide throwable object to ServletContext</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggregory">Gary D. Gregory</assignee>
                                    <reporter username="ggregory">Gary D. Gregory</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Sep 2016 16:28:34 +0000</created>
                <updated>Fri, 23 Sep 2016 12:31:51 +0000</updated>
                            <resolved>Fri, 23 Sep 2016 12:31:50 +0000</resolved>
                                    <version>2.6.2</version>
                                    <fixVersion>2.7</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15513819" author="garydgregory" created="Thu, 22 Sep 2016 17:05:10 +0000"  >&lt;p&gt;In Git master.&lt;/p&gt;</comment>
                            <comment id="15513874" author="ralph.goers@dslextreme.com" created="Thu, 22 Sep 2016 17:22:29 +0000"  >&lt;p&gt;I don&apos;t believe I agree with this. I don&apos;t understand why it is better to pass the exception to the servletContext since we provide better formatting, Until you can explain what the actual problem is better than &quot;we should...&quot; I am -1 on this commit.&lt;/p&gt;</comment>
                            <comment id="15515618" author="remkop@yahoo.com" created="Fri, 23 Sep 2016 06:54:30 +0000"  >&lt;p&gt;Was this resolved now? (Jira ticket status is still Reopened)&lt;/p&gt;</comment>
                            <comment id="15516318" author="ralph.goers@dslextreme.com" created="Fri, 23 Sep 2016 12:31:51 +0000"  >&lt;p&gt;Yes&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 8 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33ykf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>