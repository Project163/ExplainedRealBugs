<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:40:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2388] Thread indefinitely blocked when logging a message in an interrupted thread</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2388</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Logging a message to the Flume appender in an interrupted thread undefinitely block the thread.&lt;/p&gt;

&lt;p&gt;The thread is blocked in an infinite loop here :&lt;/p&gt;

&lt;p&gt;org.apache.logging.log4j.flume.appender.FlumePersistentManager.&lt;b&gt;send&lt;/b&gt;(Event) :&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; interrupted = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; ieCount = 0;
&lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; {
&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;future&lt;/span&gt;.get();
&#160;&#160;&#160; } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; InterruptedException ie) {
&#160;&#160;&#160;&#160;&#160;&#160;&#160; interrupted = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
&#160;&#160;&#160;&#160;&#160;&#160;&#160; ++ieCount;
&#160;&#160;&#160; }
} &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (interrupted &amp;amp;&amp;amp; ieCount &amp;lt;= 1);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;This test case allows to reproduce the problem (add the code below in FlumePersistentAppenderTest in log4j-flume-ng module):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&#160;&#160; @Test
&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testLogInterrupted() {
&#160;&#160; &#160;&#160;&#160; &#160;ExecutorService executor = Executors.newSingleThreadExecutor();
&#160;&#160;&#160;&#160;&#160;&#160;&#160; executor.execute(() -&amp;gt; {
&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160; &#160;executor.shutdownNow();
&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160; &#160;&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Logger logger = LogManager.getLogger(&lt;span class=&quot;code-quote&quot;&gt;&quot;EventLogger&quot;&lt;/span&gt;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Marker marker = MarkerManager.getMarker(&lt;span class=&quot;code-quote&quot;&gt;&quot;EVENT&quot;&lt;/span&gt;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; logger.info(marker, &lt;span class=&quot;code-quote&quot;&gt;&quot;This is a test message&quot;&lt;/span&gt;);
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; Assert.assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;Interruption status not preserved&quot;&lt;/span&gt;,
&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; &#160;&#160;&#160; &#160;&#160;&#160; &#160;&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.currentThread().isInterrupted());
&#160;&#160;&#160;&#160;&#160;&#160;&#160; });
&#160;&#160;&#160; }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13173586">LOG4J2-2388</key>
            <summary>Thread indefinitely blocked when logging a message in an interrupted thread</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="failled">Failled</reporter>
                        <labels>
                    </labels>
                <created>Sat, 21 Jul 2018 08:44:56 +0000</created>
                <updated>Sat, 21 Jul 2018 23:14:04 +0000</updated>
                            <resolved>Sat, 21 Jul 2018 14:07:33 +0000</resolved>
                                                    <fixVersion>2.11.1</fixVersion>
                    <fixVersion>3.0.0</fixVersion>
                                    <component>Flume Appender</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16551597" author="githubbot" created="Sat, 21 Jul 2018 09:35:46 +0000"  >&lt;p&gt;GitHub user failled opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/196&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/196&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Fix &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2388&quot; title=&quot;Thread indefinitely blocked when logging a message in an interrupted thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2388&quot;&gt;&lt;del&gt;LOG4J2-2388&lt;/del&gt;&lt;/a&gt; / Blocking thread when logging message in an interrup&#8230;&lt;/p&gt;

&lt;p&gt;    &#8230;ted thread&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Fix unfinite loop in org.apache.logging.log4j.flume.appender.FlumePersistentManager.send when the thread is interrupted (Note : The loop has been completely removed since it does not seems to serve any purpose)&lt;/li&gt;
	&lt;li&gt;Preserve Thread interruption status on InterruptedException&lt;/li&gt;
	&lt;li&gt;Add unit test for this case&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/failled/logging-log4j2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/failled/logging-log4j2&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2388&quot; title=&quot;Thread indefinitely blocked when logging a message in an interrupted thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2388&quot;&gt;&lt;del&gt;LOG4J2-2388&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/196.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/196.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #196&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c27a545e52cf68b5503801a50ec5efb13c460e3e&lt;br/&gt;
Author: failled &amp;lt;23032941+failled@...&amp;gt;&lt;br/&gt;
Date:   2018-07-21T09:26:57Z&lt;/p&gt;

&lt;p&gt;    Fix &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2388&quot; title=&quot;Thread indefinitely blocked when logging a message in an interrupted thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2388&quot;&gt;&lt;del&gt;LOG4J2-2388&lt;/del&gt;&lt;/a&gt; / Blocking thread when logging message in an interrupted thread&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="16551694" author="garydgregory" created="Sat, 21 Jul 2018 13:57:12 +0000"  >&lt;p&gt;Dev Note: If you only apply the test part of the patch, running Maven hangs with &lt;tt&gt;mvn clean test -pl log4j-flume-ng&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="16551704" author="garydgregory" created="Sat, 21 Jul 2018 14:05:06 +0000"  >&lt;p&gt;Fixed typos in title and description.&lt;/p&gt;</comment>
                            <comment id="16551705" author="jira-bot" created="Sat, 21 Jul 2018 14:05:38 +0000"  >&lt;p&gt;Commit 12959208f17c6ac570f97a645d32416696e0295e in logging-log4j2&apos;s branch refs/heads/release-2.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=1295920&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=1295920&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2388&quot; title=&quot;Thread indefinitely blocked when logging a message in an interrupted thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2388&quot;&gt;&lt;del&gt;LOG4J2-2388&lt;/del&gt;&lt;/a&gt; Thread indefinitely blocked when logging a message in an&lt;br/&gt;
interrupted thread.&lt;/p&gt;</comment>
                            <comment id="16551706" author="jira-bot" created="Sat, 21 Jul 2018 14:06:30 +0000"  >&lt;p&gt;Commit 91905b891bace4566570105ac6f39e9aafd8a3ae in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=91905b8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=91905b8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2388&quot; title=&quot;Thread indefinitely blocked when logging a message in an interrupted thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2388&quot;&gt;&lt;del&gt;LOG4J2-2388&lt;/del&gt;&lt;/a&gt; Thread indefinitely blocked when logging a message in an&lt;br/&gt;
interrupted thread.&lt;/p&gt;</comment>
                            <comment id="16551708" author="garydgregory" created="Sat, 21 Jul 2018 14:07:33 +0000"  >&lt;p&gt;Thank you for your report and PR.&lt;/p&gt;

&lt;p&gt;Patch applied to git &lt;tt&gt;master&lt;/tt&gt; and &lt;tt&gt;release-2.x&lt;/tt&gt; (without lambdas).&#160;&lt;/p&gt;

&lt;p&gt;Please verify and close this and the PR.&lt;/p&gt;</comment>
                            <comment id="16551710" author="jira-bot" created="Sat, 21 Jul 2018 14:08:36 +0000"  >&lt;p&gt;Commit a630a15d11fbed7e205e9ff59bac1cee62bb5a78 in logging-log4j2&apos;s branch refs/heads/release-2.x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=a630a15&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=a630a15&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2388&quot; title=&quot;Thread indefinitely blocked when logging a message in an interrupted thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2388&quot;&gt;&lt;del&gt;LOG4J2-2388&lt;/del&gt;&lt;/a&gt; Thread indefinitely blocked when logging a message in an&lt;br/&gt;
interrupted thread.&lt;/p&gt;</comment>
                            <comment id="16551711" author="jira-bot" created="Sat, 21 Jul 2018 14:08:57 +0000"  >&lt;p&gt;Commit af332311f4ab021dfdaadf24c1b669ac4a416ac2 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=af33231&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=af33231&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2388&quot; title=&quot;Thread indefinitely blocked when logging a message in an interrupted thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2388&quot;&gt;&lt;del&gt;LOG4J2-2388&lt;/del&gt;&lt;/a&gt; Thread indefinitely blocked when logging a message in an&lt;br/&gt;
interrupted thread.&lt;/p&gt;</comment>
                            <comment id="16551788" author="ralph.goers@dslextreme.com" created="Sat, 21 Jul 2018 17:31:18 +0000"  >&lt;p&gt;Gary - Did you merge from github with &quot;Closes #196&quot;? This PR is still showing as being open with merge conflicts.&lt;/p&gt;</comment>
                            <comment id="16551830" author="failled" created="Sat, 21 Jul 2018 21:37:33 +0000"  >&lt;p&gt;Works for me&lt;/p&gt;

&lt;p&gt;Thanks for the quick merge !&lt;/p&gt;</comment>
                            <comment id="16551831" author="githubbot" created="Sat, 21 Jul 2018 21:38:42 +0000"  >&lt;p&gt;Github user failled commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/196&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/196&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    PR has been merged&lt;/p&gt;</comment>
                            <comment id="16551832" author="githubbot" created="Sat, 21 Jul 2018 21:38:42 +0000"  >&lt;p&gt;Github user failled closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/196&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/196&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16551843" author="garydgregory" created="Sat, 21 Jul 2018 23:14:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ralph.goers%40dslextreme.com&quot; class=&quot;user-hover&quot; rel=&quot;ralph.goers@dslextreme.com&quot;&gt;ralph.goers@dslextreme.com&lt;/a&gt;, I forgot the &quot;closes&quot; comment for githib but the user closed the PR.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 17 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3w4x3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>