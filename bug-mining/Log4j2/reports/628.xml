<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:35:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-999] RollingFileAppender only rotates when time is after rollover time, not on exact match</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-999</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;I have this log4j.xml configuration file: &lt;a href=&quot;http://www.grupoventus.com/download/log4j.xml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.grupoventus.com/download/log4j.xml&lt;/a&gt;  &lt;br/&gt;
Relevant snippet:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;RollingFile name=&lt;span class=&quot;code-quote&quot;&gt;&quot;ACCESS_LOG&quot;&lt;/span&gt; fileName=&lt;span class=&quot;code-quote&quot;&gt;&quot;${sys:log.dir}vproxy_access&quot;&lt;/span&gt;   
      filePattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;${sys:log.dir}vproxy_access.%d{yyyy-MM-dd}&quot;&lt;/span&gt; 
      append=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; immediateFlush=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;
  &amp;lt;PatternLayout&amp;gt;
    &amp;lt;Pattern&amp;gt;%m%d{yyyy-MM-dd HH:mm:ss}%n&amp;lt;/Pattern&amp;gt;
  &amp;lt;/PatternLayout&amp;gt;
  &amp;lt;Policies&amp;gt;
    &amp;lt;TimeBasedTriggeringPolicy/&amp;gt;
  &amp;lt;/Policies&amp;gt;
&amp;lt;/RollingFile&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is an async logger called LOGGER_ACCESS that is using a RollingFileAppender named ACCESS_LOG.&lt;/p&gt;

&lt;p&gt;We have sent an stress test against our application, about 500 simultaneous requests. Every request appends a new line to the current log.&lt;/p&gt;

&lt;p&gt;At 00:00 log file was rotated, and now there are two logs (as expected): vproxy_acccess.2015-04-16 (the older) and vproxy_access (the current from today, day 17).&lt;/p&gt;

&lt;p&gt;But if we take a look to the old log file, we see this. Below the last two lines of my log:&lt;/p&gt;

&lt;p&gt;1,1429221599904,A,56,A,66,A,,190,A,S,5,S,2359,0000,2359,0,N,188.165.133.226,gzip,86,456,93,89,error.0011,2015-04-16 23:59:59&lt;/p&gt;

&lt;p&gt;1,1429221599999,A,56,A,66,A,,190,A,S,5,S,2359,0000,2359,300000,S,,gzip,66342,456,1064,0,ok,2015-04-17 00:00:00&lt;/p&gt;

&lt;p&gt;The first request from 2015-04-17 has been included into the log from day 16. Just the first one, the rest have been correctly appended to the vproxy_access log.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux CentOS 6.7, jdk7.0.57, Tomcat7.0.59&lt;/p&gt;</environment>
        <key id="12823726">LOG4J2-999</key>
            <summary>RollingFileAppender only rotates when time is after rollover time, not on exact match</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rpopma">Remko Popma</assignee>
                                    <reporter username="joan.balaguero">Joan Balaguer&#243;</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Apr 2015 11:45:32 +0000</created>
                <updated>Sat, 24 Oct 2015 19:35:46 +0000</updated>
                            <resolved>Sat, 24 Oct 2015 19:35:46 +0000</resolved>
                                    <version>2.2</version>
                                    <fixVersion>2.5</fixVersion>
                                    <component>Appenders</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14511075" author="ralph.goers@dslextreme.com" created="Fri, 24 Apr 2015 13:42:36 +0000"  >&lt;p&gt;Changed priority. This is not a blocker to a release.&lt;/p&gt;</comment>
                            <comment id="14604061" author="garydgregory" created="Sat, 27 Jun 2015 08:27:40 +0000"  >&lt;p&gt;Removed fix version.&lt;/p&gt;</comment>
                            <comment id="14956131" author="remkop@yahoo.com" created="Wed, 14 Oct 2015 02:02:05 +0000"  >&lt;p&gt;It turns out that this issue is not related to AsyncLoggers, so I am changing the title from &quot;Log4j2 Issue with RollingFileAppender rotation with AsyncLogger&quot; to &quot;RollingFileAppender only rotates when time is after rollover time, not on exact match&quot;&lt;/p&gt;

&lt;p&gt;It turns out that a rollover is only triggered if the event time is &lt;em&gt;larger than&lt;/em&gt; the rollover time (midnight in your case), and does not roll over when the event time is &lt;em&gt;exactly&lt;/em&gt; the rollover time.&lt;/p&gt;

&lt;p&gt;The documentation is a bit vague on when a rollover happens exactly. It says:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;The TimeBasedTriggeringPolicy causes a rollover once the date/time pattern no longer applies to the active file.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think your example is a good argument that the current logic for &lt;tt&gt;TimeBasedTriggeringPolicy.isTriggeringEvent&lt;/tt&gt; should be changed from &lt;tt&gt;event.getTimeMillis() &amp;gt; nextRolloverMillis&lt;/tt&gt; to  &lt;tt&gt;event.getTimeMillis() &amp;gt;= nextRolloverMillis&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="14972829" author="remkop@yahoo.com" created="Sat, 24 Oct 2015 19:35:46 +0000"  >&lt;p&gt;Fixed in master in commit 54dcbf7b.&lt;/p&gt;

&lt;p&gt;Please verify and close.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 4 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2dpov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>