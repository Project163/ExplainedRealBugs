<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:43:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-3339] FilePattern doesn&apos;t rotate correctly when not using a Filename</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-3339</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Note: Probably affects all versions of log4j2, but 2.17, and 2.14.1 I tested&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Quick Description:&lt;/p&gt;

&lt;p&gt;When using a appender with&#160;&lt;b&gt;FilePattern&lt;/b&gt; but &lt;b&gt;without FileName&lt;/b&gt;, then log4j2 eats one of the logs (the one generated on boot), then will always lag behind for 1 timeunit (Depending on the kind of rotation)&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Ex with Minutes rotation:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;First message ocurring on boot&amp;#93;&lt;/span&gt;&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;&lt;tt&gt;&lt;font color=&quot;#57d9a3&quot;&gt;10:49:18,385&lt;/font&gt; - Now writing to ./logs/13/test.&lt;b&gt;1049&lt;/b&gt;.log at 2022-01-13T10:49:18.385+0000&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;&lt;font color=&quot;#ffab00&quot;&gt;10:50:00,007&lt;/font&gt; Log4j2-TF-2-Scheduled-1 DEBUG Rolling ./logs/13/test.1049.log&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;&lt;font color=&quot;#ffab00&quot;&gt;10:50:00,016&lt;/font&gt; Log4j2-TF-2-Scheduled-1 DEBUG GzCompressAction&lt;span class=&quot;error&quot;&gt;&amp;#91;./logs/13/test.1049.log to ./logs/13/test.1049.log.gz, deleteSource=true&amp;#93;&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;&lt;font color=&quot;#ffab00&quot;&gt;10:50:00,019&lt;/font&gt; Now writing to ./logs/13/test.&lt;font color=&quot;#de350b&quot;&gt;&lt;b&gt;1049&lt;/b&gt;&lt;/font&gt;.log at 2022-01-13T&lt;b&gt;10:50:00.019+00&lt;/b&gt;&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;&lt;font color=&quot;#4c9aff&quot;&gt;10:51:00,001&lt;/font&gt; Log4j2-TF-2-Scheduled-3 DEBUG Rolling ./logs/13/test.1049.log&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;&lt;font color=&quot;#4c9aff&quot;&gt;10:51:00,004&lt;/font&gt; Log4j2-TF-2-Scheduled-3 DEBUG RollingFileManager executing async GzCompressAction&lt;span class=&quot;error&quot;&gt;&amp;#91;./logs/13/test.{*}1049{*}.log to ./logs/13/test.{*}1049{*}.log.gz, deleteSource=true&amp;#93;&lt;/span&gt;&lt;/tt&gt;{&lt;tt&gt;}&lt;/tt&gt;{&lt;tt&gt;}&lt;/tt&gt;{&lt;tt&gt;}&lt;/tt&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;We can see that on 4. log4j2 didnt started log 1050.log but recreated &lt;b&gt;1049&lt;/b&gt;.log which will end up deleting the original boot log&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Detected on:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/questions/70695499/log4j2-seems-to-be-lagging-one-time-unit-behind&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/70695499/log4j2-seems-to-be-lagging-one-time-unit-behind&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Ex Configs to replicate issue:&lt;/p&gt;

&lt;p&gt;properties:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 ### Normal log file Configuration
appender.fileRotator.type=RollingFile
appender.fileRotator.name=fileRotator
appender.fileRotator.filePattern=${sys:logs.directory}/$${date:dd}/test.%d{HHmm}.log.gz
appender.fileRotator.layout.type=PatternLayout
appender.fileRotator.layout.pattern=[%-5level] %d{HH:mm:ss.SSS yyyy-MM-dd} | [%t] %c{1} %L |#| %msg%n
appender.fileRotator.policies.type=CronTriggeringPolicy
appender.fileRotator.policies.schedule=0 * * ? * * *
rootLogger.appenderRef.stdout.ref=fileRotator
rootLogger.level=warn
status=debug &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Xml:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;Configuration status=&lt;span class=&quot;code-quote&quot;&gt;&quot;warn&quot;&lt;/span&gt; name=&lt;span class=&quot;code-quote&quot;&gt;&quot;App&quot;&lt;/span&gt; packages=&quot;&quot;&amp;gt;
  &amp;lt;Appenders&amp;gt;
    &amp;lt;RollingFile name=&lt;span class=&quot;code-quote&quot;&gt;&quot;RollingFile&quot;&lt;/span&gt; filePattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;${sys:logs.directory}/$${date:dd}/test.%d{HHmm}.log.gz&quot;&lt;/span&gt;&amp;gt;
      &amp;lt;PatternLayout&amp;gt;
        &amp;lt;Pattern&amp;gt;%d{ISO8601} | %-5.5p | %-8.8t | %-40.40c{1} | %m%n%ex&amp;lt;/Pattern&amp;gt;
      &amp;lt;/PatternLayout&amp;gt;
      &amp;lt;Policies&amp;gt;
        &amp;lt;CronTriggeringPolicy schedule=&lt;span class=&quot;code-quote&quot;&gt;&quot;0 0 * * * ?&quot;&lt;/span&gt;/&amp;gt;
      &amp;lt;/Policies&amp;gt;
    &amp;lt;/RollingFile&amp;gt;
  &amp;lt;/Appenders&amp;gt;
  &amp;lt;Loggers&amp;gt;
    &amp;lt;Root level=&lt;span class=&quot;code-quote&quot;&gt;&quot;info&quot;&lt;/span&gt;&amp;gt;
      &amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;RollingFile&quot;&lt;/span&gt;/&amp;gt;
    &amp;lt;/Root&amp;gt;
  &amp;lt;/Loggers&amp;gt;
&amp;lt;/Configuration&amp;gt; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13422735">LOG4J2-3339</key>
            <summary>FilePattern doesn&apos;t rotate correctly when not using a Filename</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rgoers">Ralph Goers</assignee>
                                    <reporter username="ioliano">Miguel Valente</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 Jan 2022 12:30:05 +0000</created>
                <updated>Wed, 6 Jul 2022 18:07:14 +0000</updated>
                            <resolved>Mon, 27 Jun 2022 06:20:33 +0000</resolved>
                                    <version>2.14.1</version>
                    <version>2.17.0</version>
                                    <fixVersion>2.18.0</fixVersion>
                                    <component>Appenders</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17558990" author="jira-bot" created="Mon, 27 Jun 2022 05:31:49 +0000"  >&lt;p&gt;Commit 161c07664c921ae7a752b23d71e6f56cada805dc in logging-log4j2&apos;s branch refs/heads/release-2.x from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=161c07664c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=161c07664c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3339&quot; title=&quot;FilePattern doesn&amp;#39;t rotate correctly when not using a Filename&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3339&quot;&gt;&lt;del&gt;LOG4J2-3339&lt;/del&gt;&lt;/a&gt; - DirectWriteRolloverStrategy should use the current time when creating files&lt;/p&gt;</comment>
                            <comment id="17558992" author="jira-bot" created="Mon, 27 Jun 2022 05:42:44 +0000"  >&lt;p&gt;Commit 6bd41c98afc1004bd14531b297dd7a88cdbd4f9d in logging-log4j2&apos;s branch refs/heads/master from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=6bd41c98af&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=6bd41c98af&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3339&quot; title=&quot;FilePattern doesn&amp;#39;t rotate correctly when not using a Filename&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3339&quot;&gt;&lt;del&gt;LOG4J2-3339&lt;/del&gt;&lt;/a&gt; - DirectWriteRolloverStrategy should use the current time when creating files&lt;/p&gt;</comment>
                            <comment id="17558998" author="jira-bot" created="Mon, 27 Jun 2022 06:02:52 +0000"  >&lt;p&gt;Commit 161c07664c921ae7a752b23d71e6f56cada805dc in logging-log4j2&apos;s branch refs/heads/dependabot/maven/springVersion-5.3.21 from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=161c07664c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=161c07664c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3339&quot; title=&quot;FilePattern doesn&amp;#39;t rotate correctly when not using a Filename&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3339&quot;&gt;&lt;del&gt;LOG4J2-3339&lt;/del&gt;&lt;/a&gt; - DirectWriteRolloverStrategy should use the current time when creating files&lt;/p&gt;</comment>
                            <comment id="17559002" author="ralph.goers@dslextreme.com" created="Mon, 27 Jun 2022 06:20:33 +0000"  >&lt;p&gt;The fix has been committed to release-2.x and master. Please verify and close.&lt;/p&gt;</comment>
                            <comment id="17559351" author="jira-bot" created="Mon, 27 Jun 2022 19:16:43 +0000"  >&lt;p&gt;Commit 161c07664c921ae7a752b23d71e6f56cada805dc in logging-log4j2&apos;s branch refs/heads/dependabot/maven/org.apache.maven.plugins-maven-pdf-plugin-1.6.0 from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=161c07664c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=161c07664c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3339&quot; title=&quot;FilePattern doesn&amp;#39;t rotate correctly when not using a Filename&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3339&quot;&gt;&lt;del&gt;LOG4J2-3339&lt;/del&gt;&lt;/a&gt; - DirectWriteRolloverStrategy should use the current time when creating files&lt;/p&gt;</comment>
                            <comment id="17559355" author="jira-bot" created="Mon, 27 Jun 2022 19:17:08 +0000"  >&lt;p&gt;Commit 161c07664c921ae7a752b23d71e6f56cada805dc in logging-log4j2&apos;s branch refs/heads/dependabot/maven/org.apache.rat-apache-rat-plugin-0.14 from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=161c07664c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=161c07664c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3339&quot; title=&quot;FilePattern doesn&amp;#39;t rotate correctly when not using a Filename&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3339&quot;&gt;&lt;del&gt;LOG4J2-3339&lt;/del&gt;&lt;/a&gt; - DirectWriteRolloverStrategy should use the current time when creating files&lt;/p&gt;</comment>
                            <comment id="17563369" author="jira-bot" created="Wed, 6 Jul 2022 18:07:14 +0000"  >&lt;p&gt;Commit 161c07664c921ae7a752b23d71e6f56cada805dc in logging-log4j2&apos;s branch refs/heads/dependabot/maven/com.conversantmedia-disruptor-1.2.20 from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=161c07664c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=161c07664c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3339&quot; title=&quot;FilePattern doesn&amp;#39;t rotate correctly when not using a Filename&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3339&quot;&gt;&lt;del&gt;LOG4J2-3339&lt;/del&gt;&lt;/a&gt; - DirectWriteRolloverStrategy should use the current time when creating files&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 19 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ylio:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>