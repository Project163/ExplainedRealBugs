<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:39:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2182] NullPointerException at org.apache.logging.log4j.util.Activator.loadProvider(Activator.java:81) in log4j 2.10.0</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2182</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;I use log4j 2.10.0 in project development, But there is Exception occurs:&lt;/p&gt;

&lt;p&gt;2018-01-11 12:22:13,515 Start Level: Equinox Container: 3a750538-5739-473e-a609-4213b1901911 WARN Problem checking bundle org.apache.logging.log4j.coreconf for Log4j 2 provider. java.lang.NullPointerException&lt;br/&gt;
at org.apache.logging.log4j.util.Activator.loadProvider(Activator.java:81)&lt;br/&gt;
at org.apache.logging.log4j.util.Activator.loadProvider(Activator.java:70)&lt;br/&gt;
at org.apache.logging.log4j.util.Activator.start(Activator.java:113)&lt;br/&gt;
at org.eclipse.osgi.internal.framework.BundleContextImpl$3.run(BundleContextImpl.java:774)&lt;br/&gt;
at org.eclipse.osgi.internal.framework.BundleContextImpl$3.run(BundleContextImpl.java:1)&lt;br/&gt;
at java.security.AccessController.doPrivileged(Native Method)&lt;br/&gt;
at org.eclipse.osgi.internal.framework.BundleContextImpl.startActivator(BundleContextImpl.java:767)&lt;br/&gt;
at org.eclipse.osgi.internal.framework.BundleContextImpl.start(BundleContextImpl.java:724)&lt;br/&gt;
at org.eclipse.osgi.internal.framework.EquinoxBundle.startWorker0(EquinoxBundle.java:932)&lt;br/&gt;
at org.eclipse.osgi.internal.framework.EquinoxBundle$EquinoxModule.startWorker(EquinoxBundle.java:309)&lt;br/&gt;
at org.eclipse.osgi.container.Module.doStart(Module.java:581)&lt;br/&gt;
at org.eclipse.osgi.container.Module.start(Module.java:449)&lt;br/&gt;
at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.incStartLevel(ModuleContainer.java:1620)&lt;br/&gt;
at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.incStartLevel(ModuleContainer.java:1600)&lt;br/&gt;
at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.doContainerStartLevel(ModuleContainer.java:1571)&lt;br/&gt;
at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.dispatchEvent(ModuleContainer.java:1514)&lt;br/&gt;
at org.eclipse.osgi.container.ModuleContainer$ContainerStartLevel.dispatchEvent(ModuleContainer.java:1)&lt;br/&gt;
at org.eclipse.osgi.framework.eventmgr.EventManager.dispatchEvent(EventManager.java:230)&lt;br/&gt;
at org.eclipse.osgi.framework.eventmgr.EventManager$EventThread.run(EventManager.java:340)&lt;/p&gt;

&lt;p&gt;I checked the code, The ERROR occurs in  Activator.class in org.apache.logging.log4j.util in log4j-api-2.10.0.jar:&lt;/p&gt;

&lt;p&gt;77 private void loadProvider(BundleContext context, BundleWiring bundleWiring)&lt;br/&gt;
78 {&lt;br/&gt;
79 + String filter = &quot;(APIVersion&amp;gt;=2.60)&quot;;&lt;br/&gt;
80 + try {&lt;br/&gt;
81 + Collection&amp;lt;ServiceReference&amp;lt;Provider&amp;gt;&amp;gt; serviceReferences = context.getServiceReferences(Provider.class, &quot;(APIVersion&amp;gt;=2.60)&quot;);&lt;br/&gt;
82 + Provider maxProvider = null;&lt;br/&gt;
83 + for (ServiceReference&amp;lt;Provider&amp;gt; serviceReference : serviceReferences) {&lt;br/&gt;
84 + Provider provider = (Provider)context.getService(serviceReference);&lt;br/&gt;
85 + if ((maxProvider == null) || (provider.getPriority().intValue() &amp;gt; maxProvider.getPriority().intValue()))&lt;br/&gt;
86 + &lt;/p&gt;
{  maxProvider = provider; 87 + }

&lt;p&gt;88 + }&lt;br/&gt;
89 + if (maxProvider != null)&lt;br/&gt;
90 + &lt;/p&gt;
{  ProviderUtil.addProvider(maxProvider); 91 + }

&lt;p&gt;92 + }&lt;br/&gt;
93 + catch (InvalidSyntaxException ex)&lt;br/&gt;
94 + &lt;/p&gt;
{ LOGGER.error(&quot;Invalid service filter: (APIVersion&amp;gt;=2.60)&quot;, ex); 95 + }

&lt;p&gt;List&amp;lt;URL&amp;gt; urls = bundleWiring.findEntries(&quot;META-INF&quot;, &quot;log4j-provider.properties&quot;, 0);&lt;br/&gt;
for (URL url : urls)&lt;/p&gt;
{ ProviderUtil.loadProvider(url, bundleWiring.getClassLoader()); }

&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;compared with log4j-api-2.8.jar, we can see the codes marked with &apos;+&apos; are the new added codes in 2.10.0, The Exceptions occur because in line 81, context is null. But checking getBundleContext method in OSGI, we can see getBundleContext could return null if this bundle is not in the STARTING, ACTIVE, or STOPPING states or this bundle is a fragment bundle.&lt;/p&gt;

&lt;p&gt;In my case, bundle org.apache.logging.log4j.coreconf is a fragment bundle. So How to handle fragment in this case and let NullPointerException not ccur. Thanks.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13130172">LOG4J2-2182</key>
            <summary>NullPointerException at org.apache.logging.log4j.util.Activator.loadProvider(Activator.java:81) in log4j 2.10.0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="liwenxian2017">liwenxian2017</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Jan 2018 11:20:12 +0000</created>
                <updated>Fri, 9 Feb 2018 02:12:47 +0000</updated>
                            <resolved>Wed, 24 Jan 2018 05:12:59 +0000</resolved>
                                    <version>2.10.0</version>
                                    <fixVersion>2.11.0</fixVersion>
                                    <component>Boot</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16322070" author="liwenxian2017" created="Thu, 11 Jan 2018 11:23:09 +0000"  >&lt;p&gt;Below is copied from OSGI:&lt;/p&gt;


&lt;p&gt;public BundleContext getBundleContext()&lt;/p&gt;

&lt;p&gt;    Returns this bundle&apos;s BundleContext. The returned BundleContext can be used by the caller to act on behalf of this bundle.&lt;/p&gt;

&lt;p&gt;    If this bundle is not in the STARTING, ACTIVE, or STOPPING states or this bundle is a fragment bundle, then this bundle has no valid BundleContext. This method will return null if this bundle has no valid BundleContext.&lt;/p&gt;

&lt;p&gt;    Returns:&lt;br/&gt;
        A BundleContext for this bundle or null if this bundle has no valid BundleContext. &lt;br/&gt;
    Throws:&lt;br/&gt;
        java.lang.SecurityException - If the caller does not have the appropriate AdminPermission&lt;span class=&quot;error&quot;&gt;&amp;#91;this,CONTEXT&amp;#93;&lt;/span&gt;, and the Java Runtime Environment supports permissions.&lt;br/&gt;
    Since:&lt;br/&gt;
        1.4&lt;/p&gt;


&lt;p&gt;Thanks.&lt;/p&gt;

</comment>
                            <comment id="16333768" author="liwenxian2017" created="Mon, 22 Jan 2018 01:28:25 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Any update on this issue? Thanks.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;/liwenxian&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16333964" author="remkop@yahoo.com" created="Mon, 22 Jan 2018 07:39:25 +0000"  >&lt;p&gt;There are not many people in the Log4j2 community who work with OSGi.&lt;br/&gt;
The best way to get this issue fixed is to provide a patch or pull request with a unit test that demonstrates the issue (and passes after applying your fix).&lt;/p&gt;</comment>
                            <comment id="16336915" author="jira-bot" created="Wed, 24 Jan 2018 05:08:14 +0000"  >&lt;p&gt;Commit 31b390e39eeb0ab653491e29c6b9106304f350f6 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=31b390e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=31b390e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2182&quot; title=&quot;NullPointerException at org.apache.logging.log4j.util.Activator.loadProvider(Activator.java:81) in log4j 2.10.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2182&quot;&gt;&lt;del&gt;LOG4J2-2182&lt;/del&gt;&lt;/a&gt; NullPointerException at&lt;br/&gt;
org.apache.logging.log4j.util.Activator.loadProvider(Activator.java:81)&lt;br/&gt;
in log4j 2.10.0.&lt;/p&gt;</comment>
                            <comment id="16336918" author="garydgregory" created="Wed, 24 Jan 2018 05:12:59 +0000"  >&lt;p&gt;Thank you for your report.&lt;/p&gt;

&lt;p&gt;I&apos;ve updated the API &lt;tt&gt;Activator&lt;/tt&gt; in git master to avoid trying to load providers if a given bundle&apos;s &lt;tt&gt;BundleContext&lt;/tt&gt; is null. Instead, the activator will log a DEBUG event to the Log4j status logger in the form &quot;&lt;tt&gt;Bundle {} has no context (state={}), skipping loading provider&lt;/tt&gt;&quot;&lt;/p&gt;

&lt;p&gt;You can try this by using a 2.10.1-SNAPSHOT build from the Apache Maven Snaphot repository at&#160;&lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16357811" author="liwenxian2017" created="Fri, 9 Feb 2018 01:39:04 +0000"  >&lt;p&gt;Thank you, Gary,&#160; I tested 2.10.1-SNAPSHOT build, it works for me.&#160; And also thank Remko for your information.&lt;/p&gt;</comment>
                            <comment id="16357838" author="garydgregory" created="Fri, 9 Feb 2018 02:12:47 +0000"  >&lt;p&gt;Closing this ticket per&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=liwenxian2017&quot; class=&quot;user-hover&quot; rel=&quot;liwenxian2017&quot;&gt;liwenxian2017&lt;/a&gt;&apos;s comment.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 40 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3oskn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>