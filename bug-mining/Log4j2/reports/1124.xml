<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:39:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2053] Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2053</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Today I updated my fitnesse project to use the 2.9.0 versions of log4-core and log4j-api. Now I am encountering the exception java.nio.charset.UnsupportedCharsetException: cp65001. &lt;/p&gt;

&lt;p&gt;However, my project is running well. Logging seems to work anyway.&lt;/p&gt;

&lt;p&gt;According to Issue 1888, there was a similar bug, which was fixed in 2.9.0: &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-1888&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/LOG4J2-1888&lt;/a&gt;. I commented it, but didn&apos;t get an answer until now.&lt;/p&gt;

&lt;p&gt;I am using ISO-8859-1 on my Eclipse computer to store the files. But the execution environment is plain UTF-8. Therefore I am using those parameters to run my fitnesse project:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;-Dsun.jnu.encoding=UTF8: handed over as JAVA_TOOL_OPTIONS&lt;/li&gt;
	&lt;li&gt;-Dfile.encoding=UTF8: handed over as JAVA_TOOL_OPTIONS&lt;/li&gt;
	&lt;li&gt;chcp 65001: to switch the Windows console encoding to UTF8&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Here is the exception, which is thrown: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;C:\Users\admin\Desktop\RabbitDevInstall\Testtool&amp;gt;java -jar RunRabbitRun-2.0-SNAPSHOT-jar-with-dependencies.jar start ./Resources
Picked up JAVA_TOOL_OPTIONS: -Dsun.jnu.encoding=UTF8 -Dfile.encoding=UTF8 -Ds=0
Unable to get Charset &lt;span class=&quot;code-quote&quot;&gt;&apos;sun.stdout.encoding&apos;&lt;/span&gt;, using &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt; UTF-8
java.nio.charset.UnsupportedCharsetException: cp65001
        at java.nio.charset.Charset.forName(Unknown Source)
        at org.apache.logging.log4j.util.PropertiesUtil.getCharsetProperty(PropertiesUtil.java:172)
        at org.apache.logging.log4j.core.appender.ConsoleAppender$Target.getCharset(ConsoleAppender.java:89)
        at org.apache.logging.log4j.core.appender.ConsoleAppender$Target$1.getDefaultCharset(ConsoleAppender.java:74)
        at org.apache.logging.log4j.core.appender.ConsoleAppender$Builder.build(ConsoleAppender.java:222)
        at org.apache.logging.log4j.core.appender.ConsoleAppender$Builder.build(ConsoleAppender.java:189)
        at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:122)
        at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:958)
        at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:898)
        at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:890)
        at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:513)
        at org.apache.logging.log4j.core.config.AbstractConfiguration.initialize(AbstractConfiguration.java:237)
        at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:249)
        at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:545)
        at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:617)
        at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:634)
        at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:229)
        at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:152)
        at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:45)
        at org.apache.logging.log4j.LogManager.getContext(LogManager.java:194)
        at org.apache.logging.log4j.LogManager.getLogger(LogManager.java:551)
        at de.duerr.fitnesse.RunRabbitRun.&amp;lt;clinit&amp;gt;(RunRabbitRun.java:24)
11:37:19.176 [main] DEBUG de.duerr.fitnesse.RunRabbitRun - Passed over first parameter: start
11:37:19.192 [main] DEBUG de.duerr.fitnesse.RunRabbitRun - Passed over Fitnesse directory: ./Resources
11:37:19.192 [main] DEBUG de.duerr.fitnesse.RunRabbitRun - The parameters handed over to Fitnesse: -d
11:37:19.192 [main] DEBUG de.duerr.fitnesse.RunRabbitRun - The parameters handed over to Fitnesse: ./Resources
11:37:19.192 [main] DEBUG de.duerr.fitnesse.RunRabbitRun - The parameters handed over to Fitnesse: -r
11:37:19.192 [main] DEBUG de.duerr.fitnesse.RunRabbitRun - The parameters handed over to Fitnesse: FitNesseRoot
Sep 20, 2017 11:37:19 AM fitnesse.ConfigurationParameter loadProperties
INFORMATION: No configuration file found (C:\Users\admin\Desktop\RabbitDevInstall\Testtool\Resources\plugins.properties)
Bootstrapping FitNesse, the fully integrated standalone wiki and acceptance testing framework.
root page: fitnesse.wiki.fs.WikiFilePage: FitNesseRoot
logger: none
authenticator: fitnesse.authentication.PromiscuousAuthenticator
page factory: fitnesse.html.template.PageFactory
page theme: bootstrap
Starting FitNesse on port: 80
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here is my log4j configuration file:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Configuration status=&lt;span class=&quot;code-quote&quot;&gt;&quot;WARN&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Appenders&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Console name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Console&quot;&lt;/span&gt; target=&lt;span class=&quot;code-quote&quot;&gt;&quot;SYSTEM_OUT&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;PatternLayout pattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;%d{HH:mm:ss.SSS} [%t] %-5level %logger{36} - %msg%n&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Console&amp;gt;&lt;/span&gt;
    
    &amp;lt;RollingFile name=&lt;span class=&quot;code-quote&quot;&gt;&quot;RollingFile&quot;&lt;/span&gt; fileName=&lt;span class=&quot;code-quote&quot;&gt;&quot;logs/rrr.log&quot;&lt;/span&gt;
                 filePattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;logs/$${date:yyyy-MM}/app-%d{MM-dd-yyyy}-%i.log&quot;&lt;/span&gt;&amp;gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;PatternLayout&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Pattern&amp;gt;&lt;/span&gt;%d %p %c{1.} [%t] %m%n&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Pattern&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/PatternLayout&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Policies&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;TimeBasedTriggeringPolicy /&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;OnStartupTriggeringPolicy /&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;SizeBasedTriggeringPolicy size=&lt;span class=&quot;code-quote&quot;&gt;&quot;20 MB&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Policies&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/RollingFile&amp;gt;&lt;/span&gt;
    
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Appenders&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Loggers&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;Root level=&lt;span class=&quot;code-quote&quot;&gt;&quot;all&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;RollingFile&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;AppenderRef ref=&lt;span class=&quot;code-quote&quot;&gt;&quot;Console&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Root&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Loggers&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/Configuration&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And here is my starting script:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;SET RRR_RESOURCES=.

SET JAVA_TOOL_OPTIONS=-Dsun.jnu.encoding=UTF8 -Dfile.encoding=UTF8 -Ds=0

chcp 65001

java -version

java -XshowSettings

java -jar ${project.artifactId}-${project.version}-jar-with-dependencies.jar start ./Resources

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Windows 10x64 1607 German&lt;br/&gt;
Java JDK 1.8.0_144 (JAVA_TOOL_OPTIONS=-Dsun.jnu.encoding=UTF8 -Dfile.encoding=UTF8 -Ds=0)&lt;br/&gt;
Fitnesse 20161106&lt;br/&gt;
Log4j 2.9.0&lt;br/&gt;
Executing from command line, switching to chcp 65001&lt;/p&gt;</environment>
        <key id="13104223">LOG4J2-2053</key>
            <summary>Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="steudle.f@duerr.de">Frank Steudle</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 Sep 2017 09:00:06 +0000</created>
                <updated>Wed, 11 Oct 2017 15:18:42 +0000</updated>
                            <resolved>Fri, 6 Oct 2017 22:49:43 +0000</resolved>
                                    <version>2.9.0</version>
                    <version>2.9.1</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16191299" author="steudle.f@duerr.de" created="Wed, 4 Oct 2017 14:08:44 +0000"  >&lt;p&gt;Any news on this issue?&lt;/p&gt;</comment>
                            <comment id="16191429" author="jira-bot" created="Wed, 4 Oct 2017 15:27:36 +0000"  >&lt;p&gt;Commit c66cfd853d1f4f87ee91e0997eef07756de73055 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=c66cfd8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=c66cfd8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2053&quot; title=&quot;Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2053&quot;&gt;&lt;del&gt;LOG4J2-2053&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
Exception java.nio.charset.UnsupportedCharsetException: cp65001 in&lt;br/&gt;
2.9.0. Better internal exception message.&lt;/p&gt;</comment>
                            <comment id="16191434" author="garydgregory" created="Wed, 4 Oct 2017 15:31:50 +0000"  >&lt;p&gt;The message emitted by log4j says: &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Unable to get Charset &apos;sun.stdout.encoding&apos;, using default UTF-8&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;ve improved the message in git master to read:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;&quot;Unable to get Charset &apos;cp65001&apos; for property &apos;sun.stdout.encoding&apos;, using default UTF-8 and continuing.&quot;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;When you set the active console&apos;s code page with &lt;tt&gt;chcp&lt;/tt&gt; to &lt;tt&gt;65001&lt;/tt&gt;, Java does not know that this maps to UTF-8. So it tries to use &lt;tt&gt;cp65001&lt;/tt&gt; as the code page and fails since there is no such encoding name standardized. Note that not even the ICU project (&lt;a href=&quot;https://ssl.icu-project.org/icu-bin/convexp?s=WINDOWS&amp;amp;s=ALL&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ssl.icu-project.org/icu-bin/convexp?s=WINDOWS&amp;amp;s=ALL&lt;/a&gt;) maps the name &lt;tt&gt;cp65001&lt;/tt&gt;, but there is mapping in ICU from &lt;tt&gt;windows-65001&lt;/tt&gt; to &lt;tt&gt;UTF-8&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Options today:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;You can ignore this error since Log4j will continue working and use UTF-8 as the default, which happens to match what you want.&lt;/li&gt;
	&lt;li&gt;You can set the system property &lt;tt&gt;sun.stdout.encoding&lt;/tt&gt; to &lt;tt&gt;UTF-8&lt;/tt&gt;.&lt;/li&gt;
	&lt;li&gt;You can set the charset attribute on the layout to whatever charset name you want (but the default charset will still be queried)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The more general solution is to provide some handling for what to do when a user calls &lt;tt&gt;chcp&lt;/tt&gt; to change to an encoding that is both not supported with the encoding name Java gives the chcp value AND UTF-8 is not the right value.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;We could change the query of the default charset to only take place if the layout&apos;s charset is not set. This could be done with a lambda or the equivalent Java 7 hack.&lt;/li&gt;
	&lt;li&gt;We could add a properties file with some default mappings like &lt;tt&gt;cp65001 = UTF-8&lt;/tt&gt; which would be used when an exception is caught calling Charset.forName(). We could then still log the exception but perhaps only at the WARN level.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Thoughts?&lt;/p&gt;</comment>
                            <comment id="16192530" author="steudle.f@duerr.de" created="Thu, 5 Oct 2017 06:56:02 +0000"  >&lt;p&gt;Hi Gary, thank you very much for the great response!&lt;/p&gt;

&lt;p&gt;I welcome your updated exception message. It will help in my situation. &lt;/p&gt;

&lt;p&gt;To suggest a solution for your question about language settings with non-UTF-8 defaults we could do a properties file, which maps those missing code pages mentioned here:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://msdn.microsoft.com/de-de/library/windows/desktop/dd317756(v=vs.85).aspx&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://msdn.microsoft.com/de-de/library/windows/desktop/dd317756(v=vs.85).aspx&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But in a first try, there are not all code pages included in your link:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://ssl.icu-project.org/icu-bin/convexp?s=WINDOWS&amp;amp;s=ALL&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://ssl.icu-project.org/icu-bin/convexp?s=WINDOWS&amp;amp;s=ALL&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;For example there is no mapping for 20420, which is &apos;IBM EBCDIC Arabic&apos; according to Microsoft&apos;s homepage.&lt;/p&gt;

&lt;p&gt;If you are presenting me an initial version of the properties file and you are telling me of how to cope with those exceptions mentioned before (20420), then I will try to complete the properties file by myself and hand it over to you.&lt;/p&gt;

&lt;p&gt;Is this fine?&lt;/p&gt;</comment>
                            <comment id="16195319" author="garydgregory" created="Fri, 6 Oct 2017 22:08:52 +0000"  >&lt;p&gt;Hi.&lt;/p&gt;

&lt;p&gt;The reason I offered the link to the ICU project is that a project could add ICU to its classpath to pick up additional encodings. BUT in this case, using ICU would not help since there is no &quot;cp65001&quot; aliased to &quot;UTF-8&quot; or to &lt;em&gt;any&lt;/em&gt; other encoding. This leads me to suggest a mapping file. We would include such a file in the code jar by default. The file could be overriden by a user by placing his own earlier on the classpath. Or we could come up with a different configuration mechanism. &lt;/p&gt;

&lt;p&gt;I will attach a super simple default file (or maybe put it in the resource folder), which you can feel free to add to through a patch or GitHub... forthcoming...&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="16195376" author="jira-bot" created="Fri, 6 Oct 2017 22:38:20 +0000"  >&lt;p&gt;Commit 6f39fce8ca8ebce2cd0ebef480835ab53a844865 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=6f39fce&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=6f39fce&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2053&quot; title=&quot;Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2053&quot;&gt;&lt;del&gt;LOG4J2-2053&lt;/del&gt;&lt;/a&gt; Exception java.nio.charset.UnsupportedCharsetException:&lt;br/&gt;
cp65001 in 2.9.0. Add some bullet-proofing to low-level error reporting.&lt;/p&gt;</comment>
                            <comment id="16195384" author="jira-bot" created="Fri, 6 Oct 2017 22:41:29 +0000"  >&lt;p&gt;Commit 307257b3d78f8502c3526cbd0b8d41b88c294482 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=307257b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=307257b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2053&quot; title=&quot;Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2053&quot;&gt;&lt;del&gt;LOG4J2-2053&lt;/del&gt;&lt;/a&gt; Exception java.nio.charset.UnsupportedCharsetException:&lt;br/&gt;
cp65001 in 2.9.0. Add another service to low-level error reporting.&lt;/p&gt;</comment>
                            <comment id="16195387" author="jira-bot" created="Fri, 6 Oct 2017 22:47:52 +0000"  >&lt;p&gt;Commit 324606e113edb96f21fe6ae6d32690f1fb6f633f in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=324606e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=324606e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2053&quot; title=&quot;Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2053&quot;&gt;&lt;del&gt;LOG4J2-2053&lt;/del&gt;&lt;/a&gt; Exception java.nio.charset.UnsupportedCharsetException:&lt;br/&gt;
cp65001 in 2.9.0. Add a mapping layer when a charset is not found. Used&lt;br/&gt;
map legacy charset names when you say &quot;chcp 65001&quot; in a console on&lt;br/&gt;
Windows for example.&lt;/p&gt;</comment>
                            <comment id="16195389" author="garydgregory" created="Fri, 6 Oct 2017 22:49:43 +0000"  >&lt;p&gt;I added a file called &lt;tt&gt;log4j-api/src/main/resources/Log4j-charsets.properties&lt;/tt&gt; which currently contains only one mapping:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;cp65001 = UTF-8
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This mapping file is used when a charset is not normally found.&lt;/p&gt;

&lt;p&gt;Please checkout and test git master (which will be a 2.9.2-SNAPSHOT)&lt;/p&gt;

&lt;p&gt;Code reviews welcome!&lt;/p&gt;</comment>
                            <comment id="16195730" author="jira-bot" created="Sat, 7 Oct 2017 14:35:43 +0000"  >&lt;p&gt;Commit 9a9aa1d29126f573e8b10c335b2f8d914c675790 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=9a9aa1d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=9a9aa1d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2053&quot; title=&quot;Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2053&quot;&gt;&lt;del&gt;LOG4J2-2053&lt;/del&gt;&lt;/a&gt; Exception java.nio.charset.UnsupportedCharsetException:&lt;br/&gt;
cp65001 in 2.9.0. Fix tests and a test util.&lt;/p&gt;</comment>
                            <comment id="16195732" author="jira-bot" created="Sat, 7 Oct 2017 14:40:29 +0000"  >&lt;p&gt;Commit 189af79786b329b91b60482682779dd84e84add6 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=189af79&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=189af79&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2053&quot; title=&quot;Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2053&quot;&gt;&lt;del&gt;LOG4J2-2053&lt;/del&gt;&lt;/a&gt; Exception java.nio.charset.UnsupportedCharsetException:&lt;br/&gt;
cp65001 in 2.9.0. Fix tests and a test util.&lt;/p&gt;</comment>
                            <comment id="16195746" author="garydgregory" created="Sat, 7 Oct 2017 15:01:40 +0000"  >&lt;p&gt;FYI: The whole build runs after calling &quot;chcp 65001&quot; on the Windows 10 console with &quot;mvn clean install&quot;&lt;/p&gt;</comment>
                            <comment id="16196826" author="steudle.f@duerr.de" created="Mon, 9 Oct 2017 11:21:10 +0000"  >&lt;p&gt;Thank you for adding the properties file. Currently I am mapping the missing key value pairs for the encodings. Please verify my additions before I continue with my additions:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
cp65001 = UTF-8
cp65000 = UTF-7
cp20127 = US-ASCII
cp54936 = gb18030
cp28592 = ibm-912_P100-1995
cp28593 = ibm-913_P100-2000
cp28594 = ibm-914_P100-1995
cp28595 = ibm-915_P100-1995
cp28596 = ibm-1089_P100-1995
cp28597
cp28598
cp28599
cp28603
cp28605
cp51949
cp720
cp20866
cp21866
cp1250
cp1251
cp1252
cp1253
cp1254
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thank you very much!&lt;/p&gt;</comment>
                            <comment id="16197329" author="jira-bot" created="Mon, 9 Oct 2017 17:16:08 +0000"  >&lt;p&gt;Commit 4457121cec465cf0f738290f2ff3ab1142ad286c in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=4457121&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=4457121&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2053&quot; title=&quot;Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2053&quot;&gt;&lt;del&gt;LOG4J2-2053&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&lt;/p&gt;</comment>
                            <comment id="16197375" author="jira-bot" created="Mon, 9 Oct 2017 17:45:41 +0000"  >&lt;p&gt;Commit 85bc8a50a03278567dfdfe58acf2f31a9211832a in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=85bc8a5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=85bc8a5&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2053&quot; title=&quot;Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2053&quot;&gt;&lt;del&gt;LOG4J2-2053&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&lt;/p&gt;</comment>
                            <comment id="16197391" author="garydgregory" created="Mon, 9 Oct 2017 17:50:15 +0000"  >&lt;p&gt;This mapping is not quite right. Please the current version in git master here: &lt;tt&gt;log4j-api/src/main/resources/Log4j-charsets.properties&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;For example, the charset &lt;tt&gt;ibm-912_P100-1995&lt;/tt&gt; is provided by ICU but the page &lt;a href=&quot;https://msdn.microsoft.com/en-us/en-en/library/windows/desktop/dd317756(v=vs.85).aspx&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://msdn.microsoft.com/en-us/en-en/library/windows/desktop/dd317756(v=vs.85).aspx&lt;/a&gt; maps &lt;tt&gt;28592&lt;/tt&gt; to &lt;tt&gt;iso-8859-2&lt;/tt&gt; which exists in the Oracle JRE. This lets you create the mapping without depending on ICU.&lt;/p&gt;

&lt;p&gt;If you really want to map to UTF-7, then yes, you will need to depend on ICU, in which case, we can consider adding an optional dependency to ICU4J so that tests will pass when testing the default mapping file. Or we can relax the test.&lt;/p&gt;

&lt;p&gt;Also run this test when you update the mapping: &lt;tt&gt;org.apache.logging.log4j.util.Log4jCharsetsPropertiesTest&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;To check if a charset SOME_NAME can be loaded run &lt;tt&gt;org.apache.logging.log4j.util.CharsetForNameMain SOME_NAME&lt;/tt&gt; &lt;/p&gt;

&lt;p&gt;To update the property file, either attach a patch file here in unified diff format. Alternatively, (and better IMO), you can create a PR on GitHub &lt;a href=&quot;https://github.com/apache/log4j&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/log4j&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16198361" author="steudle.f@duerr.de" created="Tue, 10 Oct 2017 08:44:56 +0000"  >&lt;p&gt;Thank you for the corrected result. Currently I am unable to make a Pull Request, because I am fighting with GitHub, git and Eclipse setup. Please mind the attached file instead.&lt;/p&gt;

&lt;p&gt;According to your suggestion, I mapped every entry in accordance to &lt;a href=&quot;https://msdn.microsoft.com/en-us/en-en/library/windows/desktop/dd317756(v=vs.85).aspx&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://msdn.microsoft.com/en-us/en-en/library/windows/desktop/dd317756(v=vs.85).aspx&lt;/a&gt;. After that I searched for a mapping in &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/technotes/guides/intl/encoding.doc.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/8/docs/technotes/guides/intl/encoding.doc.html&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If I get you right, log4j is not referencing ICU yet? I think, that we don&apos;t need the reference to ICU, if it is not already existing. Since Java is not supporting UTF-7 we simply delete it from the preferences list.&lt;/p&gt;

&lt;p&gt;Is this all right?&lt;/p&gt;</comment>
                            <comment id="16198362" author="steudle.f@duerr.de" created="Tue, 10 Oct 2017 08:46:18 +0000"  >&lt;p&gt;Attached the file to previous comment. Please review and add if appropriate.&lt;/p&gt;</comment>
                            <comment id="16199522" author="jira-bot" created="Tue, 10 Oct 2017 22:54:32 +0000"  >&lt;p&gt;Commit 60636bafbb178b2b5e30b54dd7f1575426281583 in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=60636ba&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=60636ba&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2053&quot; title=&quot;Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2053&quot;&gt;&lt;del&gt;LOG4J2-2053&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&lt;/p&gt;</comment>
                            <comment id="16199526" author="garydgregory" created="Tue, 10 Oct 2017 22:58:40 +0000"  >&lt;p&gt;Please run the test org.apache.logging.log4j.util.Log4jCharsetsPropertiesTest before submitting changes. I had to remove many entries that are already mapped. Or, did the test pass for you? If yes, what is you Java vendor and version?&lt;/p&gt;

&lt;p&gt;I tested with Oracle Java 1.7.0_80, Oracle Java 8 (latest), Oracle Java 9, IBM Java 8.&lt;/p&gt;
</comment>
                            <comment id="16199873" author="steudle.f@duerr.de" created="Wed, 11 Oct 2017 06:44:22 +0000"  >&lt;p&gt;Thank you for your endeavours! My runtime is Oracle Java 8u144 on Windows 7 Professional 64 Bit. I haven&apos;t executed the test before, because currently I don&apos;t have the time to accomplish this task. I am new to GitHub and to contribute to Apache projects.&lt;/p&gt;

&lt;p&gt;I mentioned your changes to the file. In my opinion we could leave it like this. &lt;/p&gt;

&lt;p&gt;Would it be a good idea, if we submit a feature to the ICU project? Then they are able to include the missing codepages in their alternatives sections.&lt;/p&gt;</comment>
                            <comment id="16200439" author="jira-bot" created="Wed, 11 Oct 2017 15:18:42 +0000"  >&lt;p&gt;Commit 5f99a5d05254dc81a8c9c649e944f991f94529fa in logging-log4j2&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=5f99a5d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=logging-log4j2.git;h=5f99a5d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2053&quot; title=&quot;Exception java.nio.charset.UnsupportedCharsetException: cp65001 in 2.9.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2053&quot;&gt;&lt;del&gt;LOG4J2-2053&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
Exception java.nio.charset.UnsupportedCharsetException: cp65001 in&lt;br/&gt;
2.9.0. Add another entry.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13066444">LOG4J2-1888</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12891222" name="Log4j-charsets.properties" size="1076" author="steudle.f@duerr.de" created="Tue, 10 Oct 2017 08:45:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 6 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3kek7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>