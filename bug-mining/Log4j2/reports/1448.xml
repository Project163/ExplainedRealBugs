<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:41:42 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-3006] ForkJoinPool common pool is initialized, no option to supply another executor</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-3006</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;After upgrading our application to use Log4J 2.14 we discovered that our thread factory for the ForkJoinPool common pool was not being used.&lt;/p&gt;

&lt;p&gt;After debugging I discovered that this was because we initialize Log4J before we configure the ForkJoinPool. Log4J 2.14 now initializes the&#160;ForkJoinPool common pool via this line in the constructor:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;CompletableFuture.runAsync(ThreadContextDataInjector::initServiceProviders);&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;This was introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2867&quot; title=&quot;ContextDataProvider will cause concurrent threads blocking at the first logging time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2867&quot;&gt;&lt;del&gt;LOG4J2-2867&lt;/del&gt;&lt;/a&gt;. I am not familiar with what initServiceProviders is doing but please consider reverting to the previous behavior by default and providing an option to supply an executor if desired.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13354736">LOG4J2-3006</key>
            <summary>ForkJoinPool common pool is initialized, no option to supply another executor</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jaredwiltshire">Jared Wiltshire</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Jan 2021 18:32:47 +0000</created>
                <updated>Sun, 7 Feb 2021 18:23:05 +0000</updated>
                            <resolved>Sun, 7 Feb 2021 18:23:05 +0000</resolved>
                                    <version>2.14.0</version>
                                    <fixVersion>2.14.1</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17272321" author="jvz" created="Tue, 26 Jan 2021 18:37:00 +0000"  >&lt;p&gt;According to the comments in &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2867&quot; title=&quot;ContextDataProvider will cause concurrent threads blocking at the first logging time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2867&quot;&gt;&lt;del&gt;LOG4J2-2867&lt;/del&gt;&lt;/a&gt;, it sounds like using the common pool wasn&apos;t necessary in the first place. This should be fixed to use its own ForkJoinPool by default at least. If any customization is needed, perhaps a global property to configure which service provider class to use to supply a ForkJoinPool (i.e., another service).&lt;/p&gt;</comment>
                            <comment id="17272325" author="jaredwiltshire" created="Tue, 26 Jan 2021 18:37:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ckozak&quot; class=&quot;user-hover&quot; rel=&quot;ckozak&quot;&gt;ckozak&lt;/a&gt;&#160;actually mentioned this could be an issue in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2867&quot; title=&quot;ContextDataProvider will cause concurrent threads blocking at the first logging time&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2867&quot;&gt;&lt;del&gt;LOG4J2-2867&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The fork-join pool can be difficult to debug, we may want to use our own pool instead.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="17272328" author="jaredwiltshire" created="Tue, 26 Jan 2021 18:39:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mattsicker&quot; class=&quot;user-hover&quot; rel=&quot;mattsicker&quot;&gt;mattsicker&lt;/a&gt;&#160;it may not even need a pool? Just a single thread perhaps? Not sure where else the FJP is being used though.&lt;/p&gt;</comment>
                            <comment id="17272329" author="jvz" created="Tue, 26 Jan 2021 18:39:52 +0000"  >&lt;p&gt;Exactly! And now you&apos;ve provided a great example as to why. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17272331" author="jvz" created="Tue, 26 Jan 2021 18:40:38 +0000"  >&lt;p&gt;There are thread factories and pools and whatnot for various things in Log4j, so if any ForkJoinPool can be combined into the other thread management code, that&apos;d probably help simplify things.&lt;/p&gt;</comment>
                            <comment id="17273124" author="ralph.goers@dslextreme.com" created="Wed, 27 Jan 2021 20:07:24 +0000"  >&lt;p&gt;I don&apos;t think this should be combined with the thread pool used for the configuration scheduler. In this case we just want to start a thread to initialize the service providers asynchronously. It is simply a performance optimization. Just kicking off a thread would work. I had thought using a preallocated thread would be less expensive but if that causes other problems then we don&apos;t need to use the common pool.&lt;/p&gt;</comment>
                            <comment id="17280611" author="jira-bot" created="Sun, 7 Feb 2021 16:43:39 +0000"  >&lt;p&gt;Commit 82d689c920f8cee617da351c18a0c552dd182e87 in logging-log4j2&apos;s branch refs/heads/release-2.x from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=82d689c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=82d689c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3006&quot; title=&quot;ForkJoinPool common pool is initialized, no option to supply another executor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3006&quot;&gt;&lt;del&gt;LOG4J2-3006&lt;/del&gt;&lt;/a&gt; - Directly create a thread instead of using the common ForkJoin pool when initializing ThreadContextDataInjector&lt;/p&gt;</comment>
                            <comment id="17280628" author="jira-bot" created="Sun, 7 Feb 2021 18:22:11 +0000"  >&lt;p&gt;Commit 3482450de877a9e0c1093c45728249a86ff1c7bb in logging-log4j2&apos;s branch refs/heads/master from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=3482450&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=3482450&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3006&quot; title=&quot;ForkJoinPool common pool is initialized, no option to supply another executor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3006&quot;&gt;&lt;del&gt;LOG4J2-3006&lt;/del&gt;&lt;/a&gt; - Directly create a thread instead of using the common ForkJoin pool when initializing ThreadContextDataInjector&lt;/p&gt;</comment>
                            <comment id="17280629" author="ralph.goers@dslextreme.com" created="Sun, 7 Feb 2021 18:23:05 +0000"  >&lt;p&gt;A Thread is now directly created. Please verify and close.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 40 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0n0g8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>