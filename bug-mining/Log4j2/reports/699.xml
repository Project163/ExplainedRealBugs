<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:35:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-920] ClassNotFoundException for BundleContextSelector when initialising in an OSGi environment</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-920</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;When initialising Log4J2 in an Apache Felix environment, I get the following exception: &lt;br/&gt;
ERROR StatusLogger Unable to create context org.apache.logging.log4j.core.osgi.BundleContextSelector java.lang.ClassNotFoundException: org.apache.logging.log4j.core.osgi.BundleContextSelector not found by org.apache.logging.log4j.api &lt;span class=&quot;error&quot;&gt;&amp;#91;78&amp;#93;&lt;/span&gt;&lt;br/&gt;
    at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1556)&lt;br/&gt;
    at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:77)&lt;br/&gt;
    at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1993)&lt;br/&gt;
    at java.lang.ClassLoader.loadClass(ClassLoader.java:357)&lt;br/&gt;
    at java.lang.Class.forName0(Native Method)&lt;br/&gt;
    at java.lang.Class.forName(Class.java:260)&lt;br/&gt;
    at org.apache.logging.log4j.util.LoaderUtil.loadClass(LoaderUtil.java:117)&lt;br/&gt;
    at org.apache.logging.log4j.util.LoaderUtil.newInstanceOf(LoaderUtil.java:136)&lt;br/&gt;
    at org.apache.logging.log4j.util.LoaderUtil.newCheckedInstanceOf(LoaderUtil.java:163)&lt;br/&gt;
    at org.apache.logging.log4j.core.util.Loader.newCheckedInstanceOf(Loader.java:311)&lt;br/&gt;
    at org.apache.logging.log4j.core.impl.Log4jContextFactory.createContextSelector(Log4jContextFactory.java:96)&lt;br/&gt;
    at org.apache.logging.log4j.core.impl.Log4jContextFactory.&amp;lt;init&amp;gt;(Log4jContextFactory.java:54)&lt;br/&gt;
    at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
    at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)&lt;br/&gt;
    at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)&lt;br/&gt;
    at java.lang.reflect.Constructor.newInstance(Constructor.java:408)&lt;br/&gt;
    at java.lang.Class.newInstance(Class.java:438)&lt;br/&gt;
    at org.apache.logging.log4j.LogManager.&amp;lt;clinit&amp;gt;(LogManager.java:96)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Due to a missing import of the org.apache.logging.log4j.core.osgi package in the API OSGi metadata in its pom&lt;/p&gt;</description>
                <environment>&lt;p&gt;Apache Felix, Java 8&lt;/p&gt;</environment>
        <key id="12761163">LOG4J2-920</key>
            <summary>ClassNotFoundException for BundleContextSelector when initialising in an OSGi environment</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mattsicker">Matt Sicker</assignee>
                                    <reporter username="lhochet">Ludovic HOCHET</reporter>
                        <labels>
                    </labels>
                <created>Thu, 11 Dec 2014 21:06:55 +0000</created>
                <updated>Thu, 3 Nov 2016 16:56:22 +0000</updated>
                            <resolved>Tue, 9 Feb 2016 02:29:24 +0000</resolved>
                                    <version>2.1</version>
                                    <fixVersion>2.6</fixVersion>
                                    <component>API</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14243144" author="lhochet" created="Thu, 11 Dec 2014 21:09:33 +0000"  >&lt;p&gt;proposed patch&lt;/p&gt;</comment>
                            <comment id="14561685" author="puce" created="Wed, 27 May 2015 20:42:19 +0000"  >&lt;p&gt;Still affects v2.3&lt;/p&gt;</comment>
                            <comment id="14563879" author="garydgregory" created="Thu, 28 May 2015 23:23:57 +0000"  >&lt;p&gt;This patch looks like is creates a dependency &lt;em&gt;from&lt;/em&gt; &lt;tt&gt;log4j-api&lt;/tt&gt; &lt;em&gt;to&lt;/em&gt; &lt;tt&gt;log4j-core&lt;/tt&gt; which is backwards from the Log4j POV. The Core module depends on the API module. Does that mean the the API module should import all Log4j call sites packages for &lt;tt&gt;LoaderUtil&lt;/tt&gt;?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=remkop%40yahoo.com&quot; class=&quot;user-hover&quot; rel=&quot;remkop@yahoo.com&quot;&gt;remkop@yahoo.com&lt;/a&gt;? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ralphgoers&quot; class=&quot;user-hover&quot; rel=&quot;ralphgoers&quot;&gt;ralphgoers&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="14563931" author="ralph.goers@dslextreme.com" created="Thu, 28 May 2015 23:53:46 +0000"  >&lt;p&gt;I will admit to not being experienced with OSGi, but one of the aspects of the Log4j API is that it allows users to create their own implementation should they desire to. Adding this import seems like it would make that impossible.&lt;/p&gt;</comment>
                            <comment id="14566806" author="lhochet" created="Sun, 31 May 2015 22:43:08 +0000"  >&lt;p&gt;a simple project to reproduce the issue&lt;/p&gt;</comment>
                            <comment id="14566813" author="lhochet" created="Sun, 31 May 2015 22:56:04 +0000"  >&lt;p&gt;patch2 is another proposal that uses DynamicImport (&lt;a href=&quot;http://wiki.osgi.org/wiki/DynamicImport-Package&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.osgi.org/wiki/DynamicImport-Package&lt;/a&gt;) which does not create a dependency. Since LoggerContextFactory&apos;s package is undefined I set the value to *.&lt;/p&gt;</comment>
                            <comment id="14567440" author="garydgregory" created="Mon, 1 Jun 2015 15:34:10 +0000"  >&lt;p&gt;From the OSGi wiki:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Though DynamicImport-Package can be a life saver in certain circumstances it does revert the OSGi Framework to a very expensive class path for the packages involved. With DynamicImport-Package the OSGi Framework must revert to searching the public exported packages to find a match instead of the careful normal calculation. Especially using the wildcard is very harmful. The need for DynamicImport-Package usually is a symptom of a non-modular design.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This does not sound nice.&lt;/p&gt;

&lt;p&gt;I find it hard to believe, as complex as Eclipse is for example, that Log4j presents an architecture that would require us to essentially workaround OSGi&apos;s.&lt;/p&gt;

&lt;p&gt;Surely there must be a better way, or not &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I just cannot dig into it ATM.&lt;/p&gt;</comment>
                            <comment id="14569929" author="puce" created="Tue, 2 Jun 2015 22:51:42 +0000"  >&lt;p&gt;I agree with Gary that DynamicImport is hopefully not the way to go.&lt;/p&gt;

&lt;p&gt;I didn&apos;t have a look at the source code yet, but can someone sum up what causes this issue:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;What does org.apache.logging.log4j.core.osgi.BundleContextSelector do? Why is it needed?&lt;/li&gt;
	&lt;li&gt;Who should instantiate this class? Who should access this class?&lt;/li&gt;
	&lt;li&gt;Why does it look like the API needs to access/ provide this class (org.apache.logging.log4j.core.osgi.BundleContextSelector not found by org.apache.logging.log4j.api )?&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="14650405" author="hanbaj" created="Sat, 1 Aug 2015 15:52:30 +0000"  >&lt;p&gt;There is a correct way to fix this issue and it is not by adding a generic &amp;lt;DynamicImport-Package&amp;gt; field to the pom.xml file.Two lines have to be added to the pom.xml file for the log4j-api OSGi bundle. Basically it is not properly wired up to the log4j-core OSGi bundle (in other words it is not importing the packages needed from log4j-core). The log4j-api pom.xml file has to include these two lines under &amp;lt;Import-Package&amp;gt;&lt;/p&gt;

&lt;p&gt;org.apache.logging.log4j.core.osgi;resolution:=runtime,&lt;br/&gt;
org.apache.logging.log4j.core.lookup;resolution:=runtime,&lt;/p&gt;

&lt;p&gt;So the entire &amp;lt;Import-Package&amp;gt; in the log4j-api pom.xml file looks like this:&lt;/p&gt;

&lt;p&gt;&amp;lt;Import-Package&amp;gt;&lt;br/&gt;
  org.apache.logging.log4j.core.osgi;resolution:=runtime,&lt;br/&gt;
  org.apache.logging.log4j.core.lookup;resolution:=runtime,&lt;br/&gt;
  sun.reflect;resolution:=optional,&lt;br/&gt;
  *&lt;br/&gt;
&amp;lt;/Import-Package&amp;gt;&lt;/p&gt;</comment>
                            <comment id="14650409" author="hanbaj" created="Sat, 1 Aug 2015 15:55:20 +0000"  >&lt;p&gt;The pom.xml file I have attached contains the changes necessary for OSGi to work as I outlined in my comment.&lt;/p&gt;</comment>
                            <comment id="14651076" author="ralph.goers@dslextreme.com" created="Sun, 2 Aug 2015 16:23:40 +0000"  >&lt;p&gt;Is there a test to prove it works?  I don&apos;t like blindly applying patches.&lt;/p&gt;</comment>
                            <comment id="14651194" author="hanbaj" created="Sun, 2 Aug 2015 21:33:08 +0000"  >&lt;p&gt;Running the OSGi Log4J 2.3.0 bundle in Felix OSGi Framework 4.4.1 results in this error as noted in the original bug report.&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
ERROR StatusLogger Unable to create context org.apache.logging.log4j.core.osgi.BundleContextSelector java.lang.ClassNotFoundException: org.apache.logging.log4j.core.osgi.BundleContextSelector not found by org.apache.logging.log4j.api &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1556)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:77)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1993)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(Unknown Source)&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.loadClass(LoaderUtil.java:117)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newInstanceOf(LoaderUtil.java:136)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newCheckedInstanceOf(LoaderUtil.java:163)&lt;br/&gt;
	at org.apache.logging.log4j.core.util.Loader.newCheckedInstanceOf(Loader.java:311)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.createContextSelector(Log4jContextFactory.java:96)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.&amp;lt;init&amp;gt;(Log4jContextFactory.java:54)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.&amp;lt;clinit&amp;gt;(LogManager.java:96)&lt;br/&gt;
	at com.ge.ip.systemtest2.osgi.example.Activator.&amp;lt;clinit&amp;gt;(Activator.java:18)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.felix.framework.Felix.createBundleActivator(Felix.java:4362)&lt;br/&gt;
	at org.apache.felix.framework.Felix.activateBundle(Felix.java:2149)&lt;br/&gt;
	at org.apache.felix.framework.Felix.startBundle(Felix.java:2072)&lt;br/&gt;
	at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:976)&lt;br/&gt;
	at aQute.launcher.Launcher.update(Launcher.java:436)&lt;br/&gt;
	at aQute.launcher.Launcher.activate(Launcher.java:349)&lt;br/&gt;
	at aQute.launcher.Launcher.run(Launcher.java:238)&lt;br/&gt;
	at aQute.launcher.Launcher.main(Launcher.java:87)&lt;/p&gt;

&lt;p&gt;ERROR StatusLogger Unable to create context org.apache.logging.log4j.core.osgi.BundleContextSelector java.lang.ClassNotFoundException: org.apache.logging.log4j.core.osgi.BundleContextSelector not found by org.apache.logging.log4j.api &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1556)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:77)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1993)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(Unknown Source)&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.loadClass(LoaderUtil.java:117)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newInstanceOf(LoaderUtil.java:136)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newCheckedInstanceOf(LoaderUtil.java:163)&lt;br/&gt;
	at org.apache.logging.log4j.core.util.Loader.newCheckedInstanceOf(Loader.java:311)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.createContextSelector(Log4jContextFactory.java:96)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.&amp;lt;init&amp;gt;(Log4jContextFactory.java:54)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.&amp;lt;clinit&amp;gt;(LogManager.java:96)&lt;br/&gt;
	at com.ge.ip.systemtest2.osgi.example.Activator.&amp;lt;clinit&amp;gt;(Activator.java:18)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.felix.framework.Felix.createBundleActivator(Felix.java:4362)&lt;br/&gt;
	at org.apache.felix.framework.Felix.activateBundle(Felix.java:2149)&lt;br/&gt;
	at org.apache.felix.framework.Felix.startBundle(Felix.java:2072)&lt;br/&gt;
	at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:976)&lt;br/&gt;
	at aQute.launcher.Launcher.update(Launcher.java:436)&lt;br/&gt;
	at aQute.launcher.Launcher.activate(Launcher.java:349)&lt;br/&gt;
	at aQute.launcher.Launcher.run(Launcher.java:238)&lt;br/&gt;
	at aQute.launcher.Launcher.main(Launcher.java:87)&lt;/p&gt;

&lt;p&gt;2015-08-02 15:57:21,251 WARN JNDI lookup class is not available because this JRE does not support JNDI. JNDI string lookups will not be available, continuing configuration. java.lang.ClassNotFoundException: org.apache.logging.log4j.core.lookup.JndiLookup not found by org.apache.logging.log4j.api &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1556)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:77)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1993)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(Unknown Source)&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.loadClass(LoaderUtil.java:117)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newInstanceOf(LoaderUtil.java:136)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newCheckedInstanceOf(LoaderUtil.java:163)&lt;br/&gt;
	at org.apache.logging.log4j.core.util.Loader.newCheckedInstanceOf(Loader.java:311)&lt;br/&gt;
	at org.apache.logging.log4j.core.lookup.Interpolator.&amp;lt;init&amp;gt;(Interpolator.java:92)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.&amp;lt;init&amp;gt;(AbstractConfiguration.java:104)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.DefaultConfiguration.&amp;lt;init&amp;gt;(DefaultConfiguration.java:55)&lt;br/&gt;
	at org.apache.logging.log4j.core.layout.PatternLayout$Builder.build(PatternLayout.java:374)&lt;br/&gt;
	at org.apache.logging.log4j.core.layout.PatternLayout.createDefaultLayout(PatternLayout.java:279)&lt;br/&gt;
	at org.apache.logging.log4j.core.appender.ConsoleAppender$Builder.&amp;lt;init&amp;gt;(ConsoleAppender.java:119)&lt;br/&gt;
	at org.apache.logging.log4j.core.appender.ConsoleAppender.newBuilder(ConsoleAppender.java:114)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.createBuilder(PluginBuilder.java:160)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:120)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:766)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:706)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:698)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:358)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:161)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:361)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:426)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:442)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:138)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:147)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:41)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.getContext(LogManager.java:175)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.getLogger(LogManager.java:426)&lt;br/&gt;
	at com.ge.ip.systemtest2.osgi.example.Activator.&amp;lt;clinit&amp;gt;(Activator.java:18)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.felix.framework.Felix.createBundleActivator(Felix.java:4362)&lt;br/&gt;
	at org.apache.felix.framework.Felix.activateBundle(Felix.java:2149)&lt;br/&gt;
	at org.apache.felix.framework.Felix.startBundle(Felix.java:2072)&lt;br/&gt;
	at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:976)&lt;br/&gt;
	at aQute.launcher.Launcher.update(Launcher.java:436)&lt;br/&gt;
	at aQute.launcher.Launcher.activate(Launcher.java:349)&lt;br/&gt;
	at aQute.launcher.Launcher.run(Launcher.java:238)&lt;br/&gt;
	at aQute.launcher.Launcher.main(Launcher.java:87)&lt;/p&gt;

&lt;p&gt;2015-08-02 15:57:21,254 WARN JMX runtime input lookup class is not available because this JRE does not support JMX. JMX lookups will not be available, continuing configuration. java.lang.ClassNotFoundException: org.apache.logging.log4j.core.lookup.JmxRuntimeInputArgumentsLookup not found by org.apache.logging.log4j.api &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1556)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:77)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1993)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(Unknown Source)&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.loadClass(LoaderUtil.java:117)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newInstanceOf(LoaderUtil.java:136)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newCheckedInstanceOf(LoaderUtil.java:163)&lt;br/&gt;
	at org.apache.logging.log4j.core.util.Loader.newCheckedInstanceOf(Loader.java:311)&lt;br/&gt;
	at org.apache.logging.log4j.core.lookup.Interpolator.&amp;lt;init&amp;gt;(Interpolator.java:103)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.&amp;lt;init&amp;gt;(AbstractConfiguration.java:104)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.DefaultConfiguration.&amp;lt;init&amp;gt;(DefaultConfiguration.java:55)&lt;br/&gt;
	at org.apache.logging.log4j.core.layout.PatternLayout$Builder.build(PatternLayout.java:374)&lt;br/&gt;
	at org.apache.logging.log4j.core.layout.PatternLayout.createDefaultLayout(PatternLayout.java:279)&lt;br/&gt;
	at org.apache.logging.log4j.core.appender.ConsoleAppender$Builder.&amp;lt;init&amp;gt;(ConsoleAppender.java:119)&lt;br/&gt;
	at org.apache.logging.log4j.core.appender.ConsoleAppender.newBuilder(ConsoleAppender.java:114)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.createBuilder(PluginBuilder.java:160)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:120)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:766)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:706)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:698)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:358)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:161)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:361)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:426)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:442)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:138)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:147)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:41)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.getContext(LogManager.java:175)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.getLogger(LogManager.java:426)&lt;br/&gt;
	at com.ge.ip.systemtest2.osgi.example.Activator.&amp;lt;clinit&amp;gt;(Activator.java:18)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.felix.framework.Felix.createBundleActivator(Felix.java:4362)&lt;br/&gt;
	at org.apache.felix.framework.Felix.activateBundle(Felix.java:2149)&lt;br/&gt;
	at org.apache.felix.framework.Felix.startBundle(Felix.java:2072)&lt;br/&gt;
	at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:976)&lt;br/&gt;
	at aQute.launcher.Launcher.update(Launcher.java:436)&lt;br/&gt;
	at aQute.launcher.Launcher.activate(Launcher.java:349)&lt;br/&gt;
	at aQute.launcher.Launcher.run(Launcher.java:238)&lt;br/&gt;
	at aQute.launcher.Launcher.main(Launcher.java:87)&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
Adjusting the pom.xml file in the log4j-api bundle to contain the following OSGi section addresses the above exceptions. What&apos;s clearly missing from the original pom.xml is the OSGi specification to import the Log4J OSGi package, which is the reason for the ClassNotFoundException. It&apos;s simply not being imported, so the class is not found. The third exception listed above relates to a ClassNotFoundException for class org.apache.logging.log4j.core.lookup.JndiLookup. Again, the lookup package is simply not being imported, so the class is not found. The addition of these two lines under the Import-Package section in the log4j-api pom.xml file clearly addresses these two exceptions.&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
&amp;lt;plugin&amp;gt;&lt;br/&gt;
        &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;&lt;br/&gt;
        &amp;lt;artifactId&amp;gt;maven-bundle-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
        &amp;lt;configuration&amp;gt;&lt;br/&gt;
          &amp;lt;instructions&amp;gt;&lt;br/&gt;
            &amp;lt;Export-Package&amp;gt;org.apache.logging.log4j.*&amp;lt;/Export-Package&amp;gt;&lt;br/&gt;
            &amp;lt;Import-Package&amp;gt;&lt;br/&gt;
			  org.apache.logging.log4j.core.osgi;resolution:=runtime,&lt;br/&gt;
			  org.apache.logging.log4j.core.lookup;resolution:=runtime,&lt;br/&gt;
              sun.reflect;resolution:=optional,&lt;br/&gt;
              *&lt;br/&gt;
            &amp;lt;/Import-Package&amp;gt;&lt;br/&gt;
            &amp;lt;Bundle-Activator&amp;gt;org.apache.logging.log4j.util.Activator&amp;lt;/Bundle-Activator&amp;gt;&lt;br/&gt;
          &amp;lt;/instructions&amp;gt;&lt;br/&gt;
        &amp;lt;/configuration&amp;gt;&lt;br/&gt;
      &amp;lt;/plugin&amp;gt;&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
As shown below, after log4j-api has been rebuilt with the Import-Package corrections to the pom.xml file, Log4J clearly works without exceptions.&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
16:21:50.677 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  Hello World!&lt;/p&gt;</comment>
                            <comment id="14651195" author="hanbaj" created="Sun, 2 Aug 2015 21:33:08 +0000"  >&lt;p&gt;Running the OSGi Log4J 2.3.0 bundle in Felix OSGi Framework 4.4.1 results in this error as noted in the original bug report.&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
ERROR StatusLogger Unable to create context org.apache.logging.log4j.core.osgi.BundleContextSelector java.lang.ClassNotFoundException: org.apache.logging.log4j.core.osgi.BundleContextSelector not found by org.apache.logging.log4j.api &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1556)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:77)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1993)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(Unknown Source)&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.loadClass(LoaderUtil.java:117)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newInstanceOf(LoaderUtil.java:136)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newCheckedInstanceOf(LoaderUtil.java:163)&lt;br/&gt;
	at org.apache.logging.log4j.core.util.Loader.newCheckedInstanceOf(Loader.java:311)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.createContextSelector(Log4jContextFactory.java:96)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.&amp;lt;init&amp;gt;(Log4jContextFactory.java:54)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.&amp;lt;clinit&amp;gt;(LogManager.java:96)&lt;br/&gt;
	at com.ge.ip.systemtest2.osgi.example.Activator.&amp;lt;clinit&amp;gt;(Activator.java:18)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.felix.framework.Felix.createBundleActivator(Felix.java:4362)&lt;br/&gt;
	at org.apache.felix.framework.Felix.activateBundle(Felix.java:2149)&lt;br/&gt;
	at org.apache.felix.framework.Felix.startBundle(Felix.java:2072)&lt;br/&gt;
	at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:976)&lt;br/&gt;
	at aQute.launcher.Launcher.update(Launcher.java:436)&lt;br/&gt;
	at aQute.launcher.Launcher.activate(Launcher.java:349)&lt;br/&gt;
	at aQute.launcher.Launcher.run(Launcher.java:238)&lt;br/&gt;
	at aQute.launcher.Launcher.main(Launcher.java:87)&lt;/p&gt;

&lt;p&gt;ERROR StatusLogger Unable to create context org.apache.logging.log4j.core.osgi.BundleContextSelector java.lang.ClassNotFoundException: org.apache.logging.log4j.core.osgi.BundleContextSelector not found by org.apache.logging.log4j.api &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1556)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:77)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1993)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(Unknown Source)&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.loadClass(LoaderUtil.java:117)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newInstanceOf(LoaderUtil.java:136)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newCheckedInstanceOf(LoaderUtil.java:163)&lt;br/&gt;
	at org.apache.logging.log4j.core.util.Loader.newCheckedInstanceOf(Loader.java:311)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.createContextSelector(Log4jContextFactory.java:96)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.&amp;lt;init&amp;gt;(Log4jContextFactory.java:54)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.&amp;lt;clinit&amp;gt;(LogManager.java:96)&lt;br/&gt;
	at com.ge.ip.systemtest2.osgi.example.Activator.&amp;lt;clinit&amp;gt;(Activator.java:18)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.felix.framework.Felix.createBundleActivator(Felix.java:4362)&lt;br/&gt;
	at org.apache.felix.framework.Felix.activateBundle(Felix.java:2149)&lt;br/&gt;
	at org.apache.felix.framework.Felix.startBundle(Felix.java:2072)&lt;br/&gt;
	at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:976)&lt;br/&gt;
	at aQute.launcher.Launcher.update(Launcher.java:436)&lt;br/&gt;
	at aQute.launcher.Launcher.activate(Launcher.java:349)&lt;br/&gt;
	at aQute.launcher.Launcher.run(Launcher.java:238)&lt;br/&gt;
	at aQute.launcher.Launcher.main(Launcher.java:87)&lt;/p&gt;

&lt;p&gt;2015-08-02 15:57:21,251 WARN JNDI lookup class is not available because this JRE does not support JNDI. JNDI string lookups will not be available, continuing configuration. java.lang.ClassNotFoundException: org.apache.logging.log4j.core.lookup.JndiLookup not found by org.apache.logging.log4j.api &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1556)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:77)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1993)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(Unknown Source)&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.loadClass(LoaderUtil.java:117)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newInstanceOf(LoaderUtil.java:136)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newCheckedInstanceOf(LoaderUtil.java:163)&lt;br/&gt;
	at org.apache.logging.log4j.core.util.Loader.newCheckedInstanceOf(Loader.java:311)&lt;br/&gt;
	at org.apache.logging.log4j.core.lookup.Interpolator.&amp;lt;init&amp;gt;(Interpolator.java:92)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.&amp;lt;init&amp;gt;(AbstractConfiguration.java:104)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.DefaultConfiguration.&amp;lt;init&amp;gt;(DefaultConfiguration.java:55)&lt;br/&gt;
	at org.apache.logging.log4j.core.layout.PatternLayout$Builder.build(PatternLayout.java:374)&lt;br/&gt;
	at org.apache.logging.log4j.core.layout.PatternLayout.createDefaultLayout(PatternLayout.java:279)&lt;br/&gt;
	at org.apache.logging.log4j.core.appender.ConsoleAppender$Builder.&amp;lt;init&amp;gt;(ConsoleAppender.java:119)&lt;br/&gt;
	at org.apache.logging.log4j.core.appender.ConsoleAppender.newBuilder(ConsoleAppender.java:114)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.createBuilder(PluginBuilder.java:160)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:120)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:766)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:706)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:698)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:358)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:161)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:361)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:426)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:442)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:138)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:147)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:41)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.getContext(LogManager.java:175)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.getLogger(LogManager.java:426)&lt;br/&gt;
	at com.ge.ip.systemtest2.osgi.example.Activator.&amp;lt;clinit&amp;gt;(Activator.java:18)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.felix.framework.Felix.createBundleActivator(Felix.java:4362)&lt;br/&gt;
	at org.apache.felix.framework.Felix.activateBundle(Felix.java:2149)&lt;br/&gt;
	at org.apache.felix.framework.Felix.startBundle(Felix.java:2072)&lt;br/&gt;
	at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:976)&lt;br/&gt;
	at aQute.launcher.Launcher.update(Launcher.java:436)&lt;br/&gt;
	at aQute.launcher.Launcher.activate(Launcher.java:349)&lt;br/&gt;
	at aQute.launcher.Launcher.run(Launcher.java:238)&lt;br/&gt;
	at aQute.launcher.Launcher.main(Launcher.java:87)&lt;/p&gt;

&lt;p&gt;2015-08-02 15:57:21,254 WARN JMX runtime input lookup class is not available because this JRE does not support JMX. JMX lookups will not be available, continuing configuration. java.lang.ClassNotFoundException: org.apache.logging.log4j.core.lookup.JmxRuntimeInputArgumentsLookup not found by org.apache.logging.log4j.api &lt;span class=&quot;error&quot;&gt;&amp;#91;3&amp;#93;&lt;/span&gt;&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.findClassOrResourceByDelegation(BundleWiringImpl.java:1556)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl.access$400(BundleWiringImpl.java:77)&lt;br/&gt;
	at org.apache.felix.framework.BundleWiringImpl$BundleClassLoader.loadClass(BundleWiringImpl.java:1993)&lt;br/&gt;
	at java.lang.ClassLoader.loadClass(Unknown Source)&lt;br/&gt;
	at java.lang.Class.forName0(Native Method)&lt;br/&gt;
	at java.lang.Class.forName(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.loadClass(LoaderUtil.java:117)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newInstanceOf(LoaderUtil.java:136)&lt;br/&gt;
	at org.apache.logging.log4j.util.LoaderUtil.newCheckedInstanceOf(LoaderUtil.java:163)&lt;br/&gt;
	at org.apache.logging.log4j.core.util.Loader.newCheckedInstanceOf(Loader.java:311)&lt;br/&gt;
	at org.apache.logging.log4j.core.lookup.Interpolator.&amp;lt;init&amp;gt;(Interpolator.java:103)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.&amp;lt;init&amp;gt;(AbstractConfiguration.java:104)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.DefaultConfiguration.&amp;lt;init&amp;gt;(DefaultConfiguration.java:55)&lt;br/&gt;
	at org.apache.logging.log4j.core.layout.PatternLayout$Builder.build(PatternLayout.java:374)&lt;br/&gt;
	at org.apache.logging.log4j.core.layout.PatternLayout.createDefaultLayout(PatternLayout.java:279)&lt;br/&gt;
	at org.apache.logging.log4j.core.appender.ConsoleAppender$Builder.&amp;lt;init&amp;gt;(ConsoleAppender.java:119)&lt;br/&gt;
	at org.apache.logging.log4j.core.appender.ConsoleAppender.newBuilder(ConsoleAppender.java:114)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Method.invoke(Unknown Source)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.createBuilder(PluginBuilder.java:160)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.plugins.util.PluginBuilder.build(PluginBuilder.java:120)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createPluginObject(AbstractConfiguration.java:766)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:706)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.createConfiguration(AbstractConfiguration.java:698)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.doConfigure(AbstractConfiguration.java:358)&lt;br/&gt;
	at org.apache.logging.log4j.core.config.AbstractConfiguration.start(AbstractConfiguration.java:161)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.setConfiguration(LoggerContext.java:361)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:426)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.reconfigure(LoggerContext.java:442)&lt;br/&gt;
	at org.apache.logging.log4j.core.LoggerContext.start(LoggerContext.java:138)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:147)&lt;br/&gt;
	at org.apache.logging.log4j.core.impl.Log4jContextFactory.getContext(Log4jContextFactory.java:41)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.getContext(LogManager.java:175)&lt;br/&gt;
	at org.apache.logging.log4j.LogManager.getLogger(LogManager.java:426)&lt;br/&gt;
	at com.ge.ip.systemtest2.osgi.example.Activator.&amp;lt;clinit&amp;gt;(Activator.java:18)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.reflect.Constructor.newInstance(Unknown Source)&lt;br/&gt;
	at java.lang.Class.newInstance(Unknown Source)&lt;br/&gt;
	at org.apache.felix.framework.Felix.createBundleActivator(Felix.java:4362)&lt;br/&gt;
	at org.apache.felix.framework.Felix.activateBundle(Felix.java:2149)&lt;br/&gt;
	at org.apache.felix.framework.Felix.startBundle(Felix.java:2072)&lt;br/&gt;
	at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:976)&lt;br/&gt;
	at aQute.launcher.Launcher.update(Launcher.java:436)&lt;br/&gt;
	at aQute.launcher.Launcher.activate(Launcher.java:349)&lt;br/&gt;
	at aQute.launcher.Launcher.run(Launcher.java:238)&lt;br/&gt;
	at aQute.launcher.Launcher.main(Launcher.java:87)&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
Adjusting the pom.xml file in the log4j-api bundle to contain the following OSGi section addresses the above exceptions. What&apos;s clearly missing from the original pom.xml is the OSGi specification to import the Log4J OSGi package, which is the reason for the ClassNotFoundException. It&apos;s simply not being imported, so the class is not found. The third exception listed above relates to a ClassNotFoundException for class org.apache.logging.log4j.core.lookup.JndiLookup. Again, the lookup package is simply not being imported, so the class is not found. The addition of these two lines under the Import-Package section in the log4j-api pom.xml file clearly addresses these two exceptions.&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
&amp;lt;plugin&amp;gt;&lt;br/&gt;
        &amp;lt;groupId&amp;gt;org.apache.felix&amp;lt;/groupId&amp;gt;&lt;br/&gt;
        &amp;lt;artifactId&amp;gt;maven-bundle-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
        &amp;lt;configuration&amp;gt;&lt;br/&gt;
          &amp;lt;instructions&amp;gt;&lt;br/&gt;
            &amp;lt;Export-Package&amp;gt;org.apache.logging.log4j.*&amp;lt;/Export-Package&amp;gt;&lt;br/&gt;
            &amp;lt;Import-Package&amp;gt;&lt;br/&gt;
			  org.apache.logging.log4j.core.osgi;resolution:=runtime,&lt;br/&gt;
			  org.apache.logging.log4j.core.lookup;resolution:=runtime,&lt;br/&gt;
              sun.reflect;resolution:=optional,&lt;br/&gt;
              *&lt;br/&gt;
            &amp;lt;/Import-Package&amp;gt;&lt;br/&gt;
            &amp;lt;Bundle-Activator&amp;gt;org.apache.logging.log4j.util.Activator&amp;lt;/Bundle-Activator&amp;gt;&lt;br/&gt;
          &amp;lt;/instructions&amp;gt;&lt;br/&gt;
        &amp;lt;/configuration&amp;gt;&lt;br/&gt;
      &amp;lt;/plugin&amp;gt;&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
As shown below, after log4j-api has been rebuilt with the Import-Package corrections to the pom.xml file, Log4J clearly works without exceptions.&lt;br/&gt;
--------------------------------------------------------------------------------&lt;br/&gt;
16:21:50.677 &lt;span class=&quot;error&quot;&gt;&amp;#91;main&amp;#93;&lt;/span&gt; INFO  Hello World!&lt;/p&gt;</comment>
                            <comment id="14651274" author="ralph.goers@dslextreme.com" created="Sun, 2 Aug 2015 23:33:46 +0000"  >&lt;p&gt;Sorry, I should have said unit test. Can you provide something similar to the test above that fails but succeeds when the changes are made to the pom.xml?  The test should be part of one of the log4j modules so it runs with every build.&lt;/p&gt;</comment>
                            <comment id="14708527" author="lhochet" created="Sun, 23 Aug 2015 20:20:25 +0000"  >&lt;p&gt;patch3 is an attempt at providing a &apos;unit&apos; test for this issue.&lt;br/&gt;
It builds on the existing, but skipped, OSGi tests in log4j-api.&lt;/p&gt;

&lt;p&gt;In order to reenable the OSGi tests, the following changes where needed:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;in log4j-api/pom.xml, the org.apache.felix.framework dependency had to be moved before the org.osgi.core dependency as otherwise the classes from the later were used causing class errors.&lt;/li&gt;
	&lt;li&gt;in log4j-api/src/test/java/org/apache/logging/log4j/osgi/BundleTestInfo.java::getVersion() : this was expecting a project.version.osgi property that isn&apos;t defined, changed it to return the version of the artifact, this caused the following change&lt;/li&gt;
	&lt;li&gt;in log4j-api/src/test/java/org/apache/logging/log4j/osgi/AbstractLoadBundleTest.java::getExpectedBundleSymbolicName() : . are used instead of - in the OSGi symbolic name&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Adding the new test, required two changes:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;log4j-core/src/main/java/org/apache/logging/log4j/core/osgi/Activator.java::scanInstalledBundlesForPlugins(..) : exclude the system bundle (id 0) from the search for plugins as it uses a ClassLoader that does not properly descend from ClassLoader in the core bundle when using Equinox&lt;/li&gt;
	&lt;li&gt;log4j-api/src/test/java/org/apache/logging/log4j/osgi/AbstractLoadBundleTest.java::testLoadStartStop() : added an uninstall step as otherwise it somehow cause issues with Equinox&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Now for the test itself, it is actually two tests:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;a first one that in the basic OSGi environment adds the api, core and for the test dependency purpose log4j-samples-configuration, then through reflection (in order to be in the sample bundle context) log a simple error message that&apos;s retrieved via a ByteArrayOutputStream override of System.out and compared to the expected value.&lt;/li&gt;
	&lt;li&gt;a second derived from the first but that checks for the absence of the message line of exception that motivated this issue, again using reflection to plug into the right classes.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The fix used was to add &quot;org.apache.logging.log4j.core.osgi;resolution:=optional,&quot; to the Import-Package of maven-bundle-plugin in log4j-api/pom.xml&lt;/p&gt;

&lt;p&gt;I feel the OSGi tests could be made a submodule of log4j2 &apos;pom&apos; they would then not require a first build followed by a second build for actually running the tests, but that may be a follow up.&lt;/p&gt;</comment>
                            <comment id="15136312" author="lhochet" created="Sun, 7 Feb 2016 16:41:39 +0000"  >&lt;p&gt;Is there anything more that I could do to get this moving?&lt;/p&gt;</comment>
                            <comment id="15136446" author="garydgregory" created="Sun, 7 Feb 2016 21:12:03 +0000"  >&lt;p&gt;Can someone make a single patch file? Right now, it&apos;s not clear to me what patch3 sits on top of.&lt;/p&gt;</comment>
                            <comment id="15136463" author="lhochet" created="Sun, 7 Feb 2016 21:37:26 +0000"  >&lt;p&gt;patch3 should be applyable on top of the current master from &lt;a href=&quot;http://git-wip-us.apache.org/repos/asf/logging-log4j2.git&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://git-wip-us.apache.org/repos/asf/logging-log4j2.git&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I left the patch and patch2 attachments for anybody reading the progression of this issue.&lt;/p&gt;</comment>
                            <comment id="15138217" author="jvz" created="Tue, 9 Feb 2016 01:47:27 +0000"  >&lt;p&gt;Adding the optional import-package for log4j-core would definitely be a workaround IMO. Other log4j implementations (like log4j-to-slf4j for instance) still wouldn&apos;t work (though 3rd parties could either shade with the api jar or use fragment-host I suppose). This could be a valid workaround for now until the real issue is uncovered.&lt;/p&gt;

&lt;p&gt;Edit: that is if the problem is related to the Provider API in log4j-api and not some weird issue specific to log4j-core.&lt;/p&gt;</comment>
                            <comment id="15138219" author="jvz" created="Tue, 9 Feb 2016 01:48:49 +0000"  >&lt;ul&gt;
	&lt;li&gt;BundleContextSelector is supposed to allow individual bundles to have their own independent LoggerContext similar to how log4j works in servlet environments (as a shared library that is).&lt;/li&gt;
	&lt;li&gt;It&apos;s supposed to be instantiated by log4j-core&lt;/li&gt;
	&lt;li&gt;Sounds like a bug&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15138250" author="jvz" created="Tue, 9 Feb 2016 02:29:24 +0000"  >&lt;p&gt;I&apos;ve applied your patch to the master branch. Looks good to me. Please verify and close.&lt;/p&gt;</comment>
                            <comment id="15139994" author="lhochet" created="Tue, 9 Feb 2016 23:29:23 +0000"  >&lt;p&gt;Tested with the sample project and the original project this was found on, both are ok.&lt;/p&gt;</comment>
                            <comment id="15140081" author="jvz" created="Wed, 10 Feb 2016 00:21:55 +0000"  >&lt;p&gt;Thanks for all your help!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12846167">LOG4J2-1081</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13010870">LOG4J2-1637</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12736464" name="LOG4J2-920.zip" size="870292" author="lhochet" created="Sun, 31 May 2015 22:43:08 +0000"/>
                            <attachment id="12686675" name="patch.diff" size="426" author="lhochet" created="Thu, 11 Dec 2014 21:09:33 +0000"/>
                            <attachment id="12736468" name="patch2.diff" size="431" author="lhochet" created="Sun, 31 May 2015 22:56:04 +0000"/>
                            <attachment id="12751930" name="patch3.diff" size="10535" author="lhochet" created="Sun, 23 Aug 2015 20:20:25 +0000"/>
                            <attachment id="12748318" name="pom.xml" size="8241" author="hanbaj" created="Sat, 1 Aug 2015 15:55:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 41 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i23c33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>