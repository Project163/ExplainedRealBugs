<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:41:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2939] NPE in MDCContextMap</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2939</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;When using the SLF4J adapter and you call ThreadContext.containsKey() before putting anything into the ThreadContext, a NullPointerException is thrown:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Exception in thread &quot;main&quot; java.lang.NullPointerException
at org.apache.logging.slf4j.MDCContextMap.containsKey(MDCContextMap.java:74)
at org.apache.logging.log4j.ThreadContext.containsKey(ThreadContext.java:350)
at de.semvox.logtest.LogtestApplication.main(LogtestApplication.java:15)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is not surprising, as the implementation looks like this&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Override
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; containsKey(&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; key) {
&#160;&#160;&#160; &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; MDC.getCopyOfContextMap().containsKey(key);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;And the Javadoc for getCopyOfContextMap explicitly states &#8220;May be null.&#8221;&lt;/p&gt;

&lt;p&gt;This bug is also present in the isEmpty method of the same class.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Workaround: Before any tests are made, e.g. top of main, execute the following&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ThreadContext.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;bar&quot;&lt;/span&gt;);
ThreadContext.remove(&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I will create a pull request shortly.&lt;/p&gt;

&lt;p&gt;UPDATE: Here is the pull request: &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/430&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/430&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Empty fresh Spring Boot project on Windows 10 64Bit Oracle JDK11&lt;/p&gt;</environment>
        <key id="13333714">LOG4J2-2939</key>
            <summary>NPE in MDCContextMap</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="constantinhirschsemvox">Constantin Hirsch</reporter>
                        <labels>
                    </labels>
                <created>Mon, 5 Oct 2020 12:35:52 +0000</created>
                <updated>Tue, 6 Oct 2020 16:02:41 +0000</updated>
                            <resolved>Tue, 6 Oct 2020 14:42:04 +0000</resolved>
                                    <version>2.13.3</version>
                                    <fixVersion>2.14.0</fixVersion>
                                    <component>SLF4J Bridge</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17208806" author="jira-bot" created="Tue, 6 Oct 2020 14:36:42 +0000"  >&lt;p&gt;Commit 7aef4f075803ac5153cae392a28d8563eba0812f in logging-log4j2&apos;s branch refs/heads/master from Constantin Hirsch (SemVox)&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=7aef4f0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=7aef4f0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2939&quot; title=&quot;NPE in MDCContextMap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2939&quot;&gt;&lt;del&gt;LOG4J2-2939&lt;/del&gt;&lt;/a&gt;: Fix NPE in MDCContextMap (#430)&lt;/p&gt;

&lt;p&gt;Accomodate for the fact that MDC.getCopyOfContextMap() may return null&lt;/p&gt;</comment>
                            <comment id="17208810" author="jira-bot" created="Tue, 6 Oct 2020 14:41:49 +0000"  >&lt;p&gt;Commit d368e294d631e79119caa985656d0ec571bd24f5 in logging-log4j2&apos;s branch refs/heads/master from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=d368e29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=d368e29&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2939&quot; title=&quot;NPE in MDCContextMap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2939&quot;&gt;&lt;del&gt;LOG4J2-2939&lt;/del&gt;&lt;/a&gt; changelog&lt;/p&gt;</comment>
                            <comment id="17208812" author="jira-bot" created="Tue, 6 Oct 2020 14:41:55 +0000"  >&lt;p&gt;Commit d368e294d631e79119caa985656d0ec571bd24f5 in logging-log4j2&apos;s branch refs/heads/master from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=d368e29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=d368e29&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2939&quot; title=&quot;NPE in MDCContextMap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2939&quot;&gt;&lt;del&gt;LOG4J2-2939&lt;/del&gt;&lt;/a&gt; changelog&lt;/p&gt;</comment>
                            <comment id="17208813" author="jira-bot" created="Tue, 6 Oct 2020 14:41:59 +0000"  >&lt;p&gt;Commit ec34bd2f1ebc34bc80cde64d51ec6060d7bd250e in logging-log4j2&apos;s branch refs/heads/release-2.x from Constantin Hirsch (SemVox)&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=ec34bd2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=ec34bd2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2939&quot; title=&quot;NPE in MDCContextMap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2939&quot;&gt;&lt;del&gt;LOG4J2-2939&lt;/del&gt;&lt;/a&gt;: Fix NPE in MDCContextMap (#430)&lt;/p&gt;

&lt;p&gt;Accomodate for the fact that MDC.getCopyOfContextMap() may return null&lt;/p&gt;</comment>
                            <comment id="17208814" author="jira-bot" created="Tue, 6 Oct 2020 14:42:00 +0000"  >&lt;p&gt;Commit 2f798b01663213428c5d04f1706e752d1f2ba3eb in logging-log4j2&apos;s branch refs/heads/release-2.x from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=2f798b0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=2f798b0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2939&quot; title=&quot;NPE in MDCContextMap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2939&quot;&gt;&lt;del&gt;LOG4J2-2939&lt;/del&gt;&lt;/a&gt; changelog&lt;/p&gt;</comment>
                            <comment id="17208816" author="ckozak" created="Tue, 6 Oct 2020 14:42:04 +0000"  >&lt;p&gt;Thanks for your contribution &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=constantinhirschsemvox&quot; class=&quot;user-hover&quot; rel=&quot;constantinhirschsemvox&quot;&gt;constantinhirschsemvox&lt;/a&gt;! I&apos;ve merged the change to master and backported to the release-2.x branch in preparation for 2.14.0.&lt;br/&gt;
Please verify using the latest snapshot, and close this issue once you&apos;re satisfied.&lt;/p&gt;</comment>
                            <comment id="17208837" author="constantinhirschsemvox" created="Tue, 6 Oct 2020 15:24:54 +0000"  >&lt;p&gt;Thanks for your support!&lt;/p&gt;

&lt;p&gt;To test it, I set this property in my pom:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;log4j2.version&amp;gt;2.14.0-SNAPSHOT&amp;lt;/log4j2.version&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But the resulting version is only &quot;log4j-to-slf4j : 2.14.0-20200919.205531-71&quot; which hints at a build date in September. Do I just wait for the build server to publish a newer snapshot, or should I try to circumvent the build server somehow?&lt;/p&gt;</comment>
                            <comment id="17208868" author="ckozak" created="Tue, 6 Oct 2020 16:02:41 +0000"  >&lt;p&gt;You&apos;re right, the snapshots appear unhappy at the moment. I think the unit tests are sufficient to close this out, I&apos;m working on getting builds working again (in progress here: &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/431&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/431&lt;/a&gt;&#160;)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 6 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0jf40:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>