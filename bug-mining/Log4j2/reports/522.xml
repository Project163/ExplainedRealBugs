<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:34:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-1067] ThrowableProxy getExtendedStackTraceAsString throws NPE on deserialized nested exceptions</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-1067</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;In a similar vein to &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-914&quot; title=&quot;ThrowableProxy.getExtendedStackTraceAsString causes NullPointerException &quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-914&quot;&gt;&lt;del&gt;LOG4J2-914&lt;/del&gt;&lt;/a&gt;, I also am attempting to use log4j as a daemon log server.  The fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-914&quot; title=&quot;ThrowableProxy.getExtendedStackTraceAsString causes NullPointerException &quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-914&quot;&gt;&lt;del&gt;LOG4J2-914&lt;/del&gt;&lt;/a&gt; only solved the NPE problem for one dimensional exceptions. Nested exceptions also cause an NPE in the current implementation.  Here is a test/patch diff for the bug:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;---
 .../org/apache/logging/log4j/core/impl/ThrowableProxy.java     |  2 +-
 .../org/apache/logging/log4j/core/impl/ThrowableProxyTest.java | 10 ++++++++++
 2 files changed, 11 insertions(+), 1 deletion(-)

diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/impl/ThrowableProxy.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/impl/ThrowableProxy.java
index 67d55ec..307de58 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/impl/ThrowableProxy.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/impl/ThrowableProxy.java
@@ -207,7 +207,7 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ThrowableProxy &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; Serializable {
             &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
         }
         sb.append(&lt;span class=&quot;code-quote&quot;&gt;&quot;Caused by: &quot;&lt;/span&gt;).append(cause).append(EOL);
-        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.formatElements(sb, cause.commonElementCount, cause.getThrowable().getStackTrace(),
+        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.formatElements(sb, cause.commonElementCount, cause.getStackTrace(),
                 cause.extendedStackTrace, ignorePackages);
         &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.formatCause(sb, cause.causeProxy, ignorePackages);
     }
diff --git a/log4j-core/src/test/java/org/apache/logging/log4j/core/impl/ThrowableProxyTest.java b/log4j-core/src/test/java/org/apache/logging/log4j/core/impl/ThrowableProxyTest.java
index 7019aa2..6eb5dbc 100644
--- a/log4j-core/src/test/java/org/apache/logging/log4j/core/impl/ThrowableProxyTest.java
+++ b/log4j-core/src/test/java/org/apache/logging/log4j/core/impl/ThrowableProxyTest.java
@@ -146,6 +146,16 @@ &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ThrowableProxyTest {
 
         assertEquals(proxy.getExtendedStackTraceAsString(), proxy2.getExtendedStackTraceAsString());
     }
+    
+    @Test
+    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testSerialization_getExtendedStackTraceAsStringWithNestedThrowable() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
+        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Throwable throwable = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalArgumentException(&lt;span class=&quot;code-quote&quot;&gt;&quot;This is a test&quot;&lt;/span&gt;));
+        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ThrowableProxy proxy = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ThrowableProxy(throwable);
+        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] binary = serialize(proxy);
+        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ThrowableProxy proxy2 = deserialize(binary);
+
+        assertEquals(proxy.getExtendedStackTraceAsString(), proxy2.getExtendedStackTraceAsString());
+    }
 
     @Test
     &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testSerializationWithUnknownThrowable() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
-- 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12839839">LOG4J2-1067</key>
            <summary>ThrowableProxy getExtendedStackTraceAsString throws NPE on deserialized nested exceptions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="braam">Sam Braam</reporter>
                        <labels>
                    </labels>
                <created>Tue, 23 Jun 2015 12:53:35 +0000</created>
                <updated>Wed, 24 Jun 2015 04:55:38 +0000</updated>
                            <resolved>Tue, 23 Jun 2015 16:17:11 +0000</resolved>
                                    <version>2.3</version>
                                    <fixVersion>2.4</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14597878" author="garydgregory" created="Tue, 23 Jun 2015 16:17:11 +0000"  >&lt;p&gt;Sam,&lt;/p&gt;

&lt;p&gt;Thank you for your report and patch.&lt;/p&gt;

&lt;p&gt;I applied the patch to Git master with refactored and additional tests. &lt;/p&gt;

&lt;p&gt;Please verify and close.&lt;/p&gt;

&lt;p&gt;More reports are welcome!&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="14598868" author="braam" created="Wed, 24 Jun 2015 04:55:38 +0000"  >&lt;p&gt;Looks good, thanks for the quick response.&lt;/p&gt;

&lt;p&gt;Sam&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 22 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2gdvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>