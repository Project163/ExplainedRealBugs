<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:32:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-445] ResolverUtil cannot find packages in file URLs which include the &apos;+&apos; character</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-445</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;I work on an application whose version number includes a &apos;+&apos; character which becomes part of the filename for the jars created in the build process.  This application uses several custom log4j2 plugins contained in the jar which are discovered via the packages tag in the xml Configuration.  We also generate a plugin map using the exec-maven-plugin command documented in the Extending log4j section of the log4j2 documentation.  This command prints the following during the build:&lt;br/&gt;
ERROR StatusLogger Could not search jar file &apos;/src/program-1.2.3 build127/util/target/util-1.2.3 build127.jar&apos; for classes matching criteria: annotated with @Plugin file not found&lt;br/&gt;
The actual path to the jar is &apos;/src/program-1.2.3+build127/util/target/util-1.2.3+build127.jar&apos;&lt;/p&gt;

&lt;p&gt;I examined the source for ResolverUtil and in the method findInPackage (line 225), URLDecoder.decode is called unilaterally even for file: URLs.  The javadoc for this class says the character + is converted to space, which is inappropriate for a file: URL.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Debian Squeeze and Gentoo&lt;br/&gt;
Java 7u25&lt;/p&gt;</environment>
        <key id="12678146">LOG4J2-445</key>
            <summary>ResolverUtil cannot find packages in file URLs which include the &apos;+&apos; character</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rpopma">Remko Popma</assignee>
                                    <reporter username="abaldocchi">Anthony Baldocchi</reporter>
                        <labels>
                    </labels>
                <created>Fri, 8 Nov 2013 04:06:15 +0000</created>
                <updated>Mon, 6 Jan 2014 16:13:14 +0000</updated>
                            <resolved>Sun, 5 Jan 2014 04:54:17 +0000</resolved>
                                    <version>2.0-beta9</version>
                                    <fixVersion>2.0-rc1</fixVersion>
                    <fixVersion>2.0</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>4</votes>
                                    <watches>3</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="13816979" author="abaldocchi" created="Fri, 8 Nov 2013 04:07:06 +0000"  >&lt;p&gt;proposed fix for ResolverUtil.findInPackage&lt;/p&gt;</comment>
                            <comment id="13818391" author="abaldocchi" created="Sun, 10 Nov 2013 07:59:56 +0000"  >&lt;p&gt;The previous patch was insufficient for jar:file: URLs.&lt;/p&gt;</comment>
                            <comment id="13862475" author="ralph.goers@dslextreme.com" created="Sun, 5 Jan 2014 02:13:05 +0000"  >&lt;p&gt;Remko - I see you assigned this to yourself. I don&apos;t see anything wrong with this patch but we should have a unit test for ResolverUtil to prove that it works.&lt;/p&gt;</comment>
                            <comment id="13862479" author="remkop@yahoo.com" created="Sun, 5 Jan 2014 02:53:59 +0000"  >&lt;p&gt;I&apos;m working on the JUnit tests.&lt;br/&gt;
Would it be sufficient to have tests for the &lt;tt&gt;file:&lt;/tt&gt;, the &lt;tt&gt;jar:file:&lt;/tt&gt; and the &lt;tt&gt;http:&lt;/tt&gt; protocols or can anyone think of other URL protocols that &lt;tt&gt;ClassLoader.getResources()&lt;/tt&gt; might return?&lt;/p&gt;</comment>
                            <comment id="13862481" author="remkop@yahoo.com" created="Sun, 5 Jan 2014 03:07:25 +0000"  >&lt;p&gt;Hmm... to answer my own question,&lt;br/&gt;
it looks like the only URL protocols that are actually supported by the current &lt;tt&gt;ResolverUtil.findInPackage()&lt;/tt&gt; implementation are &lt;tt&gt;file:&lt;/tt&gt;, &lt;tt&gt;jar:file:&lt;/tt&gt;, &lt;tt&gt;vfszip:&lt;/tt&gt; and &lt;tt&gt;resourcebundle:&lt;/tt&gt;. Any other protocol URL will be be handled as a local &lt;tt&gt;File&lt;/tt&gt;.&lt;br/&gt;
I&apos;ll create JUnit tests accordingly.&lt;/p&gt;</comment>
                            <comment id="13862493" author="remkop@yahoo.com" created="Sun, 5 Jan 2014 04:54:17 +0000"  >&lt;p&gt;I&apos;ve taken a slightly different approach than the patch:&lt;/p&gt;

&lt;p&gt;Instead of calling URL.toExternalForm (which theoretically could include the Host, Query and Ref parts), I only do string processing on the Path part.&lt;/p&gt;

&lt;p&gt;Stripping of &lt;tt&gt;&quot;jar:&quot;&lt;/tt&gt; and &lt;tt&gt;&quot;file:&quot;&lt;/tt&gt; prefixes and &lt;tt&gt;&quot;!/*&quot;&lt;/tt&gt; suffix is as before.&lt;/p&gt;

&lt;p&gt;Finally, deciding whether to &lt;tt&gt;URL.decode&lt;/tt&gt; or not:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;vfszip:&lt;/tt&gt; and &lt;tt&gt;bundleresource:&lt;/tt&gt; URLs are never decoded,&lt;/li&gt;
	&lt;li&gt;if the path exists as a file (without decoding it), then return it as is&lt;/li&gt;
	&lt;li&gt;otherwise, return the URL.decoded path&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Added JUnit tests.&lt;br/&gt;
Fixed in revision 1555458.&lt;br/&gt;
Please verify and close.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12612778" name="resolver-util-file-with-plus.patch" size="1177" author="abaldocchi" created="Fri, 8 Nov 2013 04:07:06 +0000"/>
                            <attachment id="12613041" name="resolver-util-jar-file-path-with-plus.patch" size="1320" author="abaldocchi" created="Sun, 10 Nov 2013 07:59:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>357521</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 46 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1pmsv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>357811</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>