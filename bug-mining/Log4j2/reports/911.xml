<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:37:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-1563] Log4j 2.6.2 can lose exceptions when a security manager is present</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-1563</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;When Log4j is rendering an exception, it can attempt to load classes that it does not have permissions to load when a security manager is present.&lt;/p&gt;

&lt;p&gt;I have a patch and a failing test case for this; I will submit it shortly.&lt;/p&gt;

&lt;p&gt;This is the backport for &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-1560&quot; title=&quot;Log4j can lose exceptions when a security manager is present&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-1560&quot;&gt;&lt;del&gt;LOG4J2-1560&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13002623">LOG4J2-1563</key>
            <summary>Log4j 2.6.2 can lose exceptions when a security manager is present</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ggregory">Gary D. Gregory</assignee>
                                    <reporter username="jasontedor">Jason E Tedor</reporter>
                        <labels>
                    </labels>
                <created>Sun, 4 Sep 2016 16:10:45 +0000</created>
                <updated>Sat, 18 Feb 2017 05:07:35 +0000</updated>
                            <resolved>Wed, 7 Sep 2016 02:23:58 +0000</resolved>
                                    <version>2.6.2</version>
                                    <fixVersion>2.7</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15463138" author="jasontedor" created="Sun, 4 Sep 2016 16:11:47 +0000"  >&lt;p&gt;Attached is a patch against tag log4j-2.6.2.&lt;/p&gt;</comment>
                            <comment id="15469261" author="garydgregory" created="Wed, 7 Sep 2016 02:12:21 +0000"  >&lt;p&gt;The patch looks good. I&apos;ll apply it. Thank you.&lt;/p&gt;

&lt;p&gt;My next questions: &lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Where else should we catch SecurityException?&lt;/li&gt;
	&lt;li&gt;How do we run a whole build with a security manager?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="15469270" author="garydgregory" created="Wed, 7 Sep 2016 02:18:23 +0000"  >&lt;p&gt;The tests restores the Security Manager, which is good. Should it not also restore the Policy?&lt;/p&gt;</comment>
                            <comment id="15469276" author="garydgregory" created="Wed, 7 Sep 2016 02:23:27 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;We now have:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            clazz = LoaderUtil.loadClass(className);
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ClassNotFoundException | NoClassDefFoundError e) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; initializeClass(className);
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; SecurityException e) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can you provide a comment for returning a null value?&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="15469280" author="garydgregory" created="Wed, 7 Sep 2016 02:23:58 +0000"  >&lt;p&gt;In Git master.&lt;/p&gt;</comment>
                            <comment id="15482723" author="jasontedor" created="Mon, 12 Sep 2016 01:24:21 +0000"  >&lt;p&gt;That gets tricky because that means storing off the current policy, which means getting it, which will cause the JVM to load the default policy which will interfere with the permissions we need to setup the test. I&apos;ll attach a patch that removes the need to set a policy at all.&lt;/p&gt;</comment>
                            <comment id="15482725" author="jasontedor" created="Mon, 12 Sep 2016 01:25:08 +0000"  >&lt;p&gt;Attached is a a patch that removes the need for setting a policy.&lt;/p&gt;</comment>
                            <comment id="15482727" author="jasontedor" created="Mon, 12 Sep 2016 01:26:09 +0000"  >&lt;p&gt;I think we can make this simpler by just following the same code path as &lt;tt&gt;ClassNotFoundException&lt;/tt&gt; and &lt;tt&gt;NoClassDefFoundError&lt;/tt&gt;. I&apos;ll attach a patch.&lt;/p&gt;</comment>
                            <comment id="15482729" author="jasontedor" created="Mon, 12 Sep 2016 01:26:46 +0000"  >&lt;p&gt;Attached is a patch to unify the handling of throwables when loading a class in &lt;tt&gt;ThrowableProxy&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="15482732" author="jasontedor" created="Mon, 12 Sep 2016 01:28:12 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;, sorry that I missed your pings earlier this week. I see that you already integrated this but I think your comments have merit and I attached two more patches if you want to integrate them as well. Thanks for integrating, and for your feedback!&lt;/p&gt;</comment>
                            <comment id="15482737" author="jasontedor" created="Mon, 12 Sep 2016 01:31:50 +0000"  >&lt;blockquote&gt;&lt;p&gt;How do we run a whole build with a security manager?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;In Elasticsearch, we run all of our tests under a security manager. The way that we do this is we have a custom test class that installs a security manager when the class initializer for it runs. Log4j could do something similar. That&apos;s the easy part. The hard part is figuring out which permissions for Log4j are needed, and then handling the security exceptions that could arise if those permissions are not granted.&lt;/p&gt;</comment>
                            <comment id="15491432" author="jasontedor" created="Wed, 14 Sep 2016 20:52:56 +0000"  >&lt;p&gt;Heya &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;, I&apos;m confused about the contribution process here? I supplied a patch with an elaborate commit message but I see the commit in the logs does not have my commit message nor authorship? What am I missing here?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;commit b7b30013e84e8be2b6bbc8326e9bc2ff27e239f1
Author:     Gary Gregory &amp;lt;ggregory@apache.org&amp;gt;
AuthorDate: Tue Sep 6 22:21:37 2016 -0400
Commit:     Gary Gregory &amp;lt;ggregory@apache.org&amp;gt;
CommitDate: Tue Sep 6 22:21:37 2016 -0400

    [LOG4J2-1563] Log4j 2.6.2 can lose exceptions when a security manager is
    present.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15491458" author="garydgregory" created="Wed, 14 Sep 2016 21:08:11 +0000"  >&lt;p&gt;Hi Jason,&lt;/p&gt;

&lt;p&gt;We don&apos;t bother with attribution at the commit level, we use the changes.xml file for that:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;action issue=&lt;span class=&quot;code-quote&quot;&gt;&quot;LOG4J2-1563&quot;&lt;/span&gt; dev=&lt;span class=&quot;code-quote&quot;&gt;&quot;ggregory&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;fix&quot;&lt;/span&gt; due-to=&lt;span class=&quot;code-quote&quot;&gt;&quot;Jason Tedor&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
        Fix to prevent Log4j 2.6.2 and higher from losing exceptions when a security manager is present.
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/action&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15491466" author="jasontedor" created="Wed, 14 Sep 2016 21:13:14 +0000"  >&lt;p&gt;Thanks for replying &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;. That&apos;s a different model than I&apos;m use to, what is the reason for this?&lt;/p&gt;</comment>
                            <comment id="15491537" author="jvz" created="Wed, 14 Sep 2016 21:47:23 +0000"  >&lt;p&gt;The commit message is kept usually in a pull request at least. My guess is he used patch(1) instead of git-apply(1).&lt;/p&gt;</comment>
                            <comment id="15491622" author="garydgregory" created="Wed, 14 Sep 2016 22:31:59 +0000"  >&lt;p&gt;I used EGit. The background is that most of us started with Svn and have not seen the need for this feature. I am happy to adjust my usage if EGit knows how to do that. AFK ATM or I&apos;d check.&lt;/p&gt;</comment>
                            <comment id="15555412" author="jasontedor" created="Fri, 7 Oct 2016 15:38:20 +0000"  >&lt;p&gt;I recognize that I&apos;m an external contributor and my opinion caries very little weight here, but I really think open source projects like this one should be applying patches from external contributors directly keeping their name as the commit author and keeping their original commit message.&lt;/p&gt;</comment>
                            <comment id="15555429" author="jvz" created="Fri, 7 Oct 2016 15:45:28 +0000"  >&lt;p&gt;We always credit external contributes in the changelog for the feature or bugfix. Not everyone here uses Mac or Linux, and using git on Windows is an exercise in frustration, so sometimes metadata like that gets lost. :/&lt;/p&gt;</comment>
                            <comment id="15555547" author="remkop@yahoo.com" created="Fri, 7 Oct 2016 16:30:34 +0000"  >&lt;p&gt;Jason, thank you for pointing this out. Your suggestion is a good one and personally I think if the tools support it we should try to do it that way. We do have a process to give credit for contributions, but if we can enhance that to encourage people to contribute that is a good thing in my opinion.&lt;/p&gt;</comment>
                            <comment id="15555562" author="jasontedor" created="Fri, 7 Oct 2016 16:37:14 +0000"  >&lt;p&gt;I don&apos;t think this practice should be attributed to tooling. Either my suggestion is a better way to do things, or there is a good reason for maintaining the current practice that is independent of the tooling.&lt;/p&gt;

&lt;p&gt;Regardless, when I need to test a change on Windows for the projects that I contribute to, I&apos;ve never had any issues with using the Git Bash support that comes with the &lt;a href=&quot;https://git-scm.com/download/win&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;official binary distribution&lt;/a&gt;. It acts exactly like git does on Linux for me.&lt;/p&gt;</comment>
                            <comment id="15555563" author="jasontedor" created="Fri, 7 Oct 2016 16:37:17 +0000"  >&lt;p&gt;I don&apos;t think this practice should be attributed to tooling. Either my suggestion is a better way to do things, or there is a good reason for maintaining the current practice that is independent of the tooling.&lt;/p&gt;

&lt;p&gt;Regardless, when I need to test a change on Windows for the projects that I contribute to, I&apos;ve never had any issues with using the Git Bash support that comes with the &lt;a href=&quot;https://git-scm.com/download/win&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;official binary distribution&lt;/a&gt;. I acts exactly like git does on Linux for me.&lt;/p&gt;</comment>
                            <comment id="15555570" author="garydgregory" created="Fri, 7 Oct 2016 16:40:14 +0000"  >&lt;p&gt;On Windows 7, I use Git Bash, git in a cmd.exe, and EGit in Eclipse and I&apos;ve not had a Windows specific issue yet.&lt;/p&gt;</comment>
                            <comment id="15555573" author="jasontedor" created="Fri, 7 Oct 2016 16:41:27 +0000"  >&lt;p&gt;Please do not attribute this to the tooling, this has nothing to do with the tooling. The right tooling is available on the major platforms.&lt;/p&gt;

&lt;p&gt;For me personally I was not happy to learn that this is the practice after my contribution was accepted, this is the only open source project I&apos;ve seen conducted this way (there might be others, but this is the first I&apos;ve seen).&lt;/p&gt;

&lt;p&gt;If people spend time carefully preparing a patch and crafting a commit message, the entirety of their work (which is more than just the code) should be integrated.&lt;/p&gt;</comment>
                            <comment id="15555585" author="remkop@yahoo.com" created="Fri, 7 Oct 2016 16:44:45 +0000"  >&lt;p&gt;I hear you. We do appreciate the time and effort you put into this. We will try to do better in future.&lt;/p&gt;</comment>
                            <comment id="15555588" author="garydgregory" created="Fri, 7 Oct 2016 16:46:25 +0000"  >&lt;p&gt;In EGit (Eclipse), I see an Author and Commit text box, so it&apos;s just a matter for me to create a new habit and use the Author field when appropriate. &lt;/p&gt;

&lt;p&gt;The issue for me is that I do not apply all patches as is, some I do, there usually is some tweaking needed. What to do then? I guess I could commit the patch and mark it with the author and then make another commit with my changes where I am the author. But that seems to add more to the git history than is strictly needed for no good reason. Hence our tracking of contributions in the changes.xml file, where we can list who helped for the whole issue.&lt;/p&gt;</comment>
                            <comment id="15555590" author="jasontedor" created="Fri, 7 Oct 2016 16:47:26 +0000"  >&lt;p&gt;How about just iterating with the patch author if more changes are needed, isn&apos;t that part of the review process anyway?&lt;/p&gt;</comment>
                            <comment id="15561773" author="mikaelstaldal" created="Mon, 10 Oct 2016 09:23:48 +0000"  >&lt;p&gt;Maybe we should encourage external contributors to use GitHib pull requests rather than sending patch files?&lt;/p&gt;</comment>
                            <comment id="15562011" author="jasontedor" created="Mon, 10 Oct 2016 11:18:56 +0000"  >&lt;p&gt;That&apos;s a workflow that a lot of people are use to these days, so that would be a welcome addition.&lt;/p&gt;</comment>
                            <comment id="15872608" author="jasontedor" created="Fri, 17 Feb 2017 22:01:39 +0000"  >&lt;p&gt;I would like to submit another patch for a similar issue. It appears that the workflow hasn&apos;t changed to accept pull requests via GitHub? Is it safe to assume that if I submit a patch the old-fashioned way it will be fully integrated?&lt;/p&gt;</comment>
                            <comment id="15872993" author="remkop@yahoo.com" created="Sat, 18 Feb 2017 05:07:35 +0000"  >&lt;p&gt;I Saw you raised &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-1820&quot; title=&quot;Log4j 2.8 can lose exceptions when a security manager is present&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-1820&quot;&gt;&lt;del&gt;LOG4J2-1820&lt;/del&gt;&lt;/a&gt; for the new issue. Perfect, thanks!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13044132">LOG4J2-1820</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12827945" name="0001-Unify-handling-of-throwables-when-loading-class.patch" size="1442" author="jasontedor" created="Mon, 12 Sep 2016 01:26:46 +0000"/>
                            <attachment id="12827944" name="0002-Remove-policy-in-throwable-proxy-security-test.patch" size="4988" author="jasontedor" created="Mon, 12 Sep 2016 01:25:08 +0000"/>
                            <attachment id="12827014" name="throwable-proxy-security-exception-2.6.2.patch" size="5028" author="jasontedor" created="Sun, 4 Sep 2016 16:11:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12311024" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>External issue ID</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20304</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://github.com/elastic/elasticsearch/issues/20304]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 39 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i338cn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>