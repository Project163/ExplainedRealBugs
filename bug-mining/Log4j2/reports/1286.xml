<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:40:31 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2522] Make MapMessageLookup.lookup usable with MapMessage again</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2522</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-1935&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/LOG4J2-1935&lt;/a&gt;&lt;br/&gt;
changed MapMessage to a generic superclass, &lt;br/&gt;
but decided to cast to StringMapMessage (a subclass with previous semantics) in MapMessageLookup.lookup&lt;/p&gt;

&lt;p&gt;Test case:&lt;/p&gt;


&lt;p&gt;{{ @Test}}&lt;br/&gt;
{{ public void testEventMapMessage() {}}&lt;br/&gt;
&lt;tt&gt;&#160; &#160; final HashMap&amp;lt;String, String&amp;gt; map = new HashMap&amp;lt;&amp;gt;();&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; map.put(&quot;A&quot;, &quot;B&quot;);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; final HashMap&amp;lt;String, String&amp;gt; eventMap = new HashMap&amp;lt;&amp;gt;();&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; eventMap.put(&quot;A1&quot;, &quot;B1&quot;);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; final StringMapMessage message = new StringMapMessage(eventMap);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; final LogEvent event = Log4jLogEvent.newBuilder()&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; .setMessage(message)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; .build();&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; final MapLookup lookup = new MapLookup(map);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; assertEquals(&quot;B&quot;, lookup.lookup(event, &quot;A&quot;));&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; assertEquals(&quot;B1&quot;, lookup.lookup(event, &quot;A1&quot;));&lt;/tt&gt;&lt;br/&gt;
{{ }}}&lt;/p&gt;

&lt;p&gt;passes, but new test&lt;/p&gt;


&lt;p&gt;{{ @Test}}&lt;br/&gt;
{{ public void testEventMapMessageNew() {}}&lt;br/&gt;
&lt;tt&gt;&#160; &#160; final HashMap&amp;lt;String, String&amp;gt; map = new HashMap&amp;lt;&amp;gt;();&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; map.put(&quot;A&quot;, &quot;B&quot;);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; final HashMap&amp;lt;String, String&amp;gt; eventMap = new HashMap&amp;lt;&amp;gt;();&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; eventMap.put(&quot;A1&quot;, 11);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; final MapMessage message = new MapMessage&amp;lt;&amp;gt;(eventMap);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; final LogEvent event = Log4jLogEvent.newBuilder()&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; .setMessage(message)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160; .build();&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; final MapLookup lookup = new MapLookup(map);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; assertEquals(&quot;B&quot;, lookup.lookup(event, &quot;A&quot;));&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; assertEquals(&quot;11&quot;, lookup.lookup(event, &quot;A1&quot;));&lt;/tt&gt;&lt;br/&gt;
{{ }}}&lt;/p&gt;

&lt;p&gt;Even worse, if we initialize MapMessage with a Map&amp;lt;String, String&amp;gt;, the test case still fails.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13204911">LOG4J2-2522</key>
            <summary>Make MapMessageLookup.lookup usable with MapMessage again</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ckozak">Carter Kozak</assignee>
                                    <reporter username="lesiak">Adam Lesiak</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Dec 2018 15:05:06 +0000</created>
                <updated>Thu, 10 Jan 2019 16:03:42 +0000</updated>
                            <resolved>Wed, 2 Jan 2019 14:58:13 +0000</resolved>
                                                    <fixVersion>3.0.0</fixVersion>
                    <fixVersion>2.11.2</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16723187" author="lesiak" created="Mon, 17 Dec 2018 17:28:07 +0000"  >&lt;p&gt;Created pull request:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/245&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/245&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16732118" author="jira-bot" created="Wed, 2 Jan 2019 14:50:49 +0000"  >&lt;p&gt;Commit 82fc39a2b462781a832b7a50700a1f6d78693f74 in logging-log4j2&apos;s branch refs/heads/master from lesiak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=82fc39a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=82fc39a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2522&quot; title=&quot;Make MapMessageLookup.lookup usable with MapMessage again&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2522&quot;&gt;&lt;del&gt;LOG4J2-2522&lt;/del&gt;&lt;/a&gt; Make MapMessageLookup.lookup usable with MapMessage again&lt;/p&gt;</comment>
                            <comment id="16732119" author="jira-bot" created="Wed, 2 Jan 2019 14:50:50 +0000"  >&lt;p&gt;Commit 0e2b27e72fd8f3c016c3cc8dcef674ed518234ab in logging-log4j2&apos;s branch refs/heads/master from lesiak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=0e2b27e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=0e2b27e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2522&quot; title=&quot;Make MapMessageLookup.lookup usable with MapMessage again&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2522&quot;&gt;&lt;del&gt;LOG4J2-2522&lt;/del&gt;&lt;/a&gt;  Added @Test testLookupDefaultMapIsCheckedBeforeMapMessage()&lt;/p&gt;</comment>
                            <comment id="16732120" author="jira-bot" created="Wed, 2 Jan 2019 14:50:51 +0000"  >&lt;p&gt;Commit 51ef2871720f415df3617da161949c8705b5de87 in logging-log4j2&apos;s branch refs/heads/master from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=51ef287&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=51ef287&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merge pull request #245 from lesiak/&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2522&quot; title=&quot;Make MapMessageLookup.lookup usable with MapMessage again&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2522&quot;&gt;&lt;del&gt;LOG4J2-2522&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2522&quot; title=&quot;Make MapMessageLookup.lookup usable with MapMessage again&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2522&quot;&gt;&lt;del&gt;LOG4J2-2522&lt;/del&gt;&lt;/a&gt; Make MapMessageLookup.lookup usable with MapMessage again&lt;/p&gt;</comment>
                            <comment id="16732121" author="jira-bot" created="Wed, 2 Jan 2019 14:50:51 +0000"  >&lt;p&gt;Commit 51ef2871720f415df3617da161949c8705b5de87 in logging-log4j2&apos;s branch refs/heads/master from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=51ef287&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=51ef287&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merge pull request #245 from lesiak/&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2522&quot; title=&quot;Make MapMessageLookup.lookup usable with MapMessage again&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2522&quot;&gt;&lt;del&gt;LOG4J2-2522&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2522&quot; title=&quot;Make MapMessageLookup.lookup usable with MapMessage again&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2522&quot;&gt;&lt;del&gt;LOG4J2-2522&lt;/del&gt;&lt;/a&gt; Make MapMessageLookup.lookup usable with MapMessage again&lt;/p&gt;</comment>
                            <comment id="16732131" author="jira-bot" created="Wed, 2 Jan 2019 14:55:31 +0000"  >&lt;p&gt;Commit 67e387481cf49a7cff495fcb145a386e4e5b6671 in logging-log4j2&apos;s branch refs/heads/release-2.x from lesiak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=67e3874&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=67e3874&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2522&quot; title=&quot;Make MapMessageLookup.lookup usable with MapMessage again&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2522&quot;&gt;&lt;del&gt;LOG4J2-2522&lt;/del&gt;&lt;/a&gt; Make MapMessageLookup.lookup usable with MapMessage again&lt;/p&gt;</comment>
                            <comment id="16732132" author="jira-bot" created="Wed, 2 Jan 2019 14:55:32 +0000"  >&lt;p&gt;Commit 43d9f81b1736f37a0b2cd737b8c9c97956e2c731 in logging-log4j2&apos;s branch refs/heads/release-2.x from lesiak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=43d9f81&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=43d9f81&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2522&quot; title=&quot;Make MapMessageLookup.lookup usable with MapMessage again&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2522&quot;&gt;&lt;del&gt;LOG4J2-2522&lt;/del&gt;&lt;/a&gt;  Added @Test testLookupDefaultMapIsCheckedBeforeMapMessage()&lt;/p&gt;</comment>
                            <comment id="16732133" author="jira-bot" created="Wed, 2 Jan 2019 14:55:33 +0000"  >&lt;p&gt;Commit 35312ef6ae9486ef57f50614a88823aece5c096a in logging-log4j2&apos;s branch refs/heads/release-2.x from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=35312ef&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=35312ef&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Changelog for &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2522&quot; title=&quot;Make MapMessageLookup.lookup usable with MapMessage again&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2522&quot;&gt;&lt;del&gt;LOG4J2-2522&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16732134" author="jira-bot" created="Wed, 2 Jan 2019 14:56:17 +0000"  >&lt;p&gt;Commit 9f78ee05433759daf5f86538668165264ebfdada in logging-log4j2&apos;s branch refs/heads/master from Carter Kozak&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=9f78ee0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=9f78ee0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Changelog for &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2522&quot; title=&quot;Make MapMessageLookup.lookup usable with MapMessage again&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2522&quot;&gt;&lt;del&gt;LOG4J2-2522&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16732138" author="ckozak" created="Wed, 2 Jan 2019 14:58:00 +0000"  >&lt;p&gt;Thanks for your contribution &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lesiak&quot; class=&quot;user-hover&quot; rel=&quot;lesiak&quot;&gt;lesiak&lt;/a&gt;! I&apos;ve merged the fix to master and release-2.x. I would appreciate if you could verify against a snapshot build and close out the ticket &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13208811">LOG4J2-2530</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 46 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|u001w0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>