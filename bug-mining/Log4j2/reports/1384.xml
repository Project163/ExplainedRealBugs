<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:41:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-2717] Slow initialization under Windows</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-2717</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Together with feature &lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-913&quot; title=&quot;Allow to load log4j2 configuration from a centralized repository, like a database or a webservice&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-913&quot;&gt;&lt;del&gt;LOG4J2-913&lt;/del&gt;&lt;/a&gt; (included in 2.12.0) was introduced in commit cb905f37c1ec10e8aa7637dd9770e3cf4672c830 (&lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=cb905f3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=cb905f3&lt;/a&gt;) following change in the file &lt;tt&gt;WatchManager.java&lt;/tt&gt; (&lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;a=blob;f=log4j-core/src/main/java/org/apache/logging/log4j/core/util/WatchManager.java;h=3e3715258b498a55247e52d1cc360a91f5681a8f;hb=cb905f3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;a=blob;f=log4j-core/src/main/java/org/apache/logging/log4j/core/util/WatchManager.java;h=3e3715258b498a55247e52d1cc360a91f5681a8f;hb=cb905f3&lt;/a&gt;)&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; UUID id = UuidUtil.getTimeBasedUuid();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This change is causing that during log4j2 initialization are enumerated network interfaces (seems to be quite slow operation under Windows).&lt;/p&gt;

&lt;p&gt;Behavior can be reproduced with the simple test program:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; test;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.logging.log4j.LogManager;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.logging.log4j.Logger;

&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestLog4j2Startup {
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) {
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Test started&quot;&lt;/span&gt;);

        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Starting to initialize the logger&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; startTime = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
        Logger logger = LogManager.getLogger();
        &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; endTime = &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.currentTimeMillis();
        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Logger initialization took &quot;&lt;/span&gt; + (endTime - startTime) + &lt;span class=&quot;code-quote&quot;&gt;&quot; ms&quot;&lt;/span&gt;);

        logger.info(&lt;span class=&quot;code-quote&quot;&gt;&quot;Hello from log4j2!&quot;&lt;/span&gt;);

        &lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;Test finished&quot;&lt;/span&gt;);
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Execution of the following command then prints how much time initialization takes:&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;java -cp .;log4j-api-2.12.1.jar;log4j-core-2.12.1.jar test.TestLog4j2Startup&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Delay is depending on number of enabled network interfaces. In our case delay in the initialization is between 5 to 10 seconds.&lt;/p&gt;

&lt;p&gt;The same command with log4j2 version 2.11.2 is executed as expected (within few hundreds of milliseconds).&lt;/p&gt;

&lt;p&gt;Suggested solution: Late initialization of the &lt;tt&gt;id&lt;/tt&gt; field or different mechanism how &lt;tt&gt;id&lt;/tt&gt; is generated.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Tested JDKs:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;jdk1.8.0_221&lt;/li&gt;
	&lt;li&gt;jdk-9.0.4&lt;/li&gt;
	&lt;li&gt;jdk-11.0.4&lt;/li&gt;
	&lt;li&gt;jdk-12.0.2&lt;/li&gt;
	&lt;li&gt;jdk-13.0.1&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Tested OS: Windows 10 1809&lt;/p&gt;</environment>
        <key id="13265798">LOG4J2-2717</key>
            <summary>Slow initialization under Windows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rgoers">Ralph Goers</assignee>
                                    <reporter username="libor.svehlak">Libor Svehlak</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Nov 2019 16:52:11 +0000</created>
                <updated>Thu, 5 Mar 2020 16:20:03 +0000</updated>
                            <resolved>Sun, 23 Feb 2020 22:00:38 +0000</resolved>
                                    <version>2.12.0</version>
                    <version>2.12.1</version>
                                    <fixVersion>2.13.1</fixVersion>
                                    <component>Core</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17006715" author="libor.svehlak" created="Thu, 2 Jan 2020 10:14:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rgoers&quot; class=&quot;user-hover&quot; rel=&quot;rgoers&quot;&gt;rgoers&lt;/a&gt;: Do we need in WatchManager id based on UUID or can we use more light-weight approach? How requirements for id look like?&lt;/p&gt;</comment>
                            <comment id="17043069" author="jira-bot" created="Sun, 23 Feb 2020 21:25:28 +0000"  >&lt;p&gt;Commit 66693211f3ed47297ca0bf9139ae4ff1889424eb in logging-log4j2&apos;s branch refs/heads/release-2.x from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=6669321&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=6669321&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2717&quot; title=&quot;Slow initialization under Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2717&quot;&gt;&lt;del&gt;LOG4J2-2717&lt;/del&gt;&lt;/a&gt; - Slow initialization on Windows due to accessing network interfaces.&lt;/p&gt;</comment>
                            <comment id="17043073" author="jira-bot" created="Sun, 23 Feb 2020 21:59:25 +0000"  >&lt;p&gt;Commit dae33df9ad7ff4e233427d30859e8bbde3925f27 in logging-log4j2&apos;s branch refs/heads/master from Ralph Goers&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=dae33df&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=dae33df&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-2717&quot; title=&quot;Slow initialization under Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-2717&quot;&gt;&lt;del&gt;LOG4J2-2717&lt;/del&gt;&lt;/a&gt; - Slow initialization on Windows due to accessing network interfaces.&lt;/p&gt;</comment>
                            <comment id="17043074" author="ralph.goers@dslextreme.com" created="Sun, 23 Feb 2020 22:00:38 +0000"  >&lt;p&gt;I was not able to duplicate the problem on Windows, however the code was modified to use a simplified UUID. Please verify and close.&lt;/p&gt;</comment>
                            <comment id="17052112" author="libor.svehlak" created="Thu, 5 Mar 2020 13:01:55 +0000"  >&lt;p&gt;I can confirm that issue is resolved with log4j2 version 2.13.1.&lt;/p&gt;</comment>
                            <comment id="17052299" author="ralph.goers@dslextreme.com" created="Thu, 5 Mar 2020 16:20:03 +0000"  >&lt;p&gt;Closing based on feedback.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 36 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z086j4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>