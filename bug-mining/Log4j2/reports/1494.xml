<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:42:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-3172] SmtpManager sends emails with OFF level messages</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-3172</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;I occasionally receive emails with logs that have OFF level and no message when using &amp;lt;SMTP&amp;gt; with a filter and the setting -Dlog4j2.contextSelector=org.apache.logging.log4j.core.async.AsyncLoggerContextSelector.&lt;/p&gt;

&lt;p&gt;I believe the cause is that AsyncLoggerContextSelector uses RingBufferLogEvents, and when the filter matches these events are buffered by the SmtpManager and then cleared soon after by the RingBufferLogEventHandler. Once the SmtpManager&apos;s buffer has filled, the empty events are added to the email.&lt;/p&gt;

&lt;p&gt;There is logic in SmtpManager.add(LogEvent) to copy the contents of mutable messages, and it might be appropriate to do the same for&#160;RingBufferLogEvents.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13406031">LOG4J2-3172</key>
            <summary>SmtpManager sends emails with OFF level messages</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="vy">Volkan Yazici</assignee>
                                    <reporter username="barrynfleming">Barry Fleming</reporter>
                        <labels>
                    </labels>
                <created>Mon, 11 Oct 2021 21:12:43 +0000</created>
                <updated>Tue, 19 Oct 2021 21:40:36 +0000</updated>
                            <resolved>Tue, 19 Oct 2021 06:41:28 +0000</resolved>
                                    <version>2.14.1</version>
                                    <fixVersion>2.15.0</fixVersion>
                                    <component>Appenders</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17429142" author="vy" created="Fri, 15 Oct 2021 07:17:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=barrynfleming&quot; class=&quot;user-hover&quot; rel=&quot;barrynfleming&quot;&gt;barrynfleming&lt;/a&gt;, thanks for the bug report and elaborate investigation. Indeed copying the contents of mutable messages sounds like the way to go? Mind submitting a GitHub PR for the fix, please?&lt;/p&gt;</comment>
                            <comment id="17429390" author="barrynfleming" created="Fri, 15 Oct 2021 17:15:14 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vy&quot; class=&quot;user-hover&quot; rel=&quot;vy&quot;&gt;vy&lt;/a&gt;, opened &lt;a href=&quot;https://github.com/apache/logging-log4j2/pull/588&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/logging-log4j2/pull/588&lt;/a&gt;&#160;for this.&lt;/p&gt;</comment>
                            <comment id="17430338" author="jira-bot" created="Tue, 19 Oct 2021 06:40:40 +0000"  >&lt;p&gt;Commit d7905bb98a61706f20c5617d33e3da7c982ee1d9 in logging-log4j2&apos;s branch refs/heads/release-2.x from Barry Fleming&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=d7905bb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=d7905bb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3172&quot; title=&quot;SmtpManager sends emails with OFF level messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3172&quot;&gt;&lt;del&gt;LOG4J2-3172&lt;/del&gt;&lt;/a&gt; Buffer immutable log events in the SmtpManager. (#588)&lt;/p&gt;

&lt;p&gt;Co-authored-by: Barry Fleming &amp;lt;barry.fleming@theice.com&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17430344" author="jira-bot" created="Tue, 19 Oct 2021 06:46:00 +0000"  >&lt;p&gt;Commit 5baac5651788bd9b844f176e5b572f3a93a6ba32 in logging-log4j2&apos;s branch refs/heads/master from Volkan Yaz&#305;c&#305;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=5baac56&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=5baac56&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3172&quot; title=&quot;SmtpManager sends emails with OFF level messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3172&quot;&gt;&lt;del&gt;LOG4J2-3172&lt;/del&gt;&lt;/a&gt; Buffer immutable log events in the SmtpManager. (#588)&lt;/p&gt;

&lt;p&gt;Co-authored-by: Barry Fleming &amp;lt;barry.fleming@theice.com&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17430345" author="jira-bot" created="Tue, 19 Oct 2021 06:46:09 +0000"  >&lt;p&gt;Commit 8998d6f715425bbdbc2c10d776f7a221de66e936 in logging-log4j2&apos;s branch refs/heads/release-2.x from Volkan Yazici&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=8998d6f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=8998d6f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3172&quot; title=&quot;SmtpManager sends emails with OFF level messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3172&quot;&gt;&lt;del&gt;LOG4J2-3172&lt;/del&gt;&lt;/a&gt; Update `changes.xml`.&lt;/p&gt;</comment>
                            <comment id="17430781" author="jira-bot" created="Tue, 19 Oct 2021 21:40:36 +0000"  >&lt;p&gt;Commit 775423cbdb506bbe1977e05b7378185564bfc307 in logging-log4j2&apos;s branch refs/heads/master from Volkan Yaz&#305;c&#305;&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=775423c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=logging-log4j2.git;h=775423c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LOG4J2-3172&quot; title=&quot;SmtpManager sends emails with OFF level messages&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LOG4J2-3172&quot;&gt;&lt;del&gt;LOG4J2-3172&lt;/del&gt;&lt;/a&gt; Fix broken SmtpManagerTest.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 4 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0vr6w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>