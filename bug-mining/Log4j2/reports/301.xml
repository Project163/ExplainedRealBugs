<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 19:32:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[LOG4J2-619] Unable to recover after loading corrupted XML</title>
                <link>https://issues.apache.org/jira/browse/LOG4J2-619</link>
                <project id="12310790" key="LOG4J2">Log4j 2</project>
                    <description>&lt;p&gt;Steps to reproduce:&lt;br/&gt;
1) auto-reloading of log4j 2.x configuration from XML is enabled&lt;br/&gt;
2) system is started and producing logs&lt;br/&gt;
3) change XML configuration, so it&apos;s not valid XML any longer&lt;br/&gt;
4) Wait till it would be picked up -&amp;gt; no more logging info is produced, exception can be found from logs (see below).&lt;br/&gt;
5) Fix XML configuration -&amp;gt; it&apos;s not getting reloaded anymore, only java restart can fix the problem.&lt;/p&gt;

&lt;p&gt;log4j2.xml org.xml.sax.SAXParseException; lineNumber: 1; columnNumber: 7; The processi&lt;br/&gt;
ng instruction target matching &quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;xX&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;mM&amp;#93;&lt;/span&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;lL&amp;#93;&lt;/span&gt;&quot; is not allowed.&lt;br/&gt;
        at com.sun.org.apache.xerces.internal.parsers.DOMParser.parse(DOMParser.java:257)&lt;br/&gt;
        at com.sun.org.apache.xerces.internal.jaxp.DocumentBuilderImpl.parse(DocumentBuilderImpl.java:347)&lt;br/&gt;
        at org.apache.logging.log4j.core.config.XMLConfiguration.&amp;lt;init&amp;gt;(XMLConfiguration.java:145)&lt;br/&gt;
        at org.apache.logging.log4j.core.config.XMLConfiguration.reconfigure(XMLConfiguration.java:286)&lt;br/&gt;
        at org.apache.logging.log4j.core.LoggerContext.onChange(LoggerContext.java:421)&lt;br/&gt;
        at org.apache.logging.log4j.core.config.FileConfigurationMonitor.checkConfiguration(FileConfigurationMonitor.java:79)&lt;br/&gt;
        at org.apache.logging.log4j.core.Logger$PrivateConfig.filter(Logger.java:279)&lt;br/&gt;
        at org.apache.logging.log4j.core.Logger.isEnabled(Logger.java:117)&lt;br/&gt;
        at org.apache.logging.log4j.spi.AbstractLoggerWrapper.isEnabled(AbstractLoggerWrapper.java:82)&lt;br/&gt;
        at org.apache.logging.log4j.spi.AbstractLogger.isDebugEnabled(AbstractLogger.java:1071)&lt;br/&gt;
        at org.slf4j.impl.SLF4JLogger.isDebugEnabled(SLF4JLogger.java:174)&lt;br/&gt;
        at org.apache.commons.logging.impl.SLF4JLocationAwareLog.isDebugEnabled(SLF4JLocationAwareLog.java:67)&lt;br/&gt;
....&lt;/p&gt;

&lt;p&gt;ERROR No logging configuration&lt;/p&gt;</description>
                <environment>&lt;p&gt;CentOS 6.5, Oracle Java 7 u55&lt;/p&gt;</environment>
        <key id="12710880">LOG4J2-619</key>
            <summary>Unable to recover after loading corrupted XML</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="BerkOFF">Sergey Burkov</reporter>
                        <labels>
                    </labels>
                <created>Mon, 28 Apr 2014 08:46:21 +0000</created>
                <updated>Tue, 17 Jun 2014 03:55:06 +0000</updated>
                            <resolved>Mon, 16 Jun 2014 00:56:50 +0000</resolved>
                                    <version>2.0-rc1</version>
                                    <fixVersion>2.0-rc2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14019305" author="ralph.goers@dslextreme.com" created="Thu, 5 Jun 2014 21:30:32 +0000"  >&lt;p&gt;I think this issue may have been fixed with the changes made in LOG4J-620. Can you please retest with the latest in trunk?&lt;/p&gt;</comment>
                            <comment id="14032038" author="seh4nc" created="Sun, 15 Jun 2014 22:36:58 +0000"  >&lt;p&gt;Hi, I am not the original submitter but I observed this as well, in both rc1 and in trunk r1602630, and it turns out to be easy to fix (patch is attached).&lt;/p&gt;

&lt;p&gt;The issue is that XmlConfiguration constructor (a) swallows exceptions, and (b) encounters the parse failure before populating the FileConfigurationMonitor. So reconfigure() returns an instance that is useless AND that will never check the file again.&lt;/p&gt;

&lt;p&gt;A similar issue might exist in JsonConfiguration but I don&apos;t have an easy way to test that.&lt;/p&gt;

&lt;p&gt;An alternate fix would be to NOT swallow exceptions in the constructor. But I looked at the other callers e.g. XmlConfigurationFactory and concluded those cases are probably o.k. with a useless Configuration (unlike reconfigure which really shouldn&apos;t rip the monitor out from under us).&lt;/p&gt;</comment>
                            <comment id="14032058" author="jvz" created="Mon, 16 Jun 2014 00:10:41 +0000"  >&lt;p&gt;I&apos;ve applied the patch in r1602778. Could you verify if this fixes the error?&lt;/p&gt;</comment>
                            <comment id="14032069" author="seh4nc" created="Mon, 16 Jun 2014 00:54:17 +0000"  >&lt;p&gt;Hi Matt, I&apos;ve updated to 1602778 and the XML reconfigure cycle works as expected when invalid XML is encountered. Thanks!&lt;/p&gt;</comment>
                            <comment id="14032070" author="jvz" created="Mon, 16 Jun 2014 00:56:50 +0000"  >&lt;p&gt;Fixed in r1602778 and verified by user.&lt;/p&gt;</comment>
                            <comment id="14033410" author="ralph.goers@dslextreme.com" created="Tue, 17 Jun 2014 03:55:06 +0000"  >&lt;p&gt;The fix was bad.  It checked for a rootElement being null and if it was it returned null. But it never returned the new configuration, so the reconfigure method was always returning null and the new configuration never took effect. Fixed in revision 1603048.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12710971">LOG4J2-620</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12650497" name="log4j-r1602630-reconfigure.patch" size="1193" author="seh4nc" created="Sun, 15 Jun 2014 22:34:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>389201</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 23 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1v1hb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>389447</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>