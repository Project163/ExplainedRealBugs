diff --git a/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/KeyStoreConfigurationTest.java b/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/KeyStoreConfigurationTest.java
index cb76930170..c957771e70 100644
--- a/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/KeyStoreConfigurationTest.java
+++ b/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/KeyStoreConfigurationTest.java
@@ -16,13 +16,26 @@
  */
 package org.apache.logging.log4j.core.net.ssl;
 
-import org.junit.jupiter.api.Test;
+import static org.junit.jupiter.api.Assertions.assertDoesNotThrow;
+import static org.junit.jupiter.api.Assertions.assertNotNull;
+import static org.junit.jupiter.api.Assertions.assertSame;
+import static org.junit.jupiter.api.Assertions.assertThrows;
 
 import java.security.KeyStore;
+import java.util.Collections;
+import java.util.function.Supplier;
+import java.util.stream.Stream;
 
-import static org.junit.jupiter.api.Assertions.*;
+import org.junit.jupiter.api.Test;
+import org.junit.jupiter.api.condition.OS;
+import org.junit.jupiter.params.ParameterizedTest;
+import org.junit.jupiter.params.provider.Arguments;
+import org.junit.jupiter.params.provider.MethodSource;
+import org.junitpioneer.jupiter.SetSystemProperty;
 
+@SetSystemProperty(key = "sun.security.mscapi.keyStoreCompatibilityMode", value = "false")
 public class KeyStoreConfigurationTest {
+
     @SuppressWarnings("deprecation")
     @Test
     public void loadEmptyConfigurationDeprecated() {
@@ -43,14 +56,34 @@ public class KeyStoreConfigurationTest {
                         TestConstants.KEYSTORE_TYPE, null);
         final KeyStore ks = ksc.getKeyStore();
         assertNotNull(ks);
+        checkKeystoreConfiguration(ksc);
     }
 
-    @Test
-    public void loadNotEmptyConfiguration() throws StoreConfigurationException {
-        final KeyStoreConfiguration ksc = new KeyStoreConfiguration(TestConstants.KEYSTORE_FILE, new MemoryPasswordProvider(TestConstants.KEYSTORE_PWD()),
-                TestConstants.KEYSTORE_TYPE, null);
+    static Stream<Arguments> configurations() {
+        final Stream.Builder<Arguments> builder = Stream.builder();
+        builder.add(Arguments.of(TestConstants.KEYSTORE_FILE, (Supplier<char[]>) TestConstants::KEYSTORE_PWD,
+                TestConstants.KEYSTORE_TYPE))
+                .add(Arguments.of(TestConstants.KEYSTORE_PKCS12_FILE,
+                        (Supplier<char[]>) TestConstants::KEYSTORE_PKCS12_PWD, TestConstants.KEYSTORE_PKCS12_TYPE))
+                .add(Arguments.of(TestConstants.KEYSTORE_EMPTYPASS_FILE,
+                        (Supplier<char[]>) TestConstants::KEYSTORE_EMPTYPASS_PWD,
+                        TestConstants.KEYSTORE_EMPTYPASS_TYPE));
+        if (OS.WINDOWS.isCurrentOs()) {
+            builder.add(Arguments.of(null, (Supplier<char[]>) () -> null, "Windows-MY"))
+                    .add(Arguments.of(null, (Supplier<char[]>) () -> null, "Windows-ROOT"));
+        }
+        return builder.build();
+    }
+
+    @ParameterizedTest
+    @MethodSource("configurations")
+    public void loadNotEmptyConfiguration(final String keystoreFile, final Supplier<char[]> password,
+            final String keystoreType) throws StoreConfigurationException {
+        final KeyStoreConfiguration ksc = new KeyStoreConfiguration(keystoreFile,
+                new MemoryPasswordProvider(password.get()), keystoreType, null);
         final KeyStore ks = ksc.getKeyStore();
         assertNotNull(ks);
+        checkKeystoreConfiguration(ksc);
     }
 
     @Test
@@ -79,9 +112,42 @@ public class KeyStoreConfigurationTest {
                 () -> new KeyStoreConfiguration(TestConstants.KEYSTORE_FILE, "wrongPassword!", null, null));
     }
 
-    @Test
-    public void wrongPassword() {
-        assertThrows(StoreConfigurationException.class, () -> new KeyStoreConfiguration(TestConstants.KEYSTORE_FILE,
-                new MemoryPasswordProvider("wrongPassword!".toCharArray()), null, null));
+    static Stream<Arguments> wrongConfigurations() {
+        final Stream.Builder<Arguments> builder = Stream.builder();
+        builder.add(Arguments.of(TestConstants.KEYSTORE_FILE, (Supplier<char[]>) TestConstants::KEYSTORE_EMPTYPASS_PWD,
+                TestConstants.KEYSTORE_TYPE))
+                .add(Arguments.of(TestConstants.KEYSTORE_FILE, (Supplier<char[]>) () -> "wrongPassword!".toCharArray(),
+                        TestConstants.KEYSTORE_TYPE))
+                .add(Arguments.of(TestConstants.KEYSTORE_PKCS12_FILE,
+                        (Supplier<char[]>) TestConstants::KEYSTORE_EMPTYPASS_PWD, TestConstants.KEYSTORE_PKCS12_TYPE))
+                .add(Arguments.of(TestConstants.KEYSTORE_PKCS12_FILE,
+                        (Supplier<char[]>) TestConstants::KEYSTORE_EMPTYPASS_PWD, TestConstants.KEYSTORE_PKCS12_TYPE));
+        if (OS.WINDOWS.isCurrentOs()) {
+            builder.add(Arguments.of(null, (Supplier<char[]>) () -> new char[0], "Windows-MY"))
+                    .add(Arguments.of(null, (Supplier<char[]>) () -> new char[0], "Windows-ROOT"));
+        }
+        return builder.build();
+    }
+
+    @ParameterizedTest
+    @MethodSource("wrongConfigurations")
+    public void wrongPassword(final String keystoreFile, final Supplier<char[]> password, final String keystoreType) {
+        assertThrows(StoreConfigurationException.class, () -> new KeyStoreConfiguration(keystoreFile,
+                new MemoryPasswordProvider(password.get()), keystoreType, null));
+    }
+
+    static void checkKeystoreConfiguration(final AbstractKeyStoreConfiguration config) {
+        // Not all keystores throw immediately if the password is wrong
+        assertDoesNotThrow(() -> {
+            final KeyStore ks = config.load();
+            for (final String alias : Collections.list(ks.aliases())) {
+                if (ks.isCertificateEntry(alias)) {
+                    ks.getCertificate(alias);
+                }
+                if (ks.isKeyEntry(alias)) {
+                    ks.getKey(alias, config.getPasswordAsCharArray());
+                }
+            }
+        });
     }
 }
diff --git a/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/SslConfigurationFactoryTest.java b/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/SslConfigurationFactoryTest.java
index a153b73e04..55bd0b86ed 100644
--- a/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/SslConfigurationFactoryTest.java
+++ b/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/SslConfigurationFactoryTest.java
@@ -20,20 +20,33 @@ import static org.junit.jupiter.api.Assertions.assertNotNull;
 import static org.junit.jupiter.api.Assertions.assertNull;
 
 import java.util.Properties;
+import java.util.stream.Stream;
 
 import org.apache.logging.log4j.util.PropertiesUtil;
 import org.junit.jupiter.api.Test;
+import org.junit.jupiter.api.condition.EnabledOnOs;
+import org.junit.jupiter.api.condition.OS;
+import org.junit.jupiter.params.ParameterizedTest;
+import org.junit.jupiter.params.provider.Arguments;
+import org.junit.jupiter.params.provider.MethodSource;
 
 public class SslConfigurationFactoryTest {
 
+    private static final String trustStorelocation = "log4j2.trustStoreLocation";
+    private static final String trustStorePassword = "log4j2.trustStorePassword";
+    private static final String trustStoreKeyStoreType = "log4j2.trustStoreKeyStoreType";
+    private static final String keyStoreLocation = "log4j2.keyStoreLocation";
+    private static final String keyStorePassword = "log4j2.keyStorePassword";
+    private static final String keyStoreType = "log4j2.keyStoreType";
+
     private static void addKeystoreConfiguration(Properties props) {
-        props.setProperty("log4j2.keyStoreLocation", TestConstants.KEYSTORE_FILE_RESOURCE);
-        props.setProperty("log4j2.keyStoreKeyStoreType", TestConstants.KEYSTORE_TYPE);
+        props.setProperty(keyStoreLocation, TestConstants.KEYSTORE_FILE_RESOURCE);
+        props.setProperty(keyStoreType, TestConstants.KEYSTORE_TYPE);
     }
 
     private static void addTruststoreConfiguration(Properties props) {
-        props.setProperty("log4j2.trustStoreLocation", TestConstants.TRUSTSTORE_FILE_RESOURCE);
-        props.setProperty("log4j2.trustStoreKeyStoreType", TestConstants.TRUSTSTORE_TYPE);
+        props.setProperty(trustStorelocation, TestConstants.TRUSTSTORE_FILE_RESOURCE);
+        props.setProperty(trustStoreKeyStoreType, TestConstants.TRUSTSTORE_TYPE);
     }
 
     @Test
@@ -69,4 +82,41 @@ public class SslConfigurationFactoryTest {
         assertNotNull(sslConfiguration.getKeyStoreConfig());
         assertNotNull(sslConfiguration.getTrustStoreConfig());
     }
+
+    static Stream<Arguments> windowsKeystoreConfigs() {
+        final String[] emptyOrNull = { "", null };
+        final Stream.Builder<Arguments> builder = Stream.builder();
+        for (final String location : emptyOrNull) {
+            for (final String password : emptyOrNull) {
+                builder.add(Arguments.of(location, password));
+            }
+        }
+        return builder.build();
+    }
+
+    @EnabledOnOs(OS.WINDOWS)
+    @ParameterizedTest
+    @MethodSource("windowsKeystoreConfigs")
+    public void testPasswordLessStores(final String location, final String password) {
+        final Properties props = new Properties();
+        props.setProperty(keyStoreType, "Windows-MY");
+        props.setProperty(trustStoreKeyStoreType, "Windows-ROOT");
+        if (location != null) {
+            props.setProperty(keyStoreLocation, location);
+            props.setProperty(trustStorelocation, location);
+        }
+        if (password != null) {
+            props.setProperty(keyStorePassword, password);
+            props.setProperty(trustStorePassword, password);
+        }
+        final PropertiesUtil util = new PropertiesUtil(props);
+        final SslConfiguration config = SslConfigurationFactory.createSslConfiguration(util);
+        assertNotNull(config);
+        final KeyStoreConfiguration keyStoreConfig = config.getKeyStoreConfig();
+        assertNotNull(keyStoreConfig);
+        KeyStoreConfigurationTest.checkKeystoreConfiguration(keyStoreConfig);
+        final TrustStoreConfiguration trustStoreConfig = config.getTrustStoreConfig();
+        assertNotNull(trustStoreConfig);
+        KeyStoreConfigurationTest.checkKeystoreConfiguration(trustStoreConfig);
+    }
 }
diff --git a/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/TestConstants.java b/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/TestConstants.java
index 90b3bed7c4..a258f6f88c 100644
--- a/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/TestConstants.java
+++ b/log4j-core/src/test/java/org/apache/logging/log4j/core/net/ssl/TestConstants.java
@@ -36,5 +36,19 @@ public class TestConstants {
     public static final char[] KEYSTORE_PWD() { return "changeit".toCharArray(); }
     public static final String KEYSTORE_TYPE = "JKS";
 
+    public static final String KEYSTORE_PKCS12_PATH = PATH;
+    public static final String KEYSTORE_PKCS12_RESOURCE = RESOURCE_ROOT;
+    public static final String KEYSTORE_PKCS12_FILE = KEYSTORE_PKCS12_PATH + "client.log4j2-keystore.p12";
+    public static final String KEYSTORE_PKCS12_FILE_RESOURCE = KEYSTORE_PKCS12_RESOURCE + "client.log4j2-keystore.p12";
+    public static final char[] KEYSTORE_PKCS12_PWD() { return "changeit".toCharArray(); }
+    public static final String KEYSTORE_PKCS12_TYPE = "PKCS12";
+
+    public static final String KEYSTORE_EMPTYPASS_PATH = PATH;
+    public static final String KEYSTORE_EMPTYPASS_RESOURCE = RESOURCE_ROOT;
+    public static final String KEYSTORE_EMPTYPASS_FILE = KEYSTORE_EMPTYPASS_PATH + "client.log4j2-keystore-nopass.p12";
+    public static final String KEYSTORE_EMPTYPASS_FILE_RESOURCE = KEYSTORE_EMPTYPASS_RESOURCE + "client.log4j-keystore-nopass.p12";
+    public static final char[] KEYSTORE_EMPTYPASS_PWD() { return new char[0]; }
+    public static final String KEYSTORE_EMPTYPASS_TYPE = "PKCS12";
+
     public static final char[] NULL_PWD = null;
 }
diff --git a/log4j-core/src/test/resources/org/apache/logging/log4j/core/net/ssl/client.log4j2-keystore-nopass.p12 b/log4j-core/src/test/resources/org/apache/logging/log4j/core/net/ssl/client.log4j2-keystore-nopass.p12
new file mode 100644
index 0000000000..447135c3fe
Binary files /dev/null and b/log4j-core/src/test/resources/org/apache/logging/log4j/core/net/ssl/client.log4j2-keystore-nopass.p12 differ
diff --git a/log4j-core/src/test/resources/org/apache/logging/log4j/core/net/ssl/client.log4j2-keystore.p12 b/log4j-core/src/test/resources/org/apache/logging/log4j/core/net/ssl/client.log4j2-keystore.p12
new file mode 100644
index 0000000000..e2b135864e
Binary files /dev/null and b/log4j-core/src/test/resources/org/apache/logging/log4j/core/net/ssl/client.log4j2-keystore.p12 differ
