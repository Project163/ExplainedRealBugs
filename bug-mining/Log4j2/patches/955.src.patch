diff --git a/log4j-api/src/main/java/org/apache/logging/log4j/spi/ThreadContextMapFactory.java b/log4j-api/src/main/java/org/apache/logging/log4j/spi/ThreadContextMapFactory.java
index b44f88312a..196867a24d 100644
--- a/log4j-api/src/main/java/org/apache/logging/log4j/spi/ThreadContextMapFactory.java
+++ b/log4j-api/src/main/java/org/apache/logging/log4j/spi/ThreadContextMapFactory.java
@@ -55,7 +55,7 @@ public final class ThreadContextMapFactory {
                 LOGGER.error("Unable to create configured ThreadContextMap {}", threadContextMapName, ex);
             }
         }
-        if (result == null && ProviderUtil.hasProviders()) {
+        if (result == null && ProviderUtil.hasProviders() && LogManager.getFactory() != null) { //LOG4J2-1658
             final String factoryClassName = LogManager.getFactory().getClass().getName();
             for (final Provider provider : ProviderUtil.getProviders()) {
                 if (factoryClassName.equals(provider.getClassName())) {
diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 4d91ada09f..53c7c36bb3 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -24,6 +24,9 @@
   </properties>
   <body>
     <release version="2.7.1" date="2016-MM-DD" description="GA Release 2.7.1">
+      <action issue="LOG4J2-1658" dev="rpopma" type="fix">
+        Prevent NPE in ThreadContextMapFactory::createThreadContextMap when initializing Log4j with Configurator::initialize and the BasicContextSelector is used.
+      </action>
       <action issue="LOG4J2-1645" dev="mikes" type="fix">
         Immutable empty StringMap.
       </action>
