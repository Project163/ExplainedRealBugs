diff --git a/log4j-nosql/src/main/java/org/apache/logging/log4j/nosql/appender/AbstractNoSqlConnection.java b/log4j-nosql/src/main/java/org/apache/logging/log4j/nosql/appender/AbstractNoSqlConnection.java
new file mode 100644
index 0000000000..ac52eba713
--- /dev/null
+++ b/log4j-nosql/src/main/java/org/apache/logging/log4j/nosql/appender/AbstractNoSqlConnection.java
@@ -0,0 +1,48 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements. See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache license, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License. You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the license for the specific language governing permissions and
+ * limitations under the license.
+ */
+
+package org.apache.logging.log4j.nosql.appender;
+
+import java.util.concurrent.atomic.AtomicBoolean;
+
+/**
+ * Facilitates implementations of {@link NoSqlConnection}.
+ *
+ * @param <W>
+ *            See {@link NoSqlConnection}.
+ * @param <T>See
+ *            {@link NoSqlConnection}.
+ */
+public abstract class AbstractNoSqlConnection<W, T extends NoSqlObject<W>> implements NoSqlConnection<W, T> {
+
+    private final AtomicBoolean closed = new AtomicBoolean(false);
+
+    @Override
+    public void close() {
+        if (this.closed.compareAndSet(false, true)) {
+            closeImpl();
+        }
+    }
+
+    protected abstract void closeImpl();
+
+    @Override
+    public boolean isClosed() {
+        return this.closed.get();
+    }
+
+}
diff --git a/log4j-nosql/src/main/java/org/apache/logging/log4j/nosql/appender/couchdb/CouchDbConnection.java b/log4j-nosql/src/main/java/org/apache/logging/log4j/nosql/appender/couchdb/CouchDbConnection.java
index dd77d38c81..2494a5c20d 100644
--- a/log4j-nosql/src/main/java/org/apache/logging/log4j/nosql/appender/couchdb/CouchDbConnection.java
+++ b/log4j-nosql/src/main/java/org/apache/logging/log4j/nosql/appender/couchdb/CouchDbConnection.java
@@ -1,76 +1,69 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements. See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache license, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License. You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the license for the specific language governing permissions and
- * limitations under the license.
- */
-package org.apache.logging.log4j.nosql.appender.couchdb;
-
-import java.util.Map;
-import java.util.concurrent.atomic.AtomicBoolean;
-
-import org.apache.logging.log4j.core.appender.AppenderLoggingException;
-import org.apache.logging.log4j.nosql.appender.DefaultNoSqlObject;
-import org.apache.logging.log4j.nosql.appender.NoSqlConnection;
-import org.apache.logging.log4j.nosql.appender.NoSqlObject;
-import org.apache.logging.log4j.util.Strings;
-import org.lightcouch.CouchDbClient;
-import org.lightcouch.Response;
-
-/**
- * The Apache CouchDB implementation of {@link NoSqlConnection}.
- */
-public final class CouchDbConnection implements NoSqlConnection<Map<String, Object>, DefaultNoSqlObject> {
-    private final CouchDbClient client;
-    private final AtomicBoolean closed = new AtomicBoolean(false);
-
-    public CouchDbConnection(final CouchDbClient client) {
-        this.client = client;
-    }
-
-    @Override
-    public DefaultNoSqlObject createObject() {
-        return new DefaultNoSqlObject();
-    }
-
-    @Override
-    public DefaultNoSqlObject[] createList(final int length) {
-        return new DefaultNoSqlObject[length];
-    }
-
-    @Override
-    public void insertObject(final NoSqlObject<Map<String, Object>> object) {
-        try {
-            final Response response = this.client.save(object.unwrap());
-            if (Strings.isNotEmpty(response.getError())) {
-                throw new AppenderLoggingException("Failed to write log event to CouchDB due to error: " +
-                        response.getError() + '.');
-            }
-        } catch (final Exception e) {
-            throw new AppenderLoggingException("Failed to write log event to CouchDB due to error: " + e.getMessage(),
-                    e);
-        }
-    }
-
-    @Override
-    public void close() {
-        if (this.closed.compareAndSet(false, true)) {
-            this.client.shutdown();
-        }
-    }
-
-    @Override
-    public boolean isClosed() {
-        return this.closed.get();
-    }
-}
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements. See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache license, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License. You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the license for the specific language governing permissions and
+ * limitations under the license.
+ */
+package org.apache.logging.log4j.nosql.appender.couchdb;
+
+import java.util.Map;
+
+import org.apache.logging.log4j.core.appender.AppenderLoggingException;
+import org.apache.logging.log4j.nosql.appender.AbstractNoSqlConnection;
+import org.apache.logging.log4j.nosql.appender.DefaultNoSqlObject;
+import org.apache.logging.log4j.nosql.appender.NoSqlConnection;
+import org.apache.logging.log4j.nosql.appender.NoSqlObject;
+import org.apache.logging.log4j.util.Strings;
+import org.lightcouch.CouchDbClient;
+import org.lightcouch.Response;
+
+/**
+ * The Apache CouchDB implementation of {@link NoSqlConnection}.
+ */
+public final class CouchDbConnection extends AbstractNoSqlConnection<Map<String, Object>, DefaultNoSqlObject> {
+    private final CouchDbClient client;
+
+    public CouchDbConnection(final CouchDbClient client) {
+        this.client = client;
+    }
+
+    @Override
+    public DefaultNoSqlObject createObject() {
+        return new DefaultNoSqlObject();
+    }
+
+    @Override
+    public DefaultNoSqlObject[] createList(final int length) {
+        return new DefaultNoSqlObject[length];
+    }
+
+    @Override
+    public void insertObject(final NoSqlObject<Map<String, Object>> object) {
+        try {
+            final Response response = this.client.save(object.unwrap());
+            if (Strings.isNotEmpty(response.getError())) {
+                throw new AppenderLoggingException(
+                        "Failed to write log event to CouchDB due to error: " + response.getError() + '.');
+            }
+        } catch (final Exception e) {
+            throw new AppenderLoggingException("Failed to write log event to CouchDB due to error: " + e.getMessage(),
+                    e);
+        }
+    }
+
+    @Override
+    protected void closeImpl() {
+        this.client.shutdown();
+    }
+
+}
diff --git a/log4j-nosql/src/main/java/org/apache/logging/log4j/nosql/appender/mongodb/MongoDbConnection.java b/log4j-nosql/src/main/java/org/apache/logging/log4j/nosql/appender/mongodb/MongoDbConnection.java
index a803378b6a..6b65fc3725 100644
--- a/log4j-nosql/src/main/java/org/apache/logging/log4j/nosql/appender/mongodb/MongoDbConnection.java
+++ b/log4j-nosql/src/main/java/org/apache/logging/log4j/nosql/appender/mongodb/MongoDbConnection.java
@@ -19,6 +19,7 @@ package org.apache.logging.log4j.nosql.appender.mongodb;
 import org.apache.logging.log4j.Level;
 import org.apache.logging.log4j.Logger;
 import org.apache.logging.log4j.core.appender.AppenderLoggingException;
+import org.apache.logging.log4j.nosql.appender.AbstractNoSqlConnection;
 import org.apache.logging.log4j.nosql.appender.NoSqlConnection;
 import org.apache.logging.log4j.nosql.appender.NoSqlObject;
 import org.apache.logging.log4j.status.StatusLogger;
@@ -28,14 +29,13 @@ import org.bson.Transformer;
 import com.mongodb.BasicDBObject;
 import com.mongodb.DB;
 import com.mongodb.DBCollection;
-import com.mongodb.Mongo;
 import com.mongodb.MongoException;
 import com.mongodb.WriteConcern;
 
 /**
  * The MongoDB implementation of {@link NoSqlConnection}.
  */
-public final class MongoDbConnection implements NoSqlConnection<BasicDBObject, MongoDbObject> {
+public final class MongoDbConnection extends AbstractNoSqlConnection<BasicDBObject, MongoDbObject> {
 
     private static final Logger LOGGER = StatusLogger.getLogger();
 
@@ -52,11 +52,9 @@ public final class MongoDbConnection implements NoSqlConnection<BasicDBObject, M
     }
 
     private final DBCollection collection;
-    private final Mongo mongo;
     private final WriteConcern writeConcern;
 
     public MongoDbConnection(final DB database, final WriteConcern writeConcern, final String collectionName) {
-        this.mongo = database.getMongo();
         this.collection = database.getCollection(collectionName);
         this.writeConcern = writeConcern;
     }
@@ -82,15 +80,10 @@ public final class MongoDbConnection implements NoSqlConnection<BasicDBObject, M
     }
 
     @Override
-    public void close() {
-        // there's no need to call this.mongo.close() since that literally
-        // closes the connection
-        // MongoDBClient uses internal connection pooling
-        // for more details, see LOG4J2-591
+    public void closeImpl() {
+        // there's no need to call this.mongo.close() since that literally closes the connection.
+        // MongoDBClient uses internal connection pooling.
+        // For more details, see LOG4J2-591.
     }
 
-    @Override
-    public boolean isClosed() {
-        return !this.mongo.getConnector().isOpen();
-    }
 }
diff --git a/log4j-nosql/src/test/java/org/apache/logging/log4j/nosql/appender/MongoDbTest.java b/log4j-nosql/src/test/java/org/apache/logging/log4j/nosql/appender/MongoDbTest.java
index 2513526da4..44d3d21985 100644
--- a/log4j-nosql/src/test/java/org/apache/logging/log4j/nosql/appender/MongoDbTest.java
+++ b/log4j-nosql/src/test/java/org/apache/logging/log4j/nosql/appender/MongoDbTest.java
@@ -23,11 +23,11 @@ import org.junit.ClassRule;
 import org.junit.Ignore;
 import org.junit.Test;
 
-@Ignore("Requires a running MongoDB server")
+//@Ignore("Requires a running MongoDB server")
 public class MongoDbTest {
 
     @ClassRule
-    public static LoggerContextRule context = new LoggerContextRule("log4j2-mongodb.xml");
+    public static LoggerContextRule context = new LoggerContextRule("log4j2-mongodb-auth.xml");
 
     @Test
     public void test() {
diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index ff8f590dad..146b4e2512 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -30,6 +30,12 @@
       <action issue="LOG4J2-1127" dev="ggregory" type="fix">
         log4j2.xml cannot be parsed on Oracle Weblogic 12c
       </action>
+      <action issue="LOG4J2-1132" dev="ggregory" type="fix">
+        Do not use MongoDB driver 2.13.3 deprecated methods.
+      </action>
+      <action issue="LOG4J2-1040" dev="ggregory" type="update">
+        Update MongoDB driver from 2.13.3 to 3.0.4.
+      </action>
       <action issue="LOG4J2-1128" dev="ggregory" type="update">
         Reuse StringBuilder to improve performance for String-based layouts: CSV, GELF, HTML, RFC524, Syslog.
       </action>
