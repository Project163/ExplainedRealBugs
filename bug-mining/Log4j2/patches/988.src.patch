diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/CronTriggeringPolicy.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/CronTriggeringPolicy.java
index 7b1d231277..e5a19a1b97 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/CronTriggeringPolicy.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/CronTriggeringPolicy.java
@@ -76,6 +76,10 @@ public final class CronTriggeringPolicy extends AbstractTriggeringPolicy {
         if (!scheduler.isStarted()) {
             scheduler.incrementScheduledItems();
             scheduler.start();
+        } else if (scheduler.isStarted()) {
+            // make sure we have a thread pool
+            scheduler.incrementScheduledItems();
+            scheduler.initScheduledExecutorService();
         }
         future = scheduler.scheduleWithCron(cronExpression, new CronTrigger());
     }
diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/config/ConfigurationScheduler.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/config/ConfigurationScheduler.java
index a832cf4d73..f847acec19 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/config/ConfigurationScheduler.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/config/ConfigurationScheduler.java
@@ -41,6 +41,10 @@ public class ConfigurationScheduler extends AbstractLifeCycle {
     @Override
     public void start() {
         super.start();
+        initScheduledExecutorService();
+    }
+
+    public void initScheduledExecutorService() {
         if (scheduledItems > 0) {
             LOGGER.debug("{} starting {} threads", SIMPLE_NAME, scheduledItems);
             scheduledItems = Math.min(scheduledItems, MAX_SCHEDULED_ITEMS);
@@ -66,7 +70,7 @@ public class ConfigurationScheduler extends AbstractLifeCycle {
      * Increment the number of threads in the pool.
      */
     public void incrementScheduledItems() {
-        if (!isStarted()) {
+        if (executorService == null) {
             ++scheduledItems;
         } else {
             LOGGER.error("{} attempted to increment scheduled items after start", SIMPLE_NAME);
diff --git a/log4j-core/src/test/java/org/apache/logging/log4j/core/appender/rolling/CronTriggeringPolicyTest.java b/log4j-core/src/test/java/org/apache/logging/log4j/core/appender/rolling/CronTriggeringPolicyTest.java
index c54a7023d1..ba20a02f6b 100644
--- a/log4j-core/src/test/java/org/apache/logging/log4j/core/appender/rolling/CronTriggeringPolicyTest.java
+++ b/log4j-core/src/test/java/org/apache/logging/log4j/core/appender/rolling/CronTriggeringPolicyTest.java
@@ -1,108 +1,140 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements. See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache license, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License. You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the license for the specific language governing permissions and
- * limitations under the license.
- */
-
-package org.apache.logging.log4j.core.appender.rolling;
-
-import org.apache.logging.log4j.core.appender.RollingFileAppender;
-import org.apache.logging.log4j.core.config.NullConfiguration;
-import org.apache.logging.log4j.core.layout.PatternLayout;
-import org.junit.Assert;
-import org.junit.Before;
-import org.junit.Test;
-
-public class CronTriggeringPolicyTest {
-
-    private static final String FILE_PATTERN = "testcmd.log.%d{yyyy-MM-dd}";
-    private static final String FILE_NAME = "testcmd.log";
-    private static final String CRON_EXPRESSION = "0 0 0 * * ?";
-    
-    private NullConfiguration configuration;
-
-    @Before
-    public void before() {
-        configuration = new NullConfiguration();
-    }
-
-    private CronTriggeringPolicy createPolicy() {
-        return CronTriggeringPolicy.createPolicy(configuration, Boolean.TRUE.toString(), CRON_EXPRESSION);
-    }
-
-    private DefaultRolloverStrategy createStrategy() {
-        return DefaultRolloverStrategy.createStrategy("7", "1", "max", null, null, false, configuration);
-    }
-
-    private void testBuilder() {
-        // @formatter:off
-        final RollingFileAppender raf = RollingFileAppender.newBuilder()
-            .withName("test")
-            .withFileName(FILE_NAME)
-            .withFilePattern(FILE_PATTERN)
-            .withPolicy(createPolicy())
-            .withStrategy(createStrategy())
-            .setConfiguration(configuration)
-            .build();
-        // @formatter:on
-        Assert.assertNotNull(raf);
-    }
-
-    /**
-     * Tests LOG4J2-1474 CronTriggeringPolicy raise exception and fail to rollover log file when evaluateOnStartup is
-     * true.
-     */
-    @Test
-    public void testBuilderOnce() {
-        testBuilder();
-    }
-
-    /**
-     * Tests LOG4J2-1474 CronTriggeringPolicy raise exception and fail to rollover log file when evaluateOnStartup is
-     * true.
-     */
-    @Test
-    public void testBuilderSequence() {
-        testBuilder();
-        testBuilder();
-    }
-
-    private void testFactoryMethod() {
-        final CronTriggeringPolicy triggerPolicy = createPolicy();
-        final DefaultRolloverStrategy rolloverStrategy = createStrategy();
-
-        try (RollingFileManager fileManager = RollingFileManager.getFileManager(FILE_NAME,
-                FILE_PATTERN, true, true, triggerPolicy, rolloverStrategy, null,
-                PatternLayout.createDefaultLayout(), 0, true, false, configuration)) {
-            // trigger rollover
-            fileManager.initialize();
-            fileManager.rollover();
-        }
-    }
-
-    /**
-     * Tests LOG4J2-1474 CronTriggeringPolicy raise exception and fail to rollover log file when evaluateOnStartup is
-     * true.
-     */
-    @Test
-    public void testFactoryMethodOnce() {
-        testFactoryMethod();
-    }
-
-    @Test
-    public void testFactoryMethodSequence() {
-        testFactoryMethod();
-        testFactoryMethod();
-    }
-}
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements. See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache license, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License. You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the license for the specific language governing permissions and
+ * limitations under the license.
+ */
+
+package org.apache.logging.log4j.core.appender.rolling;
+
+import org.apache.logging.log4j.core.appender.RollingFileAppender;
+import org.apache.logging.log4j.core.appender.RollingRandomAccessFileAppender;
+import org.apache.logging.log4j.core.config.Configurator;
+import org.apache.logging.log4j.core.config.NullConfiguration;
+import org.apache.logging.log4j.core.layout.PatternLayout;
+import org.apache.logging.log4j.junit.CleanFiles;
+import org.junit.Assert;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+
+public class CronTriggeringPolicyTest {
+
+    private static final String CRON_EXPRESSION = "0 0 0 * * ?";
+    
+    private NullConfiguration configuration;
+
+//    @Rule
+//    public CleanFiles files = new CleanFiles("testcmd1.log");
+
+    @Before
+    public void before() {
+        configuration = new NullConfiguration();
+    }
+
+    private CronTriggeringPolicy createPolicy() {
+        return CronTriggeringPolicy.createPolicy(configuration, Boolean.TRUE.toString(), CRON_EXPRESSION);
+    }
+
+    private DefaultRolloverStrategy createStrategy() {
+        return DefaultRolloverStrategy.createStrategy("7", "1", "max", null, null, false, configuration);
+    }
+
+    private void testBuilder() {
+        // @formatter:off
+        final RollingFileAppender raf = RollingFileAppender.newBuilder()
+            .withName("test1")
+            .withFileName("testcmd1.log")
+            .withFilePattern("testcmd1.log.%d{yyyy-MM-dd}")
+            .withPolicy(createPolicy())
+            .withStrategy(createStrategy())
+            .setConfiguration(configuration)
+            .build();
+        // @formatter:on
+        Assert.assertNotNull(raf);
+    }
+
+    /**
+     * Tests LOG4J2-1474 CronTriggeringPolicy raise exception and fail to rollover log file when evaluateOnStartup is
+     * true.
+     */
+    @Test
+    public void testBuilderOnce() {
+        testBuilder();
+    }
+
+    /**
+     * Tests LOG4J2-1740 Add CronTriggeringPolicy programmatically leads to NPE
+     */
+    @Test
+    public void testLoggerContextAndBuilder() {
+        Configurator.initialize(configuration);
+        testBuilder();
+    }
+
+    /**
+     * Tests LOG4J2-1740 Add CronTriggeringPolicy programmatically leads to NPE
+     */
+    @Test
+    public void testRollingRandomAccessFileAppender() {
+        // @formatter:off
+        RollingRandomAccessFileAppender.newBuilder()
+            .withName("test2")
+            .withFileName("testcmd2.log")
+            .withFilePattern("testcmd2.log.%d{yyyy-MM-dd}")
+            .withPolicy(createPolicy())
+            .withStrategy(createStrategy())
+            .setConfiguration(configuration)
+            .build();
+        // @formatter:on
+    }
+
+    
+    /**
+     * Tests LOG4J2-1474 CronTriggeringPolicy raise exception and fail to rollover log file when evaluateOnStartup is
+     * true.
+     */
+    @Test
+    public void testBuilderSequence() {
+        testBuilder();
+        testBuilder();
+    }
+
+    private void testFactoryMethod() {
+        final CronTriggeringPolicy triggerPolicy = createPolicy();
+        final DefaultRolloverStrategy rolloverStrategy = createStrategy();
+
+        try (RollingFileManager fileManager = RollingFileManager.getFileManager("testcmd3.log",
+                "testcmd3.log.%d{yyyy-MM-dd}", true, true, triggerPolicy, rolloverStrategy, null,
+                PatternLayout.createDefaultLayout(), 0, true, false, configuration)) {
+            // trigger rollover
+            fileManager.initialize();
+            fileManager.rollover();
+        }
+    }
+
+    /**
+     * Tests LOG4J2-1474 CronTriggeringPolicy raise exception and fail to rollover log file when evaluateOnStartup is
+     * true.
+     */
+    @Test
+    public void testFactoryMethodOnce() {
+        testFactoryMethod();
+    }
+
+    @Test
+    public void testFactoryMethodSequence() {
+        testFactoryMethod();
+        testFactoryMethod();
+    }
+}
diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 5835c498a1..d3e42a62f2 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -162,6 +162,9 @@
       <action issue="LOG4J2-1736" dev="ggregory" type="fix">
         TcpSocketManagerFactory might leak Sockets when certain startup errors occur.
       </action>
+      <action issue="LOG4J2-1740" dev="ggregory" type="fix">
+        Add CronTriggeringPolicy programmatically leads to NPE.
+      </action>     
       <action issue="LOG4J2-1644" dev="ggregory" type="update" due-to="Tim Gokcen, Pavel Sivolobtchik">
         Inefficient locking in AbstractLoggerAdapter.
       </action>
