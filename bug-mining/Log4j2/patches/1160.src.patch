diff --git a/log4j-api/src/main/java/org/apache/logging/log4j/message/StructuredDataMessage.java b/log4j-api/src/main/java/org/apache/logging/log4j/message/StructuredDataMessage.java
index acb95a0f12..97acf382b6 100644
--- a/log4j-api/src/main/java/org/apache/logging/log4j/message/StructuredDataMessage.java
+++ b/log4j-api/src/main/java/org/apache/logging/log4j/message/StructuredDataMessage.java
@@ -339,6 +339,10 @@ public class StructuredDataMessage extends MapMessage<StructuredDataMessage, Str
         if (sdId == null || sdId.getName() == null) {
             return;
         }
+        if (Format.XML.equals(format)) {
+            asXml(sdId, sb);
+            return;
+        }
         sb.append('[');
         StringBuilders.appendValue(sb, sdId); // avoids toString if implements StringBuilderFormattable
         sb.append(' ');
@@ -352,6 +356,14 @@ public class StructuredDataMessage extends MapMessage<StructuredDataMessage, Str
         }
     }
 
+    private void asXml(StructuredDataId structuredDataId, StringBuilder sb) {
+        sb.append("<StructuredData>\n");
+        sb.append("<type>").append(type).append("</type>\n");
+        sb.append("<id>").append(structuredDataId).append("</id>\n");
+        super.asXml(sb);
+        sb.append("\n</StructuredData>\n");
+    }
+
     /**
      * Formats the message and return it.
      * @return the formatted message.
@@ -390,20 +402,6 @@ public class StructuredDataMessage extends MapMessage<StructuredDataMessage, Str
         return Format.FULL;
     }
 
-    private String asXml() {
-        final StringBuilder sb = new StringBuilder();
-        final StructuredDataId sdId = getId();
-        if (sdId == null || sdId.getName() == null || type == null) {
-            return sb.toString();
-        }
-        sb.append("<StructuredData>\n");
-        sb.append("<type>").append(type).append("</type>\n");
-        sb.append("<id>").append(sdId).append("</id>\n");
-        super.asXml(sb);
-        sb.append("</StructuredData>\n");
-        return sb.toString();
-    }
-
     @Override
     public String toString() {
         return asString(null, null);
diff --git a/log4j-api/src/test/java/org/apache/logging/log4j/message/StructuredDataMessageTest.java b/log4j-api/src/test/java/org/apache/logging/log4j/message/StructuredDataMessageTest.java
index 47116f2a76..51a4ceec46 100644
--- a/log4j-api/src/test/java/org/apache/logging/log4j/message/StructuredDataMessageTest.java
+++ b/log4j-api/src/test/java/org/apache/logging/log4j/message/StructuredDataMessageTest.java
@@ -37,6 +37,39 @@ public class StructuredDataMessageTest {
         assertEquals(expected, result);
     }
 
+    @Test
+    public void testMsgNonFull() {
+        final String testMsg = "Test message {}";
+        final StructuredDataMessage msg = new StructuredDataMessage("MsgId@12345", testMsg, "Alert");
+        msg.put("message", testMsg);
+        msg.put("project", "Log4j");
+        msg.put("memo", "This is a very long test memo to prevent regression of LOG4J2-114");
+        final String result = msg.getFormattedMessage(new String[] { "WHATEVER" });
+        final String expected = "[MsgId@12345 memo=\"This is a very long test memo to prevent regression of LOG4J2-114\" message=\"Test message {}\" project=\"Log4j\"]";
+        assertEquals(expected, result);
+    }
+
+    @Test
+    public void testMsgXml() {
+        final String testMsg = "Test message {}";
+        final StructuredDataMessage msg = new StructuredDataMessage("MsgId@12345", testMsg, "Alert");
+        msg.put("message", testMsg);
+        msg.put("project", "Log4j");
+        msg.put("memo", "This is a very long test memo to prevent regression of LOG4J2-114");
+        final String result = msg.getFormattedMessage(new String[] { "XML" });
+        final String expected =
+                  "<StructuredData>\n"
+                + "<type>Alert</type>\n"
+                + "<id>MsgId@12345</id>\n"
+                + "<Map>\n"
+                + "  <Entry key=\"memo\">This is a very long test memo to prevent regression of LOG4J2-114</Entry>\n"
+                + "  <Entry key=\"message\">Test message {}</Entry>\n"
+                + "  <Entry key=\"project\">Log4j</Entry>\n"
+                + "</Map>\n"
+                + "</StructuredData>\n";
+        assertEquals(expected, result);
+    }
+
     @Test
     public void testBuilder() {
         final String testMsg = "Test message {}";
