diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/pattern/EncodingPatternConverter.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/pattern/EncodingPatternConverter.java
index 65ac43990f..b9b917c87e 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/pattern/EncodingPatternConverter.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/pattern/EncodingPatternConverter.java
@@ -100,43 +100,56 @@ public final class EncodingPatternConverter extends LogEventPatternConverter {
         HTML {
             @Override
             void escape(final StringBuilder toAppendTo, final int start) {
-                for (int i = toAppendTo.length() - 1; i >= start; i--) { // backwards: length may change
+
+                // do this in two passes to keep O(n) time complexity
+
+                final int origLength = toAppendTo.length();
+                int firstSpecialChar = origLength;
+
+                for (int i = origLength - 1; i >= start; i--) {
                     final char c = toAppendTo.charAt(i);
-                    switch (c) {
-                        case '\r':
-                            toAppendTo.setCharAt(i, '\\');
-                            toAppendTo.insert(i + 1, 'r');
-                            break;
-                        case '\n':
-                            toAppendTo.setCharAt(i, '\\');
-                            toAppendTo.insert(i + 1, 'n');
-                            break;
-                        case '&':
-                            toAppendTo.setCharAt(i, '&');
-                            toAppendTo.insert(i + 1, "amp;");
-                            break;
-                        case '<':
-                            toAppendTo.setCharAt(i, '&');
-                            toAppendTo.insert(i + 1, "lt;");
-                            break;
-                        case '>':
-                            toAppendTo.setCharAt(i, '&');
-                            toAppendTo.insert(i + 1, "gt;");
-                            break;
-                        case '"':
-                            toAppendTo.setCharAt(i, '&');
-                            toAppendTo.insert(i + 1, "quot;");
-                            break;
-                        case '\'':
-                            toAppendTo.setCharAt(i, '&');
-                            toAppendTo.insert(i + 1, "apos;");
-                            break;
-                        case '/':
-                            toAppendTo.setCharAt(i, '&');
-                            toAppendTo.insert(i + 1, "#x2F;");
-                            break;
+                    final String escaped = escapeChar(c);
+                    if (escaped != null) {
+                        firstSpecialChar = i;
+                        for (int j = 0; j < escaped.length() - 1; j++) {
+                            toAppendTo.append(' '); // make room for the escape sequence
+                        }
                     }
                 }
+
+                for (int i = origLength - 1, j = toAppendTo.length(); i >= firstSpecialChar; i--) {
+                    final char c = toAppendTo.charAt(i);
+                    final String escaped = escapeChar(c);
+                    if (escaped == null) {
+                        toAppendTo.setCharAt(--j, c);
+                    } else {
+                        toAppendTo.replace(j - escaped.length(), j, escaped);
+                        j -= escaped.length();
+                    }
+                }
+            }
+
+            private String escapeChar(char c) {
+                switch (c) {
+                    case '\r':
+                        return "\\r";
+                    case '\n':
+                        return "\\n";
+                    case '&':
+                        return "&amp;";
+                    case '<':
+                        return "&lt;";
+                    case '>':
+                        return "&gt;";
+                    case '"':
+                        return "&quot;";
+                    case '\'':
+                        return "&apos;";
+                    case '/':
+                        return "&#x2F;";
+                    default:
+                        return null;
+                }
             }
         },
 
@@ -155,17 +168,33 @@ public final class EncodingPatternConverter extends LogEventPatternConverter {
         CRLF {
             @Override
             void escape(final StringBuilder toAppendTo, final int start) {
-                for (int i = toAppendTo.length() - 1; i >= start; i--) { // backwards: length may change
+
+                // do this in two passes to keep O(n) time complexity
+
+                final int origLength = toAppendTo.length();
+                int firstSpecialChar = origLength;
+
+                for (int i = origLength - 1; i >= start; i--) {
+                    final char c = toAppendTo.charAt(i);
+                    if (c == '\r' || c == '\n') {
+                        firstSpecialChar = i;
+                        toAppendTo.append(' '); // make room for the escape sequence
+                    }
+                }
+
+                for (int i = origLength - 1, j = toAppendTo.length(); i >= firstSpecialChar; i--) {
                     final char c = toAppendTo.charAt(i);
                     switch (c) {
                         case '\r':
-                            toAppendTo.setCharAt(i, '\\');
-                            toAppendTo.insert(i + 1, 'r');
+                            toAppendTo.setCharAt(--j, 'r');
+                            toAppendTo.setCharAt(--j, '\\');
                             break;
                         case '\n':
-                            toAppendTo.setCharAt(i, '\\');
-                            toAppendTo.insert(i + 1, 'n');
+                            toAppendTo.setCharAt(--j, 'n');
+                            toAppendTo.setCharAt(--j, '\\');
                             break;
+                        default:
+                            toAppendTo.setCharAt(--j, c);
                     }
                 }
             }
