diff --git a/log4j-api/src/main/java/org/apache/logging/log4j/util/EnvironmentPropertySource.java b/log4j-api/src/main/java/org/apache/logging/log4j/util/EnvironmentPropertySource.java
index 84cec36a62..f2ef0df998 100644
--- a/log4j-api/src/main/java/org/apache/logging/log4j/util/EnvironmentPropertySource.java
+++ b/log4j-api/src/main/java/org/apache/logging/log4j/util/EnvironmentPropertySource.java
@@ -19,48 +19,53 @@ package org.apache.logging.log4j.util;
 import java.util.Map;
 
 /**
- * PropertySource implementation that uses environment variables as a source. All environment variables must begin
- * with {@code LOG4J_} so as not to conflict with other variables. Normalized environment variables follow a scheme
- * like this: {@code log4j2.fooBarProperty} would normalize to {@code LOG4J_FOO_BAR_PROPERTY}.
+ * PropertySource implementation that uses environment variables as a source.
+ * All environment variables must begin with {@code LOG4J_} so as not to
+ * conflict with other variables. Normalized environment variables follow a
+ * scheme like this: {@code log4j2.fooBarProperty} would normalize to
+ * {@code LOG4J_FOO_BAR_PROPERTY}.
  *
  * @since 2.10.0
  */
 public class EnvironmentPropertySource implements PropertySource {
 
-    private static final String PREFIX = "LOG4J_";
-    private static final int DEFAULT_PRIORITY = -100;
+	private static final String PREFIX = "LOG4J_";
+	private static final int DEFAULT_PRIORITY = -100;
 
-    @Override
-    public int getPriority() {
-        return DEFAULT_PRIORITY;
-    }
+	@Override
+	public int getPriority() {
+		return DEFAULT_PRIORITY;
+	}
 
-    @Override
-    public void forEach(final BiConsumer<String, String> action) {
-        final Map<String, String> getenv;
-        try {
-            getenv = System.getenv();
-        } catch (SecurityException e) {
-            // There is no status logger yet.
-            return;
-        }
-        for (final Map.Entry<String, String> entry : getenv.entrySet()) {
-            final String key = entry.getKey();
-            if (key.startsWith(PREFIX)) {
-                action.accept(key.substring(PREFIX.length()), entry.getValue());
-            }
-        }
-    }
+	@Override
+	public void forEach(final BiConsumer<String, String> action) {
+		final Map<String, String> getenv;
+		try {
+			getenv = System.getenv();
+		} catch (final SecurityException e) {
+			// There is no status logger yet.
+			LowLevelLogUtil.logException(
+					"The system environment variables are not available to Log4j due to security restrictions: " + e,
+					e);
+			return;
+		}
+		for (final Map.Entry<String, String> entry : getenv.entrySet()) {
+			final String key = entry.getKey();
+			if (key.startsWith(PREFIX)) {
+				action.accept(key.substring(PREFIX.length()), entry.getValue());
+			}
+		}
+	}
 
-    @Override
-    public CharSequence getNormalForm(final Iterable<? extends CharSequence> tokens) {
-        final StringBuilder sb = new StringBuilder("LOG4J");
-        for (final CharSequence token : tokens) {
-            sb.append('_');
-            for (int i = 0; i < token.length(); i++) {
-                sb.append(Character.toUpperCase(token.charAt(i)));
-            }
-        }
-        return sb.toString();
-    }
+	@Override
+	public CharSequence getNormalForm(final Iterable<? extends CharSequence> tokens) {
+		final StringBuilder sb = new StringBuilder("LOG4J");
+		for (final CharSequence token : tokens) {
+			sb.append('_');
+			for (int i = 0; i < token.length(); i++) {
+				sb.append(Character.toUpperCase(token.charAt(i)));
+			}
+		}
+		return sb.toString();
+	}
 }
diff --git a/log4j-api/src/main/java/org/apache/logging/log4j/util/SystemPropertiesPropertySource.java b/log4j-api/src/main/java/org/apache/logging/log4j/util/SystemPropertiesPropertySource.java
index 627b968b59..2509cd1e19 100644
--- a/log4j-api/src/main/java/org/apache/logging/log4j/util/SystemPropertiesPropertySource.java
+++ b/log4j-api/src/main/java/org/apache/logging/log4j/util/SystemPropertiesPropertySource.java
@@ -20,40 +20,52 @@ import java.util.Objects;
 import java.util.Properties;
 
 /**
- * PropertySource backed by the current system properties. Other than having a higher priority over normal properties,
- * this follows the same rules as {@link PropertiesPropertySource}.
+ * PropertySource backed by the current system properties. Other than having a
+ * higher priority over normal properties, this follows the same rules as
+ * {@link PropertiesPropertySource}.
  *
  * @since 2.10.0
  */
 public class SystemPropertiesPropertySource implements PropertySource {
 
-    private static final int DEFAULT_PRIORITY = 100;
-    private static final String PREFIX = "log4j2.";
+	private static final int DEFAULT_PRIORITY = 100;
+	private static final String PREFIX = "log4j2.";
 
-    @Override
-    public int getPriority() {
-        return DEFAULT_PRIORITY;
-    }
+	@Override
+	public int getPriority() {
+		return DEFAULT_PRIORITY;
+	}
 
-    @Override
-    public void forEach(final BiConsumer<String, String> action) {
-        final Properties properties = System.getProperties();
-        // Lock properties only long enough to get a thread-safe SAFE snapshot of its current keys, an array.
-        final Object[] keySet;
-        synchronized (properties) {
-            keySet = properties.keySet().toArray();
-        }
-        // Then traverse for an unknown amount of time.
-        // Some keys may now be absent, in which case, the value is null.
-        for (final Object key : keySet) {
-            final String keyStr = Objects.toString(key, null);
-            action.accept(keyStr, properties.getProperty(keyStr));
-        }
-    }
+	@Override
+	public void forEach(final BiConsumer<String, String> action) {
+		Properties properties;
+		try {
+			properties = System.getProperties();
+		} catch (final SecurityException e) {
+			// (1) There is no status logger.
+			// (2) LowLevelLogUtil also consults system properties ("line.separator") to
+			// open a BufferedWriter, so this may fail as well. Just having a hard reference
+			// in this code to LowLevelLogUtil would cause a problem.
+			// (3) We could log to System.err (nah) or just be quiet as we do now.
+			return;
+		}
+		// Lock properties only long enough to get a thread-safe SAFE snapshot of its
+		// current keys, an array.
+		final Object[] keySet;
+		synchronized (properties) {
+			keySet = properties.keySet().toArray();
+		}
+		// Then traverse for an unknown amount of time.
+		// Some keys may now be absent, in which case, the value is null.
+		for (final Object key : keySet) {
+			final String keyStr = Objects.toString(key, null);
+			action.accept(keyStr, properties.getProperty(keyStr));
+		}
+	}
 
-    @Override
-    public CharSequence getNormalForm(final Iterable<? extends CharSequence> tokens) {
-        return PREFIX + Util.joinAsCamelCase(tokens);
-    }
+	@Override
+	public CharSequence getNormalForm(final Iterable<? extends CharSequence> tokens) {
+		return PREFIX + Util.joinAsCamelCase(tokens);
+	}
 
 }
diff --git a/log4j-api/src/test/java/org/apache/logging/log4j/junit/SecurityManagerTestRule.java b/log4j-api/src/test/java/org/apache/logging/log4j/junit/SecurityManagerTestRule.java
new file mode 100644
index 0000000000..311b817bc9
--- /dev/null
+++ b/log4j-api/src/test/java/org/apache/logging/log4j/junit/SecurityManagerTestRule.java
@@ -0,0 +1,70 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements. See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache license, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License. You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the license for the specific language governing permissions and
+ * limitations under the license.
+ */
+
+package org.apache.logging.log4j.junit;
+
+import org.junit.rules.TestRule;
+import org.junit.runner.Description;
+import org.junit.runners.model.Statement;
+
+/**
+ * Sets a security manager for a test run. The current security manager is first
+ * saved then restored after the test is run.
+ * <p>
+ * Using a security manager can mess up other tests so this is best used from
+ * integration tests (classes that end in "IT" instead of "Test" and
+ * "TestCase".)
+ * </p>
+ * 
+ * @since 2.11.0
+ */
+public class SecurityManagerTestRule implements TestRule {
+
+	public SecurityManagerTestRule(final SecurityManager securityManager) {
+		super();
+		this.securityManager = securityManager;
+	}
+
+	private SecurityManager securityManagerBefore;
+	private final SecurityManager securityManager;
+
+	@Override
+	public Statement apply(final Statement base, final Description description) {
+		return new Statement() {
+			@Override
+			public void evaluate() throws Throwable {
+				before();
+				try {
+					base.evaluate();
+				} finally {
+					after();
+				}
+			}
+
+			private void after() {
+				System.setSecurityManager(securityManagerBefore);
+			}
+
+			private void before() {
+				securityManagerBefore = System.getSecurityManager();
+				System.setSecurityManager(securityManager);
+
+			}
+		};
+	}
+
+}
diff --git a/log4j-api/src/test/java/org/apache/logging/log4j/util/EnvironmentPropertySourceSecurityManagerTest.java b/log4j-api/src/test/java/org/apache/logging/log4j/util/EnvironmentPropertySourceSecurityManagerIT.java
similarity index 85%
rename from log4j-api/src/test/java/org/apache/logging/log4j/util/EnvironmentPropertySourceSecurityManagerTest.java
rename to log4j-api/src/test/java/org/apache/logging/log4j/util/EnvironmentPropertySourceSecurityManagerIT.java
index fe93c3df95..0020c057e3 100644
--- a/log4j-api/src/test/java/org/apache/logging/log4j/util/EnvironmentPropertySourceSecurityManagerTest.java
+++ b/log4j-api/src/test/java/org/apache/logging/log4j/util/EnvironmentPropertySourceSecurityManagerIT.java
@@ -19,16 +19,26 @@ package org.apache.logging.log4j.util;
 
 import java.security.Permission;
 
+import org.apache.logging.log4j.junit.SecurityManagerTestRule;
+import org.junit.Rule;
 import org.junit.Test;
 
 /**
  * Tests https://issues.apache.org/jira/browse/LOG4J2-2274.
+ * <p>
+ * Using a security manager can mess up other tests so this is best used from
+ * integration tests (classes that end in "IT" instead of "Test" and
+ * "TestCase".)
+ * </p>
  * 
  * @see EnvironmentPropertySource
  * @see SecurityManager
  * @see System#setSecurityManager(SecurityManager)
  */
-public class EnvironmentPropertySourceSecurityManagerTest {
+public class EnvironmentPropertySourceSecurityManagerIT {
+
+	@Rule
+	public final SecurityManagerTestRule rule = new SecurityManagerTestRule(new TestSecurityManager());
 
 	/**
 	 * Always throws a SecurityException for any environment variables permission
@@ -36,7 +46,7 @@ public class EnvironmentPropertySourceSecurityManagerTest {
 	 */
 	private class TestSecurityManager extends SecurityManager {
 		@Override
-		public void checkPermission(Permission permission) {
+		public void checkPermission(final Permission permission) {
 			if ("getenv.*".equals(permission.getName())) {
 				throw new SecurityException();
 			}
@@ -63,12 +73,6 @@ public class EnvironmentPropertySourceSecurityManagerTest {
 	 */
 	@Test
 	public void test() {
-		try {
-			SecurityManager securityManager = new TestSecurityManager();
-			System.setSecurityManager(securityManager);
-		} catch (SecurityException se) {
-			// The SecurityManager is already set
-		}
 		PropertiesUtil.getProperties();
 	}
 }
diff --git a/log4j-api/src/test/java/org/apache/logging/log4j/util/PropertyFilePropertySourceSecurityManagerIT.java b/log4j-api/src/test/java/org/apache/logging/log4j/util/PropertyFilePropertySourceSecurityManagerIT.java
new file mode 100644
index 0000000000..a6679d6682
--- /dev/null
+++ b/log4j-api/src/test/java/org/apache/logging/log4j/util/PropertyFilePropertySourceSecurityManagerIT.java
@@ -0,0 +1,79 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements. See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache license, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License. You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the license for the specific language governing permissions and
+ * limitations under the license.
+ */
+
+package org.apache.logging.log4j.util;
+
+import java.io.FilePermission;
+import java.nio.file.Files;
+import java.nio.file.Paths;
+import java.security.Permission;
+import java.util.PropertyPermission;
+
+import org.apache.logging.log4j.junit.SecurityManagerTestRule;
+import org.junit.Assert;
+import org.junit.Rule;
+import org.junit.Test;
+
+/**
+ * Test related to https://issues.apache.org/jira/browse/LOG4J2-2274.
+ * <p>
+ * Using a security manager can mess up other tests so this is best used from
+ * integration tests (classes that end in "IT" instead of "Test" and
+ * "TestCase".)
+ * </p>
+ * 
+ * @see PropertyFilePropertySource
+ * @see SecurityManager
+ * @see System#setSecurityManager(SecurityManager)
+ * @see PropertyPermission
+ */
+public class PropertyFilePropertySourceSecurityManagerIT {
+
+	@Rule
+	public final SecurityManagerTestRule rule = new SecurityManagerTestRule(new TestSecurityManager());
+
+	private static final String TEST_FIXTURE_PATH = "src/test/resources/PropertiesUtilTest.properties";
+
+	/**
+	 * Always throws a SecurityException for any environment variables permission
+	 * check.
+	 */
+	private class TestSecurityManager extends SecurityManager {
+
+		@Override
+		public void checkPermission(Permission permission) {
+			if (permission instanceof FilePermission && permission.getName().endsWith(TEST_FIXTURE_PATH)) {
+				throw new SecurityException();
+			}
+		}
+	}
+
+	/**
+	 * Makes sure we do not blow up with exception below due to a security manager
+	 * rejecting environment variable access in
+	 * {@link SystemPropertiesPropertySource}.
+	 * 
+	 * <pre>
+	 * </pre>
+	 */
+	@Test
+	public void test() {
+		Assert.assertTrue(TEST_FIXTURE_PATH, Files.exists(Paths.get(TEST_FIXTURE_PATH)));
+		PropertiesUtil propertiesUtil = new PropertiesUtil(TEST_FIXTURE_PATH);
+		Assert.assertEquals(null, propertiesUtil.getStringProperty("a.1"));
+	}
+}
diff --git a/log4j-api/src/test/java/org/apache/logging/log4j/util/SystemPropertiesPropertySourceSecurityManagerIT.java b/log4j-api/src/test/java/org/apache/logging/log4j/util/SystemPropertiesPropertySourceSecurityManagerIT.java
new file mode 100644
index 0000000000..ebab7100d5
--- /dev/null
+++ b/log4j-api/src/test/java/org/apache/logging/log4j/util/SystemPropertiesPropertySourceSecurityManagerIT.java
@@ -0,0 +1,86 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements. See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache license, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License. You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the license for the specific language governing permissions and
+ * limitations under the license.
+ */
+
+package org.apache.logging.log4j.util;
+
+import java.security.Permission;
+import java.util.PropertyPermission;
+
+import org.apache.logging.log4j.junit.SecurityManagerTestRule;
+import org.junit.Assert;
+import org.junit.Rule;
+import org.junit.Test;
+
+/**
+ * Test related to https://issues.apache.org/jira/browse/LOG4J2-2274.
+ * <p>
+ * Using a security manager can mess up other tests so this is best used from
+ * integration tests (classes that end in "IT" instead of "Test" and
+ * "TestCase".)
+ * </p>
+ * 
+ * @see SystemPropertiesPropertySource
+ * @see SecurityManager
+ * @see System#setSecurityManager(SecurityManager)
+ * @see PropertyPermission
+ */
+public class SystemPropertiesPropertySourceSecurityManagerIT {
+
+	@Rule
+	public final SecurityManagerTestRule rule = new SecurityManagerTestRule(new TestSecurityManager());
+
+	/**
+	 * Always throws a SecurityException for any environment variables permission
+	 * check.
+	 */
+	private class TestSecurityManager extends SecurityManager {
+		@Override
+		public void checkPermission(final Permission permission) {
+			if (permission instanceof PropertyPermission) {
+				throw new SecurityException();
+			}
+		}
+	}
+
+	/**
+	 * Makes sure we do not blow up with exception below due to a security manager
+	 * rejecting environment variable access in
+	 * {@link SystemPropertiesPropertySource}.
+	 * 
+	 * <pre>
+	 * java.lang.ExceptionInInitializerError
+	 * 	at org.apache.logging.log4j.util.SystemPropertiesPropertySourceSecurityManagerTest.test(SystemPropertiesPropertySourceSecurityManagerTest.java:64)
+	 * 	...
+	 * Caused by: java.lang.SecurityException
+	 * 	at org.apache.logging.log4j.util.SystemPropertiesPropertySourceSecurityManagerTest$TestSecurityManager.checkPermission(SystemPropertiesPropertySourceSecurityManagerTest.java:49)
+	 * 	at java.lang.SecurityManager.checkPropertiesAccess(SecurityManager.java:1265)
+	 * 	at java.lang.System.getProperties(System.java:624)
+	 * 	at org.apache.logging.log4j.util.SystemPropertiesPropertySource.forEach(SystemPropertiesPropertySource.java:40)
+	 * 	at org.apache.logging.log4j.util.PropertiesUtil$Environment.reload(PropertiesUtil.java:330)
+	 * 	at org.apache.logging.log4j.util.PropertiesUtil$Environment.<init>(PropertiesUtil.java:322)
+	 * 	at org.apache.logging.log4j.util.PropertiesUtil$Environment.<init>(PropertiesUtil.java:310)
+	 * 	at org.apache.logging.log4j.util.PropertiesUtil.<init>(PropertiesUtil.java:69)
+	 * 	at org.apache.logging.log4j.util.PropertiesUtil.<clinit>(PropertiesUtil.java:49)
+	 * 	... 26 more
+	 * </pre>
+	 */
+	@Test
+	public void test() {
+		final PropertiesUtil propertiesUtil = new PropertiesUtil("src/test/resources/PropertiesUtilTest.properties");
+		Assert.assertEquals(null, propertiesUtil.getStringProperty("a.1"));
+	}
+}
diff --git a/log4j-core/src/test/java/org/apache/logging/log4j/util/EnvironmentPropertySourceSecurityManagerTest.java b/log4j-core/src/test/java/org/apache/logging/log4j/util/EnvironmentPropertySourceSecurityManagerTest.java
deleted file mode 100644
index f85d640a2f..0000000000
--- a/log4j-core/src/test/java/org/apache/logging/log4j/util/EnvironmentPropertySourceSecurityManagerTest.java
+++ /dev/null
@@ -1,76 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements. See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache license, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License. You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the license for the specific language governing permissions and
- * limitations under the license.
- */
-
-package org.apache.logging.log4j.util;
-
-import java.security.Permission;
-
-import org.apache.logging.log4j.core.config.builder.api.ConfigurationBuilderFactory;
-import org.junit.Assert;
-import org.junit.Test;
-
-/**
- * Tests https://issues.apache.org/jira/browse/LOG4J2-2274.
- * 
- * @see EnvironmentPropertySource
- * @see SecurityManager
- * @see System#setSecurityManager(SecurityManager)
- */
-public class EnvironmentPropertySourceSecurityManagerTest {
-
-    /**
-     * Always throws a SecurityException for any environment variables permission check.
-     */
-    private class TestSecurityManager extends SecurityManager {
-        @Override
-        public void checkPermission(Permission permission) {
-            if ("getenv.*".equals(permission.getName())) {
-                throw new SecurityException();
-            }
-        }
-    }
-
-    /**
-     * Makes sure we do not blow up with exception below due to a security manager rejecting environment variable access
-     * in {@link EnvironmentPropertySource}.
-     * 
-     * <pre>
-     * java.lang.NoClassDefFoundError: Could not initialize class org.apache.logging.log4j.util.PropertiesUtil
-     *     at org.apache.logging.log4j.status.StatusLogger.<clinit>(StatusLogger.java:78)
-     *     at org.apache.logging.log4j.core.AbstractLifeCycle.<clinit>(AbstractLifeCycle.java:38)
-     *     at sun.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)
-     *     at sun.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)
-     *     at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
-     *     at java.lang.reflect.Constructor.newInstance(Constructor.java:423)
-     *     at org.apache.logging.log4j.core.config.builder.impl.DefaultConfigurationBuilder.build(DefaultConfigurationBuilder.java:172)
-     *     at org.apache.logging.log4j.core.config.builder.impl.DefaultConfigurationBuilder.build(DefaultConfigurationBuilder.java:161)
-     *     at org.apache.logging.log4j.core.config.builder.impl.DefaultConfigurationBuilder.build(DefaultConfigurationBuilder.java:1)
-     *     at org.apache.logging.log4j.util.EnvironmentPropertySourceSecurityManagerTest.test(EnvironmentPropertySourceSecurityManagerTest.java:55)
-     * </pre>
-     */
-    @Test
-    public void test() {
-        try {
-            SecurityManager securityManager = new TestSecurityManager();
-            System.setSecurityManager(securityManager);
-        } catch (SecurityException se) {
-            // The SecurityManager is already set
-        }
-
-        Assert.assertNotNull(ConfigurationBuilderFactory.newConfigurationBuilder().build());
-    }
-}
diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 372e34eba9..0af37ef12c 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -213,6 +213,9 @@
       <action issue="LOG4J2-2274" dev="ggregory" type="fix" due-to="Sebastien Lannez">
         Allow EnvironmentPropertySource to run with a SecurityManager that rejects environment variable access.
       </action>      
+      <action issue="LOG4J2-2279" dev="ggregory" type="fix" due-to="Gary Gregory">
+        Allow SystemPropertiesPropertySource to run with a SecurityManager that rejects system property access.
+      </action>      
     </release>
     <release version="2.10.0" date="2017-11-18" description="GA Release 2.10.0">
       <action issue="LOG4J2-2120" dev="mikes" type="add" due-to="Carter Douglas Kozak">
