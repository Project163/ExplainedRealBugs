diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/OutputStreamManager.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/OutputStreamManager.java
index 246abba57d..006558549b 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/OutputStreamManager.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/OutputStreamManager.java
@@ -28,8 +28,7 @@ import org.apache.logging.log4j.core.Layout;
 public class OutputStreamManager extends AbstractManager {
 
     private volatile OutputStream os;
-
-    private final Layout<?> layout;
+    protected final Layout<?> layout;
 
     protected OutputStreamManager(final OutputStream os, final String streamName, final Layout<?> layout) {
         super(streamName);
@@ -66,11 +65,21 @@ public class OutputStreamManager extends AbstractManager {
      */
     @Override
     public void releaseSub() {
+        writeFooter();
+        close();
+    }
+
+    /**
+     * Writes the footer.
+     */
+    protected void writeFooter() {
+        if (layout == null) {
+            return;
+        }
         byte[] footer = layout.getFooter();
         if (footer != null) {
             write(footer);
         }
-        close();
     }
 
     /**
diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/RollingFileManager.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/RollingFileManager.java
index c58b18cb3d..318470219f 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/RollingFileManager.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/RollingFileManager.java
@@ -167,6 +167,7 @@ public class RollingFileManager extends FileManager {
         try {
             final RolloverDescription descriptor = strategy.rollover(this);
             if (descriptor != null) {
+                writeFooter();
                 close();
                 if (descriptor.getSynchronous() != null) {
                     LOGGER.debug("RollingFileManager executing synchronous {}", descriptor.getSynchronous());
diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/RollingRandomAccessFileManager.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/RollingRandomAccessFileManager.java
index cc63bfe5a0..992ab09628 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/RollingRandomAccessFileManager.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/rolling/RollingRandomAccessFileManager.java
@@ -55,6 +55,26 @@ public class RollingRandomAccessFileManager extends RollingFileManager {
         this.randomAccessFile = raf;
         isEndOfBatch.set(Boolean.FALSE);
         this.buffer = ByteBuffer.allocate(bufferSize);
+        writeHeader();
+    }
+
+    /**
+     * Writes the layout's header to the file if it exists.
+     */
+    private void writeHeader() {
+        if (layout == null) {
+            return;
+        }
+        byte[] header = layout.getHeader();
+        if (header == null) {
+            return;
+        }
+        try {
+            // write to the file, not to the buffer: the buffer may not be empty
+            randomAccessFile.write(header, 0, header.length);
+        } catch (final IOException ioe) {
+            LOGGER.error("Unable to write header", ioe);
+        }
     }
 
     public static RollingRandomAccessFileManager getRollingRandomAccessFileManager(final String fileName,
@@ -99,6 +119,7 @@ public class RollingRandomAccessFileManager extends RollingFileManager {
         if (isAppend()) {
             randomAccessFile.seek(randomAccessFile.length());
         }
+        writeHeader();
     }
 
     @Override
diff --git a/log4j-core/src/test/java/org/apache/logging/log4j/core/appender/rolling/RollingRandomAccessFileManagerHeaderFooterTest.java b/log4j-core/src/test/java/org/apache/logging/log4j/core/appender/rolling/RollingRandomAccessFileManagerHeaderFooterTest.java
new file mode 100644
index 0000000000..c4d0cd2e27
--- /dev/null
+++ b/log4j-core/src/test/java/org/apache/logging/log4j/core/appender/rolling/RollingRandomAccessFileManagerHeaderFooterTest.java
@@ -0,0 +1,122 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements. See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache license, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License. You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the license for the specific language governing permissions and
+ * limitations under the license.
+ */
+package org.apache.logging.log4j.core.appender.rolling;
+
+import java.io.File;
+import java.io.FileInputStream;
+import java.nio.charset.Charset;
+
+import org.apache.logging.log4j.Logger;
+import org.apache.logging.log4j.core.layout.HtmlLayout;
+import org.apache.logging.log4j.junit.InitialLoggerContext;
+import org.junit.After;
+import org.junit.Before;
+import org.junit.Rule;
+import org.junit.Test;
+
+import static org.junit.Assert.*;
+
+/**
+ *
+ */
+public class RollingRandomAccessFileManagerHeaderFooterTest {
+
+    private static final String DIR = "target/RollingRandomAccessFileAppenderHeaderFooterTest/";
+    private static final String LOGFILE = "target/RollingRandomAccessFileAppenderHeaderFooterTest.log";
+
+    @Rule
+    public InitialLoggerContext init = new InitialLoggerContext("RollingRandomAccessFileAppenderHeaderFooterTest.xml");
+
+    private Logger logger;
+
+    @Before
+    public void setUp() throws Exception {
+        this.logger = this.init.getLogger(RollingRandomAccessFileManagerHeaderFooterTest.class.getName());
+        deleteDir();
+    }
+
+    @After
+    public void tearDown() throws Exception {
+        deleteDir();
+    }
+
+    @Test
+    public void testAppender() throws Exception {
+        for (int i = 0; i < 8; ++i) {
+            logger.debug("This is test message number " + i);
+        }
+        Thread.sleep(50);
+        final File dir = new File(DIR);
+        assertTrue("Directory not created", dir.exists() && dir.listFiles().length > 0);
+        final File[] files = dir.listFiles();
+        assertTrue("No files created", files.length > 0);
+        for (final File file : files) {
+            assertHeader(file);
+            assertFooter(file);
+        }
+        final File logFile = new File(LOGFILE);
+        assertTrue("Expected logfile to exist: " + LOGFILE, logFile.exists());
+        assertHeader(logFile);
+    }
+
+    private void assertHeader(File file) throws Exception {
+        HtmlLayout layout = HtmlLayout.createDefaultLayout();
+        String header = new String(layout.getHeader(), Charset.defaultCharset());
+        String withoutTimestamp = header.substring(0, 435);
+        String contents = new String(slurp(file), Charset.defaultCharset());
+        String contentsInitialChunk = contents.substring(0, 435);
+        assertEquals(file.getName(), withoutTimestamp, contentsInitialChunk);
+    }
+
+    private void assertFooter(File file) throws Exception {
+        HtmlLayout layout = HtmlLayout.createDefaultLayout();
+        String footer = new String(layout.getFooter(), Charset.defaultCharset());
+        String contents = new String(slurp(file), Charset.defaultCharset());
+        assertTrue(file.getName(), contents.endsWith(footer));
+    }
+
+    private byte[] slurp(File file) throws Exception {
+        FileInputStream in = null;
+        try {
+            in = new FileInputStream(file);
+            byte[] result = new byte[(int) file.length()];
+            int pos = 0;
+            int length = in.read(result);
+            while (length > 0) {
+                pos += length;
+                length = in.read(result, pos, result.length - pos);
+            }
+            return result;
+        } finally {
+            try {
+                in.close();
+            } catch (Exception ignored) {
+            }
+        }
+    }
+
+    private static void deleteDir() {
+        final File dir = new File(DIR);
+        if (dir.exists()) {
+            final File[] files = dir.listFiles();
+            for (final File file : files) {
+                file.delete();
+            }
+            dir.delete();
+        }
+    }
+}
diff --git a/log4j-core/src/test/resources/RollingRandomAccessFileAppenderHeaderFooterTest.xml b/log4j-core/src/test/resources/RollingRandomAccessFileAppenderHeaderFooterTest.xml
new file mode 100644
index 0000000000..d8a906611f
--- /dev/null
+++ b/log4j-core/src/test/resources/RollingRandomAccessFileAppenderHeaderFooterTest.xml
@@ -0,0 +1,22 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<Configuration status="OFF">
+  <Appenders>
+    <RollingRandomAccessFile name="RollingRandomAccessFile" fileName="target/RollingRandomAccessFileAppenderHeaderFooterTest.log"
+                 filePattern="target/RollingRandomAccessFileAppenderHeaderFooterTest/rolled%i.log" append="false"
+                 immediateFlush="true">
+      <HTMLLayout></HTMLLayout>
+      <Policies>
+      <!--
+        <TimeBasedTriggeringPolicy />
+      -->
+        <SizeBasedTriggeringPolicy size="1024" />
+      </Policies>
+    </RollingRandomAccessFile>
+  </Appenders>
+  
+  <Loggers>
+    <Root level="trace" includeLocation="false">
+      <AppenderRef ref="RollingRandomAccessFile"/>
+    </Root>
+  </Loggers>
+</Configuration>
\ No newline at end of file
diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index e12e523b39..b6deb15baa 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -22,6 +22,12 @@
   </properties>
   <body>
     <release version="2.0-rc2" date="2014-MM-DD" description="Bug fixes and enhancements">
+      <action issue="LOG4J2-675" dev="rpopma" type="add">
+        RollingFile and RollingRandomAccessFile now write the layout footer before rollover.
+      </action>
+      <action issue="LOG4J2-581" dev="rpopma" type="fix" due-to="Alexander Khokhlov">
+        RollingRandomAccessFile now writes the layout header after rollover.
+      </action>
       <action issue="LOG4J2-622" dev="rpopma" type="fix" due-to="Farooq Khan">
         RollingFileManager now correctly honours the bufferedIO configuration after rollover.
       </action>
