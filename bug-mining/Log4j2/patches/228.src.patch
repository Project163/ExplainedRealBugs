diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.java
index 986d2b9219..b203fb328f 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.java
@@ -243,22 +243,28 @@ public class BaseConfiguration extends AbstractFilterable implements Configurati
     protected void doConfigure() {
         boolean setRoot = false;
         boolean setLoggers = false;
-        for (final Node child : rootNode.getChildren()) {
-            createConfiguration(child, null);
-            if (child.getObject() == null) {
-                continue;
+        if (rootNode.hasChildren() && rootNode.getChildren().get(0).getName().equalsIgnoreCase("Properties")) {
+            Node first = rootNode.getChildren().get(0);
+            createConfiguration(first, null);
+            if (first.getObject() != null) {
+                subst.setVariableResolver((StrLookup) first.getObject());
             }
+        } else {
+            final Map<String, String> map = (Map<String, String>) componentMap.get(CONTEXT_PROPERTIES);
+            final StrLookup lookup = map == null ? null : new MapLookup(map);
+            subst.setVariableResolver(new Interpolator(lookup));
+        }
+
+        for (final Node child : rootNode.getChildren()) {
             if (child.getName().equalsIgnoreCase("Properties")) {
                 if (tempLookup == subst.getVariableResolver()) {
-                    subst.setVariableResolver((StrLookup) child.getObject());
-                } else {
                     LOGGER.error("Properties declaration must be the first element in the configuration");
                 }
                 continue;
-            } else if (tempLookup == subst.getVariableResolver()) {
-                final Map<String, String> map = (Map<String, String>) componentMap.get(CONTEXT_PROPERTIES);
-                final StrLookup lookup = map == null ? null : new MapLookup(map);
-                subst.setVariableResolver(new Interpolator(lookup));
+            }
+            createConfiguration(child, null);
+            if (child.getObject() == null) {
+                continue;
             }
             if (child.getName().equalsIgnoreCase("Appenders")) {
                 appenders = (ConcurrentMap<String, Appender>) child.getObject();
diff --git a/log4j-core/src/test/java/org/apache/logging/log4j/core/LoggerDateTest.java b/log4j-core/src/test/java/org/apache/logging/log4j/core/LoggerDateTest.java
new file mode 100644
index 0000000000..4bb54df28d
--- /dev/null
+++ b/log4j-core/src/test/java/org/apache/logging/log4j/core/LoggerDateTest.java
@@ -0,0 +1,81 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements. See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache license, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License. You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the license for the specific language governing permissions and
+ * limitations under the license.
+ */
+package org.apache.logging.log4j.core;
+
+import org.apache.logging.log4j.LogManager;
+import org.apache.logging.log4j.core.appender.FileAppender;
+import org.apache.logging.log4j.core.appender.RollingFileAppender;
+import org.apache.logging.log4j.core.config.Configuration;
+import org.apache.logging.log4j.core.config.ConfigurationFactory;
+import org.apache.logging.log4j.core.helpers.Constants;
+import org.apache.logging.log4j.core.helpers.NetUtils;
+import org.apache.logging.log4j.status.StatusLogger;
+import org.apache.logging.log4j.test.appender.ListAppender;
+import org.junit.AfterClass;
+import org.junit.Before;
+import org.junit.BeforeClass;
+import org.junit.Test;
+
+import java.util.Calendar;
+import java.util.List;
+import java.util.Map;
+
+import static org.junit.Assert.assertNotNull;
+import static org.junit.Assert.assertTrue;
+
+/**
+ *
+ */
+public class LoggerDateTest {
+
+    private static final String CONFIG = "log4j-date.xml";
+    private static Configuration config;
+    private static FileAppender fileApp;
+    private static LoggerContext ctx;
+
+    @BeforeClass
+    public static void setupClass() {
+        System.setProperty(ConfigurationFactory.CONFIGURATION_FILE_PROPERTY, CONFIG);
+        ctx = (LoggerContext) LogManager.getContext(false);
+    }
+
+    @AfterClass
+    public static void cleanupClass() {
+        System.clearProperty(ConfigurationFactory.CONFIGURATION_FILE_PROPERTY);
+        ctx.reconfigure();
+        StatusLogger.getLogger().reset();
+    }
+
+    @Before
+    public void before() {
+        config = ctx.getConfiguration();
+        for (final Map.Entry<String, Appender> entry : config.getAppenders().entrySet()) {
+            if (entry.getKey().equals("File")) {
+                fileApp = (FileAppender) entry.getValue();
+            }
+        }
+        assertNotNull("No FileAppender", fileApp);
+    }
+
+
+    @Test
+    public void testFileName() {
+        String name = fileApp.getFileName();
+        int year = Calendar.getInstance().get(Calendar.YEAR);
+        assertTrue("Date was not substituted: " + name, name.contains(Integer.toString(year)));
+    }
+}
diff --git a/log4j-core/src/test/resources/log4j-date.xml b/log4j-core/src/test/resources/log4j-date.xml
new file mode 100644
index 0000000000..cfdf9ac702
--- /dev/null
+++ b/log4j-core/src/test/resources/log4j-date.xml
@@ -0,0 +1,42 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+ Licensed to the Apache Software Foundation (ASF) under one or more
+ contributor license agreements.  See the NOTICE file distributed with
+ this work for additional information regarding copyright ownership.
+ The ASF licenses this file to You under the Apache License, Version 2.0
+ (the "License"); you may not use this file except in compliance with
+ the License.  You may obtain a copy of the License at
+
+      http://www.apache.org/licenses/LICENSE-2.0
+
+ Unless required by applicable law or agreed to in writing, software
+ distributed under the License is distributed on an "AS IS" BASIS,
+ WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ See the License for the specific language governing permissions and
+ limitations under the License.
+
+-->
+<Configuration status="warn" name="XMLConfigTest" packages="org.apache.logging.log4j.test">
+
+  <Appenders>
+    <File name="File" fileName="target/${date:yyyy-MM-dd HHmmss}.log" bufferedIO="false">
+      <PatternLayout>
+        <Pattern>%d %p %C{1.} [%t] %m%n</Pattern>
+      </PatternLayout>
+    </File>
+    <Console name="STDOUT">
+      <PatternLayout pattern="%m%n"/>
+    </Console>
+  </Appenders>
+
+  <Loggers>
+    <Logger name="org.apache.logging.log4j.test2" level="debug" additivity="false">
+      <AppenderRef ref="File"/>
+    </Logger>>
+
+    <Root level="error">
+      <AppenderRef ref="STDOUT"/>
+    </Root>
+  </Loggers>
+
+</Configuration>
\ No newline at end of file
diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 22931c409b..3142aabfea 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -21,6 +21,9 @@
   </properties>
   <body>
     <release version="2.0-RC1" date="2013-MM-DD" description="Bug fixes and enhancements">
+      <action issue="LOG4J2-398" dev="rgoers" type="fix">
+        Configure properties and setup Interpolator before processing rest of configuration.
+      </action>
       <action issue="LOG4J2-481" dev="rgoers" type="update" due-to="Matt Sicker">
         Add Stream interface to Loggers.
       </action>
