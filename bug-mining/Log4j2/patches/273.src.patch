diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/db/nosql/couchdb/CouchDBProvider.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/db/nosql/couchdb/CouchDBProvider.java
index a5750e7b19..3892a6e47b 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/db/nosql/couchdb/CouchDBProvider.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/db/nosql/couchdb/CouchDBProvider.java
@@ -21,6 +21,7 @@ import java.lang.reflect.Method;
 import org.apache.logging.log4j.Logger;
 import org.apache.logging.log4j.core.appender.AbstractAppender;
 import org.apache.logging.log4j.core.appender.db.nosql.NoSQLProvider;
+import org.apache.logging.log4j.core.config.plugins.SensitivePluginAttribute;
 import org.apache.logging.log4j.core.config.plugins.Plugin;
 import org.apache.logging.log4j.core.config.plugins.PluginAttribute;
 import org.apache.logging.log4j.core.config.plugins.PluginFactory;
@@ -86,7 +87,7 @@ public final class CouchDBProvider implements NoSQLProvider<CouchDBConnection> {
             @PluginAttribute("server") String server,
             @PluginAttribute("port") final String port,
             @PluginAttribute("username") final String username,
-            @PluginAttribute("password") final String password,
+            @SensitivePluginAttribute("password") final String password,
             @PluginAttribute("factoryClassName") final String factoryClassName,
             @PluginAttribute("factoryMethodName") final String factoryMethodName) {
         CouchDbClient client;
diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/db/nosql/mongodb/MongoDBProvider.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/db/nosql/mongodb/MongoDBProvider.java
index 6e1164cc41..0ddc586851 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/db/nosql/mongodb/MongoDBProvider.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/appender/db/nosql/mongodb/MongoDBProvider.java
@@ -23,6 +23,7 @@ import java.util.List;
 import org.apache.logging.log4j.Logger;
 import org.apache.logging.log4j.core.appender.AbstractAppender;
 import org.apache.logging.log4j.core.appender.db.nosql.NoSQLProvider;
+import org.apache.logging.log4j.core.config.plugins.SensitivePluginAttribute;
 import org.apache.logging.log4j.core.config.plugins.Plugin;
 import org.apache.logging.log4j.core.config.plugins.PluginAttribute;
 import org.apache.logging.log4j.core.config.plugins.PluginFactory;
@@ -97,7 +98,7 @@ public final class MongoDBProvider implements NoSQLProvider<MongoDBConnection> {
             @PluginAttribute("server") final String server,
             @PluginAttribute("port") final String port,
             @PluginAttribute("username") final String username,
-            @PluginAttribute("password") final String password,
+            @SensitivePluginAttribute("password") final String password,
             @PluginAttribute("factoryClassName") final String factoryClassName,
             @PluginAttribute("factoryMethodName") final String factoryMethodName) {
         DB database;
diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/config/plugins/PluginBuilder.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/config/plugins/PluginBuilder.java
index e1ae46e444..6844670f93 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/config/plugins/PluginBuilder.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/config/plugins/PluginBuilder.java
@@ -179,17 +179,15 @@ public class PluginBuilder<T> {
                 } else if (a instanceof PluginAttribute) {
                     final PluginAttribute attribute = (PluginAttribute) a;
                     final String name = attribute.value();
-                    final String value = configuration.getStrSubstitutor().replace(event, getAttrValue(name, aliases));
-                    args[i] = value;
-                    sb.append(name).append("=\"");
+                    args[i] = getReplacedAttributeValue(name, aliases);
+                    sb.append(name).append("=\"").append(args[i]).append('"');
+                } else if (a instanceof SensitivePluginAttribute) {
                     // LOG4J2-605
                     // we shouldn't be displaying passwords
-                    if ("password".equalsIgnoreCase(name)) {
-                        sb.append(NameUtil.md5(value + PluginBuilder.class.getName()));
-                    } else {
-                        sb.append(value);
-                    }
-                    sb.append('"');
+                    final SensitivePluginAttribute attribute = (SensitivePluginAttribute) a;
+                    final String name = attribute.value();
+                    args[i] = getReplacedAttributeValue(name, aliases);
+                    sb.append(name).append("=\"").append(NameUtil.md5(args[i] + PluginBuilder.class.getName())).append('"');
                 } else if (a instanceof PluginElement) {
                     final PluginElement element = (PluginElement) a;
                     final String name = element.value();
@@ -265,6 +263,10 @@ public class PluginBuilder<T> {
         return aliases;
     }
 
+    private String getReplacedAttributeValue(final String name, final String... aliases) {
+        return configuration.getStrSubstitutor().replace(event, getAttrValue(name, aliases));
+    }
+
     private String getAttrValue(final String name, final String... aliases) {
         final Map<String, String> attrs = node.getAttributes();
         for (final Map.Entry<String, String> entry : attrs.entrySet()) {
@@ -275,7 +277,7 @@ public class PluginBuilder<T> {
                 return attr;
             }
             if (aliases != null) {
-                for (String alias : aliases) {
+                for (final String alias : aliases) {
                     if (key.equalsIgnoreCase(alias)) {
                         final String attr = entry.getValue();
                         attrs.remove(key);
diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/config/plugins/SensitivePluginAttribute.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/config/plugins/SensitivePluginAttribute.java
new file mode 100644
index 0000000000..1d83ddaeaa
--- /dev/null
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/config/plugins/SensitivePluginAttribute.java
@@ -0,0 +1,36 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+
+package org.apache.logging.log4j.core.config.plugins;
+
+import java.lang.annotation.ElementType;
+import java.lang.annotation.Retention;
+import java.lang.annotation.RetentionPolicy;
+import java.lang.annotation.Target;
+
+/**
+ * Identifies a sensitive PluginAttribute. This means that the value should NOT be displayed in log messages anywhere
+ * and instead should be hashed.
+ *
+ * @see org.apache.logging.log4j.core.helpers.NameUtil#md5(String) MD5
+ * @see PluginAttribute
+ */
+@Retention(RetentionPolicy.RUNTIME)
+@Target(ElementType.PARAMETER)
+public @interface SensitivePluginAttribute {
+    String value();
+}
