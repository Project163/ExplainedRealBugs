diff --git a/core/src/main/java/org/apache/logging/log4j/core/selector/ClassLoaderContextSelector.java b/core/src/main/java/org/apache/logging/log4j/core/selector/ClassLoaderContextSelector.java
index d610afc87d..08d33bc994 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/selector/ClassLoaderContextSelector.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/selector/ClassLoaderContextSelector.java
@@ -99,7 +99,9 @@ public class ClassLoaderContextSelector implements ContextSelector {
 
             if (securityManager != null) {
                 Class clazz = securityManager.getCaller(fqcn);
-                return locateContext(clazz.getClassLoader(), null);
+                if (clazz != null) {
+                    return locateContext(clazz.getClassLoader(), null);
+                }
             }
 
             Throwable t = new Throwable();
diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index dd6a825226..8b82be0667 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -23,6 +23,10 @@
 
   <body>
     <release version="2.0-beta3" date="TBD" description= "Bug fixes and enhancements">
+      <action issue="LOG4J2-108" dev="rgoers" type="fix">
+        Fix NullPointerException in ClassLoaderContextSelector when no class is returned from
+        the SecurityManager.
+      </action>
       <action issue="LOG4J2-105" dev="rgoers" type="update">
         Add ability to customize the names of the Levels in the LevelPatternConverter.
       </action>
