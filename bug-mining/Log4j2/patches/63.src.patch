diff --git a/api/src/main/java/org/apache/logging/log4j/LogManager.java b/api/src/main/java/org/apache/logging/log4j/LogManager.java
index 82fe6596c6..0447c78515 100644
--- a/api/src/main/java/org/apache/logging/log4j/LogManager.java
+++ b/api/src/main/java/org/apache/logging/log4j/LogManager.java
@@ -29,7 +29,7 @@ import org.apache.logging.log4j.spi.LoggerContext;
 import org.apache.logging.log4j.spi.LoggerContextFactory;
 import org.apache.logging.log4j.spi.Provider;
 import org.apache.logging.log4j.status.StatusLogger;
-import org.apache.logging.log4j.util.PropsUtil;
+import org.apache.logging.log4j.util.PropertiesUtil;
 import org.apache.logging.log4j.util.ProviderUtil;
 
 /**
@@ -61,7 +61,7 @@ public class LogManager {
      */
     static {
         // Shortcut binding to force a specific logging implementation.
-        final PropsUtil managerProps = PropsUtil.getComponentProperties();
+        final PropertiesUtil managerProps = PropertiesUtil.getProperties();
         final String factoryClass = managerProps.getStringProperty(FACTORY_PROPERTY_NAME);
         final ClassLoader cl = ProviderUtil.findClassLoader();
         if (factoryClass != null) {
diff --git a/api/src/main/java/org/apache/logging/log4j/ThreadContext.java b/api/src/main/java/org/apache/logging/log4j/ThreadContext.java
index 9abc42c4a1..c2a13494a5 100644
--- a/api/src/main/java/org/apache/logging/log4j/ThreadContext.java
+++ b/api/src/main/java/org/apache/logging/log4j/ThreadContext.java
@@ -23,7 +23,7 @@ import org.apache.logging.log4j.spi.LoggerContextFactory;
 import org.apache.logging.log4j.spi.Provider;
 import org.apache.logging.log4j.spi.ThreadContextMap;
 import org.apache.logging.log4j.status.StatusLogger;
-import org.apache.logging.log4j.util.PropsUtil;
+import org.apache.logging.log4j.util.PropertiesUtil;
 import org.apache.logging.log4j.util.ProviderUtil;
 
 import java.io.Serializable;
@@ -62,18 +62,21 @@ public final class ThreadContext  {
 
     private static final String THREAD_CONTEXT_KEY = "log4j2.threadContextMap";
 
-    private static boolean all = Boolean.getBoolean(DISABLE_ALL);
+    private static boolean all;
 
-    private static boolean useMap = !(Boolean.getBoolean(DISABLE_MAP) || all);
+    private static boolean useMap;
 
-    private static boolean useStack = !(Boolean.getBoolean(DISABLE_STACK) || all);
+    private static boolean useStack;
 
     private static ThreadContextMap contextMap;
 
     private static final Logger LOGGER = StatusLogger.getLogger();
 
     static {
-        final PropsUtil managerProps = PropsUtil.getComponentProperties();
+        final PropertiesUtil managerProps = PropertiesUtil.getProperties();
+        all = managerProps.getBooleanProperty(DISABLE_ALL);
+        useMap = !(managerProps.getBooleanProperty(DISABLE_MAP) || all);
+        useStack = !(managerProps.getBooleanProperty(DISABLE_STACK) || all);
         String threadContextMapName = managerProps.getStringProperty(THREAD_CONTEXT_KEY);
         final ClassLoader cl = ProviderUtil.findClassLoader();
         if (threadContextMapName != null) {
diff --git a/api/src/main/java/org/apache/logging/log4j/simple/SimpleLogger.java b/api/src/main/java/org/apache/logging/log4j/simple/SimpleLogger.java
index 43d3b7b5ec..741ab7cf5e 100644
--- a/api/src/main/java/org/apache/logging/log4j/simple/SimpleLogger.java
+++ b/api/src/main/java/org/apache/logging/log4j/simple/SimpleLogger.java
@@ -29,7 +29,7 @@ import org.apache.logging.log4j.ThreadContext;
 import org.apache.logging.log4j.message.Message;
 import org.apache.logging.log4j.message.MessageFactory;
 import org.apache.logging.log4j.spi.AbstractLogger;
-import org.apache.logging.log4j.util.PropsUtil;
+import org.apache.logging.log4j.util.PropertiesUtil;
 
 /**
  *  This is the default logger that is used when no suitable logging implementation is available.
@@ -57,7 +57,7 @@ public class SimpleLogger extends AbstractLogger {
 
     public SimpleLogger(final String name, final Level defaultLevel, final boolean showLogName, final boolean showShortLogName,
                         final boolean showDateTime, final boolean showContextMap, final String dateTimeFormat,
-                        final MessageFactory messageFactory, final PropsUtil props, final PrintStream stream) {
+                        final MessageFactory messageFactory, final PropertiesUtil props, final PrintStream stream) {
         super(name, messageFactory);
         final String lvl = props.getStringProperty(SimpleLoggerContext.SYSTEM_PREFIX + name + ".level");
         this.level = Level.toLevel(lvl, defaultLevel);
diff --git a/api/src/main/java/org/apache/logging/log4j/simple/SimpleLoggerContext.java b/api/src/main/java/org/apache/logging/log4j/simple/SimpleLoggerContext.java
index 4be6017b0e..4852b7f50f 100644
--- a/api/src/main/java/org/apache/logging/log4j/simple/SimpleLoggerContext.java
+++ b/api/src/main/java/org/apache/logging/log4j/simple/SimpleLoggerContext.java
@@ -28,7 +28,7 @@ import org.apache.logging.log4j.Logger;
 import org.apache.logging.log4j.message.MessageFactory;
 import org.apache.logging.log4j.spi.AbstractLogger;
 import org.apache.logging.log4j.spi.LoggerContext;
-import org.apache.logging.log4j.util.PropsUtil;
+import org.apache.logging.log4j.util.PropertiesUtil;
 
 /**
  *
@@ -44,7 +44,7 @@ public class SimpleLoggerContext implements LoggerContext {
     /** Properties loaded from simplelog.properties */
     private final Properties simpleLogProps = new Properties();
 
-    private final PropsUtil props;
+    private final PropertiesUtil props;
 
     /** Include the instance name in the log message? */
     private final boolean showLogName;
@@ -65,7 +65,7 @@ public class SimpleLoggerContext implements LoggerContext {
     private final PrintStream stream;
 
     public SimpleLoggerContext() {
-        props = new PropsUtil("log4j2.simplelog.properties");
+        props = new PropertiesUtil("log4j2.simplelog.properties");
 
         showContextMap = props.getBooleanProperty(SYSTEM_PREFIX + "showContextMap", false);
         showLogName = props.getBooleanProperty(SYSTEM_PREFIX + "showlogname", false);
diff --git a/api/src/main/java/org/apache/logging/log4j/status/StatusConsoleListener.java b/api/src/main/java/org/apache/logging/log4j/status/StatusConsoleListener.java
index dae7944c8d..a0649726c4 100644
--- a/api/src/main/java/org/apache/logging/log4j/status/StatusConsoleListener.java
+++ b/api/src/main/java/org/apache/logging/log4j/status/StatusConsoleListener.java
@@ -17,6 +17,7 @@
 package org.apache.logging.log4j.status;
 
 import org.apache.logging.log4j.Level;
+import org.apache.logging.log4j.util.PropertiesUtil;
 
 import java.io.PrintStream;
 
@@ -39,7 +40,7 @@ public class StatusConsoleListener implements StatusListener {
      * default value of FATAL.
      */
     public StatusConsoleListener() {
-        final String str = System.getProperty(STATUS_LEVEL);
+        final String str = PropertiesUtil.getProperties().getStringProperty(STATUS_LEVEL);
         if (str != null) {
             level = Level.toLevel(str, Level.FATAL);
         }
diff --git a/api/src/main/java/org/apache/logging/log4j/status/StatusLogger.java b/api/src/main/java/org/apache/logging/log4j/status/StatusLogger.java
index 74d6bcb79a..4e5e44b1de 100644
--- a/api/src/main/java/org/apache/logging/log4j/status/StatusLogger.java
+++ b/api/src/main/java/org/apache/logging/log4j/status/StatusLogger.java
@@ -21,7 +21,7 @@ import org.apache.logging.log4j.spi.AbstractLogger;
 import org.apache.logging.log4j.Level;
 import org.apache.logging.log4j.Marker;
 import org.apache.logging.log4j.message.Message;
-import org.apache.logging.log4j.util.PropsUtil;
+import org.apache.logging.log4j.util.PropertiesUtil;
 
 import java.util.ArrayList;
 import java.util.Iterator;
@@ -60,7 +60,7 @@ public final class StatusLogger extends AbstractLogger {
     private final ReentrantLock msgLock = new ReentrantLock();
 
     private StatusLogger() {
-        final PropsUtil props = new PropsUtil("log4j2.StatusLogger.properties");
+        final PropertiesUtil props = new PropertiesUtil("log4j2.StatusLogger.properties");
         this.logger = new SimpleLogger("StatusLogger", Level.ERROR, false, true, false, false, "", null, props, System.err);
     }
 
@@ -246,7 +246,7 @@ public final class StatusLogger extends AbstractLogger {
     private class BoundedQueue<E> extends ConcurrentLinkedQueue<E> {
 
         private static final long serialVersionUID = -3945953719763255337L;
-        
+
         private final int size;
 
         public BoundedQueue(final int size) {
diff --git a/api/src/main/java/org/apache/logging/log4j/util/PropsUtil.java b/api/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.java
similarity index 69%
rename from api/src/main/java/org/apache/logging/log4j/util/PropsUtil.java
rename to api/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.java
index 27698cacec..8b6c3cf105 100644
--- a/api/src/main/java/org/apache/logging/log4j/util/PropsUtil.java
+++ b/api/src/main/java/org/apache/logging/log4j/util/PropertiesUtil.java
@@ -16,6 +16,9 @@
  */
 package org.apache.logging.log4j.util;
 
+import org.apache.logging.log4j.Logger;
+import org.apache.logging.log4j.status.StatusLogger;
+
 import java.io.IOException;
 import java.io.InputStream;
 import java.util.Properties;
@@ -23,21 +26,23 @@ import java.util.Properties;
 /**
  * Utility class to help with accessing System Properties.
  */
-public class PropsUtil {
+public class PropertiesUtil {
 
     private final Properties props;
 
-    private static final PropsUtil LOG4J_PROPERTIES = new PropsUtil("log4j2.component.properties");
+    private static final PropertiesUtil LOG4J_PROPERTIES = new PropertiesUtil("log4j2.component.properties");
+
+    private Logger logger;
 
-    public static PropsUtil getComponentProperties() {
+    public static PropertiesUtil getProperties() {
         return LOG4J_PROPERTIES;
     }
 
-    public PropsUtil(final Properties props) {
+    public PropertiesUtil(final Properties props) {
         this.props = props;
     }
 
-    public PropsUtil(final String propsLocn) {
+    public PropertiesUtil(final String propsLocn) {
         this.props = new Properties();
         final ClassLoader loader = ProviderUtil.findClassLoader();
         final InputStream in = loader.getResourceAsStream(propsLocn);
@@ -71,8 +76,26 @@ public class PropsUtil {
         return (prop == null) ? defaultValue : prop;
     }
 
+    public boolean getBooleanProperty(final String name) {
+        return getBooleanProperty(name, false);
+    }
+
     public boolean getBooleanProperty(final String name, final boolean defaultValue) {
         final String prop = getStringProperty(name);
         return (prop == null) ? defaultValue : "true".equalsIgnoreCase(prop);
     }
+
+    /**
+     * Return the system properties or an empty Properties object if an error occurs.
+     * @return The system properties.
+     */
+    public static Properties getSystemProperties() {
+        try {
+            return new Properties(System.getProperties());
+        } catch (final SecurityException ex) {
+            StatusLogger.getLogger().error("Unable to access system properties.");
+            // Sandboxed - can't read System Properties
+            return new Properties();
+        }
+    }
 }
diff --git a/core/src/main/java/org/apache/logging/log4j/core/appender/ConsoleAppender.java b/core/src/main/java/org/apache/logging/log4j/core/appender/ConsoleAppender.java
index 94f041f2fb..a9c880883d 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/appender/ConsoleAppender.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/appender/ConsoleAppender.java
@@ -24,6 +24,7 @@ import org.apache.logging.log4j.core.config.plugins.PluginElement;
 import org.apache.logging.log4j.core.config.plugins.PluginFactory;
 import org.apache.logging.log4j.core.helpers.Loader;
 import org.apache.logging.log4j.core.layout.PatternLayout;
+import org.apache.logging.log4j.util.PropertiesUtil;
 
 import java.io.IOException;
 import java.io.OutputStream;
@@ -100,7 +101,9 @@ public final class ConsoleAppender extends AbstractOutputStreamAppender {
         final PrintStream printStream = target == Target.SYSTEM_OUT ?
             follow ? new PrintStream(new SystemOutStream()) : System.out :
             follow ? new PrintStream(new SystemErrStream()) : System.err;
-        if (!System.getProperty("os.name").startsWith("Windows") || Boolean.getBoolean("log4j.skipJansi")) {
+        PropertiesUtil propsUtil = PropertiesUtil.getProperties();
+        if (!propsUtil.getStringProperty("os.name").startsWith("Windows") ||
+            propsUtil.getBooleanProperty("log4j.skipJansi")) {
             return printStream;
         } else {
             try {
diff --git a/core/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.java b/core/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.java
index 4af996cfae..b9d6273873 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/config/BaseConfiguration.java
@@ -39,6 +39,7 @@ import org.apache.logging.log4j.core.lookup.MapLookup;
 import org.apache.logging.log4j.core.lookup.StrLookup;
 import org.apache.logging.log4j.core.lookup.StrSubstitutor;
 import org.apache.logging.log4j.status.StatusLogger;
+import org.apache.logging.log4j.util.PropertiesUtil;
 
 import java.lang.annotation.Annotation;
 import java.lang.reflect.Array;
@@ -222,14 +223,16 @@ public class BaseConfiguration extends AbstractFilterable implements Configurati
         setName(DefaultConfiguration.DEFAULT_NAME);
         final Layout layout = PatternLayout.createLayout("%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n",
             null, null, null);
-        final Appender appender = ConsoleAppender.createAppender(layout, null, "SYSTEM_OUT", "Console", "false", "true");
+        final Appender appender = ConsoleAppender.createAppender(layout, null, "SYSTEM_OUT", "Console", "false",
+            "true");
         appender.start();
         addAppender(appender);
         final LoggerConfig root = getRootLogger();
         root.addAppender(appender, null, null);
 
-        final String levelName = System.getProperty(DefaultConfiguration.DEFAULT_LEVEL);
-        final Level level = levelName != null && Level.valueOf(levelName) != null ? Level.valueOf(levelName) : Level.ERROR;
+        final String levelName = PropertiesUtil.getProperties().getStringProperty(DefaultConfiguration.DEFAULT_LEVEL);
+        final Level level = levelName != null && Level.valueOf(levelName) != null ?
+            Level.valueOf(levelName) : Level.ERROR;
         root.setLevel(level);
     }
 
diff --git a/core/src/main/java/org/apache/logging/log4j/core/config/ConfigurationFactory.java b/core/src/main/java/org/apache/logging/log4j/core/config/ConfigurationFactory.java
index d58466ddf5..454f8efd0d 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/config/ConfigurationFactory.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/config/ConfigurationFactory.java
@@ -22,6 +22,8 @@ import org.apache.logging.log4j.core.config.plugins.PluginType;
 import org.apache.logging.log4j.core.helpers.FileUtils;
 import org.apache.logging.log4j.core.helpers.Loader;
 import org.apache.logging.log4j.status.StatusLogger;
+import org.apache.logging.log4j.util.PropertiesUtil;
+
 import java.io.File;
 import java.io.FileInputStream;
 import java.io.FileNotFoundException;
@@ -53,7 +55,7 @@ import java.util.TreeSet;
  * factory to be the first one inspected. See
  * {@linkplain XMLConfigurationFactory} for an example.</li>
  * </ol>
- * 
+ *
  * If the ConfigurationFactory that was added returns null on a call to
  * getConfiguration the any other ConfigurationFactories found as plugins will
  * be called in their respective order. DefaultConfiguration is always called
@@ -94,7 +96,7 @@ public abstract class ConfigurationFactory {
      * @return the ConfigurationFactory.
      */
     public static ConfigurationFactory getInstance() {
-        final String factoryClass = System.getProperty(CONFIGURATION_FACTORY_PROPERTY);
+        final String factoryClass = PropertiesUtil.getProperties().getStringProperty(CONFIGURATION_FACTORY_PROPERTY);
         if (factoryClass != null) {
             addFactory(factoryClass);
         }
@@ -322,7 +324,7 @@ public abstract class ConfigurationFactory {
         public Configuration getConfiguration(final String name, final URI configLocation) {
 
             if (configLocation == null) {
-                final String config = System.getProperty(CONFIGURATION_FILE_PROPERTY);
+                final String config = PropertiesUtil.getProperties().getStringProperty(CONFIGURATION_FILE_PROPERTY);
                 if (config != null) {
                     final ClassLoader loader = this.getClass().getClassLoader();
                     final ConfigurationSource source = getInputFromString(config, loader);
diff --git a/core/src/main/java/org/apache/logging/log4j/core/config/DefaultConfiguration.java b/core/src/main/java/org/apache/logging/log4j/core/config/DefaultConfiguration.java
index f36f2d2c7a..754eba99b0 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/config/DefaultConfiguration.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/config/DefaultConfiguration.java
@@ -21,6 +21,7 @@ import org.apache.logging.log4j.core.Appender;
 import org.apache.logging.log4j.core.Layout;
 import org.apache.logging.log4j.core.appender.ConsoleAppender;
 import org.apache.logging.log4j.core.layout.PatternLayout;
+import org.apache.logging.log4j.util.PropertiesUtil;
 
 /**
  * The default configuration writes all output to the Console using the default logging level. You configure default logging level by setting the
@@ -46,14 +47,16 @@ public class DefaultConfiguration extends BaseConfiguration {
         setName(DEFAULT_NAME);
         final Layout layout = PatternLayout.createLayout("%d{HH:mm:ss.SSS} [%thread] %-5level %logger{36} - %msg%n",
             null, null, null);
-        final Appender appender = ConsoleAppender.createAppender(layout, null, "SYSTEM_OUT", "Console", "false", "true");
+        final Appender appender = ConsoleAppender.createAppender(layout, null, "SYSTEM_OUT", "Console", "false",
+            "true");
         appender.start();
         addAppender(appender);
         final LoggerConfig root = getRootLogger();
         root.addAppender(appender, null, null);
 
-        final String levelName = System.getProperty(DEFAULT_LEVEL);
-        final Level level = levelName != null && Level.valueOf(levelName) != null ? Level.valueOf(levelName) : Level.ERROR;
+        final String levelName = PropertiesUtil.getProperties().getStringProperty(DEFAULT_LEVEL);
+        final Level level = levelName != null && Level.valueOf(levelName) != null ?
+            Level.valueOf(levelName) : Level.ERROR;
         root.setLevel(level);
     }
 
diff --git a/core/src/main/java/org/apache/logging/log4j/core/helpers/Constants.java b/core/src/main/java/org/apache/logging/log4j/core/helpers/Constants.java
index 812970903c..5c04146ca5 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/helpers/Constants.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/helpers/Constants.java
@@ -16,6 +16,8 @@
  */
 package org.apache.logging.log4j.core.helpers;
 
+import org.apache.logging.log4j.util.PropertiesUtil;
+
 /**
  * Log4j Constants.
  */
@@ -34,7 +36,7 @@ public final class Constants {
     /**
      * Line separator.
      */
-    public static final String LINE_SEP = PropertiesUtil.getSystemProperty("line.separator", "\n");
+    public static final String LINE_SEP = PropertiesUtil.getProperties().getStringProperty("line.separator", "\n");
 
     /**
      * Number of milliseconds in a second.
diff --git a/core/src/main/java/org/apache/logging/log4j/core/helpers/Loader.java b/core/src/main/java/org/apache/logging/log4j/core/helpers/Loader.java
index 55de218185..9be99c416f 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/helpers/Loader.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/helpers/Loader.java
@@ -18,6 +18,7 @@ package org.apache.logging.log4j.core.helpers;
 
 import org.apache.logging.log4j.Logger;
 import org.apache.logging.log4j.status.StatusLogger;
+import org.apache.logging.log4j.util.PropertiesUtil;
 
 import java.io.InputStream;
 import java.io.InterruptedIOException;
@@ -36,7 +37,7 @@ public final class Loader {
     private static final Logger LOGGER = StatusLogger.getLogger();
 
     static {
-        final String ignoreTCLProp = OptionConverter.getSystemProperty("log4j.ignoreTCL", null);
+        final String ignoreTCLProp = PropertiesUtil.getProperties().getStringProperty("log4j.ignoreTCL", null);
         if (ignoreTCLProp != null) {
             ignoreTCL = OptionConverter.toBoolean(ignoreTCLProp, true);
         }
diff --git a/core/src/main/java/org/apache/logging/log4j/core/helpers/OptionConverter.java b/core/src/main/java/org/apache/logging/log4j/core/helpers/OptionConverter.java
index 16f32eb5f5..4f9f78fae1 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/helpers/OptionConverter.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/helpers/OptionConverter.java
@@ -18,6 +18,7 @@ package org.apache.logging.log4j.core.helpers;
 
 import org.apache.logging.log4j.Logger;
 import org.apache.logging.log4j.status.StatusLogger;
+import org.apache.logging.log4j.util.PropertiesUtil;
 
 import java.util.Locale;
 import java.util.Properties;
@@ -84,26 +85,6 @@ public final class OptionConverter {
         return sbuf.toString();
     }
 
-
-    /**
-     * Very similar to <code>System.getProperty</code> except
-     * that the {@link SecurityException} is hidden.
-     *
-     * @param key The key to search for.
-     * @param def The default value to return.
-     * @return the string value of the system property, or the default
-     *         value if there is no property with that key.
-     */
-    public static String getSystemProperty(final String key, final String def) {
-        try {
-            return System.getProperty(key, def);
-        } catch (final Throwable e) { // MS-Java throws com.ms.security.SecurityExceptionEx
-            LOGGER.debug("Was not allowed to read system property \"" + key + "\".");
-            return def;
-        }
-    }
-
-
     public static Object instantiateByKey(final Properties props, final String key, final Class<?> superClass,
                                    final Object defaultValue) {
 
@@ -327,7 +308,7 @@ public final class OptionConverter {
                     j += DELIM_START_LEN;
                     final String key = val.substring(j, k);
                     // first try in System properties
-                    String replacement = getSystemProperty(key, null);
+                    String replacement = PropertiesUtil.getProperties().getStringProperty(key, null);
                     // then try props parameter
                     if (replacement == null && props != null) {
                         replacement = props.getProperty(key);
diff --git a/core/src/main/java/org/apache/logging/log4j/core/helpers/PropertiesUtil.java b/core/src/main/java/org/apache/logging/log4j/core/helpers/PropertiesUtil.java
deleted file mode 100644
index 9378a75221..0000000000
--- a/core/src/main/java/org/apache/logging/log4j/core/helpers/PropertiesUtil.java
+++ /dev/null
@@ -1,80 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one or more
- * contributor license agreements. See the NOTICE file distributed with
- * this work for additional information regarding copyright ownership.
- * The ASF licenses this file to You under the Apache license, Version 2.0
- * (the "License"); you may not use this file except in compliance with
- * the License. You may obtain a copy of the License at
- *
- *      http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing, software
- * distributed under the License is distributed on an "AS IS" BASIS,
- * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
- * See the license for the specific language governing permissions and
- * limitations under the license.
- */
-package org.apache.logging.log4j.core.helpers;
-
-import org.apache.logging.log4j.Logger;
-import org.apache.logging.log4j.status.StatusLogger;
-
-import java.util.Properties;
-
-/**
- * System Property utility methods.
- */
-public final class PropertiesUtil {
-
-    private static final Logger LOGGER = StatusLogger.getLogger();
-
-    private PropertiesUtil() {
-    }
-
-    /**
-     * Return the specified system property, returning null if an error occurs.
-     * @param key The key to locate.
-     * @return The value associated with the key.
-     */
-    public static String getSystemProperty(final String key) {
-        try {
-            return System.getProperty(key);
-        } catch (final SecurityException ex) {
-            LOGGER.error("Unable to access system property {} due to security restrictions. Defaulting to null",
-                key);
-            return null;
-        }
-    }
-
-    /**
-     * Return the specified system property, returning the provided default value if the key does not exist or
-     * an error occurs.
-     * @param key The key to locate.
-     * @param defaultValue The default value.
-     * @return The value associated with the key or the default value if the key cannot be located.
-     */
-    public static String getSystemProperty(final String key, final String defaultValue) {
-        try {
-            final String value = System.getProperty(key);
-            return value == null ? defaultValue : value;
-        } catch (final SecurityException ex) {
-            LOGGER.warn("Unable to access system property {} due to security restrictions. Defaulting to {}",
-                key, defaultValue);
-            return defaultValue;
-        }
-    }
-
-    /**
-     * Return the system properties or an empty Properties object if an error occurs.
-     * @return The system properties.
-     */
-    public static Properties getSystemProperties() {
-        try {
-            return new Properties(System.getProperties());
-        } catch (final SecurityException ex) {
-            LOGGER.error("Unable to access system properties.");
-            // Sandboxed - can't read System Properties
-            return new Properties();
-        }
-    }
-}
diff --git a/core/src/main/java/org/apache/logging/log4j/core/helpers/UUIDUtil.java b/core/src/main/java/org/apache/logging/log4j/core/helpers/UUIDUtil.java
index 06f0ebfdce..ba3cafa1d8 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/helpers/UUIDUtil.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/helpers/UUIDUtil.java
@@ -16,6 +16,8 @@
  */
 package org.apache.logging.log4j.core.helpers;
 
+import org.apache.logging.log4j.util.PropertiesUtil;
+
 import java.lang.reflect.Method;
 import java.net.InetAddress;
 import java.net.NetworkInterface;
@@ -115,7 +117,7 @@ public final class UUIDUtil {
         long rand = uuidSequence;
         final Runtime runtime = Runtime.getRuntime();
         synchronized (runtime) {
-            String assigned = System.getProperty(ASSIGNED_SEQUENCES);
+            String assigned = PropertiesUtil.getProperties().getStringProperty(ASSIGNED_SEQUENCES);
             long[] sequences;
             if (assigned == null) {
                 sequences = new long[0];
diff --git a/core/src/main/java/org/apache/logging/log4j/core/impl/Log4jContextFactory.java b/core/src/main/java/org/apache/logging/log4j/core/impl/Log4jContextFactory.java
index 8a61f90870..5deb91ddba 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/impl/Log4jContextFactory.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/impl/Log4jContextFactory.java
@@ -23,6 +23,7 @@ import org.apache.logging.log4j.core.selector.ClassLoaderContextSelector;
 import org.apache.logging.log4j.core.selector.ContextSelector;
 import org.apache.logging.log4j.status.StatusLogger;
 import org.apache.logging.log4j.spi.LoggerContextFactory;
+import org.apache.logging.log4j.util.PropertiesUtil;
 
 /**
  * Factory to locate a ContextSelector and then load a LoggerContext.
@@ -37,7 +38,7 @@ public class Log4jContextFactory implements LoggerContextFactory {
      * Constructor that initializes the ContextSelector.
      */
     public Log4jContextFactory() {
-        final String sel = System.getProperty(Constants.LOG4J_CONTEXT_SELECTOR);
+        final String sel = PropertiesUtil.getProperties().getStringProperty(Constants.LOG4J_CONTEXT_SELECTOR);
         if (sel != null) {
             try {
                 final Class clazz = Loader.loadClass(sel);
diff --git a/core/src/main/java/org/apache/logging/log4j/core/lookup/SystemPropertiesLookup.java b/core/src/main/java/org/apache/logging/log4j/core/lookup/SystemPropertiesLookup.java
index 0e5dde23d6..a0b69d98d7 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/lookup/SystemPropertiesLookup.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/lookup/SystemPropertiesLookup.java
@@ -31,7 +31,11 @@ public class SystemPropertiesLookup implements StrLookup {
      * @return The value for the key.
      */
     public String lookup(final String key) {
-        return System.getProperty(key);
+        try {
+            return System.getProperty(key);
+        } catch (Exception ex) {
+            return null;
+        }
     }
 
     /**
@@ -41,6 +45,10 @@ public class SystemPropertiesLookup implements StrLookup {
      * @return The value associated with the key.
      */
     public String lookup(final LogEvent event, final String key) {
-        return System.getProperty(key);
+        try {
+            return System.getProperty(key);
+        } catch (Exception ex) {
+            return null;
+        }
     }
 }
diff --git a/core/src/main/java/org/apache/logging/log4j/core/net/SMTPManager.java b/core/src/main/java/org/apache/logging/log4j/core/net/SMTPManager.java
index 8f9ea12f1f..5064e2d18d 100644
--- a/core/src/main/java/org/apache/logging/log4j/core/net/SMTPManager.java
+++ b/core/src/main/java/org/apache/logging/log4j/core/net/SMTPManager.java
@@ -44,7 +44,7 @@ import org.apache.logging.log4j.core.appender.ManagerFactory;
 import org.apache.logging.log4j.core.helpers.CyclicBuffer;
 import org.apache.logging.log4j.core.helpers.NameUtil;
 import org.apache.logging.log4j.core.helpers.NetUtils;
-import org.apache.logging.log4j.core.helpers.PropertiesUtil;
+import org.apache.logging.log4j.util.PropertiesUtil;
 
 public class SMTPManager extends AbstractManager {
     private static final SMTPManagerFactory factory = new SMTPManagerFactory();
@@ -123,7 +123,7 @@ public class SMTPManager extends AbstractManager {
 
     /**
      * Send the contents of the cyclic buffer as an e-mail message.
-     * @param appendEvent 
+     * @param appendEvent
      */
     public void sendEvents(final Layout<?> layout, final LogEvent appendEvent) {
         if (message == null) {
@@ -178,7 +178,7 @@ public class SMTPManager extends AbstractManager {
             final byte[] bytes = layout.toByteArray(priorEvent);
             out.write(bytes);
         }
-        
+
         final byte[] bytes = layout.toByteArray(appendEvent);
         out.write(bytes);
     }
diff --git a/flume-ng/src/main/java/org/apache/logging/log4j/flume/appender/FlumeEmbeddedManager.java b/flume-ng/src/main/java/org/apache/logging/log4j/flume/appender/FlumeEmbeddedManager.java
index 4c32ab5ef3..b0d3272e2b 100644
--- a/flume-ng/src/main/java/org/apache/logging/log4j/flume/appender/FlumeEmbeddedManager.java
+++ b/flume-ng/src/main/java/org/apache/logging/log4j/flume/appender/FlumeEmbeddedManager.java
@@ -24,6 +24,7 @@ import org.apache.flume.node.nodemanager.DefaultLogicalNodeManager;
 import org.apache.logging.log4j.core.appender.ManagerFactory;
 import org.apache.logging.log4j.core.config.ConfigurationException;
 import org.apache.logging.log4j.core.config.Property;
+import org.apache.logging.log4j.core.helpers.Constants;
 import org.apache.logging.log4j.core.helpers.NameUtil;
 
 import java.util.Locale;
@@ -42,8 +43,6 @@ public class FlumeEmbeddedManager extends AbstractFlumeManager {
 
     protected static final String SOURCE_NAME = "log4j-source";
 
-    private static final String LINE_SEP = System.getProperty("file.separator");
-
     private final Log4jEventSource source;
 
     private final String shortName;
@@ -201,8 +200,8 @@ public class FlumeEmbeddedManager extends AbstractFlumeManager {
                 props.put(name + ".channels", "file");
                 props.put(name + ".channels.file.type", "file");
                 if (dataDir != null && dataDir.length() > 0) {
-                    if (!dataDir.endsWith(LINE_SEP)) {
-                        dataDir = dataDir + LINE_SEP;
+                    if (!dataDir.endsWith(Constants.LINE_SEP)) {
+                        dataDir = dataDir + Constants.LINE_SEP;
                     }
 
                     props.put(name + ".channels.file.checkpointDir", dataDir + "checkpoint");
diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index 7c98e7bb29..a5dfe8fea2 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -23,6 +23,9 @@
 
   <body>
     <release version="2.0-beta4" date="TBD" description="Bug fixes and enhancements">
+      <action issue="LOG4J2-150" dev="rgoers" type="fix">
+        Convert all System.getProperty calls to use PropertiesUtil to suppress SecurityExceptions.
+      </action>
       <action issue="LOG4J2-147" dev="rgoers" type="fix" due-to="William Burns">
         ThreadContextMapFilter was matching on the key instead of the value of the key.
       </action>
