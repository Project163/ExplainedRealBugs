diff --git a/log4j-core/src/main/java/org/apache/logging/log4j/core/lookup/MapLookup.java b/log4j-core/src/main/java/org/apache/logging/log4j/core/lookup/MapLookup.java
index 466decb9d4..c00645e6d5 100644
--- a/log4j-core/src/main/java/org/apache/logging/log4j/core/lookup/MapLookup.java
+++ b/log4j-core/src/main/java/org/apache/logging/log4j/core/lookup/MapLookup.java
@@ -22,7 +22,7 @@ import java.util.Map;
 
 import org.apache.logging.log4j.core.LogEvent;
 import org.apache.logging.log4j.core.config.plugins.Plugin;
-import org.apache.logging.log4j.message.StringMapMessage;
+import org.apache.logging.log4j.message.MapMessage;
 
 /**
  * A map-based lookup.
@@ -118,7 +118,7 @@ public class MapLookup implements StrLookup {
 
     @Override
     public String lookup(final LogEvent event, final String key) {
-        final boolean isMapMessage = event != null && event.getMessage() instanceof StringMapMessage;
+        final boolean isMapMessage = event != null && event.getMessage() instanceof MapMessage;
         if (map == null && !isMapMessage) {
             return null;
         }
@@ -129,7 +129,7 @@ public class MapLookup implements StrLookup {
             }
         }
         if (isMapMessage) {
-            return ((StringMapMessage) event.getMessage()).get(key);
+            return ((MapMessage) event.getMessage()).get(key);
         }
         return null;
     }
diff --git a/log4j-core/src/test/java/org/apache/logging/log4j/core/lookup/MapLookupTest.java b/log4j-core/src/test/java/org/apache/logging/log4j/core/lookup/MapLookupTest.java
index 61d81ecbc8..f82959b41e 100644
--- a/log4j-core/src/test/java/org/apache/logging/log4j/core/lookup/MapLookupTest.java
+++ b/log4j-core/src/test/java/org/apache/logging/log4j/core/lookup/MapLookupTest.java
@@ -22,6 +22,7 @@ import java.util.HashMap;
 
 import org.apache.logging.log4j.core.LogEvent;
 import org.apache.logging.log4j.core.impl.Log4jLogEvent;
+import org.apache.logging.log4j.message.MapMessage;
 import org.apache.logging.log4j.message.StringMapMessage;
 import org.junit.Test;
 
@@ -68,7 +69,7 @@ public class MapLookupTest {
     }
 
     @Test
-    public void testEventMapMessage() {
+    public void testEventStringMapMessage() {
       final HashMap<String, String> map = new HashMap<>();
       map.put("A", "B");
       final HashMap<String, String> eventMap = new HashMap<>();
@@ -82,6 +83,21 @@ public class MapLookupTest {
       assertEquals("B1", lookup.lookup(event, "A1"));
     }
 
+    @Test
+    public void testEventMapMessage() {
+        final HashMap<String, String> map = new HashMap<>();
+        map.put("A", "B");
+        final HashMap<String, Object> eventMap = new HashMap<>();
+        eventMap.put("A1", 11);
+        final MapMessage message = new MapMessage<>(eventMap);
+        final LogEvent event = Log4jLogEvent.newBuilder()
+                .setMessage(message)
+                .build();
+        final MapLookup lookup = new MapLookup(map);
+        assertEquals("B", lookup.lookup(event, "A"));
+        assertEquals("11", lookup.lookup(event, "A1"));
+    }
+
     @Test
     public void testNullEvent() {
       final HashMap<String, String> map = new HashMap<>();
