{"url":"https://api.github.com/repos/pylint-dev/pylint/issues/2395","repository_url":"https://api.github.com/repos/pylint-dev/pylint","labels_url":"https://api.github.com/repos/pylint-dev/pylint/issues/2395/labels{/name}","comments_url":"https://api.github.com/repos/pylint-dev/pylint/issues/2395/comments","events_url":"https://api.github.com/repos/pylint-dev/pylint/issues/2395/events","html_url":"https://github.com/pylint-dev/pylint/issues/2395","id":348786471,"node_id":"MDU6SXNzdWUzNDg3ODY0NzE=","number":2395,"title":"W1202 - logging-fstring-interpolation is not useful","user":{"login":"pzelnip","id":414933,"node_id":"MDQ6VXNlcjQxNDkzMw==","avatar_url":"https://avatars.githubusercontent.com/u/414933?v=4","gravatar_id":"","url":"https://api.github.com/users/pzelnip","html_url":"https://github.com/pzelnip","followers_url":"https://api.github.com/users/pzelnip/followers","following_url":"https://api.github.com/users/pzelnip/following{/other_user}","gists_url":"https://api.github.com/users/pzelnip/gists{/gist_id}","starred_url":"https://api.github.com/users/pzelnip/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pzelnip/subscriptions","organizations_url":"https://api.github.com/users/pzelnip/orgs","repos_url":"https://api.github.com/users/pzelnip/repos","events_url":"https://api.github.com/users/pzelnip/events{/privacy}","received_events_url":"https://api.github.com/users/pzelnip/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":21,"created_at":"2018-08-08T15:51:06Z","updated_at":"2021-04-19T15:52:14Z","closed_at":"2019-09-10T10:19:03Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n  Hi there! Thank you for wanting to make pylint better.\r\n\r\n  Before you submit this, make sure that this feature wasn't\r\n  already requested or if it is not already implemented in the master branch.\r\n-->\r\n\r\n### Is your feature request related to a problem? Please describe\r\n\r\nIn my experiments W1202 is misleading as f-strings performance is virtually equivalent to %-operator formatting in practice.\r\n\r\n### Describe the solution you'd like\r\n\r\nW1202 be deprecated, as it can lead people to not use f-strings, which (if available) are the preferred mechanism for string interpolation.\r\n\r\n### Additional context\r\n\r\nThis is related to my inquiry around this warning: https://github.com/PyCQA/pylint/issues/2354\r\n\r\nTo verify my hypothesis that f-strings are virtually as performant as %-operator formatting I wrote the following snippet to explore timing related to log statements with the 3 approaches (f-strings, .format(), and %-operator).  This was on a Django app I'm working on.\r\n\r\n```\r\nimport timeit\r\n\r\ndef timeitex1(num_times):\r\n    fstring = timeit.timeit(\r\n        'logging.info(f\"\"\"this is a {thing}, and thing: {thing + \"blah\"}\"\"\")',\r\n        setup=\"import logging ; thing='1234'\",\r\n        number=num_times,\r\n    )\r\n\r\n    formattim = timeit.timeit(\r\n        'logging.info(\"this is a {}, and thing: {}\".format(thing, thing + \"blah\"))',\r\n        setup=\"import logging ; thing='1234'\",\r\n        number=num_times,\r\n    )\r\n\r\n    percentop = timeit.timeit(\r\n        'logging.info(\"this is a %s, and thing: %s\", thing, thing + \"blah\")',\r\n        setup=\"import logging ; thing='1234'\",\r\n        number=num_times,\r\n    )\r\n\r\n    return (fstring, formattim, percentop)\r\n```\r\n\r\nWith logging output disabled (ie in my Django settings I had: ```LOGGING[\"loggers\"] = {}```), %-formatting and f-strings are virtually identical.\r\n\r\n```\r\nnum_times = 10,000:\r\n(0.016536445124074817, 0.02152163698337972, 0.018616185057908297)\r\n\r\nnum_times = 100,000:\r\n(0.16004435811191797, 0.20005284599028528, 0.1561291899997741)\r\n\r\nnum_times = 1,000,000:\r\n(1.641325417906046, 2.0023047979921103, 1.6249939629342407)\r\n```\r\n\r\nReturned times are tuples of \"time for f-strings\", \"time for the format() call\", and \"time for %-formatting\".\r\n\r\nThat's a difference of ~1% (1.641325417906046 vs 1.6249939629342407 seconds) between f-strings & the %-operator on the largest run (.format calls being clearly slower).\r\n\r\nWith logging enabled, it's a total wash (technically f-strings was the winner in the larger runs but by such a small margin it's inconsequential).  This is with log output going to standard out (so I only went up to 100,000 entries as I didn't want to dump 3 million log statements to my console):\r\n\r\nnum_times = 10,000:\r\n(1.6245153648778796, 2.0137458329554647, 1.6029843359719962)\r\n\r\nnum_times = 100,000:\r\n(4.39409149507992, 4.51585376705043, 4.532764581032097)\r\n\r\nSo basically unless you are emitting a *ton* of logging statements for a level that are never actually logged (say because the LOG_LEVEL is set high), then it doesn't matter.  And if you're in that scenario, then really there's no noticeable difference between %-operator formatting or f-strings (just don't do ```.format()``` calls).\r\n\r\nOTOH, if you *are* emitting the logging message, then it's likely that the f-string approach will be faster, so following W1202 will actually make your code (extremely slightly) *slower*.","closed_by":{"login":"PCManticore","id":448166,"node_id":"MDQ6VXNlcjQ0ODE2Ng==","avatar_url":"https://avatars.githubusercontent.com/u/448166?v=4","gravatar_id":"","url":"https://api.github.com/users/PCManticore","html_url":"https://github.com/PCManticore","followers_url":"https://api.github.com/users/PCManticore/followers","following_url":"https://api.github.com/users/PCManticore/following{/other_user}","gists_url":"https://api.github.com/users/PCManticore/gists{/gist_id}","starred_url":"https://api.github.com/users/PCManticore/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/PCManticore/subscriptions","organizations_url":"https://api.github.com/users/PCManticore/orgs","repos_url":"https://api.github.com/users/PCManticore/repos","events_url":"https://api.github.com/users/PCManticore/events{/privacy}","received_events_url":"https://api.github.com/users/PCManticore/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pylint-dev/pylint/issues/2395/reactions","total_count":67,"+1":67,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pylint-dev/pylint/issues/2395/timeline","performed_via_github_app":null,"state_reason":"completed"}