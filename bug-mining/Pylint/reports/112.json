{"url":"https://api.github.com/repos/pylint-dev/pylint/issues/4680","repository_url":"https://api.github.com/repos/pylint-dev/pylint","labels_url":"https://api.github.com/repos/pylint-dev/pylint/issues/4680/labels{/name}","comments_url":"https://api.github.com/repos/pylint-dev/pylint/issues/4680/comments","events_url":"https://api.github.com/repos/pylint-dev/pylint/issues/4680/events","html_url":"https://github.com/pylint-dev/pylint/issues/4680","id":938276656,"node_id":"MDU6SXNzdWU5MzgyNzY2NTY=","number":4680,"title":"AttributeError: 'Attribute' object has not attribute 'name'","user":{"login":"learnitall","id":13142290,"node_id":"MDQ6VXNlcjEzMTQyMjkw","avatar_url":"https://avatars.githubusercontent.com/u/13142290?v=4","gravatar_id":"","url":"https://api.github.com/users/learnitall","html_url":"https://github.com/learnitall","followers_url":"https://api.github.com/users/learnitall/followers","following_url":"https://api.github.com/users/learnitall/following{/other_user}","gists_url":"https://api.github.com/users/learnitall/gists{/gist_id}","starred_url":"https://api.github.com/users/learnitall/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/learnitall/subscriptions","organizations_url":"https://api.github.com/users/learnitall/orgs","repos_url":"https://api.github.com/users/learnitall/repos","events_url":"https://api.github.com/users/learnitall/events{/privacy}","received_events_url":"https://api.github.com/users/learnitall/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":303519130,"node_id":"MDU6TGFiZWwzMDM1MTkxMzA=","url":"https://api.github.com/repos/pylint-dev/pylint/labels/Blocker%20%F0%9F%99%85","name":"Blocker ðŸ™…","color":"e11d21","default":false,"description":"Blocks the next release"},{"id":1041256788,"node_id":"MDU6TGFiZWwxMDQxMjU2Nzg4","url":"https://api.github.com/repos/pylint-dev/pylint/labels/Crash%20%F0%9F%92%A5","name":"Crash ðŸ’¥","color":"c64d6f","default":false,"description":"A bug that makes pylint crash"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/pylint-dev/pylint/milestones/43","html_url":"https://github.com/pylint-dev/pylint/milestone/43","labels_url":"https://api.github.com/repos/pylint-dev/pylint/milestones/43/labels","id":6907540,"node_id":"MDk6TWlsZXN0b25lNjkwNzU0MA==","number":43,"title":"2.9.4","description":"","creator":{"login":"Pierre-Sassoulas","id":5493666,"node_id":"MDQ6VXNlcjU0OTM2NjY=","avatar_url":"https://avatars.githubusercontent.com/u/5493666?v=4","gravatar_id":"","url":"https://api.github.com/users/Pierre-Sassoulas","html_url":"https://github.com/Pierre-Sassoulas","followers_url":"https://api.github.com/users/Pierre-Sassoulas/followers","following_url":"https://api.github.com/users/Pierre-Sassoulas/following{/other_user}","gists_url":"https://api.github.com/users/Pierre-Sassoulas/gists{/gist_id}","starred_url":"https://api.github.com/users/Pierre-Sassoulas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Pierre-Sassoulas/subscriptions","organizations_url":"https://api.github.com/users/Pierre-Sassoulas/orgs","repos_url":"https://api.github.com/users/Pierre-Sassoulas/repos","events_url":"https://api.github.com/users/Pierre-Sassoulas/events{/privacy}","received_events_url":"https://api.github.com/users/Pierre-Sassoulas/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":36,"state":"closed","created_at":"2021-07-01T12:18:08Z","updated_at":"2023-08-25T15:15:19Z","due_on":null,"closed_at":"2021-07-20T17:05:25Z"},"comments":1,"created_at":"2021-07-06T21:33:02Z","updated_at":"2021-07-09T17:24:09Z","closed_at":"2021-07-09T17:24:09Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"<!--\r\n  Hi there! Thank you for discovering and submitting an issue.\r\n\r\n  Before you submit this, make sure that the issue doesn't already exist\r\n  or if it is not closed.\r\n\r\n  Is your issue fixed on the preview release?:\r\n    pip install pylint astroid --pre -U\r\n-->\r\n\r\nSeems to be an issued directly related to PR https://github.com/PyCQA/pylint/pull/3998 and issue https://github.com/PyCQA/pylint/issues/3742. When using a metaclass from a subpackage that can't be imported, and then referencing another variable from said subpackage within the same scope, an ``AttributeError`` is raised. Removing the ``assert`` line in the given file below prevents the error. Came across this while writing unit tests, hence the ``assert`` statement.\r\n\r\n### Steps to reproduce\r\n\r\nGiven a file `lintme.py`:\r\n```python\r\n# pylint: disable=C0304,C0114,C0116,C0115,R0903\r\nimport pkg.sub\r\n\r\nclass Failed(metaclass=pkg.sub.Metaclass):\r\n    pass\r\nassert pkg.sub.value is None\r\n```\r\n\r\n### Current behavior\r\n\r\nResult of `pylint lintme.py`:\r\n```\r\n(pylint-bug) [rydrew@redhat-worklp pylint-error]$  pylint lintme.py\r\n************* Module lintme\r\nlintme.py:2:0: E0401: Unable to import 'pkg.sub' (import-error)\r\nException on node <FunctionDef.test l.4 at 0x7f867ba766a0> in file '/home/rydrew/Documents/pylint-error/lintme.py'\r\nTraceback (most recent call last):\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/bin/pylint\", line 8, in <module>\r\n    sys.exit(run_pylint())\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/__init__.py\", line 24, in run_pylint\r\n    PylintRun(sys.argv[1:])\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/lint/run.py\", line 384, in __init__\r\n    linter.check(args)\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/lint/pylinter.py\", line 973, in check\r\n    self._check_files(\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/lint/pylinter.py\", line 1007, in _check_files\r\n    self._check_file(get_ast, check_astroid_module, name, filepath, modname)\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/lint/pylinter.py\", line 1033, in _check_file\r\n    check_astroid_module(ast_node)\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/lint/pylinter.py\", line 1170, in check_astroid_module\r\n    retval = self._check_astroid_module(\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/lint/pylinter.py\", line 1215, in _check_astroid_module\r\n    walker.walk(ast_node)\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/utils/ast_walker.py\", line 77, in walk\r\n    self.walk(child)\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/utils/ast_walker.py\", line 79, in walk\r\n    callback(astroid)\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/checkers/variables.py\", line 853, in leave_functiondef\r\n    self._check_metaclasses(node)\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/checkers/variables.py\", line 2098, in _check_metaclasses\r\n    consumed.extend(self._check_classdef_metaclasses(child_node, node))\r\n  File \"/home/rydrew/.pyenv/versions/pylint-bug/lib64/python3.9/site-packages/pylint/checkers/variables.py\", line 2142, in _check_classdef_metaclasses\r\n    name = klass._metaclass.expr.name\r\nAttributeError: 'Attribute' object has no attribute 'name'\r\n```\r\n\r\n### Expected behavior\r\n\r\nOnly the import error is shown\r\n\r\n```\r\n(pylint-bug) [rydrew@redhat-worklp pylint-error]$  pylint lintme.py\r\n************* Module lintme\r\nlintme.py:2:0: E0401: Unable to import 'pkg.sub' (import-error)\r\n```\r\n\r\n### pylint --version output\r\n\r\nResult of `pylint --version` output:\r\n\r\n```\r\npylint 3.0.0-a4\r\nastroid 2.6.2\r\nPython 3.9.5 (default, May 14 2021, 00:00:00) \r\n[GCC 11.1.1 20210428 (Red Hat 11.1.1-1)]\r\n```\r\n\r\n<!--\r\nAdditional dependencies:\r\n```\r\npandas==0.23.2\r\nmarshmallow==3.10.0\r\n...\r\n```\r\n-->\r\n","closed_by":{"login":"Pierre-Sassoulas","id":5493666,"node_id":"MDQ6VXNlcjU0OTM2NjY=","avatar_url":"https://avatars.githubusercontent.com/u/5493666?v=4","gravatar_id":"","url":"https://api.github.com/users/Pierre-Sassoulas","html_url":"https://github.com/Pierre-Sassoulas","followers_url":"https://api.github.com/users/Pierre-Sassoulas/followers","following_url":"https://api.github.com/users/Pierre-Sassoulas/following{/other_user}","gists_url":"https://api.github.com/users/Pierre-Sassoulas/gists{/gist_id}","starred_url":"https://api.github.com/users/Pierre-Sassoulas/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Pierre-Sassoulas/subscriptions","organizations_url":"https://api.github.com/users/Pierre-Sassoulas/orgs","repos_url":"https://api.github.com/users/Pierre-Sassoulas/repos","events_url":"https://api.github.com/users/Pierre-Sassoulas/events{/privacy}","received_events_url":"https://api.github.com/users/Pierre-Sassoulas/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pylint-dev/pylint/issues/4680/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pylint-dev/pylint/issues/4680/timeline","performed_via_github_app":null,"state_reason":"completed"}