diff --git a/pylint/checkers/variables.py b/pylint/checkers/variables.py
index 1b4cc6430..65b361570 100644
--- a/pylint/checkers/variables.py
+++ b/pylint/checkers/variables.py
@@ -2139,8 +2139,10 @@ class VariablesChecker(BaseChecker):
                 isinstance(klass._metaclass, astroid.Attribute)
                 and klass._metaclass.expr
             ):
-                name = klass._metaclass.expr.name
-
+                if isinstance(klass._metaclass.expr, astroid.Name):
+                    name = klass._metaclass.expr.name
+                elif isinstance(klass._metaclass.expr, astroid.Attribute):
+                    name = klass._metaclass.expr.attrname
             if name is not None:
                 if not (
                     name in astroid.Module.scope_attrs
diff --git a/tests/functional/r/regression/regression_4680.py b/tests/functional/r/regression/regression_4680.py
new file mode 100644
index 000000000..8c1decdc1
--- /dev/null
+++ b/tests/functional/r/regression/regression_4680.py
@@ -0,0 +1,18 @@
+# pylint: disable=missing-docstring,too-few-public-methods,undefined-variable
+
+import pkg.sub  # [import-error]
+
+
+class Failed(metaclass=pkg.sub.Metaclass):
+    pass
+
+
+class FailedTwo(metaclass=ab.ABCMeta):
+    pass
+
+
+class FailedThree(metaclass=pkg.sob.Metaclass):
+    pass
+
+
+assert pkg.sub.value is None
diff --git a/tests/functional/r/regression/regression_4680.txt b/tests/functional/r/regression/regression_4680.txt
new file mode 100644
index 000000000..eef59e400
--- /dev/null
+++ b/tests/functional/r/regression/regression_4680.txt
@@ -0,0 +1 @@
+import-error:3:0::Unable to import 'pkg.sub':HIGH
