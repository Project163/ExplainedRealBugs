diff --git a/core/src/main/java/hivemall/tools/array/ArrayRemoveUDF.java b/core/src/main/java/hivemall/tools/array/ArrayRemoveUDF.java
index 207c398f..5dda0ffa 100644
--- a/core/src/main/java/hivemall/tools/array/ArrayRemoveUDF.java
+++ b/core/src/main/java/hivemall/tools/array/ArrayRemoveUDF.java
@@ -18,35 +18,131 @@
  */
 package hivemall.tools.array;
 
+import hivemall.utils.hadoop.HiveUtils;
+import hivemall.utils.lang.StringUtils;
+
+import java.util.Collections;
 import java.util.List;
 
+import javax.annotation.Nonnull;
+import javax.annotation.Nullable;
+
 import org.apache.hadoop.hive.ql.exec.Description;
-import org.apache.hadoop.hive.ql.exec.UDF;
+import org.apache.hadoop.hive.ql.exec.UDFArgumentException;
+import org.apache.hadoop.hive.ql.exec.UDFArgumentLengthException;
+import org.apache.hadoop.hive.ql.metadata.HiveException;
 import org.apache.hadoop.hive.ql.udf.UDFType;
-import org.apache.hadoop.io.IntWritable;
-import org.apache.hadoop.io.Text;
+import org.apache.hadoop.hive.ql.udf.generic.GenericUDF;
+import org.apache.hadoop.hive.serde2.objectinspector.ListObjectInspector;
+import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
+import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorConverters;
+import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorConverters.Converter;
+import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorFactory;
+import org.apache.hadoop.hive.serde2.objectinspector.PrimitiveObjectInspector;
 
+//@formatter:off
 @Description(name = "array_remove",
-        value = "_FUNC_(array<int|text> original, int|text|array<int> target)"
-                + " - Returns an array that the target is removed " + "from the original array",
-        extended = "SELECT array_remove(array(1,null,3),array(null));\n" + " [3]\n" + "\n"
-                + "SELECT array_remove(array(\"aaa\",\"bbb\"),\"bbb\");\n" + " [\"aaa\"]")
+        value = "_FUNC_(array<PRIMITIVE> values, PRIMITIVE|array<PRIMITIVE> target)"
+                + " - Returns an array that the target elements are removed from the original array",
+        extended = "select array_remove(array(2.0,2.1,3.0,4.0,2.0),2), array_remove(array(2.0,3.0,4.0),array(3,2.0));\n" + 
+                "[2.1,3,4]       [4]\n" + 
+                "\n" + 
+                "SELECT array_remove(array(1,null,3),null);\n" + 
+                "[1,3]\n" + 
+                "\n" + 
+                "SELECT array_remove(array(1,null,3,null,5),null);\n" + 
+                "[1,3,5]\n" + 
+                "\n" + 
+                "SELECT array_remove(array(1,null,3),array(null));\n" + 
+                "[1,3]\n" + 
+                "\n" + 
+                "SELECT array_remove(array('aaa','bbb'),'bbb');\n" + 
+                "[\"aaa\"]\n" + 
+                "\n" + 
+                "SELECT array_remove(array('aaa','bbb','ccc','bbb'), array('bbb','ccc'));\n" + 
+                "[\"aaa\"]\n" + 
+                "\n" + 
+                "select array_remove(array(null),null);\n" + 
+                "[]\n" + 
+                "\n" + 
+                "select array_remove(array(null,'bbb'),'aaa');\n" + 
+                "[null,\"bbb\"]")
+//@formatter:on
 @UDFType(deterministic = true, stateful = false)
-public class ArrayRemoveUDF extends UDF {
+public final class ArrayRemoveUDF extends GenericUDF {
+
+    private ListObjectInspector valueListOI;
+    private PrimitiveObjectInspector valueElemOI;
+    private boolean isTargetList;
+    @Nullable
+    private ListObjectInspector targetListOI;
+    private PrimitiveObjectInspector targetElemOI;
+
+    @Override
+    public ObjectInspector initialize(ObjectInspector[] argOIs) throws UDFArgumentException {
+        if (argOIs.length != 2) {
+            throw new UDFArgumentLengthException("Expected 2 arguments, but got " + argOIs.length);
+        }
+
+        this.valueListOI = HiveUtils.asListOI(argOIs, 0);
+        this.valueElemOI =
+                HiveUtils.asPrimitiveObjectInspector(valueListOI.getListElementObjectInspector());
+
+        if (HiveUtils.isListOI(argOIs[1])) {
+            this.isTargetList = true;
+            this.targetListOI = HiveUtils.asListOI(argOIs, 1);
+            this.targetElemOI = HiveUtils.asPrimitiveObjectInspector(
+                targetListOI.getListElementObjectInspector());
+        } else {
+            this.isTargetList = false;
+            this.targetElemOI = HiveUtils.asPrimitiveObjectInspector(argOIs, 1);
+        }
+
+        return ObjectInspectorFactory.getStandardListObjectInspector(valueElemOI);
+    }
+
+    @Nullable
+    @Override
+    public Object evaluate(@Nonnull DeferredObject[] arguments) throws HiveException {
+        assert (arguments.length == 2);
+
+        final List<?> values = HiveUtils.copyListObject(arguments[0], valueListOI);
+        if (values == null) {
+            return null;
+        }
+
+        final Object target = arguments[1].get();
+        if (target == null) {
+            values.removeAll(Collections.singletonList(null));
+            return values;
+        }
+
+        if (isTargetList) {
+            Converter converter = ObjectInspectorConverters.getConverter(targetListOI, valueListOI);
+            removeAll(values, target, converter, valueListOI);
+        } else {
+            Converter converter = ObjectInspectorConverters.getConverter(targetElemOI, valueElemOI);
+            removeAll(values, target, converter);
+        }
+        return values;
+    }
 
-    public List<IntWritable> evaluate(List<IntWritable> original, IntWritable target) {
-        while (original.remove(target));
-        return original;
+    private static void removeAll(@Nonnull final List<?> values, @Nonnull final Object target,
+            @Nonnull final Converter converter, @Nonnull final ListObjectInspector valueListOI) {
+        Object converted = converter.convert(target);
+        List<?> convertedList = valueListOI.getList(converted);
+        values.removeAll(convertedList);
     }
 
-    public List<IntWritable> evaluate(List<IntWritable> original, List<IntWritable> targets) {
-        original.removeAll(targets);
-        return original;
+    private static void removeAll(@Nonnull final List<?> values, @Nonnull final Object target,
+            @Nonnull final Converter converter) {
+        Object converted = converter.convert(target);
+        values.removeAll(Collections.singleton(converted));
     }
 
-    public List<Text> evaluate(List<Text> original, Text target) {
-        while (original.remove(target));
-        return original;
+    @Override
+    public String getDisplayString(String[] children) {
+        return "array_remove(" + StringUtils.join(children, ',') + ')';
     }
 
 }
diff --git a/core/src/main/java/hivemall/utils/hadoop/HiveUtils.java b/core/src/main/java/hivemall/utils/hadoop/HiveUtils.java
index 5c485cd0..6c029744 100644
--- a/core/src/main/java/hivemall/utils/hadoop/HiveUtils.java
+++ b/core/src/main/java/hivemall/utils/hadoop/HiveUtils.java
@@ -31,6 +31,7 @@ import static hivemall.HivemallConstants.TINYINT_TYPE_NAME;
 import static hivemall.HivemallConstants.VOID_TYPE_NAME;
 
 import java.nio.charset.StandardCharsets;
+import java.util.ArrayList;
 import java.util.Arrays;
 import java.util.BitSet;
 import java.util.Collections;
@@ -66,6 +67,7 @@ import org.apache.hadoop.hive.serde2.objectinspector.MapObjectInspector;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector.Category;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils;
+import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils.ObjectInspectorCopyOption;
 import org.apache.hadoop.hive.serde2.objectinspector.PrimitiveObjectInspector;
 import org.apache.hadoop.hive.serde2.objectinspector.PrimitiveObjectInspector.PrimitiveCategory;
 import org.apache.hadoop.hive.serde2.objectinspector.StandardConstantListObjectInspector;
@@ -472,6 +474,82 @@ public final class HiveUtils {
         return (ListTypeInfo) typeInfo;
     }
 
+    public static boolean isSameCategoryGroup(@Nonnull final PrimitiveCategory cat1,
+            @Nonnull final PrimitiveCategory cat2) {
+        if (cat1 == cat2) {
+            return true;
+        }
+
+        switch (cat1) {
+            // integers
+            case BYTE:
+            case SHORT:
+            case INT:
+            case LONG: {
+                switch (cat2) {
+                    case BYTE:
+                    case SHORT:
+                    case INT:
+                    case LONG:
+                        return true;
+                    default:
+                        return false;
+                }
+            }
+            // floating point number
+            case FLOAT:
+            case DOUBLE: {
+                switch (cat2) {
+                    case FLOAT:
+                    case DOUBLE:
+                        return true;
+                    default:
+                        return false;
+                }
+            }
+            // string
+            case STRING:
+            case CHAR:
+            case VARCHAR:
+                switch (cat2) {
+                    case STRING:
+                    case CHAR:
+                    case VARCHAR:
+                        return true;
+                    default:
+                        return false;
+                }
+            default:
+                break;
+        }
+        return false;
+    }
+
+    @Nullable
+    public static ArrayList<Object> copyListObject(@Nonnull final DeferredObject argument,
+            @Nonnull final ListObjectInspector loi) throws HiveException {
+        return copyListObject(argument, loi, ObjectInspectorCopyOption.DEFAULT);
+    }
+
+    @Nullable
+    public static ArrayList<Object> copyListObject(@Nonnull final DeferredObject argument,
+            @Nonnull final ListObjectInspector loi,
+            @Nonnull final ObjectInspectorCopyOption objectInspectorOption) throws HiveException {
+        final Object o = argument.get();
+        if (o == null) {
+            return null;
+        }
+
+        final int length = loi.getListLength(o);
+        final ArrayList<Object> list = new ArrayList<Object>(length);
+        for (int i = 0; i < length; i++) {
+            Object e = ObjectInspectorUtils.copyToStandardObject(loi.getListElement(o, i),
+                loi.getListElementObjectInspector(), objectInspectorOption);
+            list.add(e);
+        }
+        return list;
+    }
+
     public static float getFloat(@Nullable Object o, @Nonnull PrimitiveObjectInspector oi) {
         if (o == null) {
             return 0.f;
