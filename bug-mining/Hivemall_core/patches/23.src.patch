diff --git a/core/src/main/java/hivemall/knn/similarity/AngularSimilarityUDF.java b/core/src/main/java/hivemall/knn/similarity/AngularSimilarityUDF.java
index e381d36a..b2284bd2 100644
--- a/core/src/main/java/hivemall/knn/similarity/AngularSimilarityUDF.java
+++ b/core/src/main/java/hivemall/knn/similarity/AngularSimilarityUDF.java
@@ -74,7 +74,7 @@ public final class AngularSimilarityUDF extends GenericUDF {
 
     @Override
     public ObjectInspector initialize(ObjectInspector[] argOIs) throws UDFArgumentException {
-        if (argOIs.length != 2) {            
+        if (argOIs.length != 2) {
             throw new UDFArgumentException("angular_similarity takes 2 arguments");
         }
         this.arg0ListOI = HiveUtils.asListOI(argOIs, 0);
diff --git a/core/src/main/java/hivemall/tools/matrix/TransposeAndDotUDAF.java b/core/src/main/java/hivemall/tools/matrix/TransposeAndDotUDAF.java
index 8366c83f..b6978fb0 100644
--- a/core/src/main/java/hivemall/tools/matrix/TransposeAndDotUDAF.java
+++ b/core/src/main/java/hivemall/tools/matrix/TransposeAndDotUDAF.java
@@ -20,7 +20,6 @@ package hivemall.tools.matrix;
 
 import hivemall.utils.hadoop.HiveUtils;
 import hivemall.utils.hadoop.WritableUtils;
-import hivemall.utils.lang.Preconditions;
 import hivemall.utils.lang.SizeOf;
 
 import java.util.ArrayList;
@@ -28,7 +27,6 @@ import java.util.Arrays;
 import java.util.List;
 
 import org.apache.hadoop.hive.ql.exec.Description;
-import org.apache.hadoop.hive.ql.exec.UDFArgumentException;
 import org.apache.hadoop.hive.ql.exec.UDFArgumentLengthException;
 import org.apache.hadoop.hive.ql.exec.UDFArgumentTypeException;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
@@ -169,8 +167,10 @@ public final class TransposeAndDotUDAF extends AbstractGenericUDAFResolver {
             final Object matrix0RowObj = parameters[0];
             final Object matrix1RowObj = parameters[1];
 
-            Preconditions.checkNotNull(matrix0RowObj, UDFArgumentException.class);
-            Preconditions.checkNotNull(matrix1RowObj, UDFArgumentException.class);
+            // need to care about NULL since NULL is passed when aggregating with zero row.
+            if (matrix0RowObj == null || matrix1RowObj == null) {
+                return;
+            }
 
             final TransposeAndDotAggregationBuffer myAgg = (TransposeAndDotAggregationBuffer) agg;
 
@@ -231,6 +231,10 @@ public final class TransposeAndDotUDAF extends AbstractGenericUDAFResolver {
                 throws HiveException {
             final TransposeAndDotAggregationBuffer myAgg = (TransposeAndDotAggregationBuffer) agg;
 
+            if (myAgg.aggMatrix == null) {
+                return null;
+            }
+
             final List<List<DoubleWritable>> result = new ArrayList<List<DoubleWritable>>();
             for (double[] row : myAgg.aggMatrix) {
                 result.add(WritableUtils.toWritableList(row));
diff --git a/core/src/main/java/hivemall/utils/collections/BoundedPriorityQueue.java b/core/src/main/java/hivemall/utils/collections/BoundedPriorityQueue.java
index 34fb0e46..9fc77547 100644
--- a/core/src/main/java/hivemall/utils/collections/BoundedPriorityQueue.java
+++ b/core/src/main/java/hivemall/utils/collections/BoundedPriorityQueue.java
@@ -45,7 +45,7 @@ public final class BoundedPriorityQueue<E> {
         this.comparator = comparator;
         this.queue = new PriorityQueue<E>(size + 10, comparator);
     }
-    
+
     public boolean contains(@Nonnull E e) {
         return queue.contains(e);
     }
