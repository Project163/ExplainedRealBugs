diff --git a/core/src/main/java/hivemall/topicmodel/LDAUDTF.java b/core/src/main/java/hivemall/topicmodel/LDAUDTF.java
index 4cbd964d..59dc2e3e 100644
--- a/core/src/main/java/hivemall/topicmodel/LDAUDTF.java
+++ b/core/src/main/java/hivemall/topicmodel/LDAUDTF.java
@@ -45,7 +45,7 @@ public final class LDAUDTF extends ProbabilisticTopicModelBaseUDTF {
 
         this.alpha = 1.f / topics;
         this.eta = 1.f / topics;
-        this.numDocs = -1L;
+        this.numDocs = 0L;
         this.tau0 = 64.d;
         this.kappa = 0.7;
         this.delta = DEFAULT_DELTA;
@@ -72,7 +72,7 @@ public final class LDAUDTF extends ProbabilisticTopicModelBaseUDTF {
         if (cl != null) {
             this.alpha = Primitives.parseFloat(cl.getOptionValue("alpha"), 1.f / topics);
             this.eta = Primitives.parseFloat(cl.getOptionValue("eta"), 1.f / topics);
-            this.numDocs = Primitives.parseLong(cl.getOptionValue("num_docs"), -1L);
+            this.numDocs = Primitives.parseLong(cl.getOptionValue("num_docs"), 0L);
             this.tau0 = Primitives.parseDouble(cl.getOptionValue("tau0"), 64.d);
             if (tau0 <= 0.d) {
                 throw new UDFArgumentException("'-tau0' must be positive: " + tau0);
diff --git a/core/src/main/java/hivemall/topicmodel/OnlineLDAModel.java b/core/src/main/java/hivemall/topicmodel/OnlineLDAModel.java
index aed17bac..1ddf52bd 100644
--- a/core/src/main/java/hivemall/topicmodel/OnlineLDAModel.java
+++ b/core/src/main/java/hivemall/topicmodel/OnlineLDAModel.java
@@ -110,7 +110,7 @@ public final class OnlineLDAModel extends AbstractProbabilisticTopicModel {
         this._kappa = kappa;
         this._delta = delta;
 
-        this._isAutoD = (_D < 0L);
+        this._isAutoD = (_D <= 0L);
 
         // initialize a random number generator
         this._gd = new GammaDistribution(SHAPE, SCALE);
diff --git a/core/src/test/java/hivemall/topicmodel/LDAUDTFTest.java b/core/src/test/java/hivemall/topicmodel/LDAUDTFTest.java
index b4636f7a..ed294870 100644
--- a/core/src/test/java/hivemall/topicmodel/LDAUDTFTest.java
+++ b/core/src/test/java/hivemall/topicmodel/LDAUDTFTest.java
@@ -18,18 +18,20 @@
  */
 package hivemall.topicmodel;
 
+import hivemall.TestUtils;
+import hivemall.utils.lang.mutable.MutableInt;
+
+import java.util.Arrays;
 import java.util.List;
 import java.util.Map;
 import java.util.SortedMap;
-import java.util.Arrays;
 
-import hivemall.TestUtils;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
+import org.apache.hadoop.hive.ql.udf.generic.Collector;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorFactory;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils;
 import org.apache.hadoop.hive.serde2.objectinspector.primitive.PrimitiveObjectInspectorFactory;
-
 import org.junit.Assert;
 import org.junit.Test;
 
@@ -181,6 +183,33 @@ public class LDAUDTFTest {
                         "oranges:1")}});
     }
 
+    @Test
+    public void testSingleRow() throws HiveException {
+        LDAUDTF udtf = new LDAUDTF();
+        final int numTopics = 2;
+        ObjectInspector[] argOIs = new ObjectInspector[] {
+                ObjectInspectorFactory.getStandardListObjectInspector(
+                    PrimitiveObjectInspectorFactory.javaStringObjectInspector),
+                ObjectInspectorUtils.getConstantObjectInspector(
+                    PrimitiveObjectInspectorFactory.javaStringObjectInspector,
+                    "-topics " + numTopics)};
+        udtf.initialize(argOIs);
+
+        String[] doc1 = new String[] {"1", "2", "3"};
+        udtf.process(new Object[] {Arrays.asList(doc1)});
+
+        final MutableInt cnt = new MutableInt(0);
+        udtf.setCollector(new Collector() {
+            @Override
+            public void collect(Object arg0) throws HiveException {
+                cnt.addValue(1);
+            }
+        });
+        udtf.close();
+
+        Assert.assertEquals(doc1.length * numTopics, cnt.getValue());
+    }
+
     private static void println(String msg) {
         if (DEBUG) {
             System.out.println(msg);
diff --git a/core/src/test/java/hivemall/topicmodel/PLSAUDTFTest.java b/core/src/test/java/hivemall/topicmodel/PLSAUDTFTest.java
index 7f344d11..a069bcb1 100644
--- a/core/src/test/java/hivemall/topicmodel/PLSAUDTFTest.java
+++ b/core/src/test/java/hivemall/topicmodel/PLSAUDTFTest.java
@@ -18,18 +18,20 @@
  */
 package hivemall.topicmodel;
 
+import hivemall.TestUtils;
+import hivemall.utils.lang.mutable.MutableInt;
+
+import java.util.Arrays;
 import java.util.List;
 import java.util.Map;
 import java.util.SortedMap;
-import java.util.Arrays;
 
-import hivemall.TestUtils;
 import org.apache.hadoop.hive.ql.metadata.HiveException;
+import org.apache.hadoop.hive.ql.udf.generic.Collector;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorFactory;
 import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorUtils;
 import org.apache.hadoop.hive.serde2.objectinspector.primitive.PrimitiveObjectInspectorFactory;
-
 import org.junit.Assert;
 import org.junit.Test;
 
@@ -182,6 +184,33 @@ public class PLSAUDTFTest {
                         "oranges:1")}});
     }
 
+    @Test
+    public void testSingleRow() throws HiveException {
+        PLSAUDTF udtf = new PLSAUDTF();
+        final int numTopics = 2;
+        ObjectInspector[] argOIs = new ObjectInspector[] {
+                ObjectInspectorFactory.getStandardListObjectInspector(
+                    PrimitiveObjectInspectorFactory.javaStringObjectInspector),
+                ObjectInspectorUtils.getConstantObjectInspector(
+                    PrimitiveObjectInspectorFactory.javaStringObjectInspector,
+                    "-topics " + numTopics)};
+        udtf.initialize(argOIs);
+
+        String[] doc1 = new String[] {"1", "2", "3"};
+        udtf.process(new Object[] {Arrays.asList(doc1)});
+
+        final MutableInt cnt = new MutableInt(0);
+        udtf.setCollector(new Collector() {
+            @Override
+            public void collect(Object arg0) throws HiveException {
+                cnt.addValue(1);
+            }
+        });
+        udtf.close();
+
+        Assert.assertEquals(doc1.length * numTopics, cnt.getValue());
+    }
+
     private static void println(String msg) {
         if (DEBUG) {
             System.out.println(msg);
