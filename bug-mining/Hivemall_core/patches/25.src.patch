diff --git a/core/src/main/java/hivemall/GeneralLearnerBaseUDTF.java b/core/src/main/java/hivemall/GeneralLearnerBaseUDTF.java
index 8400a2c3..c8675e5a 100644
--- a/core/src/main/java/hivemall/GeneralLearnerBaseUDTF.java
+++ b/core/src/main/java/hivemall/GeneralLearnerBaseUDTF.java
@@ -18,6 +18,8 @@
  */
 package hivemall;
 
+import static hivemall.utils.collections.CollectionUtils.countNonNulls;
+
 import hivemall.annotations.VisibleForTesting;
 import hivemall.common.ConversionState;
 import hivemall.model.FeatureValue;
@@ -418,8 +420,8 @@ public abstract class GeneralLearnerBaseUDTF extends LearnerBaseUDTF {
         }
 
         final ObjectInspector featureInspector = featureListOI.getListElementObjectInspector();
-        final FeatureValue[] featureVector = new FeatureValue[size];
-        for (int i = 0; i < size; i++) {
+        final FeatureValue[] featureVector = new FeatureValue[countNonNulls(features)];
+        for (int i = 0, j = 0; i < size; i++) {
             Object f = features.get(i);
             if (f == null) {
                 continue;
@@ -433,7 +435,7 @@ public abstract class GeneralLearnerBaseUDTF extends LearnerBaseUDTF {
                     ObjectInspectorCopyOption.JAVA); // should be Integer or Long
                 fv = new FeatureValue(k, 1.f);
             }
-            featureVector[i] = fv;
+            featureVector[j++] = fv;
         }
         return featureVector;
     }
diff --git a/core/src/main/java/hivemall/utils/collections/CollectionUtils.java b/core/src/main/java/hivemall/utils/collections/CollectionUtils.java
new file mode 100644
index 00000000..9a6ae06f
--- /dev/null
+++ b/core/src/main/java/hivemall/utils/collections/CollectionUtils.java
@@ -0,0 +1,39 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+package hivemall.utils.collections;
+
+import java.util.Collection;
+
+import javax.annotation.Nonnull;
+
+public final class CollectionUtils {
+
+    private CollectionUtils() {}
+
+    public static int countNonNulls(@Nonnull final Collection<?> col) {
+        int cnt = 0;
+        for (Object e : col) {
+            if (e != null) {
+                cnt++;
+            }
+        }
+        return cnt;
+    }
+
+}
diff --git a/core/src/test/java/hivemall/GeneralLearnerBaseUDTFTest.java b/core/src/test/java/hivemall/GeneralLearnerBaseUDTFTest.java
new file mode 100644
index 00000000..e18257ee
--- /dev/null
+++ b/core/src/test/java/hivemall/GeneralLearnerBaseUDTFTest.java
@@ -0,0 +1,52 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+package hivemall;
+
+import hivemall.classifier.GeneralClassifierUDTF;
+import hivemall.model.FeatureValue;
+
+import java.util.Arrays;
+import java.util.List;
+
+import org.apache.hadoop.hive.ql.exec.UDFArgumentException;
+import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspector;
+import org.apache.hadoop.hive.serde2.objectinspector.ObjectInspectorFactory;
+import org.apache.hadoop.hive.serde2.objectinspector.primitive.PrimitiveObjectInspectorFactory;
+import org.junit.Assert;
+import org.junit.Test;
+
+public class GeneralLearnerBaseUDTFTest {
+
+    @Test
+    public void testNullFeature() throws UDFArgumentException {
+        GeneralClassifierUDTF udtf = new GeneralClassifierUDTF();
+        udtf.initialize(new ObjectInspector[] {
+                ObjectInspectorFactory.getStandardListObjectInspector(
+                    PrimitiveObjectInspectorFactory.javaStringObjectInspector),
+                PrimitiveObjectInspectorFactory.javaIntObjectInspector});
+
+        List<String> features = Arrays.asList("1", "2", null, "3", null);
+
+        FeatureValue[] array = udtf.parseFeatures(features);
+        Assert.assertEquals(3, array.length);
+
+        Assert.assertEquals(0, udtf.parseFeatures(Arrays.asList(new String[] {null})).length);
+    }
+
+}
