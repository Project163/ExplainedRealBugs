diff --git a/src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java b/src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java
index 78553fb8..19ad247d 100644
--- a/src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java
+++ b/src/main/java/org/apache/commons/imaging/formats/jpeg/decoder/JpegDecoder.java
@@ -526,20 +526,24 @@ public class JpegDecoder extends BinaryFileParser implements JpegUtils.Visitor {
                     // but special handling was added for TIFF-JPEG RGB colorspace
                     // and conditional checks were reorganized for efficiency
                     if (useTiffRgb && (scaledMCU.length == 3 || scaledMCU.length == 4)) {
-                        // pre-compute the maximum allowed value for the
-                        // x2 index in the loops below.
+                        // The original (legacy) coding for the x2 and y2 loop was:
+                        //    for(y2 = 0; y2 < vSize && y1 + y2 < sofnSegment.height; y2++)
+                        //    for(x2 = 0; x2 < hSize  && x1 + x2 < sofnSegment.width; x2++)
+                        // Here, we pre-compute the limits of the loop to reduce the
+                        // overhead for the loop conditional evaluation.
                         final int x2Limit;
                         if (x1 + hSize <= sofnSegment.width) {
                             x2Limit = hSize;
                         } else {
-                            x2Limit = sofnSegment.width - hSize;
+                            x2Limit = sofnSegment.width - x1;
                         }
                         final int y2Limit;
                         if (y1 + vSize <= sofnSegment.height) {
                             y2Limit = vSize;
                         } else {
-                            y2Limit = sofnSegment.height - vSize;
+                            y2Limit = sofnSegment.height - y1;
                         }
+
                         if (scaledMCU.length == 4) {
                             // RGBA colorspace
                             // Although conventional JPEGs don't include an alpha channel
diff --git a/src/test/java/org/apache/commons/imaging/formats/tiff/TiffJpegTest.java b/src/test/java/org/apache/commons/imaging/formats/tiff/TiffJpegTest.java
index b38ae9c5..9cd73ca0 100644
--- a/src/test/java/org/apache/commons/imaging/formats/tiff/TiffJpegTest.java
+++ b/src/test/java/org/apache/commons/imaging/formats/tiff/TiffJpegTest.java
@@ -51,6 +51,11 @@ public class TiffJpegTest extends TiffBaseTest {
         "TestSampleArgb.tiff",
         "TestJpegArgb.tiff",};
 
+      static final String[] testSet3 = {
+        "TestSampleRgb127x127.tiff",
+        "TestJpegRgb127x127.tiff",};
+
+
     private File getTiffFile(String name) {
         final File tiffFolder = new File(ImagingTestConstants.TEST_IMAGE_FOLDER, "tiff");
         final File tiffJpegFolder = new File(tiffFolder, "14");
@@ -161,6 +166,11 @@ public class TiffJpegTest extends TiffBaseTest {
 
         // test set 2 includes a TIFF-specific alpha channel
         processTestSet(testSet2);
+
+        // test set 3 includes an add-valued width and height that does
+        // not evently fit a block of JPEG data. It is used to test
+        // for the proper handling of edge-cases.
+         processTestSet(testSet3);
     }
 
     /**
@@ -171,6 +181,7 @@ public class TiffJpegTest extends TiffBaseTest {
     public void testSubImage() throws IOException {
         performSubImageTest("TestJpegProgressive.tiff"); // strips
         performSubImageTest("TestJpegTiles264x264.tiff"); // tiles
+        performSubImageTest("TestJpegRgb127x127.tiff");
     }
 
 }
diff --git a/src/test/resources/data/images/tiff/14/TestJpegRgb127x127.tiff b/src/test/resources/data/images/tiff/14/TestJpegRgb127x127.tiff
new file mode 100644
index 00000000..1a651a87
Binary files /dev/null and b/src/test/resources/data/images/tiff/14/TestJpegRgb127x127.tiff differ
diff --git a/src/test/resources/data/images/tiff/14/TestSampleRgb127x127.tiff b/src/test/resources/data/images/tiff/14/TestSampleRgb127x127.tiff
new file mode 100644
index 00000000..83d0881b
Binary files /dev/null and b/src/test/resources/data/images/tiff/14/TestSampleRgb127x127.tiff differ
