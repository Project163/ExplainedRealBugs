diff --git a/src/changes/changes.xml b/src/changes/changes.xml
index f8094613..64c29465 100644
--- a/src/changes/changes.xml
+++ b/src/changes/changes.xml
@@ -46,6 +46,9 @@ The <action> type attribute can be add,update,fix,remove.
   <body>
 
     <release version="1.0" date="TBA" description="First major release">
+      <action issue="IMAGING-178" dev="britter" type="fix" due-to="emopers">
+        PnmImageParser does not check the validity of input PAM header.
+      </action>
       <action issue="IMAGING-184" dev="ggregory" type="update">
         Update platform from Java 5 to 7
       </action>
diff --git a/src/main/java/org/apache/commons/imaging/formats/pnm/PnmImageParser.java b/src/main/java/org/apache/commons/imaging/formats/pnm/PnmImageParser.java
index 967912e2..301ac0df 100644
--- a/src/main/java/org/apache/commons/imaging/formats/pnm/PnmImageParser.java
+++ b/src/main/java/org/apache/commons/imaging/formats/pnm/PnmImageParser.java
@@ -157,18 +157,28 @@ public class PnmImageParser extends ImageParser {
                 final String type = tokenizer.nextToken();
                 if ("WIDTH".equals(type)) {
                     seenWidth = true;
+                    if(!tokenizer.hasMoreTokens())
+                        throw new ImageReadException("PAM header has no WIDTH value");
                     width = Integer.parseInt(tokenizer.nextToken());
                 } else if ("HEIGHT".equals(type)) {
                     seenHeight = true;
+                    if(!tokenizer.hasMoreTokens())
+                        throw new ImageReadException("PAM header has no HEIGHT value");
                     height = Integer.parseInt(tokenizer.nextToken());
                 } else if ("DEPTH".equals(type)) {
                     seenDepth = true;
+                    if(!tokenizer.hasMoreTokens())
+                        throw new ImageReadException("PAM header has no DEPTH value");
                     depth = Integer.parseInt(tokenizer.nextToken());
                 } else if ("MAXVAL".equals(type)) {
                     seenMaxVal = true;
+                    if(!tokenizer.hasMoreTokens())
+                        throw new ImageReadException("PAM header has no MAXVAL value");
                     maxVal = Integer.parseInt(tokenizer.nextToken());
                 } else if ("TUPLTYPE".equals(type)) {
                     seenTupleType = true;
+                    if(!tokenizer.hasMoreTokens())
+                        throw new ImageReadException("PAM header has no TUPLTYPE value");
                     tupleType.append(tokenizer.nextToken());
                 } else if ("ENDHDR".equals(type)) {
                     break;
diff --git a/src/test/java/org/apache/commons/imaging/formats/pnm/PnmImageParserTest.java b/src/test/java/org/apache/commons/imaging/formats/pnm/PnmImageParserTest.java
index 066ed37b..59e5fe62 100644
--- a/src/test/java/org/apache/commons/imaging/formats/pnm/PnmImageParserTest.java
+++ b/src/test/java/org/apache/commons/imaging/formats/pnm/PnmImageParserTest.java
@@ -46,4 +46,12 @@ public class PnmImageParserTest {
     PnmImageParser underTest = new PnmImageParser();
     underTest.getImageInfo(bytes, params);
   }
+
+  @Test(expected = ImageReadException.class)
+  public void testGetImageInfo_missingWidthValue() throws ImageReadException, IOException {
+    byte[] bytes = "P7\nWIDTH \n".getBytes(US_ASCII);
+    Map<String, Object> params = Collections.emptyMap();
+    PnmImageParser underTest = new PnmImageParser();
+    underTest.getImageInfo(bytes, params);
+  }
 }
