<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:30:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[IMAGING-246] Invalid Block Size error prevents handling of block 1084, Macintosh NSPrintInfo</title>
                <link>https://issues.apache.org/jira/browse/IMAGING-246</link>
                <project id="12313421" key="IMAGING">Commons Imaging</project>
                    <description>&lt;p&gt;When processing an image created on a Mac with Adobe Photoshop which contains embedded metadata having block 1084, an invalid block size error occurs.&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;0x043C&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;1084&lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;&lt;em&gt;(Photoshop CS5)&lt;/em&gt;&#160;Macintosh NSPrintInfo. Variable OS specific info for Macintosh. NSPrintInfo. It is recommened that you do not interpret or use this data.&lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;


&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Here is some simple test code that replicates what our application is trying to do, and recreates the error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.imaging.ImageInfo;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.imaging.ImageReadException;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.imaging.Imaging;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.commons.io.FileUtils;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.io.File;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.io.IOException;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.Base64;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;Main {
&#160;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void main(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] args) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException, ImageReadException { 
  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fileName = &lt;span class=&quot;code-quote&quot;&gt;&quot;FallHarvestKitKat_07610.jpg&quot;&lt;/span&gt;;
  &lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt; classLoader = &lt;span class=&quot;code-object&quot;&gt;ClassLoader&lt;/span&gt;.getSystemClassLoader(); 
  File file = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; File(classLoader.getResource(fileName).getFile()); 
  &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] fileContent = FileUtils.readFileToByteArray(file); 
  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; encodedString = Base64.getEncoder().encodeToString(fileContent); 
  &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] decodedValue = Base64.getDecoder().decode(encodedString); 
  ImageInfo imageInfo = Imaging.getImageInfo(decodedValue);
 }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Here is the resulting error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; Exception in thread &quot;main&quot; org.apache.commons.imaging.ImageReadException: Invalid Block Size : 89562 &amp;gt; 65504Exception in thread &quot;main&quot; 
 org.apache.commons.imaging.ImageReadException: Invalid Block Size : 89562 &amp;gt; 65504 at 
 org.apache.commons.imaging.formats.jpeg.iptc.IptcParser.parseAllBlocks(IptcParser.java:318) at 
 org.apache.commons.imaging.formats.jpeg.iptc.IptcParser.parsePhotoshopSegment(IptcParser.java:119) at 
 org.apache.commons.imaging.formats.jpeg.iptc.IptcParser.parsePhotoshopSegment(IptcParser.java:112) at 
 org.apache.commons.imaging.formats.jpeg.segments.App13Segment.parsePhotoshopSegment(App13Segment.java:71) at 
 org.apache.commons.imaging.formats.jpeg.JpegImageParser.getPhotoshopMetadata(JpegImageParser.java:599) at 
 org.apache.commons.imaging.formats.jpeg.JpegImageParser.getMetadata(JpegImageParser.java:318) at 
 org.apache.commons.imaging.formats.jpeg.JpegImageParser.getImageInfo(JpegImageParser.java:739) at org.apache.commons.imaging.Imaging.getImageInfo(Imaging.java:701) at 
 org.apache.commons.imaging.Imaging.getImageInfo(Imaging.java:635) at Main.getMetaData(Main.java:22) at Main.main(Main.java:17)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13278747">IMAGING-246</key>
            <summary>Invalid Block Size error prevents handling of block 1084, Macintosh NSPrintInfo</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kinow">Bruno P. Kinoshita</assignee>
                                    <reporter username="lwollerman">Liberty Wollerman</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Jan 2020 16:10:56 +0000</created>
                <updated>Thu, 19 May 2022 04:29:27 +0000</updated>
                            <resolved>Sat, 18 Jan 2020 21:05:27 +0000</resolved>
                                    <version>1.0-alpha1</version>
                                                    <component>Format: JPEG</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3000">50m</timespent>
                                <comments>
                            <comment id="17013026" author="lwollerman" created="Fri, 10 Jan 2020 16:12:48 +0000"  >&lt;p&gt;Please bear with me as this is my first time reporting an issue to Apache JIRA. I will happily update with any additional details needed.&lt;/p&gt;</comment>
                            <comment id="17013395" author="kinow" created="Sat, 11 Jan 2020 07:28:40 +0000"  >&lt;p&gt;No problem &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lwollerman&quot; class=&quot;user-hover&quot; rel=&quot;lwollerman&quot;&gt;lwollerman&lt;/a&gt; , you reported the issue with example code and an attachment to reproduce it, and with a good issue description. I&apos;ve just updated the formatting to use the code and the noformat macros (I type the macros, but there are some buttons in the editor that can help too).&lt;/p&gt;

&lt;p&gt;Will try to reproduce and debug the issue later. Thanks!!!&lt;/p&gt;</comment>
                            <comment id="17013599" author="kinow" created="Sat, 11 Jan 2020 23:14:22 +0000"  >&lt;p&gt;PR with a fix submitted &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=lwollerman&quot; class=&quot;user-hover&quot; rel=&quot;lwollerman&quot;&gt;lwollerman&lt;/a&gt; . It should now skip the fields that the spec says are not recommended to be interpreted.&lt;/p&gt;

&lt;p&gt;Cheers&lt;/p&gt;</comment>
                            <comment id="17014377" author="lwollerman" created="Mon, 13 Jan 2020 14:37:58 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kinow&quot; class=&quot;user-hover&quot; rel=&quot;kinow&quot;&gt;kinow&lt;/a&gt;&#160;I appreciate your speedy response. Also, thanks for reformatting the description. I noticed that the reformatted code block was different content than my originally pasted code, so I just updated that in the description.&lt;/p&gt;</comment>
                            <comment id="17539248" author="kinow" created="Thu, 19 May 2022 04:29:27 +0000"  >&lt;p&gt;Apache Commons Imaging 1.0-alpha3 has been released.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12990540" name="FallHarvestKitKat_07610.jpg" size="1269869" author="lwollerman" created="Fri, 10 Jan 2020 15:55:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 25 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ae3s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>