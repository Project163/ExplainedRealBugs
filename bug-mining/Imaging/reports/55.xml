<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:30:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[IMAGING-215] ArrayIndexOutOfBoundsException in DhtSegment</title>
                <link>https://issues.apache.org/jira/browse/IMAGING-215</link>
                <project id="12313421" key="IMAGING">Commons Imaging</project>
                    <description>&lt;p&gt;I simply ran the Kelinci AFL-based Java fuzzer with the common immaging as explained here (with better input files than the author, fuzzing is all about corpus data):&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/isstac/kelinci/tree/master/examples/commons-imaging&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/isstac/kelinci/tree/master/examples/commons-imaging&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I found the following issue when parsing the attached file:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Exception in thread &lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; java.lang.ArrayIndexOutOfBoundsException: 0
	at org.apache.commons.imaging.formats.jpeg.segments.DhtSegment$HuffmanTable.&amp;lt;init&amp;gt;(DhtSegment.java:79)
	at org.apache.commons.imaging.formats.jpeg.segments.DhtSegment.&amp;lt;init&amp;gt;(DhtSegment.java:173)
	at org.apache.commons.imaging.formats.jpeg.segments.DhtSegment.&amp;lt;init&amp;gt;(DhtSegment.java:146)
	at org.apache.commons.imaging.formats.jpeg.decoder.JpegDecoder.visitSegment(JpegDecoder.java:219)
	at org.apache.commons.imaging.formats.jpeg.JpegUtils.traverseJFIF(JpegUtils.java:89)
	at org.apache.commons.imaging.formats.jpeg.decoder.JpegDecoder.decode(JpegDecoder.java:437)
	at org.apache.commons.imaging.formats.jpeg.JpegImageParser.getBufferedImage(JpegImageParser.java:97)
	at driver.Driver.main(Driver.java:23)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The rest is as described in the link, I also used commons-imaging-1.0-RC7.tar.gz&lt;/p&gt;

&lt;p&gt;The parser doesn&apos;t declare that an ArrayIndexOutOfBoundsException could be thrown.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13136868">IMAGING-215</key>
            <summary>ArrayIndexOutOfBoundsException in DhtSegment</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kinow">Bruno P. Kinoshita</assignee>
                                    <reporter username="floyd">floyd</reporter>
                        <labels>
                            <label>security</label>
                    </labels>
                <created>Wed, 7 Feb 2018 14:25:12 +0000</created>
                <updated>Fri, 7 Aug 2020 04:32:13 +0000</updated>
                            <resolved>Sat, 10 Feb 2018 10:16:43 +0000</resolved>
                                    <version>1.0-alpha1</version>
                                    <fixVersion>1.0-alpha1</fixVersion>
                                    <component>Format: JPEG</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16359357" author="kinow" created="Sat, 10 Feb 2018 10:16:34 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=floyd&quot; class=&quot;user-hover&quot; rel=&quot;floyd&quot;&gt;floyd&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks for reporting the issue, and for the interesting links. I&apos;ve added a bookmark with a note to read the paper and have a look at the fuzzer used. But before that, confirmed we had the exception from an assignment that wasn&apos;t confirming the array length and the index given during the huffman table creation for the one segment.&lt;/p&gt;

&lt;p&gt;Added a fix and unit test.&lt;/p&gt;

&lt;p&gt;Cheers&lt;/p&gt;

&lt;p&gt;Bruno&lt;/p&gt;</comment>
                            <comment id="16359360" author="kinow" created="Sat, 10 Feb 2018 10:24:28 +0000"  >&lt;p&gt;Now the code will throw another error:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Exception in thread &quot;main&quot; java.io.IOException: Not a Valid JPEG File
&#160;&#160; &#160;at org.apache.commons.imaging.common.BinaryFunctions.readByte(BinaryFunctions.java:74)
&#160;&#160; &#160;at org.apache.commons.imaging.formats.jpeg.segments.DhtSegment.&amp;lt;init&amp;gt;(DhtSegment.java:161)
&#160;&#160; &#160;at org.apache.commons.imaging.formats.jpeg.segments.DhtSegment.&amp;lt;init&amp;gt;(DhtSegment.java:138)
&#160;&#160; &#160;at org.apache.commons.imaging.formats.jpeg.decoder.JpegDecoder.visitSegment(JpegDecoder.java:221)
&#160;&#160; &#160;at org.apache.commons.imaging.formats.jpeg.JpegUtils.traverseJFIF(JpegUtils.java:91)
&#160;&#160; &#160;at org.apache.commons.imaging.formats.jpeg.decoder.JpegDecoder.decode(JpegDecoder.java:438)
&#160;&#160; &#160;at org.apache.commons.imaging.formats.jpeg.JpegImageParser.getBufferedImage(JpegImageParser.java:99)
&#160;&#160; &#160;at org.apache.commons.imaging.ImageParser.getBufferedImage(ImageParser.java:552)
&#160;&#160; &#160;at org.apache.commons.imaging.formats.jpeg.JpegImageParser.main(JpegImageParser.java:1169)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16359361" author="kinow" created="Sat, 10 Feb 2018 10:25:07 +0000"  >&lt;p&gt;This exception indicates the JPEG is not valid, which is the same exiftool gives me.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ exiftool -validate -error -warning -a&#160; ArrayIndexOutOfBoundsException_DhtSegment_79.jpeg
Warning&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160;&#160; : JPEG format error&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16360567" author="floyd" created="Mon, 12 Feb 2018 10:33:30 +0000"  >&lt;p&gt;I didn&apos;t try it, but if it behaves like that that sounds good. Thanks for the fast response and fix.&lt;/p&gt;</comment>
                            <comment id="17172859" author="kinow" created="Fri, 7 Aug 2020 04:32:13 +0000"  >&lt;p&gt;Apache Commons Imaging 1.0-alpha1 released (long ago, just closing the remaining issues marked as Resolved)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12909620" name="ArrayIndexOutOfBoundsException_DhtSegment_79.jpeg" size="2746" author="floyd" created="Wed, 7 Feb 2018 14:23:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 14 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3pwfz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>