<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 18:30:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[IMAGING-117] Classes should not expose mutable arrays</title>
                <link>https://issues.apache.org/jira/browse/IMAGING-117</link>
                <project id="12313421" key="IMAGING">Commons Imaging</project>
                    <description></description>
                <environment></environment>
        <key id="12674829">IMAGING-117</key>
            <summary>Classes should not expose mutable arrays</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="sebb">Sebb</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Oct 2013 16:28:36 +0000</created>
                <updated>Fri, 3 May 2019 08:39:55 +0000</updated>
                            <resolved>Fri, 2 Jan 2015 08:55:10 +0000</resolved>
                                                    <fixVersion>1.0-alpha1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13800777" author="sebb@apache.org" created="Mon, 21 Oct 2013 16:29:15 +0000"  >&lt;p&gt;Likewise SosSegment.components&lt;/p&gt;</comment>
                            <comment id="13800778" author="sebb@apache.org" created="Mon, 21 Oct 2013 16:35:07 +0000"  >&lt;p&gt;Also:&lt;br/&gt;
Block.samples&lt;br/&gt;
PngChunk.bytes&lt;br/&gt;
PngChunkPlte.rgb&lt;br/&gt;
PsdHeaderInfo.Reserved&lt;br/&gt;
ImageDataOffsets.imageDataOffsets&lt;br/&gt;
ImageDataOffsets.outputItems&lt;br/&gt;
IccProfileInfo.data&lt;br/&gt;
IccProfileInfo.ProfileID&lt;br/&gt;
IccProfileInfo.tags&lt;br/&gt;
IccTag.data&lt;br/&gt;
ColorSpaceSubset.maxs&lt;br/&gt;
ColorSpaceSubset.mins&lt;/p&gt;


&lt;p&gt;Public mutable List&lt;br/&gt;
TiffContents.directories&lt;br/&gt;
ColorGroup.color_counts&lt;/p&gt;


&lt;p&gt;Protected mutable arrays:&lt;br/&gt;
TransparencyFilter.bytes&lt;br/&gt;
ImageResourceBlock.data&lt;br/&gt;
ImageResourceBlock.nameData&lt;br/&gt;
DataReader.bitsPerSample&lt;br/&gt;
DataReader.last&lt;br/&gt;
PhotometricInterpreter.bitsPerSample&lt;/p&gt;


</comment>
                            <comment id="13801458" author="damjan" created="Tue, 22 Oct 2013 04:19:45 +0000"  >&lt;p&gt;Ok, but why are protected mutable arrays a problem?&lt;/p&gt;</comment>
                            <comment id="13801905" author="mbenson" created="Tue, 22 Oct 2013 15:21:25 +0000"  >&lt;p&gt;Because any code executing in the VM can come along and modify the contents of that array. &lt;/p&gt;</comment>
                            <comment id="13801944" author="sebb@apache.org" created="Tue, 22 Oct 2013 15:46:17 +0000"  >&lt;p&gt;Also - because of the Java memory model - there is no way for the classes to ensure thread safety when the array is modified.&lt;br/&gt;
Array entries written by one thread are not guaranteed to be made visible to other threads in the absence of synchronisation.&lt;/p&gt;</comment>
                            <comment id="13802068" author="damjan" created="Tue, 22 Oct 2013 18:02:25 +0000"  >&lt;p&gt;Public mutable List:&lt;br/&gt;
TiffContents.directories and ColorGroup.color_counts are now Collections.unmodifiableList()s&lt;/p&gt;

&lt;p&gt;Protected mutable arrays:&lt;br/&gt;
But protected fields can only be written from subclasses and from the same package, both of which presumably know not to write to them.&lt;/p&gt;</comment>
                            <comment id="13803079" author="gwlucas" created="Wed, 23 Oct 2013 18:05:30 +0000"  >&lt;p&gt;I recommend caution on this kind of change.  If we make a &quot;safe copy&quot; of an array every time a get() method asks for one, we could end up making a lot of redundant copies of the same thing.  This action would have a strongly negative impact on performance especially in image processing where some of these calls are made (literally) millions of times.  &lt;/p&gt;

&lt;p&gt;It is probably better to restrict the &quot;safe copy&quot; tactic to public methods only and just hope that whoever writes code using protected methods is careful enough to not modify an array he gets from the method.  &lt;/p&gt;</comment>
                            <comment id="14260070" author="sebb@apache.org" created="Mon, 29 Dec 2014 12:09:04 +0000"  >&lt;p&gt;Apart from read-only collections, arrays can be made read-only by providing a getter for the individual entries.&lt;br/&gt;
Alternatively, the array holder can provide an interface to process entries.&lt;/p&gt;

&lt;p&gt;In any case, mutable fields should never be exposed.&lt;br/&gt;
Code should always use a getter/setter as that allows synchronisation to be easily added.&lt;br/&gt;
Even if the getter/setter does not copy the array it provides better encapsulation, and allows for changes of implementation without affecting callers.&lt;/p&gt;</comment>
                            <comment id="14260175" author="sebb@apache.org" created="Mon, 29 Dec 2014 15:56:32 +0000"  >&lt;p&gt;Have fixed all the entries previously mentioned in the issue.&lt;/p&gt;

&lt;p&gt;However, I could not fix:&lt;br/&gt;
ColorGroup.color_counts - List is sorted multiple times, so cannot be made read-only&lt;/p&gt;</comment>
                            <comment id="14262643" author="britter" created="Thu, 1 Jan 2015 19:21:31 +0000"  >&lt;p&gt;New issue just for ColorGroup.color_counts?&lt;/p&gt;</comment>
                            <comment id="14262683" author="sebb@apache.org" created="Thu, 1 Jan 2015 23:04:26 +0000"  >&lt;p&gt;Created issue&lt;/p&gt;</comment>
                            <comment id="14262793" author="britter" created="Fri, 2 Jan 2015 08:55:10 +0000"  >&lt;p&gt;Added issue to changes.xml.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12764469">IMAGING-151</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>354451</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 46 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1p3vz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>354741</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>