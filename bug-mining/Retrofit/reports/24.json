{"url":"https://api.github.com/repos/square/retrofit/issues/478","repository_url":"https://api.github.com/repos/square/retrofit","labels_url":"https://api.github.com/repos/square/retrofit/issues/478/labels{/name}","comments_url":"https://api.github.com/repos/square/retrofit/issues/478/comments","events_url":"https://api.github.com/repos/square/retrofit/issues/478/events","html_url":"https://github.com/square/retrofit/issues/478","id":33312486,"node_id":"MDU6SXNzdWUzMzMxMjQ4Ng==","number":478,"title":"Add @Raw or similiar to avoid convertig body stream to byte[] in Response object","user":{"login":"rzimmer","id":1107682,"node_id":"MDQ6VXNlcjExMDc2ODI=","avatar_url":"https://avatars.githubusercontent.com/u/1107682?v=4","gravatar_id":"","url":"https://api.github.com/users/rzimmer","html_url":"https://github.com/rzimmer","followers_url":"https://api.github.com/users/rzimmer/followers","following_url":"https://api.github.com/users/rzimmer/following{/other_user}","gists_url":"https://api.github.com/users/rzimmer/gists{/gist_id}","starred_url":"https://api.github.com/users/rzimmer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/rzimmer/subscriptions","organizations_url":"https://api.github.com/users/rzimmer/orgs","repos_url":"https://api.github.com/users/rzimmer/repos","events_url":"https://api.github.com/users/rzimmer/events{/privacy}","received_events_url":"https://api.github.com/users/rzimmer/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2014-05-12T14:29:33Z","updated_at":"2014-06-06T06:02:15Z","closed_at":"2014-06-06T06:02:15Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hey there,\n\nfirst of all thanks for providing Retrofit! It's an amazing framework that impressively simplifies calling REST-APIs!\n\nWe use it in one of our server application to communicate with another remote server to download binary data (i.e. files) from there using Response as return type for the interface method. Our server operates as a proxy and copies the response.getBody().in() to the the user requesting resources. This approach works as expected, but has a performance flaw.\n\nAt the moment Retrofit converts every Response body stream to a byte array (see RestAdapter.java):\n\n``` java\nif (type.equals(Response.class)) {\n    // Read the entire stream and replace with one backed by a byte[]\n    response = Utils.readBodyToBytesIfNecessary(response);\n\n    if (methodInfo.isSynchronous) {\n        return response;\n    }\n    return new ResponseWrapper(response, response);\n}\n```\n\nIf you just want to proxy the stream, converting to a byte[] first can result in a real performance hit. The larger the binary data, the worse it will be. We would like to see _response = Utils.readBodyToBytesIfNecessary(response);_ optional, e.g. by annotating the interface method with Response return type with an additional _@Raw_.\n\nWhat do you think of this approach? Maybe something like this is already planned?\nIf not and if you consider this a valid approach, we can also prepare a pull request to implement this behaviour. \n","closed_by":{"login":"JakeWharton","id":66577,"node_id":"MDQ6VXNlcjY2NTc3","avatar_url":"https://avatars.githubusercontent.com/u/66577?v=4","gravatar_id":"","url":"https://api.github.com/users/JakeWharton","html_url":"https://github.com/JakeWharton","followers_url":"https://api.github.com/users/JakeWharton/followers","following_url":"https://api.github.com/users/JakeWharton/following{/other_user}","gists_url":"https://api.github.com/users/JakeWharton/gists{/gist_id}","starred_url":"https://api.github.com/users/JakeWharton/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JakeWharton/subscriptions","organizations_url":"https://api.github.com/users/JakeWharton/orgs","repos_url":"https://api.github.com/users/JakeWharton/repos","events_url":"https://api.github.com/users/JakeWharton/events{/privacy}","received_events_url":"https://api.github.com/users/JakeWharton/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/square/retrofit/issues/478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/square/retrofit/issues/478/timeline","performed_via_github_app":null,"state_reason":"completed"}