{"url":"https://api.github.com/repos/square/retrofit/issues/181","repository_url":"https://api.github.com/repos/square/retrofit","labels_url":"https://api.github.com/repos/square/retrofit/issues/181/labels{/name}","comments_url":"https://api.github.com/repos/square/retrofit/issues/181/comments","events_url":"https://api.github.com/repos/square/retrofit/issues/181/events","html_url":"https://github.com/square/retrofit/issues/181","id":13196856,"node_id":"MDU6SXNzdWUxMzE5Njg1Ng==","number":181,"title":"Calling error.getBody() in failure(final RetrofitError error) results in NetworkOnMainThreadException","user":{"login":"Gyllsdorff","id":1038004,"node_id":"MDQ6VXNlcjEwMzgwMDQ=","avatar_url":"https://avatars.githubusercontent.com/u/1038004?v=4","gravatar_id":"","url":"https://api.github.com/users/Gyllsdorff","html_url":"https://github.com/Gyllsdorff","followers_url":"https://api.github.com/users/Gyllsdorff/followers","following_url":"https://api.github.com/users/Gyllsdorff/following{/other_user}","gists_url":"https://api.github.com/users/Gyllsdorff/gists{/gist_id}","starred_url":"https://api.github.com/users/Gyllsdorff/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Gyllsdorff/subscriptions","organizations_url":"https://api.github.com/users/Gyllsdorff/orgs","repos_url":"https://api.github.com/users/Gyllsdorff/repos","events_url":"https://api.github.com/users/Gyllsdorff/events{/privacy}","received_events_url":"https://api.github.com/users/Gyllsdorff/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2013-04-15T12:19:18Z","updated_at":"2013-05-01T23:27:32Z","closed_at":"2013-05-01T23:27:32Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"``` Java\n    interface ServerLogin {\n        @POST(\"/account/login\")\n        void login(@Name(\"username\") String username, @Name(\"password\") String password, Callback<LoginResponse> callback);\n    }\n\n\n// Later in the code\n    final RestAdapter restAdapter = new RestAdapter.Builder().setServer(\n                \"http://[VALID URL]\").build();\n    final ServerLogin serverLogin = restAdapter.create(ServerLogin.class);\n    serverLogin.login(username, password, new Callback<LoginResponse>() {\n            public void failure(final RetrofitError error) {\n                android.util.Log.i(\"example\", \"Error, body: \" + error.getBody().toString());\n```\n\nThe above example is missing a required parameter so the server responds with a 400 status and a json formatted exception. \n\nWhen I call getBody or getBodyAs\n\n``` Java\nfinal LoginResponse res = (LoginResponse) error.getBodyAs(LoginResponse.class);\n```\n\nI get a \n\n```\nE/AndroidRuntime(11620): FATAL EXCEPTION: main\nE/AndroidRuntime(11620): android.os.NetworkOnMainThreadException\nE/AndroidRuntime(11620):        at android.os.StrictMode$AndroidBlockGuardPolicy.onNetwork(StrictMode.java:1117)\nE/AndroidRuntime(11620):        at libcore.io.BlockGuardOs.recvfrom(BlockGuardOs.java:163)\nE/AndroidRuntime(11620):        at libcore.io.IoBridge.recvfrom(IoBridge.java:513)\nE/AndroidRuntime(11620):        at java.net.PlainSocketImpl.read(PlainSocketImpl.java:488)\nE/AndroidRuntime(11620):        at java.net.PlainSocketImpl.access$000(PlainSocketImpl.java:46)\nE/AndroidRuntime(11620):        at java.net.PlainSocketImpl$PlainSocketInputStream.read(PlainSocketImpl.java:240)\nE/AndroidRuntime(11620):        at java.io.InputStream.read(InputStream.java:163)\nE/AndroidRuntime(11620):        at java.io.BufferedInputStream.fillbuf(BufferedInputStream.java:142)\nE/AndroidRuntime(11620):        at java.io.BufferedInputStream.read(BufferedInputStream.java:309)\nE/AndroidRuntime(11620):        at libcore.net.http.FixedLengthInputStream.read(FixedLengthInputStream.java:45)\nE/AndroidRuntime(11620):        at java.io.InputStreamReader.read(InputStreamReader.java:244)\nE/AndroidRuntime(11620):        at com.google.gson.stream.JsonReader.fillBuffer(JsonReader.java:825)\nE/AndroidRuntime(11620):        at com.google.gson.stream.JsonReader.nextNonWhitespace(JsonReader.java:884)\nE/AndroidRuntime(11620):        at com.google.gson.stream.JsonReader.consumeNonExecutePrefix(JsonReader.java:405)\nE/AndroidRuntime(11620):        at com.google.gson.stream.JsonReader.peek(JsonReader.java:364)\nE/AndroidRuntime(11620):        at com.google.gson.Gson.fromJson(Gson.java:792)\nE/AndroidRuntime(11620):        at com.google.gson.Gson.fromJson(Gson.java:761)\nE/AndroidRuntime(11620):        at retrofit.http.GsonConverter.fromBody(GsonConverter.java:31)\nE/AndroidRuntime(11620):        at retrofit.http.RetrofitError.getBody(RetrofitError.java:69)\nE/AndroidRuntime(11620):        at [MY PROJECT]\nE/AndroidRuntime(11620):        at retrofit.http.CallbackRunnable$2.run(CallbackRunnable.java:33)\nE/AndroidRuntime(11620):        at android.os.Handler.handleCallback(Handler.java:725)\nE/AndroidRuntime(11620):        at android.os.Handler.dispatchMessage(Handler.java:92)\nE/AndroidRuntime(11620):        at android.os.Looper.loop(Looper.java:137)\nE/AndroidRuntime(11620):        at android.app.ActivityThread.main(ActivityThread.java:5041)\nE/AndroidRuntime(11620):        at java.lang.reflect.Method.invokeNative(Native Method)\nE/AndroidRuntime(11620):        at java.lang.reflect.Method.invoke(Method.java:511)\nE/AndroidRuntime(11620):        at com.android.internal.os.ZygoteInit$MethodAndArgsCaller.run(ZygoteInit.java:793)\nE/AndroidRuntime(11620):        at com.android.internal.os.ZygoteInit.main(ZygoteInit.java:560)\nE/AndroidRuntime(11620):        at dalvik.system.NativeStart.main(Native Method)\n```\n\nI fixed it by extending retrofit.http.Callback<?> and made it parse the error on a different thread.\n\nThanks for the library, it is really the best android ReST intergration library I have tried so far.\n","closed_by":{"login":"JakeWharton","id":66577,"node_id":"MDQ6VXNlcjY2NTc3","avatar_url":"https://avatars.githubusercontent.com/u/66577?v=4","gravatar_id":"","url":"https://api.github.com/users/JakeWharton","html_url":"https://github.com/JakeWharton","followers_url":"https://api.github.com/users/JakeWharton/followers","following_url":"https://api.github.com/users/JakeWharton/following{/other_user}","gists_url":"https://api.github.com/users/JakeWharton/gists{/gist_id}","starred_url":"https://api.github.com/users/JakeWharton/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JakeWharton/subscriptions","organizations_url":"https://api.github.com/users/JakeWharton/orgs","repos_url":"https://api.github.com/users/JakeWharton/repos","events_url":"https://api.github.com/users/JakeWharton/events{/privacy}","received_events_url":"https://api.github.com/users/JakeWharton/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/square/retrofit/issues/181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/square/retrofit/issues/181/timeline","performed_via_github_app":null,"state_reason":"completed"}