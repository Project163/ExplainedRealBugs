{"url":"https://api.github.com/repos/square/retrofit/issues/2716","repository_url":"https://api.github.com/repos/square/retrofit","labels_url":"https://api.github.com/repos/square/retrofit/issues/2716/labels{/name}","comments_url":"https://api.github.com/repos/square/retrofit/issues/2716/comments","events_url":"https://api.github.com/repos/square/retrofit/issues/2716/events","html_url":"https://github.com/square/retrofit/issues/2716","id":308851119,"node_id":"MDU6SXNzdWUzMDg4NTExMTk=","number":2716,"title":"Facilitate trace propagation with RxJava2","user":{"login":"codefromthecrypt","id":64215,"node_id":"MDQ6VXNlcjY0MjE1","avatar_url":"https://avatars.githubusercontent.com/u/64215?v=4","gravatar_id":"","url":"https://api.github.com/users/codefromthecrypt","html_url":"https://github.com/codefromthecrypt","followers_url":"https://api.github.com/users/codefromthecrypt/followers","following_url":"https://api.github.com/users/codefromthecrypt/following{/other_user}","gists_url":"https://api.github.com/users/codefromthecrypt/gists{/gist_id}","starred_url":"https://api.github.com/users/codefromthecrypt/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codefromthecrypt/subscriptions","organizations_url":"https://api.github.com/users/codefromthecrypt/orgs","repos_url":"https://api.github.com/users/codefromthecrypt/repos","events_url":"https://api.github.com/users/codefromthecrypt/events{/privacy}","received_events_url":"https://api.github.com/users/codefromthecrypt/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2018-03-27T07:26:57Z","updated_at":"2018-03-28T14:32:19Z","closed_at":"2018-03-28T14:32:19Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"What kind of issue is this?\r\n - [x] Feature Request. Start by telling us what problem you’re trying to solve. Often a solution\r\n       already exists! Don’t send pull requests to implement new features without first getting our\r\n       support. Sometimes we leave features out on purpose to keep the project small.\r\n\r\nI'm trying to help get tracing working for retrofit. For example, continuing an incoming trace during an retrofit outbound request (including but not limited to SLF4J propagation).\r\n\r\nI looked at similar tech https://github.com/akaita/RxJava2Debug and assembly hooks look quite good for this. I started testing and noticed everything works nicely, except when the result type is Observable. That's because observable types are returned as-is:\r\n\r\n```java\r\nfinal class RxJava2CallAdapter<R> implements CallAdapter<R, Object> {\r\n --snip--\r\n    if (isCompletable) {\r\n      return observable.ignoreElements(); // .ignoreElements indirectly calls RxJavaPlugins.onAssembly\r\n    }\r\n    return observable; // returned with no hooks\r\n  }\r\n```\r\n\r\nI understand that a custom adapter could do this, but wondering if we could make it default to use the hook on plain observable.\r\n\r\nex.\r\n```java\r\nfinal class RxJava2CallAdapter<R> implements CallAdapter<R, Object> {\r\n --snip--\r\n    if (isCompletable) {\r\n      return observable.ignoreElements();\r\n    }\r\n    return RxJavaPlugins.onAssembly(observable);\r\n  }\r\n```\r\n\r\nOpen to other ideas to make this drop-in","closed_by":{"login":"JakeWharton","id":66577,"node_id":"MDQ6VXNlcjY2NTc3","avatar_url":"https://avatars.githubusercontent.com/u/66577?v=4","gravatar_id":"","url":"https://api.github.com/users/JakeWharton","html_url":"https://github.com/JakeWharton","followers_url":"https://api.github.com/users/JakeWharton/followers","following_url":"https://api.github.com/users/JakeWharton/following{/other_user}","gists_url":"https://api.github.com/users/JakeWharton/gists{/gist_id}","starred_url":"https://api.github.com/users/JakeWharton/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JakeWharton/subscriptions","organizations_url":"https://api.github.com/users/JakeWharton/orgs","repos_url":"https://api.github.com/users/JakeWharton/repos","events_url":"https://api.github.com/users/JakeWharton/events{/privacy}","received_events_url":"https://api.github.com/users/JakeWharton/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/square/retrofit/issues/2716/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/square/retrofit/issues/2716/timeline","performed_via_github_app":null,"state_reason":"completed"}