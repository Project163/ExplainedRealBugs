[{"id":456419646,"node_id":"MDEyOkxhYmVsZWRFdmVudDQ1NjQxOTY0Ng==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/456419646","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2015-11-06T00:35:56Z","label":{"name":"Needs investigation","color":"fad8c7"},"performed_via_github_app":null},{"id":456419648,"node_id":"MDEyOkxhYmVsZWRFdmVudDQ1NjQxOTY0OA==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/456419648","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2015-11-06T00:35:56Z","label":{"name":"High priority","color":"f7c6c7"},"performed_via_github_app":null},{"id":456419649,"node_id":"MDEyOkxhYmVsZWRFdmVudDQ1NjQxOTY0OQ==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/456419649","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2015-11-06T00:35:56Z","label":{"name":"Support","color":"4070a0"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154258395","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154258395","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154258395,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDI1ODM5NQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T01:37:29Z","updated_at":"2015-11-06T02:21:26Z","body":"[Travis' docs](http://docs.travis-ci.com/user/build-timeouts/#Build-times-out-because-no-output-was-received) mention slapping `travis_wait` in front of a command to make the 10min timeout more like 20min. Unlikely to be a permanent solution but maybe worth testing to see if the issue is \"slow\" vs \"literally hung\".\n\n---\n\nOn a Debian VM, tests take a while to run (`inv test  267.63s user 687.69s system 95% cpu 16:37.56 total` !!!) (**EDIT:** except I'm a horrible idiot who left some debug related things enabled when I ran this early test, see later comments for more realistic figures) but still wrote info often, so I don't _think_ they went >=10min w/o any output. Not like I watched it for 16 minutes straight though.\n\nThis might be the time to port the kinda-awful test harness to my `spec` nose plugin, which recently grew per-test timing info that could really help here.\n\n---\n\nAlso noticed that there _is_ a difference between my setup and Travis - I don't habitually run `--coverage` and coverage could definitely be affecting things. Maybe worth disabling for now to see if it makes a clear difference.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154258395/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154259585","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154259585","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154259585,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDI1OTU4NQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T01:45:21Z","updated_at":"2015-11-06T01:45:21Z","body":"Another option is for me to test against an Ubuntu 12.04 (Precise) since http://docs.travis-ci.com/user/ci-environment/ notes that's what they currently use for both the standard and containerbased runs (we should be containered now since our `.travis.yml` says `sudo: false`). Just in case there's some random dumb difference between \"Linux in general\" (as exemplified by my Debian 8 VM) and Travis' env.\n\nThat's assuming their docs are up to date, of course, but the same doc notes their experimental Ubuntu 14.04 based setup, so it's probably relatively current.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154259585/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154264021","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154264021","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154264021,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDI2NDAyMQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T02:20:36Z","updated_at":"2015-11-06T02:25:11Z","body":"Ran a few more cycles of tests on both my workstation proper & the Debian VM, because single data points are bad science. Started with Python 2 as a baseline, will do Python 3 after.\n\nBecause computers are terrible and I'm slow, the Debian VM tests started out with non-master & packet dumps enabled plus 512 MB ram only; once I upped to 2 GB and stock master things got a lot better & in fact faster than OS X.\n\nOS X (Yosemite) w/ all the awesome power of my dual-core 11\" MBA 1.7GHz and 8 GB RAM at its disposal:\n- `inv test  25.08s user 5.17s system 61% cpu 49.371 total`\n- `inv test  25.86s user 5.10s system 63% cpu 49.085 total`\n- `inv test  26.51s user 5.11s system 61% cpu 51.038 total`\n\nDebian 8, virtualized, with access to 2 GB RAM (seems unhappy allocating more than that, which is bizarre but I've no time to dig) & \"2 cores\" (hyperthreading, so VMware thinks I've 4 total):\n- `inv test  12.03s user 8.72s system 51% cpu 40.135 total`\n- `inv test  10.97s user 7.58s system 50% cpu 36.499 total`\n- `inv test  10.46s user 8.72s system 51% cpu 36.922 total`\n\nSo, preliminarily, the issue definitely isn't \"Linux is slow\", it's actually faster with less RAM than my native system. However, since I had it take VERY long with much less RAM (512 MB) it's possible that something is RAM hungry and if Travis is having RAM resource issues (their page only says \"up to 4 GB\" for the instance type we should be using) that might be a factor.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154264021/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154276791","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154276791","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154276791,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDI3Njc5MQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T03:44:37Z","updated_at":"2015-11-06T03:45:05Z","body":"Yea, looks like the issue was the packet dumps (note to self: leverage snapshots even for once-in-a-blue-moon OSS test VMs...), not the RAM. 512 MB and still getting these figures:\n- `inv test  10.15s user 9.58s system 51% cpu 38.134 total`\n- `inv test  12.40s user 8.14s system 50% cpu 40.469 total`\n- `inv test  10.73s user 8.69s system 49% cpu 39.111 total`\n\nStarting here and working back up...Python **3** at 512 MB:\n- `inv test  5.87s user 9.35s system 63% cpu 23.904 total`\n- `inv test  6.31s user 9.30s system 64% cpu 24.122 total`\n- `inv test  6.49s user 9.17s system 63% cpu 24.699 total`\n\nOK...clearly the issue is not \"Linux\" or even, probably, \"Linux + Python 3\" - Python 3's nearly 2x as fast as Python 2!\n\nI am now running the Python 3 version of the test in a loop for 100 iterations just for sanity's sake but doubt I'll see anything.\n\nSo next is to try with `--coverage`, then variations of this on Ubuntu 12.04.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154276791/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154288251","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154288251","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154288251,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDI4ODI1MQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T05:18:10Z","updated_at":"2015-11-06T07:19:19Z","body":"Ah, got ahead of myself. On the 12th iteration of the loop, the test run got stuck for hours. Will need to try this with Python 2 probably, but...yea.\n\nEDIT: did it again (w/ Python 3) for science reasons, got stuck on 9th iteration this time.\n\nRan the same loop under Python 2, it got all the way to 100 iterations no problem. Good argument for it being Python 3 specific.\n\nEDIT 2: Python 3 again and stuck at iteration 19. To confirm, this is _without_ using `--coverage`. I wasn't tracking process output earlier but I am now; it got stuck at `test_3_multiple_files`, surprise! Time to take a closer look at that test.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154288251/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154475729","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154475729","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154475729,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDQ3NTcyOQ==","user":{"login":"edk0","id":1224325,"node_id":"MDQ6VXNlcjEyMjQzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/1224325?v=4","gravatar_id":"","url":"https://api.github.com/users/edk0","html_url":"https://github.com/edk0","followers_url":"https://api.github.com/users/edk0/followers","following_url":"https://api.github.com/users/edk0/following{/other_user}","gists_url":"https://api.github.com/users/edk0/gists{/gist_id}","starred_url":"https://api.github.com/users/edk0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edk0/subscriptions","organizations_url":"https://api.github.com/users/edk0/orgs","repos_url":"https://api.github.com/users/edk0/repos","events_url":"https://api.github.com/users/edk0/events{/privacy}","received_events_url":"https://api.github.com/users/edk0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T17:13:02Z","updated_at":"2015-11-06T17:13:02Z","body":"I believe this is due to the garbage collector choosing to fire while (a) a SSHClient is unreachable, and (b) a log message is being emitted.\n\nThe garbage collection runs \"on top\" of the thread writing the log message (retaining lock ownership), and promptly deletes the SSHClient, triggering its Transport's `close` via the ResourceManager (I've deleted some irrelevant frames):\n\n```\n  File \"/usr/local/lib/python3.5/threading.py\", line 1067, in join\n    self._wait_for_tstate_lock(timeout=max(timeout, 0))\n  File \"/home/edk/src/paramiko/paramiko/transport.py\", line 1536, in stop_thread\n    self.join(10)\n  File \"/home/edk/src/paramiko/paramiko/transport.py\", line 644, in close\n    self.stop_thread()\n  File \"/home/edk/src/paramiko/paramiko/resource.py\", line 60, in callback\n    resource.close()\n  Garbage-collecting\n  <built-in method flush of _io.BufferedWriter object at remote 0x7f2daeacb888>\n  File \"/usr/local/lib/python3.5/logging/__init__.py\", line 964, in flush\n    self.stream.flush()\n  File \"/usr/local/lib/python3.5/logging/__init__.py\", line 984, in emit\n    self.flush()\n  File \"/usr/local/lib/python3.5/logging/__init__.py\", line 855, in handle\n    self.emit(record)\n…\n```\n\nHowever the transport in question wants to emit a log message before it closes:\n\n```\n  <built-in method acquire of _thread.RLock object at remote 0x7f2db3a23660>\n  File \"/usr/local/lib/python3.5/logging/__init__.py\", line 804, in acquire\n    self.lock.acquire()\n  File \"/usr/local/lib/python3.5/logging/__init__.py\", line 853, in handle\n    self.acquire()\n  File \"/usr/local/lib/python3.5/logging/__init__.py\", line 1487, in callHandlers\n    hdlr.handle(record)\n  File \"/usr/local/lib/python3.5/logging/__init__.py\", line 1425, in handle\n    self.callHandlers(record)\n  File \"/usr/local/lib/python3.5/logging/__init__.py\", line 1415, in _log\n    self.handle(record)\n  File \"/usr/local/lib/python3.5/logging/__init__.py\", line 1345, in log\n    self._log(level, msg, args, **kwargs)\n  File \"/home/edk/src/paramiko/paramiko/transport.py\", line 1545, in _log\n    self.logger.log(level, msg, *args)\n  File \"/home/edk/src/paramiko/paramiko/transport.py\", line 1774, in run\n    self._log(DEBUG, 'EOF in transport thread')\n  File \"/usr/local/lib/python3.5/threading.py\", line 923, in _bootstrap_inner\n    self.run()\n  File \"/usr/local/lib/python3.5/threading.py\", line 891, in _bootstrap\n    self._bootstrap_inner()\n```\n\nThis is a deadlock. The latter thread is waiting for an I/O lock in `logging`, which is owned by the former thread, which in turn is waiting for the other thread to finish.\n\nI'm inclined to think that the only way to really avoid bugs like this is to require SSHClients to be explicitly closed; shutting one down potentially has a lot of effects, and hunting down every possible lock they might acquire seems impossibly difficult.\n\nI think [at least one other](https://travis-ci.org/paramiko/paramiko/jobs/89548103), apparently rarer, hang might be related—still investigating.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154475729/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"edk0","id":1224325,"node_id":"MDQ6VXNlcjEyMjQzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/1224325?v=4","gravatar_id":"","url":"https://api.github.com/users/edk0","html_url":"https://github.com/edk0","followers_url":"https://api.github.com/users/edk0/followers","following_url":"https://api.github.com/users/edk0/following{/other_user}","gists_url":"https://api.github.com/users/edk0/gists{/gist_id}","starred_url":"https://api.github.com/users/edk0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edk0/subscriptions","organizations_url":"https://api.github.com/users/edk0/orgs","repos_url":"https://api.github.com/users/edk0/repos","events_url":"https://api.github.com/users/edk0/events{/privacy}","received_events_url":"https://api.github.com/users/edk0/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154483934","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154483934","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154483934,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDQ4MzkzNA==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T17:50:27Z","updated_at":"2015-11-06T17:50:36Z","body":"Yup a deadlock would explain the other issue too since it's simply a differently-located hang.\n\nWonder why this is only happening in 3, but I'm guessing 3 changed nontrvial amounts of things from 2, including threads and gc.\n\nThanks a bunch for poking at this while I slept. Open source distributed teams in action!\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154483934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154486329","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154486329","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154486329,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDQ4NjMyOQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T17:59:09Z","updated_at":"2015-11-06T17:59:09Z","body":"Also, re: solution, I feel like we'd still run into problems if an SSHClient got gc'd (which can happen, there was a ticket just the other day in fact) and _didn't_ auto-close? But GC and object references aren't my strong suit so this is mostly paranoia/confusion speaking.\n\nMaybe something dumb like having the code that currently autocloses, instead log (or print to stderr, which presumably would never be prone to locks, heh) an error message to the tune of \"Hey, you allowed your SSHClient to be garbage collected, that's a bad idea and the results won't be pretty, please explicitly close\".\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154486329/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154504094","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154504094","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154504094,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDUwNDA5NA==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T19:11:14Z","updated_at":"2015-11-06T19:11:39Z","body":"Looking at `test_3_multiple_keys` now to see if I can follow your work...the main diff between it and its sibling tests seems to be that it calls `self._test_connection` multiple times in a loop, whereas the rest all only call it once.\n\nPresumably the problem because `self.tc` (within `_test_connection`) gets reassigned to a new `SSHClient` each iteration of that loop, leaving up to 3 distinct orphaned clients lying around just waiting to get GC'd and trigger the bug?\n\nNotably, the overall test suite's `self.tearDown` explicitly calls `self.tc.close()`, which is why this never pops up on the \"only calls `_test_connection` once\" tests.\n\ntl;dr this is a crummy test that should instead have been using something like nose or pytest's \"emit multiple tests from a single function\" features, instead of a raw loop. (So, more fuel for my desire to rework the test suite into something using nose/spec...)\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154504094/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154510850","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154510850","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154510850,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDUxMDg1MA==","user":{"login":"edk0","id":1224325,"node_id":"MDQ6VXNlcjEyMjQzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/1224325?v=4","gravatar_id":"","url":"https://api.github.com/users/edk0","html_url":"https://github.com/edk0","followers_url":"https://api.github.com/users/edk0/followers","following_url":"https://api.github.com/users/edk0/following{/other_user}","gists_url":"https://api.github.com/users/edk0/gists{/gist_id}","starred_url":"https://api.github.com/users/edk0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edk0/subscriptions","organizations_url":"https://api.github.com/users/edk0/orgs","repos_url":"https://api.github.com/users/edk0/repos","events_url":"https://api.github.com/users/edk0/events{/privacy}","received_events_url":"https://api.github.com/users/edk0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T19:34:08Z","updated_at":"2015-11-06T19:34:08Z","body":"> Presumably the problem because self.tc (within _test_connection) gets reassigned to a new SSHClient each iteration of that loop, leaving up to 3 distinct orphaned clients lying around just waiting to get GC'd and trigger the bug?\n\nYes, I think so.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154510850/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"edk0","id":1224325,"node_id":"MDQ6VXNlcjEyMjQzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/1224325?v=4","gravatar_id":"","url":"https://api.github.com/users/edk0","html_url":"https://github.com/edk0","followers_url":"https://api.github.com/users/edk0/followers","following_url":"https://api.github.com/users/edk0/following{/other_user}","gists_url":"https://api.github.com/users/edk0/gists{/gist_id}","starred_url":"https://api.github.com/users/edk0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edk0/subscriptions","organizations_url":"https://api.github.com/users/edk0/orgs","repos_url":"https://api.github.com/users/edk0/repos","events_url":"https://api.github.com/users/edk0/events{/privacy}","received_events_url":"https://api.github.com/users/edk0/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154518859","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154518859","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154518859,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDUxODg1OQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T20:07:50Z","updated_at":"2015-11-06T20:07:50Z","body":"> [11:41:21]  <bitprophet> Would be nice to solve the underlying problem but I'm not even sure there is a foolproof method, and either way, if I can at least cut down on test failures that lets me proceed to more critical things :x\n> [11:46:40]  <edk>    the closest i can think of to a foolproof method is to remove the autoclose and instead have Transports emit a warning if they are finalized before being closed\n> [11:51:38]  <bitprophet> I think that's roughly what I was proposing in one of my ticket comments, yea\n> [11:51:44]  <edk>    yeah\n> [11:52:30]  <bitprophet> I'm on the fence, it's tempting and would probably present a lot of the \"buh why my shit hang\" tickets, otoh in single-threaded or well-managed-threading situations, auto-close is pretty darn useful and a lot of ppl would have to update their code to add explicit closing\n> [11:52:35]  <bitprophet> s/present/prevent/\n> [11:53:32]  <bitprophet> Even in 2.0 where such a change would be technically acceptable, I'd still feel like it was introducing a lot of burden on intermediate+ users for the sake of removing _some_ confusion for newer ones\n> [11:54:00]  <bitprophet> I wonder if instead we could make the \"trying to log\" part of the deadlock smarter?\n> [11:55:06]  <bitprophet> a timeout that then causes a non-logging print/exception, or (depending on what it's logging, exactly) removing the log line, or maaaybe trying to log without caring about the lock (tho that's pretty meh, I'd rather just pollute stderr instead)\n> [11:55:30]  <bitprophet> I should capture most of this into the ticket :3\n> [11:58:13]  <edk>    i think it's probably slightly easier to deal with manually closing things than having to keep track of which things have living references to them; people (including me) kind of expect gc to happen behind their backs\n> [11:58:51]  <edk>    hmm, i'm not sure if that's what i mean. like they expect it to just sort of silently work\n> [11:59:20]  <bitprophet> well right, which is probably why the \"close self on gc\" code was added however-long ago\n> [11:59:25]  <edk>    yeah\n> [11:59:45]  <edk>    the problem is that IO things and gc never seem to just work when mixed :(\n> [11:59:52]  <bitprophet> I also presume that having _multiple_ concurrently active SSHClient instances is an unusual case\n> [12:00:01]  <bitprophet> Most code I have seen in the wild has one per process\n> [12:00:19]  <bitprophet> (And where that isn't true, they're still typically well-managed in terms of scope and references)\n> [12:01:14]  <bitprophet> Would be nice to scan all our tickets to see how many issues could reasonably be chalked up to this\n> [12:01:25]  <edk>    i wrote something with potentially multiple SSHClients; solved the reference problem by doing something like transport._client_ = client\n> [12:01:38]  <bitprophet> not sure I have the time though, as above, I'd rather at least remove this particular instance in the suite and move on, while making sure this is all recorded\n> [12:01:53]  <edk>    that seems fair enough\n> [12:01:54]  <bitprophet> Yea. I think that other recent ticket had the same thing mentioned (maybe that was you replying though heh)\n> [12:02:17]  <bitprophet> BTW, thanks again for poking at this, I probably wouldn't have gotten to the bottom of it as fast myself :)\n> [12:02:32]  <edk>    worth noting, though, this could happen to any program that emits log messages and has an SSHClient die at some point\n> [12:04:02]  <edk>    and no problem, it was interesting\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154518859/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154525759","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154525759","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154525759,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDUyNTc1OQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T20:39:31Z","updated_at":"2015-11-06T20:39:31Z","body":"While confirming I could still reproduce the issue, got this different output, though I didn't check the output file prior to Ctrl-C so unclear when exactly it logged (but, probably at kill time):\n\n```\nRan 153 tests in 20.705s\n\nOK\nError in atexit._run_exitfuncs:\nTraceback (most recent call last):\n  File \"/home/jforcier/tmp/paramiko/paramiko/transport.py\", line 79, in _join_lingering_threads\n    thr.stop_thread()\n  File \"/home/jforcier/tmp/paramiko/paramiko/transport.py\", line 1536, in stop_thread\n    self.join(10)\n  File \"/usr/lib/python3.4/threading.py\", line 1064, in join\n    self._wait_for_tstate_lock(timeout=max(timeout, 0))\n  File \"/usr/lib/python3.4/threading.py\", line 1076, in _wait_for_tstate_lock\n    elif lock.acquire(block, timeout):\nKeyboardInterrupt\n```\n\nPossible this is related to the occasional Travis instances of tests completing (fail or pass) but then things hanging anyway.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154525759/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154571779","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154571779","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154571779,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDU3MTc3OQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T23:09:45Z","updated_at":"2015-11-06T23:09:45Z","body":"![](http://i.somethingawful.com/forumsystem/emoticons/emot-toot.gif) got to 100 iterations on Python 3 with some light application of explicit `setup`/`teardown`. (Simpler than tearing the test apart, lets me defer spec port until later.)\n\nGonna commit that and see if the other problem cases also keep popping up, I think this was the majority case though.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154571779/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":457521620,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ1NzUyMTYyMA==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/457521620","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a90f247a27eadae138eff5ee78c91c99dbc3596f","commit_url":"https://api.github.com/repos/paramiko/paramiko/commits/a90f247a27eadae138eff5ee78c91c99dbc3596f","created_at":"2015-11-06T23:10:52Z","performed_via_github_app":null},{"id":457522442,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ1NzUyMjQ0Mg==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/457522442","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ba0b12fb09f7334e930fc2b5a02d7e7824695627","commit_url":"https://api.github.com/repos/paramiko/paramiko/commits/ba0b12fb09f7334e930fc2b5a02d7e7824695627","created_at":"2015-11-06T23:11:59Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154575381","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154575381","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154575381,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDU3NTM4MQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T23:25:58Z","updated_at":"2015-11-06T23:25:58Z","body":"Backported to 1.15 branch too, that's as far as the crap test goes (it was my own dumb fault, apparently. No blaming 10 year old code this time!)\n\nNaturally, one of the next Travis builds is still hitting the timeout test fail bug under 3.5: https://travis-ci.org/paramiko/paramiko/jobs/89750927#L347\n\nIn fact, they're all hitting it now, wtf. And one of them is seeing it under Python 2.7. Sweet. https://travis-ci.org/paramiko/paramiko/builds/89750929\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154575381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154575976","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154575976","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154575976,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDU3NTk3Ng==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T23:28:42Z","updated_at":"2015-11-06T23:28:42Z","body":"What's interesting is my most recent \"test everything 100 times\" run didn't turn that failure up at all, meaning it may actually be more Travis-specific. Trying another run now just in case.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154575976/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154577081","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154577081","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154577081,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDU3NzA4MQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T23:34:21Z","updated_at":"2015-11-06T23:35:01Z","body":"Poked code while the tests ran, this one is \"set an obscenely short timeout, then expect an EOFError, but there's no EOFError after all\". Was added recentlyish, in d1f72859. Given that the timeout is set to something smaller than a billionth of a second, I'm assuming one of:\n- Math doesn't actually work that way & the effective timeout is much larger - still small, but large enough that an occasional very-fast execution is falling within it somehow (seems super unlikely, but...);\n- Some other error is occurring instead but not being raised correctly;\n- Something else funky but not error-bearing is going on with the `threading.Timer` implementation of the handshake timeout feature (which is mostly implemented in `Packetizer` and partly in `Transport`).\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154577081/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154578309","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154578309","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154578309,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDU3ODMwOQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-06T23:40:51Z","updated_at":"2015-11-06T23:41:28Z","body":"Assuming this current run yields no instances, gonna try on an Ubuntu 12.04 VM since that's an easy next step.\n\nThen `--coverage`.\n\nThen will instrument the test in question and then just rerun the build for 3.5 (since that's where it happens most of the time) on Travis. remote debugging!\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154578309/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154592590","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154592590","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154592590,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDU5MjU5MA==","user":{"login":"edk0","id":1224325,"node_id":"MDQ6VXNlcjEyMjQzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/1224325?v=4","gravatar_id":"","url":"https://api.github.com/users/edk0","html_url":"https://github.com/edk0","followers_url":"https://api.github.com/users/edk0/followers","following_url":"https://api.github.com/users/edk0/following{/other_user}","gists_url":"https://api.github.com/users/edk0/gists{/gist_id}","starred_url":"https://api.github.com/users/edk0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edk0/subscriptions","organizations_url":"https://api.github.com/users/edk0/orgs","repos_url":"https://api.github.com/users/edk0/repos","events_url":"https://api.github.com/users/edk0/events{/privacy}","received_events_url":"https://api.github.com/users/edk0/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-07T01:03:46Z","updated_at":"2015-11-07T01:03:46Z","body":"I can get the error fairly readily (ubuntu 15.04, python 3.5.0 debug). Replacing the assertRaises with a try/catch and `pdb.set_trace()` if nothing is caught—there is no exception thrown, and the transport connects properly.\n\nGenerally speaking thread switching intervals are _much_ larger than 0.000000000001 seconds; I think this test is really just checking which threads your OS decides to run before the packetizer checks if it's timed out.\n","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154592590/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"edk0","id":1224325,"node_id":"MDQ6VXNlcjEyMjQzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/1224325?v=4","gravatar_id":"","url":"https://api.github.com/users/edk0","html_url":"https://github.com/edk0","followers_url":"https://api.github.com/users/edk0/followers","following_url":"https://api.github.com/users/edk0/following{/other_user}","gists_url":"https://api.github.com/users/edk0/gists{/gist_id}","starred_url":"https://api.github.com/users/edk0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edk0/subscriptions","organizations_url":"https://api.github.com/users/edk0/orgs","repos_url":"https://api.github.com/users/edk0/repos","events_url":"https://api.github.com/users/edk0/events{/privacy}","received_events_url":"https://api.github.com/users/edk0/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154595712","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154595712","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154595712,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDU5NTcxMg==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-07T01:33:02Z","updated_at":"2015-11-07T01:39:29Z","body":"After some fun sysadmin tasks, got my 12.04 environment working and I got the fail 3 times in a row, so...yea. (On Python 3.5 as installed via a PPA.)\n\nThe Python 3 on my Debian VM is 3.4 so wondering if simply \"Python 3.5 on Linux\" is the hot trigger (esp given @edk0 is also reproducing it...unless the commonality is \"lol Ubuntu\" which is always possible).\n\nEither way, as @edk0 notes, it's likely one of those threading race conditions that _can_ pop up anywhere and are just _more likely_ to appear in certain environments.\n\n---\n\nRe: cause/effect/solution, I'm crap at threading and also not in the sharpest mental state right now. It sounds like the deal is: the test assumes the thread performing the timer/timeout-check is going to actually get woken up & executed (& then fail the vanishingly small timeout) prior to the test's thread performing the `assertRaises`. But in some environments, the test thread just keeps choochin' & the timer thread is never given the opportunity to raise its `EOFError` in time.\n\nWondering if we can explicitly tell the test thread to defer its scheduling, thus ensuring whichever thread is performing `Packetizer.handshake_timed_out()` (the thing that actually raises `EOFError` - and arguably the right way to test this may be to mock it instead of setting the really small timeout) actually gets a chance to raise its exception?\n\nEDIT: Though my memory may be betraying me, cuz I don't see any methods on `Thread` in the Python 3 docs that map to this sort of thing. Maybe something gross involving a thread-specific (perhaps again injected via mocking) Lock or Event (that the test thread can wait on & the waiting-for-timeout thread can release/set)? I don't think I like that idea though.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154595712/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":457612295,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU3NjEyMjk1","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/457612295","actor":{"login":"edk0","id":1224325,"node_id":"MDQ6VXNlcjEyMjQzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/1224325?v=4","gravatar_id":"","url":"https://api.github.com/users/edk0","html_url":"https://github.com/edk0","followers_url":"https://api.github.com/users/edk0/followers","following_url":"https://api.github.com/users/edk0/following{/other_user}","gists_url":"https://api.github.com/users/edk0/gists{/gist_id}","starred_url":"https://api.github.com/users/edk0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edk0/subscriptions","organizations_url":"https://api.github.com/users/edk0/orgs","repos_url":"https://api.github.com/users/edk0/repos","events_url":"https://api.github.com/users/edk0/events{/privacy}","received_events_url":"https://api.github.com/users/edk0/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2015-11-07T01:33:02Z","performed_via_github_app":null},{"id":457612296,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1NzYxMjI5Ng==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/457612296","actor":{"login":"edk0","id":1224325,"node_id":"MDQ6VXNlcjEyMjQzMjU=","avatar_url":"https://avatars.githubusercontent.com/u/1224325?v=4","gravatar_id":"","url":"https://api.github.com/users/edk0","html_url":"https://github.com/edk0","followers_url":"https://api.github.com/users/edk0/followers","following_url":"https://api.github.com/users/edk0/following{/other_user}","gists_url":"https://api.github.com/users/edk0/gists{/gist_id}","starred_url":"https://api.github.com/users/edk0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/edk0/subscriptions","organizations_url":"https://api.github.com/users/edk0/orgs","repos_url":"https://api.github.com/users/edk0/repos","events_url":"https://api.github.com/users/edk0/events{/privacy}","received_events_url":"https://api.github.com/users/edk0/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2015-11-07T01:33:02Z","performed_via_github_app":null},{"id":457612799,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU3NjEyNzk5","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/457612799","actor":{"login":"lndbrg","id":90185,"node_id":"MDQ6VXNlcjkwMTg1","avatar_url":"https://avatars.githubusercontent.com/u/90185?v=4","gravatar_id":"","url":"https://api.github.com/users/lndbrg","html_url":"https://github.com/lndbrg","followers_url":"https://api.github.com/users/lndbrg/followers","following_url":"https://api.github.com/users/lndbrg/following{/other_user}","gists_url":"https://api.github.com/users/lndbrg/gists{/gist_id}","starred_url":"https://api.github.com/users/lndbrg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lndbrg/subscriptions","organizations_url":"https://api.github.com/users/lndbrg/orgs","repos_url":"https://api.github.com/users/lndbrg/repos","events_url":"https://api.github.com/users/lndbrg/events{/privacy}","received_events_url":"https://api.github.com/users/lndbrg/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2015-11-07T01:34:27Z","performed_via_github_app":null},{"id":457612800,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1NzYxMjgwMA==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/457612800","actor":{"login":"lndbrg","id":90185,"node_id":"MDQ6VXNlcjkwMTg1","avatar_url":"https://avatars.githubusercontent.com/u/90185?v=4","gravatar_id":"","url":"https://api.github.com/users/lndbrg","html_url":"https://github.com/lndbrg","followers_url":"https://api.github.com/users/lndbrg/followers","following_url":"https://api.github.com/users/lndbrg/following{/other_user}","gists_url":"https://api.github.com/users/lndbrg/gists{/gist_id}","starred_url":"https://api.github.com/users/lndbrg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lndbrg/subscriptions","organizations_url":"https://api.github.com/users/lndbrg/orgs","repos_url":"https://api.github.com/users/lndbrg/repos","events_url":"https://api.github.com/users/lndbrg/events{/privacy}","received_events_url":"https://api.github.com/users/lndbrg/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2015-11-07T01:34:27Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154595889","html_url":"https://github.com/paramiko/paramiko/issues/612#issuecomment-154595889","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/612","id":154595889,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDU5NTg4OQ==","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2015-11-07T01:35:12Z","updated_at":"2015-11-07T01:35:12Z","body":"Also /cc @lndbrg who wrote the current version of this test, in case he has bright ideas and/or opinions. (No pressure tho :))\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/154595889/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":457613109,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU3NjEzMTA5","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/457613109","actor":{"login":"lndbrg","id":90185,"node_id":"MDQ6VXNlcjkwMTg1","avatar_url":"https://avatars.githubusercontent.com/u/90185?v=4","gravatar_id":"","url":"https://api.github.com/users/lndbrg","html_url":"https://github.com/lndbrg","followers_url":"https://api.github.com/users/lndbrg/followers","following_url":"https://api.github.com/users/lndbrg/following{/other_user}","gists_url":"https://api.github.com/users/lndbrg/gists{/gist_id}","starred_url":"https://api.github.com/users/lndbrg/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lndbrg/subscriptions","organizations_url":"https://api.github.com/users/lndbrg/orgs","repos_url":"https://api.github.com/users/lndbrg/repos","events_url":"https://api.github.com/users/lndbrg/events{/privacy}","received_events_url":"https://api.github.com/users/lndbrg/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2015-11-07T01:35:12Z","performed_via_github_app":null}]