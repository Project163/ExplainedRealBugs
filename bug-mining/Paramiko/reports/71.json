{"url":"https://api.github.com/repos/paramiko/paramiko/issues/1306","repository_url":"https://api.github.com/repos/paramiko/paramiko","labels_url":"https://api.github.com/repos/paramiko/paramiko/issues/1306/labels{/name}","comments_url":"https://api.github.com/repos/paramiko/paramiko/issues/1306/comments","events_url":"https://api.github.com/repos/paramiko/paramiko/issues/1306/events","html_url":"https://github.com/paramiko/paramiko/issues/1306","id":365247338,"node_id":"MDU6SXNzdWUzNjUyNDczMzg=","number":1306,"title":"Loading an Ed25519Key with a comment of certain lengths results in \"Invalid key\".","user":{"login":"parke","id":1454858,"node_id":"MDQ6VXNlcjE0NTQ4NTg=","avatar_url":"https://avatars.githubusercontent.com/u/1454858?v=4","gravatar_id":"","url":"https://api.github.com/users/parke","html_url":"https://github.com/parke","followers_url":"https://api.github.com/users/parke/followers","following_url":"https://api.github.com/users/parke/following{/other_user}","gists_url":"https://api.github.com/users/parke/gists{/gist_id}","starred_url":"https://api.github.com/users/parke/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/parke/subscriptions","organizations_url":"https://api.github.com/users/parke/orgs","repos_url":"https://api.github.com/users/parke/repos","events_url":"https://api.github.com/users/parke/events{/privacy}","received_events_url":"https://api.github.com/users/parke/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":60522311,"node_id":"MDU6TGFiZWw2MDUyMjMxMQ==","url":"https://api.github.com/repos/paramiko/paramiko/labels/Needs%20investigation","name":"Needs investigation","color":"fad8c7","default":false,"description":null},{"id":120549456,"node_id":"MDU6TGFiZWwxMjA1NDk0NTY=","url":"https://api.github.com/repos/paramiko/paramiko/labels/Keys","name":"Keys","color":"bfdadc","default":false,"description":null},{"id":120561399,"node_id":"MDU6TGFiZWwxMjA1NjEzOTk=","url":"https://api.github.com/repos/paramiko/paramiko/labels/Bug","name":"Bug","color":"a04040","default":false,"description":null},{"id":121094372,"node_id":"MDU6TGFiZWwxMjEwOTQzNzI=","url":"https://api.github.com/repos/paramiko/paramiko/labels/Needs%20patch","name":"Needs patch","color":"fad8c7","default":false,"description":null},{"id":121893209,"node_id":"MDU6TGFiZWwxMjE4OTMyMDk=","url":"https://api.github.com/repos/paramiko/paramiko/labels/Needs%20changelog/docs","name":"Needs changelog/docs","color":"bfdadc","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/paramiko/paramiko/milestones/18","html_url":"https://github.com/paramiko/paramiko/milestone/18","labels_url":"https://api.github.com/repos/paramiko/paramiko/milestones/18/labels","id":2578299,"node_id":"MDk6TWlsZXN0b25lMjU3ODI5OQ==","number":18,"title":"Next bugfix","description":null,"creator":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":6,"closed_issues":15,"state":"open","created_at":"2017-06-12T16:36:14Z","updated_at":"2025-08-13T11:51:52Z","due_on":null,"closed_at":null},"comments":10,"created_at":"2018-09-30T18:14:05Z","updated_at":"2019-06-21T19:53:11Z","closed_at":"2019-06-21T19:53:11Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Ed25519Keys with comments of certain lengths cannot be loaded as of paramiko 2.4.2.  Attempts to load these keys result in an \"Invalid key\" exception.\r\n\r\nIf the Ed25519Key is **encrypted** with a passphrase, and if the length of the comment **mod 16 equals 13**, loading the key causes an \"Invalid key\" exception.\r\n\r\nIf the Ed25519Key is **not encrypted** with a passphrase, and if the length of the comment **mod 8 equals 5**, loading the key causes an \"Invalid key\" exception.\r\n\r\nReproduce code:\r\n\r\n    #  generate comments of lengths 0 through 63                                \r\n\r\n    comments  =  []\r\n    for  n  in  range ( 0, 64 ):  comments .append ( '_' * n )\r\n\r\n    def  path  ( n ):  return  '/tmp/key_ed25519_%s' % n\r\n\r\n    #  generate the first key with a comment of length 0                        \r\n\r\n    passphrase  =  ''    #  an empty passphrase is much faster                  \r\n\r\n    os .system ( 'rm -f %s' % path(0) )\r\n    os .system ( 'ssh-keygen -t ed25519 -N \"%s\" -C \"%s\" -f %s > /dev/null' %\r\n                 ( passphrase, comments[0], path(0) ) )\r\n\r\n    #  generate the other keys by copying the first key and                     \r\n    #  then changing the comment                                                \r\n\r\n    for  n  in  range ( 1, len ( comments ) ):\r\n      os .system ( 'cp  %s  %s' % ( path(0), path(n) ) )\r\n      os .system ( 'ssh-keygen -c -P \"%s\" -C \"%s\" -f %s > /dev/null' %\r\n                   ( passphrase, comments[n], path(n) ) )\r\n\r\n    #  see which keys can be loaded                                             \r\n\r\n    for  n  in  range ( 0, len ( comments ) ):\r\n      s  =  comments[n]\r\n      try:\r\n        pkey  =  paramiko .ed25519key .Ed25519Key .from_private_key_file (\r\n          filename=path(n), password=passphrase )\r\n        print ( '    %11s    %2d  %s' % ( '+', len(s), s ) )\r\n      except  paramiko .ssh_exception .SSHException  as  se:\r\n        print ( '    %11s    %2d  %s' % ( str ( se ), len(s), s ) )\r\n\r\nNote:  The above code will take significantly longer to run if a non-empty passphrase is specified.  Presumably the delay is due to the passphrase being repeatedly hashed in order to reduce the effectiveness of brute force passphrase attacks.\r\n\r\nOutput of the above (when run with an empty password):\r\n\r\n              +     0  \r\n              +     1  _\r\n              +     2  __\r\n              +     3  ___\r\n              +     4  ____\r\n    Invalid key     5  _____\r\n              +     6  ______\r\n              +     7  _______\r\n              +     8  ________\r\n              +     9  _________\r\n              +    10  __________\r\n              +    11  ___________\r\n              +    12  ____________\r\n    Invalid key    13  _____________\r\n              +    14  ______________\r\n              +    15  _______________\r\n              +    16  ________________\r\n              +    17  _________________\r\n              +    18  __________________\r\n              +    19  ___________________\r\n              +    20  ____________________\r\n    Invalid key    21  _____________________\r\n              +    22  ______________________\r\n              +    23  _______________________\r\n              +    24  ________________________\r\n              +    25  _________________________\r\n              +    26  __________________________\r\n              +    27  ___________________________\r\n              +    28  ____________________________\r\n    Invalid key    29  _____________________________\r\n              +    30  ______________________________\r\n              +    31  _______________________________\r\n              +    32  ________________________________\r\n              +    33  _________________________________\r\n              +    34  __________________________________\r\n              +    35  ___________________________________\r\n              +    36  ____________________________________\r\n    Invalid key    37  _____________________________________\r\n              +    38  ______________________________________\r\n              +    39  _______________________________________\r\n              +    40  ________________________________________\r\n              +    41  _________________________________________\r\n              +    42  __________________________________________\r\n              +    43  ___________________________________________\r\n              +    44  ____________________________________________\r\n    Invalid key    45  _____________________________________________\r\n              +    46  ______________________________________________\r\n              +    47  _______________________________________________\r\n              +    48  ________________________________________________\r\n              +    49  _________________________________________________\r\n              +    50  __________________________________________________\r\n              +    51  ___________________________________________________\r\n              +    52  ____________________________________________________\r\n    Invalid key    53  _____________________________________________________\r\n              +    54  ______________________________________________________\r\n              +    55  _______________________________________________________\r\n              +    56  ________________________________________________________\r\n              +    57  _________________________________________________________\r\n              +    58  __________________________________________________________\r\n              +    59  ___________________________________________________________\r\n              +    60  ____________________________________________________________\r\n    Invalid key    61  _____________________________________________________________\r\n              +    62  ______________________________________________________________\r\n","closed_by":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/1306/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/paramiko/paramiko/issues/1306/timeline","performed_via_github_app":null,"state_reason":"completed"}