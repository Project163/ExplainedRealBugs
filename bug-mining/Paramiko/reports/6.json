{"url":"https://api.github.com/repos/paramiko/paramiko/issues/98","repository_url":"https://api.github.com/repos/paramiko/paramiko","labels_url":"https://api.github.com/repos/paramiko/paramiko/issues/98/labels{/name}","comments_url":"https://api.github.com/repos/paramiko/paramiko/issues/98/comments","events_url":"https://api.github.com/repos/paramiko/paramiko/issues/98/events","html_url":"https://github.com/paramiko/paramiko/issues/98","id":7832446,"node_id":"MDU6SXNzdWU3ODMyNDQ2","number":98,"title":"win_pageant fails when running as Administrator and PAgeant is running as UAC-limited account","user":{"login":"jaraco","id":308610,"node_id":"MDQ6VXNlcjMwODYxMA==","avatar_url":"https://avatars.githubusercontent.com/u/308610?v=4","gravatar_id":"","url":"https://api.github.com/users/jaraco","html_url":"https://github.com/jaraco","followers_url":"https://api.github.com/users/jaraco/followers","following_url":"https://api.github.com/users/jaraco/following{/other_user}","gists_url":"https://api.github.com/users/jaraco/gists{/gist_id}","starred_url":"https://api.github.com/users/jaraco/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jaraco/subscriptions","organizations_url":"https://api.github.com/users/jaraco/orgs","repos_url":"https://api.github.com/users/jaraco/repos","events_url":"https://api.github.com/users/jaraco/events{/privacy}","received_events_url":"https://api.github.com/users/jaraco/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2012-10-24T16:11:15Z","updated_at":"2013-03-19T20:28:42Z","closed_at":"2013-03-19T20:28:42Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I've adopted Windows 8, which is much more aggressive about requiring UAC (i.e. some apps refuse to run unless UAC is enabled). As a result, I've started using UAC, and I'm running into issues with interprocess communication, such as win_pageant uses for communicating with PAgeant. This is one such issue.\n\nWhen one invokes win_pagent when running as Administrator (but with PAgeant running as the UAC limited user), it fails to communicate with the process:\n\n```\nPS C:\\Users\\jaraco> python -c \"import ssh.agent; ssh.agent.Agent()\"\nTraceback (most recent call last):\n  File \"<string>\", line 1, in <module>\n  File \"C:\\Users\\jaraco\\AppData\\Roaming\\Python\\Python27\\site-packages\\ssh-1.7.13-py2.7.egg\\ssh\\agent.py\", line 323, in __init__\n    self._connect(conn)\n  File \"C:\\Users\\jaraco\\AppData\\Roaming\\Python\\Python27\\site-packages\\ssh-1.7.13-py2.7.egg\\ssh\\agent.py\", line 70, in _connect\n    ptype, result = self._send_message(chr(SSH2_AGENTC_REQUEST_IDENTITIES))\n  File \"C:\\Users\\jaraco\\AppData\\Roaming\\Python\\Python27\\site-packages\\ssh-1.7.13-py2.7.egg\\ssh\\agent.py\", line 87, in _send_message\n    l = self._read_all(4)\n  File \"C:\\Users\\jaraco\\AppData\\Roaming\\Python\\Python27\\site-packages\\ssh-1.7.13-py2.7.egg\\ssh\\agent.py\", line 95, in _read_all\n    raise SSHException('lost ssh-agent')\nssh.SSHException: lost ssh-agent\n```\n\nRun the same command in the same environment, but as a limited user, and it does not fail. Reverse the roles (run ssh.agent.Agent in a limited context with PAgeant as an Administrator), and it fails similarly.\n\nI've confirmed that pscp (PuTTY's implementation of scp) is able to get keys from the PAgeant even in this situation (where pscp is running as Administrator but PAgeant is not). Therefore, it should be possible for the ssh library to do the same.\n\nI expect I own this ticket, so I will investigate. Any tips appreciated.\n","closed_by":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/98/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/paramiko/paramiko/issues/98/timeline","performed_via_github_app":null,"state_reason":"completed"}