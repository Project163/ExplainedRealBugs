[{"id":3767004,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3NjcwMDQ=","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/3767004","actor":{"login":"w31rd0","id":157719,"node_id":"MDQ6VXNlcjE1NzcxOQ==","avatar_url":"https://avatars.githubusercontent.com/u/157719?v=4","gravatar_id":"","url":"https://api.github.com/users/w31rd0","html_url":"https://github.com/w31rd0","followers_url":"https://api.github.com/users/w31rd0/followers","following_url":"https://api.github.com/users/w31rd0/following{/other_user}","gists_url":"https://api.github.com/users/w31rd0/gists{/gist_id}","starred_url":"https://api.github.com/users/w31rd0/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/w31rd0/subscriptions","organizations_url":"https://api.github.com/users/w31rd0/orgs","repos_url":"https://api.github.com/users/w31rd0/repos","events_url":"https://api.github.com/users/w31rd0/events{/privacy}","received_events_url":"https://api.github.com/users/w31rd0/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2011-09-30T15:01:30Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/15429404","html_url":"https://github.com/paramiko/paramiko/issues/44#issuecomment-15429404","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/44","id":15429404,"node_id":"MDEyOklzc3VlQ29tbWVudDE1NDI5NDA0","user":{"login":"glasserc","id":17006,"node_id":"MDQ6VXNlcjE3MDA2","avatar_url":"https://avatars.githubusercontent.com/u/17006?v=4","gravatar_id":"","url":"https://api.github.com/users/glasserc","html_url":"https://github.com/glasserc","followers_url":"https://api.github.com/users/glasserc/followers","following_url":"https://api.github.com/users/glasserc/following{/other_user}","gists_url":"https://api.github.com/users/glasserc/gists{/gist_id}","starred_url":"https://api.github.com/users/glasserc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glasserc/subscriptions","organizations_url":"https://api.github.com/users/glasserc/orgs","repos_url":"https://api.github.com/users/glasserc/repos","events_url":"https://api.github.com/users/glasserc/events{/privacy}","received_events_url":"https://api.github.com/users/glasserc/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2013-03-25T22:19:32Z","updated_at":"2013-03-25T22:19:32Z","body":"Thanks for this bug report -- my SFTP session was mysteriously getting closed and I couldn't figure out why!\n\nIs this the intended design for paramiko? This is caused by the SSHClient being registered with the ResourceManager to close its transport when it gets collected. This certainly surprised me, but if it's the intended behavior, maybe it should be documented somewhere.\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/15429404/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"glasserc","id":17006,"node_id":"MDQ6VXNlcjE3MDA2","avatar_url":"https://avatars.githubusercontent.com/u/17006?v=4","gravatar_id":"","url":"https://api.github.com/users/glasserc","html_url":"https://github.com/glasserc","followers_url":"https://api.github.com/users/glasserc/followers","following_url":"https://api.github.com/users/glasserc/following{/other_user}","gists_url":"https://api.github.com/users/glasserc/gists{/gist_id}","starred_url":"https://api.github.com/users/glasserc/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/glasserc/subscriptions","organizations_url":"https://api.github.com/users/glasserc/orgs","repos_url":"https://api.github.com/users/glasserc/repos","events_url":"https://api.github.com/users/glasserc/events{/privacy}","received_events_url":"https://api.github.com/users/glasserc/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/17129033","html_url":"https://github.com/paramiko/paramiko/issues/44#issuecomment-17129033","issue_url":"https://api.github.com/repos/paramiko/paramiko/issues/44","id":17129033,"node_id":"MDEyOklzc3VlQ29tbWVudDE3MTI5MDMz","user":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2013-04-28T05:37:36Z","updated_at":"2013-04-28T05:37:36Z","body":"This design well predates my involvement so I've got no ready answers. If somebody wants to dig into the Git history for clues or suggest either a doc or API addition to help make this less confusing/surprising, I'd consider a merge.\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/comments/17129033/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":955938970,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDk1NTkzODk3MA==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/955938970","actor":{"login":"omeranson","id":6899356,"node_id":"MDQ6VXNlcjY4OTkzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/6899356?v=4","gravatar_id":"","url":"https://api.github.com/users/omeranson","html_url":"https://github.com/omeranson","followers_url":"https://api.github.com/users/omeranson/followers","following_url":"https://api.github.com/users/omeranson/following{/other_user}","gists_url":"https://api.github.com/users/omeranson/gists{/gist_id}","starred_url":"https://api.github.com/users/omeranson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omeranson/subscriptions","organizations_url":"https://api.github.com/users/omeranson/orgs","repos_url":"https://api.github.com/users/omeranson/repos","events_url":"https://api.github.com/users/omeranson/events{/privacy}","received_events_url":"https://api.github.com/users/omeranson/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a3b9c6cee8cc0d045addf827e31849484cd502a2","commit_url":"https://api.github.com/repos/omeranson/paramiko/commits/a3b9c6cee8cc0d045addf827e31849484cd502a2","created_at":"2017-02-09T17:08:25Z","performed_via_github_app":null},{"actor":{"login":"omeranson","id":6899356,"node_id":"MDQ6VXNlcjY4OTkzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/6899356?v=4","gravatar_id":"","url":"https://api.github.com/users/omeranson","html_url":"https://github.com/omeranson","followers_url":"https://api.github.com/users/omeranson/followers","following_url":"https://api.github.com/users/omeranson/following{/other_user}","gists_url":"https://api.github.com/users/omeranson/gists{/gist_id}","starred_url":"https://api.github.com/users/omeranson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omeranson/subscriptions","organizations_url":"https://api.github.com/users/omeranson/orgs","repos_url":"https://api.github.com/users/omeranson/repos","events_url":"https://api.github.com/users/omeranson/events{/privacy}","received_events_url":"https://api.github.com/users/omeranson/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-02-09T17:08:49Z","updated_at":"2017-02-09T17:08:49Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/891","repository_url":"https://api.github.com/repos/paramiko/paramiko","labels_url":"https://api.github.com/repos/paramiko/paramiko/issues/891/labels{/name}","comments_url":"https://api.github.com/repos/paramiko/paramiko/issues/891/comments","events_url":"https://api.github.com/repos/paramiko/paramiko/issues/891/events","html_url":"https://github.com/paramiko/paramiko/pull/891","id":206567322,"node_id":"MDExOlB1bGxSZXF1ZXN0MTA1NDcxMTU0","number":891,"title":"Add back-reference from Transport to the SSHClient that created it","user":{"login":"omeranson","id":6899356,"node_id":"MDQ6VXNlcjY4OTkzNTY=","avatar_url":"https://avatars.githubusercontent.com/u/6899356?v=4","gravatar_id":"","url":"https://api.github.com/users/omeranson","html_url":"https://github.com/omeranson","followers_url":"https://api.github.com/users/omeranson/followers","following_url":"https://api.github.com/users/omeranson/following{/other_user}","gists_url":"https://api.github.com/users/omeranson/gists{/gist_id}","starred_url":"https://api.github.com/users/omeranson/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/omeranson/subscriptions","organizations_url":"https://api.github.com/users/omeranson/orgs","repos_url":"https://api.github.com/users/omeranson/repos","events_url":"https://api.github.com/users/omeranson/events{/privacy}","received_events_url":"https://api.github.com/users/omeranson/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2017-02-09T17:08:49Z","updated_at":"2017-02-21T05:10:25Z","closed_at":"2017-02-20T22:42:03Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":119609,"node_id":"MDEwOlJlcG9zaXRvcnkxMTk2MDk=","name":"paramiko","full_name":"paramiko/paramiko","private":false,"owner":{"login":"paramiko","id":1108455,"node_id":"MDEyOk9yZ2FuaXphdGlvbjExMDg0NTU=","avatar_url":"https://avatars.githubusercontent.com/u/1108455?v=4","gravatar_id":"","url":"https://api.github.com/users/paramiko","html_url":"https://github.com/paramiko","followers_url":"https://api.github.com/users/paramiko/followers","following_url":"https://api.github.com/users/paramiko/following{/other_user}","gists_url":"https://api.github.com/users/paramiko/gists{/gist_id}","starred_url":"https://api.github.com/users/paramiko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/paramiko/subscriptions","organizations_url":"https://api.github.com/users/paramiko/orgs","repos_url":"https://api.github.com/users/paramiko/repos","events_url":"https://api.github.com/users/paramiko/events{/privacy}","received_events_url":"https://api.github.com/users/paramiko/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/paramiko/paramiko","description":"The leading native Python SSHv2 protocol library.","fork":false,"url":"https://api.github.com/repos/paramiko/paramiko","forks_url":"https://api.github.com/repos/paramiko/paramiko/forks","keys_url":"https://api.github.com/repos/paramiko/paramiko/keys{/key_id}","collaborators_url":"https://api.github.com/repos/paramiko/paramiko/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/paramiko/paramiko/teams","hooks_url":"https://api.github.com/repos/paramiko/paramiko/hooks","issue_events_url":"https://api.github.com/repos/paramiko/paramiko/issues/events{/number}","events_url":"https://api.github.com/repos/paramiko/paramiko/events","assignees_url":"https://api.github.com/repos/paramiko/paramiko/assignees{/user}","branches_url":"https://api.github.com/repos/paramiko/paramiko/branches{/branch}","tags_url":"https://api.github.com/repos/paramiko/paramiko/tags","blobs_url":"https://api.github.com/repos/paramiko/paramiko/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/paramiko/paramiko/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/paramiko/paramiko/git/refs{/sha}","trees_url":"https://api.github.com/repos/paramiko/paramiko/git/trees{/sha}","statuses_url":"https://api.github.com/repos/paramiko/paramiko/statuses/{sha}","languages_url":"https://api.github.com/repos/paramiko/paramiko/languages","stargazers_url":"https://api.github.com/repos/paramiko/paramiko/stargazers","contributors_url":"https://api.github.com/repos/paramiko/paramiko/contributors","subscribers_url":"https://api.github.com/repos/paramiko/paramiko/subscribers","subscription_url":"https://api.github.com/repos/paramiko/paramiko/subscription","commits_url":"https://api.github.com/repos/paramiko/paramiko/commits{/sha}","git_commits_url":"https://api.github.com/repos/paramiko/paramiko/git/commits{/sha}","comments_url":"https://api.github.com/repos/paramiko/paramiko/comments{/number}","issue_comment_url":"https://api.github.com/repos/paramiko/paramiko/issues/comments{/number}","contents_url":"https://api.github.com/repos/paramiko/paramiko/contents/{+path}","compare_url":"https://api.github.com/repos/paramiko/paramiko/compare/{base}...{head}","merges_url":"https://api.github.com/repos/paramiko/paramiko/merges","archive_url":"https://api.github.com/repos/paramiko/paramiko/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/paramiko/paramiko/downloads","issues_url":"https://api.github.com/repos/paramiko/paramiko/issues{/number}","pulls_url":"https://api.github.com/repos/paramiko/paramiko/pulls{/number}","milestones_url":"https://api.github.com/repos/paramiko/paramiko/milestones{/number}","notifications_url":"https://api.github.com/repos/paramiko/paramiko/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/paramiko/paramiko/labels{/name}","releases_url":"https://api.github.com/repos/paramiko/paramiko/releases{/id}","deployments_url":"https://api.github.com/repos/paramiko/paramiko/deployments","created_at":"2009-02-02T03:41:08Z","updated_at":"2025-11-10T08:04:35Z","pushed_at":"2025-10-20T02:50:05Z","git_url":"git://github.com/paramiko/paramiko.git","ssh_url":"git@github.com:paramiko/paramiko.git","clone_url":"https://github.com/paramiko/paramiko.git","svn_url":"https://github.com/paramiko/paramiko","homepage":"http://paramiko.org","size":8237,"stargazers_count":9558,"watchers_count":9558,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2033,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1138,"license":{"key":"lgpl-2.1","name":"GNU Lesser General Public License v2.1","spdx_id":"LGPL-2.1","url":"https://api.github.com/licenses/lgpl-2.1","node_id":"MDc6TGljZW5zZTEx"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2033,"open_issues":1138,"watchers":9558,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/paramiko/paramiko/pulls/891","html_url":"https://github.com/paramiko/paramiko/pull/891","diff_url":"https://github.com/paramiko/paramiko/pull/891.diff","patch_url":"https://github.com/paramiko/paramiko/pull/891.patch","merged_at":null},"body":"In some cases, the SSH client is created, the command is executed, the\r\nstreams are extracted, and the explicit reference to SSHClient is then\r\ndiscarded (since it was e.g. created in a function that only returns the\r\nstreams). In this case, the SHSClient may be garbage collected, and the\r\nconnection's state is undefined.\r\n\r\nThis fix adds a reference from Transport to the SSHClient that created\r\nit. The streams have a reference to the Channel, which references the\r\nTransport. Now that the Transport references the SSHClient, it won't be\r\ngarbage collected until it is closed.\r\n\r\nCloses-Bug: #44\r\nRelated-Bug: #344","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/891/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/paramiko/paramiko/issues/891/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":969878434,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDk2OTg3ODQzNA==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/969878434","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"e58df62ef5e7339e5895f9f5ffdaa3452d45a69c","commit_url":"https://api.github.com/repos/paramiko/paramiko/commits/e58df62ef5e7339e5895f9f5ffdaa3452d45a69c","created_at":"2017-02-20T22:41:57Z","performed_via_github_app":null},{"id":969878436,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDk2OTg3ODQzNg==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/969878436","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"a39a1eeed691b9c4e191dbe4b8716fb7682971fa","commit_url":"https://api.github.com/repos/paramiko/paramiko/commits/a39a1eeed691b9c4e191dbe4b8716fb7682971fa","created_at":"2017-02-20T22:41:57Z","performed_via_github_app":null},{"id":969878439,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDk2OTg3ODQzOQ==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/969878439","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"718e821b4a6d68b0daf3e7061a1cc78ee8389896","commit_url":"https://api.github.com/repos/paramiko/paramiko/commits/718e821b4a6d68b0daf3e7061a1cc78ee8389896","created_at":"2017-02-20T22:41:57Z","performed_via_github_app":null},{"id":969878441,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDk2OTg3ODQ0MQ==","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/969878441","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"efe7856283242374b6456711ea95fabb7320b46e","commit_url":"https://api.github.com/repos/paramiko/paramiko/commits/efe7856283242374b6456711ea95fabb7320b46e","created_at":"2017-02-20T22:41:57Z","performed_via_github_app":null},{"id":969878516,"node_id":"MDExOkNsb3NlZEV2ZW50OTY5ODc4NTE2","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/969878516","actor":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":"efe7856283242374b6456711ea95fabb7320b46e","commit_url":"https://api.github.com/repos/paramiko/paramiko/commits/efe7856283242374b6456711ea95fabb7320b46e","created_at":"2017-02-20T22:42:03Z","state_reason":null,"performed_via_github_app":null},{"actor":{"login":"agronick","id":2042303,"node_id":"MDQ6VXNlcjIwNDIzMDM=","avatar_url":"https://avatars.githubusercontent.com/u/2042303?v=4","gravatar_id":"","url":"https://api.github.com/users/agronick","html_url":"https://github.com/agronick","followers_url":"https://api.github.com/users/agronick/followers","following_url":"https://api.github.com/users/agronick/following{/other_user}","gists_url":"https://api.github.com/users/agronick/gists{/gist_id}","starred_url":"https://api.github.com/users/agronick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agronick/subscriptions","organizations_url":"https://api.github.com/users/agronick/orgs","repos_url":"https://api.github.com/users/agronick/repos","events_url":"https://api.github.com/users/agronick/events{/privacy}","received_events_url":"https://api.github.com/users/agronick/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-05-05T01:18:24Z","updated_at":"2017-05-05T01:18:24Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/949","repository_url":"https://api.github.com/repos/paramiko/paramiko","labels_url":"https://api.github.com/repos/paramiko/paramiko/issues/949/labels{/name}","comments_url":"https://api.github.com/repos/paramiko/paramiko/issues/949/comments","events_url":"https://api.github.com/repos/paramiko/paramiko/issues/949/events","html_url":"https://github.com/paramiko/paramiko/issues/949","id":225102456,"node_id":"MDU6SXNzdWUyMjUxMDI0NTY=","number":949,"title":"Paramiko has huge memory leaks (Solution Found)","user":{"login":"agronick","id":2042303,"node_id":"MDQ6VXNlcjIwNDIzMDM=","avatar_url":"https://avatars.githubusercontent.com/u/2042303?v=4","gravatar_id":"","url":"https://api.github.com/users/agronick","html_url":"https://github.com/agronick","followers_url":"https://api.github.com/users/agronick/followers","following_url":"https://api.github.com/users/agronick/following{/other_user}","gists_url":"https://api.github.com/users/agronick/gists{/gist_id}","starred_url":"https://api.github.com/users/agronick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/agronick/subscriptions","organizations_url":"https://api.github.com/users/agronick/orgs","repos_url":"https://api.github.com/users/agronick/repos","events_url":"https://api.github.com/users/agronick/events{/privacy}","received_events_url":"https://api.github.com/users/agronick/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":60520372,"node_id":"MDU6TGFiZWw2MDUyMDM3Mg==","url":"https://api.github.com/repos/paramiko/paramiko/labels/Ready%20for%20review","name":"Ready for review","color":"bfe5bf","default":false,"description":null},{"id":60522311,"node_id":"MDU6TGFiZWw2MDUyMjMxMQ==","url":"https://api.github.com/repos/paramiko/paramiko/labels/Needs%20investigation","name":"Needs investigation","color":"fad8c7","default":false,"description":null},{"id":61259482,"node_id":"MDU6TGFiZWw2MTI1OTQ4Mg==","url":"https://api.github.com/repos/paramiko/paramiko/labels/High%20priority","name":"High priority","color":"f7c6c7","default":false,"description":null},{"id":120561399,"node_id":"MDU6TGFiZWwxMjA1NjEzOTk=","url":"https://api.github.com/repos/paramiko/paramiko/labels/Bug","name":"Bug","color":"a04040","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/paramiko/paramiko/milestones/16","html_url":"https://github.com/paramiko/paramiko/milestone/16","labels_url":"https://api.github.com/repos/paramiko/paramiko/milestones/16/labels","id":2187866,"node_id":"MDk6TWlsZXN0b25lMjE4Nzg2Ng==","number":16,"title":"Next 1.x+2.x bugfix release","description":"","creator":{"login":"bitprophet","id":6088,"node_id":"MDQ6VXNlcjYwODg=","avatar_url":"https://avatars.githubusercontent.com/u/6088?v=4","gravatar_id":"","url":"https://api.github.com/users/bitprophet","html_url":"https://github.com/bitprophet","followers_url":"https://api.github.com/users/bitprophet/followers","following_url":"https://api.github.com/users/bitprophet/following{/other_user}","gists_url":"https://api.github.com/users/bitprophet/gists{/gist_id}","starred_url":"https://api.github.com/users/bitprophet/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bitprophet/subscriptions","organizations_url":"https://api.github.com/users/bitprophet/orgs","repos_url":"https://api.github.com/users/bitprophet/repos","events_url":"https://api.github.com/users/bitprophet/events{/privacy}","received_events_url":"https://api.github.com/users/bitprophet/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":9,"closed_issues":9,"state":"closed","created_at":"2016-12-09T23:23:40Z","updated_at":"2021-10-09T01:00:50Z","due_on":null,"closed_at":"2017-06-09T21:37:41Z"},"comments":23,"created_at":"2017-04-28T14:44:40Z","updated_at":"2023-11-22T13:16:50Z","closed_at":null,"author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":119609,"node_id":"MDEwOlJlcG9zaXRvcnkxMTk2MDk=","name":"paramiko","full_name":"paramiko/paramiko","private":false,"owner":{"login":"paramiko","id":1108455,"node_id":"MDEyOk9yZ2FuaXphdGlvbjExMDg0NTU=","avatar_url":"https://avatars.githubusercontent.com/u/1108455?v=4","gravatar_id":"","url":"https://api.github.com/users/paramiko","html_url":"https://github.com/paramiko","followers_url":"https://api.github.com/users/paramiko/followers","following_url":"https://api.github.com/users/paramiko/following{/other_user}","gists_url":"https://api.github.com/users/paramiko/gists{/gist_id}","starred_url":"https://api.github.com/users/paramiko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/paramiko/subscriptions","organizations_url":"https://api.github.com/users/paramiko/orgs","repos_url":"https://api.github.com/users/paramiko/repos","events_url":"https://api.github.com/users/paramiko/events{/privacy}","received_events_url":"https://api.github.com/users/paramiko/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/paramiko/paramiko","description":"The leading native Python SSHv2 protocol library.","fork":false,"url":"https://api.github.com/repos/paramiko/paramiko","forks_url":"https://api.github.com/repos/paramiko/paramiko/forks","keys_url":"https://api.github.com/repos/paramiko/paramiko/keys{/key_id}","collaborators_url":"https://api.github.com/repos/paramiko/paramiko/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/paramiko/paramiko/teams","hooks_url":"https://api.github.com/repos/paramiko/paramiko/hooks","issue_events_url":"https://api.github.com/repos/paramiko/paramiko/issues/events{/number}","events_url":"https://api.github.com/repos/paramiko/paramiko/events","assignees_url":"https://api.github.com/repos/paramiko/paramiko/assignees{/user}","branches_url":"https://api.github.com/repos/paramiko/paramiko/branches{/branch}","tags_url":"https://api.github.com/repos/paramiko/paramiko/tags","blobs_url":"https://api.github.com/repos/paramiko/paramiko/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/paramiko/paramiko/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/paramiko/paramiko/git/refs{/sha}","trees_url":"https://api.github.com/repos/paramiko/paramiko/git/trees{/sha}","statuses_url":"https://api.github.com/repos/paramiko/paramiko/statuses/{sha}","languages_url":"https://api.github.com/repos/paramiko/paramiko/languages","stargazers_url":"https://api.github.com/repos/paramiko/paramiko/stargazers","contributors_url":"https://api.github.com/repos/paramiko/paramiko/contributors","subscribers_url":"https://api.github.com/repos/paramiko/paramiko/subscribers","subscription_url":"https://api.github.com/repos/paramiko/paramiko/subscription","commits_url":"https://api.github.com/repos/paramiko/paramiko/commits{/sha}","git_commits_url":"https://api.github.com/repos/paramiko/paramiko/git/commits{/sha}","comments_url":"https://api.github.com/repos/paramiko/paramiko/comments{/number}","issue_comment_url":"https://api.github.com/repos/paramiko/paramiko/issues/comments{/number}","contents_url":"https://api.github.com/repos/paramiko/paramiko/contents/{+path}","compare_url":"https://api.github.com/repos/paramiko/paramiko/compare/{base}...{head}","merges_url":"https://api.github.com/repos/paramiko/paramiko/merges","archive_url":"https://api.github.com/repos/paramiko/paramiko/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/paramiko/paramiko/downloads","issues_url":"https://api.github.com/repos/paramiko/paramiko/issues{/number}","pulls_url":"https://api.github.com/repos/paramiko/paramiko/pulls{/number}","milestones_url":"https://api.github.com/repos/paramiko/paramiko/milestones{/number}","notifications_url":"https://api.github.com/repos/paramiko/paramiko/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/paramiko/paramiko/labels{/name}","releases_url":"https://api.github.com/repos/paramiko/paramiko/releases{/id}","deployments_url":"https://api.github.com/repos/paramiko/paramiko/deployments","created_at":"2009-02-02T03:41:08Z","updated_at":"2025-11-10T08:04:35Z","pushed_at":"2025-10-20T02:50:05Z","git_url":"git://github.com/paramiko/paramiko.git","ssh_url":"git@github.com:paramiko/paramiko.git","clone_url":"https://github.com/paramiko/paramiko.git","svn_url":"https://github.com/paramiko/paramiko","homepage":"http://paramiko.org","size":8237,"stargazers_count":9558,"watchers_count":9558,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2033,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1138,"license":{"key":"lgpl-2.1","name":"GNU Lesser General Public License v2.1","spdx_id":"LGPL-2.1","url":"https://api.github.com/licenses/lgpl-2.1","node_id":"MDc6TGljZW5zZTEx"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2033,"open_issues":1138,"watchers":9558,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"Edit: I found a solution to this. There is a bug in Paramiko. Skip to the last post for the important details.\r\n\r\nI wrap all of my ssh connections inside the classes shown below. The classes are invoked like this:\r\n\r\n```\r\n        s = SshTask()\r\n        s.timeout = s.run_timeout = 14\r\n        s.to_host = form.get_store('vmh01')\r\n        s.key = settings.KEY\r\n        s.command = \" \"\r\n        packages = s.run()\r\n```\r\n\r\nThis should leave nothing behind. I scripted a page to repeatedly make the same request to the same server over and over again. I installed Dozer on my Django app. Debug mode is turned off. After a few hours of running my memory went form 100mb to 272mb. Paramiko seems to be the only thing that isn't cleaning up after itself.\r\n\r\nNow that the app is idle this is what it is showing for counts:\r\nparamiko.agent.Agent Min: 345 Cur: 345 Max: 345  \r\nparamiko.auth_handler.AuthHandler Min: 345 Cur: 345 Max: 345 \r\nparamiko.buffered_pipe.BufferedPipe Min: 690 Cur: 690 Max: 690  \r\nparamiko.channel.Channel Min: 345 Cur: 345 Max: 345  \r\nparamiko.client.AutoAddPolicy Min: 351 Cur: 351 Max: 351  \r\nparamiko.client.SSHClient Min: 351 Cur: 351 Max: 351  \r\nparamiko.ecdsakey._ECDSACurve Min: 3 Cur: 3 Max: 3  \r\nparamiko.ecdsakey._ECDSACurveSet Min: 1 Cur: 1 Max: 1  \r\nparamiko.hostkeys.HostKeyEntry Min: 345 Cur: 345 Max: 345  \r\nparamiko.hostkeys.HostKeys Min: 702 Cur: 702 Max: 702  \r\nparamiko.message.Message Min: 345 Cur: 345 Max: 345  \r\nparamiko.packet.Packetizer Min: 351 Cur: 351 Max: 351  \r\nparamiko.py3compat.long Min: 3 Cur: 3 Max: 3  \r\nparamiko.resource.ResourceManager Min: 1 Cur: 1 Max: 1  \r\nparamiko.rsakey.RSAKey Min: 690 Cur: 690 Max: 690  \r\nparamiko.ssh_exception.SSHException Min: 6 Cur: 6 Max: 6  \r\nparamiko.transport.ChannelMap Min: 351 Cur: 351 Max: 351  \r\nparamiko.transport.Transport Min: 351 Cur: 351 Max: 351 \r\nparamiko.util.PFilter Min: 1 Cur: 1 Max: 1 \r\n\r\nEdit: Narrowed this down more, see below post. Removed my implementation. Not relevant anymore.","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/949/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/paramiko/paramiko/issues/949/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"costela","id":94699,"node_id":"MDQ6VXNlcjk0Njk5","avatar_url":"https://avatars.githubusercontent.com/u/94699?v=4","gravatar_id":"","url":"https://api.github.com/users/costela","html_url":"https://github.com/costela","followers_url":"https://api.github.com/users/costela/followers","following_url":"https://api.github.com/users/costela/following{/other_user}","gists_url":"https://api.github.com/users/costela/gists{/gist_id}","starred_url":"https://api.github.com/users/costela/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/costela/subscriptions","organizations_url":"https://api.github.com/users/costela/orgs","repos_url":"https://api.github.com/users/costela/repos","events_url":"https://api.github.com/users/costela/events{/privacy}","received_events_url":"https://api.github.com/users/costela/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2017-08-30T21:06:36Z","updated_at":"2017-08-30T21:06:36Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/344","repository_url":"https://api.github.com/repos/paramiko/paramiko","labels_url":"https://api.github.com/repos/paramiko/paramiko/issues/344/labels{/name}","comments_url":"https://api.github.com/repos/paramiko/paramiko/issues/344/comments","events_url":"https://api.github.com/repos/paramiko/paramiko/issues/344/events","html_url":"https://github.com/paramiko/paramiko/issues/344","id":35193922,"node_id":"MDU6SXNzdWUzNTE5MzkyMg==","number":344,"title":"SFTPClient does not keep a reference to the Client","user":{"login":"FiloSottile","id":1225294,"node_id":"MDQ6VXNlcjEyMjUyOTQ=","avatar_url":"https://avatars.githubusercontent.com/u/1225294?v=4","gravatar_id":"","url":"https://api.github.com/users/FiloSottile","html_url":"https://github.com/FiloSottile","followers_url":"https://api.github.com/users/FiloSottile/followers","following_url":"https://api.github.com/users/FiloSottile/following{/other_user}","gists_url":"https://api.github.com/users/FiloSottile/gists{/gist_id}","starred_url":"https://api.github.com/users/FiloSottile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FiloSottile/subscriptions","organizations_url":"https://api.github.com/users/FiloSottile/orgs","repos_url":"https://api.github.com/users/FiloSottile/repos","events_url":"https://api.github.com/users/FiloSottile/events{/privacy}","received_events_url":"https://api.github.com/users/FiloSottile/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":60522311,"node_id":"MDU6TGFiZWw2MDUyMjMxMQ==","url":"https://api.github.com/repos/paramiko/paramiko/labels/Needs%20investigation","name":"Needs investigation","color":"fad8c7","default":false,"description":null},{"id":120561399,"node_id":"MDU6TGFiZWwxMjA1NjEzOTk=","url":"https://api.github.com/repos/paramiko/paramiko/labels/Bug","name":"Bug","color":"a04040","default":false,"description":null}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2014-06-07T00:29:49Z","updated_at":"2017-08-30T22:45:19Z","closed_at":null,"author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":119609,"node_id":"MDEwOlJlcG9zaXRvcnkxMTk2MDk=","name":"paramiko","full_name":"paramiko/paramiko","private":false,"owner":{"login":"paramiko","id":1108455,"node_id":"MDEyOk9yZ2FuaXphdGlvbjExMDg0NTU=","avatar_url":"https://avatars.githubusercontent.com/u/1108455?v=4","gravatar_id":"","url":"https://api.github.com/users/paramiko","html_url":"https://github.com/paramiko","followers_url":"https://api.github.com/users/paramiko/followers","following_url":"https://api.github.com/users/paramiko/following{/other_user}","gists_url":"https://api.github.com/users/paramiko/gists{/gist_id}","starred_url":"https://api.github.com/users/paramiko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/paramiko/subscriptions","organizations_url":"https://api.github.com/users/paramiko/orgs","repos_url":"https://api.github.com/users/paramiko/repos","events_url":"https://api.github.com/users/paramiko/events{/privacy}","received_events_url":"https://api.github.com/users/paramiko/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/paramiko/paramiko","description":"The leading native Python SSHv2 protocol library.","fork":false,"url":"https://api.github.com/repos/paramiko/paramiko","forks_url":"https://api.github.com/repos/paramiko/paramiko/forks","keys_url":"https://api.github.com/repos/paramiko/paramiko/keys{/key_id}","collaborators_url":"https://api.github.com/repos/paramiko/paramiko/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/paramiko/paramiko/teams","hooks_url":"https://api.github.com/repos/paramiko/paramiko/hooks","issue_events_url":"https://api.github.com/repos/paramiko/paramiko/issues/events{/number}","events_url":"https://api.github.com/repos/paramiko/paramiko/events","assignees_url":"https://api.github.com/repos/paramiko/paramiko/assignees{/user}","branches_url":"https://api.github.com/repos/paramiko/paramiko/branches{/branch}","tags_url":"https://api.github.com/repos/paramiko/paramiko/tags","blobs_url":"https://api.github.com/repos/paramiko/paramiko/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/paramiko/paramiko/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/paramiko/paramiko/git/refs{/sha}","trees_url":"https://api.github.com/repos/paramiko/paramiko/git/trees{/sha}","statuses_url":"https://api.github.com/repos/paramiko/paramiko/statuses/{sha}","languages_url":"https://api.github.com/repos/paramiko/paramiko/languages","stargazers_url":"https://api.github.com/repos/paramiko/paramiko/stargazers","contributors_url":"https://api.github.com/repos/paramiko/paramiko/contributors","subscribers_url":"https://api.github.com/repos/paramiko/paramiko/subscribers","subscription_url":"https://api.github.com/repos/paramiko/paramiko/subscription","commits_url":"https://api.github.com/repos/paramiko/paramiko/commits{/sha}","git_commits_url":"https://api.github.com/repos/paramiko/paramiko/git/commits{/sha}","comments_url":"https://api.github.com/repos/paramiko/paramiko/comments{/number}","issue_comment_url":"https://api.github.com/repos/paramiko/paramiko/issues/comments{/number}","contents_url":"https://api.github.com/repos/paramiko/paramiko/contents/{+path}","compare_url":"https://api.github.com/repos/paramiko/paramiko/compare/{base}...{head}","merges_url":"https://api.github.com/repos/paramiko/paramiko/merges","archive_url":"https://api.github.com/repos/paramiko/paramiko/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/paramiko/paramiko/downloads","issues_url":"https://api.github.com/repos/paramiko/paramiko/issues{/number}","pulls_url":"https://api.github.com/repos/paramiko/paramiko/pulls{/number}","milestones_url":"https://api.github.com/repos/paramiko/paramiko/milestones{/number}","notifications_url":"https://api.github.com/repos/paramiko/paramiko/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/paramiko/paramiko/labels{/name}","releases_url":"https://api.github.com/repos/paramiko/paramiko/releases{/id}","deployments_url":"https://api.github.com/repos/paramiko/paramiko/deployments","created_at":"2009-02-02T03:41:08Z","updated_at":"2025-11-10T08:04:35Z","pushed_at":"2025-10-20T02:50:05Z","git_url":"git://github.com/paramiko/paramiko.git","ssh_url":"git@github.com:paramiko/paramiko.git","clone_url":"https://github.com/paramiko/paramiko.git","svn_url":"https://github.com/paramiko/paramiko","homepage":"http://paramiko.org","size":8237,"stargazers_count":9558,"watchers_count":9558,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2033,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1138,"license":{"key":"lgpl-2.1","name":"GNU Lesser General Public License v2.1","spdx_id":"LGPL-2.1","url":"https://api.github.com/licenses/lgpl-2.1","node_id":"MDc6TGljZW5zZTEx"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2033,"open_issues":1138,"watchers":9558,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"SFTPClient does not keep (properly) a reference to the parent, so when it falls out of scope and gets closed, the sftp object becomes unusable.\n\n``` python\n>>> import paramiko\n>>>\n>>> username = \"xxx\"\n>>> key_filename = 'xxx'\n>>> hostname = 'xxx'\n>>> port = 22\n\n>>> def connect():\n...     client = paramiko.SSHClient()\n...     client.load_system_host_keys()\n...     client.set_missing_host_key_policy(paramiko.AutoAddPolicy())\n...     client.connect(hostname, port, username, key_filename=key_filename)\n...     sftp = client.open_sftp()\n...     return sftp\n...\n>>> sftp = connect()\n>>> sftp.listdir()\nTraceback (most recent call last):\n  File \"<input>\", line 1, in <module>\n  File \"/usr/local/lib/python2.7/site-packages/paramiko/sftp_client.py\", line 153, in listdir\n    return [f.filename for f in self.listdir_attr(path)]\n  File \"/usr/local/lib/python2.7/site-packages/paramiko/sftp_client.py\", line 174, in listdir_attr\n    t, msg = self._request(CMD_OPENDIR, path)\n  File \"/usr/local/lib/python2.7/site-packages/paramiko/sftp_client.py\", line 646, in _request\n    num = self._async_request(type(None), t, *arg)\n  File \"/usr/local/lib/python2.7/site-packages/paramiko/sftp_client.py\", line 668, in _async_request\n    self._send_packet(t, msg)\n  File \"/usr/local/lib/python2.7/site-packages/paramiko/sftp.py\", line 170, in _send_packet\n    self._write_all(out)\n  File \"/usr/local/lib/python2.7/site-packages/paramiko/sftp.py\", line 135, in _write_all\n    raise EOFError()\nEOFError\n>>>\n>>> client = paramiko.SSHClient()\n>>> client.load_system_host_keys()\n>>> client.set_missing_host_key_policy(paramiko.AutoAddPolicy())\n>>> client.connect(hostname, port, username, key_filename=key_filename)\n>>> sftp = client.open_sftp()\n>>> sftp.listdir()\n[u'xxx']\n```\n","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/344/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/paramiko/paramiko/issues/344/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":1667886971,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE2Njc4ODY5NzE=","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/1667886971","actor":{"login":"dkhapun","id":9967552,"node_id":"MDQ6VXNlcjk5Njc1NTI=","avatar_url":"https://avatars.githubusercontent.com/u/9967552?v=4","gravatar_id":"","url":"https://api.github.com/users/dkhapun","html_url":"https://github.com/dkhapun","followers_url":"https://api.github.com/users/dkhapun/followers","following_url":"https://api.github.com/users/dkhapun/following{/other_user}","gists_url":"https://api.github.com/users/dkhapun/gists{/gist_id}","starred_url":"https://api.github.com/users/dkhapun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkhapun/subscriptions","organizations_url":"https://api.github.com/users/dkhapun/orgs","repos_url":"https://api.github.com/users/dkhapun/repos","events_url":"https://api.github.com/users/dkhapun/events{/privacy}","received_events_url":"https://api.github.com/users/dkhapun/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"781f974d1aa5cce8ab0d05e297163d97089351c0","commit_url":"https://api.github.com/repos/cyberx-labs/paramiko/commits/781f974d1aa5cce8ab0d05e297163d97089351c0","created_at":"2018-06-07T08:00:31Z","performed_via_github_app":null},{"id":1667886981,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDE2Njc4ODY5ODE=","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/1667886981","actor":{"login":"dkhapun","id":9967552,"node_id":"MDQ6VXNlcjk5Njc1NTI=","avatar_url":"https://avatars.githubusercontent.com/u/9967552?v=4","gravatar_id":"","url":"https://api.github.com/users/dkhapun","html_url":"https://github.com/dkhapun","followers_url":"https://api.github.com/users/dkhapun/followers","following_url":"https://api.github.com/users/dkhapun/following{/other_user}","gists_url":"https://api.github.com/users/dkhapun/gists{/gist_id}","starred_url":"https://api.github.com/users/dkhapun/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dkhapun/subscriptions","organizations_url":"https://api.github.com/users/dkhapun/orgs","repos_url":"https://api.github.com/users/dkhapun/repos","events_url":"https://api.github.com/users/dkhapun/events{/privacy}","received_events_url":"https://api.github.com/users/dkhapun/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"99b4bbf6e52b1b0a231c4976e46bd81bdba709b8","commit_url":"https://api.github.com/repos/cyberx-labs/paramiko/commits/99b4bbf6e52b1b0a231c4976e46bd81bdba709b8","created_at":"2018-06-07T08:00:31Z","performed_via_github_app":null},{"id":2836736125,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDI4MzY3MzYxMjU=","url":"https://api.github.com/repos/paramiko/paramiko/issues/events/2836736125","actor":{"login":"intgr","id":137616,"node_id":"MDQ6VXNlcjEzNzYxNg==","avatar_url":"https://avatars.githubusercontent.com/u/137616?v=4","gravatar_id":"","url":"https://api.github.com/users/intgr","html_url":"https://github.com/intgr","followers_url":"https://api.github.com/users/intgr/followers","following_url":"https://api.github.com/users/intgr/following{/other_user}","gists_url":"https://api.github.com/users/intgr/gists{/gist_id}","starred_url":"https://api.github.com/users/intgr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/intgr/subscriptions","organizations_url":"https://api.github.com/users/intgr/orgs","repos_url":"https://api.github.com/users/intgr/repos","events_url":"https://api.github.com/users/intgr/events{/privacy}","received_events_url":"https://api.github.com/users/intgr/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"3b400723aff0887cb3935a578e5cef04065065cf","commit_url":"https://api.github.com/repos/intgr/paramiko/commits/3b400723aff0887cb3935a578e5cef04065065cf","created_at":"2019-11-27T19:08:02Z","performed_via_github_app":null},{"actor":{"login":"bskinn","id":11325439,"node_id":"MDQ6VXNlcjExMzI1NDM5","avatar_url":"https://avatars.githubusercontent.com/u/11325439?v=4","gravatar_id":"","url":"https://api.github.com/users/bskinn","html_url":"https://github.com/bskinn","followers_url":"https://api.github.com/users/bskinn/followers","following_url":"https://api.github.com/users/bskinn/following{/other_user}","gists_url":"https://api.github.com/users/bskinn/gists{/gist_id}","starred_url":"https://api.github.com/users/bskinn/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bskinn/subscriptions","organizations_url":"https://api.github.com/users/bskinn/orgs","repos_url":"https://api.github.com/users/bskinn/repos","events_url":"https://api.github.com/users/bskinn/events{/privacy}","received_events_url":"https://api.github.com/users/bskinn/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2022-06-01T14:01:49Z","updated_at":"2022-06-01T14:01:49Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/1822","repository_url":"https://api.github.com/repos/paramiko/paramiko","labels_url":"https://api.github.com/repos/paramiko/paramiko/issues/1822/labels{/name}","comments_url":"https://api.github.com/repos/paramiko/paramiko/issues/1822/comments","events_url":"https://api.github.com/repos/paramiko/paramiko/issues/1822/events","html_url":"https://github.com/paramiko/paramiko/pull/1822","id":821906779,"node_id":"MDExOlB1bGxSZXF1ZXN0NTg0NjE3NTQz","number":1822,"title":"Close socket on failure","user":{"login":"YoavCohen","id":13788181,"node_id":"MDQ6VXNlcjEzNzg4MTgx","avatar_url":"https://avatars.githubusercontent.com/u/13788181?v=4","gravatar_id":"","url":"https://api.github.com/users/YoavCohen","html_url":"https://github.com/YoavCohen","followers_url":"https://api.github.com/users/YoavCohen/followers","following_url":"https://api.github.com/users/YoavCohen/following{/other_user}","gists_url":"https://api.github.com/users/YoavCohen/gists{/gist_id}","starred_url":"https://api.github.com/users/YoavCohen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/YoavCohen/subscriptions","organizations_url":"https://api.github.com/users/YoavCohen/orgs","repos_url":"https://api.github.com/users/YoavCohen/repos","events_url":"https://api.github.com/users/YoavCohen/events{/privacy}","received_events_url":"https://api.github.com/users/YoavCohen/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":60520372,"node_id":"MDU6TGFiZWw2MDUyMDM3Mg==","url":"https://api.github.com/repos/paramiko/paramiko/labels/Ready%20for%20review","name":"Ready for review","color":"bfe5bf","default":false,"description":null},{"id":120554861,"node_id":"MDU6TGFiZWwxMjA1NTQ4NjE=","url":"https://api.github.com/repos/paramiko/paramiko/labels/Exception%20handling","name":"Exception handling","color":"bfd4f2","default":false,"description":null},{"id":120561399,"node_id":"MDU6TGFiZWwxMjA1NjEzOTk=","url":"https://api.github.com/repos/paramiko/paramiko/labels/Bug","name":"Bug","color":"a04040","default":false,"description":null},{"id":121893209,"node_id":"MDU6TGFiZWwxMjE4OTMyMDk=","url":"https://api.github.com/repos/paramiko/paramiko/labels/Needs%20changelog/docs","name":"Needs changelog/docs","color":"bfdadc","default":false,"description":null},{"id":493264258,"node_id":"MDU6TGFiZWw0OTMyNjQyNTg=","url":"https://api.github.com/repos/paramiko/paramiko/labels/Low-hanging%20fruit","name":"Low-hanging fruit","color":"c2e0c6","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":6,"created_at":"2021-03-04T08:46:17Z","updated_at":"2022-06-04T01:29:29Z","closed_at":"2022-06-03T23:55:58Z","author_association":"NONE","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":119609,"node_id":"MDEwOlJlcG9zaXRvcnkxMTk2MDk=","name":"paramiko","full_name":"paramiko/paramiko","private":false,"owner":{"login":"paramiko","id":1108455,"node_id":"MDEyOk9yZ2FuaXphdGlvbjExMDg0NTU=","avatar_url":"https://avatars.githubusercontent.com/u/1108455?v=4","gravatar_id":"","url":"https://api.github.com/users/paramiko","html_url":"https://github.com/paramiko","followers_url":"https://api.github.com/users/paramiko/followers","following_url":"https://api.github.com/users/paramiko/following{/other_user}","gists_url":"https://api.github.com/users/paramiko/gists{/gist_id}","starred_url":"https://api.github.com/users/paramiko/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/paramiko/subscriptions","organizations_url":"https://api.github.com/users/paramiko/orgs","repos_url":"https://api.github.com/users/paramiko/repos","events_url":"https://api.github.com/users/paramiko/events{/privacy}","received_events_url":"https://api.github.com/users/paramiko/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/paramiko/paramiko","description":"The leading native Python SSHv2 protocol library.","fork":false,"url":"https://api.github.com/repos/paramiko/paramiko","forks_url":"https://api.github.com/repos/paramiko/paramiko/forks","keys_url":"https://api.github.com/repos/paramiko/paramiko/keys{/key_id}","collaborators_url":"https://api.github.com/repos/paramiko/paramiko/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/paramiko/paramiko/teams","hooks_url":"https://api.github.com/repos/paramiko/paramiko/hooks","issue_events_url":"https://api.github.com/repos/paramiko/paramiko/issues/events{/number}","events_url":"https://api.github.com/repos/paramiko/paramiko/events","assignees_url":"https://api.github.com/repos/paramiko/paramiko/assignees{/user}","branches_url":"https://api.github.com/repos/paramiko/paramiko/branches{/branch}","tags_url":"https://api.github.com/repos/paramiko/paramiko/tags","blobs_url":"https://api.github.com/repos/paramiko/paramiko/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/paramiko/paramiko/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/paramiko/paramiko/git/refs{/sha}","trees_url":"https://api.github.com/repos/paramiko/paramiko/git/trees{/sha}","statuses_url":"https://api.github.com/repos/paramiko/paramiko/statuses/{sha}","languages_url":"https://api.github.com/repos/paramiko/paramiko/languages","stargazers_url":"https://api.github.com/repos/paramiko/paramiko/stargazers","contributors_url":"https://api.github.com/repos/paramiko/paramiko/contributors","subscribers_url":"https://api.github.com/repos/paramiko/paramiko/subscribers","subscription_url":"https://api.github.com/repos/paramiko/paramiko/subscription","commits_url":"https://api.github.com/repos/paramiko/paramiko/commits{/sha}","git_commits_url":"https://api.github.com/repos/paramiko/paramiko/git/commits{/sha}","comments_url":"https://api.github.com/repos/paramiko/paramiko/comments{/number}","issue_comment_url":"https://api.github.com/repos/paramiko/paramiko/issues/comments{/number}","contents_url":"https://api.github.com/repos/paramiko/paramiko/contents/{+path}","compare_url":"https://api.github.com/repos/paramiko/paramiko/compare/{base}...{head}","merges_url":"https://api.github.com/repos/paramiko/paramiko/merges","archive_url":"https://api.github.com/repos/paramiko/paramiko/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/paramiko/paramiko/downloads","issues_url":"https://api.github.com/repos/paramiko/paramiko/issues{/number}","pulls_url":"https://api.github.com/repos/paramiko/paramiko/pulls{/number}","milestones_url":"https://api.github.com/repos/paramiko/paramiko/milestones{/number}","notifications_url":"https://api.github.com/repos/paramiko/paramiko/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/paramiko/paramiko/labels{/name}","releases_url":"https://api.github.com/repos/paramiko/paramiko/releases{/id}","deployments_url":"https://api.github.com/repos/paramiko/paramiko/deployments","created_at":"2009-02-02T03:41:08Z","updated_at":"2025-11-10T08:04:35Z","pushed_at":"2025-10-20T02:50:05Z","git_url":"git://github.com/paramiko/paramiko.git","ssh_url":"git@github.com:paramiko/paramiko.git","clone_url":"https://github.com/paramiko/paramiko.git","svn_url":"https://github.com/paramiko/paramiko","homepage":"http://paramiko.org","size":8237,"stargazers_count":9558,"watchers_count":9558,"language":"Python","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":2033,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":1138,"license":{"key":"lgpl-2.1","name":"GNU Lesser General Public License v2.1","spdx_id":"LGPL-2.1","url":"https://api.github.com/licenses/lgpl-2.1","node_id":"MDc6TGljZW5zZTEx"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":2033,"open_issues":1138,"watchers":9558,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/paramiko/paramiko/pulls/1822","html_url":"https://github.com/paramiko/paramiko/pull/1822","diff_url":"https://github.com/paramiko/paramiko/pull/1822.diff","patch_url":"https://github.com/paramiko/paramiko/pull/1822.patch","merged_at":null},"body":"As mentioned in socket docs:\r\n\"Sockets are automatically closed when they are garbage-collected, but it is recommended to close() them explicitly, or to use a with statement around them.\"\r\n\r\nResolve #1126","reactions":{"url":"https://api.github.com/repos/paramiko/paramiko/issues/1822/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/paramiko/paramiko/issues/1822/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"}]