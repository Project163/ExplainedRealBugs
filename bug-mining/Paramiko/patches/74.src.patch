diff --git a/paramiko/kex_group1.py b/paramiko/kex_group1.py
index 5131e895..dce3fd91 100644
--- a/paramiko/kex_group1.py
+++ b/paramiko/kex_group1.py
@@ -140,7 +140,7 @@ class KexGroup1(object):
         hm.add_mpint(self.e)
         hm.add_mpint(self.f)
         hm.add_mpint(K)
-        H = sha1(hm.asbytes()).digest()
+        H = self.hash_algo(hm.asbytes()).digest()
         self.transport._set_K_H(K, H)
         # sign it
         sig = self.transport.get_server_key().sign_ssh_data(H)
