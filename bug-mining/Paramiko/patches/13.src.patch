diff --git a/paramiko/_winapi.py b/paramiko/_winapi.py
index f141b005..9af8adde 100644
--- a/paramiko/_winapi.py
+++ b/paramiko/_winapi.py
@@ -81,9 +81,6 @@ def handle_nonzero_success(result):
 		raise WindowsError()
 
 
-#####################
-# jaraco.windows.mmap
-
 CreateFileMapping = ctypes.windll.kernel32.CreateFileMappingW
 CreateFileMapping.argtypes = [
 	ctypes.wintypes.HANDLE,
@@ -130,15 +127,18 @@ class MemoryMap(object):
 		self.pos = pos
 
 	def write(self, msg):
-		ctypes.windll.msvcrt.memcpy(self.view + self.pos, msg, len(msg))
-		self.pos += len(msg)
+		n = len(msg)
+		if self.pos + n >= self.length:  # A little safety.
+			raise ValueError("Refusing to write %d bytes" % n)
+		ctypes.windll.kernel32.RtlMoveMemory(self.view + self.pos, msg, n)
+		self.pos += n
 
 	def read(self, n):
 		"""
 		Read n bytes from mapped view.
 		"""
 		out = ctypes.create_string_buffer(n)
-		ctypes.windll.msvcrt.memcpy(out, self.view + self.pos, n)
+		ctypes.windll.kernel32.RtlMoveMemory(out, self.view + self.pos, n)
 		self.pos += n
 		return out.raw
 
