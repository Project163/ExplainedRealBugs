{"url":"https://api.github.com/repos/netty/netty/issues/14930","repository_url":"https://api.github.com/repos/netty/netty","labels_url":"https://api.github.com/repos/netty/netty/issues/14930/labels{/name}","comments_url":"https://api.github.com/repos/netty/netty/issues/14930/comments","events_url":"https://api.github.com/repos/netty/netty/issues/14930/events","html_url":"https://github.com/netty/netty/issues/14930","id":2923315617,"node_id":"I_kwDOABA-c86uPkGh","number":14930,"title":"Netty 4.2 - allocateUninitializedArray unavailable","user":{"login":"Spasi","id":1545420,"node_id":"MDQ6VXNlcjE1NDU0MjA=","avatar_url":"https://avatars.githubusercontent.com/u/1545420?v=4","gravatar_id":"","url":"https://api.github.com/users/Spasi","html_url":"https://github.com/Spasi","followers_url":"https://api.github.com/users/Spasi/followers","following_url":"https://api.github.com/users/Spasi/following{/other_user}","gists_url":"https://api.github.com/users/Spasi/gists{/gist_id}","starred_url":"https://api.github.com/users/Spasi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Spasi/subscriptions","organizations_url":"https://api.github.com/users/Spasi/orgs","repos_url":"https://api.github.com/users/Spasi/repos","events_url":"https://api.github.com/users/Spasi/events{/privacy}","received_events_url":"https://api.github.com/users/Spasi/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/netty/netty/milestones/311","html_url":"https://github.com/netty/netty/milestone/311","labels_url":"https://api.github.com/repos/netty/netty/milestones/311/labels","id":12458490,"node_id":"MI_kwDOABA-c84Avhn6","number":311,"title":"4.2.0.Final","description":"","creator":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":42,"state":"closed","created_at":"2025-03-07T10:34:33Z","updated_at":"2025-04-03T15:26:07Z","due_on":null,"closed_at":"2025-04-03T15:26:07Z"},"comments":1,"created_at":"2025-03-16T21:15:05Z","updated_at":"2025-03-19T09:34:25Z","closed_at":"2025-03-19T09:34:24Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"After #14032, the `jdk.internal.misc.Unsafe.allocateUninitializedArray` optimization is reported as:\n\n> unavailable: handle's method type (Class,int)Object but found (Class,int)byte[]\n\nThe reason is that it is being called via `MethodHandle::invokeExact` with not exactly accurate types. For example, in `PlatformDependent0`'s static init, the code that detects its availability should be changed from:\n\n```java\nbyte[] bytes = (byte[]) m.invokeExact(byte.class, 8);\n```\n\nto:\n\n```java\nbyte[] bytes = (byte[]) (Object) m.invokeExact(byte.class, 8);\n```\n\nNote the extra cast to `Object` before casting to byte array. This is necessary because the method signature is:\n\n```java\npublic Object allocateUninitializedArray(Class<?> componentType, int length)\n```","closed_by":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/netty/netty/issues/14930/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/netty/netty/issues/14930/timeline","performed_via_github_app":null,"state_reason":"completed"}