[{"url":"https://api.github.com/repos/netty/netty/issues/comments/681961720","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-681961720","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":681961720,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MTk2MTcyMA==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-27T13:51:03Z","updated_at":"2020-08-27T13:51:03Z","body":"My 2 cents:\r\nFirst change:\r\n- Before, it was a `copy` which limits the max, \r\n- now is a `buf.alloc.buffer(...).writeByte(buf)`  => Pooled buffer using the original ByteBufAllocator from the `buf`\r\n\r\nSecond change, which is probably the one you point out:\r\n- Before (2 places): `Unpooled.buffer(64)` (Unpooled implicit)\r\n- After (same): `undecodedChunk.alloc().heapBuffer(64)`\r\n\r\nThis should use the ByteBufAllocator used for undecoded, which in turns should be (if I understand) the same allocator than original `buf` (so the one from IO) since either it is the same, or a new allocated one using the same allocator.\r\n\r\nI could suggest to replace `undecodedChunk.alloc().heapBuffer(64)` by `undecodedChunk.alloc().buffer(64, 64)` (here there should not be any more than 64), but as you noticed that putting a `PooledByteBufAllocator` to direct is not correct, but heap seems ok, then I finally could suggest: `undecodedChunk.alloc().heapBuffer(64, 64)`, which is almost what we have there...\r\n\r\n@normanmaurer Any suggestion since I do not have a clear mind on this... ?\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/681961720/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3699743334,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzY5OTc0MzMzNA==","url":"https://api.github.com/repos/netty/netty/issues/events/3699743334","actor":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-08-27T13:51:03Z","performed_via_github_app":null},{"id":3699743351,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM2OTk3NDMzNTE=","url":"https://api.github.com/repos/netty/netty/issues/events/3699743351","actor":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-08-27T13:51:03Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/683175485","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-683175485","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":683175485,"node_id":"MDEyOklzc3VlQ29tbWVudDY4MzE3NTQ4NQ==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-08-28T22:37:14Z","updated_at":"2020-08-28T22:37:14Z","body":"@zentol I tried to reproduce using only Netty, but I can't get the numbers you've got.\r\n\r\nCould you have a reproducer code with Netty only (almost a Junit or simple example)?\r\nWhat kind of data are you sending (which forms and numbers)?\r\nAnd to be sure, your tests shows that Direct buffers are not ok, while Heap buffers are ?\r\nThanks","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/683175485/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3705841571,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzcwNTg0MTU3MQ==","url":"https://api.github.com/repos/netty/netty/issues/events/3705841571","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-08-28T22:37:14Z","performed_via_github_app":null},{"id":3705841572,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3MDU4NDE1NzI=","url":"https://api.github.com/repos/netty/netty/issues/events/3705841572","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-08-28T22:37:14Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/685342245","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-685342245","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":685342245,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NTM0MjI0NQ==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-02T06:33:55Z","updated_at":"2020-09-02T06:33:55Z","body":"@zentol Note that I used 4.1.51 and I can't reproduce the issue you raised... ","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/685342245/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3718077860,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzcxODA3Nzg2MA==","url":"https://api.github.com/repos/netty/netty/issues/events/3718077860","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-02T06:33:55Z","performed_via_github_app":null},{"id":3718077863,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3MTgwNzc4NjM=","url":"https://api.github.com/repos/netty/netty/issues/events/3718077863","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-02T06:33:55Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/686300452","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-686300452","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":686300452,"node_id":"MDEyOklzc3VlQ29tbWVudDY4NjMwMDQ1Mg==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-03T07:07:42Z","updated_at":"2020-09-03T07:07:42Z","body":"@zentol I tried another time, but the numbers I've got are almost the same whatever the allocation:\r\n- PooledHeap, PooledDirect, PooledBuffer (from undecodedChunked\r\n- UnpooledHeap, UnpooledDirect, UnpooledBuffer\r\n\r\nI've tried both 1000 chunks for big data (64KB each) so 1000 decoded vars or 1000 chunks for small data (4KB each but 16 times so still chunks of 64KB each) so 16000 decoded vars, and the results are the same : \r\n- 4KB data size: roughly 230ms each test (16000 data) (highest - lowest = 5ms)\r\n- 64KB data size: roughly 2900ms each test (1000 data), the difference being the data written on disk due to large size (> 16KB)  (highest - lowest = 310ms, but not so relevant since disk access is most of the issue as without disk access, there is no issue)\r\n- 64KB data size: roughly 190ms each test (1000 data), the difference being the data not written on disk (memory only) (highest - lowest = 8ms)\r\n\r\nSo my conclusion until further information from you is that there is no issue there... Either I'm missing something, either it was fixed in 4.1.51...","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/686300452/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3723228039,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MzcyMzIyODAzOQ==","url":"https://api.github.com/repos/netty/netty/issues/events/3723228039","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-03T07:07:42Z","performed_via_github_app":null},{"id":3723228043,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3MjMyMjgwNDM=","url":"https://api.github.com/repos/netty/netty/issues/events/3723228043","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-03T07:07:42Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/691925514","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-691925514","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":691925514,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MTkyNTUxNA==","user":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-14T09:07:21Z","updated_at":"2020-09-14T09:07:21Z","body":"@fredericBregier I did not test it with 4.1.51 due to #10425. I will check whether the issue persists in 4.1.52, and if so try to create a reproducer.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/691925514/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3762268779,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzc2MjI2ODc3OQ==","url":"https://api.github.com/repos/netty/netty/issues/events/3762268779","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-14T09:07:21Z","performed_via_github_app":null},{"id":3762268786,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3NjIyNjg3ODY=","url":"https://api.github.com/repos/netty/netty/issues/events/3762268786","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-14T09:07:21Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/692037524","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-692037524","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":692037524,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MjAzNzUyNA==","user":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-14T13:03:32Z","updated_at":"2020-09-14T13:03:32Z","body":"Ok, I think I got closer to the problem.\r\n\r\nI wrote a reproducing test, which ran fast in 4.1.49 and slow in 4.1.50, but when I moved it into a separate project it suddenly ran fast either way.\r\nI then noticed that the test we used so far also uses a `ResourceLeakDetector` set to `PARANOID`. If I set the level to `ADVANCED` it runs quickly with both versions, but `PARANOID` appears to slow things down way more in 4.1.50+.\r\n\r\nHere's the test in question:\r\n\r\n```\r\npublic class RegressionTest {\r\n\r\n\t@Rule\r\n\tpublic final TemporaryFolder temporaryFolder = new TemporaryFolder();\r\n\r\n\tstatic {\r\n\t\tResourceLeakDetector.setLevel(ResourceLeakDetector.Level.PARANOID);\r\n\t}\r\n\r\n\t@Test\r\n\tpublic void testRegression() throws Exception {\r\n\t\tFile file = temporaryFolder.newFile();\r\n\t\ttry (RandomAccessFile rw = new RandomAccessFile(file, \"rw\")) {\r\n\t\t\trw.setLength(1024 * 1024 * 5);\r\n\t\t}\r\n\t\tDefaultHttpDataFactory httpDataFactory = new DefaultHttpDataFactory(true);\r\n\r\n\t\tHttpRequest httpRequest = new DefaultFullHttpRequest(HttpVersion.HTTP_1_1, HttpMethod.POST, \"\");\r\n\t\tHttpPostRequestEncoder bodyRequestEncoder = new HttpPostRequestEncoder(httpDataFactory, httpRequest, true);\r\n\t\tbodyRequestEncoder.addBodyFileUpload(\"file\", file, \"application/octet-stream\", false);\r\n\r\n\t\tHttpRequest firstHttpRequest = bodyRequestEncoder.finalizeRequest();\r\n\t\tHttpPostRequestDecoder httpPostRequestDecoder = new HttpPostRequestDecoder(httpDataFactory, firstHttpRequest);\r\n\r\n\t\tByteBufAllocator allocator = PooledByteBufAllocator.DEFAULT;\r\n\t\tfor (HttpContent httpContent = bodyRequestEncoder.readChunk(allocator); httpContent != null; httpContent = bodyRequestEncoder.readChunk(allocator)) {\r\n\t\t\thttpPostRequestDecoder.offer(httpContent);\r\n\t\t}\r\n\t}\r\n}\r\n```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/692037524/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/692071289","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-692071289","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":692071289,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MjA3MTI4OQ==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-14T13:59:19Z","updated_at":"2020-09-14T13:59:19Z","body":"@zentol Effctively, with PARANOID level set, chunks are quite high consuming time, while other levels are quite quickier. On my tests (same than before, based on 4.1.52):  whatever the pooled/unpooled heap/direct buffers\r\n- No detector: 225 to 230ms\r\n- Simple: 229 to 233ms\r\n- Advanced; 228 to 245ms\r\n- Paranoid:  147.000ms\r\nSo yes, there is a hug gap using Paranoid (almost x600). Maybe you can stay in at most Advanced mode ?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/692071289/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3763497885,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzc2MzQ5Nzg4NQ==","url":"https://api.github.com/repos/netty/netty/issues/events/3763497885","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-14T13:59:19Z","performed_via_github_app":null},{"id":3763497889,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3NjM0OTc4ODk=","url":"https://api.github.com/repos/netty/netty/issues/events/3763497889","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-14T13:59:19Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/692073500","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-692073500","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":692073500,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MjA3MzUwMA==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-14T14:02:58Z","updated_at":"2020-09-14T14:02:58Z","body":"@normanmaurer However I have a question for you, do you think this kind of gap is normal ?\r\nI do know that Paranoid is not for Production, but maybe it is so huge that it could not be usable. Note however that I used Paranoid level for a long time is all my tests and did not found any issue about on my side.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/692073500/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3763516111,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzc2MzUxNjExMQ==","url":"https://api.github.com/repos/netty/netty/issues/events/3763516111","actor":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-14T14:02:58Z","performed_via_github_app":null},{"id":3763516114,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3NjM1MTYxMTQ=","url":"https://api.github.com/repos/netty/netty/issues/events/3763516114","actor":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-14T14:02:58Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/692600876","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-692600876","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":692600876,"node_id":"MDEyOklzc3VlQ29tbWVudDY5MjYwMDg3Ng==","user":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-15T09:42:38Z","updated_at":"2020-09-15T09:42:38Z","body":"Using Advanced would be workaround we would go for, but this runtime increase on Paranoid does not seem normal. It was perfectly fine to use Paranoid in earlier versions, and it would be unfortunate to weaken our tests now with never versions. :/","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/692600876/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/696113218","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-696113218","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":696113218,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjExMzIxOA==","user":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-21T13:25:50Z","updated_at":"2020-09-21T13:25:50Z","body":"sorry for the late reply... The problem with \"paranoid\" is that it basically creates one stack trace per `ByteBuf` access which can be very expensive. So these kind of performance drops can happen.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/696113218/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/696301086","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-696301086","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":696301086,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjMwMTA4Ng==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-21T18:47:38Z","updated_at":"2020-09-21T18:47:38Z","body":"@normanmaurer Thanks!\r\nFor me, it's fine as is.\r\nIf I'm correct, changing the number of items tracked through `io.netty.leakDetection.targetRecords` will not change every access to be checked but just limit the number of retained items ?\r\n\r\nI believe that one could set specific values for `io.netty.leakDetection.samplingInterval` (default being 128 to a small value (still power of 2, such as 16 to reduce the PARANOID effect to a smaller part (If I'm correct, the main difference between ADVANCED and PARANOID is that this samplingInterval is ignored within PARANOID ?).\r\n\r\nI checked using level = `ADVANCED` and `io.netty.leakDetection.samplingInterval` to: (using Pooled one)\r\n- compared to `PARANOID`: 140.000ms whatever Direct or Heap\r\n- 8 : 140.000ms Direct vs 4.000ms Heap, so almost the same as PARANOID, except using Heap\r\n- 16 : 210ms whatever\r\n- 128 (default) : 200ms whatever Direct or Heap\r\n- 12 (*I know that the code said it should be a power of 2): 590ms Direct 420ms Heap\r\nSo maybe 12 could be a good tradeof ? (more trace but not as many as in PARANOID).\r\n\r\nAgain, on my side, I use PARANOID everywhere in my tests and I'm fine with it. It is more for the question of @zentol .\r\n\r\nNote: I used this in my test bench code\r\n\r\n    @BeforeClass\r\n    public static void setDefaultAdvancedLevel() {\r\n      System.setProperty(\"io.netty.leakDetection.samplingInterval\", \"12\");\r\n      ResourceLeakDetector.setLevel(Level.ADVANCED);\r\n    }\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/696301086/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3790086260,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzc5MDA4NjI2MA==","url":"https://api.github.com/repos/netty/netty/issues/events/3790086260","actor":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-21T18:47:38Z","performed_via_github_app":null},{"id":3790086264,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3OTAwODYyNjQ=","url":"https://api.github.com/repos/netty/netty/issues/events/3790086264","actor":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-21T18:47:38Z","performed_via_github_app":null},{"id":3790086272,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50Mzc5MDA4NjI3Mg==","url":"https://api.github.com/repos/netty/netty/issues/events/3790086272","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-09-21T18:47:38Z","performed_via_github_app":null},{"id":3790086275,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDM3OTAwODYyNzU=","url":"https://api.github.com/repos/netty/netty/issues/events/3790086275","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-09-21T18:47:38Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/696582675","html_url":"https://github.com/netty/netty/issues/10508#issuecomment-696582675","issue_url":"https://api.github.com/repos/netty/netty/issues/10508","id":696582675,"node_id":"MDEyOklzc3VlQ29tbWVudDY5NjU4MjY3NQ==","user":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-09-22T08:30:26Z","updated_at":"2020-09-22T08:30:26Z","body":"Our problem isn't that PARANOID is slower than other modes, that's fine and expected, but that due to _some change that impacts leak detection_ our test is 100x slower in 4.1.50 than before.\r\n\r\nI would just like to understand what has changed; if the leak detection was made slower in general, then that's fine, but I'm worried that something else has changed that indirectly causes leak detection to be slower in our specific case.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/696582675/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"zentol","id":5725237,"node_id":"MDQ6VXNlcjU3MjUyMzc=","avatar_url":"https://avatars.githubusercontent.com/u/5725237?v=4","gravatar_id":"","url":"https://api.github.com/users/zentol","html_url":"https://github.com/zentol","followers_url":"https://api.github.com/users/zentol/followers","following_url":"https://api.github.com/users/zentol/following{/other_user}","gists_url":"https://api.github.com/users/zentol/gists{/gist_id}","starred_url":"https://api.github.com/users/zentol/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zentol/subscriptions","organizations_url":"https://api.github.com/users/zentol/orgs","repos_url":"https://api.github.com/users/zentol/repos","events_url":"https://api.github.com/users/zentol/events{/privacy}","received_events_url":"https://api.github.com/users/zentol/received_events","type":"User","user_view_type":"public","site_admin":false}}]