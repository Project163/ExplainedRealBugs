{"url":"https://api.github.com/repos/netty/netty/issues/13384","repository_url":"https://api.github.com/repos/netty/netty","labels_url":"https://api.github.com/repos/netty/netty/issues/13384/labels{/name}","comments_url":"https://api.github.com/repos/netty/netty/issues/13384/comments","events_url":"https://api.github.com/repos/netty/netty/issues/13384/events","html_url":"https://github.com/netty/netty/issues/13384","id":1711750715,"node_id":"I_kwDOABA-c85mBz47","number":13384,"title":"Unable to supply resolveCache to DnsNameResolverBuilder and use TTL's for other two caches","user":{"login":"samueldlightfoot","id":84812011,"node_id":"MDQ6VXNlcjg0ODEyMDEx","avatar_url":"https://avatars.githubusercontent.com/u/84812011?v=4","gravatar_id":"","url":"https://api.github.com/users/samueldlightfoot","html_url":"https://github.com/samueldlightfoot","followers_url":"https://api.github.com/users/samueldlightfoot/followers","following_url":"https://api.github.com/users/samueldlightfoot/following{/other_user}","gists_url":"https://api.github.com/users/samueldlightfoot/gists{/gist_id}","starred_url":"https://api.github.com/users/samueldlightfoot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/samueldlightfoot/subscriptions","organizations_url":"https://api.github.com/users/samueldlightfoot/orgs","repos_url":"https://api.github.com/users/samueldlightfoot/repos","events_url":"https://api.github.com/users/samueldlightfoot/events{/privacy}","received_events_url":"https://api.github.com/users/samueldlightfoot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/netty/netty/milestones/273","html_url":"https://github.com/netty/netty/milestone/273","labels_url":"https://api.github.com/repos/netty/netty/milestones/273/labels","id":9325169,"node_id":"MI_kwDOABA-c84Ajkpx","number":273,"title":"4.1.93.Final","description":"","creator":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":22,"state":"closed","created_at":"2023-04-25T09:03:40Z","updated_at":"2023-05-30T10:17:36Z","due_on":null,"closed_at":"2023-05-30T10:17:36Z"},"comments":3,"created_at":"2023-05-16T10:41:26Z","updated_at":"2023-05-22T06:48:37Z","closed_at":"2023-05-22T06:42:46Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Expected behavior\r\n\r\nIf a resolveCache is set in the DnsNameResolverBuilder the min, max and negative TTL fields must be null. However, this means the cname cache and authoritative DNS server cache will be built with default (fallback) TTLs as opposed to a TTL which the user may want to set.\r\n\r\nI'd expect to be able to provide the resolveCache and also TTL's which should be applied to the cname and authoritative DNS server caches.  This is not possible due to the following code:\r\n\r\n```\r\n       if (resolveCache != null && (minTtl != null || maxTtl != null || negativeTtl != null)) {\r\n            throw new IllegalStateException(\"resolveCache and TTLs are mutually exclusive\");\r\n        }\r\n\r\n        if (authoritativeDnsServerCache != null && (minTtl != null || maxTtl != null || negativeTtl != null)) {\r\n            throw new IllegalStateException(\"authoritativeDnsServerCache and TTLs are mutually exclusive\");\r\n        }\r\n```\r\n\r\nThis means the building of the cname cache is forced to use default values (0, Integer.MAX_VALUE)\r\n\r\n```\r\n    private DnsCnameCache newCnameCache() {\r\n        return new DefaultDnsCnameCache(\r\n                intValue(minTtl, 0), intValue(maxTtl, Integer.MAX_VALUE));\r\n    }\r\n```\r\n\r\n### Actual behavior\r\n\r\n### Steps to reproduce\r\n\r\nUse DnsNameResolverBuilder to with a supplied resolveCache and minTtl, maxTtl or negativeTtl values.\r\n\r\n### Minimal yet complete reproducer code (or URL to code)\r\n\r\n### Netty version\r\n\r\n4.1.92\r\n\r\n### JVM version (e.g. `java -version`)\r\n\r\n### OS version (e.g. `uname -a`)\r\n","closed_by":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/netty/netty/issues/13384/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/netty/netty/issues/13384/timeline","performed_via_github_app":null,"state_reason":"completed"}