{"url":"https://api.github.com/repos/netty/netty/issues/7076","repository_url":"https://api.github.com/repos/netty/netty","labels_url":"https://api.github.com/repos/netty/netty/issues/7076/labels{/name}","comments_url":"https://api.github.com/repos/netty/netty/issues/7076/comments","events_url":"https://api.github.com/repos/netty/netty/issues/7076/events","html_url":"https://github.com/netty/netty/issues/7076","id":249196855,"node_id":"MDU6SXNzdWUyNDkxOTY4NTU=","number":7076,"title":"MQTT NPE if password or willMessage is null.","user":{"login":"michaelandrepearce","id":1387822,"node_id":"MDQ6VXNlcjEzODc4MjI=","avatar_url":"https://avatars.githubusercontent.com/u/1387822?v=4","gravatar_id":"","url":"https://api.github.com/users/michaelandrepearce","html_url":"https://github.com/michaelandrepearce","followers_url":"https://api.github.com/users/michaelandrepearce/followers","following_url":"https://api.github.com/users/michaelandrepearce/following{/other_user}","gists_url":"https://api.github.com/users/michaelandrepearce/gists{/gist_id}","starred_url":"https://api.github.com/users/michaelandrepearce/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/michaelandrepearce/subscriptions","organizations_url":"https://api.github.com/users/michaelandrepearce/orgs","repos_url":"https://api.github.com/users/michaelandrepearce/repos","events_url":"https://api.github.com/users/michaelandrepearce/events{/privacy}","received_events_url":"https://api.github.com/users/michaelandrepearce/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2017-08-10T00:08:19Z","updated_at":"2017-08-11T05:14:58Z","closed_at":"2017-08-11T05:14:58Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Expected behavior\r\nmethods should return null not NPE\r\n\r\n### Actual behavior\r\nthrows NPE\r\n\r\n### Steps to reproduce\r\nSend MQTT connect message, with a null password, and then call .password or .willMesage\r\nhttps://github.com/netty/netty/pull/6817\r\nThis is caused by the following change where null byte[] for these two fields is not being null handled.\r\n\r\nWork around is to use new methods and null check manually, but would be good to save random bugs to fix the changed logic in deprecated methods.\r\n\r\n      String password = connect.payload().passwordInBytes() == null ? null : new String(connect.payload().passwordInBytes(), CharsetUtil.UTF_8);\r\n      String willMessage = connect.payload().willMessageInBytes() == null ? null : new String(connect.payload().willMessageInBytes(), CharsetUtil.UTF_8);\r\n\r\n\r\n### Minimal yet complete reproducer code (or URL to code)\r\n\r\n### Netty version\r\n4.1.13\r\n\r\n### JVM version (e.g. `java -version`)\r\n\r\n### OS version (e.g. `uname -a`)","closed_by":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/netty/netty/issues/7076/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/netty/netty/issues/7076/timeline","performed_via_github_app":null,"state_reason":"completed"}