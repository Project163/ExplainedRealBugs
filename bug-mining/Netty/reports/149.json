{"url":"https://api.github.com/repos/netty/netty/issues/10051","repository_url":"https://api.github.com/repos/netty/netty","labels_url":"https://api.github.com/repos/netty/netty/issues/10051/labels{/name}","comments_url":"https://api.github.com/repos/netty/netty/issues/10051/comments","events_url":"https://api.github.com/repos/netty/netty/issues/10051/events","html_url":"https://github.com/netty/netty/issues/10051","id":568902418,"node_id":"MDU6SXNzdWU1Njg5MDI0MTg=","number":10051,"title":"Failure to run a service that uses a Netty library having built it with Graal native-image","user":{"login":"CremboC","id":880130,"node_id":"MDQ6VXNlcjg4MDEzMA==","avatar_url":"https://avatars.githubusercontent.com/u/880130?v=4","gravatar_id":"","url":"https://api.github.com/users/CremboC","html_url":"https://github.com/CremboC","followers_url":"https://api.github.com/users/CremboC/followers","following_url":"https://api.github.com/users/CremboC/following{/other_user}","gists_url":"https://api.github.com/users/CremboC/gists{/gist_id}","starred_url":"https://api.github.com/users/CremboC/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CremboC/subscriptions","organizations_url":"https://api.github.com/users/CremboC/orgs","repos_url":"https://api.github.com/users/CremboC/repos","events_url":"https://api.github.com/users/CremboC/events{/privacy}","received_events_url":"https://api.github.com/users/CremboC/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/netty/netty/milestones/227","html_url":"https://github.com/netty/netty/milestone/227","labels_url":"https://api.github.com/repos/netty/netty/milestones/227/labels","id":5636818,"node_id":"MDk6TWlsZXN0b25lNTYzNjgxOA==","number":227,"title":"4.1.52.Final","description":"","creator":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":68,"state":"closed","created_at":"2020-07-09T12:30:30Z","updated_at":"2020-09-08T14:00:48Z","due_on":null,"closed_at":"2020-09-08T14:00:48Z"},"comments":3,"created_at":"2020-02-21T11:33:21Z","updated_at":"2020-08-03T18:30:29Z","closed_at":"2020-08-03T17:49:07Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Expected behavior\r\nAbility to build and run a service using Netty with GraalVM [native-image](https://www.graalvm.org/docs/reference-manual/native-image/).\r\n\r\n### Actual behavior\r\nIt seems like Netty already has some support for GraalVM, but there still some issues. I can't find any reference to this error below, so maybe I'm doing something wrong! Any ideas would be greatly appreciated.\r\n\r\nFailure during runtime:\r\n```\r\ncom.oracle.svm.core.jdk.UnsupportedFeatureError: Unsupported method of Unsafe\r\n\tat com.oracle.svm.core.util.VMError.unsupportedFeature(VMError.java:101)\r\n\tat jdk.internal.misc.Unsafe.staticFieldOffset(Unsafe.java:230)\r\n\tat sun.misc.Unsafe.staticFieldOffset(Unsafe.java:662)\r\n\tat io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0$5.run(PlatformDependent0.java:281)\r\n\tat java.security.AccessController.doPrivileged(AccessController.java:81)\r\n\tat io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent0.<clinit>(PlatformDependent0.java:266)\r\n\tat com.oracle.svm.core.hub.ClassInitializationInfo.invokeClassInitializer(ClassInitializationInfo.java:350)\r\n\tat com.oracle.svm.core.hub.ClassInitializationInfo.initialize(ClassInitializationInfo.java:270)\r\n\tat java.lang.Class.ensureInitialized(DynamicHub.java:496)\r\n\tat io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent.isAndroid(PlatformDependent.java:272)\r\n\tat io.grpc.netty.shaded.io.netty.util.internal.PlatformDependent.<clinit>(PlatformDependent.java:92)\r\n\tat com.oracle.svm.core.hub.ClassInitializationInfo.invokeClassInitializer(ClassInitializationInfo.java:350)\r\n\tat com.oracle.svm.core.hub.ClassInitializationInfo.initialize(ClassInitializationInfo.java:270)\r\n\tat java.lang.Class.ensureInitialized(DynamicHub.java:496)\r\n\tat io.grpc.netty.shaded.io.netty.util.AsciiString.<init>(AsciiString.java:222)\r\n\tat io.grpc.netty.shaded.io.netty.util.AsciiString.<init>(AsciiString.java:209)\r\n\tat io.grpc.netty.shaded.io.netty.util.AsciiString.cached(AsciiString.java:1406)\r\n\tat io.grpc.netty.shaded.io.netty.util.AsciiString.<clinit>(AsciiString.java:47)\r\n\tat com.oracle.svm.core.hub.ClassInitializationInfo.invokeClassInitializer(ClassInitializationInfo.java:350)\r\n\tat com.oracle.svm.core.hub.ClassInitializationInfo.initialize(ClassInitializationInfo.java:270)\r\n\tat java.lang.Class.ensureInitialized(DynamicHub.java:496)\r\n\tat io.grpc.netty.shaded.io.grpc.netty.Utils.<clinit>(Utils.java:72)\r\n\tat com.oracle.svm.core.hub.ClassInitializationInfo.invokeClassInitializer(ClassInitializationInfo.java:350)\r\n\tat com.oracle.svm.core.hub.ClassInitializationInfo.initialize(ClassInitializationInfo.java:270)\r\n\tat java.lang.Class.ensureInitialized(DynamicHub.java:496)\r\n\tat io.grpc.netty.shaded.io.grpc.netty.NettyChannelBuilder.<clinit>(NettyChannelBuilder.java:74)\r\n\tat com.oracle.svm.core.hub.ClassInitializationInfo.invokeClassInitializer(ClassInitializationInfo.java:350)\r\n\tat com.oracle.svm.core.hub.ClassInitializationInfo.initialize(ClassInitializationInfo.java:270)\r\n\tat java.lang.Class.ensureInitialized(DynamicHub.java:496)\r\n\tat io.grpc.netty.shaded.io.grpc.netty.NettyChannelProvider.builderForAddress(NettyChannelProvider.java:37)\r\n\tat io.grpc.netty.shaded.io.grpc.netty.NettyChannelProvider.builderForAddress(NettyChannelProvider.java:23)\r\n\tat io.grpc.ManagedChannelBuilder.forAddress(ManagedChannelBuilder.java:39)\r\n\tat com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createSingleChannel(InstantiatingGrpcChannelProvider.java:269)\r\n\tat com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.access$1500(InstantiatingGrpcChannelProvider.java:71)\r\n\tat com.google.api.gax.grpc.InstantiatingGrpcChannelProvider$1.createSingleChannel(InstantiatingGrpcChannelProvider.java:202)\r\n\tat com.google.api.gax.grpc.ChannelPool.create(ChannelPool.java:72)\r\n\tat com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.createChannel(InstantiatingGrpcChannelProvider.java:209)\r\n\tat com.google.api.gax.grpc.InstantiatingGrpcChannelProvider.getTransportChannel(InstantiatingGrpcChannelProvider.java:192)\r\n\tat com.google.api.gax.rpc.ClientContext.create(ClientContext.java:155)\r\n\tat com.google.cloud.bigtable.data.v2.stub.EnhancedBigtableStub.create(EnhancedBigtableStub.java:163)\r\n\tat com.google.cloud.bigtable.data.v2.BigtableDataClient.create(BigtableDataClient.java:152)\r\n```\r\n\r\n### Steps to reproduce\r\nTry building a service that uses a library that uses Netty under the hood (in my particular example, `google-cloud-bigtable`).\r\n\r\n### Minimal yet complete reproducer code (or URL to code)\r\n\r\n### Netty version\r\nThe library uses a shaded version of Netty `grpc-netty-shaded`, but using the latest version `1.27.1`, which I'm pretty sure it's Netty 4.1.44+ (but I don't know how to verify).\r\n\r\n### JVM version (e.g. `java -version`)\r\nN/A\r\n\r\n### OS version (e.g. `uname -a`)\r\nmacOS Catalina\r\n","closed_by":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/netty/netty/issues/10051/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/netty/netty/issues/10051/timeline","performed_via_github_app":null,"state_reason":"completed"}