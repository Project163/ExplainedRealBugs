[{"id":4557823640,"node_id":"MDE3OlJlbmFtZWRUaXRsZUV2ZW50NDU1NzgyMzY0MA==","url":"https://api.github.com/repos/netty/netty/issues/events/4557823640","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2021-04-06T16:24:33Z","rename":{"from":"HttpPostMultipartRequestDecoder does not populate the buffer after being offered data","to":"HttpPostMultipartRequestDecoder may not add content to an existing upload after being offered data"},"performed_via_github_app":null},{"actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T16:25:12Z","updated_at":"2021-04-06T16:25:12Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/micronaut-projects/micronaut-core/issues/5104","repository_url":"https://api.github.com/repos/micronaut-projects/micronaut-core","labels_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/issues/5104/labels{/name}","comments_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/issues/5104/comments","events_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/issues/5104/events","html_url":"https://github.com/micronaut-projects/micronaut-core/pull/5104","id":829887280,"node_id":"MDExOlB1bGxSZXF1ZXN0NTkxNDgxNjcw","number":5104,"title":"Upgrade Netty to 4.1.63","user":{"login":"ilopmar","id":559192,"node_id":"MDQ6VXNlcjU1OTE5Mg==","avatar_url":"https://avatars.githubusercontent.com/u/559192?v=4","gravatar_id":"","url":"https://api.github.com/users/ilopmar","html_url":"https://github.com/ilopmar","followers_url":"https://api.github.com/users/ilopmar/followers","following_url":"https://api.github.com/users/ilopmar/following{/other_user}","gists_url":"https://api.github.com/users/ilopmar/gists{/gist_id}","starred_url":"https://api.github.com/users/ilopmar/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ilopmar/subscriptions","organizations_url":"https://api.github.com/users/ilopmar/orgs","repos_url":"https://api.github.com/users/ilopmar/repos","events_url":"https://api.github.com/users/ilopmar/events{/privacy}","received_events_url":"https://api.github.com/users/ilopmar/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/micronaut-projects/micronaut-core/milestones/77","html_url":"https://github.com/micronaut-projects/micronaut-core/milestone/77","labels_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/milestones/77/labels","id":6613425,"node_id":"MDk6TWlsZXN0b25lNjYxMzQyNQ==","number":77,"title":"2.4.3","description":null,"creator":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":17,"state":"closed","created_at":"2021-03-31T18:38:38Z","updated_at":"2021-04-26T17:20:57Z","due_on":null,"closed_at":"2021-04-26T17:20:57Z"},"comments":4,"created_at":"2021-03-12T08:42:47Z","updated_at":"2021-04-19T16:15:13Z","closed_at":"2021-04-19T16:15:13Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":124230204,"node_id":"MDEwOlJlcG9zaXRvcnkxMjQyMzAyMDQ=","name":"micronaut-core","full_name":"micronaut-projects/micronaut-core","private":false,"owner":{"login":"micronaut-projects","id":36880643,"node_id":"MDEyOk9yZ2FuaXphdGlvbjM2ODgwNjQz","avatar_url":"https://avatars.githubusercontent.com/u/36880643?v=4","gravatar_id":"","url":"https://api.github.com/users/micronaut-projects","html_url":"https://github.com/micronaut-projects","followers_url":"https://api.github.com/users/micronaut-projects/followers","following_url":"https://api.github.com/users/micronaut-projects/following{/other_user}","gists_url":"https://api.github.com/users/micronaut-projects/gists{/gist_id}","starred_url":"https://api.github.com/users/micronaut-projects/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/micronaut-projects/subscriptions","organizations_url":"https://api.github.com/users/micronaut-projects/orgs","repos_url":"https://api.github.com/users/micronaut-projects/repos","events_url":"https://api.github.com/users/micronaut-projects/events{/privacy}","received_events_url":"https://api.github.com/users/micronaut-projects/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/micronaut-projects/micronaut-core","description":"Micronaut Application Framework","fork":false,"url":"https://api.github.com/repos/micronaut-projects/micronaut-core","forks_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/forks","keys_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/keys{/key_id}","collaborators_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/teams","hooks_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/hooks","issue_events_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/issues/events{/number}","events_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/events","assignees_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/assignees{/user}","branches_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/branches{/branch}","tags_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/tags","blobs_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/git/refs{/sha}","trees_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/git/trees{/sha}","statuses_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/statuses/{sha}","languages_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/languages","stargazers_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/stargazers","contributors_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/contributors","subscribers_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/subscribers","subscription_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/subscription","commits_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/commits{/sha}","git_commits_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/git/commits{/sha}","comments_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/comments{/number}","issue_comment_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/issues/comments{/number}","contents_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/contents/{+path}","compare_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/compare/{base}...{head}","merges_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/merges","archive_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/downloads","issues_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/issues{/number}","pulls_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/pulls{/number}","milestones_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/milestones{/number}","notifications_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/labels{/name}","releases_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/releases{/id}","deployments_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/deployments","created_at":"2018-03-07T12:05:08Z","updated_at":"2025-11-10T02:24:27Z","pushed_at":"2025-11-09T22:35:09Z","git_url":"git://github.com/micronaut-projects/micronaut-core.git","ssh_url":"git@github.com:micronaut-projects/micronaut-core.git","clone_url":"https://github.com/micronaut-projects/micronaut-core.git","svn_url":"https://github.com/micronaut-projects/micronaut-core","homepage":"http://micronaut.io","size":109602,"stargazers_count":6342,"watchers_count":6342,"language":"Java","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":true,"has_discussions":true,"forks_count":1140,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":784,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["cloudnative","groovy","java","kotlin","microservices","serverless"],"visibility":"public","forks":1140,"open_issues":784,"watchers":6342,"default_branch":"5.0.x","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/micronaut-projects/micronaut-core/pulls/5104","html_url":"https://github.com/micronaut-projects/micronaut-core/pull/5104","diff_url":"https://github.com/micronaut-projects/micronaut-core/pull/5104.diff","patch_url":"https://github.com/micronaut-projects/micronaut-core/pull/5104.patch","merged_at":"2021-04-19T16:15:13Z"},"body":"","reactions":{"url":"https://api.github.com/repos/micronaut-projects/micronaut-core/issues/5104/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/micronaut-projects/micronaut-core/issues/5104/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814289022","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814289022","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814289022,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDI4OTAyMg==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T17:13:39Z","updated_at":"2021-04-06T17:13:39Z","body":"@jameskleeh \r\nFrom the beginning: https://github.com/fredericBregier/netty/blob/6daeb0cc51d8689805c1a657e61d395450afec47/codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostMultipartRequestDecoder.java#L1160\r\n\r\nIt tries to find out the `delimiter` in the full buffer (multiple chunks up to now):\r\n- if `posDelimiter<0`, the `delimiter` is not found. So the upload cannot be finalized, but maybe we can add some bytes already.\r\n  - So, then it tries to search for CRLF or LF\r\n  - If not found (`posDelimiter<0`), the buffer can be appened fully (since the `CRLF/LF + delimiter` is not there)\r\n  - If found (`posDelimiter>0`), only up to CRLF/LF (without) can be appened (the `delimiter` could be just after in the next chunk)\r\n  - If `posDelimiter==0`, the CRLF/LF is found but at position 0, so nothing can be added (the `delimiter` could be just after in the next chunk)\r\n  - It returns false in all cases since delimiter is not found, so the next chunk will be added to the current buffer to try to find out the `CRLF/LF + delimiter`.\r\n- If `posDelimiter >= 0`, it means it found the `CRLF/LF + delimiter`, so it finalizes the upload.\r\n\r\n\r\nSo I see nothing wrong there.\r\nCould you propose a reproducer with a simpler code ? It is quite too heavy to check in this huge git.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814289022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4558062062,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU1ODA2MjA2Mg==","url":"https://api.github.com/repos/netty/netty/issues/events/4558062062","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-06T17:13:39Z","performed_via_github_app":null},{"id":4558062066,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1NTgwNjIwNjY=","url":"https://api.github.com/repos/netty/netty/issues/events/4558062066","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-06T17:13:39Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814293212","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814293212","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814293212,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDI5MzIxMg==","user":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T17:20:03Z","updated_at":"2021-04-06T17:20:03Z","body":"@fredericBregier I don't have confidence I could create something outside of Micronaut to reproduce the issue. I'm not sure what you mean by \"It is quite too heavy to check in this huge git\". I clone and run the tests in that codebase everyday so surely you can as well. \r\n\r\nI don't understand the importance of CRLF/LF in this context so I really can't comment on whether it makes sense or not. All I can say is that it worked correctly prior to this change.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814293212/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4558091376,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU1ODA5MTM3Ng==","url":"https://api.github.com/repos/netty/netty/issues/events/4558091376","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-06T17:20:04Z","performed_via_github_app":null},{"id":4558091385,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1NTgwOTEzODU=","url":"https://api.github.com/repos/netty/netty/issues/events/4558091385","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-06T17:20:04Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814297282","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814297282","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814297282,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDI5NzI4Mg==","user":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T17:26:10Z","updated_at":"2021-04-06T17:26:10Z","body":"I verified that LF is found at position 0, however your claim of \"nothing can be added (the delimiter could be just after in the next chunk)\" seems invalid to me. Can the contents of a file not contain line feeds? How can you assume the delimiter is coming after a LF? Is that in the RFC for multipart requests somewhere?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814297282/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814364631","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814364631","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814364631,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDM2NDYzMQ==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T18:57:43Z","updated_at":"2021-04-06T18:57:43Z","body":"@jameskleeh Hi, your code is quite heavy, so difficult to search for the reason behind and to be able to reproduce and fixing it.\r\n\r\nSo the reason if you have a reproducer, with simple code (one client and one server code), then we can extract a reproducer and fix it.\r\n\r\nOn the RFC part, on multipart side, each part is separated by a CRLF or LF following by the delimiter string.\r\nSo this method objective is to find out the first occurence of the CRLF/LF + delimiter in the buffer. Once found, it has found the final delimiter for the current part. And then it continues to the next part.\r\n\r\nOf course a part can contains a CRLF/LF. But if this is found, there is a risk such that the next bytes are the delimiter but not yet there (due to HTTP chunk by chunk reception).\r\nNote that if a file contains exactly the CRLF/LF+delimiter string, it can be considered as a end of a part. This is of course not wanted but that's how is the RFC.\r\n\r\nMaybe your issue is that the upload is beginning by a CRLF/LF, but not fitting within one HTTP chunk, so the delimiter will come in a later chunk. If this is that, then, once all chunks concerning this upload will arrive on the server side, it will find out the delimite preceeded by CRLF/LF, and therefore ending the part (the upload).\r\n\r\nI believe we could try to seak for the \"last\" CRLF/LF, not the first one when no delimiter is found. It might be better from a memory point of view, but it will not change the logic.\r\n","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814364631/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4558561179,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU1ODU2MTE3OQ==","url":"https://api.github.com/repos/netty/netty/issues/events/4558561179","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-06T18:57:43Z","performed_via_github_app":null},{"id":4558561185,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1NTg1NjExODU=","url":"https://api.github.com/repos/netty/netty/issues/events/4558561185","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-06T18:57:43Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814372191","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814372191","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814372191,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDM3MjE5MQ==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T19:10:22Z","updated_at":"2021-04-06T19:11:34Z","body":"The idea would be to change:\r\nhttps://github.com/netty/netty/blob/1529ef1794e0a6654fa4334fd979b769d6940e61/codec-http/src/main/java/io/netty/handler/codec/http/multipart/HttpPostMultipartRequestDecoder.java#L1163\r\n\r\n      posDelimiter = HttpPostBodyUtil.findLineBreak(undecodedChunk, startReaderIndex);\r\n\r\nby something that will search for \"last\" CRLF/LF: (not yet implemented)\r\n\r\n     posDelimiter = HttpPostBodyUtil.findLastLineBreak(undecodedChunk, startReaderIndex);\r\n\r\nWe might even check if the new posDelimiter has more space than delimiter size, in order to ensure that the delimiter is not splitten across 2 HTTP chunks as:\r\n\r\n- HTTP Chunk 1\r\n\r\n       file body example line 1CRLFThen line 2CRLF--del\r\n\r\nIt might takes `file body example line 1CRLFThen line 2` as first content for file.\r\n\r\n- HTTP Chunk 2\r\n\r\n       imiter\r\n\r\nThe delimiter is then found fully and the file is filled with a 0 length buffer.\r\nTherefore, the file contains `file body example line 1CRLFThen line 2`.\r\n\r\nCurrently, on first step, it will gives: `file body example line 1`, then after Chunk 2: ``file body example line 1CRLFThen line 2`\r\n\r\n\r\nBut not that this will not change the behaviour: if there is never a CRLF/LF + delimiter, then the part is never ending. The difference is that, if there is a CRLF/LF in the middle (or start) of the file, it will however populate the file behind, but still waiting to find out the CRLF/LF+delimiter.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814372191/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814373651","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814373651","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814373651,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDM3MzY1MQ==","user":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T19:12:51Z","updated_at":"2021-04-06T19:12:51Z","body":"@fredericBregier I'd be happy to test any local branch with the changes","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814373651/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4558622912,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU1ODYyMjkxMg==","url":"https://api.github.com/repos/netty/netty/issues/events/4558622912","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-06T19:12:51Z","performed_via_github_app":null},{"id":4558622916,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1NTg2MjI5MTY=","url":"https://api.github.com/repos/netty/netty/issues/events/4558622916","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-06T19:12:51Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814376108","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814376108","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814376108,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDM3NjEwOA==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T19:17:04Z","updated_at":"2021-04-06T19:17:04Z","body":"OK, I will try to make it, but I'm quite sure it will not change anything since I do not have a simple reproducer test code to test it.\r\nBut if it does the trick, well, I would be surprised since it seems to me not a fix but an improvement.\r\n\r\nIn other words, it seems your upload does not end up with a CRLF/LF + delimiter... ? But as I don't know the code, I cannot say for sure of course.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814376108/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814378713","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814378713","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814378713,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDM3ODcxMw==","user":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T19:21:17Z","updated_at":"2021-04-06T19:21:17Z","body":"@fredericBregier I'm not quite sure but its not getting to the end of the file. I'm uploading 15 megabytes and I'm seeing this behavior on the second chunk of data being received. I'm fairly confident all of the data in the buffer when `posDelimiter` is 0 is all data for the file and does not contain any delimiters or anything specific to HTTP","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814378713/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4558657115,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU1ODY1NzExNQ==","url":"https://api.github.com/repos/netty/netty/issues/events/4558657115","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-06T19:21:18Z","performed_via_github_app":null},{"id":4558657120,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1NTg2NTcxMjA=","url":"https://api.github.com/repos/netty/netty/issues/events/4558657120","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-06T19:21:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814379278","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814379278","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814379278,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDM3OTI3OA==","user":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T19:22:12Z","updated_at":"2021-04-06T19:22:12Z","body":"If you'd like to do a screen share I'd be glad to show you","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814379278/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814404083","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814404083","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814404083,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDQwNDA4Mw==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T20:04:26Z","updated_at":"2021-04-06T20:04:55Z","body":"Well, could you at least point me out directly to the code:\r\n- client side (I suppose the test itself)\r\n- server side\r\nI may try to do a reproducer such that I understand where the problem is. My previous point seems to me only an optimisation.\r\nI would be glad to help to fix this out.\r\n\r\nOf course, I could donwload all your project and following your original guidance, but perhaps I could read the code itself first ?\r\nWhen I go to your github repo, I found out it is so huge, that it was difficult for me to find out where it is...\r\n\r\nFor the screen sharing, might be useful next, if I don't get it ;-)","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814404083/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814408503","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814408503","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814408503,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDQwODUwMw==","user":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-06T20:11:44Z","updated_at":"2021-04-06T20:12:12Z","body":"@fredericBregier Sure\r\n\r\nClient\r\n--------\r\nHere is the client that is sending the data\r\nhttps://github.com/micronaut-projects/micronaut-core/blob/upgrade-netty/test-suite/src/test/groovy/io/micronaut/upload/StreamUploadSpec.groovy#L552\r\nYou can see its a random set of bytes 15mb long\r\n\r\nHere is where the Netty specific multipart stuff is created from our API\r\nhttps://github.com/micronaut-projects/micronaut-core/blob/upgrade-netty/http-client/src/main/java/io/micronaut/http/client/netty/DefaultHttpClient.java#L1525\r\n\r\nServer\r\n--------\r\nHere is where the data is offered to the decoder\r\nhttps://github.com/micronaut-projects/micronaut-core/blob/upgrade-netty/http-server-netty/src/main/java/io/micronaut/http/server/netty/FormDataHttpContentProcessor.java#L113\r\n\r\nIn the second invocation of the `onData` method above, the `currentPartialHttpData()` returned from the decoder will have a null buffer. See https://github.com/micronaut-projects/micronaut-core/blob/upgrade-netty/http-server-netty/src/main/java/io/micronaut/http/server/netty/FormDataHttpContentProcessor.java#L134\r\n\r\nThe buffer is null because the data previously received has already been read and released and no new data was added to the upload.\r\n\r\nThe data is released via https://github.com/micronaut-projects/micronaut-core/blob/upgrade-netty/http-server-netty/src/main/java/io/micronaut/http/server/netty/multipart/NettyStreamingFileUpload.java#L136\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814408503/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4558860638,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDU1ODg2MDYzOA==","url":"https://api.github.com/repos/netty/netty/issues/events/4558860638","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-04-06T20:11:44Z","performed_via_github_app":null},{"id":4558860646,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQ1NTg4NjA2NDY=","url":"https://api.github.com/repos/netty/netty/issues/events/4558860646","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-04-06T20:11:44Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814594584","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814594584","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814594584,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDU5NDU4NA==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-07T04:40:32Z","updated_at":"2021-04-07T04:40:32Z","body":"OK, I think I got it.\r\nFor the current Http Chunk, once `while (postRequestDecoder.hasNext())` is false, it does not mean it has nothing, it could be in the middle of creation of a new `HttpData`. It just means that there is not enough data to create a new one yet.\r\n\r\nSo I believe that maybe https://github.com/micronaut-projects/micronaut-core/blob/e67ca50cf2a778cb6c7354b1ecd2c7fe7d2910ed/http-server-netty/src/main/java/io/micronaut/http/server/netty/FormDataHttpContentProcessor.java#L134 is wrong. Current `HttpData` might be null (empty or not yet any new `HttpData`).\r\n\r\nFor instance, let say the last chunk was ending like this:\r\n\r\n       my previous Http DataCRLF--delimiterCRLFcontent-disposition: form-data; na\r\n\r\nSuch that the next Part from multipart is not yet available to know what it is.\r\nTherefore, the previous one is ready (`hasNext()` is true once, but not twice).\r\nThe second one is not yet created, so no new `HttpData` yet.\r\n\r\nAnother example:\r\n\r\n       my previous Http DataCRLF--delimiterCRLFcontent-disposition: form-data; name=\"field1\"CRLF\r\n\r\nThen the second one `HttpData` is created but empty (no data yet).\r\n\r\nI don't know why you are adding like this `messages.add(currentPartialHttpData);` on line 134-135, because for me, it has no meaning. As long as the decoder is not giving you something new through `postRequestDecoder.hasNext()`, you don't have to care about new `HttpData`, the decoder will keep the already available data inside and will give you as soon as it has all the next `HttpData`.\r\n\r\nI'm on my way however to try to improve the decoder part to opimize it, but I feel like you are not using correctly the decoder however.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814594584/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814595444","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814595444","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814595444,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDU5NTQ0NA==","user":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-07T04:43:23Z","updated_at":"2021-04-07T04:49:36Z","body":"> I don't know why you are adding like this messages.add(currentPartialHttpData); on line 134-135, because for me, it has no meaning. As long as the decoder is not giving you something new through postRequestDecoder.hasNext(), you don't have to care about new HttpData, the decoder will keep the already available data inside and will give you as soon as it has all the next HttpData.\r\n\r\nBecause we need to notify the downstream that new data is available on the upload. Users can read and release pieces of uploads as they become available. It is often the case we don't want to buffer any data beyond a single chunk\r\n\r\n> So I believe that maybe https://github.com/micronaut-projects/micronaut-core/blob/e67ca50cf2a778cb6c7354b1ecd2c7fe7d2910ed/http-server-netty/src/main/java/io/micronaut/http/server/netty/FormDataHttpContentProcessor.java#L134 is wrong. Current HttpData might be null (empty or not yet any new HttpData).\r\n\r\nIf it's null it wouldn't be passed through, so I don't think its wrong. This code has been in place for some time and working well\r\n\r\n> Then the second one HttpData is created but empty (no data yet).\r\n\r\nIt's possible this is a valid case and we need to handle it, however I don't think its relevant to this issue","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814595444/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814596181","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814596181","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814596181,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDU5NjE4MQ==","user":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-07T04:45:40Z","updated_at":"2021-04-07T04:45:40Z","body":"You can checkout the 2.4.x branch of micronaut-core to see the difference in behavior. In Netty 4.1.59 the partial upload is populated with a buffer on the second invocation and with 4.1.60+ it is not.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814596181/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814600903","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814600903","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814600903,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDYwMDkwMw==","user":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-07T04:59:08Z","updated_at":"2021-04-07T04:59:08Z","body":"Yes I understood. So the \"API behavior\" change. But what I'm saying, is that the goal of the decoder is not to give you a \"partial HttpData\" but a full one when ready. You have made assumption which are internal operations.\r\nIt is almost as a Queue: when the Queue has no more yet element, it says hasNext is false. You have to wait to see the next available element when it is ready.\r\nThere you assume the Queue will say to you it has \"almost\" something. It implementation dependent.\r\n\r\nI will try to make the current API to \"looks like\" what is was before, but my feeling IMHO is that you rely too much on the underlying implementation and not the API contract (which is not the implementation).","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814600903/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"fredericBregier","id":477131,"node_id":"MDQ6VXNlcjQ3NzEzMQ==","avatar_url":"https://avatars.githubusercontent.com/u/477131?v=4","gravatar_id":"","url":"https://api.github.com/users/fredericBregier","html_url":"https://github.com/fredericBregier","followers_url":"https://api.github.com/users/fredericBregier/followers","following_url":"https://api.github.com/users/fredericBregier/following{/other_user}","gists_url":"https://api.github.com/users/fredericBregier/gists{/gist_id}","starred_url":"https://api.github.com/users/fredericBregier/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fredericBregier/subscriptions","organizations_url":"https://api.github.com/users/fredericBregier/orgs","repos_url":"https://api.github.com/users/fredericBregier/repos","events_url":"https://api.github.com/users/fredericBregier/events{/privacy}","received_events_url":"https://api.github.com/users/fredericBregier/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/814601947","html_url":"https://github.com/netty/netty/issues/11143#issuecomment-814601947","issue_url":"https://api.github.com/repos/netty/netty/issues/11143","id":814601947,"node_id":"MDEyOklzc3VlQ29tbWVudDgxNDYwMTk0Nw==","user":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-04-07T05:01:58Z","updated_at":"2021-04-07T05:01:58Z","body":">But what I'm saying, is that the goal of the decoder is not to give you a \"partial HttpData\" but a full one when ready.\r\n\r\nIf that is the case then why is there a method to retrieve the partial data?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/814601947/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"jameskleeh","id":1583789,"node_id":"MDQ6VXNlcjE1ODM3ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1583789?v=4","gravatar_id":"","url":"https://api.github.com/users/jameskleeh","html_url":"https://github.com/jameskleeh","followers_url":"https://api.github.com/users/jameskleeh/followers","following_url":"https://api.github.com/users/jameskleeh/following{/other_user}","gists_url":"https://api.github.com/users/jameskleeh/gists{/gist_id}","starred_url":"https://api.github.com/users/jameskleeh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jameskleeh/subscriptions","organizations_url":"https://api.github.com/users/jameskleeh/orgs","repos_url":"https://api.github.com/users/jameskleeh/repos","events_url":"https://api.github.com/users/jameskleeh/events{/privacy}","received_events_url":"https://api.github.com/users/jameskleeh/received_events","type":"User","user_view_type":"public","site_admin":false}}]