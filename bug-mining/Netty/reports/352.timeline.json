[{"id":18508970655,"node_id":"LE_lADOABA-c86_TpktzwAAAARPOHqf","url":"https://api.github.com/repos/netty/netty/issues/events/18508970655","actor":{"login":"franz1981","id":13125299,"node_id":"MDQ6VXNlcjEzMTI1Mjk5","avatar_url":"https://avatars.githubusercontent.com/u/13125299?v=4","gravatar_id":"","url":"https://api.github.com/users/franz1981","html_url":"https://github.com/franz1981","followers_url":"https://api.github.com/users/franz1981/followers","following_url":"https://api.github.com/users/franz1981/following{/other_user}","gists_url":"https://api.github.com/users/franz1981/gists{/gist_id}","starred_url":"https://api.github.com/users/franz1981/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/franz1981/subscriptions","organizations_url":"https://api.github.com/users/franz1981/orgs","repos_url":"https://api.github.com/users/franz1981/repos","events_url":"https://api.github.com/users/franz1981/events{/privacy}","received_events_url":"https://api.github.com/users/franz1981/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2025-07-07T16:21:53Z","label":{"name":"improvement","color":"0052cc"},"performed_via_github_app":null},{"id":18508970666,"node_id":"LE_lADOABA-c86_TpktzwAAAARPOHqq","url":"https://api.github.com/repos/netty/netty/issues/events/18508970666","actor":{"login":"franz1981","id":13125299,"node_id":"MDQ6VXNlcjEzMTI1Mjk5","avatar_url":"https://avatars.githubusercontent.com/u/13125299?v=4","gravatar_id":"","url":"https://api.github.com/users/franz1981","html_url":"https://github.com/franz1981","followers_url":"https://api.github.com/users/franz1981/followers","following_url":"https://api.github.com/users/franz1981/following{/other_user}","gists_url":"https://api.github.com/users/franz1981/gists{/gist_id}","starred_url":"https://api.github.com/users/franz1981/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/franz1981/subscriptions","organizations_url":"https://api.github.com/users/franz1981/orgs","repos_url":"https://api.github.com/users/franz1981/repos","events_url":"https://api.github.com/users/franz1981/events{/privacy}","received_events_url":"https://api.github.com/users/franz1981/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2025-07-07T16:21:53Z","label":{"name":"loom","color":"F400B8"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/3045828618","html_url":"https://github.com/netty/netty/issues/15449#issuecomment-3045828618","issue_url":"https://api.github.com/repos/netty/netty/issues/15449","id":3045828618,"node_id":"IC_kwDOABA-c861i6gK","user":{"login":"franz1981","id":13125299,"node_id":"MDQ6VXNlcjEzMTI1Mjk5","avatar_url":"https://avatars.githubusercontent.com/u/13125299?v=4","gravatar_id":"","url":"https://api.github.com/users/franz1981","html_url":"https://github.com/franz1981","followers_url":"https://api.github.com/users/franz1981/followers","following_url":"https://api.github.com/users/franz1981/following{/other_user}","gists_url":"https://api.github.com/users/franz1981/gists{/gist_id}","starred_url":"https://api.github.com/users/franz1981/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/franz1981/subscriptions","organizations_url":"https://api.github.com/users/franz1981/orgs","repos_url":"https://api.github.com/users/franz1981/repos","events_url":"https://api.github.com/users/franz1981/events{/privacy}","received_events_url":"https://api.github.com/users/franz1981/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-07T16:27:30Z","updated_at":"2025-07-07T16:27:30Z","body":"@chrisvest @yawkat FYI","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/3045828618/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"franz1981","id":13125299,"node_id":"MDQ6VXNlcjEzMTI1Mjk5","avatar_url":"https://avatars.githubusercontent.com/u/13125299?v=4","gravatar_id":"","url":"https://api.github.com/users/franz1981","html_url":"https://github.com/franz1981","followers_url":"https://api.github.com/users/franz1981/followers","following_url":"https://api.github.com/users/franz1981/following{/other_user}","gists_url":"https://api.github.com/users/franz1981/gists{/gist_id}","starred_url":"https://api.github.com/users/franz1981/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/franz1981/subscriptions","organizations_url":"https://api.github.com/users/franz1981/orgs","repos_url":"https://api.github.com/users/franz1981/repos","events_url":"https://api.github.com/users/franz1981/events{/privacy}","received_events_url":"https://api.github.com/users/franz1981/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":18509071659,"node_id":"MEE_lADOABA-c86_TpktzwAAAARPOgUr","url":"https://api.github.com/repos/netty/netty/issues/events/18509071659","actor":{"login":"chrisvest","id":7993,"node_id":"MDQ6VXNlcjc5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/7993?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisvest","html_url":"https://github.com/chrisvest","followers_url":"https://api.github.com/users/chrisvest/followers","following_url":"https://api.github.com/users/chrisvest/following{/other_user}","gists_url":"https://api.github.com/users/chrisvest/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisvest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisvest/subscriptions","organizations_url":"https://api.github.com/users/chrisvest/orgs","repos_url":"https://api.github.com/users/chrisvest/repos","events_url":"https://api.github.com/users/chrisvest/events{/privacy}","received_events_url":"https://api.github.com/users/chrisvest/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2025-07-07T16:27:32Z","performed_via_github_app":null},{"id":18509071668,"node_id":"SE_lADOABA-c86_TpktzwAAAARPOgU0","url":"https://api.github.com/repos/netty/netty/issues/events/18509071668","actor":{"login":"chrisvest","id":7993,"node_id":"MDQ6VXNlcjc5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/7993?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisvest","html_url":"https://github.com/chrisvest","followers_url":"https://api.github.com/users/chrisvest/followers","following_url":"https://api.github.com/users/chrisvest/following{/other_user}","gists_url":"https://api.github.com/users/chrisvest/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisvest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisvest/subscriptions","organizations_url":"https://api.github.com/users/chrisvest/orgs","repos_url":"https://api.github.com/users/chrisvest/repos","events_url":"https://api.github.com/users/chrisvest/events{/privacy}","received_events_url":"https://api.github.com/users/chrisvest/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-07-07T16:27:32Z","performed_via_github_app":null},{"id":18509071686,"node_id":"MEE_lADOABA-c86_TpktzwAAAARPOgVG","url":"https://api.github.com/repos/netty/netty/issues/events/18509071686","actor":{"login":"yawkat","id":2395297,"node_id":"MDQ6VXNlcjIzOTUyOTc=","avatar_url":"https://avatars.githubusercontent.com/u/2395297?v=4","gravatar_id":"","url":"https://api.github.com/users/yawkat","html_url":"https://github.com/yawkat","followers_url":"https://api.github.com/users/yawkat/followers","following_url":"https://api.github.com/users/yawkat/following{/other_user}","gists_url":"https://api.github.com/users/yawkat/gists{/gist_id}","starred_url":"https://api.github.com/users/yawkat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yawkat/subscriptions","organizations_url":"https://api.github.com/users/yawkat/orgs","repos_url":"https://api.github.com/users/yawkat/repos","events_url":"https://api.github.com/users/yawkat/events{/privacy}","received_events_url":"https://api.github.com/users/yawkat/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2025-07-07T16:27:32Z","performed_via_github_app":null},{"id":18509071708,"node_id":"SE_lADOABA-c86_TpktzwAAAARPOgVc","url":"https://api.github.com/repos/netty/netty/issues/events/18509071708","actor":{"login":"yawkat","id":2395297,"node_id":"MDQ6VXNlcjIzOTUyOTc=","avatar_url":"https://avatars.githubusercontent.com/u/2395297?v=4","gravatar_id":"","url":"https://api.github.com/users/yawkat","html_url":"https://github.com/yawkat","followers_url":"https://api.github.com/users/yawkat/followers","following_url":"https://api.github.com/users/yawkat/following{/other_user}","gists_url":"https://api.github.com/users/yawkat/gists{/gist_id}","starred_url":"https://api.github.com/users/yawkat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yawkat/subscriptions","organizations_url":"https://api.github.com/users/yawkat/orgs","repos_url":"https://api.github.com/users/yawkat/repos","events_url":"https://api.github.com/users/yawkat/events{/privacy}","received_events_url":"https://api.github.com/users/yawkat/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-07-07T16:27:32Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/3046571414","html_url":"https://github.com/netty/netty/issues/15449#issuecomment-3046571414","issue_url":"https://api.github.com/repos/netty/netty/issues/15449","id":3046571414,"node_id":"IC_kwDOABA-c861lv2W","user":{"login":"chrisvest","id":7993,"node_id":"MDQ6VXNlcjc5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/7993?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisvest","html_url":"https://github.com/chrisvest","followers_url":"https://api.github.com/users/chrisvest/followers","following_url":"https://api.github.com/users/chrisvest/following{/other_user}","gists_url":"https://api.github.com/users/chrisvest/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisvest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisvest/subscriptions","organizations_url":"https://api.github.com/users/chrisvest/orgs","repos_url":"https://api.github.com/users/chrisvest/repos","events_url":"https://api.github.com/users/chrisvest/events{/privacy}","received_events_url":"https://api.github.com/users/chrisvest/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-07T21:28:31Z","updated_at":"2025-07-07T21:28:31Z","body":"With virtual threads, there may be thousands of threads, so I'm not sure about the scalability of this. The current copy-on-write sorted array is also kind of questionable, though. Some kind of hash set that can spread the concurrent accesses and updates would probably be beneficial, I agree.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/3046571414/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chrisvest","id":7993,"node_id":"MDQ6VXNlcjc5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/7993?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisvest","html_url":"https://github.com/chrisvest","followers_url":"https://api.github.com/users/chrisvest/followers","following_url":"https://api.github.com/users/chrisvest/following{/other_user}","gists_url":"https://api.github.com/users/chrisvest/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisvest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisvest/subscriptions","organizations_url":"https://api.github.com/users/chrisvest/orgs","repos_url":"https://api.github.com/users/chrisvest/repos","events_url":"https://api.github.com/users/chrisvest/events{/privacy}","received_events_url":"https://api.github.com/users/chrisvest/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/netty/netty/issues/comments/3046574835","html_url":"https://github.com/netty/netty/issues/15449#issuecomment-3046574835","issue_url":"https://api.github.com/repos/netty/netty/issues/15449","id":3046574835,"node_id":"IC_kwDOABA-c861lwrz","user":{"login":"franz1981","id":13125299,"node_id":"MDQ6VXNlcjEzMTI1Mjk5","avatar_url":"https://avatars.githubusercontent.com/u/13125299?v=4","gravatar_id":"","url":"https://api.github.com/users/franz1981","html_url":"https://github.com/franz1981","followers_url":"https://api.github.com/users/franz1981/followers","following_url":"https://api.github.com/users/franz1981/following{/other_user}","gists_url":"https://api.github.com/users/franz1981/gists{/gist_id}","starred_url":"https://api.github.com/users/franz1981/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/franz1981/subscriptions","organizations_url":"https://api.github.com/users/franz1981/orgs","repos_url":"https://api.github.com/users/franz1981/repos","events_url":"https://api.github.com/users/franz1981/events{/privacy}","received_events_url":"https://api.github.com/users/franz1981/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-07T21:30:20Z","updated_at":"2025-07-07T21:30:20Z","body":"@chrisvest I was still expecting the `long` and `array`s of thread ids to be (both in one go) copy-on-write; I forgot to mention it. The registration of thread ids is supposed to be a slow path already","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/3046574835/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"franz1981","id":13125299,"node_id":"MDQ6VXNlcjEzMTI1Mjk5","avatar_url":"https://avatars.githubusercontent.com/u/13125299?v=4","gravatar_id":"","url":"https://api.github.com/users/franz1981","html_url":"https://github.com/franz1981","followers_url":"https://api.github.com/users/franz1981/followers","following_url":"https://api.github.com/users/franz1981/following{/other_user}","gists_url":"https://api.github.com/users/franz1981/gists{/gist_id}","starred_url":"https://api.github.com/users/franz1981/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/franz1981/subscriptions","organizations_url":"https://api.github.com/users/franz1981/orgs","repos_url":"https://api.github.com/users/franz1981/repos","events_url":"https://api.github.com/users/franz1981/events{/privacy}","received_events_url":"https://api.github.com/users/franz1981/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":18513128537,"node_id":"MEE_lADOABA-c86_TpktzwAAAARPd-xZ","url":"https://api.github.com/repos/netty/netty/issues/events/18513128537","actor":{"login":"chrisvest","id":7993,"node_id":"MDQ6VXNlcjc5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/7993?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisvest","html_url":"https://github.com/chrisvest","followers_url":"https://api.github.com/users/chrisvest/followers","following_url":"https://api.github.com/users/chrisvest/following{/other_user}","gists_url":"https://api.github.com/users/chrisvest/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisvest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisvest/subscriptions","organizations_url":"https://api.github.com/users/chrisvest/orgs","repos_url":"https://api.github.com/users/chrisvest/repos","events_url":"https://api.github.com/users/chrisvest/events{/privacy}","received_events_url":"https://api.github.com/users/chrisvest/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2025-07-07T21:30:21Z","performed_via_github_app":null},{"id":18513128565,"node_id":"SE_lADOABA-c86_TpktzwAAAARPd-x1","url":"https://api.github.com/repos/netty/netty/issues/events/18513128565","actor":{"login":"chrisvest","id":7993,"node_id":"MDQ6VXNlcjc5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/7993?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisvest","html_url":"https://github.com/chrisvest","followers_url":"https://api.github.com/users/chrisvest/followers","following_url":"https://api.github.com/users/chrisvest/following{/other_user}","gists_url":"https://api.github.com/users/chrisvest/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisvest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisvest/subscriptions","organizations_url":"https://api.github.com/users/chrisvest/orgs","repos_url":"https://api.github.com/users/chrisvest/repos","events_url":"https://api.github.com/users/chrisvest/events{/privacy}","received_events_url":"https://api.github.com/users/chrisvest/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-07-07T21:30:21Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/3046599492","html_url":"https://github.com/netty/netty/issues/15449#issuecomment-3046599492","issue_url":"https://api.github.com/repos/netty/netty/issues/15449","id":3046599492,"node_id":"IC_kwDOABA-c861l2tE","user":{"login":"chrisvest","id":7993,"node_id":"MDQ6VXNlcjc5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/7993?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisvest","html_url":"https://github.com/chrisvest","followers_url":"https://api.github.com/users/chrisvest/followers","following_url":"https://api.github.com/users/chrisvest/following{/other_user}","gists_url":"https://api.github.com/users/chrisvest/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisvest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisvest/subscriptions","organizations_url":"https://api.github.com/users/chrisvest/orgs","repos_url":"https://api.github.com/users/chrisvest/repos","events_url":"https://api.github.com/users/chrisvest/events{/privacy}","received_events_url":"https://api.github.com/users/chrisvest/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-07T21:42:56Z","updated_at":"2025-07-07T21:44:19Z","body":"@franz1981 maybe, but still feels like we could do better. I wonder if we take something like our `LongLongHashMap` and make it concurrent, where the key is `threadId >>> 6` and the value is a `theadId % 64` bit map. I think that could work well for the monotonically increasing thread ids, and a presumably steady peak number of threads (so table expansions are very rare). This would also be a pretty compact representation. Probably smaller than the sorted array of longs.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/3046599492/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"chrisvest","id":7993,"node_id":"MDQ6VXNlcjc5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/7993?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisvest","html_url":"https://github.com/chrisvest","followers_url":"https://api.github.com/users/chrisvest/followers","following_url":"https://api.github.com/users/chrisvest/following{/other_user}","gists_url":"https://api.github.com/users/chrisvest/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisvest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisvest/subscriptions","organizations_url":"https://api.github.com/users/chrisvest/orgs","repos_url":"https://api.github.com/users/chrisvest/repos","events_url":"https://api.github.com/users/chrisvest/events{/privacy}","received_events_url":"https://api.github.com/users/chrisvest/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":18513261055,"node_id":"MEE_lADOABA-c86_TpktzwAAAARPefH_","url":"https://api.github.com/repos/netty/netty/issues/events/18513261055","actor":{"login":"franz1981","id":13125299,"node_id":"MDQ6VXNlcjEzMTI1Mjk5","avatar_url":"https://avatars.githubusercontent.com/u/13125299?v=4","gravatar_id":"","url":"https://api.github.com/users/franz1981","html_url":"https://github.com/franz1981","followers_url":"https://api.github.com/users/franz1981/followers","following_url":"https://api.github.com/users/franz1981/following{/other_user}","gists_url":"https://api.github.com/users/franz1981/gists{/gist_id}","starred_url":"https://api.github.com/users/franz1981/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/franz1981/subscriptions","organizations_url":"https://api.github.com/users/franz1981/orgs","repos_url":"https://api.github.com/users/franz1981/repos","events_url":"https://api.github.com/users/franz1981/events{/privacy}","received_events_url":"https://api.github.com/users/franz1981/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2025-07-07T21:42:57Z","performed_via_github_app":null},{"id":18513261072,"node_id":"SE_lADOABA-c86_TpktzwAAAARPefIQ","url":"https://api.github.com/repos/netty/netty/issues/events/18513261072","actor":{"login":"franz1981","id":13125299,"node_id":"MDQ6VXNlcjEzMTI1Mjk5","avatar_url":"https://avatars.githubusercontent.com/u/13125299?v=4","gravatar_id":"","url":"https://api.github.com/users/franz1981","html_url":"https://github.com/franz1981","followers_url":"https://api.github.com/users/franz1981/followers","following_url":"https://api.github.com/users/franz1981/following{/other_user}","gists_url":"https://api.github.com/users/franz1981/gists{/gist_id}","starred_url":"https://api.github.com/users/franz1981/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/franz1981/subscriptions","organizations_url":"https://api.github.com/users/franz1981/orgs","repos_url":"https://api.github.com/users/franz1981/repos","events_url":"https://api.github.com/users/franz1981/events{/privacy}","received_events_url":"https://api.github.com/users/franz1981/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2025-07-07T21:42:57Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/netty/netty/issues/comments/3049199716","html_url":"https://github.com/netty/netty/issues/15449#issuecomment-3049199716","issue_url":"https://api.github.com/repos/netty/netty/issues/15449","id":3049199716,"node_id":"IC_kwDOABA-c861vxhk","user":{"login":"yawkat","id":2395297,"node_id":"MDQ6VXNlcjIzOTUyOTc=","avatar_url":"https://avatars.githubusercontent.com/u/2395297?v=4","gravatar_id":"","url":"https://api.github.com/users/yawkat","html_url":"https://github.com/yawkat","followers_url":"https://api.github.com/users/yawkat/followers","following_url":"https://api.github.com/users/yawkat/following{/other_user}","gists_url":"https://api.github.com/users/yawkat/gists{/gist_id}","starred_url":"https://api.github.com/users/yawkat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yawkat/subscriptions","organizations_url":"https://api.github.com/users/yawkat/orgs","repos_url":"https://api.github.com/users/yawkat/repos","events_url":"https://api.github.com/users/yawkat/events{/privacy}","received_events_url":"https://api.github.com/users/yawkat/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-07-08T14:29:44Z","updated_at":"2025-07-08T14:29:44Z","body":"I don't see the value in making the thread id set concurrently writable. Where it's useful, it has maybe 8 entries and all of them are set at application startup. \n\nI also want to clarify the \"steady peak number of threads\" assumption: We can assume a small, fixed number of fake FTL threads, but we cannot assume a fixed number of threads in general, there will be millions or even billions. So a BitSet would not work, but a LongLongHashMap like you describe would.\n\nIf that improves the read performance, sure why not. Binary search is not exactly known for being fast.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/comments/3049199716/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"yawkat","id":2395297,"node_id":"MDQ6VXNlcjIzOTUyOTc=","avatar_url":"https://avatars.githubusercontent.com/u/2395297?v=4","gravatar_id":"","url":"https://api.github.com/users/yawkat","html_url":"https://github.com/yawkat","followers_url":"https://api.github.com/users/yawkat/followers","following_url":"https://api.github.com/users/yawkat/following{/other_user}","gists_url":"https://api.github.com/users/yawkat/gists{/gist_id}","starred_url":"https://api.github.com/users/yawkat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yawkat/subscriptions","organizations_url":"https://api.github.com/users/yawkat/orgs","repos_url":"https://api.github.com/users/yawkat/repos","events_url":"https://api.github.com/users/yawkat/events{/privacy}","received_events_url":"https://api.github.com/users/yawkat/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":19054580794,"node_id":"REFE_lADOABA-c86_TpktzwAAAARvvdQ6","url":"https://api.github.com/repos/netty/netty/issues/events/19054580794","actor":{"login":"georgebanasios","id":129333863,"node_id":"U_kgDOB7V6Zw","avatar_url":"https://avatars.githubusercontent.com/u/129333863?v=4","gravatar_id":"","url":"https://api.github.com/users/georgebanasios","html_url":"https://github.com/georgebanasios","followers_url":"https://api.github.com/users/georgebanasios/followers","following_url":"https://api.github.com/users/georgebanasios/following{/other_user}","gists_url":"https://api.github.com/users/georgebanasios/gists{/gist_id}","starred_url":"https://api.github.com/users/georgebanasios/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/georgebanasios/subscriptions","organizations_url":"https://api.github.com/users/georgebanasios/orgs","repos_url":"https://api.github.com/users/georgebanasios/repos","events_url":"https://api.github.com/users/georgebanasios/events{/privacy}","received_events_url":"https://api.github.com/users/georgebanasios/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"4e6027a3b93a6d71ce0516676425281111c771eb","commit_url":"https://api.github.com/repos/georgebanasios/netty/commits/4e6027a3b93a6d71ce0516676425281111c771eb","created_at":"2025-08-08T12:47:55Z","performed_via_github_app":null},{"id":19054607108,"node_id":"REFE_lADOABA-c86_TpktzwAAAARvvjsE","url":"https://api.github.com/repos/netty/netty/issues/events/19054607108","actor":{"login":"georgebanasios","id":129333863,"node_id":"U_kgDOB7V6Zw","avatar_url":"https://avatars.githubusercontent.com/u/129333863?v=4","gravatar_id":"","url":"https://api.github.com/users/georgebanasios","html_url":"https://github.com/georgebanasios","followers_url":"https://api.github.com/users/georgebanasios/followers","following_url":"https://api.github.com/users/georgebanasios/following{/other_user}","gists_url":"https://api.github.com/users/georgebanasios/gists{/gist_id}","starred_url":"https://api.github.com/users/georgebanasios/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/georgebanasios/subscriptions","organizations_url":"https://api.github.com/users/georgebanasios/orgs","repos_url":"https://api.github.com/users/georgebanasios/repos","events_url":"https://api.github.com/users/georgebanasios/events{/privacy}","received_events_url":"https://api.github.com/users/georgebanasios/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"d26efe63df7d10d1355822b11c0018504cc6f376","commit_url":"https://api.github.com/repos/georgebanasios/netty/commits/d26efe63df7d10d1355822b11c0018504cc6f376","created_at":"2025-08-08T12:49:39Z","performed_via_github_app":null},{"actor":{"login":"georgebanasios","id":129333863,"node_id":"U_kgDOB7V6Zw","avatar_url":"https://avatars.githubusercontent.com/u/129333863?v=4","gravatar_id":"","url":"https://api.github.com/users/georgebanasios","html_url":"https://github.com/georgebanasios","followers_url":"https://api.github.com/users/georgebanasios/followers","following_url":"https://api.github.com/users/georgebanasios/following{/other_user}","gists_url":"https://api.github.com/users/georgebanasios/gists{/gist_id}","starred_url":"https://api.github.com/users/georgebanasios/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/georgebanasios/subscriptions","organizations_url":"https://api.github.com/users/georgebanasios/orgs","repos_url":"https://api.github.com/users/georgebanasios/repos","events_url":"https://api.github.com/users/georgebanasios/events{/privacy}","received_events_url":"https://api.github.com/users/georgebanasios/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2025-08-08T12:51:01Z","updated_at":"2025-08-08T12:51:01Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/netty/netty/issues/15532","repository_url":"https://api.github.com/repos/netty/netty","labels_url":"https://api.github.com/repos/netty/netty/issues/15532/labels{/name}","comments_url":"https://api.github.com/repos/netty/netty/issues/15532/comments","events_url":"https://api.github.com/repos/netty/netty/issues/15532/events","html_url":"https://github.com/netty/netty/pull/15532","id":3303948052,"node_id":"PR_kwDOABA-c86iwuCv","number":15532,"title":"FastThreadLocal: Optimize fallback check for virtual threads to O(1)","user":{"login":"georgebanasios","id":129333863,"node_id":"U_kgDOB7V6Zw","avatar_url":"https://avatars.githubusercontent.com/u/129333863?v=4","gravatar_id":"","url":"https://api.github.com/users/georgebanasios","html_url":"https://github.com/georgebanasios","followers_url":"https://api.github.com/users/georgebanasios/followers","following_url":"https://api.github.com/users/georgebanasios/following{/other_user}","gists_url":"https://api.github.com/users/georgebanasios/gists{/gist_id}","starred_url":"https://api.github.com/users/georgebanasios/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/georgebanasios/subscriptions","organizations_url":"https://api.github.com/users/georgebanasios/orgs","repos_url":"https://api.github.com/users/georgebanasios/repos","events_url":"https://api.github.com/users/georgebanasios/events{/privacy}","received_events_url":"https://api.github.com/users/georgebanasios/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/netty/netty/milestones/318","html_url":"https://github.com/netty/netty/milestone/318","labels_url":"https://api.github.com/repos/netty/netty/milestones/318/labels","id":13267599,"node_id":"MI_kwDOABA-c84AynKP","number":318,"title":"4.2.4.Final","description":"","creator":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":29,"state":"closed","created_at":"2025-07-14T19:17:43Z","updated_at":"2025-08-13T12:31:06Z","due_on":null,"closed_at":"2025-08-13T12:31:06Z"},"comments":2,"created_at":"2025-08-08T12:51:00Z","updated_at":"2025-08-09T04:33:25Z","closed_at":"2025-08-08T21:58:20Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":1064563,"node_id":"MDEwOlJlcG9zaXRvcnkxMDY0NTYz","name":"netty","full_name":"netty/netty","private":false,"owner":{"login":"netty","id":473791,"node_id":"MDEyOk9yZ2FuaXphdGlvbjQ3Mzc5MQ==","avatar_url":"https://avatars.githubusercontent.com/u/473791?v=4","gravatar_id":"","url":"https://api.github.com/users/netty","html_url":"https://github.com/netty","followers_url":"https://api.github.com/users/netty/followers","following_url":"https://api.github.com/users/netty/following{/other_user}","gists_url":"https://api.github.com/users/netty/gists{/gist_id}","starred_url":"https://api.github.com/users/netty/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/netty/subscriptions","organizations_url":"https://api.github.com/users/netty/orgs","repos_url":"https://api.github.com/users/netty/repos","events_url":"https://api.github.com/users/netty/events{/privacy}","received_events_url":"https://api.github.com/users/netty/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/netty/netty","description":"Netty project - an event-driven asynchronous network application framework","fork":false,"url":"https://api.github.com/repos/netty/netty","forks_url":"https://api.github.com/repos/netty/netty/forks","keys_url":"https://api.github.com/repos/netty/netty/keys{/key_id}","collaborators_url":"https://api.github.com/repos/netty/netty/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/netty/netty/teams","hooks_url":"https://api.github.com/repos/netty/netty/hooks","issue_events_url":"https://api.github.com/repos/netty/netty/issues/events{/number}","events_url":"https://api.github.com/repos/netty/netty/events","assignees_url":"https://api.github.com/repos/netty/netty/assignees{/user}","branches_url":"https://api.github.com/repos/netty/netty/branches{/branch}","tags_url":"https://api.github.com/repos/netty/netty/tags","blobs_url":"https://api.github.com/repos/netty/netty/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/netty/netty/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/netty/netty/git/refs{/sha}","trees_url":"https://api.github.com/repos/netty/netty/git/trees{/sha}","statuses_url":"https://api.github.com/repos/netty/netty/statuses/{sha}","languages_url":"https://api.github.com/repos/netty/netty/languages","stargazers_url":"https://api.github.com/repos/netty/netty/stargazers","contributors_url":"https://api.github.com/repos/netty/netty/contributors","subscribers_url":"https://api.github.com/repos/netty/netty/subscribers","subscription_url":"https://api.github.com/repos/netty/netty/subscription","commits_url":"https://api.github.com/repos/netty/netty/commits{/sha}","git_commits_url":"https://api.github.com/repos/netty/netty/git/commits{/sha}","comments_url":"https://api.github.com/repos/netty/netty/comments{/number}","issue_comment_url":"https://api.github.com/repos/netty/netty/issues/comments{/number}","contents_url":"https://api.github.com/repos/netty/netty/contents/{+path}","compare_url":"https://api.github.com/repos/netty/netty/compare/{base}...{head}","merges_url":"https://api.github.com/repos/netty/netty/merges","archive_url":"https://api.github.com/repos/netty/netty/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/netty/netty/downloads","issues_url":"https://api.github.com/repos/netty/netty/issues{/number}","pulls_url":"https://api.github.com/repos/netty/netty/pulls{/number}","milestones_url":"https://api.github.com/repos/netty/netty/milestones{/number}","notifications_url":"https://api.github.com/repos/netty/netty/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/netty/netty/labels{/name}","releases_url":"https://api.github.com/repos/netty/netty/releases{/id}","deployments_url":"https://api.github.com/repos/netty/netty/deployments","created_at":"2010-11-09T09:22:21Z","updated_at":"2025-11-10T05:10:03Z","pushed_at":"2025-11-08T09:13:35Z","git_url":"git://github.com/netty/netty.git","ssh_url":"git@github.com:netty/netty.git","clone_url":"https://github.com/netty/netty.git","svn_url":"https://github.com/netty/netty","homepage":"http://netty.io","size":102527,"stargazers_count":34575,"watchers_count":34575,"language":"Java","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":true,"forks_count":16233,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":670,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":[],"visibility":"public","forks":16233,"open_issues":670,"watchers":34575,"default_branch":"4.2","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/netty/netty/pulls/15532","html_url":"https://github.com/netty/netty/pull/15532","diff_url":"https://github.com/netty/netty/pull/15532.diff","patch_url":"https://github.com/netty/netty/pull/15532.patch","merged_at":"2025-08-08T21:58:20Z"},"body":"Motivation:\r\n\r\nIn applications that use a lot of virtual threads, the vast majority of these threads are not \"special\" FTL-enabled threads which means the check for thread membership is almost always a negative hit. This change resolves #15449 by replacing the binary search approach with a O(1) average-time solution, as suggested in the ticket's comments.\r\n\r\nModifications:\r\n\r\n- Moved the internal `LongLongHashMap` class from `netty-buffer` module to `netty-common` to make it accessible in the FTLT class.\r\n- Created an immutable helper class, `FallbackThreadSet` to use `LongLongHashMap` for sparse storage. The map key is derived from `threadId >>> 6` and the value is a 64-bit bitmap.\r\n- The `FallbackThreadSet` is thread-safe and still uses a copy-on-write approach, preserving the existing concurrency pattern.\r\n\r\nResult:\r\n\r\nThe check for whether a thread is a \"special\" virtual thread is now a O(1) average-time operation.","reactions":{"url":"https://api.github.com/repos/netty/netty/issues/15532/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":1,"eyes":0},"timeline_url":"https://api.github.com/repos/netty/netty/issues/15532/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":19062633368,"node_id":"CE_lADOABA-c86_TpktzwAAAARwOLOY","url":"https://api.github.com/repos/netty/netty/issues/events/19062633368","actor":{"login":"chrisvest","id":7993,"node_id":"MDQ6VXNlcjc5OTM=","avatar_url":"https://avatars.githubusercontent.com/u/7993?v=4","gravatar_id":"","url":"https://api.github.com/users/chrisvest","html_url":"https://github.com/chrisvest","followers_url":"https://api.github.com/users/chrisvest/followers","following_url":"https://api.github.com/users/chrisvest/following{/other_user}","gists_url":"https://api.github.com/users/chrisvest/gists{/gist_id}","starred_url":"https://api.github.com/users/chrisvest/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/chrisvest/subscriptions","organizations_url":"https://api.github.com/users/chrisvest/orgs","repos_url":"https://api.github.com/users/chrisvest/repos","events_url":"https://api.github.com/users/chrisvest/events{/privacy}","received_events_url":"https://api.github.com/users/chrisvest/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2025-08-08T21:58:21Z","state_reason":null,"performed_via_github_app":null},{"id":19064639543,"node_id":"REFE_lADOABA-c86_TpktzwAAAARwV1A3","url":"https://api.github.com/repos/netty/netty/issues/events/19064639543","actor":{"login":"pull[bot]","id":39814207,"node_id":"MDM6Qm90Mzk4MTQyMDc=","avatar_url":"https://avatars.githubusercontent.com/in/12910?v=4","gravatar_id":"","url":"https://api.github.com/users/pull%5Bbot%5D","html_url":"https://github.com/apps/pull","followers_url":"https://api.github.com/users/pull%5Bbot%5D/followers","following_url":"https://api.github.com/users/pull%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/pull%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/pull%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pull%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/pull%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/pull%5Bbot%5D/repos","events_url":"https://api.github.com/users/pull%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/pull%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"2233eaa7ac99584191a785a1b0f42b522b579aa0","commit_url":"https://api.github.com/repos/boost-mw-poc/netty_netty/commits/2233eaa7ac99584191a785a1b0f42b522b579aa0","created_at":"2025-08-09T03:12:05Z","performed_via_github_app":null}]