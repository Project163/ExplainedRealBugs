{"url":"https://api.github.com/repos/netty/netty/issues/12024","repository_url":"https://api.github.com/repos/netty/netty","labels_url":"https://api.github.com/repos/netty/netty/issues/12024/labels{/name}","comments_url":"https://api.github.com/repos/netty/netty/issues/12024/comments","events_url":"https://api.github.com/repos/netty/netty/issues/12024/events","html_url":"https://github.com/netty/netty/issues/12024","id":1108201606,"node_id":"I_kwDOABA-c85CDdCG","number":12024,"title":"Add support for M1 Silicon Macs - Can't build Netty","user":{"login":"tmulle","id":5183186,"node_id":"MDQ6VXNlcjUxODMxODY=","avatar_url":"https://avatars.githubusercontent.com/u/5183186?v=4","gravatar_id":"","url":"https://api.github.com/users/tmulle","html_url":"https://github.com/tmulle","followers_url":"https://api.github.com/users/tmulle/followers","following_url":"https://api.github.com/users/tmulle/following{/other_user}","gists_url":"https://api.github.com/users/tmulle/gists{/gist_id}","starred_url":"https://api.github.com/users/tmulle/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tmulle/subscriptions","organizations_url":"https://api.github.com/users/tmulle/orgs","repos_url":"https://api.github.com/users/tmulle/repos","events_url":"https://api.github.com/users/tmulle/events{/privacy}","received_events_url":"https://api.github.com/users/tmulle/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/netty/netty/milestones/249","html_url":"https://github.com/netty/netty/milestone/249","labels_url":"https://api.github.com/repos/netty/netty/milestones/249/labels","id":7564181,"node_id":"MI_kwDOABA-c84Ac2uV","number":249,"title":"4.1.74.Final","description":"","creator":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":39,"state":"closed","created_at":"2022-01-12T07:18:34Z","updated_at":"2022-02-08T10:31:58Z","due_on":null,"closed_at":"2022-02-08T10:31:58Z"},"comments":11,"created_at":"2022-01-19T14:55:59Z","updated_at":"2022-08-29T05:09:33Z","closed_at":"2022-01-21T08:43:12Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I know the M1 Macs are still relatively new and not all developers have them, I decided to try to build Netty for the first time ever on my M1 Mac and it failed.\r\n\r\nJust letting you know in case no one has tried before.\r\n\r\nI also wonder if the NATIVE-TRANSPORTS (kqueue) will also build on M1 Macs?\r\n\r\n### Expected behavior\r\nTo be able to run ```mvn clean package``` successfully\r\n\r\n### Actual behavior\r\nBuild fails with error:\r\n\r\n```\r\n[INFO] Running io.netty.handler.codec.compression.BrotliEncoderTest\r\n[ERROR] Tests run: 1, Failures: 0, Errors: 1, Skipped: 0, Time elapsed: 0 s <<< FAILURE! - in io.netty.handler.codec.compression.BrotliEncoderTest\r\n[ERROR] io.netty.handler.codec.compression.BrotliEncoderTest  Time elapsed: 0 s  <<< ERROR!\r\njava.lang.ExceptionInInitializerError\r\n\tat io.netty.handler.codec.compression.BrotliEncoderTest.<clinit>(BrotliEncoderTest.java:35)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:77)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:568)\r\n\tat org.junit.platform.commons.util.ReflectionUtils.invokeMethod(ReflectionUtils.java:688)\r\n\tat org.junit.jupiter.api.condition.MethodBasedCondition.invokeConditionMethod(MethodBasedCondition.java:82)\r\n\tat org.junit.jupiter.api.condition.MethodBasedCondition.lambda$evaluateExecutionCondition$1(MethodBasedCondition.java:52)\r\n\tat java.base/java.util.Optional.map(Optional.java:260)\r\n\tat org.junit.jupiter.api.condition.MethodBasedCondition.evaluateExecutionCondition(MethodBasedCondition.java:52)\r\n\tat org.junit.jupiter.engine.execution.ConditionEvaluator.evaluate(ConditionEvaluator.java:64)\r\n\tat org.junit.jupiter.engine.execution.ConditionEvaluator.lambda$evaluate$0(ConditionEvaluator.java:55)\r\n\tat java.base/java.util.stream.ReferencePipeline$3$1.accept(ReferencePipeline.java:197)\r\n\tat java.base/java.util.stream.ReferencePipeline$2$1.accept(ReferencePipeline.java:179)\r\n\tat java.base/java.util.stream.StreamSpliterators$WrappingSpliterator.tryAdvance(StreamSpliterators.java:300)\r\n\tat java.base/java.util.stream.Streams$ConcatSpliterator.tryAdvance(Streams.java:723)\r\n\tat java.base/java.util.stream.ReferencePipeline.forEachWithCancel(ReferencePipeline.java:129)\r\n\tat java.base/java.util.stream.AbstractPipeline.copyIntoWithCancel(AbstractPipeline.java:527)\r\n\tat java.base/java.util.stream.AbstractPipeline.copyInto(AbstractPipeline.java:513)\r\n\tat java.base/java.util.stream.AbstractPipeline.wrapAndCopyInto(AbstractPipeline.java:499)\r\n\tat java.base/java.util.stream.FindOps$FindOp.evaluateSequential(FindOps.java:150)\r\n\tat java.base/java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)\r\n\tat java.base/java.util.stream.ReferencePipeline.findFirst(ReferencePipeline.java:647)\r\n\tat org.junit.jupiter.engine.execution.ConditionEvaluator.evaluate(ConditionEvaluator.java:57)\r\n\tat org.junit.jupiter.engine.descriptor.JupiterTestDescriptor.shouldBeSkipped(JupiterTestDescriptor.java:202)\r\n\tat org.junit.jupiter.engine.descriptor.JupiterTestDescriptor.shouldBeSkipped(JupiterTestDescriptor.java:57)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$checkWhetherSkipped$2(NodeTestTask.java:119)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.checkWhetherSkipped(NodeTestTask.java:119)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:81)\r\n\tat java.base/java.util.ArrayList.forEach(ArrayList.java:1511)\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.invokeAll(SameThreadHierarchicalTestExecutorService.java:38)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$5(NodeTestTask.java:143)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$7(NodeTestTask.java:129)\r\n\tat org.junit.platform.engine.support.hierarchical.Node.around(Node.java:137)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.lambda$executeRecursively$8(NodeTestTask.java:127)\r\n\tat org.junit.platform.engine.support.hierarchical.ThrowableCollector.execute(ThrowableCollector.java:73)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.executeRecursively(NodeTestTask.java:126)\r\n\tat org.junit.platform.engine.support.hierarchical.NodeTestTask.execute(NodeTestTask.java:84)\r\n\tat org.junit.platform.engine.support.hierarchical.SameThreadHierarchicalTestExecutorService.submit(SameThreadHierarchicalTestExecutorService.java:32)\r\n\tat org.junit.platform.engine.support.hierarchical.HierarchicalTestExecutor.execute(HierarchicalTestExecutor.java:57)\r\n\tat org.junit.platform.engine.support.hierarchical.HierarchicalTestEngine.execute(HierarchicalTestEngine.java:51)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:220)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.lambda$execute$6(DefaultLauncher.java:188)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.withInterceptedStreams(DefaultLauncher.java:202)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:181)\r\n\tat org.junit.platform.launcher.core.DefaultLauncher.execute(DefaultLauncher.java:128)\r\n\tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invokeAllTests(JUnitPlatformProvider.java:150)\r\n\tat org.apache.maven.surefire.junitplatform.JUnitPlatformProvider.invoke(JUnitPlatformProvider.java:124)\r\n\tat org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)\r\n\tat org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)\r\n\tat org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)\r\n\tat org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)\r\nCaused by: java.lang.UnsatisfiedLinkError: Failed to load Brotli native library\r\n\tat com.aayushatharva.brotli4j.Brotli4jLoader.ensureAvailability(Brotli4jLoader.java:78)\r\n\tat io.netty.handler.codec.compression.Brotli.ensureAvailability(Brotli.java:71)\r\n\tat io.netty.handler.codec.compression.BrotliEncoderTest.<clinit>(BrotliEncoderTest.java:33)\r\n\t... 53 more\r\nCaused by: java.lang.UnsupportedOperationException: Unsupported OS and Architecture: Mac OS X, aarch64\r\n\tat com.aayushatharva.brotli4j.Brotli4jLoader.getPlatform(Brotli4jLoader.java:106)\r\n\tat com.aayushatharva.brotli4j.Brotli4jLoader.<clinit>(Brotli4jLoader.java:38)\r\n\tat io.netty.handler.codec.compression.Brotli.<clinit>(Brotli.java:46)\r\n\tat io.netty.handler.codec.compression.BrotliDecoderTest.<clinit>(BrotliDecoderTest.java:49)\r\n\t... 53 more\r\n```\r\n\r\n### Steps to reproduce\r\nClone Netty repo and run ```mvn clean package```\r\n\r\n### Minimal yet complete reproducer code (or URL to code)\r\n\r\n### Netty version\r\n\r\n### JVM version (e.g. `java -version`)\r\nJDk11 and JDK17\r\n\r\n### OS version (e.g. `uname -a`)\r\n21.2.0 Darwin Kernel Version 21.2.0: Sun Nov 28 20:28:41 PST 2021; root:xnu-8019.61.5~1/RELEASE_ARM64_T6000 arm64","closed_by":{"login":"normanmaurer","id":439362,"node_id":"MDQ6VXNlcjQzOTM2Mg==","avatar_url":"https://avatars.githubusercontent.com/u/439362?v=4","gravatar_id":"","url":"https://api.github.com/users/normanmaurer","html_url":"https://github.com/normanmaurer","followers_url":"https://api.github.com/users/normanmaurer/followers","following_url":"https://api.github.com/users/normanmaurer/following{/other_user}","gists_url":"https://api.github.com/users/normanmaurer/gists{/gist_id}","starred_url":"https://api.github.com/users/normanmaurer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/normanmaurer/subscriptions","organizations_url":"https://api.github.com/users/normanmaurer/orgs","repos_url":"https://api.github.com/users/normanmaurer/repos","events_url":"https://api.github.com/users/normanmaurer/events{/privacy}","received_events_url":"https://api.github.com/users/normanmaurer/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/netty/netty/issues/12024/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/netty/netty/issues/12024/timeline","performed_via_github_app":null,"state_reason":"completed"}