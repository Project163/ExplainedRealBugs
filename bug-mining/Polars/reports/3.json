{"url":"https://api.github.com/repos/pola-rs/polars/issues/23993","repository_url":"https://api.github.com/repos/pola-rs/polars","labels_url":"https://api.github.com/repos/pola-rs/polars/issues/23993/labels{/name}","comments_url":"https://api.github.com/repos/pola-rs/polars/issues/23993/comments","events_url":"https://api.github.com/repos/pola-rs/polars/issues/23993/events","html_url":"https://github.com/pola-rs/polars/issues/23993","id":3309104197,"node_id":"I_kwDOD7gq787FPOxF","number":23993,"title":"Planner schema mismatch for division on `Boolean`","user":{"login":"kdn36","id":184849070,"node_id":"U_kgDOCwSSrg","avatar_url":"https://avatars.githubusercontent.com/u/184849070?v=4","gravatar_id":"","url":"https://api.github.com/users/kdn36","html_url":"https://github.com/kdn36","followers_url":"https://api.github.com/users/kdn36/followers","following_url":"https://api.github.com/users/kdn36/following{/other_user}","gists_url":"https://api.github.com/users/kdn36/gists{/gist_id}","starred_url":"https://api.github.com/users/kdn36/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kdn36/subscriptions","organizations_url":"https://api.github.com/users/kdn36/orgs","repos_url":"https://api.github.com/users/kdn36/repos","events_url":"https://api.github.com/users/kdn36/events{/privacy}","received_events_url":"https://api.github.com/users/kdn36/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2058875254,"node_id":"MDU6TGFiZWwyMDU4ODc1MjU0","url":"https://api.github.com/repos/pola-rs/polars/labels/bug","name":"bug","color":"E99695","default":true,"description":"Something isn't working"},{"id":2355548729,"node_id":"MDU6TGFiZWwyMzU1NTQ4NzI5","url":"https://api.github.com/repos/pola-rs/polars/labels/python","name":"python","color":"0052cc","default":false,"description":"Related to Python Polars"},{"id":5735025452,"node_id":"LA_kwDOD7gq788AAAABVdWLLA","url":"https://api.github.com/repos/pola-rs/polars/labels/accepted","name":"accepted","color":"0E8A16","default":false,"description":"Ready for implementation"},{"id":6401969570,"node_id":"LA_kwDOD7gq788AAAABfZZNog","url":"https://api.github.com/repos/pola-rs/polars/labels/P-medium","name":"P-medium","color":"FBCA04","default":false,"description":"Priority: medium"},{"id":7210144721,"node_id":"LA_kwDOD7gq788AAAABrcIT0Q","url":"https://api.github.com/repos/pola-rs/polars/labels/A-plan","name":"A-plan","color":"D4C5F9","default":false,"description":"Area: logical plan and intermediate representation"}],"state":"closed","locked":false,"assignee":{"login":"dsprenkels","id":439973,"node_id":"MDQ6VXNlcjQzOTk3Mw==","avatar_url":"https://avatars.githubusercontent.com/u/439973?v=4","gravatar_id":"","url":"https://api.github.com/users/dsprenkels","html_url":"https://github.com/dsprenkels","followers_url":"https://api.github.com/users/dsprenkels/followers","following_url":"https://api.github.com/users/dsprenkels/following{/other_user}","gists_url":"https://api.github.com/users/dsprenkels/gists{/gist_id}","starred_url":"https://api.github.com/users/dsprenkels/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsprenkels/subscriptions","organizations_url":"https://api.github.com/users/dsprenkels/orgs","repos_url":"https://api.github.com/users/dsprenkels/repos","events_url":"https://api.github.com/users/dsprenkels/events{/privacy}","received_events_url":"https://api.github.com/users/dsprenkels/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"dsprenkels","id":439973,"node_id":"MDQ6VXNlcjQzOTk3Mw==","avatar_url":"https://avatars.githubusercontent.com/u/439973?v=4","gravatar_id":"","url":"https://api.github.com/users/dsprenkels","html_url":"https://github.com/dsprenkels","followers_url":"https://api.github.com/users/dsprenkels/followers","following_url":"https://api.github.com/users/dsprenkels/following{/other_user}","gists_url":"https://api.github.com/users/dsprenkels/gists{/gist_id}","starred_url":"https://api.github.com/users/dsprenkels/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsprenkels/subscriptions","organizations_url":"https://api.github.com/users/dsprenkels/orgs","repos_url":"https://api.github.com/users/dsprenkels/repos","events_url":"https://api.github.com/users/dsprenkels/events{/privacy}","received_events_url":"https://api.github.com/users/dsprenkels/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":3,"created_at":"2025-08-11T09:01:43Z","updated_at":"2025-08-20T11:32:15Z","closed_at":"2025-08-20T11:32:15Z","author_association":"COLLABORATOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Checks\n\n- [x] I have checked that this issue has not already been reported.\n- [x] I have confirmed this bug exists on the [latest version](https://pypi.org/project/polars/) of Polars.\n\n### Reproducible example\n\n```python\nimport polars as pl\n\n## Boolean\ns = pl.Series(\"a\", [None, True, False])\nt = pl.Series(\"b\", [128])\nq = s.to_frame().lazy().select(pl.col(\"a\")/t)\n\nprint(q.collect_schema())\nprint(q.collect().schema)\n\n# Schema({'a': Boolean})\n# Schema({'a': Float64})\n\n## Array\ns = pl.Series(\"a\", [[None, True, False]], dtype=pl.Array(bool,3))\nt = pl.Series(\"b\", [128])\nq = s.to_frame().lazy().select(pl.col(\"a\")/t)\n\nprint(q.collect_schema())\nprint(q.collect().schema)\n\n# Schema({'a': Array(Boolean, shape=(3,))})\n# Schema({'a': Array(Float64, shape=(3,))})\n\n## List\ns = pl.Series(\"a\", [[None, True, False]])\nt = pl.Series(\"b\", [128])\nq = s.to_frame().lazy().select(pl.col(\"a\")/t)\n\nprint(q.collect_schema())\nprint(q.collect().schema)\n\n# Schema({'a': List(Boolean)})\n# Schema({'a': List(Float64)})\n```\n\n\n### Log output\n(see comments in MRE)\n\n```shell\n\n```\n\n### Issue description\n\nSchema's do not match\n\n### Expected behavior\n\nSchema's should match. Check for `truediv` and `floordiv`.\n\n### Installed versions\n\n<details>\n\n```\n--------Version info---------\nPolars:              1.32.0\nIndex type:          UInt32\nPlatform:            Linux-6.6.87.2-microsoft-standard-WSL2-x86_64-with-glibc2.39\nPython:              3.13.5 (main, Jul 18 2025, 09:47:32) [GCC 13.3.0]\nLTS CPU:             False\n```\n\n</details>\n","closed_by":{"login":"dsprenkels","id":439973,"node_id":"MDQ6VXNlcjQzOTk3Mw==","avatar_url":"https://avatars.githubusercontent.com/u/439973?v=4","gravatar_id":"","url":"https://api.github.com/users/dsprenkels","html_url":"https://github.com/dsprenkels","followers_url":"https://api.github.com/users/dsprenkels/followers","following_url":"https://api.github.com/users/dsprenkels/following{/other_user}","gists_url":"https://api.github.com/users/dsprenkels/gists{/gist_id}","starred_url":"https://api.github.com/users/dsprenkels/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dsprenkels/subscriptions","organizations_url":"https://api.github.com/users/dsprenkels/orgs","repos_url":"https://api.github.com/users/dsprenkels/repos","events_url":"https://api.github.com/users/dsprenkels/events{/privacy}","received_events_url":"https://api.github.com/users/dsprenkels/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/pola-rs/polars/issues/23993/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/pola-rs/polars/issues/23993/timeline","performed_via_github_app":null,"state_reason":"completed"}