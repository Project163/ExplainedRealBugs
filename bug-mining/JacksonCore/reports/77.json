{"url":"https://api.github.com/repos/FasterXML/jackson-core/issues/556","repository_url":"https://api.github.com/repos/FasterXML/jackson-core","labels_url":"https://api.github.com/repos/FasterXML/jackson-core/issues/556/labels{/name}","comments_url":"https://api.github.com/repos/FasterXML/jackson-core/issues/556/comments","events_url":"https://api.github.com/repos/FasterXML/jackson-core/issues/556/events","html_url":"https://github.com/FasterXML/jackson-core/issues/556","id":484725196,"node_id":"MDU6SXNzdWU0ODQ3MjUxOTY=","number":556,"title":"'IndexOutOfBoundsException' in UTF8JsonGenerator.writeString(Reader, len) when using a negative length","user":{"login":"jake-a-ward","id":3903153,"node_id":"MDQ6VXNlcjM5MDMxNTM=","avatar_url":"https://avatars.githubusercontent.com/u/3903153?v=4","gravatar_id":"","url":"https://api.github.com/users/jake-a-ward","html_url":"https://github.com/jake-a-ward","followers_url":"https://api.github.com/users/jake-a-ward/followers","following_url":"https://api.github.com/users/jake-a-ward/following{/other_user}","gists_url":"https://api.github.com/users/jake-a-ward/gists{/gist_id}","starred_url":"https://api.github.com/users/jake-a-ward/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jake-a-ward/subscriptions","organizations_url":"https://api.github.com/users/jake-a-ward/orgs","repos_url":"https://api.github.com/users/jake-a-ward/repos","events_url":"https://api.github.com/users/jake-a-ward/events{/privacy}","received_events_url":"https://api.github.com/users/jake-a-ward/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/FasterXML/jackson-core/milestones/45","html_url":"https://github.com/FasterXML/jackson-core/milestone/45","labels_url":"https://api.github.com/repos/FasterXML/jackson-core/milestones/45/labels","id":4497733,"node_id":"MDk6TWlsZXN0b25lNDQ5NzczMw==","number":45,"title":"2.9.10","description":null,"creator":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":2,"state":"open","created_at":"2019-07-17T02:23:29Z","updated_at":"2019-08-27T22:50:36Z","due_on":null,"closed_at":null},"comments":4,"created_at":"2019-08-23T21:49:02Z","updated_at":"2019-08-29T15:11:02Z","closed_at":"2019-08-27T22:50:36Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I encountered this using Jackson 2.9.9\r\n\r\nThe JavaDoc for JsonGenerator.writeString(Reader, len) states that passing a len < 0 will write all contents of the reader. It throws an IndexOutOfBoundsException when the buffer in UTF8JsonGenerator becomes full but is not correctly flushed because the check for a full buffer does not take into account the negative len parameter.\r\n\r\n`Exception in thread \"main\" com.fasterxml.jackson.databind.JsonMappingException: Index 8000 out of bounds for length 8000 (through reference chain: java.util.ArrayList[2])\r\n\tat com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:394)\r\n\tat com.fasterxml.jackson.databind.JsonMappingException.wrapWithPath(JsonMappingException.java:365)\r\n\tat com.fasterxml.jackson.databind.ser.std.StdSerializer.wrapAndThrow(StdSerializer.java:338)\r\n\tat com.fasterxml.jackson.databind.ser.impl.IndexedListSerializer.serializeContents(IndexedListSerializer.java:123)\r\n\tat com.fasterxml.jackson.databind.ser.impl.IndexedListSerializer.serialize(IndexedListSerializer.java:79)\r\n\tat com.fasterxml.jackson.databind.ser.impl.IndexedListSerializer.serialize(IndexedListSerializer.java:18)\r\n\tat com.fasterxml.jackson.databind.ser.DefaultSerializerProvider._serialize(DefaultSerializerProvider.java:480)\r\n\tat com.fasterxml.jackson.databind.ser.DefaultSerializerProvider.serializeValue(DefaultSerializerProvider.java:319)\r\n\tat com.fasterxml.jackson.databind.ObjectMapper._configAndWriteValue(ObjectMapper.java:3905)\r\n\tat com.fasterxml.jackson.databind.ObjectMapper.writeValue(ObjectMapper.java:3176)\r\n\tat jackson.bug.JacksonBugTest.main(JacksonBugTest.java:36)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)\r\n\tat java.base/java.lang.reflect.Method.invoke(Method.java:567)\r\n\tat com.intellij.rt.execution.application.AppMainV2.main(AppMainV2.java:131)\r\n\tSuppressed: java.lang.IndexOutOfBoundsException: Range [0, 0 + 8001) out of bounds for length 8000\r\n\t\tat java.base/jdk.internal.util.Preconditions.outOfBounds(Preconditions.java:64)\r\n\t\tat java.base/jdk.internal.util.Preconditions.outOfBoundsCheckFromIndexSize(Preconditions.java:82)\r\n\t\tat java.base/jdk.internal.util.Preconditions.checkFromIndexSize(Preconditions.java:343)\r\n\t\tat java.base/java.util.Objects.checkFromIndexSize(Objects.java:425)\r\n\t\tat java.base/java.io.ByteArrayOutputStream.write(ByteArrayOutputStream.java:129)\r\n\t\tat com.fasterxml.jackson.core.json.UTF8JsonGenerator._flushBuffer(UTF8JsonGenerator.java:2085)\r\n\t\tat com.fasterxml.jackson.core.json.UTF8JsonGenerator.close(UTF8JsonGenerator.java:1127)\r\n\t\tat com.fasterxml.jackson.databind.util.ClassUtil.closeOnFailAndThrowAsIOE(ClassUtil.java:488)\r\n\t\tat com.fasterxml.jackson.databind.ObjectMapper._configAndWriteValue(ObjectMapper.java:3907)\r\n\t\t... 7 more\r\nCaused by: java.lang.ArrayIndexOutOfBoundsException: Index 8000 out of bounds for length 8000\r\n\tat com.fasterxml.jackson.core.json.UTF8JsonGenerator.writeString(UTF8JsonGenerator.java:503)\r\n\tat jackson.bug.JacksonBugTest$ThingSerializer.serialize(JacksonBugTest.java:45)\r\n\tat jackson.bug.JacksonBugTest$ThingSerializer.serialize(JacksonBugTest.java:40)\r\n\tat com.fasterxml.jackson.databind.ser.impl.IndexedListSerializer.serializeContents(IndexedListSerializer.java:119)\r\n\t... 12 more`","closed_by":{"login":"cowtowncoder","id":55065,"node_id":"MDQ6VXNlcjU1MDY1","avatar_url":"https://avatars.githubusercontent.com/u/55065?v=4","gravatar_id":"","url":"https://api.github.com/users/cowtowncoder","html_url":"https://github.com/cowtowncoder","followers_url":"https://api.github.com/users/cowtowncoder/followers","following_url":"https://api.github.com/users/cowtowncoder/following{/other_user}","gists_url":"https://api.github.com/users/cowtowncoder/gists{/gist_id}","starred_url":"https://api.github.com/users/cowtowncoder/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cowtowncoder/subscriptions","organizations_url":"https://api.github.com/users/cowtowncoder/orgs","repos_url":"https://api.github.com/users/cowtowncoder/repos","events_url":"https://api.github.com/users/cowtowncoder/events{/privacy}","received_events_url":"https://api.github.com/users/cowtowncoder/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/FasterXML/jackson-core/issues/556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/FasterXML/jackson-core/issues/556/timeline","performed_via_github_app":null,"state_reason":"completed"}