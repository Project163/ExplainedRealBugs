<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:46:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DBCP-100] [dbcp] NullPointerException retrieving connection from the pool</title>
                <link>https://issues.apache.org/jira/browse/DBCP-100</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;under some load we start getting this exception when retrieving connection from&lt;br/&gt;
pool:&lt;/p&gt;

&lt;p&gt;org.apache.commons.dbcp.SQLNestedException: Could not retrieve connection info&lt;br/&gt;
from pool&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.datasources.SharedPoolDataSource.getPooledConnectionAndInfo(SharedPoolDataSource.java:169)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.datasources.InstanceKeyDataSource.getConnection(InstanceKeyDataSource.java:631)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.datasources.InstanceKeyDataSource.getConnection(InstanceKeyDataSource.java:615)&lt;br/&gt;
        at org.apache.torque.TorqueInstance.getConnection(TorqueInstance.java:705)&lt;br/&gt;
        ... 34 more&lt;br/&gt;
Caused by: java.lang.NullPointerException&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.collections.SequencedHashMap.insertEntry(SequencedHashMap.java:226)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.collections.SequencedHashMap.put(SequencedHashMap.java:451)&lt;br/&gt;
        at org.apache.commons.collections.LRUMap.put(LRUMap.java:125)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.datasources.SharedPoolDataSource.getUserPassKey(SharedPoolDataSource.java:179)&lt;br/&gt;
        at&lt;br/&gt;
org.apache.commons.dbcp.datasources.SharedPoolDataSource.getPooledConnectionAndInfo(SharedPoolDataSource.java:165)&lt;br/&gt;
        ... 37 more&lt;/p&gt;

&lt;p&gt;this is apparently caused by improper syncronization:&lt;/p&gt;

&lt;p&gt;SharedPoolDataSource.getPooledConnectionAndInfo() is synchronized &lt;em&gt;instance&lt;/em&gt;&lt;br/&gt;
method, but it accesses SharedPoolDataSource.userKeys which is a &lt;em&gt;static&lt;/em&gt;&lt;br/&gt;
variable, so if you have more than one instance of SharedPoolDataSource (as we&lt;br/&gt;
do) access to the map would not be properly synchronized. So either map should&lt;br/&gt;
be made instance variable, or the method should be synchronized on the class,&lt;br/&gt;
not instance.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: Windows XP&lt;br/&gt;
Platform: Other&lt;/p&gt;</environment>
        <key id="12342390">DBCP-100</key>
            <summary>[dbcp] NullPointerException retrieving connection from the pool</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="fedor.karpelevitch@mscibarra.com">Fedor Karpelevitch</reporter>
                        <labels>
                    </labels>
                <created>Fri, 22 Jul 2005 07:13:15 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:32 +0000</updated>
                            <resolved>Mon, 21 Aug 2006 00:34:23 +0000</resolved>
                                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>3</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12429310" author="psteitz" created="Mon, 21 Aug 2006 00:34:23 +0000"  >&lt;p&gt;Made userKeys an instance variable.  Fixed in r433104, nightlies starting 21-aug-06.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>35825</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114383</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            19 years, 14 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uxin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178571</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>