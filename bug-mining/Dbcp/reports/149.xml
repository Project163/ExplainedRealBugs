<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:48:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DBCP-454] OSGi declarations contain multiple import headers for javax.transaction</title>
                <link>https://issues.apache.org/jira/browse/DBCP-454</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-445&quot; title=&quot;java.lang.NoClassDefFoundError: javax/transaction/SystemException after update&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-445&quot;&gt;&lt;del&gt;DBCP-445&lt;/del&gt;&lt;/a&gt; an issue for &quot;javax.transaction&quot; import-packages was addressed. Though with the fix for this issue the import-packages will contain &quot;javax.transaction&quot; twice:&lt;/p&gt;

&lt;p&gt;Import-Package: javax.management,javax.naming,javax.naming.spi,javax.s&lt;br/&gt;
 ql,javax.transaction,javax.transaction.xa,org.apache.commons.logging,&lt;br/&gt;
 org.apache.commons.pool2,org.apache.commons.pool2.impl,javax.transact&lt;br/&gt;
 ion.xa;version=&quot;1.1.0&quot;;partial=true;mandatory:=partial,javax.transact&lt;br/&gt;
 ion;version=&quot;1.1.0&quot;&lt;/p&gt;

&lt;p&gt;Thus the bundle can&apos;t be loaded as duplicate import declarations are prohibited and i.e. Felix will complain about this and refuse to install the bundle. The fix is quite simple by appending the &apos;*&apos; to the end (see attached patch).&lt;/p&gt;</description>
                <environment>&lt;p&gt;OSGi&lt;/p&gt;</environment>
        <key id="12946952">DBCP-454</key>
            <summary>OSGi declarations contain multiple import headers for javax.transaction</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="mattsicker">Matt Sicker</assignee>
                                    <reporter username="pmarx">Philipp Marx</reporter>
                        <labels>
                    </labels>
                <created>Fri, 4 Mar 2016 10:41:57 +0000</created>
                <updated>Wed, 10 Oct 2018 12:19:17 +0000</updated>
                                            <version>2.2.0</version>
                                    <fixVersion>2.4.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15179795" author="pmarx" created="Fri, 4 Mar 2016 12:04:05 +0000"  >&lt;p&gt;With the fix the bundle doesn&apos;t contain the duplicate import packages anymore. Still the bundle can&apos;t be resolved properly in my OGSi environment (karaf 3.0.5 / java 1.8 / MacOS). If I remove the extra import declarations for &quot;javax.transaction&quot; completely it works without problems. Are we sure that these declarations are absolutely required in the bundle? Isn&apos;t it the responsibility of the runtime to ensure the packages are properly exported, i.e. Karaf seems to take care of this?&lt;/p&gt;</comment>
                            <comment id="15404568" author="jvz" created="Tue, 2 Aug 2016 18:40:04 +0000"  >&lt;p&gt;I cam across this issue during the 2.2 rc1. I came to the same conclusion as the patch here (see the duplicate ticket). I&apos;m trying to get a working unit test using pax-exam, but it&apos;s a bit more difficult than I expected.&lt;/p&gt;</comment>
                            <comment id="15404626" author="smigfu" created="Tue, 2 Aug 2016 19:18:59 +0000"  >&lt;p&gt;If you change ths osgi.import declaration to &quot;&amp;lt;commons.osgi.import&amp;gt;*&amp;lt;/commons.osgi.import&amp;gt;&quot; it works w/o problem (see also my previous comment).&lt;/p&gt;</comment>
                            <comment id="15404640" author="jvz" created="Tue, 2 Aug 2016 19:28:11 +0000"  >&lt;p&gt;It looks like version 1.1 is needed at least (&lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-445&quot; title=&quot;java.lang.NoClassDefFoundError: javax/transaction/SystemException after update&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-445&quot;&gt;&lt;del&gt;DBCP-445&lt;/del&gt;&lt;/a&gt;), so a version range would be more appropriate anyways. That&apos;s the problem with Java EE APIs; they aren&apos;t versioned properly for OSGi.&lt;/p&gt;</comment>
                            <comment id="15404656" author="jvz" created="Tue, 2 Aug 2016 19:47:58 +0000"  >&lt;p&gt;Fixed in revision 1754999. I gave up on trying to make a pax-exam unit test as it&apos;s far too complicated to get working for this type of use case. Right now, the best way to verify that this works is to simply install the jar (and dependencies) to a Karaf container and make sure you can run &lt;tt&gt;bundle:start&lt;/tt&gt; on it. More proper OSGi tests are included in the &lt;a href=&quot;https://github.com/ops4j/org.ops4j.pax.jdbc/tree/master/pax-jdbc-pool-dbcp2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;pax-jdbc version&lt;/a&gt; of dbcp2.&lt;/p&gt;</comment>
                            <comment id="15404762" author="garydgregory" created="Tue, 2 Aug 2016 20:50:12 +0000"  >&lt;p&gt;Can you not do something like we do in Log4j using Equinox or Felix?&lt;/p&gt;</comment>
                            <comment id="15404769" author="jvz" created="Tue, 2 Aug 2016 21:00:45 +0000"  >&lt;p&gt;Log4j doesn&apos;t require any dependencies, but dbcp does, so it makes it a lot more complicated than the AbstractLoadBundleTest from Log4j. I figured pax-exam would provide the capability of adding all those dependencies for me, but then I got other errors instead that are unrelated to dbcp or osgi. &lt;a href=&quot;https://github.com/ops4j/org.ops4j.pax.jdbc/blob/master/pax-jdbc-itest/src/test/java/org/ops4j/pax/jdbc/test/pool/PoolDbcp2Test.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Here&apos;s a related test&lt;/a&gt; that would fail if dbcp itself was exporting the wrong headers (as with this bug). The thing is with pax projects is that these types of tests are run in a separate maven module, presumably to prevent the issues I was having, and that would require a restructuring of dbcp which is rather complicated.&lt;/p&gt;</comment>
                            <comment id="15404781" author="garydgregory" created="Tue, 2 Aug 2016 21:05:17 +0000"  >&lt;p&gt;Is that because the test wants to load a jar as opposed to a .class files from a Maven target folder?&lt;/p&gt;</comment>
                            <comment id="15404789" author="jvz" created="Tue, 2 Aug 2016 21:08:03 +0000"  >&lt;p&gt;Yeah, basically. That&apos;s how pax-exam is supposed to work by default which sounds rather out of place when you&apos;re trying to integration test modules in the same repository (e.g., snapshot builds). I might be reading the documentation wrong, but even that is unhelpful as all the examples are too trivial.&lt;/p&gt;</comment>
                            <comment id="15404799" author="garydgregory" created="Tue, 2 Aug 2016 21:11:41 +0000"  >&lt;p&gt;Testing a jar makes sense to me. It just makes sure that we are testing what the users will use. The bigger issue is that we should do this for all Commons component to make a jar from loaded in an OSGi container.&lt;/p&gt;</comment>
                            <comment id="15404817" author="jvz" created="Tue, 2 Aug 2016 21:17:55 +0000"  >&lt;p&gt;It would be really neat to make a more commons-friendly generic unit test that can be copied around to make sure that each component properly installs into an OSGi container.&lt;/p&gt;</comment>
                            <comment id="15404829" author="garydgregory" created="Tue, 2 Aug 2016 21:21:55 +0000"  >&lt;p&gt;My thoughts precisely!&lt;/p&gt;</comment>
                            <comment id="15404834" author="jvz" created="Tue, 2 Aug 2016 21:25:49 +0000"  >&lt;p&gt;I&apos;ve created &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-467&quot; title=&quot;Add OSGi integration tests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-467&quot;&gt;&lt;del&gt;DBCP-467&lt;/del&gt;&lt;/a&gt; to add such a test here at least. Maybe it could end up being generified to a sort of commons-osgi-itest type of artifact that can be included as a test-scoped dependency on each commons project. Then each project can reuse those generic tests.&lt;/p&gt;</comment>
                            <comment id="15412100" author="jvz" created="Mon, 8 Aug 2016 17:16:06 +0000"  >&lt;p&gt;I don&apos;t think that partial thing is correct, either. I get the following error when installing this new version in Karaf 3.0.4:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.Exception: Could not start bundle mvn:org.apache.commons/commons-dbcp2/2.2 in feature(s) commons-dbcp2-2.2: Unresolved constraint in bundle org.apache.commons.dbcp2 [269]: Unable to resolve 269.0: missing requirement [269.0] osgi.wiring.package; (&amp;amp;(osgi.wiring.package=javax.transaction.xa)(version&amp;gt;=1.1.0)(partial=true))
	at org.apache.karaf.features.internal.FeaturesServiceImpl.startBundle(FeaturesServiceImpl.java:521)[20:org.apache.karaf.features.core:3.0.4]
	at org.apache.karaf.features.internal.FeaturesServiceImpl.installFeatures(FeaturesServiceImpl.java:476)[20:org.apache.karaf.features.core:3.0.4]
	at org.apache.karaf.features.internal.FeaturesServiceImpl.installFeature(FeaturesServiceImpl.java:417)[20:org.apache.karaf.features.core:3.0.4]
	at Proxy3ddcd89e_6018_4343_b5b3_8693418616e1.installFeature(Unknown Source)[:]
	at Proxy1c5ca9a8_a504_40c1_a273_6f4767d76de4.installFeature(Unknown Source)[:]
	at org.apache.karaf.kar.internal.KarServiceImpl.installFeatures(KarServiceImpl.java:215)[109:org.apache.karaf.kar.core:3.0.4]
	at org.apache.karaf.kar.internal.KarServiceImpl.install(KarServiceImpl.java:96)[109:org.apache.karaf.kar.core:3.0.4]
	at org.apache.karaf.kar.internal.KarServiceImpl.install(KarServiceImpl.java:84)[109:org.apache.karaf.kar.core:3.0.4]
	at Proxy670dd4c1_ba32_408b_9988_4daea71b6bc9.install(Unknown Source)[:]
	at Proxye95b24d0_c408_4277_a3ea_4b500b9f30a0.install(Unknown Source)[:]
	at org.apache.karaf.deployer.kar.KarArtifactInstaller.install(KarArtifactInstaller.java:50)[111:org.apache.karaf.deployer.kar:3.0.4]
	at Proxy370ffdac_0056_40be_877f_c9735fc99d7c.install(Unknown Source)[:]
	at org.apache.felix.fileinstall.internal.DirectoryWatcher.install(DirectoryWatcher.java:931)[7:org.apache.felix.fileinstall:3.5.0]
	at org.apache.felix.fileinstall.internal.DirectoryWatcher.install(DirectoryWatcher.java:865)[7:org.apache.felix.fileinstall:3.5.0]
	at org.apache.felix.fileinstall.internal.DirectoryWatcher.doProcess(DirectoryWatcher.java:482)[7:org.apache.felix.fileinstall:3.5.0]
	at org.apache.felix.fileinstall.internal.DirectoryWatcher.process(DirectoryWatcher.java:358)[7:org.apache.felix.fileinstall:3.5.0]
	at org.apache.felix.fileinstall.internal.DirectoryWatcher.run(DirectoryWatcher.java:310)[7:org.apache.felix.fileinstall:3.5.0]
Caused by: org.osgi.framework.BundleException: Unresolved constraint in bundle org.apache.commons.dbcp2 [269]: Unable to resolve 269.0: missing requirement [269.0] osgi.wiring.package; (&amp;amp;(osgi.wiring.package=javax.transaction.xa)(version&amp;gt;=1.1.0)(partial=true))
	at org.apache.felix.framework.Felix.resolveBundleRevision(Felix.java:3974)[org.apache.felix.framework-4.2.1.jar:]
	at org.apache.felix.framework.Felix.startBundle(Felix.java:2037)[org.apache.felix.framework-4.2.1.jar:]
	at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:955)[org.apache.felix.framework-4.2.1.jar:]
	at org.apache.felix.framework.BundleImpl.start(BundleImpl.java:942)[org.apache.felix.framework-4.2.1.jar:]
	at org.apache.karaf.features.internal.FeaturesServiceImpl.startBundle(FeaturesServiceImpl.java:518)[20:org.apache.karaf.features.core:3.0.4]
	... 16 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ve installed the transaction feature first which imports JTA 1.1.0, so it&apos;s definitely available.&lt;/p&gt;

&lt;p&gt;Also, some info about this partial/mandatory hack: &lt;a href=&quot;http://apache-geronimo.328035.n3.nabble.com/Understanding-the-quot-partial-true-mandatory-partial-quot-trick-td396729.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://apache-geronimo.328035.n3.nabble.com/Understanding-the-quot-partial-true-mandatory-partial-quot-trick-td396729.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16644898" author="vladimirfx" created="Wed, 10 Oct 2018 12:15:56 +0000"  >&lt;p&gt;Temporal workaround for Karaf with Pax Wrap protocol:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;wrap:mvn:org.apache.commons/commons-dbcp2/2.5.0$overwrite=merge&lt;font color=&quot;#6d9cbe&quot;&gt;&amp;amp;&lt;/font&gt;Import-Package=javax.transaction;version=&quot;1.1.0&quot;,javax.transaction.xa;version=&quot;1.1.0&quot;,javax.management,javax.naming,javax.naming.spi,javax.sql,org.apache.commons.logging,org.apache.commons.pool2,org.apache.commons.pool2.impl&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12994340">DBCP-465</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12791447" name="patch" size="744" author="pmarx" created="Fri, 4 Mar 2016 10:42:44 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 5 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2u5in:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>