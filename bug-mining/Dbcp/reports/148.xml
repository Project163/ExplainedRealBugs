<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:48:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DBCP-446] NullPointerException thrown when calling ManagedConnection.isClosed()</title>
                <link>https://issues.apache.org/jira/browse/DBCP-446</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Hello all,&lt;br/&gt;
I&apos;m using commons-dbcp 1.4, and I found this exception. I don&apos;t if it&apos;s reported already before, I have done some searches in google, but nothing found. &lt;/p&gt;

&lt;p&gt;Here is the call stack.&lt;/p&gt;

&lt;p&gt;2015-08-18 15:01:50,091 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-49&amp;#93;&lt;/span&gt; console : ERROR -   ... 44 more&lt;br/&gt;
2015-08-18 16:04:57,963 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-45&amp;#93;&lt;/span&gt; console : ERROR - java.lang.NullPointerException&lt;br/&gt;
2015-08-18 16:04:57,965 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-45&amp;#93;&lt;/span&gt; console : ERROR -   at org.apache.commons.dbcp.DelegatingConnection.isClosed(DelegatingConnection.java:386)&lt;br/&gt;
2015-08-18 16:04:57,965 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-45&amp;#93;&lt;/span&gt; console : ERROR -   at org.hibernate.engine.jdbc.internal.LogicalConnectionImpl.releaseConnection(LogicalConnectionImpl.java:237)&lt;br/&gt;
2015-08-18 16:04:57,965 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-45&amp;#93;&lt;/span&gt; console : ERROR -   at org.hibernate.engine.jdbc.internal.LogicalConnectionImpl.aggressiveRelease(LogicalConnectionImpl.java:200)&lt;br/&gt;
2015-08-18 16:04:57,965 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-45&amp;#93;&lt;/span&gt; console : ERROR -   at org.hibernate.engine.jdbc.internal.JdbcCoordinatorImpl.afterTransaction(JdbcCoordinatorImpl.java:272)&lt;br/&gt;
2015-08-18 16:04:57,965 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-45&amp;#93;&lt;/span&gt; console : ERROR -   at org.hibernate.engine.transaction.internal.TransactionCoordinatorImpl.afterTransaction(TransactionCoordinatorImpl.java:144)&lt;br/&gt;
2015-08-18 16:04:57,965 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-45&amp;#93;&lt;/span&gt; console : ERROR -   at org.hibernate.engine.transaction.internal.jta.JtaTransaction.afterAfterCompletion(JtaTransaction.java:179)&lt;br/&gt;
2015-08-18 16:04:57,966 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-45&amp;#93;&lt;/span&gt; console : ERROR -   at org.hibernate.engine.transaction.spi.AbstractTransactionImpl.rollback(AbstractTransactionImpl.java:219)&lt;/p&gt;

&lt;p&gt;So when I debugged it, it created a ManagedConnection, which is a sub-class of DelegatingConnection, and the _conn is initialized with null, and the _closed is false by default. So when hibernate calls the isClosed(), it throws a nullpointer exception.&lt;/p&gt;

&lt;p&gt;Could you guys tell me if in your side, or the hibernate side ?&lt;br/&gt;
Do not hesitate to contact me if you need more information.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12856937">DBCP-446</key>
            <summary>NullPointerException thrown when calling ManagedConnection.isClosed()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="yfeng">feng yang</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Aug 2015 14:51:57 +0000</created>
                <updated>Wed, 2 Nov 2016 21:52:33 +0000</updated>
                            <resolved>Thu, 21 Jul 2016 03:56:59 +0000</resolved>
                                    <version>1.4</version>
                    <version>2.1.1</version>
                                    <fixVersion>2.2.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14701642" author="psteitz" created="Tue, 18 Aug 2015 17:25:38 +0000"  >&lt;p&gt;This looks like the same issue (at least will get fixed by the same change) as &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-438&quot; title=&quot;Nested connections in a transaction (local) throws null pointer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-438&quot;&gt;&lt;del&gt;DBCP-438&lt;/del&gt;&lt;/a&gt;.  Should backport the fix for 1.4.1, assuming there is a 1.4.1.  Upgrading to 2.1.1 should also fix this.&lt;/p&gt;</comment>
                            <comment id="15380842" author="lagar84" created="Sat, 16 Jul 2016 16:28:02 +0000"  >&lt;p&gt;On 2.1.1 i also having nullpointerexception on isClosed&lt;br/&gt;
Did not find the null check there.&lt;br/&gt;
Is this a different issue?&lt;/p&gt;</comment>
                            <comment id="15383141" author="lagar84" created="Mon, 18 Jul 2016 21:47:28 +0000"  >&lt;p&gt;Since I am not the issue owner, could the reporter or an admin change the Affect version to also include 2.1.1? I could sucefully reproduce the same problem on 2.1.1 (using hibernate 4 and a conn pool org.apache.commons.dbcp2.managed.BasicManagedDataSource).&lt;br/&gt;
Altering the source code to put a null check on isClosed, no errors found:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;org.apache.commons.dbcp2.DelegatingConnection.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isClosed() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; SQLException {
    	
    	&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(_conn == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;   &lt;span class=&quot;code-comment&quot;&gt;//I put &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; line to make the error go away
&lt;/span&gt;    	
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; _closed || _conn.isClosed();
    }

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15387111" author="garydgregory" created="Thu, 21 Jul 2016 03:56:59 +0000"  >&lt;p&gt;The fix I made is:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isClosed() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; SQLException {
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; _closed || _conn == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; || _conn.isClosed();
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15392562" author="lagar84" created="Mon, 25 Jul 2016 19:54:31 +0000"  >&lt;p&gt;Thanks Gary!&lt;br/&gt;
Is there an estimate when a version of DBCP will be released with this fix?&lt;/p&gt;</comment>
                            <comment id="15393985" author="garydgregory" created="Tue, 26 Jul 2016 15:51:36 +0000"  >&lt;p&gt;There is no planned release date at the moment, but someone already expressed interested in volunteering to be the release manager. Could be a week or two, or more. I am sorry I cannot be more precise.&lt;/p&gt;</comment>
                            <comment id="15394320" author="jvz" created="Tue, 26 Jul 2016 18:49:49 +0000"  >&lt;p&gt;I&apos;ll be working on starting the release this week, so if the release candidate goes well, it should be released by next week.&lt;/p&gt;</comment>
                            <comment id="15394342" author="lagar84" created="Tue, 26 Jul 2016 19:02:14 +0000"  >&lt;p&gt;Excellent news, thank you all!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12986783">DBCP-464</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 16 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2j233:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>