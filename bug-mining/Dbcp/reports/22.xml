<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:46:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DBCP-241] NPE in case of an SQLException to be thrown on checkOpen() in DelegatingConnection</title>
                <link>https://issues.apache.org/jira/browse/DBCP-241</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;I only got it from the Spring forums (&lt;a href=&quot;http://forum.springframework.org/showthread.php?t=44068&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://forum.springframework.org/showthread.php?t=44068&lt;/a&gt;). I have no idea which version or if it is already fixed. It should be easy to review.&lt;/p&gt;

&lt;p&gt;Stacktrace:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
	at org.apache.commons.dbcp.PoolingConnection.toString(PoolingConnection.java:248)&lt;br/&gt;
	at java.lang.String.valueOf(String.java:2615)&lt;br/&gt;
	at java.lang.StringBuffer.append(StringBuffer.java:220)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingConnection.checkOpen(DelegatingConnection.java:354)&lt;br/&gt;
	at org.apache.commons.dbcp.DelegatingConnection.prepareStatement(DelegatingConnection.java:246)&lt;br/&gt;
	at org.apache.commons.dbcp.PoolingDataSource$PoolGuardConnectionWrapper.prepareStatement(PoolingDataSource.java:302)&lt;br/&gt;
	at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:505)&lt;br/&gt;
	at org.hibernate.jdbc.AbstractBatcher.getPreparedStatement(AbstractBatcher.java:423)&lt;br/&gt;
	at org.hibernate.jdbc.AbstractBatcher.prepareQueryStatement(AbstractBatcher.java:139)&lt;/p&gt;

&lt;p&gt;implementation of the method:&lt;/p&gt;

&lt;p&gt;    protected void checkOpen() throws SQLException {&lt;br/&gt;
        if(_closed) &lt;/p&gt;
{
            throw new SQLException
                (&quot;Connection &quot; + _conn + &quot; is closed.&quot;);
        }
&lt;p&gt;    }&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;

&lt;p&gt;Joerg&lt;/p&gt;</description>
                <environment></environment>
        <key id="12378929">DBCP-241</key>
            <summary>NPE in case of an SQLException to be thrown on checkOpen() in DelegatingConnection</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="joerg.heinicke@gmx.de">J&#246;rg Heinicke</reporter>
                        <labels>
                    </labels>
                <created>Sat, 22 Sep 2007 16:39:07 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Sun, 23 Sep 2007 19:51:47 +0000</resolved>
                                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12529692" author="psteitz" created="Sat, 22 Sep 2007 20:06:24 +0000"  >&lt;p&gt;Thanks for reporting this bug, which is a regression in 1.2.2  from &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-187&quot; title=&quot;[dbcp] Make exceptions about closed connections and statements more easily debuggable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-187&quot;&gt;&lt;del&gt;DBCP-187&lt;/del&gt;&lt;/a&gt;.  &lt;/p&gt;</comment>
                            <comment id="12529731" author="psteitz" created="Sun, 23 Sep 2007 05:13:13 +0000"  >&lt;p&gt;The following code reproduces this bug using DBCP 1.2.2:&lt;br/&gt;
conn = new DelegatingConnection( new PoolingConnection&lt;br/&gt;
    (delegateConn2, new GenericKeyedObjectPool()));  &lt;br/&gt;
try &lt;/p&gt;
{
    conn.close();
 }
&lt;p&gt; catch (Exception ex) {}&lt;br/&gt;
 conn.prepareStatement(&quot;&quot;);&lt;/p&gt;

&lt;p&gt;The NPE is generated by this line in PoolingConnection.toString:&lt;br/&gt;
return &quot;PoolingConnection: &quot; + _pstmtPool.toString();&lt;/p&gt;

&lt;p&gt;The &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-187&quot; title=&quot;[dbcp] Make exceptions about closed connections and statements more easily debuggable&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-187&quot;&gt;&lt;del&gt;DBCP-187&lt;/del&gt;&lt;/a&gt; change to checkOpen in DelegatingException exposed this NPE vulnerability in PoolingConnection.  Others exist in this class as well and all should be fixed before this bug is closed.&lt;/p&gt;

&lt;p&gt;To avoid this and other NPEs, DBCP 1.x users should avoid calling prepareStatement methods on closed PoolingConnections.&lt;/p&gt;</comment>
                            <comment id="12529744" author="psteitz" created="Sun, 23 Sep 2007 15:27:58 +0000"  >&lt;p&gt;s/DelegatingException/DelegatingConnection in last comment.&lt;/p&gt;</comment>
                            <comment id="12529760" author="psteitz" created="Sun, 23 Sep 2007 19:51:47 +0000"  >&lt;p&gt;Fixed in r 578597.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>41899</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 9 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uwbz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178379</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>