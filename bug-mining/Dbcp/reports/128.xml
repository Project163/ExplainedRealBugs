<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:48:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DBCP-432] BasicDataSource createDataSource can return partially initialized DataSource</title>
                <link>https://issues.apache.org/jira/browse/DBCP-432</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;The BasicDataSource instance variable, dataSource, is DCL-controlled in createDataSource; but within the sync block it is set directly and then subsequently initialized.  Threads that request connections, or access createDataSource directly while initialization is in progress will get partially initialized dataSources.  In particular, logWriters may be null and initial pool capacity may not be provisioned (if initialSize &amp;gt; 0).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12771547">DBCP-432</key>
            <summary>BasicDataSource createDataSource can return partially initialized DataSource</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="psteitz">Phil Steitz</reporter>
                        <labels>
                    </labels>
                <created>Sat, 31 Jan 2015 19:40:55 +0000</created>
                <updated>Tue, 24 Feb 2015 03:23:08 +0000</updated>
                            <resolved>Wed, 4 Feb 2015 13:44:22 +0000</resolved>
                                    <version>2.0</version>
                                    <fixVersion>2.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14299956" author="psteitz" created="Sat, 31 Jan 2015 19:45:06 +0000"  >&lt;p&gt;Patch to fix this issue, with unit test.&lt;/p&gt;</comment>
                            <comment id="14299968" author="adrianc@hlmksw.com" created="Sat, 31 Jan 2015 20:23:45 +0000"  >&lt;p&gt;Why not use AtomicReference?&lt;/p&gt;</comment>
                            <comment id="14299978" author="adrianc@hlmksw.com" created="Sat, 31 Jan 2015 20:48:00 +0000"  >&lt;p&gt;I&apos;m not a DBCP expert, but maybe the attached patch will be of some use.&lt;/p&gt;</comment>
                            <comment id="14300039" author="psteitz" created="Sun, 1 Feb 2015 00:34:44 +0000"  >&lt;p&gt;Thanks for  having a look, Adrian!&lt;/p&gt;

&lt;p&gt;The problem we have here is that we need the sync protection around the initialization block, which is just executed once, by the first thread that tries to get a connection to the pool (or non-standardly, by a thread that directly calls createDataSource).   We only want that code executed once.   Once the datasource is created and initialized, we want subsequent calls to return as fast as possible.  That is why the DCL setup is there.  What my patch does is to delay setting the instance field until it is initialized fully.  One could argue that it is better to let the pre-loading happen while other requests get served.  The dbcp/pool setup is robust enough so that does not cause problems.&lt;/p&gt;</comment>
                            <comment id="14301982" author="markt" created="Mon, 2 Feb 2015 21:42:44 +0000"  >&lt;p&gt;Your first patch looks good to me.&lt;/p&gt;</comment>
                            <comment id="14305076" author="psteitz" created="Wed, 4 Feb 2015 13:44:22 +0000"  >&lt;p&gt;First patch applied in r1657221.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12695771" name="DBCP-432-AtomicReference.patch" size="2941" author="adrianc@hlmksw.com" created="Sat, 31 Jan 2015 20:48:00 +0000"/>
                            <attachment id="12695767" name="DBCP-432.patch" size="3361" author="psteitz" created="Sat, 31 Jan 2015 19:45:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 41 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i251mn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>