<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:46:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DBCP-102] [dbcp] setReadOnly &amp; setAutoCommit called too many times</title>
                <link>https://issues.apache.org/jira/browse/DBCP-102</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;In order to gain some processor time for my application that uses Hibernate, I &lt;br/&gt;
looked with optimizeIt where it spends time. It seems that for a request on the &lt;br/&gt;
database (Oracle 9) around 25% (!!?) is spent on getting the connection from &lt;br/&gt;
the DBCP pool, and this not only the first time!. The methods that provoke this &lt;br/&gt;
loss of time are connection.setReadOnly and connection.setAutoCommit called &lt;br/&gt;
inside the method PoolableConnectionFactory.activateObject. Looking to the &lt;br/&gt;
stack, these calls translate to communication with the Oracle server. &lt;br/&gt;
The obvious thing to do is to check if read only and autocommit flags are &lt;br/&gt;
already set to the expected values. (Of course, Oracle could &apos;ve done this too, &lt;br/&gt;
but I hope you&apos;ll have a faster response &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; )&lt;/p&gt;

&lt;p&gt;Thank you very much for you help.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Operating System: other&lt;br/&gt;
Platform: Sun&lt;/p&gt;</environment>
        <key id="12341740">DBCP-102</key>
            <summary>[dbcp] setReadOnly &amp; setAutoCommit called too many times</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="acraciun@flashmail.com">AC</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Sep 2004 22:18:16 +0000</created>
                <updated>Mon, 16 Feb 2009 15:51:09 +0000</updated>
                            <resolved>Mon, 23 Jul 2007 19:02:58 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>1.2.2</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12407625" author="andy@agilbert.net" created="Fri, 18 Feb 2005 01:07:43 +0000"  >&lt;p&gt;We are experiencing a similar issue over a VPN connection where latency is&lt;br/&gt;
causing  problems when retrieving Connections from the pool. Testing a fix that&lt;br/&gt;
tests status of autocommit and readonly against default before setting&lt;br/&gt;
eliminates unecessary net traffic. The fix as applied to 1.2 of &quot;not set&quot; is not&lt;br/&gt;
suitable, as we definitely want the defaults set back if they have been changed,&lt;br/&gt;
ie Connections should come out of pool in known (default) state, but need to&lt;br/&gt;
avoid wasted network trip to set what is already set.&lt;/p&gt;
</comment>
                            <comment id="12407626" author="phil@steitz.com" created="Sun, 2 Apr 2006 09:01:02 +0000"  >&lt;p&gt;Fixed in r390763, nightlies starting 2 Apr 2006.&lt;/p&gt;</comment>
                            <comment id="12407627" author="pretbrao@yahoo.co.in" created="Thu, 20 Apr 2006 15:38:15 +0000"  >&lt;p&gt;(In reply to comment #2)&lt;br/&gt;
&amp;gt; Fixed in r390763, nightlies starting 2 Apr 2006.&lt;/p&gt;

&lt;p&gt;I just looked at the source code and activateObject() method in&lt;br/&gt;
PoolableConnectionfactory.java has been enhanced to first call&lt;br/&gt;
getAutoCommit() and then if needed call setAutoCommit().&lt;/p&gt;

&lt;p&gt;But as I have seen with OptimizeIt, passivateObject() too calls &lt;br/&gt;
setAutoCommit() without checking any condition, and that again &lt;br/&gt;
causes network overhead.&lt;/p&gt;

&lt;p&gt;Our application experiences about 20% difference in performance due &lt;br/&gt;
to this network overhead.&lt;/p&gt;

&lt;p&gt;a) should it too be fixed ?&lt;/p&gt;

&lt;p&gt;b) Is there no way to completely get rid of this network overhead due to&lt;br/&gt;
autoCommit? For example, if my application is sure that it will always use&lt;br/&gt;
autoCommit(true), then without any overhead I should be able to achieve it.&lt;br/&gt;
So, there should be a way to tell the DBCP that. &quot;let the application manage &lt;br/&gt;
all operations related to setting/getting auto commit&quot;. Same logic applies to &lt;br/&gt;
operation, that can be optionally turbed off. For example, here by optionally&lt;br/&gt;
not executing any code related to _defaultAutoCommit, we might achieve it.&lt;/p&gt;

&lt;p&gt;Thanks&lt;br/&gt;
Preetam&lt;/p&gt;</comment>
                            <comment id="12424433" author="psteitz" created="Sun, 30 Jul 2006 20:16:46 +0000"  >&lt;p&gt;Per last comment, passivateObject should also be fixed.&lt;/p&gt;</comment>
                            <comment id="12424439" author="psteitz" created="Sun, 30 Jul 2006 21:09:10 +0000"  >&lt;p&gt;passivateObject fix committed.&lt;/p&gt;</comment>
                            <comment id="12505838" author="pavel.sher" created="Mon, 18 Jun 2007 14:56:25 +0000"  >&lt;p&gt;It looks like the fix in passivateObject() is not quite correct. At the moment it sets auto commit to true if it was set to false:&lt;br/&gt;
if(!conn.getAutoCommit()) {&lt;br/&gt;
   conn.setAutoCommit(true);&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;In our system we set default auto commit to false and now every time when connection is passivated we see unnecessary cal to setAutoCommit(true). For me passivateObject should reset auto commit to default value.&lt;/p&gt;</comment>
                            <comment id="12505930" author="psteitz" created="Mon, 18 Jun 2007 19:22:35 +0000"  >&lt;p&gt;Setting fix level to 1.3, as fix represents a behavior change for passivateObject  vs. 1.2 base.  The fix in 1.2.2 retained (broken?) 1.2.1 behavior.&lt;/p&gt;</comment>
                            <comment id="12505943" author="psteitz" created="Mon, 18 Jun 2007 20:27:46 +0000"  >&lt;p&gt;The hard-coded &lt;b&gt;true&lt;/b&gt; value for autoCommit in passivateObject was introduced to resolve &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-97&quot; title=&quot;setAutoCommit(true) when returning connection to the pool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-97&quot;&gt;&lt;del&gt;DBCP-97&lt;/del&gt;&lt;/a&gt; in r132043 (DBCP 1.1 release)&lt;/p&gt;</comment>
                            <comment id="12514733" author="dain" created="Mon, 23 Jul 2007 19:02:58 +0000"  >&lt;p&gt;Fixed some time ago.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12340987">DBCP-97</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_10010" key="com.atlassian.jira.plugin.system.customfieldtypes:importid">
                        <customfieldname>Bugzilla Id</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>31343</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                    <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114385</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvjb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178250</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>