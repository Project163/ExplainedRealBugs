<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:46:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DBCP-225] getConnection / borrowObject fails with NullPointerException</title>
                <link>https://issues.apache.org/jira/browse/DBCP-225</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;We use dbcp PoolingDataSource in Solaris/Oracle 10g RAC environment and our getConnection calls fail sporadically with the following stack trace (1.2.1)&lt;/p&gt;

&lt;p&gt;Caused by: org.apache.commons.dbcp.SQLNestedException: Cannot get a connection, pool exhausted&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:103)&lt;br/&gt;
        at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:540)&lt;br/&gt;
        ... more&lt;br/&gt;
Caused by: java.util.NoSuchElementException: Could not create a validated object, cause: null&lt;br/&gt;
        at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:806)&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:95)&lt;br/&gt;
        ... 24 more&lt;/p&gt;

&lt;p&gt;This is definitely not a &quot;pool exhausted&quot; situation, it is just being reported as pool exhausted. Since NoSuchElementException that you use does not allow cause, only Exception message (null) is being printed. With some debugging I was able to recover the root exception:&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
    at org.apache.commons.dbcp.DelegatingConnection.setAutoCommit(DelegatingConnection.java:268)&lt;br/&gt;
    at org.apache.commons.dbcp.PoolableConnectionFactory.activateObject(PoolableConnectionFactory.java:368)&lt;br/&gt;
    at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:786)&lt;br/&gt;
    at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:95)&lt;br/&gt;
    at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:540)&lt;br/&gt;
...&lt;/p&gt;

&lt;p&gt;Looks like it is trying to borrow/validate DelegatingConnection which delegate is null.&lt;/p&gt;



&lt;p&gt;Hoping to resolve the issue we upgraded to 1.2.2 but it did not help. Here is is an exception stack trace from 1.2.2:&lt;/p&gt;

&lt;p&gt;org.apache.commons.dbcp.SQLNestedException: Cannot get a connection, pool error Could not create a validated object, cause: null&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:104)&lt;br/&gt;
        at org.apache.commons.dbcp.BasicDataSource.getConnection(BasicDataSource.java:880)&lt;br/&gt;
        ... more&lt;br/&gt;
Caused by: java.util.NoSuchElementException: Could not create a validated object, cause: null&lt;br/&gt;
        at org.apache.commons.pool.impl.GenericObjectPool.borrowObject(GenericObjectPool.java:871)&lt;br/&gt;
        at org.apache.commons.dbcp.PoolingDataSource.getConnection(PoolingDataSource.java:96)&lt;br/&gt;
        ... 28 more&lt;/p&gt;


&lt;p&gt;We use the following dbcp properties:&lt;/p&gt;

&lt;p&gt;autoCommit=&quot;false&quot;&lt;br/&gt;
readOnly=&quot;false&quot;&lt;br/&gt;
maxActive=&quot;200&quot;&lt;br/&gt;
maxIdle=&quot;20&quot;&lt;br/&gt;
minIdle=&quot;10&quot;&lt;br/&gt;
minEvictableIdleIime=&quot;300000&quot;&lt;br/&gt;
maxWait=&quot;200&quot;&lt;br/&gt;
accessToUnderlyingConnectionAllowed=&quot;true&quot;&lt;br/&gt;
validationQuery=&quot;SELECT 1 FROM DUAL&quot;&lt;br/&gt;
ConnectionCachingEnabled=&quot;true&quot;&lt;br/&gt;
FastConnectionFailoverEnabled=&quot;true&quot;&lt;/p&gt;



&lt;p&gt;I could not find the existing reported dbcp/object pool bug but I see similar  reports on the web, for example &lt;br/&gt;
&lt;a href=&quot;http://forum.java.sun.com/thread.jspa?threadID=713200&amp;amp;messageID=4124915&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://forum.java.sun.com/thread.jspa?threadID=713200&amp;amp;messageID=4124915&lt;/a&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Solaris 10, Oracle 10g RAC&lt;/p&gt;</environment>
        <key id="12370054">DBCP-225</key>
            <summary>getConnection / borrowObject fails with NullPointerException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dain">Dain Sundstrom</assignee>
                                    <reporter username="asamonov">Alexei Samonov</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 May 2007 14:12:02 +0000</created>
                <updated>Tue, 25 Mar 2008 08:11:36 +0000</updated>
                            <resolved>Mon, 23 Jul 2007 19:53:39 +0000</resolved>
                                    <version>1.2.1</version>
                    <version>1.2.2</version>
                                    <fixVersion>1.3</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12498695" author="saruman" created="Thu, 24 May 2007 16:08:15 +0000"  >&lt;p&gt;The situation is even more mysterious since the DelegatingConnection in question is PoolableConnection, and no code ever calls setDelegate(null) on PoolableConnection.&lt;/p&gt;</comment>
                            <comment id="12499420" author="psteitz" created="Sun, 27 May 2007 17:30:19 +0000"  >&lt;p&gt;Based on the stack traces, it looks like you are using pool 1.2, correct?  From the trace it looks like the NPE is occuring when a newly created connection is being validated.   Do you see any connection errors in the database logs?  These should throw SQLExceptions, though, which are not being reported.  Another thing to try is to turn off Oracle&apos;s Connection caching (I assume that is what ConnectionCachingEnabled=&quot;true&quot;  means). &lt;/p&gt;</comment>
                            <comment id="12500165" author="asamonov" created="Wed, 30 May 2007 15:29:01 +0000"  >&lt;p&gt;Yes we were using 1.2 , then we upgraded to 1.3 which did not  help. We have to use OracleConnection caching because it is a prerequisite to Oracle&apos;s RAC Fast Connection Failure (fcf). We will try to play with Oracle cache parameters such as MaxLimit - it was set to 5 and we will try 200 that would match the max dbcp pool size. I will report test results once I have them.&lt;/p&gt;</comment>
                            <comment id="12514073" author="dain" created="Fri, 20 Jul 2007 01:45:31 +0000"  >&lt;p&gt;This patch checks for null returned from connection factory and throws an IllegalStateException.  We may want to go with a SQLException instead.&lt;/p&gt;

&lt;p&gt;I don&apos;t think this will fix Alexei&apos;s problem, but at least will cause a fast failure instead of getting a strange &quot;hollow&quot; connection.  Alternatively, if we just need to ask Oracle again for a connection, we could put a retry loop in the connection factory.&lt;/p&gt;</comment>
                            <comment id="12514761" author="dain" created="Mon, 23 Jul 2007 19:53:39 +0000"  >&lt;p&gt;Sending        src/java/org/apache/commons/dbcp/PoolableConnectionFactory.java&lt;br/&gt;
Sending        src/java/org/apache/commons/dbcp/datasources/CPDSConnectionFactory.java&lt;br/&gt;
Sending        src/java/org/apache/commons/dbcp/datasources/KeyedCPDSConnectionFactory.java&lt;br/&gt;
Transmitting file data ...&lt;br/&gt;
Committed revision 558846.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12369945">DBCP-224</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12362188" name="DBCP-225.patch" size="2370" author="dain" created="Fri, 20 Jul 2007 01:45:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>114505</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0uvpz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>178280</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>