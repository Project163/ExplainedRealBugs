<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:48:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DBCP-484] Connection leak during XATransaction in high load</title>
                <link>https://issues.apache.org/jira/browse/DBCP-484</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;We&apos;re experiencing a connection leak in a distributed transaction when the system is under heavy load. We&apos;re using commons-dbcp (latest version) + eclipselink and narayana to perform transaction coordination.&lt;/p&gt;

&lt;p&gt;From time to time we can see a stacktrace reporting an abandoned connection. We are trying to figure out what&apos;s the root cause and we think that might be some issue in the commons dbcp (not sure) . More specifically, this parte of the code:&lt;/p&gt;

&lt;p&gt;ManagedConnection#updateTransactionStatus&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (transactionContext != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (transactionContext.isActive()) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (transactionContext != transactionRegistry.getActiveTransactionContext()) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SQLException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Connection can not be used &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; enlisted in another transaction&quot;&lt;/span&gt;);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
    }
    &lt;span class=&quot;code-comment&quot;&gt;// transaction should have been cleared up by TransactionContextListener, but in
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// rare cases another lister could have registered which uses the connection before
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// our listener is called.  In that rare &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;, trigger the transaction complete call now
&lt;/span&gt;    transactionComplete();    
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If the&#160;transactionContext is different than null but the state is not &quot;active&quot; (ex:&#160;STATUS_ROLLEDBACK, STATUS_ROLLING_BACK, etc) it executes the&#160;transactionComplete mothod that clears the reference to a shared connection and after that the connection is never closed (returned to the pool).&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If we move the transactionComplete(); to an else,(see below), the connection leak does not happen.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (transactionContext != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (transactionContext.isActive()) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (transactionContext != transactionRegistry.getActiveTransactionContext()) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SQLException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Connection can not be used &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; enlisted in another transaction&quot;&lt;/span&gt;);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
    }
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
    transactionComplete();
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;After this the&#160;dbcp unit tests still pass but I&apos;m not sure about this changes. Can you please check?&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13133723">DBCP-484</key>
            <summary>Connection leak during XATransaction in high load</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ejsfreitas">Emanuel Freitas</reporter>
                        <labels>
                    </labels>
                <created>Thu, 25 Jan 2018 15:48:48 +0000</created>
                <updated>Tue, 8 Jan 2019 20:49:05 +0000</updated>
                            <resolved>Mon, 21 May 2018 14:44:39 +0000</resolved>
                                    <version>2.2.0</version>
                                    <fixVersion>2.4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="16339444" author="garydgregory" created="Thu, 25 Jan 2018 16:18:11 +0000"  >&lt;p&gt;Hello and thank you for your report.&lt;/p&gt;

&lt;p&gt;Can you make sure you are also bringing in Apache Commons 2.5.0?&lt;/p&gt;

&lt;p&gt;Can you provide a small test case program that reproduces the problem? Preferably in the for a JUnit test case?&lt;/p&gt;

&lt;p&gt;Thank you!&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="16343701" author="ejsfreitas" created="Mon, 29 Jan 2018 17:50:07 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;, thanks for your fast answer.&lt;/p&gt;

&lt;p&gt;As you asked I&apos;m working on a small test case but without any success yet.&#160;&lt;/p&gt;

&lt;p&gt;Yes, I&apos;m also using Apache Commons 2.5.0&lt;/p&gt;

&lt;p&gt;Kind regards,&lt;/p&gt;

&lt;p&gt;Emanuel&lt;/p&gt;</comment>
                            <comment id="16343981" author="garydgregory" created="Mon, 29 Jan 2018 20:40:09 +0000"  >&lt;p&gt;OK, let us know when you get that unit test working/failing. Above, I meant Apache Commons POOL 2.5.0 coupled with Apache Commons DBCP 2.2.0.&lt;/p&gt;</comment>
                            <comment id="16346724" author="ejsfreitas" created="Wed, 31 Jan 2018 12:20:18 +0000"  >&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;For some reason (JIRA could not attach the file as there was a missing token. Please try attaching the file again.) i&apos;m not able to atach the files.&#160;&lt;/p&gt;

&lt;p&gt;Where is a link to dropbox:&#160;&lt;a href=&quot;https://www.dropbox.com/s/g0oiz2wizmedeqs/dbcp-test.zip?dl=0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.dropbox.com/s/g0oiz2wizmedeqs/dbcp-test.zip?dl=0&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;If you run the TeskLeak you can see that if you increase the number of threads (nthreads) you start getting some leaks. On our project I was able to fix the issue with the code that I posted above, but for this test the problem is something else.&#160;&lt;/p&gt;

&lt;p&gt;For this tests I was using a PostgreSQL database.&lt;/p&gt;

&lt;p&gt;Thanks for your help.&lt;/p&gt;

&lt;p&gt;Kind regards,&lt;/p&gt;

&lt;p&gt;Emanuel&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16369153" author="ejsfreitas" created="Mon, 19 Feb 2018 14:16:07 +0000"  >&lt;p&gt;Hello&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;, did you had the chance to see the test?&#160;&lt;/p&gt;

&lt;p&gt;Kind regards,&lt;/p&gt;

&lt;p&gt;Emanuel&lt;/p&gt;</comment>
                            <comment id="16390640" author="zhfeng" created="Thu, 8 Mar 2018 02:53:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ejsfreitas&quot; class=&quot;user-hover&quot; rel=&quot;ejsfreitas&quot;&gt;ejsfreitas&lt;/a&gt;, I&apos;m from the narayana team and I&apos;m looking into this test. can you provide the command to run the TestLeak ?&lt;/p&gt;

&lt;p&gt;I just use &quot;mvn clean test&quot; but it looks like can not run the test.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Amos&lt;/p&gt;</comment>
                            <comment id="16410711" author="zhfeng" created="Fri, 23 Mar 2018 02:20:02 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I think there might be a race condition when closing the ManagedConnection&lt;/p&gt;

&lt;p&gt;There are two methods which could call connection.close() and the one is in &lt;a href=&quot;https://github.com/apache/commons-dbcp/blob/master/src/main/java/org/apache/commons/dbcp2/managed/ManagedConnection.java#L160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ManagedConnection.close()&lt;/a&gt; and the other is &lt;a href=&quot;https://github.com/apache/commons-dbcp/blob/master/src/main/java/org/apache/commons/dbcp2/managed/ManagedConnection.java#L188&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;ManagedConncetion.transactionComplete()&lt;/a&gt; which is used in calling back when the transaction is completed.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void close() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; SQLException {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!isClosedInternal()) {
            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                &lt;span class=&quot;code-comment&quot;&gt;// Don&apos;t actually close the connection &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; in a transaction. The
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// connection will be closed by the transactionComplete method.
&lt;/span&gt;                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (transactionContext == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                    &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.close();
                }
            } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
                setClosedInternal(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
            }
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The thread of close() could be switched after check (transactionContext == null) and before the setCloseInternal(true). So it thinks it is still in a transaction but dose not set the _closed.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; void transactionComplete() {
        transactionContext = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;

        &lt;span class=&quot;code-comment&quot;&gt;// If we were using a shared connection, clear the reference now that
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// the transaction has completed
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isSharedConnection) {
            setDelegate(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
            isSharedConnection = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
        }

        &lt;span class=&quot;code-comment&quot;&gt;// If &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; connection was closed during the transaction and there is
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// still a delegate present close it
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Connection delegate = getDelegateInternal();
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isClosedInternal() &amp;amp;&amp;amp; delegate != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
                setDelegate(&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);

                &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!delegate.isClosed()) {
                    delegate.close();
                }
            } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; SQLException ignored) {
                &lt;span class=&quot;code-comment&quot;&gt;// Not a whole lot we can &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; here as connection is closed
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// and &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; is a transaction callback so there is no
&lt;/span&gt;                &lt;span class=&quot;code-comment&quot;&gt;// way to report the error.
&lt;/span&gt;            }
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The thread of transationComplete() should check isClosedInternal() which is still false. So it will not close the connection. And the connection.close() is missed both in close() and transactionComplete(). I think it could be one cause of the connection leaking.&lt;/p&gt;</comment>
                            <comment id="16416323" author="garydgregory" created="Tue, 27 Mar 2018 22:11:19 +0000"  >&lt;p&gt;I attached the zip file from &lt;a href=&quot;https://www.dropbox.com/s/g0oiz2wizmedeqs/dbcp-test.zip?dl=0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.dropbox.com/s/g0oiz2wizmedeqs/dbcp-test.zip?dl=0&lt;/a&gt; to this ticket.&lt;/p&gt;</comment>
                            <comment id="16416993" author="zhfeng" created="Wed, 28 Mar 2018 07:49:44 +0000"  >&lt;p&gt;I just opened &lt;a href=&quot;https://github.com/apache/commons-dbcp/pull/10&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/commons-dbcp/pull/10&lt;/a&gt; for fixing this issue.&lt;/p&gt;</comment>
                            <comment id="16419046" author="garydgregory" created="Thu, 29 Mar 2018 14:04:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhfeng&quot; class=&quot;user-hover&quot; rel=&quot;zhfeng&quot;&gt;zhfeng&lt;/a&gt;:&lt;/p&gt;

&lt;p&gt;Thank you for your PR!&#160;&lt;/p&gt;

&lt;p&gt;Do you think you could augment your PR with a unit test that fails unless the &lt;tt&gt;main&lt;/tt&gt; portion of the patch is applied?&lt;/p&gt;

&lt;p&gt;Thank you,&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="16420264" author="zhfeng" created="Fri, 30 Mar 2018 07:56:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;, I think we can add a test to simulate the race condition with the &lt;a href=&quot;https://byteman.jboss.org/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Byteman&lt;/a&gt; tool which is licensed by the LGPL.&lt;br/&gt;
I&apos;m not sure this could be used in the apache project ?&lt;/p&gt;</comment>
                            <comment id="16421043" author="garydgregory" created="Fri, 30 Mar 2018 22:58:52 +0000"  >&lt;p&gt;Good question.&#160;IANAL, but it looks like a no: &lt;a href=&quot;https://www.apache.org/legal/resolved.html:&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.apache.org/legal/resolved.html:&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;GNU LGPLThe LGPL is ineligible primarily due to the restrictions it places on larger works, violating the third license criterion.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;More:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&lt;a href=&quot;https://www.apache.org/licenses/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.apache.org/licenses/&lt;/a&gt;&lt;br/&gt;
-&#160;&lt;a href=&quot;https://www.apache.org/foundation/license-faq.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.apache.org/foundation/license-faq.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16431873" author="zhfeng" created="Tue, 10 Apr 2018 07:47:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt;, it looks like that the ActiveMQ already uses the byteman in their tests&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;. So I think it could be OK to just include the byteman as the testsing purpose.&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt; &lt;a href=&quot;https://github.com/apache/activemq-artemis/blob/master/tests/extra-tests/pom.xml#L46&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/activemq-artemis/blob/master/tests/extra-tests/pom.xml#L46&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16434549" author="garydgregory" created="Wed, 11 Apr 2018 20:41:16 +0000"  >&lt;p&gt;Nice find in Apache MQ &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhfeng&quot; class=&quot;user-hover&quot; rel=&quot;zhfeng&quot;&gt;zhfeng&lt;/a&gt;!&#160;&lt;/p&gt;

&lt;p&gt;I&apos;m curious if anyone in our community has any thoughts here? Because Apache MQ uses it in their tests does not make it right, but I would hope that they&apos;ve validated this dependency...&lt;/p&gt;

&lt;p&gt;Gary&lt;/p&gt;</comment>
                            <comment id="16435211" author="martyntaylor" created="Thu, 12 Apr 2018 09:06:50 +0000"  >&lt;p&gt;It&apos;s a question of whether or not the LGPL licensed dependency is distributed as part of the Apache project.&#160; Build time dependencies are OK&lt;span class=&quot;error&quot;&gt;&amp;#91;1&amp;#93;&lt;/span&gt;.&#160; The licensing documentation is not explicit about test dependencies.&#160; In ActiveMQ Artemis we don&apos;t distribute tests and don&apos;t redistribute Byteman.&#160; As a precautionary measure, we&#160;disable by default tests that pull down libraries with prohibited licenses.&#160; TBH I don&apos;t believe this is necessary.&#160; If you&apos;re still unsure I would fire an email off to Apache security to verify.&lt;/p&gt;

&lt;p&gt;1.&#160;&lt;a href=&quot;https://www.apache.org/legal/resolved.html#prohibited&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.apache.org/legal/resolved.html#prohibited&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16476664" author="zhfeng" created="Wed, 16 May 2018 00:47:03 +0000"  >&lt;p&gt;There could be an issue with the Narayana related to the afterCompletion and I think we have fixed in &lt;a href=&quot;https://issues.jboss.org/browse/JBTM-3021&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JBTM-3021&lt;/a&gt; which should be include in the Narayan 5.8.2.Final&lt;/p&gt;</comment>
                            <comment id="16481976" author="garydgregory" created="Sun, 20 May 2018 15:08:45 +0000"  >&lt;p&gt;Hm... where are we on this?&lt;/p&gt;</comment>
                            <comment id="16482218" author="zhfeng" created="Mon, 21 May 2018 06:06:20 +0000"  >&lt;p&gt;The Narayana dependency is in the dbcp-test. I have verified the TestLeak.java works fine with the fix of JBTM-3021. And we will release the Narayana 5.8.2.Final soon I hope in this week. So I would suggest to close this issue as &quot;Migrated to other ITS&quot; and mark with JBTM-3021&lt;/p&gt;</comment>
                            <comment id="16482220" author="zhfeng" created="Mon, 21 May 2018 06:08:51 +0000"  >&lt;p&gt;Also we have worked with more tests by using the Narayana and the DBCP2 and will raise the PR for &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-491&quot; title=&quot;Ensure DBCP ConnectionListener can deal with transaction managers which invoke rollback in a separate thread&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-491&quot;&gt;&lt;del&gt;DBCP-491&lt;/del&gt;&lt;/a&gt; after we release 5.8.2.Final of Narayana&lt;/p&gt;</comment>
                            <comment id="16482296" author="markt" created="Mon, 21 May 2018 08:32:19 +0000"  >&lt;p&gt;A reliable unit test for a race condition is always going to be tricky. The patch looks good to me. I&apos;ve commented on the PR.&lt;/p&gt;</comment>
                            <comment id="16482570" author="garydgregory" created="Mon, 21 May 2018 14:44:39 +0000"  >&lt;p&gt;PR applied. Please verify and close this ticket and associated PR.&lt;/p&gt;</comment>
                            <comment id="16737421" author="ddillard" created="Tue, 8 Jan 2019 18:58:52 +0000"  >&lt;p&gt;I know this fix has been out a while, but any chance of getting a CVE for this?&lt;/p&gt;</comment>
                            <comment id="16737468" author="garydgregory" created="Tue, 8 Jan 2019 20:03:53 +0000"  >&lt;p&gt;I would not think this requires a CVE. What do others think?&lt;/p&gt;</comment>
                            <comment id="16737480" author="ddillard" created="Tue, 8 Jan 2019 20:13:06 +0000"  >&lt;p&gt;To be clear, the reason I asked about a CVE is that a resource leak can lead to a denial of service.&lt;/p&gt;</comment>
                            <comment id="16737505" author="garydgregory" created="Tue, 8 Jan 2019 20:43:08 +0000"  >&lt;p&gt;Hm...  OK. Let&apos;s see if we get a volunteer &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16737508" author="markt" created="Tue, 8 Jan 2019 20:49:05 +0000"  >&lt;p&gt;I don&apos;t think this meets the bar for a CVE.&lt;/p&gt;

&lt;p&gt;It can&apos;t be reliably triggered by a remote user. The bug appears to be rare enough that a malicious user isn&apos;t going to be able to exhaust server resources with this. Also, the abandoned connection clean-up releases the leaked resource.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13159930">DBCP-491</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12916479" name="dbcp-test.zip" size="12852" author="ggregory" created="Tue, 27 Mar 2018 22:10:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                    <customfield id="customfield_12311024" key="com.atlassian.jira.plugin.system.customfieldtypes:textfield">
                        <customfieldname>External issue ID</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>10</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12311020" key="com.atlassian.jira.plugin.system.customfieldtypes:url">
                        <customfieldname>External issue URL</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[https://github.com/apache/commons-dbcp/pull/10]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 44 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3pd33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>