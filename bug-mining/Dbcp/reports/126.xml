<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 17:48:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[DBCP-426] DBCP should allow clients to mark connections as invalid</title>
                <link>https://issues.apache.org/jira/browse/DBCP-426</link>
                <project id="12310469" key="DBCP">Commons DBCP</project>
                    <description>&lt;p&gt;Currently there is no way for a DBCP client to mark a connection as invalid, effectively requesting the pool to try to close it, remove it from the pool and reclaim pool capacity.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12744772">DBCP-426</key>
            <summary>DBCP should allow clients to mark connections as invalid</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="psteitz">Phil Steitz</reporter>
                        <labels>
                    </labels>
                <created>Mon, 29 Sep 2014 19:59:08 +0000</created>
                <updated>Wed, 12 Aug 2015 16:56:45 +0000</updated>
                            <resolved>Wed, 1 Oct 2014 01:00:37 +0000</resolved>
                                    <version>2.0</version>
                                    <fixVersion>2.1</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14152285" author="kaspersor" created="Mon, 29 Sep 2014 21:01:28 +0000"  >&lt;p&gt;Here&apos;s my suggested patch (to be added in BasicDataSource):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    /**
     * Manually invalidates a connection, effectively requesting the pool to &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt;
     * to close it, remove it from the pool and reclaim pool capacity.
     * 
     * @&lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IllegalStateException
     *             &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; invalidating the connection failed.
     */
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void invalidateConnection(Connection connection) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IllegalStateException {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (connection == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;;
        }
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (connectionPool == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cannot invalidate connection: ConnectionPool is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;.&quot;&lt;/span&gt;);
        }

        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; PoolableConnection poolableConnection;
        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            poolableConnection = connection.unwrap(PoolableConnection.class);
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (poolableConnection == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
                &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalStateException(
                        &lt;span class=&quot;code-quote&quot;&gt;&quot;Cannot invalidate connection: Connection is not a poolable connection.&quot;&lt;/span&gt;);
            }
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (SQLException e) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Cannot invalidate connection: Unwrapping poolable connection failed.&quot;&lt;/span&gt;, e);
        }

        &lt;span class=&quot;code-comment&quot;&gt;// attempt to close the connection &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; good measure
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            connection.close();
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
            &lt;span class=&quot;code-comment&quot;&gt;// ignore any exceptions here
&lt;/span&gt;        }

        &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
            connectionPool.invalidateObject(poolableConnection);
        } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
            &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IllegalStateException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Invalidating connection threw unexpected exception&quot;&lt;/span&gt;, e);
        }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14154147" author="psteitz" created="Wed, 1 Oct 2014 01:00:37 +0000"  >&lt;p&gt;Many thanks for the patch.  Applied in r1628584.&lt;/p&gt;</comment>
                            <comment id="14693314" author="bcoughlan" created="Wed, 12 Aug 2015 10:57:01 +0000"  >&lt;p&gt;I believe there is there a race condition here where the object could be borrowed from the pool after &apos;connection.close()&apos; returns it to the pool, and the underlying connection will be closed while it is borrowed by another thread.&lt;/p&gt;</comment>
                            <comment id="14693830" author="psteitz" created="Wed, 12 Aug 2015 16:56:45 +0000"  >&lt;p&gt;Thanks for the review and report, Barry.  &lt;a href=&quot;https://issues.apache.org/jira/browse/DBCP-444&quot; title=&quot;InvalidateConnection can result in closed connection returned by getConnection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;DBCP-444&quot;&gt;&lt;del&gt;DBCP-444&lt;/del&gt;&lt;/a&gt; opened to track this issue.  Patches / test case demonstrating the bug welcome on that ticket.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 14 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i20lrb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>