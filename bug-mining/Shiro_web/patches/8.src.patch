diff --git a/web/src/main/java/org/apache/shiro/web/servlet/AbstractShiroFilter.java b/web/src/main/java/org/apache/shiro/web/servlet/AbstractShiroFilter.java
index 2b0a32cd8..29857816b 100644
--- a/web/src/main/java/org/apache/shiro/web/servlet/AbstractShiroFilter.java
+++ b/web/src/main/java/org/apache/shiro/web/servlet/AbstractShiroFilter.java
@@ -231,7 +231,11 @@ public abstract class AbstractShiroFilter extends OncePerRequestFilter {
      */
     @SuppressWarnings({"UnusedDeclaration"})
     protected void unbind(ThreadState threadState) {
-        threadState.clear();
+        if ( threadState != null ) {
+            threadState.clear();
+        }
+        //just for good measure (SHIRO-159):
+        ThreadContext.clear();
     }
 
     /**
