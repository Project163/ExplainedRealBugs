diff --git a/web/src/main/java/org/apache/shiro/web/session/mgt/DefaultWebSessionManager.java b/web/src/main/java/org/apache/shiro/web/session/mgt/DefaultWebSessionManager.java
index e148c3b77..3ff80bad8 100644
--- a/web/src/main/java/org/apache/shiro/web/session/mgt/DefaultWebSessionManager.java
+++ b/web/src/main/java/org/apache/shiro/web/session/mgt/DefaultWebSessionManager.java
@@ -115,10 +115,11 @@ public class DefaultWebSessionManager extends DefaultSessionManager implements W
                     ShiroHttpServletRequest.COOKIE_SESSION_ID_SOURCE);
         } else {
             //not in a cookie, or cookie is disabled - try the request params as a fallback (i.e. URL rewriting):
-            id = request.getParameter(ShiroHttpSession.DEFAULT_SESSION_ID_NAME);
+            String name = getSessionIdName();
+            id = request.getParameter(name);
             if (id == null) {
                 //try lowercase:
-                id = request.getParameter(ShiroHttpSession.DEFAULT_SESSION_ID_NAME.toLowerCase());
+                id = request.getParameter(name.toLowerCase());
             }
             if (id != null) {
                 request.setAttribute(ShiroHttpServletRequest.REFERENCED_SESSION_ID_SOURCE,
@@ -134,6 +135,15 @@ public class DefaultWebSessionManager extends DefaultSessionManager implements W
         return id;
     }
 
+    //since 1.2.1
+    private String getSessionIdName() {
+        String name = this.sessionIdCookie != null ? this.sessionIdCookie.getName() : null;
+        if (name == null) {
+            name = ShiroHttpSession.DEFAULT_SESSION_ID_NAME;
+        }
+        return name;
+    }
+
     protected Session createExposedSession(Session session, SessionContext context) {
         if (!WebUtils.isWeb(context)) {
             return super.createExposedSession(session, context);
diff --git a/web/src/test/java/org/apache/shiro/web/session/mgt/DefaultWebSessionManagerTest.java b/web/src/test/java/org/apache/shiro/web/session/mgt/DefaultWebSessionManagerTest.java
index 90527bf74..b6000b18e 100644
--- a/web/src/test/java/org/apache/shiro/web/session/mgt/DefaultWebSessionManagerTest.java
+++ b/web/src/test/java/org/apache/shiro/web/session/mgt/DefaultWebSessionManagerTest.java
@@ -147,6 +147,7 @@ public class DefaultWebSessionManagerTest {
 
         String id = "12345";
 
+        expect(cookie.getName()).andReturn(ShiroHttpSession.DEFAULT_SESSION_ID_NAME);
         expect(request.getParameter(ShiroHttpSession.DEFAULT_SESSION_ID_NAME)).andReturn(id);
         request.setAttribute(ShiroHttpServletRequest.REFERENCED_SESSION_ID_SOURCE,
                 ShiroHttpServletRequest.URL_SESSION_ID_SOURCE);
@@ -180,6 +181,7 @@ public class DefaultWebSessionManagerTest {
 
         String id = "12345";
 
+        expect(cookie.getName()).andReturn(ShiroHttpSession.DEFAULT_SESSION_ID_NAME);
         expect(request.getParameter(ShiroHttpSession.DEFAULT_SESSION_ID_NAME)).andReturn(null);
         expect(request.getParameter(ShiroHttpSession.DEFAULT_SESSION_ID_NAME.toLowerCase())).andReturn(id);
         request.setAttribute(ShiroHttpServletRequest.REFERENCED_SESSION_ID_SOURCE,
