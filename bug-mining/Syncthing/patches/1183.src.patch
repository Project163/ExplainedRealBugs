diff --git a/lib/fs/basicfs_test.go b/lib/fs/basicfs_test.go
index c900a131d..0012a774c 100644
--- a/lib/fs/basicfs_test.go
+++ b/lib/fs/basicfs_test.go
@@ -121,6 +121,10 @@ func TestChmodDir(t *testing.T) {
 	if err := os.Mkdir(path, mode); err != nil {
 		t.Error(err)
 	}
+	// On UNIX, Mkdir will subtract the umask, so force desired mode explicitly
+	if err := os.Chmod(path, mode); err != nil {
+		t.Error(err)
+	}
 
 	if stat, err := os.Stat(path); err != nil || stat.Mode()&os.ModePerm != mode {
 		t.Errorf("wrong perm: %t %#o", err == nil, stat.Mode()&os.ModePerm)
