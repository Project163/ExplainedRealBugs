diff --git a/cmd/syncthing/monitor.go b/cmd/syncthing/monitor.go
index 5fdffbea4..e25689d16 100644
--- a/cmd/syncthing/monitor.go
+++ b/cmd/syncthing/monitor.go
@@ -78,6 +78,10 @@ func monitorMain() {
 			l.Fatalln(err)
 		}
 
+		// Let the next child process know that this is not the first time
+		// it's starting up.
+		os.Setenv("STRESTART", "yes")
+
 		stdoutMut.Lock()
 		stdoutFirstLines = make([]string, 0, 10)
 		stdoutLastLines = make([]string, 0, 50)
@@ -123,10 +127,6 @@ func monitorMain() {
 
 		l.Infoln("Syncthing exited:", err)
 		time.Sleep(1 * time.Second)
-
-		// Let the next child process know that this is not the first time
-		// it's starting up.
-		os.Setenv("STRESTART", "yes")
 	}
 }
 
