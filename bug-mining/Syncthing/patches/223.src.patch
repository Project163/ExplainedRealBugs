diff --git a/cmd/syncthing/main.go b/cmd/syncthing/main.go
index eea9f9d8e..d8a54a3d6 100644
--- a/cmd/syncthing/main.go
+++ b/cmd/syncthing/main.go
@@ -235,6 +235,10 @@ func main() {
 		baseDirs["config"] = confDir
 	}
 
+	if err := expandLocations(); err != nil {
+		l.Fatalln(err)
+	}
+
 	if runtime.GOOS == "windows" {
 		if logFile == "" {
 			// Use the default log file location
@@ -245,10 +249,6 @@ func main() {
 		}
 	}
 
-	if err := expandLocations(); err != nil {
-		l.Fatalln(err)
-	}
-
 	if showVersion {
 		fmt.Println(LongVersion)
 		return
