diff --git a/lib/connections/structs.go b/lib/connections/structs.go
index 0a044d0b8..7e678a8c6 100644
--- a/lib/connections/structs.go
+++ b/lib/connections/structs.go
@@ -93,7 +93,19 @@ func (c internalConn) Type() string {
 }
 
 func (c internalConn) Transport() string {
-	return c.connType.Transport()
+	transport := c.connType.Transport()
+	host, _, err := net.SplitHostPort(c.LocalAddr().String())
+	if err != nil {
+		return transport
+	}
+	ip := net.ParseIP(host)
+	if ip == nil {
+		return transport
+	}
+	if ip.To4() != nil {
+		return transport + "4"
+	}
+	return transport + "6"
 }
 
 func (c internalConn) String() string {
