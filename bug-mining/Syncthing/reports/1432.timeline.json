[{"id":11612569252,"node_id":"LE_lADOAOCAEs59VgwkzwAAAAK0Kb6k","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/11612569252","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-01-26T19:39:36Z","label":{"name":"bug","color":"d93f0b"},"performed_via_github_app":null},{"id":11612569255,"node_id":"LE_lADOAOCAEs59VgwkzwAAAAK0Kb6n","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/11612569255","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-01-26T19:39:36Z","label":{"name":"needs-triage","color":"ce23af"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1912631934","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1912631934","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1912631934,"node_id":"IC_kwDOAOCAEs5yAHJ-","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-26T20:12:34Z","updated_at":"2024-01-26T20:12:34Z","body":"I suspect you're syncing/deleting settings of a running program, which is what causes the modifications and hence \"resurrection\" of the deleted files. This seems like a support issue more suited to the forum: forum.syncthing.net","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1912631934/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1912636382","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1912636382","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1912636382,"node_id":"IC_kwDOAOCAEs5yAIPe","user":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-26T20:16:40Z","updated_at":"2024-01-30T15:49:49Z","body":"It's a subfolder of my Alfred workflows dir, but the files are not specifically settings or in any way belonging to Alfred. The bug also occurs regardless of whether Alfred is running or not.\r\n\r\nFurther down the thread, I can reproduce the behavior with a completely separate non-related dir.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1912636382/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1912637134","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1912637134","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1912637134,"node_id":"IC_kwDOAOCAEs5yAIbO","user":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-26T20:17:18Z","updated_at":"2024-01-30T15:50:21Z","body":"I decided to try a database reset on both machines (not sure if it's required to do it on both side, so I did...)\r\n\r\nI used the API...\r\n```\r\ncurl -X POST -H \"X-API-Key: <APIKEY>\" \"http://127.0.0.1:8384/rest/system/reset?folder=<FOLDERID>\"\r\n```\r\nTook about 12 minutes, and everything is re-synced. Will continue to monitor the situation.\r\n\r\n**update**: The db reset did not help.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1912637134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1915449750","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1915449750","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1915449750,"node_id":"IC_kwDOAOCAEs5yK3GW","user":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-29T19:52:27Z","updated_at":"2024-02-07T18:43:10Z","body":"@calmh This is still weird. Been doing more testing today. I'm doing a \"clean\" test: a brand new folder that is OUTSIDE any application-related settings dir. Just a brand new folder called `foo123`. I open a Terminal on Machine-A, `cd` into that directory, and execute\r\n\r\n```\r\npython3 -m pip install --disable-pip-version-check --isolated --upgrade --target=. opencv-python\r\n```\r\n\r\nAfter a few moments, the files have synced to Machine-B. So far so good.\r\n\r\nNext, I select all and delete the files that were just created. About 10-15 seconds later, the folders mysteriously just come back. Sometimes all of them, sometimes only some of them. I can repeat this several times, the folders just will not stay deleted. Below is a screen recording showing this!\r\n\r\nIn the debug logs, there are many messages like\r\n\r\n```\r\n2024-01-29 13:34:05 Puller (folder \"Sync\" (xxxxx-xxxxx), item \"foo123/numpy/typing\"): syncing: delete dir: directory has been deleted on a remote device but is not empty; the contents are probably ignored on that remote device, but not locally\r\n2024-01-29 13:34:05 Puller (folder \"Sync\" (xxxxx-xxxxx), item \"foo123/numpy/lib\"): syncing: delete dir: directory has been deleted on a remote device but is not empty; the contents are probably ignored on that remote device, but not locally\r\n2024-01-29 13:34:05 Puller (folder \"Sync\" (xxxxx-xxxxx), item \"foo123/numpy/f2py/tests\"): syncing: delete dir: directory has been deleted on a remote device but is not empty; the contents are probably ignored on that remote device, but not locally\r\n2024-01-29 13:34:05 Puller (folder \"Sync\" (xxxxx-xxxxx), item \"foo123/numpy/core/include\"): syncing: delete dir: directory has been deleted on a remote device but is not empty; the contents are probably ignored on that remote device, but not locally\r\n2024-01-29 13:34:05 \"Sync\" (xxxxx-xxxxx): Failed to sync 6 items\r\n2024-01-29 13:34:05 Folder \"Sync\" (xxxxx-xxxxx) isn't making sync progress - retrying in 1m0s.\r\n2024-01-29 13:34:05 Puller (folder \"Sync\" (xxxxx-xxxxx), item \"foo123/numpy/core\"): syncing: delete dir: directory has been deleted on a remote device but is not empty; the contents are probably ignored on that remote device, but not locally\r\n2024-01-29 13:34:05 Puller (folder \"Sync\" (xxxxx-xxxxx), item \"foo123/numpy/typing\"): syncing: delete dir: directory has been deleted on a remote device but is not empty; the contents are probably ignored on that remote device, but not locally\r\n2024-01-29 13:34:05 \"Sync\" (xxxxx-xxxxx): Failed to sync 2 items\r\n2024-01-29 13:34:05 Folder \"Sync\" (xxxxx-xxxxx) isn't making sync progress - retrying in 1m0s.\r\n```\r\n\r\nI don't know how to troubleshoot further but, something's definitely not right...\r\n\r\nMay be related?\r\n- https://forum.syncthing.net/t/discussing-fs-watcher-delays-4953/11593\r\n- https://github.com/syncthing/syncthing/issues/4953\r\n\r\n\r\nhttps://github.com/syncthing/syncthing/assets/1992842/75e0e03f-ab19-457b-a73e-94f30220dc9b\r\n\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1915449750/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11632544065,"node_id":"MEE_lADOAOCAEs59VgwkzwAAAAK1WolB","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/11632544065","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-01-29T19:52:27Z","performed_via_github_app":null},{"id":11632544087,"node_id":"SE_lADOAOCAEs59VgwkzwAAAAK1WolX","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/11632544087","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-01-29T19:52:27Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1915885239","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1915885239","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1915885239,"node_id":"IC_kwDOAOCAEs5yMha3","user":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-30T01:21:46Z","updated_at":"2024-01-30T15:51:25Z","body":"**Update 1:**\r\n\r\nI compiled a custom build based on v1.27.3-rc.2+8f5d07b - just in case. No change...\r\n\r\n**Update 2:**\r\n\r\nI also experimented with lowering `fsWatcherDelayS` to `0.5` and changing `databaseTuning` to `large`. Also no effect on the issue (although the folders do **_re-appear_** almost instantly now!)","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1915885239/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1916261103","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1916261103","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1916261103,"node_id":"IC_kwDOAOCAEs5yN9Lv","user":{"login":"anonhostpi","id":130698314,"node_id":"U_kgDOB8pMSg","avatar_url":"https://avatars.githubusercontent.com/u/130698314?v=4","gravatar_id":"","url":"https://api.github.com/users/anonhostpi","html_url":"https://github.com/anonhostpi","followers_url":"https://api.github.com/users/anonhostpi/followers","following_url":"https://api.github.com/users/anonhostpi/following{/other_user}","gists_url":"https://api.github.com/users/anonhostpi/gists{/gist_id}","starred_url":"https://api.github.com/users/anonhostpi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anonhostpi/subscriptions","organizations_url":"https://api.github.com/users/anonhostpi/orgs","repos_url":"https://api.github.com/users/anonhostpi/repos","events_url":"https://api.github.com/users/anonhostpi/events{/privacy}","received_events_url":"https://api.github.com/users/anonhostpi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-30T07:55:19Z","updated_at":"2024-01-30T07:55:19Z","body":"Here is where that log string is defined: https://github.com/syncthing/syncthing/blob/8f5d07bd092990ceeb5d7f6b496e67ed5680a82f/lib/model/folder_sendrecv.go#L70","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1916261103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"anonhostpi","id":130698314,"node_id":"U_kgDOB8pMSg","avatar_url":"https://avatars.githubusercontent.com/u/130698314?v=4","gravatar_id":"","url":"https://api.github.com/users/anonhostpi","html_url":"https://github.com/anonhostpi","followers_url":"https://api.github.com/users/anonhostpi/followers","following_url":"https://api.github.com/users/anonhostpi/following{/other_user}","gists_url":"https://api.github.com/users/anonhostpi/gists{/gist_id}","starred_url":"https://api.github.com/users/anonhostpi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anonhostpi/subscriptions","organizations_url":"https://api.github.com/users/anonhostpi/orgs","repos_url":"https://api.github.com/users/anonhostpi/repos","events_url":"https://api.github.com/users/anonhostpi/events{/privacy}","received_events_url":"https://api.github.com/users/anonhostpi/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1916272516","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1916272516","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1916272516,"node_id":"IC_kwDOAOCAEs5yN_-E","user":{"login":"anonhostpi","id":130698314,"node_id":"U_kgDOB8pMSg","avatar_url":"https://avatars.githubusercontent.com/u/130698314?v=4","gravatar_id":"","url":"https://api.github.com/users/anonhostpi","html_url":"https://github.com/anonhostpi","followers_url":"https://api.github.com/users/anonhostpi/followers","following_url":"https://api.github.com/users/anonhostpi/following{/other_user}","gists_url":"https://api.github.com/users/anonhostpi/gists{/gist_id}","starred_url":"https://api.github.com/users/anonhostpi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anonhostpi/subscriptions","organizations_url":"https://api.github.com/users/anonhostpi/orgs","repos_url":"https://api.github.com/users/anonhostpi/repos","events_url":"https://api.github.com/users/anonhostpi/events{/privacy}","received_events_url":"https://api.github.com/users/anonhostpi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-30T08:02:58Z","updated_at":"2024-01-30T08:02:58Z","body":"This is the block of code that generates the error:\r\n\r\nhttps://github.com/syncthing/syncthing/blob/8f5d07bd092990ceeb5d7f6b496e67ed5680a82f/lib/model/folder_sendrecv.go#L2028-L2031\r\n\r\nthen later:\r\n\r\nhttps://github.com/syncthing/syncthing/blob/8f5d07bd092990ceeb5d7f6b496e67ed5680a82f/lib/model/folder_sendrecv.go#L2059-L2061","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1916272516/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"anonhostpi","id":130698314,"node_id":"U_kgDOB8pMSg","avatar_url":"https://avatars.githubusercontent.com/u/130698314?v=4","gravatar_id":"","url":"https://api.github.com/users/anonhostpi","html_url":"https://github.com/anonhostpi","followers_url":"https://api.github.com/users/anonhostpi/followers","following_url":"https://api.github.com/users/anonhostpi/following{/other_user}","gists_url":"https://api.github.com/users/anonhostpi/gists{/gist_id}","starred_url":"https://api.github.com/users/anonhostpi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anonhostpi/subscriptions","organizations_url":"https://api.github.com/users/anonhostpi/orgs","repos_url":"https://api.github.com/users/anonhostpi/repos","events_url":"https://api.github.com/users/anonhostpi/events{/privacy}","received_events_url":"https://api.github.com/users/anonhostpi/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1916287877","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1916287877","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1916287877,"node_id":"IC_kwDOAOCAEs5yODuF","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-30T08:14:00Z","updated_at":"2024-01-30T08:14:00Z","body":"So, generally speaking this doesn't happen, or we'd have a flood of complaints from everyone. As such, I'd suggest focusing on what might be different on your systems/setup that would trigger this.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1916287877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1916765893","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1916765893","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1916765893,"node_id":"IC_kwDOAOCAEs5yP4bF","user":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-30T12:43:25Z","updated_at":"2024-01-30T12:53:15Z","body":"@calmh Believe me, I've been focusing on it for 3 days straight. I've fiddled with debug flags, written scripts to stream errors from the events API in realtime, reset my database, adjusted the `fsWatcherDelayS` and `databaseTuning` params, compiled custom builds based off HEAD, tried reverting back to 1.27.1 (and 1.27.0)...\r\n\r\nNone of it has helped. I am really stuck here, and starting to feel crazy. Syncthing's been working more or less flawlessly for me for many years now.\r\n\r\nThe only thing I can think of that changed around the timeframe of when this started was I updated my 2 Macs to macOS 14.3. Could this be an OS-level bug? How could I even confirm that (short of reformatting my 2 Macs...)","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1916765893/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11641222171,"node_id":"MEE_lADOAOCAEs59VgwkzwAAAAK13vQb","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/11641222171","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-01-30T12:43:26Z","performed_via_github_app":null},{"id":11641222180,"node_id":"SE_lADOAOCAEs59VgwkzwAAAAK13vQk","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/11641222180","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-01-30T12:43:26Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1916829103","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1916829103","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1916829103,"node_id":"IC_kwDOAOCAEs5yQH2v","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-30T13:17:10Z","updated_at":"2024-01-30T13:17:10Z","body":"Yeah, but all of that is fiddling with Syncthing, and I'm thinking this works with the usual default Syncthing for almost everyone since forever, so that's not the right variable to tinker with. I'm more thinking along the lines of are you using a different filesystem, some odd hardware, some odd driver, some other sync- or backup software, does it happen in both directions or is it limited to one of the devices, if so does it happen with any other device you own, etc.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1916829103/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1918273897","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1918273897","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1918273897,"node_id":"IC_kwDOAOCAEs5yVolp","user":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-31T02:49:08Z","updated_at":"2024-01-31T03:32:48Z","body":"- My filesystem is APFS which it has been for 6 years.\r\n- I don't have any weird hardware or storage involved-just the bog standard Apple SSDs that came with these systems.\r\n- Yes the bug happens in both directions, if I delete the folder from Machine-A then it reappears on Machine-A. If I delete from Machine-B, it reappears on Machine-B.\r\n\r\nAre there any additional debug options that could help track this down if I enable them?\r\n\r\nOne other thought: could this be related to my `.stignore` ? I'm using a single shared `.stglobaligbore` that is sourced from the local `.stignore`. Here are the contents of that file:\r\n\r\n```\r\n!Icon{[a-z],[A-Z],[0-9],_,-}\r\n(?d)Icon?\r\n\r\n(?d).DS_Store\r\n(?d)._*\r\n(?d).Spotlight-V100\r\n(?d).Trashes\r\n(?d)*.tmp\r\n(?d)*.swp\r\n\r\n.obsidian/plugins/recent-files-obsidian/data.json\r\n.obsidian/workspace.json\r\n/Obsidian/*/debug.log\r\n\r\nS.gpg-*\r\n```\r\n\r\n**Jan 30 morning update**: I created an entirely new sync folder definition, left everything at defaults, and started it on both ends completely empty. Dropped in some files and waited for sync to reach 100%. Then, I deleted the folder contents on Machine-A. **After ~1m the folders had returned back from the dead.**\r\n\r\nI then scoured the advanced settings again, and saw the [`modTimeWindowS`](https://docs.syncthing.net/users/config#config-option-folder.modtimewindows) option, which I enabled and set to `2`. I then re-tested. Same results. Completely baffled here.\r\n\r\n**Jan 30 evening update**: I spun up 2 **brand new** macOS VMs (mac1, mac2) completely isolated from each other and from the other systems involved in this bugreport. I did not do anything other than install Syncthing 1.27.2 on both of them, and connect them to each other.\r\n\r\nI created a new shared folder, using all default values for everything.\r\n\r\nI then repeated the original test: create a directory with around ~1100 files in it and ~150 directories. I waited for the sync to reach consensus. I then deleted the folder from mac1 and waited. The bug immediately reared its head again, a few of the folders quickly \"snapped back\". I repeated the test 2 more times to be sure.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1918273897/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1918512936","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1918512936","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1918512936,"node_id":"IC_kwDOAOCAEs5yWi8o","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-31T07:09:13Z","updated_at":"2024-01-31T07:09:13Z","body":"Yeah, you've certainly done your due diligence. I tried it a few times now on my macOS 14.3 M2 laptop, with two instances on the same machine but different directories etc, no snapbacks, so I still can't explain what you're seeing. Sorry. :/","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1918512936/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1918600038","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1918600038","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1918600038,"node_id":"IC_kwDOAOCAEs5yW4Nm","user":{"login":"anonhostpi","id":130698314,"node_id":"U_kgDOB8pMSg","avatar_url":"https://avatars.githubusercontent.com/u/130698314?v=4","gravatar_id":"","url":"https://api.github.com/users/anonhostpi","html_url":"https://github.com/anonhostpi","followers_url":"https://api.github.com/users/anonhostpi/followers","following_url":"https://api.github.com/users/anonhostpi/following{/other_user}","gists_url":"https://api.github.com/users/anonhostpi/gists{/gist_id}","starred_url":"https://api.github.com/users/anonhostpi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anonhostpi/subscriptions","organizations_url":"https://api.github.com/users/anonhostpi/orgs","repos_url":"https://api.github.com/users/anonhostpi/repos","events_url":"https://api.github.com/users/anonhostpi/events{/privacy}","received_events_url":"https://api.github.com/users/anonhostpi/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-31T08:16:28Z","updated_at":"2024-01-31T08:16:28Z","body":"> Yeah, you've certainly done your due diligence. I tried it a few times now on my macOS 14.3 M2 laptop, with two instances on the same machine but different directories etc, no snapbacks, so I still can't explain what you're seeing. Sorry. :/\r\n\r\nDid you run the same script that generated the directories?\r\n> ```\r\n> python3 -m pip install --disable-pip-version-check --isolated --upgrade --> target=. opencv-python\r\n> ```","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1918600038/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"anonhostpi","id":130698314,"node_id":"U_kgDOB8pMSg","avatar_url":"https://avatars.githubusercontent.com/u/130698314?v=4","gravatar_id":"","url":"https://api.github.com/users/anonhostpi","html_url":"https://github.com/anonhostpi","followers_url":"https://api.github.com/users/anonhostpi/followers","following_url":"https://api.github.com/users/anonhostpi/following{/other_user}","gists_url":"https://api.github.com/users/anonhostpi/gists{/gist_id}","starred_url":"https://api.github.com/users/anonhostpi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/anonhostpi/subscriptions","organizations_url":"https://api.github.com/users/anonhostpi/orgs","repos_url":"https://api.github.com/users/anonhostpi/repos","events_url":"https://api.github.com/users/anonhostpi/events{/privacy}","received_events_url":"https://api.github.com/users/anonhostpi/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1918669451","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1918669451","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1918669451,"node_id":"IC_kwDOAOCAEs5yXJKL","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-31T09:01:59Z","updated_at":"2024-01-31T09:02:26Z","body":"I did now, a whole bunch of times creating and removing the structure. In doing that I think I found another bug in the filesystem watcher (it seems to not trigger for items that were deleted, created, then deleted again, necessitating a manual or periodic scan to detect the remove...). I also got a couple of transient warnings on the receiving side (\"directory has been deleted on a remote device but is not empty\") which went away on retry. This could be an ordering issue or related to the above, perhaps.\r\n\r\nNo putbacks, though.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1918669451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1919068988","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1919068988","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1919068988,"node_id":"IC_kwDOAOCAEs5yYqs8","user":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-31T13:06:01Z","updated_at":"2024-02-02T12:33:31Z","body":"> I tried it a few times now on my macOS 14.3 M2 laptop, with **two instances on the same machine** but different directories\r\n\r\nI'm not sure that's the \"same\" -- I will test it like that on my side. I suggest [UTM][1] for a free and simple way to spin up some macOS VMs for testing if you only have 1 Mac.\r\n\r\nAlso, there's nothing special about that Python command that I ran to generate the files, I also tested by simply dragging a copy of the Syncthing macOS app bundle into the sync folder, and upon deleting that, it also snapped back, wirh empty orphan dirs left behind.\r\n\r\nJust asking again, are there any extra debug facilities that I can toggle on to help narrow down the cause of what I'm seeing here?\r\n\r\n[1]: https://mac.getutm.app/","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1919068988/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1919095198","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1919095198","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1919095198,"node_id":"IC_kwDOAOCAEs5yYxGe","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-31T13:22:48Z","updated_at":"2024-01-31T13:23:04Z","body":"The cause is in your initial post: `syncing: delete dir: file modified but not rescanned; will try again later`. Syncthing thinks, right or wrong, that the thing that it's about to delete has changed in some manner since it was last scanned, and shouldn't be deleted since there is a sync conflict.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1919095198/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1919130877","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1919130877","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1919130877,"node_id":"IC_kwDOAOCAEs5yY5z9","user":{"login":"tomasz1986","id":5626656,"node_id":"MDQ6VXNlcjU2MjY2NTY=","avatar_url":"https://avatars.githubusercontent.com/u/5626656?v=4","gravatar_id":"","url":"https://api.github.com/users/tomasz1986","html_url":"https://github.com/tomasz1986","followers_url":"https://api.github.com/users/tomasz1986/followers","following_url":"https://api.github.com/users/tomasz1986/following{/other_user}","gists_url":"https://api.github.com/users/tomasz1986/gists{/gist_id}","starred_url":"https://api.github.com/users/tomasz1986/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomasz1986/subscriptions","organizations_url":"https://api.github.com/users/tomasz1986/orgs","repos_url":"https://api.github.com/users/tomasz1986/repos","events_url":"https://api.github.com/users/tomasz1986/events{/privacy}","received_events_url":"https://api.github.com/users/tomasz1986/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-31T13:44:23Z","updated_at":"2024-01-31T13:44:23Z","body":"> I think I found another bug in the filesystem watcher (it seems to not trigger for items that were deleted, created, then deleted again, necessitating a manual or periodic scan to detect the remove...).\r\n\r\nWow, thanks for discovering this. I think I've been hit by this bug quite a few times, and I always wondered what the culprit was. Had no idea how to reproduce, so I just kept restarting Syncthing to make the watcher work again.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1919130877/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"tomasz1986","id":5626656,"node_id":"MDQ6VXNlcjU2MjY2NTY=","avatar_url":"https://avatars.githubusercontent.com/u/5626656?v=4","gravatar_id":"","url":"https://api.github.com/users/tomasz1986","html_url":"https://github.com/tomasz1986","followers_url":"https://api.github.com/users/tomasz1986/followers","following_url":"https://api.github.com/users/tomasz1986/following{/other_user}","gists_url":"https://api.github.com/users/tomasz1986/gists{/gist_id}","starred_url":"https://api.github.com/users/tomasz1986/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/tomasz1986/subscriptions","organizations_url":"https://api.github.com/users/tomasz1986/orgs","repos_url":"https://api.github.com/users/tomasz1986/repos","events_url":"https://api.github.com/users/tomasz1986/events{/privacy}","received_events_url":"https://api.github.com/users/tomasz1986/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1919708141","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1919708141","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1919708141,"node_id":"IC_kwDOAOCAEs5ybGvt","user":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-31T18:37:15Z","updated_at":"2024-01-31T19:27:28Z","body":"@calmh I think I may be making progress towards figuring this out.\r\n\r\nI had a theory that Spotlight was \"doing something\" to the files shortly after creation. I added an exclusion for the dir that I was syncing in Syncthing and re-ran the tests. No problem! No \"snapbacks\"!\r\n\r\nI then made a small test script to dump the timestamps to a file, pause 10s and dump them again, and diff the results:\r\n\r\n```shell\r\n#!/bin/zsh --no-rcs\r\nDIR=$HOME/hello_world\r\necho \"v1\"\r\nfind -s \"$DIR\" ! -path '*/.stversions/*' -exec stat -f%a,%m,%c,%B%t%N {} \\; >/tmp/v1\r\necho \"sleeping for 10s\"\r\nsleep 10\r\necho \"v2\"\r\nfind -s \"$DIR\" ! -path '*/.stversions/*' -exec stat -f%a,%m,%c,%B%t%N {} \\; >/tmp/v2\r\necho \"diff:\"\r\ndiff /tmp/v{1,2}\r\n```\r\nWhen I ran this immediately after the pip install command that adds the files, I saw that the `atime` (access time) on most of the files had been bumped by ~6 sec.\r\n\r\nFor example\r\n<img width=\"913\" alt=\"image\" src=\"https://github.com/syncthing/syncthing/assets/1992842/1e57b24b-03b6-4ffd-b153-2c371ba3ec96\">\r\n\r\nI _think_ Syncthing counts a change in the `atime` as a change that requires sync, and so the hysteresis occurs because mid-sync or mid-delete, you have Spotlight on one side or the other in there indexing files and touching their access timestamps (see [possibly related SuperUser post][1]).\r\n\r\n**_IF_** this is what is happening, I'm not sure I understand the merit of considering merely accessing a file as a \"change\", but in case that's a long-standing or breaking change, I wonder is there some advanced config flag to tell ST to ignore changes in atime and only consider the other timestamps like `birthtime` or `mtime`?\r\n\r\n**update:** Further tests are now conflicting with this finding: even when adding an exclusion in Spotlight to my original systems, I am still seeing this atime discrepancy 6-8 seconds after the files are created. Not sure whether that's a red herring, or if Syncthing even takes atime into consideration at all...\r\n\r\n[1]: https://superuser.com/a/89522/67691","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1919708141/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11659852064,"node_id":"MEE_lADOAOCAEs59VgwkzwAAAAK2-zkg","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/11659852064","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2024-01-31T18:37:16Z","performed_via_github_app":null},{"id":11659852069,"node_id":"SE_lADOAOCAEs59VgwkzwAAAAK2-zkl","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/11659852069","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2024-01-31T18:37:16Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1919956022","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1919956022","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1919956022,"node_id":"IC_kwDOAOCAEs5ycDQ2","user":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-01-31T21:04:36Z","updated_at":"2024-01-31T21:04:36Z","body":"This is getting weirder. It also affects renames. If I have a folder called `folder 1` on both sides, and I rename it to `folder 2`, I end up with **BOTH** folder1 & folder2... this repeats endlessly. Here's a video (sorry for the poor quality):\r\n\r\nhttps://github.com/syncthing/syncthing/assets/1992842/b4653685-8b08-4fbc-9f37-a3ebc705cd4c\r\n\r\n\r\n\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1919956022/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11664110031,"node_id":"RTE_lADOAOCAEs59VgwkzwAAAAK3PDHP","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/11664110031","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"renamed","commit_id":null,"commit_url":null,"created_at":"2024-02-01T03:40:12Z","rename":{"from":"Deleting a directory with a fairly large number of child items, dir quickly gets \"put back\" by ST","to":"Deleting or renaming directories causes old dir to quickly get \"put back\" by ST"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1921874834","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1921874834","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1921874834,"node_id":"IC_kwDOAOCAEs5yjXuS","user":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-01T17:45:40Z","updated_at":"2024-02-01T17:45:40Z","body":"I'm desperate. Anything else I can do here to try to track this down?\r\n\r\nI just enabled the following extra debug modules on both machines\r\n\r\n- fs\r\n- scanner\r\n- walkfs\r\n- watchaggregator\r\n\r\n...and ran this quick test\r\n\r\n1. created a folder named `___x` at the top of my Sync folder\r\n2. dumped files into it using the pip command above\r\n3. waited for sync to complete\r\n4. deleted all the subfolders that were created by step 2 (from Machine A)\r\n\r\nHere's are log outputs of `tail -F syncthing.log | grep ___x` from both sides, immediately following the deletion of all the subfolders under `___x` from Machine A (step 4) and up until sync had returned to 100% green.\r\n\r\nThe deleted folders had all snapped back...\r\n\r\n- [`machineA.log`](https://github.com/syncthing/syncthing/files/14128934/machineA.log)\r\n- [`machineB.log`](https://github.com/syncthing/syncthing/files/14128935/machineB.log)\r\n","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1921874834/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"luckman212","id":1992842,"node_id":"MDQ6VXNlcjE5OTI4NDI=","avatar_url":"https://avatars.githubusercontent.com/u/1992842?v=4","gravatar_id":"","url":"https://api.github.com/users/luckman212","html_url":"https://github.com/luckman212","followers_url":"https://api.github.com/users/luckman212/followers","following_url":"https://api.github.com/users/luckman212/following{/other_user}","gists_url":"https://api.github.com/users/luckman212/gists{/gist_id}","starred_url":"https://api.github.com/users/luckman212/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/luckman212/subscriptions","organizations_url":"https://api.github.com/users/luckman212/orgs","repos_url":"https://api.github.com/users/luckman212/repos","events_url":"https://api.github.com/users/luckman212/events{/privacy}","received_events_url":"https://api.github.com/users/luckman212/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1921910026","html_url":"https://github.com/syncthing/syncthing/issues/9371#issuecomment-1921910026","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/9371","id":1921910026,"node_id":"IC_kwDOAOCAEs5yjgUK","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-01T18:03:46Z","updated_at":"2024-02-01T18:03:46Z","body":"Looking at this, there are a couple of oddities. We take an example failed remove:\r\n\r\n```\r\nINFO: Puller (folder \"Sync\" (9bupw-pod9e), item \"___x/cv2/gapi/imgproc\"): syncing: delete dir: file modified but not rescanned; will try again later\r\n```\r\n\r\nThis gets scanned a little later, so we can see what differences we saw:\r\n\r\n```\r\n[AL47A] 2024/02/01 12:37:29.292509 walk.go:450: DEBUG: walker/9bupw-pod9e@0x1400031ac60 checking: Directory{Name:\"___x/cv2/gapi/imgproc\", Sequence:0, Permissions:0755, ModTime:2024-02-01 12:37:28.105909529 -0500 EST, Version:{[{AL47AUJ 1706809049} {67NVTVG 1706808970}]}, VersionHash:, Deleted:false, Invalid:false, LocalFlags:0x0, NoPermissions:false, Platform:{<nil> <nil> <nil>  <nil> <nil>}, InodeChangeTime:2024-02-01 12:37:28.105909529 -0500 EST}\r\n[AL47A] 2024/02/01 12:37:29.292527 walk.go:472: DEBUG: walker/9bupw-pod9e@0x1400031ac60 rescan: Directory{Name:\"___x/cv2/gapi/imgproc\", Sequence:212382, Permissions:0755, ModTime:2024-02-01 12:36:27.772506429 -0500 EST, Version:{[{AL47AUJ 1706809049} {67NVTVG 1706808970}]}, VersionHash:, Deleted:false, Invalid:false, LocalFlags:0x0, NoPermissions:false, Platform:{<nil> <nil> <nil>  <nil> <nil>}, InodeChangeTime:2024-02-01 12:36:27.772506429 -0500 EST}\r\n```\r\n\r\nSpoiler: no relevant differences, or shouldn't be. The modtime differs, but we expect that since we touched children, and we never care about mtime of directories for this reason (nor atime for anything ever). Also the InodeChangeTime differs. I don't know off hand whether that's expected just based on having deleted children, but we don't normally care about that anyway... except...\r\n\r\n```\r\nDEBUG: get xattr /Users/luke/Sync/___x/cv2/gapi/imgproc: skipping attribute \"com.apple.provenance\" denied by filter\r\n```\r\n\r\nHang on, we're syncing extended attributes? That wasn't mentioned so far. In that case we *do* care about the inode change time, because it indicates (or *can* indicate) a change in xattrs. I wouldn't be surprised if a bunch of xattrs get set automatically in the background by all kinds of things, in this case apparently a provenance attribute was set and we're configured to ignore it...","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/1921910026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}}]