{"url":"https://api.github.com/repos/syncthing/syncthing/issues/5340","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/5340/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/5340/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/5340/events","html_url":"https://github.com/syncthing/syncthing/issues/5340","id":385622699,"node_id":"MDU6SXNzdWUzODU2MjI2OTk=","number":5340,"title":"Incorrectly out of sync, sequence number oddness.","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/syncthing/syncthing/milestones/30","html_url":"https://github.com/syncthing/syncthing/milestone/30","labels_url":"https://api.github.com/repos/syncthing/syncthing/milestones/30/labels","id":3893101,"node_id":"MDk6TWlsZXN0b25lMzg5MzEwMQ==","number":30,"title":"v1.0.1","description":"","creator":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":43,"state":"closed","created_at":"2018-12-12T14:51:05Z","updated_at":"2019-02-05T06:41:30Z","due_on":"2019-02-05T08:00:00Z","closed_at":"2019-02-05T06:41:30Z"},"comments":2,"created_at":"2018-11-29T08:33:02Z","updated_at":"2020-01-19T07:02:35Z","closed_at":"2019-01-18T10:34:22Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"It seems there might be an occasional issue with the index sending.\r\n\r\nTwo devices, \"kvin\" and \"pseudo\"; kvin thinks pseudo is out of sync missing one file, pseudo thinks it has everything, but the file is missing.\r\n\r\nkvin side:\r\n\r\n<img width=\"1164\" alt=\"screen shot 2018-11-29 at 09 15 05\" src=\"https://user-images.githubusercontent.com/125426/49208702-c20d8c80-f3b8-11e8-87ed-22de4bab7431.png\">\r\n\r\n<img width=\"1174\" alt=\"screen shot 2018-11-29 at 09 15 13\" src=\"https://user-images.githubusercontent.com/125426/49208713-c9349a80-f3b8-11e8-8601-b03af85b3f9f.png\">\r\n\r\n(note 2702 files locally, pseudo missing one pdf)\r\n\r\npseudo side:\r\n\r\n<img width=\"1175\" alt=\"screen shot 2018-11-29 at 09 15 20\" src=\"https://user-images.githubusercontent.com/125426/49208739-dbaed400-f3b8-11e8-8894-f1bb9e264a3c.png\">\r\n\r\n(2701 files locally)\r\n\r\nChecking the file via rest shows it present on kvin but not pseudo, which matches the above:\r\n\r\n```\r\njb@kvin:~ $ curl ... 'http://localhost:8384/rest/db/file?folder=documents&file=Kastelo/Ekonomi/2018+Bokföring/INV04871726_A00552008_11252018.pdf'\r\n{\r\n  \"availability\": null,\r\n  \"global\": {\r\n    \"deleted\": false,\r\n    \"ignored\": false,\r\n    \"invalid\": false,\r\n    \"localFlags\": 0,\r\n    \"modified\": \"2018-11-26T07:03:54+01:00\",\r\n    \"modifiedBy\": \"SYNO4VL\",\r\n    \"mustRescan\": false,\r\n    \"name\": \"Kastelo/Ekonomi/2018 Bokföring/INV04871726_A00552008_11252018.pdf\",\r\n    \"noPermissions\": false,\r\n    \"numBlocks\": 1,\r\n    \"permissions\": \"0644\",\r\n    \"sequence\": 902,\r\n    \"size\": 71947,\r\n    \"type\": 0,\r\n    \"version\": [\r\n      \"SYNO4VL:1\"\r\n    ]\r\n  },\r\n  \"local\": {\r\n    \"deleted\": false,\r\n    \"ignored\": false,\r\n    \"invalid\": false,\r\n    \"localFlags\": 0,\r\n    \"modified\": \"2018-11-26T07:03:54+01:00\",\r\n    \"modifiedBy\": \"SYNO4VL\",\r\n    \"mustRescan\": false,\r\n    \"name\": \"Kastelo/Ekonomi/2018 Bokföring/INV04871726_A00552008_11252018.pdf\",\r\n    \"noPermissions\": false,\r\n    \"numBlocks\": 1,\r\n    \"permissions\": \"0644\",\r\n    \"sequence\": 902,\r\n    \"size\": 71947,\r\n    \"type\": 0,\r\n    \"version\": [\r\n      \"SYNO4VL:1\"\r\n    ]\r\n  }\r\n}\r\n\r\n$ curl ... 'https://pseudo.int.nym.se:8384/rest/db/file?folder=documents&file=Kastelo/Ekonomi/2018+Bokföring/INV04871726_A00552008_11252018.pdf'\r\nNo such object in the index\r\n```\r\n\r\nThe sequence number 902 is suspiciously low for this folder though; it's been around for a long time. Spot checking a couple of other files doesn't reveal anything conclusive though. One from Nov 14 (two weeks ago) has sequence 850 while another from Now 27 (one day after the affected one above) has sequence 49569. The latter seems more reasonable, and I'm not sure what would cause the large amount of updates between the 26th and 27th otherwise. (I mean, there are 2700 files in the folder, and they only change very occasionally.) This file is very recent, and a sequence < 2700 should be impossible.\r\n\r\nRestarting kvin with `-reset-deltas` resolved.","closed_by":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/5340/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/5340/timeline","performed_via_github_app":null,"state_reason":"completed"}