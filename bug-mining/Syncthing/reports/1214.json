{"url":"https://api.github.com/repos/syncthing/syncthing/issues/7451","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/7451/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/7451/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/7451/events","html_url":"https://github.com/syncthing/syncthing/issues/7451","id":828964453,"node_id":"MDU6SXNzdWU4Mjg5NjQ0NTM=","number":7451,"title":"strelaysrv v1.14.0 failing to load","user":{"login":"FFourtyTwo","id":16088828,"node_id":"MDQ6VXNlcjE2MDg4ODI4","avatar_url":"https://avatars.githubusercontent.com/u/16088828?v=4","gravatar_id":"","url":"https://api.github.com/users/FFourtyTwo","html_url":"https://github.com/FFourtyTwo","followers_url":"https://api.github.com/users/FFourtyTwo/followers","following_url":"https://api.github.com/users/FFourtyTwo/following{/other_user}","gists_url":"https://api.github.com/users/FFourtyTwo/gists{/gist_id}","starred_url":"https://api.github.com/users/FFourtyTwo/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/FFourtyTwo/subscriptions","organizations_url":"https://api.github.com/users/FFourtyTwo/orgs","repos_url":"https://api.github.com/users/FFourtyTwo/repos","events_url":"https://api.github.com/users/FFourtyTwo/events{/privacy}","received_events_url":"https://api.github.com/users/FFourtyTwo/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/syncthing/syncthing/milestones/62","html_url":"https://github.com/syncthing/syncthing/milestone/62","labels_url":"https://api.github.com/repos/syncthing/syncthing/milestones/62/labels","id":6443170,"node_id":"MDk6TWlsZXN0b25lNjQ0MzE3MA==","number":62,"title":"v1.15.0","description":"This release fixes a vulnerability where Syncthing and the relay server can crash due to malformed relay protocol messages (CVE-2021-21404); see https://github.com/syncthing/syncthing/security/advisories/GHSA-x462-89pf-6r5h.\r\n\r\nThis release updates the CLI to use subcommands and adds the subcommands `cli` (previously standalone `stcli` utility) and `decrypt` (for offline verifying and decrypting encrypted folders).\r\n\r\nWith this release we invite everyone to test the \"untrusted (encrypted) devices\" feature. You should not use it yet on important production data. Thus UI controls are hidden behind a feature flag. For more information, visit: \r\nhttps://forum.syncthing.net/t/testing-untrusted-encrypted-devices/16470","creator":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":88,"state":"closed","created_at":"2021-02-17T10:21:38Z","updated_at":"2021-04-29T20:05:04Z","due_on":"2021-04-06T07:00:00Z","closed_at":"2021-04-06T06:17:01Z"},"comments":2,"created_at":"2021-03-11T09:27:11Z","updated_at":"2022-08-11T07:17:25Z","closed_at":"2021-03-11T13:51:06Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Which version of Syncthing and what operating system you are using:**\r\n**OS:** Debian Testing (Bullseye) with all latest updates\r\n**GO:** tried 1.15.8 from testing or 1.16.0 from unstable, nothing changes\r\n**strelaysrv:** v1.14.0 \r\n\r\n**What happened:**\r\nFreshly built strelaysrv v1.14.0 don't want to start thoroughly. Loading process freezes and don't show the connection link.\r\n\r\n**Steps to reproduce:**\r\n1. git checkout v1.14.0\r\n2. go run build.go\r\n3. systemctl start strelay.service - handmade systemd script with following command:\r\n`ExecStart=/srv/syncthing/bin/strelaysrv -keys=/srv/syncthing/relay -pools=\"\" -status-srv=\"\" -protocol=tcp4 -listen=10.10.20.10:22067 -ext-address=xxx.xxx.xxx.xxx:22067 -debug`\r\n\r\n4. tail -f /var/log/syslog:\r\n```\r\nMar 11 12:17:17 ftpve systemd[1]: Started Syncthing Relay Server.\r\nMar 11 12:17:17 ftpve strelaysrv[32158]: 2021/03/11 12:17:17 main.go:140: strelaysrv v1.14.0 \"Fermium Flea\" (go1.16 linux-amd64) root@ftdebdesk 2021-02-26 12:21:13 UTC [purego]\r\nMar 11 12:17:17 ftpve strelaysrv[32158]: 2021/03/11 12:17:17 main.go:146: Connection limit 419430\r\nMar 11 12:17:17 ftpve strelaysrv[32158]: 2021/03/11 12:17:17 main.go:185: ID: HR3QXIF-HOMCBFR-UT2GZG4-QFQKAQ5-VVYH54F-6DVGSSX-XXXXXXX-XXXXXXX\r\n```\r\n5. netstat -tunap | grep str - empty output\r\n6. That's all, it won't load further\r\n\r\n**Steps to fix:**\r\n1. git checkout v1.13.1\r\n2. go run build.go\r\n3. systemctl start strelay.service - handmade systemd script with following command:\r\n`ExecStart=/srv/syncthing/bin/strelaysrv -keys=/srv/syncthing/relay -pools=\"\" -status-srv=\"\" -protocol=tcp4 -listen=10.10.20.10:22067 -ext-address=xxx.xxx.xxx.xxx:22067 -debug`\r\n\r\n4. tail -f /var/log/syslog:\r\n```\r\nMar 11 12:23:34 ftpve systemd[1]: Started Syncthing Relay Server.\r\nMar 11 12:23:34 ftpve strelaysrv[9370]: 2021/03/11 12:23:34 main.go:140: strelaysrv v1.13.1 \"Fermium Flea\" (go1.16 linux-amd64) root@ftdebdesk 2021-01-11 14:15:21 UTC [purego]\r\nMar 11 12:23:34 ftpve strelaysrv[9370]: 2021/03/11 12:23:34 main.go:146: Connection limit 419430\r\nMar 11 12:23:34 ftpve strelaysrv[9370]: 2021/03/11 12:23:34 main.go:185: ID: HR3QXIF-HOMCBFR-UT2GZG4-QFQKAQ5-VVYH54F-6DVGSSX-XXXXXXX-XXXXXXX\r\nMar 11 12:23:34 ftpve strelaysrv[9370]: 2021/03/11 12:23:34 main.go:237: URI: relay://xxx.xxx.xxx.xxx:22067/?id=HR3QXIF-HOMCBFR-UT2GZG4-QFQKAQ5-VVYH54F-6DVGSSX-XXXXXXX-XXXXXXX&pingInterval=1m0s&networkTimeout=2m0s&sessionLimitBps=0&globalLimitBps=0&statusAddr=&providedBy=\r\n```\r\n5. netstat -tunap | grep str:\r\n`tcp        0      0 10.10.20.10:22067       0.0.0.0:*               LISTEN      9370/strelaysrv`\r\n6. Working as expected\r\n","closed_by":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/7451/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/7451/timeline","performed_via_github_app":null,"state_reason":"completed"}