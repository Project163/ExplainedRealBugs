{"url":"https://api.github.com/repos/syncthing/syncthing/issues/6397","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/6397/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/6397/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/6397/events","html_url":"https://github.com/syncthing/syncthing/issues/6397","id":576569355,"node_id":"MDU6SXNzdWU1NzY1NjkzNTU=","number":6397,"title":"Loop migrating database","user":{"login":"fbreve","id":7475908,"node_id":"MDQ6VXNlcjc0NzU5MDg=","avatar_url":"https://avatars.githubusercontent.com/u/7475908?v=4","gravatar_id":"","url":"https://api.github.com/users/fbreve","html_url":"https://github.com/fbreve","followers_url":"https://api.github.com/users/fbreve/followers","following_url":"https://api.github.com/users/fbreve/following{/other_user}","gists_url":"https://api.github.com/users/fbreve/gists{/gist_id}","starred_url":"https://api.github.com/users/fbreve/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fbreve/subscriptions","organizations_url":"https://api.github.com/users/fbreve/orgs","repos_url":"https://api.github.com/users/fbreve/repos","events_url":"https://api.github.com/users/fbreve/events{/privacy}","received_events_url":"https://api.github.com/users/fbreve/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"},{"id":753433298,"node_id":"MDU6TGFiZWw3NTM0MzMyOTg=","url":"https://api.github.com/repos/syncthing/syncthing/labels/skip-changelog","name":"skip-changelog","color":"7fffb4","default":false,"description":"Bugs that have never been in a released stable version, and as such excluded from the release notes"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/syncthing/syncthing/milestones/44","html_url":"https://github.com/syncthing/syncthing/milestone/44","labels_url":"https://api.github.com/repos/syncthing/syncthing/milestones/44/labels","id":5009490,"node_id":"MDk6TWlsZXN0b25lNTAwOTQ5MA==","number":44,"title":"v1.4.0","description":"Important changes:\r\n\r\n- A new config option maxConcurrentIncomingRequestKiB has been added to limit the maximum amount of request data being concurrently processed due to incoming requests. This limits Syncthing's peak RAM usage when there are many connected devices all requesting file data. The default is 256 MiB.\r\n\r\n- The config option maxConcurrentScans has been removed and replaced a new config option maxFolderConcurrency. In addition to just limiting concurrent scans it now also limits concurrent sync operations. The default is the number of available CPU threads (\"GOMAXPROCS\").\r\n\r\n- Syncthing now always runs the monitor process, which previously was disabled with -no-restart. This facilitates crash reporting and makes logging behave more consistently. The observed behavior with -no-restart should be the same as before but the internals differ.\r\n\r\n- The database schema has been improved and will result in a migration plus compaction at first startup after the upgrade.\r\n","creator":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":53,"state":"closed","created_at":"2020-01-16T06:48:10Z","updated_at":"2020-03-17T06:20:59Z","due_on":"2020-03-17T07:00:00Z","closed_at":"2020-03-17T06:20:59Z"},"comments":5,"created_at":"2020-03-05T22:27:00Z","updated_at":"2021-03-07T07:02:28Z","closed_at":"2020-03-06T19:51:01Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"One of my machines is stuck in this loop:\r\n\r\n[start] 19:23:49 INFO: syncthing v1.4.0-rc.10 \"Fermium Flea\" (go1.13.8 windows-amd64) teamcity@build.syncthing.net 2020-02-29 18:51:48 UTC\r\n[start] 19:23:49 INFO: Using large-database tuning\r\n[start] 19:23:49 INFO: Automatic upgrade is always enabled for candidate releases.\r\n[CBEOV] 19:23:49 INFO: My ID: CBEOV4E\r\n[CBEOV] 19:23:50 INFO: Single thread SHA256 performance is 216 MB/s using minio/sha256-simd (164 MB/s using crypto/sha256).\r\n[CBEOV] 19:23:50 INFO: Hashing performance is 183.12 MB/s\r\n[CBEOV] 19:23:50 INFO: Migrating database to schema version 9...\r\n[CBEOV] 19:24:12 WARNING: Database schema: key not found\r\n[monitor] 19:24:13 INFO: Log output saved to file \"C:\\Users\\fbrev\\AppData\\Local\\Syncthing\\syncthing.log\"\r\n[start] 19:24:13 INFO: syncthing v1.4.0-rc.10 \"Fermium Flea\" (go1.13.8 windows-amd64) teamcity@build.syncthing.net 2020-02-29 18:51:48 UTC\r\n[start] 19:24:13 INFO: Using large-database tuning\r\n[start] 19:24:13 INFO: Automatic upgrade is always enabled for candidate releases.\r\n[CBEOV] 19:24:13 INFO: My ID: CBEOV4E\r\n[CBEOV] 19:24:14 INFO: Single thread SHA256 performance is 206 MB/s using minio/sha256-simd (138 MB/s using crypto/sha256).\r\n[CBEOV] 19:24:15 INFO: Hashing performance is 192.41 MB/s\r\n[CBEOV] 19:24:15 INFO: Migrating database to schema version 9...\r\n[CBEOV] 19:24:36 WARNING: Database schema: key not found\r\n[monitor] 19:24:36 INFO: Log output saved to file \"C:\\Users\\fbrev\\AppData\\Local\\Syncthing\\syncthing.log\"\r\n[start] 19:24:36 INFO: syncthing v1.4.0-rc.10 \"Fermium Flea\" (go1.13.8 windows-amd64) teamcity@build.syncthing.net 2020-02-29 18:51:48 UTC\r\n[start] 19:24:36 INFO: Using large-database tuning\r\n[start] 19:24:36 INFO: Automatic upgrade is always enabled for candidate releases.\r\n[CBEOV] 19:24:36 INFO: My ID: CBEOV4E\r\n[CBEOV] 19:24:37 INFO: Single thread SHA256 performance is 218 MB/s using minio/sha256-simd (161 MB/s using crypto/sha256).\r\n[CBEOV] 19:24:37 INFO: Hashing performance is 164.65 MB/s\r\n[CBEOV] 19:24:37 INFO: Migrating database to schema version 9...\r\n[CBEOV] 19:24:58 WARNING: Database schema: key not found\r\n[monitor] 19:24:59 INFO: Log output saved to file \"C:\\Users\\fbrev\\AppData\\Local\\Syncthing\\syncthing.log\"\r\n[start] 19:24:59 INFO: syncthing v1.4.0-rc.10 \"Fermium Flea\" (go1.13.8 windows-amd64) teamcity@build.syncthing.net 2020-02-29 18:51:48 UTC\r\n[start] 19:24:59 INFO: Using large-database tuning\r\n[start] 19:24:59 INFO: Automatic upgrade is always enabled for candidate releases.\r\n[CBEOV] 19:24:59 INFO: My ID: CBEOV4E\r\n[CBEOV] 19:25:00 INFO: Single thread SHA256 performance is 224 MB/s using minio/sha256-simd (168 MB/s using crypto/sha256).\r\n[CBEOV] 19:25:00 INFO: Hashing performance is 198.79 MB/s\r\n[CBEOV] 19:25:00 INFO: Migrating database to schema version 9...\r\n[CBEOV] 19:25:22 WARNING: Database schema: key not found\r\n[monitor] 19:25:22 INFO: Log output saved to file \"C:\\Users\\fbrev\\AppData\\Local\\Syncthing\\syncthing.log\"\r\n[start] 19:25:22 INFO: syncthing v1.4.0-rc.10 \"Fermium Flea\" (go1.13.8 windows-amd64) teamcity@build.syncthing.net 2020-02-29 18:51:48 UTC\r\n[start] 19:25:22 INFO: Using large-database tuning\r\n[start] 19:25:22 INFO: Automatic upgrade is always enabled for candidate releases.\r\n[CBEOV] 19:25:22 INFO: My ID: CBEOV4E\r\n[CBEOV] 19:25:23 INFO: Single thread SHA256 performance is 218 MB/s using minio/sha256-simd (160 MB/s using crypto/sha256).\r\n[CBEOV] 19:25:24 INFO: Hashing performance is 186.07 MB/s\r\n[CBEOV] 19:25:24 INFO: Migrating database to schema version 9...\r\n[CBEOV] 19:25:45 WARNING: Database schema: key not found\r\n[monitor] 19:25:45 INFO: Log output saved to file \"C:\\Users\\fbrev\\AppData\\Local\\Syncthing\\syncthing.log\"\r\n[start] 19:25:45 INFO: syncthing v1.4.0-rc.10 \"Fermium Flea\" (go1.13.8 windows-amd64) teamcity@build.syncthing.net 2020-02-29 18:51:48 UTC\r\n[start] 19:25:45 INFO: Using large-database tuning\r\n[start] 19:25:46 INFO: Automatic upgrade is always enabled for candidate releases.\r\n[CBEOV] 19:25:46 INFO: My ID: CBEOV4E\r\n[CBEOV] 19:25:46 INFO: Single thread SHA256 performance is 218 MB/s using minio/sha256-simd (162 MB/s using crypto/sha256).\r\n[CBEOV] 19:25:47 INFO: Hashing performance is 194.89 MB/s\r\n[CBEOV] 19:25:47 INFO: Migrating database to schema version 9...","closed_by":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/6397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/6397/timeline","performed_via_github_app":null,"state_reason":"completed"}