{"url":"https://api.github.com/repos/syncthing/syncthing/issues/7449","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/7449/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/7449/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/7449/events","html_url":"https://github.com/syncthing/syncthing/issues/7449","id":828473604,"node_id":"MDU6SXNzdWU4Mjg0NzM2MDQ=","number":7449,"title":"Can't accept untrusted folder from Web UI","user":{"login":"zenitraM","id":863975,"node_id":"MDQ6VXNlcjg2Mzk3NQ==","avatar_url":"https://avatars.githubusercontent.com/u/863975?v=4","gravatar_id":"","url":"https://api.github.com/users/zenitraM","html_url":"https://github.com/zenitraM","followers_url":"https://api.github.com/users/zenitraM/followers","following_url":"https://api.github.com/users/zenitraM/following{/other_user}","gists_url":"https://api.github.com/users/zenitraM/gists{/gist_id}","starred_url":"https://api.github.com/users/zenitraM/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/zenitraM/subscriptions","organizations_url":"https://api.github.com/users/zenitraM/orgs","repos_url":"https://api.github.com/users/zenitraM/repos","events_url":"https://api.github.com/users/zenitraM/events{/privacy}","received_events_url":"https://api.github.com/users/zenitraM/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"},{"id":753433298,"node_id":"MDU6TGFiZWw3NTM0MzMyOTg=","url":"https://api.github.com/repos/syncthing/syncthing/labels/skip-changelog","name":"skip-changelog","color":"7fffb4","default":false,"description":"Bugs that have never been in a released stable version, and as such excluded from the release notes"},{"id":1601528430,"node_id":"MDU6TGFiZWwxNjAxNTI4NDMw","url":"https://api.github.com/repos/syncthing/syncthing/labels/ui","name":"ui","color":"bdd34e","default":false,"description":"Issues related to the graphical user interface"}],"state":"closed","locked":true,"assignee":{"login":"imsodin","id":15955093,"node_id":"MDQ6VXNlcjE1OTU1MDkz","avatar_url":"https://avatars.githubusercontent.com/u/15955093?v=4","gravatar_id":"","url":"https://api.github.com/users/imsodin","html_url":"https://github.com/imsodin","followers_url":"https://api.github.com/users/imsodin/followers","following_url":"https://api.github.com/users/imsodin/following{/other_user}","gists_url":"https://api.github.com/users/imsodin/gists{/gist_id}","starred_url":"https://api.github.com/users/imsodin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imsodin/subscriptions","organizations_url":"https://api.github.com/users/imsodin/orgs","repos_url":"https://api.github.com/users/imsodin/repos","events_url":"https://api.github.com/users/imsodin/events{/privacy}","received_events_url":"https://api.github.com/users/imsodin/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"imsodin","id":15955093,"node_id":"MDQ6VXNlcjE1OTU1MDkz","avatar_url":"https://avatars.githubusercontent.com/u/15955093?v=4","gravatar_id":"","url":"https://api.github.com/users/imsodin","html_url":"https://github.com/imsodin","followers_url":"https://api.github.com/users/imsodin/followers","following_url":"https://api.github.com/users/imsodin/following{/other_user}","gists_url":"https://api.github.com/users/imsodin/gists{/gist_id}","starred_url":"https://api.github.com/users/imsodin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imsodin/subscriptions","organizations_url":"https://api.github.com/users/imsodin/orgs","repos_url":"https://api.github.com/users/imsodin/repos","events_url":"https://api.github.com/users/imsodin/events{/privacy}","received_events_url":"https://api.github.com/users/imsodin/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/syncthing/syncthing/milestones/62","html_url":"https://github.com/syncthing/syncthing/milestone/62","labels_url":"https://api.github.com/repos/syncthing/syncthing/milestones/62/labels","id":6443170,"node_id":"MDk6TWlsZXN0b25lNjQ0MzE3MA==","number":62,"title":"v1.15.0","description":"This release fixes a vulnerability where Syncthing and the relay server can crash due to malformed relay protocol messages (CVE-2021-21404); see https://github.com/syncthing/syncthing/security/advisories/GHSA-x462-89pf-6r5h.\r\n\r\nThis release updates the CLI to use subcommands and adds the subcommands `cli` (previously standalone `stcli` utility) and `decrypt` (for offline verifying and decrypting encrypted folders).\r\n\r\nWith this release we invite everyone to test the \"untrusted (encrypted) devices\" feature. You should not use it yet on important production data. Thus UI controls are hidden behind a feature flag. For more information, visit: \r\nhttps://forum.syncthing.net/t/testing-untrusted-encrypted-devices/16470","creator":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":88,"state":"closed","created_at":"2021-02-17T10:21:38Z","updated_at":"2021-04-29T20:05:04Z","due_on":"2021-04-06T07:00:00Z","closed_at":"2021-04-06T06:17:01Z"},"comments":1,"created_at":"2021-03-10T23:30:38Z","updated_at":"2022-08-11T07:17:27Z","closed_at":"2021-03-11T10:21:41Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Steps to reproduce:\r\n- Enable untrusted feature flag on both devices A and B, restart them\r\n- Create a shared folder from device A from the UI\r\n- Share it with device B, enabling the untrusted checkbox and entering a password\r\n- Go to device B on web UI, try and accept the request to add the new folder\r\n\r\nThe result is that the window closes, but the folder is not added due to the following Javascript error:\r\n\r\nFirefox backtrace:\r\n```\r\nError: folderCfg.versioning is undefined\r\n$scope.saveFolder@http://127.0.0.1:8384/syncthing/core/syncthingController.js:2096:13\r\n$parseFunctionCall@http://127.0.0.1:8384/vendor/angular/angular.js:12493:18\r\ncallback@http://127.0.0.1:8384/vendor/angular/angular.js:21719:19\r\n$eval@http://127.0.0.1:8384/vendor/angular/angular.js:14589:28\r\n$apply@http://127.0.0.1:8384/vendor/angular/angular.js:14688:23\r\nngEventHandler/<@http://127.0.0.1:8384/vendor/angular/angular.js:21724:23\r\ndispatch@http://127.0.0.1:8384/vendor/jquery/jquery-2.2.2.js:4755:27\r\nadd/elemData.handle@http://127.0.0.1:8384/vendor/jquery/jquery-2.2.2.js:4567:28\r\n```\r\n\r\nChromium backtrace:\r\n```\r\nTypeError: Cannot set property 'type' of undefined\r\n    at Scope.$scope.saveFolder (syncthingController.js:2096)\r\n    at $parseFunctionCall (angular.js:12493)\r\n    at callback (angular.js:21719)\r\n    at Scope.$eval (angular.js:14589)\r\n    at Scope.$apply (angular.js:14688)\r\n    at HTMLButtonElement.<anonymous> (angular.js:21724)\r\n    at HTMLButtonElement.dispatch (jquery-2.2.2.js:4755)\r\n    at HTMLButtonElement.elemData.handle (jquery-2.2.2.js:4567)\r\n```\r\n\r\nI have tried a couple times deleting and recreating the folder from device A but I get always the same result on the UI for device B, as well as when trying to add the folder manually specifying the device ID. \r\n\r\nTested on Syncthing version `v1.15.0-rc2` running on both nodes and recent versions of Firefox/Chromium on Linux.","closed_by":{"login":"imsodin","id":15955093,"node_id":"MDQ6VXNlcjE1OTU1MDkz","avatar_url":"https://avatars.githubusercontent.com/u/15955093?v=4","gravatar_id":"","url":"https://api.github.com/users/imsodin","html_url":"https://github.com/imsodin","followers_url":"https://api.github.com/users/imsodin/followers","following_url":"https://api.github.com/users/imsodin/following{/other_user}","gists_url":"https://api.github.com/users/imsodin/gists{/gist_id}","starred_url":"https://api.github.com/users/imsodin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imsodin/subscriptions","organizations_url":"https://api.github.com/users/imsodin/orgs","repos_url":"https://api.github.com/users/imsodin/repos","events_url":"https://api.github.com/users/imsodin/events{/privacy}","received_events_url":"https://api.github.com/users/imsodin/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/7449/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/7449/timeline","performed_via_github_app":null,"state_reason":"completed"}