{"url":"https://api.github.com/repos/syncthing/syncthing/issues/1263","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/1263/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/1263/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/1263/events","html_url":"https://github.com/syncthing/syncthing/issues/1263","id":54668439,"node_id":"MDU6SXNzdWU1NDY2ODQzOQ==","number":1263,"title":"Empty files left behind","user":{"login":"CoupeWare","id":9490727,"node_id":"MDQ6VXNlcjk0OTA3Mjc=","avatar_url":"https://avatars.githubusercontent.com/u/9490727?v=4","gravatar_id":"","url":"https://api.github.com/users/CoupeWare","html_url":"https://github.com/CoupeWare","followers_url":"https://api.github.com/users/CoupeWare/followers","following_url":"https://api.github.com/users/CoupeWare/following{/other_user}","gists_url":"https://api.github.com/users/CoupeWare/gists{/gist_id}","starred_url":"https://api.github.com/users/CoupeWare/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CoupeWare/subscriptions","organizations_url":"https://api.github.com/users/CoupeWare/orgs","repos_url":"https://api.github.com/users/CoupeWare/repos","events_url":"https://api.github.com/users/CoupeWare/events{/privacy}","received_events_url":"https://api.github.com/users/CoupeWare/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":55,"created_at":"2015-01-17T17:32:07Z","updated_at":"2017-06-16T21:09:48Z","closed_at":"2016-01-16T17:59:52Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I was comparing the speed of Syncthing (0.10.20) to btsync (1.4.106) between 2 Linux computers, one a Core i7 and one a Odroid-C1 (Quad Core Arm 1.5 GHz). I ran two tests, one with a lot of small files (500 1 MB files and 100 5 MB files) and one with several large files (one 10 GB file and ten 1 GB files).\n\nIn both cases Syncthing took about twice as long to sync as btsync. This was on a GB network. The average speed was 20 Mb/s for Syncthing and 40 Mb/s for btsync. In the case of the large files (20 GB total) it took syncthing 4 minutes to scan the files before it started to transfer and it took btsync 2 minutes to index the files before it started to transfer. This was happening on the Core i7 computer. This is for information only and has nothing to do with this issue.\n\nBecause the sync was taking so long I cancelled it before it was done with the larger files. I waited until the 10 GB file and 2 of the 1 GB files were complete and then moved the files on the source machine (Core i7) to  different folder.\n\nSyncthing was not able to remove one of the folders from the computer that was receiving the files. This was because it left empty files behind with the names of the files that it had not yet started syncing. It appears that once syncthing knows a file needs to be created on the receiving end, it creates an empty file and if that file disappears before anything is transferred into the empty file it does not get deleted on the receiving end. The file that was in the process of receiving data was deleted when the source file disappeared. 7 empty files were left behind. The 3 files that had been completed and the 1 file that had received some data were deleted along with the folder that only contained the 10 GB file. The folder with the 1 GB files could not be deleted because of the empty files in it.\n\nBTSync did not have the problem but it did not create empty files ahead of time.\n\nThe folder that disappeared on the source computer could not be deleted on the receiving computer because it was not empty but the real problem was that they contained empty files that no longer existed on the source computer. The web interface referred to the logs and I have piped the console output to the log file so it was easy to see what the problem as.\n\nI have had a similar problem when adding files to the .stignore file after it has synced the first time. When I delete or move a folder that contains a file name that matches a file name in the .stignore file on one end the file is not deleted on the other end so the non-empty folder can not be deleted. The only file left in the non-empty folder on the receiving end is the one that is now being ignored. I can live with this since it only happens when the .stignore file is changed and I can easily find and deleted the files that are left behind. It would be nice if this was handled more gracefully.\n","closed_by":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/1263/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/1263/timeline","performed_via_github_app":null,"state_reason":"completed"}