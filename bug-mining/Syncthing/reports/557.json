{"url":"https://api.github.com/repos/syncthing/syncthing/issues/3726","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/3726/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/3726/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/3726/events","html_url":"https://github.com/syncthing/syncthing/issues/3726","id":188854534,"node_id":"MDU6SXNzdWUxODg4NTQ1MzQ=","number":3726,"title":"strelaysrv: Static client does not reconnect on failure","user":{"login":"CompuRoot","id":276694,"node_id":"MDQ6VXNlcjI3NjY5NA==","avatar_url":"https://avatars.githubusercontent.com/u/276694?v=4","gravatar_id":"","url":"https://api.github.com/users/CompuRoot","html_url":"https://github.com/CompuRoot","followers_url":"https://api.github.com/users/CompuRoot/followers","following_url":"https://api.github.com/users/CompuRoot/following{/other_user}","gists_url":"https://api.github.com/users/CompuRoot/gists{/gist_id}","starred_url":"https://api.github.com/users/CompuRoot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CompuRoot/subscriptions","organizations_url":"https://api.github.com/users/CompuRoot/orgs","repos_url":"https://api.github.com/users/CompuRoot/repos","events_url":"https://api.github.com/users/CompuRoot/events{/privacy}","received_events_url":"https://api.github.com/users/CompuRoot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2016-11-11T21:26:39Z","updated_at":"2017-11-15T07:21:38Z","closed_at":"2016-11-13T08:33:03Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Version Information\r\n\r\n_**Syncthing Version**: v0.14.10\r\n**OS Version**: Windows 7 / LinuxMint 13|17|18 / FreeBSD 10\r\n**Browser Version**: Firefox 49.0.2_\r\n\r\n---------------------------------\r\n\r\n **- what happened:**\r\nSyncThing monitored over web interface and it showed 3/3 listeners(two relays and local IP).\r\nI stopped one of relay server, then upgraded it to the latest version and restarted. \r\nUpgraded relay itself is working fine.\r\nSyncThing showed 2/3 listeners regardless how long one ready to wait.\r\nWhen relay was upgraded and restarted syncthing stuck on 2/3 listeners and upgraded relay does not show any connection from clients too (\"numConnections\": 0,)\r\nAfter syncthing forcibly was restarted via web gui menu, syncthing found all relays again\r\n\r\n **- what you expected to happen instead:**\r\nI assume that syncthing should query relay on reguar basis and reconnect to it automatically in case of network issue with relay or relay simply restarted.\r\n\r\n **- any steps to reproduce the problem:**\r\nPrecondition: running own latest relay (strelaysrv-~10+12) and discovery(stdiscosrv-linux-arm-v0.14.10+6) servers. Query to discovery and relays issued with certificate pinning (providing UUID of remote relay in URL). Relays and discovery server listening on non default ports.\r\n\r\nEverything works fine until one of relays stopped for a period of time longer than \r\nspecified in query url to relay (...pingInterval=1m0s&networkTimeout=2m0s...)\r\nAfter that, syncthing will not automatically reconnect to relay that was restarted. \r\nThe only restart of synthing can fix issue.\r\n\r\nFirst, I think it somehow related to a new version of stRelay but it isn't (tried to run previous version with the same effect - if relay stopped for long period of time and started again, clients cant see restarted relay anymore until clients itself restarted)","closed_by":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/3726/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/3726/timeline","performed_via_github_app":null,"state_reason":"completed"}