{"url":"https://api.github.com/repos/syncthing/syncthing/issues/9072","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/9072/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/9072/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/9072/events","html_url":"https://github.com/syncthing/syncthing/issues/9072","id":1878806935,"node_id":"I_kwDOAOCAEs5v_FGX","number":9072,"title":"Omitting %s from LDAP search filter results in corrupt search filter","user":{"login":"Salvoxia","id":6501566,"node_id":"MDQ6VXNlcjY1MDE1NjY=","avatar_url":"https://avatars.githubusercontent.com/u/6501566?v=4","gravatar_id":"","url":"https://api.github.com/users/Salvoxia","html_url":"https://github.com/Salvoxia","followers_url":"https://api.github.com/users/Salvoxia/followers","following_url":"https://api.github.com/users/Salvoxia/following{/other_user}","gists_url":"https://api.github.com/users/Salvoxia/gists{/gist_id}","starred_url":"https://api.github.com/users/Salvoxia/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Salvoxia/subscriptions","organizations_url":"https://api.github.com/users/Salvoxia/orgs","repos_url":"https://api.github.com/users/Salvoxia/repos","events_url":"https://api.github.com/users/Salvoxia/events{/privacy}","received_events_url":"https://api.github.com/users/Salvoxia/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/syncthing/syncthing/milestones/98","html_url":"https://github.com/syncthing/syncthing/milestone/98","labels_url":"https://api.github.com/repos/syncthing/syncthing/milestones/98/labels","id":10013944,"node_id":"MI_kwDOAOCAEs4AmMz4","number":98,"title":"v1.26.0","description":"","creator":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":25,"state":"closed","created_at":"2023-10-07T02:37:42Z","updated_at":"2023-11-06T17:44:27Z","due_on":"2023-11-07T08:00:00Z","closed_at":"2023-11-06T17:44:27Z"},"comments":3,"created_at":"2023-09-02T18:58:28Z","updated_at":"2024-10-06T18:45:21Z","closed_at":"2023-10-07T02:29:56Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Syncthing Version\r\n\r\nSyncthing version: v1.23.7, AMD64 Docker Container\r\n\r\n## What Happened\r\n\r\nThis seems similar to #8899, but for the LDAP search filter.\r\nConfiguring an LDAP search filter without the %s placeholder results in a warning message in the log file and a corrupt search filter sent to the LDAP server. Logging in with LDAP fails. I could not find the search filter in the LDAP log files though, but that might be due to the behavior of my LDAP server when receiving a corrupt search filter.\r\n\r\nIf %s is used in LDAP search filter, everything works.\r\n\r\nDoes __not__ work:\r\n```\r\n(memberOf=CN=Syncthing,CN=Users,DC=example,DC=com)\r\n```\r\nMessage in Syncthing log reads\r\n```\r\nWARNING: LDAP Search: LDAP Result Code 201 \"Filter Compile Error\": ldap: finished compiling filter with extra at end: %!(EXTRA string=myUser)\r\n```\r\n\r\n__Works__:\r\n```\r\n(&(sAMAccountName=%s)(memberOf=CN=Syncthing,CN=Users,DC=example,DC=com))\r\n```\r\n\r\n## What Is Expected\r\n\r\nIf %s is omitted from LDAP search filter, send it as configured without any processing.\r\n\r\n## Reproduction\r\n  - Configure an LDAP search filter without a %s placeholder\r\n  - Enable LDAP auth\r\n  - Login fails, find warning in Syncthing logs, possibly in LDAP logs depending on LDAP server\r\n","closed_by":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/9072/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/9072/timeline","performed_via_github_app":null,"state_reason":"completed"}