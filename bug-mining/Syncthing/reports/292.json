{"url":"https://api.github.com/repos/syncthing/syncthing/issues/1751","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/1751/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/1751/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/1751/events","html_url":"https://github.com/syncthing/syncthing/issues/1751","id":72670796,"node_id":"MDU6SXNzdWU3MjY3MDc5Ng==","number":1751,"title":"Ping timeout during index exchange","user":{"login":"alex2108","id":6099511,"node_id":"MDQ6VXNlcjYwOTk1MTE=","avatar_url":"https://avatars.githubusercontent.com/u/6099511?v=4","gravatar_id":"","url":"https://api.github.com/users/alex2108","html_url":"https://github.com/alex2108","followers_url":"https://api.github.com/users/alex2108/followers","following_url":"https://api.github.com/users/alex2108/following{/other_user}","gists_url":"https://api.github.com/users/alex2108/gists{/gist_id}","starred_url":"https://api.github.com/users/alex2108/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alex2108/subscriptions","organizations_url":"https://api.github.com/users/alex2108/orgs","repos_url":"https://api.github.com/users/alex2108/repos","events_url":"https://api.github.com/users/alex2108/events{/privacy}","received_events_url":"https://api.github.com/users/alex2108/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767667,"node_id":"MDU6TGFiZWw2Nzc2NzY2Nw==","url":"https://api.github.com/repos/syncthing/syncthing/labels/enhancement","name":"enhancement","color":"0e8a16","default":true,"description":"New features or improvements of some kind, as opposed to a problem (bug)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":11,"created_at":"2015-05-02T16:58:03Z","updated_at":"2017-06-16T21:07:34Z","closed_at":"2015-06-28T05:45:04Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"the index exchange seems to work fine, at least the gui of the laptop shows \"Up to date\" for a while but then the raspberry disconnects.\n\nBefore 0.11 I never saw this and as soon as the connection is established (which worked in some rare cases and which works almost always to another device that syncs less data, except both devices try to connect, then both connections constantly break after index exchange) it stays connected so I assume it's not a real network issue.\n\npart of the log on the raspberry pi:\n\n```\n[NRL2J] 2015/05/02 17:10:59.590206 connections.go:95: INFO: Established secure connection to 7TQSWGR-... at 192.168.1.71:22000-79.231.115.135:52951\n[NRL2J] 2015/05/02 17:11:00.624042 model.go:588: INFO: Device 7TQSWGR-... client is \"syncthing v0.11.1\"\n[NRL2J] 2015/05/02 17:11:00.628217 model.go:593: INFO: Device 7TQSWGR-... name is \"laptop\"\n[NRL2J] 2015/05/02 17:18:23.772963 connections.go:134: INFO: Connected to already connected device (7TQSWGR-...)\n[NRL2J] 2015/05/02 17:18:28.088101 model.go:674: INFO: Connection to 7TQSWGR-... closed: EOF\n[NRL2J] 2015/05/02 17:20:59.056688 connections.go:95: INFO: Established secure connection to 7TQSWGR-... at 192.168.1.71:22000-79.231.115.135:53080\n[NRL2J] 2015/05/02 17:20:59.334155 model.go:588: INFO: Device 7TQSWGR-... client is \"syncthing v0.11.1\"\n[NRL2J] 2015/05/02 17:20:59.338092 model.go:593: INFO: Device 7TQSWGR-... name is \"laptop\"\n[NRL2J] 2015/05/02 17:28:42.376262 model.go:674: INFO: Connection to 7TQSWGR-... closed: EOF\n```\n\npart of the log from the laptop:\n\n```\n[7TQSW] 17:19:30 INFO: Established secure connection to NRL2JRW-... at 192.168.2.112:53080-78.43.167.253:22000\n[7TQSW] 17:20:59 INFO: Device NRL2JRW-... client is \"syncthing v0.11.1\"\n[7TQSW] 17:20:59 INFO: Device NRL2JRW-... name is \"raspberrypi\"\n[7TQSW] 17:28:00 INFO: Connection to NRL2JRW-... closed: ping timeout\n[7TQSW] 17:28:48 INFO: Established secure connection to NRL2JRW-... at 192.168.2.112:53174-78.43.167.253:22000\n[7TQSW] 17:30:58 INFO: Device NRL2JRW-... client is \"syncthing v0.11.1\"\n[7TQSW] 17:30:58 INFO: Device NRL2JRW-... name is \"raspberrypi\"\n[7TQSW] 17:31:18 INFO: Connection to NRL2JRW-... closed: ping timeout\n[7TQSW] 17:31:57 INFO: Established secure connection to NRL2JRW-... at 192.168.2.112:53233-78.43.167.253:22000\n[7TQSW] 17:31:57 INFO: Device NRL2JRW-... client is \"syncthing v0.11.1\"\n[7TQSW] 17:31:57 INFO: Device NRL2JRW-... name is \"raspberrypi\"\n```\n\n`Connected to already connected device` sometimes happens a bit more often than in the log I copied here until the raspberry notices the old connection is gone.\n\nI also tried STTRACE=net but this does not reveal more.\n\nAnother thing that I noticed: even after I shut down syncthing on all devices except the raspberry pi there is still maximum CPU usage from syncthing for around one minute.\n\nAny other STTRACE that could reveal what is going on here? For me it looks like some connection related stuff does not get enough CPU time and I get timeouts due to that.\n","closed_by":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/1751/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/1751/timeline","performed_via_github_app":null,"state_reason":"completed"}