{"url":"https://api.github.com/repos/syncthing/syncthing/issues/4552","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/4552/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/4552/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/4552/events","html_url":"https://github.com/syncthing/syncthing/issues/4552","id":276806250,"node_id":"MDU6SXNzdWUyNzY4MDYyNTA=","number":4552,"title":"Add UI for filesystem watcher","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767667,"node_id":"MDU6TGFiZWw2Nzc2NzY2Nw==","url":"https://api.github.com/repos/syncthing/syncthing/labels/enhancement","name":"enhancement","color":"0e8a16","default":true,"description":"New features or improvements of some kind, as opposed to a problem (bug)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/syncthing/syncthing/milestones/21","html_url":"https://github.com/syncthing/syncthing/milestone/21","labels_url":"https://api.github.com/repos/syncthing/syncthing/milestones/21/labels","id":3216518,"node_id":"MDk6TWlsZXN0b25lMzIxNjUxOA==","number":21,"title":"v0.14.47","description":null,"creator":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":10,"state":"closed","created_at":"2018-03-26T09:31:04Z","updated_at":"2018-06-06T21:34:12Z","due_on":null,"closed_at":"2018-05-01T10:36:09Z"},"comments":8,"created_at":"2017-11-26T07:35:38Z","updated_at":"2019-03-26T07:02:30Z","closed_at":"2018-03-25T20:05:50Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Now that we have the watcher code in place, let’s add the UI. There’s a couple of different parts to that:\r\n\r\n- enabling it to begin with\r\n- showing its current status\r\n- showing a reasonable error when it doesn’t work\r\n\r\nThe enabling part is fairly simple. I think we’ve already mostly agreed on a checkbox, and when ticked it will also automatically increase the rescan interval to something high. This happens in the config UI, so the user can change the interval if they want, and in the code it’s still the same interval mechanism as usual. When the watcher is disabled we suggest the usual default interval of 60 seconds. One thing to note here might be a documentation link or comment about why rescans may still be necessary. As far as I know, permission only changes are not picked up by the watcher? Mtime only changes? May need some investigation.\r\n\r\nThe folder status thing on the left should have a row for the fs watcher status. For most things we don’t show a row unless the value diverges from the default. Nonetheless I think the fs watcher row should always be present and probably replace the rescan interval row. Having it there with “Watcher: On (rescans at 7200s)” or whatever even in the default case gives peace of mind that it’s actually running.  \r\n\r\nWhen it’s enabled but not running we should show an error indication similar to when a folder stopped. (XXX: and change the scan interval...? Not a UI question)\r\n\r\nIf there are cases when it’s “half running” we need to figure that out. For example if it’s running fine and I copy in a directory into the folder and now it exceeds the system max number of open watch frobbits. \r\n\r\nWe should not, at this time, automatically enable watches for existing folders. We may want to have it on by default for newly created folders?","closed_by":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/4552/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/4552/timeline","performed_via_github_app":null,"state_reason":"completed"}