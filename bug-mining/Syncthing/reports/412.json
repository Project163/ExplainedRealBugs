{"url":"https://api.github.com/repos/syncthing/syncthing/issues/2705","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/2705/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/2705/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/2705/events","html_url":"https://github.com/syncthing/syncthing/issues/2705","id":127051849,"node_id":"MDU6SXNzdWUxMjcwNTE4NDk=","number":2705,"title":"Crash on folder removal","user":{"login":"lfam","id":6568228,"node_id":"MDQ6VXNlcjY1NjgyMjg=","avatar_url":"https://avatars.githubusercontent.com/u/6568228?v=4","gravatar_id":"","url":"https://api.github.com/users/lfam","html_url":"https://github.com/lfam","followers_url":"https://api.github.com/users/lfam/followers","following_url":"https://api.github.com/users/lfam/following{/other_user}","gists_url":"https://api.github.com/users/lfam/gists{/gist_id}","starred_url":"https://api.github.com/users/lfam/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lfam/subscriptions","organizations_url":"https://api.github.com/users/lfam/orgs","repos_url":"https://api.github.com/users/lfam/repos","events_url":"https://api.github.com/users/lfam/events{/privacy}","received_events_url":"https://api.github.com/users/lfam/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":2,"created_at":"2016-01-16T20:30:57Z","updated_at":"2017-06-16T21:03:01Z","closed_at":"2016-01-16T20:54:46Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I added a shared folder, located on a remote machine, to test transfer speeds to the local machine. So, only two nodes. After the local shared folder was ~5% completed, I removed the folder from the local machine through the web interface. When that happened, Syncthing crashed.\n\nHere is some info about each Syncthing installation, followed by the panic trace.\n\nRemote machine (Debian Jessie):\n\n```\n$ syncthing --version\nsyncthing v0.12.14 \"Beryllium Bedbug\" (go1.5.3 linux-amd64) unknown-user@build2.syncthing.net 2016-01-13 20:11:02 UTC\n```\n\nLocal machine where Syncthing crashed (Debian Stretch):\n\n```\n$ syncthing --version\nsyncthing v0.12.13 \"Beryllium Bedbug\" (go1.5.3 linux-amd64) unknown-user@build2.syncthing.net 2016-01-13 20:11:02 UTC\n```\n\nPanic trace with sanitized hostnames. If you think the hostnames are related, I can provide them. They fit within ASCII.\n\n```\nJan 16 15:15:57 local syncthing[22535]: [MQPBM] INFO: Puller: final: peers who had this file went away, or the file has changed while syncing. will retry later\nJan 16 15:15:57 local syncthing[22535]: panic: runtime error: invalid memory address or nil pointer dereference\nJan 16 15:15:57 local syncthing[22535]: [signal 0xb code=0x1 addr=0x0 pc=0x6523df]\nJan 16 15:15:57 local syncthing[22535]: goroutine 2358 [running]:\nJan 16 15:15:57 local syncthing[22535]: github.com/syncthing/syncthing/lib/db.(*FileSet).Update(0x0, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xffffffffffffffff, 0xc822684000, 0x25, 0x3e8)\nJan 16 15:15:57 local syncthing[22535]: /home/jenkins/workspace/syncthing-release-debian/src/github.com/syncthing/syncthing/lib/db/set.go:140 +0xabf\nJan 16 15:15:57 local syncthing[22535]: github.com/syncthing/syncthing/lib/model.(*Model).updateLocals(0xc8210fa240, 0xc821593050, 0x9, 0xc822684000, 0x25, 0x3e8)\nJan 16 15:15:57 local syncthing[22535]: /home/jenkins/workspace/syncthing-release-debian/src/github.com/syncthing/syncthing/lib/model/model.go:1171 +0x137\nJan 16 15:15:57 local syncthing[22535]: github.com/syncthing/syncthing/lib/model.(*rwFolder).dbUpdaterRoutine.func1()\nJan 16 15:15:57 local syncthing[22535]: /home/jenkins/workspace/syncthing-release-debian/src/github.com/syncthing/syncthing/lib/model/rwfolder.go:1433 +0x268\nJan 16 15:15:57 local syncthing[22535]: github.com/syncthing/syncthing/lib/model.(*rwFolder).dbUpdaterRoutine(0xc8208d3b80)\nJan 16 15:15:57 local syncthing[22535]: /home/jenkins/workspace/syncthing-release-debian/src/github.com/syncthing/syncthing/lib/model/rwfolder.go:1460 +0x359\nJan 16 15:15:57 local syncthing[22535]: github.com/syncthing/syncthing/lib/model.(*rwFolder).pullerIteration.func1(0xc8208d3b80, 0x7f96944a1930, 0xc8216bd660)\nJan 16 15:15:57 local syncthing[22535]: /home/jenkins/workspace/syncthing-release-debian/src/github.com/syncthing/syncthing/lib/model/rwfolder.go:411 +0x21\nJan 16 15:15:57 local syncthing[22535]: created by github.com/syncthing/syncthing/lib/model.(*rwFolder).pullerIteration\nJan 16 15:15:57 local syncthing[22535]: /home/jenkins/workspace/syncthing-release-debian/src/github.com/syncthing/syncthing/lib/model/rwfolder.go:413 +0x670\nJan 16 15:15:57 local syncthing[22535]: goroutine 1 [chan receive, 110 minutes]:\nJan 16 15:15:57 local syncthing[22535]: main.syncthingMain(0x0, 0x0, 0x0, 0x0, 0x0, 0x1, 0xb66548, 0x1, 0x0, 0x0, ...)\nJan 16 15:15:57 local syncthing[22535]: /home/jenkins/workspace/syncthing-release-debian/src/github.com/syncthing/syncthing/cmd/syncthing/main.go:848 +0x3f59\nJan 16 15:15:57 local syncthing[22535]: main.main()\nJan 16 15:15:57 local syncthing[22535]: /home/jenkins/workspace/syncthing-release-debian/src/github.com/syncthing/syncthing/cmd/syncthing/main.go:362 +0x943\nJan 16 15:15:57 local syncthing[22535]: goroutine 28 [select, 50 minutes]:\nJan 16 15:15:57 local syncthing[22535]: github.com/syncthing/syncthing/lib/ignore.(*Matcher).clean(0xc82023c5a0, 0x68c61714000)\nJan 16 15:15:57 local syncthing[22535]: /home/jenkins/workspace/syncthing-release-debian/src/github.com/syncthing/syncthing/lib/ignore/ignore.go:161 +0x1ca\nJan 16 15:15:57 local syncthing[22535]: created by github.com/syncthing/syncthing/lib/ignore.New\nJan 16 15:15:57 local syncthing[22535]: /home/jenkins/workspace/syncthing-release-debian/src/github.com/syncthing/syncthing/lib/ignore/ignore.go:53 +0x159\n```\n","closed_by":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/2705/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/2705/timeline","performed_via_github_app":null,"state_reason":"completed"}