{"url":"https://api.github.com/repos/syncthing/syncthing/issues/7026","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/7026/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/7026/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/7026/events","html_url":"https://github.com/syncthing/syncthing/issues/7026","id":715884106,"node_id":"MDU6SXNzdWU3MTU4ODQxMDY=","number":7026,"title":"panic: key not found when repairing DB","user":{"login":"imsodin","id":15955093,"node_id":"MDQ6VXNlcjE1OTU1MDkz","avatar_url":"https://avatars.githubusercontent.com/u/15955093?v=4","gravatar_id":"","url":"https://api.github.com/users/imsodin","html_url":"https://github.com/imsodin","followers_url":"https://api.github.com/users/imsodin/followers","following_url":"https://api.github.com/users/imsodin/following{/other_user}","gists_url":"https://api.github.com/users/imsodin/gists{/gist_id}","starred_url":"https://api.github.com/users/imsodin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imsodin/subscriptions","organizations_url":"https://api.github.com/users/imsodin/orgs","repos_url":"https://api.github.com/users/imsodin/repos","events_url":"https://api.github.com/users/imsodin/events{/privacy}","received_events_url":"https://api.github.com/users/imsodin/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/syncthing/syncthing/milestones/63","html_url":"https://github.com/syncthing/syncthing/milestone/63","labels_url":"https://api.github.com/repos/syncthing/syncthing/milestones/63/labels","id":6628670,"node_id":"MDk6TWlsZXN0b25lNjYyODY3MA==","number":63,"title":"v1.16.0","description":"This release adds untrusted / encrypted devices for public testing. It should still be considered beta / testing-only.","creator":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":40,"state":"closed","created_at":"2021-04-06T06:29:18Z","updated_at":"2021-05-11T08:43:59Z","due_on":"2021-05-04T07:00:00Z","closed_at":"2021-05-04T09:00:11Z"},"comments":9,"created_at":"2020-10-06T17:36:45Z","updated_at":"2022-08-11T07:19:13Z","closed_at":"2021-04-05T08:24:17Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"https://sentry.syncthing.net/share/issue/b29b701f48f64fcf8ce06ef60e3cc765/\r\n\r\n```\r\ngithub.com/syncthing/syncthing/lib/db/lowlevel.go in func1 at line 818\r\ngithub.com/syncthing/syncthing/lib/db/lowlevel.go in getMetaAndCheck at line 833\r\ngithub.com/syncthing/syncthing/lib/db/lowlevel.go in loadMetadataTracker at line 856\r\ngithub.com/syncthing/syncthing/lib/db/set.go in NewFileSet at line 46\r\n```\r\n\r\nWe can't know for sure where the error is occuring, as the panic happens in defer, but given it happens on 1.10.0 only it's most likely the code added in https://github.com/syncthing/syncthing/pull/6950. The only places I see where a `key not found` could occur are the `Delete` calls. However the deleted keys are keys we just got by iterating, so they should exist.\r\n\r\nThe github-sentry integration seems to be broken","closed_by":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/7026/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/7026/timeline","performed_via_github_app":null,"state_reason":"completed"}