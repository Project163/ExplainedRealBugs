{"url":"https://api.github.com/repos/syncthing/syncthing/issues/663","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/663/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/663/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/663/events","html_url":"https://github.com/syncthing/syncthing/issues/663","id":42516606,"node_id":"MDU6SXNzdWU0MjUxNjYwNg==","number":663,"title":"Panic after changing the repository settings (staggered versioning)","user":{"login":"djtm","id":6469710,"node_id":"MDQ6VXNlcjY0Njk3MTA=","avatar_url":"https://avatars.githubusercontent.com/u/6469710?v=4","gravatar_id":"","url":"https://api.github.com/users/djtm","html_url":"https://github.com/djtm","followers_url":"https://api.github.com/users/djtm/followers","following_url":"https://api.github.com/users/djtm/following{/other_user}","gists_url":"https://api.github.com/users/djtm/gists{/gist_id}","starred_url":"https://api.github.com/users/djtm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/djtm/subscriptions","organizations_url":"https://api.github.com/users/djtm/orgs","repos_url":"https://api.github.com/users/djtm/repos","events_url":"https://api.github.com/users/djtm/events{/privacy}","received_events_url":"https://api.github.com/users/djtm/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2014-09-11T12:07:06Z","updated_at":"2017-06-17T00:13:25Z","closed_at":"2014-09-11T18:23:50Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I've changed the repository to update only every 180 seconds and to keep revisions for 60 days. The restart led to a panic, log attached.\n\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x30 pc=0x6ccac5]\n\n```\nPanic at Thu, 11 Sep 2014 12:04:02 CEST\n[HRKVO] 12:04:02 INFO: syncthing v0.9.14 (go1.3.1 linux-amd64 default) jenkins@build.syncthing.net 2014-09-10 12:21:44 UTC\n[HRKVO] 12:04:02 INFO: My ID: HRKVOTT-F66HFOV-CV2A5QQ-LTNPBRG-4KESZVJ-WOOSANE-A4L4A45-5FLODBG\n[HRKVO] 12:04:02 INFO: Starting web GUI on http://127.0.0.1:8080/\n[HRKVO] 12:04:02 INFO: Performing initial repository scan\n[HRKVO] 12:04:02 INFO: Starting local discovery announcements\n[HRKVO] 12:04:02 INFO: Local discovery over IPv6 unavailable\n[HRKVO] 12:04:02 INFO: Starting global discovery announcements\n[HRKVO] 12:04:02 OK: Ready to synchronize syncer (read-write)\n...\n[HRKVO] 12:04:02 INFO: syncthing v0.9.14 (go1.3.1 linux-amd64 default) jenkins@build.syncthing.net 2014-09-10 12:21:44 UTC\n[HRKVO] 12:04:02 INFO: My ID: HRKVOTT-F66HFOV-CV2A5QQ-LTNPBRG-4KESZVJ-WOOSANE-A4L4A45-5FLODBG\n[HRKVO] 12:04:02 INFO: Starting web GUI on http://127.0.0.1:8080/\n[HRKVO] 12:04:02 INFO: Performing initial repository scan\n[HRKVO] 12:04:02 INFO: Starting local discovery announcements\n[HRKVO] 12:04:02 INFO: Local discovery over IPv6 unavailable\n[HRKVO] 12:04:02 INFO: Starting global discovery announcements\n[HRKVO] 12:04:02 OK: Ready to synchronize syncer (read-write)\npanic: runtime error: invalid memory address or nil pointer dereference\n[signal 0xb code=0x1 addr=0x30 pc=0x6ccac5]\n\ngoroutine 16 [running]:\nruntime.panic(0x8ffb80, 0xcf3dd3)\n    /usr/local/go/src/pkg/runtime/panic.c:279 +0xf5\ngithub.com/syncthing/syncthing/versioner.func·001(0xc2080b4480, 0x1f, 0x0, 0x0, 0x7f496510f2f8, 0xc2080959b0, 0x0, 0x0)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/versioner/staggered.go:62 +0x55\npath/filepath.Walk(0xc2080b4480, 0x1f, 0xa87df8, 0x0, 0x0)\n    /usr/local/go/src/pkg/path/filepath/path.go:388 +0xa9\ngithub.com/syncthing/syncthing/versioner.Staggered.renameOld(0xc2080b4480, 0x1f, 0xe10, 0xc20803c740, 0x13, 0x1e, 0xe10, 0xe10, 0x15180, 0x15180, ...)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/versioner/staggered.go:75 +0x4b\ngithub.com/syncthing/syncthing/versioner.NewStaggered(0xc2080016e8, 0x6, 0xc20803c740, 0x13, 0xc208023f80, 0x0, 0x0)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/versioner/staggered.go:126 +0x587\ngithub.com/syncthing/syncthing/model.newPuller(0xc2080016e8, 0x6, 0xc20803c740, 0x13, 0xc2080206c0, 0x5, 0x8, 0x0, 0xb4, 0x0, ...)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/model/puller.go:117 +0x2af\ngithub.com/syncthing/syncthing/model.(*Model).StartRepoRW(0xc208070000, 0xc2080016e8, 0x6, 0x10)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/model/model.go:149 +0x18f\nmain.syncthingMain()\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/cmd/syncthing/main.go:567 +0x2d4f\nmain.main()\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/cmd/syncthing/main.go:258 +0xda9\n\ngoroutine 19 [finalizer wait]:\nruntime.park(0x431590, 0xcfaf00, 0xcf8969)\n    /usr/local/go/src/pkg/runtime/proc.c:1369 +0x89\nruntime.parkunlock(0xcfaf00, 0xcf8969)\n    /usr/local/go/src/pkg/runtime/proc.c:1385 +0x3b\nrunfinq()\n    /usr/local/go/src/pkg/runtime/mgc0.c:2644 +0xcf\nruntime.goexit()\n    /usr/local/go/src/pkg/runtime/proc.c:1445\n\ngoroutine 20 [syscall]:\nos/signal.loop()\n    /usr/local/go/src/pkg/os/signal/signal_unix.go:21 +0x1e\ncreated by os/signal.init·1\n    /usr/local/go/src/pkg/os/signal/signal_unix.go:27 +0x32\n\ngoroutine 22 [select]:\ngithub.com/syncthing/syncthing/events.(*Subscription).Poll(0xc20803c600, 0xdf8475800, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, 0x0, ...)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/events/events.go:165 +0x35c\ngithub.com/syncthing/syncthing/events.(*BufferedSubscription).pollingLoop(0xc208044180)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/events/events.go:197 +0x44\ncreated by github.com/syncthing/syncthing/events.NewBufferedSubscription\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/events/events.go:191 +0x111\n\ngoroutine 23 [chan receive]:\nmain.trackCPUUsage()\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/cmd/syncthing/gui_unix.go:22 +0xe8\ncreated by main.init·2\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/cmd/syncthing/gui_unix.go:15 +0x22\n\ngoroutine 24 [select]:\ngithub.com/syndtr/goleveldb/leveldb/util.(*BufferPool).drain(0xc20807e1c0)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/util/buffer_pool.go:173 +0x1b4\ncreated by github.com/syndtr/goleveldb/leveldb/util.NewBufferPool\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/util/buffer_pool.go:203 +0x202\n\ngoroutine 25 [select]:\ngithub.com/syndtr/goleveldb/leveldb.(*DB).compactionError(0xc208020d80)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/db_compaction.go:113 +0x1fa\ncreated by github.com/syndtr/goleveldb/leveldb.openDB\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/db.go:123 +0x4d6\n\ngoroutine 26 [select]:\ngithub.com/syndtr/goleveldb/leveldb.(*DB).tCompaction(0xc208020d80)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/db_compaction.go:667 +0x777\ncreated by github.com/syndtr/goleveldb/leveldb.openDB\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/db.go:126 +0x518\n\ngoroutine 27 [select]:\ngithub.com/syndtr/goleveldb/leveldb.(*DB).mCompaction(0xc208020d80)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/db_compaction.go:616 +0x1b9\ncreated by github.com/syndtr/goleveldb/leveldb.openDB\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/db.go:127 +0x530\n\ngoroutine 28 [select]:\ngithub.com/syndtr/goleveldb/leveldb.(*DB).jWriter(0xc208020d80)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/db_write.go:37 +0x143\ncreated by github.com/syndtr/goleveldb/leveldb.openDB\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/db.go:128 +0x548\n\ngoroutine 29 [select]:\ngithub.com/syndtr/goleveldb/leveldb.(*DB).mpoolDrain(0xc208020d80)\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/db_state.go:73 +0xfb\ncreated by github.com/syndtr/goleveldb/leveldb.openDB\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/Godeps/_workspace/src/github.com/syndtr/goleveldb/leveldb/db.go:129 +0x560\n\ngoroutine 30 [sleep]:\ntime.Sleep(0x45d964b800)\n    /usr/local/go/src/pkg/runtime/time.goc:39 +0x31\ngithub.com/syncthing/syncthing/model.func·017()\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/model/util.go:15 +0x49\ncreated by github.com/syncthing/syncthing/model.deadlockDetect\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/model/util.go:33 +0x8f\n\ngoroutine 31 [sleep]:\ntime.Sleep(0x45d964b800)\n    /usr/local/go/src/pkg/runtime/time.goc:39 +0x31\ngithub.com/syncthing/syncthing/model.func·017()\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/model/util.go:15 +0x49\ncreated by github.com/syncthing/syncthing/model.deadlockDetect\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/model/util.go:33 +0x8f\n\ngoroutine 48 [sleep]:\ntime.Sleep(0x45d964b800)\n    /usr/local/go/src/pkg/runtime/time.goc:39 +0x31\ngithub.com/syncthing/syncthing/model.func·017()\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/model/util.go:15 +0x49\ncreated by github.com/syncthing/syncthing/model.deadlockDetect\n    /home/jenkins/.jenkins/jobs/syncthing/workspace/src/github.com/syncthing/syncthing/model/util.go:33 +0x8f\n\ngoroutine 49 [IO wait]:\nnet.runtime_pollWait(0x7f4965109e00, 0x72, 0x0)\n    /usr/local/go/src/pkg/runtime/netpoll.goc:146 +0x66\nnet.(*pollDesc).Wait(0xc20810c140, 0x72, 0x0, 0x0)\n    /usr/local/go/src/pkg/net/fd_poll_runtime.go:84 +0x46\nnet.(*pollDesc).WaitRead(0xc20810c140, 0x0, 0x0)\n    /usr/local/go/src/pkg/net/fd_poll_runtime.go:89 +0x42\nnet.(*netFD).accept(0xc20810c0e0, 0xa885c8, 0x0, 0x7f49651023c8, 0xb)\n    /usr/local/go/src/pkg/net/fd_unix.go:419 +0x343\nnet.(*TCPListener).AcceptTCP(0xc208040098, 0xc208044268, 0x0, 0x0)\n    /usr/local/go/src/pkg/net/tcpsock_posix.go:234 +0x5d\nnet.(*TCPListener).Accept(0xc208040098, 0x0, 0x0, 0x0, 0x0)\n    /usr/local/go/src/pkg/net/tcpsock_posix.go:244 +0x4b\nnet/http.(*Server).Serve(0xc2081e6000, 0x7f4965108e30, 0xc208040098, 0x0, 0x0)\n```\n","closed_by":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/663/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/663/timeline","performed_via_github_app":null,"state_reason":"completed"}