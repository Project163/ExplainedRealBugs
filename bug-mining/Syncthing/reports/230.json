{"url":"https://api.github.com/repos/syncthing/syncthing/issues/1487","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/1487/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/1487/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/1487/events","html_url":"https://github.com/syncthing/syncthing/issues/1487","id":62802770,"node_id":"MDU6SXNzdWU2MjgwMjc3MA==","number":1487,"title":"REST API collection inconsistencies","user":{"login":"adrianrudnik","id":681514,"node_id":"MDQ6VXNlcjY4MTUxNA==","avatar_url":"https://avatars.githubusercontent.com/u/681514?v=4","gravatar_id":"","url":"https://api.github.com/users/adrianrudnik","html_url":"https://github.com/adrianrudnik","followers_url":"https://api.github.com/users/adrianrudnik/followers","following_url":"https://api.github.com/users/adrianrudnik/following{/other_user}","gists_url":"https://api.github.com/users/adrianrudnik/gists{/gist_id}","starred_url":"https://api.github.com/users/adrianrudnik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/adrianrudnik/subscriptions","organizations_url":"https://api.github.com/users/adrianrudnik/orgs","repos_url":"https://api.github.com/users/adrianrudnik/repos","events_url":"https://api.github.com/users/adrianrudnik/events{/privacy}","received_events_url":"https://api.github.com/users/adrianrudnik/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767667,"node_id":"MDU6TGFiZWw2Nzc2NzY2Nw==","url":"https://api.github.com/repos/syncthing/syncthing/labels/enhancement","name":"enhancement","color":"0e8a16","default":true,"description":"New features or improvements of some kind, as opposed to a problem (bug)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":8,"created_at":"2015-03-18T21:14:38Z","updated_at":"2017-06-16T21:08:48Z","closed_at":"2015-04-07T12:29:41Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"As I'm currently implementing a native client against the REST API, I found a conflict in the current formatting of lists/arrays/collections in various calls.\n\nLets take /rest/connections\n\n```\n{  \n   \"SJ3BZVN\":{  \n      \"At\":\"2015-03-18T21:56:46.6428785+01:00\",\n      \"InBytesTotal\":4758908,\n      \"OutBytesTotal\":4758728,\n      \"Address\":\"192.168.79.45:54689\",\n      \"ClientVersion\":\"v0.10.27\"\n   },\n   \"total\":{  \n      \"At\":\"2015-03-18T21:56:46.6428785+01:00\",\n      \"InBytesTotal\":14348332,\n      \"OutBytesTotal\":14278380,\n      \"Address\":\"\",\n      \"ClientVersion\":\"\"\n   }\n}\n```\n\nThere is a conflict that complicates the processing of the records. SJ3BZVN should be in an array of connections, where total is at the right place. Right now I can map the total result because I know its name. To get actual connections I need to iterate trough the whole thing and exclude total from it (which is not a connection, but a summary). Also I can no longer use automatic mapping as the key is unknown at runtime and no other call offers a correct list of IDs, so I need to write a custom JSON deserializer for this call.\n\nI would propose to change it to the same clean structure as /rest/ignores, /rest/need, /rest/errors and others:\n\n```\n{  \n   \"connections\":[  \n      {  \n         \"ID\":\"SJ3BZVN\",\n         \"At\":\"2015-03-18T21:56:46.6428785+01:00\",\n         \"InBytesTotal\":4758908,\n         \"OutBytesTotal\":4758728,\n         \"Address\":\"192.168.79.45:54689\",\n         \"ClientVersion\":\"v0.10.27\"\n      }\n   ],\n   \"total\":{  \n      \"At\":\"2015-03-18T21:56:46.6428785+01:00\",\n      \"InBytesTotal\":14348332,\n      \"OutBytesTotal\":14278380,\n      \"Address\":\"\",\n      \"ClientVersion\":\"\"\n   }\n}\n```\n\nSame also applies, sooner or later, to\n\n```\n/rest/system > extAnnounceOK\n/rest/discovery\n/rest/tree\n```\n\nas well as possible POST calls (havent looked at them yet).\n\nAny other ideas?\n","closed_by":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/1487/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/1487/timeline","performed_via_github_app":null,"state_reason":"completed"}