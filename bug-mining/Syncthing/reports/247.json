{"url":"https://api.github.com/repos/syncthing/syncthing/issues/1696","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/1696/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/1696/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/1696/events","html_url":"https://github.com/syncthing/syncthing/issues/1696","id":70910874,"node_id":"MDU6SXNzdWU3MDkxMDg3NA==","number":1696,"title":"upnp port mapping failed 0.11.0","user":{"login":"jarlebring","id":11163595,"node_id":"MDQ6VXNlcjExMTYzNTk1","avatar_url":"https://avatars.githubusercontent.com/u/11163595?v=4","gravatar_id":"","url":"https://api.github.com/users/jarlebring","html_url":"https://github.com/jarlebring","followers_url":"https://api.github.com/users/jarlebring/followers","following_url":"https://api.github.com/users/jarlebring/following{/other_user}","gists_url":"https://api.github.com/users/jarlebring/gists{/gist_id}","starred_url":"https://api.github.com/users/jarlebring/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jarlebring/subscriptions","organizations_url":"https://api.github.com/users/jarlebring/orgs","repos_url":"https://api.github.com/users/jarlebring/repos","events_url":"https://api.github.com/users/jarlebring/events{/privacy}","received_events_url":"https://api.github.com/users/jarlebring/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2015-04-25T13:33:09Z","updated_at":"2017-06-16T21:07:49Z","closed_at":"2015-04-26T11:10:15Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hello,\n\nI am running syncthing 0.11.0 on \"Debian 3.2.63-2+deb7u1 armv5tel\" and get \"Failed to create UPnP port mapping\" in the web interface. My router is identical to the router in #1187 and the SOAP response is the same (501 not implemented) as that issue, but my SOAP Request URL appears valid. Running STTRACE=upnp ./syncthing 2>&1 | tee ~/upnplog.txt gives me the following log. I have increased the time-out with the upnpTimeoutSeconds in .config/syncthing/config.xml.  Any further suggestion on how to troubleshoot it? \n\nThanks!\n\nupnplog.txt: \n\n```\n[monitor] 2015/04/25 14:59:40.758906 monitor.go:94: INFO: Starting syncthing\n[LZZ6Y] 2015/04/25 14:59:52.133109 main.go:399: INFO: syncthing v0.11.0 (go1.4.2 linux-arm default) unknown-user@syncthing-builder 2015-04-22 00:37:18 UTC\n[LZZ6Y] 2015/04/25 14:59:52.136784 main.go:400: INFO: My ID: *************\n[LZZ6Y] 2015/04/25 14:59:52.198793 main.go:673: INFO: Starting web GUI on http://127.0.0.1:8384/\n[LZZ6Y] 2015/04/25 15:00:02.625250 upnp.go:97: INFO: Starting UPnP discovery...\n[LZZ6Y] 2015/04/25 15:00:02.632074 upnp.go:173: DEBUG: Starting discovery of device type urn:schemas-upnp-org:device:InternetGatewayDevice:1 on lo\n[LZZ6Y] 2015/04/25 15:00:02.636094 upnp.go:173: DEBUG: Starting discovery of device type urn:schemas-upnp-org:device:InternetGatewayDevice:2 on lo\n[LZZ6Y] 2015/04/25 15:00:02.638029 upnp.go:173: DEBUG: Starting discovery of device type urn:schemas-upnp-org:device:InternetGatewayDevice:1 on eth0\n[LZZ6Y] 2015/04/25 15:00:02.641520 upnp.go:192: DEBUG: Sending search request for device type urn:schemas-upnp-org:device:InternetGatewayDevice:1 on eth0\n[LZZ6Y] 2015/04/25 15:00:02.643145 upnp.go:198: DEBUG: Listening for UPnP response for device type urn:schemas-upnp-org:device:InternetGatewayDevice:1 on eth0\n[LZZ6Y] 2015/04/25 15:00:02.644560 upnp.go:173: DEBUG: Starting discovery of device type urn:schemas-upnp-org:device:InternetGatewayDevice:2 on eth1\n[LZZ6Y] 2015/04/25 15:00:02.646669 upnp.go:192: DEBUG: Sending search request for device type urn:schemas-upnp-org:device:InternetGatewayDevice:2 on eth1\n[LZZ6Y] 2015/04/25 15:00:02.648284 upnp.go:197: INFO: write udp4: network is unreachable\n[LZZ6Y] 2015/04/25 15:00:02.649571 upnp.go:173: DEBUG: Starting discovery of device type urn:schemas-upnp-org:device:InternetGatewayDevice:2 on eth0\n[LZZ6Y] 2015/04/25 15:00:02.651601 upnp.go:192: DEBUG: Sending search request for device type urn:schemas-upnp-org:device:InternetGatewayDevice:2 on eth0\n[LZZ6Y] 2015/04/25 15:00:02.653047 upnp.go:198: DEBUG: Listening for UPnP response for device type urn:schemas-upnp-org:device:InternetGatewayDevice:2 on eth0\n[LZZ6Y] 2015/04/25 15:00:02.654386 upnp.go:192: DEBUG: Sending search request for device type urn:schemas-upnp-org:device:InternetGatewayDevice:1 on lo\n[LZZ6Y] 2015/04/25 15:00:02.655763 upnp.go:198: DEBUG: Listening for UPnP response for device type urn:schemas-upnp-org:device:InternetGatewayDevice:1 on lo\n[LZZ6Y] 2015/04/25 15:00:02.656994 upnp.go:192: DEBUG: Sending search request for device type urn:schemas-upnp-org:device:InternetGatewayDevice:2 on lo\n[LZZ6Y] 2015/04/25 15:00:02.658452 upnp.go:173: DEBUG: Starting discovery of device type urn:schemas-upnp-org:device:InternetGatewayDevice:1 on eth1\n[LZZ6Y] 2015/04/25 15:00:02.658985 upnp.go:192: DEBUG: Sending search request for device type urn:schemas-upnp-org:device:InternetGatewayDevice:1 on eth1\n[LZZ6Y] 2015/04/25 15:00:02.659133 upnp.go:197: INFO: write udp4: network is unreachable\n[LZZ6Y] 2015/04/25 15:00:02.660418 upnp.go:198: DEBUG: Listening for UPnP response for device type urn:schemas-upnp-org:device:InternetGatewayDevice:2 on lo\n[LZZ6Y] 2015/04/25 15:00:03.040224 upnp.go:229: DEBUG: Handling UPnP response:\n\nHTTP/1.1 200 OK\nST:urn:schemas-upnp-org:device:InternetGatewayDevice:1\nUSN:uuid:00000000-0000-0001-0000-687f7481bd8f::urn:schemas-upnp-org:device:InternetGatewayDevice:1\nLocation:http://192.168.1.1:80/igd.xml\nServer: WRT120N/1.0 UPnP/1.0 UPnP-Device-Host/1.0\nEXT:\nCache-Control:max-age=60\nDate: Sat, 25 Apr 2015 13:03:06 GMT\n\n\n[LZZ6Y] 2015/04/25 15:00:03.058012 upnp.go:401: DEBUG: [http://192.168.1.1:80/igd.xml] Found urn:schemas-upnp-org:service:WANIPConnection:1 with URL http://192.168.1.1:80/upnp/control?WANIPConnection\n[LZZ6Y] 2015/04/25 15:00:03.059240 upnp.go:401: DEBUG: [http://192.168.1.1:80/igd.xml] Found urn:schemas-upnp-org:service:WANPPPConnection:1 with URL http://192.168.1.1:80/upnp/control?WANPPPConnection\n[LZZ6Y] 2015/04/25 15:00:03.160065 upnp.go:124: DEBUG: UPnP discovery result 00000000-0000-0001-0000-687f7481bd8f with services:\n[LZZ6Y] 2015/04/25 15:00:03.161615 upnp.go:126: DEBUG: * [urn:upnp-org:serviceId:WANIPConn1] http://192.168.1.1:80/upnp/control?WANIPConnection\n[LZZ6Y] 2015/04/25 15:00:03.163115 upnp.go:126: DEBUG: * [urn:upnp-org:serviceId:WANPPPConn1] http://192.168.1.1:80/upnp/control?WANPPPConnection\n[LZZ6Y] 2015/04/25 15:00:22.640762 upnp.go:198: DEBUG: Discovery for device type urn:schemas-upnp-org:device:InternetGatewayDevice:2 on lo finished.\n[LZZ6Y] 2015/04/25 15:00:22.640980 upnp.go:198: DEBUG: Discovery for device type urn:schemas-upnp-org:device:InternetGatewayDevice:1 on lo finished.\n[LZZ6Y] 2015/04/25 15:00:22.642752 upnp.go:198: DEBUG: Discovery for device type urn:schemas-upnp-org:device:InternetGatewayDevice:1 on eth0 finished.\n[LZZ6Y] 2015/04/25 15:00:22.651846 upnp.go:198: DEBUG: Discovery for device type urn:schemas-upnp-org:device:InternetGatewayDevice:2 on eth0 finished.\n[LZZ6Y] 2015/04/25 15:00:22.652054 upnp.go:151: INFO: UPnP discovery complete (found 1 device).\n[LZZ6Y] 2015/04/25 15:00:22.652466 upnp.go:462: DEBUG: SOAP Request URL: http://192.168.1.1:80/upnp/control?WANIPConnection\n[LZZ6Y] 2015/04/25 15:00:22.652567 upnp.go:463: DEBUG: SOAP Action: \"urn:schemas-upnp-org:service:WANIPConnection:1#AddPortMapping\"\n[LZZ6Y] 2015/04/25 15:00:22.652657 upnp.go:464: DEBUG: SOAP Request:\n\n<?xml version=\"1.0\" ?>\n    <s:Envelope xmlns:s=\"http://schemas.xmlsoap.org/soap/envelope/\" s:encodingStyle=\"http://schemas.xmlsoap.org/soap/encoding/\">\n    <s:Body><u:AddPortMapping xmlns:u=\"urn:schemas-upnp-org:service:WANIPConnection:1\">\n    <NewRemoteHost></NewRemoteHost>\n    <NewExternalPort>51063</NewExternalPort>\n    <NewProtocol>TCP</NewProtocol>\n    <NewInternalPort>22000</NewInternalPort>\n    <NewInternalClient>192.168.1.105</NewInternalClient>\n    <NewEnabled>1</NewEnabled>\n    <NewPortMappingDescription>syncthing-51063</NewPortMappingDescription>\n    <NewLeaseDuration>0</NewLeaseDuration>\n    </u:AddPortMapping></s:Body>\n    </s:Envelope>\n\n[LZZ6Y] 2015/04/25 15:00:22.885172 upnp.go:469: DEBUG: SOAP Response:\n\n<HEAD><TITLE>501 Not Implemented</TITLE></HEAD>\n<BODY><H1>501 Not Implemented</H1>\nWe are sorry to be unable to perform the method POST to non-script at this time.<P>\nIf you would like to see this capability in future\nreleases, send the method which failed, why you\nwould like to have it, and the server version Apache\nto <ADDRESS>http://www.apache.org/</ADDRESS><P>\n</BODY>\n\n\n[LZZ6Y] 2015/04/25 15:00:22.885599 upnp.go:462: DEBUG: SOAP Request URL: http://192.168.1.1:80/upnp/control?WANIPConnection\n[LZZ6Y] 2015/04/25 15:00:22.885701 upnp.go:463: DEBUG: SOAP Action: \"urn:schemas-upnp-org:service:WANIPConnection:1#AddPortMapping\"\n```\n\nwget http://192.168.1.1/igd.xml\n\n```\n<?xml version=\"1.0\"?>\n<root xmlns=\"urn:schemas-upnp-org:device-1-0\">\n\n<specVersion>\n    <major>1</major>\n    <minor>0</minor>\n</specVersion>\n<URLBase>http://192.168.1.1</URLBase>\n\n<device>\n    <deviceType>urn:schemas-upnp-org:device:InternetGatewayDevice:1</deviceType>\n    <friendlyName>Linksys WRT120N</friendlyName>\n    <manufacturer>Linksys Inc.</manufacturer>\n    <manufacturerURL>http://www.linksysbycisco.com/</manufacturerURL>\n    <modelDescription>Internet Access Server</modelDescription>\n    <modelName>WRT120N</modelName>\n    <modelNumber>v1.0.01</modelNumber>\n    <modelURL>http://www.linksysbycisco.com/international/</modelURL>\n    <serialNumber>JUT00K503200</serialNumber>\n    <UDN>uuid:00000000-0000-0001-0000-687f7481bd8f</UDN>\n    <UPC>494125014380</UPC>\n\n    <serviceList>\n    <service>\n\n\n\n\n\n\n\n\n        <serviceType>urn:schemas-upnp-org:service:Layer3Forwarding:1</serviceType>\n        <serviceId>urn:upnp-org:serviceId:L3Forwarding1</serviceId>\n        <SCPDURL>/igd_l3f.xml</SCPDURL>\n        <controlURL>http://192.168.1.1:80/upnp/control?Layer3Forwarding</controlURL>\n        <eventSubURL>http://192.168.1.1:80/upnp/event?Layer3Forwarding</eventSubURL>\n    </service>\n    </serviceList>\n\n    <deviceList>\n    <device>\n        <deviceType>urn:schemas-upnp-org:device:WANDevice:1</deviceType>\n        <friendlyName>Linksys WRT120N (WAN)</friendlyName>\n        <manufacturer>Linksys Inc.</manufacturer>\n        <manufacturerURL>http://www.linksysbycisco.com/</manufacturerURL>\n        <modelDescription>Internet Access Server (WAN Interface Device)</modelDescription>\n        <modelName>WRT120N WAN Interface</modelName>\n        <modelNumber>v1.0.01</modelNumber>\n        <modelURL>http://www.linksysbycisco.com/international/</modelURL>\n        <serialNumber>JUT00K503200</serialNumber>\n        <UDN>uuid:00000000-0000-0001-0001-687f7481bd8f</UDN>\n        <UPC>494125014380</UPC>\n        <serviceList>\n        <service>\n            <serviceType>urn:schemas-upnp-org:service:WANCommonInterfaceConfig:1</serviceType>\n            <serviceId>urn:upnp-org:serviceId:WANCommonIFC1</serviceId>\n            <SCPDURL>/igd_wcic.xml</SCPDURL>\n            <controlURL>http://192.168.1.1:80/upnp/control?WANCommonInterfaceConfig</controlURL>\n            <eventSubURL>http://192.168.1.1:80/upnp/event?WANCommonInterfaceConfig</eventSubURL>\n        </service>\n        </serviceList>\n\n        <deviceList>\n        <device>\n            <deviceType>urn:schemas-upnp-org:device:WANConnectionDevice:1</deviceType>\n            <friendlyName>Linksys WRT120N (WAN Con)</friendlyName>\n            <manufacturer>Linksys Inc.</manufacturer>\n            <manufacturerURL>http://www.linksysbycisco.com/</manufacturerURL>\n            <modelDescription>Internet Access Server (WAN Connection Device)</modelDescription>\n            <modelName>WRT120N WAN Connector</modelName>\n            <modelNumber>v1.0.01</modelNumber>\n            <modelURL>http://www.linksysbycisco.com/international/</modelURL>\n            <serialNumber>JUT00K503200</serialNumber>\n            <UDN>uuid:00000000-0000-0001-0002-687f7481bd8f</UDN>\n            <UPC>494125014380</UPC>\n\n            <serviceList>\n            <service>\n                <serviceType>urn:schemas-upnp-org:service:WANEthernetLinkConfig:1</serviceType>\n                <serviceId>urn:upnp-org:serviceId:WANEthLinkC1</serviceId>\n                <SCPDURL>/igd_wec.xml</SCPDURL>\n                <controlURL>http://192.168.1.1:80/upnp/control?WANEthernetLinkConfig</controlURL>\n                <eventSubURL>http://192.168.1.1:80/upnp/event?WANEthernetLinkConfig</eventSubURL>\n            </service>\n\n            <service>\n                <serviceType>urn:schemas-upnp-org:service:WANPPPConnection:1</serviceType>\n                <serviceId>urn:upnp-org:serviceId:WANPPPConn1</serviceId>\n                <SCPDURL>/igd_wpc.xml</SCPDURL>\n                <controlURL>http://192.168.1.1:80/upnp/control?WANPPPConnection</controlURL>\n                <eventSubURL>http://192.168.1.1:80/upnp/event?WANPPPConnection</eventSubURL>\n            </service>\n\n            <service>\n                <serviceType>urn:schemas-upnp-org:service:WANIPConnection:1</serviceType>\n                <serviceId>urn:upnp-org:serviceId:WANIPConn1</serviceId>\n                <SCPDURL>/igd_wic.xml</SCPDURL>\n                <controlURL>http://192.168.1.1:80/upnp/control?WANIPConnection</controlURL>\n                <eventSubURL>http://192.168.1.1:80/upnp/event?WANIPConnection</eventSubURL>\n            </service>\n            </serviceList>\n\n        </device>\n        </deviceList>\n\n    </device>\n\n        <device>\n               <deviceType>urn:schemas-wifialliance-org:device:WFADevice:1</deviceType>\n              <friendlyName>Linksys WRT120N (WFA)</friendlyName>\n                <manufacturer>Linksys Inc.</manufacturer>\n                <manufacturerURL>http://www.linksysbycisco.com/</manufacturerURL>\n                <modelDescription>Internet Access Server</modelDescription>\n                <modelName>WRT120N</modelName>\n                <modelNumber>v1.0.01</modelNumber>\n                <modelURL>http://www.linksysbycisco.com/international/</modelURL>\n                <serialNumber>JUT00K503200</serialNumber>\n                <UDN>uuid:00000000-0000-0001-1000-687f7481bd8f</UDN>\n                    <UPC>494125014380</UPC>\n              <serviceList>\n                <service>\n                  <serviceType>urn:schemas-wifialliance-org:service:WFAWLANConfig:1</serviceType>\n                  <serviceId>urn:wifialliance-org:serviceId:WFAWLANConfig1</serviceId>\n                  <SCPDURL>/igd_WSC_UPnP.xml</SCPDURL>\n                        <controlURL>/upnp/control?WFAWLANConfig</controlURL>\n                        <eventSubURL>/upnp/event?WFAWLANConfig</eventSubURL>\n                </service>\n              </serviceList>\n        </device>\n    </deviceList>\n\n    <presentationURL>/</presentationURL>\n</device>\n</root>\n\n<!--\n    File        : igd.xml\n    Descripte   : internet gateway device description page\n    Copyright   :\n    Authors     : Pert\n    Date        : 03/12/2002\n    Last Date   : 03/??/2002\n    Version     : v1.0\n-->\n```\n","closed_by":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/1696/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/1696/timeline","performed_via_github_app":null,"state_reason":"completed"}