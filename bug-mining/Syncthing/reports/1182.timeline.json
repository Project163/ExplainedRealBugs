[{"id":4111430989,"node_id":"MDEyOkxhYmVsZWRFdmVudDQxMTE0MzA5ODk=","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4111430989","actor":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-12-14T21:32:01Z","label":{"name":"enhancement","color":"0e8a16"},"performed_via_github_app":null},{"id":4111430990,"node_id":"MDEyOkxhYmVsZWRFdmVudDQxMTE0MzA5OTA=","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4111430990","actor":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-12-14T21:32:01Z","label":{"name":"needs-triage","color":"ce23af"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744727146","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-744727146","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":744727146,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NDcyNzE0Ng==","user":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-14T21:38:58Z","updated_at":"2020-12-14T21:39:04Z","body":"Have you checked --help?\r\n\r\n--ext-address is there for this specific reason.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744727146/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4111462334,"node_id":"MDExOkNsb3NlZEV2ZW50NDExMTQ2MjMzNA==","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4111462334","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-12-14T21:38:58Z","state_reason":null,"performed_via_github_app":null},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744729765","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-744729765","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":744729765,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NDcyOTc2NQ==","user":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-14T21:44:32Z","updated_at":"2020-12-14T21:48:39Z","body":"Hi @AudriusButkevicius ,\r\n\r\nThanks for the quick response. I think I was too scarce on the post above, as I forgot to post the config I'm using (which includes `--ext-address`):\r\n```yaml\r\n          args:\r\n            - -global-rate\r\n            - \"2099200\"\r\n            - -provided-by\r\n            - \"Roberto Santalla (@rsroobre)\"\r\n            - -ext-address\r\n            - st-relay.roobre.es:22067\r\n            - -debug\r\n```\r\n\r\n`st-relay.roobre.es` resolves to `212.129.50.60`, which can be seen in the log I posted above. This is also the address where the input port is mapped and therefore where I expect clients to connect to. I double-checked that the port is correctly mapped and accessible from the outside by running `nc -vv st-relay.roobre.es 22067` from my llocal machine.\r\n\r\nHowever, the machine hosting the relay server is performing requests to the internet from a different IP address, which I think might be confusing the relay pool. Could this be the case?\r\n\r\nThanks!","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744729765/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4111482166,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDExMTQ4MjE2Ng==","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4111482166","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-12-14T21:44:33Z","performed_via_github_app":null},{"id":4111482173,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQxMTE0ODIxNzM=","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4111482173","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-12-14T21:44:33Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744743378","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-744743378","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":744743378,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NDc0MzM3OA==","user":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-14T22:13:15Z","updated_at":"2020-12-14T22:13:15Z","body":"I made a quick search and it would seem that the error I'm seeing is reported here:\r\n\r\nhttps://github.com/syncthing/syncthing/blob/466e8a5cd0fce655fc98f327f0b12e939446ea0e/cmd/strelaysrv/pool.go#L81\r\n\r\nWhich is, in turn, returned by the pool server here:\r\n\r\nhttps://github.com/syncthing/syncthing/blob/466e8a5cd0fce655fc98f327f0b12e939446ea0e/cmd/strelaypoolsrv/main.go#L386\r\n\r\nIt would seem that this is indeed a check in the relay pool server, which rejects clients when the advertised address is different from the one making the request. I still want to make a point saying that this might not be an uncommon scenario for dedicated servers. Would you be open to reconsider this? Perhaps if I understood the motivation behind this check (security maybe?) we could discuss an alternative approach.\r\n\r\nThanks again for your time.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744743378/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744749641","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-744749641","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":744749641,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NDc0OTY0MQ==","user":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-14T22:26:13Z","updated_at":"2020-12-14T22:26:13Z","body":"Why is it dialing out a different gateway than it expects to get connections back?","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744749641/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744756139","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-744756139","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":744756139,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NDc1NjEzOQ==","user":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-14T22:38:53Z","updated_at":"2020-12-14T22:40:05Z","body":"> Why is it dialing out a different gateway than it expects to get connections back?\r\n\r\n@AudriusButkevicius This is not uncommon in multihomed environments, or in this case, in Kubernetes. It is designed that way so the machine can have its own IP address, while at the same time the services hosted in it are accessed through other addresses, for example behind load balancers. In this case there is not the case (the address in which the relay server listens will not change), but it is different from the one the host uses because of this. This also allows to decouple the service from the machine is being run on, which is useful for clusters.\r\n\r\nIt is not really my choice, it is \"just how Kubernetes works\", if you want to say it like that.\r\n\r\nI might, however, ask the opposite question: Why is the relay server assuming that a particular host can only have one address?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744756139/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4111667323,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50NDExMTY2NzMyMw==","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4111667323","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2020-12-14T22:38:53Z","performed_via_github_app":null},{"id":4111667328,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDQxMTE2NjczMjg=","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4111667328","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2020-12-14T22:38:53Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744765343","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-744765343","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":744765343,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NDc2NTM0Mw==","user":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-14T23:00:54Z","updated_at":"2020-12-14T23:00:54Z","body":"So I can't really see a good reason why the check is there.\r\nWe perform a connection test anyway.\r\n\r\nSorry for closing this early, but from your original report it looked to me like you are just looking for --ext-address.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/744765343/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":4111740244,"node_id":"MDEzOlJlb3BlbmVkRXZlbnQ0MTExNzQwMjQ0","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4111740244","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"reopened","commit_id":null,"commit_url":null,"created_at":"2020-12-14T23:00:54Z","state_reason":null,"performed_via_github_app":null},{"id":4111743374,"node_id":"MDE0OlVubGFiZWxlZEV2ZW50NDExMTc0MzM3NA==","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4111743374","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2020-12-14T23:01:58Z","label":{"name":"needs-triage","color":"ce23af"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745097755","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-745097755","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":745097755,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTA5Nzc1NQ==","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T07:02:51Z","updated_at":"2020-12-15T07:02:51Z","body":"I think the check is reasonable as-is, in that I think we want the relay pool to only accept voluntary submissions. That the announcement comes from the actual relay is one way to check that. Without the check I could announce someone else's supposedly secret relay to the relay pool without their consent.\r\n\r\nOf course there are other solutions to this, but they would require changing the relay protocol (or at least handshake) I think.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745097755/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745164527","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-745164527","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":745164527,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTE2NDUyNw==","user":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T09:26:41Z","updated_at":"2020-12-15T09:26:41Z","body":"Hi,\r\n\r\nThanks for the explanation, I think I understand the problematic now. It is true that removing the check could open the door for a malicious agent to spam submissions on behalf of other hosts.\r\n\r\nA possible solution that comes to my mind is adding some sort of \"negotiation phase\" to the relay, in a way similar to the following:\r\n\r\n1. The relay advertises its address to the pool server\r\n2. The pool server returns a random token to the relay\r\n3. The relay stores that token in memory and serves it somewhere, e.g. in `http://external-address:22070/token`\r\n4. Two or three seconds later, the pool server tries to fetch `http://external-address:22070/token` and compares the token with the one it dispensed.\r\n\r\nIn my mind (I haven't looked too much at the code) this could be implemented as a part of the discovery phase, rather than the relay protocol itself. In addition, this step could be triggered only if the advertised address and source address do not match (i.e. in [this](https://github.com/syncthing/syncthing/blob/466e8a5cd0fce655fc98f327f0b12e939446ea0e/cmd/strelaypoolsrv/main.go#L386) section of the code), making the change non-breaking.\r\n\r\nOf course this adds a bit of weight on the pool server, as it would need to keep track of these tokens at least for a short while.\r\n\r\nWhat do you think about this approach? If you think it is worth implementing, I could try and write a PoC and PR with it.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745164527/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745190671","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-745190671","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":745190671,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTE5MDY3MQ==","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T10:14:57Z","updated_at":"2020-12-15T10:14:57Z","body":"Yeah, that's something like what I was thinking of when I said another solution, though I was thinking the token would end up in the relay handshake. Your idea is better. Another option would be to do the registering with the relay certificate as client certificate. The relay pool server can then do the connect back to whatever address and accept it as long as the presented certificate is the same.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745190671/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745200134","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-745200134","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":745200134,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTIwMDEzNA==","user":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T10:31:45Z","updated_at":"2020-12-15T10:31:45Z","body":"> Another option would be to do the registering with the relay certificate as client certificate.\r\n\r\nBy this, do you mean reusing the certificate for the HTTP registration? I think that might be more complex, as it would require setting up https and would break existing configurations.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745200134/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745276853","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-745276853","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":745276853,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTI3Njg1Mw==","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T13:09:40Z","updated_at":"2020-12-15T13:09:40Z","body":"The request to register with the pool server is a HTTPS POST to https://relays.syncthing.net/endpoint. The relay has a TLS certificate that is uses for relay connections. The relay server could present that certificate as a client certificate in the HTTPS POST. Then, when the relay pool does the connection check it can compare the certificate presented by the relay with that used in the registration request. If it's the same certificate we know it's the same relay server.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745276853/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745286166","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-745286166","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":745286166,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTI4NjE2Ng==","user":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T13:27:23Z","updated_at":"2020-12-15T13:27:23Z","body":"Anyways, all of these are non-trivial in terms of effort to implement and to support migration/rollout for existing relays.\r\n\r\nDo we really think we'll do this?\r\n\r\nI doubt it, hence my heart is going back towards close as won't fix.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745286166/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745302771","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-745302771","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":745302771,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTMwMjc3MQ==","user":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T13:59:17Z","updated_at":"2020-12-15T13:59:17Z","body":"> The request to register with the pool server is a HTTPS POST to https://relays.syncthing.net/endpoint. The relay has a TLS certificate that is uses for relay connections. The relay server could present that certificate as a client certificate in the HTTPS POST. Then, when the relay pool does the connection check it can compare the certificate presented by the relay with that used in the registration request. If it's the same certificate we know it's the same relay server.\r\n\r\nOk, I understand now. Sending the certificate on announcement is an easy change, and if said cert is already sent by the relaysrv to the pool in the connection check, asserting that it is the same shouldn't be much of a change either.\r\n\r\n> Anyways, all of these are non-trivial in terms of effort to implement and to support migration/rollout for existing relays.\r\n\r\nI think that these mechanisms could be implemented only in the case the remote IP check fails. Rather than returning an error, the pool server could store a flag like \"verification pending\" and check the certificate in the connect phase only if this flag is set. That way the change would not be breaking, right?\r\n\r\n> Do we really think we'll do this?\r\n\r\nIn the end it's up to you to decide, but please keep in mind that you can count on me to lend a hand with a PR for the solution :)","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745302771/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745324606","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-745324606","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":745324606,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTMyNDYwNg==","user":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T14:28:28Z","updated_at":"2020-12-15T14:28:28Z","body":"Someone might, at some point.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745324606/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745326249","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-745326249","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":745326249,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTMyNjI0OQ==","user":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T14:29:28Z","updated_at":"2020-12-15T14:29:28Z","body":"Sure, if you want to file a PR fixing this, I won't stop you. \r\n\r\nGlobal discovery client/server already does this certificate validation to prevent this same spoofing, in case you are looking for inspiration.\r\n\r\nWe don't need any sort of verification pending state, if the cert is there, we ignore host mismatch and do cert based validation in the \"test that the relay actually works\" part. If the cert is not there, we stick to host checking.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745326249/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745340241","html_url":"https://github.com/syncthing/syncthing/issues/7196#issuecomment-745340241","issue_url":"https://api.github.com/repos/syncthing/syncthing/issues/7196","id":745340241,"node_id":"MDEyOklzc3VlQ29tbWVudDc0NTM0MDI0MQ==","user":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-15T14:47:11Z","updated_at":"2020-12-15T14:47:11Z","body":"Looks like we have an approach then!\r\n\r\nThanks for your feedback and ideas, I'll allocate some time to work on a PR implementing it :)","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/comments/745340241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-12-21T00:08:18Z","updated_at":"2020-12-21T00:08:18Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/7217","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/7217/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/7217/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/7217/events","html_url":"https://github.com/syncthing/syncthing/pull/7217","id":771749078,"node_id":"MDExOlB1bGxSZXF1ZXN0NTQzMTUzMjc4","number":7217,"title":"Allow validation of relay join requests by certificate","user":{"login":"nadiamoe","id":969721,"node_id":"MDQ6VXNlcjk2OTcyMQ==","avatar_url":"https://avatars.githubusercontent.com/u/969721?v=4","gravatar_id":"","url":"https://api.github.com/users/nadiamoe","html_url":"https://github.com/nadiamoe","followers_url":"https://api.github.com/users/nadiamoe/followers","following_url":"https://api.github.com/users/nadiamoe/following{/other_user}","gists_url":"https://api.github.com/users/nadiamoe/gists{/gist_id}","starred_url":"https://api.github.com/users/nadiamoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/nadiamoe/subscriptions","organizations_url":"https://api.github.com/users/nadiamoe/orgs","repos_url":"https://api.github.com/users/nadiamoe/repos","events_url":"https://api.github.com/users/nadiamoe/events{/privacy}","received_events_url":"https://api.github.com/users/nadiamoe/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/syncthing/syncthing/milestones/59","html_url":"https://github.com/syncthing/syncthing/milestone/59","labels_url":"https://api.github.com/repos/syncthing/syncthing/milestones/59/labels","id":6215237,"node_id":"MDk6TWlsZXN0b25lNjIxNTIzNw==","number":59,"title":"v1.13.0","description":"This release adds configuration options for min/max connections (see https://docs.syncthing.net/advanced/option-connection-limits.html) and moves the storage of pending devices/folders from the config to the database (see https://docs.syncthing.net/dev/rest.html#cluster-endpoints).","creator":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":45,"state":"closed","created_at":"2020-12-15T13:04:43Z","updated_at":"2021-02-02T16:05:22Z","due_on":"2021-02-02T08:00:00Z","closed_at":"2021-02-02T16:05:22Z"},"comments":9,"created_at":"2020-12-21T00:08:17Z","updated_at":"2021-12-22T07:02:42Z","closed_at":"2020-12-21T10:55:17Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":14712850,"node_id":"MDEwOlJlcG9zaXRvcnkxNDcxMjg1MA==","name":"syncthing","full_name":"syncthing/syncthing","private":false,"owner":{"login":"syncthing","id":7628018,"node_id":"MDEyOk9yZ2FuaXphdGlvbjc2MjgwMTg=","avatar_url":"https://avatars.githubusercontent.com/u/7628018?v=4","gravatar_id":"","url":"https://api.github.com/users/syncthing","html_url":"https://github.com/syncthing","followers_url":"https://api.github.com/users/syncthing/followers","following_url":"https://api.github.com/users/syncthing/following{/other_user}","gists_url":"https://api.github.com/users/syncthing/gists{/gist_id}","starred_url":"https://api.github.com/users/syncthing/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/syncthing/subscriptions","organizations_url":"https://api.github.com/users/syncthing/orgs","repos_url":"https://api.github.com/users/syncthing/repos","events_url":"https://api.github.com/users/syncthing/events{/privacy}","received_events_url":"https://api.github.com/users/syncthing/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/syncthing/syncthing","description":"Open Source Continuous File Synchronization","fork":false,"url":"https://api.github.com/repos/syncthing/syncthing","forks_url":"https://api.github.com/repos/syncthing/syncthing/forks","keys_url":"https://api.github.com/repos/syncthing/syncthing/keys{/key_id}","collaborators_url":"https://api.github.com/repos/syncthing/syncthing/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/syncthing/syncthing/teams","hooks_url":"https://api.github.com/repos/syncthing/syncthing/hooks","issue_events_url":"https://api.github.com/repos/syncthing/syncthing/issues/events{/number}","events_url":"https://api.github.com/repos/syncthing/syncthing/events","assignees_url":"https://api.github.com/repos/syncthing/syncthing/assignees{/user}","branches_url":"https://api.github.com/repos/syncthing/syncthing/branches{/branch}","tags_url":"https://api.github.com/repos/syncthing/syncthing/tags","blobs_url":"https://api.github.com/repos/syncthing/syncthing/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/syncthing/syncthing/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/syncthing/syncthing/git/refs{/sha}","trees_url":"https://api.github.com/repos/syncthing/syncthing/git/trees{/sha}","statuses_url":"https://api.github.com/repos/syncthing/syncthing/statuses/{sha}","languages_url":"https://api.github.com/repos/syncthing/syncthing/languages","stargazers_url":"https://api.github.com/repos/syncthing/syncthing/stargazers","contributors_url":"https://api.github.com/repos/syncthing/syncthing/contributors","subscribers_url":"https://api.github.com/repos/syncthing/syncthing/subscribers","subscription_url":"https://api.github.com/repos/syncthing/syncthing/subscription","commits_url":"https://api.github.com/repos/syncthing/syncthing/commits{/sha}","git_commits_url":"https://api.github.com/repos/syncthing/syncthing/git/commits{/sha}","comments_url":"https://api.github.com/repos/syncthing/syncthing/comments{/number}","issue_comment_url":"https://api.github.com/repos/syncthing/syncthing/issues/comments{/number}","contents_url":"https://api.github.com/repos/syncthing/syncthing/contents/{+path}","compare_url":"https://api.github.com/repos/syncthing/syncthing/compare/{base}...{head}","merges_url":"https://api.github.com/repos/syncthing/syncthing/merges","archive_url":"https://api.github.com/repos/syncthing/syncthing/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/syncthing/syncthing/downloads","issues_url":"https://api.github.com/repos/syncthing/syncthing/issues{/number}","pulls_url":"https://api.github.com/repos/syncthing/syncthing/pulls{/number}","milestones_url":"https://api.github.com/repos/syncthing/syncthing/milestones{/number}","notifications_url":"https://api.github.com/repos/syncthing/syncthing/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/syncthing/syncthing/labels{/name}","releases_url":"https://api.github.com/repos/syncthing/syncthing/releases{/id}","deployments_url":"https://api.github.com/repos/syncthing/syncthing/deployments","created_at":"2013-11-26T09:48:21Z","updated_at":"2025-11-09T22:07:32Z","pushed_at":"2025-11-04T08:20:50Z","git_url":"git://github.com/syncthing/syncthing.git","ssh_url":"git@github.com:syncthing/syncthing.git","clone_url":"https://github.com/syncthing/syncthing.git","svn_url":"https://github.com/syncthing/syncthing","homepage":"https://syncthing.net/","size":124346,"stargazers_count":77446,"watchers_count":77446,"language":"Go","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":4825,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":361,"license":{"key":"mpl-2.0","name":"Mozilla Public License 2.0","spdx_id":"MPL-2.0","url":"https://api.github.com/licenses/mpl-2.0","node_id":"MDc6TGljZW5zZTE0"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":true,"topics":["go","p2p","peer-to-peer","synchronization"],"visibility":"public","forks":4825,"open_issues":361,"watchers":77446,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/syncthing/syncthing/pulls/7217","html_url":"https://github.com/syncthing/syncthing/pull/7217","diff_url":"https://github.com/syncthing/syncthing/pull/7217.diff","patch_url":"https://github.com/syncthing/syncthing/pull/7217.patch","merged_at":"2020-12-21T10:55:17Z"},"body":"### Purpose\r\n\r\nAs discussed in #7196, there might be some scenarios where a relay server might want to advertise itself from a different IP address from which it is actually listening on. This is currently not possible, as the relay pool server rejects join requests whose advertised remote address does not match the address used to make the join request.\r\n\r\nThis PR enables relay servers to send their TLS certificate in the join requests, provided the pool is contacted via https. The relay pool server will capture this certificate, generate the Device ID from it, and compare it to the advertised device ID. If they do not match, the request is rejected straight away.\r\n\r\nThis ensures that the agent sending the join request is indeed in possession of the key corresponding to the advertised device ID. This advertised device ID is later checked to be the same as the one behind the advertised IP address as a part of the original connection test by `performHandshakeAndValidation` on: https://github.com/syncthing/syncthing/blob/d904dfa1918ae09a7af38c75945903ba494fd21f/lib/relay/client/static.go#L240-L242\r\n\r\nWhile this check is only triggered if `uri.Query().Get(\"id\") != \"\"`, this is ensured by the mismatch check mentioned earlier.\r\n\r\n### Testing\r\n\r\nVery basic tested was performed locally by building a relay server and a pool server with the changes, and checking that they were able to exchange and validate the certificates. Please comment if you think more testing (automated or not) is desired for this.\r\n\r\n### Screenshots\r\n\r\nN/A\r\n\r\n### Documentation\r\n\r\n> If this is a user visible change (including API and protocol changes), add a link here to the corresponding pull request on https://github.com/syncthing/docs or describe the documentation changes necessary.\r\n\r\nNone done yet, please tell me if this is necessary.\r\n\r\n---\r\n\r\nCloses #7196\r\n","reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/7217/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/7217/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":4135448880,"node_id":"MDExOkNsb3NlZEV2ZW50NDEzNTQ0ODg4MA==","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4135448880","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2020-12-21T10:55:17Z","state_reason":null,"performed_via_github_app":null},{"id":4135449006,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQxMzU0NDkwMDY=","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4135449006","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"b5de49917c5f632e49c838222e0a12ceb79c609d","commit_url":"https://api.github.com/repos/syncthing/syncthing/commits/b5de49917c5f632e49c838222e0a12ceb79c609d","created_at":"2020-12-21T10:55:19Z","performed_via_github_app":null},{"id":4135755776,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQxMzU3NTU3NzY=","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4135755776","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"7b89bc55c99880eb994ef2b4b7555b82b2bf1e1e","commit_url":"https://api.github.com/repos/calmh/syncthing/commits/7b89bc55c99880eb994ef2b4b7555b82b2bf1e1e","created_at":"2020-12-21T12:25:53Z","performed_via_github_app":null},{"id":4136508284,"node_id":"MDE1Ok1pbGVzdG9uZWRFdmVudDQxMzY1MDgyODQ=","url":"https://api.github.com/repos/syncthing/syncthing/issues/events/4136508284","actor":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2020-12-21T15:42:27Z","milestone":{"title":"v1.13.0"},"performed_via_github_app":null}]