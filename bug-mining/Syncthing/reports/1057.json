{"url":"https://api.github.com/repos/syncthing/syncthing/issues/5288","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/5288/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/5288/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/5288/events","html_url":"https://github.com/syncthing/syncthing/issues/5288","id":373629844,"node_id":"MDU6SXNzdWUzNzM2Mjk4NDQ=","number":5288,"title":"Errors running \"ip\" and \"route\" as snap package","user":{"login":"popey","id":1841272,"node_id":"MDQ6VXNlcjE4NDEyNzI=","avatar_url":"https://avatars.githubusercontent.com/u/1841272?v=4","gravatar_id":"","url":"https://api.github.com/users/popey","html_url":"https://github.com/popey","followers_url":"https://api.github.com/users/popey/followers","following_url":"https://api.github.com/users/popey/following{/other_user}","gists_url":"https://api.github.com/users/popey/gists{/gist_id}","starred_url":"https://api.github.com/users/popey/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/popey/subscriptions","organizations_url":"https://api.github.com/users/popey/orgs","repos_url":"https://api.github.com/users/popey/repos","events_url":"https://api.github.com/users/popey/events{/privacy}","received_events_url":"https://api.github.com/users/popey/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"},{"id":753433298,"node_id":"MDU6TGFiZWw3NTM0MzMyOTg=","url":"https://api.github.com/repos/syncthing/syncthing/labels/skip-changelog","name":"skip-changelog","color":"7fffb4","default":false,"description":"Bugs that have never been in a released stable version, and as such excluded from the release notes"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/syncthing/syncthing/milestones/46","html_url":"https://github.com/syncthing/syncthing/milestone/46","labels_url":"https://api.github.com/repos/syncthing/syncthing/milestones/46/labels","id":5214891,"node_id":"MDk6TWlsZXN0b25lNTIxNDg5MQ==","number":46,"title":"v1.5.0","description":"This release changes the default location for the index database under some circumstances. Two new flags can also be used to affect the location of the configuration (`-config`) and database (`-data`) separately. The old `-home` flag is equivalent to setting both of these to the same directory. When no flags are given the following logic is used to determine the data location:\r\n\r\n- If a database exists in the old default location, that location is still used. This means existing installations are not affected by this change.\r\n- If `$XDG_DATA_HOME` is set, use `$XDG_DATA_HOME/syncthing`.\r\n- If `~/.local/share/syncthing` exists, use that location.\r\n- Use the old default location.\r\n\r\nThis logic is used on non-Windows, non-Mac platforms only. On Windows and Mac the logic is unchanged.\r\n","creator":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":66,"state":"closed","created_at":"2020-03-18T19:49:05Z","updated_at":"2020-05-05T06:03:45Z","due_on":"2020-05-05T07:00:00Z","closed_at":"2020-05-05T06:03:45Z"},"comments":4,"created_at":"2018-10-24T18:58:30Z","updated_at":"2021-03-31T07:02:36Z","closed_at":"2020-03-30T09:11:58Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"On my Ubuntu machine where syncthing is running (from the snap) I was running `snappy-debug.security scanlog` (a tool snap packagers use to identify confinement problems) for another program, and noticed it complain about syncthing. Full log below.\r\n\r\nIt looks like the syncthing application is trying to call out to the /bin/ip and /sbin/route commands. These are not bundled in the snap, and confinement prevents them from running. You may need to bundle them via a `stage-packages` stanza in the snapcraft.yaml. `ip` appears to originate in the `iproute2` package and `route` is in the net-tools package. Hope that helps.\r\n\r\nSyncthing Version:  v0.14.51, Linux (64 bit)\r\nOS Version: Ubuntu 18.04\r\n\r\n```\r\n= AppArmor =\r\nTime: Oct 24 19:50:59\r\nLog: apparmor=\"DENIED\" operation=\"exec\" profile=\"snap.syncthing.syncthing\" name=\"/sbin/route\" pid=18198 comm=\"syncthing\" requested_mask=\"x\" denied_mask=\"x\" fsuid=1000 ouid=0\r\nFile: /sbin/route (exec)\r\nSuggestions:\r\n* adjust snap to ship 'route'\r\n* adjust program to use relative paths if the snap already ships 'route'\r\n\r\n= AppArmor =\r\nTime: Oct 24 19:50:59\r\nLog: apparmor=\"DENIED\" operation=\"exec\" profile=\"snap.syncthing.syncthing\" name=\"/bin/ip\" pid=18199 comm=\"syncthing\" requested_mask=\"x\" denied_mask=\"x\" fsuid=1000 ouid=0\r\nFile: /bin/ip (exec)\r\nSuggestions:\r\n* adjust snap to ship 'ip'\r\n* adjust program to use relative paths if the snap already ships 'ip'\r\n```","closed_by":{"login":"imsodin","id":15955093,"node_id":"MDQ6VXNlcjE1OTU1MDkz","avatar_url":"https://avatars.githubusercontent.com/u/15955093?v=4","gravatar_id":"","url":"https://api.github.com/users/imsodin","html_url":"https://github.com/imsodin","followers_url":"https://api.github.com/users/imsodin/followers","following_url":"https://api.github.com/users/imsodin/following{/other_user}","gists_url":"https://api.github.com/users/imsodin/gists{/gist_id}","starred_url":"https://api.github.com/users/imsodin/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imsodin/subscriptions","organizations_url":"https://api.github.com/users/imsodin/orgs","repos_url":"https://api.github.com/users/imsodin/repos","events_url":"https://api.github.com/users/imsodin/events{/privacy}","received_events_url":"https://api.github.com/users/imsodin/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/5288/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/5288/timeline","performed_via_github_app":null,"state_reason":"completed"}