{"url":"https://api.github.com/repos/syncthing/syncthing/issues/5050","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/5050/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/5050/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/5050/events","html_url":"https://github.com/syncthing/syncthing/issues/5050","id":339168167,"node_id":"MDU6SXNzdWUzMzkxNjgxNjc=","number":5050,"title":"Filesystem watcher doesn't notify changes on Windows when the file size remains the same","user":{"login":"philr","id":190067,"node_id":"MDQ6VXNlcjE5MDA2Nw==","avatar_url":"https://avatars.githubusercontent.com/u/190067?v=4","gravatar_id":"","url":"https://api.github.com/users/philr","html_url":"https://github.com/philr","followers_url":"https://api.github.com/users/philr/followers","following_url":"https://api.github.com/users/philr/following{/other_user}","gists_url":"https://api.github.com/users/philr/gists{/gist_id}","starred_url":"https://api.github.com/users/philr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/philr/subscriptions","organizations_url":"https://api.github.com/users/philr/orgs","repos_url":"https://api.github.com/users/philr/repos","events_url":"https://api.github.com/users/philr/events{/privacy}","received_events_url":"https://api.github.com/users/philr/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/syncthing/syncthing/milestones/23","html_url":"https://github.com/syncthing/syncthing/milestone/23","labels_url":"https://api.github.com/repos/syncthing/syncthing/milestones/23/labels","id":3343149,"node_id":"MDk6TWlsZXN0b25lMzM0MzE0OQ==","number":23,"title":"v0.14.49","description":null,"creator":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":78,"state":"closed","created_at":"2018-05-14T07:01:53Z","updated_at":"2018-07-24T20:19:43Z","due_on":null,"closed_at":"2018-07-24T20:19:43Z"},"comments":0,"created_at":"2018-07-07T19:12:11Z","updated_at":"2019-07-10T07:02:57Z","closed_at":"2018-07-09T17:29:23Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"On Windows, if a file is modified but the file size remains the same, the file system watcher doesn't detect the change. Syncthing won't sync the changes to the file until the next folder scan.\r\n\r\nI can reproduce this issue by opening a text file with Notepad, changing one of the characters (leaving the length of the file the same) and saving the file. With the `NOTIFY_DEBUG` environment variable enabled, the Syncthing logs don't show a change having been detected (I would expect to see 'dispatching notify.FileActionModified').\r\n\r\nI suspect this issue can be fixed by including [`FILE_NOTIFY_CHANGE_LAST_WRITE`](https://docs.microsoft.com/en-us/windows/desktop/api/WinBase/nf-winbase-readdirectorychangesw#FILE_NOTIFY_CHANGE_LAST_WRITE) in the filter passed to `ReadDirectoryChanges` in [`watcher_readdcw.go`](https://github.com/syncthing/notify/blob/master/watcher_readdcw.go). This will generate an event when the last-write time of a file is changed.\r\n\r\n### Version Information\r\n\r\nSyncthing Version: v0.14.48\r\nOS Version: Windows 10 64 bit OS Build 17134.112\r\nBrowser Version: N/A\r\n\r\n","closed_by":{"login":"AudriusButkevicius","id":1144861,"node_id":"MDQ6VXNlcjExNDQ4NjE=","avatar_url":"https://avatars.githubusercontent.com/u/1144861?v=4","gravatar_id":"","url":"https://api.github.com/users/AudriusButkevicius","html_url":"https://github.com/AudriusButkevicius","followers_url":"https://api.github.com/users/AudriusButkevicius/followers","following_url":"https://api.github.com/users/AudriusButkevicius/following{/other_user}","gists_url":"https://api.github.com/users/AudriusButkevicius/gists{/gist_id}","starred_url":"https://api.github.com/users/AudriusButkevicius/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AudriusButkevicius/subscriptions","organizations_url":"https://api.github.com/users/AudriusButkevicius/orgs","repos_url":"https://api.github.com/users/AudriusButkevicius/repos","events_url":"https://api.github.com/users/AudriusButkevicius/events{/privacy}","received_events_url":"https://api.github.com/users/AudriusButkevicius/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/5050/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/5050/timeline","performed_via_github_app":null,"state_reason":"completed"}