{"url":"https://api.github.com/repos/syncthing/syncthing/issues/561","repository_url":"https://api.github.com/repos/syncthing/syncthing","labels_url":"https://api.github.com/repos/syncthing/syncthing/issues/561/labels{/name}","comments_url":"https://api.github.com/repos/syncthing/syncthing/issues/561/comments","events_url":"https://api.github.com/repos/syncthing/syncthing/issues/561/events","html_url":"https://github.com/syncthing/syncthing/issues/561","id":41012780,"node_id":"MDU6SXNzdWU0MTAxMjc4MA==","number":561,"title":".stignore rules are ignored/buggy for existing/synced files","user":{"login":"pascalfree","id":1621900,"node_id":"MDQ6VXNlcjE2MjE5MDA=","avatar_url":"https://avatars.githubusercontent.com/u/1621900?v=4","gravatar_id":"","url":"https://api.github.com/users/pascalfree","html_url":"https://github.com/pascalfree","followers_url":"https://api.github.com/users/pascalfree/followers","following_url":"https://api.github.com/users/pascalfree/following{/other_user}","gists_url":"https://api.github.com/users/pascalfree/gists{/gist_id}","starred_url":"https://api.github.com/users/pascalfree/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pascalfree/subscriptions","organizations_url":"https://api.github.com/users/pascalfree/orgs","repos_url":"https://api.github.com/users/pascalfree/repos","events_url":"https://api.github.com/users/pascalfree/events{/privacy}","received_events_url":"https://api.github.com/users/pascalfree/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":67767665,"node_id":"MDU6TGFiZWw2Nzc2NzY2NQ==","url":"https://api.github.com/repos/syncthing/syncthing/labels/bug","name":"bug","color":"d93f0b","default":true,"description":"A problem with current functionality, as opposed to missing functionality (enhancement)"},{"id":628314330,"node_id":"MDU6TGFiZWw2MjgzMTQzMzA=","url":"https://api.github.com/repos/syncthing/syncthing/labels/frozen-due-to-age","name":"frozen-due-to-age","color":"eeeeee","default":false,"description":"Issues closed and untouched for a long time, together with being locked for discussion"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":10,"created_at":"2014-08-24T16:13:04Z","updated_at":"2017-06-17T00:13:53Z","closed_at":"2014-09-04T20:31:12Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Hi,\n\nI have 2 nodes:\n1. v0.9.8 on linux armv5\n2. v0.9.5 on android (syncthing for android 0.4.8)\n\nI synced the camera folder from my android device to the linux box (setting the \"master repo\" on android). Then I realized, that the two folders `cache` and `thumbnails` had been synced as well and wanted to remove those off the linux box while keeping them on android. So I created a `.stignore` on both nodes (just to be sure) like this:\n\n```\ncache\nthumbnails\n```\n\nHowever the folders (+contents) where not ignored by syncthing (file count did not decrease on either node). I went on deleting the folders on the Linux box. This resulted in the conflict showing up on the android device: It wants to delete the folders but can't, because it has the master repo. When using \"Override Changes\", the folders will be resynced (despite the rule in `.stignore`).\n\nThe problem seems to be, that `.stignore` rules are ignored, if they where created after the respective files have been created/synced, i.e. when the file already has been scanned.\n\nI reproduced the problem the other way around (linux box has the master repo). In general:\n1. Set up a repo synced between node A and B.\n2. (optional) Enable the option \"Master Repo\" on A\n3. Create a file on A. e.g. `testfile.txt`. Let it sync to B\n4. Create `.stignore` on A containing `testfile.txt`\n\n**Expected**: The file count in syncthing will be reduced (on the local repo with the .stignore file) and deleting the file on one node will have no effect on the other node.\n**Actual**: No change in file count and deleting the file on B will delete the file on A (or leave a conflict if A has the master repo). And deleting the file on A will also delete it on B.\n\nAdditionally, I tried editing the file `testfile.txt` after the procedure described above.\nWhen editing it on A, nothing is synced. I assume this is the `.stignore` working correctly.\nWhen editing on B, the changes will be synced back to A. This also seems correct from the way `.stignore` works but may not be expected by the user, i.e.: \"I told it to ignore the file, why is it still changing?\"\n\nSo the question finally is: How to remove a file from the repo that has already been scanned by syncthing (without actually deleting it)?\n\nbtw: I'm very excited about syncthing and totally looking forward to use it for automated backups once it's stable. Thanks for making this and for making it open source.\n","closed_by":{"login":"calmh","id":125426,"node_id":"MDQ6VXNlcjEyNTQyNg==","avatar_url":"https://avatars.githubusercontent.com/u/125426?v=4","gravatar_id":"","url":"https://api.github.com/users/calmh","html_url":"https://github.com/calmh","followers_url":"https://api.github.com/users/calmh/followers","following_url":"https://api.github.com/users/calmh/following{/other_user}","gists_url":"https://api.github.com/users/calmh/gists{/gist_id}","starred_url":"https://api.github.com/users/calmh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/calmh/subscriptions","organizations_url":"https://api.github.com/users/calmh/orgs","repos_url":"https://api.github.com/users/calmh/repos","events_url":"https://api.github.com/users/calmh/events{/privacy}","received_events_url":"https://api.github.com/users/calmh/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/syncthing/syncthing/issues/561/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/syncthing/syncthing/issues/561/timeline","performed_via_github_app":null,"state_reason":"completed"}