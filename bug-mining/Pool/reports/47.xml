<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:16:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[POOL-157] GenericObjectPool.setFactory(...) does not destroy idle pool objects with their original factory object.</title>
                <link>https://issues.apache.org/jira/browse/POOL-157</link>
                <project id="12310488" key="POOL">Commons Pool</project>
                    <description>&lt;p&gt;When setting a new object factory, the existing idle poolable objects are not destroyed by the same factory that created them.&lt;/p&gt;

&lt;p&gt;1453	    public void setFactory(PoolableObjectFactory factory) throws IllegalStateException {&lt;br/&gt;
1454	        List toDestroy = new ArrayList();&lt;br/&gt;
1455	        synchronized (this) {&lt;br/&gt;
1456	            assertOpen();&lt;br/&gt;
1457	            if(0 &amp;lt; getNumActive()) &lt;/p&gt;
{
1458	                throw new IllegalStateException(&quot;Objects are already active&quot;);
1459	            }
&lt;p&gt; else &lt;/p&gt;
{
1460	                toDestroy.addAll(_pool);
1461	                _numInternalProcessing = _numInternalProcessing + _pool._size;
1462	                _pool.clear();
1463	            }
&lt;p&gt;1464	            _factory = factory;&lt;br/&gt;
1465	        }&lt;br/&gt;
1466	        destroy(toDestroy); // &amp;lt;----- indirectly calls _factory.destroy(...) when _factory has already been replaced by the new factory.&lt;br/&gt;
1467	    }&lt;/p&gt;</description>
                <environment></environment>
        <key id="12446749">POOL-157</key>
            <summary>GenericObjectPool.setFactory(...) does not destroy idle pool objects with their original factory object.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="buddydvd">David Hu</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Jan 2010 23:39:21 +0000</created>
                <updated>Sun, 12 Sep 2010 17:24:54 +0000</updated>
                            <resolved>Sun, 11 Apr 2010 17:57:00 +0000</resolved>
                                    <version>1.5</version>
                    <version>1.5.1</version>
                    <version>1.5.2</version>
                    <version>1.5.3</version>
                    <version>1.5.4</version>
                                    <fixVersion>1.5.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12831981" author="psteitz" created="Wed, 10 Feb 2010 13:23:16 +0000"  >&lt;p&gt;This is the result of the change in pool 1.5 to move factory methods outside of synchronized scope to avoid deadlocks.  The obvious fix for this would be to move the call to destroy above the factory reassignment.  This would, however, violate the lock order principle above.   &lt;/p&gt;

&lt;p&gt;I am curious as to the use case for resetting the factory on an active pool.   Why not just close the pool and create a new one with the new factory?  Personally, I have always thought that the factory should be an immutable property of the pool.   I am interested in the understanding the use case.&lt;/p&gt;

&lt;p&gt;I propose to resolve this by&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;deprecating the setter - to be removed in 2.0&lt;/li&gt;
	&lt;li&gt;adding private destroy(PoolableObjectFactory, Collection) and passing it the old factory&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="12832233" author="buddydvd" created="Wed, 10 Feb 2010 22:07:43 +0000"  >&lt;p&gt;I have no use case for it. I just noticed it while trying to understand the code.&lt;/p&gt;</comment>
                            <comment id="12832243" author="psteitz" created="Wed, 10 Feb 2010 22:17:23 +0000"  >&lt;p&gt;OK.  Thanks for reporting this issue.&lt;/p&gt;</comment>
                            <comment id="12855763" author="psteitz" created="Sun, 11 Apr 2010 17:57:00 +0000"  >&lt;p&gt;Fixed in r932962.&lt;/p&gt;</comment>
                            <comment id="12908500" author="psteitz" created="Sun, 12 Sep 2010 17:24:54 +0000"  >&lt;p&gt;Fix version (1.5.5) has been released.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>166729</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 10 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zg7b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>204927</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>