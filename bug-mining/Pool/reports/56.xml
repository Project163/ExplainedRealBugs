<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:16:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[POOL-180] Max active per key can be exceeded by one</title>
                <link>https://issues.apache.org/jira/browse/POOL-180</link>
                <project id="12310488" key="POOL">Commons Pool</project>
                    <description>&lt;p&gt;When instances in the pool fail validation with high frequency,  maxTotal is less than maxActive times the number of keys, and destroy has latency,  the maxActive contract can be violated (i.e., the number of instances created under a given key minus the number destroyed can exceed maxActive).&lt;/p&gt;

&lt;p&gt;Attaching a test case that fails against POOL_1_X&lt;/p&gt;</description>
                <environment></environment>
        <key id="12494669">POOL-180</key>
            <summary>Max active per key can be exceeded by one</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markt">Mark Thomas</assignee>
                                    <reporter username="psteitz">Phil Steitz</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Jan 2011 02:15:49 +0000</created>
                <updated>Fri, 8 Apr 2011 13:54:40 +0000</updated>
                            <resolved>Thu, 24 Mar 2011 11:32:25 +0000</resolved>
                                    <version>1.5</version>
                    <version>1.5.1</version>
                    <version>1.5.2</version>
                    <version>1.5.3</version>
                    <version>1.5.4</version>
                    <version>1.5.5</version>
                                    <fixVersion>1.5.6</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12977619" author="psteitz" created="Wed, 5 Jan 2011 04:33:56 +0000"  >&lt;p&gt;I think the problem is in clearOldest/destroy where only _totalInternalProcessing is incremented/decremented.  The individual key processing counts need to be updated as well.  When clearOldest is disabled, the test succeeds.&lt;/p&gt;</comment>
                            <comment id="13010174" author="markt" created="Wed, 23 Mar 2011 15:24:57 +0000"  >&lt;p&gt;I think Phil&apos;s analysis is correct but the test fails due to a mis-match between WaiterFactory and the pool.&lt;br/&gt;
WaiterFactory#maxActive=5 &amp;lt;=&amp;gt; pool#maxTotal =8&lt;br/&gt;
WaiterFactory#maxActivePerKey=8 &amp;lt;=&amp;gt; pool#maxActive=5&lt;/p&gt;

&lt;p&gt;There are four keys in the test. The pool could have 3 keys each with 2 objects for a total of 6 objects. 6 &amp;lt; 8 (pool#maxTotal) and 2 &amp;lt; 5 (pool#maxActive) so the pool is well within limits. However, 6 !&amp;lt; 5 hence the WaiterFactory throws an error.&lt;/p&gt;

&lt;p&gt;With the mismatch corrected, I can&apos;t recreate the error but I will fix the issue Phil identified.&lt;/p&gt;</comment>
                            <comment id="13010181" author="markt" created="Wed, 23 Mar 2011 15:34:29 +0000"  >&lt;p&gt;Now I am seeing failures. The test appears to be timing sensitive. Not entirely surprising. Still working on a fix.&lt;/p&gt;</comment>
                            <comment id="13010214" author="psteitz" created="Wed, 23 Mar 2011 16:49:59 +0000"  >&lt;p&gt;I have also been working on a fix for this.  It gets a little messy because clear() and clearOldest() both need to have their accounting fixed and you need to postpone removing depleted pools from _poolMap until after destroy completes so you can continue to track internal processing count for the depleted pool.  One other thing I noticed is that clear does not seem to clear _poolMap.  &lt;/p&gt;

&lt;p&gt;Sorry the test case was messed up.&lt;/p&gt;</comment>
                            <comment id="13010222" author="markt" created="Wed, 23 Mar 2011 17:06:57 +0000"  >&lt;p&gt;Fixed in 1.5.x and trunk. There was actually a bigger issue in that the tracking information was being thrown away too soon. Fixing that and the issue Phil noticed, allowed the test case to complete.&lt;/p&gt;</comment>
                            <comment id="13010606" author="markt" created="Thu, 24 Mar 2011 09:06:53 +0000"  >&lt;p&gt;Phil spotted similar issues in evict that also need to be fixed.&lt;/p&gt;</comment>
                            <comment id="13010634" author="markt" created="Thu, 24 Mar 2011 11:32:25 +0000"  >&lt;p&gt;The additional issues have been fixed in trunk and 1.5.x&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12467506" name="maxAcitivePerKeyExceededTest.patch" size="1207" author="psteitz" created="Wed, 5 Jan 2011 02:16:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>166740</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 35 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zgv3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>205034</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>