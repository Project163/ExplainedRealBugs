<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:16:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[POOL-248] GenericObjectPool.returnObject() is NOT throwing IllegalStateException for object has already been returned</title>
                <link>https://issues.apache.org/jira/browse/POOL-248</link>
                <project id="12310488" key="POOL">Commons Pool</project>
                    <description>&lt;p&gt;When GenericObjectPool is created using AbandonedConfig, the pool is NOT throwing &quot;IllegalStateException: Object has already been returned to this pool or is invalid&quot; for object has already been returned.&lt;/p&gt;

&lt;p&gt;final GenericObjectPool&amp;lt;String&amp;gt; pool = new GenericObjectPool&amp;lt;String&amp;gt;(&lt;br/&gt;
				new SimpleFactory(), new GenericObjectPoolConfig(),&lt;br/&gt;
				new AbandonedConfig());&lt;/p&gt;

&lt;p&gt;		String obj1 = pool.borrowObject();&lt;br/&gt;
		System.out.println(&quot;after borrowing obj1&quot;);&lt;br/&gt;
		System.out.println(&quot;numActive=&quot; + pool.getNumActive());&lt;br/&gt;
		System.out.println(&quot;numIdle=&quot; + pool.getNumIdle());&lt;/p&gt;

&lt;p&gt;		System.out.println(&quot;return obj1&quot;);&lt;br/&gt;
		pool.returnObject(obj1);&lt;br/&gt;
		System.out.println(&quot;numActive=&quot; + pool.getNumActive());&lt;br/&gt;
		System.out.println(&quot;numIdle=&quot; + pool.getNumIdle());&lt;/p&gt;

&lt;p&gt;		System.out.println(&quot;return obj1 again&quot;);&lt;br/&gt;
		pool.returnObject(obj1);&lt;br/&gt;
		System.out.println(&quot;numActive=&quot; + pool.getNumActive());&lt;br/&gt;
		System.out.println(&quot;numIdle=&quot; + pool.getNumIdle());&lt;/p&gt;

&lt;p&gt;Output:&lt;br/&gt;
after borrowing obj1&lt;br/&gt;
numActive=1&lt;br/&gt;
numIdle=0&lt;br/&gt;
return obj1&lt;br/&gt;
numActive=0&lt;br/&gt;
numIdle=1&lt;br/&gt;
return obj1 again&lt;br/&gt;
numActive=-1&lt;br/&gt;
numIdle=2&lt;/p&gt;</description>
                <environment></environment>
        <key id="12691951">POOL-248</key>
            <summary>GenericObjectPool.returnObject() is NOT throwing IllegalStateException for object has already been returned</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="chen168">Warren Chen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 29 Jan 2014 04:30:54 +0000</created>
                <updated>Wed, 31 Dec 2014 16:19:11 +0000</updated>
                            <resolved>Mon, 10 Feb 2014 13:06:55 +0000</resolved>
                                    <version>2.1</version>
                                    <fixVersion>2.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13885181" author="markt" created="Wed, 29 Jan 2014 09:49:36 +0000"  >&lt;p&gt;Confirmed. I&apos;ve converted this to a unit test and am working on a fix now.&lt;/p&gt;</comment>
                            <comment id="13885196" author="markt" created="Wed, 29 Jan 2014 10:12:20 +0000"  >&lt;p&gt;I&apos;ve fixed the corruption of active and idle object counts. However, no ISE should be thrown so I&apos;m curious as to why you think it should.&lt;/p&gt;

&lt;p&gt;I&apos;d also note that unless you wrap your pool in the new ProxiedObjectPool then you can never be certain of protecting against an attempt to continue to use an object after it has been returned to the pool&lt;/p&gt;</comment>
                            <comment id="13885604" author="chen168" created="Wed, 29 Jan 2014 18:13:27 +0000"  >&lt;p&gt;When GenericObjectPool is created WITHOUT using AbandonedConfig, the pool is throwing &quot;IllegalStateException: Object has already been returned to this pool or is invalid&quot;.  My assumption is that GenericObjectPool.returnObject() should have the same behavior for both scenarios.  Thanks.&lt;/p&gt;

&lt;p&gt;final GenericObjectPool&amp;lt;String&amp;gt; pool = new GenericObjectPool&amp;lt;String&amp;gt;(&lt;br/&gt;
				new SimpleFactory(), new GenericObjectPoolConfig());&lt;/p&gt;

&lt;p&gt;Output:&lt;br/&gt;
after borrowing obj1&lt;br/&gt;
numActive=1&lt;br/&gt;
numIdle=0&lt;br/&gt;
return obj1&lt;br/&gt;
numActive=0&lt;br/&gt;
numIdle=1&lt;/p&gt;

&lt;p&gt;java.lang.IllegalStateException: Object has already been retured to this pool or is invalid&lt;br/&gt;
	at org.apache.commons.pool2.impl.GenericObjectPool.returnObject(GenericObjectPool.java:592)&lt;/p&gt;

</comment>
                            <comment id="13885737" author="markt" created="Wed, 29 Jan 2014 20:07:55 +0000"  >&lt;p&gt;Thanks, I obviously missed that. I&apos;ve fixed GOP ti the ISE is thrown in both cases. My comment about using the proxy stands.&lt;/p&gt;</comment>
                            <comment id="13885876" author="psteitz" created="Wed, 29 Jan 2014 22:01:15 +0000"  >&lt;p&gt;We should make this clear in the javadoc for returnObject. &lt;/p&gt;</comment>
                            <comment id="13896466" author="markt" created="Mon, 10 Feb 2014 13:06:55 +0000"  >&lt;p&gt;I&apos;ve reviewed and updated the Javadoc.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>370541</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 40 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1rv3b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>370851</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>