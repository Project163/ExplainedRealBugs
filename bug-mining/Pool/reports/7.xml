<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 21:16:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[POOL-102] Thread waiting forever for borrowObject() cannot be interrupted</title>
                <link>https://issues.apache.org/jira/browse/POOL-102</link>
                <project id="12310488" key="POOL">Commons Pool</project>
                    <description>&lt;p&gt;In the following GenericObjectPool snippet inside borrowObject(), InterruptedException is caught and ignored.&lt;/p&gt;

&lt;p&gt;                            case WHEN_EXHAUSTED_BLOCK:&lt;br/&gt;
                                    try {&lt;br/&gt;
                                        if(_maxWait &amp;lt;= 0) &lt;/p&gt;
{
                                            wait();
                                        } else {
                                            wait(_maxWait);
                                        }&lt;br/&gt;
                                    } catch(InterruptedException e) {
                                        // ignored
                                    }&lt;br/&gt;
&lt;br/&gt;
There are two problems here:&lt;br/&gt;
1) a thread waiting forever to get an object out of the pool will NEVER terminate, even if interrupted&lt;br/&gt;
2) even if you put a &quot;throw e&quot; in, it will still be wrong because the thread&apos;s interrupted status is not preserved&lt;br/&gt;
&lt;br/&gt;
This will cause cancellation problems for threads that are inside borrowObject() that want to terminate early ONLY if they are interrupted.&lt;br/&gt;
&lt;br/&gt;
For example, if a borrow-and-wait-forever was running on an pooled executor thread in Java 1.5 and the executor service tried to cancel a task and that task had early-termination logic in it that checked interrupted status to terminate early, the task would never be cancelled.&lt;br/&gt;
&lt;br/&gt;
For us, this is minor because we are on a Tomcat request thread that has to wait for this resource to continue, but for others that have pools of stuff that are being used by time-bound tasks, it&apos;s inconvenient to write code that waits for what ends up being arbitrary time periods for a wait.  It would be easier to just say wait forever and allow interruption by someone else who is watching me.&lt;br/&gt;
&lt;br/&gt;
Suggestion: make the code read like this:&lt;br/&gt;
&lt;br/&gt;
                            case WHEN_EXHAUSTED_BLOCK:&lt;br/&gt;
                                    try {&lt;br/&gt;
                                        if(_maxWait &amp;lt;= 0) {                                            wait();                                        }
&lt;p&gt; else &lt;/p&gt;
{
                                            wait(_maxWait);
                                        }
&lt;p&gt;                                    } catch(InterruptedException e) &lt;/p&gt;
{
                                        Thread.currentThread().interrupt();
                                        throw e;
                                    }</description>
                <environment></environment>
        <key id="12370549">POOL-102</key>
            <summary>Thread waiting forever for borrowObject() cannot be interrupted</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="jdsumsion">John Sumsion</reporter>
                        <labels>
                    </labels>
                <created>Wed, 30 May 2007 18:23:32 +0000</created>
                <updated>Sun, 12 Sep 2010 17:43:31 +0000</updated>
                            <resolved>Fri, 22 Jun 2007 06:13:09 +0000</resolved>
                                    <version>1.1</version>
                    <version>1.2</version>
                    <version>1.3</version>
                                    <fixVersion>2.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="12507136" author="psteitz" created="Fri, 22 Jun 2007 06:13:09 +0000"  >&lt;p&gt;Patch applied.  Thanks!&lt;/p&gt;</comment>
                            <comment id="12614628" author="songzhouchen" created="Fri, 18 Jul 2008 03:50:55 +0000"  >&lt;p&gt;Steitz,&lt;/p&gt;

&lt;p&gt;It seems the Revision #549729 doesn&apos;t work. we met the issue on the HTTP threads being response to concurrent 40 users, which made the connection pool was exhausted and all of HTTP threads waiting on GenericObjectPool.borrowObject happened.&lt;/p&gt;

&lt;p&gt;Given the commons pool v2.0 doesn&apos;t come out, I got the v1.4 and was pleased to see the bug fixes list  -  Allowed blocked threads in GenericObjectPool borrowObject to be interrupted. Issue: &lt;a href=&quot;https://issues.apache.org/jira/browse/POOL-102&quot; title=&quot;Thread waiting forever for borrowObject() cannot be interrupted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;POOL-102&quot;&gt;&lt;del&gt;POOL-102&lt;/del&gt;&lt;/a&gt;.  But unfortunately it didn&apos;t fix our issue when I replaced the v1.4 with v1.3.  HTTP threads were still waiting for GenericObjectPool.borrowObject.&lt;/p&gt;

&lt;p&gt;is it any solution to solve it out or any workaround exists? many thanks.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>166692</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            17 years, 19 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0zh07:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>205057</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>