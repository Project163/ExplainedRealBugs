diff --git a/src/java/org/apache/commons/pool2/impl/GenericKeyedObjectPool.java b/src/java/org/apache/commons/pool2/impl/GenericKeyedObjectPool.java
index bd8747d6..3e503bd7 100644
--- a/src/java/org/apache/commons/pool2/impl/GenericKeyedObjectPool.java
+++ b/src/java/org/apache/commons/pool2/impl/GenericKeyedObjectPool.java
@@ -236,6 +236,9 @@ public class GenericKeyedObjectPool<K,T> implements KeyedObjectPool<K,T>,
             GenericKeyedObjectPoolConfig config) {
         // Copy the settings from the config
         this.factory = factory;
+        // save the current CCL to be used later by the evictor Thread
+        factoryClassLoader = Thread.currentThread().getContextClassLoader();
+
         setConfig(config);
 
         startEvictor(getMinEvictableIdleTimeMillis());
@@ -2081,24 +2084,37 @@ public class GenericKeyedObjectPool<K,T> implements KeyedObjectPool<K,T>,
         /**
          * Run pool maintenance.  Evict objects qualifying for eviction and then
          * invoke {@link GenericKeyedObjectPool#ensureMinIdle()}.
+         * Since the Timer that invokes Evictors is shared for all Pools, we try
+         * to restore the ContextClassLoader that created the pool.
          */
         @Override
         public void run() {
-            //Evict from the pool
-            try {
-                evict();
-            } catch(Exception e) {
-                // ignored
-            } catch(OutOfMemoryError oome) {
-                // Log problem but give evictor thread a chance to continue in
-                // case error is recoverable
-                oome.printStackTrace(System.err);
-            }
-            //Re-create idle instances.
+            ClassLoader savedClassLoader =
+                    Thread.currentThread().getContextClassLoader();
             try {
-                ensureMinIdle();
-            } catch (Exception e) {
-                // ignored
+                //  set the class loader for the factory
+                Thread.currentThread().setContextClassLoader(
+                        factoryClassLoader);
+                
+                //Evict from the pool
+                try {
+                    evict();
+                } catch(Exception e) {
+                    // ignored
+                } catch(OutOfMemoryError oome) {
+                    // Log problem but give evictor thread a chance to continue in
+                    // case error is recoverable
+                    oome.printStackTrace(System.err);
+                }
+                //Re-create idle instances.
+                try {
+                    ensureMinIdle();
+                } catch (Exception e) {
+                    // ignored
+                }
+            } finally {
+                // restore the previous CCL
+                Thread.currentThread().setContextClassLoader(savedClassLoader);
             }
         }
     }
@@ -2264,6 +2280,13 @@ public class GenericKeyedObjectPool<K,T> implements KeyedObjectPool<K,T>,
     /** My {@link KeyedPoolableObjectFactory}. */
     final private KeyedPoolableObjectFactory<K,T> factory;
 
+    /**
+     * Class loader for evictor thread to use since in a J2EE or similar
+     * environment the context class loader for the evictor thread may have
+     * visibility of the correct factory. See POOL-161.
+     */
+    private ClassLoader factoryClassLoader = null;
+
     /**
      * My hash of pools (ObjectQueue). The list of keys <b>must</b> be kept in
      * step with {@link #poolKeyList} using {@link #keyLock} to ensure any
diff --git a/src/java/org/apache/commons/pool2/impl/GenericObjectPool.java b/src/java/org/apache/commons/pool2/impl/GenericObjectPool.java
index 255a130a..a580a00b 100644
--- a/src/java/org/apache/commons/pool2/impl/GenericObjectPool.java
+++ b/src/java/org/apache/commons/pool2/impl/GenericObjectPool.java
@@ -189,6 +189,9 @@ public class GenericObjectPool<T> extends BaseObjectPool<T>
     public GenericObjectPool(PoolableObjectFactory<T> factory,
             GenericObjectPoolConfig config) {
         this.factory = factory;
+        // save the current CCL to be used later by the evictor Thread
+        factoryClassLoader = Thread.currentThread().getContextClassLoader();
+        
         setConfig(config);
 
         startEvictor(getTimeBetweenEvictionRunsMillis());
@@ -1417,22 +1420,35 @@ public class GenericObjectPool<T> extends BaseObjectPool<T>
         /**
          * Run pool maintenance. Evict objects qualifying for eviction and then
          * invoke {@link GenericObjectPool#ensureMinIdle()}.
+         * Since the Timer that invokes Evictors is shared for all Pools, we try
+         * to restore the ContextClassLoader that created the pool.
          */
         @Override
         public void run() {
+            ClassLoader savedClassLoader =
+                    Thread.currentThread().getContextClassLoader();
             try {
-                evict();
-            } catch (Exception e) {
-                // ignored
-            } catch (OutOfMemoryError oome) {
-                // Log problem but give evictor thread a chance to continue in
-                // case error is recoverable
-                oome.printStackTrace(System.err);
-            }
-            try {
-                ensureMinIdle();
-            } catch (Exception e) {
-                // ignored
+                //  set the class loader for the factory
+                Thread.currentThread().setContextClassLoader(
+                        factoryClassLoader);
+                try {
+                    evict();
+                } catch (Exception e) {
+                    // ignored
+                } catch (OutOfMemoryError oome) {
+                    // Log problem but give evictor thread a chance to continue
+                    // in case error is recoverable
+                    oome.printStackTrace(System.err);
+                }
+                try {
+                    ensureMinIdle();
+                } catch (Exception e) {
+                    e.printStackTrace();
+                    // ignored
+                }
+            } finally {
+                // restore the previous CCL
+                Thread.currentThread().setContextClassLoader(savedClassLoader);
             }
         }
     }
@@ -1588,6 +1604,13 @@ public class GenericObjectPool<T> extends BaseObjectPool<T>
     /** My {@link PoolableObjectFactory}. */
     final private PoolableObjectFactory<T> factory;
 
+    /**
+     * Class loader for evictor thread to use since in a J2EE or similar
+     * environment the context class loader for the evictor thread may have
+     * visibility of the correct factory. See POOL-161.
+     */
+    private ClassLoader factoryClassLoader = null;
+
     /**
      * All of the objects currently associated with this pool in any state. It
      * excludes objects that have been destroyed. The size of
diff --git a/src/test/org/apache/commons/pool2/impl/TestGenericObjectPoolClassLoaders.java b/src/test/org/apache/commons/pool2/impl/TestGenericObjectPoolClassLoaders.java
new file mode 100644
index 00000000..7941c624
--- /dev/null
+++ b/src/test/org/apache/commons/pool2/impl/TestGenericObjectPoolClassLoaders.java
@@ -0,0 +1,110 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one or more
+ * contributor license agreements.  See the NOTICE file distributed with
+ * this work for additional information regarding copyright ownership.
+ * The ASF licenses this file to You under the Apache License, Version 2.0
+ * (the "License"); you may not use this file except in compliance with
+ * the License.  You may obtain a copy of the License at
+ *
+ *      http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing, software
+ * distributed under the License is distributed on an "AS IS" BASIS,
+ * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
+ * See the License for the specific language governing permissions and
+ * limitations under the License.
+ */
+package org.apache.commons.pool2.impl;
+
+import java.net.URL;
+import java.net.URLClassLoader;
+
+import junit.framework.TestCase;
+
+import org.apache.commons.pool2.BasePoolableObjectFactory;
+
+public class TestGenericObjectPoolClassLoaders extends TestCase {
+
+	private static final URL BASE_URL =
+	        TestGenericObjectPoolClassLoaders.class.getResource(
+	                "/org/apache/commons/pool2/impl/");
+
+	public void testContextClassLoader() throws Exception {
+
+		ClassLoader savedClassloader = Thread.currentThread()
+				.getContextClassLoader();
+
+		try {
+			CustomClassLoader cl1 = new CustomClassLoader(1);
+			Thread.currentThread().setContextClassLoader(cl1);
+			CustomClassLoaderObjectFactory factory1 =
+			        new CustomClassLoaderObjectFactory(1);
+			GenericObjectPool<URL> pool1 = new GenericObjectPool<URL>(factory1);
+			pool1.setMinIdle(1);
+			pool1.setTimeBetweenEvictionRunsMillis(100);
+			Thread.sleep(200);
+			assertEquals("Wrong number of idle objects in pool1", 1,
+			        pool1.getNumIdle());
+
+			// ---------------
+			CustomClassLoader cl2 = new CustomClassLoader(2);
+			Thread.currentThread().setContextClassLoader(cl2);
+			CustomClassLoaderObjectFactory factory2 = new CustomClassLoaderObjectFactory(
+					2);
+			GenericObjectPool<URL> pool2 = new GenericObjectPool<URL>(factory2);
+			pool2.setMinIdle(1);
+
+			pool2.addObject();
+			assertEquals("Wrong number of idle objects in pool2", 1,
+			        pool2.getNumIdle());
+			pool2.clear();
+
+			pool2.setTimeBetweenEvictionRunsMillis(100);
+			Thread.sleep(200);
+
+			assertEquals("Wrong number of  idle objects in pool2", 1,
+			        pool2.getNumIdle());
+
+		} finally {
+			Thread.currentThread().setContextClassLoader(savedClassloader);
+		}
+	}
+
+	private class CustomClassLoaderObjectFactory extends
+			BasePoolableObjectFactory<URL> {
+		private int n;
+
+		CustomClassLoaderObjectFactory(int n) {
+			this.n = n;
+		}
+
+		@Override
+        public URL makeObject() throws Exception {
+			URL url = Thread.currentThread().getContextClassLoader()
+					.getResource("test" + n);
+			if (url == null) {
+				throw new IllegalStateException("Object should not be null");
+			}
+			return url;
+		}
+
+	}
+
+	private static class CustomClassLoader extends URLClassLoader {
+		private int n;
+
+		CustomClassLoader(int n) {
+			super(new URL[] { BASE_URL });
+			this.n = n;
+		}
+
+		@Override
+        public URL findResource(String name) {
+			if (!name.endsWith(String.valueOf(n))) {
+				return null;
+			}
+
+			return super.findResource(name);
+		}
+	}
+}
diff --git a/src/test/org/apache/commons/pool2/impl/test1 b/src/test/org/apache/commons/pool2/impl/test1
new file mode 100644
index 00000000..93b493a5
--- /dev/null
+++ b/src/test/org/apache/commons/pool2/impl/test1
@@ -0,0 +1 @@
+Hello world !
\ No newline at end of file
diff --git a/src/test/org/apache/commons/pool2/impl/test2 b/src/test/org/apache/commons/pool2/impl/test2
new file mode 100644
index 00000000..93b493a5
--- /dev/null
+++ b/src/test/org/apache/commons/pool2/impl/test2
@@ -0,0 +1 @@
+Hello world !
\ No newline at end of file
