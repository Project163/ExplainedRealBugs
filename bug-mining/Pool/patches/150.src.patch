diff --git a/src/main/java/org/apache/commons/pool2/impl/GenericObjectPool.java b/src/main/java/org/apache/commons/pool2/impl/GenericObjectPool.java
index abdf7e18..0575f7e9 100644
--- a/src/main/java/org/apache/commons/pool2/impl/GenericObjectPool.java
+++ b/src/main/java/org/apache/commons/pool2/impl/GenericObjectPool.java
@@ -914,6 +914,15 @@ public class GenericObjectPool<T> extends BaseGenericObjectPool<T>
             destroyedCount.incrementAndGet();
             createCount.decrementAndGet();
         }
+
+        if (idleObjects.isEmpty() && idleObjects.hasTakeWaiters()) {
+            // POOL-356.
+            // In case there are already threads waiting on something in the pool
+            // (e.g. idleObjects.takeFirst(); then we need to provide them a fresh instance.
+            // Otherwise they will be stuck forever (or until timeout)
+            PooledObject<T> freshPooled = create();
+            idleObjects.put(freshPooled);
+        }
     }
 
     @Override
diff --git a/src/test/java/org/apache/commons/pool2/impl/TestGenericObjectPool.java b/src/test/java/org/apache/commons/pool2/impl/TestGenericObjectPool.java
index 3e897f7e..fd5a871f 100644
--- a/src/test/java/org/apache/commons/pool2/impl/TestGenericObjectPool.java
+++ b/src/test/java/org/apache/commons/pool2/impl/TestGenericObjectPool.java
@@ -777,7 +777,7 @@ public class TestGenericObjectPool extends TestBaseObjectPool {
         }
         // Give the threads a chance to start doing some work
         try {
-            Thread.sleep(5000);
+            Thread.sleep(100);
         } catch(final InterruptedException e) {
             // ignored
         }
@@ -824,6 +824,7 @@ public class TestGenericObjectPool extends TestBaseObjectPool {
                 }
             }
             if(threads[i].failed()) {
+                threads[i]._error.printStackTrace();
                 fail("Thread "+i+" failed: "+threads[i]._error.toString());
             }
         }
