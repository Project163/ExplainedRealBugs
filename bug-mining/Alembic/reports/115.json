{"url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1556","repository_url":"https://api.github.com/repos/sqlalchemy/alembic","labels_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1556/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1556/comments","events_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1556/events","html_url":"https://github.com/sqlalchemy/alembic/issues/1556","id":2614298141,"node_id":"I_kwDOCX47u86b0wYd","number":1556,"title":"A timezone error on `python3.12` and `alembic[tz]`?","user":{"login":"Danipulok","id":45077699,"node_id":"MDQ6VXNlcjQ1MDc3Njk5","avatar_url":"https://avatars.githubusercontent.com/u/45077699?v=4","gravatar_id":"","url":"https://api.github.com/users/Danipulok","html_url":"https://github.com/Danipulok","followers_url":"https://api.github.com/users/Danipulok/followers","following_url":"https://api.github.com/users/Danipulok/following{/other_user}","gists_url":"https://api.github.com/users/Danipulok/gists{/gist_id}","starred_url":"https://api.github.com/users/Danipulok/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Danipulok/subscriptions","organizations_url":"https://api.github.com/users/Danipulok/orgs","repos_url":"https://api.github.com/users/Danipulok/repos","events_url":"https://api.github.com/users/Danipulok/events{/privacy}","received_events_url":"https://api.github.com/users/Danipulok/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141241826,"node_id":"MDU6TGFiZWwxMTQxMjQxODI2","url":"https://api.github.com/repos/sqlalchemy/alembic/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1388914604,"node_id":"MDU6TGFiZWwxMzg4OTE0NjA0","url":"https://api.github.com/repos/sqlalchemy/alembic/labels/use%20case","name":"use case","color":"f28b2b","default":false,"description":"not quite a feature and not quite a bug, something we just didn't think of"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2024-10-25T14:37:34Z","updated_at":"2024-11-06T23:37:28Z","closed_at":"2024-11-06T23:37:28Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Describe the bug**\r\nAsync API mode. \r\nI used config templates from [here](https://github.com/sqlalchemy/alembic/tree/bd50ba325b10a1a9cdb452fe40c96f959825797c/alembic/templates/async).\r\nI used `pip install alembic[tz]`:\r\n\r\n```\r\n$ pip install alembic[tz]==1.13.3\r\nRequirement already satisfied: alembic==1.13.3 in d:\\code\\project\\.venv\\lib\\site-packages (from alembic[tz]==1.13.3) (1.13.3)\r\nRequirement already satisfied: SQLAlchemy>=1.3.0 in d:\\code\\project\\.venv\\lib\\site-packages (from alembic==1.13.3->alembic[tz]==1.13.3) (2.0.36)\r\nRequirement already satisfied: Mako in d:\\code\\project\\.venv\\lib\\site-packages (from alembic==1.13.3->alembic[tz]==1.13.3) (1.3.6)\r\nRequirement already satisfied: typing-extensions>=4 in d:\\code\\project\\.venv\\lib\\site-packages (from alembic==1.13.3->alembic[tz]==1.13.3) (4.12.2)\r\nRequirement already satisfied: greenlet!=0.4.17 in d:\\code\\project\\.venv\\lib\\site-packages (from SQLAlchemy>=1.3.0->alembic==1.13.3->alembic[tz]==1.13.3) (3.1.1)     \r\nRequirement already satisfied: MarkupSafe>=0.9.2 in d:\\code\\project\\.venv\\lib\\site-packages (from Mako->alembic==1.13.3->alembic[tz]==1.13.3) (3.0.2)\r\n```\r\n\r\nBut when I run `alembic revision --autogenerate -m \"msg\"`, I get:\r\n```\r\nINFO  [alembic.runtime.migration] Context impl PostgresqlImpl.\r\nINFO  [alembic.runtime.migration] Will assume transactional DDL.\r\nINFO  [alembic.autogenerate.compare] Detected added table 'users'\r\nINFO  [alembic.autogenerate.compare] Detected added index ''ix_users_created_at'' on '('created_at',)'\r\nERROR [alembic.util.messaging] Can't locate timezone: UTC\r\nFAILED: Can't locate timezone: UTC\r\n```\r\n\r\n**Expected behavior**\r\nEverything should work if I installed `alembic[tz]`?\r\nBut I also found this issue on SO: https://stackoverflow.com/questions/77698777/how-to-change-timezone-in-alembic-for-sqlalchemy\r\nAfter I install `tzdata`, the same command stated working.\r\n\r\n**To Reproduce**\r\nUse this `alembic.ini`: https://github.com/sqlalchemy/alembic/blob/bd50ba325b10a1a9cdb452fe40c96f959825797c/alembic/templates/async/alembic.ini.mako\r\nAnd add:\r\n```\r\ntimezone = UTC\r\n```\r\n\r\n**Versions.**\r\n - OS: Windows 10\r\n - Python: 3.12.3\r\n - Alembic: 1.13.3\r\n - SQLAlchemy: 2.0.36\r\n - Database: postgres\r\n - DBAPI: asyncpg==0.30.0\r\n","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1556/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1556/timeline","performed_via_github_app":null,"state_reason":"completed"}