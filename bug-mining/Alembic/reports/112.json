{"url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1337","repository_url":"https://api.github.com/repos/sqlalchemy/alembic","labels_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1337/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1337/comments","events_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1337/events","html_url":"https://github.com/sqlalchemy/alembic/issues/1337","id":1959778587,"node_id":"I_kwDOCX47u850z9kb","number":1337,"title":"Improve re-writer implementation, fixing chain and adding support to callables","user":{"login":"CaselIT","id":16175304,"node_id":"MDQ6VXNlcjE2MTc1MzA0","avatar_url":"https://avatars.githubusercontent.com/u/16175304?v=4","gravatar_id":"","url":"https://api.github.com/users/CaselIT","html_url":"https://github.com/CaselIT","followers_url":"https://api.github.com/users/CaselIT/followers","following_url":"https://api.github.com/users/CaselIT/following{/other_user}","gists_url":"https://api.github.com/users/CaselIT/gists{/gist_id}","starred_url":"https://api.github.com/users/CaselIT/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/CaselIT/subscriptions","organizations_url":"https://api.github.com/users/CaselIT/orgs","repos_url":"https://api.github.com/users/CaselIT/repos","events_url":"https://api.github.com/users/CaselIT/events{/privacy}","received_events_url":"https://api.github.com/users/CaselIT/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141243519,"node_id":"MDU6TGFiZWwxMTQxMjQzNTE5","url":"https://api.github.com/repos/sqlalchemy/alembic/labels/autogenerate%20-%20rendering","name":"autogenerate - rendering","color":"00B0E0","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-10-24T17:53:31Z","updated_at":"2023-12-20T13:54:16Z","closed_at":"2023-12-20T13:54:15Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"ive just read the source code for chain() and it's a bit of a disaster.  because if i do this:\r\n\r\n    w = writer1.chain(writer2).chain(writer3)\r\n\r\nwriter2 is lost.  it's doing the chaining wrong.  my high school comp sci teacher would be unimpressed\r\n\r\nit works for your use case right now because it only handles exactly two writers.   but if we fix it to correctly implement chaining then it would not work for your case in the general sense.    \r\n\r\nwe can fix both issues at once by 1. fixing the chaining so that if `self._chain` is non-None we traverse the list through to the end for the linked list append, and 2. looking at the type of object sent and if it's just a callable, wrapping it in a helper object `CallableRewriter` that uses that callable and also supports the rest of the `Rewriter` protocol including `self._chain`.\r\n\r\n_Originally posted by @zzzeek in https://github.com/sqlalchemy/alembic/discussions/1332#discussioncomment-7369839_","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1337/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/1337/timeline","performed_via_github_app":null,"state_reason":"completed"}