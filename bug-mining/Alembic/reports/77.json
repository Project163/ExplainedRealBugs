{"url":"https://api.github.com/repos/sqlalchemy/alembic/issues/302","repository_url":"https://api.github.com/repos/sqlalchemy/alembic","labels_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/302/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/302/comments","events_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/302/events","html_url":"https://github.com/sqlalchemy/alembic/issues/302","id":384602413,"node_id":"MDU6SXNzdWUzODQ2MDI0MTM=","number":302,"title":"operations as objects","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141242821,"node_id":"MDU6TGFiZWwxMTQxMjQyODIx","url":"https://api.github.com/repos/sqlalchemy/alembic/labels/feature","name":"feature","color":"801010","default":false,"description":null},{"id":1141242979,"node_id":"MDU6TGFiZWwxMTQxMjQyOTc5","url":"https://api.github.com/repos/sqlalchemy/alembic/labels/op%20directives","name":"op directives","color":"90F020","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/sqlalchemy/alembic/milestones/2","html_url":"https://github.com/sqlalchemy/alembic/milestone/2","labels_url":"https://api.github.com/repos/sqlalchemy/alembic/milestones/2/labels","id":3850498,"node_id":"MDk6TWlsZXN0b25lMzg1MDQ5OA==","number":2,"title":"tier 1","description":null,"creator":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":24,"state":"closed","created_at":"2018-11-27T03:04:06Z","updated_at":"2020-04-10T15:00:48Z","due_on":null,"closed_at":"2020-04-10T15:00:48Z"},"comments":3,"created_at":"2015-06-11T21:07:12Z","updated_at":"2015-07-03T17:15:26Z","closed_at":"2015-07-03T17:13:36Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Migrated issue, originally created by Michael Bayer ([@zzzeek](https://github.com/zzzeek))**\n\nto allow extensibility:\n\n1. primary methods in operations move to be exported from objects, extending a base Operation type, e.g. `AddTableOperation`\n\n2. object-building methods in operations move to a utility object \"objects\" or similar, e.g. _table(), _metadata(), _unique_constraint(); \n\n3. Operation objects include a convenience op_method, which goes into operations and defines the docstring, and does the things that are inside of operations.py right now, e.g. calling upon objects.table(), etc. then calling the more fundamental version of itself on a given \n\"impl\".   E.g. under \"class Operations:\" we have \"drop_table = DropTable.get_op_method()\".\n\n4.  Operation objects also integrate with autogenerate render; methods in autogen.render such as _add_index, _drop_table etc. go onto a compiler object that uses a visit pattern, given Operation objects.\n\n5. autogenerate api -> _produce_commands will deal in these directives now.  the directives are first generated from the diffs stream\n\n6. the Operation objects also store a reference to the diff object they got from the diffs stream,\n\n7. the Operation objects use a generic dispatcher pattern; so when Operation is invoked such that we want it to acutally do say a \"drop_table\", it is given a generic \"impl\" upon which it invokes \"drop_table\".   The object is not stateful in terms of it \"doing\" anything.   this is the basic visitor / dispatch pattern that will also work for the autogen render aspect.\n\n8. extensibility is key so ensure Operation objects have an .info as well.\n\n9. rework the modules into sub-packages where things involving the new Operation scheme is in alembic.operations, so the existing \"operations\" and \"batch\" move into there as well.\n\n10. operations.BatchOperations subclass probably needs to stay as is for now\n\nsee also #301\n\n","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/alembic/issues/302/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/302/timeline","performed_via_github_app":null,"state_reason":"completed"}