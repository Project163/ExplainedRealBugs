{"url":"https://api.github.com/repos/sqlalchemy/alembic/issues/192","repository_url":"https://api.github.com/repos/sqlalchemy/alembic","labels_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/192/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/192/comments","events_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/192/events","html_url":"https://github.com/sqlalchemy/alembic/issues/192","id":384601385,"node_id":"MDU6SXNzdWUzODQ2MDEzODU=","number":192,"title":"mssql_drop_check=True results in \"Not an executable clause\" in MSSQL","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141241826,"node_id":"MDU6TGFiZWwxMTQxMjQxODI2","url":"https://api.github.com/repos/sqlalchemy/alembic/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2014-03-28T14:43:01Z","updated_at":"2014-03-28T18:59:16Z","closed_at":"2014-03-28T18:59:16Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Migrated issue, originally created by Marek Baczy≈Ñski ([@imbaczek](https://github.com/imbaczek))**\n\nalembic master, sqlalchemy master, Python 3.4.0, MSSQL 2008 R2\n\nThe migration:\n\n```\ndef upgrade():\n    ### commands auto generated by Alembic - please adjust! ###\n    op.add_column('some_table', sa.Column('status', sa.Enum('HAS_A', 'HAS_A_OR_B', 'NEITHER', name='status'), server_default='NEITHER', nullable=False))\n    ### end Alembic commands ###\n\n\ndef downgrade():\n    ### commands auto generated by Alembic - please adjust! ###\n    op.drop_column('some_table', 'status', mssql_drop_check=True)\n    ### end Alembic commands ##\n\n```\n\n\n\n```\n#!\n[...]\n  File \"alembic\\versions\\4a54e52933c_add_status_column_to_sometable.py\", line 25, in downgrade\n    op.drop_column('some_table', 'status', mssql_drop_check=True)\n  File \"<string>\", line 7, in drop_column\n  File \"...venv\\lib\\site-packages\\alembic\\operations.py\", line 477, in drop_column\n    **kw\n  File \"...venv\\lib\\site-packages\\alembic\\ddl\\mssql.py\", line 118, in drop_column\n    'sys.check_constraints')\n  File \"...venv\\lib\\site-packages\\alembic\\ddl\\mssql.py\", line 22, in _exec\n    super(MSSQLImpl, self)._exec(construct, *args, **kw)\n  File \"...venv\\lib\\site-packages\\alembic\\ddl\\impl.py\", line 76, in _exec\n    conn.execute(construct, *multiparams, **params)\n  File \"...venv\\lib\\site-packages\\sqlalchemy\\engine\\base.py\", line 720, in execute\n    return meth(self, multiparams, params)\n[...]\n    raise exc.ArgumentError(\"Not an executable clause\")\nsqlalchemy.exc.StatementError: Not an executable clause (original cause: sqlalchemy.exc.ArgumentError: Not an executable clause)\n\"declare @const_name varchar(256)\\nselect @const_name = [name] from sys.check_constraints\\nwhere parent_object_id = object_id('some_table')\\nand col_name(parent_object_id, parent_column_id) = 'status'\\nexec('alter table some_table drop constraint ' + @const_name)\" []\n```\nWhat's most interesting is that the printed SQL works fine in Management Studio after replacing \\n's with newlines manually.\n\n","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/alembic/issues/192/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/192/timeline","performed_via_github_app":null,"state_reason":"completed"}