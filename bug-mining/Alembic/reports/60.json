{"url":"https://api.github.com/repos/sqlalchemy/alembic/issues/241","repository_url":"https://api.github.com/repos/sqlalchemy/alembic","labels_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/241/labels{/name}","comments_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/241/comments","events_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/241/events","html_url":"https://github.com/sqlalchemy/alembic/issues/241","id":384601868,"node_id":"MDU6SXNzdWUzODQ2MDE4Njg=","number":241,"title":"postgresql compare_server_default with floats","user":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1141241826,"node_id":"MDU6TGFiZWwxMTQxMjQxODI2","url":"https://api.github.com/repos/sqlalchemy/alembic/labels/bug","name":"bug","color":"d73a4a","default":true,"description":"Something isn't working"},{"id":1141242890,"node_id":"MDU6TGFiZWwxMTQxMjQyODkw","url":"https://api.github.com/repos/sqlalchemy/alembic/labels/low%20priority","name":"low priority","color":"900080","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":7,"created_at":"2014-11-03T13:22:41Z","updated_at":"2015-01-12T19:13:16Z","closed_at":"2015-01-12T19:12:20Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Migrated issue, originally created by Dimitrios Theodorou ([@dtheodor](https://github.com/dtheodor))**\n\nAfter updating Alembic from 0.6.2 to the latest I am getting an exception in the `PostgresqlIpml.compare_server_default`. In particular:\n\nMy DB schema:\n```sql\nCREATE TABLE stuff (\nvalue1 float DEFAULT 0\n)\n```\n\nMy SQL Alchemy model:\n```python\nclass Stuff(Base):\n  value1 = Column(Float, server_default=\"0.0\")\n```\n\nThe compare_server_default emits this SQL query (on the left is the rendered_inspector_default, on the right the rendered_metadata_default):\n```sql\nSELECT 0 = '0.0';\n```\nwhich fails with the DataError `ERROR:  invalid input syntax for integer: \"0.0\"`\n\nIn Postgres, the DEFAULT values `0`, `0.0` and `'0.0`' are all valid and have identical end-result for a float column.\n\nWhat would the \"proper\" solution be here, catch the exception and return False in the comparison, or check the column type and cast to float before comparing?\n\nTo avoid the error I set the `server_default` to a float value (`server_default=text(\"0.0\")`)\n\n","closed_by":{"login":"sqlalchemy-bot","id":36047385,"node_id":"MDQ6VXNlcjM2MDQ3Mzg1","avatar_url":"https://avatars.githubusercontent.com/u/36047385?v=4","gravatar_id":"","url":"https://api.github.com/users/sqlalchemy-bot","html_url":"https://github.com/sqlalchemy-bot","followers_url":"https://api.github.com/users/sqlalchemy-bot/followers","following_url":"https://api.github.com/users/sqlalchemy-bot/following{/other_user}","gists_url":"https://api.github.com/users/sqlalchemy-bot/gists{/gist_id}","starred_url":"https://api.github.com/users/sqlalchemy-bot/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sqlalchemy-bot/subscriptions","organizations_url":"https://api.github.com/users/sqlalchemy-bot/orgs","repos_url":"https://api.github.com/users/sqlalchemy-bot/repos","events_url":"https://api.github.com/users/sqlalchemy-bot/events{/privacy}","received_events_url":"https://api.github.com/users/sqlalchemy-bot/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/sqlalchemy/alembic/issues/241/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/sqlalchemy/alembic/issues/241/timeline","performed_via_github_app":null,"state_reason":"completed"}