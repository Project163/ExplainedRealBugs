diff --git a/tools/write_pyi.py b/tools/write_pyi.py
index 363d727..b2ad230 100644
--- a/tools/write_pyi.py
+++ b/tools/write_pyi.py
@@ -11,12 +11,12 @@ from tempfile import NamedTemporaryFile
 import textwrap
 import typing
 
+sys.path.append(str(Path(__file__).parent.parent))
+
 from alembic.autogenerate.api import AutogenContext
 from alembic.ddl.impl import DefaultImpl
 from alembic.runtime.migration import MigrationInfo
 
-sys.path.append(str(Path(__file__).parent.parent))
-
 if True:  # avoid flake/zimports messing with the order
     from alembic.operations.base import BatchOperations
     from alembic.operations.base import Operations
diff --git a/tox.ini b/tox.ini
index f1bfcac..77439be 100644
--- a/tox.ini
+++ b/tox.ini
@@ -101,3 +101,12 @@ deps=
 commands =
      flake8 ./alembic/ ./tests/ setup.py docs/build/conf.py {posargs}
      black --check setup.py tests alembic
+
+[testenv:write_pyi]
+basepython = python3
+deps=
+    sqlalchemy>=2
+    mako
+    zimports
+    black==24.1.1
+commands = python tools/write_pyi.py
