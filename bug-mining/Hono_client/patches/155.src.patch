diff --git a/client/src/main/java/org/eclipse/hono/client/Command.java b/client/src/main/java/org/eclipse/hono/client/Command.java
index 45c3bf8e3..4a6d13c6d 100644
--- a/client/src/main/java/org/eclipse/hono/client/Command.java
+++ b/client/src/main/java/org/eclipse/hono/client/Command.java
@@ -31,6 +31,12 @@ import io.vertx.core.buffer.Buffer;
  */
 public final class Command {
 
+    /**
+     * Bit flag value for the boolean option that defines whether the original reply-to address of the command message
+     * contained the device id.
+     */
+    private static final byte FLAG_REPLY_TO_CONTAINED_DEVICE_ID = 1;
+
     /**
      * If present, the command is invalid.
      */
@@ -349,14 +355,45 @@ public final class Command {
             return null;
         }
 
-        final String stringOne = Optional.ofNullable(correlationId).orElse("");
-        String stringTwo = Optional.ofNullable(replyToId).orElse("");
-        final boolean removeDeviceFromReplyTo = stringTwo.startsWith(deviceId + "/");
-        if (removeDeviceFromReplyTo) {
-            stringTwo = stringTwo.substring(deviceId.length() + 1);
+        final String correlationIdOrEmpty = Optional.ofNullable(correlationId).orElse("");
+        String replyToIdWithoutDeviceOrEmpty = Optional.ofNullable(replyToId).orElse("");
+        final boolean replyToContainedDeviceId = replyToIdWithoutDeviceOrEmpty.startsWith(deviceId + "/");
+        if (replyToContainedDeviceId) {
+            replyToIdWithoutDeviceOrEmpty = replyToIdWithoutDeviceOrEmpty.substring(deviceId.length() + 1);
         }
-        return String.format("%s%02x%s%s", removeDeviceFromReplyTo ? "1" : "0", stringOne.length(), stringOne,
-                stringTwo);
+        return String.format("%s%02x%s%s", encodeReplyToOptions(replyToContainedDeviceId), correlationIdOrEmpty.length(),
+                correlationIdOrEmpty, replyToIdWithoutDeviceOrEmpty);
+    }
+
+    /**
+     * Encodes the given boolean parameters related to the original reply-to address of the command message as a single
+     * digit string.
+     * 
+     * @param replyToContainedDeviceId Whether the original reply-to address of the command message contained the device
+     *            id.
+     * @return The encoded options as a single digit string.
+     */
+    static String encodeReplyToOptions(final boolean replyToContainedDeviceId) {
+        int bitFlag = 0;
+        if (replyToContainedDeviceId) {
+            bitFlag |= FLAG_REPLY_TO_CONTAINED_DEVICE_ID;
+        }
+        return String.valueOf(bitFlag);
+    }
+
+    /**
+     * Checks if the original reply-to address of the command message contained the device id.
+     *
+     * @param replyToOptionsBitFlag The bit flag returned by {@link #encodeReplyToOptions(boolean)}.
+     * @return Whether the original reply-to address of the command message contained the device id.
+     * @throws NumberFormatException If the given replyToOptionsBitFlag can't be parsed as an integer.
+     */
+    static boolean isReplyToContainedDeviceIdOptionSet(final String replyToOptionsBitFlag) {
+        return decodeReplyToOption(replyToOptionsBitFlag, FLAG_REPLY_TO_CONTAINED_DEVICE_ID);
+    }
+
+    private static boolean decodeReplyToOption(final String replyToOptionsBitFlag, final byte optionBitConstant) {
+        return (Integer.parseInt(replyToOptionsBitFlag) & optionBitConstant) == optionBitConstant;
     }
 
     @Override
@@ -373,18 +410,17 @@ public final class Command {
      * Gets the reply-to-id that will be set when forwarding the command to the device.
      * <p>
      * It is ensured that this id starts with the device id.
-     * <p>
-     * See {@link CommandResponse#getReplyToId(ResourceIdentifier)} for the conversion in the opposite direction.
      *
      * @param replyToId The reply-to-id as extracted from the 'reply-to' of the command AMQP message. Potentially not
      *            containing the device id.
      * @param deviceId The device id.
      * @return The reply-to-id, starting with the device id.
      */
-    static String getDeviceFacingReplyToId(final String replyToId, final String deviceId) {
-        if (replyToId.startsWith(deviceId + "/")) {
-            return replyToId.replaceFirst(deviceId + "/", deviceId + "/0");
-        }
-        return String.format("%s/1%s", deviceId, replyToId);
+    public static String getDeviceFacingReplyToId(final String replyToId, final String deviceId) {
+        final boolean replyToContainedDeviceId = replyToId.startsWith(deviceId + "/");
+        final String replyToIdWithoutDeviceId = replyToContainedDeviceId ? replyToId.substring(deviceId.length() + 1)
+                : replyToId;
+        final String bitFlagString = encodeReplyToOptions(replyToContainedDeviceId);
+        return String.format("%s/%s%s", deviceId, bitFlagString, replyToIdWithoutDeviceId);
     }
 }
diff --git a/client/src/main/java/org/eclipse/hono/client/CommandResponse.java b/client/src/main/java/org/eclipse/hono/client/CommandResponse.java
index 08315730f..c3d0eebd1 100644
--- a/client/src/main/java/org/eclipse/hono/client/CommandResponse.java
+++ b/client/src/main/java/org/eclipse/hono/client/CommandResponse.java
@@ -88,7 +88,8 @@ public final class CommandResponse {
             return null;
         } else {
             try {
-                final boolean addDeviceIdToReply = "1".equals(requestId.substring(0, 1));
+                final String replyToOptionsBitFlag = requestId.substring(0, 1);
+                final boolean addDeviceIdToReply = Command.isReplyToContainedDeviceIdOptionSet(replyToOptionsBitFlag);
                 final int lengthStringOne = Integer.parseInt(requestId.substring(1, 3), 16);
                 final String replyId = requestId.substring(3 + lengthStringOne);
                 return new CommandResponse(
@@ -183,14 +184,18 @@ public final class CommandResponse {
      *
      * @param resource The command response resource string.
      * @return The reply-to-id.
+     * @throws IllegalArgumentException If the given resource has an invalid format.
      */
     static String getReplyToId(final ResourceIdentifier resource) {
         final String deviceId = resource.getResourceId();
         final String pathWithoutBase = resource.getPathWithoutBase();
-        if (pathWithoutBase.startsWith(deviceId + "/1")) {
-            return pathWithoutBase.replaceFirst(deviceId + "/1", "");
-        } else {
-            return pathWithoutBase.replaceFirst(deviceId + "/0", deviceId + "/");
+        if (pathWithoutBase.length() < deviceId.length() + 3) {
+            throw new IllegalArgumentException("invalid resource length");
         }
+        // pathWithoutBase starts with deviceId/[bit flag]
+        final String replyToOptionsBitFlag = pathWithoutBase.substring(deviceId.length() + 1, deviceId.length() + 2);
+        final boolean replyToContainedDeviceId = Command.isReplyToContainedDeviceIdOptionSet(replyToOptionsBitFlag);
+        return pathWithoutBase.replaceFirst(deviceId + "/" + replyToOptionsBitFlag,
+                replyToContainedDeviceId ? deviceId + "/" : "");
     }
 }
diff --git a/client/src/test/java/org/eclipse/hono/client/CommandResponseTest.java b/client/src/test/java/org/eclipse/hono/client/CommandResponseTest.java
index 2794494c1..730cf8cf6 100644
--- a/client/src/test/java/org/eclipse/hono/client/CommandResponseTest.java
+++ b/client/src/test/java/org/eclipse/hono/client/CommandResponseTest.java
@@ -17,8 +17,6 @@ import static org.junit.Assert.*;
 import static org.hamcrest.CoreMatchers.*;
 
 import java.net.HttpURLConnection;
-import java.util.HashMap;
-import java.util.Map;
 
 import io.vertx.proton.ProtonHelper;
 import org.apache.qpid.proton.message.Message;
@@ -60,10 +58,10 @@ public class CommandResponseTest {
 
     /**
      * Verifies that creating a response from a request ID which does not contain a hex encoded byte
-     * at the start position fails.
+     * at the second position fails.
      */
     @Test
-    public void testFromFailsForMalformedRequestId() {
+    public void testFromFailsForRequestIdWithMalformedLengthPart() {
 
         // make sure we succeed with a valid length string
         final CommandResponse resp = CommandResponse.from(
@@ -80,6 +78,28 @@ public class CommandResponseTest {
         assertNull(CommandResponse.from("0ZZanyString", TENANT_ID, DEVICE_ID, null, null, HttpURLConnection.HTTP_OK));
     }
 
+    /**
+     * Verifies that creating a response from a request ID which does not contain a single digit
+     * at the start position fails.
+     */
+    @Test
+    public void testFromFailsForRequestIdWithMalformedReplyIdOptionBitsPart() {
+
+        // make sure we succeed with a valid length string
+        final CommandResponse resp = CommandResponse.from(
+                "003anyString",
+                TENANT_ID,
+                DEVICE_ID,
+                null,
+                null,
+                HttpURLConnection.HTTP_OK);
+        assertNotNull(resp.toMessage());
+        assertThat(resp.toMessage().getCorrelationId(), is("any"));
+        assertThat(resp.getReplyToId(), is("String"));
+
+        assertNull(CommandResponse.from("Z03anyString", TENANT_ID, DEVICE_ID, null, null, HttpURLConnection.HTTP_OK));
+    }
+
     /**
      * Verifies that creating a response for an invalid status code fails.
      */
@@ -108,7 +128,7 @@ public class CommandResponseTest {
      * by the hex encoded byte at the start position fails.
      */
     @Test
-    public void testFailsForIncorrectCorrelationIdLength() {
+    public void testFromFailsForIncorrectCorrelationIdLength() {
 
         final String id = "thisIsLessThan255Characters";
         // make sure we succeed with valid length
@@ -164,9 +184,11 @@ public class CommandResponseTest {
      */
     @Test
     public void testForDeviceIdInReplyToId() {
+        final boolean replyToContainedDeviceId = true;
+        final String replyToOptionsBitFlag = Command.encodeReplyToOptions(replyToContainedDeviceId);
         final Message message = ProtonHelper.message();
         message.setAddress(ResourceIdentifier
-                .from("control", TENANT_ID, String.format("%s/0rid-1", DEVICE_ID)).toString());
+                .from("control", TENANT_ID, String.format("%s/%srid-1", DEVICE_ID, replyToOptionsBitFlag)).toString());
         message.setCorrelationId(CORRELATION_ID);
         MessageHelper.addProperty(message, MessageHelper.APP_PROPERTY_STATUS, HttpURLConnection.HTTP_OK);
         final CommandResponse response = CommandResponse.from(message);
@@ -174,14 +196,121 @@ public class CommandResponseTest {
         assertThat(response.getReplyToId(), is("4711/rid-1"));
     }
 
+    /**
+     * Verifies that creating a response fails for a message with no correlation id.
+     */
+    @Test
+    public void testFromMessageFailsForMissingCorrelationId() {
+        final boolean replyToContainedDeviceId = true;
+        final String replyToOptionsBitFlag = Command.encodeReplyToOptions(replyToContainedDeviceId);
+        final Message message = ProtonHelper.message();
+        message.setAddress(ResourceIdentifier
+                .from("control", TENANT_ID, String.format("%s/%srid-1", DEVICE_ID, replyToOptionsBitFlag)).toString());
+        MessageHelper.addProperty(message, MessageHelper.APP_PROPERTY_STATUS, HttpURLConnection.HTTP_OK);
+        final CommandResponse response = CommandResponse.from(message);
+        assertThat(response, nullValue());
+    }
+
+    /**
+     * Verifies that creating a response fails for a message with no address set.
+     */
+    @Test
+    public void testFromMessageFailsForMissingAddress() {
+        final Message message = ProtonHelper.message();
+        message.setCorrelationId(CORRELATION_ID);
+        MessageHelper.addProperty(message, MessageHelper.APP_PROPERTY_STATUS, HttpURLConnection.HTTP_OK);
+        final CommandResponse response = CommandResponse.from(message);
+        assertThat(response, nullValue());
+    }
+
+    /**
+     * Verifies that creating a response fails for a message with no status property.
+     */
+    @Test
+    public void testFromMessageFailsForMissingStatus() {
+        final boolean replyToContainedDeviceId = true;
+        final String replyToOptionsBitFlag = Command.encodeReplyToOptions(replyToContainedDeviceId);
+        final Message message = ProtonHelper.message();
+        message.setAddress(ResourceIdentifier
+                .from("control", TENANT_ID, String.format("%s/%srid-1", DEVICE_ID, replyToOptionsBitFlag)).toString());
+        message.setCorrelationId(CORRELATION_ID);
+        final CommandResponse response = CommandResponse.from(message);
+        assertThat(response, nullValue());
+    }
+
+    /**
+     * Verifies that creating a response fails for a message with status property containing an invalid value.
+     */
+    @Test
+    public void testFromMessageFailsForInvalidStatus() {
+        final boolean replyToContainedDeviceId = true;
+        final String replyToOptionsBitFlag = Command.encodeReplyToOptions(replyToContainedDeviceId);
+        final Message message = ProtonHelper.message();
+        message.setAddress(ResourceIdentifier
+                .from("control", TENANT_ID, String.format("%s/%srid-1", DEVICE_ID, replyToOptionsBitFlag)).toString());
+        message.setCorrelationId(CORRELATION_ID);
+        MessageHelper.addProperty(message, MessageHelper.APP_PROPERTY_STATUS, 777);
+        final CommandResponse response = CommandResponse.from(message);
+        assertThat(response, nullValue());
+    }
+
+    /**
+     * Verifies that creating a response fails for a message with an invalid address, containing nothing behind the
+     * device id part.
+     */
+    @Test
+    public void testFromMessageFailsForInvalidAddressWithNothingBehindDeviceId() {
+        final Message message = ProtonHelper.message();
+        // use address with an invalid resource id part (nothing behind the device id)
+        message.setAddress(ResourceIdentifier.from("control", TENANT_ID, DEVICE_ID).toString());
+        message.setCorrelationId(CORRELATION_ID);
+        MessageHelper.addProperty(message, MessageHelper.APP_PROPERTY_STATUS, HttpURLConnection.HTTP_OK);
+        final CommandResponse response = CommandResponse.from(message);
+        assertThat(response, nullValue());
+    }
+
+    /**
+     * Verifies that creating a response fails for a message with an invalid address, ending with the replyToOptions bit.
+     */
+    @Test
+    public void testFromMessageFailsForInvalidAddressWithOnlyReplyToOptionsBit() {
+        final boolean replyToContainedDeviceId = true;
+        final String replyToOptionsBitFlag = Command.encodeReplyToOptions(replyToContainedDeviceId);
+        final Message message = ProtonHelper.message();
+        message.setAddress(ResourceIdentifier
+                .from("control", TENANT_ID, String.format("%s/%s", DEVICE_ID, replyToOptionsBitFlag)).toString());
+        message.setCorrelationId(CORRELATION_ID);
+        MessageHelper.addProperty(message, MessageHelper.APP_PROPERTY_STATUS, HttpURLConnection.HTTP_OK);
+        final CommandResponse response = CommandResponse.from(message);
+        assertThat(response, nullValue());
+    }
+
+    /**
+     * Verifies that creating a response fails for a message with an invalid address, containing an invalid
+     * replyToOptions bit.
+     */
+    @Test
+    public void testFromMessageFailsForInvalidAddressWithWrongReplyToOptionsBit() {
+        final String replyToOptionsBitFlag = "X"; // invalid value to test with
+        final Message message = ProtonHelper.message();
+        message.setAddress(ResourceIdentifier
+                .from("control", TENANT_ID, String.format("%s/%srid-1", DEVICE_ID, replyToOptionsBitFlag)).toString());
+        message.setCorrelationId(CORRELATION_ID);
+        MessageHelper.addProperty(message, MessageHelper.APP_PROPERTY_STATUS, HttpURLConnection.HTTP_OK);
+        final CommandResponse response = CommandResponse.from(message);
+        assertThat(response, nullValue());
+    }
+
     /**
      * Verifies that the device-id is not part of the reply-to-id.
      */
     @Test
     public void testForNoDeviceIdInReplyToId() {
+        final boolean replyToContainedDeviceId = false;
+        final String replyToOptionsBitFlag = Command.encodeReplyToOptions(replyToContainedDeviceId);
         final Message message = ProtonHelper.message();
         message.setAddress(ResourceIdentifier
-                .from("control", TENANT_ID, String.format("%s/1rid-1", DEVICE_ID)).toString());
+                .from("control", TENANT_ID, String.format("%s/%srid-1", DEVICE_ID, replyToOptionsBitFlag)).toString());
         message.setCorrelationId(CORRELATION_ID);
         MessageHelper.addProperty(message, MessageHelper.APP_PROPERTY_STATUS, HttpURLConnection.HTTP_OK);
         final CommandResponse response = CommandResponse.from(message);
@@ -190,13 +319,10 @@ public class CommandResponseTest {
     }
 
     /**
-     * Verifies that the tenant and device ids are present in the properties.
+     * Verifies that the tenant and device ids are present in the response message.
      */
     @Test
     public void testForDeviceAndTenantIds() {
-        final Map<String, Object> properties = new HashMap<>();
-        properties.put("testKey1", "testValue1");
-        properties.put("testKey2", "testValue2");
         final CommandResponse response = CommandResponse.from(
                 Command.getRequestId(CORRELATION_ID, REPLY_TO_ID, DEVICE_ID),
                 TENANT_ID,
diff --git a/client/src/test/java/org/eclipse/hono/client/CommandTest.java b/client/src/test/java/org/eclipse/hono/client/CommandTest.java
index 8e4ffe526..975739986 100644
--- a/client/src/test/java/org/eclipse/hono/client/CommandTest.java
+++ b/client/src/test/java/org/eclipse/hono/client/CommandTest.java
@@ -54,14 +54,15 @@ public class CommandTest {
         message.setCorrelationId(correlationId);
         message.setReplyTo(String.format("%s/%s/%s/%s",
                 CommandConstants.COMMAND_ENDPOINT, Constants.DEFAULT_TENANT, "4711", replyToId));
+        final String replyToOptionsBitFlag = Command.encodeReplyToOptions(true);
         final Command cmd = Command.from(message, Constants.DEFAULT_TENANT, "4711");
         assertTrue(cmd.isValid());
         assertThat(cmd.getName(), is("doThis"));
         assertThat(cmd.getReplyToId(), is(String.format("4711/%s", replyToId)));
         assertThat(cmd.getCorrelationId(), is(correlationId));
         assertFalse(cmd.isOneWay());
-        assertThat(cmd.getCommandMessage().getReplyTo(), is(String.format("%s/%s/%s/0%s",
-                CommandConstants.COMMAND_ENDPOINT, Constants.DEFAULT_TENANT, "4711", replyToId)));
+        assertThat(cmd.getCommandMessage().getReplyTo(), is(String.format("%s/%s/%s/%s%s",
+                CommandConstants.COMMAND_ENDPOINT, Constants.DEFAULT_TENANT, "4711", replyToOptionsBitFlag, replyToId)));
     }
 
     /**
@@ -77,13 +78,14 @@ public class CommandTest {
         message.setCorrelationId(correlationId);
         message.setReplyTo(String.format("%s/%s/%s",
                 CommandConstants.COMMAND_ENDPOINT, Constants.DEFAULT_TENANT, replyToId));
+        final String replyToOptionsBitFlag = Command.encodeReplyToOptions(false);
         final Command cmd = Command.from(message, Constants.DEFAULT_TENANT, "4711");
         assertTrue(cmd.isValid());
         assertThat(cmd.getReplyToId(), is(replyToId));
         assertNotNull(cmd.getCommandMessage());
         assertNotNull(cmd.getCommandMessage().getReplyTo());
-        assertThat(cmd.getCommandMessage().getReplyTo(), is(String.format("%s/%s/%s/1%s",
-                CommandConstants.COMMAND_ENDPOINT, Constants.DEFAULT_TENANT, "4711", replyToId)));
+        assertThat(cmd.getCommandMessage().getReplyTo(), is(String.format("%s/%s/%s/%s%s",
+                CommandConstants.COMMAND_ENDPOINT, Constants.DEFAULT_TENANT, "4711", replyToOptionsBitFlag, replyToId)));
     }
 
     /**
@@ -99,13 +101,14 @@ public class CommandTest {
         message.setCorrelationId(correlationId);
         message.setReplyTo(String.format("%s/%s/%s/%s",
                 CommandConstants.COMMAND_ENDPOINT, Constants.DEFAULT_TENANT, "4711", replyToId));
+        final String replyToOptionsBitFlag = Command.encodeReplyToOptions(true);
         final Command cmd = Command.from(message, Constants.DEFAULT_TENANT, "4711");
         assertTrue(cmd.isValid());
         assertThat(cmd.getReplyToId(), is(String.format("4711/%s", replyToId)));
         assertNotNull(cmd.getCommandMessage());
         assertNotNull(cmd.getCommandMessage().getReplyTo());
-        assertThat(cmd.getCommandMessage().getReplyTo(), is(String.format("%s/%s/%s/0%s",
-                CommandConstants.COMMAND_ENDPOINT, Constants.DEFAULT_TENANT, "4711", replyToId)));
+        assertThat(cmd.getCommandMessage().getReplyTo(), is(String.format("%s/%s/%s/%s%s",
+                CommandConstants.COMMAND_ENDPOINT, Constants.DEFAULT_TENANT, "4711", replyToOptionsBitFlag, replyToId)));
     }
 
     /**
@@ -228,4 +231,18 @@ public class CommandTest {
         assertThat(command.getInvalidCommandReason(), containsString("message/correlation-id"));
         assertThat(command.getInvalidCommandReason(), containsString("reply-to"));
     }
+
+    /**
+     * Verifies the correct encoding and decoding of the bit flag with options relating to the reply-to address.
+     */
+    @Test
+    public void testEncodeDecodeReplyToOptions() {
+        final boolean replyToContainedDeviceId = false;
+        final String replyToOptionsBitFlag = Command.encodeReplyToOptions(replyToContainedDeviceId);
+        assertThat(Command.isReplyToContainedDeviceIdOptionSet(replyToOptionsBitFlag), is(replyToContainedDeviceId));
+
+        final boolean replyToContainedDeviceId2 = true;
+        final String replyToOptions2 = Command.encodeReplyToOptions(replyToContainedDeviceId2);
+        assertThat(Command.isReplyToContainedDeviceIdOptionSet(replyToOptions2), is(replyToContainedDeviceId2));
+    }
 }
