{"url":"https://api.github.com/repos/assertj/assertj/issues/2067","repository_url":"https://api.github.com/repos/assertj/assertj","labels_url":"https://api.github.com/repos/assertj/assertj/issues/2067/labels{/name}","comments_url":"https://api.github.com/repos/assertj/assertj/issues/2067/comments","events_url":"https://api.github.com/repos/assertj/assertj/issues/2067/events","html_url":"https://github.com/assertj/assertj/issues/2067","id":760935679,"node_id":"MDU6SXNzdWU3NjA5MzU2Nzk=","number":2067,"title":"Too much stack trace removed for failure in a utility method","user":{"login":"kriegfrj","id":7224087,"node_id":"MDQ6VXNlcjcyMjQwODc=","avatar_url":"https://avatars.githubusercontent.com/u/7224087?v=4","gravatar_id":"","url":"https://api.github.com/users/kriegfrj","html_url":"https://github.com/kriegfrj","followers_url":"https://api.github.com/users/kriegfrj/followers","following_url":"https://api.github.com/users/kriegfrj/following{/other_user}","gists_url":"https://api.github.com/users/kriegfrj/gists{/gist_id}","starred_url":"https://api.github.com/users/kriegfrj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kriegfrj/subscriptions","organizations_url":"https://api.github.com/users/kriegfrj/orgs","repos_url":"https://api.github.com/users/kriegfrj/repos","events_url":"https://api.github.com/users/kriegfrj/events{/privacy}","received_events_url":"https://api.github.com/users/kriegfrj/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":{"login":"joel-costigliola","id":382613,"node_id":"MDQ6VXNlcjM4MjYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/382613?v=4","gravatar_id":"","url":"https://api.github.com/users/joel-costigliola","html_url":"https://github.com/joel-costigliola","followers_url":"https://api.github.com/users/joel-costigliola/followers","following_url":"https://api.github.com/users/joel-costigliola/following{/other_user}","gists_url":"https://api.github.com/users/joel-costigliola/gists{/gist_id}","starred_url":"https://api.github.com/users/joel-costigliola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joel-costigliola/subscriptions","organizations_url":"https://api.github.com/users/joel-costigliola/orgs","repos_url":"https://api.github.com/users/joel-costigliola/repos","events_url":"https://api.github.com/users/joel-costigliola/events{/privacy}","received_events_url":"https://api.github.com/users/joel-costigliola/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"joel-costigliola","id":382613,"node_id":"MDQ6VXNlcjM4MjYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/382613?v=4","gravatar_id":"","url":"https://api.github.com/users/joel-costigliola","html_url":"https://github.com/joel-costigliola","followers_url":"https://api.github.com/users/joel-costigliola/followers","following_url":"https://api.github.com/users/joel-costigliola/following{/other_user}","gists_url":"https://api.github.com/users/joel-costigliola/gists{/gist_id}","starred_url":"https://api.github.com/users/joel-costigliola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joel-costigliola/subscriptions","organizations_url":"https://api.github.com/users/joel-costigliola/orgs","repos_url":"https://api.github.com/users/joel-costigliola/repos","events_url":"https://api.github.com/users/joel-costigliola/events{/privacy}","received_events_url":"https://api.github.com/users/joel-costigliola/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/assertj/assertj/milestones/63","html_url":"https://github.com/assertj/assertj/milestone/63","labels_url":"https://api.github.com/repos/assertj/assertj/milestones/63/labels","id":7421574,"node_id":"MI_kwDOAIX3Vs4AcT6G","number":63,"title":"3.23.0","description":"","creator":{"login":"scordio","id":26772046,"node_id":"MDQ6VXNlcjI2NzcyMDQ2","avatar_url":"https://avatars.githubusercontent.com/u/26772046?v=4","gravatar_id":"","url":"https://api.github.com/users/scordio","html_url":"https://github.com/scordio","followers_url":"https://api.github.com/users/scordio/followers","following_url":"https://api.github.com/users/scordio/following{/other_user}","gists_url":"https://api.github.com/users/scordio/gists{/gist_id}","starred_url":"https://api.github.com/users/scordio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scordio/subscriptions","organizations_url":"https://api.github.com/users/scordio/orgs","repos_url":"https://api.github.com/users/scordio/repos","events_url":"https://api.github.com/users/scordio/events{/privacy}","received_events_url":"https://api.github.com/users/scordio/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":34,"state":"closed","created_at":"2021-11-23T09:28:57Z","updated_at":"2024-04-17T06:38:09Z","due_on":"2022-04-30T07:00:00Z","closed_at":"2022-05-31T17:11:02Z"},"comments":12,"created_at":"2020-12-10T05:59:21Z","updated_at":"2022-04-03T05:23:19Z","closed_at":"2022-04-03T05:23:18Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### Summary\r\n\r\nI am using soft assertions with a custom soft assertions provider (though I'm not sure if the custom provider is a relevant point). I had an `AssertJMultipleFailuresError` that only contained one error. Unfortunately, the stack trace for the code where the original assertion failed seems to have been removed.\r\n\r\nThe problem seems to be that the soft assertion is thrown in a utility method within the same class, and not the original test method. This is possibly confusing the code that attempts to tidy-up the stack trace (which I believe has been altered recently).\r\n\r\n#### Example\r\n\r\n```\r\norg.assertj.core.error.AssertJMultipleFailuresError: \r\nMultiple Failures (1 failure)\r\n-- failure 1 --\r\n[result] \r\nExpecting:\r\n <\"@OK@ Transaction message #1722379596: [field name]: this is a description: this is a much longer description\">\r\nto contain:\r\n <\"0\"> \r\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance0(Native Method)\r\n\tat java.base/jdk.internal.reflect.NativeConstructorAccessorImpl.newInstance(NativeConstructorAccessorImpl.java:62)\r\n\tat java.base/jdk.internal.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)\r\n```\r\n\r\nClearly, the assertion was not raised in the JDK code! The code that caused the above looked something like this:\r\n\r\n```java\r\n@InjectSoftAssertions \r\nSoftAssertions softly;\r\n\r\n@Test \r\nvoid topLevelTest1() {\r\n  // Do configuration specific to \"topLevelTest1()\" here\r\n\r\n  // Run the common code along with the common sanity checks\r\n  String result  = doCommonStuff();\r\n\r\n  // Do assertions specific to \"topLevelTest1()\" here\r\n  softly.assertThat(result).contains(\"topLevelTest1 message\");\r\n}\r\n\r\n@Test \r\nString doCommonStuff() {\r\n  String result;\r\n  // Do common tasks here (eg, make the web request)\r\n\r\n  // Now do common assertions - this is the one that fails\r\n  softly.assertThat(result).as(\"result\").contains(\"@OK@\");\r\n}\r\n```\r\n\r\nAs noted in the comment in my pseudo-code, it is that soft assertion in `doCommonStuff()` that actually failed. Yet all... errm... \"trace\" of it (pun intended) has been removed from the stack trace in the reported soft assertion failure.\r\n\r\nThis is a bit of an inconvenience - I miss being able to click on the stack trace and get taken straight to the line in the code where the failure happened. I also think (but I'm not 100% sure) that this is a regression - this problem didn't always used to happen (I'm sure I would have noticed it before now if that were the case). I think I remember first seeing it in 3.18.1.","closed_by":{"login":"joel-costigliola","id":382613,"node_id":"MDQ6VXNlcjM4MjYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/382613?v=4","gravatar_id":"","url":"https://api.github.com/users/joel-costigliola","html_url":"https://github.com/joel-costigliola","followers_url":"https://api.github.com/users/joel-costigliola/followers","following_url":"https://api.github.com/users/joel-costigliola/following{/other_user}","gists_url":"https://api.github.com/users/joel-costigliola/gists{/gist_id}","starred_url":"https://api.github.com/users/joel-costigliola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joel-costigliola/subscriptions","organizations_url":"https://api.github.com/users/joel-costigliola/orgs","repos_url":"https://api.github.com/users/joel-costigliola/repos","events_url":"https://api.github.com/users/joel-costigliola/events{/privacy}","received_events_url":"https://api.github.com/users/joel-costigliola/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/assertj/assertj/issues/2067/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/assertj/assertj/issues/2067/timeline","performed_via_github_app":null,"state_reason":"completed"}