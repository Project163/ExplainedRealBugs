{"url":"https://api.github.com/repos/assertj/assertj/issues/1970","repository_url":"https://api.github.com/repos/assertj/assertj","labels_url":"https://api.github.com/repos/assertj/assertj/issues/1970/labels{/name}","comments_url":"https://api.github.com/repos/assertj/assertj/issues/1970/comments","events_url":"https://api.github.com/repos/assertj/assertj/issues/1970/events","html_url":"https://github.com/assertj/assertj/issues/1970","id":682431694,"node_id":"MDU6SXNzdWU2ODI0MzE2OTQ=","number":1970,"title":"Softly/SoftAssertionsExtension revamp","user":{"login":"kriegfrj","id":7224087,"node_id":"MDQ6VXNlcjcyMjQwODc=","avatar_url":"https://avatars.githubusercontent.com/u/7224087?v=4","gravatar_id":"","url":"https://api.github.com/users/kriegfrj","html_url":"https://github.com/kriegfrj","followers_url":"https://api.github.com/users/kriegfrj/followers","following_url":"https://api.github.com/users/kriegfrj/following{/other_user}","gists_url":"https://api.github.com/users/kriegfrj/gists{/gist_id}","starred_url":"https://api.github.com/users/kriegfrj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kriegfrj/subscriptions","organizations_url":"https://api.github.com/users/kriegfrj/orgs","repos_url":"https://api.github.com/users/kriegfrj/repos","events_url":"https://api.github.com/users/kriegfrj/events{/privacy}","received_events_url":"https://api.github.com/users/kriegfrj/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/assertj/assertj/milestones/53","html_url":"https://github.com/assertj/assertj/milestone/53","labels_url":"https://api.github.com/repos/assertj/assertj/milestones/53/labels","id":5784375,"node_id":"MDk6TWlsZXN0b25lNTc4NDM3NQ==","number":53,"title":"3.18.0","description":null,"creator":{"login":"joel-costigliola","id":382613,"node_id":"MDQ6VXNlcjM4MjYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/382613?v=4","gravatar_id":"","url":"https://api.github.com/users/joel-costigliola","html_url":"https://github.com/joel-costigliola","followers_url":"https://api.github.com/users/joel-costigliola/followers","following_url":"https://api.github.com/users/joel-costigliola/following{/other_user}","gists_url":"https://api.github.com/users/joel-costigliola/gists{/gist_id}","starred_url":"https://api.github.com/users/joel-costigliola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joel-costigliola/subscriptions","organizations_url":"https://api.github.com/users/joel-costigliola/orgs","repos_url":"https://api.github.com/users/joel-costigliola/repos","events_url":"https://api.github.com/users/joel-costigliola/events{/privacy}","received_events_url":"https://api.github.com/users/joel-costigliola/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":18,"state":"closed","created_at":"2020-08-18T10:46:52Z","updated_at":"2020-10-25T11:50:05Z","due_on":null,"closed_at":"2020-10-25T11:50:05Z"},"comments":8,"created_at":"2020-08-20T05:43:34Z","updated_at":"2020-09-20T02:56:56Z","closed_at":"2020-09-20T02:56:56Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I have a number of suggestions regarding these two extensions that I wanted to float - they could be done as separate issues but they are tightly coupled so I'm going to include them in one issue for now and we can split them up later if you feel that this is appropriate.\r\n\r\n## SoftlyExtension doesn't support custom SoftAssertionsProvider\r\n\r\nI find the field-injection style of `SoftlyExtension` much preferable to parameter injections. Not only does it simplify the method signatures of the tests, but you can easily have common methods that can perform a common set of (soft) assertions on some objects without having to pass the `SoftAssertions` reference around. I find that in many of my `SoftAssertionExtension` implementations, I have a line at the top of them all that says \"this.softly = softly\", which is boilerplate code polluting every test. The alternative is to declare `SoftAssertions` as a parameter to all of the common methods too, which is even less attractive.\r\n\r\nHowever, `SoftlyExtension` has the drawback that it is hard-coded to use `SoftAssertions`. This means you miss out on the ability to use \r\n\r\n## Combine SoftlyExtension and SoftAssertionsExtension\r\n\r\nIn osgi-test, we've settled upon a pattern of extensions that support both field and parameter injection. This allows them to make use of common code (eg, instantiating the object to be injected) and it makes it easier for the user as they don't have to make a special effort to remember which one to use.\r\n\r\nI can't see any good reason not to merge these two, but perhaps someone else can. Failing that, I suggest that we merge them (which will go a significant part of the way to solving the first point). Given that `SoftAssertionsExtension` has been around longer, I'm going to suggest merging `SoftlyExtension` into it and then deprecating `SoftlyExtension`.\r\n\r\n## Adding API for third-party extensions\r\n\r\nIf you're using multiple soft assertion-type libraries, it is nice if you can combine the two into a common \"multiple failure\". This was the thrust behind #1459.\r\n\r\n@fduminy came up with a novel way to combine it with Mockito soft verification (see https://github.com/fduminy/assertj-mockito). The only problem with this implementation is that it relies on what is effectively private API of `SoftAssertionsExtension` to work, as it maintains its own copy of has to reach into the extension context and peek into `SoftAssertionExtension`'s private store to get the current soft assertion instance to re-use. It would be nice if this aspect of it was publicised so that `AssertJMockitoExtension` and other 3rd-party extensions can get access to the soft assertion object for the current context.\r\n\r\nIn osgi-test, we hit upon the idea of using a public static method that takes an `ExtensionContext` as a parameter, which is responsible for fetching the object from the store (and creating it if necessary). It is possible to use a static method because the extensions themselves are stateless (or supposed to be, anyway!) and store all of their state in the `ExtensionContext`.\r\n\r\nIt would be nice if these extensions offered the same ability, which would help clean up code like `AssertJMockitoExtension`. If we merge the two extensions, this will only need to be done once - if we do not merge them, then we could consider making one depend on the other's public static initalisation method (which would go part way to solving the first point too).\r\n","closed_by":{"login":"joel-costigliola","id":382613,"node_id":"MDQ6VXNlcjM4MjYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/382613?v=4","gravatar_id":"","url":"https://api.github.com/users/joel-costigliola","html_url":"https://github.com/joel-costigliola","followers_url":"https://api.github.com/users/joel-costigliola/followers","following_url":"https://api.github.com/users/joel-costigliola/following{/other_user}","gists_url":"https://api.github.com/users/joel-costigliola/gists{/gist_id}","starred_url":"https://api.github.com/users/joel-costigliola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joel-costigliola/subscriptions","organizations_url":"https://api.github.com/users/joel-costigliola/orgs","repos_url":"https://api.github.com/users/joel-costigliola/repos","events_url":"https://api.github.com/users/joel-costigliola/events{/privacy}","received_events_url":"https://api.github.com/users/joel-costigliola/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/assertj/assertj/issues/1970/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/assertj/assertj/issues/1970/timeline","performed_via_github_app":null,"state_reason":"completed"}