{"url":"https://api.github.com/repos/assertj/assertj/issues/2979","repository_url":"https://api.github.com/repos/assertj/assertj","labels_url":"https://api.github.com/repos/assertj/assertj/issues/2979/labels{/name}","comments_url":"https://api.github.com/repos/assertj/assertj/issues/2979/comments","events_url":"https://api.github.com/repos/assertj/assertj/issues/2979/events","html_url":"https://github.com/assertj/assertj/issues/2979","id":1619841739,"node_id":"I_kwDOAIX3Vs5gjNLL","number":2979,"title":"determineDifferences method of RecursiveComparisonDifferenceCalculator not able to compare the list of 100 objects","user":{"login":"amitnarula","id":8600403,"node_id":"MDQ6VXNlcjg2MDA0MDM=","avatar_url":"https://avatars.githubusercontent.com/u/8600403?v=4","gravatar_id":"","url":"https://api.github.com/users/amitnarula","html_url":"https://github.com/amitnarula","followers_url":"https://api.github.com/users/amitnarula/followers","following_url":"https://api.github.com/users/amitnarula/following{/other_user}","gists_url":"https://api.github.com/users/amitnarula/gists{/gist_id}","starred_url":"https://api.github.com/users/amitnarula/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/amitnarula/subscriptions","organizations_url":"https://api.github.com/users/amitnarula/orgs","repos_url":"https://api.github.com/users/amitnarula/repos","events_url":"https://api.github.com/users/amitnarula/events{/privacy}","received_events_url":"https://api.github.com/users/amitnarula/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":734184708,"node_id":"MDU6TGFiZWw3MzQxODQ3MDg=","url":"https://api.github.com/repos/assertj/assertj/labels/theme:%20recursive%20comparison","name":"theme: recursive comparison","color":"FEF2C0","default":false,"description":"An issue related to the recursive comparison"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/assertj/assertj/milestones/67","html_url":"https://github.com/assertj/assertj/milestone/67","labels_url":"https://api.github.com/repos/assertj/assertj/milestones/67/labels","id":8654259,"node_id":"MI_kwDOAIX3Vs4AhA2z","number":67,"title":"3.25.0","description":"","creator":{"login":"scordio","id":26772046,"node_id":"MDQ6VXNlcjI2NzcyMDQ2","avatar_url":"https://avatars.githubusercontent.com/u/26772046?v=4","gravatar_id":"","url":"https://api.github.com/users/scordio","html_url":"https://github.com/scordio","followers_url":"https://api.github.com/users/scordio/followers","following_url":"https://api.github.com/users/scordio/following{/other_user}","gists_url":"https://api.github.com/users/scordio/gists{/gist_id}","starred_url":"https://api.github.com/users/scordio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/scordio/subscriptions","organizations_url":"https://api.github.com/users/scordio/orgs","repos_url":"https://api.github.com/users/scordio/repos","events_url":"https://api.github.com/users/scordio/events{/privacy}","received_events_url":"https://api.github.com/users/scordio/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":77,"state":"closed","created_at":"2022-11-14T21:55:21Z","updated_at":"2024-01-02T23:13:09Z","due_on":null,"closed_at":"2023-12-31T16:16:47Z"},"comments":5,"created_at":"2023-03-11T02:17:00Z","updated_at":"2023-04-07T16:18:43Z","closed_at":"2023-04-07T16:18:42Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Trying to work with assertj-core [recursive comparison APIs](https://www.javadoc.io/static/org.assertj/assertj-core/3.13.2/org/assertj/core/api/recursive/comparison/RecursiveComparisonDifferenceCalculator.html#determineDifferences(java.lang.Object,java.lang.Object,org.assertj.core.api.recursive.comparison.RecursiveComparisonConfiguration)) for deep comparison between the objects as follows. But it appears that it doesn't work when we pass collections of custom objects for deep comparison when they are large in number for example even for 50 or 100, the comparison takes forever.\r\n\r\n**Let me share you the code chunks to look at.**\r\n\r\n* assertj core version: 3.24.2\r\n* java version: 11\r\n* test framework version: junit 4.13.1\r\n* os (if relevant): Windows 10 64 bit\r\n\r\n**Minimal/simplified code reproducing the bug**\r\n\r\nAssignment class\r\n```java\r\nclass Assignment\r\n{\r\n   String assignmentName;\r\n   String assignmentDescription;\r\n   \r\n   Assignment(String assignmentName, String assignmentDescription)\r\n   {\r\n     this.assignmentName = assignmentName;\r\n     this.assignmentDescription = assignmentDescription;\r\n   }\r\n}\r\n```\r\n\r\nOwner class\r\n```java\r\nclass Owner\r\n{\r\n   String id;\r\n   String name;\r\n   ArrayList<Assignment> assignments;\r\n\r\n   Owner(String id,String name, ArrayList<Assignment> assignments)\r\n   {\r\n      this.id = id;\r\n      this.name = name;\r\n      this.assignments = assignments;\r\n   }\r\n}\r\n```\r\n\r\nCode to generate a **single Assignment** object\r\n\r\n```java\r\npublic static Assignment GenerateAssignment()\r\n{\r\n    return new Assignment(\"111\", \"Assignment 1\");\r\n}\r\n```\r\n\r\n\r\nCode to generate **different** assignment object\r\n\r\n```java\r\npublic static Assignment GenerateDifferentAssignment()\r\n{\r\n    return new Assignment(\"222\", \"Assignment 2\");\r\n}\r\n```\r\n\r\nCode to generate list of Assignment objects\r\n\r\n```java\r\npublic static ArrayList<Assignment> GenerateListOfAssignments(Integer size)\r\n{\r\n    ArrayList<Assignment> lst = new ArrayList<Assignment>();\r\n    for(Integer i=0 ; i<size; i++)\r\n    {\r\n          lst.add(GenerateAssignment());\r\n    }\r\n    return lst;\r\n}\r\n```\r\n\r\nCode to generate **different** assignment objects\r\n\r\n```java\r\npublic static ArrayList<Assignment> GenerateDifferentListOfAssignments(Integer size)\r\n{\r\n    ArrayList<Assignment> lst = new ArrayList<Assignment>();\r\n    for(Integer i=0 ; i<size; i++)\r\n    {\r\n          lst.add(GenerateDifferentAssignment());\r\n    }\r\n   return lst;\r\n}\r\n```\r\n\r\nCode to generate an **Owner** object\r\n\r\n```java\r\npublic static Owner GenerateOwner(Integer numberOfAssignments)\r\n{\r\n     ArrayList<Assignment> lstAssignments = GenerateListOfAssignments(numberOfAssignments);\r\n     return new Owner(\"owner1\", \"TestOwner 1\", lstAssignments);\r\n}\r\n```\r\n\r\nCode to generate a **different** **Owner** object\r\n\r\n```java\r\npublic static Owner GenerateDifferentOwner(Integer numberOfAssignments)\r\n{\r\n     ArrayList<Assignment> lstAssignments = GenerateDifferentListOfAssignments(numberOfAssignments);\r\n     return new Owner(\"owner2\", \"TestOwner 2\", lstAssignments);\r\n}\r\n```\r\n\r\nCode to generate **list** of **Owners**\r\n\r\n```java\r\npublic static ArrayList<Owner> GenerateListOfOwners(Integer noOfOwners,  noOfAssignments)\r\n{\r\n    ArrayList<Owner> lstOwner = new ArrayList<Owner>();\r\n    for(Integer i=0 ; i<noOfOwners; i++)\r\n    {\r\n          lst.add(GenerateOwner(noOfAssignments));\r\n    }\r\n    return lstOwner;\r\n}\r\n```\r\n\r\nCode to generate a **different** list of **Owners**\r\n\r\n```java\r\npublic static ArrayList<Owner> GenerateDifferentListOwners(Integer noOfOwners,  noOfAssignments)\r\n{\r\n    ArrayList<Owner> lstOwner = new ArrayList<Owner>();\r\n    for(Integer i=0 ; i<noOfOwners; i++)\r\n    {\r\n          lst.add(GenerateDifferentOwner(noOfAssignments));\r\n    }\r\n    return lstOwner;\r\n}\r\n```\r\n\r\n**JUnit test**\r\n\r\n```java\r\n@Test\r\npublic static void DeepCompareCollections()\r\n{\r\n\r\n  //100 owners with 50 assignments each\r\n   ArrayList<Owner> actual = GenerateListOfOwners(100, 50);\r\n\r\n  //100 different owners with 50 different assignments each\r\n  ArrayList<Owner> expected = GeneratedDifferentListOfOwners(100, 50);\r\n\r\n   //Recursive comparison logic\r\n    var config = new RecursiveComparisonConfiguration();\r\n    config.ignoreCollectionOrder(true);\r\n    config.ignoreCollectionOrderInFields();\r\n\r\n   List<ComparisonDifference> difference = new RecursiveComparisonDifferenceCalculator().determineDifference(actual, expected, \r\nconfig);\r\n\r\n}\r\n```\r\n\r\n\r\nOnce you debug the test : DeepCompareCollections test as shown above , you will observe that the recursive comparison takes a lot of time to determine the difference between the two collections. We can adjust the number of owners and their corresponding assignments to observe the behavior further.","closed_by":{"login":"joel-costigliola","id":382613,"node_id":"MDQ6VXNlcjM4MjYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/382613?v=4","gravatar_id":"","url":"https://api.github.com/users/joel-costigliola","html_url":"https://github.com/joel-costigliola","followers_url":"https://api.github.com/users/joel-costigliola/followers","following_url":"https://api.github.com/users/joel-costigliola/following{/other_user}","gists_url":"https://api.github.com/users/joel-costigliola/gists{/gist_id}","starred_url":"https://api.github.com/users/joel-costigliola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joel-costigliola/subscriptions","organizations_url":"https://api.github.com/users/joel-costigliola/orgs","repos_url":"https://api.github.com/users/joel-costigliola/repos","events_url":"https://api.github.com/users/joel-costigliola/events{/privacy}","received_events_url":"https://api.github.com/users/joel-costigliola/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/assertj/assertj/issues/2979/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/assertj/assertj/issues/2979/timeline","performed_via_github_app":null,"state_reason":"completed"}