{"url":"https://api.github.com/repos/assertj/assertj/issues/2001","repository_url":"https://api.github.com/repos/assertj/assertj","labels_url":"https://api.github.com/repos/assertj/assertj/issues/2001/labels{/name}","comments_url":"https://api.github.com/repos/assertj/assertj/issues/2001/comments","events_url":"https://api.github.com/repos/assertj/assertj/issues/2001/events","html_url":"https://github.com/assertj/assertj/issues/2001","id":706007694,"node_id":"MDU6SXNzdWU3MDYwMDc2OTQ=","number":2001,"title":"AbstractAssert to add assertion factory methods","user":{"login":"kriegfrj","id":7224087,"node_id":"MDQ6VXNlcjcyMjQwODc=","avatar_url":"https://avatars.githubusercontent.com/u/7224087?v=4","gravatar_id":"","url":"https://api.github.com/users/kriegfrj","html_url":"https://github.com/kriegfrj","followers_url":"https://api.github.com/users/kriegfrj/followers","following_url":"https://api.github.com/users/kriegfrj/following{/other_user}","gists_url":"https://api.github.com/users/kriegfrj/gists{/gist_id}","starred_url":"https://api.github.com/users/kriegfrj/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/kriegfrj/subscriptions","organizations_url":"https://api.github.com/users/kriegfrj/orgs","repos_url":"https://api.github.com/users/kriegfrj/repos","events_url":"https://api.github.com/users/kriegfrj/events{/privacy}","received_events_url":"https://api.github.com/users/kriegfrj/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/assertj/assertj/milestones/53","html_url":"https://github.com/assertj/assertj/milestone/53","labels_url":"https://api.github.com/repos/assertj/assertj/milestones/53/labels","id":5784375,"node_id":"MDk6TWlsZXN0b25lNTc4NDM3NQ==","number":53,"title":"3.18.0","description":null,"creator":{"login":"joel-costigliola","id":382613,"node_id":"MDQ6VXNlcjM4MjYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/382613?v=4","gravatar_id":"","url":"https://api.github.com/users/joel-costigliola","html_url":"https://github.com/joel-costigliola","followers_url":"https://api.github.com/users/joel-costigliola/followers","following_url":"https://api.github.com/users/joel-costigliola/following{/other_user}","gists_url":"https://api.github.com/users/joel-costigliola/gists{/gist_id}","starred_url":"https://api.github.com/users/joel-costigliola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joel-costigliola/subscriptions","organizations_url":"https://api.github.com/users/joel-costigliola/orgs","repos_url":"https://api.github.com/users/joel-costigliola/repos","events_url":"https://api.github.com/users/joel-costigliola/events{/privacy}","received_events_url":"https://api.github.com/users/joel-costigliola/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":18,"state":"closed","created_at":"2020-08-18T10:46:52Z","updated_at":"2020-10-25T11:50:05Z","due_on":null,"closed_at":"2020-10-25T11:50:05Z"},"comments":1,"created_at":"2020-09-22T00:59:07Z","updated_at":"2020-09-30T10:20:41Z","closed_at":"2020-09-30T10:20:41Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"#### Summary\r\n\r\nSome of the utility methods in `AbstractAssert` that are commonly used by custom assertion implementations will always throw an exception. Specifically:\r\n\r\nhttps://github.com/joel-costigliola/assertj-core/blob/3c6bb8a5d4f452c60cf3c8e336a03feba5e9b207/src/main/java/org/assertj/core/api/AbstractAssert.java#L143\r\n\r\nhttps://github.com/joel-costigliola/assertj-core/blob/3c6bb8a5d4f452c60cf3c8e336a03feba5e9b207/src/main/java/org/assertj/core/api/AbstractAssert.java#L185\r\n\r\nUnfortunately, methods like this are a pain for the compiler and for code coverage tools because they have no way of knowing that calls to these methods will never return normally. Hence you get code coverage maps that look like this:\r\n\r\nhttps://codecov.io/gh/osgi/osgi-test/src/main/org.osgi.test.assertj.framework/src/main/java/org/osgi/test/assertj/bundlecontext/AbstractBundleContextAssert.java\r\n\r\n...with the invocations of the `failXXX()` methods all showing up as uncovered. This happens because the way Codecov works is to insert probes (little bits of test code) before and after each line of source code - because the probe after the call to `failXXX()` never gets called, the code coverage tool concludes (incorrectly) that the line before it wasn't executed.\r\n\r\nIn order to fix this, it would be better if instead of throwing the exception directly, the two methods had counterparts which returned an exception that the caller could throw directly. So instead of:\r\n\r\n```java\r\nif (!actual.getName().equals(name)) {\r\n     failWithMessage(\"Expected character's name to be <%s> but was <%s>\" name, actual.getName());\r\n}\r\n```\r\n\r\n...you'd do something like this:\r\n\r\n```java\r\nif (!actual.getName().equals(name)) {\r\n     throw failureWithMessage(\"Expected character's name to be <%s> but was <%s>\" name, actual.getName());\r\n}\r\n```\r\n\r\nThis way, the compiler and code coverage tools would be in on the secret and can handle appropriately, and our code coverage checks for our custom assertions would be showing 100% coverage instead of 87%. :smile:\r\n\r\nThis is more than just a \"code coverage\" nicety - the compiler can also work better (eg, spot dead code) with this pattern rather than the pattern of calling a method that always throws.","closed_by":{"login":"joel-costigliola","id":382613,"node_id":"MDQ6VXNlcjM4MjYxMw==","avatar_url":"https://avatars.githubusercontent.com/u/382613?v=4","gravatar_id":"","url":"https://api.github.com/users/joel-costigliola","html_url":"https://github.com/joel-costigliola","followers_url":"https://api.github.com/users/joel-costigliola/followers","following_url":"https://api.github.com/users/joel-costigliola/following{/other_user}","gists_url":"https://api.github.com/users/joel-costigliola/gists{/gist_id}","starred_url":"https://api.github.com/users/joel-costigliola/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/joel-costigliola/subscriptions","organizations_url":"https://api.github.com/users/joel-costigliola/orgs","repos_url":"https://api.github.com/users/joel-costigliola/repos","events_url":"https://api.github.com/users/joel-costigliola/events{/privacy}","received_events_url":"https://api.github.com/users/joel-costigliola/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/assertj/assertj/issues/2001/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/assertj/assertj/issues/2001/timeline","performed_via_github_app":null,"state_reason":"completed"}