diff --git a/assertj-core/src/main/java/org/assertj/core/api/recursive/comparison/RecursiveComparisonDifferenceCalculator.java b/assertj-core/src/main/java/org/assertj/core/api/recursive/comparison/RecursiveComparisonDifferenceCalculator.java
index b8d267af3..67c66f60b 100644
--- a/assertj-core/src/main/java/org/assertj/core/api/recursive/comparison/RecursiveComparisonDifferenceCalculator.java
+++ b/assertj-core/src/main/java/org/assertj/core/api/recursive/comparison/RecursiveComparisonDifferenceCalculator.java
@@ -160,10 +160,18 @@ public class RecursiveComparisonDifferenceCalculator {
       if (recursiveComparisonConfiguration.hasCustomMessageForField(fieldName)) {
         return recursiveComparisonConfiguration.getMessageForField(fieldName);
       }
-      Class<?> fieldType = dualValue.actual != null ? dualValue.actual.getClass() : dualValue.expected.getClass();
-      if (recursiveComparisonConfiguration.hasCustomMessageForType(fieldType)) {
+
+      Class<?> fieldType = null;
+      if (dualValue.actual != null) {
+        fieldType = dualValue.actual.getClass();
+      } else if (dualValue.expected != null) {
+        fieldType = dualValue.expected.getClass();
+      }
+
+      if (fieldType != null && recursiveComparisonConfiguration.hasCustomMessageForType(fieldType)) {
         return recursiveComparisonConfiguration.getMessageForType(fieldType);
       }
+
       return null;
     }
   }
diff --git a/assertj-core/src/test/java/org/assertj/core/api/recursive/comparison/RecursiveComparisonAssert_isEqualTo_withErrorMessageForFields_Test.java b/assertj-core/src/test/java/org/assertj/core/api/recursive/comparison/RecursiveComparisonAssert_isEqualTo_withErrorMessageForFields_Test.java
index e82dc13ee..f4d3a6570 100644
--- a/assertj-core/src/test/java/org/assertj/core/api/recursive/comparison/RecursiveComparisonAssert_isEqualTo_withErrorMessageForFields_Test.java
+++ b/assertj-core/src/test/java/org/assertj/core/api/recursive/comparison/RecursiveComparisonAssert_isEqualTo_withErrorMessageForFields_Test.java
@@ -15,12 +15,18 @@ package org.assertj.core.api.recursive.comparison;
 import static org.assertj.core.api.Assertions.assertThat;
 import static org.assertj.core.api.BDDAssertions.then;
 import static org.assertj.core.util.AssertionsUtil.expectAssertionError;
+import static org.junit.jupiter.params.provider.Arguments.arguments;
 
 import java.util.OptionalInt;
+import java.util.function.BiPredicate;
+import java.util.stream.Stream;
 
 import org.assertj.core.api.RecursiveComparisonAssert_isEqualTo_BaseTest;
 import org.assertj.core.internal.objects.data.Person;
 import org.junit.jupiter.api.Test;
+import org.junit.jupiter.params.ParameterizedTest;
+import org.junit.jupiter.params.provider.Arguments;
+import org.junit.jupiter.params.provider.MethodSource;
 
 class RecursiveComparisonAssert_isEqualTo_withErrorMessageForFields_Test extends RecursiveComparisonAssert_isEqualTo_BaseTest {
 
@@ -69,4 +75,41 @@ class RecursiveComparisonAssert_isEqualTo_withErrorMessageForFields_Test extends
                         .hasMessageNotContainingAny(typeMessage);
   }
 
+  @ParameterizedTest
+  @MethodSource
+  void should_use_message_for_type_when_possible(final Person actual, final Person expected) {
+    // GIVEN
+    String customMessage = "custom message 1234";
+    // WHEN
+    AssertionError assertionError = expectAssertionError(() -> assertThat(actual).usingRecursiveComparison()
+                                                                                 .withErrorMessageForType(customMessage,
+                                                                                                          String.class)
+                                                                                 .isEqualTo(expected));
+    // THEN
+    then(assertionError).hasMessageContainingAll(customMessage, "name");
+  }
+
+  static Stream<Arguments> should_use_message_for_type_when_possible() {
+    // Use the custom message whenever either the expected or the actual name is not null.
+    return Stream.of(arguments(new Person("Alice"), new Person("Bob")),
+                     arguments(new Person(null), new Person("Bob")),
+                     arguments(new Person("Alice"), new Person(null)));
+  }
+
+  @Test
+  void should_use_default_message_when_expected_and_actual_fields_are_both_null() {
+    // GIVEN
+    Person actual = new Person(null);
+    Person expected = new Person(null);
+    BiPredicate<String, String> alwaysFalse = (n1, n2) -> false;
+    // WHEN
+    AssertionError assertionError = expectAssertionError(() -> assertThat(actual).usingRecursiveComparison()
+                                                                                 .withErrorMessageForType("custom message not used",
+                                                                                                          String.class)
+                                                                                 .withEqualsForFieldsMatchingRegexes(alwaysFalse,
+                                                                                                                     "name")
+                                                                                 .isEqualTo(expected));
+    // THEN
+    then(assertionError).hasMessageContainingAll("field/property 'name' differ");
+  }
 }
