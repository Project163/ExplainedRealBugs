diff --git a/src/main/java/org/assertj/core/internal/AbstractComparisonStrategy.java b/src/main/java/org/assertj/core/internal/AbstractComparisonStrategy.java
index ca4ba34b8..9a0397f7f 100644
--- a/src/main/java/org/assertj/core/internal/AbstractComparisonStrategy.java
+++ b/src/main/java/org/assertj/core/internal/AbstractComparisonStrategy.java
@@ -15,10 +15,11 @@
 package org.assertj.core.internal;
 
 import static java.lang.reflect.Array.getLength;
+import static java.util.Collections.EMPTY_SET;
+
 import static org.assertj.core.util.Iterables.isNullOrEmpty;
 
 import java.lang.reflect.Array;
-import java.util.HashSet;
 import java.util.Set;
 
 /**
@@ -30,21 +31,27 @@ public abstract class AbstractComparisonStrategy implements ComparisonStrategy {
 
   @Override
   public Iterable<?> duplicatesFrom(Iterable<?> iterable) {
-    Set<Object> duplicates = new HashSet<Object>();
-    if (isNullOrEmpty(iterable)) {
-      return duplicates;
-    }
-    Set<Object> noDuplicates = new HashSet<Object>();
+    // To optimize the search - see https://github.com/alexruiz/fest-assert-2.x/issues/122
+    if (isNullOrEmpty(iterable)) return EMPTY_SET;
+
+    Set<Object> duplicates = newSetUsingComparisonStrategy();
+    Set<Object> noEmbeddedDuplicates = newSetUsingComparisonStrategy();
     for (Object element : iterable) {
-      if (iterableContains(noDuplicates, element)) {
+      if (noEmbeddedDuplicates.contains(element)) {
         duplicates.add(element);
       } else {
-        noDuplicates.add(element);
+        noEmbeddedDuplicates.add(element);
       }
     }
     return duplicates;
   }
 
+  /**
+   * Returns a {@link Set} honoring the comparison strategy used.
+   * @return a {@link Set} honoring the comparison strategy used.
+   */
+  protected abstract Set<Object> newSetUsingComparisonStrategy();
+
   @Override
   public boolean arrayContains(Object array, Object value) {
     for (int i = 0; i < getLength(array); i++) {
diff --git a/src/main/java/org/assertj/core/internal/ComparatorBasedComparisonStrategy.java b/src/main/java/org/assertj/core/internal/ComparatorBasedComparisonStrategy.java
index a0c345380..d1f9c8c09 100644
--- a/src/main/java/org/assertj/core/internal/ComparatorBasedComparisonStrategy.java
+++ b/src/main/java/org/assertj/core/internal/ComparatorBasedComparisonStrategy.java
@@ -19,6 +19,8 @@ import static org.assertj.core.util.Strings.quote;
 
 import java.util.Comparator;
 import java.util.Iterator;
+import java.util.Set;
+import java.util.TreeSet;
 
 /**
  * Implements {@link ComparisonStrategy} contract with a comparison strategy based on a {@link Comparator}.
@@ -102,11 +104,17 @@ public class ComparatorBasedComparisonStrategy extends AbstractComparisonStrateg
    * @return an {@link Iterable} containing the duplicate elements of the given one. If no duplicates are found, an empty
    *         {@link Iterable} is returned.
    */
-  // overridden to write javadoc.
+  // overriden to write javadoc.
   @Override
   public Iterable<?> duplicatesFrom(Iterable<?> iterable) {
     return super.duplicatesFrom(iterable);
   }
+  
+  @SuppressWarnings("unchecked")
+  @Override
+  protected Set<Object> newSetUsingComparisonStrategy() {
+    return new TreeSet<Object>(comparator);
+  }
 
   @Override
   public String toString() {
diff --git a/src/main/java/org/assertj/core/internal/StandardComparisonStrategy.java b/src/main/java/org/assertj/core/internal/StandardComparisonStrategy.java
index ed0c8028b..61b4543d4 100644
--- a/src/main/java/org/assertj/core/internal/StandardComparisonStrategy.java
+++ b/src/main/java/org/assertj/core/internal/StandardComparisonStrategy.java
@@ -16,7 +16,6 @@ package org.assertj.core.internal;
  */
 
 import static java.lang.String.format;
-import static org.assertj.core.util.Iterables.isNullOrEmpty;
 
 import java.util.HashSet;
 import java.util.Iterator;
@@ -78,7 +77,7 @@ public class StandardComparisonStrategy extends AbstractComparisonStrategy {
       return false;
     }
     for (Object next : iterable) {
-      if (Objects.areEqual(next, value)) {
+      if (areEqual(next, value)) {
         return true;
       }
     }
@@ -109,48 +108,15 @@ public class StandardComparisonStrategy extends AbstractComparisonStrategy {
    * @return an {@link Iterable} containing the duplicate elements of the given one. If no duplicates are found, an
    *         empty {@link Iterable} is returned.
    */
+  // overriden to write javadoc.
   @Override
   public Iterable<?> duplicatesFrom(Iterable<?> iterable) {
-    // To optimize the search (see https://github.com/alexruiz/fest-assert-2.x/issues/122)
-    class Embedded {
-      private final Object embedded;
-
-      private final int hashCode;
-
-      public Embedded(Object embedded) {
-        this.embedded = embedded;
-        this.hashCode = Objects.hashCodeFor(embedded);
-      }
-
-      @Override
-      public boolean equals(Object o) {
-        if (o instanceof Embedded) {
-          return Objects.areEqual(embedded, ((Embedded) o).embedded);
-        }
-        // Can't append.
-        return false;
-      }
-
-      @Override
-      public int hashCode() {
-        return hashCode;
-      }
-    }
+    return super.duplicatesFrom(iterable);
+  }
 
-    Set<Object> duplicates = new HashSet<Object>();
-    if (isNullOrEmpty(iterable)) {
-      return duplicates;
-    }
-    Set<Embedded> noDuplicates = new HashSet<Embedded>();
-    for (Object element : iterable) {
-      Embedded e = new Embedded(element);
-      if (noDuplicates.contains(e)) {
-        duplicates.add(element);
-      } else {
-        noDuplicates.add(e);
-      }
-    }
-    return duplicates;
+  @Override
+  protected Set<Object> newSetUsingComparisonStrategy() {
+    return new HashSet<Object>();
   }
 
   @Override
diff --git a/src/test/java/org/assertj/core/internal/iterables/Iterables_assertDoesNotHaveDuplicates_Test.java b/src/test/java/org/assertj/core/internal/iterables/Iterables_assertDoesNotHaveDuplicates_Test.java
index 76d8507b0..edf439bfb 100644
--- a/src/test/java/org/assertj/core/internal/iterables/Iterables_assertDoesNotHaveDuplicates_Test.java
+++ b/src/test/java/org/assertj/core/internal/iterables/Iterables_assertDoesNotHaveDuplicates_Test.java
@@ -15,6 +15,8 @@
 package org.assertj.core.internal.iterables;
 
 import static java.util.Collections.emptyList;
+
+import static org.assertj.core.api.Assertions.assertThat;
 import static org.assertj.core.error.ShouldNotHaveDuplicates.shouldNotHaveDuplicates;
 import static org.assertj.core.test.TestData.someInfo;
 import static org.assertj.core.test.TestFailures.failBecauseExpectedAssertionErrorWasNotThrown;
@@ -29,11 +31,11 @@ import java.util.Collection;
 import java.util.List;
 import java.util.UUID;
 
+import org.junit.Test;
+
 import org.assertj.core.api.AssertionInfo;
 import org.assertj.core.internal.Iterables;
 import org.assertj.core.internal.IterablesBaseTest;
-import org.junit.Ignore;
-import org.junit.Test;
 
 /**
  * Tests for <code>{@link Iterables#assertDoesNotHaveDuplicates(AssertionInfo, Collection)}</code>.
@@ -43,6 +45,7 @@ import org.junit.Test;
  */
 public class Iterables_assertDoesNotHaveDuplicates_Test extends IterablesBaseTest {
 
+  private static final int GENERATED_OBJECTS_NUMBER = 100000;
   private final List<String> actual = newArrayList("Luke", "Yoda", "Leia");
 
   @Test
@@ -75,6 +78,21 @@ public class Iterables_assertDoesNotHaveDuplicates_Test extends IterablesBaseTes
     failBecauseExpectedAssertionErrorWasNotThrown();
   }
 
+  @Test
+  public void should_pass_within_time_constraints() {
+    List<String> generated = new ArrayList<String>(GENERATED_OBJECTS_NUMBER);
+    for (int count = 0; count < GENERATED_OBJECTS_NUMBER; count++) {
+      generated.add(UUID.randomUUID().toString());
+    }
+
+    long time = System.currentTimeMillis();
+    iterables.assertDoesNotHaveDuplicates(someInfo(), generated);
+    // check that it takes less than 2 seconds, usually it takes 100ms on an average computer
+    // with the previous implementation, it would take minutes ...
+    System.out.println("Time elapsed in ms for assertDoesNotHaveDuplicates : " + (System.currentTimeMillis() - time));
+    assertThat((System.currentTimeMillis() - time)).isLessThan(2000);
+  }
+  
   // ------------------------------------------------------------------------------------------------------------------
   // tests using a custom comparison strategy
   // ------------------------------------------------------------------------------------------------------------------
@@ -99,19 +117,18 @@ public class Iterables_assertDoesNotHaveDuplicates_Test extends IterablesBaseTes
   }
 
   @Test
-  @Ignore
-  // Or use @Category, but doesn't "test" nothing.
-  public void testManyGeneration() {
-    AssertionInfo info = someInfo();
-    int generationCount = 100000;
-
-    List<String> generated = new ArrayList<String>(generationCount);
-    for (int count = 0; count < generationCount; count++) {
+  public void should_pass_within_time_constraints_with_custom_comparison_strategy() {
+    List<String> generated = new ArrayList<String>(GENERATED_OBJECTS_NUMBER);
+    for (int count = 0; count < GENERATED_OBJECTS_NUMBER; count++) {
       generated.add(UUID.randomUUID().toString());
     }
 
     long time = System.currentTimeMillis();
-    iterables.assertDoesNotHaveDuplicates(info, generated);
-    System.out.println("Time elapsed in ms : " + (System.currentTimeMillis() - time));
+    iterablesWithCaseInsensitiveComparisonStrategy.assertDoesNotHaveDuplicates(someInfo(), generated);
+    // check that it takes less than 10 seconds, usually it takes 2000ms on an average computer
+    // with the previous implementation, it would take minutes ...
+    // System.out.println("Time elapsed in ms for assertDoesNotHaveDuplicates with custom comparison strategy : " + (System.currentTimeMillis() - time));
+    assertThat((System.currentTimeMillis() - time)).isLessThan(10000);
   }
+  
 }
