{"url":"https://api.github.com/repos/libuv/libuv/issues/155","repository_url":"https://api.github.com/repos/libuv/libuv","labels_url":"https://api.github.com/repos/libuv/libuv/issues/155/labels{/name}","comments_url":"https://api.github.com/repos/libuv/libuv/issues/155/comments","events_url":"https://api.github.com/repos/libuv/libuv/issues/155/events","html_url":"https://github.com/libuv/libuv/issues/155","id":55172072,"node_id":"MDU6SXNzdWU1NTE3MjA3Mg==","number":155,"title":"API nitpick.","user":{"login":"txdv","id":116642,"node_id":"MDQ6VXNlcjExNjY0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/116642?v=4","gravatar_id":"","url":"https://api.github.com/users/txdv","html_url":"https://github.com/txdv","followers_url":"https://api.github.com/users/txdv/followers","following_url":"https://api.github.com/users/txdv/following{/other_user}","gists_url":"https://api.github.com/users/txdv/gists{/gist_id}","starred_url":"https://api.github.com/users/txdv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/txdv/subscriptions","organizations_url":"https://api.github.com/users/txdv/orgs","repos_url":"https://api.github.com/users/txdv/repos","events_url":"https://api.github.com/users/txdv/events{/privacy}","received_events_url":"https://api.github.com/users/txdv/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2015-01-22T16:10:29Z","updated_at":"2015-01-27T21:23:17Z","closed_at":"2015-01-27T21:23:17Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"We have stuff that returns strings, usually we have a pointer to length which gives the function an idea of how big a given buffer is and then puts the real size of the string into the pointer, the signature looks something like this:\n\n``` c\nint function(char* buf, size_t* len);\n```\n\nSometimes there are more parameters, a pointer to handle or  such, sometimes not.\n\nWe have in total 5 functions which fit this:\n\n``` c\nUV_EXTERN int uv_fs_poll_getpath(uv_fs_poll_t* handle, char* buf, size_t* len);\nUV_EXTERN int uv_exepath(char* buffer, size_t* size);\nUV_EXTERN int uv_cwd(char* buffer, size_t* size);\nUV_EXTERN int uv_pipe_getsockname(const uv_pipe_t* handle,\n                                  char* buf,\n                                  size_t* len);\nUV_EXTERN int uv_fs_event_getpath(uv_fs_event_t* handle,\n                                  char* buf,\n                                  size_t* len);\n```\n\nTo begin with, we have inconsistent names. buf - buffer, len - size.\n\nThe more disturbing part is that uv_cwd and uv_exepath return the exact length of the string and uv_fs_poll_getpath returns +1(it probably counts the 0 terminating symbol as well), so I need to manually decrease it by 1, which is suboptimal.\n\nThe len+1 happens on ubuntu 14.04 64bit.\n\nShould we make the names more consistent?\n\nShould we return the exact size of the string?\n","closed_by":{"login":"txdv","id":116642,"node_id":"MDQ6VXNlcjExNjY0Mg==","avatar_url":"https://avatars.githubusercontent.com/u/116642?v=4","gravatar_id":"","url":"https://api.github.com/users/txdv","html_url":"https://github.com/txdv","followers_url":"https://api.github.com/users/txdv/followers","following_url":"https://api.github.com/users/txdv/following{/other_user}","gists_url":"https://api.github.com/users/txdv/gists{/gist_id}","starred_url":"https://api.github.com/users/txdv/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/txdv/subscriptions","organizations_url":"https://api.github.com/users/txdv/orgs","repos_url":"https://api.github.com/users/txdv/repos","events_url":"https://api.github.com/users/txdv/events{/privacy}","received_events_url":"https://api.github.com/users/txdv/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/libuv/libuv/issues/155/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/libuv/libuv/issues/155/timeline","performed_via_github_app":null,"state_reason":"completed"}