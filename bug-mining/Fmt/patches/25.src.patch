diff --git a/include/fmt/format-inl.h b/include/fmt/format-inl.h
index 6722fe8c..f0bacf8b 100644
--- a/include/fmt/format-inl.h
+++ b/include/fmt/format-inl.h
@@ -155,8 +155,8 @@ FMT_FUNC void report_error(format_func func, int error_code,
   memory_buffer full_message;
   func(full_message, error_code, message);
   // Don't use fwrite_fully because the latter may throw.
-  (void)std::fwrite(full_message.data(), full_message.size(), 1, stderr);
-  std::fputc('\n', stderr);
+  if (std::fwrite(full_message.data(), full_message.size(), 1, stderr) > 0)
+    std::fputc('\n', stderr);
 }
 
 // A wrapper around fwrite that throws on error.
