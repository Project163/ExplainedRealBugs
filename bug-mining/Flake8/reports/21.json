{"url":"https://api.github.com/repos/PyCQA/flake8/issues/164","repository_url":"https://api.github.com/repos/PyCQA/flake8","labels_url":"https://api.github.com/repos/PyCQA/flake8/issues/164/labels{/name}","comments_url":"https://api.github.com/repos/PyCQA/flake8/issues/164/comments","events_url":"https://api.github.com/repos/PyCQA/flake8/issues/164/events","html_url":"https://github.com/PyCQA/flake8/issues/164","id":849559645,"node_id":"MDU6SXNzdWU4NDk1NTk2NDU=","number":164,"title":"flake8-3.0.4: 8 test failures (python-3.5.2/NetBSD): tox.ini problem","user":{"login":"asottile","id":1810591,"node_id":"MDQ6VXNlcjE4MTA1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1810591?v=4","gravatar_id":"","url":"https://api.github.com/users/asottile","html_url":"https://github.com/asottile","followers_url":"https://api.github.com/users/asottile/followers","following_url":"https://api.github.com/users/asottile/following{/other_user}","gists_url":"https://api.github.com/users/asottile/gists{/gist_id}","starred_url":"https://api.github.com/users/asottile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asottile/subscriptions","organizations_url":"https://api.github.com/users/asottile/orgs","repos_url":"https://api.github.com/users/asottile/repos","events_url":"https://api.github.com/users/asottile/events{/privacy}","received_events_url":"https://api.github.com/users/asottile/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2021-04-03T02:29:14Z","updated_at":"2021-04-03T02:29:22Z","closed_at":"2021-04-03T02:29:22Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"In GitLab by @_wiz_ on Sep 28, 2016, 24:41\n\nAfter fixing https://gitlab.com/pycqa/flake8/issues/231, when I run the self tests for flake8-3.0.4 with python-3.5.2 on NetBSD-7.99.38/amd64, I see the following test failures:\r\n````\r\n# python3.5  setup.py  test\r\nrunning pytest\r\nrunning egg_info\r\nwriting requirements to src/flake8.egg-info/requires.txt\r\nwriting src/flake8.egg-info/PKG-INFO\r\nwriting dependency_links to src/flake8.egg-info/dependency_links.txt\r\nwriting entry points to src/flake8.egg-info/entry_points.txt\r\nwriting top-level names to src/flake8.egg-info/top_level.txt\r\nreading manifest file 'src/flake8.egg-info/SOURCES.txt'\r\nreading manifest template 'MANIFEST.in'\r\nwriting manifest file 'src/flake8.egg-info/SOURCES.txt'\r\nrunning build_ext\r\n============================= test session starts ==============================\r\nplatform netbsd7 -- Python 3.5.2, pytest-3.0.2, py-1.4.30, pluggy-0.3.1\r\nrootdir: /scratch/devel/py-flake8/work/flake8-3.0.4, inifile: setup.cfg\r\ncollected 307 items\r\n\r\ntests/integration/test_aggregator.py ..\r\ntests/integration/test_checker.py ............\r\ntests/unit/test_base_formatter.py ............\r\ntests/unit/test_checker_manager.py ....\r\ntests/unit/test_config_file_finder.py .....FFFFFFFF...\r\ntests/unit/test_file_processor.py ..................................................................\r\ntests/unit/test_legacy_api.py ............\r\ntests/unit/test_merged_config_parser.py .................\r\ntests/unit/test_notifier.py .......\r\ntests/unit/test_option.py .....\r\ntests/unit/test_option_manager.py ................\r\ntests/unit/test_plugin.py ............\r\ntests/unit/test_plugin_manager.py ...\r\ntests/unit/test_plugin_type_manager.py ...........\r\ntests/unit/test_statistics.py ...................\r\ntests/unit/test_style_guide.py ............................................................\r\ntests/unit/test_trie.py .........\r\ntests/unit/test_utils.py ........................\r\n\r\n=================================== FAILURES ===================================\r\n_____________ test_generate_possible_local_files[args0-expected0] ______________\r\n\r\nargs = []\r\nexpected = ['/scratch/devel/py-flake8/work/flake8-3.0.4/setup.cfg', '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini']\r\n\r\n    @pytest.mark.parametrize('args,expected', [\r\n        # No arguments, common prefix of abspath('.')\r\n        ([],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\"\r\n        (['flake8/options', 'flake8/'],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/options\"\r\n        (['flake8/options', 'flake8/options/sub'],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n    ])\r\n    def test_generate_possible_local_files(args, expected):\r\n        \"\"\"Verify generation of all possible config paths.\"\"\"\r\n        finder = config.ConfigFileFinder('flake8', args, [])\r\n    \r\n>       assert (list(finder.generate_possible_local_files()) ==\r\n                expected)\r\nE       assert ['/scratch/de....4/setup.cfg'] == ['/scratch/dev....0.4/tox.ini']\r\nE         Right contains more items, first extra item: '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini'\r\nE         Use -v to get the full diff\r\n\r\ntests/unit/test_config_file_finder.py:60: AssertionError\r\n_____________ test_generate_possible_local_files[args1-expected1] ______________\r\n\r\nargs = ['flake8/options', 'flake8/']\r\nexpected = ['/scratch/devel/py-flake8/work/flake8-3.0.4/setup.cfg', '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini']\r\n\r\n    @pytest.mark.parametrize('args,expected', [\r\n        # No arguments, common prefix of abspath('.')\r\n        ([],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\"\r\n        (['flake8/options', 'flake8/'],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/options\"\r\n        (['flake8/options', 'flake8/options/sub'],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n    ])\r\n    def test_generate_possible_local_files(args, expected):\r\n        \"\"\"Verify generation of all possible config paths.\"\"\"\r\n        finder = config.ConfigFileFinder('flake8', args, [])\r\n    \r\n>       assert (list(finder.generate_possible_local_files()) ==\r\n                expected)\r\nE       assert ['/scratch/de....4/setup.cfg'] == ['/scratch/dev....0.4/tox.ini']\r\nE         Right contains more items, first extra item: '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini'\r\nE         Use -v to get the full diff\r\n\r\ntests/unit/test_config_file_finder.py:60: AssertionError\r\n_____________ test_generate_possible_local_files[args2-expected2] ______________\r\n\r\nargs = ['flake8/options', 'flake8/options/sub']\r\nexpected = ['/scratch/devel/py-flake8/work/flake8-3.0.4/setup.cfg', '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini']\r\n\r\n    @pytest.mark.parametrize('args,expected', [\r\n        # No arguments, common prefix of abspath('.')\r\n        ([],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\"\r\n        (['flake8/options', 'flake8/'],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/options\"\r\n        (['flake8/options', 'flake8/options/sub'],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n    ])\r\n    def test_generate_possible_local_files(args, expected):\r\n        \"\"\"Verify generation of all possible config paths.\"\"\"\r\n        finder = config.ConfigFileFinder('flake8', args, [])\r\n    \r\n>       assert (list(finder.generate_possible_local_files()) ==\r\n                expected)\r\nE       assert ['/scratch/de....4/setup.cfg'] == ['/scratch/dev....0.4/tox.ini']\r\nE         Right contains more items, first extra item: '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini'\r\nE         Use -v to get the full diff\r\n\r\ntests/unit/test_config_file_finder.py:60: AssertionError\r\n_________ test_local_config_files[args0-extra_config_files0-expected0] _________\r\n\r\nargs = [], extra_config_files = []\r\nexpected = ['/scratch/devel/py-flake8/work/flake8-3.0.4/setup.cfg', '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini']\r\n\r\n    @pytest.mark.parametrize('args,extra_config_files,expected', [\r\n        # No arguments, common prefix of abspath('.')\r\n        ([],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\"\r\n        (['flake8/options', 'flake8/'],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/options\"\r\n        (['flake8/options', 'flake8/options/sub'],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\" with extra config files specified\r\n        (['flake8/'],\r\n            [CLI_SPECIFIED_FILEPATH],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini'),\r\n                os.path.abspath(CLI_SPECIFIED_FILEPATH)]),\r\n        # Common prefix of \"flake8/\" with missing extra config files specified\r\n        (['flake8/'],\r\n            [CLI_SPECIFIED_FILEPATH,\r\n                'tests/fixtures/config_files/missing.ini'],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini'),\r\n                os.path.abspath(CLI_SPECIFIED_FILEPATH)]),\r\n    ])\r\n    def test_local_config_files(args, extra_config_files, expected):\r\n        \"\"\"Verify discovery of local config files.\"\"\"\r\n        finder = config.ConfigFileFinder('flake8', args, extra_config_files)\r\n    \r\n>       assert list(finder.local_config_files()) == expected\r\nE       assert ['/scratch/de....4/setup.cfg'] == ['/scratch/dev....0.4/tox.ini']\r\nE         Right contains more items, first extra item: '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini'\r\nE         Use -v to get the full diff\r\n\r\ntests/unit/test_config_file_finder.py:98: AssertionError\r\n_________ test_local_config_files[args1-extra_config_files1-expected1] _________\r\n\r\nargs = ['flake8/options', 'flake8/'], extra_config_files = []\r\nexpected = ['/scratch/devel/py-flake8/work/flake8-3.0.4/setup.cfg', '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini']\r\n\r\n    @pytest.mark.parametrize('args,extra_config_files,expected', [\r\n        # No arguments, common prefix of abspath('.')\r\n        ([],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\"\r\n        (['flake8/options', 'flake8/'],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/options\"\r\n        (['flake8/options', 'flake8/options/sub'],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\" with extra config files specified\r\n        (['flake8/'],\r\n            [CLI_SPECIFIED_FILEPATH],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini'),\r\n                os.path.abspath(CLI_SPECIFIED_FILEPATH)]),\r\n        # Common prefix of \"flake8/\" with missing extra config files specified\r\n        (['flake8/'],\r\n            [CLI_SPECIFIED_FILEPATH,\r\n                'tests/fixtures/config_files/missing.ini'],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini'),\r\n                os.path.abspath(CLI_SPECIFIED_FILEPATH)]),\r\n    ])\r\n    def test_local_config_files(args, extra_config_files, expected):\r\n        \"\"\"Verify discovery of local config files.\"\"\"\r\n        finder = config.ConfigFileFinder('flake8', args, extra_config_files)\r\n    \r\n>       assert list(finder.local_config_files()) == expected\r\nE       assert ['/scratch/de....4/setup.cfg'] == ['/scratch/dev....0.4/tox.ini']\r\nE         Right contains more items, first extra item: '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini'\r\nE         Use -v to get the full diff\r\n\r\ntests/unit/test_config_file_finder.py:98: AssertionError\r\n_________ test_local_config_files[args2-extra_config_files2-expected2] _________\r\n\r\nargs = ['flake8/options', 'flake8/options/sub'], extra_config_files = []\r\nexpected = ['/scratch/devel/py-flake8/work/flake8-3.0.4/setup.cfg', '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini']\r\n\r\n    @pytest.mark.parametrize('args,extra_config_files,expected', [\r\n        # No arguments, common prefix of abspath('.')\r\n        ([],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\"\r\n        (['flake8/options', 'flake8/'],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/options\"\r\n        (['flake8/options', 'flake8/options/sub'],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\" with extra config files specified\r\n        (['flake8/'],\r\n            [CLI_SPECIFIED_FILEPATH],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini'),\r\n                os.path.abspath(CLI_SPECIFIED_FILEPATH)]),\r\n        # Common prefix of \"flake8/\" with missing extra config files specified\r\n        (['flake8/'],\r\n            [CLI_SPECIFIED_FILEPATH,\r\n                'tests/fixtures/config_files/missing.ini'],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini'),\r\n                os.path.abspath(CLI_SPECIFIED_FILEPATH)]),\r\n    ])\r\n    def test_local_config_files(args, extra_config_files, expected):\r\n        \"\"\"Verify discovery of local config files.\"\"\"\r\n        finder = config.ConfigFileFinder('flake8', args, extra_config_files)\r\n    \r\n>       assert list(finder.local_config_files()) == expected\r\nE       assert ['/scratch/de....4/setup.cfg'] == ['/scratch/dev....0.4/tox.ini']\r\nE         Right contains more items, first extra item: '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini'\r\nE         Use -v to get the full diff\r\n\r\ntests/unit/test_config_file_finder.py:98: AssertionError\r\n_________ test_local_config_files[args3-extra_config_files3-expected3] _________\r\n\r\nargs = ['flake8/']\r\nextra_config_files = ['tests/fixtures/config_files/cli-specified.ini']\r\nexpected = ['/scratch/devel/py-flake8/work/flake8-3.0.4/setup.cfg', '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini', '/scratch/devel/py-flake8/work/flake8-3.0.4/tests/fixtures/config_files/cli-specified.ini']\r\n\r\n    @pytest.mark.parametrize('args,extra_config_files,expected', [\r\n        # No arguments, common prefix of abspath('.')\r\n        ([],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\"\r\n        (['flake8/options', 'flake8/'],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/options\"\r\n        (['flake8/options', 'flake8/options/sub'],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\" with extra config files specified\r\n        (['flake8/'],\r\n            [CLI_SPECIFIED_FILEPATH],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini'),\r\n                os.path.abspath(CLI_SPECIFIED_FILEPATH)]),\r\n        # Common prefix of \"flake8/\" with missing extra config files specified\r\n        (['flake8/'],\r\n            [CLI_SPECIFIED_FILEPATH,\r\n                'tests/fixtures/config_files/missing.ini'],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini'),\r\n                os.path.abspath(CLI_SPECIFIED_FILEPATH)]),\r\n    ])\r\n    def test_local_config_files(args, extra_config_files, expected):\r\n        \"\"\"Verify discovery of local config files.\"\"\"\r\n        finder = config.ConfigFileFinder('flake8', args, extra_config_files)\r\n    \r\n>       assert list(finder.local_config_files()) == expected\r\nE       assert ['/scratch/de...pecified.ini'] == ['/scratch/dev...pecified.ini']\r\nE         At index 1 diff: '/scratch/devel/py-flake8/work/flake8-3.0.4/tests/fixtures/config_files/cli-specified.ini' != '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini'\r\nE         Right contains more items, first extra item: '/scratch/devel/py-flake8/work/flake8-3.0.4/tests/fixtures/config_files/cli-specified.ini'\r\nE         Use -v to get the full diff\r\n\r\ntests/unit/test_config_file_finder.py:98: AssertionError\r\n_________ test_local_config_files[args4-extra_config_files4-expected4] _________\r\n\r\nargs = ['flake8/']\r\nextra_config_files = ['tests/fixtures/config_files/cli-specified.ini', 'tests/fixtures/config_files/missing.ini']\r\nexpected = ['/scratch/devel/py-flake8/work/flake8-3.0.4/setup.cfg', '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini', '/scratch/devel/py-flake8/work/flake8-3.0.4/tests/fixtures/config_files/cli-specified.ini']\r\n\r\n    @pytest.mark.parametrize('args,extra_config_files,expected', [\r\n        # No arguments, common prefix of abspath('.')\r\n        ([],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\"\r\n        (['flake8/options', 'flake8/'],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/options\"\r\n        (['flake8/options', 'flake8/options/sub'],\r\n            [],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini')]),\r\n        # Common prefix of \"flake8/\" with extra config files specified\r\n        (['flake8/'],\r\n            [CLI_SPECIFIED_FILEPATH],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini'),\r\n                os.path.abspath(CLI_SPECIFIED_FILEPATH)]),\r\n        # Common prefix of \"flake8/\" with missing extra config files specified\r\n        (['flake8/'],\r\n            [CLI_SPECIFIED_FILEPATH,\r\n                'tests/fixtures/config_files/missing.ini'],\r\n            [os.path.abspath('setup.cfg'),\r\n                os.path.abspath('tox.ini'),\r\n                os.path.abspath(CLI_SPECIFIED_FILEPATH)]),\r\n    ])\r\n    def test_local_config_files(args, extra_config_files, expected):\r\n        \"\"\"Verify discovery of local config files.\"\"\"\r\n        finder = config.ConfigFileFinder('flake8', args, extra_config_files)\r\n    \r\n>       assert list(finder.local_config_files()) == expected\r\nE       assert ['/scratch/de...pecified.ini'] == ['/scratch/dev...pecified.ini']\r\nE         At index 1 diff: '/scratch/devel/py-flake8/work/flake8-3.0.4/tests/fixtures/config_files/cli-specified.ini' != '/scratch/devel/py-flake8/work/flake8-3.0.4/tox.ini'\r\nE         Right contains more items, first extra item: '/scratch/devel/py-flake8/work/flake8-3.0.4/tests/fixtures/config_files/cli-specified.ini'\r\nE         Use -v to get the full diff\r\n\r\ntests/unit/test_config_file_finder.py:98: AssertionError\r\n===================== 8 failed, 299 passed in 1.25 seconds =====================\r\n*** Error code 1\r\n````\r\nThey look like tox.ini is missing in some comparison list.","closed_by":{"login":"asottile","id":1810591,"node_id":"MDQ6VXNlcjE4MTA1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1810591?v=4","gravatar_id":"","url":"https://api.github.com/users/asottile","html_url":"https://github.com/asottile","followers_url":"https://api.github.com/users/asottile/followers","following_url":"https://api.github.com/users/asottile/following{/other_user}","gists_url":"https://api.github.com/users/asottile/gists{/gist_id}","starred_url":"https://api.github.com/users/asottile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asottile/subscriptions","organizations_url":"https://api.github.com/users/asottile/orgs","repos_url":"https://api.github.com/users/asottile/repos","events_url":"https://api.github.com/users/asottile/events{/privacy}","received_events_url":"https://api.github.com/users/asottile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/PyCQA/flake8/issues/164/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PyCQA/flake8/issues/164/timeline","performed_via_github_app":null,"state_reason":"completed"}