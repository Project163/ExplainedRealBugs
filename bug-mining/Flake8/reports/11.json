{"url":"https://api.github.com/repos/PyCQA/flake8/issues/87","repository_url":"https://api.github.com/repos/PyCQA/flake8","labels_url":"https://api.github.com/repos/PyCQA/flake8/issues/87/labels{/name}","comments_url":"https://api.github.com/repos/PyCQA/flake8/issues/87/comments","events_url":"https://api.github.com/repos/PyCQA/flake8/issues/87/events","html_url":"https://github.com/PyCQA/flake8/issues/87","id":849555066,"node_id":"MDU6SXNzdWU4NDk1NTUwNjY=","number":87,"title":"Jobs warning tests failing on Windows with Python < 3.4","user":{"login":"asottile","id":1810591,"node_id":"MDQ6VXNlcjE4MTA1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1810591?v=4","gravatar_id":"","url":"https://api.github.com/users/asottile","html_url":"https://github.com/asottile","followers_url":"https://api.github.com/users/asottile/followers","following_url":"https://api.github.com/users/asottile/following{/other_user}","gists_url":"https://api.github.com/users/asottile/gists{/gist_id}","starred_url":"https://api.github.com/users/asottile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asottile/subscriptions","organizations_url":"https://api.github.com/users/asottile/orgs","repos_url":"https://api.github.com/users/asottile/repos","events_url":"https://api.github.com/users/asottile/events{/privacy}","received_events_url":"https://api.github.com/users/asottile/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2021-04-03T01:55:56Z","updated_at":"2021-04-03T01:56:13Z","closed_at":"2021-04-03T01:56:13Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"In GitLab by @christianmlong on Mar 11, 2015, 18:42\n\nFlake8 issues warnings when the `--jobs` option is used in an incompatible way (e.g. with the `--diff` option). The tests for this feature are in `flake8/tests/test_warnings.py`.\r\n\r\nUnder certain condition, the tests in `test_warnings.py` fail.\r\n\r\n---\r\n\r\n#### Tests pass \r\n\r\nLinux - Ubuntu 14.10\r\n\r\n2.6, 2.7, 3.2, 3.3, 3.4\r\n\r\nWindows - 8.1\r\n\r\n3.4\r\n\r\n---\r\n\r\n#### Tests fail \r\n\r\nWindows - 8.1\r\n\r\n2.7, 3.3\r\n\r\n---\r\n\r\nThey fail because the warnings are not issued, or are not captured. However, when the tests in `test_warnings.py` are run alone, without the rest of the test suite, they pass. Using the `nosetests --isolation` option does not help.\r\n\r\nThe nature of the tests (patching stdin, stdout) and the pattern of failure (Windows, Python &lt; 3.4) makes me think the failure might have something to do with [PEP 446](https://www.python.org/dev/peps/pep-0446/) \"Make newly created file descriptors non-inheritable\".\r\n\r\n---\r\n\r\nOne proposed solution (PR coming soon) is to run the tests in `test_warnings.py` separately, in a separate line in the tox `[testenv]` stanza.\r\n\r\n\r\n---\r\n\r\n### Tracebacks\r\n\r\n\r\n\r\n    \r\n    ======================================================================\r\n    FAIL: test_jobs_verbose (flake8.tests.test_warnings.IntegrationTestCaseWarnings)\r\n    ----------------------------------------------------------------------\r\n    Traceback (most recent call last):\r\n      File \"C:\\Users\\Me\\Documents\\Documents\\Computer\\Projects\\git\\flake8\\flake8\\tests\\test_warnings.py\", line 190, in test_jobs_verbose\r\n        self.test_jobs(verbose=True)\r\n      File \"C:\\Users\\Me\\Documents\\Documents\\Computer\\Projects\\git\\flake8\\flake8\\tests\\test_warnings.py\", line 160, in test_jobs\r\n        self._job_tester(2, verbose=verbose)\r\n      File \"C:\\Users\\Me\\Documents\\Documents\\Computer\\Projects\\git\\flake8\\flake8\\tests\\test_warnings.py\", line 157, in _job_tester\r\n        self.verify_warnings(collected_warnings, expected_warings)\r\n      File \"C:\\Users\\Me\\Documents\\Documents\\Computer\\Projects\\git\\flake8\\flake8\\tests\\test_warnings.py\", line 88, in verify_warnings\r\n        len(expected_warnings))\r\n    nose.proxy.AssertionError: 0 != 1\r\n    -------------------- >> begin captured stdout << ---------------------\r\n    local configuration: in C:\\Users\\Me\\Documents\\Documents\\Computer\\Projects\\git\\flake8\r\n    checking C:\\Users\\Me\\Documents\\Documents\\Computer\\Projects\\git\\flake8\\flake8\\tests\\test_warnings.py\r\n    \r\n    --------------------- >> end captured stdout << ----------------------\r\n    \r\n    ======================================================================\r\n    FAIL: test_stdin_jobs_warning_verbose (flake8.tests.test_warnings.IntegrationTestCaseWarnings)\r\n    ----------------------------------------------------------------------\r\n    Traceback (most recent call last):\r\n      File \"C:\\Users\\Me\\Documents\\Documents\\Computer\\Projects\\git\\flake8\\flake8\\tests\\test_warnings.py\", line 196, in test_stdin_jobs_warning_verbose\r\n        self.test_stdin_jobs_warning(verbose=True)\r\n      File \"C:\\Users\\Me\\Documents\\Documents\\Computer\\Projects\\git\\flake8\\flake8\\tests\\test_warnings.py\", line 186, in test_stdin_jobs_warning\r\n        self.verify_warnings(collected_warnings, expected_warings)\r\n      File \"C:\\Users\\Me\\Documents\\Documents\\Computer\\Projects\\git\\flake8\\flake8\\tests\\test_warnings.py\", line 88, in verify_warnings\r\n        len(expected_warnings))\r\n    nose.proxy.AssertionError: 1 != 2\r\n    -------------------- >> begin captured stdout << ---------------------\r\n    local configuration: in C:\\Users\\Me\\Documents\\Documents\\Computer\\Projects\\git\\flake8\r\n    checking -\r\n    \r\n    --------------------- >> end captured stdout << ----------------------\r\n\r\n","closed_by":{"login":"asottile","id":1810591,"node_id":"MDQ6VXNlcjE4MTA1OTE=","avatar_url":"https://avatars.githubusercontent.com/u/1810591?v=4","gravatar_id":"","url":"https://api.github.com/users/asottile","html_url":"https://github.com/asottile","followers_url":"https://api.github.com/users/asottile/followers","following_url":"https://api.github.com/users/asottile/following{/other_user}","gists_url":"https://api.github.com/users/asottile/gists{/gist_id}","starred_url":"https://api.github.com/users/asottile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/asottile/subscriptions","organizations_url":"https://api.github.com/users/asottile/orgs","repos_url":"https://api.github.com/users/asottile/repos","events_url":"https://api.github.com/users/asottile/events{/privacy}","received_events_url":"https://api.github.com/users/asottile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/PyCQA/flake8/issues/87/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/PyCQA/flake8/issues/87/timeline","performed_via_github_app":null,"state_reason":"completed"}