<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:02:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[JOHNZON-223] Deserialization of objects with generic types leads to an error</title>
                <link>https://issues.apache.org/jira/browse/JOHNZON-223</link>
                <project id="12315523" key="JOHNZON">Johnzon</project>
                    <description>&lt;p&gt;In our project we use generic containers e.g. for enums to enrich them with additional information. For the serialization in Json we use an own adapter.&lt;br/&gt;
Serialization in Json works without problems, but deserialization into an object results in an error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 javax.json.bind.JsonbException: Cannot &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; sun.reflect.generics.reflectiveObjects.ParameterizedTypeImpl to java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;From my point of view the problem lies in the method&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
org.apache.johnzon.mapper.Mappings.findConverter line 570

&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; ParameterizedType type = ParameterizedType.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(decoratedType.getType());
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Type rawType = type.getRawType();
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;isInstance(rawType)
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;amp;&amp;amp; Collection.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;isAssignableFrom(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.&lt;span class=&quot;code-keyword&quot;&gt;class.&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt;(rawType))
&#160;&#160;&#160;&#160;&#160;&#160;&#160; &amp;amp;&amp;amp; type.getActualTypeArguments().length &amp;gt;= 1) {
&#160;&#160;&#160; typeToTest = type.getActualTypeArguments()[0];
} &lt;span class=&quot;code-comment&quot;&gt;// TODO: map&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The condition checks here whether it is a collection, otherwise nothing else is done for ParameterizedTypes.&lt;br/&gt;
However, the variable typeToTest should be set to rawType for&#160;ParameterizedTypes so that a converter can be found afterwards. Otherwise typeToTest remains a ParameterizedType and the query in line 576 if (converter == null &amp;amp;&amp;amp; Class.class.isInstance(typeToTest)) fails and no converter will be searched.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;A small test can be found here: &lt;a href=&quot;https://gist.github.com/kevinwilken/12da681534053b776247697c6f24c296&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/kevinwilken/12da681534053b776247697c6f24c296&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13246737">JOHNZON-223</key>
            <summary>Deserialization of objects with generic types leads to an error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="romain.manni-bucau">Romain Manni-Bucau</assignee>
                                    <reporter username="KeSt">Kevin</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Jul 2019 06:51:51 +0000</created>
                <updated>Wed, 24 Jul 2019 09:34:57 +0000</updated>
                            <resolved>Wed, 24 Jul 2019 07:25:40 +0000</resolved>
                                    <version>1.1.12</version>
                                    <fixVersion>1.1.13</fixVersion>
                                    <component>JSON-B</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16891656" author="romain.manni-bucau" created="Wed, 24 Jul 2019 07:25:40 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=KeSt&quot; class=&quot;user-hover&quot; rel=&quot;KeSt&quot;&gt;KeSt&lt;/a&gt;, it&#160;is fixed on master (1.1.13-SNAPSHOT) and the snapshot is deployed on apache snapshot repo (&lt;a href=&quot;https://repository.apache.org/content/repositories/snapshots/)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://repository.apache.org/content/repositories/snapshots/)&lt;/a&gt;&#160;if you want to give it a try. Thanks a lot for the report.&lt;/p&gt;</comment>
                            <comment id="16891728" author="kest" created="Wed, 24 Jul 2019 09:34:44 +0000"  >&lt;p&gt;Works fine, thank you!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12975593" name="error.log" size="1503" author="KeSt" created="Wed, 24 Jul 2019 06:54:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 16 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z04ytk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>