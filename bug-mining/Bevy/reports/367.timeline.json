[{"id":13522421326,"node_id":"LE_lADODf6-U86PukINzwAAAAMl_8ZO","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/13522421326","actor":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-07-16T14:42:12Z","label":{"name":"C-Bug","color":"d73a4a"},"performed_via_github_app":null},{"id":13522421330,"node_id":"LE_lADODf6-U86PukINzwAAAAMl_8ZS","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/13522421330","actor":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-07-16T14:42:12Z","label":{"name":"S-Needs-Triage","color":"D876e3"},"performed_via_github_app":null},{"id":13522690898,"node_id":"MIE_lADODf6-U86PukINzwAAAAMmA-NS","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/13522690898","actor":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"milestoned","commit_id":null,"commit_url":null,"created_at":"2024-07-16T14:59:40Z","milestone":{"title":"0.15"},"performed_via_github_app":null},{"id":13522692292,"node_id":"UNLE_lADODf6-U86PukINzwAAAAMmA-jE","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/13522692292","actor":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unlabeled","commit_id":null,"commit_url":null,"created_at":"2024-07-16T14:59:45Z","label":{"name":"S-Needs-Triage","color":"D876e3"},"performed_via_github_app":null},{"id":13522692304,"node_id":"LE_lADODf6-U86PukINzwAAAAMmA-jQ","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/13522692304","actor":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-07-16T14:59:45Z","label":{"name":"A-ECS","color":"c6a751"},"performed_via_github_app":null},{"id":13522692322,"node_id":"LE_lADODf6-U86PukINzwAAAAMmA-ji","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/13522692322","actor":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-07-16T14:59:46Z","label":{"name":"P-Unsound","color":"FF7b00"},"performed_via_github_app":null},{"id":13522693582,"node_id":"LE_lADODf6-U86PukINzwAAAAMmA-3O","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/13522693582","actor":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-07-16T14:59:50Z","label":{"name":"D-Unsafe","color":"008672"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2231138596","html_url":"https://github.com/bevyengine/bevy/issues/14348#issuecomment-2231138596","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/14348","id":2231138596,"node_id":"IC_kwDODf6-U86E_Hkk","user":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-16T15:00:13Z","updated_at":"2024-07-16T15:00:13Z","body":"As mentioned on Discord, this is effectively https://github.com/bevyengine/bevy/pull/13120 again.","author_association":"MEMBER","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2231138596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2231155739","html_url":"https://github.com/bevyengine/bevy/issues/14348#issuecomment-2231155739","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/14348","id":2231155739,"node_id":"IC_kwDODf6-U86E_Lwb","user":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-16T15:06:30Z","updated_at":"2024-07-16T15:06:30Z","body":"> As mentioned on Discord, this is effectively #13120 again.\r\n\r\nThe difference is that for #13120 it was just one of the blockers for merging, while this issue is present on an already released version.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2231155739/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2261320507","html_url":"https://github.com/bevyengine/bevy/issues/14348#issuecomment-2261320507","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/14348","id":2261320507,"node_id":"IC_kwDODf6-U86GyQM7","user":{"login":"cBournhonesque","id":8112632,"node_id":"MDQ6VXNlcjgxMTI2MzI=","avatar_url":"https://avatars.githubusercontent.com/u/8112632?v=4","gravatar_id":"","url":"https://api.github.com/users/cBournhonesque","html_url":"https://github.com/cBournhonesque","followers_url":"https://api.github.com/users/cBournhonesque/followers","following_url":"https://api.github.com/users/cBournhonesque/following{/other_user}","gists_url":"https://api.github.com/users/cBournhonesque/gists{/gist_id}","starred_url":"https://api.github.com/users/cBournhonesque/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cBournhonesque/subscriptions","organizations_url":"https://api.github.com/users/cBournhonesque/orgs","repos_url":"https://api.github.com/users/cBournhonesque/repos","events_url":"https://api.github.com/users/cBournhonesque/events{/privacy}","received_events_url":"https://api.github.com/users/cBournhonesque/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-31T19:45:27Z","updated_at":"2024-07-31T19:45:27Z","body":"So the problem is that queries use static analysis on the type of the query to check if all components are dense, in which case it iterates through the table instead of the archetype?\r\n\r\nWould the solution be to check if the query is dense by looking at the `Access` dynamically instead of looking at the types of `D` and `F`?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2261320507/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cBournhonesque","id":8112632,"node_id":"MDQ6VXNlcjgxMTI2MzI=","avatar_url":"https://avatars.githubusercontent.com/u/8112632?v=4","gravatar_id":"","url":"https://api.github.com/users/cBournhonesque","html_url":"https://github.com/cBournhonesque","followers_url":"https://api.github.com/users/cBournhonesque/followers","following_url":"https://api.github.com/users/cBournhonesque/following{/other_user}","gists_url":"https://api.github.com/users/cBournhonesque/gists{/gist_id}","starred_url":"https://api.github.com/users/cBournhonesque/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cBournhonesque/subscriptions","organizations_url":"https://api.github.com/users/cBournhonesque/orgs","repos_url":"https://api.github.com/users/cBournhonesque/repos","events_url":"https://api.github.com/users/cBournhonesque/events{/privacy}","received_events_url":"https://api.github.com/users/cBournhonesque/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2261384731","html_url":"https://github.com/bevyengine/bevy/issues/14348#issuecomment-2261384731","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/14348","id":2261384731,"node_id":"IC_kwDODf6-U86Gyf4b","user":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-31T20:22:08Z","updated_at":"2024-07-31T20:23:13Z","body":"> So the problem is that queries use static analysis on the type of the query to check if all components are dense, in which case it iterates through the table instead of the archetype?\r\n\r\nYes. Basically the (wrong) assumption is that if all the static types and filters are dense then the query will actually access all and only those entities in the corresponding tables (and thus they can directly iterate over them, gaining better cache locality and even potential for autovectorization), but that assumption is violated by the query not having access to some of the archetypes in those tables when built dynamically (or when `transmute`/`transmute_lens`/etc etc are used, see #14528).\r\n\r\n> Would the solution be to check if the query is dense by looking at the Access dynamically instead of looking at the types of D and F?\r\n\r\nIt would solve the soundness issue, but it would also require introducing a branch in every call to the very hot `QueryIter::next` which would likely be devastating for performance.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2261384731/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2261463065","html_url":"https://github.com/bevyengine/bevy/issues/14348#issuecomment-2261463065","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/14348","id":2261463065,"node_id":"IC_kwDODf6-U86GyzAZ","user":{"login":"cBournhonesque","id":8112632,"node_id":"MDQ6VXNlcjgxMTI2MzI=","avatar_url":"https://avatars.githubusercontent.com/u/8112632?v=4","gravatar_id":"","url":"https://api.github.com/users/cBournhonesque","html_url":"https://github.com/cBournhonesque","followers_url":"https://api.github.com/users/cBournhonesque/followers","following_url":"https://api.github.com/users/cBournhonesque/following{/other_user}","gists_url":"https://api.github.com/users/cBournhonesque/gists{/gist_id}","starred_url":"https://api.github.com/users/cBournhonesque/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cBournhonesque/subscriptions","organizations_url":"https://api.github.com/users/cBournhonesque/orgs","repos_url":"https://api.github.com/users/cBournhonesque/repos","events_url":"https://api.github.com/users/cBournhonesque/events{/privacy}","received_events_url":"https://api.github.com/users/cBournhonesque/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-31T21:06:40Z","updated_at":"2024-07-31T21:06:40Z","body":"> It would solve the soundness issue, but it would also require introducing a branch in every call to the very hot `QueryIter::next` which would likely be devastating for performance.\r\n\r\nCould something like:\r\n- at QueryIter  creation time (`QueryIter::new()`)  we create either a `QueryArchetypeIterationCursor` or `QueryTableIterationCursor` depending on the access, which is checked dynamically\r\n- then the hot path of `Cursor::next()` wouldn't have branching\r\n\r\nwork?","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2261463065/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cBournhonesque","id":8112632,"node_id":"MDQ6VXNlcjgxMTI2MzI=","avatar_url":"https://avatars.githubusercontent.com/u/8112632?v=4","gravatar_id":"","url":"https://api.github.com/users/cBournhonesque","html_url":"https://github.com/cBournhonesque","followers_url":"https://api.github.com/users/cBournhonesque/followers","following_url":"https://api.github.com/users/cBournhonesque/following{/other_user}","gists_url":"https://api.github.com/users/cBournhonesque/gists{/gist_id}","starred_url":"https://api.github.com/users/cBournhonesque/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cBournhonesque/subscriptions","organizations_url":"https://api.github.com/users/cBournhonesque/orgs","repos_url":"https://api.github.com/users/cBournhonesque/repos","events_url":"https://api.github.com/users/cBournhonesque/events{/privacy}","received_events_url":"https://api.github.com/users/cBournhonesque/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2262098397","html_url":"https://github.com/bevyengine/bevy/issues/14348#issuecomment-2262098397","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/14348","id":2262098397,"node_id":"IC_kwDODf6-U86G1OHd","user":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-01T05:54:05Z","updated_at":"2024-08-01T05:54:05Z","body":"No, `Cursor::next()` would still have a branch due to checking which cursor it actually is. Ultimately the two types of iteration do different things, so if you want to make the selection dynamic you will have a branch in `next`.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2262098397/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2263076255","html_url":"https://github.com/bevyengine/bevy/issues/14348#issuecomment-2263076255","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/14348","id":2263076255,"node_id":"IC_kwDODf6-U86G482f","user":{"login":"cBournhonesque","id":8112632,"node_id":"MDQ6VXNlcjgxMTI2MzI=","avatar_url":"https://avatars.githubusercontent.com/u/8112632?v=4","gravatar_id":"","url":"https://api.github.com/users/cBournhonesque","html_url":"https://github.com/cBournhonesque","followers_url":"https://api.github.com/users/cBournhonesque/followers","following_url":"https://api.github.com/users/cBournhonesque/following{/other_user}","gists_url":"https://api.github.com/users/cBournhonesque/gists{/gist_id}","starred_url":"https://api.github.com/users/cBournhonesque/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cBournhonesque/subscriptions","organizations_url":"https://api.github.com/users/cBournhonesque/orgs","repos_url":"https://api.github.com/users/cBournhonesque/repos","events_url":"https://api.github.com/users/cBournhonesque/events{/privacy}","received_events_url":"https://api.github.com/users/cBournhonesque/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-01T13:38:38Z","updated_at":"2024-08-01T13:40:18Z","body":"> No, `Cursor::next()` would still have a branch due to checking which cursor it actually is. Ultimately the two types of iteration do different things, so if you want to make the selection dynamic you will have a branch in `next`.\r\n\r\nI wouldn't have any dynamic checks in the cursor because I have 2 different types of Cursors. `DenseCursor` vs `ArchetypeCursor`. Maybe I can try it.\r\n\r\nEDIT: ah i see, you would have to check which cursor to advance..","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2263076255/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cBournhonesque","id":8112632,"node_id":"MDQ6VXNlcjgxMTI2MzI=","avatar_url":"https://avatars.githubusercontent.com/u/8112632?v=4","gravatar_id":"","url":"https://api.github.com/users/cBournhonesque","html_url":"https://github.com/cBournhonesque","followers_url":"https://api.github.com/users/cBournhonesque/followers","following_url":"https://api.github.com/users/cBournhonesque/following{/other_user}","gists_url":"https://api.github.com/users/cBournhonesque/gists{/gist_id}","starred_url":"https://api.github.com/users/cBournhonesque/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cBournhonesque/subscriptions","organizations_url":"https://api.github.com/users/cBournhonesque/orgs","repos_url":"https://api.github.com/users/cBournhonesque/repos","events_url":"https://api.github.com/users/cBournhonesque/events{/privacy}","received_events_url":"https://api.github.com/users/cBournhonesque/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2263229794","html_url":"https://github.com/bevyengine/bevy/issues/14348#issuecomment-2263229794","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/14348","id":2263229794,"node_id":"IC_kwDODf6-U86G5iVi","user":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-01T14:32:13Z","updated_at":"2024-08-01T14:32:13Z","body":"A solution which would keep the dense iteration optimization may be to add a new marker parameter to `Query` and `QueryState` which tells it whether it can trust the static filters or not. By default it would be to trust the static filters, and thus the dense iteration optimization would be possible, but any operation that may introduce dynamic ones will have to return a `Query`/`QueryState` with the other marker where it is not.\r\n\r\nThe downside of this approach is that now we have two incompatible kind of `Query`, though we could add a zero-cost way to convert a static one to a dynamic one to ease the reduction in usability.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2263229794/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2263344142","html_url":"https://github.com/bevyengine/bevy/issues/14348#issuecomment-2263344142","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/14348","id":2263344142,"node_id":"IC_kwDODf6-U86G5-QO","user":{"login":"cBournhonesque","id":8112632,"node_id":"MDQ6VXNlcjgxMTI2MzI=","avatar_url":"https://avatars.githubusercontent.com/u/8112632?v=4","gravatar_id":"","url":"https://api.github.com/users/cBournhonesque","html_url":"https://github.com/cBournhonesque","followers_url":"https://api.github.com/users/cBournhonesque/followers","following_url":"https://api.github.com/users/cBournhonesque/following{/other_user}","gists_url":"https://api.github.com/users/cBournhonesque/gists{/gist_id}","starred_url":"https://api.github.com/users/cBournhonesque/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cBournhonesque/subscriptions","organizations_url":"https://api.github.com/users/cBournhonesque/orgs","repos_url":"https://api.github.com/users/cBournhonesque/repos","events_url":"https://api.github.com/users/cBournhonesque/events{/privacy}","received_events_url":"https://api.github.com/users/cBournhonesque/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-01T15:22:25Z","updated_at":"2024-08-01T15:23:01Z","body":"And doing something like\r\n```\r\nenum Cursor {\r\n   Dense(DenseCursor),\r\n   Archetype(ArchetypeCursor)\r\n}\r\n```\r\n\r\nwould not work because the check of which type of cursor we are is still done dynamically?\r\n\r\nI was hoping that after the Cursor creation, the other functions would just be called statically. We only need to check the `is_dense` at cursor creation, not after","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2263344142/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"cBournhonesque","id":8112632,"node_id":"MDQ6VXNlcjgxMTI2MzI=","avatar_url":"https://avatars.githubusercontent.com/u/8112632?v=4","gravatar_id":"","url":"https://api.github.com/users/cBournhonesque","html_url":"https://github.com/cBournhonesque","followers_url":"https://api.github.com/users/cBournhonesque/followers","following_url":"https://api.github.com/users/cBournhonesque/following{/other_user}","gists_url":"https://api.github.com/users/cBournhonesque/gists{/gist_id}","starred_url":"https://api.github.com/users/cBournhonesque/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cBournhonesque/subscriptions","organizations_url":"https://api.github.com/users/cBournhonesque/orgs","repos_url":"https://api.github.com/users/cBournhonesque/repos","events_url":"https://api.github.com/users/cBournhonesque/events{/privacy}","received_events_url":"https://api.github.com/users/cBournhonesque/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2263405204","html_url":"https://github.com/bevyengine/bevy/issues/14348#issuecomment-2263405204","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/14348","id":2263405204,"node_id":"IC_kwDODf6-U86G6NKU","user":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-01T15:51:17Z","updated_at":"2024-08-01T15:51:17Z","body":"> would not work because the check of which type of cursor we are is still done dynamically?\r\n\r\nYes\r\n\r\n> I was hoping that after the Cursor creation, the other functions would just be called statically. We only need to check the `is_dense` at cursor creation, not after\r\n\r\nIn the end you want to do different things in `next` depending on whether the query is actually dense or not, so you need a branch there, there's no way around that. Moving the dense check at cursor creation just changes what the branch in `next` will be, but ultimately you need a branch or to let go of the dense iteration optimization.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/2263405204/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"cBournhonesque","id":8112632,"node_id":"MDQ6VXNlcjgxMTI2MzI=","avatar_url":"https://avatars.githubusercontent.com/u/8112632?v=4","gravatar_id":"","url":"https://api.github.com/users/cBournhonesque","html_url":"https://github.com/cBournhonesque","followers_url":"https://api.github.com/users/cBournhonesque/followers","following_url":"https://api.github.com/users/cBournhonesque/following{/other_user}","gists_url":"https://api.github.com/users/cBournhonesque/gists{/gist_id}","starred_url":"https://api.github.com/users/cBournhonesque/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cBournhonesque/subscriptions","organizations_url":"https://api.github.com/users/cBournhonesque/orgs","repos_url":"https://api.github.com/users/cBournhonesque/repos","events_url":"https://api.github.com/users/cBournhonesque/events{/privacy}","received_events_url":"https://api.github.com/users/cBournhonesque/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-02T19:34:00Z","updated_at":"2024-08-02T19:34:00Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14596","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/14596/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/14596/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/14596/events","html_url":"https://github.com/bevyengine/bevy/pull/14596","id":2445644293,"node_id":"PR_kwDODf6-U853Sy2Y","number":14596,"title":"Update QueryBuilder to change the type after each transformation","user":{"login":"cBournhonesque","id":8112632,"node_id":"MDQ6VXNlcjgxMTI2MzI=","avatar_url":"https://avatars.githubusercontent.com/u/8112632?v=4","gravatar_id":"","url":"https://api.github.com/users/cBournhonesque","html_url":"https://github.com/cBournhonesque","followers_url":"https://api.github.com/users/cBournhonesque/followers","following_url":"https://api.github.com/users/cBournhonesque/following{/other_user}","gists_url":"https://api.github.com/users/cBournhonesque/gists{/gist_id}","starred_url":"https://api.github.com/users/cBournhonesque/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/cBournhonesque/subscriptions","organizations_url":"https://api.github.com/users/cBournhonesque/orgs","repos_url":"https://api.github.com/users/cBournhonesque/repos","events_url":"https://api.github.com/users/cBournhonesque/events{/privacy}","received_events_url":"https://api.github.com/users/cBournhonesque/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2197761682,"node_id":"MDU6TGFiZWwyMTk3NzYxNjgy","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-ECS","name":"A-ECS","color":"c6a751","default":false,"description":"Entities, components, systems, and events"},{"id":3166143717,"node_id":"MDU6TGFiZWwzMTY2MTQzNzE3","url":"https://api.github.com/repos/bevyengine/bevy/labels/D-Complex","name":"D-Complex","color":"008672","default":false,"description":"Quite challenging from either a design or technical perspective. Ask for help!"},{"id":4102809496,"node_id":"LA_kwDODf6-U870i-eY","url":"https://api.github.com/repos/bevyengine/bevy/labels/P-Unsound","name":"P-Unsound","color":"FF7b00","default":false,"description":"A bug that results in undefined compiler behavior"},{"id":6899591173,"node_id":"LA_kwDODf6-U88AAAABmz9oBQ","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Waiting-on-Author","name":"S-Waiting-on-Author","color":"D876E3","default":false,"description":"The author needs to make changes or address concerns before this can be merged"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-08-02T19:33:59Z","updated_at":"2024-08-30T17:16:44Z","closed_at":"2024-08-30T17:16:44Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":true,"repository":{"id":234798675,"node_id":"MDEwOlJlcG9zaXRvcnkyMzQ3OTg2NzU=","name":"bevy","full_name":"bevyengine/bevy","private":false,"owner":{"login":"bevyengine","id":60047606,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYwMDQ3NjA2","avatar_url":"https://avatars.githubusercontent.com/u/60047606?v=4","gravatar_id":"","url":"https://api.github.com/users/bevyengine","html_url":"https://github.com/bevyengine","followers_url":"https://api.github.com/users/bevyengine/followers","following_url":"https://api.github.com/users/bevyengine/following{/other_user}","gists_url":"https://api.github.com/users/bevyengine/gists{/gist_id}","starred_url":"https://api.github.com/users/bevyengine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bevyengine/subscriptions","organizations_url":"https://api.github.com/users/bevyengine/orgs","repos_url":"https://api.github.com/users/bevyengine/repos","events_url":"https://api.github.com/users/bevyengine/events{/privacy}","received_events_url":"https://api.github.com/users/bevyengine/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bevyengine/bevy","description":"A refreshingly simple data-driven game engine built in Rust","fork":false,"url":"https://api.github.com/repos/bevyengine/bevy","forks_url":"https://api.github.com/repos/bevyengine/bevy/forks","keys_url":"https://api.github.com/repos/bevyengine/bevy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bevyengine/bevy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bevyengine/bevy/teams","hooks_url":"https://api.github.com/repos/bevyengine/bevy/hooks","issue_events_url":"https://api.github.com/repos/bevyengine/bevy/issues/events{/number}","events_url":"https://api.github.com/repos/bevyengine/bevy/events","assignees_url":"https://api.github.com/repos/bevyengine/bevy/assignees{/user}","branches_url":"https://api.github.com/repos/bevyengine/bevy/branches{/branch}","tags_url":"https://api.github.com/repos/bevyengine/bevy/tags","blobs_url":"https://api.github.com/repos/bevyengine/bevy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bevyengine/bevy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bevyengine/bevy/git/refs{/sha}","trees_url":"https://api.github.com/repos/bevyengine/bevy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bevyengine/bevy/statuses/{sha}","languages_url":"https://api.github.com/repos/bevyengine/bevy/languages","stargazers_url":"https://api.github.com/repos/bevyengine/bevy/stargazers","contributors_url":"https://api.github.com/repos/bevyengine/bevy/contributors","subscribers_url":"https://api.github.com/repos/bevyengine/bevy/subscribers","subscription_url":"https://api.github.com/repos/bevyengine/bevy/subscription","commits_url":"https://api.github.com/repos/bevyengine/bevy/commits{/sha}","git_commits_url":"https://api.github.com/repos/bevyengine/bevy/git/commits{/sha}","comments_url":"https://api.github.com/repos/bevyengine/bevy/comments{/number}","issue_comment_url":"https://api.github.com/repos/bevyengine/bevy/issues/comments{/number}","contents_url":"https://api.github.com/repos/bevyengine/bevy/contents/{+path}","compare_url":"https://api.github.com/repos/bevyengine/bevy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bevyengine/bevy/merges","archive_url":"https://api.github.com/repos/bevyengine/bevy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bevyengine/bevy/downloads","issues_url":"https://api.github.com/repos/bevyengine/bevy/issues{/number}","pulls_url":"https://api.github.com/repos/bevyengine/bevy/pulls{/number}","milestones_url":"https://api.github.com/repos/bevyengine/bevy/milestones{/number}","notifications_url":"https://api.github.com/repos/bevyengine/bevy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bevyengine/bevy/labels{/name}","releases_url":"https://api.github.com/repos/bevyengine/bevy/releases{/id}","deployments_url":"https://api.github.com/repos/bevyengine/bevy/deployments","created_at":"2020-01-18T21:13:55Z","updated_at":"2025-11-10T00:30:24Z","pushed_at":"2025-11-09T20:05:46Z","git_url":"git://github.com/bevyengine/bevy.git","ssh_url":"git@github.com:bevyengine/bevy.git","clone_url":"https://github.com/bevyengine/bevy.git","svn_url":"https://github.com/bevyengine/bevy","homepage":"https://bevy.org","size":152673,"stargazers_count":42996,"watchers_count":42996,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":4220,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3116,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bevy","game-development","game-engine","gamedev","open-source","rust"],"visibility":"public","forks":4220,"open_issues":3116,"watchers":42996,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/bevyengine/bevy/pulls/14596","html_url":"https://github.com/bevyengine/bevy/pull/14596","diff_url":"https://github.com/bevyengine/bevy/pull/14596.diff","patch_url":"https://github.com/bevyengine/bevy/pull/14596.patch","merged_at":null},"body":"# Objective\r\n\r\n- I wanted to fix https://github.com/bevyengine/bevy/issues/14348 by making sure that the types `D` and `F` in the QueryBuilder are always up to date so that the query optimizations work but actually this approach doesn't seem to work because:\r\n\r\n1) I get a rust error that I don't know how to resolve\r\n```\r\nerror[E0505]: cannot move out of `self` because it is borrowed\r\n   --> crates/bevy_ecs/src/query/builder.rs:209:38\r\n    |\r\n42  | impl<'w, D: QueryData, F: QueryFilter> QueryBuilder<'w, D, F> {\r\n    |      -- lifetime `'w` defined here\r\n...\r\n200 |     pub fn or<F2: QueryFilter>(mut self, f: impl Fn(QueryBuilder<'w>) -> QueryBuilder<'w, (), F2>) -> QueryBuilder<'w, D, Or<(F, F2)>> {\r\n    |                                -------- binding `self` declared here\r\n201 |         let mut builder = QueryBuilder::new(self.world);\r\n    |                           -----------------------------\r\n    |                           |                 |\r\n    |                           |                 borrow of `*self.world` occurs here\r\n    |                           argument requires that `*self.world` is borrowed for `'w`\r\n...\r\n209 |         unsafe { std::mem::transmute(self) }\r\n    |                                      ^^^^ move out of `self` occurs here\r\n```\r\n\r\n2) The system used to finish building the `SystemBuilder` often won't have a signature that matches the output of the QueryBuilder.\r\nFor example I get this error:\r\n```\r\nwarning: build failed, waiting for other jobs to finish...\r\nerror[E0271]: type mismatch resolving `<Query<'_, '_, (), With<A>> as BuildableSystemParam>::OutputBuilder == QueryBuilder<'_, (), (_, With<A>)>`\r\n   --> crates/bevy_ecs/src/system/builder.rs:191:14\r\n    |\r\n191 |             .builder(|w: &mut World| {\r\n    |              ^^^^^^^ type mismatch resolving `<Query<'_, '_, (), With<A>> as BuildableSystemParam>::OutputBuilder == QueryBuilder<'_, (), (_, With<A>)>`\r\n    |\r\nnote: expected this to be `query::builder::QueryBuilder<'_, (), filter::With<system::builder::tests::A>>`\r\n   --> crates/bevy_ecs/src/system/system_param.rs:261:26\r\n    |\r\n261 |     type OutputBuilder = QueryBuilder<'w, D, F>;\r\n    |                          ^^^^^^^^^^^^^^^^^^^^^^\r\n    = note: expected struct `query::builder::QueryBuilder<'_, _, filter::With<system::builder::tests::A>>`\r\n               found struct `query::builder::QueryBuilder<'_, _, (_, filter::With<system::builder::tests::A>)>`\r\n```\r\n\r\nHowever I still think it's worthwhile posting the draft just to demonstrate the approach and to get some feedback\r\n@SkiFire13 @james-j-obrien \r\n\r\nMaybe it's actually a feature (and not a bug) to have a Query that iterates on data that doesn't exactly match the types (D, F)?\r\nI know it's already used in `QueryLens` and `QueryBuilder`, so maybe it's something we'd like to keep?\r\n\r\nMaybe a better solution would then be https://github.com/bevyengine/bevy/issues/14348#issuecomment-2263405204","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14596/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/14596/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-04T13:48:58Z","updated_at":"2024-08-04T13:48:58Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14611","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/14611/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/14611/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/14611/events","html_url":"https://github.com/bevyengine/bevy/pull/14611","id":2447143539,"node_id":"PR_kwDODf6-U853Xzga","number":14611,"title":"Fix query transmute from table to archetype iteration unsoundness","user":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619323,"node_id":"MDU6TGFiZWwxNzk1NjE5MzIz","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Bug","name":"C-Bug","color":"d73a4a","default":false,"description":"An unexpected or incorrect behavior"},{"id":2197761682,"node_id":"MDU6TGFiZWwyMTk3NzYxNjgy","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-ECS","name":"A-ECS","color":"c6a751","default":false,"description":"Entities, components, systems, and events"},{"id":3166133948,"node_id":"MDU6TGFiZWwzMTY2MTMzOTQ4","url":"https://api.github.com/repos/bevyengine/bevy/labels/M-Migration-Guide","name":"M-Migration-Guide","color":"006B75","default":false,"description":"A breaking change to Bevy's public API that needs to be noted in a migration guide"},{"id":3166143717,"node_id":"MDU6TGFiZWwzMTY2MTQzNzE3","url":"https://api.github.com/repos/bevyengine/bevy/labels/D-Complex","name":"D-Complex","color":"008672","default":false,"description":"Quite challenging from either a design or technical perspective. Ask for help!"},{"id":4141523492,"node_id":"LA_kwDODf6-U8722qIk","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Needs-Benchmarking","name":"S-Needs-Benchmarking","color":"d876e3","default":false,"description":"This set of changes needs performance benchmarking to double-check that they help"},{"id":6899591173,"node_id":"LA_kwDODf6-U88AAAABmz9oBQ","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Waiting-on-Author","name":"S-Waiting-on-Author","color":"D876E3","default":false,"description":"The author needs to make changes or address concerns before this can be merged"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2024-08-04T13:48:57Z","updated_at":"2024-08-28T06:24:48Z","closed_at":"2024-08-19T16:47:15Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":234798675,"node_id":"MDEwOlJlcG9zaXRvcnkyMzQ3OTg2NzU=","name":"bevy","full_name":"bevyengine/bevy","private":false,"owner":{"login":"bevyengine","id":60047606,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYwMDQ3NjA2","avatar_url":"https://avatars.githubusercontent.com/u/60047606?v=4","gravatar_id":"","url":"https://api.github.com/users/bevyengine","html_url":"https://github.com/bevyengine","followers_url":"https://api.github.com/users/bevyengine/followers","following_url":"https://api.github.com/users/bevyengine/following{/other_user}","gists_url":"https://api.github.com/users/bevyengine/gists{/gist_id}","starred_url":"https://api.github.com/users/bevyengine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bevyengine/subscriptions","organizations_url":"https://api.github.com/users/bevyengine/orgs","repos_url":"https://api.github.com/users/bevyengine/repos","events_url":"https://api.github.com/users/bevyengine/events{/privacy}","received_events_url":"https://api.github.com/users/bevyengine/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bevyengine/bevy","description":"A refreshingly simple data-driven game engine built in Rust","fork":false,"url":"https://api.github.com/repos/bevyengine/bevy","forks_url":"https://api.github.com/repos/bevyengine/bevy/forks","keys_url":"https://api.github.com/repos/bevyengine/bevy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bevyengine/bevy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bevyengine/bevy/teams","hooks_url":"https://api.github.com/repos/bevyengine/bevy/hooks","issue_events_url":"https://api.github.com/repos/bevyengine/bevy/issues/events{/number}","events_url":"https://api.github.com/repos/bevyengine/bevy/events","assignees_url":"https://api.github.com/repos/bevyengine/bevy/assignees{/user}","branches_url":"https://api.github.com/repos/bevyengine/bevy/branches{/branch}","tags_url":"https://api.github.com/repos/bevyengine/bevy/tags","blobs_url":"https://api.github.com/repos/bevyengine/bevy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bevyengine/bevy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bevyengine/bevy/git/refs{/sha}","trees_url":"https://api.github.com/repos/bevyengine/bevy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bevyengine/bevy/statuses/{sha}","languages_url":"https://api.github.com/repos/bevyengine/bevy/languages","stargazers_url":"https://api.github.com/repos/bevyengine/bevy/stargazers","contributors_url":"https://api.github.com/repos/bevyengine/bevy/contributors","subscribers_url":"https://api.github.com/repos/bevyengine/bevy/subscribers","subscription_url":"https://api.github.com/repos/bevyengine/bevy/subscription","commits_url":"https://api.github.com/repos/bevyengine/bevy/commits{/sha}","git_commits_url":"https://api.github.com/repos/bevyengine/bevy/git/commits{/sha}","comments_url":"https://api.github.com/repos/bevyengine/bevy/comments{/number}","issue_comment_url":"https://api.github.com/repos/bevyengine/bevy/issues/comments{/number}","contents_url":"https://api.github.com/repos/bevyengine/bevy/contents/{+path}","compare_url":"https://api.github.com/repos/bevyengine/bevy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bevyengine/bevy/merges","archive_url":"https://api.github.com/repos/bevyengine/bevy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bevyengine/bevy/downloads","issues_url":"https://api.github.com/repos/bevyengine/bevy/issues{/number}","pulls_url":"https://api.github.com/repos/bevyengine/bevy/pulls{/number}","milestones_url":"https://api.github.com/repos/bevyengine/bevy/milestones{/number}","notifications_url":"https://api.github.com/repos/bevyengine/bevy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bevyengine/bevy/labels{/name}","releases_url":"https://api.github.com/repos/bevyengine/bevy/releases{/id}","deployments_url":"https://api.github.com/repos/bevyengine/bevy/deployments","created_at":"2020-01-18T21:13:55Z","updated_at":"2025-11-10T00:30:24Z","pushed_at":"2025-11-09T20:05:46Z","git_url":"git://github.com/bevyengine/bevy.git","ssh_url":"git@github.com:bevyengine/bevy.git","clone_url":"https://github.com/bevyengine/bevy.git","svn_url":"https://github.com/bevyengine/bevy","homepage":"https://bevy.org","size":152673,"stargazers_count":42996,"watchers_count":42996,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":4220,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3116,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bevy","game-development","game-engine","gamedev","open-source","rust"],"visibility":"public","forks":4220,"open_issues":3116,"watchers":42996,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/bevyengine/bevy/pulls/14611","html_url":"https://github.com/bevyengine/bevy/pull/14611","diff_url":"https://github.com/bevyengine/bevy/pull/14611.diff","patch_url":"https://github.com/bevyengine/bevy/pull/14611.patch","merged_at":null},"body":"# Objective\r\n\r\n- Fixes #14348 \r\n- Fixes #14528\r\n- Fixes the fundamental issue with the table vs archetype iteration optimization not being compatible with dynamic query filters\r\n    - The table vs archetype iteration optimization switches between iterating over tables when all the query filters are dense;\r\n    - However to get good performance, especially in `QueryIter::next` (used for iterating with `for`), this needs to be a compile time switch on `D::IS_DENSE && F::IS_DENSE`;\r\n    - We thus need to setup this compiler time check in such a way that when dynamic query filters that require archetype iteration may be present then this compiler time check is false.\r\n    - An alternative not explored in this PR would be to remove the table iteration optimization from `QueryIter::next` (while keeping it where a dynamic check is acceptable).\r\n\r\n- NOTE: this is a pretty big breaking change. Where possible I've tried to make the migration manageable by introducing type aliases and some conversions.\r\n\r\n## Solution\r\n\r\n- Introduce a new parameter `M` to `Query`, `QueryState`, `QueryIter` and other similar types, which contains a compile type switch on whether the query is static (i.e. its filters are only determined by the `D` and `F` parameters) or dynamic (e.g. the `Query`s produced by `QueryBuilder` and `QueryState::transmute`). The allowed types for `M` are `StaticMarker` and `DynamicMarker`, and a sealed trait used to limit parameter to only these two types.\r\n- I choose to default this type parameter to `StaticMarker`, meaning existing `Query`s that don't use dynamic filters will continue to benefit from the table iteration optimization, while however breaking the code for users that used dynamic filters. For making it easier to migrate to use `DynamicMarker` I introduced a `DynQuery` and `DynQueryState` type aliases.\r\n    - The alternative would be doing the opposite, but this would be a silent performance regression for users not using dynamic queries, and will forever be a footgun to not use an hypothesis `StaticQuery`.\r\n- Introduce a new `is_dense` field in `QueryBuilder` which will reflect whether the dynamic filters are dense or not. This will have two uses:\r\n    - It allows transmuting `Query`/`QueryState` with a static marker to one with a dynamic marker, where the crucial part is ensuring the the `matched_storage_ids` is still accessed in the same way; this also helps the migration between uses of these queries;\r\n    - It allows using table iteration in situations where a dynamic check is not very costly, e.g. in `QueryIter::for_each`, hence limiting the performance difference to `QueryIter::next`.\r\n\r\n## Migration Guide\r\n\r\n- `Query`, `QueryState`, `QueryIter` and other `Query`-related types now have a third `M` generic parameter which is either `StaticMarker` or `DynamicMarker`, depending on whether dynamic filters are allowed or not, with `StaticMarker` as default;\r\n- It will not be possible to produce a `Query` with a `StaticMarker` from APIs that allow dynamic filters, like `QueryBuilder`, `Query::transmute_lens` and `QueryState::transmute`;\r\n- If you were using dynamic filters you can switch your `Query`es to use the `DynamicMarker`; the `DynQuery` and `DynQueryState` type aliases can be used to make this shorter to type. This will basically restore the functionality to before this change, at the cost of a performance penality when iterating using `for` over dense queries (which were previously broken).","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14611/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/14611/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-04T20:43:23Z","updated_at":"2024-08-04T20:43:23Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14615","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/14615/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/14615/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/14615/events","html_url":"https://github.com/bevyengine/bevy/pull/14615","id":2447289728,"node_id":"PR_kwDODf6-U853YQ0H","number":14615,"title":"Fix query transmute from table to archetype iteration unsoundness","user":{"login":"SkiFire13","id":9020423,"node_id":"MDQ6VXNlcjkwMjA0MjM=","avatar_url":"https://avatars.githubusercontent.com/u/9020423?v=4","gravatar_id":"","url":"https://api.github.com/users/SkiFire13","html_url":"https://github.com/SkiFire13","followers_url":"https://api.github.com/users/SkiFire13/followers","following_url":"https://api.github.com/users/SkiFire13/following{/other_user}","gists_url":"https://api.github.com/users/SkiFire13/gists{/gist_id}","starred_url":"https://api.github.com/users/SkiFire13/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/SkiFire13/subscriptions","organizations_url":"https://api.github.com/users/SkiFire13/orgs","repos_url":"https://api.github.com/users/SkiFire13/repos","events_url":"https://api.github.com/users/SkiFire13/events{/privacy}","received_events_url":"https://api.github.com/users/SkiFire13/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619323,"node_id":"MDU6TGFiZWwxNzk1NjE5MzIz","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Bug","name":"C-Bug","color":"d73a4a","default":false,"description":"An unexpected or incorrect behavior"},{"id":2197761682,"node_id":"MDU6TGFiZWwyMTk3NzYxNjgy","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-ECS","name":"A-ECS","color":"c6a751","default":false,"description":"Entities, components, systems, and events"},{"id":2747865511,"node_id":"MDU6TGFiZWwyNzQ3ODY1NTEx","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Ready-For-Final-Review","name":"S-Ready-For-Final-Review","color":"D876E3","default":false,"description":"This PR has been approved by the community. It's ready for a maintainer to consider merging it"},{"id":4102809496,"node_id":"LA_kwDODf6-U870i-eY","url":"https://api.github.com/repos/bevyengine/bevy/labels/P-Unsound","name":"P-Unsound","color":"FF7b00","default":false,"description":"A bug that results in undefined compiler behavior"},{"id":6899583116,"node_id":"LA_kwDODf6-U88AAAABmz9IjA","url":"https://api.github.com/repos/bevyengine/bevy/labels/D-Unsafe","name":"D-Unsafe","color":"008672","default":false,"description":"Touches with unsafe code in some way"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-08-04T20:43:23Z","updated_at":"2024-08-28T06:24:40Z","closed_at":"2024-08-27T01:14:43Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":234798675,"node_id":"MDEwOlJlcG9zaXRvcnkyMzQ3OTg2NzU=","name":"bevy","full_name":"bevyengine/bevy","private":false,"owner":{"login":"bevyengine","id":60047606,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYwMDQ3NjA2","avatar_url":"https://avatars.githubusercontent.com/u/60047606?v=4","gravatar_id":"","url":"https://api.github.com/users/bevyengine","html_url":"https://github.com/bevyengine","followers_url":"https://api.github.com/users/bevyengine/followers","following_url":"https://api.github.com/users/bevyengine/following{/other_user}","gists_url":"https://api.github.com/users/bevyengine/gists{/gist_id}","starred_url":"https://api.github.com/users/bevyengine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bevyengine/subscriptions","organizations_url":"https://api.github.com/users/bevyengine/orgs","repos_url":"https://api.github.com/users/bevyengine/repos","events_url":"https://api.github.com/users/bevyengine/events{/privacy}","received_events_url":"https://api.github.com/users/bevyengine/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bevyengine/bevy","description":"A refreshingly simple data-driven game engine built in Rust","fork":false,"url":"https://api.github.com/repos/bevyengine/bevy","forks_url":"https://api.github.com/repos/bevyengine/bevy/forks","keys_url":"https://api.github.com/repos/bevyengine/bevy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bevyengine/bevy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bevyengine/bevy/teams","hooks_url":"https://api.github.com/repos/bevyengine/bevy/hooks","issue_events_url":"https://api.github.com/repos/bevyengine/bevy/issues/events{/number}","events_url":"https://api.github.com/repos/bevyengine/bevy/events","assignees_url":"https://api.github.com/repos/bevyengine/bevy/assignees{/user}","branches_url":"https://api.github.com/repos/bevyengine/bevy/branches{/branch}","tags_url":"https://api.github.com/repos/bevyengine/bevy/tags","blobs_url":"https://api.github.com/repos/bevyengine/bevy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bevyengine/bevy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bevyengine/bevy/git/refs{/sha}","trees_url":"https://api.github.com/repos/bevyengine/bevy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bevyengine/bevy/statuses/{sha}","languages_url":"https://api.github.com/repos/bevyengine/bevy/languages","stargazers_url":"https://api.github.com/repos/bevyengine/bevy/stargazers","contributors_url":"https://api.github.com/repos/bevyengine/bevy/contributors","subscribers_url":"https://api.github.com/repos/bevyengine/bevy/subscribers","subscription_url":"https://api.github.com/repos/bevyengine/bevy/subscription","commits_url":"https://api.github.com/repos/bevyengine/bevy/commits{/sha}","git_commits_url":"https://api.github.com/repos/bevyengine/bevy/git/commits{/sha}","comments_url":"https://api.github.com/repos/bevyengine/bevy/comments{/number}","issue_comment_url":"https://api.github.com/repos/bevyengine/bevy/issues/comments{/number}","contents_url":"https://api.github.com/repos/bevyengine/bevy/contents/{+path}","compare_url":"https://api.github.com/repos/bevyengine/bevy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bevyengine/bevy/merges","archive_url":"https://api.github.com/repos/bevyengine/bevy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bevyengine/bevy/downloads","issues_url":"https://api.github.com/repos/bevyengine/bevy/issues{/number}","pulls_url":"https://api.github.com/repos/bevyengine/bevy/pulls{/number}","milestones_url":"https://api.github.com/repos/bevyengine/bevy/milestones{/number}","notifications_url":"https://api.github.com/repos/bevyengine/bevy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bevyengine/bevy/labels{/name}","releases_url":"https://api.github.com/repos/bevyengine/bevy/releases{/id}","deployments_url":"https://api.github.com/repos/bevyengine/bevy/deployments","created_at":"2020-01-18T21:13:55Z","updated_at":"2025-11-10T00:30:24Z","pushed_at":"2025-11-09T20:05:46Z","git_url":"git://github.com/bevyengine/bevy.git","ssh_url":"git@github.com:bevyengine/bevy.git","clone_url":"https://github.com/bevyengine/bevy.git","svn_url":"https://github.com/bevyengine/bevy","homepage":"https://bevy.org","size":152673,"stargazers_count":42996,"watchers_count":42996,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":4220,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3116,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bevy","game-development","game-engine","gamedev","open-source","rust"],"visibility":"public","forks":4220,"open_issues":3116,"watchers":42996,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/bevyengine/bevy/pulls/14615","html_url":"https://github.com/bevyengine/bevy/pull/14615","diff_url":"https://github.com/bevyengine/bevy/pull/14615.diff","patch_url":"https://github.com/bevyengine/bevy/pull/14615.patch","merged_at":"2024-08-27T01:14:43Z"},"body":"# Objective\r\n\r\n- Fixes #14348 \r\n- Fixes #14528\r\n- Less complex (but also likely less performant) alternative to #14611\r\n\r\n## Solution\r\n\r\n- Add a `is_dense` field flag to `QueryIter` indicating whether it is dense or not, that is whether it can perform dense iteration or not;\r\n- Check this flag any time iteration over a query is performed.\r\n\r\n---\r\n\r\nIt would be nice if someone could try benching this change to see if it actually matters.\r\n\r\n~Note that this not 100% ready for mergin, since there are a bunch of safety comments on the use of the various `IS_DENSE` for checks that still need to be updated.~ This is ready modulo benchmarks","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14615/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":2,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/14615/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":14020758182,"node_id":"REFE_lADODf6-U86PukINzwAAAANDs8qm","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/14020758182","actor":{"login":"github-merge-queue[bot]","id":118344674,"node_id":"BOT_kgDOBw3L4g","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github-merge-queue%5Bbot%5D","html_url":"https://github.com/apps/github-merge-queue","followers_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"e320fa0738e3f4582b0d61db85a00d7a70b676eb","commit_url":"https://api.github.com/repos/bevyengine/bevy/commits/e320fa0738e3f4582b0d61db85a00d7a70b676eb","created_at":"2024-08-27T01:14:43Z","performed_via_github_app":null},{"id":14020758315,"node_id":"CE_lADODf6-U86PukINzwAAAANDs8sr","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/14020758315","actor":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2024-08-27T01:14:44Z","state_reason":null,"performed_via_github_app":null}]