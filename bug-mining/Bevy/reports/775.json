{"url":"https://api.github.com/repos/bevyengine/bevy/issues/17478","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/17478/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/17478/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/17478/events","html_url":"https://github.com/bevyengine/bevy/issues/17478","id":2802803378,"node_id":"I_kwDODf6-U86nD2Ky","number":17478,"title":"Missing a method to insert related entities at a specific index (`insert_children`)","user":{"login":"villor","id":7102243,"node_id":"MDQ6VXNlcjcxMDIyNDM=","avatar_url":"https://avatars.githubusercontent.com/u/7102243?v=4","gravatar_id":"","url":"https://api.github.com/users/villor","html_url":"https://github.com/villor","followers_url":"https://api.github.com/users/villor/followers","following_url":"https://api.github.com/users/villor/following{/other_user}","gists_url":"https://api.github.com/users/villor/gists{/gist_id}","starred_url":"https://api.github.com/users/villor/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/villor/subscriptions","organizations_url":"https://api.github.com/users/villor/orgs","repos_url":"https://api.github.com/users/villor/repos","events_url":"https://api.github.com/users/villor/events{/privacy}","received_events_url":"https://api.github.com/users/villor/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2197761682,"node_id":"MDU6TGFiZWwyMTk3NzYxNjgy","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-ECS","name":"A-ECS","color":"c6a751","default":false,"description":"Entities, components, systems, and events"},{"id":2747857990,"node_id":"MDU6TGFiZWwyNzQ3ODU3OTkw","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Usability","name":"C-Usability","color":"b8b8b8","default":false,"description":"A targeted quality-of-life change that makes Bevy easier to use"},{"id":2860079228,"node_id":"MDU6TGFiZWwyODYwMDc5MjI4","url":"https://api.github.com/repos/bevyengine/bevy/labels/P-Regression","name":"P-Regression","color":"FF7B00","default":false,"description":"Functionality that used to work but no longer does. Add a test for this!"},{"id":3166151441,"node_id":"MDU6TGFiZWwzMTY2MTUxNDQx","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Ready-For-Implementation","name":"S-Ready-For-Implementation","color":"D876E3","default":false,"description":"This issue is ready for an implementation PR. Go for it!"},{"id":6899571146,"node_id":"LA_kwDODf6-U88AAAABmz8Zyg","url":"https://api.github.com/repos/bevyengine/bevy/labels/D-Straightforward","name":"D-Straightforward","color":"008672","default":false,"description":"Simple bug fixes and API improvements, docs, test and examples"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/bevyengine/bevy/milestones/28","html_url":"https://github.com/bevyengine/bevy/milestone/28","labels_url":"https://api.github.com/repos/bevyengine/bevy/milestones/28/labels","id":11655039,"node_id":"MI_kwDODf6-U84Asdd_","number":28,"title":"0.16","description":"","creator":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":558,"state":"closed","created_at":"2024-09-30T20:15:21Z","updated_at":"2025-04-25T13:01:43Z","due_on":null,"closed_at":"2025-04-25T13:01:43Z"},"comments":1,"created_at":"2025-01-21T21:01:08Z","updated_at":"2025-04-01T02:43:43Z","closed_at":"2025-04-01T02:43:43Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## What problem does this solve or what need does it fill?\n\nBefore #17398 there was a pretty handy method for inserting a slice of children at a specific index: [insert_children](https://docs.rs/bevy_hierarchy/0.15.1/src/bevy_hierarchy/child_builder.rs.html#645)\n\nNot sure if it was intentionally left out, or just lost in the process. It's pretty useful for UI sometimes when needing to insert one or more children in specific spots.\n\nWhile migrating `bevy_editor_prototypes` I resorted to an extension for now:\n```rust\nimpl InsertChildrenExt for EntityWorldMut<'_> {\n    fn insert_children(&mut self, index: usize, children: &[Entity]) {\n        let prev_children = self.take::<Children>().unwrap_or_default();\n        let (prev_left, prev_right) = prev_children.split_at(index);\n\n        let parent_id = self.id();\n        self.world_scope(|world| {\n            for child in prev_left.iter().chain(children).chain(prev_right) {\n                world.entity_mut(*child).insert(ChildOf(parent_id));\n            }\n        });\n    }\n}\n```\n\n## What solution would you like?\n\n- Add `insert_related` method on `EntityWorldMut`/`EntityCommands`, inserting a `&[Entity]` (or iterator?) at a specific index.\n- Add `insert_children` for convenience and less breakage when migrating\n\n## What alternative(s) have you considered?\n\n- Could just skip it and let \"user-space\" handle it like the extension above or similar. But seeing as it was in there before, I guess at some point it was deemed useful enough to keep upstream.\n","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/17478/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/17478/timeline","performed_via_github_app":null,"state_reason":"completed"}