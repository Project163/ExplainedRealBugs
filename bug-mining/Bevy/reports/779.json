{"url":"https://api.github.com/repos/bevyengine/bevy/issues/18690","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/18690/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/18690/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/18690/events","html_url":"https://github.com/bevyengine/bevy/issues/18690","id":2967648945,"node_id":"I_kwDODf6-U86w4rqx","number":18690,"title":"Mismatched types and inaccessible methods for HashMap and HashSet in 0.16-rc","user":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2272067174,"node_id":"MDU6TGFiZWwyMjcyMDY3MTc0","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Dependencies","name":"C-Dependencies","color":"b8b8b8","default":false,"description":"A change to the crates that Bevy depends on"},{"id":2747857990,"node_id":"MDU6TGFiZWwyNzQ3ODU3OTkw","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Usability","name":"C-Usability","color":"b8b8b8","default":false,"description":"A targeted quality-of-life change that makes Bevy easier to use"},{"id":2860079228,"node_id":"MDU6TGFiZWwyODYwMDc5MjI4","url":"https://api.github.com/repos/bevyengine/bevy/labels/P-Regression","name":"P-Regression","color":"FF7B00","default":false,"description":"Functionality that used to work but no longer does. Add a test for this!"},{"id":3524678100,"node_id":"LA_kwDODf6-U87SFlHU","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-Utils","name":"A-Utils","color":"c6a751","default":false,"description":"Utility functions and types"},{"id":4058407495,"node_id":"LA_kwDODf6-U87x5mJH","url":"https://api.github.com/repos/bevyengine/bevy/labels/X-Controversial","name":"X-Controversial","color":"D93F0B","default":false,"description":"There is active debate or serious implications around merging this PR"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/bevyengine/bevy/milestones/28","html_url":"https://github.com/bevyengine/bevy/milestone/28","labels_url":"https://api.github.com/repos/bevyengine/bevy/milestones/28/labels","id":11655039,"node_id":"MI_kwDODf6-U84Asdd_","number":28,"title":"0.16","description":"","creator":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":558,"state":"closed","created_at":"2024-09-30T20:15:21Z","updated_at":"2025-04-25T13:01:43Z","due_on":null,"closed_at":"2025-04-25T13:01:43Z"},"comments":10,"created_at":"2025-04-02T22:06:59Z","updated_at":"2025-04-06T18:11:39Z","closed_at":"2025-04-06T18:11:39Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"# Background\n\nhttps://github.com/rust-lang/hashbrown/pull/563 changed the default hasher for `hashbrown` to one that doesn't meet our needs. #15801 updated us to that version of hashbrown, following our dependencies. We were originally using `hashbrown::HashMap` over `std::HashMap` due to the use of  a faster, more vulnerable hashing algorithm, as Bevy apps are generally not exposed to malicious input in this way. \n\n#17460 shuffled our types around, moving `HashMap` and `HashSet` into `bevy_platform_support, as they replace functionality provided by Rust's `std`.\n\nAs part of #15801, we also changed hashers.\n\n#18350 attempts to explain this problem somewhat in the docs.\n\n## Problems\n\nAs discussed in https://github.com/bevyengine/bevy-website/pull/2065, the migration for this is terrible: it's more explicit in confusing ways, there are prominent methods like `new` and `with_capacity` that are simply unusable, despite showing up in the docs!\n\n## Potential solutions\n\n### Use `hashbrown`'s default hasher\n\nThis might or might not be slower than whatever we're using. It fixes the migration / UX issues, and avoids duplicate dependencies though!\n\nThe really critical stuff is already generally using `EntityHashMap` etc, which is very optimized. See #17078 for an example.\n\n### Downgrade to `hashbrown` 0.14\n\nThis gets us parity with Bevy 0.15, but duplicates the dependency in our tree.\n\nIt also doesn't allow us to use the deterministic `FixedHash` (or whatever else we may choose) by default.\n\n### Petition for a better API upstream that can handle non-standard hashers with generics\n\nThis would be great, but due to the need to specify generic type defaults when calling methods, it may not be readily  accepted.\n\nThis is made much worse by the fact that `hashbrown` is used in and aligns with the `std` API for these types, which has very strict stability guarantees.\n\n### Fork `hashbrown` and change the default hasher\n\nThis also duplicates the code, but allows us to properly fix the issue and pull in new fixes and improvements from upstream.\n\nThis is strictly better than relying on 0.14 forever, but adds maintenance burden for a complex utilities crate.","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/18690/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/18690/timeline","performed_via_github_app":null,"state_reason":"completed"}