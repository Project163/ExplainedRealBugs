{"url":"https://api.github.com/repos/bevyengine/bevy/issues/17561","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/17561/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/17561/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/17561/events","html_url":"https://github.com/bevyengine/bevy/issues/17561","id":2813263927,"node_id":"I_kwDODf6-U86nrwA3","number":17561,"title":"UI Node with border radius causes background pixels to come through on the inside of rounded corners","user":{"login":"LucDrenth","id":47307392,"node_id":"MDQ6VXNlcjQ3MzA3Mzky","avatar_url":"https://avatars.githubusercontent.com/u/47307392?v=4","gravatar_id":"","url":"https://api.github.com/users/LucDrenth","html_url":"https://github.com/LucDrenth","followers_url":"https://api.github.com/users/LucDrenth/followers","following_url":"https://api.github.com/users/LucDrenth/following{/other_user}","gists_url":"https://api.github.com/users/LucDrenth/gists{/gist_id}","starred_url":"https://api.github.com/users/LucDrenth/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LucDrenth/subscriptions","organizations_url":"https://api.github.com/users/LucDrenth/orgs","repos_url":"https://api.github.com/users/LucDrenth/repos","events_url":"https://api.github.com/users/LucDrenth/events{/privacy}","received_events_url":"https://api.github.com/users/LucDrenth/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619323,"node_id":"MDU6TGFiZWwxNzk1NjE5MzIz","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Bug","name":"C-Bug","color":"d73a4a","default":false,"description":"An unexpected or incorrect behavior"},{"id":2045383863,"node_id":"MDU6TGFiZWwyMDQ1MzgzODYz","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-Rendering","name":"A-Rendering","color":"C6A751","default":false,"description":"Drawing game state to the screen"},{"id":2276469463,"node_id":"MDU6TGFiZWwyMjc2NDY5NDYz","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-UI","name":"A-UI","color":"c6a751","default":false,"description":"Graphical user interfaces, styles, layouts, and widgets"},{"id":3166151441,"node_id":"MDU6TGFiZWwzMTY2MTUxNDQx","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Ready-For-Implementation","name":"S-Ready-For-Implementation","color":"D876E3","default":false,"description":"This issue is ready for an implementation PR. Go for it!"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":8,"created_at":"2025-01-27T15:01:42Z","updated_at":"2025-09-22T11:23:12Z","closed_at":null,"author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Bevy version\n\nfrom 0.14 (where rounded corners were introduced) until the current main branch\n\n## Relevant system information\n\n```\nSystemInfo { os: \"macOS 15.2 Sequoia\", kernel: \"24.2.0\", cpu: \"Apple M2\", core_count: \"8\", memory: \"16.0 GiB\" }\n```\n\nAlthough I believe this bug exists on every device.\n\n## What you did\n\nSpawn a Node with a border radius that is bigger than the border size, so that the inside of the border become rounded. \n\nExample `main.rs` to reproduce (tested on main branch but should also work with bevy 15.x):\n```\nuse bevy::{\n    color::palettes::css::{BLUE, GREEN, WHITE},\n    prelude::*,\n};\n\nfn main() {\n    App::new()\n        .add_plugins(DefaultPlugins)\n        .add_systems(Startup, setup)\n        .run();\n}\n\nfn setup(mut commands: Commands) {\n    commands.spawn(Camera2d);\n    commands\n        .spawn((\n            Node {\n                align_items: AlignItems::Center,\n                justify_content: JustifyContent::Center,\n                width: Val::Percent(100.),\n                height: Val::Percent(100.),\n                ..default()\n            },\n            BackgroundColor(WHITE.into()),\n        ))\n        .with_children(|parent| {\n            parent.spawn((\n                Node {\n                    width: Val::Percent(80.0),\n                    height: Val::Percent(80.0),\n                    border: UiRect::all(Val::Px(20.)),\n                    ..default()\n                },\n                BackgroundColor(BLUE.into()),\n                BorderColor(GREEN.into()),\n                BorderRadius::all(Val::Px(30.0)),\n            ));\n        });\n}\n```\n\n## What went wrong\n\nIf we zoom in to the edges, you can see that the background comes through\n<img width=\"59\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/39a5940c-4809-4dbe-8519-20bf8285e809\" />\n<img width=\"339\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/11415676-7216-4a35-a6dd-49207b619291\" />\n\nWhile i'd expect it to look like this\n<img width=\"77\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/8ac09b36-5094-4e74-a5f6-4a47cb65578d\" />\n<img width=\"731\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/8fb6d1f7-d5a2-4685-860d-a94ae2d4da9d\" />\n\nThe issue becomes more apparent with more contrasting colors, and especially once you start zooming in.\n\n## Cause of the issue\nAs a bit of background info, a Node with a border gets rendered by having 2 rectangles: 1 for the border (green part of my example images) and 1 for the background (blue part of my example images).\n\nThe problem is that the rectangle for the background is not quite big enough to fully reach the anti-aliased pixels of the inside of the border corners.\n\n## What I tried to do to solve this issue\n1) **Remove anti-aliasing of the background rectangle** \nI did this by using a `t` value of 1.0 instead of any pixel that has a higher `t` value of 0 in the current code. Here `t` refers to `let t` in the relevant fragment shader: `crates/bevy_ui/src/render/ui.wgsl`. Even with this, there was still some bleed-through.\n\n2) **Make the background rectangle bigger** \nI increased the size of the background rectangle by halve of the border size. This fixes the issue if the border has no transparency (which is how I got the images of what I expect a fixed version to look like), but it creates another issue for borders with transparency: the overlapping part of the border and the background make another border (so now there's unintentionally two borders!).\n\n## Proposed solution\nUnify the two separate rectangles of border and background in to 1 rectangle. This way we have fine grained control over the pixel values and we can properly calculate the color without the background coming through.\n\nI don't think there is any real impact or migration guide necessary for this approach.\n\nOnce I get some eyes on this to confirm that this is the right approach, I'd love to implement this myself.\n\n## Related issues\n- probably related to #14456","closed_by":{"login":"mockersf","id":8672791,"node_id":"MDQ6VXNlcjg2NzI3OTE=","avatar_url":"https://avatars.githubusercontent.com/u/8672791?v=4","gravatar_id":"","url":"https://api.github.com/users/mockersf","html_url":"https://github.com/mockersf","followers_url":"https://api.github.com/users/mockersf/followers","following_url":"https://api.github.com/users/mockersf/following{/other_user}","gists_url":"https://api.github.com/users/mockersf/gists{/gist_id}","starred_url":"https://api.github.com/users/mockersf/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mockersf/subscriptions","organizations_url":"https://api.github.com/users/mockersf/orgs","repos_url":"https://api.github.com/users/mockersf/repos","events_url":"https://api.github.com/users/mockersf/events{/privacy}","received_events_url":"https://api.github.com/users/mockersf/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/17561/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/17561/timeline","performed_via_github_app":null,"state_reason":"reopened"}