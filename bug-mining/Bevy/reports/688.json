{"url":"https://api.github.com/repos/bevyengine/bevy/issues/17290","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/17290/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/17290/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/17290/events","html_url":"https://github.com/bevyengine/bevy/issues/17290","id":2781135715,"node_id":"I_kwDODf6-U86lxMNj","number":17290,"title":"It's possible to compile `bevy_image` with `feature = \"dds\"`, without also doing the same for `bevy_core_pipeline` or `bevy_gltf`, resulting in a compilation error","user":{"login":"LikeLakers2","id":1008889,"node_id":"MDQ6VXNlcjEwMDg4ODk=","avatar_url":"https://avatars.githubusercontent.com/u/1008889?v=4","gravatar_id":"","url":"https://api.github.com/users/LikeLakers2","html_url":"https://github.com/LikeLakers2","followers_url":"https://api.github.com/users/LikeLakers2/followers","following_url":"https://api.github.com/users/LikeLakers2/following{/other_user}","gists_url":"https://api.github.com/users/LikeLakers2/gists{/gist_id}","starred_url":"https://api.github.com/users/LikeLakers2/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LikeLakers2/subscriptions","organizations_url":"https://api.github.com/users/LikeLakers2/orgs","repos_url":"https://api.github.com/users/LikeLakers2/repos","events_url":"https://api.github.com/users/LikeLakers2/events{/privacy}","received_events_url":"https://api.github.com/users/LikeLakers2/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619323,"node_id":"MDU6TGFiZWwxNzk1NjE5MzIz","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Bug","name":"C-Bug","color":"d73a4a","default":false,"description":"An unexpected or incorrect behavior"},{"id":2045383863,"node_id":"MDU6TGFiZWwyMDQ1MzgzODYz","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-Rendering","name":"A-Rendering","color":"C6A751","default":false,"description":"Drawing game state to the screen"},{"id":3166152189,"node_id":"MDU6TGFiZWwzMTY2MTUyMTg5","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Needs-Design","name":"S-Needs-Design","color":"D876E3","default":false,"description":"This issue requires design work to think about how it would best be accomplished"},{"id":3662879866,"node_id":"LA_kwDODf6-U87aUxx6","url":"https://api.github.com/repos/bevyengine/bevy/labels/P-Compile-Failure","name":"P-Compile-Failure","color":"FF7B00","default":false,"description":"A failure to compile Bevy apps"},{"id":6899571146,"node_id":"LA_kwDODf6-U88AAAABmz8Zyg","url":"https://api.github.com/repos/bevyengine/bevy/labels/D-Straightforward","name":"D-Straightforward","color":"008672","default":false,"description":"Simple bug fixes and API improvements, docs, test and examples"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-01-10T20:53:10Z","updated_at":"2025-02-17T05:30:43Z","closed_at":"2025-02-17T05:30:43Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"When running `cargo clippy --tests --all-features --package bevy_image` (`--tests` isn't technically required, but it prevents currently-existing errors with `bevy_math` from surfacing), `bevy_core_pipeline` will fail to compile due to not providing a required argument to `bevy_image::Image::from_buffer()`.\n\n<details><summary>Full compilation error log</summary>\n\n```shell\nerror[E0061]: this function takes 7 arguments but 6 arguments were supplied\n   --> crates\\bevy_core_pipeline\\src\\tonemapping\\mod.rs:447:5\n    |\n447 |     Image::from_buffer(\n    |     ^^^^^^^^^^^^^^^^^^\n...\n450 |         bytes,\n    |         ----- argument #1 of type `std::string::String` is missing\n    |\nnote: associated function defined here\n   --> crates\\bevy_image\\src\\image.rs:873:12\n    |\n873 |     pub fn from_buffer(\n    |            ^^^^^^^^^^^\nhelp: provide the argument\n    |\n447 |     Image::from_buffer(/* std::string::String */, bytes, image_type, CompressedImageFormats::NONE, false, image_sampler, RenderAssetUsages::RENDER_WORLD)\n    |                       ~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~\n\nFor more information about this error, try `rustc --explain E0061`.\nerror: could not compile `bevy_core_pipeline` (lib) due to 1 previous error\n```\n</details>\n\nAfter some investigation, I found the issue: if debug assertions are enabled, and `bevy_image` is compiled with `--features dds`, then `bevy_core_pipeline` must also be compiled with `--features dds`, otherwise a compilation error will occur with `bevy_core_pipeline`. To explain:\n\n* Assume debug assertions are on\n* `bevy_image::Image::from_buffer()` takes a `name` parameter - but only if `--features bevy_image/dds` is specified [[1]](https://github.com/bevyengine/bevy/blob/454dd279221da0dc477bb2b7cf8a1da0a8b7e281/crates/bevy_image/src/image.rs#L874)\n* `bevy_core_pipeline` will, under certain circumstances, call `Image::from_buffer()`. If `--features bevy_core_pipeline/dds` is specified, then `bevy_core_pipeline` will pass in the `name` parameter. [[1]](https://github.com/bevyengine/bevy/blob/454dd279221da0dc477bb2b7cf8a1da0a8b7e281/crates/bevy_core_pipeline/src/smaa/mod.rs#L296-L298) [[2]](https://github.com/bevyengine/bevy/blob/454dd279221da0dc477bb2b7cf8a1da0a8b7e281/crates/bevy_core_pipeline/src/smaa/mod.rs#L314-L316) [[3]](https://github.com/bevyengine/bevy/blob/454dd279221da0dc477bb2b7cf8a1da0a8b7e281/crates/bevy_core_pipeline/src/tonemapping/mod.rs#L447-L449)\n* The `bevy_core_pipeline/dds` feature will enable `bevy_image/dds` if it isn't already [[1]](https://github.com/bevyengine/bevy/blob/454dd279221da0dc477bb2b7cf8a1da0a8b7e281/crates/bevy_core_pipeline/Cargo.toml#L16)\n* However, because `bevy_image/dds` does not enable `bevy_core_pipeline/dds`, it's possible to compile with `bevy_image/dds` but without `bevy_core_pipeline/dds`, leading to this compilation error.\n\nI am unsure how to resolve this issue, hence I'm making this bug report.","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/17290/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/17290/timeline","performed_via_github_app":null,"state_reason":"completed"}