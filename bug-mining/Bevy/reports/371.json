{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14952","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/14952/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/14952/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/14952/events","html_url":"https://github.com/bevyengine/bevy/issues/14952","id":2491057186,"node_id":"I_kwDODf6-U86UeoQi","number":14952,"title":"Remove unnecessary muts in `RenderSet::QueueMeshes`","user":{"login":"AllenPocketGamer","id":17348971,"node_id":"MDQ6VXNlcjE3MzQ4OTcx","avatar_url":"https://avatars.githubusercontent.com/u/17348971?v=4","gravatar_id":"","url":"https://api.github.com/users/AllenPocketGamer","html_url":"https://github.com/AllenPocketGamer","followers_url":"https://api.github.com/users/AllenPocketGamer/followers","following_url":"https://api.github.com/users/AllenPocketGamer/following{/other_user}","gists_url":"https://api.github.com/users/AllenPocketGamer/gists{/gist_id}","starred_url":"https://api.github.com/users/AllenPocketGamer/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AllenPocketGamer/subscriptions","organizations_url":"https://api.github.com/users/AllenPocketGamer/orgs","repos_url":"https://api.github.com/users/AllenPocketGamer/repos","events_url":"https://api.github.com/users/AllenPocketGamer/events{/privacy}","received_events_url":"https://api.github.com/users/AllenPocketGamer/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619327,"node_id":"MDU6TGFiZWwxNzk1NjE5MzI3","url":"https://api.github.com/repos/bevyengine/bevy/labels/D-Trivial","name":"D-Trivial","color":"008672","default":false,"description":"Nice and easy! A great choice to get started with Bevy"},{"id":2045383863,"node_id":"MDU6TGFiZWwyMDQ1MzgzODYz","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-Rendering","name":"A-Rendering","color":"C6A751","default":false,"description":"Drawing game state to the screen"},{"id":2287994822,"node_id":"MDU6TGFiZWwyMjg3OTk0ODIy","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Code-Quality","name":"C-Code-Quality","color":"B8B8B8","default":false,"description":"A section of code that is hard to understand or change"},{"id":3166151441,"node_id":"MDU6TGFiZWwzMTY2MTUxNDQx","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Ready-For-Implementation","name":"S-Ready-For-Implementation","color":"D876E3","default":false,"description":"This issue is ready for an implementation PR. Go for it!"},{"id":6899549740,"node_id":"LA_kwDODf6-U88AAAABmz7GLA","url":"https://api.github.com/repos/bevyengine/bevy/labels/X-Uncontroversial","name":"X-Uncontroversial","color":"d93f0b","default":false,"description":"This work is generally agreed upon"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-08-28T05:06:36Z","updated_at":"2024-08-28T11:54:22Z","closed_at":"2024-08-28T11:54:22Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Relavant system information\r\n\r\nnot applicable\r\n\r\n## What I did\r\n\r\nIn the `queue_shadows` function, the parameter `view_light_entities` is defined as mut, but there is no modification of this parameter in the function body(`let Ok(light_entity) = view_light_entities.get_mut(view_light_entity)` can be changed to `let Ok(light_entity) = view_light_entities.get(view_light_entity)` because light_entity is immutable.\r\n\r\nhttps://github.com/bevyengine/bevy/blob/419359b9a7af62939e8d4466d9c539b9a7cf4cf3/crates/bevy_pbr/src/render/light.rs#L1177-L1187\r\n\r\n### Fix to\r\n\r\n```rust\r\n     view_light_entities: Query<&LightEntity>, \r\n     point_light_entities: Query<&CubemapVisibleEntities, With<ExtractedPointLight>>, \r\n     directional_light_entities: Query<&CascadesVisibleEntities, With<ExtractedDirectionalLight>>, \r\n     spot_light_entities: Query<&VisibleMeshEntities, With<ExtractedPointLight>>, \r\n ) where \r\n     M::Data: PartialEq + Eq + Hash + Clone, \r\n { \r\n     for (entity, view_lights) in &view_lights { \r\n         let draw_shadow_mesh = shadow_draw_functions.read().id::<DrawPrepass<M>>(); \r\n         for view_light_entity in view_lights.lights.iter().copied() { \r\n             let Ok(light_entity) = view_light_entities.get(view_light_entity) else { \r\n```\r\n\r\n## What went wrong\r\n\r\nAlthough this doesn't cause any direct bugs, the mut is unnecessary. It might lead other developers to think that the parameter is modified within the function, potentially causing some confusion.\r\n\r\n## Expected Behavior\r\n\r\nRemoving the mut from the view_light_entities parameter will not affect the functionality or performance of the queue_shadows function, and it will improve code readability.","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14952/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/14952/timeline","performed_via_github_app":null,"state_reason":"completed"}