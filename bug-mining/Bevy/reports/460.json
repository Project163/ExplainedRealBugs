{"url":"https://api.github.com/repos/bevyengine/bevy/issues/15600","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/15600/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/15600/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/15600/events","html_url":"https://github.com/bevyengine/bevy/issues/15600","id":2562454878,"node_id":"I_kwDODf6-U86Yu_Ve","number":15600,"title":"Sub View only projects correctly when aspect ratio of `size` and `full_size` match","user":{"login":"m-edlund","id":44649263,"node_id":"MDQ6VXNlcjQ0NjQ5MjYz","avatar_url":"https://avatars.githubusercontent.com/u/44649263?v=4","gravatar_id":"","url":"https://api.github.com/users/m-edlund","html_url":"https://github.com/m-edlund","followers_url":"https://api.github.com/users/m-edlund/followers","following_url":"https://api.github.com/users/m-edlund/following{/other_user}","gists_url":"https://api.github.com/users/m-edlund/gists{/gist_id}","starred_url":"https://api.github.com/users/m-edlund/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/m-edlund/subscriptions","organizations_url":"https://api.github.com/users/m-edlund/orgs","repos_url":"https://api.github.com/users/m-edlund/repos","events_url":"https://api.github.com/users/m-edlund/events{/privacy}","received_events_url":"https://api.github.com/users/m-edlund/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619323,"node_id":"MDU6TGFiZWwxNzk1NjE5MzIz","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Bug","name":"C-Bug","color":"d73a4a","default":false,"description":"An unexpected or incorrect behavior"},{"id":2488007862,"node_id":"MDU6TGFiZWwyNDg4MDA3ODYy","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Needs-Triage","name":"S-Needs-Triage","color":"D876e3","default":false,"description":"This issue needs to be labelled"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-10-02T19:11:00Z","updated_at":"2024-10-05T01:53:45Z","closed_at":"2024-10-05T01:53:45Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Bevy version\n\nMain branch (c841dd92a1480a44d6af803733dd5e4a9cb400a4)\n\n## What you did\n\nI attempted to use the newly added `sub_camera_view` API (#15537 ) to create a subview that overlays a shader effect onto a part of the full image. However this only works when the `size` and `full_size` of the `sub_camera_view` have the same aspect ratio. \n \nI made an example to illustrate this effect in [a fork](https://github.com/m-edlund/bevy/tree/bug/main/subViewProjectionBroken)\n\n## What went wrong\n\nRegardless of the aspect ratios of `size` and `full_size`, the shader effect should cleanly overlap the image of the main camera.\n\nInstead in both orthographic and perspective projection the projection of the sub view is skewed when the aspect ratio of `size` and `full_size` differ. \n\n## Additional information\n\n\nPerspective (overlay working correctly when aspect ratio is the same):\n\n![Image](https://github.com/user-attachments/assets/bb7e7837-4475-46db-b4c7-adb0d7ab253f)\n\n\nPerspective (overlay is skewed when aspect ratios differ):\n\n![Image](https://github.com/user-attachments/assets/4fc48b35-a685-4ca6-936b-decf9f05fcab)\n\nAnalogous in orthographic projection.\n\nTo run the example yourself, check out [the branch](https://github.com/m-edlund/bevy/tree/bug/main/subViewProjectionBroken) and run `cargo run --example camera_sub_view`.\n\nPress P to switch projection and A to switch aspect ratios.\n\n### Likely cause\n\nThe most likely reason is that I made a mistake in the projection calculations [here](https://github.com/bevyengine/bevy/blob/ca709ffb5a9a6c69cbdf5bc88ebc7ac71b1a3128/crates/bevy_render/src/camera/projection.rs#L200-L237) and [here](https://github.com/bevyengine/bevy/blob/ca709ffb5a9a6c69cbdf5bc88ebc7ac71b1a3128/crates/bevy_render/src/camera/projection.rs#L445-L479).\n","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/15600/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/15600/timeline","performed_via_github_app":null,"state_reason":"completed"}