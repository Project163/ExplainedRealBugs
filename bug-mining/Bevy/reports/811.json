{"url":"https://api.github.com/repos/bevyengine/bevy/issues/15849","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/15849/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/15849/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/15849/events","html_url":"https://github.com/bevyengine/bevy/issues/15849","id":2581277037,"node_id":"I_kwDODf6-U86Z2ylt","number":15849,"title":"Rename `StateScoped` to `StateExitDespawn`, add the inverse variant `StateEntryDespawn`","user":{"login":"Jaso333","id":1828763,"node_id":"MDQ6VXNlcjE4Mjg3NjM=","avatar_url":"https://avatars.githubusercontent.com/u/1828763?v=4","gravatar_id":"","url":"https://api.github.com/users/Jaso333","html_url":"https://github.com/Jaso333","followers_url":"https://api.github.com/users/Jaso333/followers","following_url":"https://api.github.com/users/Jaso333/following{/other_user}","gists_url":"https://api.github.com/users/Jaso333/gists{/gist_id}","starred_url":"https://api.github.com/users/Jaso333/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Jaso333/subscriptions","organizations_url":"https://api.github.com/users/Jaso333/orgs","repos_url":"https://api.github.com/users/Jaso333/repos","events_url":"https://api.github.com/users/Jaso333/events{/privacy}","received_events_url":"https://api.github.com/users/Jaso333/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619326,"node_id":"MDU6TGFiZWwxNzk1NjE5MzI2","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Feature","name":"C-Feature","color":"b8b8b8","default":false,"description":"A new feature, making something new possible"},{"id":2197761682,"node_id":"MDU6TGFiZWwyMTk3NzYxNjgy","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-ECS","name":"A-ECS","color":"c6a751","default":false,"description":"Entities, components, systems, and events"},{"id":3166151441,"node_id":"MDU6TGFiZWwzMTY2MTUxNDQx","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Ready-For-Implementation","name":"S-Ready-For-Implementation","color":"D876E3","default":false,"description":"This issue is ready for an implementation PR. Go for it!"},{"id":6899552399,"node_id":"LA_kwDODf6-U88AAAABmz7Qjw","url":"https://api.github.com/repos/bevyengine/bevy/labels/X-Contentious","name":"X-Contentious","color":"D93F0B","default":false,"description":"There are nontrivial implications that should be thought through"},{"id":6899571146,"node_id":"LA_kwDODf6-U88AAAABmz8Zyg","url":"https://api.github.com/repos/bevyengine/bevy/labels/D-Straightforward","name":"D-Straightforward","color":"008672","default":false,"description":"Simple bug fixes and API improvements, docs, test and examples"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2024-10-11T12:34:29Z","updated_at":"2025-05-06T00:57:53Z","closed_at":"2025-05-06T00:57:53Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## What problem does this solve or what need does it fill?\n\nThe current naming of the `StateScoped` component is slightly misleading: it could be interpreted as \"this entity will not exist outside of this state\". Whereas in fact it merely despawns on exit of the given state, it doesn't care if you spawn an entity _outside_ of the given state:\n\n```\nfor (entity, binding) in &query {\n    if binding.0 == *exited {\n        #[cfg(feature = \"bevy_hierarchy\")]\n        commands.entity(entity).despawn_recursive();\n        #[cfg(not(feature = \"bevy_hierarchy\"))]\n        commands.entity(entity).despawn();\n    }\n}\n```\n\nTo me, this functionality is fine, I can't think of a situation where you would want to spawn something in a state it doesn't belong, only for it to be deleted instantly.\n\nThere is also no available _inverse_ of this component: despawn an entity on _entry_ to a state, which I recently found a need for, and have written a very similar mechanism to achieve the same thing.\n\n## What solution would you like?\n\n- Rename `StateScoped` to `StateExitDespawn`, or maybe a cleaner looking name than that.\n- Add the inverse version: `StateEntryDespawn`, having it operate during state transition, before `OnEnter`.\n\nHere's a snippet of what I produced for my own game:\n\n```\nimpl AppExtLifetime for SubApp {\n    fn enable_state_entry_despawn<S: States>(&mut self) -> &mut Self {\n        self.add_systems(\n            StateTransition,\n            state_entry_despawn::<S>\n                .in_set(TransitionSchedules::<S>::default())\n                .run_if(on_event::<StateTransitionEvent<S>>()),\n        );\n        self\n    }\n}\n```\n## What alternative(s) have you considered?\n\nNo real alternatives.\n\n## Additional context\n\nState transitions are such a powerful and flexible way to orchestrate game entity lifecyles and the flow of the game itself, it would be nice to see more features in this area.\n","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/15849/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/15849/timeline","performed_via_github_app":null,"state_reason":"completed"}