[{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/1965533263","html_url":"https://github.com/bevyengine/bevy/issues/12144#issuecomment-1965533263","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/12144","id":1965533263,"node_id":"IC_kwDODf6-U851J6hP","user":{"login":"james-j-obrien","id":30707409,"node_id":"MDQ6VXNlcjMwNzA3NDA5","avatar_url":"https://avatars.githubusercontent.com/u/30707409?v=4","gravatar_id":"","url":"https://api.github.com/users/james-j-obrien","html_url":"https://github.com/james-j-obrien","followers_url":"https://api.github.com/users/james-j-obrien/followers","following_url":"https://api.github.com/users/james-j-obrien/following{/other_user}","gists_url":"https://api.github.com/users/james-j-obrien/gists{/gist_id}","starred_url":"https://api.github.com/users/james-j-obrien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/james-j-obrien/subscriptions","organizations_url":"https://api.github.com/users/james-j-obrien/orgs","repos_url":"https://api.github.com/users/james-j-obrien/repos","events_url":"https://api.github.com/users/james-j-obrien/events{/privacy}","received_events_url":"https://api.github.com/users/james-j-obrien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-26T23:49:50Z","updated_at":"2024-02-26T23:50:46Z","body":"Thanks for creating a place to track this.\r\n\r\nThe main issue is that the render world currently guarantees that extracted entities from the main world will be able to use the same `Entity` id in the render world. This forces all entity and component data to be dropped each frame to make room for the entities from the main world. This is primarily a problem as mentioned above for using the ECS storage for things like queries, systems and most importantly components which is a requirement for flecs-like fragmenting relations, a long term goal of the project.\r\n\r\nSome proposed solutions include:\r\n1. Stop deleting entities in the render world entirely, move to a resource based render world where extracted data is not store in entities at all.\r\n2. Instead of ensuring ids match attach a `MainWorldEntity` component to render world entities to track the mapping and assign arbitrary ids. Then either:\r\n  a. Persist entities in the render world, only despawning them when the corresponding entity is despawned.\r\n  b. Despawn entities properly each frame (avoid using `SparseSet` components so entire tables can be dropped).\r\n  \r\nIn my opinion 2b is the only option I'm currently aware of that doesn't require a huge rearchitecting of the renderer, however I am aware there are some who want to pursue 1 or 2a for performance reasons unrelated to the blocked entitification of the ECS. I'm also sure there are more approaches I've forgotten or we haven't yet considered.\r\n\r\nRegardless I think we are united in wishing to move away from the current model and I'll be happy wherever we end up.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/1965533263/reactions","total_count":4,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":4,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"james-j-obrien","id":30707409,"node_id":"MDQ6VXNlcjMwNzA3NDA5","avatar_url":"https://avatars.githubusercontent.com/u/30707409?v=4","gravatar_id":"","url":"https://api.github.com/users/james-j-obrien","html_url":"https://github.com/james-j-obrien","followers_url":"https://api.github.com/users/james-j-obrien/followers","following_url":"https://api.github.com/users/james-j-obrien/following{/other_user}","gists_url":"https://api.github.com/users/james-j-obrien/gists{/gist_id}","starred_url":"https://api.github.com/users/james-j-obrien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/james-j-obrien/subscriptions","organizations_url":"https://api.github.com/users/james-j-obrien/orgs","repos_url":"https://api.github.com/users/james-j-obrien/repos","events_url":"https://api.github.com/users/james-j-obrien/events{/privacy}","received_events_url":"https://api.github.com/users/james-j-obrien/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/1968289931","html_url":"https://github.com/bevyengine/bevy/issues/12144#issuecomment-1968289931","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/12144","id":1968289931,"node_id":"IC_kwDODf6-U851UbiL","user":{"login":"JMS55","id":47158642,"node_id":"MDQ6VXNlcjQ3MTU4NjQy","avatar_url":"https://avatars.githubusercontent.com/u/47158642?v=4","gravatar_id":"","url":"https://api.github.com/users/JMS55","html_url":"https://github.com/JMS55","followers_url":"https://api.github.com/users/JMS55/followers","following_url":"https://api.github.com/users/JMS55/following{/other_user}","gists_url":"https://api.github.com/users/JMS55/gists{/gist_id}","starred_url":"https://api.github.com/users/JMS55/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JMS55/subscriptions","organizations_url":"https://api.github.com/users/JMS55/orgs","repos_url":"https://api.github.com/users/JMS55/repos","events_url":"https://api.github.com/users/JMS55/events{/privacy}","received_events_url":"https://api.github.com/users/JMS55/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-28T05:59:37Z","updated_at":"2024-02-28T05:59:37Z","body":"Additional constraint: The render world entity ID must be stable between frames. Lots of temporal rendering techniques require storing and retrieving data across multiple frames per entity.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/1968289931/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JMS55","id":47158642,"node_id":"MDQ6VXNlcjQ3MTU4NjQy","avatar_url":"https://avatars.githubusercontent.com/u/47158642?v=4","gravatar_id":"","url":"https://api.github.com/users/JMS55","html_url":"https://github.com/JMS55","followers_url":"https://api.github.com/users/JMS55/followers","following_url":"https://api.github.com/users/JMS55/following{/other_user}","gists_url":"https://api.github.com/users/JMS55/gists{/gist_id}","starred_url":"https://api.github.com/users/JMS55/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JMS55/subscriptions","organizations_url":"https://api.github.com/users/JMS55/orgs","repos_url":"https://api.github.com/users/JMS55/repos","events_url":"https://api.github.com/users/JMS55/events{/privacy}","received_events_url":"https://api.github.com/users/JMS55/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/1968298008","html_url":"https://github.com/bevyengine/bevy/issues/12144#issuecomment-1968298008","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/12144","id":1968298008,"node_id":"IC_kwDODf6-U851UdgY","user":{"login":"james-j-obrien","id":30707409,"node_id":"MDQ6VXNlcjMwNzA3NDA5","avatar_url":"https://avatars.githubusercontent.com/u/30707409?v=4","gravatar_id":"","url":"https://api.github.com/users/james-j-obrien","html_url":"https://github.com/james-j-obrien","followers_url":"https://api.github.com/users/james-j-obrien/followers","following_url":"https://api.github.com/users/james-j-obrien/following{/other_user}","gists_url":"https://api.github.com/users/james-j-obrien/gists{/gist_id}","starred_url":"https://api.github.com/users/james-j-obrien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/james-j-obrien/subscriptions","organizations_url":"https://api.github.com/users/james-j-obrien/orgs","repos_url":"https://api.github.com/users/james-j-obrien/repos","events_url":"https://api.github.com/users/james-j-obrien/events{/privacy}","received_events_url":"https://api.github.com/users/james-j-obrien/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-28T06:07:18Z","updated_at":"2024-02-28T06:07:18Z","body":"> Additional constraint: The render world entity ID must be stable between frames. Lots of temporal rendering techniques require storing and retrieving data across multiple frames per entity.\r\n\r\nCould you use the value from the component in the place of the actual entity ID?\r\n\r\nAlternatively this does remind me of another implementation which is to split the address space and use a bit in the identifier to signify a foreign id. This involves a few intricacies with how high entity ids would interact with sparse sets and other ECS internals but we do need to resolve that for relations anyway.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/1968298008/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"james-j-obrien","id":30707409,"node_id":"MDQ6VXNlcjMwNzA3NDA5","avatar_url":"https://avatars.githubusercontent.com/u/30707409?v=4","gravatar_id":"","url":"https://api.github.com/users/james-j-obrien","html_url":"https://github.com/james-j-obrien","followers_url":"https://api.github.com/users/james-j-obrien/followers","following_url":"https://api.github.com/users/james-j-obrien/following{/other_user}","gists_url":"https://api.github.com/users/james-j-obrien/gists{/gist_id}","starred_url":"https://api.github.com/users/james-j-obrien/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/james-j-obrien/subscriptions","organizations_url":"https://api.github.com/users/james-j-obrien/orgs","repos_url":"https://api.github.com/users/james-j-obrien/repos","events_url":"https://api.github.com/users/james-j-obrien/events{/privacy}","received_events_url":"https://api.github.com/users/james-j-obrien/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/1968303612","html_url":"https://github.com/bevyengine/bevy/issues/12144#issuecomment-1968303612","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/12144","id":1968303612,"node_id":"IC_kwDODf6-U851Ue38","user":{"login":"JMS55","id":47158642,"node_id":"MDQ6VXNlcjQ3MTU4NjQy","avatar_url":"https://avatars.githubusercontent.com/u/47158642?v=4","gravatar_id":"","url":"https://api.github.com/users/JMS55","html_url":"https://github.com/JMS55","followers_url":"https://api.github.com/users/JMS55/followers","following_url":"https://api.github.com/users/JMS55/following{/other_user}","gists_url":"https://api.github.com/users/JMS55/gists{/gist_id}","starred_url":"https://api.github.com/users/JMS55/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JMS55/subscriptions","organizations_url":"https://api.github.com/users/JMS55/orgs","repos_url":"https://api.github.com/users/JMS55/repos","events_url":"https://api.github.com/users/JMS55/events{/privacy}","received_events_url":"https://api.github.com/users/JMS55/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-28T06:13:12Z","updated_at":"2024-02-28T06:13:23Z","body":"> Could you use the value from the component in the place of the actual entity ID?\r\n\r\nWhat component? MainWorldEntity? Yes, so long as MainWorldEntity is stable across frames. I need to be able to do this basically:\r\n\r\n```rust\r\n// Resource\r\nlet mut last_frame_data_per_light = HashMap::new();\r\n\r\n// Current frame\r\nfor entity in light_query {\r\n     last_frame_data_per_light.insert(entity, foo);\r\n}\r\n\r\n// Next frame\r\nfor entity in light_query {\r\n   last_frame_data_per_light.get(entity); // Need to know some info about the light stored from last frame\r\n}\r\n```","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/1968303612/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"JMS55","id":47158642,"node_id":"MDQ6VXNlcjQ3MTU4NjQy","avatar_url":"https://avatars.githubusercontent.com/u/47158642?v=4","gravatar_id":"","url":"https://api.github.com/users/JMS55","html_url":"https://github.com/JMS55","followers_url":"https://api.github.com/users/JMS55/followers","following_url":"https://api.github.com/users/JMS55/following{/other_user}","gists_url":"https://api.github.com/users/JMS55/gists{/gist_id}","starred_url":"https://api.github.com/users/JMS55/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JMS55/subscriptions","organizations_url":"https://api.github.com/users/JMS55/orgs","repos_url":"https://api.github.com/users/JMS55/repos","events_url":"https://api.github.com/users/JMS55/events{/privacy}","received_events_url":"https://api.github.com/users/JMS55/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":11955513426,"node_id":"LE_lADODf6-U86Ad9BGzwAAAALImqhS","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/11955513426","actor":{"login":"TrialDragon","id":31419708,"node_id":"MDQ6VXNlcjMxNDE5NzA4","avatar_url":"https://avatars.githubusercontent.com/u/31419708?v=4","gravatar_id":"","url":"https://api.github.com/users/TrialDragon","html_url":"https://github.com/TrialDragon","followers_url":"https://api.github.com/users/TrialDragon/followers","following_url":"https://api.github.com/users/TrialDragon/following{/other_user}","gists_url":"https://api.github.com/users/TrialDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/TrialDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TrialDragon/subscriptions","organizations_url":"https://api.github.com/users/TrialDragon/orgs","repos_url":"https://api.github.com/users/TrialDragon/repos","events_url":"https://api.github.com/users/TrialDragon/events{/privacy}","received_events_url":"https://api.github.com/users/TrialDragon/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-02-28T18:13:07Z","label":{"name":"A-ECS","color":"c6a751"},"performed_via_github_app":null},{"id":11955513446,"node_id":"LE_lADODf6-U86Ad9BGzwAAAALImqhm","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/11955513446","actor":{"login":"TrialDragon","id":31419708,"node_id":"MDQ6VXNlcjMxNDE5NzA4","avatar_url":"https://avatars.githubusercontent.com/u/31419708?v=4","gravatar_id":"","url":"https://api.github.com/users/TrialDragon","html_url":"https://github.com/TrialDragon","followers_url":"https://api.github.com/users/TrialDragon/followers","following_url":"https://api.github.com/users/TrialDragon/following{/other_user}","gists_url":"https://api.github.com/users/TrialDragon/gists{/gist_id}","starred_url":"https://api.github.com/users/TrialDragon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TrialDragon/subscriptions","organizations_url":"https://api.github.com/users/TrialDragon/orgs","repos_url":"https://api.github.com/users/TrialDragon/repos","events_url":"https://api.github.com/users/TrialDragon/events{/privacy}","received_events_url":"https://api.github.com/users/TrialDragon/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2024-02-28T18:13:07Z","label":{"name":"C-Tracking-Issue","color":"b8b8b8"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/1971999710","html_url":"https://github.com/bevyengine/bevy/issues/12144#issuecomment-1971999710","issue_url":"https://api.github.com/repos/bevyengine/bevy/issues/12144","id":1971999710,"node_id":"IC_kwDODf6-U851ilPe","user":{"login":"superdump","id":302146,"node_id":"MDQ6VXNlcjMwMjE0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/302146?v=4","gravatar_id":"","url":"https://api.github.com/users/superdump","html_url":"https://github.com/superdump","followers_url":"https://api.github.com/users/superdump/followers","following_url":"https://api.github.com/users/superdump/following{/other_user}","gists_url":"https://api.github.com/users/superdump/gists{/gist_id}","starred_url":"https://api.github.com/users/superdump/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/superdump/subscriptions","organizations_url":"https://api.github.com/users/superdump/orgs","repos_url":"https://api.github.com/users/superdump/repos","events_url":"https://api.github.com/users/superdump/events{/privacy}","received_events_url":"https://api.github.com/users/superdump/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-02-29T21:33:43Z","updated_at":"2024-02-29T21:36:08Z","body":"My main concern for the render app is performance. In one sense moving away from using the ECS for the main mesh entity flow has been freeing to use whatever we find works best. For me at least it lets me focus on the data and how best to structure and access it to achieve fast rendering, rather than being constrained by how the ECS works.\r\n\r\nThat said, if there were to be an ECS world shared between the apps so that we could avoid extraction and could access everything that we need, that certainly seems interesting.\r\n\r\nAnd from the original post, 1 sounds ok, 2 sounds a bit clunky but could work. We donâ€™t use entities in the ECS sense much in the render app anymore in my opinion. Mostly views I think. The bulk of high frequency data is done with EntityHashMap in resources.","author_association":"CONTRIBUTOR","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/comments/1971999710/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"superdump","id":302146,"node_id":"MDQ6VXNlcjMwMjE0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/302146?v=4","gravatar_id":"","url":"https://api.github.com/users/superdump","html_url":"https://github.com/superdump","followers_url":"https://api.github.com/users/superdump/followers","following_url":"https://api.github.com/users/superdump/following{/other_user}","gists_url":"https://api.github.com/users/superdump/gists{/gist_id}","starred_url":"https://api.github.com/users/superdump/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/superdump/subscriptions","organizations_url":"https://api.github.com/users/superdump/orgs","repos_url":"https://api.github.com/users/superdump/repos","events_url":"https://api.github.com/users/superdump/events{/privacy}","received_events_url":"https://api.github.com/users/superdump/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"james7132","id":3137680,"node_id":"MDQ6VXNlcjMxMzc2ODA=","avatar_url":"https://avatars.githubusercontent.com/u/3137680?v=4","gravatar_id":"","url":"https://api.github.com/users/james7132","html_url":"https://github.com/james7132","followers_url":"https://api.github.com/users/james7132/followers","following_url":"https://api.github.com/users/james7132/following{/other_user}","gists_url":"https://api.github.com/users/james7132/gists{/gist_id}","starred_url":"https://api.github.com/users/james7132/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/james7132/subscriptions","organizations_url":"https://api.github.com/users/james7132/orgs","repos_url":"https://api.github.com/users/james7132/repos","events_url":"https://api.github.com/users/james7132/events{/privacy}","received_events_url":"https://api.github.com/users/james7132/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-03-05T03:44:57Z","updated_at":"2024-03-05T03:44:57Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/12312","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/12312/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/12312/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/12312/events","html_url":"https://github.com/bevyengine/bevy/issues/12312","id":2168237133,"node_id":"I_kwDODf6-U86BPKxN","number":12312,"title":"World::flush is not being called properly","user":{"login":"james7132","id":3137680,"node_id":"MDQ6VXNlcjMxMzc2ODA=","avatar_url":"https://avatars.githubusercontent.com/u/3137680?v=4","gravatar_id":"","url":"https://api.github.com/users/james7132","html_url":"https://github.com/james7132","followers_url":"https://api.github.com/users/james7132/followers","following_url":"https://api.github.com/users/james7132/following{/other_user}","gists_url":"https://api.github.com/users/james7132/gists{/gist_id}","starred_url":"https://api.github.com/users/james7132/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/james7132/subscriptions","organizations_url":"https://api.github.com/users/james7132/orgs","repos_url":"https://api.github.com/users/james7132/repos","events_url":"https://api.github.com/users/james7132/events{/privacy}","received_events_url":"https://api.github.com/users/james7132/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619323,"node_id":"MDU6TGFiZWwxNzk1NjE5MzIz","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Bug","name":"C-Bug","color":"d73a4a","default":false,"description":"An unexpected or incorrect behavior"},{"id":2197761682,"node_id":"MDU6TGFiZWwyMTk3NzYxNjgy","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-ECS","name":"A-ECS","color":"c6a751","default":false,"description":"Entities, components, systems, and events"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2024-03-05T03:44:56Z","updated_at":"2024-03-30T09:31:26Z","closed_at":null,"author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"repository":{"id":234798675,"node_id":"MDEwOlJlcG9zaXRvcnkyMzQ3OTg2NzU=","name":"bevy","full_name":"bevyengine/bevy","private":false,"owner":{"login":"bevyengine","id":60047606,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYwMDQ3NjA2","avatar_url":"https://avatars.githubusercontent.com/u/60047606?v=4","gravatar_id":"","url":"https://api.github.com/users/bevyengine","html_url":"https://github.com/bevyengine","followers_url":"https://api.github.com/users/bevyengine/followers","following_url":"https://api.github.com/users/bevyengine/following{/other_user}","gists_url":"https://api.github.com/users/bevyengine/gists{/gist_id}","starred_url":"https://api.github.com/users/bevyengine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bevyengine/subscriptions","organizations_url":"https://api.github.com/users/bevyengine/orgs","repos_url":"https://api.github.com/users/bevyengine/repos","events_url":"https://api.github.com/users/bevyengine/events{/privacy}","received_events_url":"https://api.github.com/users/bevyengine/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bevyengine/bevy","description":"A refreshingly simple data-driven game engine built in Rust","fork":false,"url":"https://api.github.com/repos/bevyengine/bevy","forks_url":"https://api.github.com/repos/bevyengine/bevy/forks","keys_url":"https://api.github.com/repos/bevyengine/bevy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bevyengine/bevy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bevyengine/bevy/teams","hooks_url":"https://api.github.com/repos/bevyengine/bevy/hooks","issue_events_url":"https://api.github.com/repos/bevyengine/bevy/issues/events{/number}","events_url":"https://api.github.com/repos/bevyengine/bevy/events","assignees_url":"https://api.github.com/repos/bevyengine/bevy/assignees{/user}","branches_url":"https://api.github.com/repos/bevyengine/bevy/branches{/branch}","tags_url":"https://api.github.com/repos/bevyengine/bevy/tags","blobs_url":"https://api.github.com/repos/bevyengine/bevy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bevyengine/bevy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bevyengine/bevy/git/refs{/sha}","trees_url":"https://api.github.com/repos/bevyengine/bevy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bevyengine/bevy/statuses/{sha}","languages_url":"https://api.github.com/repos/bevyengine/bevy/languages","stargazers_url":"https://api.github.com/repos/bevyengine/bevy/stargazers","contributors_url":"https://api.github.com/repos/bevyengine/bevy/contributors","subscribers_url":"https://api.github.com/repos/bevyengine/bevy/subscribers","subscription_url":"https://api.github.com/repos/bevyengine/bevy/subscription","commits_url":"https://api.github.com/repos/bevyengine/bevy/commits{/sha}","git_commits_url":"https://api.github.com/repos/bevyengine/bevy/git/commits{/sha}","comments_url":"https://api.github.com/repos/bevyengine/bevy/comments{/number}","issue_comment_url":"https://api.github.com/repos/bevyengine/bevy/issues/comments{/number}","contents_url":"https://api.github.com/repos/bevyengine/bevy/contents/{+path}","compare_url":"https://api.github.com/repos/bevyengine/bevy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bevyengine/bevy/merges","archive_url":"https://api.github.com/repos/bevyengine/bevy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bevyengine/bevy/downloads","issues_url":"https://api.github.com/repos/bevyengine/bevy/issues{/number}","pulls_url":"https://api.github.com/repos/bevyengine/bevy/pulls{/number}","milestones_url":"https://api.github.com/repos/bevyengine/bevy/milestones{/number}","notifications_url":"https://api.github.com/repos/bevyengine/bevy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bevyengine/bevy/labels{/name}","releases_url":"https://api.github.com/repos/bevyengine/bevy/releases{/id}","deployments_url":"https://api.github.com/repos/bevyengine/bevy/deployments","created_at":"2020-01-18T21:13:55Z","updated_at":"2025-11-10T00:30:24Z","pushed_at":"2025-11-09T20:05:46Z","git_url":"git://github.com/bevyengine/bevy.git","ssh_url":"git@github.com:bevyengine/bevy.git","clone_url":"https://github.com/bevyengine/bevy.git","svn_url":"https://github.com/bevyengine/bevy","homepage":"https://bevy.org","size":152673,"stargazers_count":42996,"watchers_count":42996,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":4220,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3116,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bevy","game-development","game-engine","gamedev","open-source","rust"],"visibility":"public","forks":4220,"open_issues":3116,"watchers":42996,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"body":"`Entities::reserve_entities` is considered 100% safe as it can be accessed from `World::entities`, but returns an iterator that yields `Entity` values that are not valid until `World::flush_entities`, a safe `pub(crate)` function. As it currently stands, there is no safe way to use `Entities::reserve_entities` as it *must* be paired with an unsafe call to `Entities::flush`, or `Entites::flush_as_invalid`.\r\n\r\nLikewise, there are zero internal uses of the function due to our current use of `flush_and_reserve_invalid_assuming_no_entities` in the render world (see #12144).\r\n\r\nIt may be best to just remove all of these functions to simplify the code, or come up with safe abstractions around this for external use, such as #11602.","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/12312/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/12312/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"Trashtalk217","id":24552941,"node_id":"MDQ6VXNlcjI0NTUyOTQx","avatar_url":"https://avatars.githubusercontent.com/u/24552941?v=4","gravatar_id":"","url":"https://api.github.com/users/Trashtalk217","html_url":"https://github.com/Trashtalk217","followers_url":"https://api.github.com/users/Trashtalk217/followers","following_url":"https://api.github.com/users/Trashtalk217/following{/other_user}","gists_url":"https://api.github.com/users/Trashtalk217/gists{/gist_id}","starred_url":"https://api.github.com/users/Trashtalk217/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Trashtalk217/subscriptions","organizations_url":"https://api.github.com/users/Trashtalk217/orgs","repos_url":"https://api.github.com/users/Trashtalk217/repos","events_url":"https://api.github.com/users/Trashtalk217/events{/privacy}","received_events_url":"https://api.github.com/users/Trashtalk217/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-09T18:10:52Z","updated_at":"2024-07-09T18:10:52Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14252","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/14252/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/14252/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/14252/events","html_url":"https://github.com/bevyengine/bevy/pull/14252","id":2398843262,"node_id":"PR_kwDODf6-U8503il8","number":14252,"title":"Persistent Render World","user":{"login":"Trashtalk217","id":24552941,"node_id":"MDQ6VXNlcjI0NTUyOTQx","avatar_url":"https://avatars.githubusercontent.com/u/24552941?v=4","gravatar_id":"","url":"https://api.github.com/users/Trashtalk217","html_url":"https://github.com/Trashtalk217","followers_url":"https://api.github.com/users/Trashtalk217/followers","following_url":"https://api.github.com/users/Trashtalk217/following{/other_user}","gists_url":"https://api.github.com/users/Trashtalk217/gists{/gist_id}","starred_url":"https://api.github.com/users/Trashtalk217/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Trashtalk217/subscriptions","organizations_url":"https://api.github.com/users/Trashtalk217/orgs","repos_url":"https://api.github.com/users/Trashtalk217/repos","events_url":"https://api.github.com/users/Trashtalk217/events{/privacy}","received_events_url":"https://api.github.com/users/Trashtalk217/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2045383863,"node_id":"MDU6TGFiZWwyMDQ1MzgzODYz","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-Rendering","name":"A-Rendering","color":"C6A751","default":false,"description":"Drawing game state to the screen"},{"id":2197761682,"node_id":"MDU6TGFiZWwyMTk3NzYxNjgy","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-ECS","name":"A-ECS","color":"c6a751","default":false,"description":"Entities, components, systems, and events"},{"id":4058407495,"node_id":"LA_kwDODf6-U87x5mJH","url":"https://api.github.com/repos/bevyengine/bevy/labels/X-Controversial","name":"X-Controversial","color":"D93F0B","default":false,"description":"There is active debate or serious implications around merging this PR"},{"id":6600141374,"node_id":"LA_kwDODf6-U88AAAABiWYqPg","url":"https://api.github.com/repos/bevyengine/bevy/labels/M-Release-Note","name":"M-Release-Note","color":"006B75","default":false,"description":"Work that should be called out in the blog due to impact"},{"id":6899588994,"node_id":"LA_kwDODf6-U88AAAABmz9fgg","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Needs-Review","name":"S-Needs-Review","color":"D876E3","default":false,"description":"Needs reviewer attention (from anyone!) to move forward"},{"id":6938992360,"node_id":"LA_kwDODf6-U88AAAABnZie6A","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Needs-SME","name":"S-Needs-SME","color":"D876E3","default":false,"description":"Decision or review from an SME is required"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/bevyengine/bevy/milestones/24","html_url":"https://github.com/bevyengine/bevy/milestone/24","labels_url":"https://api.github.com/repos/bevyengine/bevy/milestones/24/labels","id":11048296,"node_id":"MI_kwDODf6-U84AqJVo","number":24,"title":"0.15","description":"","creator":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":550,"state":"closed","created_at":"2024-05-13T18:42:18Z","updated_at":"2024-11-30T03:58:51Z","due_on":null,"closed_at":"2024-11-29T22:40:27Z"},"comments":18,"created_at":"2024-07-09T18:10:51Z","updated_at":"2024-08-12T15:25:13Z","closed_at":"2024-08-12T15:25:12Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":234798675,"node_id":"MDEwOlJlcG9zaXRvcnkyMzQ3OTg2NzU=","name":"bevy","full_name":"bevyengine/bevy","private":false,"owner":{"login":"bevyengine","id":60047606,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYwMDQ3NjA2","avatar_url":"https://avatars.githubusercontent.com/u/60047606?v=4","gravatar_id":"","url":"https://api.github.com/users/bevyengine","html_url":"https://github.com/bevyengine","followers_url":"https://api.github.com/users/bevyengine/followers","following_url":"https://api.github.com/users/bevyengine/following{/other_user}","gists_url":"https://api.github.com/users/bevyengine/gists{/gist_id}","starred_url":"https://api.github.com/users/bevyengine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bevyengine/subscriptions","organizations_url":"https://api.github.com/users/bevyengine/orgs","repos_url":"https://api.github.com/users/bevyengine/repos","events_url":"https://api.github.com/users/bevyengine/events{/privacy}","received_events_url":"https://api.github.com/users/bevyengine/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bevyengine/bevy","description":"A refreshingly simple data-driven game engine built in Rust","fork":false,"url":"https://api.github.com/repos/bevyengine/bevy","forks_url":"https://api.github.com/repos/bevyengine/bevy/forks","keys_url":"https://api.github.com/repos/bevyengine/bevy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bevyengine/bevy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bevyengine/bevy/teams","hooks_url":"https://api.github.com/repos/bevyengine/bevy/hooks","issue_events_url":"https://api.github.com/repos/bevyengine/bevy/issues/events{/number}","events_url":"https://api.github.com/repos/bevyengine/bevy/events","assignees_url":"https://api.github.com/repos/bevyengine/bevy/assignees{/user}","branches_url":"https://api.github.com/repos/bevyengine/bevy/branches{/branch}","tags_url":"https://api.github.com/repos/bevyengine/bevy/tags","blobs_url":"https://api.github.com/repos/bevyengine/bevy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bevyengine/bevy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bevyengine/bevy/git/refs{/sha}","trees_url":"https://api.github.com/repos/bevyengine/bevy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bevyengine/bevy/statuses/{sha}","languages_url":"https://api.github.com/repos/bevyengine/bevy/languages","stargazers_url":"https://api.github.com/repos/bevyengine/bevy/stargazers","contributors_url":"https://api.github.com/repos/bevyengine/bevy/contributors","subscribers_url":"https://api.github.com/repos/bevyengine/bevy/subscribers","subscription_url":"https://api.github.com/repos/bevyengine/bevy/subscription","commits_url":"https://api.github.com/repos/bevyengine/bevy/commits{/sha}","git_commits_url":"https://api.github.com/repos/bevyengine/bevy/git/commits{/sha}","comments_url":"https://api.github.com/repos/bevyengine/bevy/comments{/number}","issue_comment_url":"https://api.github.com/repos/bevyengine/bevy/issues/comments{/number}","contents_url":"https://api.github.com/repos/bevyengine/bevy/contents/{+path}","compare_url":"https://api.github.com/repos/bevyengine/bevy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bevyengine/bevy/merges","archive_url":"https://api.github.com/repos/bevyengine/bevy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bevyengine/bevy/downloads","issues_url":"https://api.github.com/repos/bevyengine/bevy/issues{/number}","pulls_url":"https://api.github.com/repos/bevyengine/bevy/pulls{/number}","milestones_url":"https://api.github.com/repos/bevyengine/bevy/milestones{/number}","notifications_url":"https://api.github.com/repos/bevyengine/bevy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bevyengine/bevy/labels{/name}","releases_url":"https://api.github.com/repos/bevyengine/bevy/releases{/id}","deployments_url":"https://api.github.com/repos/bevyengine/bevy/deployments","created_at":"2020-01-18T21:13:55Z","updated_at":"2025-11-10T00:30:24Z","pushed_at":"2025-11-09T20:05:46Z","git_url":"git://github.com/bevyengine/bevy.git","ssh_url":"git@github.com:bevyengine/bevy.git","clone_url":"https://github.com/bevyengine/bevy.git","svn_url":"https://github.com/bevyengine/bevy","homepage":"https://bevy.org","size":152673,"stargazers_count":42996,"watchers_count":42996,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":4220,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3116,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bevy","game-development","game-engine","gamedev","open-source","rust"],"visibility":"public","forks":4220,"open_issues":3116,"watchers":42996,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/bevyengine/bevy/pulls/14252","html_url":"https://github.com/bevyengine/bevy/pull/14252","diff_url":"https://github.com/bevyengine/bevy/pull/14252.diff","patch_url":"https://github.com/bevyengine/bevy/pull/14252.patch","merged_at":null},"body":"# Objective\r\n\r\n- Fixes #12144 \r\n\r\nEvery Bevy app has (at least) two ECS Worlds, the main world and the render world. These are held separately so gameplay code can run parallel to the rendering code. For changes in the main world to affect the render world (and eventually the screen), the data from the former has to be hoisted over to the render world in the Extract stage. See the figure I've graciously stolen from @inodentry:\r\n\r\n![image](https://github.com/bevyengine/bevy/assets/24552941/e9582c34-c2e6-4a8e-951e-dd8ab002c07a)\r\n\r\nThe [article](https://bevy-cheatbook.github.io/gpu/stages.html?highlight=Extract#extract) in the cheatbook also gives a good overview.\r\n\r\nThis extraction happens for every frame and in order to not overload the render world with entities, all entities are removed in the Cleanup stage, a frame earlier. This, however, causes a problem for more advanced ECS features like Components as Entities and Queries as Entities. Queries and Components are not extracted (nor does it make sense to) and it doesn't make sense to remove them every frame. It causes very big, very annoying problems.\r\n\r\n## Solution\r\n\r\nStop removing all entities every frame and instead of extracting all (render-relevant) entities, keep more careful track of them by way of an entity-entity mapping between main world entities and render world entities.\r\n\r\n## Drawbacks\r\nCurrently, there is a one-to-one mapping between render world entities and main world entities, i.e. they have the same IDs in both worlds. This is likely not going to be the case moving forward. This has never been a guarantee, so for the few people who have relied on this behaviour: I'm sorry.\r\n\r\nAlso, and I feel like I can say this with some confidence, the performance is going to get worse. How much worse, I cannot say yet, but given that we are going to do a lot more bookkeeping, it's expected to get worse.\r\n","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14252/reactions","total_count":2,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":2},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/14252/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"re0312","id":45868716,"node_id":"MDQ6VXNlcjQ1ODY4NzE2","avatar_url":"https://avatars.githubusercontent.com/u/45868716?v=4","gravatar_id":"","url":"https://api.github.com/users/re0312","html_url":"https://github.com/re0312","followers_url":"https://api.github.com/users/re0312/followers","following_url":"https://api.github.com/users/re0312/following{/other_user}","gists_url":"https://api.github.com/users/re0312/gists{/gist_id}","starred_url":"https://api.github.com/users/re0312/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/re0312/subscriptions","organizations_url":"https://api.github.com/users/re0312/orgs","repos_url":"https://api.github.com/users/re0312/repos","events_url":"https://api.github.com/users/re0312/events{/privacy}","received_events_url":"https://api.github.com/users/re0312/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-07-23T09:34:39Z","updated_at":"2024-07-23T09:34:39Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14449","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/14449/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/14449/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/14449/events","html_url":"https://github.com/bevyengine/bevy/pull/14449","id":2424727828,"node_id":"PR_kwDODf6-U852MM-b","number":14449,"title":"Retain Rendering World","user":{"login":"re0312","id":45868716,"node_id":"MDQ6VXNlcjQ1ODY4NzE2","avatar_url":"https://avatars.githubusercontent.com/u/45868716?v=4","gravatar_id":"","url":"https://api.github.com/users/re0312","html_url":"https://github.com/re0312","followers_url":"https://api.github.com/users/re0312/followers","following_url":"https://api.github.com/users/re0312/following{/other_user}","gists_url":"https://api.github.com/users/re0312/gists{/gist_id}","starred_url":"https://api.github.com/users/re0312/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/re0312/subscriptions","organizations_url":"https://api.github.com/users/re0312/orgs","repos_url":"https://api.github.com/users/re0312/repos","events_url":"https://api.github.com/users/re0312/events{/privacy}","received_events_url":"https://api.github.com/users/re0312/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2045383863,"node_id":"MDU6TGFiZWwyMDQ1MzgzODYz","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-Rendering","name":"A-Rendering","color":"C6A751","default":false,"description":"Drawing game state to the screen"},{"id":2272098452,"node_id":"MDU6TGFiZWwyMjcyMDk4NDUy","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Performance","name":"C-Performance","color":"B8B8B8","default":false,"description":"A change motivated by improving speed, memory usage or compile times"},{"id":3166143717,"node_id":"MDU6TGFiZWwzMTY2MTQzNzE3","url":"https://api.github.com/repos/bevyengine/bevy/labels/D-Complex","name":"D-Complex","color":"008672","default":false,"description":"Quite challenging from either a design or technical perspective. Ask for help!"},{"id":4058407495,"node_id":"LA_kwDODf6-U87x5mJH","url":"https://api.github.com/repos/bevyengine/bevy/labels/X-Controversial","name":"X-Controversial","color":"D93F0B","default":false,"description":"There is active debate or serious implications around merging this PR"},{"id":6600141374,"node_id":"LA_kwDODf6-U88AAAABiWYqPg","url":"https://api.github.com/repos/bevyengine/bevy/labels/M-Release-Note","name":"M-Release-Note","color":"006B75","default":false,"description":"Work that should be called out in the blog due to impact"},{"id":6938992360,"node_id":"LA_kwDODf6-U88AAAABnZie6A","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Needs-SME","name":"S-Needs-SME","color":"D876E3","default":false,"description":"Decision or review from an SME is required"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/bevyengine/bevy/milestones/24","html_url":"https://github.com/bevyengine/bevy/milestone/24","labels_url":"https://api.github.com/repos/bevyengine/bevy/milestones/24/labels","id":11048296,"node_id":"MI_kwDODf6-U84AqJVo","number":24,"title":"0.15","description":"","creator":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":550,"state":"closed","created_at":"2024-05-13T18:42:18Z","updated_at":"2024-11-30T03:58:51Z","due_on":null,"closed_at":"2024-11-29T22:40:27Z"},"comments":37,"created_at":"2024-07-23T09:34:38Z","updated_at":"2024-09-27T02:02:10Z","closed_at":"2024-09-27T02:02:10Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":234798675,"node_id":"MDEwOlJlcG9zaXRvcnkyMzQ3OTg2NzU=","name":"bevy","full_name":"bevyengine/bevy","private":false,"owner":{"login":"bevyengine","id":60047606,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYwMDQ3NjA2","avatar_url":"https://avatars.githubusercontent.com/u/60047606?v=4","gravatar_id":"","url":"https://api.github.com/users/bevyengine","html_url":"https://github.com/bevyengine","followers_url":"https://api.github.com/users/bevyengine/followers","following_url":"https://api.github.com/users/bevyengine/following{/other_user}","gists_url":"https://api.github.com/users/bevyengine/gists{/gist_id}","starred_url":"https://api.github.com/users/bevyengine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bevyengine/subscriptions","organizations_url":"https://api.github.com/users/bevyengine/orgs","repos_url":"https://api.github.com/users/bevyengine/repos","events_url":"https://api.github.com/users/bevyengine/events{/privacy}","received_events_url":"https://api.github.com/users/bevyengine/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bevyengine/bevy","description":"A refreshingly simple data-driven game engine built in Rust","fork":false,"url":"https://api.github.com/repos/bevyengine/bevy","forks_url":"https://api.github.com/repos/bevyengine/bevy/forks","keys_url":"https://api.github.com/repos/bevyengine/bevy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bevyengine/bevy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bevyengine/bevy/teams","hooks_url":"https://api.github.com/repos/bevyengine/bevy/hooks","issue_events_url":"https://api.github.com/repos/bevyengine/bevy/issues/events{/number}","events_url":"https://api.github.com/repos/bevyengine/bevy/events","assignees_url":"https://api.github.com/repos/bevyengine/bevy/assignees{/user}","branches_url":"https://api.github.com/repos/bevyengine/bevy/branches{/branch}","tags_url":"https://api.github.com/repos/bevyengine/bevy/tags","blobs_url":"https://api.github.com/repos/bevyengine/bevy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bevyengine/bevy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bevyengine/bevy/git/refs{/sha}","trees_url":"https://api.github.com/repos/bevyengine/bevy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bevyengine/bevy/statuses/{sha}","languages_url":"https://api.github.com/repos/bevyengine/bevy/languages","stargazers_url":"https://api.github.com/repos/bevyengine/bevy/stargazers","contributors_url":"https://api.github.com/repos/bevyengine/bevy/contributors","subscribers_url":"https://api.github.com/repos/bevyengine/bevy/subscribers","subscription_url":"https://api.github.com/repos/bevyengine/bevy/subscription","commits_url":"https://api.github.com/repos/bevyengine/bevy/commits{/sha}","git_commits_url":"https://api.github.com/repos/bevyengine/bevy/git/commits{/sha}","comments_url":"https://api.github.com/repos/bevyengine/bevy/comments{/number}","issue_comment_url":"https://api.github.com/repos/bevyengine/bevy/issues/comments{/number}","contents_url":"https://api.github.com/repos/bevyengine/bevy/contents/{+path}","compare_url":"https://api.github.com/repos/bevyengine/bevy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bevyengine/bevy/merges","archive_url":"https://api.github.com/repos/bevyengine/bevy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bevyengine/bevy/downloads","issues_url":"https://api.github.com/repos/bevyengine/bevy/issues{/number}","pulls_url":"https://api.github.com/repos/bevyengine/bevy/pulls{/number}","milestones_url":"https://api.github.com/repos/bevyengine/bevy/milestones{/number}","notifications_url":"https://api.github.com/repos/bevyengine/bevy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bevyengine/bevy/labels{/name}","releases_url":"https://api.github.com/repos/bevyengine/bevy/releases{/id}","deployments_url":"https://api.github.com/repos/bevyengine/bevy/deployments","created_at":"2020-01-18T21:13:55Z","updated_at":"2025-11-10T00:30:24Z","pushed_at":"2025-11-09T20:05:46Z","git_url":"git://github.com/bevyengine/bevy.git","ssh_url":"git@github.com:bevyengine/bevy.git","clone_url":"https://github.com/bevyengine/bevy.git","svn_url":"https://github.com/bevyengine/bevy","homepage":"https://bevy.org","size":152673,"stargazers_count":42996,"watchers_count":42996,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":4220,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3116,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bevy","game-development","game-engine","gamedev","open-source","rust"],"visibility":"public","forks":4220,"open_issues":3116,"watchers":42996,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/bevyengine/bevy/pulls/14449","html_url":"https://github.com/bevyengine/bevy/pull/14449","diff_url":"https://github.com/bevyengine/bevy/pull/14449.diff","patch_url":"https://github.com/bevyengine/bevy/pull/14449.patch","merged_at":null},"body":"# Objective\r\n\r\n- fix #12144 ,compare to #14252 \r\n- We want Relations! However, the render world currently hinders the development of  `* as entities` because it needs to despawn all entities each frame to ensure consistent entity IDs between the main world and render world.\r\n\r\n\r\n## Solution\r\n- Transition to a strategy of maintaining entity-to-entity mapping between the main world and render world, abandoning the method of removing all entities every frame.\r\n- Use `Observer `to listen the components that tis entity needs to be synchronized to the render world.\r\n- Before executing the extract schedule, the `entity_sync_system `will be run first, which is responsible for maintaining the entity mapping between the main world and the rendering world\r\n\r\nBevy Schedule \r\n![image](https://github.com/user-attachments/assets/013e9822-e575-43a5-bb0c-108dfc167fd1)\r\n\r\n\r\n##  Alternative(s)\r\n\r\nwe could using Resource to manage all rendering entity component data  so that we don't have any entities at all.\r\n\r\n## Advantages\r\n\r\n- We can continue to use ECS in rendering, which can bring more performance advantages in many aspects(Retain redering world + update in place)\r\n- More consistent primitives, as Bevy is entirely based on ECS.\r\n\r\n## Drawbacks \r\n- Once a component has a dependency relationship on other main world entities, this relationship must also be synchronized to the rendering world, which undoubtedly increases the user's mental burden\r\n- Not all the entities are in sync with the rendering world,  And that makes it pretty confusing to tell apart the entities in the main world from those in the rendering world when we're in the middle of rendering stuff. And considering our extensive use of  `EntityHashmap `to handle rendering data. that's could made everything even more of a headache to deal with.\r\n\r\n## Performance\r\ncargo run --release --example many_cubes --features bevy/trace_tracy\r\nred is main\r\n![image](https://github.com/user-attachments/assets/dafe7d09-3fd3-4245-b651-615409036b8c)\r\n\r\ncargo run --release --example many_foxes --features bevy/trace_tracy\r\n![image](https://github.com/user-attachments/assets/da5feaa4-a9ba-4fec-a297-1c3f253169bd)\r\n\r\n\r\ncargo run --release --example many_buttons --features bevy/trace_tracy \r\n\r\n![image](https://github.com/user-attachments/assets/8072a345-b8d4-4af8-8fed-86d8cff4359a)\r\n\r\n~30% loss\r\nThe majority of the performance loss from the spawn(~3ms) and despawn(~3ms) operations of ephemeral entity.\r\n\r\n## Next Steps\r\n\r\n1. Stop spawn temporary entities and depsawn it every frame , it could persist in render world\r\n2. Update in place for instance data instead re-insert it per frame \r\n\r\n\r\n## Migration Guide\r\n\r\nRender world no longer clear all entities per frame , Instead, You must manually control the spawn and despawn of render entities properly.\r\n\r\nBefore this pr ,`extract` would copy the related main world entity and its data into render world. Then, the render world clear all render entities at the end of the frame to reserve enough entity space, ensuring that no main world entity ID would be occupied when next `extract`.\r\n\r\nFor the sake of `* as entities`, **we turn to an entity-to-entity mapping strategy to sync between main world entity and render world entity, where each `synchronized` main entity has a `RenderEntity` component  that holds an Entity ID pointer to its unique counterpart entity in the render world.**\r\n\r\n![image](https://github.com/user-attachments/assets/3aac38a3-05b2-4a28-a54a-333669e5887a)\r\n\r\nTo establish a \"Synchronous Relationship\", you can add a `SyncRenderWorld` component to an entity, indicating that it needs to be synchronized to the render world. (Currently, its added by default in `Camera2dBundle` , `Camera3dBundle`, `DirectionalLightBundle`, `SpotLightBundle`, `PointLightBundle`, `SpriteBundle`, and `SpriteSheetBundle`.)\r\n\r\n Once a `synchronized` main entity despawned ,its corresponding render entity will automatically be purged before next `extract`.\r\n\r\nTemporary entities are part of entities in render world  , bevy's renderer spawns numerous temporary entities for rendering per frame , which need to be cleared at the end of each frame.\r\nTo avoid duplicating spawn these entities each frame,you can add a `TemporaryRenderEntity` component to it. Bevy will then automatically clean up it at the end of each frame. But as best you should turn to persisit entity in render world instead of spawn and clear them every frame.\r\n\r\n`ExtractComponentPlugin` now only extracts  \"Synchronized\" entity to render world.\r\n\r\nCo-Authored-By:Trashtalk217 Trashtalk217@gmail.com\r\n","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14449/reactions","total_count":27,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":16,"eyes":9},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/14449/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"Trashtalk217","id":24552941,"node_id":"MDQ6VXNlcjI0NTUyOTQx","avatar_url":"https://avatars.githubusercontent.com/u/24552941?v=4","gravatar_id":"","url":"https://api.github.com/users/Trashtalk217","html_url":"https://github.com/Trashtalk217","followers_url":"https://api.github.com/users/Trashtalk217/followers","following_url":"https://api.github.com/users/Trashtalk217/following{/other_user}","gists_url":"https://api.github.com/users/Trashtalk217/gists{/gist_id}","starred_url":"https://api.github.com/users/Trashtalk217/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Trashtalk217/subscriptions","organizations_url":"https://api.github.com/users/Trashtalk217/orgs","repos_url":"https://api.github.com/users/Trashtalk217/repos","events_url":"https://api.github.com/users/Trashtalk217/events{/privacy}","received_events_url":"https://api.github.com/users/Trashtalk217/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-08-08T22:31:01Z","updated_at":"2024-08-08T22:31:01Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14668","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/14668/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/14668/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/14668/events","html_url":"https://github.com/bevyengine/bevy/pull/14668","id":2456743505,"node_id":"PR_kwDODf6-U8534zBh","number":14668,"title":"Queries as Entities","user":{"login":"Trashtalk217","id":24552941,"node_id":"MDQ6VXNlcjI0NTUyOTQx","avatar_url":"https://avatars.githubusercontent.com/u/24552941?v=4","gravatar_id":"","url":"https://api.github.com/users/Trashtalk217","html_url":"https://github.com/Trashtalk217","followers_url":"https://api.github.com/users/Trashtalk217/followers","following_url":"https://api.github.com/users/Trashtalk217/following{/other_user}","gists_url":"https://api.github.com/users/Trashtalk217/gists{/gist_id}","starred_url":"https://api.github.com/users/Trashtalk217/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Trashtalk217/subscriptions","organizations_url":"https://api.github.com/users/Trashtalk217/orgs","repos_url":"https://api.github.com/users/Trashtalk217/repos","events_url":"https://api.github.com/users/Trashtalk217/events{/privacy}","received_events_url":"https://api.github.com/users/Trashtalk217/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2197761682,"node_id":"MDU6TGFiZWwyMTk3NzYxNjgy","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-ECS","name":"A-ECS","color":"c6a751","default":false,"description":"Entities, components, systems, and events"},{"id":2272098452,"node_id":"MDU6TGFiZWwyMjcyMDk4NDUy","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Performance","name":"C-Performance","color":"B8B8B8","default":false,"description":"A change motivated by improving speed, memory usage or compile times"},{"id":2707198919,"node_id":"MDU6TGFiZWwyNzA3MTk4OTE5","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Blocked","name":"S-Blocked","color":"D876E3","default":false,"description":"This cannot move forward until something else changes"},{"id":3166154419,"node_id":"MDU6TGFiZWwzMTY2MTU0NDE5","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Adopt-Me","name":"S-Adopt-Me","color":"d876e3","default":false,"description":"The original PR author has no intent to complete this work. Pick me up!"}],"state":"open","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2024-08-08T22:24:14Z","updated_at":"2024-09-27T16:36:09Z","closed_at":null,"author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":true,"repository":{"id":234798675,"node_id":"MDEwOlJlcG9zaXRvcnkyMzQ3OTg2NzU=","name":"bevy","full_name":"bevyengine/bevy","private":false,"owner":{"login":"bevyengine","id":60047606,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYwMDQ3NjA2","avatar_url":"https://avatars.githubusercontent.com/u/60047606?v=4","gravatar_id":"","url":"https://api.github.com/users/bevyengine","html_url":"https://github.com/bevyengine","followers_url":"https://api.github.com/users/bevyengine/followers","following_url":"https://api.github.com/users/bevyengine/following{/other_user}","gists_url":"https://api.github.com/users/bevyengine/gists{/gist_id}","starred_url":"https://api.github.com/users/bevyengine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bevyengine/subscriptions","organizations_url":"https://api.github.com/users/bevyengine/orgs","repos_url":"https://api.github.com/users/bevyengine/repos","events_url":"https://api.github.com/users/bevyengine/events{/privacy}","received_events_url":"https://api.github.com/users/bevyengine/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bevyengine/bevy","description":"A refreshingly simple data-driven game engine built in Rust","fork":false,"url":"https://api.github.com/repos/bevyengine/bevy","forks_url":"https://api.github.com/repos/bevyengine/bevy/forks","keys_url":"https://api.github.com/repos/bevyengine/bevy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bevyengine/bevy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bevyengine/bevy/teams","hooks_url":"https://api.github.com/repos/bevyengine/bevy/hooks","issue_events_url":"https://api.github.com/repos/bevyengine/bevy/issues/events{/number}","events_url":"https://api.github.com/repos/bevyengine/bevy/events","assignees_url":"https://api.github.com/repos/bevyengine/bevy/assignees{/user}","branches_url":"https://api.github.com/repos/bevyengine/bevy/branches{/branch}","tags_url":"https://api.github.com/repos/bevyengine/bevy/tags","blobs_url":"https://api.github.com/repos/bevyengine/bevy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bevyengine/bevy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bevyengine/bevy/git/refs{/sha}","trees_url":"https://api.github.com/repos/bevyengine/bevy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bevyengine/bevy/statuses/{sha}","languages_url":"https://api.github.com/repos/bevyengine/bevy/languages","stargazers_url":"https://api.github.com/repos/bevyengine/bevy/stargazers","contributors_url":"https://api.github.com/repos/bevyengine/bevy/contributors","subscribers_url":"https://api.github.com/repos/bevyengine/bevy/subscribers","subscription_url":"https://api.github.com/repos/bevyengine/bevy/subscription","commits_url":"https://api.github.com/repos/bevyengine/bevy/commits{/sha}","git_commits_url":"https://api.github.com/repos/bevyengine/bevy/git/commits{/sha}","comments_url":"https://api.github.com/repos/bevyengine/bevy/comments{/number}","issue_comment_url":"https://api.github.com/repos/bevyengine/bevy/issues/comments{/number}","contents_url":"https://api.github.com/repos/bevyengine/bevy/contents/{+path}","compare_url":"https://api.github.com/repos/bevyengine/bevy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bevyengine/bevy/merges","archive_url":"https://api.github.com/repos/bevyengine/bevy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bevyengine/bevy/downloads","issues_url":"https://api.github.com/repos/bevyengine/bevy/issues{/number}","pulls_url":"https://api.github.com/repos/bevyengine/bevy/pulls{/number}","milestones_url":"https://api.github.com/repos/bevyengine/bevy/milestones{/number}","notifications_url":"https://api.github.com/repos/bevyengine/bevy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bevyengine/bevy/labels{/name}","releases_url":"https://api.github.com/repos/bevyengine/bevy/releases{/id}","deployments_url":"https://api.github.com/repos/bevyengine/bevy/deployments","created_at":"2020-01-18T21:13:55Z","updated_at":"2025-11-10T00:30:24Z","pushed_at":"2025-11-09T20:05:46Z","git_url":"git://github.com/bevyengine/bevy.git","ssh_url":"git@github.com:bevyengine/bevy.git","clone_url":"https://github.com/bevyengine/bevy.git","svn_url":"https://github.com/bevyengine/bevy","homepage":"https://bevy.org","size":152673,"stargazers_count":42996,"watchers_count":42996,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":4220,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3116,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bevy","game-development","game-engine","gamedev","open-source","rust"],"visibility":"public","forks":4220,"open_issues":3116,"watchers":42996,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/bevyengine/bevy/pulls/14668","html_url":"https://github.com/bevyengine/bevy/pull/14668","diff_url":"https://github.com/bevyengine/bevy/pull/14668.diff","patch_url":"https://github.com/bevyengine/bevy/pull/14668.patch","merged_at":null},"body":"# Objective\r\n\r\nQuoting the [Relations RFC](https://github.com/james-j-obrien/rfcs/blob/minimal-fragmenting-relationships/rfcs/79-minimal-fragmenting-relationships.md#query-and-system-caches):\r\n\r\n> Query's caches of matching tables and archetypes are updated each time the query is accessed by iterating through the archetypes that have been created since it was last accessed. As the number of archetypes in bevy is expected to stabilize over the runtime of a program this isn't currently an issue. However with the increased archetype fragmentation caused by fragmenting relationships and the new wrinkle of archetype deletion the updating of the query caches is poised to become a performance bottleneck.\r\n> \r\n> An appropriate solution would allow us to expose new/deleted archetypes to only the queries that may be interested in iterating them. Luckily observers https://github.com/bevyengine/bevy/pull/10839 could cleanly model this pattern. By sending ECS triggers each time an archetype is created and creating an observer for each query we can target the updates so that we no longer need to iterate every new archetype. Similarly we can fire archetype deletion events to cause queries to remove the archetype from their cache.\r\n\r\n## Solution\r\n\r\nContinuing the quote:\r\n\r\n> In order to implement such a mechanism we need some way for the observer to have access to the query state. Currently QueryState is stored in the system state, so in order to update it we would need to expose several additional APIs, even then it's quite difficult to reach into the system state tuple to access the correct query without some macros to handle tuple indexing. An alternative would be to move the query state into a component on an associated entity (WIP branch here: [queries-as-entities](https://github.com/james-j-obrien/bevy/tree/queries-as-entities)) this provides additional benefits in making it easier manage dynamic queries, but they are largely tangential to this RFC.\r\n\r\n---\r\n\r\n## Migration Guide\r\n\r\nTBD\r\n","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/14668/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/14668/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"actor":{"login":"Trashtalk217","id":24552941,"node_id":"MDQ6VXNlcjI0NTUyOTQx","avatar_url":"https://avatars.githubusercontent.com/u/24552941?v=4","gravatar_id":"","url":"https://api.github.com/users/Trashtalk217","html_url":"https://github.com/Trashtalk217","followers_url":"https://api.github.com/users/Trashtalk217/followers","following_url":"https://api.github.com/users/Trashtalk217/following{/other_user}","gists_url":"https://api.github.com/users/Trashtalk217/gists{/gist_id}","starred_url":"https://api.github.com/users/Trashtalk217/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Trashtalk217/subscriptions","organizations_url":"https://api.github.com/users/Trashtalk217/orgs","repos_url":"https://api.github.com/users/Trashtalk217/repos","events_url":"https://api.github.com/users/Trashtalk217/events{/privacy}","received_events_url":"https://api.github.com/users/Trashtalk217/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2024-09-19T23:24:12Z","updated_at":"2024-09-19T23:24:12Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/15320","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/15320/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/15320/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/15320/events","html_url":"https://github.com/bevyengine/bevy/pull/15320","id":2537516053,"node_id":"PR_kwDODf6-U858GZX5","number":15320,"title":"Retain Rendering World (adopted)","user":{"login":"Trashtalk217","id":24552941,"node_id":"MDQ6VXNlcjI0NTUyOTQx","avatar_url":"https://avatars.githubusercontent.com/u/24552941?v=4","gravatar_id":"","url":"https://api.github.com/users/Trashtalk217","html_url":"https://github.com/Trashtalk217","followers_url":"https://api.github.com/users/Trashtalk217/followers","following_url":"https://api.github.com/users/Trashtalk217/following{/other_user}","gists_url":"https://api.github.com/users/Trashtalk217/gists{/gist_id}","starred_url":"https://api.github.com/users/Trashtalk217/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Trashtalk217/subscriptions","organizations_url":"https://api.github.com/users/Trashtalk217/orgs","repos_url":"https://api.github.com/users/Trashtalk217/repos","events_url":"https://api.github.com/users/Trashtalk217/events{/privacy}","received_events_url":"https://api.github.com/users/Trashtalk217/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2045383863,"node_id":"MDU6TGFiZWwyMDQ1MzgzODYz","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-Rendering","name":"A-Rendering","color":"C6A751","default":false,"description":"Drawing game state to the screen"},{"id":2197761682,"node_id":"MDU6TGFiZWwyMTk3NzYxNjgy","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-ECS","name":"A-ECS","color":"c6a751","default":false,"description":"Entities, components, systems, and events"},{"id":2747865511,"node_id":"MDU6TGFiZWwyNzQ3ODY1NTEx","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Ready-For-Final-Review","name":"S-Ready-For-Final-Review","color":"D876E3","default":false,"description":"This PR has been approved by the community. It's ready for a maintainer to consider merging it"},{"id":3166133948,"node_id":"MDU6TGFiZWwzMTY2MTMzOTQ4","url":"https://api.github.com/repos/bevyengine/bevy/labels/M-Migration-Guide","name":"M-Migration-Guide","color":"006B75","default":false,"description":"A breaking change to Bevy's public API that needs to be noted in a migration guide"},{"id":3166143717,"node_id":"MDU6TGFiZWwzMTY2MTQzNzE3","url":"https://api.github.com/repos/bevyengine/bevy/labels/D-Complex","name":"D-Complex","color":"008672","default":false,"description":"Quite challenging from either a design or technical perspective. Ask for help!"},{"id":6600141374,"node_id":"LA_kwDODf6-U88AAAABiWYqPg","url":"https://api.github.com/repos/bevyengine/bevy/labels/M-Release-Note","name":"M-Release-Note","color":"006B75","default":false,"description":"Work that should be called out in the blog due to impact"},{"id":6899554715,"node_id":"LA_kwDODf6-U88AAAABmz7Zmw","url":"https://api.github.com/repos/bevyengine/bevy/labels/X-Blessed","name":"X-Blessed","color":"D93F0B","default":false,"description":"Has a large architectural impact or tradeoffs, but the design has been endorsed by decision makers"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/bevyengine/bevy/milestones/24","html_url":"https://github.com/bevyengine/bevy/milestone/24","labels_url":"https://api.github.com/repos/bevyengine/bevy/milestones/24/labels","id":11048296,"node_id":"MI_kwDODf6-U84AqJVo","number":24,"title":"0.15","description":"","creator":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":550,"state":"closed","created_at":"2024-05-13T18:42:18Z","updated_at":"2024-11-30T03:58:51Z","due_on":null,"closed_at":"2024-11-29T22:40:27Z"},"comments":12,"created_at":"2024-09-19T23:24:11Z","updated_at":"2024-10-20T15:42:52Z","closed_at":"2024-09-30T19:15:19Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":234798675,"node_id":"MDEwOlJlcG9zaXRvcnkyMzQ3OTg2NzU=","name":"bevy","full_name":"bevyengine/bevy","private":false,"owner":{"login":"bevyengine","id":60047606,"node_id":"MDEyOk9yZ2FuaXphdGlvbjYwMDQ3NjA2","avatar_url":"https://avatars.githubusercontent.com/u/60047606?v=4","gravatar_id":"","url":"https://api.github.com/users/bevyengine","html_url":"https://github.com/bevyengine","followers_url":"https://api.github.com/users/bevyengine/followers","following_url":"https://api.github.com/users/bevyengine/following{/other_user}","gists_url":"https://api.github.com/users/bevyengine/gists{/gist_id}","starred_url":"https://api.github.com/users/bevyengine/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bevyengine/subscriptions","organizations_url":"https://api.github.com/users/bevyengine/orgs","repos_url":"https://api.github.com/users/bevyengine/repos","events_url":"https://api.github.com/users/bevyengine/events{/privacy}","received_events_url":"https://api.github.com/users/bevyengine/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/bevyengine/bevy","description":"A refreshingly simple data-driven game engine built in Rust","fork":false,"url":"https://api.github.com/repos/bevyengine/bevy","forks_url":"https://api.github.com/repos/bevyengine/bevy/forks","keys_url":"https://api.github.com/repos/bevyengine/bevy/keys{/key_id}","collaborators_url":"https://api.github.com/repos/bevyengine/bevy/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/bevyengine/bevy/teams","hooks_url":"https://api.github.com/repos/bevyengine/bevy/hooks","issue_events_url":"https://api.github.com/repos/bevyengine/bevy/issues/events{/number}","events_url":"https://api.github.com/repos/bevyengine/bevy/events","assignees_url":"https://api.github.com/repos/bevyengine/bevy/assignees{/user}","branches_url":"https://api.github.com/repos/bevyengine/bevy/branches{/branch}","tags_url":"https://api.github.com/repos/bevyengine/bevy/tags","blobs_url":"https://api.github.com/repos/bevyengine/bevy/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/bevyengine/bevy/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/bevyengine/bevy/git/refs{/sha}","trees_url":"https://api.github.com/repos/bevyengine/bevy/git/trees{/sha}","statuses_url":"https://api.github.com/repos/bevyengine/bevy/statuses/{sha}","languages_url":"https://api.github.com/repos/bevyengine/bevy/languages","stargazers_url":"https://api.github.com/repos/bevyengine/bevy/stargazers","contributors_url":"https://api.github.com/repos/bevyengine/bevy/contributors","subscribers_url":"https://api.github.com/repos/bevyengine/bevy/subscribers","subscription_url":"https://api.github.com/repos/bevyengine/bevy/subscription","commits_url":"https://api.github.com/repos/bevyengine/bevy/commits{/sha}","git_commits_url":"https://api.github.com/repos/bevyengine/bevy/git/commits{/sha}","comments_url":"https://api.github.com/repos/bevyengine/bevy/comments{/number}","issue_comment_url":"https://api.github.com/repos/bevyengine/bevy/issues/comments{/number}","contents_url":"https://api.github.com/repos/bevyengine/bevy/contents/{+path}","compare_url":"https://api.github.com/repos/bevyengine/bevy/compare/{base}...{head}","merges_url":"https://api.github.com/repos/bevyengine/bevy/merges","archive_url":"https://api.github.com/repos/bevyengine/bevy/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/bevyengine/bevy/downloads","issues_url":"https://api.github.com/repos/bevyengine/bevy/issues{/number}","pulls_url":"https://api.github.com/repos/bevyengine/bevy/pulls{/number}","milestones_url":"https://api.github.com/repos/bevyengine/bevy/milestones{/number}","notifications_url":"https://api.github.com/repos/bevyengine/bevy/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/bevyengine/bevy/labels{/name}","releases_url":"https://api.github.com/repos/bevyengine/bevy/releases{/id}","deployments_url":"https://api.github.com/repos/bevyengine/bevy/deployments","created_at":"2020-01-18T21:13:55Z","updated_at":"2025-11-10T00:30:24Z","pushed_at":"2025-11-09T20:05:46Z","git_url":"git://github.com/bevyengine/bevy.git","ssh_url":"git@github.com:bevyengine/bevy.git","clone_url":"https://github.com/bevyengine/bevy.git","svn_url":"https://github.com/bevyengine/bevy","homepage":"https://bevy.org","size":152673,"stargazers_count":42996,"watchers_count":42996,"language":"Rust","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":false,"has_pages":true,"has_discussions":true,"forks_count":4220,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":3116,"license":{"key":"apache-2.0","name":"Apache License 2.0","spdx_id":"Apache-2.0","url":"https://api.github.com/licenses/apache-2.0","node_id":"MDc6TGljZW5zZTI="},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["bevy","game-development","game-engine","gamedev","open-source","rust"],"visibility":"public","forks":4220,"open_issues":3116,"watchers":42996,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/bevyengine/bevy/pulls/15320","html_url":"https://github.com/bevyengine/bevy/pull/15320","diff_url":"https://github.com/bevyengine/bevy/pull/15320.diff","patch_url":"https://github.com/bevyengine/bevy/pull/15320.patch","merged_at":"2024-09-30T19:15:19Z"},"body":"- Adopted from #14449\r\n- Still fixes #12144.\r\n\r\n## Migration Guide\r\n\r\nThe retained render world is a complex change: migrating might take one of a few different forms depending on the patterns you're using.\r\n\r\nFor every example, we specify in which world the code is run. Most of the changes affect render world code, so for the average Bevy user who's using Bevy's high-level rendering APIs, these changes are unlikely to affect your code.\r\n\r\n### Spawning entities in the render world\r\n\r\nPreviously, if you spawned an entity with `world.spawn(...)`, `commands.spawn(...)` or some other method in the rendering world, it would be despawned at the end of each frame. In 0.15, this is no longer the case and so your old code could leak entities. This can be mitigated by either re-architecting your code to no longer continuously spawn entities (like you're used to in the main world), or by adding the `bevy_render::world_sync::TemporaryRenderEntity` component to the entity you're spawning. Entities tagged with `TemporaryRenderEntity` will be removed at the end of each frame (like before).\r\n\r\n### Extract components with `ExtractComponentPlugin`\r\n\r\n```\r\n// main world\r\napp.add_plugins(ExtractComponentPlugin::<ComponentToExtract>::default());\r\n```\r\n\r\n`ExtractComponentPlugin` has been changed to only work with synced entities. Entities are automatically synced if `ComponentToExtract` is added to them. However, entities are not \"unsynced\" if any given `ComponentToExtract` is removed, because an entity may have multiple components to extract. This would cause the other components to no longer get extracted because the entity is not synced. \r\n\r\nSo be careful when only removing extracted components from entities in the render world, because it might leave an entity behind in the render world. The solution here is to avoid only removing extracted components and instead despawn the entire entity. \r\n\r\n### Manual extraction using `Extract<Query<(Entity, ...)>>`\r\n\r\n```rust\r\n// in render world, inspired by bevy_pbr/src/cluster/mod.rs\r\npub fn extract_clusters(\r\n    mut commands: Commands,\r\n    views: Extract<Query<(Entity, &Clusters, &Camera)>>,\r\n) {\r\n    for (entity, clusters, camera) in &views {\r\n        // some code\r\n        commands.get_or_spawn(entity).insert(...);\r\n    }\r\n}\r\n```\r\nOne of the primary consequences of the retained rendering world is that there's no longer a one-to-one mapping from entity IDs in the main world to entity IDs in the render world. Unlike in Bevy 0.14, Entity 42 in the main world doesn't necessarily map to entity 42 in the render world. \r\n\r\nPrevious code which called  `get_or_spawn(main_world_entity)` in the render world (`Extract<Query<(Entity, ...)>>` returns main world entities). Instead, you should use `&RenderEntity` and `render_entity.id()` to get the correct entity in the render world. Note that this entity does need to be synced first in order to have a `RenderEntity`.\r\n\r\nWhen performing manual abstraction, this won't happen automatically (like with `ExtractComponentPlugin`) so add a `SyncToRenderWorld` marker component to the entities you want to extract.\r\n\r\nThis results in the following code:\r\n```rust\r\n// in render world, inspired by bevy_pbr/src/cluster/mod.rs\r\npub fn extract_clusters(\r\n    mut commands: Commands,\r\n    views: Extract<Query<(&RenderEntity, &Clusters, &Camera)>>,\r\n) {\r\n    for (render_entity, clusters, camera) in &views {\r\n        // some code\r\n        commands.get_or_spawn(render_entity.id()).insert(...);\r\n    }\r\n}\r\n\r\n// in main world, when spawning\r\nworld.spawn(Clusters::default(), Camera::default(), SyncToRenderWorld)\r\n```\r\n\r\n### Looking up `Entity` ids in the render world\r\n\r\nAs previously stated, there's now no correspondence between main world and render world `Entity` identifiers. \r\n\r\nQuerying for `Entity` in the render world will return the `Entity` id in the render world: query for `MainEntity` (and use its `id()` method) to get the corresponding entity in the main world.\r\n\r\nThis is also a good way to tell the difference between synced and unsynced entities in the render world, because unsynced entities won't have a `MainEntity` component.","reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/15320/reactions","total_count":3,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":3,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/15320/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":14461204545,"node_id":"REFE_lADODf6-U86Ad9BGzwAAAANd9HhB","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/14461204545","actor":{"login":"github-merge-queue[bot]","id":118344674,"node_id":"BOT_kgDOBw3L4g","avatar_url":"https://avatars.githubusercontent.com/u/9919?v=4","gravatar_id":"","url":"https://api.github.com/users/github-merge-queue%5Bbot%5D","html_url":"https://github.com/apps/github-merge-queue","followers_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-merge-queue%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"56f8e526dde49b4e4ad62efb7ad27bfe0bd6f617","commit_url":"https://api.github.com/repos/bevyengine/bevy/commits/56f8e526dde49b4e4ad62efb7ad27bfe0bd6f617","created_at":"2024-09-30T19:15:20Z","performed_via_github_app":null},{"id":14461204732,"node_id":"CE_lADODf6-U86Ad9BGzwAAAANd9Hj8","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/14461204732","actor":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2024-09-30T19:15:21Z","state_reason":null,"performed_via_github_app":null},{"id":14461529578,"node_id":"UE_lADODf6-U86Ad9BGzwAAAANd-W3q","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/14461529578","actor":{"login":"BenjaminBrienen","id":42162869,"node_id":"MDQ6VXNlcjQyMTYyODY5","avatar_url":"https://avatars.githubusercontent.com/u/42162869?v=4","gravatar_id":"","url":"https://api.github.com/users/BenjaminBrienen","html_url":"https://github.com/BenjaminBrienen","followers_url":"https://api.github.com/users/BenjaminBrienen/followers","following_url":"https://api.github.com/users/BenjaminBrienen/following{/other_user}","gists_url":"https://api.github.com/users/BenjaminBrienen/gists{/gist_id}","starred_url":"https://api.github.com/users/BenjaminBrienen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenjaminBrienen/subscriptions","organizations_url":"https://api.github.com/users/BenjaminBrienen/orgs","repos_url":"https://api.github.com/users/BenjaminBrienen/repos","events_url":"https://api.github.com/users/BenjaminBrienen/events{/privacy}","received_events_url":"https://api.github.com/users/BenjaminBrienen/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"unsubscribed","commit_id":null,"commit_url":null,"created_at":"2024-09-30T19:46:16Z","performed_via_github_app":null},{"id":14516459004,"node_id":"REFE_lADODf6-U86Ad9BGzwAAAANhP5X8","url":"https://api.github.com/repos/bevyengine/bevy/issues/events/14516459004","actor":{"login":"robtfm","id":50659922,"node_id":"MDQ6VXNlcjUwNjU5OTIy","avatar_url":"https://avatars.githubusercontent.com/u/50659922?v=4","gravatar_id":"","url":"https://api.github.com/users/robtfm","html_url":"https://github.com/robtfm","followers_url":"https://api.github.com/users/robtfm/followers","following_url":"https://api.github.com/users/robtfm/following{/other_user}","gists_url":"https://api.github.com/users/robtfm/gists{/gist_id}","starred_url":"https://api.github.com/users/robtfm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/robtfm/subscriptions","organizations_url":"https://api.github.com/users/robtfm/orgs","repos_url":"https://api.github.com/users/robtfm/repos","events_url":"https://api.github.com/users/robtfm/events{/privacy}","received_events_url":"https://api.github.com/users/robtfm/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"2581fcb40e95f9fe6cce63322dbfc3164a693045","commit_url":"https://api.github.com/repos/robtfm/bevy/commits/2581fcb40e95f9fe6cce63322dbfc3164a693045","created_at":"2024-10-04T09:35:58Z","performed_via_github_app":null}]