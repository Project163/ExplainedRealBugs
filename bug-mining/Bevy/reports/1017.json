{"url":"https://api.github.com/repos/bevyengine/bevy/issues/21381","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/21381/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/21381/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/21381/events","html_url":"https://github.com/bevyengine/bevy/issues/21381","id":3483895654,"node_id":"I_kwDODf6-U87PqAdm","number":21381,"title":"dragging cube inside viewport in examples/ui/viewport_node not working","user":{"login":"df51d","id":122315498,"node_id":"U_kgDOB0pi6g","avatar_url":"https://avatars.githubusercontent.com/u/122315498?v=4","gravatar_id":"","url":"https://api.github.com/users/df51d","html_url":"https://github.com/df51d","followers_url":"https://api.github.com/users/df51d/followers","following_url":"https://api.github.com/users/df51d/following{/other_user}","gists_url":"https://api.github.com/users/df51d/gists{/gist_id}","starred_url":"https://api.github.com/users/df51d/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/df51d/subscriptions","organizations_url":"https://api.github.com/users/df51d/orgs","repos_url":"https://api.github.com/users/df51d/repos","events_url":"https://api.github.com/users/df51d/events{/privacy}","received_events_url":"https://api.github.com/users/df51d/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619323,"node_id":"MDU6TGFiZWwxNzk1NjE5MzIz","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Bug","name":"C-Bug","color":"d73a4a","default":false,"description":"An unexpected or incorrect behavior"},{"id":2488007862,"node_id":"MDU6TGFiZWwyNDg4MDA3ODYy","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Needs-Triage","name":"S-Needs-Triage","color":"D876e3","default":false,"description":"This issue needs to be labelled"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2025-10-04T15:49:04Z","updated_at":"2025-10-04T23:25:14Z","closed_at":"2025-10-04T23:25:14Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Before I say anything, the example and functionality was introduced in #17253, and it pushed the changes from\n[original repo of PR author](https://github.com/chompaa/bevy/tree/viewport-widget) which are **WORKING** correctly!\n\n## Bevy version and features\n- `bevy = { version = \"0.17.2\" }`\n\n## \\[Optional\\] Relevant system information\nTested on two different machines:\n-  `Windows 10`\n- `INFO SystemInfo { os: \"Linux (Arch Linux)\", kernel: \"6.16.10-arch1-1\", cpu: \"11th Gen Intel(R) Core(TM) i5-11400 @ 2.60GHz\", core_count: \"6\", memory: \"31.2 GiB\" }`\n\n```ignore\nAdapterInfo { name: \"NVIDIA GeForce GTX 750\", vendor: 4318, device: 4993, device_type: DiscreteGpu, driver: \"NVIDIA\", driver_info: \"580.82.09\", backend: Vulkan }\n\n```\n\n## What you did\n\nCopied and run example [ui/viewport_node](https://github.com/bevyengine/bevy/blob/main/examples/ui/viewport_node.rs)\n## What went wrong\nI was expecting that, when I click on the cube **inside** the viewport and drag my mouse, the cube should rotate. Same as in this video:\nhttps://bevy.org/news/bevy-0-17/viewport_node.mp4\nand it is not doing it on my end. \nI can only rotate cube when pressing directly on it with left mouse button\nor move the viewport window with right mouse button. But not rotate the cube when clicking on it inside the viewport with any mouse button i\n\n## Additional information\n\nI added the log to every branch, if, early exit and so on inside [fn viewport_picking](https://github.com/bevyengine/bevy/blob/27b9527da4875f01dacc9456b7d277093b93042b/crates/bevy_ui/src/widget/viewport.rs#L68):  only one log is executed at the start of the function.\n\n`viewport_query` inside `fn viewport_picking` is always of len 0. \n\nTo debug why is that I added this system:\n```rs\n app.add_systems(Startup, (test, foo.after(test)));\n\nfn foo(world: &mut World) {\n    let entity = world\n        .query_filtered::<Entity, With<ViewportNode>>()\n        .single(&world)\n        .unwrap();\n    let iter = world.inspect_entity(entity).unwrap();\n    for item in iter {\n        println!(\"{}\", item.name().shortname());\n    }\n}\n```\nTo debug what components are inside the viewport. It showed bunch of them, almost every one was inside `viewport_query`, except of `GlobalTransform`.\nWhich I then manually added when spawning `ViewportNode`:\n```rs\ncommands.spawn((\n  // ...\n  ViewportNode::new(camera),\n  GlobalTransform::IDENTITY,\n));\n```\nThis resulted in successfully running the viewport_query and executed a bunch of my logs inside `viewport_picking`, but still didn't rotate the cube.\n\n","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/21381/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/21381/timeline","performed_via_github_app":null,"state_reason":"completed"}