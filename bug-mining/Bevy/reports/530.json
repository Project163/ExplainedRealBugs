{"url":"https://api.github.com/repos/bevyengine/bevy/issues/16080","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/16080/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/16080/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/16080/events","html_url":"https://github.com/bevyengine/bevy/issues/16080","id":2611409383,"node_id":"I_kwDODf6-U86bpvHn","number":16080,"title":"Make BinnedRenderPhase fields for accessing batchable and unbatchable entities public","user":{"login":"askogseide","id":25616568,"node_id":"MDQ6VXNlcjI1NjE2NTY4","avatar_url":"https://avatars.githubusercontent.com/u/25616568?v=4","gravatar_id":"","url":"https://api.github.com/users/askogseide","html_url":"https://github.com/askogseide","followers_url":"https://api.github.com/users/askogseide/followers","following_url":"https://api.github.com/users/askogseide/following{/other_user}","gists_url":"https://api.github.com/users/askogseide/gists{/gist_id}","starred_url":"https://api.github.com/users/askogseide/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/askogseide/subscriptions","organizations_url":"https://api.github.com/users/askogseide/orgs","repos_url":"https://api.github.com/users/askogseide/repos","events_url":"https://api.github.com/users/askogseide/events{/privacy}","received_events_url":"https://api.github.com/users/askogseide/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2045383863,"node_id":"MDU6TGFiZWwyMDQ1MzgzODYz","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-Rendering","name":"A-Rendering","color":"C6A751","default":false,"description":"Drawing game state to the screen"},{"id":2747857990,"node_id":"MDU6TGFiZWwyNzQ3ODU3OTkw","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Usability","name":"C-Usability","color":"b8b8b8","default":false,"description":"A targeted quality-of-life change that makes Bevy easier to use"},{"id":3166151441,"node_id":"MDU6TGFiZWwzMTY2MTUxNDQx","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Ready-For-Implementation","name":"S-Ready-For-Implementation","color":"D876E3","default":false,"description":"This issue is ready for an implementation PR. Go for it!"},{"id":6899571146,"node_id":"LA_kwDODf6-U88AAAABmz8Zyg","url":"https://api.github.com/repos/bevyengine/bevy/labels/D-Straightforward","name":"D-Straightforward","color":"008672","default":false,"description":"Simple bug fixes and API improvements, docs, test and examples"}],"state":"closed","locked":false,"assignee":{"login":"BenjaminBrienen","id":42162869,"node_id":"MDQ6VXNlcjQyMTYyODY5","avatar_url":"https://avatars.githubusercontent.com/u/42162869?v=4","gravatar_id":"","url":"https://api.github.com/users/BenjaminBrienen","html_url":"https://github.com/BenjaminBrienen","followers_url":"https://api.github.com/users/BenjaminBrienen/followers","following_url":"https://api.github.com/users/BenjaminBrienen/following{/other_user}","gists_url":"https://api.github.com/users/BenjaminBrienen/gists{/gist_id}","starred_url":"https://api.github.com/users/BenjaminBrienen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenjaminBrienen/subscriptions","organizations_url":"https://api.github.com/users/BenjaminBrienen/orgs","repos_url":"https://api.github.com/users/BenjaminBrienen/repos","events_url":"https://api.github.com/users/BenjaminBrienen/events{/privacy}","received_events_url":"https://api.github.com/users/BenjaminBrienen/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"BenjaminBrienen","id":42162869,"node_id":"MDQ6VXNlcjQyMTYyODY5","avatar_url":"https://avatars.githubusercontent.com/u/42162869?v=4","gravatar_id":"","url":"https://api.github.com/users/BenjaminBrienen","html_url":"https://github.com/BenjaminBrienen","followers_url":"https://api.github.com/users/BenjaminBrienen/followers","following_url":"https://api.github.com/users/BenjaminBrienen/following{/other_user}","gists_url":"https://api.github.com/users/BenjaminBrienen/gists{/gist_id}","starred_url":"https://api.github.com/users/BenjaminBrienen/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/BenjaminBrienen/subscriptions","organizations_url":"https://api.github.com/users/BenjaminBrienen/orgs","repos_url":"https://api.github.com/users/BenjaminBrienen/repos","events_url":"https://api.github.com/users/BenjaminBrienen/events{/privacy}","received_events_url":"https://api.github.com/users/BenjaminBrienen/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2024-10-24T12:18:41Z","updated_at":"2024-11-07T18:22:43Z","closed_at":"2024-11-07T18:22:43Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## What problem does this solve or what need does it fill?\nBinnedRenderPhase already has two public fields (`batchable_mesh_keys` and `unbatchable_mesh_keys`) which contain the keys to the hashmaps `batchable_mesh_values` and `unbatchable_mesh_values`, so I think it would make sense if the hashamps were public as well.\n\nIt would be useful to be able to read the values of `batchable_mesh_values` and `unbatchable_mesh_values` in the render world, in order to be able to see\n1. which entities are being batched together and\n2. which entities have which `instance_index`.\n\n### This could be used for\n- gpu picking of instances (determining which entity has which instance index and sending the instance index from the render world to the app world and comparing it with the instance index from the shader)\n- debugging (checking the expected entities are being batched together)\n\n## What solution would you like?\nMaking `batchable_mesh_values`, `unbatchable_mesh_values`, `UnbatchableBinnedEntities` and `UnbatchableBinnedEntities.entities` public instead of pub(crate).\n\n## What alternative(s) have you considered?\n- The fields could have public getters instead of being public.\n- A resource or components could be created that contain a batch group number and the instance_index for each entity. This resource or components could be updated in the `batch_and_prepare_binned_render_phase` systems in `bevy/crates/bevy_render/src/batching/gpu_preprocessing.rs `and `bevy/crates/bevy_render/src/batching/no_gpu_preprocessing.rs`.\n\n## Additional context\nI don't know if there is already a way of getting the batch and `instance_index` for each entity that I am missing. By reading the values from `batchable_mesh_values` and `unbatchable_mesh_values`, I think it is possible to determine which entites have which `instance_index` by iterating over the vector of entities for each key in `batchable_mesh_values` and `unbatchable_mesh_values` in the same way as is done in the `batch_and_prepare_binned_render_phase` systems.","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/16080/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/16080/timeline","performed_via_github_app":null,"state_reason":"completed"}