{"url":"https://api.github.com/repos/bevyengine/bevy/issues/18616","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/18616/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/18616/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/18616/events","html_url":"https://github.com/bevyengine/bevy/issues/18616","id":2958605157,"node_id":"I_kwDODf6-U86wWLtl","number":18616,"title":"Child text components created after initial object creation are invisible","user":{"login":"jansenMurphy","id":32967985,"node_id":"MDQ6VXNlcjMyOTY3OTg1","avatar_url":"https://avatars.githubusercontent.com/u/32967985?v=4","gravatar_id":"","url":"https://api.github.com/users/jansenMurphy","html_url":"https://github.com/jansenMurphy","followers_url":"https://api.github.com/users/jansenMurphy/followers","following_url":"https://api.github.com/users/jansenMurphy/following{/other_user}","gists_url":"https://api.github.com/users/jansenMurphy/gists{/gist_id}","starred_url":"https://api.github.com/users/jansenMurphy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jansenMurphy/subscriptions","organizations_url":"https://api.github.com/users/jansenMurphy/orgs","repos_url":"https://api.github.com/users/jansenMurphy/repos","events_url":"https://api.github.com/users/jansenMurphy/events{/privacy}","received_events_url":"https://api.github.com/users/jansenMurphy/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619323,"node_id":"MDU6TGFiZWwxNzk1NjE5MzIz","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Bug","name":"C-Bug","color":"d73a4a","default":false,"description":"An unexpected or incorrect behavior"},{"id":2045383863,"node_id":"MDU6TGFiZWwyMDQ1MzgzODYz","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-Rendering","name":"A-Rendering","color":"C6A751","default":false,"description":"Drawing game state to the screen"},{"id":2276469463,"node_id":"MDU6TGFiZWwyMjc2NDY5NDYz","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-UI","name":"A-UI","color":"c6a751","default":false,"description":"Graphical user interfaces, styles, layouts, and widgets"},{"id":3166151441,"node_id":"MDU6TGFiZWwzMTY2MTUxNDQx","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Ready-For-Implementation","name":"S-Ready-For-Implementation","color":"D876E3","default":false,"description":"This issue is ready for an implementation PR. Go for it!"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/bevyengine/bevy/milestones/28","html_url":"https://github.com/bevyengine/bevy/milestone/28","labels_url":"https://api.github.com/repos/bevyengine/bevy/milestones/28/labels","id":11655039,"node_id":"MI_kwDODf6-U84Asdd_","number":28,"title":"0.16","description":"","creator":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":558,"state":"closed","created_at":"2024-09-30T20:15:21Z","updated_at":"2025-04-25T13:01:43Z","due_on":null,"closed_at":"2025-04-25T13:01:43Z"},"comments":6,"created_at":"2025-03-30T01:49:02Z","updated_at":"2025-04-01T20:10:17Z","closed_at":"2025-04-01T20:10:17Z","author_association":"NONE","type":{"id":11850499,"node_id":"IT_kwDOA5RA9s4AtNMD","name":"Bug","description":"An unexpected problem or behavior","color":"red","created_at":"2024-02-04T05:41:55Z","updated_at":"2024-07-26T13:07:36Z","is_enabled":true},"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Bevy version\n\n0.16.0-rc.2\n\n## Relevant system information\n\nRust version: 1.87.0-nightly (6cf826701 2025-03-14)\nAdapterInfo\n- name: \"NVIDIA GeForce RTX 3060\",\n- vendor: 4318, device: 9476\n- device_type: DiscreteGpu\n- driver: \"NVIDIA\"\n- driver_info: \"560.94\"\n- backend: Vulkan\n\nWindows 11 (build 22631) - Multi-window, 2 monitors - Vulkan (Forward+) - dedicated NVIDIA GeForce RTX 3060 (NVIDIA; 32.0.15.6094) - AMD Ryzen 9 5900X 12-Core Processor (24 threads)\n## What you did\nhttps://github.com/jansenMurphy/bevy_minimum_text_render_failure_example\n\nWith this example code, click 'Menu A' and 'Menu B' repeatedly to add and remove the entities and see how the text in menu B fails to render as expected.\n\nThis was as minimal as I knew how to get it:\n```use bevy::prelude::*;\n\n#[derive(States, Debug, Clone, Copy, Eq, PartialEq, PartialOrd, Ord, Hash, Default)]\nenum AppState{\n    #[default]\n    StateA,\n    StateB,\n}\n\n#[derive(Component)]\nstruct MenuRoot;\n#[derive(Component)]\nstruct MenuStateARoot;\n#[derive(Component)]\nstruct MenuStateBRoot;\n\nfn main() {\n\n    App::new()\n        .add_plugins(DefaultPlugins)\n        .add_systems(OnEnter(AppState::StateA), setup_a)\n        .add_systems(OnExit(AppState::StateA), teardown::<MenuStateARoot>)\n        .add_systems(OnEnter(AppState::StateB), setup_b)\n        .add_systems(OnExit(AppState::StateB), teardown::<MenuStateBRoot>)\n        .add_systems(Startup, setup_root)\n        .init_state::<AppState>()\n        .run();\n}\n\nfn setup_root(mut commands: Commands){\n\n    commands.spawn((\n        Camera {\n            order: 20,\n            ..Default::default()\n        },\n        Camera2d,\n        IsDefaultUiCamera,\n    ));\n\n    commands.spawn((\n        MenuRoot,\n        Node{\n            ..Default::default()\n        },\n        Button\n    )).with_children(|parent|{\n        parent.spawn((\n            Button,\n            Text::new(\"Menu A\")\n        )).observe(|\n            mut _trigger: Trigger<Pointer<Click>>,\n            mut next_app_state: ResMut<NextState<AppState>>\n        | {\n            println!(\"To A\");\n            next_app_state.set(AppState::StateA);\n        });\n\n        parent.spawn((\n            Button,\n            Text::new(\"Menu B\")\n        )).observe(|\n            mut _trigger: Trigger<Pointer<Click>>,\n            mut next_app_state: ResMut<NextState<AppState>>\n        | {\n            println!(\"To B\");\n            next_app_state.set(AppState::StateB);\n        });\n    });\n}\n\nfn setup_a(\n    mut commands: Commands,\n    q: Query<Entity, With<MenuRoot>>,\n){\n    if let Ok(parent) = q.single(){\n\n        println!(\"Setup A\");\n        commands.spawn((\n            ChildOf{parent},\n            MenuStateARoot,\n            Text::new(\"This text appears\"),\n            BackgroundColor(Color::srgb(0.0, 1.0, 0.0))\n        ));\n\n        commands.spawn((\n            ChildOf{parent},\n            Button,\n            BackgroundColor(Color::srgb(0.5, 0.5, 0.0))\n        ));\n    }\n}\n\nfn setup_b(\n    mut commands: Commands,\n    q: Query<Entity, With<MenuRoot>>,\n){\n    if let Ok(parent) = q.single(){\n\n        println!(\"Setup B\");\n        commands.spawn((\n            ChildOf{parent},\n            MenuStateBRoot,\n            Node{..Default::default()},\n            BackgroundColor(Color::srgb(0.1, 0.1, 0.1))\n        )).with_children(|sub_parent|{\n            sub_parent.spawn((\n                Text::new(\"This text should appear but does not\"),\n                BackgroundColor(Color::srgb(0.0, 0.0, 1.0)),\n            ));\n        });\n\n        commands.spawn((\n            ChildOf{parent},\n            Button,\n            BackgroundColor(Color::srgb(0.0, 0.5, 0.5))\n        ));\n    }\n}\n\nfn teardown<T: Component>(to_despawn: Query<Entity, With<T>>, mut commands: Commands){\n    for entity in &to_despawn{\n        commands.entity(entity).despawn();\n    }\n}\n```\n\n## What went wrong\n\nI _think_ the problem is that when entities with text components are added as children to already-existing ui entities, the text is laid out properly but not rendered.\n\nI was expecting to be able to add child 'menus' with text to a root menu long after instantiating the root of the menu. \n\n## Additional information\nThe dark grey rectangle should be rendering text but is not. It's the appropriate width for the text content\n![Image](https://github.com/user-attachments/assets/cb58eeb1-f862-49b5-9d22-30d06fff0709)\n\nApologies if this is already an issue; I didn't see it if it was.","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/18616/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/18616/timeline","performed_via_github_app":null,"state_reason":"completed"}