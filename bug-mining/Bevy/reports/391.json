{"url":"https://api.github.com/repos/bevyengine/bevy/issues/15154","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/15154/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/15154/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/15154/events","html_url":"https://github.com/bevyengine/bevy/issues/15154","id":2518290838,"node_id":"I_kwDODf6-U86WGhGW","number":15154,"title":"uberbuffers selects single mesh when two are added","user":{"login":"ChristopherBiscardi","id":551247,"node_id":"MDQ6VXNlcjU1MTI0Nw==","avatar_url":"https://avatars.githubusercontent.com/u/551247?v=4","gravatar_id":"","url":"https://api.github.com/users/ChristopherBiscardi","html_url":"https://github.com/ChristopherBiscardi","followers_url":"https://api.github.com/users/ChristopherBiscardi/followers","following_url":"https://api.github.com/users/ChristopherBiscardi/following{/other_user}","gists_url":"https://api.github.com/users/ChristopherBiscardi/gists{/gist_id}","starred_url":"https://api.github.com/users/ChristopherBiscardi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ChristopherBiscardi/subscriptions","organizations_url":"https://api.github.com/users/ChristopherBiscardi/orgs","repos_url":"https://api.github.com/users/ChristopherBiscardi/repos","events_url":"https://api.github.com/users/ChristopherBiscardi/events{/privacy}","received_events_url":"https://api.github.com/users/ChristopherBiscardi/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619323,"node_id":"MDU6TGFiZWwxNzk1NjE5MzIz","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Bug","name":"C-Bug","color":"d73a4a","default":false,"description":"An unexpected or incorrect behavior"},{"id":2488007862,"node_id":"MDU6TGFiZWwyNDg4MDA3ODYy","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Needs-Triage","name":"S-Needs-Triage","color":"D876e3","default":false,"description":"This issue needs to be labelled"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-09-11T02:03:35Z","updated_at":"2024-09-12T12:56:40Z","closed_at":"2024-09-12T12:56:40Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Bevy version\r\n\r\nmain, 0.15.0-dev.\r\n\r\nintroduced in bc342169293187cb1e9b59bb0f6a0872f457b5d1 by https://github.com/bevyengine/bevy/pull/14257\r\n\r\nThe same mesh is used even though there are two different custom meshes added. Each time the program runs, one of the two meshes is selected and used for both renders.\r\n\r\n![screenshot-2024-09-10-at-18 56 51@2x](https://github.com/user-attachments/assets/a5f878ee-0b40-4771-8d87-7f067f2589df)\r\n![screenshot-2024-09-10-at-18 56 38@2x](https://github.com/user-attachments/assets/fa825dfe-967e-4f9a-a604-66d463ebefbe)\r\n\r\n\r\nThe previous commit 293e91564b20dc2971e47c79e727f7db2349024c does not show the bug.\r\n\r\n![screenshot-2024-09-10-at-18 56 02@2x](https://github.com/user-attachments/assets/5f30a42c-497d-4361-ab2d-b3b56fb0094c)\r\n\r\n## What you did\r\n\r\nThe following program adds two different custom 2d meshes.\r\n\r\n```\r\nuse bevy::{\r\n    prelude::*,\r\n    render::{\r\n        mesh::PrimitiveTopology,\r\n        render_asset::RenderAssetUsages,\r\n    },\r\n    sprite::{MaterialMesh2dBundle, Mesh2dHandle},\r\n};\r\n\r\nfn main() {\r\n    App::new()\r\n        .add_plugins(DefaultPlugins)\r\n        .add_systems(Startup, spawn_custom_meshes)\r\n        .run();\r\n}\r\n\r\npub fn spawn_custom_meshes(\r\n    mut commands: Commands,\r\n    mut meshes: ResMut<Assets<Mesh>>,\r\n    mut materials: ResMut<Assets<ColorMaterial>>,\r\n) {\r\n    commands.spawn(Camera2dBundle::default());\r\n\r\n    let mesh_1 = Mesh::new(\r\n        PrimitiveTopology::TriangleList,\r\n        RenderAssetUsages::RENDER_WORLD,\r\n    )\r\n    .with_inserted_attribute(\r\n        Mesh::ATTRIBUTE_POSITION,\r\n        vec![\r\n            [50., 0., 0.],\r\n            [-50., 0., 0.],\r\n            [0., 100., 0.],\r\n            [50., 0., 0.],\r\n        ],\r\n    );\r\n\r\n    commands.spawn(MaterialMesh2dBundle {\r\n        mesh: Mesh2dHandle(meshes.add(mesh_1)),\r\n        material: materials.add(ColorMaterial {\r\n            color: Color::linear_rgb(0., 1., 0.),\r\n            ..Default::default()\r\n        }),\r\n\r\n        transform: Transform::from_xyz(-50., 0., 0.),\r\n        ..default()\r\n    });\r\n\r\n    let mesh_2 = Mesh::new(\r\n        PrimitiveTopology::TriangleList,\r\n        RenderAssetUsages::RENDER_WORLD,\r\n    )\r\n    .with_inserted_attribute(\r\n        Mesh::ATTRIBUTE_POSITION,\r\n        vec![\r\n            [-50., 50., 0.],\r\n            [50., 50., 0.],\r\n            [0., -50., 0.],\r\n            [-50., 50., 0.],\r\n        ],\r\n    );\r\n\r\n    commands.spawn(MaterialMesh2dBundle {\r\n        mesh: Mesh2dHandle(meshes.add(mesh_2)),\r\n        material: materials.add(ColorMaterial {\r\n            color: Color::linear_rgb(0., 0., 1.),\r\n            ..Default::default()\r\n        }),\r\n\r\n        transform: Transform::from_xyz(50., 0., 0.),\r\n        ..default()\r\n    });\r\n}\r\n```\r\n\r\nHere's a cargo.toml for ease of replication\r\n\r\n```toml\r\n[package]\r\nname = \"meshes\"\r\nversion = \"0.1.0\"\r\nedition = \"2021\"\r\n\r\n[dependencies]\r\n# main\r\nbevy = { git = \"https://github.com/bevyengine/bevy.git\" }\r\n## has bug\r\n# bevy = { git = \"https://github.com/bevyengine/bevy.git\", rev = \"bc342169293187cb1e9b59bb0f6a0872f457b5d1\" }\r\n## prior commit, no bug\r\n# bevy = { git = \"https://github.com/bevyengine/bevy.git\", rev = \"293e91564b20dc2971e47c79e727f7db2349024c\" }\r\n```\r\n\r\n## Additional information\r\n\r\nThere were some updates to the 3d pipeline to fix example regressions. Item 2 in https://github.com/bevyengine/bevy/pull/14375 might be relevant.","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/15154/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/15154/timeline","performed_via_github_app":null,"state_reason":"completed"}