{"url":"https://api.github.com/repos/bevyengine/bevy/issues/18081","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/18081/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/18081/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/18081/events","html_url":"https://github.com/bevyengine/bevy/issues/18081","id":2885779262,"node_id":"I_kwDODf6-U86sAX8-","number":18081,"title":"RayMeshHit.triangle_index contains the first vertex index instead of the triangle index","user":{"login":"brookman","id":1568303,"node_id":"MDQ6VXNlcjE1NjgzMDM=","avatar_url":"https://avatars.githubusercontent.com/u/1568303?v=4","gravatar_id":"","url":"https://api.github.com/users/brookman","html_url":"https://github.com/brookman","followers_url":"https://api.github.com/users/brookman/followers","following_url":"https://api.github.com/users/brookman/following{/other_user}","gists_url":"https://api.github.com/users/brookman/gists{/gist_id}","starred_url":"https://api.github.com/users/brookman/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brookman/subscriptions","organizations_url":"https://api.github.com/users/brookman/orgs","repos_url":"https://api.github.com/users/brookman/repos","events_url":"https://api.github.com/users/brookman/events{/privacy}","received_events_url":"https://api.github.com/users/brookman/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619323,"node_id":"MDU6TGFiZWwxNzk1NjE5MzIz","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Bug","name":"C-Bug","color":"d73a4a","default":false,"description":"An unexpected or incorrect behavior"},{"id":3166151441,"node_id":"MDU6TGFiZWwzMTY2MTUxNDQx","url":"https://api.github.com/repos/bevyengine/bevy/labels/S-Ready-For-Implementation","name":"S-Ready-For-Implementation","color":"D876E3","default":false,"description":"This issue is ready for an implementation PR. Go for it!"},{"id":6899571146,"node_id":"LA_kwDODf6-U88AAAABmz8Zyg","url":"https://api.github.com/repos/bevyengine/bevy/labels/D-Straightforward","name":"D-Straightforward","color":"008672","default":false,"description":"Simple bug fixes and API improvements, docs, test and examples"},{"id":7040334053,"node_id":"LA_kwDODf6-U88AAAABo6L45Q","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-Picking","name":"A-Picking","color":"c6A751","default":false,"description":"Pointing at and selecting objects of all sorts"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":2,"created_at":"2025-02-27T22:56:40Z","updated_at":"2025-03-31T19:16:53Z","closed_at":"2025-03-31T19:16:53Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Bevy Version: 0.15**\n\n**Issue Summary**  \n`RayMeshHit.triangle_index` currently stores the index of the first vertex of the hit triangle rather than the triangle’s actual index. This makes it impossible to determine the other two vertices when the mesh uses indexed geometry (especially when vertices are shared among multiple triangles or aren’t strictly grouped in triples). As a result, getting UVs or texture colors for the exact hit point is blocked.\nThis prevents use-cases like texture painting and texture based decals from working.\n\n**Background**  \nThis problem was previously identified in the [`bevy_mod_raycast` crate](https://github.com/aevyrie/bevy_mod_raycast/pull/103) and an unmerged PR [#117](https://github.com/aevyrie/bevy_mod_raycast/pull/117) proposed a fix. The same issue appears to apply in the core Bevy code where the relevant code assigns `Some(a)` for the triangle index instead of using the iteration (triangle) index:\n\n```rust\nfor triangle in indices.chunks_exact(3) {\n    let [a, b, c] = [\n        triangle[0].try_into().ok()?,\n        triangle[1].try_into().ok()?,\n        triangle[2].try_into().ok()?,\n    ];\n    let triangle_index = Some(a);\n    // ...\n}\n```\n\nSwitching to:\n\n```rust\nfor (i, triangle) in indices.chunks_exact(3).enumerate() {\n    let [a, b, c] = [\n        triangle[0].try_into().ok()?,\n        triangle[1].try_into().ok()?,\n        triangle[2].try_into().ok()?,\n    ];\n    let triangle_index = Some(i);\n    // ...\n}\n```\n\nwould correctly store the triangle’s index instead of the first vertex index, resolving the issue.\n\n**Request**  \nPlease let me know if there’s any oversight or if I should open a PR to address this.","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/18081/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/18081/timeline","performed_via_github_app":null,"state_reason":"completed"}