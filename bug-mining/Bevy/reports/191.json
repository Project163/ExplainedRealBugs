{"url":"https://api.github.com/repos/bevyengine/bevy/issues/13207","repository_url":"https://api.github.com/repos/bevyengine/bevy","labels_url":"https://api.github.com/repos/bevyengine/bevy/issues/13207/labels{/name}","comments_url":"https://api.github.com/repos/bevyengine/bevy/issues/13207/comments","events_url":"https://api.github.com/repos/bevyengine/bevy/issues/13207/events","html_url":"https://github.com/bevyengine/bevy/issues/13207","id":2278099555,"node_id":"I_kwDODf6-U86HyQpj","number":13207,"title":"Invalid shader import after #13121","user":{"login":"arcashka","id":12927583,"node_id":"MDQ6VXNlcjEyOTI3NTgz","avatar_url":"https://avatars.githubusercontent.com/u/12927583?v=4","gravatar_id":"","url":"https://api.github.com/users/arcashka","html_url":"https://github.com/arcashka","followers_url":"https://api.github.com/users/arcashka/followers","following_url":"https://api.github.com/users/arcashka/following{/other_user}","gists_url":"https://api.github.com/users/arcashka/gists{/gist_id}","starred_url":"https://api.github.com/users/arcashka/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/arcashka/subscriptions","organizations_url":"https://api.github.com/users/arcashka/orgs","repos_url":"https://api.github.com/users/arcashka/repos","events_url":"https://api.github.com/users/arcashka/events{/privacy}","received_events_url":"https://api.github.com/users/arcashka/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":1795619323,"node_id":"MDU6TGFiZWwxNzk1NjE5MzIz","url":"https://api.github.com/repos/bevyengine/bevy/labels/C-Bug","name":"C-Bug","color":"d73a4a","default":false,"description":"An unexpected or incorrect behavior"},{"id":2045383863,"node_id":"MDU6TGFiZWwyMDQ1MzgzODYz","url":"https://api.github.com/repos/bevyengine/bevy/labels/A-Rendering","name":"A-Rendering","color":"C6A751","default":false,"description":"Drawing game state to the screen"}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/bevyengine/bevy/milestones/20","html_url":"https://github.com/bevyengine/bevy/milestone/20","labels_url":"https://api.github.com/repos/bevyengine/bevy/milestones/20/labels","id":10463467,"node_id":"MI_kwDODf6-U84An6jr","number":20,"title":"0.14","description":"","creator":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":404,"state":"closed","created_at":"2024-01-24T15:23:42Z","updated_at":"2024-07-04T20:09:44Z","due_on":null,"closed_at":"2024-07-04T20:09:44Z"},"comments":0,"created_at":"2024-05-03T17:11:58Z","updated_at":"2024-05-04T10:45:33Z","closed_at":"2024-05-04T10:45:32Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"## Bevy version\r\nmain branch, regression after #13121\r\n\r\n## Issue\r\nTonemapping doesn't work if you don't use bevy_pbr feature\r\n```\r\n❯ cargo run\r\n   Compiling bevy_render v0.14.0-dev (/home/arcashka/Documents/projects/other/bevy/crates/bevy_render)\r\n   Compiling bevy_core_pipeline v0.14.0-dev (/home/arcashka/Documents/projects/other/bevy/crates/bevy_core_pipeline)\r\n   Compiling bevy_internal v0.14.0-dev (/home/arcashka/Documents/projects/other/bevy/crates/bevy_internal)\r\n   Compiling bevy v0.14.0-dev (/home/arcashka/Documents/projects/other/bevy)\r\n   Compiling issue2 v0.1.0 (/home/arcashka/Documents/projects/other/issue2)\r\n    Finished dev [unoptimized + debuginfo] target(s) in 7.50s\r\n     Running `target/debug/issue2`\r\n2024-05-03T11:22:14.962803Z  INFO bevy_winit::system: Creating new window \"App\" (Entity { index: 0, generation: 1 })\r\n2024-05-03T11:22:14.963476Z  INFO winit::platform_impl::platform::x11::window: Guessed window scale factor: 1\r\n2024-05-03T11:22:15.023778Z  INFO bevy_render::renderer: AdapterInfo { name: \"Intel(R) Graphics (ADL GT2)\", vendor: 32902, device: 17958, device_type: IntegratedGpu, driver: \"Intel open-source Mesa driver\", driver_info: \"Mesa 23.2.1-1ubuntu3.1\", backend: Vulkan }\r\n2024-05-03T11:22:15.230009Z ERROR bevy_render::render_resource::pipeline_cache: failed to process shader:\r\nerror: required import 'bevy_pbr::utils' not found\r\n    ┌─ /home/arcashka/Documents/projects/other/bevy/crates/bevy_core_pipeline/src/tonemapping/tonemapping_shared.wgsl:355:15\r\n    │\r\n355 │     var hsv = rgb_to_hsv(color);\r\n    │               ^\r\n    │\r\n    = missing import 'bevy_pbr::utils'\r\n\r\n\r\n2024-05-03T11:22:20.791119Z  INFO bevy_window::system: No windows are open, exiting\r\n```\r\n\r\n## Minimal example\r\n```Cargo.toml\r\n[package]\r\nname = \"issue2\"\r\nversion = \"0.1.0\"\r\nedition = \"2021\"\r\n\r\n# See more keys and their definitions at https://doc.rust-lang.org/cargo/reference/manifest.html\r\n\r\n[dependencies]\r\nbevy = { path = \"../bevy\", default-features = false, features = [\r\n    \"bevy_core_pipeline\",\r\n    \"tonemapping_luts\",\r\n    \"x11\",\r\n] }\r\n```\r\n\r\n```main.rs\r\nuse bevy::{core_pipeline::tonemapping::Tonemapping, prelude::*};\r\n\r\nfn main() {\r\n    App::new()\r\n        .add_plugins(DefaultPlugins)\r\n        .add_systems(Startup, setup)\r\n        .run();\r\n}\r\n\r\nfn setup(mut commands: Commands) {\r\n    commands.spawn(Camera2dBundle {\r\n        camera: Camera {\r\n            hdr: false,\r\n            ..default()\r\n        },\r\n        tonemapping: Tonemapping::BlenderFilmic,\r\n        ..default()\r\n    });\r\n}\r\n```\r\n\r\n## What you did\r\nI was investigating #13118 and found 2 other issues, so right now there are 3 issues related to the same scenario\r\n* This one\r\n* #13175\r\n* #13118\r\nThey all are reproducible with the same minimal example and cover each over. (I mean application fails on one of them and can not get to the point where other issues occurs)","closed_by":{"login":"alice-i-cecile","id":3579909,"node_id":"MDQ6VXNlcjM1Nzk5MDk=","avatar_url":"https://avatars.githubusercontent.com/u/3579909?v=4","gravatar_id":"","url":"https://api.github.com/users/alice-i-cecile","html_url":"https://github.com/alice-i-cecile","followers_url":"https://api.github.com/users/alice-i-cecile/followers","following_url":"https://api.github.com/users/alice-i-cecile/following{/other_user}","gists_url":"https://api.github.com/users/alice-i-cecile/gists{/gist_id}","starred_url":"https://api.github.com/users/alice-i-cecile/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/alice-i-cecile/subscriptions","organizations_url":"https://api.github.com/users/alice-i-cecile/orgs","repos_url":"https://api.github.com/users/alice-i-cecile/repos","events_url":"https://api.github.com/users/alice-i-cecile/events{/privacy}","received_events_url":"https://api.github.com/users/alice-i-cecile/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/bevyengine/bevy/issues/13207/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/bevyengine/bevy/issues/13207/timeline","performed_via_github_app":null,"state_reason":"completed"}