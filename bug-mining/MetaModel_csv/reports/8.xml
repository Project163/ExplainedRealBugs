<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Sat Nov 08 20:31:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[METAMODEL-1086] Encoding not used with InputStreams in CsvDataContext</title>
                <link>https://issues.apache.org/jira/browse/METAMODEL-1086</link>
                <project id="12314523" key="METAMODEL">Apache MetaModel (Retired)</project>
                    <description>&lt;p&gt;When using the Constructor with InputStreams you can get into trouble with encoding if the default encoding of your platform is different than the one used in the InputStream even though you specify an encoding in the CvsConfiguration.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;CsvDataContext csvDataContext = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CsvDataContext(someInputstream, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CsvConfiguration(1, &lt;span class=&quot;code-quote&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;&quot;&apos;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&apos;\\&apos;&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The offending code is in the static method createFileFromInputStream():&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; File createFileFromInputStream(InputStream inputStream, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; encoding) {
        ....
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; BufferedWriter writer = FileHelper.getBufferedWriter(file, encoding);
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; BufferedReader reader = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BufferedReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InputStreamReader(inputStream));
        ....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The InputStreamReader is instantiated without a charset. In this case the Platforms default charset is used (e.g. &quot;windows-1252&quot;). The BufferedWriter on the other hand is instantiated with the specified charset. This effectively causes a re-encoding if the file is in a different encoding (e.g. &quot;utf-8&quot;) than the platforms default encoding when the content of the stream is written to the temp directory. &lt;/p&gt;

&lt;p&gt;Instead the code should be similar to this: &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; File createFileFromInputStream(InputStream inputStream, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; encoding) {
        ....
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; BufferedWriter writer = FileHelper.getBufferedWriter(file, encoding);
        &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; BufferedReader reader = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BufferedReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InputStreamReader(inputStream, encoding));
        ....
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;On the other hand you can skip the encoding completely when copying the InputStream. The encoding is used later when the FileResource is read. An alternative and more readable implementation in Java 7 would be:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;            tempFile = File.createTempFile(&lt;span class=&quot;code-quote&quot;&gt;&quot;metamodel&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;.csv&quot;&lt;/span&gt;);
            tempFile.deleteOnExit();
            Files.copy(resourceAsStream, tempFile.toPath(), StandardCopyOption.REPLACE_EXISTING);
            &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; tempfile;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12971527">METAMODEL-1086</key>
            <summary>Encoding not used with InputStreams in CsvDataContext</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="kaspersor">Kasper S&#248;rensen</assignee>
                                    <reporter username="samuelmumm">Samuel Mumm</reporter>
                        <labels>
                    </labels>
                <created>Fri, 20 May 2016 13:31:07 +0000</created>
                <updated>Thu, 9 Jun 2016 04:22:04 +0000</updated>
                            <resolved>Thu, 9 Jun 2016 04:22:04 +0000</resolved>
                                    <version>4.5.2</version>
                                    <fixVersion>5.0.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15293404" author="samuelmumm" created="Fri, 20 May 2016 13:54:20 +0000"  >&lt;p&gt;Just saw there is a github repro. Will try to provide a pull request there soon.&lt;/p&gt;</comment>
                            <comment id="15293418" author="githubbot" created="Fri, 20 May 2016 14:07:00 +0000"  >&lt;p&gt;GitHub user bmehner opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/104&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/104&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Fix for encoding error when using InputStreams&lt;/p&gt;

&lt;p&gt;    Fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/METAMODEL-1086&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/METAMODEL-1086&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/bmehner/metamodel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/bmehner/metamodel&lt;/a&gt; master&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/104.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/104.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #104&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 6219cfa6e6ac4bc4e9ce5ab5ceca7abcd3d3b778&lt;br/&gt;
Author: Bj&#246;rn Mehner &amp;lt;bjoern.mehner@3c-d.de&amp;gt;&lt;br/&gt;
Date:   2016-05-20T14:04:12Z&lt;/p&gt;

&lt;p&gt;    Fix for encoding error when using InputStreams&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15293420" author="samuelmumm" created="Fri, 20 May 2016 14:07:29 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://github.com/apache/metamodel/pull/104&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/104&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15321854" author="githubbot" created="Thu, 9 Jun 2016 04:21:09 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/metamodel/pull/104&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/metamodel/pull/104&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 23 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2y9zj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>