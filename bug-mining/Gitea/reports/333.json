{"url":"https://api.github.com/repos/go-gitea/gitea/issues/31330","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/31330/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/31330/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/31330/events","html_url":"https://github.com/go-gitea/gitea/issues/31330","id":2347682215,"node_id":"I_kwDOBFIx286L7smn","number":31330,"title":"Push to repository results in \"PANIC: runtime error: invalid memory address or nil pointer dereference\"","user":{"login":"gmaxwell447","id":6623106,"node_id":"MDQ6VXNlcjY2MjMxMDY=","avatar_url":"https://avatars.githubusercontent.com/u/6623106?v=4","gravatar_id":"","url":"https://api.github.com/users/gmaxwell447","html_url":"https://github.com/gmaxwell447","followers_url":"https://api.github.com/users/gmaxwell447/followers","following_url":"https://api.github.com/users/gmaxwell447/following{/other_user}","gists_url":"https://api.github.com/users/gmaxwell447/gists{/gist_id}","starred_url":"https://api.github.com/users/gmaxwell447/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/gmaxwell447/subscriptions","organizations_url":"https://api.github.com/users/gmaxwell447/orgs","repos_url":"https://api.github.com/users/gmaxwell447/repos","events_url":"https://api.github.com/users/gmaxwell447/events{/privacy}","received_events_url":"https://api.github.com/users/gmaxwell447/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""},{"id":3995080816,"node_id":"LA_kwDOBFIx287uIBhw","url":"https://api.github.com/repos/go-gitea/gitea/labels/issue/workaround","name":"issue/workaround","color":"006B75","default":false,"description":"it is or has a workaround"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/go-gitea/gitea/milestones/164","html_url":"https://github.com/go-gitea/gitea/milestone/164","labels_url":"https://api.github.com/repos/go-gitea/gitea/milestones/164/labels","id":11101386,"node_id":"MI_kwDOBFIx284AqWTK","number":164,"title":"1.22.1","description":"","creator":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":94,"state":"closed","created_at":"2024-05-27T04:35:15Z","updated_at":"2024-08-01T21:40:04Z","due_on":"2024-06-10T07:00:00Z","closed_at":"2024-07-05T23:08:32Z"},"comments":1,"created_at":"2024-06-12T02:48:25Z","updated_at":"2024-09-10T23:49:44Z","closed_at":"2024-06-12T10:22:02Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\r\n\r\nWe have been porting repositories from a legacy Gitlab instance, and have had no issues except for one particular repository. This repo could not be directly migrated by Gitea; the raw Gitlab repos (*.git) were dropped into the appropriate owner directory on Gitea and successfully adopted by Gitea using the [documented process](https://docs.gitea.com/help/faq#how-to-adopt-repositories-from-disk). Everything looks great and the repo can be successfully cloned over HTTP or SSH.\r\n\r\nHowever, any sort of push operation (commit, branch delete) results in a panic from an \"invalid memory address or nil pointer dereference.\"  The gist includes three different panic origins and their stack traces.\r\n\r\nThe repo in particular has a few large binary blobs, 17 branches, 630 commits, 235 tags, and occupies 58 MiB. I will note that the \".pack\" file under objects/pack occupies 79553430 bytes. We're willing to prune out old commits and branches, but would have to do that off Gitea since push is currently broken, if that is our only option.\r\n\r\nI would attempt to reproduce it on the Gitea demo site but the repo contains proprietary IP.\r\n\r\nThank you!\r\n\r\n### Gitea Version\r\n\r\n1.22.0+41-g3fcf865a4b\r\n\r\n### Can you reproduce the bug on the Gitea demo site?\r\n\r\nNo\r\n\r\n### Log Gist\r\n\r\nhttps://gist.github.com/gmaxwell447/b45ee124ad25e04bdc39619a254d6247\r\n\r\n### Screenshots\r\n\r\n_No response_\r\n\r\n### Git Version\r\n\r\n2.39.3\r\n\r\n### Operating System\r\n\r\nRocky Release 9.3 with SELinux enabled, Red Hat Server Level 1 Security Profile\r\n\r\n### How are you running Gitea?\r\n\r\nI have tried the downloaded 1.22.0 binary (gitea_1.22.0_dev-1092-g02d4a62e3) along with the nightly build (1.22.0+41-g3fcf865a4b). Gitea is running on a Hyper-V hosted VM (no container), launched as a systemd service (service file included in gist).\r\n\r\n### Database\r\n\r\nMySQL/MariaDB","closed_by":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/31330/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/31330/timeline","performed_via_github_app":null,"state_reason":"completed"}