{"url":"https://api.github.com/repos/go-gitea/gitea/issues/33407","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/33407/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/33407/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/33407/events","html_url":"https://github.com/go-gitea/gitea/issues/33407","id":2811781210,"node_id":"I_kwDOBFIx286nmGBa","number":33407,"title":"WeakRef usage (not always supported and not recommended)","user":{"login":"wolfbeast","id":3359132,"node_id":"MDQ6VXNlcjMzNTkxMzI=","avatar_url":"https://avatars.githubusercontent.com/u/3359132?v=4","gravatar_id":"","url":"https://api.github.com/users/wolfbeast","html_url":"https://github.com/wolfbeast","followers_url":"https://api.github.com/users/wolfbeast/followers","following_url":"https://api.github.com/users/wolfbeast/following{/other_user}","gists_url":"https://api.github.com/users/wolfbeast/gists{/gist_id}","starred_url":"https://api.github.com/users/wolfbeast/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wolfbeast/subscriptions","organizations_url":"https://api.github.com/users/wolfbeast/orgs","repos_url":"https://api.github.com/users/wolfbeast/repos","events_url":"https://api.github.com/users/wolfbeast/events{/privacy}","received_events_url":"https://api.github.com/users/wolfbeast/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""},{"id":474799001,"node_id":"MDU6TGFiZWw0NzQ3OTkwMDE=","url":"https://api.github.com/repos/go-gitea/gitea/labels/topic/ui","name":"topic/ui","color":"fef2c0","default":false,"description":"Change the appearance of the Gitea UI"},{"id":474800073,"node_id":"MDU6TGFiZWw0NzQ4MDAwNzM=","url":"https://api.github.com/repos/go-gitea/gitea/labels/issue/needs-feedback","name":"issue/needs-feedback","color":"1d76db","default":false,"description":"For bugs, we need more details. For features, the feature must be described in more detail"},{"id":1939212317,"node_id":"MDU6TGFiZWwxOTM5MjEyMzE3","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/upstream","name":"type/upstream","color":"f9595c","default":false,"description":"This is an issue in one of Gitea's dependencies and should be reported there"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":29,"created_at":"2025-01-26T20:50:01Z","updated_at":"2025-06-24T16:15:06Z","closed_at":"2025-03-26T15:56:28Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\n\n> JavaScript promise rejection: WeakRef is not defined. Open browser console to see more details.\n\nI noticed Gitea's web interface started using `WeakRef` (noticed when posting a reply to a PR review conversation).\nPlease note that UXP doesn't implement `WeakRef` and its usage is not recommended unless you explicitly want to give hints to the JS GC for the release of (overly large) memory. Even so there is no guarantee that a JS engine will honour those hints, as they have often very complex internal machinery to deal with garbage collection. Letting content interfere with this process is not desirable; UXP doesn't intend to implement this as a result (potential can of worms also for security considerations as it might open UAFs and the like).\n\nPlease consider removing `WeakRef` usage from Gitea's web interface. There should not be a reason for using it to begin with. Let the engine do its own housekeeping. There is currently the risk of JS scripting breaking if it runs into `WeakRef` being undefined errors.\n\n### Screenshots\n\nI didn't think of capturing the error box\n\n### Gitea Version\n\n1.23.1\n\n### Can you reproduce the bug on the Gitea demo site?\n\nYes\n\n### Operating System\n\nWindows 10 22H2\n\n### Browser Version\n\nPale Moon 33.5.1","closed_by":{"login":"wxiaoguang","id":2114189,"node_id":"MDQ6VXNlcjIxMTQxODk=","avatar_url":"https://avatars.githubusercontent.com/u/2114189?v=4","gravatar_id":"","url":"https://api.github.com/users/wxiaoguang","html_url":"https://github.com/wxiaoguang","followers_url":"https://api.github.com/users/wxiaoguang/followers","following_url":"https://api.github.com/users/wxiaoguang/following{/other_user}","gists_url":"https://api.github.com/users/wxiaoguang/gists{/gist_id}","starred_url":"https://api.github.com/users/wxiaoguang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wxiaoguang/subscriptions","organizations_url":"https://api.github.com/users/wxiaoguang/orgs","repos_url":"https://api.github.com/users/wxiaoguang/repos","events_url":"https://api.github.com/users/wxiaoguang/events{/privacy}","received_events_url":"https://api.github.com/users/wxiaoguang/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/33407/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/33407/timeline","performed_via_github_app":null,"state_reason":"completed"}