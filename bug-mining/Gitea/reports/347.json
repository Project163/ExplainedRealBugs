{"url":"https://api.github.com/repos/go-gitea/gitea/issues/31675","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/31675/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/31675/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/31675/events","html_url":"https://github.com/go-gitea/gitea/issues/31675","id":2424535738,"node_id":"I_kwDOBFIx286Qg3q6","number":31675,"title":"All pages show error `JavaScript promise rejection: Cannot set properties of null (setting 'textContent').`","user":{"login":"wolfogre","id":9418365,"node_id":"MDQ6VXNlcjk0MTgzNjU=","avatar_url":"https://avatars.githubusercontent.com/u/9418365?v=4","gravatar_id":"","url":"https://api.github.com/users/wolfogre","html_url":"https://github.com/wolfogre","followers_url":"https://api.github.com/users/wolfogre/followers","following_url":"https://api.github.com/users/wolfogre/following{/other_user}","gists_url":"https://api.github.com/users/wolfogre/gists{/gist_id}","starred_url":"https://api.github.com/users/wolfogre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wolfogre/subscriptions","organizations_url":"https://api.github.com/users/wolfogre/orgs","repos_url":"https://api.github.com/users/wolfogre/repos","events_url":"https://api.github.com/users/wolfogre/events{/privacy}","received_events_url":"https://api.github.com/users/wolfogre/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""},{"id":474799001,"node_id":"MDU6TGFiZWw0NzQ3OTkwMDE=","url":"https://api.github.com/repos/go-gitea/gitea/labels/topic/ui","name":"topic/ui","color":"fef2c0","default":false,"description":"Change the appearance of the Gitea UI"},{"id":608693925,"node_id":"MDU6TGFiZWw2MDg2OTM5MjU=","url":"https://api.github.com/repos/go-gitea/gitea/labels/issue/regression","name":"issue/regression","color":"c92f0b","default":false,"description":"Indicates a previously functioning feature or behavior that has broken or regressed after a change"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2024-07-23T08:01:36Z","updated_at":"2024-10-25T09:54:59Z","closed_at":"2024-07-25T23:26:43Z","author_association":"MEMBER","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\r\n\r\n<img width=\"1952\" alt=\"image\" src=\"https://github.com/user-attachments/assets/9c2f98a8-77a4-4ae8-bd06-5c0bbf4ae2ee\">\r\n\r\n## How to reproduce\r\n\r\n1. Start Gitea **WITHOUT** a [Secure contexts](https://developer.mozilla.org/en-US/docs/Web/Security/Secure_Contexts), like `http://192.168.85.1:3000/`\r\n   - No `https`.\r\n   - No `127.0.0.1`, `localhost`, `*.localhost` \r\n2. Visit the sign-in page, and you will see a right warning about WebAuthn:\r\n<img width=\"545\" alt=\"image\" src=\"https://github.com/user-attachments/assets/06f29103-b167-4066-8b86-581f44cb0b3b\">\r\n\r\n3. And visit any other pages (even the home page), you will see:\r\n<img width=\"1512\" alt=\"image\" src=\"https://github.com/user-attachments/assets/1d9f8a4b-f7d7-4ca1-a94e-14d6f0ac22f8\">\r\n<img width=\"1134\" alt=\"image\" src=\"https://github.com/user-attachments/assets/7f072b1e-5cf8-431a-9175-bbcf8d3f1465\">\r\n\r\n## Possible causes\r\n\r\nIt seems introduced by\r\n- #31504\r\n\r\n1. After `#31504`, every page will run `detectWebAuthnSupport`\r\n<img width=\"1555\" alt=\"image\" src=\"https://github.com/user-attachments/assets/893ad659-d409-436f-afb4-87a73d8f598b\">\r\n\r\n2. And it emits error `insecure`\r\n<img width=\"267\" alt=\"image\" src=\"https://github.com/user-attachments/assets/5224a7c8-d02b-4b0c-8fb1-4ba4d999dffc\">\r\n\r\n3. But it's not sign-in page, it cannot get `#webauthn-error-msg`, so it shows a strange error.\r\n<img width=\"753\" alt=\"image\" src=\"https://github.com/user-attachments/assets/9eafb4ca-8681-4926-9904-b92de0efbbf6\">\r\n\r\n\r\n\r\n\r\n\r\n### Gitea Version\r\n\r\nmain (ad91a59c18)\r\n\r\n### Can you reproduce the bug on the Gitea demo site?\r\n\r\nNo\r\n\r\n### Log Gist\r\n\r\n_No response_\r\n\r\n### Screenshots\r\n\r\n_No response_\r\n\r\n### Git Version\r\n\r\n_No response_\r\n\r\n### Operating System\r\n\r\n_No response_\r\n\r\n### How are you running Gitea?\r\n\r\nCommand line.\r\n\r\n### Database\r\n\r\nNone","closed_by":{"login":"lafriks","id":165205,"node_id":"MDQ6VXNlcjE2NTIwNQ==","avatar_url":"https://avatars.githubusercontent.com/u/165205?v=4","gravatar_id":"","url":"https://api.github.com/users/lafriks","html_url":"https://github.com/lafriks","followers_url":"https://api.github.com/users/lafriks/followers","following_url":"https://api.github.com/users/lafriks/following{/other_user}","gists_url":"https://api.github.com/users/lafriks/gists{/gist_id}","starred_url":"https://api.github.com/users/lafriks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lafriks/subscriptions","organizations_url":"https://api.github.com/users/lafriks/orgs","repos_url":"https://api.github.com/users/lafriks/repos","events_url":"https://api.github.com/users/lafriks/events{/privacy}","received_events_url":"https://api.github.com/users/lafriks/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/31675/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/31675/timeline","performed_via_github_app":null,"state_reason":"completed"}