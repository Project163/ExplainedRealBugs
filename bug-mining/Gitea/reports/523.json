{"url":"https://api.github.com/repos/go-gitea/gitea/issues/33353","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/33353/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/33353/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/33353/events","html_url":"https://github.com/go-gitea/gitea/issues/33353","id":2803977921,"node_id":"I_kwDOBFIx286nIU7B","number":33353,"title":"Gitea rerurns 404 when trying to download artifact via Gitea actions","user":{"login":"this-username-has-been-taken","id":119663930,"node_id":"U_kgDOByHtOg","avatar_url":"https://avatars.githubusercontent.com/u/119663930?v=4","gravatar_id":"","url":"https://api.github.com/users/this-username-has-been-taken","html_url":"https://github.com/this-username-has-been-taken","followers_url":"https://api.github.com/users/this-username-has-been-taken/followers","following_url":"https://api.github.com/users/this-username-has-been-taken/following{/other_user}","gists_url":"https://api.github.com/users/this-username-has-been-taken/gists{/gist_id}","starred_url":"https://api.github.com/users/this-username-has-been-taken/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/this-username-has-been-taken/subscriptions","organizations_url":"https://api.github.com/users/this-username-has-been-taken/orgs","repos_url":"https://api.github.com/users/this-username-has-been-taken/repos","events_url":"https://api.github.com/users/this-username-has-been-taken/events{/privacy}","received_events_url":"https://api.github.com/users/this-username-has-been-taken/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""},{"id":4808833534,"node_id":"LA_kwDOBFIx288AAAABHqD5_g","url":"https://api.github.com/repos/go-gitea/gitea/labels/topic/gitea-actions","name":"topic/gitea-actions","color":"007ED2","default":false,"description":"related to the actions of Gitea"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2025-01-22T10:19:43Z","updated_at":"2025-05-17T16:58:29Z","closed_at":"2025-02-16T00:32:55Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\n\nHello!\n\nI was trying to download an artifact that was published in a different workflow and faced with a 404 error returned by Gitea.\n\nLet's assume that we have 2 workflows:\n\n`workflow1.yml` - generates and publishes an artifact under `build_details_{run_id}` name\n```\nname: Generate and publish artifacts\non:\n  workflow_dispatch:\njobs:\n  generate_publish:\n    runs-on: ubuntu-latest\n    permissions:\n      actions: read\n      contents: write\n    steps:\n      - name: Generate artifacts\n        shell: bash\n        run: |\n          mkdir output\n          echo \"TEST_VAR=123\" | tee -a output/build_details.txt\n      - name: Publish artifacts\n        uses: christopherhx/gitea-upload-artifact@v4\n        with:\n          name: build_details_${{ github.run_id }}\n          path: ${{ github.workspace }}/output/*\n          retention-days: 7\n```\n\n`workflow2.yml` - downloads artifact published by `workflow2.yml`\n```\nname: Download artifact\non:\n  workflow_dispatch:\n    inputs:\n      build-id:\n        type: string\n        description: Run ID\n        required: true\njobs:\n  download_artifact:\n    runs-on: linux_amd64\n    permissions: read-all\n    steps:\n      - name: Download artifact\n        uses: christopherhx/gitea-download-artifact@v4\n        with:\n          name: build_details_${{ inputs.build-id }}\n          github-token: ${{ github.token }}\n          run-id: ${{ inputs.build-id }}\n          path: input\n```\n\nNow let's assume that workflow 1 has been successfully completed: it recieved `run id = 22` and it published an artifact named `build_details_22`.\nIf I run workflow 2 and pass `22` as `build-id` parameter I will get the following error: `::error::Unable to download artifact(s): 404 page not found%0A`\n\nIf I replace `Download artifact` step in workflow 2 with an alternative action:\n```\n      - name: Download artifact\n        uses: dawidd6/action-download-artifact@v7\n        with:\n          github_token: ${{ github.token }}\n          run_number: ${{ inputs.build-id }}\n          name: build_details_${{ inputs.build-id }}\n          workflow: workflow1.yml\n```\nI will get the same error: `::error::404 page not found%0A`\n\nTaking into account the same error messages (followed by `%0A`) I think that there is a bug exist in some of the Gitea endpoint(s).\nI appreciate any advice how to fix the issue\n\n### Gitea Version\n\n1.23.1\n\n### Can you reproduce the bug on the Gitea demo site?\n\nNo: there are no runners available on the demo site\n\n### Log Gist\n\n_No response_\n\n### Screenshots\n\n_No response_\n\n### Git Version\n\n_No response_\n\n### Operating System\n\nDebian 12\n\n### How are you running Gitea?\n\nGitea is running in the Docker container.\nGitea act runner is installed directly on the server.\n\n### Database\n\nPostgreSQL","closed_by":{"login":"wxiaoguang","id":2114189,"node_id":"MDQ6VXNlcjIxMTQxODk=","avatar_url":"https://avatars.githubusercontent.com/u/2114189?v=4","gravatar_id":"","url":"https://api.github.com/users/wxiaoguang","html_url":"https://github.com/wxiaoguang","followers_url":"https://api.github.com/users/wxiaoguang/followers","following_url":"https://api.github.com/users/wxiaoguang/following{/other_user}","gists_url":"https://api.github.com/users/wxiaoguang/gists{/gist_id}","starred_url":"https://api.github.com/users/wxiaoguang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wxiaoguang/subscriptions","organizations_url":"https://api.github.com/users/wxiaoguang/orgs","repos_url":"https://api.github.com/users/wxiaoguang/repos","events_url":"https://api.github.com/users/wxiaoguang/events{/privacy}","received_events_url":"https://api.github.com/users/wxiaoguang/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/33353/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/33353/timeline","performed_via_github_app":null,"state_reason":"completed"}