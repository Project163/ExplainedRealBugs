{"url":"https://api.github.com/repos/go-gitea/gitea/issues/30992","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/30992/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/30992/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/30992/events","html_url":"https://github.com/go-gitea/gitea/issues/30992","id":2299210215,"node_id":"I_kwDOBFIx286JCynn","number":30992,"title":"Data race during testing","user":{"login":"wxiaoguang","id":2114189,"node_id":"MDQ6VXNlcjIxMTQxODk=","avatar_url":"https://avatars.githubusercontent.com/u/2114189?v=4","gravatar_id":"","url":"https://api.github.com/users/wxiaoguang","html_url":"https://github.com/wxiaoguang","followers_url":"https://api.github.com/users/wxiaoguang/followers","following_url":"https://api.github.com/users/wxiaoguang/following{/other_user}","gists_url":"https://api.github.com/users/wxiaoguang/gists{/gist_id}","starred_url":"https://api.github.com/users/wxiaoguang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wxiaoguang/subscriptions","organizations_url":"https://api.github.com/users/wxiaoguang/orgs","repos_url":"https://api.github.com/users/wxiaoguang/repos","events_url":"https://api.github.com/users/wxiaoguang/events{/privacy}","received_events_url":"https://api.github.com/users/wxiaoguang/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":476411733,"node_id":"MDU6TGFiZWw0NzY0MTE3MzM=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/testing","name":"type/testing","color":"d4c5f9","default":false,"description":""}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2024-05-16T02:37:49Z","updated_at":"2024-08-19T00:28:55Z","closed_at":"2024-05-20T04:35:39Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"```\r\n=== TestOrgProjectAccess (tests/integration/org_project_test.go:17)\r\n==================\r\nWARNING: DATA RACE\r\nRead at 0x000008956640 by goroutine 272626:\r\n  code.gitea.io/gitea/models/unit.Type.UnitGlobalDisabled()\r\n      /home/runner/work/gitea/gitea/models/unit/unit.go:170 +0x257\r\n  code.gitea.io/gitea/models/repo.getUnitsByRepoID()\r\n      /home/runner/work/gitea/gitea/models/repo/repo_unit.go:331 +0x230\r\n  code.gitea.io/gitea/models/repo.(*Repository).LoadUnits()\r\n      /home/runner/work/gitea/gitea/models/repo/repo.go:361 +0xa7\r\n  code.gitea.io/gitea/models/repo.(*Repository).GetUnit()\r\n      /home/runner/work/gitea/gitea/models/repo/repo.go:435 +0x46\r\n  code.gitea.io/gitea/models/repo.(*Repository).IsTimetrackerEnabled()\r\n      /home/runner/work/gitea/gitea/models/repo/issue.go:35 +0x5e\r\n  code.gitea.io/gitea/models/issues.(*Issue).IsTimetrackerEnabled()\r\n      /home/runner/work/gitea/gitea/models/issues/issue.go:193 +0x117\r\n  code.gitea.io/gitea/models/issues.(*Issue).LoadAttributes()\r\n      /home/runner/work/gitea/gitea/models/issues/issue.go:341 +0x325\r\n  code.gitea.io/gitea/modules/indexer/issues.getIssueIndexerData()\r\n      /home/runner/work/gitea/gitea/modules/indexer/issues/util.go:44 +0x3b1\r\n  code.gitea.io/gitea/modules/indexer/issues.InitIssueIndexer.getIssueIndexerQueueHandler.func4()\r\n      /home/runner/work/gitea/gitea/modules/indexer/issues/indexer.go:178 +0x4d5\r\n  code.gitea.io/gitea/modules/queue.NewWorkerPoolQueueWithContext[go.shape.*uint8].func1()\r\n      /home/runner/work/gitea/gitea/modules/queue/workerqueue.go:246 +0x174\r\n  code.gitea.io/gitea/modules/queue.(*WorkerPoolQueue[go.shape.*uint8]).doWorkerHandle()\r\n      /home/runner/work/gitea/gitea/modules/queue/workergroup.go:103 +0x1a7\r\n  code.gitea.io/gitea/modules/queue.(*WorkerPoolQueue[go.shape.*uint8]).doStartNewWorker.func1()\r\n      /home/runner/work/gitea/gitea/modules/queue/workergroup.go:178 +0x593\r\n\r\nPrevious write at 0x000008956640 by goroutine 271665:\r\n  code.gitea.io/gitea/tests/integration.TestOrgProjectAccess.MockVariableValue[go.shape.[]code.gitea.io/gitea/models/unit.Type].func1()\r\n      /home/runner/work/gitea/gitea/modules/test/utils.go:40 +0x50\r\n  runtime.deferreturn()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/runtime/panic.go:602 +0x5d\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:285 +0x3bb\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:280 +0x5e9\r\n  text/template.(*Template).execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:224 +0x44d\r\n  text/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:207 +0x98\r\n  html/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/html/template/template.go:124 +0x64\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.escapeTemplate()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:99 +0x44\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:183 +0x38f\r\n  text/template.(*state).evalPipeline()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:479 +0x1fe\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:267 +0x417\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:280 +0x5e9\r\n  text/template.(*Template).execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:224 +0x44d\r\n  text/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:207 +0x98\r\n  html/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/html/template/template.go:124 +0x64\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.escapeTemplate()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:99 +0x44\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:183 +0x38f\r\n  text/template.(*state).evalPipeline()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:479 +0x1fe\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:267 +0x417\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:280 +0x5e9\r\n  text/template.(*state).walkIfOrWith()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:313 +0x2dc\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:277 +0x2c4\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:280 +0x5e9\r\n  text/template.(*Template).execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:224 +0x44d\r\n  text/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:207 +0x98\r\n  html/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/html/template/template.go:124 +0x64\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.escapeTemplate()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:99 +0x44\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:183 +0x38f\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:195 +0x65e\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:187 +0x43e\r\n  text/template.(*state).evalCommand()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:507 +0x4bc\r\n  text/template.(*state).evalPipeline()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:479 +0x1fe\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:267 +0x417\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:280 +0x5e9\r\n  text/template.(*Template).execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:224 +0x44d\r\n  text/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:207 +0x98\r\n  html/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/html/template/template.go:124 +0x64\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.escapeTemplate()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:99 +0x44\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:183 +0x38f\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:195 +0x65e\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:267 +0x417\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:280 +0x5e9\r\n  text/template.(*Template).execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:224 +0x44d\r\n  text/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:207 +0x98\r\n  html/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/html/template/template.go:124 +0x64\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.escapeTemplate()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:99 +0x44\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:183 +0x38f\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:195 +0x65e\r\n  text/template.(*state).evalCommand()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:507 +0x4bc\r\n  text/template.(*state).evalPipeline()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:479 +0x1fe\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:267 +0x417\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:280 +0x5e9\r\n  text/template.(*Template).execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:224 +0x44d\r\n  text/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:207 +0x98\r\n  html/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/html/template/template.go:124 +0x64\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.escapeTemplate()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:99 +0x44\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:183 +0x38f\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:187 +0x43e\r\n  text/template.(*state).evalCommand()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:507 +0x4bc\r\n  text/template.(*state).evalPipeline()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:479 +0x1fe\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:267 +0x417\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:280 +0x5e9\r\n  text/template.(*Template).execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:224 +0x44d\r\n  text/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:207 +0x98\r\n  html/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/html/template/template.go:124 +0x64\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.escapeTemplate()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:99 +0x44\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet.func1()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:183 +0x38f\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:215 +0x828\r\n  text/template.(*state).evalCommand()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:507 +0x4bc\r\n  text/template.(*state).evalPipeline()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:479 +0x1fe\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:267 +0x417\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:280 +0x5e9\r\n  text/template.(*state).walkTemplate()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:461 +0x456\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:285 +0x3bb\r\n  text/template.(*state).walk()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:280 +0x5e9\r\n  text/template.(*Template).execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:224 +0x44d\r\n  text/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/text/template/exec.go:207 +0x98\r\n  html/template.(*Template).Execute()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/html/template/template.go:124 +0x64\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.escapeTemplate()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:99 +0x44\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.newScopedTemplateSet()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:146 +0x77\r\n  code.gitea.io/gitea/modules/templates/scopedtmpl.(*ScopedTemplate).Executor()\r\n      /home/runner/work/gitea/gitea/modules/templates/scopedtmpl/scopedtmpl.go:74 +0x184\r\n  code.gitea.io/gitea/modules/templates.(*HTMLRender).TemplateLookup()\r\n      /home/runner/work/gitea/gitea/modules/templates/htmlrenderer.go:64 +0x15a\r\n  code.gitea.io/gitea/modules/templates.(*HTMLRender).HTML()\r\n      /home/runner/work/gitea/gitea/modules/templates/htmlrenderer.go:50 +0x1e8\r\n  code.gitea.io/gitea/services/context.(*Context).HTML()\r\n      /home/runner/work/gitea/gitea/services/context/context_response.go:80 +0x438\r\n  code.gitea.io/gitea/routers/web/org.Projects()\r\n      /home/runner/work/gitea/gitea/routers/web/org/projects.go:129 +0x11b9\r\n  runtime.call16()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/runtime/asm_amd64.s:770 +0x42\r\n  reflect.Value.Call()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/reflect/value.go:380 +0xb5\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:172 +0x256\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  net/http.Handler.ServeHTTP-fm()\r\n      <autogenerated>:1 +0x67\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.(*Route).wrapMiddlewareAndHandler.RouteMockPoint.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/routemock.go:34 +0xdd\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:182 +0x2de\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:182 +0x2de\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:182 +0x2de\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:182 +0x2de\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:182 +0x2de\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:182 +0x2de\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  github.com/go-chi/chi/v5.(*ChainHandler).ServeHTTP()\r\n      /home/runner/go/pkg/mod/github.com/go-chi/chi/v5@v5.0.12/chain.go:31 +0x63\r\n  github.com/go-chi/chi/v5.(*Mux).routeHTTP()\r\n      /home/runner/go/pkg/mod/github.com/go-chi/chi/v5@v5.0.12/mux.go:459 +0x594\r\n  github.com/go-chi/chi/v5.(*Mux).routeHTTP-fm()\r\n      <autogenerated>:1 +0x51\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:182 +0x2de\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:182 +0x2de\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:182 +0x2de\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  github.com/go-chi/chi/v5/middleware.GetHead.func1()\r\n      /home/runner/go/pkg/mod/github.com/go-chi/chi/v5@v5.0.12/middleware/get_head.go:37 +0x3b7\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  net/http.Handler.ServeHTTP()\r\n      <autogenerated>:1 +0x61\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.wrapHandlerProvider[go.shape.interface { ServeHTTP(net/http.ResponseWriter, *net/http.Request) }].func2.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:136 +0x8b\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.func1.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:182 +0x2de\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/services/context.Contexter.func1.1()\r\n      /home/runner/work/gitea/gitea/services/context/context.go:225 +0x251a\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  net/http.Handler.ServeHTTP()\r\n      <autogenerated>:1 +0x61\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.wrapHandlerProvider[go.shape.interface { ServeHTTP(net/http.ResponseWriter, *net/http.Request) }].func2.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:136 +0x8b\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  gitea.com/go-chi/session.Sessioner.func1.1()\r\n      /home/runner/go/pkg/mod/gitea.com/go-chi/session@v0.0.0-20240316035857-16768d98ec96/session.go:257 +0x287\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  net/http.Handler.ServeHTTP()\r\n      <autogenerated>:1 +0x61\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.wrapHandlerProvider[go.shape.interface { ServeHTTP(net/http.ResponseWriter, *net/http.Request) }].func2.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:136 +0x8b\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  github.com/klauspost/compress/gzhttp.NewWrapper.func1.1()\r\n      /home/runner/go/pkg/mod/github.com/klauspost/compress@v1.17.8/gzhttp/compress.go:501 +0x6e1\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.wrapHandlerProvider[go.shape.func(net/http.ResponseWriter, *net/http.Request)].func3.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:136 +0x79\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  github.com/go-chi/chi/v5.(*Mux).ServeHTTP()\r\n      /home/runner/go/pkg/mod/github.com/go-chi/chi/v5@v5.0.12/mux.go:73 +0x716\r\n  github.com/go-chi/chi/v5.(*Mux).Mount.func1()\r\n      /home/runner/go/pkg/mod/github.com/go-chi/chi/v5@v5.0.12/mux.go:327 +0x4e5\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  github.com/go-chi/chi/v5.(*Mux).routeHTTP()\r\n      /home/runner/go/pkg/mod/github.com/go-chi/chi/v5@v5.0.12/mux.go:459 +0x594\r\n  github.com/go-chi/chi/v5.(*Mux).routeHTTP-fm()\r\n      <autogenerated>:1 +0x51\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  github.com/go-chi/chi/v5.(*Mux).ServeHTTP()\r\n      /home/runner/go/pkg/mod/github.com/go-chi/chi/v5@v5.0.12/mux.go:73 +0x716\r\n  github.com/go-chi/chi/v5.(*Mux).Mount.func1()\r\n      /home/runner/go/pkg/mod/github.com/go-chi/chi/v5@v5.0.12/mux.go:327 +0x4e5\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  github.com/go-chi/chi/v5.(*Mux).routeHTTP()\r\n      /home/runner/go/pkg/mod/github.com/go-chi/chi/v5@v5.0.12/mux.go:459 +0x594\r\n  github.com/go-chi/chi/v5.(*Mux).routeHTTP-fm()\r\n      <autogenerated>:1 +0x51\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/modules/web/routing.(*requestRecordsManager).handler-fm.(*requestRecordsManager).handler.func1()\r\n      /home/runner/work/gitea/gitea/modules/web/routing/logger_manager.go:122 +0x431\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  net/http.Handler.ServeHTTP()\r\n      <autogenerated>:1 +0x61\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.wrapHandlerProvider[go.shape.interface { ServeHTTP(net/http.ResponseWriter, *net/http.Request) }].func2.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:136 +0x8b\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/routers/common.ProtocolMiddlewares.ForwardedHeaders.func3.1()\r\n      /home/runner/go/pkg/mod/github.com/chi-middleware/proxy@v1.1.1/middleware.go:37 +0x178\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  net/http.Handler.ServeHTTP()\r\n      <autogenerated>:1 +0x61\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.wrapHandlerProvider[go.shape.interface { ServeHTTP(net/http.ResponseWriter, *net/http.Request) }].func2.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:136 +0x8b\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/routers/common.ProtocolMiddlewares.func2.1()\r\n      /home/runner/work/gitea/gitea/routers/common/middleware.go:49 +0x4ba\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  net/http.Handler.ServeHTTP()\r\n      <autogenerated>:1 +0x61\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.wrapHandlerProvider[go.shape.interface { ServeHTTP(net/http.ResponseWriter, *net/http.Request) }].func2.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:136 +0x8b\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/routers/common.ProtocolMiddlewares.func1.1()\r\n      /home/runner/work/gitea/gitea/routers/common/middleware.go:40 +0x47d\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  net/http.Handler.ServeHTTP()\r\n      <autogenerated>:1 +0x61\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.wrapHandlerProvider[go.shape.interface { ServeHTTP(net/http.ResponseWriter, *net/http.Request) }].func2.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:136 +0x8b\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  code.gitea.io/gitea/routers/common.stripSlashesMiddleware.func1()\r\n      /home/runner/work/gitea/gitea/routers/common/middleware.go:103 +0x4d8\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  net/http.Handler.ServeHTTP()\r\n      <autogenerated>:1 +0x61\r\n  code.gitea.io/gitea/modules/web.toHandlerProvider.wrapHandlerProvider[go.shape.interface { ServeHTTP(net/http.ResponseWriter, *net/http.Request) }].func2.1()\r\n      /home/runner/work/gitea/gitea/modules/web/handler.go:136 +0x8b\r\n  net/http.HandlerFunc.ServeHTTP()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/net/http/server.go:2166 +0x47\r\n  github.com/go-chi/chi/v5.(*Mux).ServeHTTP()\r\n      /home/runner/go/pkg/mod/github.com/go-chi/chi/v5@v5.0.12/mux.go:90 +0x69e\r\n  code.gitea.io/gitea/modules/web.(*Route).ServeHTTP()\r\n      /home/runner/work/gitea/gitea/modules/web/route.go:163 +0x242\r\n  code.gitea.io/gitea/tests/integration.MakeRequest()\r\n      /home/runner/work/gitea/gitea/tests/integration/integration_test.go:400 +0x1fb\r\n  code.gitea.io/gitea/tests/integration.TestOrgProjectAccess()\r\n      /home/runner/work/gitea/gitea/tests/integration/org_project_test.go:26 +0x344\r\n  testing.tRunner()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/testing/testing.go:1689 +0x21e\r\n  testing.(*T).Run.gowrap1()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/testing/testing.go:1742 +0x44\r\n\r\nGoroutine 272626 (running) created at:\r\n  code.gitea.io/gitea/modules/queue.(*WorkerPoolQueue[go.shape.*uint8]).doStartNewWorker()\r\n      /home/runner/work/gitea/gitea/modules/queue/workergroup.go:153 +0x12b\r\n  code.gitea.io/gitea/modules/queue.(*WorkerPoolQueue[go.shape.*uint8]).doDispatchBatchToWorker()\r\n      /home/runner/work/gitea/gitea/modules/queue/workergroup.go:73 +0x291\r\n  code.gitea.io/gitea/modules/queue.(*WorkerPoolQueue[go.shape.*uint8]).doRun()\r\n      /home/runner/work/gitea/gitea/modules/queue/workergroup.go:336 +0xc33\r\n  code.gitea.io/gitea/modules/queue.(*WorkerPoolQueue[go.shape.*uint8]).Run()\r\n      /home/runner/work/gitea/gitea/modules/queue/workerqueue.go:180 +0x44\r\n  code.gitea.io/gitea/modules/queue.(*WorkerPoolQueue[*code.gitea.io/gitea/modules/indexer/issues.IndexerMetadata]).Run()\r\n      /home/runner/work/gitea/gitea/modules/queue/workerqueue.go:179 +0x17\r\n  code.gitea.io/gitea/modules/graceful.(*Manager).RunWithCancel()\r\n      /home/runner/work/gitea/gitea/modules/graceful/manager.go:75 +0x1e6\r\n  code.gitea.io/gitea/modules/indexer/issues.InitIssueIndexer.func1.gowrap1()\r\n      /home/runner/work/gitea/gitea/modules/indexer/issues/indexer.go:124 +0x4f\r\n\r\nGoroutine 271665 (running) created at:\r\n  testing.(*T).Run()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/testing/testing.go:1742 +0x825\r\n  testing.runTests.func1()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/testing/testing.go:2161 +0x85\r\n  testing.tRunner()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/testing/testing.go:1689 +0x21e\r\n  testing.runTests()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/testing/testing.go:2159 +0x8be\r\n  testing.(*M).Run()\r\n      /opt/hostedtoolcache/go/1.22.3/x64/src/testing/testing.go:2027 +0xf17\r\n  code.gitea.io/gitea/tests/integration.TestMain()\r\n      /home/runner/work/gitea/gitea/tests/integration/integration_test.go:132 +0x671\r\n  main.main()\r\n      _testmain.go:1183 +0x2d4\r\n==================\r\n--- FAIL: TestOrgProjectAccess (0.66s)\r\n```","closed_by":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/30992/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/30992/timeline","performed_via_github_app":null,"state_reason":"completed"}