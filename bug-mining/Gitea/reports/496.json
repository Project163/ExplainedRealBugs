{"url":"https://api.github.com/repos/go-gitea/gitea/issues/32769","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/32769/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/32769/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/32769/events","html_url":"https://github.com/go-gitea/gitea/issues/32769","id":2726164286,"node_id":"I_kwDOBFIx286iffc-","number":32769,"title":"New pull request notification will show wrong branch in a special case","user":{"login":"yp05327","id":18380374,"node_id":"MDQ6VXNlcjE4MzgwMzc0","avatar_url":"https://avatars.githubusercontent.com/u/18380374?v=4","gravatar_id":"","url":"https://api.github.com/users/yp05327","html_url":"https://github.com/yp05327","followers_url":"https://api.github.com/users/yp05327/followers","following_url":"https://api.github.com/users/yp05327/following{/other_user}","gists_url":"https://api.github.com/users/yp05327/gists{/gist_id}","starred_url":"https://api.github.com/users/yp05327/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/yp05327/subscriptions","organizations_url":"https://api.github.com/users/yp05327/orgs","repos_url":"https://api.github.com/users/yp05327/repos","events_url":"https://api.github.com/users/yp05327/events{/privacy}","received_events_url":"https://api.github.com/users/yp05327/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""}],"state":"closed","locked":true,"assignee":{"login":"changchaishi","id":25934612,"node_id":"MDQ6VXNlcjI1OTM0NjEy","avatar_url":"https://avatars.githubusercontent.com/u/25934612?v=4","gravatar_id":"","url":"https://api.github.com/users/changchaishi","html_url":"https://github.com/changchaishi","followers_url":"https://api.github.com/users/changchaishi/followers","following_url":"https://api.github.com/users/changchaishi/following{/other_user}","gists_url":"https://api.github.com/users/changchaishi/gists{/gist_id}","starred_url":"https://api.github.com/users/changchaishi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/changchaishi/subscriptions","organizations_url":"https://api.github.com/users/changchaishi/orgs","repos_url":"https://api.github.com/users/changchaishi/repos","events_url":"https://api.github.com/users/changchaishi/events{/privacy}","received_events_url":"https://api.github.com/users/changchaishi/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"changchaishi","id":25934612,"node_id":"MDQ6VXNlcjI1OTM0NjEy","avatar_url":"https://avatars.githubusercontent.com/u/25934612?v=4","gravatar_id":"","url":"https://api.github.com/users/changchaishi","html_url":"https://github.com/changchaishi","followers_url":"https://api.github.com/users/changchaishi/followers","following_url":"https://api.github.com/users/changchaishi/following{/other_user}","gists_url":"https://api.github.com/users/changchaishi/gists{/gist_id}","starred_url":"https://api.github.com/users/changchaishi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/changchaishi/subscriptions","organizations_url":"https://api.github.com/users/changchaishi/orgs","repos_url":"https://api.github.com/users/changchaishi/repos","events_url":"https://api.github.com/users/changchaishi/events{/privacy}","received_events_url":"https://api.github.com/users/changchaishi/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":7,"created_at":"2024-12-09T06:52:40Z","updated_at":"2025-04-18T01:46:02Z","closed_at":"2025-01-17T19:37:19Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\n\nSorry, this is a bug come from my PR #25812\r\n\r\nReproduce:\r\n1. create a new repo A, create a file in it\r\n2. fork it to repo B\r\n3. push a commit (the most easy way is creating a new file in web) in repo A's main branch\r\n\r\nThen you will see:\r\nIn repo A, the branch in notification is repo B's main branch, actually the expected branch is repo A's main branch.\r\n![image](https://github.com/user-attachments/assets/4af2cf9d-e7a2-4ba5-959d-56c1aefdaea1)\r\nIn the fork (repo B), it show the repo A's main branch, actually the expected behavior is showing nothing.\r\n![image](https://github.com/user-attachments/assets/074c9d58-d438-42db-8ff9-81ccb9f7ee4b)\r\n\r\nReason:\r\nFor newly created empty branch (based on default branch), I want to ignore the notification, so I added this in the SQL query.\r\n![image](https://github.com/user-attachments/assets/1b4217b6-f107-4aa2-9709-bedf671c9977)\r\nAnd this cause this bug.\r\n\r\nIn repo A, it will ignore the newly pushed commit because of the condition I mentioned above, and the default branch's latest commit id is changed. So in repo B's main branch, the latest commit id is not same to the repo A's default branch's latest commit id, so it will be picked up as a recently updated branch.\r\n\r\nDon't have a good idea about how to fix it now. If someone is interested, it is welcome to create a PR for it.\n\n### Gitea Version\n\nlatest\n\n### Can you reproduce the bug on the Gitea demo site?\n\nNo\n\n### Log Gist\n\n_No response_\n\n### Screenshots\n\n_No response_\n\n### Git Version\n\n_No response_\n\n### Operating System\n\n_No response_\n\n### How are you running Gitea?\n\nbuild\n\n### Database\n\nNone","closed_by":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/32769/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/32769/timeline","performed_via_github_app":null,"state_reason":"completed"}