{"url":"https://api.github.com/repos/go-gitea/gitea/issues/28945","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/28945/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/28945/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/28945/events","html_url":"https://github.com/go-gitea/gitea/issues/28945","id":2102257921,"node_id":"I_kwDOBFIx2859TekB","number":28945,"title":"avatar_default.png broken on some pages","user":{"login":"JanRomero","id":7873027,"node_id":"MDQ6VXNlcjc4NzMwMjc=","avatar_url":"https://avatars.githubusercontent.com/u/7873027?v=4","gravatar_id":"","url":"https://api.github.com/users/JanRomero","html_url":"https://github.com/JanRomero","followers_url":"https://api.github.com/users/JanRomero/followers","following_url":"https://api.github.com/users/JanRomero/following{/other_user}","gists_url":"https://api.github.com/users/JanRomero/gists{/gist_id}","starred_url":"https://api.github.com/users/JanRomero/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/JanRomero/subscriptions","organizations_url":"https://api.github.com/users/JanRomero/orgs","repos_url":"https://api.github.com/users/JanRomero/repos","events_url":"https://api.github.com/users/JanRomero/events{/privacy}","received_events_url":"https://api.github.com/users/JanRomero/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/go-gitea/gitea/milestones/156","html_url":"https://github.com/go-gitea/gitea/milestone/156","labels_url":"https://api.github.com/repos/go-gitea/gitea/milestones/156/labels","id":10504095,"node_id":"MI_kwDOBFIx284AoEef","number":156,"title":"1.21.6","description":"","creator":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":73,"state":"closed","created_at":"2024-02-02T03:47:16Z","updated_at":"2024-02-22T22:42:49Z","due_on":"2024-02-19T08:00:00Z","closed_at":"2024-02-22T22:42:49Z"},"comments":8,"created_at":"2024-01-26T13:56:14Z","updated_at":"2024-03-04T00:01:25Z","closed_at":"2024-02-22T16:42:25Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\n\nNew users who have not uploaded a custom avatar are shown with a broken image in our installation. The HTML generated for the big image on the user profile looks like this, which is clearly wrong:\r\n\r\n![/avatars/%2Fassets%2Fimg%2Favatar_default.png?size=512](https://github.com/go-gitea/gitea/assets/7873027/8bb3e267-5ed1-4697-b151-00d13461862c)\r\nAs you can see, the path contains escaped forward slashes and is wrongly prefixed with “/avatars”.\r\n\r\nIn the install directory the image is set up under `/custom/public/assets/img/avatar_default.png`. I’m pretty sure that’s correct, because it is shown nicely on anonymous commits, where [the generated HTML](https://github.com/go-gitea/gitea/assets/7873027/e56cb83d-8333-4900-942a-1f2548101f53) looks as expected.\r\n\r\nOur config in app.ini looks like this. This is the entire section and it’s reflected in the admin panel. We don’t have any other avatar settings in the UI or in app.ini that I’m aware of.\r\n```\r\n[picture]\r\nDISABLE_GRAVATAR = true\r\nENABLE_FEDERATED_AVATAR = false\r\n```\r\n\r\nIf this is indeed a bug, I imagine it lives here, but I’m only browsing the source on github and don’t know what I’m doing: https://github.com/go-gitea/gitea/blob/534917d57670d82703567131e2b33fd945e6f8cb/models/avatars/avatar.go#L60\r\n\r\nThank you very much! Sorry if this is a misconfiguration on my end.\n\n### Screenshots\n\n![](https://github.com/go-gitea/gitea/assets/7873027/a37f534f-65f8-4852-846a-1290288bdda9)\r\n\n\n### Gitea Version\n\n1.21.4\n\n### Can you reproduce the bug on the Gitea demo site?\n\nNo\n\n### Operating System\n\nWindows\n\n### Browser Version\n\nAny","closed_by":{"login":"6543","id":24977596,"node_id":"MDQ6VXNlcjI0OTc3NTk2","avatar_url":"https://avatars.githubusercontent.com/u/24977596?v=4","gravatar_id":"","url":"https://api.github.com/users/6543","html_url":"https://github.com/6543","followers_url":"https://api.github.com/users/6543/followers","following_url":"https://api.github.com/users/6543/following{/other_user}","gists_url":"https://api.github.com/users/6543/gists{/gist_id}","starred_url":"https://api.github.com/users/6543/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6543/subscriptions","organizations_url":"https://api.github.com/users/6543/orgs","repos_url":"https://api.github.com/users/6543/repos","events_url":"https://api.github.com/users/6543/events{/privacy}","received_events_url":"https://api.github.com/users/6543/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/28945/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/28945/timeline","performed_via_github_app":null,"state_reason":"completed"}