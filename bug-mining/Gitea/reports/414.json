{"url":"https://api.github.com/repos/go-gitea/gitea/issues/32220","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/32220/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/32220/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/32220/events","html_url":"https://github.com/go-gitea/gitea/issues/32220","id":2574207517,"node_id":"I_kwDOBFIx286Zb0od","number":32220,"title":"Use a more sane tokenizer for source code search","user":{"login":"bsofiato","id":5076967,"node_id":"MDQ6VXNlcjUwNzY5Njc=","avatar_url":"https://avatars.githubusercontent.com/u/5076967?v=4","gravatar_id":"","url":"https://api.github.com/users/bsofiato","html_url":"https://github.com/bsofiato","followers_url":"https://api.github.com/users/bsofiato/followers","following_url":"https://api.github.com/users/bsofiato/following{/other_user}","gists_url":"https://api.github.com/users/bsofiato/gists{/gist_id}","starred_url":"https://api.github.com/users/bsofiato/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/bsofiato/subscriptions","organizations_url":"https://api.github.com/users/bsofiato/orgs","repos_url":"https://api.github.com/users/bsofiato/repos","events_url":"https://api.github.com/users/bsofiato/events{/privacy}","received_events_url":"https://api.github.com/users/bsofiato/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":474393850,"node_id":"MDU6TGFiZWw0NzQzOTM4NTA=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/proposal","name":"type/proposal","color":"5319e7","default":false,"description":"The new feature has not been accepted yet but needs to be discussed first."}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":4,"created_at":"2024-10-08T21:02:40Z","updated_at":"2025-02-05T00:32:08Z","closed_at":"2024-11-06T20:51:22Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Feature Description\n\nAs of today, the elastic search search uses the [default analizer](https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-standard-analyzer.html) when indexing the source code contents. This implementation uses whitespaces to break the tokens. \r\n\r\nI feel this approach is not particularly suitable for source code search. To illustrate the issue, let us consider the code snippet below:\r\n\r\n```\r\npublic baz(Foo foo) {\r\n   return foo.bar();\r\n}\r\n```\r\n\r\nIt is fair to think that searching for `bar` returns the code above. As of today, however, this is not the case: ES will assume that `foo.bar()` is a single token. As such, ES will not match the criterion `bar`.\r\n\r\nI suggest we use the [pattern tokenizer](https://www.elastic.co/guide/en/elasticsearch/reference/current/analysis-pattern-analyzer.html) instead.  It uses regular expressions to separate tokens. By default, it uses any (non-word character as a token separator).  In such a case, the snippet `foo.bar()` would yield two tokens -- `foo` and `bar` (the second token will match the given criterion).\r\n\r\nWhat do you guys think? \r\n\r\n\n\n### Screenshots\n\n_No response_","closed_by":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/32220/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/32220/timeline","performed_via_github_app":null,"state_reason":"completed"}