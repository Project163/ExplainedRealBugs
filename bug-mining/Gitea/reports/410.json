{"url":"https://api.github.com/repos/go-gitea/gitea/issues/28121","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/28121/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/28121/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/28121/events","html_url":"https://github.com/go-gitea/gitea/issues/28121","id":2000851058,"node_id":"I_kwDOBFIx2853QpBy","number":28121,"title":"Registry: Error response from daemon: missing signature key after upgrade to 1.21.0","user":{"login":"RogerSik","id":165814,"node_id":"MDQ6VXNlcjE2NTgxNA==","avatar_url":"https://avatars.githubusercontent.com/u/165814?v=4","gravatar_id":"","url":"https://api.github.com/users/RogerSik","html_url":"https://github.com/RogerSik","followers_url":"https://api.github.com/users/RogerSik/followers","following_url":"https://api.github.com/users/RogerSik/following{/other_user}","gists_url":"https://api.github.com/users/RogerSik/gists{/gist_id}","starred_url":"https://api.github.com/users/RogerSik/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/RogerSik/subscriptions","organizations_url":"https://api.github.com/users/RogerSik/orgs","repos_url":"https://api.github.com/users/RogerSik/repos","events_url":"https://api.github.com/users/RogerSik/events{/privacy}","received_events_url":"https://api.github.com/users/RogerSik/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""},{"id":3995080816,"node_id":"LA_kwDOBFIx287uIBhw","url":"https://api.github.com/repos/go-gitea/gitea/labels/issue/workaround","name":"issue/workaround","color":"006B75","default":false,"description":"it is or has a workaround"},{"id":4102834064,"node_id":"LA_kwDOBFIx2870jEeQ","url":"https://api.github.com/repos/go-gitea/gitea/labels/topic/packages","name":"topic/packages","color":"AFE667","default":false,"description":""}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":24,"created_at":"2023-11-19T13:26:49Z","updated_at":"2025-01-29T23:33:52Z","closed_at":"2024-10-31T15:28:26Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\n\nSince the upgrade to 1.21.0 the docker image build succeed but the docker pull fails with \r\n\r\n```\r\ndocker pull gitea.sikorski.cloud/rogersik/ansible:development\r\nError response from daemon: missing signature key\r\n```\r\n\r\nI suspect this is because of 1.21.0 because before the upgrade I din't have this problem. I can't \r\n\r\n- Gitea 1.21.0\r\n- using Act Runner on Kubernetes (with root rights)\r\n- Minio as S3 storage\r\n\r\nTest build locally with docker client\r\n```\r\n$ docker build . -t gitea.sikorski.cloud/rogersik/ansible:development\r\nfailed to fetch metadata: fork/exec /home/rsikorski/.docker/cli-plugins/docker-buildx: no such file or directory\r\n\r\nDEPRECATED: The legacy builder is deprecated and will be removed in a future release.\r\n            Install the buildx component to build images with BuildKit:\r\n            https://docs.docker.com/go/buildx/\r\n\r\nSending build context to Docker daemon   10.1MB\r\nStep 1/7 : FROM python:3.11-alpine3.18\r\n ---> 270f1e4a1f16\r\n\r\n## shortened ##\r\n\r\nSuccessfully built fa533b1a9606\r\nSuccessfully tagged gitea.sikorski.cloud/rogersik/ansible:development\r\n[rsikorski@ALIENWARE Ansible (feature/gitea-workflow-update)]$ docker push gitea.sikorski.cloud/rogersik/ansible:development\r\nThe push refers to repository [gitea.sikorski.cloud/rogersik/ansible]\r\nfc95f885118b: Pushed \r\n23e5afdd0f5b: Pushed \r\n83a9d089d007: Pushed \r\n086ab54fdc47: Pushed \r\nd85eefc84d77: Pushed \r\n880f9dc6c21c: Pushed \r\n47818e695d36: Pushed \r\na4aa75b591c8: Pushed \r\ne9e9555ceaa8: Pushed \r\n6f25d7d19389: Pushed \r\ncc2447e1835a: Layer already exists \r\ndevelopment: digest: sha256:5648a9fde44c7a13075e23e77c7d0ca56db8d43ad727857d8f5f08a4abb867d4 size: 2621\r\n[rsikorski@ALIENWARE Ansible (feature/gitea-workflow-update)]$ docker push gitea.sikorski.cloud/rogersik/ansible:development\r\nThe push refers to repository [gitea.sikorski.cloud/rogersik/ansible]\r\nfc95f885118b: Layer already exists \r\n23e5afdd0f5b: Layer already exists \r\n83a9d089d007: Layer already exists \r\n086ab54fdc47: Layer already exists \r\nd85eefc84d77: Layer already exists \r\n880f9dc6c21c: Layer already exists \r\n47818e695d36: Layer already exists \r\na4aa75b591c8: Layer already exists \r\ne9e9555ceaa8: Layer already exists \r\n6f25d7d19389: Layer already exists \r\ncc2447e1835a: Layer already exists \r\ndevelopment: digest: sha256:5648a9fde44c7a13075e23e77c7d0ca56db8d43ad727857d8f5f08a4abb867d4 size: 2621\r\n[rsikorski@ALIENWARE Ansible (feature/gitea-workflow-update)]$ docker push gitea.sikorski.cloud/rogersik/ansible:development\r\nThe push refers to repository [gitea.sikorski.cloud/rogersik/ansible]\r\nfc95f885118b: Layer already exists \r\n23e5afdd0f5b: Layer already exists \r\n83a9d089d007: Layer already exists \r\n086ab54fdc47: Layer already exists \r\nd85eefc84d77: Layer already exists \r\n880f9dc6c21c: Layer already exists \r\n47818e695d36: Layer already exists \r\na4aa75b591c8: Layer already exists \r\ne9e9555ceaa8: Layer already exists \r\n6f25d7d19389: Layer already exists \r\ncc2447e1835a: Layer already exists \r\ndevelopment: digest: sha256:5648a9fde44c7a13075e23e77c7d0ca56db8d43ad727857d8f5f08a4abb867d4 size: 2621\r\n\r\n[rsikorski@ALIENWARE Ansible (feature/gitea-workflow-update)]$ docker pull gitea.sikorski.cloud/rogersik/ansible:development\r\nError response from daemon: missing signature key\r\n```\r\n\r\nI builded the image now on three different ways\r\n* Gitea Act Runner: Kaniko\r\n* Gitea Act Runner: Docker root\r\n* locally on Ubuntu\r\n\r\nI deleted the :development image and rebuild it the same error happens. When using an unused tag example test1 same error.\r\n\r\nWhen downloading a ready image like alpine:latest\r\n```\r\ndocker pull alpine:latest\r\ndocker tag alpine:latest gitea.sikorski.cloud/rogersik/ansible:development\r\ndocker push gitea.sikorski.cloud/rogersik/ansible:development\r\ndocker pull gitea.sikorski.cloud/rogersik/ansible:development\r\nError response from daemon: missing signature key\r\n```\n\n### Gitea Version\n\n1.21.0\n\n### Can you reproduce the bug on the Gitea demo site?\n\nNo\n\n### Log Gist\n\n_No response_\n\n### Screenshots\n\n_No response_\n\n### Git Version\n\n1.21.0\n\n### Operating System\n\nUbuntu 22.04 / K3s\n\n### How are you running Gitea?\n\nGitea with the official docker container running on K3S.\n\n### Database\n\nPostgreSQL","closed_by":{"login":"techknowlogick","id":164197,"node_id":"MDQ6VXNlcjE2NDE5Nw==","avatar_url":"https://avatars.githubusercontent.com/u/164197?v=4","gravatar_id":"","url":"https://api.github.com/users/techknowlogick","html_url":"https://github.com/techknowlogick","followers_url":"https://api.github.com/users/techknowlogick/followers","following_url":"https://api.github.com/users/techknowlogick/following{/other_user}","gists_url":"https://api.github.com/users/techknowlogick/gists{/gist_id}","starred_url":"https://api.github.com/users/techknowlogick/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/techknowlogick/subscriptions","organizations_url":"https://api.github.com/users/techknowlogick/orgs","repos_url":"https://api.github.com/users/techknowlogick/repos","events_url":"https://api.github.com/users/techknowlogick/events{/privacy}","received_events_url":"https://api.github.com/users/techknowlogick/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/28121/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/28121/timeline","performed_via_github_app":null,"state_reason":"completed"}