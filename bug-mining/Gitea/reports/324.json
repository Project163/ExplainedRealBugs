{"url":"https://api.github.com/repos/go-gitea/gitea/issues/31205","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/31205/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/31205/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/31205/events","html_url":"https://github.com/go-gitea/gitea/issues/31205","id":2328983908,"node_id":"I_kwDOBFIx286K0Xlk","number":31205,"title":"1.22 upgrade migration fail, postgres 16 column not created - cannot revert","user":{"login":"jamiew0w","id":8589138,"node_id":"MDQ6VXNlcjg1ODkxMzg=","avatar_url":"https://avatars.githubusercontent.com/u/8589138?v=4","gravatar_id":"","url":"https://api.github.com/users/jamiew0w","html_url":"https://github.com/jamiew0w","followers_url":"https://api.github.com/users/jamiew0w/followers","following_url":"https://api.github.com/users/jamiew0w/following{/other_user}","gists_url":"https://api.github.com/users/jamiew0w/gists{/gist_id}","starred_url":"https://api.github.com/users/jamiew0w/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jamiew0w/subscriptions","organizations_url":"https://api.github.com/users/jamiew0w/orgs","repos_url":"https://api.github.com/users/jamiew0w/repos","events_url":"https://api.github.com/users/jamiew0w/events{/privacy}","received_events_url":"https://api.github.com/users/jamiew0w/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":12,"created_at":"2024-06-01T07:36:47Z","updated_at":"2024-09-01T00:35:13Z","closed_at":"2024-06-02T03:01:09Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\r\n\r\npostgres 16.3/debian 12\r\n\r\nwhen attempting upgrade:\r\n```\r\nrouters/init.go:73:mustInitCtx() [F] code.gitea.io/gitea/routers/common.InitDBEngine(ctx) failed: migrate: migration[286]: Add support for SHA256 git repositories failed: pq: column \"object_format_name\" does not exist\r\n```\r\n\r\nwhen attempting to revert:\r\n```\r\n2024/06/01 07:30:37 ...ations/migrations.go:628:Migrate() [F] Migration Error: Your database (migration version: 286) is for a newer Gitea, newer database for this old Gitea release (280).\r\nGitea will exit to keep your database safe and unchanged. Please use the correct Gitea release, do not change the migration version manually (incorrect manual operation may lose data).\r\n```\r\n\r\n### Gitea Version\r\n\r\n1.22\r\n\r\n### Can you reproduce the bug on the Gitea demo site?\r\n\r\nNo\r\n\r\n### Log Gist\r\n\r\n_No response_\r\n\r\n### Screenshots\r\n\r\n_No response_\r\n\r\n### Git Version\r\n\r\n_No response_\r\n\r\n### Operating System\r\n\r\ndebian\r\n\r\n### How are you running Gitea?\r\n\r\nbinary release\r\n\r\n### Database\r\n\r\nPostgreSQL","closed_by":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/31205/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/31205/timeline","performed_via_github_app":null,"state_reason":"completed"}