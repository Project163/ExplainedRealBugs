{"url":"https://api.github.com/repos/go-gitea/gitea/issues/33145","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/33145/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/33145/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/33145/events","html_url":"https://github.com/go-gitea/gitea/issues/33145","id":2774243454,"node_id":"I_kwDOBFIx286lW5h-","number":33145,"title":"Strange behaviors of the Sync Fork feature","user":{"login":"changchaishi","id":25934612,"node_id":"MDQ6VXNlcjI1OTM0NjEy","avatar_url":"https://avatars.githubusercontent.com/u/25934612?v=4","gravatar_id":"","url":"https://api.github.com/users/changchaishi","html_url":"https://github.com/changchaishi","followers_url":"https://api.github.com/users/changchaishi/followers","following_url":"https://api.github.com/users/changchaishi/following{/other_user}","gists_url":"https://api.github.com/users/changchaishi/gists{/gist_id}","starred_url":"https://api.github.com/users/changchaishi/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/changchaishi/subscriptions","organizations_url":"https://api.github.com/users/changchaishi/orgs","repos_url":"https://api.github.com/users/changchaishi/repos","events_url":"https://api.github.com/users/changchaishi/events{/privacy}","received_events_url":"https://api.github.com/users/changchaishi/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/go-gitea/gitea/milestones/171","html_url":"https://github.com/go-gitea/gitea/milestone/171","labels_url":"https://api.github.com/repos/go-gitea/gitea/milestones/171/labels","id":12144018,"node_id":"MI_kwDOBFIx284AuU2S","number":171,"title":"1.23.1","description":"","creator":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":15,"state":"closed","created_at":"2025-01-09T17:59:15Z","updated_at":"2025-01-16T11:02:25Z","due_on":null,"closed_at":"2025-01-10T18:31:23Z"},"comments":2,"created_at":"2025-01-08T04:07:19Z","updated_at":"2025-04-10T17:18:11Z","closed_at":"2025-01-10T05:29:57Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\r\n\r\nThere is a known issue that, when in a forked repository, we use `GetUpstreamDivergingInfo->GetDivergingCommits` to see if the forked branch needs to be synced.\r\n\r\nHowever the `GetDivergingCommits` will not work completely (return code 128 when the forked branch is updated) because the forked branch does not have the reference tree of the base branch in the repo path. Results in some scenarios, the `Sync fork` button is not shown as expected.\r\n\r\nI would like to work on this issue, and the following is my fix design:\r\n\r\n* By reference to `modules/git/repo_compare.go`'s `GetCompareInfo`, implement a temporary remote for the forked branch to make the `git rev-list` work.\r\n* The `rev-list` for the forked branch and base branch is much alike a pull request without listing the file changes but getting the summary of the commit change.\r\n\r\n---\r\n\r\nThis issue is related to #32769, if this is fixed, the improved `GetDivergingCommits` could help the other issue.\r\n\r\n### Gitea Version\r\n\r\n34dfc25\r\n\r\n### Can you reproduce the bug on the Gitea demo site?\r\n\r\nNo\r\n\r\n### Log Gist\r\n\r\n_No response_\r\n\r\n### Screenshots\r\n![Snipaste_2025-01-08_12-08-30](https://github.com/user-attachments/assets/16f3445b-51d8-4c6f-89b2-e6ac2f573625)\r\n\r\n_No response_\r\n\r\n### Git Version\r\n\r\n_No response_\r\n\r\n### Operating System\r\n\r\n_No response_\r\n\r\n### How are you running Gitea?\r\n\r\ndev container from ubuntu22.04\r\n\r\n### Database\r\n\r\nSQLite","closed_by":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/33145/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":1,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/33145/timeline","performed_via_github_app":null,"state_reason":"completed"}