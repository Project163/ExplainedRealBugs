{"url":"https://api.github.com/repos/go-gitea/gitea/issues/27457","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/27457/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/27457/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/27457/events","html_url":"https://github.com/go-gitea/gitea/issues/27457","id":1927708799,"node_id":"I_kwDOBFIx285y5oB_","number":27457,"title":"Admin user registration and EMAIL_DOMAIN_ALLOWLIST","user":{"login":"TineHorvat","id":3491512,"node_id":"MDQ6VXNlcjM0OTE1MTI=","avatar_url":"https://avatars.githubusercontent.com/u/3491512?v=4","gravatar_id":"","url":"https://api.github.com/users/TineHorvat","html_url":"https://github.com/TineHorvat","followers_url":"https://api.github.com/users/TineHorvat/followers","following_url":"https://api.github.com/users/TineHorvat/following{/other_user}","gists_url":"https://api.github.com/users/TineHorvat/gists{/gist_id}","starred_url":"https://api.github.com/users/TineHorvat/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TineHorvat/subscriptions","organizations_url":"https://api.github.com/users/TineHorvat/orgs","repos_url":"https://api.github.com/users/TineHorvat/repos","events_url":"https://api.github.com/users/TineHorvat/events{/privacy}","received_events_url":"https://api.github.com/users/TineHorvat/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":9,"created_at":"2023-10-05T08:36:57Z","updated_at":"2024-03-16T00:01:05Z","closed_at":"2024-03-05T05:55:48Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\n\nHello,\r\nwe have a local installation of Gitea and have recently upgraded to 1.20.4 and experienced a feature or functionality that was not present before on in the versions before. I can see there was a security enchantment (https://github.com/go-gitea/gitea/releases/tag/v1.20.4) about checking the blocklist. \r\n\r\nThe issue:\r\nAfter the upgrade to 1.20.4 we are not able (through administrator dashboard) to add users that have emails on domains that are not listed on the ALLOWLIST. If you use the any other domain, we get the error message: \"The email address is invalid.\"\r\n\r\nWe have user registration enabled, and set EMAIL_DOMAIN_ALLOWLIST for our organization and some business partners domains, which is working fine and they can register trough the form. For any other domains, only Gitea administrators added new users, so we can avoid spam users as much as possible. This was working for any domains, also those that are not on the ALLOWLIST in the previous version of Gitea.\r\n\r\nWe want to keep the \"open\" registration for the domains that are allowed, but also allow the administrators to add users with emails from any other domains. The main reason is we don't want to disable the registration for \"our\" domains because those users are under our organization policy and they can register by themself, but still be able that admins can add users with any domain if needed.\r\n\r\nIs there a new configuration combination that allows this settings or is this a \"feature/bug\", that checks only the ALLOWLIST also when an administrator is adding a new user?\r\n\r\nCan you please look into in?\r\n\r\nThanks,\r\nTine\n\n### Gitea Version\n\n1.20.4\n\n### Can you reproduce the bug on the Gitea demo site?\n\nNo\n\n### Log Gist\n\n_No response_\n\n### Screenshots\n\n_No response_\n\n### Git Version\n\n_No response_\n\n### Operating System\n\n_No response_\n\n### How are you running Gitea?\n\nWe are running on Windows Server, its running as a windows service.\n\n### Database\n\nNone","closed_by":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/27457/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/27457/timeline","performed_via_github_app":null,"state_reason":"completed"}