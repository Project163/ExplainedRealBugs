{"url":"https://api.github.com/repos/go-gitea/gitea/issues/31362","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/31362/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/31362/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/31362/events","html_url":"https://github.com/go-gitea/gitea/issues/31362","id":2351571755,"node_id":"I_kwDOBFIx286MKiMr","number":31362,"title":"Cannot download attachments of draft releases","user":{"login":"TobiLabu","id":116058935,"node_id":"U_kgDOBurrNw","avatar_url":"https://avatars.githubusercontent.com/u/116058935?v=4","gravatar_id":"","url":"https://api.github.com/users/TobiLabu","html_url":"https://github.com/TobiLabu","followers_url":"https://api.github.com/users/TobiLabu/followers","following_url":"https://api.github.com/users/TobiLabu/following{/other_user}","gists_url":"https://api.github.com/users/TobiLabu/gists{/gist_id}","starred_url":"https://api.github.com/users/TobiLabu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/TobiLabu/subscriptions","organizations_url":"https://api.github.com/users/TobiLabu/orgs","repos_url":"https://api.github.com/users/TobiLabu/repos","events_url":"https://api.github.com/users/TobiLabu/events{/privacy}","received_events_url":"https://api.github.com/users/TobiLabu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2024-06-13T16:28:42Z","updated_at":"2024-09-14T16:40:39Z","closed_at":"2024-06-15T04:20:15Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\r\n\r\nSince version 1.22.0 it is not possible to download files attached to releases that are flagged as draft. This used to work up until version 1.21.11. \r\n\r\nSteps to reproduce:\r\n1. Open any repo with activated releases\r\n2. Go to release page\r\n3. Create a new release\r\n4. Add an attachment to the release\r\n5. Save release as draft\r\n6. Try to download the attached file\r\n\r\nI'd expect the browser to download / open the file. Instead nothing happens (dev tools show a 404 is returned). \r\n\r\nI have prepared a script that reproduces the issue using docker containers, see https://github.com/TobiLabu/reproduce-gitea-issue.\r\nYou can set the version of Gitea in the .env file to verify that this used to work in earlier versions. \r\n\r\nPlease let me know if any info is missing. \r\n\r\n### Gitea Version\r\n\r\n1.22.0\r\n\r\n### Can you reproduce the bug on the Gitea demo site?\r\n\r\nYes\r\n\r\n### Log Gist\r\n\r\nhttps://gist.github.com/TobiLabu/3e661a79630a574313988fa415427408\r\n\r\n### Screenshots\r\n\r\n_No response_\r\n\r\n### Git Version\r\n\r\n2.45.1\r\n\r\n### Operating System\r\n\r\nLinux\r\n\r\n### How are you running Gitea?\r\n\r\nI have reproduced the issue at https://demo.gitea.com/ as well as on a private dockerized instance and a fresh instance using Docker Compose. \r\n\r\n### Database\r\n\r\nPostgreSQL","closed_by":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/31362/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/31362/timeline","performed_via_github_app":null,"state_reason":"completed"}