{"url":"https://api.github.com/repos/go-gitea/gitea/issues/35473","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/35473/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/35473/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/35473/events","html_url":"https://github.com/go-gitea/gitea/issues/35473","id":3409952141,"node_id":"I_kwDOBFIx287LP72N","number":35473,"title":"Different behavior in status check pattern matching with `**`","user":{"login":"LordBaryhobal","id":47377497,"node_id":"MDQ6VXNlcjQ3Mzc3NDk3","avatar_url":"https://avatars.githubusercontent.com/u/47377497?v=4","gravatar_id":"","url":"https://api.github.com/users/LordBaryhobal","html_url":"https://github.com/LordBaryhobal","followers_url":"https://api.github.com/users/LordBaryhobal/followers","following_url":"https://api.github.com/users/LordBaryhobal/following{/other_user}","gists_url":"https://api.github.com/users/LordBaryhobal/gists{/gist_id}","starred_url":"https://api.github.com/users/LordBaryhobal/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/LordBaryhobal/subscriptions","organizations_url":"https://api.github.com/users/LordBaryhobal/orgs","repos_url":"https://api.github.com/users/LordBaryhobal/repos","events_url":"https://api.github.com/users/LordBaryhobal/events{/privacy}","received_events_url":"https://api.github.com/users/LordBaryhobal/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/go-gitea/gitea/milestones/179","html_url":"https://github.com/go-gitea/gitea/milestone/179","labels_url":"https://api.github.com/repos/go-gitea/gitea/milestones/179/labels","id":12704260,"node_id":"MI_kwDOBFIx284AwdoE","number":179,"title":"1.25.0","description":"","creator":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":459,"state":"closed","created_at":"2025-04-10T01:13:20Z","updated_at":"2025-10-29T16:21:54Z","due_on":"2025-08-25T07:00:00Z","closed_at":"2025-10-29T16:21:54Z"},"comments":1,"created_at":"2025-09-12T10:39:19Z","updated_at":"2025-09-13T03:53:29Z","closed_at":"2025-09-13T03:53:28Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\n\n## Context\nWhen configuring banch protection, you can enable status checks. You are prompted to enter some patterns to match required status checks. The patterns are first matched against recent status checks using the [`minimatch`](https://www.npmjs.com/package/minimatch) JS package. But when they are enforced, on the backend, they are matched using the [`gobwas/glob`](https://github.com/gobwas/glob) Go package. This leads to some differences in behaviors (as seen in [#33121](https://github.com/go-gitea/gitea/issues/33121)\n\n## Issue\nThe main issue I am facing right now is the difference in the meaning of \"**\". It seems like the Go package implements it as a \"match _any_ character, any number of times\", while the `minimatch` implements it in a more path-related way, matching \"multiple folder names\".\n\nHere is a minimal working example in Go, which correctly matches the status check context.\n```go\npackage main\n\nimport (\n    \"fmt\"\n    \"github.com/gobwas/glob\"\n)\n\nfunc main() {\n    pattern, _ := glob.Compile(\"Check**\")\n    if pattern.Match(\"Check / check (pull_request)\") {\n        fmt.Println(\"Matches\")\n    } else {\n        fmt.Println(\"Doesn't match\")\n    }\n    // -> Matches\n}\n```\n\nAnd here is the same example using the `minimatch` JS package, which doesn't work because of the \"/\" in the status check context:\n```js\nconst {minimatch} = require(\"minimatch\")\nconst matches = minimatch(\"Check / check (pull_request)\", \"Check**\", {noext: true})\nif (matches) {\n    console.log(\"Matches\")\n} else {\n    console.log(\"Doesn't match\")\n}\n// -> Doesn't match\n```\n\n## Possible solution\nI don't know how to make `minimatch` work the same as `gobwas/glob` or if it is even possible. However, if the patterns were to be RegExps, I think it would be easier to have matching libraries both in Go and JS. Is there a particular reason to use globs instead of regular expressions ?\n\nDemo repo: https://demo.gitea.com/LordBaryhobal/test-status-check\n\n### Gitea Version\n\n1.24.4\n\n### Can you reproduce the bug on the Gitea demo site?\n\nYes\n\n### Log Gist\n\n_No response_\n\n### Screenshots\n\n### Branch protection rule, status check is not marked as \"Matched\"\n<img width=\"1016\" height=\"344\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/60aacc56-c894-4eb2-aa3e-d8dd44e79d4b\" />\n\n### Pull request, check is marked as required\n<img width=\"984\" height=\"285\" alt=\"Image\" src=\"https://github.com/user-attachments/assets/0abad2b5-2b0c-46c8-8208-6814822836e8\" />\n\n### Git Version\n\n_No response_\n\n### Operating System\n\n_No response_\n\n### How are you running Gitea?\n\nDocker image\n\n### Database\n\nNone","closed_by":{"login":"wxiaoguang","id":2114189,"node_id":"MDQ6VXNlcjIxMTQxODk=","avatar_url":"https://avatars.githubusercontent.com/u/2114189?v=4","gravatar_id":"","url":"https://api.github.com/users/wxiaoguang","html_url":"https://github.com/wxiaoguang","followers_url":"https://api.github.com/users/wxiaoguang/followers","following_url":"https://api.github.com/users/wxiaoguang/following{/other_user}","gists_url":"https://api.github.com/users/wxiaoguang/gists{/gist_id}","starred_url":"https://api.github.com/users/wxiaoguang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wxiaoguang/subscriptions","organizations_url":"https://api.github.com/users/wxiaoguang/orgs","repos_url":"https://api.github.com/users/wxiaoguang/repos","events_url":"https://api.github.com/users/wxiaoguang/events{/privacy}","received_events_url":"https://api.github.com/users/wxiaoguang/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/35473/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/35473/timeline","performed_via_github_app":null,"state_reason":"completed"}