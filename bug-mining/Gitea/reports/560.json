{"url":"https://api.github.com/repos/go-gitea/gitea/issues/33966","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/33966/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/33966/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/33966/events","html_url":"https://github.com/go-gitea/gitea/issues/33966","id":2938739224,"node_id":"I_kwDOBFIx286vKZoY","number":33966,"title":"Setting to disable expensive endpoints for anonymous users","user":{"login":"Victorious3","id":3749322,"node_id":"MDQ6VXNlcjM3NDkzMjI=","avatar_url":"https://avatars.githubusercontent.com/u/3749322?v=4","gravatar_id":"","url":"https://api.github.com/users/Victorious3","html_url":"https://github.com/Victorious3","followers_url":"https://api.github.com/users/Victorious3/followers","following_url":"https://api.github.com/users/Victorious3/following{/other_user}","gists_url":"https://api.github.com/users/Victorious3/gists{/gist_id}","starred_url":"https://api.github.com/users/Victorious3/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Victorious3/subscriptions","organizations_url":"https://api.github.com/users/Victorious3/orgs","repos_url":"https://api.github.com/users/Victorious3/repos","events_url":"https://api.github.com/users/Victorious3/events{/privacy}","received_events_url":"https://api.github.com/users/Victorious3/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":474393850,"node_id":"MDU6TGFiZWw0NzQzOTM4NTA=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/proposal","name":"type/proposal","color":"5319e7","default":false,"description":"The new feature has not been accepted yet but needs to be discussed first."}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":16,"created_at":"2025-03-21T15:23:10Z","updated_at":"2025-06-28T08:15:54Z","closed_at":"2025-03-30T05:26:20Z","author_association":"NONE","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Feature Description\n\nSince AI scrapers are terrorizing the web and flooding innocent gitea instances, it would make sense to have an option to only allow expensive endpoints (like `/src/commit` or `/blame`) for logged in users.\n\nWhat I have observed is that crawlers like Claudebot and Bytespider don't respect my robots.txt and decide to crawl every single file from every single commit. For big repositories this can become a massive performance hit since gitea has to run git to be able to serve the requests, which has a lot of overhead. I even enabled a redis cache but since they hit new files all the time it didn't help much.\n\nAs a workaround I have configured my reverse proxy nginx to redirect these endpoints to an Anubis instance (https://anubis.techaro.lol/) which seems to kill most of the scrapers or at least wastes their time for long enough to make their DDOS (because that's what it is, really!) less annoying.\n\nHowever, since this is a solution that works on proxying with nginx, every user sees the Anubis thing before being able to look at commits, even if they are logged in. Therefore it would be preferrable to just have an option to disallow these endpoints. If someone external wants to look at the commits they can just check out the repository and look at the history there.\n\n### Screenshots\n\n_No response_","closed_by":{"login":"wxiaoguang","id":2114189,"node_id":"MDQ6VXNlcjIxMTQxODk=","avatar_url":"https://avatars.githubusercontent.com/u/2114189?v=4","gravatar_id":"","url":"https://api.github.com/users/wxiaoguang","html_url":"https://github.com/wxiaoguang","followers_url":"https://api.github.com/users/wxiaoguang/followers","following_url":"https://api.github.com/users/wxiaoguang/following{/other_user}","gists_url":"https://api.github.com/users/wxiaoguang/gists{/gist_id}","starred_url":"https://api.github.com/users/wxiaoguang/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wxiaoguang/subscriptions","organizations_url":"https://api.github.com/users/wxiaoguang/orgs","repos_url":"https://api.github.com/users/wxiaoguang/repos","events_url":"https://api.github.com/users/wxiaoguang/events{/privacy}","received_events_url":"https://api.github.com/users/wxiaoguang/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/33966/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/33966/timeline","performed_via_github_app":null,"state_reason":"completed"}