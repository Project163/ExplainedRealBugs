{"url":"https://api.github.com/repos/go-gitea/gitea/issues/31271","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/31271/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/31271/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/31271/events","html_url":"https://github.com/go-gitea/gitea/issues/31271","id":2337411612,"node_id":"I_kwDOBFIx286LUhIc","number":31271,"title":"Garbage Collection LFS Pointer deletes inuse LFS Objects","user":{"login":"wienans","id":40465543,"node_id":"MDQ6VXNlcjQwNDY1NTQz","avatar_url":"https://avatars.githubusercontent.com/u/40465543?v=4","gravatar_id":"","url":"https://api.github.com/users/wienans","html_url":"https://github.com/wienans","followers_url":"https://api.github.com/users/wienans/followers","following_url":"https://api.github.com/users/wienans/following{/other_user}","gists_url":"https://api.github.com/users/wienans/gists{/gist_id}","starred_url":"https://api.github.com/users/wienans/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wienans/subscriptions","organizations_url":"https://api.github.com/users/wienans/orgs","repos_url":"https://api.github.com/users/wienans/repos","events_url":"https://api.github.com/users/wienans/events{/privacy}","received_events_url":"https://api.github.com/users/wienans/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""},{"id":474799156,"node_id":"MDU6TGFiZWw0NzQ3OTkxNTY=","url":"https://api.github.com/repos/go-gitea/gitea/labels/issue/critical","name":"issue/critical","color":"fbca04","default":false,"description":"This issue should be fixed ASAP. If it is a PR, the PR should be merged ASAP"},{"id":5792453903,"node_id":"LA_kwDOBFIx288AAAABWUHVDw","url":"https://api.github.com/repos/go-gitea/gitea/labels/topic/lfs","name":"topic/lfs","color":"4AACF2","default":false,"description":""}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/go-gitea/gitea/milestones/165","html_url":"https://github.com/go-gitea/gitea/milestone/165","labels_url":"https://api.github.com/repos/go-gitea/gitea/milestones/165/labels","id":11278175,"node_id":"MI_kwDOBFIx284ArBdf","number":165,"title":"1.22.2","description":"","creator":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":76,"state":"closed","created_at":"2024-07-05T23:07:38Z","updated_at":"2024-09-06T03:38:51Z","due_on":null,"closed_at":"2024-09-06T03:38:51Z"},"comments":1,"created_at":"2024-06-06T06:24:38Z","updated_at":"2024-11-07T03:28:13Z","closed_at":"2024-08-09T02:40:46Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\r\n\r\nHallo Community,\r\n\r\ni noticed that on my Gitea Platform all old LFS Files are lost. Currently i only have LFS files which are 3 days old. And 3 days ago i manually run the Garbage Collection for all repositories and Garbage Collection LFS pointers.\r\n\r\nI now reproduced this issue with setting the config as follows for that task and uploaded some lfs files an hour ago.\r\n\r\n```\r\n[cron.gc_lfs]\r\nOLDER_THAN = 1h\r\nLAST_UPDATED_MORE_THAN_AGO = 1h\r\n```\r\nAll LFS Files are gone again. And the Log looks not to be conclusive at all...\r\nThe Admin pannel shows that the task was done at 12:11:43 and i see the gc_lfs but there is not more than that.\r\n\r\n### Gitea Version\r\n\r\n1.21.11\r\n\r\n### Can you reproduce the bug on the Gitea demo site?\r\n\r\nNo\r\n\r\n### Log\r\n\r\n```\r\n2024/06/06 12:11:43 ...eb/routing/logger.go:102:func1() [I] router: completed GET /user/events for 192.168.1.132:56594, 200 OK in 14976.7ms @ events/events.go:18(events.Events)\r\n2024/06/06 12:11:43 ...rvices/cron/tasks.go:152:GetTask() [I] Getting gc_lfs in &{{0 0} gc_lfs 0xc000918740 0x24a6980    0 0001-01-01 00:00:00 +0000 UTC}\r\n2024/06/06 12:11:43 ...eb/routing/logger.go:102:func1() [I] router: completed POST /admin for 192.168.1.132:56634, 303 See Other in 6.0ms @ admin/admin.go:141(admin.DashboardPost)\r\n2024/06/06 12:11:43 ...eb/routing/logger.go:102:func1() [I] router: completed GET /admin/monitor/cron for 192.168.1.132:56634, 200 OK in 23.1ms @ admin/admin.go:175(admin.CronTasks)\r\n2024/06/06 12:11:43 ...eb/routing/logger.go:102:func1() [I] router: completed POST /api/actions/runner.v1.RunnerService/FetchTask for 192.168.3.47:46962, 200 OK in 60.9ms @ <autogenerated>:1(http.Handler.ServeHTTP-fm)\r\n2024/06/06 12:11:45 ...eb/routing/logger.go:102:func1() [I] router: completed POST /api/actions/runner.v1.RunnerService/FetchTask for 192.168.3.47:46962, 200 OK in 55.4ms @ <autogenerated>:1(http.Handler.ServeHTTP-fm)\r\n2024/06/06 12:11:47 ...eb/routing/logger.go:68:func1() [I] router: polling   GET /user/events for 192.168.1.132:56634, elapsed 3610.7ms @ events/events.go:18(events.Events)\r\n2024/06/06 12:11:47 ...eb/routing/logger.go:102:func1() [I] router: completed GET /user/events for 192.168.1.132:56634, 200 OK in 3732.3ms @ events/events.go:18(events.Events)\r\n2024/06/06 12:11:47 ...eb/routing/logger.go:102:func1() [I] router: completed GET /admin/monitor/cron for 192.168.1.132:56635, 200 OK in 18.0ms @ admin/admin.go:175(admin.CronTasks)\r\n2024/06/06 12:11:47 ...eb/routing/logger.go:102:func1() [I] router: completed POST /api/actions/runner.v1.RunnerService/FetchTask for 192.168.3.47:46962, 200 OK in 50.6ms @ <autogenerated>:1(http.Handler.ServeHTTP-fm)\r\n2024/06/06 12:11:49 ...eb/routing/logger.go:102:func1() [I] router: completed POST /api/actions/runner.v1.RunnerService/FetchTask for 192.168.3.47:46962, 200 OK in 52.4ms @ <autogenerated>:1(http.Handler.ServeHTTP-fm)\r\n2024/06/06 12:11:50 ...eb/routing/logger.go:102:func1() [I] router: completed GET /wienand/GIT-lfs-test/settings/lfs for 192.168.1.132:56636, 200 OK in 146.5ms @ setting/lfs.go:42(setting.LFSFiles)\r\n2024/06/06 12:11:51 ...eb/routing/logger.go:68:func1() [I] router: polling   GET /user/events for 192.168.1.132:56635, elapsed 3738.1ms @ events/events.go:18(events.Events)\r\n\r\n```\r\n### Screenshots\r\n\r\n_No response_\r\n\r\n### Git Version\r\n\r\n2.42.0, Wire Protocol Version 2 Enabled\r\n\r\n### Operating System\r\n\r\nWindows\r\n\r\n### How are you running Gitea?\r\n\r\nWindows Server: gitea-1.21.11-gogit-windows-4.0-amd64\r\n\r\n### Database\r\n\r\nMySQL/MariaDB","closed_by":{"login":"wolfogre","id":9418365,"node_id":"MDQ6VXNlcjk0MTgzNjU=","avatar_url":"https://avatars.githubusercontent.com/u/9418365?v=4","gravatar_id":"","url":"https://api.github.com/users/wolfogre","html_url":"https://github.com/wolfogre","followers_url":"https://api.github.com/users/wolfogre/followers","following_url":"https://api.github.com/users/wolfogre/following{/other_user}","gists_url":"https://api.github.com/users/wolfogre/gists{/gist_id}","starred_url":"https://api.github.com/users/wolfogre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wolfogre/subscriptions","organizations_url":"https://api.github.com/users/wolfogre/orgs","repos_url":"https://api.github.com/users/wolfogre/repos","events_url":"https://api.github.com/users/wolfogre/events{/privacy}","received_events_url":"https://api.github.com/users/wolfogre/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/31271/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/31271/timeline","performed_via_github_app":null,"state_reason":"completed"}