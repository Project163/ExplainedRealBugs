[{"id":11088104923,"node_id":"LE_lADOBFIx2854HXrhzwAAAAKU5w3b","url":"https://api.github.com/repos/go-gitea/gitea/issues/events/11088104923","actor":{"login":"brechtvl","id":450909,"node_id":"MDQ6VXNlcjQ1MDkwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/450909?v=4","gravatar_id":"","url":"https://api.github.com/users/brechtvl","html_url":"https://github.com/brechtvl","followers_url":"https://api.github.com/users/brechtvl/followers","following_url":"https://api.github.com/users/brechtvl/following{/other_user}","gists_url":"https://api.github.com/users/brechtvl/gists{/gist_id}","starred_url":"https://api.github.com/users/brechtvl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brechtvl/subscriptions","organizations_url":"https://api.github.com/users/brechtvl/orgs","repos_url":"https://api.github.com/users/brechtvl/repos","events_url":"https://api.github.com/users/brechtvl/events{/privacy}","received_events_url":"https://api.github.com/users/brechtvl/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2023-11-28T19:54:32Z","label":{"name":"type/bug","color":"ee0701"},"performed_via_github_app":null},{"actor":{"login":"wolfogre","id":9418365,"node_id":"MDQ6VXNlcjk0MTgzNjU=","avatar_url":"https://avatars.githubusercontent.com/u/9418365?v=4","gravatar_id":"","url":"https://api.github.com/users/wolfogre","html_url":"https://github.com/wolfogre","followers_url":"https://api.github.com/users/wolfogre/followers","following_url":"https://api.github.com/users/wolfogre/following{/other_user}","gists_url":"https://api.github.com/users/wolfogre/gists{/gist_id}","starred_url":"https://api.github.com/users/wolfogre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wolfogre/subscriptions","organizations_url":"https://api.github.com/users/wolfogre/orgs","repos_url":"https://api.github.com/users/wolfogre/repos","events_url":"https://api.github.com/users/wolfogre/events{/privacy}","received_events_url":"https://api.github.com/users/wolfogre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-11-30T08:47:17Z","updated_at":"2023-11-30T08:47:17Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/28304","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/28304/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/28304/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/28304/events","html_url":"https://github.com/go-gitea/gitea/pull/28304","id":2018155962,"node_id":"PR_kwDOBFIx285gwLmi","number":28304,"title":"Include public repos in doer's dashboard for issue search","user":{"login":"wolfogre","id":9418365,"node_id":"MDQ6VXNlcjk0MTgzNjU=","avatar_url":"https://avatars.githubusercontent.com/u/9418365?v=4","gravatar_id":"","url":"https://api.github.com/users/wolfogre","html_url":"https://github.com/wolfogre","followers_url":"https://api.github.com/users/wolfogre/followers","following_url":"https://api.github.com/users/wolfogre/following{/other_user}","gists_url":"https://api.github.com/users/wolfogre/gists{/gist_id}","starred_url":"https://api.github.com/users/wolfogre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wolfogre/subscriptions","organizations_url":"https://api.github.com/users/wolfogre/orgs","repos_url":"https://api.github.com/users/wolfogre/repos","events_url":"https://api.github.com/users/wolfogre/events{/privacy}","received_events_url":"https://api.github.com/users/wolfogre/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""},{"id":475283668,"node_id":"MDU6TGFiZWw0NzUyODM2Njg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/lgtm/done","name":"lgtm/done","color":"0e8a16","default":false,"description":"This PR has enough approvals to get merged. There are no important open reservations anymore."},{"id":676182852,"node_id":"MDU6TGFiZWw2NzYxODI4NTI=","url":"https://api.github.com/repos/go-gitea/gitea/labels/pr/breaking","name":"pr/breaking","color":"fbca04","default":false,"description":"Merging this PR means builds will break. Needs a description what exactly breaks, and how to fix it!"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":{"url":"https://api.github.com/repos/go-gitea/gitea/milestones/148","html_url":"https://github.com/go-gitea/gitea/milestone/148","labels_url":"https://api.github.com/repos/go-gitea/gitea/milestones/148/labels","id":9871524,"node_id":"MI_kwDOBFIx284AlqCk","number":148,"title":"1.22.0","description":"","creator":{"login":"6543","id":24977596,"node_id":"MDQ6VXNlcjI0OTc3NTk2","avatar_url":"https://avatars.githubusercontent.com/u/24977596?v=4","gravatar_id":"","url":"https://api.github.com/users/6543","html_url":"https://github.com/6543","followers_url":"https://api.github.com/users/6543/followers","following_url":"https://api.github.com/users/6543/following{/other_user}","gists_url":"https://api.github.com/users/6543/gists{/gist_id}","starred_url":"https://api.github.com/users/6543/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/6543/subscriptions","organizations_url":"https://api.github.com/users/6543/orgs","repos_url":"https://api.github.com/users/6543/repos","events_url":"https://api.github.com/users/6543/events{/privacy}","received_events_url":"https://api.github.com/users/6543/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":1530,"state":"closed","created_at":"2023-09-02T01:25:31Z","updated_at":"2024-05-28T09:31:23Z","due_on":"2024-03-14T07:00:00Z","closed_at":"2024-05-27T12:24:20Z"},"comments":2,"created_at":"2023-11-30T08:47:16Z","updated_at":"2024-07-05T21:31:38Z","closed_at":"2023-12-07T05:26:18Z","author_association":"MEMBER","type":null,"active_lock_reason":"resolved","draft":false,"repository":{"id":72495579,"node_id":"MDEwOlJlcG9zaXRvcnk3MjQ5NTU3OQ==","name":"gitea","full_name":"go-gitea/gitea","private":false,"owner":{"login":"go-gitea","id":12724356,"node_id":"MDEyOk9yZ2FuaXphdGlvbjEyNzI0MzU2","avatar_url":"https://avatars.githubusercontent.com/u/12724356?v=4","gravatar_id":"","url":"https://api.github.com/users/go-gitea","html_url":"https://github.com/go-gitea","followers_url":"https://api.github.com/users/go-gitea/followers","following_url":"https://api.github.com/users/go-gitea/following{/other_user}","gists_url":"https://api.github.com/users/go-gitea/gists{/gist_id}","starred_url":"https://api.github.com/users/go-gitea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/go-gitea/subscriptions","organizations_url":"https://api.github.com/users/go-gitea/orgs","repos_url":"https://api.github.com/users/go-gitea/repos","events_url":"https://api.github.com/users/go-gitea/events{/privacy}","received_events_url":"https://api.github.com/users/go-gitea/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/go-gitea/gitea","description":"Git with a cup of tea! Painless self-hosted all-in-one software development service, including Git hosting, code review, team collaboration, package registry and CI/CD","fork":false,"url":"https://api.github.com/repos/go-gitea/gitea","forks_url":"https://api.github.com/repos/go-gitea/gitea/forks","keys_url":"https://api.github.com/repos/go-gitea/gitea/keys{/key_id}","collaborators_url":"https://api.github.com/repos/go-gitea/gitea/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/go-gitea/gitea/teams","hooks_url":"https://api.github.com/repos/go-gitea/gitea/hooks","issue_events_url":"https://api.github.com/repos/go-gitea/gitea/issues/events{/number}","events_url":"https://api.github.com/repos/go-gitea/gitea/events","assignees_url":"https://api.github.com/repos/go-gitea/gitea/assignees{/user}","branches_url":"https://api.github.com/repos/go-gitea/gitea/branches{/branch}","tags_url":"https://api.github.com/repos/go-gitea/gitea/tags","blobs_url":"https://api.github.com/repos/go-gitea/gitea/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/go-gitea/gitea/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/go-gitea/gitea/git/refs{/sha}","trees_url":"https://api.github.com/repos/go-gitea/gitea/git/trees{/sha}","statuses_url":"https://api.github.com/repos/go-gitea/gitea/statuses/{sha}","languages_url":"https://api.github.com/repos/go-gitea/gitea/languages","stargazers_url":"https://api.github.com/repos/go-gitea/gitea/stargazers","contributors_url":"https://api.github.com/repos/go-gitea/gitea/contributors","subscribers_url":"https://api.github.com/repos/go-gitea/gitea/subscribers","subscription_url":"https://api.github.com/repos/go-gitea/gitea/subscription","commits_url":"https://api.github.com/repos/go-gitea/gitea/commits{/sha}","git_commits_url":"https://api.github.com/repos/go-gitea/gitea/git/commits{/sha}","comments_url":"https://api.github.com/repos/go-gitea/gitea/comments{/number}","issue_comment_url":"https://api.github.com/repos/go-gitea/gitea/issues/comments{/number}","contents_url":"https://api.github.com/repos/go-gitea/gitea/contents/{+path}","compare_url":"https://api.github.com/repos/go-gitea/gitea/compare/{base}...{head}","merges_url":"https://api.github.com/repos/go-gitea/gitea/merges","archive_url":"https://api.github.com/repos/go-gitea/gitea/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/go-gitea/gitea/downloads","issues_url":"https://api.github.com/repos/go-gitea/gitea/issues{/number}","pulls_url":"https://api.github.com/repos/go-gitea/gitea/pulls{/number}","milestones_url":"https://api.github.com/repos/go-gitea/gitea/milestones{/number}","notifications_url":"https://api.github.com/repos/go-gitea/gitea/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/go-gitea/gitea/labels{/name}","releases_url":"https://api.github.com/repos/go-gitea/gitea/releases{/id}","deployments_url":"https://api.github.com/repos/go-gitea/gitea/deployments","created_at":"2016-11-01T02:13:26Z","updated_at":"2025-11-09T22:07:00Z","pushed_at":"2025-11-09T21:54:34Z","git_url":"git://github.com/go-gitea/gitea.git","ssh_url":"git@github.com:go-gitea/gitea.git","clone_url":"https://github.com/go-gitea/gitea.git","svn_url":"https://github.com/go-gitea/gitea","homepage":"https://gitea.com","size":317853,"stargazers_count":51900,"watchers_count":51900,"language":"Go","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6199,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2849,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":true,"topics":["bitbucket","cicd","devops","docker-registry-v2","git","git-gui","git-server","gitea","github","github-actions","gitlab","go","golang","hacktoberfest","maven-server","npm-registry","vue"],"visibility":"public","forks":6199,"open_issues":2849,"watchers":51900,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/go-gitea/gitea/pulls/28304","html_url":"https://github.com/go-gitea/gitea/pull/28304","diff_url":"https://github.com/go-gitea/gitea/pull/28304.diff","patch_url":"https://github.com/go-gitea/gitea/pull/28304.patch","merged_at":"2023-12-07T05:26:18Z"},"body":"It will fix #28268 .\r\n\r\n<img width=\"1313\" alt=\"image\" src=\"https://github.com/go-gitea/gitea/assets/9418365/cb1e07d5-7a12-4691-a054-8278ba255bfc\">\r\n\r\n<img width=\"1318\" alt=\"image\" src=\"https://github.com/go-gitea/gitea/assets/9418365/4fd60820-97f1-4c2c-a233-d3671a5039e9\">\r\n\r\n## :warning: BREAKING :warning:\r\n\r\nBut need to give up some features:\r\n\r\n<img width=\"1312\" alt=\"image\" src=\"https://github.com/go-gitea/gitea/assets/9418365/281c0d51-0e7d-473f-bbed-216e2f645610\">\r\n\r\nHowever, such abandonment may fix #28055 .\r\n\r\n## Backgroud\r\n\r\nWhen the user switches the dashboard context to an org, it means they want to search issues in the repos that belong to the org. However, when they switch to themselves, it means all repos they can access because they may have created an issue in a public repo that they don't own.\r\n\r\n<img width=\"286\" alt=\"image\" src=\"https://github.com/go-gitea/gitea/assets/9418365/182dcd5b-1c20-4725-93af-96e8dfae5b97\">\r\n\r\nIt's a confusing design. Think about this: What does \"In your repositories\" mean when the user switches to an org? Repos belong to the user or the org?\r\n\r\nWhatever, it has been broken by #26012 and its following PRs. After the PR, it searches for issues in repos that the dashboard context user owns or has been explicitly granted access to, so it causes #28268.\r\n\r\n## How to fix it\r\n\r\nIt's not really difficult to fix it. Just extend the repo scope to search issues when the dashboard context user is the doer. Since the user may create issues or be mentioned in any public repo, we can just set `AllPublic` to true, which is already supported by indexers. The DB condition will also support it in this PR.\r\n\r\nBut the real difficulty is how to count the search results grouped by repos. It's something like \"search issues with this keyword and those filters, and return the total number and the top results. **Then, group all of them by repo and return the counts of each group.**\"\r\n\r\n<img width=\"314\" alt=\"image\" src=\"https://github.com/go-gitea/gitea/assets/9418365/5206eb20-f8f5-49b9-b45a-1be2fcf679f4\">\r\n\r\nBefore #26012, it was being done in the DB, but it caused the results to be incomplete (see the description of #26012).\r\n\r\nAnd to keep this, #26012 implement it in an inefficient way, just count the issues by repo one by one, so it cannot work when `AllPublic` is true because it's almost impossible to do this for all public repos.\r\n\r\nhttps://github.com/go-gitea/gitea/blob/1bfcdeef4cca0f5509476358e5931c13d37ed1ca/modules/indexer/issues/indexer.go#L318-L338\r\n\r\n## Give up unnecessary features\r\n\r\nWe may can resovle `TODO: use \"group by\" of the indexer engines to implement it`, I'm sure it can be done with Elasticsearch, but IIRC, Bleve and Meilisearch don't support \"group by\".\r\n\r\nAnd the real question is, does it worth it? Why should we need to know the counts grouped by repos?\r\n\r\nLet me show you my search dashboard on gitea.com.\r\n\r\n<img width=\"1304\" alt=\"image\" src=\"https://github.com/go-gitea/gitea/assets/9418365/2bca2d46-6c71-4de1-94cb-0c9af27c62ff\">\r\n\r\nI never think the long repo list helps anything.\r\n\r\nAnd if we agree to abandon it, things will be much easier. That is this PR.\r\n\r\n## TODO\r\n\r\nI know it's important to filter by repos when searching issues. However, it shouldn't be the way we have it now. It could be implemented like this.\r\n\r\n<img width=\"1316\" alt=\"image\" src=\"https://github.com/go-gitea/gitea/assets/9418365/99ee5f21-cbb5-4dfe-914d-cb796cb79fbe\">\r\n\r\nThe indexers support it well now, but it requires some frontend work, which I'm not good at. So, I think someone could help do that in another PR and merge this one to fix the bug first.\r\n\r\nOr please block this PR and help to complete it.\r\n\r\nFinally, \"Switch dashboard context\" is also a design that needs improvement. In my opinion, it can be accomplished by adding filtering conditions instead of \"switching\".","reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/28304/reactions","total_count":1,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":1,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/28304/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":11177122532,"node_id":"CE_lADOBFIx2854HXrhzwAAAAKaNVrk","url":"https://api.github.com/repos/go-gitea/gitea/issues/events/11177122532","actor":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2023-12-07T05:26:19Z","state_reason":null,"performed_via_github_app":null},{"id":11177122665,"node_id":"REFE_lADOBFIx2854HXrhzwAAAAKaNVtp","url":"https://api.github.com/repos/go-gitea/gitea/issues/events/11177122665","actor":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"beb71f5ef6e8074dc744ac995c15f7b5947a3f2e","commit_url":"https://api.github.com/repos/go-gitea/gitea/commits/beb71f5ef6e8074dc744ac995c15f7b5947a3f2e","created_at":"2023-12-07T05:26:20Z","performed_via_github_app":null},{"id":11179705538,"node_id":"REFE_lADOBFIx2854HXrhzwAAAAKaXMTC","url":"https://api.github.com/repos/go-gitea/gitea/issues/events/11179705538","actor":{"login":"brechtvl","id":450909,"node_id":"MDQ6VXNlcjQ1MDkwOQ==","avatar_url":"https://avatars.githubusercontent.com/u/450909?v=4","gravatar_id":"","url":"https://api.github.com/users/brechtvl","html_url":"https://github.com/brechtvl","followers_url":"https://api.github.com/users/brechtvl/followers","following_url":"https://api.github.com/users/brechtvl/following{/other_user}","gists_url":"https://api.github.com/users/brechtvl/gists{/gist_id}","starred_url":"https://api.github.com/users/brechtvl/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/brechtvl/subscriptions","organizations_url":"https://api.github.com/users/brechtvl/orgs","repos_url":"https://api.github.com/users/brechtvl/repos","events_url":"https://api.github.com/users/brechtvl/events{/privacy}","received_events_url":"https://api.github.com/users/brechtvl/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"c055e4d16123b98bbd8eacb25a80fdcfdae9a247","commit_url":"https://api.github.com/repos/blender/gitea/commits/c055e4d16123b98bbd8eacb25a80fdcfdae9a247","created_at":"2023-12-07T09:59:34Z","performed_via_github_app":null},{"actor":{"login":"wolfogre","id":9418365,"node_id":"MDQ6VXNlcjk0MTgzNjU=","avatar_url":"https://avatars.githubusercontent.com/u/9418365?v=4","gravatar_id":"","url":"https://api.github.com/users/wolfogre","html_url":"https://github.com/wolfogre","followers_url":"https://api.github.com/users/wolfogre/followers","following_url":"https://api.github.com/users/wolfogre/following{/other_user}","gists_url":"https://api.github.com/users/wolfogre/gists{/gist_id}","starred_url":"https://api.github.com/users/wolfogre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wolfogre/subscriptions","organizations_url":"https://api.github.com/users/wolfogre/orgs","repos_url":"https://api.github.com/users/wolfogre/repos","events_url":"https://api.github.com/users/wolfogre/events{/privacy}","received_events_url":"https://api.github.com/users/wolfogre/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2023-12-07T10:47:16Z","updated_at":"2023-12-07T10:47:16Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/28385","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/28385/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/28385/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/28385/events","html_url":"https://github.com/go-gitea/gitea/pull/28385","id":2030461564,"node_id":"PR_kwDOBFIx285haBLj","number":28385,"title":"Include public repos in doer's dashboard for issue search (#28304)","user":{"login":"wolfogre","id":9418365,"node_id":"MDQ6VXNlcjk0MTgzNjU=","avatar_url":"https://avatars.githubusercontent.com/u/9418365?v=4","gravatar_id":"","url":"https://api.github.com/users/wolfogre","html_url":"https://github.com/wolfogre","followers_url":"https://api.github.com/users/wolfogre/followers","following_url":"https://api.github.com/users/wolfogre/following{/other_user}","gists_url":"https://api.github.com/users/wolfogre/gists{/gist_id}","starred_url":"https://api.github.com/users/wolfogre/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/wolfogre/subscriptions","organizations_url":"https://api.github.com/users/wolfogre/orgs","repos_url":"https://api.github.com/users/wolfogre/repos","events_url":"https://api.github.com/users/wolfogre/events{/privacy}","received_events_url":"https://api.github.com/users/wolfogre/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""},{"id":475283844,"node_id":"MDU6TGFiZWw0NzUyODM4NDQ=","url":"https://api.github.com/repos/go-gitea/gitea/labels/lgtm/need%201","name":"lgtm/need 1","color":"f9d0c4","default":false,"description":"This PR needs approval from one additional maintainer to be merged."},{"id":676182852,"node_id":"MDU6TGFiZWw2NzYxODI4NTI=","url":"https://api.github.com/repos/go-gitea/gitea/labels/pr/breaking","name":"pr/breaking","color":"fbca04","default":false,"description":"Merging this PR means builds will break. Needs a description what exactly breaks, and how to fix it!"}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2023-12-07T10:47:16Z","updated_at":"2024-03-10T16:30:17Z","closed_at":"2023-12-11T05:50:45Z","author_association":"MEMBER","type":null,"active_lock_reason":"resolved","draft":false,"repository":{"id":72495579,"node_id":"MDEwOlJlcG9zaXRvcnk3MjQ5NTU3OQ==","name":"gitea","full_name":"go-gitea/gitea","private":false,"owner":{"login":"go-gitea","id":12724356,"node_id":"MDEyOk9yZ2FuaXphdGlvbjEyNzI0MzU2","avatar_url":"https://avatars.githubusercontent.com/u/12724356?v=4","gravatar_id":"","url":"https://api.github.com/users/go-gitea","html_url":"https://github.com/go-gitea","followers_url":"https://api.github.com/users/go-gitea/followers","following_url":"https://api.github.com/users/go-gitea/following{/other_user}","gists_url":"https://api.github.com/users/go-gitea/gists{/gist_id}","starred_url":"https://api.github.com/users/go-gitea/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/go-gitea/subscriptions","organizations_url":"https://api.github.com/users/go-gitea/orgs","repos_url":"https://api.github.com/users/go-gitea/repos","events_url":"https://api.github.com/users/go-gitea/events{/privacy}","received_events_url":"https://api.github.com/users/go-gitea/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/go-gitea/gitea","description":"Git with a cup of tea! Painless self-hosted all-in-one software development service, including Git hosting, code review, team collaboration, package registry and CI/CD","fork":false,"url":"https://api.github.com/repos/go-gitea/gitea","forks_url":"https://api.github.com/repos/go-gitea/gitea/forks","keys_url":"https://api.github.com/repos/go-gitea/gitea/keys{/key_id}","collaborators_url":"https://api.github.com/repos/go-gitea/gitea/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/go-gitea/gitea/teams","hooks_url":"https://api.github.com/repos/go-gitea/gitea/hooks","issue_events_url":"https://api.github.com/repos/go-gitea/gitea/issues/events{/number}","events_url":"https://api.github.com/repos/go-gitea/gitea/events","assignees_url":"https://api.github.com/repos/go-gitea/gitea/assignees{/user}","branches_url":"https://api.github.com/repos/go-gitea/gitea/branches{/branch}","tags_url":"https://api.github.com/repos/go-gitea/gitea/tags","blobs_url":"https://api.github.com/repos/go-gitea/gitea/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/go-gitea/gitea/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/go-gitea/gitea/git/refs{/sha}","trees_url":"https://api.github.com/repos/go-gitea/gitea/git/trees{/sha}","statuses_url":"https://api.github.com/repos/go-gitea/gitea/statuses/{sha}","languages_url":"https://api.github.com/repos/go-gitea/gitea/languages","stargazers_url":"https://api.github.com/repos/go-gitea/gitea/stargazers","contributors_url":"https://api.github.com/repos/go-gitea/gitea/contributors","subscribers_url":"https://api.github.com/repos/go-gitea/gitea/subscribers","subscription_url":"https://api.github.com/repos/go-gitea/gitea/subscription","commits_url":"https://api.github.com/repos/go-gitea/gitea/commits{/sha}","git_commits_url":"https://api.github.com/repos/go-gitea/gitea/git/commits{/sha}","comments_url":"https://api.github.com/repos/go-gitea/gitea/comments{/number}","issue_comment_url":"https://api.github.com/repos/go-gitea/gitea/issues/comments{/number}","contents_url":"https://api.github.com/repos/go-gitea/gitea/contents/{+path}","compare_url":"https://api.github.com/repos/go-gitea/gitea/compare/{base}...{head}","merges_url":"https://api.github.com/repos/go-gitea/gitea/merges","archive_url":"https://api.github.com/repos/go-gitea/gitea/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/go-gitea/gitea/downloads","issues_url":"https://api.github.com/repos/go-gitea/gitea/issues{/number}","pulls_url":"https://api.github.com/repos/go-gitea/gitea/pulls{/number}","milestones_url":"https://api.github.com/repos/go-gitea/gitea/milestones{/number}","notifications_url":"https://api.github.com/repos/go-gitea/gitea/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/go-gitea/gitea/labels{/name}","releases_url":"https://api.github.com/repos/go-gitea/gitea/releases{/id}","deployments_url":"https://api.github.com/repos/go-gitea/gitea/deployments","created_at":"2016-11-01T02:13:26Z","updated_at":"2025-11-09T22:07:00Z","pushed_at":"2025-11-09T21:54:34Z","git_url":"git://github.com/go-gitea/gitea.git","ssh_url":"git@github.com:go-gitea/gitea.git","clone_url":"https://github.com/go-gitea/gitea.git","svn_url":"https://github.com/go-gitea/gitea","homepage":"https://gitea.com","size":317853,"stargazers_count":51900,"watchers_count":51900,"language":"Go","has_issues":true,"has_projects":false,"has_downloads":true,"has_wiki":false,"has_pages":false,"has_discussions":false,"forks_count":6199,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":2849,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":true,"topics":["bitbucket","cicd","devops","docker-registry-v2","git","git-gui","git-server","gitea","github","github-actions","gitlab","go","golang","hacktoberfest","maven-server","npm-registry","vue"],"visibility":"public","forks":6199,"open_issues":2849,"watchers":51900,"default_branch":"main","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/go-gitea/gitea/pulls/28385","html_url":"https://github.com/go-gitea/gitea/pull/28385","diff_url":"https://github.com/go-gitea/gitea/pull/28385.diff","patch_url":"https://github.com/go-gitea/gitea/pull/28385.patch","merged_at":null},"body":"Backport #28304.\r\n\r\nIt will fix #28268 .\r\n\r\n<img width=\"1313\" alt=\"image\"\r\nsrc=\"https://github.com/go-gitea/gitea/assets/9418365/cb1e07d5-7a12-4691-a054-8278ba255bfc\">\r\n\r\n<img width=\"1318\" alt=\"image\"\r\nsrc=\"https://github.com/go-gitea/gitea/assets/9418365/4fd60820-97f1-4c2c-a233-d3671a5039e9\">\r\n\r\n## :warning: BREAKING :warning:\r\n\r\nBut need to give up some features:\r\n\r\n<img width=\"1312\" alt=\"image\"\r\nsrc=\"https://github.com/go-gitea/gitea/assets/9418365/281c0d51-0e7d-473f-bbed-216e2f645610\">\r\n\r\nHowever, such abandonment may fix #28055 .\r\n\r\nWhen the user switches the dashboard context to an org, it means they want to search issues in the repos that belong to the org. However, when they switch to themselves, it means all repos they can access because they may have created an issue in a public repo that they don't own.\r\n\r\n<img width=\"286\" alt=\"image\"\r\nsrc=\"https://github.com/go-gitea/gitea/assets/9418365/182dcd5b-1c20-4725-93af-96e8dfae5b97\">\r\n\r\nIt's a confusing design. Think about this: What does \"In your repositories\" mean when the user switches to an org? Repos belong to the user or the org?\r\n\r\nWhatever, it has been broken by #26012 and its following PRs. After the PR, it searches for issues in repos that the dashboard context user owns or has been explicitly granted access to, so it causes #28268.\r\n\r\nIt's not really difficult to fix it. Just extend the repo scope to search issues when the dashboard context user is the doer. Since the user may create issues or be mentioned in any public repo, we can just set `AllPublic` to true, which is already supported by indexers. The DB condition will also support it in this PR.\r\n\r\nBut the real difficulty is how to count the search results grouped by repos. It's something like \"search issues with this keyword and those filters, and return the total number and the top results. **Then, group all of them by repo and return the counts of each group.**\"\r\n\r\n<img width=\"314\" alt=\"image\"\r\nsrc=\"https://github.com/go-gitea/gitea/assets/9418365/5206eb20-f8f5-49b9-b45a-1be2fcf679f4\">\r\n\r\nBefore #26012, it was being done in the DB, but it caused the results to be incomplete (see the description of #26012).\r\n\r\nAnd to keep this, #26012 implement it in an inefficient way, just count the issues by repo one by one, so it cannot work when `AllPublic` is true because it's almost impossible to do this for all public repos.\r\n\r\nhttps://github.com/go-gitea/gitea/blob/1bfcdeef4cca0f5509476358e5931c13d37ed1ca/modules/indexer/issues/indexer.go#L318-L338\r\n\r\nWe may can resovle `TODO: use \"group by\" of the indexer engines to implement it`, I'm sure it can be done with Elasticsearch, but IIRC, Bleve and Meilisearch don't support \"group by\".\r\n\r\nAnd the real question is, does it worth it? Why should we need to know the counts grouped by repos?\r\n\r\nLet me show you my search dashboard on gitea.com.\r\n\r\n<img width=\"1304\" alt=\"image\"\r\nsrc=\"https://github.com/go-gitea/gitea/assets/9418365/2bca2d46-6c71-4de1-94cb-0c9af27c62ff\">\r\n\r\nI never think the long repo list helps anything.\r\n\r\nAnd if we agree to abandon it, things will be much easier. That is this PR.\r\n\r\nI know it's important to filter by repos when searching issues. However, it shouldn't be the way we have it now. It could be implemented like this.\r\n\r\n<img width=\"1316\" alt=\"image\"\r\nsrc=\"https://github.com/go-gitea/gitea/assets/9418365/99ee5f21-cbb5-4dfe-914d-cb796cb79fbe\">\r\n\r\nThe indexers support it well now, but it requires some frontend work, which I'm not good at. So, I think someone could help do that in another PR and merge this one to fix the bug first.\r\n\r\nOr please block this PR and help to complete it.\r\n\r\nFinally, \"Switch dashboard context\" is also a design that needs improvement. In my opinion, it can be accomplished by adding filtering conditions instead of \"switching\".\r\n","reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/28385/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/28385/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":11512213477,"node_id":"REFE_lADOBFIx2854HXrhzwAAAAKuLm_l","url":"https://api.github.com/repos/go-gitea/gitea/issues/events/11512213477","actor":{"login":"fuxiaohei","id":2142787,"node_id":"MDQ6VXNlcjIxNDI3ODc=","avatar_url":"https://avatars.githubusercontent.com/u/2142787?v=4","gravatar_id":"","url":"https://api.github.com/users/fuxiaohei","html_url":"https://github.com/fuxiaohei","followers_url":"https://api.github.com/users/fuxiaohei/followers","following_url":"https://api.github.com/users/fuxiaohei/following{/other_user}","gists_url":"https://api.github.com/users/fuxiaohei/gists{/gist_id}","starred_url":"https://api.github.com/users/fuxiaohei/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/fuxiaohei/subscriptions","organizations_url":"https://api.github.com/users/fuxiaohei/orgs","repos_url":"https://api.github.com/users/fuxiaohei/repos","events_url":"https://api.github.com/users/fuxiaohei/events{/privacy}","received_events_url":"https://api.github.com/users/fuxiaohei/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"b59225809aed527037b0ed08d1433be81cde71b2","commit_url":"https://api.github.com/repos/fuxiaohei/gitea/commits/b59225809aed527037b0ed08d1433be81cde71b2","created_at":"2024-01-17T14:31:13Z","performed_via_github_app":null},{"id":11550296495,"node_id":"LOE_lADOBFIx2854HXrhzwAAAAKwc4mv","url":"https://api.github.com/repos/go-gitea/gitea/issues/events/11550296495","actor":{"login":"github-actions[bot]","id":41898282,"node_id":"MDM6Qm90NDE4OTgyODI=","avatar_url":"https://avatars.githubusercontent.com/in/15368?v=4","gravatar_id":"","url":"https://api.github.com/users/github-actions%5Bbot%5D","html_url":"https://github.com/apps/github-actions","followers_url":"https://api.github.com/users/github-actions%5Bbot%5D/followers","following_url":"https://api.github.com/users/github-actions%5Bbot%5D/following{/other_user}","gists_url":"https://api.github.com/users/github-actions%5Bbot%5D/gists{/gist_id}","starred_url":"https://api.github.com/users/github-actions%5Bbot%5D/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/github-actions%5Bbot%5D/subscriptions","organizations_url":"https://api.github.com/users/github-actions%5Bbot%5D/orgs","repos_url":"https://api.github.com/users/github-actions%5Bbot%5D/repos","events_url":"https://api.github.com/users/github-actions%5Bbot%5D/events{/privacy}","received_events_url":"https://api.github.com/users/github-actions%5Bbot%5D/received_events","type":"Bot","user_view_type":"public","site_admin":false},"event":"locked","commit_id":null,"commit_url":null,"created_at":"2024-01-22T00:01:23Z","lock_reason":"resolved","performed_via_github_app":null},{"id":11865886531,"node_id":"REFE_lADOBFIx2854HXrhzwAAAALDQw9D","url":"https://api.github.com/repos/go-gitea/gitea/issues/events/11865886531","actor":{"login":"silverwind","id":115237,"node_id":"MDQ6VXNlcjExNTIzNw==","avatar_url":"https://avatars.githubusercontent.com/u/115237?v=4","gravatar_id":"","url":"https://api.github.com/users/silverwind","html_url":"https://github.com/silverwind","followers_url":"https://api.github.com/users/silverwind/followers","following_url":"https://api.github.com/users/silverwind/following{/other_user}","gists_url":"https://api.github.com/users/silverwind/gists{/gist_id}","starred_url":"https://api.github.com/users/silverwind/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/silverwind/subscriptions","organizations_url":"https://api.github.com/users/silverwind/orgs","repos_url":"https://api.github.com/users/silverwind/repos","events_url":"https://api.github.com/users/silverwind/events{/privacy}","received_events_url":"https://api.github.com/users/silverwind/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"d9d75936cd3de5e0a63824c7fa048e41b6e8d39e","commit_url":"https://api.github.com/repos/silverwind/gitea/commits/d9d75936cd3de5e0a63824c7fa048e41b6e8d39e","created_at":"2024-02-20T18:35:00Z","performed_via_github_app":null}]