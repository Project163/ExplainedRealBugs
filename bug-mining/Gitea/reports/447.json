{"url":"https://api.github.com/repos/go-gitea/gitea/issues/32782","repository_url":"https://api.github.com/repos/go-gitea/gitea","labels_url":"https://api.github.com/repos/go-gitea/gitea/issues/32782/labels{/name}","comments_url":"https://api.github.com/repos/go-gitea/gitea/issues/32782/comments","events_url":"https://api.github.com/repos/go-gitea/gitea/issues/32782/events","html_url":"https://github.com/go-gitea/gitea/issues/32782","id":2730445398,"node_id":"I_kwDOBFIx286iv0pW","number":32782,"title":"R CRAN package registry not working when requesting archived packages","user":{"login":"Sebastian-T-T","id":109338575,"node_id":"U_kgDOBoRfzw","avatar_url":"https://avatars.githubusercontent.com/u/109338575?v=4","gravatar_id":"","url":"https://api.github.com/users/Sebastian-T-T","html_url":"https://github.com/Sebastian-T-T","followers_url":"https://api.github.com/users/Sebastian-T-T/followers","following_url":"https://api.github.com/users/Sebastian-T-T/following{/other_user}","gists_url":"https://api.github.com/users/Sebastian-T-T/gists{/gist_id}","starred_url":"https://api.github.com/users/Sebastian-T-T/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sebastian-T-T/subscriptions","organizations_url":"https://api.github.com/users/Sebastian-T-T/orgs","repos_url":"https://api.github.com/users/Sebastian-T-T/repos","events_url":"https://api.github.com/users/Sebastian-T-T/events{/privacy}","received_events_url":"https://api.github.com/users/Sebastian-T-T/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":472744938,"node_id":"MDU6TGFiZWw0NzI3NDQ5Mzg=","url":"https://api.github.com/repos/go-gitea/gitea/labels/type/bug","name":"type/bug","color":"ee0701","default":false,"description":""}],"state":"closed","locked":true,"assignee":null,"assignees":[],"milestone":null,"comments":0,"created_at":"2024-12-10T15:24:58Z","updated_at":"2025-03-11T16:52:01Z","closed_at":"2024-12-11T16:20:05Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":"resolved","sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Description\r\n\r\nR package managers expects the newest package URL to be available at the base path and all older versions to be available in a specific /Archive/package path of the package registry.\r\n\r\nCurrently Gitea CRAN support for R packages stores all packages in the base path, causing R package manager to not being able to find older versions of packages.\r\n\r\nExample:\r\nI upload two versions of my R package \"giteaR\" to Gitea under an Organization called \"R-packages\", version 1.0.0 and 1.0.1, these are now available at:\r\nhttps://gitea.url/api/packages/R-packages/cran/src/contrib/giteaR_1.0.0.tar.gz\r\nhttps://gitea.url/api/packages/R-packages/cran/src/contrib/giteaR_1.0.1.tar.gz\r\n\r\nHowever my R package manager (either base, renv or packrat) expects them to be located at:\r\nhttps://gitea.url/api/packages/R-packages/cran/src/contrib/Archive/giteaR/giteaR_1.0.0.tar.gz\r\nhttps://gitea.url/api/packages/R-packages/cran/src/contrib/giteaR_1.0.1.tar.gz\r\n\r\nThe same structure is visible in the official R CRAN respository.\r\nExample for the ggplot2 package:\r\nNewest (as of this issue report): https://cran.r-project.org/src/contrib/ggplot2_3.5.1.tar.gz\r\nVersion before that: https://cran.r-project.org/src/contrib/Archive/ggplot2/ggplot2_3.5.0.tar.gz\r\n\r\nThe above is only true for source package builds and not for binaries. CRAN doesn't keep binaries for older versions of packages nor does it keep them for Archived packages.\r\n\r\nSuggested solution is to keep the current Gitea behavior as-is and add a new Get router which adds support for the /Archive/package path.\r\n\r\n### Gitea Version\r\n\r\n1.21\r\n\r\n### Can you reproduce the bug on the Gitea demo site?\r\n\r\nYes\r\n\r\n### Log Gist\r\n\r\n_No response_\r\n\r\n### Screenshots\r\n\r\n_No response_\r\n\r\n### Git Version\r\n\r\n_No response_\r\n\r\n### Operating System\r\n\r\n_No response_\r\n\r\n### How are you running Gitea?\r\n\r\nWe are running Gitea via a systemd service on Ubuntu\r\n\r\n### Database\r\n\r\nNone","closed_by":{"login":"lunny","id":81045,"node_id":"MDQ6VXNlcjgxMDQ1","avatar_url":"https://avatars.githubusercontent.com/u/81045?v=4","gravatar_id":"","url":"https://api.github.com/users/lunny","html_url":"https://github.com/lunny","followers_url":"https://api.github.com/users/lunny/followers","following_url":"https://api.github.com/users/lunny/following{/other_user}","gists_url":"https://api.github.com/users/lunny/gists{/gist_id}","starred_url":"https://api.github.com/users/lunny/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/lunny/subscriptions","organizations_url":"https://api.github.com/users/lunny/orgs","repos_url":"https://api.github.com/users/lunny/repos","events_url":"https://api.github.com/users/lunny/events{/privacy}","received_events_url":"https://api.github.com/users/lunny/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/go-gitea/gitea/issues/32782/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/go-gitea/gitea/issues/32782/timeline","performed_via_github_app":null,"state_reason":"completed"}