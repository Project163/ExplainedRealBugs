{"url":"https://api.github.com/repos/glfw/glfw/issues/1872","repository_url":"https://api.github.com/repos/glfw/glfw","labels_url":"https://api.github.com/repos/glfw/glfw/issues/1872/labels{/name}","comments_url":"https://api.github.com/repos/glfw/glfw/issues/1872/comments","events_url":"https://api.github.com/repos/glfw/glfw/issues/1872/events","html_url":"https://github.com/glfw/glfw/issues/1872","id":842403553,"node_id":"MDU6SXNzdWU4NDI0MDM1NTM=","number":1872,"title":"CPU spike bug in glfwWaitEvents on Linux","user":{"login":"Sonicadvance1","id":1018829,"node_id":"MDQ6VXNlcjEwMTg4Mjk=","avatar_url":"https://avatars.githubusercontent.com/u/1018829?v=4","gravatar_id":"","url":"https://api.github.com/users/Sonicadvance1","html_url":"https://github.com/Sonicadvance1","followers_url":"https://api.github.com/users/Sonicadvance1/followers","following_url":"https://api.github.com/users/Sonicadvance1/following{/other_user}","gists_url":"https://api.github.com/users/Sonicadvance1/gists{/gist_id}","starred_url":"https://api.github.com/users/Sonicadvance1/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Sonicadvance1/subscriptions","organizations_url":"https://api.github.com/users/Sonicadvance1/orgs","repos_url":"https://api.github.com/users/Sonicadvance1/repos","events_url":"https://api.github.com/users/Sonicadvance1/events{/privacy}","received_events_url":"https://api.github.com/users/Sonicadvance1/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":36425440,"node_id":"MDU6TGFiZWwzNjQyNTQ0MA==","url":"https://api.github.com/repos/glfw/glfw/labels/bug","name":"bug","color":"b60205","default":true,"description":"Bug reports and bugfix pull requests"},{"id":37361231,"node_id":"MDU6TGFiZWwzNzM2MTIzMQ==","url":"https://api.github.com/repos/glfw/glfw/labels/X11","name":"X11","color":"3b80ae","default":false,"description":null},{"id":37364584,"node_id":"MDU6TGFiZWwzNzM2NDU4NA==","url":"https://api.github.com/repos/glfw/glfw/labels/verified","name":"verified","color":"0e8a16","default":false,"description":"Reproduced or otherwise verified bugs"}],"state":"closed","locked":false,"assignee":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/glfw/glfw/milestones/21","html_url":"https://github.com/glfw/glfw/milestone/21","labels_url":"https://api.github.com/repos/glfw/glfw/milestones/21/labels","id":7448663,"node_id":"MI_kwDOAJFXBc4AcahX","number":21,"title":"3.3.7","description":"","creator":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":26,"state":"closed","created_at":"2021-12-01T20:57:27Z","updated_at":"2024-02-05T14:25:36Z","due_on":null,"closed_at":"2022-03-20T21:22:51Z"},"comments":1,"created_at":"2021-03-27T03:18:47Z","updated_at":"2022-03-03T22:57:25Z","closed_at":"2022-03-03T22:57:24Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"https://github.com/glfw/glfw/blob/33cd8b865d9289cfbcf3d95e6e68e4050b94fcd3/src/x11_window.c#L2813\r\n\r\nThis function (which gets called from glfwWaitEvents) on Linux has a bug in it that causes an infinite loop, spiking to 100% CPU utilization.\r\n\r\nThe problem comes down to `waitForEvent(NULL);` testing two FDs for events\r\nFirst event is from `ConnectionNumber(_glfw.x11.display);`\r\nSecond event is from inotify `FD_SET(_glfw.linjs.inotify, &fds);`\r\n\r\nIn the case of an inotify event and NOT an X11 display event then the while loop condition `while (!XPending(_glfw.x11.display))` Will cause an infinite loop where `waitForEvent` ALWAYS immediately returns because there is an inotify event.\r\nThere is no XPending event so it'll loop again to try and find an X11 event.\r\ninotify event hasn't been handled so it'll return immediately again.\r\nThus consuming 100% CPU.\r\n\r\nA likely fix is to either handle or drop the joystick event. I'm not very familiar with the internals of glfw to know what would be correct here.","closed_by":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/glfw/glfw/issues/1872/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/glfw/glfw/issues/1872/timeline","performed_via_github_app":null,"state_reason":"completed"}