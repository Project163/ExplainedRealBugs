{"url":"https://api.github.com/repos/glfw/glfw/issues/800","repository_url":"https://api.github.com/repos/glfw/glfw","labels_url":"https://api.github.com/repos/glfw/glfw/issues/800/labels{/name}","comments_url":"https://api.github.com/repos/glfw/glfw/issues/800/comments","events_url":"https://api.github.com/repos/glfw/glfw/issues/800/events","html_url":"https://github.com/glfw/glfw/issues/800","id":162766702,"node_id":"MDU6SXNzdWUxNjI3NjY3MDI=","number":800,"title":"glfwGetWindowPos and glfwSetWindowPos do not ignore decorations","user":{"login":"notverymoe","id":5101853,"node_id":"MDQ6VXNlcjUxMDE4NTM=","avatar_url":"https://avatars.githubusercontent.com/u/5101853?v=4","gravatar_id":"","url":"https://api.github.com/users/notverymoe","html_url":"https://github.com/notverymoe","followers_url":"https://api.github.com/users/notverymoe/followers","following_url":"https://api.github.com/users/notverymoe/following{/other_user}","gists_url":"https://api.github.com/users/notverymoe/gists{/gist_id}","starred_url":"https://api.github.com/users/notverymoe/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/notverymoe/subscriptions","organizations_url":"https://api.github.com/users/notverymoe/orgs","repos_url":"https://api.github.com/users/notverymoe/repos","events_url":"https://api.github.com/users/notverymoe/events{/privacy}","received_events_url":"https://api.github.com/users/notverymoe/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":36425440,"node_id":"MDU6TGFiZWwzNjQyNTQ0MA==","url":"https://api.github.com/repos/glfw/glfw/labels/bug","name":"bug","color":"b60205","default":true,"description":"Bug reports and bugfix pull requests"},{"id":37361231,"node_id":"MDU6TGFiZWwzNzM2MTIzMQ==","url":"https://api.github.com/repos/glfw/glfw/labels/X11","name":"X11","color":"3b80ae","default":false,"description":null},{"id":37364584,"node_id":"MDU6TGFiZWwzNzM2NDU4NA==","url":"https://api.github.com/repos/glfw/glfw/labels/verified","name":"verified","color":"0e8a16","default":false,"description":"Reproduced or otherwise verified bugs"}],"state":"closed","locked":false,"assignee":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/glfw/glfw/milestones/14","html_url":"https://github.com/glfw/glfw/milestone/14","labels_url":"https://api.github.com/repos/glfw/glfw/milestones/14/labels","id":1879452,"node_id":"MDk6TWlsZXN0b25lMTg3OTQ1Mg==","number":14,"title":"3.2.1","description":"","creator":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":28,"state":"closed","created_at":"2016-07-12T20:20:41Z","updated_at":"2022-03-17T16:05:29Z","due_on":null,"closed_at":"2016-09-13T10:40:24Z"},"comments":8,"created_at":"2016-06-28T19:30:00Z","updated_at":"2016-08-17T14:27:57Z","closed_at":"2016-08-17T14:27:56Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"It appears that the either the window position callback or the glfwGetWindowPos/glfwSetWindowPos are not using the correct/same reference point. As the values provided by the callback and the glfwGetWindowPos are consistantly out by the size of my window decorations.\n\nI confirmed this by performing a test where I create a window and set the position callback.\nIn the position callback I store the values that are passed in and then setting the window's position to them in the main update loop.\nThis results in the window jumping, normally when I drag the window.\nHowever, if in the callback I store the values provided by glfwGetWindowPos then the window remains static and correctly moves when I drag the window.\n\nIn my case the values were different by -4 x and -18 y relative to the callback's values.\n\nThis suggests that the callback is providing client-area positions and glfwGetWindowPos/glfwSetWindowPos are operating on window cordinates. This is further suggested by setting the window position so that x = 0, this results in the window decoration's edge touching the side rather than the client area. Setting the position to x = -4 causes the client area's edge to line up with the edge of the screen instead. Lastly looking at the documentation for the XMoveWindow function, it says that x and y \"define the new location of the top-left pixel of the window's border or the window itself if it has no border.\" and (atleast in the __glfwPlatformSetWindowPos function) the coordinates aren't translated from the client-area to include the window decorations.\n\nIt appears that the callback provides client-area positions while glfwGetWindowPos/glfwSetWindowPos are operating on the window+decoration positio\nns. This is further suggested by setting the window's x position to 0 which results in the border of the window being flush with the edge of the screen, in this case the callback provides the value 4 for x indiciating that the client-area's x isn't at the edge of the screen, while glfwGetWindowPos reports that x is at 0. Forcing the window's x position to -4 results in the client area being flush with the screen's edge, the callback reporting 0 and the glfwGetWindowPos reporting -4. \n\nThe documentation for XMoveWindow also states that x and y \"define the new location of the top-left pixel of the window's border or the window itself if it has no border\" so I attempted changing the __glfwPlatformSetWindowPos function in x11_window.c like so:\n\n```\nXWindowAttributes xwa;\nXGetWindowAttributes(_glfw.x11.display, window->x11.handle, &xwa);\n\nXMoveWindow(_glfw.x11.display, window->x11.handle, xpos - xwa.x, ypos - xwa.y);\nXFlush(_glfw.x11.display);\n```\n\nThis causes the window position provided by the callback to work correctly, but in turn causes the values provided by glfwGetWindowPos to make the window jump around as one would expect. A similar modification should work for the get function as well, I believe. It also fixes setting the window's x-coordinate to 0 so that the client area is flush with the edge of the screen. I'm not 100% certain that the modification I made is technically correct, as I'm unaware how X11 operates.\n\nI also don't currently have another linux distribution set-up or an alternative window manager set-up currently so I'm not sure where the problem acutally lies. \n\nI'm running Arch Linux 4.6.2-1 x86_64 with Xfce 4.12 + xfwm 4.12.3\nI've observed this behavour with the current master branch (commit: 49f429018e5ef50db730439132a443c0bb1967e7)\n\nIf you need any more information, a test program or maybe a video just ask and I'll get right on it. \n\nPS: Sorry if it's a bit rambly / filled with spelling errors. It's pretty late at night right now and I wanted to get this all down and post the bug report before I forgot.\n","closed_by":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/glfw/glfw/issues/800/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/glfw/glfw/issues/800/timeline","performed_via_github_app":null,"state_reason":"completed"}