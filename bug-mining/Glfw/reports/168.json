{"url":"https://api.github.com/repos/glfw/glfw/issues/784","repository_url":"https://api.github.com/repos/glfw/glfw","labels_url":"https://api.github.com/repos/glfw/glfw/issues/784/labels{/name}","comments_url":"https://api.github.com/repos/glfw/glfw/issues/784/comments","events_url":"https://api.github.com/repos/glfw/glfw/issues/784/events","html_url":"https://github.com/glfw/glfw/issues/784","id":159961262,"node_id":"MDU6SXNzdWUxNTk5NjEyNjI=","number":784,"title":"Monitor callback never fired","user":{"login":"spettroscopio","id":19908595,"node_id":"MDQ6VXNlcjE5OTA4NTk1","avatar_url":"https://avatars.githubusercontent.com/u/19908595?v=4","gravatar_id":"","url":"https://api.github.com/users/spettroscopio","html_url":"https://github.com/spettroscopio","followers_url":"https://api.github.com/users/spettroscopio/followers","following_url":"https://api.github.com/users/spettroscopio/following{/other_user}","gists_url":"https://api.github.com/users/spettroscopio/gists{/gist_id}","starred_url":"https://api.github.com/users/spettroscopio/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/spettroscopio/subscriptions","organizations_url":"https://api.github.com/users/spettroscopio/orgs","repos_url":"https://api.github.com/users/spettroscopio/repos","events_url":"https://api.github.com/users/spettroscopio/events{/privacy}","received_events_url":"https://api.github.com/users/spettroscopio/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":36425440,"node_id":"MDU6TGFiZWwzNjQyNTQ0MA==","url":"https://api.github.com/repos/glfw/glfw/labels/bug","name":"bug","color":"b60205","default":true,"description":"Bug reports and bugfix pull requests"},{"id":37361218,"node_id":"MDU6TGFiZWwzNzM2MTIxOA==","url":"https://api.github.com/repos/glfw/glfw/labels/Windows","name":"Windows","color":"0078d6","default":false,"description":"Win32 specific (not Cygwin or WSL)"},{"id":37364584,"node_id":"MDU6TGFiZWwzNzM2NDU4NA==","url":"https://api.github.com/repos/glfw/glfw/labels/verified","name":"verified","color":"0e8a16","default":false,"description":"Reproduced or otherwise verified bugs"}],"state":"closed","locked":false,"assignee":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/glfw/glfw/milestones/12","html_url":"https://github.com/glfw/glfw/milestone/12","labels_url":"https://api.github.com/repos/glfw/glfw/milestones/12/labels","id":1586124,"node_id":"MDk6TWlsZXN0b25lMTU4NjEyNA==","number":12,"title":"3.3","description":"","creator":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":0,"closed_issues":266,"state":"closed","created_at":"2016-02-16T16:04:47Z","updated_at":"2019-07-21T23:55:22Z","due_on":null,"closed_at":"2019-04-16T00:42:23Z"},"comments":3,"created_at":"2016-06-13T14:18:47Z","updated_at":"2017-03-14T18:51:09Z","closed_at":"2017-03-14T18:44:17Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"The monitor callback set with glfwSetMonitorCallback() is never fired on my system.\n\nI have a nVidia GTX970 with 353.06 drivers on Win 7 x64.\n\nI'm using the latest stable version of glfw, 3.2.\n\n```\n3.2.0 Win32 WGL EGL MinGW DLL\nNVIDIA Corporation\nGeForce GTX 970/PCIe/SSE2\n4.5.0 NVIDIA 353.06\n```\n\nRunning the test program events.c, I tried to enable/disable a second monitor from the nVidia control panel, the monitor is attached/removed as expected to/from the OS but no event is fired in the events test program.\n\nI also tried to physically connect/disconnect the monitor from the graphic card, still the same.\n\nI also tried to manually call glfwGetMonitors() from my own code (by pressing a function key) after I attached/detached the second monitor, but the list of reported monitors is not updated and it's the one detected at the moment the program was launched.\n\nI have to exit the program and relaunch it to make glfwGetMonitors() aware of the changed configuration.\n\nAlso I tried in a simple API program with a single window, to see what messages were sent to the window.\nIn winproc I'm testing for WM_DEVICECHANGE and WM_DISPLAYCHANGE\n\nI get a WM_DEVICECHANGE when I connect/disconnect a USB joystick\nI get a WM_DISPLAYCHANGE when I add/remove a monitor in the nVidia control panel, but no WM_DEVICECHANGE\n\nIn my case, to make all work I had to change windowProc() in win32_windows.c adding WM_DISPLAYCHANGE to the second switch(), the one associated to the MAIN window (not the helper one).\n\n```\nswitch (uMsg)\n    {\n    ...\n    }\n\nswitch (uMsg)\n    {\n        // start\n        case WM_DISPLAYCHANGE:\n        {        \n            _glfwInputMonitorChange();\n            return 0;\n        }\n        // end\n\n        case WM_SETFOCUS:\n       ...\n       etc\n       ...\n```\n\nThis way the callback work for bot attacth and detach and the monitor list has been refreshed when I call glfwGetMonitors()\n\nUser @dougbinks reports \n\n> I've just tested this and on my Windows 8.1 system with Radeon drivers and latest GLFW 3.2 from Github I get the same as you.\n> Investigating further it appears the WM_DEVICECHANGE message is being sent with a valid window on my system, so copying the code for device change (testing DBT_DEVNODES_CHANGED only) outside the if(!window) and in the second switch works for me.\n\nSo his modification is different:\n\n```\nswitch (uMsg)\n    {\n    ...\n    }\n\nswitch (uMsg)\n    {       \n        // start\n        case WM_DEVICECHANGE:\n        {\n            if (wParam == DBT_DEVNODES_CHANGED)\n            {\n                _glfwInputMonitorChange();\n                return TRUE;\n            }\n        }\n        // end\n\n        case WM_SETFOCUS:           \n       ...\n       etc\n       ...\n```\n\nThe above works for him, but NOT for me.\n\nThe original thread in the forum is here -> http://discourse.glfw.org/t/monitor-callback-never-fired/678/1\n\nThank you\n","closed_by":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/glfw/glfw/issues/784/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/glfw/glfw/issues/784/timeline","performed_via_github_app":null,"state_reason":"completed"}