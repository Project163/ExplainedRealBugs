{"url":"https://api.github.com/repos/glfw/glfw/issues/2741","repository_url":"https://api.github.com/repos/glfw/glfw","labels_url":"https://api.github.com/repos/glfw/glfw/issues/2741/labels{/name}","comments_url":"https://api.github.com/repos/glfw/glfw/issues/2741/comments","events_url":"https://api.github.com/repos/glfw/glfw/issues/2741/events","html_url":"https://github.com/glfw/glfw/issues/2741","id":3235471975,"node_id":"I_kwDOAJFXBc7A2WJn","number":2741,"title":"Wayland: key repeat timer not reset when window destroyed","user":{"login":"dougbinks","id":872946,"node_id":"MDQ6VXNlcjg3Mjk0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/872946?v=4","gravatar_id":"","url":"https://api.github.com/users/dougbinks","html_url":"https://github.com/dougbinks","followers_url":"https://api.github.com/users/dougbinks/followers","following_url":"https://api.github.com/users/dougbinks/following{/other_user}","gists_url":"https://api.github.com/users/dougbinks/gists{/gist_id}","starred_url":"https://api.github.com/users/dougbinks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dougbinks/subscriptions","organizations_url":"https://api.github.com/users/dougbinks/orgs","repos_url":"https://api.github.com/users/dougbinks/repos","events_url":"https://api.github.com/users/dougbinks/events{/privacy}","received_events_url":"https://api.github.com/users/dougbinks/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":36425440,"node_id":"MDU6TGFiZWwzNjQyNTQ0MA==","url":"https://api.github.com/repos/glfw/glfw/labels/bug","name":"bug","color":"b60205","default":true,"description":"Bug reports and bugfix pull requests"},{"id":89092389,"node_id":"MDU6TGFiZWw4OTA5MjM4OQ==","url":"https://api.github.com/repos/glfw/glfw/labels/Wayland","name":"Wayland","color":"ffbc00","default":false,"description":""},{"id":1572895686,"node_id":"MDU6TGFiZWwxNTcyODk1Njg2","url":"https://api.github.com/repos/glfw/glfw/labels/input","name":"input","color":"d4c5f9","default":false,"description":"Keyboard, joystick or mouse"}],"state":"closed","locked":false,"assignee":{"login":"dougbinks","id":872946,"node_id":"MDQ6VXNlcjg3Mjk0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/872946?v=4","gravatar_id":"","url":"https://api.github.com/users/dougbinks","html_url":"https://github.com/dougbinks","followers_url":"https://api.github.com/users/dougbinks/followers","following_url":"https://api.github.com/users/dougbinks/following{/other_user}","gists_url":"https://api.github.com/users/dougbinks/gists{/gist_id}","starred_url":"https://api.github.com/users/dougbinks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dougbinks/subscriptions","organizations_url":"https://api.github.com/users/dougbinks/orgs","repos_url":"https://api.github.com/users/dougbinks/repos","events_url":"https://api.github.com/users/dougbinks/events{/privacy}","received_events_url":"https://api.github.com/users/dougbinks/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"dougbinks","id":872946,"node_id":"MDQ6VXNlcjg3Mjk0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/872946?v=4","gravatar_id":"","url":"https://api.github.com/users/dougbinks","html_url":"https://github.com/dougbinks","followers_url":"https://api.github.com/users/dougbinks/followers","following_url":"https://api.github.com/users/dougbinks/following{/other_user}","gists_url":"https://api.github.com/users/dougbinks/gists{/gist_id}","starred_url":"https://api.github.com/users/dougbinks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dougbinks/subscriptions","organizations_url":"https://api.github.com/users/dougbinks/orgs","repos_url":"https://api.github.com/users/dougbinks/repos","events_url":"https://api.github.com/users/dougbinks/events{/privacy}","received_events_url":"https://api.github.com/users/dougbinks/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":null,"comments":0,"created_at":"2025-07-16T10:58:08Z","updated_at":"2025-07-17T15:24:21Z","closed_at":"2025-07-17T15:24:21Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"Wayland requires clients (applications) to handle keyboard repeat events themselves. The GLFW implementation does so during the event loop, however the current implementation does not reset the key repeat timer when a window is destroyed.\n\nThis looks like the actual likely cause of issue #2727 with a workaround fix in merged PR #2732 which ignores repeats when no window has focus. This could result in lost events and potentially an application with multiple GLFW windows receiving key repeat events to the wrong window.\n\nThis is related to #2736.\n\nTo observe this issue I used a version of GLFW prior to PR #2732 and altered `events.c` to create 2 windows, added a `sleep(1)` in the loop and auto-closed the first window after 10 seconds. Running this and clicking on the first window to appear to get keyboard focus and then holding down a key will result in key repeat events followed by an assert:\n\n```\n000002b7 to 1 at 12.183: Key 0x0044 (D) Scancode 0x0020 Name d (with no mods) was repeated\n000002b8 to 1 at 12.183: Character 0x00000064 (d) input\n000002b9 to 1 at 12.183: Key 0x0044 (D) Scancode 0x0020 Name d (with no mods) was repeated\n000002ba to 1 at 12.183: Character 0x00000064 (d) input\n000002bb to 1 at 12.183: Key 0x0044 (D) Scancode 0x0020 Name d (with no mods) was repeated\n000002bc to 1 at 12.183: Character 0x00000064 (d) input\nevents: /redacted/glfw/src/input.c:274: _glfwInputKey: Assertion `window != NULL' failed.\ndddddddAborted (core dumped)\n```\n\nI am currently working on a fix for this issue.","closed_by":{"login":"dougbinks","id":872946,"node_id":"MDQ6VXNlcjg3Mjk0Ng==","avatar_url":"https://avatars.githubusercontent.com/u/872946?v=4","gravatar_id":"","url":"https://api.github.com/users/dougbinks","html_url":"https://github.com/dougbinks","followers_url":"https://api.github.com/users/dougbinks/followers","following_url":"https://api.github.com/users/dougbinks/following{/other_user}","gists_url":"https://api.github.com/users/dougbinks/gists{/gist_id}","starred_url":"https://api.github.com/users/dougbinks/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dougbinks/subscriptions","organizations_url":"https://api.github.com/users/dougbinks/orgs","repos_url":"https://api.github.com/users/dougbinks/repos","events_url":"https://api.github.com/users/dougbinks/events{/privacy}","received_events_url":"https://api.github.com/users/dougbinks/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/glfw/glfw/issues/2741/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/glfw/glfw/issues/2741/timeline","performed_via_github_app":null,"state_reason":"completed"}