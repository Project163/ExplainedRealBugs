{"url":"https://api.github.com/repos/glfw/glfw/issues/2517","repository_url":"https://api.github.com/repos/glfw/glfw","labels_url":"https://api.github.com/repos/glfw/glfw/issues/2517/labels{/name}","comments_url":"https://api.github.com/repos/glfw/glfw/issues/2517/comments","events_url":"https://api.github.com/repos/glfw/glfw/issues/2517/events","html_url":"https://github.com/glfw/glfw/issues/2517","id":2204604418,"node_id":"I_kwDOAJFXBc6DZ5gC","number":2517,"title":"glfwInit segfaults on headless weston","user":{"login":"jcowgill","id":1226825,"node_id":"MDQ6VXNlcjEyMjY4MjU=","avatar_url":"https://avatars.githubusercontent.com/u/1226825?v=4","gravatar_id":"","url":"https://api.github.com/users/jcowgill","html_url":"https://github.com/jcowgill","followers_url":"https://api.github.com/users/jcowgill/followers","following_url":"https://api.github.com/users/jcowgill/following{/other_user}","gists_url":"https://api.github.com/users/jcowgill/gists{/gist_id}","starred_url":"https://api.github.com/users/jcowgill/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/jcowgill/subscriptions","organizations_url":"https://api.github.com/users/jcowgill/orgs","repos_url":"https://api.github.com/users/jcowgill/repos","events_url":"https://api.github.com/users/jcowgill/events{/privacy}","received_events_url":"https://api.github.com/users/jcowgill/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":36425440,"node_id":"MDU6TGFiZWwzNjQyNTQ0MA==","url":"https://api.github.com/repos/glfw/glfw/labels/bug","name":"bug","color":"b60205","default":true,"description":"Bug reports and bugfix pull requests"},{"id":37364584,"node_id":"MDU6TGFiZWwzNzM2NDU4NA==","url":"https://api.github.com/repos/glfw/glfw/labels/verified","name":"verified","color":"0e8a16","default":false,"description":"Reproduced or otherwise verified bugs"},{"id":89092389,"node_id":"MDU6TGFiZWw4OTA5MjM4OQ==","url":"https://api.github.com/repos/glfw/glfw/labels/Wayland","name":"Wayland","color":"ffbc00","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/glfw/glfw/milestones/27","html_url":"https://github.com/glfw/glfw/milestone/27","labels_url":"https://api.github.com/repos/glfw/glfw/milestones/27/labels","id":10751495,"node_id":"MI_kwDOAJFXBc4ApA4H","number":27,"title":"3.4.1","description":"","creator":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":2,"closed_issues":13,"state":"open","created_at":"2024-03-29T14:37:50Z","updated_at":"2025-08-20T19:11:26Z","due_on":null,"closed_at":null},"comments":1,"created_at":"2024-03-24T23:03:16Z","updated_at":"2024-03-29T14:37:58Z","closed_at":"2024-03-29T14:36:35Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"I tried to run GLFW with Weston in headless mode (I was trying to do this for some CI testing) but it segfaults.\r\n\r\nOS and version: Debian unstable\r\nRelease or commit: 3.4\r\nError messages: Nothing is printed\r\n\r\n```\r\n$ weston --no-config --backends headless &\r\n[22:33:07.368] weston 13.0.0\r\n               https://wayland.freedesktop.org\r\n               Bug reports to: https://gitlab.freedesktop.org/wayland/weston/issues/\r\n               Build: 13.0.0\r\n[22:33:07.368] Command line: weston --no-config --backends headless\r\n[22:33:07.368] OS: Linux, 6.7.9-amd64, #1 SMP PREEMPT_DYNAMIC Debian 6.7.9-2 (2024-03-13), x86_64\r\n...\r\n$ WAYLAND_DEBUG=client XDG_SESSION_TYPE=wayland WAYLAND_DISPLAY=wayland-1 gdb tests/glfwinfo\r\n...\r\n(gdb) r\r\n[3858817.306]  -> wl_display@1.get_registry(new id wl_registry@2)\r\n[3858817.424]  -> wl_display@1.sync(new id wl_callback@3)\r\n[3858817.603] wl_display@1.delete_id(3)\r\n[3858817.627] wl_registry@2.global(1, \"wl_compositor\", 5)\r\n[3858817.643]  -> wl_registry@2.bind(1, \"wl_compositor\", 3, new id [unknown]@4)\r\n[3858817.660] wl_registry@2.global(2, \"wl_subcompositor\", 1)\r\n[3858817.672]  -> wl_registry@2.bind(2, \"wl_subcompositor\", 1, new id [unknown]@5)\r\n[3858817.687] wl_registry@2.global(3, \"wp_viewporter\", 1)\r\n[3858817.704]  -> wl_registry@2.bind(3, \"wp_viewporter\", 1, new id [unknown]@6)\r\n[3858817.718] wl_registry@2.global(4, \"zxdg_output_manager_v1\", 2)\r\n[3858817.733] wl_registry@2.global(5, \"wp_presentation\", 1)\r\n[3858817.746] wl_registry@2.global(6, \"wp_single_pixel_buffer_manager_v1\", 1)\r\n[3858817.760] wl_registry@2.global(7, \"wp_tearing_control_manager_v1\", 1)\r\n[3858817.775] wl_registry@2.global(8, \"zwp_relative_pointer_manager_v1\", 1)\r\n[3858817.789]  -> wl_registry@2.bind(8, \"zwp_relative_pointer_manager_v1\", 1, new id [unknown]@7)\r\n[3858817.803] wl_registry@2.global(9, \"zwp_pointer_constraints_v1\", 1)\r\n[3858817.825]  -> wl_registry@2.bind(9, \"zwp_pointer_constraints_v1\", 1, new id [unknown]@8)\r\n[3858817.839] wl_registry@2.global(10, \"zwp_input_timestamps_manager_v1\", 1)\r\n[3858817.853] wl_registry@2.global(11, \"weston_capture_v1\", 1)\r\n[3858817.868] wl_registry@2.global(12, \"wl_data_device_manager\", 3)\r\n[3858817.882]  -> wl_registry@2.bind(12, \"wl_data_device_manager\", 1, new id [unknown]@9)\r\n[3858817.896] wl_registry@2.global(13, \"wl_shm\", 1)\r\n[3858817.911]  -> wl_registry@2.bind(13, \"wl_shm\", 1, new id [unknown]@10)\r\n[3858817.925] wl_registry@2.global(14, \"zwp_linux_explicit_synchronization_v1\", 2)\r\n[3858817.939] wl_registry@2.global(15, \"wl_output\", 4)\r\n[3858817.953]  -> wl_registry@2.bind(15, \"wl_output\", 4, new id [unknown]@11)\r\n[3858817.972] wl_registry@2.global(16, \"zwp_input_panel_v1\", 1)\r\n[3858817.985] wl_registry@2.global(17, \"zwp_text_input_manager_v1\", 1)\r\n[3858818.001] wl_registry@2.global(18, \"xdg_wm_base\", 5)\r\n[3858818.015]  -> wl_registry@2.bind(18, \"xdg_wm_base\", 1, new id [unknown]@12)\r\n[3858818.030] wl_registry@2.global(19, \"weston_desktop_shell\", 1)\r\n[3858818.048] wl_callback@3.done(3)\r\n[3858818.061]  -> wl_display@1.sync(new id wl_callback@3)\r\n[3858818.180] wl_display@1.delete_id(3)\r\n[3858818.193] wl_output@11.geometry(0, 0, 1024, 640, 0, \"weston\", \"headless\", 0)\r\n[3858818.211] wl_output@11.scale(1)\r\n[3858818.219] wl_output@11.mode(3, 1024, 640, 60000)\r\n[3858818.232] wl_output@11.name(\"headless\")\r\n[3858818.242] wl_output@11.description(\"headless\")\r\n[3858818.251] wl_output@11.done()\r\n[3858818.260] wl_callback@3.done(3)\r\n[3858818.271]  -> wl_display@1.get_registry(new id wl_registry@3)\r\n[3858818.281]  -> wl_display@1.sync(new id wl_callback@13)\r\n[3858954.559]  -> wl_display@1.get_registry(new id wl_registry@14)\r\n[3858954.577]  -> wl_display@1.sync(new id wl_callback@15)\r\n[3858954.587]  -> wl_display@1.sync(new id wl_callback@16)\r\n[3858954.733] wl_display@1.delete_id(13)\r\n[3858954.744] wl_display@1.delete_id(15)\r\n[3858954.748] wl_display@1.delete_id(16)\r\n[3858954.753] wl_registry@3.global(1, \"wl_compositor\", 5)\r\n[3858954.759] wl_registry@3.global(2, \"wl_subcompositor\", 1)\r\n[3858954.764] wl_registry@3.global(3, \"wp_viewporter\", 1)\r\n[3858954.769] wl_registry@3.global(4, \"zxdg_output_manager_v1\", 2)\r\n[3858954.773] wl_registry@3.global(5, \"wp_presentation\", 1)\r\n[3858954.778] wl_registry@3.global(6, \"wp_single_pixel_buffer_manager_v1\", 1)\r\n[3858954.784] wl_registry@3.global(7, \"wp_tearing_control_manager_v1\", 1)\r\n[3858954.791] wl_registry@3.global(8, \"zwp_relative_pointer_manager_v1\", 1)\r\n[3858954.797] wl_registry@3.global(9, \"zwp_pointer_constraints_v1\", 1)\r\n[3858954.803] wl_registry@3.global(10, \"zwp_input_timestamps_manager_v1\", 1)\r\n[3858954.808] wl_registry@3.global(11, \"weston_capture_v1\", 1)\r\n[3858954.814] wl_registry@3.global(12, \"wl_data_device_manager\", 3)\r\n[3858954.819] wl_registry@3.global(13, \"wl_shm\", 1)\r\n[3858954.825] wl_registry@3.global(14, \"zwp_linux_explicit_synchronization_v1\", 2)\r\n[3858954.830] wl_registry@3.global(15, \"wl_output\", 4)\r\n[3858954.836] wl_registry@3.global(16, \"zwp_input_panel_v1\", 1)\r\n[3858954.842] wl_registry@3.global(17, \"zwp_text_input_manager_v1\", 1)\r\n[3858954.847] wl_registry@3.global(18, \"xdg_wm_base\", 5)\r\n[3858954.854]  -> wl_registry@3.bind(18, \"xdg_wm_base\", 5, new id [unknown]@17)\r\n[3858954.861] wl_registry@3.global(19, \"weston_desktop_shell\", 1)\r\n[3858954.867] wl_callback@13.done(3)\r\n[3858954.873] wl_registry@14.global(1, \"wl_compositor\", 5)\r\n[3858954.880]  -> wl_registry@14.bind(1, \"wl_compositor\", 4, new id [unknown]@13)\r\n[3858954.887] wl_registry@14.global(2, \"wl_subcompositor\", 1)\r\n[3858954.893]  -> wl_registry@14.bind(2, \"wl_subcompositor\", 1, new id [unknown]@18)\r\n[3858954.899] wl_registry@14.global(3, \"wp_viewporter\", 1)\r\n[3858954.905] wl_registry@14.global(4, \"zxdg_output_manager_v1\", 2)\r\n[3858954.911] wl_registry@14.global(5, \"wp_presentation\", 1)\r\n[3858954.916] wl_registry@14.global(6, \"wp_single_pixel_buffer_manager_v1\", 1)\r\n[3858954.922] wl_registry@14.global(7, \"wp_tearing_control_manager_v1\", 1)\r\n[3858954.928] wl_registry@14.global(8, \"zwp_relative_pointer_manager_v1\", 1)\r\n[3858954.934] wl_registry@14.global(9, \"zwp_pointer_constraints_v1\", 1)\r\n[3858954.940] wl_registry@14.global(10, \"zwp_input_timestamps_manager_v1\", 1)\r\n[3858954.945] wl_registry@14.global(11, \"weston_capture_v1\", 1)\r\n[3858954.951] wl_registry@14.global(12, \"wl_data_device_manager\", 3)\r\n[3858954.957] wl_registry@14.global(13, \"wl_shm\", 1)\r\n[3858954.963]  -> wl_registry@14.bind(13, \"wl_shm\", 1, new id [unknown]@19)\r\n[3858954.969]  -> wl_display@1.sync(new id wl_callback@20)\r\n[3858954.975] wl_registry@14.global(14, \"zwp_linux_explicit_synchronization_v1\", 2)\r\n[3858954.981] wl_registry@14.global(15, \"wl_output\", 4)\r\n[3858954.987]  -> wl_registry@14.bind(15, \"wl_output\", 3, new id [unknown]@21)\r\n[3858954.994] wl_registry@14.global(16, \"zwp_input_panel_v1\", 1)\r\n[3858954.999] wl_registry@14.global(17, \"zwp_text_input_manager_v1\", 1)\r\n[3858955.005] wl_registry@14.global(18, \"xdg_wm_base\", 5)\r\n[3858955.011] wl_registry@14.global(19, \"weston_desktop_shell\", 1)\r\n[3858955.017] wl_callback@15.done(3)\r\n[3858955.022] wl_callback@16.done(3)\r\n[3858955.039]  -> wl_display@1.sync(new id wl_callback@16)\r\n\r\nProgram received signal SIGSEGV, Segmentation fault.\r\nwl_proxy_get_version (proxy=0x0) at ../src/wayland-client.c:2248\r\n2248\t../src/wayland-client.c: No such file or directory.\r\n(gdb) bt\r\n#0  wl_proxy_get_version (proxy=0x0) at ../src/wayland-client.c:2248\r\n#1  0x000055555558ad73 in wl_seat_get_version (wl_seat=0x0) at .../glfw3/build/src/wayland-client-protocol.h:4288\r\n#2  0x000055555558d820 in _glfwInitWayland () at .../glfw3/src/wl_init.c:856\r\n#3  0x000055555556dff6 in glfwInit () at .../glfw3/src/init.c:405\r\n#4  0x000055555556a0be in main (argc=1, argv=0x7fffffffdc28) at .../glfw3/tests/glfwinfo.c:677\r\n```\r\n\r\nI'm guessing the `wl_seat=0x0` is the problem.\r\n\r\nI found this: https://gitlab.freedesktop.org/wayland/weston/-/merge_requests/209 which suggests weston not registering a `wl_seat` global for the headless backend is intentional.","closed_by":{"login":"elmindreda","id":133714,"node_id":"MDQ6VXNlcjEzMzcxNA==","avatar_url":"https://avatars.githubusercontent.com/u/133714?v=4","gravatar_id":"","url":"https://api.github.com/users/elmindreda","html_url":"https://github.com/elmindreda","followers_url":"https://api.github.com/users/elmindreda/followers","following_url":"https://api.github.com/users/elmindreda/following{/other_user}","gists_url":"https://api.github.com/users/elmindreda/gists{/gist_id}","starred_url":"https://api.github.com/users/elmindreda/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/elmindreda/subscriptions","organizations_url":"https://api.github.com/users/elmindreda/orgs","repos_url":"https://api.github.com/users/elmindreda/repos","events_url":"https://api.github.com/users/elmindreda/events{/privacy}","received_events_url":"https://api.github.com/users/elmindreda/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/glfw/glfw/issues/2517/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/glfw/glfw/issues/2517/timeline","performed_via_github_app":null,"state_reason":"completed"}