<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:16:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-1593] 3.0.0-M1 produces invalid code sources on Windows</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-1593</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;The fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1588&quot; title=&quot;Surefire manifest jar classloading broken on latest Debian/Ubuntu Java8&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1588&quot;&gt;&lt;del&gt;SUREFIRE-1588&lt;/del&gt;&lt;/a&gt; did not work correctly on Windows. (When active&#8212;i.e., when the drive letters of the system temporary directory, per &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1400&quot; title=&quot;Windows surefire boot directory should appear in system default temporary-directory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1400&quot;&gt;&lt;del&gt;SUREFIRE-1400&lt;/del&gt;&lt;/a&gt;, and the project basedir were the same.) It would produce relative URIs containing &lt;tt&gt;%5C&lt;/tt&gt; where &lt;tt&gt;/&lt;/tt&gt; was intended.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13197142">SUREFIRE-1593</key>
            <summary>3.0.0-M1 produces invalid code sources on Windows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tibordigana">Tibor Digana</assignee>
                                    <reporter username="jglick@netbeans.org">Jesse Glick</reporter>
                        <labels>
                    </labels>
                <created>Thu, 8 Nov 2018 14:42:45 +0000</created>
                <updated>Fri, 4 Jul 2025 07:32:19 +0000</updated>
                            <resolved>Sat, 17 Nov 2018 02:02:04 +0000</resolved>
                                    <version>3.0.0-M1</version>
                                    <fixVersion>3.0.0-M2</fixVersion>
                                    <component>classloading</component>
                    <component>process forking</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16679849" author="githubbot" created="Thu, 8 Nov 2018 14:43:49 +0000"  >&lt;p&gt;jglick commented on issue #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#issuecomment-437017168&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#issuecomment-437017168&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &amp;gt; Create a new Jira ticket.&lt;/p&gt;

&lt;p&gt;   done&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16680013" author="githubbot" created="Thu, 8 Nov 2018 16:58:15 +0000"  >&lt;p&gt;Tibor17 commented on a change in pull request #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#discussion_r231979549&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#discussion_r231979549&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfiguration.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -150,10 +150,9 @@ private static String toClasspathElementUri( @Nonnull Path parent,&lt;br/&gt;
     {&lt;br/&gt;
         try&lt;br/&gt;
         {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return new URI( null,&lt;/li&gt;
	&lt;li&gt;parent.relativize( classPathElement.toPath() ).toString().&lt;/li&gt;
	&lt;li&gt;replace( File.separatorChar, &apos;/&apos; ),&lt;/li&gt;
	&lt;li&gt;null ).toASCIIString();&lt;br/&gt;
+            Path relativePath = parent.relativize( classPathElement.toPath() );&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   This won&apos;t tested by ITs because we cannot occupy any disk on Jenkins, but this algorithm could be tested by unit test and Mockito. At least Line 153 in mock and next two lines are real and tested. If the Line went to private static method, we could mock it via PowerMock, and then the next two lines together in another method calling the first static method. We would assert the returned value has Unix slashes and white spaces are escaped, paths are relative, etc.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16680060" author="githubbot" created="Thu, 8 Nov 2018 17:31:06 +0000"  >&lt;p&gt;Tibor17 commented on a change in pull request #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#discussion_r231991410&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#discussion_r231991410&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfiguration.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -150,10 +150,9 @@ private static String toClasspathElementUri( @Nonnull Path parent,&lt;br/&gt;
     {&lt;br/&gt;
         try&lt;br/&gt;
         {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return new URI( null,&lt;/li&gt;
	&lt;li&gt;parent.relativize( classPathElement.toPath() ).toString().&lt;/li&gt;
	&lt;li&gt;replace( File.separatorChar, &apos;/&apos; ),&lt;/li&gt;
	&lt;li&gt;null ).toASCIIString();&lt;br/&gt;
+            Path relativePath = parent.relativize( classPathElement.toPath() );&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   @jglick &lt;br/&gt;
   There is one IT test `Surefire855AllowFailsafeUseArtifactFileIT` which asserts Class-Path in manifest and surefire.properties, but it&apos;s hard to develope such test runing on any platform and any number of dists. Even in our case, using ASF Jenkins CI, we have workspace on `F:\` but the TEMP is on `C:\`.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16680062" author="githubbot" created="Thu, 8 Nov 2018 17:31:38 +0000"  >&lt;p&gt;Tibor17 commented on a change in pull request #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#discussion_r231991410&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#discussion_r231991410&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfiguration.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -150,10 +150,9 @@ private static String toClasspathElementUri( @Nonnull Path parent,&lt;br/&gt;
     {&lt;br/&gt;
         try&lt;br/&gt;
         {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return new URI( null,&lt;/li&gt;
	&lt;li&gt;parent.relativize( classPathElement.toPath() ).toString().&lt;/li&gt;
	&lt;li&gt;replace( File.separatorChar, &apos;/&apos; ),&lt;/li&gt;
	&lt;li&gt;null ).toASCIIString();&lt;br/&gt;
+            Path relativePath = parent.relativize( classPathElement.toPath() );&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   @jglick &lt;br/&gt;
   There is one IT test `Surefire855AllowFailsafeUseArtifactFileIT` which asserts Class-Path in manifest and surefire.properties, but it&apos;s hard to develop such test running on any platform and with any number of disks. Even in our case, using ASF Jenkins CI, we have workspace on `F:\` but the TEMP is on `C:\`.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16681654" author="githubbot" created="Fri, 9 Nov 2018 16:11:57 +0000"  >&lt;p&gt;Tibor17 commented on issue #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#issuecomment-437408939&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#issuecomment-437408939&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @jglick &lt;br/&gt;
   Can you squash the commits together, rebase on the master and create a new Jira ticket?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16681688" author="githubbot" created="Fri, 9 Nov 2018 16:45:32 +0000"  >&lt;p&gt;Tibor17 commented on issue #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#issuecomment-437419749&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#issuecomment-437419749&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   Currently running the build with our changes...&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16681776" author="githubbot" created="Fri, 9 Nov 2018 18:05:55 +0000"  >&lt;p&gt;jglick commented on issue #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#issuecomment-437444471&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#issuecomment-437444471&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &amp;gt; create a new Jira ticket?&lt;/p&gt;

&lt;p&gt;   Besides the &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; I already created?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16681779" author="githubbot" created="Fri, 9 Nov 2018 18:07:03 +0000"  >&lt;p&gt;jglick commented on a change in pull request #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#discussion_r232342689&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#discussion_r232342689&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfiguration.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -150,10 +150,9 @@ private static String toClasspathElementUri( @Nonnull Path parent,&lt;br/&gt;
     {&lt;br/&gt;
         try&lt;br/&gt;
         {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return new URI( null,&lt;/li&gt;
	&lt;li&gt;parent.relativize( classPathElement.toPath() ).toString().&lt;/li&gt;
	&lt;li&gt;replace( File.separatorChar, &apos;/&apos; ),&lt;/li&gt;
	&lt;li&gt;null ).toASCIIString();&lt;br/&gt;
+            Path relativePath = parent.relativize( classPathElement.toPath() );&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   I cannot imagine you could write a reliable IT without Vagrant or similar.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16682319" author="githubbot" created="Sat, 10 Nov 2018 10:10:56 +0000"  >&lt;p&gt;cstamas commented on issue #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#issuecomment-437573037&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#issuecomment-437573037&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   +1&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16682580" author="githubbot" created="Sat, 10 Nov 2018 20:19:23 +0000"  >&lt;p&gt;Tibor17 commented on issue #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#issuecomment-437618365&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#issuecomment-437618365&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @jglick &lt;br/&gt;
   Pls update your PR with &lt;a href=&quot;https://github.com/jglick/maven-surefire/pull/1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/jglick/maven-surefire/pull/1&lt;/a&gt;&lt;br/&gt;
   there are more unit tests and fixes in codestyle in the test class.&lt;br/&gt;
   Thx&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16682586" author="githubbot" created="Sat, 10 Nov 2018 20:49:39 +0000"  >&lt;p&gt;Tibor17 commented on issue #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#issuecomment-437620227&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#issuecomment-437620227&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @cstamas &lt;br/&gt;
   @jglick &lt;br/&gt;
   I could not find in Java specification that element in `Class-Path` should be URI `&lt;a href=&quot;file:///path/to/jar&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:///path/to/jar&lt;/a&gt;`. Oracle used examples with relative paths only. In case of absolute paths we use URI. Is this expected?&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16682603" author="githubbot" created="Sat, 10 Nov 2018 21:26:46 +0000"  >&lt;p&gt;Tibor17 commented on issue #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#issuecomment-437622572&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#issuecomment-437622572&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   linked with discussion &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/199&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/199&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16682798" author="githubbot" created="Sun, 11 Nov 2018 08:51:37 +0000"  >&lt;p&gt;Tibor17 commented on a change in pull request #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#discussion_r232479128&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#discussion_r232479128&lt;/a&gt;&lt;/p&gt;



&lt;p&gt; ##########&lt;br/&gt;
 File path: maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfiguration.java&lt;br/&gt;
 ##########&lt;br/&gt;
 @@ -150,10 +150,9 @@ private static String toClasspathElementUri( @Nonnull Path parent,&lt;br/&gt;
     {&lt;br/&gt;
         try&lt;br/&gt;
         {&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;return new URI( null,&lt;/li&gt;
	&lt;li&gt;parent.relativize( classPathElement.toPath() ).toString().&lt;/li&gt;
	&lt;li&gt;replace( File.separatorChar, &apos;/&apos; ),&lt;/li&gt;
	&lt;li&gt;null ).toASCIIString();&lt;br/&gt;
+            Path relativePath = parent.relativize( classPathElement.toPath() );&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt; Review comment:&lt;br/&gt;
   @jglick &lt;br/&gt;
   Not sure about Vagrant but I know that Docker works with Windows 10.&lt;br/&gt;
   our Jenkins in ASF has Windows server 2008.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16685332" author="githubbot" created="Tue, 13 Nov 2018 14:59:51 +0000"  >&lt;p&gt;jglick commented on issue #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#issuecomment-438296318&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#issuecomment-438296318&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   &amp;gt; Oracle used examples with relative paths only.&lt;/p&gt;

&lt;p&gt;   Yes, and that is what #197 attempts to do. It falls back to the original behavior of absolute URIs only when relativization fails, typically due to Windows cross-drive issues.&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16685356" author="githubbot" created="Tue, 13 Nov 2018 15:18:06 +0000"  >&lt;p&gt;cstamas commented on issue #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#issuecomment-438303029&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#issuecomment-438303029&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @Tibor17 &lt;br/&gt;
   See &lt;a href=&quot;https://docs.oracle.com/javase/8/docs/technotes/guides/jar/jar.html#Main_Attributes&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://docs.oracle.com/javase/8/docs/technotes/guides/jar/jar.html#Main_Attributes&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16690193" author="tibor17" created="Sat, 17 Nov 2018 02:02:04 +0000"  >&lt;p&gt;&lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=maven-surefire.git;a=commit;h=f5cca5bcc2c85060c21c82eea0081d016cb86909&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=maven-surefire.git;a=commit;h=f5cca5bcc2c85060c21c82eea0081d016cb86909&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16690398" author="githubbot" created="Sat, 17 Nov 2018 06:19:25 +0000"  >&lt;p&gt;Tibor17 commented on issue #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198#issuecomment-439592262&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198#issuecomment-439592262&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;   @jglick &lt;br/&gt;
   Pls close your PR, the fix has been pushed. Thx for your work!&lt;/p&gt;

&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16690519" author="githubbot" created="Sat, 17 Nov 2018 12:05:38 +0000"  >&lt;p&gt;rfscholte closed pull request #198: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1593&quot; title=&quot;3.0.0-M1 produces invalid code sources on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1593&quot;&gt;&lt;del&gt;SUREFIRE-1593&lt;/del&gt;&lt;/a&gt; Correcting relativization logic to produce valid URIs on Windows&lt;br/&gt;
URL: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/198&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/198&lt;/a&gt;&lt;/p&gt;




&lt;p&gt;This is a PR merged from a forked repository.&lt;br/&gt;
As GitHub hides the original diff on merge, it is displayed below for&lt;br/&gt;
the sake of provenance:&lt;/p&gt;

&lt;p&gt;As this is a foreign pull request (from a fork), the diff is supplied&lt;br/&gt;
below (as it won&apos;t show otherwise due to GitHub magic):&lt;/p&gt;

&lt;p&gt;diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfiguration.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfiguration.java&lt;br/&gt;
index 70f95d953..25f55066e 100644&lt;br/&gt;
&amp;#8212; a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfiguration.java&lt;br/&gt;
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfiguration.java&lt;br/&gt;
@@ -33,7 +33,7 @@&lt;br/&gt;
 import java.io.IOException;&lt;br/&gt;
 import java.net.URI;&lt;br/&gt;
 import java.net.URISyntaxException;&lt;br/&gt;
-import java.nio.file.Path;&lt;br/&gt;
+import java.nio.file.Paths;&lt;br/&gt;
 import java.util.Iterator;&lt;br/&gt;
 import java.util.List;&lt;br/&gt;
 import java.util.Map;&lt;br/&gt;
@@ -101,7 +101,7 @@ private File createJar( @Nonnull List&amp;lt;String&amp;gt; classPath, @Nonnull String startCl&lt;/p&gt;
         {
             file.deleteOnExit();
         }
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Path parent = file.getParentFile().toPath();&lt;br/&gt;
+        String parent = file.getParent();&lt;br/&gt;
         FileOutputStream fos = new FileOutputStream( file );&lt;br/&gt;
         try ( JarOutputStream jos = new JarOutputStream( fos ) )&lt;br/&gt;
         {&lt;br/&gt;
@@ -116,10 +116,10 @@ private File createJar( @Nonnull List&amp;lt;String&amp;gt; classPath, @Nonnull String startCl&lt;br/&gt;
             StringBuilder cp = new StringBuilder();&lt;br/&gt;
             for ( Iterator&amp;lt;String&amp;gt; it = classPath.iterator(); it.hasNext(); )&lt;br/&gt;
             {&lt;/li&gt;
	&lt;li&gt;File classPathElement = new File( it.next() );&lt;br/&gt;
+                String classPathElement = it.next();&lt;br/&gt;
                 String uri = toClasspathElementUri( parent, classPathElement, dumpLogDirectory );&lt;br/&gt;
                 cp.append( uri );&lt;/li&gt;
	&lt;li&gt;if ( classPathElement.isDirectory() &amp;amp;&amp;amp; !uri.endsWith( &quot;/&quot; ) )&lt;br/&gt;
+                if ( new File( classPathElement ).isDirectory() &amp;amp;&amp;amp; !uri.endsWith( &quot;/&quot; ) )
                 {
                     cp.append( &apos;/&apos; );
                 }
&lt;p&gt;@@ -143,24 +143,34 @@ private File createJar( @Nonnull List&amp;lt;String&amp;gt; classPath, @Nonnull String startCl&lt;br/&gt;
         }&lt;br/&gt;
     }&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;private static String toClasspathElementUri( @Nonnull Path parent,&lt;/li&gt;
	&lt;li&gt;@Nonnull File classPathElement,&lt;/li&gt;
	&lt;li&gt;@Nonnull File dumpLogDirectory )&lt;br/&gt;
+    static String relativize( @Nonnull String parent, @Nonnull String child )&lt;br/&gt;
+            throws IllegalArgumentException&lt;br/&gt;
+    
{
+        return Paths.get( parent ).relativize( Paths.get( child ) ).toString();
+    }
&lt;p&gt;+&lt;br/&gt;
+    static String absoluteUri( @Nonnull String file )&lt;br/&gt;
+    &lt;/p&gt;
{
+        return Paths.get( file ).toUri().toASCIIString();
+    }
&lt;p&gt;+&lt;br/&gt;
+    static String toClasspathElementUri( @Nonnull String parent,&lt;br/&gt;
+                                           @Nonnull String classPathElement,&lt;br/&gt;
+                                           @Nonnull File dumpLogDirectory )&lt;br/&gt;
             throws IOException&lt;br/&gt;
     {&lt;br/&gt;
         try&lt;/p&gt;
         {
-            return new URI( null, parent.relativize( classPathElement.toPath() ).toString(), null )
-                    .toASCIIString();
+            String uriPath = relativize( parent, classPathElement ).replace( &apos;\\&apos;, &apos;/&apos; );
+            return new URI( null, uriPath, null ).toASCIIString();
         }
&lt;p&gt;         catch ( IllegalArgumentException e )&lt;/p&gt;
         {
-            String error = &quot;Boot Manifest-JAR contains absolute paths in classpath &quot; + classPathElement.getPath();
+            String error = &quot;Boot Manifest-JAR contains absolute paths in classpath &quot; + classPathElement;
             InPluginProcessDumpSingleton.getSingleton()
                     .dumpException( e, error, dumpLogDirectory );
 
-            return classPathElement.toURI()
-                    .toASCIIString();
+            return absoluteUri( classPathElement );
         }
&lt;p&gt;         catch ( URISyntaxException e )&lt;br/&gt;
         {&lt;br/&gt;
diff --git a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfigurationTest.java b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfigurationTest.java&lt;br/&gt;
new file mode 100644&lt;br/&gt;
index 000000000..7e25e7fee&lt;/p&gt;
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;
		&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
			&lt;li&gt;/dev/null&lt;br/&gt;
+++ b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/booterclient/JarManifestForkConfigurationTest.java&lt;br/&gt;
@@ -0,0 +1,119 @@&lt;br/&gt;
+package org.apache.maven.plugin.surefire.booterclient;&lt;br/&gt;
+&lt;br/&gt;
+/*&lt;br/&gt;
+ * Licensed to the Apache Software Foundation (ASF) under one&lt;br/&gt;
+ * or more contributor license agreements.  See the NOTICE file&lt;br/&gt;
+ * distributed with this work for additional information&lt;br/&gt;
+ * regarding copyright ownership.  The ASF licenses this file&lt;br/&gt;
+ * to you under the Apache License, Version 2.0 (the&lt;br/&gt;
+ * &quot;License&quot;); you may not use this file except in compliance&lt;br/&gt;
+ * with the License.  You may obtain a copy of the License at&lt;br/&gt;
+ *&lt;br/&gt;
+ *     &lt;a href=&quot;http://www.apache.org/licenses/LICENSE-2.0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://www.apache.org/licenses/LICENSE-2.0&lt;/a&gt;&lt;br/&gt;
+ *&lt;br/&gt;
+ * Unless required by applicable law or agreed to in writing,&lt;br/&gt;
+ * software distributed under the License is distributed on an&lt;br/&gt;
+ * &quot;AS IS&quot; BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY&lt;br/&gt;
+ * KIND, either express or implied.  See the License for the&lt;br/&gt;
+ * specific language governing permissions and limitations&lt;br/&gt;
+ * under the License.&lt;br/&gt;
+ */&lt;br/&gt;
+&lt;br/&gt;
+import java.io.File;&lt;br/&gt;
+import org.apache.maven.plugin.surefire.booterclient.output.InPluginProcessDumpSingleton;&lt;br/&gt;
+import static org.fest.assertions.Assertions.assertThat;&lt;br/&gt;
+import org.junit.Test;&lt;br/&gt;
+import org.junit.runner.RunWith;&lt;br/&gt;
+import static org.mockito.ArgumentMatchers.*;&lt;br/&gt;
+import static org.powermock.api.mockito.PowerMockito.*;&lt;br/&gt;
+import org.powermock.core.classloader.annotations.PrepareForTest;&lt;br/&gt;
+import org.powermock.modules.junit4.PowerMockRunner;&lt;br/&gt;
+&lt;br/&gt;
+/**&lt;br/&gt;
+ * Unit tests for 
{@link JarManifestForkConfiguration}
&lt;p&gt;.&lt;br/&gt;
+ */&lt;br/&gt;
+@RunWith( PowerMockRunner.class )&lt;br/&gt;
+@PrepareForTest( &lt;/p&gt;
{ JarManifestForkConfiguration.class, InPluginProcessDumpSingleton.class }
&lt;p&gt; )&lt;br/&gt;
+public class JarManifestForkConfigurationTest&lt;br/&gt;
+&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {++    @Test+    public void relativeClasspathUnixSimple()+        throws Exception+    {
+        mockStatic( JarManifestForkConfiguration.class );
+        String parent = &quot;/home/me/prj/target/surefire&quot;;
+        String classPathElement = &quot;/home/me/.m2/repository/grp/art/1.0/art-1.0.jar&quot;;
+        when( JarManifestForkConfiguration.relativize( parent, classPathElement ) ).
+                thenReturn( &quot;../../../.m2/repository/grp/art/1.0/art-1.0.jar&quot; );
+        when( JarManifestForkConfiguration.toClasspathElementUri( anyString(), anyString(), any( File.class ) ) ).
+                thenCallRealMethod();
+        assertThat( JarManifestForkConfiguration.toClasspathElementUri( parent, classPathElement, new File(&quot;.&quot;) ) ).
+                isEqualTo( &quot;../../../.m2/repository/grp/art/1.0/art-1.0.jar&quot; );
+    }++    @Test+    public void relativeClasspathUnixTricky()+        throws Exception+    {
+        mockStatic( JarManifestForkConfiguration.class );
+        String parent = &quot;/home/me/prj/target/surefire&quot;;
+        String classPathElement = &quot;/the Maven repo/grp/art/1.0/art-1.0.jar&quot;;
+        when( JarManifestForkConfiguration.relativize( parent, classPathElement ) ).
+                thenReturn( &quot;../../../../../the Maven repo/grp/art/1.0/art-1.0.jar&quot; );
+        when( JarManifestForkConfiguration.toClasspathElementUri( anyString(), anyString(), any( File.class ) ) ).
+                thenCallRealMethod();
+        assertThat( JarManifestForkConfiguration.toClasspathElementUri( parent, classPathElement, new File(&quot;.&quot;) ) ).
+                isEqualTo( &quot;../../../../../the%20Maven%20repo/grp/art/1.0/art-1.0.jar&quot; );
+    }++    @Test+    public void relativeClasspathWindowsSimple()+        throws Exception+    {
+        mockStatic( JarManifestForkConfiguration.class );
+        String parent = &quot;C:\\Windows\\Temp\\surefire&quot;;
+        String classPathElement = &quot;C:\\Users\\me\\.m2\\repository\\grp\\art\\1.0\\art-1.0.jar&quot;;
+        when( JarManifestForkConfiguration.relativize( parent, classPathElement ) ).
+                thenReturn( &quot;..\\..\\..\\Users\\me\\.m2\\repository\\grp\\art\\1.0\\art-1.0.jar&quot; );
+        when( JarManifestForkConfiguration.toClasspathElementUri( anyString(), anyString(), any( File.class ) ) ).
+                thenCallRealMethod();
+        assertThat( JarManifestForkConfiguration.toClasspathElementUri( parent, classPathElement, new File(&quot;.&quot;) ) ).
+                isEqualTo( &quot;../../../Users/me/.m2/repository/grp/art/1.0/art-1.0.jar&quot; );
+    }++    @Test+    public void relativeClasspathWindowsTricky()+        throws Exception+    {
+        mockStatic( JarManifestForkConfiguration.class );
+        String parent = &quot;C:\\Windows\\Temp\\surefire&quot;;
+        String classPathElement = &quot;C:\\Test User\\me\\.m2\\repository\\grp\\art\\1.0\\art-1.0.jar&quot;;
+        when( JarManifestForkConfiguration.relativize( parent, classPathElement ) ).
+                thenReturn( &quot;..\\..\\..\\Test User\\me\\.m2\\repository\\grp\\art\\1.0\\art-1.0.jar&quot; );
+        when( JarManifestForkConfiguration.toClasspathElementUri( anyString(), anyString(), any( File.class ) ) ).
+                thenCallRealMethod();
+        assertThat( JarManifestForkConfiguration.toClasspathElementUri( parent, classPathElement, new File(&quot;.&quot;) ) ).
+                isEqualTo( &quot;../../../Test%20User/me/.m2/repository/grp/art/1.0/art-1.0.jar&quot; );
+    }++    @Test+    public void crossDriveWindows()+        throws Exception+    {
+        mockStatic( JarManifestForkConfiguration.class );
+        mockStatic( InPluginProcessDumpSingleton.class );
+        when( InPluginProcessDumpSingleton.getSingleton() ).thenReturn(mock( InPluginProcessDumpSingleton.class ));
+        String parent = &quot;C:\\Windows\\Temp\\surefire&quot;;
+        String classPathElement = &quot;X:\\Users\\me\\.m2\\repository\\grp\\art\\1.0\\art-1.0.jar&quot;;
+        when( JarManifestForkConfiguration.relativize( parent, classPathElement ) ).
+                thenThrow( new IllegalArgumentException() );
+        when( JarManifestForkConfiguration.absoluteUri( classPathElement ) ).
+                thenReturn( &quot;file:///X:/Users/me/.m2/repository/grp/art/1.0/art-1.0.jar&quot; );
+        when( JarManifestForkConfiguration.toClasspathElementUri( anyString(), anyString(), any( File.class ) ) ).
+                thenCallRealMethod();
+        assertThat( JarManifestForkConfiguration.toClasspathElementUri( parent, classPathElement, new File(&quot;.&quot;) ) ).
+                isEqualTo( &quot;file:///X:/Users/me/.m2/repository/grp/art/1.0/art-1.0.jar&quot; );
+    }++}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;diff --git a/maven-surefire-common/src/test/java/org/apache/maven/surefire/JUnit4SuiteTest.java b/maven-surefire-common/src/test/java/org/apache/maven/surefire/JUnit4SuiteTest.java&lt;br/&gt;
index 728cef3a3..c248de866 100644&lt;/p&gt;&lt;/li&gt;
			&lt;li&gt;a/maven-surefire-common/src/test/java/org/apache/maven/surefire/JUnit4SuiteTest.java&lt;br/&gt;
+++ b/maven-surefire-common/src/test/java/org/apache/maven/surefire/JUnit4SuiteTest.java&lt;br/&gt;
@@ -34,6 +34,7 @@&lt;br/&gt;
 import org.apache.maven.plugin.surefire.booterclient.DefaultForkConfigurationTest;&lt;br/&gt;
 import org.apache.maven.plugin.surefire.booterclient.ForkConfigurationTest;&lt;br/&gt;
 import org.apache.maven.plugin.surefire.booterclient.ForkingRunListenerTest;&lt;br/&gt;
+import org.apache.maven.plugin.surefire.booterclient.JarManifestForkConfigurationTest;&lt;br/&gt;
 import org.apache.maven.plugin.surefire.booterclient.ModularClasspathForkConfigurationTest;&lt;br/&gt;
 import org.apache.maven.plugin.surefire.booterclient.lazytestprovider.TestLessInputStreamBuilderTest;&lt;br/&gt;
 import org.apache.maven.plugin.surefire.booterclient.lazytestprovider.TestProvidingInputStreamTest;&lt;br/&gt;
@@ -88,6 +89,7 @@ public static Test suite()&lt;br/&gt;
         suite.addTest( new JUnit4TestAdapter( SurefireHelperTest.class ) );&lt;br/&gt;
         suite.addTest( new JUnit4TestAdapter( AbstractSurefireMojoTest.class ) );&lt;br/&gt;
         suite.addTest( new JUnit4TestAdapter( DefaultForkConfigurationTest.class ) );&lt;br/&gt;
+        suite.addTest( new JUnit4TestAdapter( JarManifestForkConfigurationTest.class ) );&lt;br/&gt;
         suite.addTest( new JUnit4TestAdapter( ModularClasspathForkConfigurationTest.class ) );&lt;br/&gt;
         if ( JAVA_RECENT.atLeast( JAVA_1_7 ) )&lt;br/&gt;
         {&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;





&lt;p&gt;----------------------------------------------------------------&lt;br/&gt;
This is an automated message from the Apache Git Service.&lt;br/&gt;
To respond to the message, please log on GitHub and use the&lt;br/&gt;
URL above to go to the specific comment.&lt;/p&gt;

&lt;p&gt;For queries about this service, please contact Infrastructure at:&lt;br/&gt;
users@infra.apache.org&lt;/p&gt;</comment>
                            <comment id="16691868" author="jglick@netbeans.org" created="Mon, 19 Nov 2018 15:30:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/maven-surefire/commit/f5cca5bcc2c85060c21c82eea0081d016cb86909&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Final fix&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17994990" author="olamy" created="Fri, 4 Jul 2025 07:32:19 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/2162&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#2162&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13195231">SUREFIRE-1588</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s00a1s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>