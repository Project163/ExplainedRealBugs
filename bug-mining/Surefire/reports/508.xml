<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:13:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-1268] With JUnit listener, redirectTestOutputToFile is ignored</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-1268</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;When specifying, according to &lt;a href=&quot;http://maven.apache.org/surefire/maven-surefire-plugin/examples/junit.html#Using_Custom_Listeners_and_Reporters&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this doc&lt;/a&gt;, a JUnit listener, the test output is sent to STDOUT, even though &lt;tt&gt;redirectTestOutputToFile&lt;/tt&gt; is set to &lt;tt&gt;true&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;This happens with log4j2 configuration for &lt;tt&gt;SYSTEM_OUT&lt;/tt&gt;, regular &lt;tt&gt;System.out.println&lt;/tt&gt; works fine.&lt;/p&gt;

&lt;p&gt;With no &lt;tt&gt;properties&lt;/tt&gt; element, &lt;tt&gt;redirectTestOutputToFile&lt;/tt&gt; is honored.&lt;/p&gt;</description>
                <environment>Linux</environment>
        <key id="12995970">SUREFIRE-1268</key>
            <summary>With JUnit listener, redirectTestOutputToFile is ignored</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tibordigana">Tibor Digana</assignee>
                                    <reporter username="ilgrosso">Francesco Chicchiricc&#242;</reporter>
                        <labels>
                    </labels>
                <created>Tue, 9 Aug 2016 14:50:52 +0000</created>
                <updated>Fri, 4 Jul 2025 07:26:14 +0000</updated>
                            <resolved>Tue, 30 Aug 2016 22:33:48 +0000</resolved>
                                    <version>2.19.1</version>
                                    <fixVersion>2.20</fixVersion>
                                    <component>Junit 4.x support</component>
                    <component>Maven Surefire Plugin</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15415019" author="ilgrosso" created="Wed, 10 Aug 2016 09:34:13 +0000"  >&lt;p&gt;Also noticed that &lt;tt&gt;target/surefire-reports/null-output.txt&lt;/tt&gt; is created.&lt;/p&gt;

&lt;p&gt;I have currently switched, in &lt;tt&gt;log4j2.xml&lt;/tt&gt;, from &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &amp;lt;console name=&lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; target=&lt;span class=&quot;code-quote&quot;&gt;&quot;SYSTEM_OUT&quot;&lt;/span&gt;&amp;gt;
      &amp;lt;PatternLayout&amp;gt;
        &amp;lt;pattern&amp;gt;%d{HH:mm:ss.SSS} %-5level %logger - %msg%n&amp;lt;/pattern&amp;gt;
      &amp;lt;/PatternLayout&amp;gt;
    &amp;lt;/console&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;to&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &amp;lt;RollingRandomAccessFile name=&lt;span class=&quot;code-quote&quot;&gt;&quot;main&quot;&lt;/span&gt; fileName=&lt;span class=&quot;code-quote&quot;&gt;&quot;${log.directory}/offline-tests.log&quot;&lt;/span&gt;
                             filePattern=&lt;span class=&quot;code-quote&quot;&gt;&quot;${log.directory}/core-%d{yyyy-MM-dd}.log.gz&quot;&lt;/span&gt;
                             immediateFlush=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt; append=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;&amp;gt;
      &amp;lt;PatternLayout&amp;gt;
        &amp;lt;pattern&amp;gt;%d{HH:mm:ss.SSS} %-5level %logger - %msg%n&amp;lt;/pattern&amp;gt;
      &amp;lt;/PatternLayout&amp;gt;
      &amp;lt;Policies&amp;gt;
        &amp;lt;TimeBasedTriggeringPolicy/&amp;gt;
        &amp;lt;SizeBasedTriggeringPolicy size=&lt;span class=&quot;code-quote&quot;&gt;&quot;250 MB&quot;&lt;/span&gt;/&amp;gt;
      &amp;lt;/Policies&amp;gt;
    &amp;lt;/RollingRandomAccessFile&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;to keep my console output clean.&lt;/p&gt;</comment>
                            <comment id="15420072" author="tibor17" created="Sat, 13 Aug 2016 20:51:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ilgrosso&quot; class=&quot;user-hover&quot; rel=&quot;ilgrosso&quot;&gt;ilgrosso&lt;/a&gt;&lt;br/&gt;
Pls create plain github project that I can try out.&lt;/p&gt;</comment>
                            <comment id="15420096" author="tibor17" created="Sat, 13 Aug 2016 21:54:22 +0000"  >&lt;p&gt;It looks to me that log4j calls &lt;em&gt;System.setOut()&lt;/em&gt; and completely violates our stream which means the corrupted stream appears directly on the console of main process. Could this happen?&lt;/p&gt;</comment>
                            <comment id="15420359" author="ilgrosso" created="Sun, 14 Aug 2016 15:06:51 +0000"  >&lt;p&gt;It could even be (not sure): but why this should happen only when adding a listener? Without it, everything works as expected.&lt;/p&gt;</comment>
                            <comment id="15422503" author="ilgrosso" created="Tue, 16 Aug 2016 09:44:34 +0000"  >&lt;p&gt;I have created &lt;a href=&quot;https://github.com/ilgrosso/surefire1268&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/ilgrosso/surefire1268&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;When you run &lt;tt&gt;mvn clean test&lt;/tt&gt;, you will get an output like as&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Running net.tirasa.test.surefire1268.BaseTest
Tests run: 1, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.02 sec - in net.tirasa.test.surefire1268.BaseTest
11:39:56.407 INFO  net.tirasa.test.surefire1268.BaseTest - ********* You should not be viewing &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; from console

Results :

Tests run: 1, Failures: 0, Errors: 0, Skipped: 0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The line&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;11:39:56.407 INFO  net.tirasa.test.surefire1268.BaseTest - ********* You should not be viewing &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; from console
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;is supposed to be included in &lt;tt&gt;target/surefire-reports/net.tirasa.test.surefire1268.BaseTest-output.txt&lt;/tt&gt;, but such file is not created.&lt;/p&gt;

&lt;p&gt;When commenting out&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;          &amp;lt;properties&amp;gt;
            &amp;lt;property&amp;gt;
              &amp;lt;name&amp;gt;listener&amp;lt;/name&amp;gt;
              &amp;lt;value&amp;gt;net.tirasa.test.surefire1268.NotDoingSoMuchListener&amp;lt;/value&amp;gt;
            &amp;lt;/property&amp;gt;
          &amp;lt;/properties&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;in the &lt;tt&gt;pom.xml&lt;/tt&gt;, everything works as expected.&lt;/p&gt;

&lt;p&gt;Moreover, I have noticed that everything works also if &lt;b&gt;not&lt;/b&gt; commenting the listener property in the &lt;tt&gt;pom.xml&lt;/tt&gt; but removing this line&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Logger LOG = LoggerFactory.getLogger(NotDoingSoMuchListener.class);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;in the listener class.&lt;/p&gt;</comment>
                            <comment id="15445339" author="tibor17" created="Mon, 29 Aug 2016 09:17:07 +0000"  >&lt;p&gt;... and this configuration with &lt;tt&gt;RollingRandomAccessFile&lt;/tt&gt; has the same symptoms of the bug?&lt;br/&gt;
Please tell me the artifact name including version of log4jXXX you use and I will ask &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=garydgregory&quot; class=&quot;user-hover&quot; rel=&quot;garydgregory&quot;&gt;garydgregory&lt;/a&gt; if the Log4J calls &lt;tt&gt;System.setOut()&lt;/tt&gt; without wrapping the stream origin.&lt;/p&gt;</comment>
                            <comment id="15449690" author="tibor17" created="Tue, 30 Aug 2016 18:04:20 +0000"  >&lt;p&gt;I see now. The problem is that the listeners are instantiated first in Surefire and the stream System.out gets replaced after that. Most probably LOG4J handles the original System.out when the static class context was called.&lt;br/&gt;
I should reorder listener and call of setOut() in providers.&lt;/p&gt;</comment>
                            <comment id="15450341" author="tibor17" created="Tue, 30 Aug 2016 22:33:49 +0000"  >&lt;p&gt;commit 658230b69241fc87588e9b007391f9ae4a2b416a&lt;/p&gt;</comment>
                            <comment id="15450480" author="hudson" created="Tue, 30 Aug 2016 23:32:13 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build maven-surefire #1605 (See &lt;a href=&quot;https://builds.apache.org/job/maven-surefire/1605/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/maven-surefire/1605/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1268&quot; title=&quot;With JUnit listener, redirectTestOutputToFile is ignored&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1268&quot;&gt;&lt;del&gt;SUREFIRE-1268&lt;/del&gt;&lt;/a&gt; With JUnit listener, redirectTestOutputToFile is ignored (tibor17: rev 658230b69241fc87588e9b007391f9ae4a2b416a)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreProvider.java&lt;/li&gt;
	&lt;li&gt;(edit) surefire-providers/surefire-junit4/src/main/java/org/apache/maven/surefire/junit4/JUnit4Provider.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15451033" author="ilgrosso" created="Wed, 31 Aug 2016 04:06:52 +0000"  >&lt;p&gt;Thank you very much!&lt;/p&gt;</comment>
                            <comment id="17994672" author="olamy" created="Fri, 4 Jul 2025 07:26:14 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/2420&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#2420&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i323c7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>