<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:11:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-1055] Parallel JUnit does not run all test methods with parallel=classesAndMethods perCoreThreadCount=false useUnlimitedThreads=true and threadCountMethods specified</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-1055</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;Some test methods are skipped at random with the below configuration. When test methods are skipped in this way, only one method in the class runs. Running tests repeatedly with no code change often yields a different number of tests with each run (e.g. see the attached surefire-output.txt). Tests that take longer to run are less likely to be affected. This affects version 2.16 of Surefire and Failsafe equally.&lt;/p&gt;

&lt;p&gt;Here is a simple test project which reproduces the issue: &lt;a href=&quot;https://github.com/hansenc/SUREFIRE-1055&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/hansenc/SUREFIRE-1055&lt;/a&gt;&lt;br/&gt;
It has a few simple test classes with a naming convention for how many test methods are in each class (e.g. Methods4Test has 4 test methods).&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-surefire-plugin&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;2.16&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;parallel&amp;gt;&lt;/span&gt;classesAndMethods&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/parallel&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;perCoreThreadCount&amp;gt;&lt;/span&gt;false&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/perCoreThreadCount&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;useUnlimitedThreads&amp;gt;&lt;/span&gt;true&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/useUnlimitedThreads&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;threadCountMethods&amp;gt;&lt;/span&gt;3&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/threadCountMethods&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12809587">SUREFIRE-1055</key>
            <summary>Parallel JUnit does not run all test methods with parallel=classesAndMethods perCoreThreadCount=false useUnlimitedThreads=true and threadCountMethods specified</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="krosenvold">Kristian Rosenvold</assignee>
                                    <reporter username="chris.hansen">Chris Hansen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Jan 2014 15:50:05 +0000</created>
                <updated>Fri, 4 Jul 2025 07:21:58 +0000</updated>
                            <resolved>Thu, 13 Feb 2014 11:52:29 +0000</resolved>
                                    <version>2.16</version>
                                    <fixVersion>2.17</fixVersion>
                                    <component>Junit 4.7+ (parallel) support</component>
                    <component>Maven Failsafe Plugin</component>
                    <component>Maven Surefire Plugin</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14456100" author="krosenvold" created="Wed, 22 Jan 2014 00:33:58 +0000"  >&lt;p&gt;I assume this does not happen with 2.15 and below ?&lt;/p&gt;</comment>
                            <comment id="14456142" author="chris.hansen" created="Wed, 22 Jan 2014 10:43:49 +0000"  >&lt;p&gt;Some of the options are not available on 2.15 and below, but I&apos;ve tried some different configuration combinations and have not been to reproduce this issue with 2.15. Also, I&apos;ve tried different configuration combinations with 2.16 and I&apos;ve only seen this issue when parallel=classesAndMethods or parallel=all with the rest of the above configuration.&lt;/p&gt;</comment>
                            <comment id="14456089" author="tibor17" created="Mon, 10 Feb 2014 17:44:16 +0000"  >&lt;p&gt;@Chris&lt;br/&gt;
I have seen this issue as well.&lt;br/&gt;
Before the version 2.16 we have not proper parallelism. I implemented new parallelism and tested.&lt;br/&gt;
Since the old parallelism was not properly enabled you could not see this issue.&lt;br/&gt;
Now you have feature with concurrent execution, and the issue you can see in log should not be real because the test-methods are executed but their invocation is not properly handled by the logs.&lt;br/&gt;
In order to prove these symptoms put a little code in every test method and lunch mvn test again. This means print test-method name by an ordinal System.out.println(...) in it. Make sure every name of the particular method is unique in whole project. Then count them in your custom logs. Alternatively you can initialize an atomic counter, e.g. AtomicInteger, in a singleton and print post-increment value in every test-method. If you get deterministic number by every test round, the methods are called as expected but not printed by the plugin.&lt;br/&gt;
I guess you will have positive answer which means that it is known issue.&lt;/p&gt;</comment>
                            <comment id="14456225" author="chris.hansen" created="Tue, 11 Feb 2014 13:26:45 +0000"  >&lt;p&gt;@Tibor&lt;br/&gt;
Thank you for the suggestion. It is something I had tried using System.out.println(...) prior to submitting a bug. However, just now I was able to get a consistent test count by writing the count to a file in a shutdown hook. That means you are correct that the tests are being run, and there is a logging issue. I think System.out.println() output is subject to the same logging issue in question, which is why I hadn&apos;t gotten a consistent count previously.&lt;/p&gt;

&lt;p&gt;Is there an existing Jira issue for this (in which case I can close this one) or shall I change this issue to describe the logging bug?&lt;/p&gt;

&lt;p&gt;Also, thank you for your work on &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-814&quot; title=&quot;Parallel &amp;quot;both&amp;quot; setting does not execute classes in parallel&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-814&quot;&gt;&lt;del&gt;SUREFIRE-814&lt;/del&gt;&lt;/a&gt;, Tibor.&lt;/p&gt;</comment>
                            <comment id="14456183" author="krosenvold" created="Wed, 12 Feb 2014 00:57:39 +0000"  >&lt;p&gt;I have updated the developer docs on how to trace the output of the fork:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=maven-surefire.git;a=blob;f=maven-surefire-plugin/src/site/apt/developing.apt.vm&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=maven-surefire.git;a=blob;f=maven-surefire-plugin/src/site/apt/developing.apt.vm&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;See the section on &quot;tracing forked execution&quot;&lt;/p&gt;

&lt;p&gt;If you can do this, you can determine if the missing data is lost in the test runner on the forked side, or in the reporting subsystem within the actual plugin. You will typically need to grep the output for the classname you&apos;re investigating and see how much different stuff is reported. Also pay some attention to the second parameter in the output (the &quot;channel&quot;), and to which extent there may be any correlation to the channel number and lost test results.&lt;/p&gt;

</comment>
                            <comment id="14456172" author="krosenvold" created="Thu, 13 Feb 2014 00:36:24 +0000"  >&lt;p&gt;When applying this technique to the sample project it is very easy to see that the problem happens within the fork, not the reporting logic.   &lt;/p&gt;

&lt;p&gt;this means the bug is happening somewhere starting at ForkedBooter, ForkingReporterFactor, probably closer to the junit4 provider itself. It reproduces easily with the (excellent) test project !&lt;/p&gt;
</comment>
                            <comment id="14456059" author="krosenvold" created="Thu, 13 Feb 2014 01:01:54 +0000"  >&lt;p&gt;The plot thickens; everything is reported correctly to org.apache.maven.surefire.junitcore.ConcurrentRunListener#testStarting&lt;/p&gt;
</comment>
                            <comment id="14456147" author="krosenvold" created="Thu, 13 Feb 2014 11:52:29 +0000"  >&lt;p&gt;Fixed in 9ef1843ba4851b82b5c8eb8271ad352690be0cc9, thanks for the test case !&lt;/p&gt;</comment>
                            <comment id="14456088" author="chris.hansen" created="Thu, 13 Feb 2014 13:57:58 +0000"  >&lt;p&gt;Fantastic! Thanks Kristian.&lt;/p&gt;</comment>
                            <comment id="17994450" author="olamy" created="Fri, 4 Jul 2025 07:21:58 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/1474&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#1474&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12720221" name="surefire-output.txt" size="9585" author="chris.hansen" created="Tue, 21 Jan 2014 15:50:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bbhz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>