<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:13:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-1198] Failsafe does not allow to configure the jar file to use</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-1198</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;See &lt;a href=&quot;https://github.com/spring-projects/spring-boot/issues/4510#issuecomment-159448634&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this Spring Boot issue&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It seems that &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-855&quot; title=&quot;Allow failsafe to use actual jar file instead of target/classes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-855&quot;&gt;&lt;del&gt;SUREFIRE-855&lt;/del&gt;&lt;/a&gt; does not allow &lt;tt&gt;target/classes&lt;/tt&gt; to be used anymore. Is there a reason why this behaviour was completely removed in favour of only the jar file?&lt;/p&gt;

&lt;p&gt;It would be nice if we had an option to chose between the two (defaulting to the jar)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12916084">SUREFIRE-1198</key>
            <summary>Failsafe does not allow to configure the jar file to use</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tibordigana">Tibor Digana</assignee>
                                    <reporter username="snicoll">Stephane Nicoll</reporter>
                        <labels>
                    </labels>
                <created>Wed, 25 Nov 2015 09:01:06 +0000</created>
                <updated>Fri, 4 Jul 2025 07:24:48 +0000</updated>
                            <resolved>Sun, 25 Sep 2016 02:21:32 +0000</resolved>
                                                    <fixVersion>2.20</fixVersion>
                                        <due></due>
                            <votes>6</votes>
                                    <watches>15</watches>
                                                                                                                <comments>
                            <comment id="15026679" author="tibor17" created="Wed, 25 Nov 2015 12:06:35 +0000"  >&lt;p&gt;Yes there was a reason. The Surefire fixed this as a bug in Version 2.19.&lt;br/&gt;
Without it unit test and integration test would not make any difference. &lt;br/&gt;
The life cycle:&lt;br/&gt;
compile&lt;br/&gt;
test&lt;br/&gt;
package&lt;br/&gt;
integration-test&lt;br/&gt;
verify&lt;/p&gt;

&lt;p&gt;This means classes is tested in unit test&lt;br/&gt;
The package is tested in the integration tests.&lt;/p&gt;

&lt;p&gt;May I close this issue?&lt;/p&gt;</comment>
                            <comment id="15026712" author="azgard" created="Wed, 25 Nov 2015 12:53:43 +0000"  >&lt;p&gt;At first this sounds fully correct to me.&lt;/p&gt;

&lt;p&gt;But in second you ignore that some plugins reassemble the jar (shade-plugin or spring-boot-maven-plugin). That means in intergration tests is not the &quot;original&quot; jar attached and used, but the &quot;repackaged&quot; jar.&lt;/p&gt;

&lt;p&gt;If you use the repackaged jar in integration test, you have also the assigned dependencies artifacts in classpath. This is really a bad situation.&lt;/p&gt;

&lt;p&gt;Maybe the default should use the jar in intergration tests - but we should have a swicth to disable this and use target/classes instead.&lt;/p&gt;</comment>
                            <comment id="15026848" author="tibor17" created="Wed, 25 Nov 2015 14:32:05 +0000"  >&lt;p&gt;You can open a pull-request on GitHub and add parameter artifactName for failsafe only.&lt;br/&gt;
We already have such things in AbstractSurefireMojo.&lt;br/&gt;
Notice that classes folder is taken anyway if non-jar achive is packaged. For instance WAR file.&lt;/p&gt;</comment>
                            <comment id="15026854" author="snicoll" created="Wed, 25 Nov 2015 14:35:40 +0000"  >&lt;p&gt;Configuring the jar to use would work for us. I&apos;ll have a look.&lt;/p&gt;</comment>
                            <comment id="15027200" author="tibor17" created="Wed, 25 Nov 2015 17:24:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snicoll&quot; class=&quot;user-hover&quot; rel=&quot;snicoll&quot;&gt;snicoll&lt;/a&gt;&lt;br/&gt;
Is it now working for you?&lt;/p&gt;</comment>
                            <comment id="15027517" author="rfscholte" created="Wed, 25 Nov 2015 20:13:24 +0000"  >&lt;p&gt;I still think that everyone wants/expects (or should expect) the distributable to be tested and I&apos;m very willing to help solving related issues. So it seems like the plugin must also decide if should use the adjusted pom.xml, that would help, right?&lt;/p&gt;</comment>
                            <comment id="15027554" author="tibor17" created="Wed, 25 Nov 2015 20:32:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=azgard&quot; class=&quot;user-hover&quot; rel=&quot;azgard&quot;&gt;azgard&lt;/a&gt;&lt;br/&gt;
If you use assembly plugin, do you attach and override the artifact file with its default name? If you don&apos;t then two jars do not make sense since one of them is not testable.&lt;/p&gt;</comment>
                            <comment id="15027555" author="tibor17" created="Wed, 25 Nov 2015 20:36:09 +0000"  >&lt;p&gt;More than fixing this issue I would say we would need to have ClassLoader for war and ear due to currently only jar is supported in this feature. Maybe more archive types..&lt;/p&gt;</comment>
                            <comment id="15027647" author="snicoll" created="Wed, 25 Nov 2015 21:35:41 +0000"  >&lt;p&gt;What do you mean? I confirm that if surefire allows to configure the jar to use we are happy. &lt;/p&gt;</comment>
                            <comment id="15027677" author="rfscholte" created="Wed, 25 Nov 2015 21:54:10 +0000"  >&lt;p&gt;So you want to test with another jar then the one being uploaded/deployed? Sounds like an unnecessary hack to me. I suggest to attach a simple project exposing the problem so we all understand the problem.&lt;/p&gt;</comment>
                            <comment id="15028713" author="tibor17" created="Thu, 26 Nov 2015 13:04:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=snicoll&quot; class=&quot;user-hover&quot; rel=&quot;snicoll&quot;&gt;snicoll&lt;/a&gt;&lt;br/&gt;
How you want to continue if you close this ticket?&lt;br/&gt;
It is not fair if you close it without saying &quot;I fixed it like this and this...&quot;.&lt;/p&gt;</comment>
                            <comment id="15028807" author="azgard" created="Thu, 26 Nov 2015 13:48:44 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tibor17&quot; class=&quot;user-hover&quot; rel=&quot;tibor17&quot;&gt;tibor17&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;we are inverstigating the issue in the spring boot project. &lt;a href=&quot;https://github.com/spring-projects/spring-boot/issues/4510#issuecomment-159916604&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/spring-projects/spring-boot/issues/4510#issuecomment-159916604&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;I can reproduce it now. If you have a good old windows 2003/xp maybe you can try my testset to reproduce the bug. &lt;a href=&quot;https://github.com/kreyssel/spring-boot-failsafe-plugin-console-hang-test-set&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/kreyssel/spring-boot-failsafe-plugin-console-hang-test-set&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;But it looks like not an failsafe-plugin bug.&lt;/p&gt;</comment>
                            <comment id="15028978" author="tibor17" created="Thu, 26 Nov 2015 15:18:40 +0000"  >&lt;p&gt;The project is successfully running with one IT on Win7 in both cases&lt;br/&gt;
Surefire 2.18.1 and 2.19.&lt;br/&gt;
I will try to run (mvn verify) on WinXP in the evening.&lt;/p&gt;

&lt;p&gt;On Thu, Nov 26, 2015 at 2:49 PM, Conny Krey&#223;el (JIRA) &amp;lt;jira@apache.org&amp;gt;&lt;/p&gt;
</comment>
                            <comment id="15029258" author="tibor17" created="Thu, 26 Nov 2015 21:37:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=azgard&quot; class=&quot;user-hover&quot; rel=&quot;azgard&quot;&gt;azgard&lt;/a&gt;&lt;br/&gt;
Started the build of your project on WinXP and there really seems to be a problem.&lt;br/&gt;
The test started and timed out after 200 seconds. No idea why.&lt;br/&gt;
But another thing is interesteing to me. I printed std/out but I do not see anything in the console.&lt;br/&gt;
Most probably Stringboot overrides std/out when the test starts and the Surefire does not receive command TESTSET_FINISHED from std/in and therefore expects a new test class but there&apos;s only one. We are using std/in and out as communication channel between Maven process and Surefire forked JVM.&lt;br/&gt;
I don&apos;t see these logs:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;	@Before
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void check() {
		&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;################# B:TIBOR ##############&quot;&lt;/span&gt;);
		assertNotNull(ctrl);
	}
	
	@After
	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void after() {
		&lt;span class=&quot;code-object&quot;&gt;System&lt;/span&gt;.out.println(&lt;span class=&quot;code-quote&quot;&gt;&quot;################# A:TIBOR ##############&quot;&lt;/span&gt;);
	}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15029282" author="tibor17" created="Thu, 26 Nov 2015 22:09:30 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=azgard&quot; class=&quot;user-hover&quot; rel=&quot;azgard&quot;&gt;azgard&lt;/a&gt;&lt;br/&gt;
I was too fast writing the comment. I saw my System.out logs after the timeout 290 seconds.&lt;br/&gt;
This means the test hangs on WinXP before the test method starts, maybe in Spring Runner.&lt;br/&gt;
Why this is related only to old OS?&lt;br/&gt;
WDYT?&lt;/p&gt;</comment>
                            <comment id="15356767" author="snicoll" created="Thu, 30 Jun 2016 08:59:00 +0000"  >&lt;p&gt;I can see that this issue got closed but I don&apos;t see a way to configure the jar file to use. &lt;/p&gt;

&lt;p&gt;In a Spring Boot project, we repackage the main jar with the fat jar and we rename the original jar. In 1.4, we&apos;ve improved the jar layout and, long story short, failsafe doesn&apos;t work at all for us.&lt;/p&gt;

&lt;p&gt;We have a couple of workaround but having the ability to configure the jar file of the project that is going to be used is fairly important for us. Users of the shade plugin should find this useful as well.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://github.com/spring-projects/spring-boot/issues/6254&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this issue&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15357861" author="rfscholte" created="Thu, 30 Jun 2016 21:12:35 +0000"  >&lt;p&gt;IIUC the Spring Boot jar is a jar-in-name-only: it doesn&apos;t follow the specifications of a jar, classes are not in the root but in a subdirectory. I assume you&apos;re using a custom classloader to execute this jar, which means that the maven-failsafe-plugin should do the same.&lt;/p&gt;</comment>
                            <comment id="15358571" author="snicoll" created="Fri, 1 Jul 2016 07:29:43 +0000"  >&lt;p&gt;I disagree. Builds have different requirements. This particular one makes it so that the jar that should be used for ITs is not the main artifact of the project. Since we&apos;re forced to use the jar, making it configurable doesn&apos;t sound insane to me.&lt;/p&gt;</comment>
                            <comment id="15359561" author="rfscholte" created="Fri, 1 Jul 2016 20:13:17 +0000"  >&lt;p&gt;Failsafe &lt;b&gt;prefers&lt;/b&gt; to use the jar. If you bind it to an earlier phase when there&apos;s no jar, it&apos;ll use the folder with the test-classes. But then you should wonder why not using the maven-surefire-plugin instead?&lt;br/&gt;
So I had a look at the &lt;tt&gt;Spring-Boot-Maven-Failsafe-Plugin-Issue-master&lt;/tt&gt; project. It seems like you&apos;ve decided to introduce a &lt;tt&gt;BOOT-INFO/classes&lt;/tt&gt;, the &lt;tt&gt;META-INF/MANIFEST.MF&lt;/tt&gt; has an entry to this folder.&lt;br/&gt;
This made me aware that the plugin is actually still not good enough. In case of an executable jar ( i.e the Main-Class entry is specified) where the Class-Path is specified as well, it should use those entries. Spring Boot does something similar, but with own specified entries.&lt;br/&gt;
So the fix should be to be able to map or redirect classes.&lt;/p&gt;</comment>
                            <comment id="15504700" author="pwebb" created="Mon, 19 Sep 2016 21:08:16 +0000"  >&lt;p&gt;I spoke with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rfscholte&quot; class=&quot;user-hover&quot; rel=&quot;rfscholte&quot;&gt;rfscholte&lt;/a&gt; a little about this issue today. One option we might have is to find some way of plugging in a custom classloader that can deal with Spring Boot&apos;s layouts. This does seem quite involved so I wondering if instead we shouldn&apos;t look at what can be done with the &lt;tt&gt;getClassesDirectory()&lt;/tt&gt; method. Currently it looks like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; File getClassesDirectory()
    {
        Artifact artifact = getProject().getArtifact();
        File artifactFile = artifact.getFile();

        &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; useArtifactFile = artifactFile != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; artifactFile.isFile()
            &amp;amp;&amp;amp; artifactFile.getName().toLowerCase().endsWith( &lt;span class=&quot;code-quote&quot;&gt;&quot;.jar&quot;&lt;/span&gt; );

        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; useArtifactFile ? artifactFile : classesDirectory;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This is appears to be saying &quot;use the main artifact, if it&apos;s a JAR, otherwise use the classesDirectory&quot;. So, if the main artifact is set (which it will be if failsafe is bound the expected lifecyle) there is no way to force the &lt;tt&gt;classesDirectory&lt;/tt&gt; to be used. Perhaps we could change that logic so that if a specific &lt;tt&gt;classesDirectory&lt;/tt&gt; attribute has been configured, it&apos;s always used. That way Spring Boot could either set &lt;tt&gt;classesDirectory&lt;/tt&gt; to &lt;tt&gt;${project.build.outputDirectory&lt;/tt&gt; to force use of the folder or, more likely, set it to point to the original jar (before it was repackaged).&lt;/p&gt;
</comment>
                            <comment id="15504710" author="pwebb" created="Mon, 19 Sep 2016 21:11:22 +0000"  >&lt;p&gt;The javadoc for &lt;tt&gt;classesDirectory&lt;/tt&gt; appears to suggest that it could be used to specify an alternative JAR file, but this is not the case when the project artifact is set:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    /**
     * The path representing project &amp;lt;em&amp;gt;JAR&amp;lt;/em&amp;gt; file, &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; exists; Otherwise the directory containing generated
     * classes of the project being tested. This will be included after the test classes in the test classpath.
     */
    @Parameter( defaultValue = &lt;span class=&quot;code-quote&quot;&gt;&quot;${project.build.outputDirectory}&quot;&lt;/span&gt; )
    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; File classesDirectory;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15504861" author="tibor17" created="Mon, 19 Sep 2016 22:17:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pwebb&quot; class=&quot;user-hover&quot; rel=&quot;pwebb&quot;&gt;pwebb&lt;/a&gt;&lt;br/&gt;
A custom classloader is a good idea. I would propose the issue in 3.0 or 3.1.&lt;br/&gt;
We want to let the users give a chance to &quot;inject&quot; the code to Surefire/Failsafe from outside without asking the committer.&lt;/p&gt;</comment>
                            <comment id="15504972" author="pwebb" created="Mon, 19 Sep 2016 23:08:34 +0000"  >&lt;p&gt;That would be an ideal solution. In the short term, if we could just tell the plugin to use the backed up jar rather than the repackaged one, then we should be good. Spring Boot effectively creates a backup of the original JAR before it repackages it, I imagine if we pointed failsafe at that backup JAR then everything would work as before.&lt;/p&gt;</comment>
                            <comment id="15518547" author="tibor17" created="Sat, 24 Sep 2016 06:43:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=pwebb&quot; class=&quot;user-hover&quot; rel=&quot;pwebb&quot;&gt;pwebb&lt;/a&gt;&lt;br/&gt;
I think here is the fundamental problem in Spring group using integration tests. The ITs are inherently testing the interaction between jar files which is the purpose. So I am wondering why if these jars can run in the application server, the same file have problem to run in tests. I think it is unit tests started by &lt;tt&gt;maven-surefire-plugin&lt;/tt&gt; which you should rather use instead of &lt;tt&gt;maven-failsafe-plugin&lt;/tt&gt;. Surefire tests classes in particular module which is smaller granularity of tests.&lt;/p&gt;</comment>
                            <comment id="15519273" author="rfscholte" created="Sat, 24 Sep 2016 16:31:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;In the short term ...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;There are no temporary solutions. If we introduce a parameter, it&apos;ll stay there until at least the next major version. I have good hope that this can be fixed with the custom classloader option, so let&apos;s fix it immediately correct.&lt;/p&gt;</comment>
                            <comment id="15519997" author="tibor17" created="Sun, 25 Sep 2016 02:21:32 +0000"  >&lt;p&gt;commit f1aea63320b66e635e0dc27e4f9ecd0e155099d9&lt;br/&gt;
commit 432231e7e9d01b9ef109acd39176045e0b18e5a5&lt;/p&gt;</comment>
                            <comment id="15520012" author="pwebb" created="Sun, 25 Sep 2016 02:29:57 +0000"  >&lt;blockquote&gt;&lt;p&gt;I think here is the fundamental problem in Spring group using integration tests&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Just to be clear, the issue here was raised by Spring Boot &lt;b&gt;users&lt;/b&gt;, we&apos;ve not hit the problem in our own build.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The ITs are inherently testing the interaction between jar files which is the purpose. So I am wondering why if these jars can run in the application server, the same file have problem to run in tests&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Spring Boot creates &quot;Fat Jar&quot; files which a fully executable, there is no need for an application server. The layout is conceptually similar to a WAR file. Classes are under a &lt;tt&gt;BOOT-INF/classes&lt;/tt&gt; folder and dependent libraries are under &lt;tt&gt;BOOT-INF/lib&lt;/tt&gt;. We have a custom &lt;tt&gt;URLHandler&lt;/tt&gt; and &lt;tt&gt;Classloader&lt;/tt&gt; that actually launches the application.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think it is unit tests started by maven-surefire-plugin which you should rather use instead of maven-failsafe-plugin. Surefire tests classes in particular module which is smaller granularity of tests.&lt;/p&gt;&lt;/blockquote&gt;


&lt;p&gt;I think it&apos;s a little confusing to suggest that users should switch to surefire for integration tests, especially given that the plugin previously worked well. I&apos;m especially concerned that there is so much documentation out there for using failsafe, and so many differences with configuration (e.g. the bound lifecycle, the use of *IT.java) that it will be quite hard to explain why it shouldn&apos;t be used.&lt;/p&gt;

&lt;p&gt;I did look into how we might be able to plug in a different classloader, but it&apos;s quite hard because most of the classpath is actually built in &lt;tt&gt;AbstractSurefireMojo.generateTestClasspath&lt;/tt&gt;. We really don&apos;t want to mess with that, we just want to return a different JAR file (as it appeared before we repackaged it) from &lt;tt&gt;getClassesDirectory()&lt;/tt&gt; or failing that use the &lt;tt&gt;project.build.outputDirectory&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;I&apos;m still wondering why we can&apos;t use the &lt;tt&gt;classesDirectory&lt;/tt&gt; parameter. It seems odd to me that the setting is completely ignored when dealing with &lt;tt&gt;.jar&lt;/tt&gt; files. I haven&apos;t had time to actually try the change yet, but I was hoping to submit a PR that:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Changed &lt;tt&gt;classesDirectory&lt;/tt&gt; so that it no longer has a &lt;tt&gt;defaultValue&lt;/tt&gt;.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Updated &lt;tt&gt;getClassesDirectory()&lt;/tt&gt; so that if &lt;tt&gt;classesDirectory&lt;/tt&gt; is not &lt;tt&gt;null&lt;/tt&gt; it&apos;s returned&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Update the final line to &lt;tt&gt;return useArtifactFile ? artifactFile : ${project.build.outputDirectory};&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Is that something that&apos;s worth pursuing? It seems a lot simpler than trying to write another classloader, and I think it would be generally useful for any project that does something different with the primary artifact JAR.&lt;/p&gt;



</comment>
                            <comment id="15520033" author="pwebb" created="Sun, 25 Sep 2016 02:48:47 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tibor17&quot; class=&quot;user-hover&quot; rel=&quot;tibor17&quot;&gt;tibor17&lt;/a&gt;!! Exactly what I had in mind.&lt;/p&gt;</comment>
                            <comment id="15520070" author="hudson" created="Sun, 25 Sep 2016 03:17:48 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build maven-surefire #1626 (See &lt;a href=&quot;https://builds.apache.org/job/maven-surefire/1626/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/maven-surefire/1626/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1198&quot; title=&quot;Failsafe does not allow to configure the jar file to use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1198&quot;&gt;&lt;del&gt;SUREFIRE-1198&lt;/del&gt;&lt;/a&gt; Failsafe does not allow to configure the jar file to use (tibor17: rev f1aea63320b66e635e0dc27e4f9ecd0e155099d9)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(add) maven-failsafe-plugin/src/test/java/org/apache/maven/plugin/failsafe/IntegrationTestMojoTest.java&lt;/li&gt;
	&lt;li&gt;(edit) maven-surefire-plugin/src/site/apt/examples/configuring-classpath.apt.vm&lt;/li&gt;
	&lt;li&gt;(edit) maven-failsafe-plugin/pom.xml&lt;/li&gt;
	&lt;li&gt;(edit) maven-failsafe-plugin/src/main/java/org/apache/maven/plugin/failsafe/IntegrationTestMojo.java&lt;/li&gt;
	&lt;li&gt;(edit) maven-surefire-plugin/src/site/fml/faq.fml&lt;/li&gt;
	&lt;li&gt;(edit) pom.xml&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15520132" author="hudson" created="Sun, 25 Sep 2016 04:05:20 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build maven-surefire #1627 (See &lt;a href=&quot;https://builds.apache.org/job/maven-surefire/1627/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/maven-surefire/1627/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1198&quot; title=&quot;Failsafe does not allow to configure the jar file to use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1198&quot;&gt;&lt;del&gt;SUREFIRE-1198&lt;/del&gt;&lt;/a&gt; Failsafe does not allow to configure the jar file to use (tibor17: rev 432231e7e9d01b9ef109acd39176045e0b18e5a5)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) maven-failsafe-plugin/src/main/java/org/apache/maven/plugin/failsafe/IntegrationTestMojo.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16674062" author="rustamabd" created="Sat, 3 Nov 2018 14:32:05 +0000"  >&lt;p&gt;Failsafe is NOT working with Spring Boot in repackage mode since version&#160;2.19.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            &amp;lt;plugin&amp;gt;
                &amp;lt;groupId&amp;gt;org.springframework.boot&amp;lt;/groupId&amp;gt;
                &amp;lt;artifactId&amp;gt;spring-boot-maven-plugin&amp;lt;/artifactId&amp;gt;
                &amp;lt;version&amp;gt;2.1.0.RELEASE&amp;lt;/version&amp;gt;
                &amp;lt;executions&amp;gt;
                    &amp;lt;execution&amp;gt;
                        &amp;lt;goals&amp;gt;
                            &amp;lt;goal&amp;gt;repackage&amp;lt;/goal&amp;gt;
                        &amp;lt;/goals&amp;gt;
                    &amp;lt;/execution&amp;gt;
                &amp;lt;/executions&amp;gt;
            &amp;lt;/plugin&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Causes&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.ArrayStoreException: sun.reflect.annotation.TypeNotPresentExceptionProxy
	at sun.reflect.annotation.AnnotationParser.parseClassArray(AnnotationParser.java:724)
	at sun.reflect.annotation.AnnotationParser.parseArray(AnnotationParser.java:531)
	at sun.reflect.annotation.AnnotationParser.parseMemberValue(AnnotationParser.java:355)
	at sun.reflect.annotation.AnnotationParser.parseAnnotation2(AnnotationParser.java:286)
	at sun.reflect.annotation.AnnotationParser.parseAnnotations2(AnnotationParser.java:120)
	at sun.reflect.annotation.AnnotationParser.parseAnnotations(AnnotationParser.java:72)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.createAnnotationData(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:3521)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.annotationData(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:3510)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.getAnnotation(&lt;span class=&quot;code-object&quot;&gt;Class&lt;/span&gt;.java:3415)
	at org.apache.maven.surefire.common.junit4.JUnit4TestChecker.isValidJUnit4Test(JUnit4TestChecker.java:66)
	at org.apache.maven.surefire.common.junit4.JUnit4TestChecker.accept(JUnit4TestChecker.java:53)
	at org.apache.maven.surefire.util.DefaultScanResult.applyFilter(DefaultScanResult.java:102)
	at org.apache.maven.surefire.junit4.JUnit4Provider.scanClassPath(JUnit4Provider.java:309)
	at org.apache.maven.surefire.junit4.JUnit4Provider.setTestsToRun(JUnit4Provider.java:189)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:132)
	at org.apache.maven.surefire.booter.ForkedBooter.invokeProviderInSameClassLoader(ForkedBooter.java:384)
	at org.apache.maven.surefire.booter.ForkedBooter.runSuitesInProcess(ForkedBooter.java:345)
	at org.apache.maven.surefire.booter.ForkedBooter.execute(ForkedBooter.java:126)
	at org.apache.maven.surefire.booter.ForkedBooter.main(ForkedBooter.java:418)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;So we&apos;re stuck with version &lt;b&gt;2.18.1&lt;/b&gt; at the moment.&lt;/p&gt;

&lt;p&gt;How to use Failsafe with the repackage goal?&lt;/p&gt;</comment>
                            <comment id="16674086" author="snicoll" created="Sat, 3 Nov 2018 15:47:17 +0000"  >&lt;p&gt;I don&apos;t thinks that error is related to this issue. Spring Boot is using Failsafe 2.22.1 in &lt;tt&gt;spring-boot-starter-parent&lt;/tt&gt; with this extra configuration&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;configuration&amp;gt;
    &amp;lt;classesDirectory&amp;gt;${project.build.outputDirectory}&amp;lt;/classesDirectory&amp;gt;
&amp;lt;/configuration&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16674157" author="rustamabd" created="Sat, 3 Nov 2018 18:46:26 +0000"  >&lt;p&gt;Ah OK thanks! We don&apos;t inherit from spring-boot-starter-parent (because we must inherit from our corporate parent pom), so didn&apos;t have that configuration. It&apos;s working now indeed.&lt;/p&gt;</comment>
                            <comment id="17994598" author="olamy" created="Fri, 4 Jul 2025 07:24:48 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/2489&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#2489&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="13050433">SUREFIRE-1343</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13050433">SUREFIRE-1343</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2owzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>