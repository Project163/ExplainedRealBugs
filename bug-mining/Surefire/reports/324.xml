<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:10:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-800] redirectTestOutputToFile is not taken into account in all cases with JUnit47 provider</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-800</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;With the following class:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;public class Test0 {

  public Test0(){
    System.out.println(&quot;Constructor&quot;);
  }

  @Test
  public void testT0() throws Exception {
    System.out.println(&quot;testT0&quot;);
  }

  @Test
  public void testT1() throws Exception {
    System.out.println(&quot;testT1&quot;);
  }

  @BeforeClass
  public static void setUpBeforeClass() throws Exception {
    System.out.println(&quot;setUpBeforeClass&quot;);
  }

  @AfterClass
  public static void tearDownAfterClass() throws Exception {
    System.out.println(&quot;tearDownAfterClass&quot;);
  }

  @Before
  public void setUp() throws Exception {
    System.out.println(&quot;setUp&quot;);
  }

  @After
  public void tearDown() throws Exception {
    System.out.println(&quot;tearDown&quot;);
  }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Some elements of the output are not redirected with JUNit47.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Concurrency config is parallel=&apos;none&apos;, perCoreThreadCount=true, threadCount=2, useUnlimitedThreads=false
setUpBeforeClass
Constructor
Constructor
tearDownAfterClass
Running Test0
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.01 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;While it&apos;s ok with with JUNit4:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;-------------------------------------------------------
 T E S T S
-------------------------------------------------------
Running Test0
Tests run: 2, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 0.09 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>all</environment>
        <key id="12810318">SUREFIRE-800</key>
            <summary>redirectTestOutputToFile is not taken into account in all cases with JUnit47 provider</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="krosenvold">Kristian Rosenvold</assignee>
                                    <reporter username="nkeywal">Nicolas Liochon</reporter>
                        <labels>
                    </labels>
                <created>Sat, 26 Nov 2011 09:11:35 +0000</created>
                <updated>Fri, 4 Jul 2025 07:17:18 +0000</updated>
                            <resolved>Sun, 16 Dec 2012 09:59:47 +0000</resolved>
                                    <version>2.10</version>
                                    <fixVersion>2.13</fixVersion>
                                    <component>Junit 4.7+ (parallel) support</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14455185" author="nkeywal" created="Sat, 26 Nov 2011 09:19:38 +0000"  >&lt;p&gt;Seems that I can&apos;t edit the title. It should be: not taken into account in all cases.&lt;/p&gt;</comment>
                            <comment id="14455099" author="krosenvold" created="Tue, 13 Dec 2011 14:27:16 +0000"  >&lt;p&gt;Due to the fact the JUnit does not demarcate class start/stop in any sensible way in the notification api, getting this issue /right/ is a &lt;b&gt;lot&lt;/b&gt; harder than it seems, maybe even impossible for parallel=&quot;classes&quot;. For &quot;methods&quot; it may be possible to make it reliable, and &quot;both&quot; I am simply not sure of.&lt;/p&gt;

&lt;p&gt;There are some threading notes written in ConcurrentReporterManager, and the main problem is to determine when one class has finished and another has started, so attaching &quot;class&quot; level output to any given test-class correctly is hard/impossible. I have tried several times to fix this, and after a few hours I always realize this is not possible/wont work well. Again, the main problem here should really be fixed in the JUnit project as far as I can understand.&lt;/p&gt;

&lt;p&gt;Someone might want to try to make a patch for &quot;methods&quot;; I&apos;m moving this issue to the backlog until such a patch shows up &lt;/p&gt;</comment>
                            <comment id="14455255" author="krosenvold" created="Tue, 13 Dec 2011 14:29:34 +0000"  >&lt;p&gt;These issues are related because they both depend on the same underlying JUnit issue; JUnit does not demarcate &quot;beforeClass and afterClass&quot; in the listener api.&lt;/p&gt;</comment>
                            <comment id="14455138" author="nkeywal" created="Wed, 14 Dec 2011 08:40:36 +0000"  >&lt;p&gt;Note that with &quot;category&quot; implementation, we&apos;re now using JUnit47 provider in non parallel runs. And with the implementation of parallel run at the process level, it&apos;s a little bit less necessary than before to parallelize at the method/class level, so may be a specific NonConcurrentReporterManager could do the trick?&lt;/p&gt;

&lt;p&gt;Today, we&apos;re using *output.txt to analyze the behavior when something went wrong. In this file, there is no split per method, it&apos;s only per class.&lt;/p&gt;</comment>
                            <comment id="14455205" author="krosenvold" created="Wed, 14 Dec 2011 09:37:39 +0000"  >&lt;p&gt;Well the &quot;NonConcurrentReporterManager&quot; is the one thing I /will/ try to fix  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14455361" author="krosenvold" created="Sun, 8 Jan 2012 15:24:58 +0000"  >&lt;p&gt;Asssigning to backlog helps &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Beforeclass/aterclass console output fixed for &quot;classes&quot; mode in r1228960&lt;/p&gt;</comment>
                            <comment id="14455196" author="nkeywal" created="Sun, 8 Jan 2012 15:32:48 +0000"  >&lt;p&gt;This one is great! Thanks for all your help, Kristian.&lt;/p&gt;</comment>
                            <comment id="14455211" author="krosenvold" created="Mon, 9 Jan 2012 11:28:58 +0000"  >&lt;p&gt;Always rewarding when someone takes an interest, so thank you too !&lt;/p&gt;</comment>
                            <comment id="14455351" author="krosenvold" created="Sat, 21 Jul 2012 15:14:29 +0000"  >&lt;p&gt;This fix had to be reverted &amp;amp; reopened since the additional runner indirection was causing severe problems&lt;/p&gt;</comment>
                            <comment id="14455470" author="nkeywal" created="Mon, 13 Aug 2012 11:10:45 +0000"  >&lt;p&gt;Hello Kristian,&lt;/p&gt;

&lt;p&gt;I had a look at the fix and its revert, I saw that you reverted only a very small part of it. Does it mean you think you will be able to finally fix it?&lt;/p&gt;

&lt;p&gt;Thanks in advance!&lt;/p&gt;


</comment>
                            <comment id="14455521" author="krosenvold" created="Mon, 13 Aug 2012 14:03:04 +0000"  >&lt;p&gt;I dont know &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I don&apos;t think I&apos;ll be prioritizing this stuff anytime soon. So unless someone submits a better patch it&apos;ll probably go to the backlog.&lt;/p&gt;</comment>
                            <comment id="14455409" author="nkeywal" created="Tue, 14 Aug 2012 05:34:08 +0000"  >&lt;p&gt;Thanks for the reply, it&apos;s a bad news for us...&lt;br/&gt;
It seems root cause is in JUnit, so we have to use workarounds...&lt;/p&gt;</comment>
                            <comment id="14455578" author="nkeywal" created="Thu, 23 Aug 2012 12:27:12 +0000"  >&lt;p&gt;Hi Kristian,&lt;/p&gt;

&lt;p&gt;In 800.v1.patch, I tried the NonConcurrentReportManager approach, it covers the cases with forkMode=always or perthread, i.e. the ones that are more likely to have outputs outside of the tested methods themselves. Unit &amp;amp; Integration tests are ok. It seems to work well on our project as well.&lt;/p&gt;

&lt;p&gt;With forkMode=perthread, the tests results (stuff like:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Running org.apache.hadoop.hbase.util.hbck.TestOfflineMetaRebuildBase
Tests run: 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 15.671 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;are not synchronized at all anymore. It happens sometimes already on 2.12 (when two tests are finishing simultaneously), but now it happens all the time.&lt;br/&gt;
I think the simplest way to fix this would be to do add the shortened class name in the result, like&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Tests run (oahhuh.TestOfflineMetaRebuildBase): 5, Failures: 0, Errors: 0, Skipped: 0, Time elapsed: 15.671 sec
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This said, even if it stays like this it fine for us.&lt;/p&gt;

&lt;p&gt;Tell me if you want me to change something, it would be great if it could be integrated.&lt;/p&gt;</comment>
                            <comment id="14455579" author="nkeywal" created="Wed, 12 Sep 2012 05:52:31 +0000"  >&lt;p&gt;Hi Kristian,&lt;/p&gt;

&lt;p&gt;Any feedback on this patch? I think it fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-817&quot; title=&quot;JUnit 4.7 test output is always buffered, lost if forked process exits abnormally&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-817&quot;&gt;&lt;del&gt;SUREFIRE-817&lt;/del&gt;&lt;/a&gt; as well BTW.&lt;br/&gt;
I can add the class name in the &quot;Tests run&quot; line if you confirm you&apos;re ok with the patch globally...&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="14455562" author="krosenvold" created="Wed, 12 Sep 2012 06:18:50 +0000"  >&lt;p&gt;Not yet, I&apos;ll be doing a very minor bugfix release for surefire &quot;soon&quot; and will look at it then.&lt;/p&gt;</comment>
                            <comment id="14455412" author="krosenvold" created="Tue, 18 Sep 2012 14:55:05 +0000"  >&lt;p&gt;I applied the patch and the testcase to a branch on github. I added your testclass to surefire-integration-tests/src/test/resources/junit47-redirect-output&lt;/p&gt;

&lt;p&gt;If you run:&lt;br/&gt;
git clone --branch=SUREFIRE800 &lt;a href=&quot;https://github.com/krosenvold/maven-surefire&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/krosenvold/maven-surefire&lt;/a&gt;&lt;br/&gt;
cd maven-surefire/surefire-integration-tests/src/test/resources/junit47-redirect-output&lt;br/&gt;
mvn -Dsurefire.version=2.12.3 -Dtest=Test0 test&lt;br/&gt;
cat target/surefire-reports/junit47ConsoleOutput.Test0-output.txt &lt;/p&gt;

&lt;p&gt;If I build the version with your patch, nothing really changes in the status of the console output and the output text files either .... ?&lt;/p&gt;</comment>
                            <comment id="14455450" author="nkeywal" created="Wed, 19 Sep 2012 08:05:00 +0000"  >&lt;p&gt;2.12.3: cat target/surefire-reports/junit47ConsoleOutput.Test0-output.txt&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Constructor
setUp
testT0
tearDown
Constructor
setUp
testT1
tearDown
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2.13-SNAPSHOT with 800 cat target/surefire-reports/junit47ConsoleOutput.Test0-output.txt&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;setUpBeforeClass
Constructor
setUp
testT0
tearDown
Constructor
setUp
testT1
tearDown
tearDownAfterClass
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;setUpBeforeClass / tearDownAfterClass are in the output when using the version #800 (as expected).&lt;/p&gt;

&lt;p&gt;But may be I misunderstood your point?&lt;/p&gt;</comment>
                            <comment id="14455603" author="nkeywal" created="Mon, 12 Nov 2012 05:12:43 +0000"  >&lt;p&gt;Hi Kristian,&lt;/p&gt;

&lt;p&gt;Did you have some time to look at this jira?&lt;/p&gt;</comment>
                            <comment id="14455569" author="krosenvold" created="Mon, 12 Nov 2012 05:54:59 +0000"  >&lt;p&gt;Yeah, sorry. Will get this sorted RSN&lt;/p&gt;</comment>
                            <comment id="14455574" author="nkeywal" created="Wed, 12 Dec 2012 08:50:54 +0000"  >&lt;p&gt;Hi Kristian,&lt;/p&gt;

&lt;p&gt;Any news on this?&lt;/p&gt;

&lt;p&gt;Thanks!&lt;/p&gt;</comment>
                            <comment id="14455668" author="krosenvold" created="Thu, 13 Dec 2012 08:59:35 +0000"  >&lt;p&gt;Fixed in 9b3beb4f6a1890d7a8ee916219ac2f0bedef8fcd, thanks for the patch !&lt;/p&gt;

&lt;p&gt;Sorry for the delay, but when I first saw this patch I was almost sure there was a problem with it, and it just slipped day by day until now. &lt;/p&gt;

&lt;p&gt;I had to modify the patch quite significantly to make it work for &amp;gt;1 test class in any non-parallel mode, which it now does. &lt;/p&gt;</comment>
                            <comment id="14455487" author="nkeywal" created="Thu, 13 Dec 2012 09:21:22 +0000"  >&lt;p&gt;Thanks a lot for all this, Kristian.&lt;/p&gt;</comment>
                            <comment id="14455691" author="krosenvold" created="Sat, 15 Dec 2012 23:53:20 +0000"  >&lt;p&gt;This is currently breaking ITs on CI and is blocking release. This is due to different run-order of tests on jdk5, and the problem is &apos;real&apos;&lt;/p&gt;</comment>
                            <comment id="14455621" author="nkeywal" created="Sun, 16 Dec 2012 06:05:48 +0000"  >&lt;p&gt;Would it be a solution to limit the usage of this nonconcurrent manager to the &apos;once&apos; &amp;amp; &apos;perthread&apos; forkmode? At least short term?&lt;/p&gt;</comment>
                            <comment id="14455486" author="krosenvold" created="Sun, 16 Dec 2012 09:59:47 +0000"  >&lt;p&gt;The problem is &quot;fixed&quot; (as in &quot;understood&quot;, not solved). This is the ever-recurring issue that junit core does not allow us to demarcate the border between classes. The actual &quot;problem&quot; is not new, but was caused by a test running in different order on CI.&lt;/p&gt;</comment>
                            <comment id="17994199" author="olamy" created="Fri, 4 Jul 2025 07:17:18 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/1763&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#1763&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310260">
                    <name>Related</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12810332">SUREFIRE-827</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12809554">SUREFIRE-793</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12720301" name="800.v1.patch" size="8027" author="nkeywal" created="Thu, 23 Aug 2012 12:27:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2balj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>