<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:08:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-690] testSetCompleted called before testSetStarting when using m3 parallel builds</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-690</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;This is running m3 with -T 1C (8 core build machine).&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;17:52:38&amp;#93;&lt;/span&gt;: &lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.7.1:test (default-test) on project hornet-stinger: Error while executing forked tests.; nested exception is java.lang.IllegalStateException: testSetCompleted called before testSetStarting -&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;br/&gt;
Seems like it doesn&apos;t happen as frequently as previously&lt;/p&gt;</description>
                <environment></environment>
        <key id="12809690">SUREFIRE-690</key>
            <summary>testSetCompleted called before testSetStarting when using m3 parallel builds</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="krosenvold">Kristian Rosenvold</assignee>
                                    <reporter username="gchen77">Tim Chen</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Jan 2011 13:18:00 +0000</created>
                <updated>Fri, 4 Jul 2025 07:15:19 +0000</updated>
                            <resolved>Sun, 8 May 2011 15:42:24 +0000</resolved>
                                    <version>2.7.1</version>
                                    <fixVersion>2.9</fixVersion>
                                    <component>Junit 4.7+ (parallel) support</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14454926" author="krosenvold" created="Mon, 28 Feb 2011 07:42:25 +0000"  >&lt;p&gt;Are you setting the &quot;forkTimeout&quot; parameter in your surefire settings ? We have identified a race condition that could occur if the forked process times out while still outputting to stdout/stderr. Just setting &quot;forkTimeout&quot; is actually enough to trigger &lt;br/&gt;
this, it would happen even with &quot;forkMode=never&quot; as long as forkTimeout is set.&lt;/p&gt;

&lt;p&gt;Actually the issue would probably happen quite frequently as long as the process outputs to stderr/stdout at the exact time it times out with &quot;forkTimeout&quot;. &lt;/p&gt;</comment>
                            <comment id="14456967" author="gchen77" created="Mon, 28 Feb 2011 08:21:33 +0000"  >&lt;p&gt;yes I am. more specifically &lt;tt&gt;forkedProcessTimeoutInSeconds&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="14454837" author="krosenvold" created="Mon, 28 Feb 2011 09:09:57 +0000"  >&lt;p&gt;And can you confirm that either&lt;br/&gt;
A) The exception always happens when the tests were supposed to time out&lt;br/&gt;
B) Increasing the timeout seems to help &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; (Say doubling its current value)&lt;/p&gt;</comment>
                            <comment id="14454925" author="gchen77" created="Mon, 28 Feb 2011 09:19:13 +0000"  >&lt;p&gt;For now I&apos;m testing with the value off but I can try it by using a lower value than I know a verbose (lots of output) test takes.&lt;/p&gt;</comment>
                            <comment id="14454793" author="krosenvold" created="Thu, 3 Mar 2011 14:27:24 +0000"  >&lt;p&gt;Plexus utils 2.0.7 will be appearing in maven central in a few hours. Adding this to surefire should solve this issue;&lt;br/&gt;
        &amp;lt;plugin&amp;gt;&lt;br/&gt;
          &amp;lt;artifactId&amp;gt;maven-surefire-plugin&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
          ....&lt;br/&gt;
          &amp;lt;dependencies&amp;gt;&lt;br/&gt;
            &amp;lt;dependency&amp;gt;&lt;br/&gt;
              &amp;lt;groupId&amp;gt;org.codehaus.plexus&amp;lt;/groupId&amp;gt;&lt;br/&gt;
              &amp;lt;artifactId&amp;gt;plexus-utils&amp;lt;/artifactId&amp;gt;&lt;br/&gt;
              &amp;lt;version&amp;gt;2.0.7&amp;lt;/version&amp;gt;&lt;br/&gt;
            &amp;lt;/dependency&amp;gt;&lt;br/&gt;
          &amp;lt;/dependencies&amp;gt;&lt;br/&gt;
        &amp;lt;/plugin&amp;gt;&lt;/p&gt;

&lt;p&gt;Please report back on the effects of this.&lt;/p&gt;</comment>
                            <comment id="14454940" author="gchen77" created="Thu, 3 Mar 2011 22:10:16 +0000"  >&lt;p&gt;I got another one today after setting timeout to 0.&lt;br/&gt;
I haven&apos;t verified yet that it was running with no timeout settings but it was the first one since setting it.&lt;br/&gt;
So it definitely seems to be related as it happened way more frequently before.&lt;br/&gt;
I will try it again now with the new plexus-utils but I can&apos;t guarantee that I will know the results anytime soon as this is intermittent and I still haven&apos;t had time to come up with a test case.&lt;/p&gt;</comment>
                            <comment id="14454869" author="krosenvold" created="Fri, 4 Mar 2011 01:28:57 +0000"  >&lt;p&gt;OK, this indicates that there are probably several distinct issues causing this problem. You can either add plexus to your surefire-declaration (2.7.2) or just switch to 2.8-SNAPSHOT.&lt;/p&gt;

&lt;p&gt;Could you give me some indication of the frequency of this issue in its current state ? The redirectTestOuputToFile logice is due for a revision in 2.8.1 or so, and it&apos;s basically the source of all these troubles. Is the &lt;br/&gt;
remaining frequency is more in the &quot;annoyance&quot; category?&lt;/p&gt;</comment>
                            <comment id="14456980" author="gchen77" created="Mon, 7 Mar 2011 10:27:49 +0000"  >&lt;p&gt;Hey Kristian, Sry I think I misunderstood you earlier.&lt;br/&gt;
I added the plexus-utils to surefire 2.7.1 not 2.7.2 and got this error again today.&lt;br/&gt;
Did you mean that this also needed 2.7.2 to work correctly?&lt;br/&gt;
Unfortunately I can&apos;t switch to 2.8-SNAPSHOT just yet as I am locked to using release only versions ATM.&lt;/p&gt;</comment>
                            <comment id="14454912" author="krosenvold" created="Mon, 7 Mar 2011 11:03:04 +0000"  >&lt;p&gt;2.7.2 (released) with the addition of plexus-utils 2.0.7 (released) should be identical to 2.8-.SNAPSHOT wrt this error.&lt;/p&gt;

&lt;p&gt;I will be releasing 2.8 within the next 48 hours, so I think we can just defer this until 2.8 is released and re-test then.&lt;/p&gt;</comment>
                            <comment id="14456975" author="gchen77" created="Mon, 7 Mar 2011 11:13:06 +0000"  >&lt;p&gt;Sounds good to me &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14456976" author="gchen77" created="Mon, 14 Mar 2011 18:30:53 +0000"  >&lt;p&gt;I got this again in 2.8.&lt;br/&gt;
I should note, however, that I also turned the timeout back on when I updated to 2.8.&lt;br/&gt;
Do you need a stack trace? I can probably get one pretty quickly with the frequency of this bug&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[18:16:29]: [ERROR] Failed to execute goal org.apache.maven.plugins:maven-surefire-plugin:2.8:test (default-test) on project chameleon-main: Error while executing forked tests.; nested exception is java.lang.IllegalStateException: testSetStarting called twice -&amp;gt; [Help 1]
[18:16:29]: [ERROR] 
[18:16:29]: [ERROR] To see the full stack trace of the errors, re-run Maven with the -e switch.
[18:16:29]: [ERROR] Re-run Maven using the -X switch to enable full debug logging.
[18:16:29]: [ERROR] 
[18:16:29]: [ERROR] For more information about the errors and possible solutions, please read the following articles:
[18:16:29]: [ERROR] [Help 1] http://cwiki.apache.org/confluence/display/MAVEN/MojoExecutionException
[18:16:29]: [ERROR] 
[18:16:29]: [ERROR] After correcting the problems, you can resume the build with the command
[18:16:29]: [ERROR]   mvn &amp;lt;goals&amp;gt; -rf :chameleon-main
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14454913" author="krosenvold" created="Tue, 15 Mar 2011 05:09:34 +0000"  >&lt;p&gt;The issue you&apos;re seeing now is actually a design problem with parallel surefire providers and redirectTestOuputToFile=true, because you&apos;re running parallel junit (and parallel m3, which is not relevant).  (All the others issues we&apos;ve been having with 2.7.X and redirectTestOuputToFile= true have been just basic thread safety issues that affect all users of redirectTestOuputToFile).&lt;/p&gt;

&lt;p&gt;Until we fixed &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-700&quot; title=&quot;Surefire is not isolated from itself&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-700&quot;&gt;&lt;del&gt;SUREFIRE-700&lt;/del&gt;&lt;/a&gt; there was no way to fix this issue, but now that this is done it should be much simpler. I am working on this for 2.8.1. Until then, the only way to make this reliable is either to turn off parallel junit &lt;b&gt;or&lt;/b&gt; redirectTestOuputToFile.&lt;/p&gt;</comment>
                            <comment id="14454941" author="gchen77" created="Tue, 15 Mar 2011 20:43:14 +0000"  >&lt;p&gt;Actually Kristian this is only running parallel m3 (-T 1C) at the moment. redirectTestOutputToFile may be on but definitely not parallel junit.&lt;/p&gt;</comment>
                            <comment id="14454985" author="krosenvold" created="Sun, 8 May 2011 15:42:24 +0000"  >&lt;p&gt;As of &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-732&quot; title=&quot;Clean up/simplify reporting logic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-732&quot;&gt;&lt;del&gt;SUREFIRE-732&lt;/del&gt;&lt;/a&gt; with the followup in r1100808 this whole logic was simplified to the extent that this problem cannot happen any more. Revised 2.8.2-SNAPSHOT uploaded to r.a.o.&lt;/p&gt;</comment>
                            <comment id="17994093" author="olamy" created="Fri, 4 Jul 2025 07:15:19 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/1887&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#1887&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bc9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>