<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:06:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-47] JUnit suite() method ends up being called twice when tests are run with Surefire</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-47</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;JUnit defines that the static suite() method is only instantiated once.&lt;/p&gt;

&lt;p&gt;However, the recent release of surefire (2.0) seems to call the suite() method twice. &lt;br/&gt;
the first time it&apos;s called from during the creation of all suites (see the first stacktrace in the attached test.out files) - the JUnitTestSet calls &quot;suite()&quot; to instantiate a test object so that it can call countTestCases() on it. &lt;/p&gt;

&lt;p&gt;The second time the suite() method is called during the actual test execution, when Surefire.run() iterates over all the collected test suites and eventually calls into JUnitTestSet.execute() method.&lt;/p&gt;

&lt;p&gt;a sample project is attached. I added an exception stacktrace into every occurence of the suite() method.&lt;/p&gt;

&lt;p&gt;there&apos;s also a build.xml file to run the &apos;ant test&apos; command for comparison. &lt;/p&gt;

&lt;p&gt;There&apos;s also a test.out file with the sample output.&lt;/p&gt;

&lt;p&gt;Suggested fixes:&lt;br/&gt;
Is it possible to pass the suite itself to the JUnitTestSet w/out having to create it again? &lt;br/&gt;
We rely on suite() being called only once, and create one-time operations there (such as creating a few singletons) so this bug is a pain.&lt;/p&gt;
</description>
                <environment>maven 2.0.4, ant 1.6.5, this is on MacOSX 10.4.6</environment>
        <key id="12809965">SUREFIRE-47</key>
            <summary>JUnit suite() method ends up being called twice when tests are run with Surefire</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="toli">Toli Kuznets</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Jun 2006 14:58:55 +0000</created>
                <updated>Fri, 4 Jul 2025 05:48:00 +0000</updated>
                            <resolved>Sun, 25 Nov 2007 20:19:36 +0000</resolved>
                                    <version>2.0 (2.2 plugin)</version>
                                    <fixVersion>2.4</fixVersion>
                                        <due></due>
                            <votes>4</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14454097" author="dfabulich" created="Fri, 23 Nov 2007 20:31:32 +0000"  >&lt;p&gt;This happens in JUnitTestSet; what&apos;s strange is that we don&apos;t do this in TestNGTestSet.  &quot;getTestCount()&quot; simply returns 1 in that case, with a TODO &quot;need to get this from TestNG somehow&quot;.  This is filed as &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-94&quot; title=&quot;Implement getTestCount for TestNG&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-94&quot;&gt;&lt;del&gt;SUREFIRE-94&lt;/del&gt;&lt;/a&gt;; it&apos;s minor, because &quot;this isn&apos;t required for correct operation of the tests, but may be if a reporter relies on the correct number in the runStarting method (currently, it is unused).&quot;&lt;/p&gt;

&lt;p&gt;If so, why do we count the tests initially at all?  I just tried ripping out all implementations of getTestCount() and just adding 1 to totalTests whenever we would have called it.  It doesn&apos;t seem to have done any harm; the only difference I can see is that in the case where you&apos;ve got some classes that look like tests, we do &quot;execute&quot; the test run, but when we find no tests, the summary banner says:&lt;/p&gt;

&lt;p&gt;  Tests run: 0, Failures: 0, Errors: 0, Skipped: 0&lt;/p&gt;

&lt;p&gt;... instead of:&lt;/p&gt;

&lt;p&gt;  No tests to run.&lt;/p&gt;

&lt;p&gt;(It still says &quot;No tests to run&quot; when there are no JUnit classes at all.)&lt;/p&gt;

&lt;p&gt;Therefore, I&apos;m inclined to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-47&quot; title=&quot;JUnit suite() method ends up being called twice when tests are run with Surefire&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-47&quot;&gt;&lt;del&gt;SUREFIRE-47&lt;/del&gt;&lt;/a&gt; by ripping out getTestCount() from the SurefireTestSet interface and removing its implementation from JUnitTestSet, PojoTestSet and TestNGTestSet.&lt;/p&gt;

&lt;p&gt;Does anyone object to this?&lt;/p&gt;</comment>
                            <comment id="14454054" author="dfabulich" created="Sun, 25 Nov 2007 20:19:36 +0000"  >&lt;p&gt;Fixed in revision 598025.&lt;/p&gt;</comment>
                            <comment id="17993496" author="olamy" created="Fri, 4 Jul 2025 05:48:00 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/1070&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#1070&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12809989">SUREFIRE-101</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12719878" name="surefireBug.tar" size="102400" author="toli" created="Mon, 12 Jun 2006 14:58:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bdhj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>