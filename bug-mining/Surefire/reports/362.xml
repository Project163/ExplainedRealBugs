<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:11:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-951] Better handling of file.encoding system property</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-951</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;It appears that Surefire doesn&apos;t (correctly) set &lt;tt&gt;-Dfile.encoding=${project.build.sourceEncoding&lt;/tt&gt;} prior to running the tests. As a result the JVM will derive &lt;tt&gt;file.encoding&lt;/tt&gt; from the environment&apos;s file encoding. This affects the return value of &lt;tt&gt;java.nio.charset.Charset#defaultCharset()&lt;/tt&gt;, which reads the &lt;tt&gt;file.encoding&lt;/tt&gt; system property exactly once, and is invoked very early on. Concretely this means that the unit tests are unnecessarily platform dependent.&lt;/p&gt;

&lt;p&gt;Thus I have two requests:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Make &lt;tt&gt;-Dfile.encoding=${project.build.sourceEncoding&lt;/tt&gt;} the default. That is, the following configuration setting should be implied:
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;argLine&amp;gt;-Dfile.encoding=${project.build.sourceEncoding}&amp;lt;/argLine&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;Extend the method &lt;tt&gt;org.apache.maven.plugin.surefire.SurefireProperties#verifyLegalSystemProperties(org.apache.maven.plugin.logging.Log)&lt;/tt&gt; such that is warns about users attempting to set the &lt;tt&gt;file.encoding&lt;/tt&gt; property through the &lt;tt&gt;systemPropertyVariables&lt;/tt&gt; configuration setting. Like with &lt;tt&gt;java.library.path&lt;/tt&gt;, this does &lt;em&gt;not&lt;/em&gt; work.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I have &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12720273/12720273_file-encoding-example.tbz&quot; title=&quot;file-encoding-example.tbz attached to SUREFIRE-951&quot;&gt;attached&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; a sample project that demonstrates the issue (simply run &lt;tt&gt;`mvn test`&lt;/tt&gt;). Please have a look at the comments I added to the POM. I have tested this sample project only on Linux, but a colleague has confirmed that an instance of this issue can also be recreated on Windows.&lt;/p&gt;

&lt;p&gt;TIA for looking into this!&lt;/p&gt;</description>
                <environment>Any environment in which the file encoding is distinct from ${project.build.sourceEncoding}.</environment>
        <key id="12809573">SUREFIRE-951</key>
            <summary>Better handling of file.encoding system property</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tibordigana">Tibor Digana</assignee>
                                    <reporter username="stephan202">Stephan Schroevers</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Jan 2013 05:01:22 +0000</created>
                <updated>Fri, 4 Jul 2025 07:20:10 +0000</updated>
                            <resolved>Fri, 3 May 2013 16:03:20 +0000</resolved>
                                    <version>2.13</version>
                                    <fixVersion>2.15</fixVersion>
                                    <component>Maven Surefire Plugin</component>
                    <component>process forking</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>13</watches>
                                                                                                                <comments>
                            <comment id="14455628" author="stephan202" created="Tue, 15 Jan 2013 05:27:20 +0000"  >&lt;p&gt;Thinking about it some more, I guess any unit test that relies on a &lt;em&gt;specific&lt;/em&gt; default encoding is faulty, so the case can be made that point (1) above &lt;em&gt;should not be&lt;/em&gt; necessary. Would like to hear other people&apos;s thoughts on that.&lt;/p&gt;</comment>
                            <comment id="14455728" author="stephan202" created="Sat, 16 Feb 2013 13:25:25 +0000"  >&lt;p&gt;Another property that only takes effect when set using &lt;tt&gt;&amp;lt;argLine&amp;gt;&lt;/tt&gt; (i.e., not when using &lt;tt&gt;&amp;lt;systemPropertyVariables&amp;gt;&lt;/tt&gt;) is &lt;a href=&quot;http://docs.oracle.com/javase/7/docs/technotes/guides/collections/changes7.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;tt&gt;jdk.map.althashing.threshold&lt;/tt&gt;&lt;/a&gt;. (Perhaps I should create a separate ticket for that?)&lt;/p&gt;</comment>
                            <comment id="14455912" author="krosenvold" created="Fri, 3 May 2013 14:38:29 +0000"  >&lt;p&gt;I have added warnings about setting the two properties in a8d47d08d6701446e947724f9d963d02532b40d7&lt;/p&gt;

&lt;p&gt;I am really unsure about setting the VM file encoding to project.build.sourceEncoding, it somehow feels like we&apos;re over-reaching the scope of this setting....?&lt;/p&gt;

</comment>
                            <comment id="14455855" author="stephan202" created="Fri, 3 May 2013 15:41:32 +0000"  >&lt;p&gt;Thanks Kristian. As per the observation in my &lt;a href=&quot;https://jira.codehaus.org/browse/SUREFIRE-951?focusedCommentId=317337#comment-317337&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;first comment&lt;/a&gt;, I&apos;m also not so certain anymore about silently overriding &lt;tt&gt;file.encoding&lt;/tt&gt;. An additional thing to consider is that if Surefire were to set &lt;tt&gt;-Dfile.encoding=${project.build.sourceEncoding&lt;/tt&gt;} by default, people would of course start to rely on it. That would make it harder to revert the decision later on. So without a convincing argument one way or the other, it might be better not to do anything at all.&lt;/p&gt;

&lt;p&gt;As such: I&apos;d be okay with closing this ticket as-is: the additional warnings are useful in and of themselves. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14456077" author="cowwoc" created="Mon, 23 Dec 2013 15:16:20 +0000"  >&lt;p&gt;I am getting &lt;tt&gt;file.encoding cannot be set as system property, use &amp;lt;argLine&amp;gt;-Dfile.encoding=...&amp;lt;argLine&amp;gt; instead&lt;/tt&gt; in spite of the fact that I &lt;b&gt;did&lt;/b&gt; set file.encoding as the warning recommends. If &lt;tt&gt;-Dfile.encoding&lt;/tt&gt; is set as a system property, and it is also set using &lt;tt&gt;argLine&lt;/tt&gt; then you should suppress this warning.&lt;/p&gt;</comment>
                            <comment id="14456146" author="cowwoc" created="Fri, 7 Feb 2014 10:47:02 +0000"  >&lt;p&gt;Filed &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1060&quot; title=&quot;Suppress warning if argLine is set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1060&quot;&gt;&lt;del&gt;SUREFIRE-1060&lt;/del&gt;&lt;/a&gt; for suppressing the warning.&lt;/p&gt;</comment>
                            <comment id="15333559" author="gwdfl59u" created="Thu, 16 Jun 2016 10:44:24 +0000"  >&lt;p&gt;still not working reliably as of surefire 2.19.1. Netbeans is starting maven tests with &quot;mvn -Dfile.encoding=...&quot;, and that seems to trigger the warning.&lt;/p&gt;</comment>
                            <comment id="15554741" author="fmarot" created="Fri, 7 Oct 2016 10:22:57 +0000"  >&lt;p&gt;Just want to share my experience. After switching to Windows from Linux, I stumbled onto a failed unit test:&lt;/p&gt;

&lt;p&gt;final String tmp = new String(&quot;IBA&#209;EZ/9&quot;);&lt;br/&gt;
String toTest = new String(tmp.getBytes(), Charsets.UTF_8);&lt;br/&gt;
Assert.assertTrue(tmp.equals(toTest));&lt;/p&gt;

&lt;p&gt;It was OK on Linux but KO on windows because SUREFIRE does not default to what I thought was a global Maven parameter &quot;project.build.sourceEncoding&quot;. In my opinion, the principle of least astonishment would favor defaulting to this parameter by default.&lt;/p&gt;

&lt;p&gt;My 2 cents&lt;/p&gt;</comment>
                            <comment id="15556355" author="tibor17" created="Fri, 7 Oct 2016 21:55:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fmarot&quot; class=&quot;user-hover&quot; rel=&quot;fmarot&quot;&gt;fmarot&lt;/a&gt;&lt;br/&gt;
I am now rewriting Surefire and I will fix the encoding issues. It has nothing to do with &lt;tt&gt;project.build.sourceEncoding&lt;/tt&gt; and there is no reason to not to use &lt;tt&gt;file.encoding&lt;/tt&gt;.&lt;br/&gt;
I think the problem is that forked process is using one Charset and plugin process default one. The entire communication protocol will be different with Base64 encoding and does not matter if you use 8 or 16 or whatever width of encodings.&lt;br/&gt;
Can I ask you then to test the Version 2.19.2-SNAPSHOT before starting the release?&lt;/p&gt;</comment>
                            <comment id="15565114" author="fmarot" created="Tue, 11 Oct 2016 10:34:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tibor17&quot; class=&quot;user-hover&quot; rel=&quot;tibor17&quot;&gt;tibor17&lt;/a&gt; Can you point me to the repository containing the SNAPSHOTS version please ? Or better directly give me the pom content &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15565253" author="tibor17" created="Tue, 11 Oct 2016 12:02:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=fmarot&quot; class=&quot;user-hover&quot; rel=&quot;fmarot&quot;&gt;fmarot&lt;/a&gt;&lt;br/&gt;
Please give me several days to complete the task. It is still in progress..&lt;/p&gt;</comment>
                            <comment id="15904676" author="amuthmann" created="Fri, 10 Mar 2017 08:10:47 +0000"  >&lt;p&gt;Hi, we currently run into this issue using 2.19, as here is still some discussion I have to ask: is this issue really closed?&lt;/p&gt;</comment>
                            <comment id="15905273" author="cowwoc" created="Fri, 10 Mar 2017 15:37:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=amuthmann&quot; class=&quot;user-hover&quot; rel=&quot;amuthmann&quot;&gt;amuthmann&lt;/a&gt; which issue are you referring to specifically (this page talks about multiple issues).&lt;/p&gt;

&lt;p&gt;If you are having problems getting UTF-8 to work, see &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1220&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SUREFIRE-1220&lt;/a&gt; which is still open.&lt;/p&gt;</comment>
                            <comment id="15929677" author="somedev1705" created="Fri, 17 Mar 2017 09:58:38 +0000"  >&lt;p&gt;The original issue is still present in version 2.15. I just ran into this with unit tests testing some UTF-8 chars on Windows.&lt;br/&gt;
While explicitly adding the file encoding fixes this issue, I think this offends Maven&apos;s Convention Over Configuration approach. When I configure the native maven property &lt;tt&gt;project.build.sourceEncoding&lt;/tt&gt; I expect it to be honored by everything Maven related i.e. the complete build. In case of some special edge case I&apos;m happy to configure plugins. However expecting my unit tests to be working with the correct source encoding is no edge case at all.&lt;/p&gt;

&lt;p&gt;For the Googlers: The fix is adding&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;plugin&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;groupId&amp;gt;&lt;/span&gt;org.apache.maven.plugins&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/groupId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;artifactId&amp;gt;&lt;/span&gt;maven-surefire-plugin&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/artifactId&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;version&amp;gt;&lt;/span&gt;2.15&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/version&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;configuration&amp;gt;&lt;/span&gt;
        &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;argLine&amp;gt;&lt;/span&gt;-Dfile.encoding=${project.build.sourceEncoding}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/argLine&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/configuration&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/plugin&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;(Given that you have set &lt;tt&gt;&amp;lt;project.build.sourceEncoding&amp;gt;UTF-8&amp;lt;/project.build.sourceEncoding&amp;gt;&lt;/tt&gt; in your &lt;tt&gt;properties&lt;/tt&gt;.)&lt;/p&gt;

&lt;p&gt;Also see &lt;a href=&quot;http://stackoverflow.com/questions/17656475/maven-source-encoding-in-utf-8-not-working&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/17656475/maven-source-encoding-in-utf-8-not-working&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17843385" author="mirabilos" created="Sat, 4 May 2024 00:16:28 +0000"  >&lt;p&gt;This breaks JaCoCo. You need:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
        &amp;lt;plugin&amp;gt;
                &amp;lt;groupId&amp;gt;org.apache.maven.plugins&amp;lt;/groupId&amp;gt;
                &amp;lt;artifactId&amp;gt;maven-surefire-plugin&amp;lt;/artifactId&amp;gt;
                &amp;lt;configuration&amp;gt;
                        &amp;lt;argLine&amp;gt;${argLine} -Dfile.encoding=${project.build.sourceEncoding}&amp;lt;/argLine&amp;gt;
                &amp;lt;/configuration&amp;gt;
        &amp;lt;/plugin&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17994354" author="olamy" created="Fri, 4 Jul 2025 07:20:10 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/1680&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#1680&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310260">
                    <name>Related</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12809537">SUREFIRE-709</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12720273" name="file-encoding-example.tbz" size="1421" author="stephan202" created="Tue, 15 Jan 2013 05:01:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bfvz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>