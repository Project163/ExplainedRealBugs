<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:05:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-44] Inner class inclusion too powerful</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-44</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;When inner classes were included, it was done in a way that was too powerful.  I believe it is too powerful in the following ways:&lt;/p&gt;

&lt;p&gt;    It is not name based &amp;#8211; it assumes that all inner classes of an included class are test cases.&lt;br/&gt;
    It does not work on nested classes (non-static classes)&lt;/p&gt;

&lt;p&gt;See the test case and stack trace below.&lt;/p&gt;

&lt;p&gt;I know people put tests in nested classes, but many nested classes exist for other reasons (simple mock objects, for example).  Inner classes do not have no-arg constructors, and so including them includes classes that pretty much by definition will not be runnable.&lt;/p&gt;

&lt;p&gt;As things stand, I cannot put a nested (non-static inner) class in a test case.  I will get the exception below.&lt;/p&gt;

&lt;p&gt;There needs to be some marker for nested test classes.  If nothing else, nested classes without a no-arg constructor should be ignored.  &lt;/p&gt;

&lt;p&gt;But that still makes the inclusion very broad.  The default inclusion of top-level classes is much more selective.  I would prefer if the default inclusion of nested classes followed the same default naming pattern.  But at the very least, please ignore classes without  no-arg constructors.&lt;/p&gt;

&lt;p&gt;I have been puzzling myself over errors like the following:&lt;/p&gt;

&lt;p&gt;java.lang.NoSuchMethodException: com.hyphenhealth.edc.drq.editchecks.queries.compute.TestAThing$Foo.&amp;lt;init&amp;gt;()&lt;br/&gt;
        at java.lang.Class.getConstructor0(Class.java:2647)&lt;br/&gt;
        at java.lang.Class.getConstructor(Class.java:1629)&lt;br/&gt;
        at org.apache.maven.surefire.battery.JUnitBattery.getTestConstructor(JUnitBattery.java:307)&lt;br/&gt;
        at org.apache.maven.surefire.battery.JUnitBattery.processTestClass(JUnitBattery.java:150)&lt;br/&gt;
        at org.apache.maven.surefire.battery.JUnitBattery.&amp;lt;init&amp;gt;(JUnitBattery.java:81)&lt;br/&gt;
        at org.apache.maven.surefire.SurefireUtils.instantiateBattery(SurefireUtils.java:63)&lt;br/&gt;
        at org.apache.maven.surefire.Surefire.instantiateBatteries(Surefire.java:262)&lt;br/&gt;
        at org.apache.maven.surefire.Surefire.run(Surefire.java:140)&lt;br/&gt;
        at org.apache.maven.surefire.Surefire.run(Surefire.java:87)&lt;br/&gt;
        at org.apache.maven.surefire.Surefire.run(Surefire.java:63)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
        at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)&lt;br/&gt;
        at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)&lt;br/&gt;
        at java.lang.reflect.Method.invoke(Method.java:585)&lt;br/&gt;
        at org.apache.maven.surefire.SurefireBooter.main(SurefireBooter.java:785)&lt;br/&gt;
RUN ABORTED&lt;br/&gt;
java.lang.NoSuchMethodException&lt;/p&gt;


&lt;p&gt;Test code:&lt;br/&gt;
public class TestAThing {&lt;br/&gt;
    public class Foo { }&lt;br/&gt;
}&lt;/p&gt;</description>
                <environment></environment>
        <key id="12810569">SUREFIRE-44</key>
            <summary>Inner class inclusion too powerful</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="5">Cannot Reproduce</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="arnold@moonhill.org">Ken Arnold</reporter>
                        <labels>
                    </labels>
                <created>Mon, 5 Jun 2006 08:37:32 +0000</created>
                <updated>Fri, 4 Jul 2025 05:48:40 +0000</updated>
                            <resolved>Fri, 23 Nov 2007 00:55:19 +0000</resolved>
                                    <version>2.0 (2.2 plugin)</version>
                                                        <due></due>
                            <votes>6</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14456809" author="arnold@moonhill.org" created="Mon, 5 Jun 2006 08:38:34 +0000"  >&lt;p&gt;I suspect that adding this feature is what created the bug.&lt;/p&gt;</comment>
                            <comment id="14456797" author="arnold@moonhill.org" created="Mon, 5 Jun 2006 08:53:21 +0000"  >&lt;p&gt;I thought I had a workaround &amp;#8211; make classes static, etc.  But I don&apos;t.  Because of things like this:&lt;/p&gt;

&lt;p&gt;    public interface MockExpressionMatcher {&lt;br/&gt;
        MockExpressionMatcher MATCH_ALL = new MockExpressionMatcher() {&lt;br/&gt;
          public boolean matches(String sql) &lt;/p&gt;
{
              return true;
          }
&lt;p&gt;       };&lt;/p&gt;

&lt;p&gt;        boolean matches(String sql);&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;When I use it in code, the anonymous object for MATCH_ALL is created in that class.  Or at least it seems so.  Consider: &lt;/p&gt;

&lt;p&gt;    private MockDBConnection setupTestDB() &lt;/p&gt;
{
        MockDBConnection c = new MockDBConnection();
        c.addResultSetFactory(MockExpressionMatcher.MATCH_ALL,
                new MockUpdateFactory());
        return c;
    }

&lt;p&gt;I then get the following problem when running tests:&lt;/p&gt;

&lt;p&gt;    java.lang.NoSuchMethodException: com.hyphenhealth.edc.drq.editchecks.queries.TestComputeQuery$1.&amp;lt;init&amp;gt;()&lt;/p&gt;

&lt;p&gt;This is true &amp;#8211; a javap of this anonymous class shows no constructor at all:&lt;/p&gt;

&lt;p&gt;    class com.hyphenhealth.edc.drq.editchecks.queries.TestComputeQuery$1 extends java.lang.Object{&lt;br/&gt;
    }&lt;/p&gt;

&lt;p&gt;I cannot control this compiler behavior.  This is how it handles static final constructed objects (in interfaces anyway).  I cannot make this class non-static because this is not my file.  (I probably could make a nested static class for each such field if I controlled the file).&lt;/p&gt;

&lt;p&gt;If there is a language for exclusion of nested classes I cannot find it in the documentation.  So I&apos;m out of workarounds for now.&lt;/p&gt;

&lt;p&gt;(This is partly a consequence of naming java files instead of classes for inclusion/exclusion.  If classes were named I could exclude *&lt;b&gt;/&lt;/b&gt;\$* (all nested classes).  But nested classes have no separate file to include/exclude.  I will file a separate feature request for that.)&lt;/p&gt;</comment>
                            <comment id="14456782" author="arnold@moonhill.org" created="Thu, 8 Jun 2006 11:09:52 +0000"  >&lt;p&gt;My mistake, this is not a 2.0 issue (that was a typo).  It&apos;s a 1.5.3 issue.&lt;/p&gt;

&lt;p&gt;I am going to have to add no-arg constructors to all nested classes right now.  This is just wrong.&lt;/p&gt;</comment>
                            <comment id="14453717" author="carlos" created="Thu, 14 Dec 2006 05:11:36 +0000"  >&lt;p&gt;do you mean you are having this issue in 1.5.3 and it&apos;s already fixed in 2.0 ?&lt;/p&gt;</comment>
                            <comment id="14456832" author="arnold@moonhill.org" created="Sun, 17 Dec 2006 23:45:09 +0000"  >&lt;p&gt;No, I meant that I was using 1.5.3 when I had the problem, and that I hadn&apos;t tried it at 2.0.  Sorry for the unclarity.&lt;/p&gt;</comment>
                            <comment id="14453960" author="dfabulich" created="Fri, 23 Nov 2007 00:55:19 +0000"  >&lt;p&gt;Can&apos;t reproduce; integration checked in revision 597570&lt;/p&gt;</comment>
                            <comment id="17993502" author="olamy" created="Fri, 4 Jul 2025 05:48:40 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/1109&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#1109&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310260">
                    <name>Related</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12809760">SUREFIRE-19</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                                                <inwardlinks description="is depended upon by">
                                        <issuelink>
            <issuekey id="12810047">SUREFIRE-288</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2be1r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>