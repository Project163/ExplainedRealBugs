<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:17:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-2076] BufferOverflowException when encoding message with null runMode</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-2076</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;Per &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/518#issuecomment-1099231382&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#issuecomment-1099231382&lt;/a&gt;, &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/518#issuecomment-1099706229&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#issuecomment-1099706229&lt;/a&gt;, &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/518#pullrequestreview-951134938&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#pullrequestreview-951134938&lt;/a&gt; and &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/518#issuecomment-1108371215&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#issuecomment-1108371215&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;RunMode can be null&#160;causing BufferOverflowException when encoding message.&lt;br/&gt;
Related to similar issue with null testIds: &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-2056&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;SUREFIRE-2056&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/maven-surefire/blob/959c1e9cabb8d06c72f5ebd7eb6e56e9987eccf8/surefire-api/src/main/java/org/apache/maven/surefire/api/stream/AbstractStreamEncoder.java#L86&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;b&gt;AbstractStreamEncoder#encodeHeader&lt;/b&gt;&lt;/a&gt; stores runMode in at least 3 bytes:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;1-byte length&lt;/li&gt;
	&lt;li&gt;1-byte delimiter&lt;/li&gt;
	&lt;li&gt;length-bytes runMode&lt;/li&gt;
	&lt;li&gt;1-byte delimiter&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In case of null runMode the encoded part becomes &lt;b&gt;0::&lt;/b&gt; (exactly 3 bytes length)&lt;/p&gt;

&lt;p&gt;The issue is that &lt;a href=&quot;https://github.com/apache/maven-surefire/blob/959c1e9cabb8d06c72f5ebd7eb6e56e9987eccf8/surefire-api/src/main/java/org/apache/maven/surefire/api/stream/AbstractStreamEncoder.java#L184&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;&lt;b&gt;AbstractStreamEncoder#estimateBufferLength&lt;/b&gt;&lt;/a&gt; is not expecting/couting any bytes for runMode part in case of null runMode.&lt;br/&gt;
This results in in BufferOverflowException becase the byte size of the message is underestimated.&lt;/p&gt;


&lt;p&gt;Exception thrown:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.nio.BufferOverflowException
	at java.nio.Buffer.nextPutIndex(Buffer.java:547)
	at java.nio.HeapByteBuffer.put(HeapByteBuffer.java:172)
	at org.apache.maven.surefire.api.stream.AbstractStreamEncoder.encodeString(AbstractStreamEncoder.java:127)
	at org.apache.maven.surefire.api.stream.AbstractStreamEncoder.encodeStringData(AbstractStreamEncoder.java:171)
	at org.apache.maven.surefire.api.stream.AbstractStreamEncoder.encode(AbstractStreamEncoder.java:157)
	at org.apache.maven.surefire.booter.spi.EventChannelEncoder.encodeMessage(EventChannelEncoder.java:398)
	at org.apache.maven.surefire.booter.spi.EventChannelEncoder.setOutErr(EventChannelEncoder.java:188)
	at org.apache.maven.surefire.booter.spi.EventChannelEncoder.testOutput(EventChannelEncoder.java:183)
	at org.apache.maven.surefire.api.booter.ForkingRunListener.writeTestOutput(ForkingRunListener.java:113)
	at org.apache.maven.surefire.api.booter.ForkingRunListener.writeTestOutput(ForkingRunListener.java:44)
	at org.apache.maven.surefire.common.junit4.JUnit4RunListener.writeTestOutput(JUnit4RunListener.java:235)
	at org.apache.maven.surefire.api.report.ConsoleOutputCapture$ForwardingPrintStream.println(ConsoleOutputCapture.java:144)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13441574">SUREFIRE-2076</key>
            <summary>BufferOverflowException when encoding message with null runMode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tibordigana">Tibor Digana</assignee>
                                    <reporter username="zoltan.meze">Zoltan Meze</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Apr 2022 14:10:12 +0000</created>
                <updated>Fri, 4 Jul 2025 07:41:42 +0000</updated>
                            <resolved>Wed, 27 Apr 2022 17:06:44 +0000</resolved>
                                    <version>3.0.0-M6</version>
                                    <fixVersion>3.0.0-M7</fixVersion>
                                    <component>Maven Surefire Plugin</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="17527581" author="JIRAUSER287608" created="Mon, 25 Apr 2022 15:42:24 +0000"  >&lt;p&gt;Probably related to this or &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-2056&quot; title=&quot;BufferOverflowException when encoding message with null testId&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-2056&quot;&gt;&lt;del&gt;SUREFIRE-2056&lt;/del&gt;&lt;/a&gt;, will confirm which one:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-2068&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SUREFIRE-2068&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17528900" author="tibor17" created="Wed, 27 Apr 2022 17:06:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=maven-surefire.git;a=commit;h=71f871751e3395e9d1646a34aa3433039fbfab2a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=maven-surefire.git;a=commit;h=71f871751e3395e9d1646a34aa3433039fbfab2a&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17529670" author="mjsax" created="Thu, 28 Apr 2022 21:57:09 +0000"  >&lt;p&gt;Seems we are hitting this issue trying to upgrade from `-M5` to `-M6` (cf &lt;a href=&quot;https://github.com/confluentinc/ksql/issues/9060)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/confluentinc/ksql/issues/9060)&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Is there any workaround/config we can set to avoid this issue?&lt;/p&gt;</comment>
                            <comment id="17535072" author="mjsax" created="Wed, 11 May 2022 19:13:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tibordigana&quot; class=&quot;user-hover&quot; rel=&quot;tibordigana&quot;&gt;tibordigana&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zoltan.meze&quot; class=&quot;user-hover&quot; rel=&quot;zoltan.meze&quot;&gt;zoltan.meze&lt;/a&gt; &#8211; Did you see my last comment? Is there some workaround or do we need to stick with `-M5` until `-M7` is released?&lt;/p&gt;</comment>
                            <comment id="17539299" author="JIRAUSER289557" created="Thu, 19 May 2022 05:14:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mjsax&quot; class=&quot;user-hover&quot; rel=&quot;mjsax&quot;&gt;mjsax&lt;/a&gt; the workaround is to avoid calling System.out.println()/(&quot;&quot;) and System.out.print(). For me I only repro the error when printing an empty string. print(&apos;\n&apos;) works fine as a println replacement.&lt;/p&gt;

&lt;p&gt;Also, none of the args to printf can be an empty string e.g. this fails: printf(&quot;%s%s&quot;, &quot;abc&quot;, &quot;&quot;)&lt;/p&gt;</comment>
                            <comment id="17553045" author="JIRAUSER287608" created="Sat, 11 Jun 2022 07:34:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mjsax&quot; class=&quot;user-hover&quot; rel=&quot;mjsax&quot;&gt;mjsax&lt;/a&gt; The new version 3.0.0-M7 is out now. I didn&apos;t go too deep into figuring out workarounds. &lt;/p&gt;

&lt;p&gt;Someone mentioned this issue in &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-2058&quot; title=&quot;Corrupted STDOUT by directly writing to native stream in forked JVM 1 with UTF-8 console logging&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-2058&quot;&gt;&lt;del&gt;SUREFIRE-2058&lt;/del&gt;&lt;/a&gt; PR so I just created a ticket and fixed this one too. &lt;br/&gt;
It was obious why this issues was happening after comparing encoder and decoder implementations.&lt;/p&gt;</comment>
                            <comment id="17554376" author="mjsax" created="Wed, 15 Jun 2022 05:16:44 +0000"  >&lt;p&gt;Thanks for the update! &#8211; I opened a PR for our repo bumping to `-M7` &#8211; hope it works: &lt;a href=&quot;https://github.com/confluentinc/ksql/pull/9200&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/confluentinc/ksql/pull/9200&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17995471" author="olamy" created="Fri, 4 Jul 2025 07:41:42 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/3117&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#3117&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13437585">SUREFIRE-2056</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13438819">SUREFIRE-2068</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z11scg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>