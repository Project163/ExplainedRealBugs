<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:08:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-711] OutOfMemoryError while building multi module projects</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-711</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;We&apos;re getting out of memory errors since we&apos;ve updated to surefire 2.7.2 from 2.6.&lt;br/&gt;
Please check the attached jvisualvm pics they show the same build execution with 2.6 and 2.7.2. The attached &quot;log.txt&quot; and &quot;log -X.txt&quot; might also be interesting.&lt;br/&gt;
it seems like 2.7.2 is not unloading classes after processing.&lt;/p&gt;

&lt;p&gt;We found out that if we skip tests with -DskipTests=true, the exception won&apos;t occur.&lt;/p&gt;

&lt;p&gt;The build consists of several multi module projects.&lt;/p&gt;

&lt;p&gt;    &amp;lt;modules&amp;gt;&lt;br/&gt;
		&amp;lt;module&amp;gt;..\..\BaseSys\trunk&amp;lt;/module&amp;gt; (multimodule)&lt;br/&gt;
		&amp;lt;module&amp;gt;..\..\MagIC\trunk&amp;lt;/module&amp;gt; (multimodule)&lt;br/&gt;
		&amp;lt;module&amp;gt;..\..\StabNet\trunk&amp;lt;/module&amp;gt; (multimodule)&lt;br/&gt;
		&amp;lt;module&amp;gt;..\..\tiamo\trunk&amp;lt;/module&amp;gt; (multimodule)&lt;br/&gt;
		&amp;lt;module&amp;gt;..\..\TiBase\trunk&amp;lt;/module&amp;gt; (multimodule)&lt;br/&gt;
		&amp;lt;module&amp;gt;..\..\VIVA\trunk&amp;lt;/module&amp;gt; (multimodule)&lt;br/&gt;
    &amp;lt;/modules&amp;gt;&lt;/p&gt;



&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Java heap space &lt;del&gt;&amp;gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt;&lt;/del&gt;--------------------------Exception in thread &quot;main&quot; jav&lt;br/&gt;
lang.OutOfMemoryError: Java heap space&lt;br/&gt;
        at java.util.Arrays.copyOf(Arrays.java:2786)&lt;br/&gt;
        at java.io.ByteArrayOutputStream.write(ByteArrayOutputStream.java:94)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:44)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;/p&gt;</description>
                <environment>Win 7 32bit&lt;br/&gt;
</environment>
        <key id="12810268">SUREFIRE-711</key>
            <summary>OutOfMemoryError while building multi module projects</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="krosenvold">Kristian Rosenvold</assignee>
                                    <reporter username="onmomo">Christian Moser</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Mar 2011 06:21:32 +0000</created>
                <updated>Fri, 4 Jul 2025 07:15:58 +0000</updated>
                            <resolved>Fri, 4 Mar 2011 05:08:43 +0000</resolved>
                                    <version>2.7.2</version>
                                    <fixVersion>2.8</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14454909" author="onmomo" created="Thu, 3 Mar 2011 06:22:59 +0000"  >&lt;p&gt;maven version: 3.0.1 or 3.0.2&lt;/p&gt;

&lt;p&gt;mvn call:&lt;br/&gt;
mvn -f all-pom.xml -DloadTestModules=true -Dtest=skip -Denforcer.skip=true clean install -U -DfailIfNoTests=false&lt;/p&gt;</comment>
                            <comment id="14454943" author="krosenvold" created="Thu, 3 Mar 2011 08:27:28 +0000"  >&lt;p&gt;Are you certain there&apos;s no 2.6 left in there somewhere ? The stack trace in the log seems to be &lt;b&gt;exactly&lt;/b&gt; the bug that was fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-495&quot; title=&quot;OutOfMemory Exception &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-495&quot;&gt;&lt;del&gt;SUREFIRE-495&lt;/del&gt;&lt;/a&gt;. I am not sure I am reading the log files correctly either, but it would seem like the stacktrace is coming from some kind of forked process invocation.&lt;/p&gt;</comment>
                            <comment id="14454809" author="onmomo" created="Thu, 3 Mar 2011 09:21:23 +0000"  >&lt;p&gt;There&apos;s only one surefire configuration available in our build system. Perhaps, &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-495&quot; title=&quot;OutOfMemory Exception &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-495&quot;&gt;&lt;del&gt;SUREFIRE-495&lt;/del&gt;&lt;/a&gt; was only fixed for test-ng?&lt;/p&gt;

&lt;p&gt;With 2.6, we are able to sucessfully execute the build. We are even able to execute all test classes (~1400) in forked VM&apos;s without OutOfMemoryError&apos;s. &lt;br/&gt;
With 2.7.2, the error occurs while executing an ant-run process, test&apos;s aren&apos;t executed at all, they are disabled.&lt;/p&gt;</comment>
                            <comment id="14454910" author="krosenvold" created="Thu, 3 Mar 2011 15:16:23 +0000"  >&lt;p&gt;Identified a memory leak that affects only mostly big reactor builds. This is a really nice catch.&lt;/p&gt;

&lt;p&gt;Fixed in r1076794 and an updated 2.8-SNAPSHOT is being deployed to repository.apache.org now. Thanks for a good bug report!&lt;/p&gt;</comment>
                            <comment id="14454890" author="onmomo" created="Fri, 4 Mar 2011 02:39:59 +0000"  >&lt;p&gt;Thanks for the fast fix!&lt;br/&gt;
Unfortunately, the leak seems still not fixed in 2.8-SNAPSHOT.&lt;/p&gt;

&lt;p&gt;I still got:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Help 1&amp;#93;&lt;/span&gt; &lt;a href=&quot;http://cwiki.apache.org/confluence/display/MAVEN/OutOfMemoryErr&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cwiki.apache.org/confluence/display/MAVEN/OutOfMemoryErr&lt;/a&gt;&lt;br/&gt;
or---------------------------------------------------&lt;br/&gt;
constituent&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;: &lt;a href=&quot;file:/D:/MNet/Tools/maven/lib/aether-api-1.8.jarException&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;file:/D:/MNet/Tools/maven/lib/aether-api-1.8.jarException&lt;/a&gt; in thr&lt;br/&gt;
ead &quot;main&quot; java.lang.OutOfMemoryError: Java heap space&lt;br/&gt;
        at java.util.Arrays.copyOf(Arrays.java:2786)&lt;br/&gt;
        at java.io.ByteArrayOutputStream.write(ByteArrayOutputStream.java:94)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:44)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;br/&gt;
        at java.io.PrintStream.write(PrintStream.java:430)&lt;br/&gt;
        at org.apache.maven.surefire.util.TeeStream.write(TeeStream.java:42)&lt;/p&gt;

&lt;p&gt;I verified that the class JUnit4Provider in surefire-provider:2.8-SNAPSHOT in my local repository contains the following lines:&lt;/p&gt;

&lt;p&gt;public Iterator getSuites()&lt;/p&gt;
  {
    this.testsToRun = scanClassPath();

    this.reporterFactory.close();

    return this.testsToRun.iterator();
  }

&lt;p&gt;Perhaps, there&apos;s another leak.&lt;/p&gt;</comment>
                            <comment id="14454840" author="onmomo" created="Fri, 4 Mar 2011 02:41:17 +0000"  >&lt;p&gt;jvisualvm output with fixed version&lt;/p&gt;</comment>
                            <comment id="14454794" author="krosenvold" created="Fri, 4 Mar 2011 05:08:43 +0000"  >&lt;p&gt;Take 2 is out in r1077870, updated 2.8-SNAPSHOT deployed.&lt;/p&gt;

&lt;p&gt;The &lt;b&gt;interesting&lt;/b&gt; thing about your error report is that it basically describes 2 different problems. One is that you&apos;re describing a possible difference between 2.6 and 2.7.X in terms of classloading and unloading within the actual surefire plugin performin directory scanning. &lt;/p&gt;

&lt;p&gt;The &lt;b&gt;other&lt;/b&gt; issue is the stacktrace you&apos;re including, where the recursive TeeStream invocation shows another (different) incarnation of &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-495&quot; title=&quot;OutOfMemory Exception &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-495&quot;&gt;&lt;del&gt;SUREFIRE-495&lt;/del&gt;&lt;/a&gt;, this time not between the individual tests classes of a single surefire run but between the modules in the reactor. This leak should be much smaller than &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-495&quot; title=&quot;OutOfMemory Exception &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-495&quot;&gt;&lt;del&gt;SUREFIRE-495&lt;/del&gt;&lt;/a&gt;, but may still be fairly large - especially for a large reactor like yours.&lt;/p&gt;

&lt;p&gt;I suspect it&apos;s the second of the two that&apos;s causing the misery here, and this is the issue I have fixed now. I am closing this issue as fixed again, feel free to reopen if necessary. And if you don&apos;t mind, please see if the class-loading/unloading difference between 2.6-&amp;gt;2.8-SNAPSHOT is still present and upload the nice graphs, even it if doesn&apos;t cause your build to fail.&lt;/p&gt;</comment>
                            <comment id="14454961" author="onmomo" created="Fri, 4 Mar 2011 06:16:26 +0000"  >&lt;p&gt;Second fix did the trick. Surefire 2.8-SNAPSHOT does even unload more classes than 2.6.&lt;br/&gt;
Thanks and good job!&lt;/p&gt;</comment>
                            <comment id="14454911" author="krosenvold" created="Fri, 4 Mar 2011 09:11:46 +0000"  >&lt;p&gt;Out of general curiosity, could you give me some stats on this issue: 2.6 vs 2.7.2 vs 2.7.3-SNAPSHOT vs 2.8-SNAPSHOT:&lt;/p&gt;

&lt;p&gt;Total build time difference and perhaps  &lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Final Memory: 9M/157M at the end of the build for each version ? This bug has been here in one form or another since 2.4.X.&lt;/p&gt;</comment>
                            <comment id="14454854" author="onmomo" created="Mon, 4 Apr 2011 08:52:57 +0000"  >&lt;p&gt;I&apos;m sorry for my late reply, I was off work for a little while.&lt;br/&gt;
Here are the stats, it&apos;s curios that 2.8 took longer, perhaps because it was the first execution of the build:&lt;/p&gt;

&lt;p&gt;2.6&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Total time: 13:46.940s&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Finished at: Mon Apr 04 15:02:30 CEST 2011&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Final Memory: 257M/494M&lt;/p&gt;

&lt;p&gt;2.8&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Total time: 13:53.233s&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Finished at: Mon Apr 04 15:19:02 CEST 2011&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;INFO&amp;#93;&lt;/span&gt; Final Memory: 256M/494M&lt;/p&gt;

&lt;p&gt;2.7.1&lt;br/&gt;
FAILED&lt;/p&gt;

&lt;p&gt;2.7.2&lt;br/&gt;
FAILED&lt;/p&gt;</comment>
                            <comment id="17994128" author="olamy" created="Fri, 4 Jul 2025 07:15:58 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/1861&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#1861&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12809501">SUREFIRE-495</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12720127" name="surefire-log.zip" size="1193140" author="onmomo" created="Thu, 3 Mar 2011 06:21:32 +0000"/>
                            <attachment id="12720192" name="surefire2-6-0.JPG" size="263241" author="onmomo" created="Thu, 3 Mar 2011 06:21:32 +0000"/>
                            <attachment id="12719711" name="surefire2-7-2.JPG" size="271364" author="onmomo" created="Thu, 3 Mar 2011 06:21:32 +0000"/>
                            <attachment id="12720257" name="surefire2-8-SNAPSHOT-fix2.JPG" size="279356" author="onmomo" created="Fri, 4 Mar 2011 06:16:26 +0000"/>
                            <attachment id="12720017" name="surefire2-8-SNAPSHOT.JPG" size="230950" author="onmomo" created="Fri, 4 Mar 2011 02:41:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bdhb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>