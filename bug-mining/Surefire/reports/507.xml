<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:13:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-1250] Regex testcase filtering: exception when hashmark is regex-quoted</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-1250</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;i&apos;ve been using regex to select which tests to run...and i&apos;ve got some wierd exceptions when executing&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;mvn test &lt;span class=&quot;code-quote&quot;&gt;&quot;-Dtest=%regex[.*\Q#\E.*]&quot;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;executing the above command results in:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.util.regex.PatternSyntaxException: 
Illegal/unsupported escape sequence near index 1
\E.*
 ^
	at org.apache.maven.surefire.junit4.JUnit4Provider.execute(JUnit4Provider.java:364)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeWithRerun(JUnit4Provider.java:274)
	at org.apache.maven.surefire.junit4.JUnit4Provider.executeTestSet(JUnit4Provider.java:238)
	at org.apache.maven.surefire.junit4.JUnit4Provider.invoke(JUnit4Provider.java:161)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;i noticed earlier that maven might do some black-magic with these regexps in the background ( i know that it should know the class name earlier; to avoid starting testcases which will get entirely excluded...and thats cool )&lt;/p&gt;

&lt;p&gt;...so..i assume maven does split the regex by the &lt;tt&gt;#&lt;/tt&gt;; and that&apos;s okay - if that can&apos;t be avoided; place some pointers in the documentation about it and/or a more descriptive exception could be useful&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12971871">SUREFIRE-1250</key>
            <summary>Regex testcase filtering: exception when hashmark is regex-quoted</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tibordigana">Tibor Digana</assignee>
                                    <reporter username="kgyrtkirk">Zoltan Haindrich</reporter>
                        <labels>
                    </labels>
                <created>Sun, 22 May 2016 12:30:51 +0000</created>
                <updated>Fri, 4 Jul 2025 07:25:50 +0000</updated>
                            <resolved>Mon, 22 Aug 2016 23:24:11 +0000</resolved>
                                    <version>2.19.1</version>
                                    <fixVersion>2.20</fixVersion>
                                    <component>Maven Surefire Plugin</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15296331" author="tibor17" created="Mon, 23 May 2016 12:53:50 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgyrtkirk&quot; class=&quot;user-hover&quot; rel=&quot;kgyrtkirk&quot;&gt;kgyrtkirk&lt;/a&gt;&lt;br/&gt;
Did you read this documentation?&lt;br/&gt;
&lt;a href=&quot;http://maven.apache.org/surefire/maven-surefire-plugin/examples/single-test.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://maven.apache.org/surefire/maven-surefire-plugin/examples/single-test.html&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The hash mark is class#method separator.&lt;br/&gt;
Then the quotation mark splits in two where.&lt;br/&gt;
Why you use quotations if class name and method name do not use the quotation marks?&lt;/p&gt;</comment>
                            <comment id="15296786" author="kgyrtkirk" created="Mon, 23 May 2016 18:10:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tibor17&quot; class=&quot;user-hover&quot; rel=&quot;tibor17&quot;&gt;tibor17&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;yes ...i&apos;ve read the documentation; i don&apos;t say it was crystal clear..but i&apos;ve read it.&lt;/p&gt;

&lt;p&gt;i&apos;ve opened the source and looked into the code...this exception is caused by the unwrapping of the pattern&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/maven-surefire/blob/master/surefire-api/src/main/java/org/apache/maven/surefire/testset/TestListResolver.java#L407&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/blob/master/surefire-api/src/main/java/org/apache/maven/surefire/testset/TestListResolver.java#L407&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;i&apos;ve other example regexps which may be affected by the issue:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;(A#test1|B#test2)&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;A\Q#\Etest&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;others may be exists..but if someone hits this thing...they don&apos;t have a clue why the regexp is bad - while it&apos;s perfectly correct&lt;/p&gt;

&lt;p&gt;so I think a better exception should notify the user about the special nature of these regexps....because i&apos;ve already downloaded the code; i&apos;ve added a sample fix for the issue&lt;/p&gt;


</comment>
                            <comment id="15296790" author="kgyrtkirk" created="Mon, 23 May 2016 18:12:36 +0000"  >&lt;p&gt;i think regexps like: &lt;tt&gt;A#test1|B#test2&lt;/tt&gt; will not cause any errors/warnings; but will behave silently differently than expected by the user.&lt;/p&gt;</comment>
                            <comment id="15296810" author="tibor17" created="Mon, 23 May 2016 18:17:46 +0000"  >&lt;p&gt;Please concentrate on the problem.&lt;br/&gt;
The symbol &quot;\Q&quot; does not make sense because it&apos;s a quotation mark and it cannot not appear in class name.&lt;br/&gt;
Why we are even talking about it?&lt;br/&gt;
I guess this problem is not a problem.&lt;/p&gt;</comment>
                            <comment id="15296827" author="tibor17" created="Mon, 23 May 2016 18:29:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgyrtkirk&quot; class=&quot;user-hover&quot; rel=&quot;kgyrtkirk&quot;&gt;kgyrtkirk&lt;/a&gt;&lt;br/&gt;
The documentation says &quot;The regex validates fully qualified class file, and validates test methods separately after (#)&quot;.&lt;br/&gt;
This means the regex argument A#test1|B#test2 is invalid because no such method named &quot;B#test2&quot; can be found in class A. Therefore in this case it has to be comma separated values with two regex, one with A#test1 and another with B#test2.&lt;/p&gt;</comment>
                            <comment id="15297064" author="kgyrtkirk" created="Mon, 23 May 2016 20:54:49 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tibor17&quot; class=&quot;user-hover&quot; rel=&quot;tibor17&quot;&gt;tibor17&lt;/a&gt;&lt;br/&gt;
well...yes... that really makes it clear..but I do read the paragraph containing that phrase multiple times when i was experiencing this exception; maybe an example would have made it more easier for me to comprehend...&lt;/p&gt;

&lt;p&gt;i still think that a custom exception should notify the user in case the regexp usage rules are violated...; maybe even in the case when there are 2 or more &lt;tt&gt;#&lt;/tt&gt;&apos;s.&lt;/p&gt;

&lt;p&gt;if you still think this is not a problem (because it affects only a small portion of users)...then just close this issue as invalid..maybe i&apos;m the only one having issues with it&lt;/p&gt;</comment>
                            <comment id="15297309" author="tibor17" created="Mon, 23 May 2016 23:06:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kgyrtkirk&quot; class=&quot;user-hover&quot; rel=&quot;kgyrtkirk&quot;&gt;kgyrtkirk&lt;/a&gt;&lt;br/&gt;
Giving a hint to an user is good point.&lt;br/&gt;
Feel free to commit verification of the pattern and open a pull request on GitHub.&lt;br/&gt;
Throwing exception would be useful.&lt;/p&gt;</comment>
                            <comment id="15298852" author="githubbot" created="Tue, 24 May 2016 20:39:05 +0000"  >&lt;p&gt;GitHub user kgyrtkirk opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/113&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/113&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1250&quot; title=&quot;Regex testcase filtering: exception when hashmark is regex-quoted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1250&quot;&gt;&lt;del&gt;SUREFIRE-1250&lt;/del&gt;&lt;/a&gt;: add exceptions to describe usage rules of %regex&lt;/p&gt;

&lt;p&gt;    @Tibor17 i&apos;ve cleaned it up a bit; and added exception for multiple hashmarks too. tests have passed on my machine.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/kgyrtkirk/maven-surefire&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/kgyrtkirk/maven-surefire&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1250&quot; title=&quot;Regex testcase filtering: exception when hashmark is regex-quoted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1250&quot;&gt;&lt;del&gt;SUREFIRE-1250&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/113.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/113.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #113&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 09e33b88e82266a3118b9db260496f30a8861e58&lt;br/&gt;
Author: Haindrich Zolt&#225;n (kirk) &amp;lt;kirk@rxd.hu&amp;gt;&lt;br/&gt;
Date:   2016-05-24T20:28:11Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1250&quot; title=&quot;Regex testcase filtering: exception when hashmark is regex-quoted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1250&quot;&gt;&lt;del&gt;SUREFIRE-1250&lt;/del&gt;&lt;/a&gt;: add exceptions to describe usage rules of %regex&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15301036" author="githubbot" created="Wed, 25 May 2016 22:47:23 +0000"  >&lt;p&gt;Github user Tibor17 commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/113#discussion_r64666590&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/113#discussion_r64666590&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: surefire-api/src/main/java/org/apache/maven/surefire/testset/TestListResolver.java &amp;#8212;&lt;br/&gt;
    @@ -479,6 +481,27 @@ else if ( hasMethod )&lt;br/&gt;
                 updatedFilters( isExcluded, test, patterns, includedFilters, excludedFilters );&lt;br/&gt;
             }&lt;br/&gt;
         }&lt;br/&gt;
    +    &lt;br/&gt;
    +    private static void regexSanityCheck( String request, String classNameExpr, String methodNameExpr )&lt;br/&gt;
    +    {&lt;br/&gt;
    +        // this will emit any exception if the regex is not valid at all&lt;br/&gt;
    +        Pattern.compile( request );&lt;br/&gt;
    +        try&lt;br/&gt;
    +        {&lt;br/&gt;
    +            Pattern.compile( classNameExpr );&lt;br/&gt;
    +            Pattern.compile( methodNameExpr );&lt;br/&gt;
    +            if ( methodNameExpr.indexOf( &quot;#&quot; ) != -1 )&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    I thought you would use `String.contains` in both constructors of `ResolvedTest`.&lt;br/&gt;
    I think we do not need to use `Pattern.compile` here because this is already done by `maven-shared-utils` anyway.&lt;br/&gt;
    Lets use the sanity check if the `isRegex` is set, because I do not know how Cucumber would use JUnit Description of method or class name without regex. Cucumber is different runner from most of the other.&lt;/p&gt;</comment>
                            <comment id="15301137" author="githubbot" created="Wed, 25 May 2016 23:42:35 +0000"  >&lt;p&gt;Github user kgyrtkirk commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/113#issuecomment-221739676&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/113#issuecomment-221739676&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    I&apos;ve used `Pattern.compile` to keep the regexp&apos;s problem description; i thinked it makes it more clear how it will be used eventually.&lt;/p&gt;

&lt;p&gt;    I picked `TestListResolver` as it&apos;s place; because this is the first point where the deconstruction logic is used.&lt;br/&gt;
    plus: I wanted to keep all the generic exceptions of Pattern prior to these construction exceptions - without reassembling the original regex - but maybe this dosen&apos;t matter.&lt;/p&gt;

&lt;p&gt;    I might be able to move it to `ResolvedTest`...tomorrow i will look at it.&lt;/p&gt;</comment>
                            <comment id="15303479" author="githubbot" created="Fri, 27 May 2016 04:53:03 +0000"  >&lt;p&gt;Github user kgyrtkirk commented on the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/113#issuecomment-222059866&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/113#issuecomment-222059866&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    i&apos;ve moved the check into `ResolvedTest`.&lt;br/&gt;
    I now use the `MatchedPattern`...to check for exceptions.&lt;/p&gt;

&lt;p&gt;    I&apos;ve squashed my changes into one commit; because of the sidetrip to `TestListResolver`&lt;/p&gt;
</comment>
                            <comment id="15431783" author="githubbot" created="Mon, 22 Aug 2016 23:23:32 +0000"  >&lt;p&gt;Github user Tibor17 commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/113&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/113&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    @kgyrtkirk Please close the PR. The code was merged with master. Thx for contributing!&lt;/p&gt;</comment>
                            <comment id="15431784" author="tibor17" created="Mon, 22 Aug 2016 23:24:12 +0000"  >&lt;p&gt;commit 52681e56db036fa7f648ac43c084ac9f0747213e&lt;/p&gt;</comment>
                            <comment id="15431848" author="hudson" created="Tue, 23 Aug 2016 00:14:11 +0000"  >&lt;p&gt;SUCCESS: Integrated in Jenkins build maven-surefire #1600 (See &lt;a href=&quot;https://builds.apache.org/job/maven-surefire/1600/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/maven-surefire/1600/&lt;/a&gt;)&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SUREFIRE-1250&quot; title=&quot;Regex testcase filtering: exception when hashmark is regex-quoted&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SUREFIRE-1250&quot;&gt;&lt;del&gt;SUREFIRE-1250&lt;/del&gt;&lt;/a&gt; Regex testcase filtering: exception when hashmark is (tibor17: rev 52681e56db036fa7f648ac43c084ac9f0747213e)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;(edit) surefire-api/src/test/java/org/apache/maven/surefire/testset/TestListResolverTest.java&lt;/li&gt;
	&lt;li&gt;(edit) surefire-api/src/main/java/org/apache/maven/surefire/testset/ResolvedTest.java&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15432977" author="githubbot" created="Tue, 23 Aug 2016 15:06:17 +0000"  >&lt;p&gt;Github user kgyrtkirk closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/113&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/113&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17994651" author="olamy" created="Fri, 4 Jul 2025 07:25:50 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/2439&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#2439&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12805692" name="SUREFIRE-1250.patch" size="3083" author="kgyrtkirk" created="Mon, 23 May 2016 18:11:05 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2yc3z:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>