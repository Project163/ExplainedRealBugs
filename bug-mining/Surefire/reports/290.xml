<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:10:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-879] maven-surefire-report-plugin fails some times with ConcurrentModificationException when running parallel TestNG</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-879</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>
&lt;p&gt;I&apos;m running TestNG tests in parallel and get this exception ConcurrentModificationException.&lt;/p&gt;

&lt;p&gt;My quick analysis is that at the end of the test the method TestSetRunListener.getAsString is accessing the list of captured output while another thread (a stray thread spawned by the test or a completely different concurrent test) generates some more console output causing an append to the list which results in ConcurrentModificationException.&lt;/p&gt;

&lt;p&gt;To fix this we need to ensure getAsString accesses the list atomically. A possible solution is to copy/clone the list before iterating over it.&lt;/p&gt;

&lt;p&gt;Here is the stakctrace I get.&lt;/p&gt;

&lt;p&gt;java.util.ConcurrentModificationException&lt;br/&gt;
at java.util.AbstractList$Itr.checkForComodification(AbstractList.java:372)&lt;br/&gt;
at java.util.AbstractList$Itr.next(AbstractList.java:343)&lt;br/&gt;
at org.apache.maven.plugin.surefire.report.TestSetRunListener.getAsString(TestSetRunListener.java:209)&lt;br/&gt;
at org.apache.maven.plugin.surefire.report.TestSetRunListener.testFailed(TestSetRunListener.java:168)&lt;br/&gt;
at org.apache.maven.surefire.testng.TestNGReporter.onTestFailure(TestNGReporter.java:104)&lt;br/&gt;
at org.testng.internal.Invoker.runTestListeners(Invoker.java:1796)&lt;br/&gt;
at org.testng.internal.Invoker.runTestListeners(Invoker.java:1780)&lt;br/&gt;
at org.testng.internal.Invoker.invokeMethod(Invoker.java:749)&lt;br/&gt;
at org.testng.internal.Invoker.invokeTestMethod(Invoker.java:846)&lt;br/&gt;
at org.testng.internal.Invoker.invokeTestMethods(Invoker.java:1170)&lt;br/&gt;
at org.testng.internal.TestMethodWorker.invokeTestMethods(TestMethodWorker.java:125)&lt;br/&gt;
at org.testng.internal.TestMethodWorker.run(TestMethodWorker.java:109)&lt;br/&gt;
at org.testng.TestRunner.runWorkers(TestRunner.java:1147)&lt;br/&gt;
at org.testng.TestRunner.privateRun(TestRunner.java:749)&lt;br/&gt;
at org.testng.TestRunner.run(TestRunner.java:600)&lt;br/&gt;
at org.testng.SuiteRunner.runTest(SuiteRunner.java:317)&lt;br/&gt;
at org.testng.SuiteRunner.access$000(SuiteRunner.java:34)&lt;br/&gt;
at org.testng.SuiteRunner$SuiteWorker.run(SuiteRunner.java:351)&lt;br/&gt;
at org.testng.internal.thread.ThreadUtil$CountDownLatchedRunnable.run(ThreadUtil.java:147)&lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor$Worker.runTask(ThreadPoolExecutor.java:886)&lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:908)&lt;br/&gt;
at java.lang.Thread.run(Thread.java:662)&lt;/p&gt;</description>
                <environment>Java version: 1.6.0_32&lt;br/&gt;
Maven version: 3.0.4&lt;br/&gt;
maven-surefire-report-plugin: 2.12&lt;br/&gt;
TestNG: 5.14.10 </environment>
        <key id="12809570">SUREFIRE-879</key>
            <summary>maven-surefire-report-plugin fails some times with ConcurrentModificationException when running parallel TestNG</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="pgier">Paul Gier</assignee>
                                    <reporter username="anistor">Adrian Nistor</reporter>
                        <labels>
                    </labels>
                <created>Tue, 26 Jun 2012 16:18:55 +0000</created>
                <updated>Fri, 4 Jul 2025 07:18:36 +0000</updated>
                            <resolved>Thu, 28 Jun 2012 10:33:42 +0000</resolved>
                                    <version>2.12</version>
                                    <fixVersion>2.12.1</fixVersion>
                                    <component>TestNG support</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14455401" author="anistor" created="Tue, 26 Jun 2012 16:19:22 +0000"  >&lt;p&gt;Will try to create a sample test and also submit a patch very soon this week.&lt;/p&gt;</comment>
                            <comment id="14455463" author="anistor" created="Wed, 27 Jun 2012 06:15:22 +0000"  >&lt;p&gt;An important note, to reproduce this bug you must have at least one failing test in your suite. This can also be seen in the above stacktrace.&lt;/p&gt;</comment>
                            <comment id="14455425" author="anistor" created="Wed, 27 Jun 2012 06:26:34 +0000"  >&lt;p&gt;This is a small project (a pom.xml + a simple TestNG test) that helps reproduce the issue. Please see instructions in README.txt from zip.&lt;/p&gt;</comment>
                            <comment id="14455491" author="anistor" created="Wed, 27 Jun 2012 06:46:18 +0000"  >&lt;p&gt;I pushed a fix to github and made a pull request: &lt;a href=&quot;https://github.com/apache/maven-surefire/pull/6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/maven-surefire/pull/6&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks&lt;/p&gt;</comment>
                            <comment id="14455320" author="pgier" created="Thu, 28 Jun 2012 10:33:42 +0000"  >&lt;p&gt;Merged the patch to the main svn repo, thanks!&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1355045&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1355045&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14455439" author="anistor" created="Thu, 28 Jun 2012 10:49:29 +0000"  >&lt;p&gt;Great! Thanks&lt;/p&gt;</comment>
                            <comment id="17994269" author="olamy" created="Fri, 4 Jul 2025 07:18:36 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/1671&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#1671&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12720269" name="surefire-879-bug.zip" size="2443" author="anistor" created="Wed, 27 Jun 2012 06:26:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bejz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            </customfields>
    </item>
</channel>
</rss>