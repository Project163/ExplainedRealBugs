<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:09:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-446] Surefire fails to capture TestNG results when forkMode=always</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-446</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;The interplay between &lt;tt&gt;surefire.Surefire&lt;/tt&gt; and &lt;tt&gt;testng.TestNGDirectoryTestSuite&lt;/tt&gt; does not properly notify the ReportManager such that it reports 0 executed tests after the end of the day. IT to reproduce attached.&lt;/p&gt;

&lt;p&gt;Also confirmed against 2.5-SNAPSHOT.&lt;/p&gt;</description>
                <environment>Maven 2.0.8, JDK 1.5.0_12, WinXP</environment>
        <key id="12809687">SUREFIRE-446</key>
            <summary>Surefire fails to capture TestNG results when forkMode=always</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bentmann">Benjamin Bentmann</reporter>
                        <labels>
                    </labels>
                <created>Tue, 29 Jan 2008 14:03:23 +0000</created>
                <updated>Fri, 4 Jul 2025 07:09:26 +0000</updated>
                            <resolved>Mon, 1 Aug 2011 10:40:29 +0000</resolved>
                                    <version>2.4</version>
                                    <fixVersion>2.9</fixVersion>
                                    <component>process forking</component>
                        <due></due>
                            <votes>10</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14454148" author="dfabulich" created="Tue, 5 Feb 2008 14:47:31 +0000"  >&lt;p&gt;Repro&apos;d.&lt;/p&gt;</comment>
                            <comment id="14454261" author="dfabulich" created="Wed, 6 Feb 2008 17:22:06 +0000"  >&lt;p&gt;This is trickier than it looks...  I&apos;m not 100% certain that it even makes sense to run TestNG with forkMode=always; it isn&apos;t necessarily safe to do so (especially when tests depend on tests in other classes).  &lt;span class=&quot;error&quot;&gt;&amp;#91;This certainly explains how Benjamin found this bug... ;-)&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Ideally, TestNG would provide its own support for forkMode=always...  Short of that, it&apos;s hard to see how we can hack it into Surefire on top of the framework that&apos;s already in place.&lt;/p&gt;</comment>
                            <comment id="14454289" author="bentmann" created="Wed, 6 Feb 2008 17:41:42 +0000"  >&lt;blockquote&gt;&lt;p&gt;This certainly explains how Benjamin found this bug... &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;What should I say, I am just evil minded &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;it isn&apos;t necessarily safe to do so&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The same is true with running tests in parallel. If your test suite contains non-thread-safe method calls, well, multi-threaded tests are a bad idea, too. So, is Surefire going to drop its parameter &quot;parallel&quot; because an incompotent user could make the tests errorneously fail? I wouldn&apos;t feel quite comfortable with a build tool that restricts me from doing something just because it &lt;b&gt;might&lt;/b&gt; not work although - for a special use-case - it &lt;b&gt;will&lt;/b&gt; work.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Short of that, it&apos;s hard to see how we can hack it into Surefire on top of the framework that&apos;s already in place.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Naively spoken, I would expect that forkMode=always behaves as if &lt;tt&gt;TestNGDirectoryTestSuite&lt;/tt&gt; found only a single test class.&lt;/p&gt;</comment>
                            <comment id="14454222" author="andyhot" created="Mon, 3 Mar 2008 04:30:41 +0000"  >&lt;p&gt;The 2.4-collab-SNAPSHOT version does not suffer from this.&lt;/p&gt;</comment>
                            <comment id="14454391" author="jwiegman" created="Wed, 21 May 2008 15:51:40 +0000"  >&lt;p&gt;I&apos;m suffering from this as well.  The 2.4-collab-SNAPSHOT has plenty of unfixed bugs and I unfortunately cannot use this version.&lt;/p&gt;

&lt;p&gt;As for forkMode=always, this is a relatively common practice in unit tests.  Consider the following scenarios:&lt;/p&gt;

&lt;p&gt;1. I have a crucial static variable and would like it reset to a known state for each test / test class&lt;br/&gt;
2. I bootstrap my unit tests with some data by using an in-memory database that&apos;s created on the fly and would like it to be reset to a known state for each test/test class as well&lt;/p&gt;

&lt;p&gt;In either of these scenarios, the only way to return to a known state in a unit test is to ensure you&apos;re starting with a fresh JVM.&lt;/p&gt;

&lt;p&gt;I get that TestNG offers some testing functionality that is &quot;outside&quot; the unit testing paradigm (@BeforeSuite and @AfterSuite), but I agree with Benjamin... let&apos;s let the developer use whatever configuration he/she wants and let them make their own mistakes.&lt;/p&gt;</comment>
                            <comment id="14454620" author="andyhot" created="Thu, 12 Aug 2010 10:39:24 +0000"  >&lt;p&gt;Are there any plans to somehow resolve this? &lt;/p&gt;

&lt;p&gt;I&apos;d like to help resolve this, or at least include a patch here for those that would also be interested - any guidance on which part of the code I should start looking at?&lt;/p&gt;</comment>
                            <comment id="14454735" author="velo" created="Wed, 10 Nov 2010 07:23:57 +0000"  >&lt;p&gt;I made a small patch that doesn&apos;t solve the problem of the testNG html report, but, it makes this issue more manageable, specially for those running testNG + maven + forked=always on CI servers&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Index: surefire-providers/surefire-testng/src/main/java/org/apache/maven/surefire/testng/TestNGDirectoryTestSuite.java
===================================================================
--- surefire-providers/surefire-testng/src/main/java/org/apache/maven/surefire/testng/TestNGDirectoryTestSuite.java	(revision 1033415)
+++ surefire-providers/surefire-testng/src/main/java/org/apache/maven/surefire/testng/TestNGDirectoryTestSuite.java	(working copy)
@@ -98,6 +98,8 @@
             &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TestSetFailedException( &lt;span class=&quot;code-quote&quot;&gt;&quot;Unable to find test set &lt;span class=&quot;code-quote&quot;&gt;&apos;&quot;&lt;/span&gt; + testSetName + &lt;span class=&quot;code-quote&quot;&gt;&quot;&apos;&lt;/span&gt; in suite&quot;&lt;/span&gt; );
         }
 
+        &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.options.put( &lt;span class=&quot;code-quote&quot;&gt;&quot;suitename&quot;&lt;/span&gt;, testSetName );
+
         ReporterManager reporterManager = reporterManagerFactory.createReporterManager();
         startTestSuite( reporterManager, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; );
 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This will create on report.xml per test. This eliminates the problem on CI builds and makes it much more useful for people running it locally, since now it is possible to see the test failure result.&lt;/p&gt;

&lt;p&gt;VELO&lt;/p&gt;</comment>
                            <comment id="14455054" author="bdemers" created="Wed, 8 Jun 2011 12:14:29 +0000"  >&lt;p&gt;I applied the previous patch.&lt;/p&gt;</comment>
                            <comment id="14455108" author="plynch" created="Mon, 1 Aug 2011 10:40:29 +0000"  >&lt;p&gt;velo&apos;s patch was applied and included in the 2.9 release.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1133426&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1133426&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Didn&apos;t see another reason to keep this issue open - if there is, feel free to reopen it.&lt;/p&gt;</comment>
                            <comment id="17993786" author="olamy" created="Fri, 4 Jul 2025 07:09:26 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/1346&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#1346&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13058908">SUREFIRE-1346</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12720004" name="testng-fork-mode-it.patch" size="10223" author="bentmann" created="Tue, 29 Jan 2008 14:03:23 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bghr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>