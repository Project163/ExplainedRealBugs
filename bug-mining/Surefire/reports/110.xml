<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 07:07:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF Jira</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SUREFIRE-432] Surefire swallows redirected test output if uncaught exceptions occur in forked SurefireBooter</title>
                <link>https://issues.apache.org/jira/browse/SUREFIRE-432</link>
                <project id="12317927" key="SUREFIRE">Maven Surefire (Moved to GitHub Issues)</project>
                    <description>&lt;p&gt;If Surefire&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;forks a test and&lt;/li&gt;
	&lt;li&gt;is configured to redirect test output to a file and&lt;/li&gt;
	&lt;li&gt;encounters an uncaught exception in its internals&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;the tests fail (as expected) but the user does not get any information about the error, i.e. the txt files under target/surefire-reports are of zero length. This can be quite fustrating.&lt;/p&gt;

&lt;p&gt;Attached is an integration test which produces the following exception:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.reflect.InvocationTargetException
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
	at java.lang.reflect.Method.invoke(Method.java:585)
	at org.apache.maven.surefire.booter.SurefireBooter.runSuitesInProcess(SurefireBooter.java:334)
	at org.apache.maven.surefire.booter.SurefireBooter.main(SurefireBooter.java:980)
Caused by: org.testng.TestNGException: 
Cyclic graph of methods
	at org.testng.internal.Graph.topologicalSort(Graph.java:117)
	at org.testng.internal.MethodHelper.topologicalSort(MethodHelper.java:494)
	at org.testng.internal.MethodHelper.sortMethods(MethodHelper.java:544)
	at org.testng.internal.MethodHelper.internalCollectAndOrderMethods(MethodHelper.java:77)
	at org.testng.internal.MethodHelper.collectAndOrderMethods(MethodHelper.java:49)
	at org.testng.TestRunner.initMethods(TestRunner.java:337)
	at org.testng.TestRunner.init(TestRunner.java:216)
	at org.testng.TestRunner.init(TestRunner.java:178)
	at org.testng.TestRunner.&amp;lt;init&amp;gt;(TestRunner.java:127)
	at org.testng.SuiteRunner$DefaultTestRunnerFactory.newTestRunner(SuiteRunner.java:454)
	at org.testng.SuiteRunner.privateRun(SuiteRunner.java:235)
	at org.testng.SuiteRunner.run(SuiteRunner.java:191)
	at org.testng.TestNG.createAndRunSuiteRunners(TestNG.java:808)
	at org.testng.TestNG.runSuitesLocally(TestNG.java:776)
	at org.testng.TestNG.run(TestNG.java:701)
	at org.apache.maven.surefire.testng.TestNGExecutor.run(TestNGExecutor.java:64)
	at org.apache.maven.surefire.testng.TestNGDirectoryTestSuite.execute(TestNGDirectoryTestSuite.java:136)
	at org.apache.maven.surefire.Surefire.run(Surefire.java:177)
	... 6 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This uncaught exception causes abnormal completion of Surefire.run() such that reporterManager.runCompleted() never gets called. Without the call the runCompleted(), Reporter.writeFooter() gets never called, too. This means ForkingStreamConsumer.consumeLine() will never call OutputConsumer.testSetCompleted(). However, the later call would be required to properly flush the FileWriter employed by FileOutputConsumerProxy.&lt;/p&gt;

&lt;p&gt;I think what is needed is a means in SurefireBooter.fork() to flush/close the StreamConsumers after the call to CommandLineUtils.executeCommandLine() returned.&lt;/p&gt;</description>
                <environment>Maven 2.0.8, JDK 1.5.0_12, WinXP</environment>
        <key id="12809491">SUREFIRE-432</key>
            <summary>Surefire swallows redirected test output if uncaught exceptions occur in forked SurefireBooter</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bentmann">Benjamin Bentmann</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Jan 2008 16:38:16 +0000</created>
                <updated>Fri, 4 Jul 2025 07:09:21 +0000</updated>
                            <resolved>Fri, 25 Jan 2008 16:23:56 +0000</resolved>
                                    <version>2.4</version>
                                    <fixVersion>2.4.1</fixVersion>
                                    <component>process forking</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="14454243" author="bentmann" created="Thu, 17 Jan 2008 16:13:05 +0000"  >&lt;p&gt;Fixed test, the requirement on TestSuite.txt was too much. All that matters is the TestSuite-output.txt with the stack trace.&lt;/p&gt;</comment>
                            <comment id="14454163" author="bentmann" created="Thu, 17 Jan 2008 16:19:51 +0000"  >&lt;p&gt;Now, here&apos;s a possible fix. I broke some encapsulation to get the OutputConsumer from the ForkingStreamConsumer in order to call testSetCompleted() on it which triggers the required file close. I&apos;m not sure whether this is a good approach though. Maybe it would be better to add a dedicated close() method to the OutputConsumer interface to prevent interferences with the normal usage of testSetCompleted().&lt;/p&gt;</comment>
                            <comment id="14454126" author="bentmann" created="Mon, 21 Jan 2008 17:20:49 +0000"  >&lt;p&gt;Fixed IT patch, contained duplicate contents.&lt;/p&gt;</comment>
                            <comment id="14454065" author="dfabulich" created="Fri, 25 Jan 2008 16:23:56 +0000"  >&lt;p&gt;submitted revision 615379.&lt;/p&gt;</comment>
                            <comment id="17993781" author="olamy" created="Fri, 4 Jul 2025 07:09:21 +0000"  >&lt;p&gt;This project has moved from Jira to GitHub Issues. This issue was migrated to &lt;a href=&quot;https://github.com/apache/maven-surefire/issues/1345&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;apache/maven-surefire#1345&lt;/a&gt;. &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12719687" name="file-output-consumer-proxy-close.patch" size="2397" author="bentmann" created="Thu, 17 Jan 2008 16:19:51 +0000"/>
                            <attachment id="12720242" name="testng-execute-error.patch" size="5264" author="bentmann" created="Mon, 21 Jan 2008 17:20:49 +0000"/>
                            <attachment id="12719900" name="testng-execute-error.patch" size="8858" author="bentmann" created="Thu, 17 Jan 2008 16:13:05 +0000"/>
                            <attachment id="12719685" name="testng-execute-error.patch" size="8956" author="bentmann" created="Wed, 16 Jan 2008 16:38:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[no_permission]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2bczb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12312220" key="com.atlassian.jira.plugin.system.customfieldtypes:radiobuttons">
                        <customfieldname>Testcase included</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="11060"><![CDATA[Yes]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                        </customfields>
    </item>
</channel>
</rss>