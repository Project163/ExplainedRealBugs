diff --git a/surefire-shadefire/pom.xml b/surefire-shadefire/pom.xml
index cafa27e17..f7d39ff17 100644
--- a/surefire-shadefire/pom.xml
+++ b/surefire-shadefire/pom.xml
@@ -84,6 +84,10 @@
                   <include>org.apache.maven.surefire:common-junit3</include>
                   <include>org.apache.maven.surefire:surefire-junit3</include>
                 </includes>
+                <excludes>
+                  <!-- with rebuild old shaded artifact is used -->
+                  <exclude>${project.groupId}:${project.artifactId}</exclude>
+                </excludes>
               </artifactSet>
               <relocations>
                 <relocation>
diff --git a/surefire-shared-utils/pom.xml b/surefire-shared-utils/pom.xml
index 4de4b27e9..380a75daa 100644
--- a/surefire-shared-utils/pom.xml
+++ b/surefire-shared-utils/pom.xml
@@ -71,11 +71,30 @@
               <goal>shade</goal>
             </goals>
             <configuration>
+              <artifactSet>
+                <excludes>
+                  <!-- with rebuild old shaded artifact is used -->
+                  <exclude>${project.groupId}:${project.artifactId}</exclude>
+                </excludes>
+              </artifactSet>
+              <filters>
+                <filter>
+                  <artifact>*:*</artifact>
+                  <excludes>
+                    <exclude>**/module-info.class</exclude>
+                    <exclude>META-INF/MANIFEST.MF</exclude>
+                  </excludes>
+                </filter>
+              </filters>
               <relocations>
                 <relocation>
                   <pattern>org.apache.maven.shared.utils</pattern>
                   <shadedPattern>org.apache.maven.surefire.shared.utils</shadedPattern>
                 </relocation>
+                <relocation>
+                  <pattern>org.apache.commons.codec</pattern>
+                  <shadedPattern>org.apache.maven.surefire.shared.codec</shadedPattern>
+                </relocation>
                 <relocation>
                   <pattern>org.apache.commons.io</pattern>
                   <shadedPattern>org.apache.maven.surefire.shared.io</shadedPattern>
@@ -89,6 +108,13 @@
                   <shadedPattern>org.apache.maven.surefire.shared.compress</shadedPattern>
                 </relocation>
               </relocations>
+              <transformers>
+                <transformer implementation="org.apache.maven.plugins.shade.resource.ApacheLicenseResourceTransformer" />
+                <transformer implementation="org.apache.maven.plugins.shade.resource.ApacheNoticeResourceTransformer" />
+                <transformer implementation="org.apache.maven.plugins.shade.resource.AppendingTransformer">
+                  <resource>META-INF/DEPENDENCIES</resource>
+                </transformer>
+              </transformers>
             </configuration>
           </execution>
         </executions>
