diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/AbstractSurefireMojo.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/AbstractSurefireMojo.java
index 4253b8c82..c976a2376 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/AbstractSurefireMojo.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/AbstractSurefireMojo.java
@@ -1777,8 +1777,23 @@ private static Set<Artifact> retainInProcArtifactsUnique( Set<Artifact> provider
                                                          Artifact... inPluginArtifacts )
     {
         Set<Artifact> result = new LinkedHashSet<Artifact>();
-        addAll( result, inPluginArtifacts );
-        result.removeAll( providerArtifacts );
+        for ( Artifact inPluginArtifact : inPluginArtifacts )
+        {
+            boolean contains = false;
+            for ( Artifact providerArtifact : providerArtifacts )
+            {
+                if ( providerArtifact.getGroupId().equals( inPluginArtifact.getGroupId() )
+                        && providerArtifact.getArtifactId().equals( inPluginArtifact.getArtifactId() ) )
+                {
+                    contains = true;
+                    break;
+                }
+            }
+            if ( !contains )
+            {
+                result.add( inPluginArtifact );
+            }
+        }
         return result;
     }
 
