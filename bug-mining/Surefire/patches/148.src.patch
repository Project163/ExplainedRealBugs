diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/Surefire.java b/surefire-api/src/main/java/org/apache/maven/surefire/Surefire.java
index 5ccf00f42..1afde855b 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/Surefire.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/Surefire.java
@@ -1,312 +1,265 @@
-package org.apache.maven.surefire;
-
-/*
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing,
- * software distributed under the License is distributed on an
- * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
- * KIND, either express or implied.  See the License for the
- * specific language governing permissions and limitations
- * under the License.
- */
-
-import org.apache.maven.surefire.report.Reporter;
-import org.apache.maven.surefire.report.ReporterException;
-import org.apache.maven.surefire.report.ReporterManager;
-import org.apache.maven.surefire.report.ReporterManagerFactory;
-import org.apache.maven.surefire.report.RunStatistics;
-import org.apache.maven.surefire.suite.SurefireTestSuite;
-import org.apache.maven.surefire.testset.TestSetFailedException;
-
-import java.lang.reflect.Constructor;
-import java.lang.reflect.InvocationTargetException;
-import java.util.ArrayList;
-import java.util.Iterator;
-import java.util.List;
-import java.util.Properties;
-import java.util.ResourceBundle;
-
-/**
- * @author Jason van Zyl
- * @version $Id$
- */
-public class Surefire
-{
-    
-    private static final int SUCCESS = 0;
-    private static final int NO_TESTS = 254;
-    private static final int FAILURE = 255;
-    
-    private ResourceBundle bundle = ResourceBundle.getBundle( SUREFIRE_BUNDLE_NAME );
-
-    public static final String SUREFIRE_BUNDLE_NAME = "org.apache.maven.surefire.surefire";
-
-    // DGF backwards compatibility
-    public boolean run( List reportDefinitions, Object[] testSuiteDefinition, String testSetName,
-                    ClassLoader surefireClassLoader, ClassLoader testsClassLoader )
-        throws ReporterException, TestSetFailedException
-    {
-        return run( reportDefinitions, testSuiteDefinition, testSetName, surefireClassLoader, testsClassLoader, null,
-                    Boolean.FALSE ) == 0;
-    }
-    
-    public int run( List reportDefinitions, Object[] testSuiteDefinition, String testSetName,
-                        ClassLoader surefireClassLoader, ClassLoader testsClassLoader, Boolean failIfNoTests )
-        throws ReporterException, TestSetFailedException
-    {
-        return run( reportDefinitions, testSuiteDefinition, testSetName, surefireClassLoader, testsClassLoader, null,
-                    failIfNoTests );
-    }
-
-    // DGF backwards compatibility
-    public boolean run( List reportDefinitions, Object[] testSuiteDefinition, String testSetName,
-                    ClassLoader surefireClassLoader, ClassLoader testsClassLoader, Properties results )
-        throws ReporterException, TestSetFailedException
-    {
-        return run( reportDefinitions, testSuiteDefinition, testSetName, surefireClassLoader, testsClassLoader,
-                    results, Boolean.FALSE ) == 0;
-    }
-    
-    public int run( List reportDefinitions, Object[] testSuiteDefinition, String testSetName,
-                    ClassLoader surefireClassLoader, ClassLoader testsClassLoader, Properties results,
-                    Boolean failIfNoTests )
-        throws ReporterException, TestSetFailedException
-    {
-        ReporterManagerFactory reporterManagerFactory =
-            new ReporterManagerFactory( reportDefinitions, surefireClassLoader);
-
-        RunStatistics runStatistics = reporterManagerFactory.getGlobalRunStatistics();
-        if ( results != null )
-        {
-            runStatistics.initResultsFromProperties( results );
-        }
-
-        int totalTests = 0;
-
-        SurefireTestSuite suite = createSuiteFromDefinition( testSuiteDefinition, surefireClassLoader, testsClassLoader );
-
-        int testCount = suite.getNumTests();
-        if ( testCount > 0 )
-        {
-            totalTests += testCount;
-        }
-
-        if ( totalTests == 0 )
-        {
-            reporterManagerFactory.createReporterManager().writeMessage( "There are no tests to run." );
-        }
-        else
-        {
-            suite.execute( testSetName, reporterManagerFactory, testsClassLoader );
-        }
-
-        reporterManagerFactory.close();
-
-        if ( results != null )
-        {
-            runStatistics.updateResultsProperties( results );
-        }
-
-        if ( failIfNoTests.booleanValue() )
-        {
-            if ( runStatistics.getCompletedCount() == 0 )
-            {
-                return NO_TESTS;
-            }
-        }
-        
-
-        return runStatistics.isProblemFree() ? SUCCESS : FAILURE;
-
-    }
-
-    public boolean run( List reportDefinitions, List testSuiteDefinitions, ClassLoader surefireClassLoader,
-                        ClassLoader testsClassLoader )
-        throws ReporterException, TestSetFailedException
-    {
-        return run ( reportDefinitions, testSuiteDefinitions, surefireClassLoader, testsClassLoader, Boolean.FALSE )
-               == 0;
-    }
-    public int run( List reportDefinitions, List testSuiteDefinitions, ClassLoader surefireClassLoader,
-                        ClassLoader testsClassLoader, Boolean failIfNoTests )
-        throws ReporterException, TestSetFailedException
-    {
-        ReporterManagerFactory reporterManagerFactory =
-            new ReporterManagerFactory( reportDefinitions, surefireClassLoader);
-
-        RunStatistics runStatistics = reporterManagerFactory.getGlobalRunStatistics();
-
-        List suites = new ArrayList();
-
-        int totalTests = 0;
-        for ( Iterator i = testSuiteDefinitions.iterator(); i.hasNext(); )
-        {
-            Object[] definition = (Object[]) i.next();
-
-            SurefireTestSuite suite = createSuiteFromDefinition( definition, surefireClassLoader, testsClassLoader );
-
-            int testCount = suite.getNumTests();
-            if ( testCount > 0 )
-            {
-                suites.add( suite );
-                totalTests += testCount;
-            }
-        }
-
-        if ( totalTests == 0 )
-        {
-            reporterManagerFactory.createReporterManager().writeMessage( "There are no tests to run." );
-        }
-        else
-        {
-            for ( Iterator i = suites.iterator(); i.hasNext(); )
-            {
-                SurefireTestSuite suite = (SurefireTestSuite) i.next();
-                suite.execute( reporterManagerFactory, testsClassLoader );
-            }
-        }
-
-        reporterManagerFactory.close();
-        if ( failIfNoTests.booleanValue() )
-        {
-            if ( runStatistics.getCompletedCount() == 0 )
-            {
-                return NO_TESTS;
-            }
-        }
-
-        return runStatistics.isProblemFree() ? SUCCESS : FAILURE;
-    }
-
-    private SurefireTestSuite createSuiteFromDefinition( Object[] definition, ClassLoader surefireClassLoader,
-                                                         ClassLoader testsClassLoader )
-        throws TestSetFailedException
-    {
-        String suiteClass = (String) definition[0];
-        Object[] params = (Object[]) definition[1];
-
-        SurefireTestSuite suite = instantiateSuite( suiteClass, params, surefireClassLoader );
-
-        suite.locateTestSets( testsClassLoader );
-
-        return suite;
-    }
-
-    private List instantiateReports( List reportDefinitions, ClassLoader classLoader )
-        throws TestSetFailedException
-    {
-        List reports = new ArrayList();
-
-        for ( Iterator i = reportDefinitions.iterator(); i.hasNext(); )
-        {
-            Object[] definition = (Object[]) i.next();
-
-            String className = (String) definition[0];
-            Object[] params = (Object[]) definition[1];
-
-            Reporter report = instantiateReport( className, params, classLoader );
-
-            reports.add( report );
-        }
-
-        return reports;
-    }
-
-    private static Reporter instantiateReport( String className, Object[] params, ClassLoader classLoader )
-        throws TestSetFailedException
-    {
-        try
-        {
-            return (Reporter) instantiateObject( className, params, classLoader );
-        }
-        catch ( ClassNotFoundException e )
-        {
-            throw new TestSetFailedException( "Unable to find class to create report '" + className + "'", e );
-        }
-        catch ( NoSuchMethodException e )
-        {
-            throw new TestSetFailedException(
-                "Unable to find appropriate constructor to create report: " + e.getMessage(), e );
-        }
-    }
-
-    public static Object instantiateObject( String className, Object[] params, ClassLoader classLoader )
-        throws TestSetFailedException, ClassNotFoundException, NoSuchMethodException
-    {
-        Class clazz = classLoader.loadClass( className );
-
-        Object object;
-        try
-        {
-            if ( params != null )
-            {
-                Class[] paramTypes = new Class[params.length];
-
-                for ( int j = 0; j < params.length; j++ )
-                {
-                    if ( params[j] == null )
-                    {
-                        paramTypes[j] = String.class;
-                    }
-                    else
-                    {
-                        paramTypes[j] = params[j].getClass();
-                    }
-                }
-
-                Constructor constructor = clazz.getConstructor( paramTypes );
-
-                object = constructor.newInstance( params );
-            }
-            else
-            {
-                object = clazz.newInstance();
-            }
-        }
-        catch ( IllegalAccessException e )
-        {
-            throw new TestSetFailedException( "Unable to instantiate object: " + e.getMessage(), e );
-        }
-        catch ( InvocationTargetException e )
-        {
-            throw new TestSetFailedException( e.getTargetException().getMessage(), e.getTargetException() );
-        }
-        catch ( InstantiationException e )
-        {
-            throw new TestSetFailedException( "Unable to instantiate object: " + e.getMessage(), e );
-        }
-        return object;
-    }
-
-    private static SurefireTestSuite instantiateSuite( String suiteClass, Object[] params, ClassLoader classLoader )
-        throws TestSetFailedException
-    {
-        try
-        {
-            return (SurefireTestSuite) instantiateObject( suiteClass, params, classLoader );
-        }
-        catch ( ClassNotFoundException e )
-        {
-            throw new TestSetFailedException( "Unable to find class to create suite '" + suiteClass + "'", e );
-        }
-        catch ( NoSuchMethodException e )
-        {
-            throw new TestSetFailedException(
-                "Unable to find appropriate constructor to create suite: " + e.getMessage(), e );
-        }
-    }
-
-    public String getResourceString( String key )
-    {
-        return bundle.getString( key );
-    }
-}
+package org.apache.maven.surefire;
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import org.apache.maven.surefire.report.ReporterException;
+import org.apache.maven.surefire.report.ReporterManagerFactory;
+import org.apache.maven.surefire.report.RunStatistics;
+import org.apache.maven.surefire.suite.SurefireTestSuite;
+import org.apache.maven.surefire.testset.TestSetFailedException;
+
+import java.lang.reflect.Constructor;
+import java.lang.reflect.InvocationTargetException;
+import java.util.ArrayList;
+import java.util.Iterator;
+import java.util.List;
+import java.util.Properties;
+
+/**
+ * @author Jason van Zyl
+ * @version $Id$
+ */
+public class Surefire
+{
+    
+    private static final int SUCCESS = 0;
+    private static final int NO_TESTS = 254;
+    private static final int FAILURE = 255;
+    
+    public static final String SUREFIRE_BUNDLE_NAME = "org.apache.maven.surefire.surefire";
+
+    // DGF backwards compatibility
+    public boolean run( List reportDefinitions, Object[] testSuiteDefinition, String testSetName,
+                    ClassLoader surefireClassLoader, ClassLoader testsClassLoader )
+        throws ReporterException, TestSetFailedException
+    {
+        return run( reportDefinitions, testSuiteDefinition, testSetName, surefireClassLoader, testsClassLoader, null,
+                    Boolean.FALSE ) == 0;
+    }
+    
+    public int run( List reportDefinitions, Object[] testSuiteDefinition, String testSetName,
+                        ClassLoader surefireClassLoader, ClassLoader testsClassLoader, Boolean failIfNoTests )
+        throws ReporterException, TestSetFailedException
+    {
+        return run( reportDefinitions, testSuiteDefinition, testSetName, surefireClassLoader, testsClassLoader, null,
+                    failIfNoTests );
+    }
+
+    // DGF backwards compatibility
+    public boolean run( List reportDefinitions, Object[] testSuiteDefinition, String testSetName,
+                    ClassLoader surefireClassLoader, ClassLoader testsClassLoader, Properties results )
+        throws ReporterException, TestSetFailedException
+    {
+        return run( reportDefinitions, testSuiteDefinition, testSetName, surefireClassLoader, testsClassLoader,
+                    results, Boolean.FALSE ) == 0;
+    }
+    
+    public int run( List reportDefinitions, Object[] testSuiteDefinition, String testSetName,
+                    ClassLoader surefireClassLoader, ClassLoader testsClassLoader, Properties results,
+                    Boolean failIfNoTests )
+        throws ReporterException, TestSetFailedException
+    {
+        ReporterManagerFactory reporterManagerFactory =
+            new ReporterManagerFactory( reportDefinitions, surefireClassLoader);
+
+        RunStatistics runStatistics = reporterManagerFactory.getGlobalRunStatistics();
+        if ( results != null )
+        {
+            runStatistics.initResultsFromProperties( results );
+        }
+
+        int totalTests = 0;
+
+        SurefireTestSuite suite = createSuiteFromDefinition( testSuiteDefinition, surefireClassLoader, testsClassLoader );
+
+        int testCount = suite.getNumTests();
+        if ( testCount > 0 )
+        {
+            totalTests += testCount;
+        }
+
+        if ( totalTests == 0 )
+        {
+            reporterManagerFactory.createReporterManager().writeMessage( "There are no tests to run." );
+        }
+        else
+        {
+            suite.execute( testSetName, reporterManagerFactory, testsClassLoader );
+        }
+
+        reporterManagerFactory.close();
+
+        if ( results != null )
+        {
+            runStatistics.updateResultsProperties( results );
+        }
+
+        if ( failIfNoTests.booleanValue() )
+        {
+            if ( runStatistics.getCompletedCount() == 0 )
+            {
+                return NO_TESTS;
+            }
+        }
+        
+
+        return runStatistics.isProblemFree() ? SUCCESS : FAILURE;
+
+    }
+
+    public boolean run( List reportDefinitions, List testSuiteDefinitions, ClassLoader surefireClassLoader,
+                        ClassLoader testsClassLoader )
+        throws ReporterException, TestSetFailedException
+    {
+        return run ( reportDefinitions, testSuiteDefinitions, surefireClassLoader, testsClassLoader, Boolean.FALSE )
+               == 0;
+    }
+    public int run( List reportDefinitions, List testSuiteDefinitions, ClassLoader surefireClassLoader,
+                        ClassLoader testsClassLoader, Boolean failIfNoTests )
+        throws ReporterException, TestSetFailedException
+    {
+        ReporterManagerFactory reporterManagerFactory =
+            new ReporterManagerFactory( reportDefinitions, surefireClassLoader);
+
+        RunStatistics runStatistics = reporterManagerFactory.getGlobalRunStatistics();
+
+        List suites = new ArrayList();
+
+        int totalTests = 0;
+        for ( Iterator i = testSuiteDefinitions.iterator(); i.hasNext(); )
+        {
+            Object[] definition = (Object[]) i.next();
+
+            SurefireTestSuite suite = createSuiteFromDefinition( definition, surefireClassLoader, testsClassLoader );
+
+            int testCount = suite.getNumTests();
+            if ( testCount > 0 )
+            {
+                suites.add( suite );
+                totalTests += testCount;
+            }
+        }
+
+        if ( totalTests == 0 )
+        {
+            reporterManagerFactory.createReporterManager().writeMessage( "There are no tests to run." );
+        }
+        else
+        {
+            for ( Iterator i = suites.iterator(); i.hasNext(); )
+            {
+                SurefireTestSuite suite = (SurefireTestSuite) i.next();
+                suite.execute( reporterManagerFactory, testsClassLoader );
+            }
+        }
+
+        reporterManagerFactory.close();
+        if ( failIfNoTests.booleanValue() )
+        {
+            if ( runStatistics.getCompletedCount() == 0 )
+            {
+                return NO_TESTS;
+            }
+        }
+
+        return runStatistics.isProblemFree() ? SUCCESS : FAILURE;
+    }
+
+    private SurefireTestSuite createSuiteFromDefinition( Object[] definition, ClassLoader surefireClassLoader,
+                                                         ClassLoader testsClassLoader )
+        throws TestSetFailedException
+    {
+        String suiteClass = (String) definition[0];
+        Object[] params = (Object[]) definition[1];
+
+        SurefireTestSuite suite = instantiateSuite( suiteClass, params, surefireClassLoader );
+
+        suite.locateTestSets( testsClassLoader );
+
+        return suite;
+    }
+
+    public static Object instantiateObject( String className, Object[] params, ClassLoader classLoader )
+        throws TestSetFailedException, ClassNotFoundException, NoSuchMethodException
+    {
+        Class clazz = classLoader.loadClass( className );
+
+        Object object;
+        try
+        {
+            if ( params != null )
+            {
+                Class[] paramTypes = new Class[params.length];
+
+                for ( int j = 0; j < params.length; j++ )
+                {
+                    if ( params[j] == null )
+                    {
+                        paramTypes[j] = String.class;
+                    }
+                    else
+                    {
+                        paramTypes[j] = params[j].getClass();
+                    }
+                }
+
+                Constructor constructor = clazz.getConstructor( paramTypes );
+
+                object = constructor.newInstance( params );
+            }
+            else
+            {
+                object = clazz.newInstance();
+            }
+        }
+        catch ( IllegalAccessException e )
+        {
+            throw new TestSetFailedException( "Unable to instantiate object: " + e.getMessage(), e );
+        }
+        catch ( InvocationTargetException e )
+        {
+            throw new TestSetFailedException( e.getTargetException().getMessage(), e.getTargetException() );
+        }
+        catch ( InstantiationException e )
+        {
+            throw new TestSetFailedException( "Unable to instantiate object: " + e.getMessage(), e );
+        }
+        return object;
+    }
+
+    private static SurefireTestSuite instantiateSuite( String suiteClass, Object[] params, ClassLoader classLoader )
+        throws TestSetFailedException
+    {
+        try
+        {
+            return (SurefireTestSuite) instantiateObject( suiteClass, params, classLoader );
+        }
+        catch ( ClassNotFoundException e )
+        {
+            throw new TestSetFailedException( "Unable to find class to create suite '" + suiteClass + "'", e );
+        }
+        catch ( NoSuchMethodException e )
+        {
+            throw new TestSetFailedException(
+                "Unable to find appropriate constructor to create suite: " + e.getMessage(), e );
+        }
+    }
+
+}
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/report/MulticastingReporter.java b/surefire-api/src/main/java/org/apache/maven/surefire/report/MulticastingReporter.java
index 5ea5ba64e..796921e57 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/report/MulticastingReporter.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/report/MulticastingReporter.java
@@ -120,6 +120,17 @@ public void testSkipped( ReportEntry report )
         }
     }
 
+    public void writeConsoleMessage( String message )
+    {
+        for ( Iterator it = target.iterator(); it.hasNext(); )
+        {
+            Reporter reporter = ( (Reporter) it.next() );
+            // Todo: Really need to find out how the surefire4.x provider manages to avoid printing to this one.
+            if (!(reporter instanceof BriefFileReporter)){
+               reporter.writeMessage( message);
+            }
+        }
+    }
 
     public void writeMessage( String message )
     {
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/report/Reporter.java b/surefire-api/src/main/java/org/apache/maven/surefire/report/Reporter.java
index b4261fff4..fcafcd779 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/report/Reporter.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/report/Reporter.java
@@ -43,21 +43,21 @@ void testSetCompleted( ReportEntry report )
     /**
      * Event fired when a test is about to start
      *
-     * @param report
+     * @param report The report entry to log for
      */
     void testStarting( ReportEntry report );
 
     /**
      * Event fired when a test ended successfully
      *
-     * @param report
+     * @param report The report entry to log for
      */
     void testSucceeded( ReportEntry report );
 
     /**
      * Event fired when a test ended with an error (non anticipated problem)
      *
-     * @param report
+     * @param report The report entry to log for
      * @param stdOut standard output from the test case
      * @param stdErr error output from the test case
      */
@@ -66,7 +66,7 @@ void testSetCompleted( ReportEntry report )
     /**
      * Event fired when a test ended with a failure (anticipated problem)
      *
-     * @param report
+     * @param report The report entry to log for
      * @param stdOut standard output from the test case
      * @param stdErr error output from the test case
      */
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/report/ReporterManager.java b/surefire-api/src/main/java/org/apache/maven/surefire/report/ReporterManager.java
index 99f4f18d0..772da07ec 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/report/ReporterManager.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/report/ReporterManager.java
@@ -52,22 +52,27 @@
  */
 public class ReporterManager
 {
-    private final RunStatistics runStatistics;
+    private final RunStatistics runStatisticsForThis;
 
     private final MulticastingReporter multicastingReporter;
 
     private final SystemStreamCapturer consoleCapturer = new SystemStreamCapturer();
 
-    public ReporterManager( List reports, RunStatistics runStatistics )
+    public ReporterManager( List reports, RunStatistics runStatisticsForThis )
     {
         multicastingReporter = new MulticastingReporter( reports );
-        this.runStatistics = runStatistics;
+        this.runStatisticsForThis = runStatisticsForThis;
     }
 
     public synchronized void writeMessage( String message )
     {
         multicastingReporter.writeMessage( message );
     }
+    
+    public synchronized void writeConsoleMessage( String message )
+    {
+        multicastingReporter.writeConsoleMessage( message );
+    }
 
     // ----------------------------------------------------------------------
     // Run
@@ -84,29 +89,30 @@ public synchronized void runCompleted()
         multicastingReporter.writeFooter( "" );
         multicastingReporter.writeFooter( "Results :" );
         multicastingReporter.writeFooter( "" );
-        if ( runStatistics.hadFailures() )
+        if ( runStatisticsForThis.hadFailures() )
         {
             multicastingReporter.writeFooter( "Failed tests: " );
-            for ( Iterator iterator = this.runStatistics.getFailureSources().iterator(); iterator.hasNext(); )
+            for ( Iterator iterator = this.runStatisticsForThis.getFailureSources().iterator(); iterator.hasNext(); )
             {
                 multicastingReporter.writeFooter( "  " + iterator.next() );
             }
             multicastingReporter.writeFooter( "" );
         }
-        if ( runStatistics.hadErrors() )
+        if ( runStatisticsForThis.hadErrors() )
         {
             writeFooter( "Tests in error: " );
-            for ( Iterator iterator = this.runStatistics.getErrorSources().iterator(); iterator.hasNext(); )
+            for ( Iterator iterator = this.runStatisticsForThis.getErrorSources().iterator(); iterator.hasNext(); )
             {
                 multicastingReporter.writeFooter( "  " + iterator.next() );
             }
             multicastingReporter.writeFooter( "" );
         }
-        multicastingReporter.writeFooter( runStatistics.getSummary() );
+        multicastingReporter.writeFooter( runStatisticsForThis.getSummary() );
         multicastingReporter.writeFooter( "" );
+        consoleCapturer.restoreStreams();
     }
 
-    private synchronized void writeFooter( String footer )
+    public synchronized void writeFooter( String footer )
     {
         multicastingReporter.writeFooter( footer );
     }
@@ -129,31 +135,43 @@ public synchronized void testSetCompleted( ReportEntry report )
 
     public synchronized void testStarting( ReportEntry report )
     {
-        consoleCapturer.startCapture();
         multicastingReporter.testStarting( report );
     }
 
     public synchronized void testSucceeded( ReportEntry report )
     {
-        consoleCapturer.resetStreams();
-        runStatistics.incrementCompletedCount();
+        consoleCapturer.clearCapturedContent();
+        runStatisticsForThis.incrementCompletedCount();
         multicastingReporter.testSucceeded( report );
     }
 
     public synchronized void testError( ReportEntry reportEntry )
     {
-        multicastingReporter.testError( reportEntry, consoleCapturer.getStdOutLog(), consoleCapturer.getStdErrLog() );
-        runStatistics.incrementErrorsCount();
-        runStatistics.addErrorSource( reportEntry.getName() );
-        consoleCapturer.resetStreams();
+        testError( reportEntry, consoleCapturer.getStdOutLog(), consoleCapturer.getStdErrLog() );
+    }
+
+    public synchronized void testError( ReportEntry reportEntry, String stdOutLog, String stdErrLog )
+    {
+        multicastingReporter.testError( reportEntry, stdOutLog, stdErrLog );
+        runStatisticsForThis.incrementErrorsCount();
+        runStatisticsForThis.incrementCompletedCount();
+        runStatisticsForThis.addErrorSource( reportEntry.getName() );
+        consoleCapturer.clearCapturedContent();
     }
 
     public synchronized void testFailed( ReportEntry reportEntry )
     {
-        multicastingReporter.testFailed( reportEntry, consoleCapturer.getStdOutLog(), consoleCapturer.getStdErrLog() );
-        runStatistics.incrementFailureCount();
-        runStatistics.addFailureSource( reportEntry.getName() );
-        consoleCapturer.resetStreams();
+        testFailed( reportEntry, consoleCapturer.getStdOutLog(), consoleCapturer.getStdErrLog() );
+    }
+
+
+    public synchronized void testFailed( ReportEntry reportEntry, String stdOutLog, String stdErrLog )
+    {
+        multicastingReporter.testFailed( reportEntry, stdOutLog, stdErrLog );
+        runStatisticsForThis.incrementFailureCount();
+        runStatisticsForThis.incrementCompletedCount();
+        runStatisticsForThis.addFailureSource( reportEntry.getName() );
+        consoleCapturer.clearCapturedContent();
     }
 
     // ----------------------------------------------------------------------
@@ -162,9 +180,9 @@ public synchronized void testFailed( ReportEntry reportEntry )
 
     public synchronized void testSkipped( ReportEntry report )
     {
-        consoleCapturer.resetStreams();
-
-        runStatistics.incrementSkippedCount();
+        consoleCapturer.clearCapturedContent();
+        runStatisticsForThis.incrementSkippedCount();
+        runStatisticsForThis.incrementCompletedCount();
         multicastingReporter.testSkipped( report );
     }
 
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/report/ReporterManagerFactory.java b/surefire-api/src/main/java/org/apache/maven/surefire/report/ReporterManagerFactory.java
index 9d7226597..1c8b91c13 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/report/ReporterManagerFactory.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/report/ReporterManagerFactory.java
@@ -69,6 +69,8 @@ public ReporterManager createReporterManager()
         throws TestSetFailedException
     {
         final List reports = instantiateReports( reportDefinitions, surefireClassLoader );
+        // Note, if we ever start making >1 reporter Managers, we have to aggregate run statistics
+        // i.e. we cannot use a single "globalRunStatistics"
         final ReporterManager reporterManager = new ReporterManager( reports, globalRunStatistics );
         if ( first == null )
         {
@@ -181,6 +183,4 @@ private static Object instantiateObject( String className, Object[] params, Clas
         }
         return object;
     }
-
-
 }
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/report/SystemStreamCapturer.java b/surefire-api/src/main/java/org/apache/maven/surefire/report/SystemStreamCapturer.java
index d62199e8f..da4b588c7 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/report/SystemStreamCapturer.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/report/SystemStreamCapturer.java
@@ -27,31 +27,31 @@
 
 /**
  * Captures System.out/System.err streams to buffers.
- *
+ * <p/>
  * Please note that this design is inherently single-threaded test-linear, and is intended only
  * for use with ReporterManager, which is also test-linear. While it will capture
  * output in a multi-threaded scenario, there's no way to associate ouput with the correct
  * test/thread.
- *
+ * <p/>
  * Note; this class does not need synchronization because all of these methods are serially invoked on
  * the same thread. Or maybe not. See notes inside ReporterManager about the general improperness
  * of this design in multithreading.
  */
 public class SystemStreamCapturer
 {
-    private PrintStream oldOut;
+    private final PrintStream oldOut;
 
-    private PrintStream oldErr;
+    private final PrintStream oldErr;
 
-    private PrintStream newErr;
+    private final PrintStream newErr;
 
-    private PrintStream newOut;
+    private final PrintStream newOut;
 
-    private ByteArrayOutputStream stdOut;
+    private final ByteArrayOutputStream stdOut;
 
-    private ByteArrayOutputStream stdErr;
+    private final ByteArrayOutputStream stdErr;
 
-    public void startCapture()
+    public SystemStreamCapturer()
     {
         stdOut = new ByteArrayOutputStream();
 
@@ -72,7 +72,8 @@ public void startCapture()
         System.setErr( tee );
     }
 
-    public void resetStreams()
+
+    public void restoreStreams()
     {
         // Note that the fields can be null if the test hasn't even started yet (an early error)
         if ( oldOut != null )
@@ -88,6 +89,18 @@ public void resetStreams()
         IOUtil.close( newErr );
     }
 
+    public void clearCapturedContent()
+    {
+        if ( stdOut != null )
+        {
+            stdOut.reset();
+        }
+        if ( stdErr != null )
+        {
+            stdErr.reset();
+        }
+    }
+
     public String getStdOutLog()
     {
         // Note that the fields can be null if the test hasn't even started yet (an early error)
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/report/TestSetStatistics.java b/surefire-api/src/main/java/org/apache/maven/surefire/report/TestSetStatistics.java
index d223e8301..4cc992496 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/report/TestSetStatistics.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/report/TestSetStatistics.java
@@ -22,7 +22,7 @@
 import java.util.Properties;
 
 /**
- * Run-statistcis for a testset
+ * Run-statistics for a testset
  *
  * @author Kristian Rosenvold
  *         Note; synchronization is questionable. Whiled this class alone is ok, there's a higher level concern about
@@ -87,6 +87,11 @@ public synchronized int getCompletedCount()
         return completedCount;
     }
 
+    public int getSkipped()
+    {
+        return skipped;
+    }
+
     public synchronized void initResultsFromProperties( Properties results )
     {
         errors = Integer.valueOf( results.getProperty( RESULTS_ERRORS, "0" ) ).intValue();
diff --git a/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/Surefire613TestCountInParallelIT.java b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/Surefire613TestCountInParallelIT.java
index 3ca1e3d00..96125255d 100644
--- a/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/Surefire613TestCountInParallelIT.java
+++ b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/Surefire613TestCountInParallelIT.java
@@ -45,6 +45,11 @@ public void testPaallelBuildResultCount()
         this.executeGoal( verifier, "test" );
         verifier.resetStreams();
 
-        HelperAssertions.assertTestSuiteResults( 7, 1, 2, 1, testDir );
+        verifier.verifyTextInLog("testAllok to stdout");
+        verifier.verifyTextInLog("testAllok to stderr");
+        verifier.verifyTextInLog("testWithException1 to stdout");
+        verifier.verifyTextInLog("testWithException1 to stderr");
+
+        HelperAssertions.assertTestSuiteResults( 15, 8, 4, 2, testDir );
     }
 }
\ No newline at end of file
diff --git a/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/Surefire621TestCountingJunit3InParallelIT.java b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/Surefire621TestCountingJunit3InParallelIT.java
new file mode 100644
index 000000000..c7fd33764
--- /dev/null
+++ b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/Surefire621TestCountingJunit3InParallelIT.java
@@ -0,0 +1,50 @@
+package org.apache.maven.surefire.its;
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+
+import org.apache.maven.it.Verifier;
+import org.apache.maven.it.util.ResourceExtractor;
+
+import java.io.File;
+import java.util.ArrayList;
+import java.util.Arrays;
+
+/**
+ * SUREFIRE-621 Asserts proper test counts when running junit 3 tests in parallel
+ *
+ * @author Kristian Rosenvold
+ */
+public class Surefire621TestCountingJunit3InParallelIT
+    extends AbstractSurefireIntegrationTestClass
+{
+    public void testJunit3ParallelBuildResultCount()
+        throws Exception
+    {
+        File testDir = ResourceExtractor.simpleExtractResources( getClass(), "/surefire-621-testCounting-junit3-in-parallel" );
+
+        Verifier verifier = new Verifier( testDir.getAbsolutePath() );
+        String[] opts = { "-fn" };
+        verifier.setCliOptions( new ArrayList( Arrays.asList( opts ) ) );
+        this.executeGoal( verifier, "install" );
+        verifier.resetStreams();
+
+        HelperAssertions.assertTestSuiteResults( 6, 0, 0, 0, testDir );
+    }
+}
\ No newline at end of file
diff --git a/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/pom.xml b/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/pom.xml
index b5592dd9e..5791d4771 100644
--- a/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/pom.xml
+++ b/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/pom.xml
@@ -29,6 +29,7 @@
            <artifactId>maven-surefire-plugin</artifactId>
            <version>${surefire.version}</version>
            <configuration>
+             <forkMode>once</forkMode>
              <parallel>methods</parallel>
              <threadCount>10</threadCount>
              <includes>
diff --git a/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/src/test/java/surefire163/Test1.java b/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/src/test/java/surefire163/Test1.java
index 2a446280b..88286c7f9 100644
--- a/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/src/test/java/surefire163/Test1.java
+++ b/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/src/test/java/surefire163/Test1.java
@@ -4,29 +4,68 @@
 
 import static org.junit.Assert.assertTrue;
 import static org.junit.Assert.fail;
-
+import static org.hamcrest.CoreMatchers.*;
+import static org.junit.Assume.*;
 public class Test1
 {
     @Test
-    public void test2_1()
-        throws InterruptedException
-    {
-        Thread.currentThread().sleep( 1200 );
+    public void testWithFailingAssumption1() {
+        assumeThat( 2, is(3));
     }
-
     @Test
-    public void test2_2()
-        throws InterruptedException
-    {
-        Thread.currentThread().sleep( 1200 );
-        assertTrue(false);
-        fail( "We expect failure" );
+    public void testWithFailingAssumption2() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption3() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption4() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption5() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption6() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption7() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption8() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption9() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption10() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption11() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption12() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption13() {
+        assumeThat( 2, is(3));
+    }
+    @Test
+    public void testWithFailingAssumption14() {
+        assumeThat( 2, is(3));
     }
-
     @Test
-    public void test2_3()
-        throws InterruptedException
-    {
-        Thread.currentThread().sleep( 1200 );
+    public void testWithFailingAssumption15() {
+        assumeThat( 2, is(3));
     }
 }
\ No newline at end of file
diff --git a/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/src/test/java/surefire163/Test2.java b/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/src/test/java/surefire163/Test2.java
index d5d83bbdc..731bd6497 100644
--- a/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/src/test/java/surefire163/Test2.java
+++ b/surefire-integration-tests/src/test/resources/surefire-613-testCount-in-parallel/src/test/java/surefire163/Test2.java
@@ -12,25 +12,73 @@
  */
 public class Test2
 {
+    @Test
+    public void testAllok(){
+        System.out.println("testAllok to stdout");
+        System.err.println("testAllok to stderr");
+    }
+
+
+    @Ignore
+    @Test
+    public void testWithIgnore1(){
+    }
+
     @Ignore
     @Test
-    public void testWithIgnore(){
+    public void testWithIgnore2(){
     }
 
     @Test
-    public void testiWithFail(){
+    public void testiWithFail1(){
+        fail("We excpect this");
+    }
+    @Test
+    public void testiWithFail2(){
+        fail("We excpect this");
+    }
+    @Test
+    public void testiWithFail3(){
+        fail("We excpect this");
+    }
+    @Test
+    public void testiWithFail4(){
         fail("We excpect this");
-
     }
 
     @Test
-    public void testWithException() {
+    public void testWithException1() {
+        System.out.println("testWithException1 to stdout");
+        System.err.println("testWithException1 to stderr");
         throw new RuntimeException("We expect this");
     }
-
     @Test
-    public void testWithFailingAssumption() {
-        assumeThat( 2, is(3));
+    public void testWithException2() {
+        throw new RuntimeException("We expect this");
+    }
+    @Test
+    public void testWithException3() {
+        throw new RuntimeException("We expect this");
+    }
+    @Test
+    public void testWithException4() {
+        throw new RuntimeException("We expect this");
+    }
+    @Test
+    public void testWithException5() {
+        throw new RuntimeException("We expect this");
+    }
+    @Test
+    public void testWithException6() {
+        throw new RuntimeException("We expect this");
+    }
+    @Test
+    public void testWithException7() {
+        throw new RuntimeException("We expect this");
+    }
+    @Test
+    public void testWithException8() {
+        throw new RuntimeException("We expect this");
     }
 
 }
\ No newline at end of file
diff --git a/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/pom.xml b/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/pom.xml
new file mode 100755
index 000000000..58544680c
--- /dev/null
+++ b/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/pom.xml
@@ -0,0 +1,66 @@
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+    <modelVersion>4.0.0</modelVersion>
+    <groupId>mho</groupId>
+    <artifactId>surefire-test</artifactId>
+    <packaging>jar</packaging>
+    <version>1.0-SNAPSHOT</version>
+    <name>junit-test</name>
+    <url>http://maven.apache.org</url>
+    <properties>
+      <junit.version>4.8.1</junit.version>
+    </properties>
+    <dependencies>
+        <dependency>
+            <groupId>junit</groupId>
+            <artifactId>junit</artifactId>
+            <version>${junit.version}</version>
+        </dependency>
+    </dependencies>
+
+    <build>
+        <testSourceDirectory>src/it/java</testSourceDirectory>
+        <plugins>
+            <plugin>
+                <groupId>org.apache.maven.plugins</groupId>
+                <artifactId>maven-compiler-plugin</artifactId>
+                <configuration>
+                    <source>1.5</source>
+                    <target>1.5</target>
+                </configuration>
+            </plugin>
+            <plugin>
+                <groupId>org.apache.maven.plugins</groupId>
+                <artifactId>maven-surefire-plugin</artifactId>
+                <version>${surefire.version}</version>
+                <configuration>
+                    <skip>true</skip>
+                    <parallel>classes</parallel>
+                    <threadCount>10</threadCount>
+                </configuration>
+                <executions>
+                    <execution>
+                        <id>surefire-it</id>
+                        <phase>integration-test</phase>
+                        <goals>
+                            <goal>test</goal>
+                        </goals>
+                        <configuration>
+                            <skip>false</skip>
+
+                            <testFailureIgnore>true</testFailureIgnore>
+                            <includes>
+                                <include>**/MySuiteTest1.java</include>
+                                <include>**/MySuiteTest2.java</include>
+                                <include>**/MySuiteTest3.java</include>
+                            </includes>
+                            <excludes>
+                            </excludes>
+                            <forkMode>once</forkMode>
+                        </configuration>
+                    </execution>
+                </executions>
+            </plugin>
+        </plugins>
+    </build>
+</project>
diff --git a/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/src/it/java/mho/MySuiteTest1.java b/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/src/it/java/mho/MySuiteTest1.java
new file mode 100755
index 000000000..c7247dba0
--- /dev/null
+++ b/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/src/it/java/mho/MySuiteTest1.java
@@ -0,0 +1,35 @@
+package mho;
+
+import junit.framework.Test;
+import junit.framework.TestCase;
+import junit.framework.TestSuite;
+
+/**
+ * Created by IntelliJ IDEA.
+ * User: yyit927b
+ * Date: 26.05.2010
+ * Time: 11:02:06
+ * To change this template use File | Settings | File Templates.
+ */
+public class MySuiteTest1 extends TestCase {
+
+    public static Test suite () {
+        TestSuite suite = new TestSuite();
+
+        suite.addTest (new MySuiteTest1("testMe", 1));
+
+        return suite;
+    }
+
+    private int number;
+
+    public MySuiteTest1(String name, int number) {
+        super (name);
+        this.number = number;
+    }
+
+    public void testMe() {
+        System.out.println ("### "+ this.getClass().getName()+":"+this.getName()+" - number "+number);
+        assertTrue (true);
+    }
+}
diff --git a/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/src/it/java/mho/MySuiteTest2.java b/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/src/it/java/mho/MySuiteTest2.java
new file mode 100755
index 000000000..a33076ad6
--- /dev/null
+++ b/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/src/it/java/mho/MySuiteTest2.java
@@ -0,0 +1,36 @@
+package mho;
+
+import junit.framework.Test;
+import junit.framework.TestCase;
+import junit.framework.TestSuite;
+
+/**
+ * Created by IntelliJ IDEA.
+ * User: yyit927b
+ * Date: 26.05.2010
+ * Time: 11:02:06
+ * To change this template use File | Settings | File Templates.
+ */
+public class MySuiteTest2 extends TestCase {
+
+    public static Test suite () {
+        TestSuite suite = new TestSuite();
+
+        suite.addTest (new MySuiteTest2("testMe", 1));
+        suite.addTest (new MySuiteTest2("testMe", 2));
+
+        return suite;
+    }
+
+    private int number;
+
+    public MySuiteTest2(String name, int number) {
+        super (name);
+        this.number = number;
+    }
+
+    public void testMe() {
+        System.out.println ("### "+ this.getClass().getName()+":"+this.getName()+" - number "+number);
+        assertTrue (true);
+    }
+}
diff --git a/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/src/it/java/mho/MySuiteTest3.java b/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/src/it/java/mho/MySuiteTest3.java
new file mode 100755
index 000000000..671fcfe78
--- /dev/null
+++ b/surefire-integration-tests/src/test/resources/surefire-621-testCounting-junit3-in-parallel/src/it/java/mho/MySuiteTest3.java
@@ -0,0 +1,37 @@
+package mho;
+
+import junit.framework.Test;
+import junit.framework.TestCase;
+import junit.framework.TestSuite;
+
+/**
+ * Created by IntelliJ IDEA.
+ * User: yyit927b
+ * Date: 26.05.2010
+ * Time: 11:27:42
+ * To change this template use File | Settings | File Templates.
+ */
+public class MySuiteTest3 extends TestCase {
+
+    public static Test suite () {
+        TestSuite suite = new TestSuite();
+
+        suite.addTest (new MySuiteTest3("testMe", 1));
+        suite.addTest (new MySuiteTest3("testMe", 2));
+        suite.addTest (new MySuiteTest3("testMe", 3));
+
+        return suite;
+    }
+
+    private int number;
+
+    public MySuiteTest3(String name, int number) {
+        super (name);
+        this.number = number;
+    }
+
+    public void testMe() {
+        System.out.println ("### "+ this.getClass().getName()+":"+this.getName()+" - number "+number);
+        assertTrue (true);
+    }
+}
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ConcurrentPrintStream.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ConcurrentPrintStream.java
new file mode 100644
index 000000000..792567a45
--- /dev/null
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ConcurrentPrintStream.java
@@ -0,0 +1,60 @@
+package org.apache.maven.surefire.junitcore;
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import java.io.ByteArrayOutputStream;
+import java.io.PrintStream;
+
+class ConcurrentPrintStream
+    extends PrintStream
+{
+    private final boolean isStdout;
+
+    ConcurrentPrintStream( boolean stdout )
+    {
+        super( new ByteArrayOutputStream() );
+        isStdout = stdout;
+    }
+
+
+    public void write( byte[] buf, int off, int len )
+    {
+
+        final TestMethod threadTestMethod = TestMethod.getThreadTestMethod();
+        if ( threadTestMethod != null )
+        {
+            threadTestMethod.getLogicalStream().write( isStdout, buf, off, len );
+        }
+        else
+        {
+           ( (ByteArrayOutputStream) out ).write( buf, off, len );
+        }
+    }
+
+    public void close()
+    {
+
+    }
+
+    public void flush()
+    {
+    }
+
+
+}
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ConcurrentReportingRunListener.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ConcurrentReportingRunListener.java
new file mode 100644
index 000000000..b6969bdcc
--- /dev/null
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ConcurrentReportingRunListener.java
@@ -0,0 +1,198 @@
+package org.apache.maven.surefire.junitcore;
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import org.apache.maven.surefire.report.ReporterManager;
+import org.apache.maven.surefire.report.ReporterManagerFactory;
+import org.apache.maven.surefire.testset.TestSetFailedException;
+import org.junit.runner.Description;
+import org.junit.runner.Result;
+import org.junit.runner.notification.Failure;
+import org.junit.runner.notification.RunListener;
+
+import java.io.PrintStream;
+import java.util.Map;
+import java.util.concurrent.ConcurrentHashMap;
+
+/**
+ * @author Kristian Rosenvold
+ */
+public abstract class ConcurrentReportingRunListener
+    extends RunListener
+{
+    private final PrintStream orgSystemOut = System.out;
+
+    private final PrintStream orgSystemErr = System.err;
+
+    protected Map<Class, TestSet> classMethodCounts = new ConcurrentHashMap<Class, TestSet>();
+
+    protected final ReporterManager reporterManager;
+
+    protected final boolean reportImmediately;
+
+    public ConcurrentReportingRunListener( ReporterManagerFactory reporterFactory, boolean reportImmediately )
+        throws TestSetFailedException
+    {
+        this.reportImmediately = reportImmediately;
+        reporterManager = reporterFactory.createReporterManager();
+        // Important: We mustcapture System.out/System.err AFTER the  reportManager captures stdout/stderr
+        // because we know how to demultiplex correctly. The redirection in reporterManager is basically
+        // ignored/unused because we use ConcurrentPrintStream.
+        System.setOut( new ConcurrentPrintStream( true ) );
+        System.setErr( new ConcurrentPrintStream( false ) );
+    }
+
+    @Override
+    public void testRunStarted( Description description )
+        throws Exception
+    {
+        TestMethod.fillTestCountMap( description, classMethodCounts );
+    }
+
+    @Override
+    public void testRunFinished( Result result )
+        throws Exception
+    {
+        for ( TestSet testSet : classMethodCounts.values() )
+        {
+            testSet.replay( reporterManager );
+        }
+        System.setOut( orgSystemOut );
+        System.setErr( orgSystemErr );
+    }
+
+    protected TestMethod getTestMethod()
+    {
+        return TestMethod.getThreadTestMethod();
+    }
+
+    protected void detachTestMethodFromThread()
+    {
+        TestMethod.detachFromCurrentThread();
+    }
+
+    protected TestSet getTestSet( Description description )
+    {
+        return classMethodCounts.get( description.getTestClass() );
+    }
+
+    @Override
+    public void testFailure( Failure failure )
+        throws Exception
+    {
+        TestMethod.getThreadTestMethod().testFailure( failure );
+    }
+
+    @Override
+    public void testAssumptionFailure( Failure failure )
+    {
+        TestMethod.getThreadTestMethod().testAssumptionFailure( failure );
+    }
+
+    @Override
+    public void testIgnored( Description description )
+        throws Exception
+    {
+        TestSet testSet = getTestSet( description );
+        testSet.createTestMethod( description ).testIgnored( description );
+        testSet.incrementFinishedTests( reporterManager, reportImmediately );
+    }
+
+    @Override
+    public void testStarted( Description description )
+        throws Exception
+    {
+        TestSet testSet = getTestSet( description );
+        testSet.createTestMethod( description ).attachToThread();
+        checkIfTestSetCanBeReported( testSet );
+        testSet.attachToThread();
+    }
+
+    public abstract void checkIfTestSetCanBeReported( TestSet testSetForTest );
+
+    @Override
+    public void testFinished( Description description )
+        throws Exception
+    {
+        getTestMethod().testFinished();
+        TestSet.getThreadTestSet().incrementFinishedTests( reporterManager, reportImmediately );
+        detachTestMethodFromThread();
+    }
+
+    public static ConcurrentReportingRunListener createInstance( ReporterManagerFactory reporterManagerFactory,
+                                                                 boolean parallelClasses, boolean parallelBoth )
+        throws TestSetFailedException
+    {
+        if ( parallelClasses )
+        {
+            return new ClassesParallelRunListener( reporterManagerFactory );
+        }
+        return new MethodsParallelRunListener( reporterManagerFactory, !parallelBoth );
+    }
+
+    public static class ClassesParallelRunListener
+        extends ConcurrentReportingRunListener
+    {
+        public ClassesParallelRunListener( ReporterManagerFactory reporterFactory )
+            throws TestSetFailedException
+        {
+            super( reporterFactory, false );
+        }
+
+        @Override
+        public void checkIfTestSetCanBeReported( TestSet testSetForTest )
+        {
+            TestSet currentlyAttached = TestSet.getThreadTestSet();
+            if ( currentlyAttached != null && currentlyAttached != testSetForTest )
+            {
+                currentlyAttached.setAllScheduled( reporterManager );
+            }
+        }
+    }
+
+    public static class MethodsParallelRunListener
+        extends ConcurrentReportingRunListener
+    {
+        private volatile TestSet lastStarted;
+
+        private final Object lock = new Object();
+
+        public MethodsParallelRunListener( ReporterManagerFactory reporterFactory, boolean reportImmediately )
+            throws TestSetFailedException
+        {
+            super( reporterFactory, reportImmediately );
+        }
+
+        @Override
+        public void checkIfTestSetCanBeReported( TestSet testSetForTest )
+        {
+            synchronized ( lock )
+            {
+                if ( testSetForTest != lastStarted )
+                {
+                    if ( lastStarted != null )
+                    {
+                        lastStarted.setAllScheduled( reporterManager );
+                    }
+                    lastStarted = testSetForTest;
+                }
+            }
+        }
+    }
+}
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/DemultiplexingRunListener.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/DemultiplexingRunListener.java
deleted file mode 100644
index ded02bc3a..000000000
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/DemultiplexingRunListener.java
+++ /dev/null
@@ -1,271 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing,
- * software distributed under the License is distributed on an
- * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
- * KIND, either express or implied.  See the License for the
- * specific language governing permissions and limitations
- * under the License.
- */
-
-package org.apache.maven.surefire.junitcore;
-
-import org.junit.runner.Description;
-import org.junit.runner.Result;
-import org.junit.runner.notification.Failure;
-import org.junit.runner.notification.RunListener;
-
-import java.util.ArrayList;
-import java.util.Collections;
-import java.util.HashMap;
-import java.util.List;
-import java.util.Map;
-import java.util.concurrent.atomic.AtomicInteger;
-
-/**
- * Demultiplexes threaded running of tests into something that does not look threaded.
- * Essentially makes a threaded junit core RunListener behave like something like a
- * junit4 reporter can handle.
- * <p/>
- * This version is non-ketchup mode, outputting test results as the individual suites complete.
- *
- * @author Kristian Rosenvold
- */
-public class DemultiplexingRunListener
-    extends RunListener
-{
-    private final RunListener realtarget;
-
-    private volatile Map<String, TestMethod> testMethods;
-
-    public DemultiplexingRunListener( RunListener realtarget )
-    {
-        this.realtarget = realtarget;
-    }
-
-    @Override
-    public void testRunStarted( Description description )
-        throws Exception
-    {
-        testMethods = createTestMethodMap( description );
-    }
-
-    @Override
-    public void testFinished( Description description )
-        throws Exception
-    {
-        final TestMethod testDescription = getTestDescription( description );
-        testDescription.testFinished( description );
-        testDescription.getParent().setDone( realtarget );
-    }
-
-    @Override
-    public void testIgnored( Description description )
-        throws Exception
-    {
-        final TestMethod testDescription = getTestDescription( description );
-        testDescription.testIgnored( description );
-        testDescription.getParent().setDone( realtarget );
-    }
-
-    @Override
-    public void testFailure( Failure failure )
-        throws Exception
-    {
-        getTestDescription( failure.getDescription() ).testFailure( failure );
-    }
-
-    @Override
-    public void testAssumptionFailure( Failure failure )
-    {
-        final TestMethod testDescription = getTestDescription( failure.getDescription() );
-        testDescription.testAssumptionFailure( failure );
-    }
-
-
-    private TestMethod getTestDescription( Description description )
-    {
-        final TestMethod result = testMethods.get( description.getDisplayName() );
-        if ( result == null )
-        {
-            throw new IllegalStateException( "No TestDescription found for " + description +
-                ", inconsistent junit behaviour. Unknown junit version?" );
-        }
-        return result;
-    }
-
-
-    static Map<String, TestMethod> createTestMethodMap( Description description )
-    {
-        Map<String, TestMethod> result = new HashMap<String, TestMethod>();
-        createTestDescription( description, result );
-        return result;
-    }
-
-    private static void createTestDescription( Description description, Map<String, TestMethod> result )
-    {
-        final ArrayList<Description> children = description.getChildren();
-
-        TestDescription current = new TestDescription( description );
-
-        for ( Description item : children )
-        {
-            if ( item.isTest() )
-            {
-                TestMethod testMethod = new TestMethod( item, current );
-                if ( item.getDisplayName() != null )
-                {
-                    result.put( item.getDisplayName(), testMethod );
-                }
-                current.addTestMethod( testMethod );
-            }
-            else
-            {
-                createTestDescription( item, result );
-            }
-        }
-    }
-
-    public static class TestDescription
-    {
-        private final Result resultForThisClass = new Result();
-
-        private final Description testRunStarted;
-
-
-        private AtomicInteger numberOfCompletedChildren = new AtomicInteger( 0 );
-
-        private final List<TestMethod> testMethods = Collections.synchronizedList( new ArrayList<TestMethod>() );
-
-        public TestDescription( Description description )
-        {
-            testRunStarted = description;
-        }
-
-        private void addTestMethod( TestMethod testMethod )
-        {
-            testMethods.add( testMethod );
-        }
-
-        private boolean incrementCompletedChildrenCount()
-        {
-            return testMethods.size() == numberOfCompletedChildren.incrementAndGet();
-        }
-
-        boolean setDone( RunListener target )
-        {
-            final boolean result = incrementCompletedChildrenCount();
-            if ( result )
-            {
-                notifyListener( target );
-                notifyListener( resultForThisClass.createListener() );
-            }
-            return result;
-        }
-
-        @SuppressWarnings( { "SynchronizationOnLocalVariableOrMethodParameter" } )
-        private void notifyListener( final RunListener target )
-        {
-            try
-            {
-                synchronized ( target )
-                {
-                    target.testRunStarted( testRunStarted );
-                    for ( TestMethod testMethod : testMethods )
-                    {
-                        testMethod.replay( target );
-                    }
-                    target.testRunFinished( resultForThisClass );
-                }
-            }
-            catch ( Exception e )
-            {
-                throw new RuntimeException( e );
-            }
-        }
-    }
-
-    static class TestMethod
-    {
-        private final Description description;
-
-        private final TestDescription parent;
-
-        private volatile Failure testFailure;
-
-        private volatile Failure testAssumptionFailure;
-
-        private volatile Description finished;
-
-        private volatile Description ignored;
-
-
-        public TestMethod( Description description, TestDescription current )
-        {
-            this.description = description;
-            this.parent = current;
-        }
-
-
-        public void testFinished( Description description )
-            throws Exception
-        {
-            this.finished = description;
-        }
-
-
-        public void testIgnored( Description description )
-            throws Exception
-        {
-            ignored = description;
-        }
-
-        public void testFailure( Failure failure )
-            throws Exception
-        {
-            this.testFailure = failure;
-        }
-
-        public void testAssumptionFailure( Failure failure )
-        {
-            this.testAssumptionFailure = failure;
-        }
-
-        public void replay( RunListener runListener )
-            throws Exception
-        {
-            if ( ignored != null )
-            {
-                runListener.testIgnored( ignored );
-            }
-            else
-            {
-                runListener.testStarted( description );
-                if ( testFailure != null )
-                {
-                    runListener.testFailure( testFailure );
-                }
-                if ( testAssumptionFailure != null )
-                {
-                    runListener.testAssumptionFailure( testAssumptionFailure );
-                }
-                runListener.testFinished( finished );
-            }
-        }
-
-        public TestDescription getParent()
-        {
-            return parent;
-        }
-    }
-
-}
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreDirectoryTestSuite.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreDirectoryTestSuite.java
index b1112272a..23d187c73 100644
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreDirectoryTestSuite.java
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreDirectoryTestSuite.java
@@ -20,7 +20,6 @@
 package org.apache.maven.surefire.junitcore;
 
 import org.apache.maven.surefire.report.ReporterException;
-import org.apache.maven.surefire.report.ReporterManager;
 import org.apache.maven.surefire.report.ReporterManagerFactory;
 import org.apache.maven.surefire.suite.SurefireTestSuite;
 import org.apache.maven.surefire.testset.TestSetFailedException;
@@ -37,6 +36,7 @@
  * @author Karl M. Davis
  * @author Kristian Rosenvold (junit core adaption)
  */
+@SuppressWarnings( { "UnusedDeclaration" } )
 public class JUnitCoreDirectoryTestSuite
     implements SurefireTestSuite
 {
@@ -64,8 +64,7 @@ public void execute( ReporterManagerFactory reporterManagerFactory, ClassLoader
             throw new IllegalStateException( "You must call locateTestSets before calling execute" );
         }
 
-        final ReporterManager reporterManager = reporterManagerFactory.createReporterManager();
-        JUnitCoreTestSet.execute( testsToRun.getLocatedClasses(), reporterManager, jUnitCoreParameters );
+        JUnitCoreTestSet.execute( testsToRun.getLocatedClasses(), reporterManagerFactory, jUnitCoreParameters );
     }
 
     public void execute( String testSetName, ReporterManagerFactory reporterManagerFactory, ClassLoader classLoader )
@@ -82,7 +81,7 @@ public void execute( String testSetName, ReporterManagerFactory reporterManagerF
         {
             throw new TestSetFailedException( "Unable to find test set '" + testSetName + "' in suite" );
         }
-        testSet.execute( reporterManagerFactory.createReporterManager(), jUnitCoreParameters );
+        testSet.execute( reporterManagerFactory, jUnitCoreParameters );
     }
 
     public Map locateTestSets( ClassLoader classLoader )
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreTestSet.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreTestSet.java
index 595125766..0ee8631ab 100644
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreTestSet.java
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreTestSet.java
@@ -19,7 +19,7 @@
 package org.apache.maven.surefire.junitcore;
 
 
-import org.apache.maven.surefire.report.ReporterManager;
+import org.apache.maven.surefire.report.ReporterManagerFactory;
 import org.apache.maven.surefire.testset.TestSetFailedException;
 import org.junit.experimental.ParallelComputer;
 import org.junit.runner.Computer;
@@ -45,8 +45,6 @@ class JUnitCoreTestSet
 
     private static final String className = "org.jdogma.junit.ConfigurableParallelComputer";
 
-    private static final String demuxerClassName = "org.jdogma.junit.DemultiplexingRunListener";
-
     public String getName()
     {
         return testClass.getName();
@@ -70,12 +68,12 @@ protected JUnitCoreTestSet( Class testClasses )
     /**
      * Actually runs the test and adds the tests results to the <code>reportManager</code>.
      *
-     * @param JUnitCoreParameters The parameters for this test
      * @param reportManager       The report manager
+     * @param JUnitCoreParameters The parameters for this test
      * @throws TestSetFailedException If something fails
      * @see org.apache.maven.surefire.testset.SurefireTestSet#execute(org.apache.maven.surefire.report.ReporterManager,java.lang.ClassLoader)
      */
-    public void execute( ReporterManager reportManager, JUnitCoreParameters JUnitCoreParameters )
+    public void execute( ReporterManagerFactory reportManager, JUnitCoreParameters JUnitCoreParameters )
         throws TestSetFailedException
     {
 
@@ -84,13 +82,13 @@ public void execute( ReporterManager reportManager, JUnitCoreParameters JUnitCor
         execute( classes, reportManager, JUnitCoreParameters );
     }
 
-    public static void execute( Class[] classes, ReporterManager reportManager,
+    public static void execute( Class[] classes, ReporterManagerFactory reporterManagerFactory,
                                 JUnitCoreParameters jUnitCoreParameters )
         throws TestSetFailedException
     {
-        RunListener realTarget = new JUnitCoreTestSetReporter( reportManager );
-        RunListener listener =
-            createRunListener( realTarget, jUnitCoreParameters.isConfigurableParallelComputerPresent() );
+        final ConcurrentReportingRunListener listener =
+            ConcurrentReportingRunListener.createInstance( reporterManagerFactory, jUnitCoreParameters.isParallelClasses(),
+                                                      jUnitCoreParameters.isParallelBoth() );
         Computer computer = getComputer( jUnitCoreParameters );
         try
         {
@@ -99,42 +97,6 @@ public static void execute( Class[] classes, ReporterManager reportManager,
         finally
         {
             closeIfConfigurable( computer );
-            reportManager.reset();
-        }
-    }
-
-    private static RunListener createRunListener( RunListener realTarget, boolean configurableParallelComputerPresent )
-        throws TestSetFailedException
-    {
-        if ( !configurableParallelComputerPresent )
-        {
-            return new DemultiplexingRunListener( realTarget );
-        }
-        try
-        {
-            Class<?> cpcClass = Class.forName( demuxerClassName );
-            Constructor constructor = cpcClass.getConstructor( RunListener.class );
-            return (RunListener) constructor.newInstance( realTarget );
-        }
-        catch ( ClassNotFoundException e )
-        {
-            throw new TestSetFailedException( e );
-        }
-        catch ( NoSuchMethodException e )
-        {
-            throw new TestSetFailedException( e );
-        }
-        catch ( InvocationTargetException e )
-        {
-            throw new TestSetFailedException( e );
-        }
-        catch ( IllegalAccessException e )
-        {
-            throw new TestSetFailedException( e );
-        }
-        catch ( InstantiationException e )
-        {
-            throw new TestSetFailedException( e );
         }
     }
 
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreTestSetReporter.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreTestSetReporter.java
deleted file mode 100644
index 3036fea6b..000000000
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreTestSetReporter.java
+++ /dev/null
@@ -1,186 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing,
- * software distributed under the License is distributed on an
- * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
- * KIND, either express or implied.  See the License for the
- * specific language governing permissions and limitations
- * under the License.
- */
-package org.apache.maven.surefire.junitcore;
-
-
-import org.apache.maven.surefire.Surefire;
-import org.apache.maven.surefire.report.ReportEntry;
-import org.apache.maven.surefire.report.ReporterManager;
-import org.junit.runner.Description;
-import org.junit.runner.Result;
-import org.junit.runner.notification.Failure;
-import org.junit.runner.notification.RunListener;
-
-import java.util.ResourceBundle;
-import java.util.regex.Matcher;
-import java.util.regex.Pattern;
-
-class JUnitCoreTestSetReporter
-    extends RunListener
-{
-
-    private static final Pattern PARENS = Pattern.compile( "^" + "[^\\(\\)]+" + //non-parens
-        "\\((" + // then an open-paren (start matching a group)
-        "[^\\\\(\\\\)]+" + //non-parens
-        ")\\)" + "$" ); // then a close-paren (end group match)
-
-    // Constants
-
-    private static ResourceBundle bundle = ResourceBundle.getBundle( Surefire.SUREFIRE_BUNDLE_NAME );
-
-
-    private Description currentRunStart;
-
-    private String currentClassName;
-
-    private ReporterManager reportMgr;
-
-    /**
-     * This flag is set after a failure has occurred so that a <code>testSucceeded</code> event is not fired.  This is necessary because JUnit4 always fires a <code>testRunFinished</code> event-- even if there was a failure.
-     */
-    private boolean failureFlag;
-
-    /**
-     * Constructor.
-     *
-     * @param reportManager the report manager to log testing events to
-     */
-    JUnitCoreTestSetReporter( ReporterManager reportManager )
-    {
-        this.reportMgr = reportManager;
-    }
-
-    /**
-     * Called right before any tests from a specific class are run.
-     *
-     * @see org.junit.runner.notification.RunListener#testRunStarted(org.junit.runner.Description)
-     */
-    public void testRunStarted( Description description )
-        throws Exception
-    {
-        String rawString = bundle.getString( "testSetStarting" );
-        currentClassName = extractClassName( description );
-        currentRunStart = description;
-
-        ReportEntry report = new ReportEntry( description.getClassName(), currentClassName, rawString );
-        this.reportMgr.testSetStarting( report );
-    }
-
-    /**
-     * Called right after all tests from a specific class are run.
-     *
-     * @see org.junit.runner.notification.RunListener#testRunFinished(org.junit.runner.Result)
-     */
-    public void testRunFinished( Result result )
-        throws Exception
-    {
-        String rawString = bundle.getString( "testSetCompletedNormally" );
-        ReportEntry report = new ReportEntry( currentRunStart.getClassName(), currentClassName, rawString );
-        this.reportMgr.testSetCompleted( report );
-        this.reportMgr.reset();
-    }
-
-    /**
-     * Called when a specific test has been skipped (for whatever reason).
-     *
-     * @see org.junit.runner.notification.RunListener#testIgnored(org.junit.runner.Description)
-     */
-    public void testIgnored( Description description )
-        throws Exception
-    {
-        String rawString = bundle.getString( "testSkipped" );
-        ReportEntry report =
-            new ReportEntry( description.getTestClass().getCanonicalName(), description.getDisplayName(), rawString );
-
-        this.reportMgr.testSkipped( report );
-    }
-
-    /**
-     * Called when a specific test has started.
-     *
-     * @see org.junit.runner.notification.RunListener#testStarted(org.junit.runner.Description)
-     */
-    public void testStarted( Description description )
-        throws Exception
-    {
-        String rawString = bundle.getString( "testStarting" );
-        ReportEntry report =
-            new ReportEntry( description.getTestClass().getCanonicalName(), description.getDisplayName(), rawString );
-
-        this.reportMgr.testStarting( report );
-
-        this.failureFlag = false;
-    }
-
-    /**
-     * Called when a specific test has failed.
-     *
-     * @see org.junit.runner.notification.RunListener#testFailure(org.junit.runner.notification.Failure)
-     */
-    public void testFailure( Failure failure )
-        throws Exception
-    {
-        String rawString = bundle.getString( "executeException" );
-        ReportEntry report =
-            new ReportEntry( failure.getDescription().getTestClass().getCanonicalName(), failure.getTestHeader(),
-                             rawString, new JUnitCoreStackTraceWriter( failure ) );
-
-        if ( failure.getException() instanceof AssertionError )
-        {
-            this.reportMgr.testFailed( report );
-        }
-        else
-        {
-            this.reportMgr.testError( report );
-        }
-
-        failureFlag = true;
-    }
-
-    /**
-     * Called after a specific test has finished.
-     *
-     * @see org.junit.runner.notification.RunListener#testFinished(org.junit.runner.Description)
-     */
-    public void testFinished( Description description )
-        throws Exception
-    {
-        if ( failureFlag == false )
-        {
-            String rawString = bundle.getString( "testSuccessful" );
-            ReportEntry report =
-                new ReportEntry( description.getTestClass().getCanonicalName(), description.getDisplayName(),
-                                 rawString );
-
-            this.reportMgr.testSucceeded( report );
-        }
-    }
-
-    private String extractClassName( Description description )
-    {
-        String displayName = description.getDisplayName();
-        Matcher m = PARENS.matcher( displayName );
-        if ( !m.find() )
-        {
-            return displayName;
-        }
-        return m.group( 1 );
-    }
-
-}
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/LogicalStream.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/LogicalStream.java
new file mode 100644
index 000000000..ab4258953
--- /dev/null
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/LogicalStream.java
@@ -0,0 +1,105 @@
+package org.apache.maven.surefire.junitcore;
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import org.apache.maven.surefire.report.ReporterManager;
+
+import java.util.ArrayList;
+import java.util.List;
+
+/**
+ * A stream-like object that preserves ordering between stdout/stderr
+ */
+public class LogicalStream
+{
+
+    private final List<Entry> output = new ArrayList<Entry>();
+
+    class Entry
+    {
+        final boolean stdout;
+
+        final String value;
+
+        Entry( boolean stdout, byte[] b, int off, int len )
+        {
+            this.stdout = stdout;
+            value = new String( b, off, len ).intern();
+        }
+
+        public boolean isStdout()
+        {
+            return stdout;
+        }
+
+        public void writeTo( StringBuilder stringBuilder )
+        {
+            stringBuilder.append( value );
+        }
+
+
+        public void writeToConsole( ReporterManager reporter )
+        {
+            reporter.writeConsoleMessage( value );
+        }
+
+        @Override
+        public String toString()
+        {
+            return value;
+        }
+
+        public boolean isBlankLine()
+        {
+            return "\n".equals( value );
+        }
+    }
+
+    public synchronized void write( boolean stdout, byte b[], int off, int len )
+    {
+        Entry entry = new Entry( stdout, b, off, len );
+        if ( !entry.isBlankLine() )
+        {
+            output.add( entry );
+        }
+    }
+
+
+    public void writeToConsole( ReporterManager reporter )
+    {
+        for ( Entry entry : output )
+        {
+            entry.writeToConsole( reporter );
+        }
+    }
+
+    public String getOutput( boolean stdOut )
+    {
+        StringBuilder stringBuilder = new StringBuilder();
+        for ( Entry entry : output )
+        {
+            if ( stdOut == entry.isStdout() )
+            {
+                entry.writeTo( stringBuilder );
+            }
+        }
+        return stringBuilder.toString();
+    }
+
+}
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestMethod.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestMethod.java
new file mode 100644
index 000000000..57591bf03
--- /dev/null
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestMethod.java
@@ -0,0 +1,201 @@
+package org.apache.maven.surefire.junitcore;
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import org.apache.maven.surefire.Surefire;
+import org.apache.maven.surefire.report.ReportEntry;
+import org.apache.maven.surefire.report.ReporterManager;
+import org.junit.runner.Description;
+import org.junit.runner.notification.Failure;
+
+import java.util.ArrayList;
+import java.util.Map;
+import java.util.ResourceBundle;
+
+/**
+ * Represents the test-state of a single test method that is run.
+ * <p/>
+ * Notes about thread safety: This instance is serially confined to 1-3 threads (construction, test-run, reporting),
+ * without any actual parallel access
+ */
+class TestMethod
+{
+    private final Description description;
+
+    private volatile Failure testFailure;
+
+    private volatile Failure testAssumptionFailure;
+
+    private volatile Description ignored;
+
+    private static final ResourceBundle bundle = ResourceBundle.getBundle( Surefire.SUREFIRE_BUNDLE_NAME );
+
+    private static final InheritableThreadLocal<TestMethod> testMethod = new InheritableThreadLocal<TestMethod>();
+
+    private volatile LogicalStream output;
+
+    public TestMethod( Description description )
+    {
+        this.description = description;
+    }
+
+
+    public void testFinished()
+        throws Exception
+    {
+    }
+
+
+    public void testIgnored( Description description )
+        throws Exception
+    {
+        ignored = description;
+
+    }
+
+    public void testFailure( Failure failure )
+        throws Exception
+    {
+        this.testFailure = failure;
+    }
+
+
+    public void testAssumptionFailure( Failure failure )
+    {
+        this.testAssumptionFailure = failure;
+    }
+
+    public void replay( ReporterManager reporter )
+        throws Exception
+    {
+
+        if ( ignored != null )
+        {
+            reporter.testSkipped( createReportEntry( "testSkipped" ) );
+            return;
+        }
+
+        reporter.testStarting( createReportEntry( "testStarting" ) );
+        if ( output != null )
+        {
+            // For some reason, console output is not written to the txt file.
+            output.writeToConsole( reporter );
+        }
+        if ( testFailure != null )
+        {
+            ReportEntry report = createFailureEntry( testFailure, "executeException" );
+            //noinspection ThrowableResultOfMethodCallIgnored
+            if ( testFailure.getException() instanceof AssertionError )
+            {
+                reporter.testFailed( report, getStdout(), getStdErr() );
+            }
+            else
+            {
+                reporter.testError( report, getStdout(), getStdErr() );
+            }
+
+        }
+        else if ( testAssumptionFailure != null )
+        {
+            // Does nothing...
+        }
+        else
+        {
+            reporter.testSucceeded( createReportEntry( "testSuccessful" ) );
+        }
+    }
+
+    private ReportEntry createReportEntry( String rawString2 )
+    {
+        String rawString = bundle.getString( rawString2 );
+        return new ReportEntry( description.getTestClass().getCanonicalName(), description.getDisplayName(),
+                                rawString );
+    }
+
+    private ReportEntry createFailureEntry( Failure failure, String rawString2 )
+    {
+        String rawString = bundle.getString( rawString2 );
+        return new ReportEntry( failure.getDescription().getTestClass().getCanonicalName(), failure.getTestHeader(),
+                                rawString, new JUnitCoreStackTraceWriter( failure ) );
+    }
+
+
+    public void attachToThread()
+    {
+        testMethod.set( this );
+    }
+
+    public static void detachFromCurrentThread()
+    {
+        testMethod.remove();
+    }
+
+    public static TestMethod getThreadTestMethod()
+    {
+        return testMethod.get();
+    }
+
+    public LogicalStream getLogicalStream()
+    {
+        if ( output == null )
+        {
+            output = new LogicalStream();
+        }
+        return output;
+    }
+
+
+    private String getStdout()
+    {
+        return output != null ? output.getOutput( true ) : "";
+    }
+
+    private String getStdErr()
+    {
+        return output != null ? output.getOutput( false ) : "";
+    }
+
+    public static void fillTestCountMap( Description description, Map<Class, TestSet> methodCount )
+    {
+        final ArrayList<Description> children = description.getChildren();
+
+        TestSet testSet = new TestSet( description );
+        Class<?> itemTestClass = null;
+        for ( Description item : children )
+        {
+            if ( item.isTest() )
+            {
+                testSet.incrementTestMethodCount();
+                if ( itemTestClass == null )
+                {
+                    itemTestClass = item.getTestClass();
+                }
+            }
+            else if ( item.getChildren().size() > 0 )
+            {
+                fillTestCountMap( item, methodCount );
+            }
+        }
+        if ( itemTestClass != null )
+        {
+            methodCount.put( itemTestClass, testSet );
+        }
+    }
+
+}
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestSet.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestSet.java
new file mode 100644
index 000000000..fbad4ff5e
--- /dev/null
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestSet.java
@@ -0,0 +1,146 @@
+package org.apache.maven.surefire.junitcore;
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import org.apache.maven.surefire.Surefire;
+import org.apache.maven.surefire.report.ReportEntry;
+import org.apache.maven.surefire.report.ReporterManager;
+import org.junit.runner.Description;
+
+import java.util.ArrayList;
+import java.util.Collections;
+import java.util.List;
+import java.util.ResourceBundle;
+import java.util.concurrent.atomic.AtomicBoolean;
+import java.util.concurrent.atomic.AtomicInteger;
+
+/**
+ * * Represents the test-state of a testset that is run.
+ */
+public class TestSet
+{
+    private static ResourceBundle bundle = ResourceBundle.getBundle( Surefire.SUREFIRE_BUNDLE_NAME );
+
+    private final Description testSetDescription;
+
+    private AtomicInteger numberOfCompletedChildren = new AtomicInteger( 0 );
+
+    // While the two parameters below may seem duplicated, it is not entirely the case,
+    // since numberOfTests has the correct value from the start, while testMethods grows as method execution starts.
+
+    private final AtomicInteger numberOfTests = new AtomicInteger( 0 );
+
+    private final List<TestMethod> testMethods = Collections.synchronizedList( new ArrayList<TestMethod>() );
+
+    private static final InheritableThreadLocal<TestSet> testSet = new InheritableThreadLocal<TestSet>();
+
+    private AtomicBoolean allScheduled = new AtomicBoolean();
+    private AtomicBoolean played = new AtomicBoolean();
+
+
+    public TestSet( Description testSetDescription )
+    {
+        this.testSetDescription = testSetDescription;
+    }
+
+    public void replay( ReporterManager target )
+    {
+        if (!played.compareAndSet( false, true )) return;
+
+        try
+        {
+            ReportEntry report = createReportEntry( "testSetStarting" );
+
+            target.testSetStarting( report );
+
+            for ( TestMethod testMethod : testMethods )
+            {
+                testMethod.replay( target );
+            }
+            report = createReportEntry( "testSetCompletedNormally" );
+
+            target.testSetCompleted( report );
+
+            target.reset();
+        }
+        catch ( Exception e )
+        {
+            throw new RuntimeException( e );
+        }
+    }
+
+    public TestMethod createTestMethod( Description description )
+    {
+        TestMethod testMethod = new TestMethod( description );
+        addTestMethod( testMethod );
+        return testMethod;
+    }
+
+    private ReportEntry createReportEntry( String rawString2 )
+    {
+        String rawString = bundle.getString( rawString2 );
+        boolean isJunit3 = testSetDescription.getTestClass() == null;
+        String classNameToUse =
+            isJunit3 ? testSetDescription.getChildren().get( 0 ).getClassName() : testSetDescription.getClassName();
+        return new ReportEntry( classNameToUse, classNameToUse, rawString );
+    }
+
+    public void incrementTestMethodCount()
+    {
+        numberOfTests.incrementAndGet();
+    }
+
+    public void addTestMethod( TestMethod testMethod )
+    {
+        testMethods.add( testMethod );
+    }
+
+    public void incrementFinishedTests( ReporterManager reporterManager, boolean reportImmediately )
+    {
+        numberOfCompletedChildren.incrementAndGet();
+        if ( allScheduled.get() && isAllTestsDone() && reportImmediately)
+        {
+            replay( reporterManager );
+        }
+    }
+
+    public void setAllScheduled( ReporterManager reporterManager )
+    {
+        allScheduled.set( true );
+        if ( isAllTestsDone() )
+        {
+            replay( reporterManager );
+        }
+    }
+
+    private boolean isAllTestsDone()
+    {
+        return testMethods.size() == numberOfCompletedChildren.get();
+    }
+
+    public void attachToThread()
+    {
+        testSet.set( this );
+    }
+
+    public static TestSet getThreadTestSet()
+    {
+        return testSet.get();
+    }
+}
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestsToRun.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestsToRun.java
index 9dad43c40..82ad3f414 100644
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestsToRun.java
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestsToRun.java
@@ -44,9 +44,8 @@ public TestsToRun( Class... locatedClasses )
         this.locatedClasses = locatedClasses;
         testSets = new HashMap<String, JUnitCoreTestSet>();
         int testCount = 0;
-        for ( int i = 0; i < locatedClasses.length; i++ )
+        for ( Class testClass : locatedClasses )
         {
-            Class testClass = locatedClasses[i];
             JUnitCoreTestSet testSet = new JUnitCoreTestSet( testClass );
 
             if ( testSets.containsKey( testSet.getName() ) )
diff --git a/surefire-providers/surefire-junit47/src/test/java/org/apache/maven/surefire/junitcore/ConcurrentReportingRunListenerTest.java b/surefire-providers/surefire-junit47/src/test/java/org/apache/maven/surefire/junitcore/ConcurrentReportingRunListenerTest.java
new file mode 100644
index 000000000..b83b43648
--- /dev/null
+++ b/surefire-providers/surefire-junit47/src/test/java/org/apache/maven/surefire/junitcore/ConcurrentReportingRunListenerTest.java
@@ -0,0 +1,412 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+package org.apache.maven.surefire.junitcore;
+
+
+import junit.framework.Assert;
+import junit.framework.TestCase;
+import junit.framework.TestSuite;
+import org.apache.maven.surefire.report.ReporterManagerFactory;
+import org.apache.maven.surefire.report.RunStatistics;
+import org.apache.maven.surefire.testset.TestSetFailedException;
+import org.junit.Ignore;
+import org.junit.Test;
+import org.junit.runner.Computer;
+import org.junit.runner.JUnitCore;
+
+import java.io.ByteArrayOutputStream;
+import java.io.PrintStream;
+import java.util.ArrayList;
+import java.util.List;
+
+import static junit.framework.Assert.assertEquals;
+import static org.junit.Assert.assertNotNull;
+
+/*
+ * @author Kristian Rosenvold
+ */
+
+public class ConcurrentReportingRunListenerTest
+{
+    // Tests are in order of increasing complexity
+    @Test
+    public void testNoErrorsCounting() throws Exception
+    {
+        runClasses(  3, 0 ,0, DummyAllOk.class );
+    }
+
+    @Test
+    public void testNoErrorsCounting2() throws Exception
+    {
+        runClasses( 2, 0 ,0 , Dummy3.class );
+    }
+
+    @Test
+    public void testOneIgnoreCounting() throws Exception
+    {
+        runClasses( 3, 1, 0, DummyWithOneIgnore.class  );
+    }
+
+    @Test
+    public void testOneFailureCounting() throws Exception
+    {
+        runClasses( 3, 0 ,1,  DummyWithFailure.class  );
+    }
+
+    @Test
+    public void testWithErrorsCountingDemultiplexed()
+        throws Exception
+    {
+        runClasses( 6, 1, 1 , DummyWithOneIgnore.class, DummyWithFailure.class);
+    }
+
+
+    @Test
+    public void testJunitResultCountingDemultiplexed()
+        throws Exception
+    {
+        runClasses( 8, 1, 1, DummyWithOneIgnore.class, DummyWithFailure.class, Dummy3.class   );
+    }
+
+    @Test
+    public void testJunitResultCountingJUnit3Demultiplexed()
+        throws Exception
+    {
+        runClasses( 3, 0 ,0, Junit3Tc1.class, Junit3Tc2.class  );
+    }
+
+    @Test
+    public void testJunitResultCountingJUnit3OddTest()
+        throws Exception
+    {
+        runClasses( 2, 0 ,0, Junit3OddTest1.class );
+    }
+
+    @Test
+    public void testJunit3WithNestedSuite()
+        throws TestSetFailedException
+    {
+        runClasses(  4, 0 ,0, Junit3WithNestedSuite.class );
+    }
+
+    @Test
+    public void testJunit3NestedSuite()
+        throws Exception
+    {
+        runClasses( 2, 0 ,0, Junit3OddTest1.class );
+    }
+
+
+    @Test
+    public void testSimpleOutput()
+        throws Exception
+    {
+        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
+        PrintStream collector = new PrintStream( byteArrayOutputStream );
+        PrintStream orgOur = System.out;
+        System.setOut( collector );
+
+        RunStatistics result = runClasses(Dummy3.class);
+        assertReporter( result,  2, 0 ,0, "msgs" );
+
+
+        String foo = new String( byteArrayOutputStream.toByteArray() );
+        assertNotNull( foo );
+
+        System.setOut( orgOur );
+    }
+
+    @Test
+    public void testOutputOrdering()
+        throws Exception
+    {
+        ByteArrayOutputStream byteArrayOutputStream = new ByteArrayOutputStream();
+        PrintStream collector = new PrintStream( byteArrayOutputStream );
+        PrintStream orgOur = System.out;
+        System.setOut( collector );
+
+        RunStatistics result = runClasses(DummyWithOneIgnore.class, DummyWithFailure.class, Dummy3.class);
+        assertReporter( result,  8, 1 ,1, "msgs" );
+
+
+        String foo = new String( byteArrayOutputStream.toByteArray() );
+        assertNotNull( foo );
+
+        System.setOut( orgOur );
+
+//        final List<String> stringList = result.getEvents();
+//        assertEquals( 23, stringList.size() );
+    }
+
+    private void runClasses( int success, int ignored, int failure, Class... classes )
+        throws TestSetFailedException
+    {
+        ReporterManagerFactory reporterManagerFactory = createReporterFactory();
+        RunStatistics result = runClasses(reporterManagerFactory, new ConcurrentReportingRunListener.ClassesParallelRunListener( reporterManagerFactory ),  classes);
+        assertReporter(  result, success, ignored ,failure, "classes" );
+
+        reporterManagerFactory = createReporterFactory();
+        result = runClasses(reporterManagerFactory, new ConcurrentReportingRunListener.MethodsParallelRunListener(reporterManagerFactory, true) , classes);
+        assertReporter(  result, success, ignored ,failure, "methods" );
+
+        reporterManagerFactory = createReporterFactory();
+        result = runClasses(reporterManagerFactory, new ConcurrentReportingRunListener.MethodsParallelRunListener(reporterManagerFactory, false) , classes);
+        assertReporter(  result, success, ignored ,failure, "methods" );
+
+    }
+
+    private RunStatistics runClasses( Class... classes )
+        throws TestSetFailedException
+    {
+        final ReporterManagerFactory reporterManagerFactory = createReporterFactory();
+        ConcurrentReportingRunListener demultiplexingRunListener = createRunListener( reporterManagerFactory );
+
+        JUnitCore jUnitCore = new JUnitCore();
+
+        jUnitCore.addListener( demultiplexingRunListener );
+        Computer computer = new Computer();
+
+        jUnitCore.run( computer, classes );
+        return reporterManagerFactory.getGlobalRunStatistics();
+    }
+
+    private RunStatistics runClasses( ReporterManagerFactory reporterManagerFactory, ConcurrentReportingRunListener demultiplexingRunListener, Class... classes )
+        throws TestSetFailedException
+    {
+
+        JUnitCore jUnitCore = new JUnitCore();
+
+        jUnitCore.addListener( demultiplexingRunListener );
+        Computer computer = new Computer();
+
+        jUnitCore.run( computer, classes );
+        return reporterManagerFactory.getGlobalRunStatistics();
+    }
+
+    private ConcurrentReportingRunListener createRunListener( ReporterManagerFactory reporterFactory )
+        throws TestSetFailedException
+    {
+        return new ConcurrentReportingRunListener.ClassesParallelRunListener( reporterFactory );
+    }
+
+
+    public static class DummyWithOneIgnore
+    {
+        @Test
+        public void testNotMuch()
+        {
+
+        }
+
+        @Ignore
+        @Test
+        public void testStub1()
+        {
+        }
+
+        @Test
+        public void testStub2()
+        {
+        }
+    }
+
+    public static class DummyWithFailure
+    {
+
+        @Test
+        public void testBeforeFail()
+        {
+
+        }
+
+        @Test
+        public void testWillFail()
+        {
+            Assert.fail( "We will fail" );
+        }
+
+        @Test
+        public void testAfterFail()
+        {
+        }
+    }
+
+    public static class DummyAllOk
+    {
+
+        @Test
+        public void testNotMuchA()
+        {
+
+        }
+
+        @Test
+        public void testStub1A()
+        {
+        }
+
+        @Test
+        public void testStub2A()
+        {
+        }
+    }
+
+    public static class Dummy3
+    {
+
+        @Test
+        public void testNotMuchA()
+        {
+            System.out.println( "tNMA1" );
+            System.err.println( "tNMA1err" );
+        }
+
+        @Test
+        public void testStub2A()
+        {
+            System.out.println( "tS2A" );
+            System.err.println( "tS2AErr" );
+        }
+    }
+
+    public static class Junit3Tc1
+        extends TestCase
+    {
+
+        public Junit3Tc1()
+        {
+            super( "testNotMuchJunit3TC1" );
+        }
+
+        public void testNotMuchJunit3TC1()
+        {
+            System.out.println( "Junit3TC1" );
+        }
+
+
+        public static junit.framework.Test suite()
+        {
+            TestSuite suite = new TestSuite();
+            suite.addTest( new Junit3Tc1() );
+            return suite;
+        }
+    }
+
+    public static class Junit3Tc2
+        extends TestCase
+    {
+        public Junit3Tc2( String testMethod )
+        {
+            super( testMethod );
+        }
+
+        public void testNotMuchJunit3TC2()
+        {
+            System.out.println( "Junit3TC2" );
+        }
+
+        public void testStubJ3TC2A()
+        {
+            System.out.println( "testStubJ3TC2A" );
+        }
+
+
+        public static junit.framework.Test suite()
+        {
+            TestSuite suite = new TestSuite();
+            suite.addTest( new Junit3Tc2( "testNotMuchJunit3TC2" ) );
+            suite.addTest( new Junit3Tc2( "testStubJ3TC2A" ) );
+            return suite;
+        }
+    }
+
+    public static class Junit3OddTest1
+        extends TestCase
+    {
+
+
+        public static junit.framework.Test suite()
+        {
+            TestSuite suite = new TestSuite();
+
+            suite.addTest( new Junit3OddTest1( "testMe" ) );
+            suite.addTest( new Junit3OddTest1( "testMe" ) );
+
+
+
+            return suite;
+        }
+
+
+        public Junit3OddTest1( String name )
+        {
+            super( name );
+        }
+
+        public void testMe()
+        {
+            assertTrue( true );
+        }
+    }
+
+    public static class Junit3WithNestedSuite
+        extends TestCase
+    {
+
+
+        public static junit.framework.Test suite()
+        {
+            TestSuite suite = new TestSuite();
+
+            suite.addTest( new Junit3WithNestedSuite( "testMe2" ) );
+            suite.addTest( new Junit3WithNestedSuite( "testMe2" ) );
+            suite.addTestSuite(   Junit3Tc2.class);
+            return suite;
+        }
+
+
+        public Junit3WithNestedSuite( String name )
+        {
+            super( name );
+        }
+
+        public void testMe2()
+        {
+            assertTrue( true );
+        }
+    }
+
+
+    private ReporterManagerFactory createReporterFactory()
+    {
+        Object[] reporter = new Object[]{MockReporter.class.getCanonicalName(), new Object[] {} };
+        final List<Object> objects = new ArrayList();
+        objects.add( reporter );
+        return new ReporterManagerFactory(objects, this.getClass().getClassLoader());
+    }
+
+    private void assertReporter( RunStatistics result, int success, int ignored, int failure, String message )
+    {
+        assertEquals( message,  success, result.getCompletedCount() );
+        assertEquals( message,  failure, result.getFailureSources().size() );
+        assertEquals( message,  ignored, result.getSkipped() );
+    }
+
+}
diff --git a/surefire-providers/surefire-junit47/src/test/java/org/apache/maven/surefire/junitcore/DemultiplexingRunListenerTest.java b/surefire-providers/surefire-junit47/src/test/java/org/apache/maven/surefire/junitcore/DemultiplexingRunListenerTest.java
deleted file mode 100644
index 2771be2a0..000000000
--- a/surefire-providers/surefire-junit47/src/test/java/org/apache/maven/surefire/junitcore/DemultiplexingRunListenerTest.java
+++ /dev/null
@@ -1,148 +0,0 @@
-/*
- * Licensed to the Apache Software Foundation (ASF) under one
- * or more contributor license agreements.  See the NOTICE file
- * distributed with this work for additional information
- * regarding copyright ownership.  The ASF licenses this file
- * to you under the Apache License, Version 2.0 (the
- * "License"); you may not use this file except in compliance
- * with the License.  You may obtain a copy of the License at
- *
- *     http://www.apache.org/licenses/LICENSE-2.0
- *
- * Unless required by applicable law or agreed to in writing,
- * software distributed under the License is distributed on an
- * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
- * KIND, either express or implied.  See the License for the
- * specific language governing permissions and limitations
- * under the License.
- */
-
-package org.apache.maven.surefire.junitcore;
-
-
-import junit.framework.Assert;
-import org.junit.Ignore;
-import org.junit.Test;
-import org.junit.runner.Computer;
-import org.junit.runner.Description;
-import org.junit.runner.JUnitCore;
-import org.junit.runner.Result;
-import org.junit.runner.notification.RunListener;
-
-import static junit.framework.Assert.assertEquals;
-import static org.mockito.Mockito.*;
-
-/*
- * @author Kristian Rosenvold
- */
-
-public class DemultiplexingRunListenerTest
-{
-    @Test
-    public void testTestStarted()
-        throws Exception
-    {
-        RunListener real = mock( RunListener.class );
-        DemultiplexingRunListener listener = new DemultiplexingRunListener( real );
-
-        Description testRunDescription = Description.createSuiteDescription( DemultiplexingRunListenerTest.class );
-        Description description1 =
-            Description.createTestDescription( DemultiplexingRunListenerTest.class, "testStub1" );
-        Description description2 = Description.createTestDescription( Dummy.class, "testStub2" );
-        testRunDescription.addChild( description1 );
-        testRunDescription.addChild( description2 );
-
-        listener.testRunStarted( testRunDescription );
-        listener.testStarted( description1 );
-        listener.testStarted( description2 );
-        listener.testFinished( description1 );
-        listener.testFinished( description2 );
-        Result temp = new Result();
-        listener.testRunFinished( temp );
-
-        verify( real ).testRunStarted( any( Description.class ) );
-        verify( real ).testStarted( description1 );
-        verify( real ).testFinished( description1 );
-        verify( real ).testStarted( description2 );
-        verify( real ).testFinished( description2 );
-        verify( real ).testRunFinished( any( Result.class ) );
-    }
-
-    @Test
-    public void testJunitResultCountingReferenceValue()
-        throws Exception
-    {
-        Result result = new Result();
-        runACoupleOfClasses( result );
-
-        assertEquals( 5, result.getRunCount() );
-        assertEquals( 1, result.getIgnoreCount() );
-        assertEquals( 1, result.getFailureCount() );
-    }
-
-    @Test
-    public void testJunitResultCountingDemultiplexed()
-        throws Exception
-    {
-        Result result = new Result();
-        runACoupleOfClasses( result );
-
-        assertEquals( 5, result.getRunCount() );
-        assertEquals( 1, result.getIgnoreCount() );
-        assertEquals( 1, result.getFailureCount() );
-    }
-
-    private void runACoupleOfClasses( Result result )
-    {
-        DemultiplexingRunListener demultiplexingRunListener = new DemultiplexingRunListener( result.createListener() );
-
-        JUnitCore jUnitCore = new JUnitCore();
-
-        jUnitCore.addListener( demultiplexingRunListener );
-        Computer computer = new Computer();
-
-        jUnitCore.run( computer, new Class[]{ Dummy.class, Dummy2.class } );
-    }
-
-    public static class Dummy
-    {
-        @Test
-        public void testNotMuch()
-        {
-
-        }
-
-        @Ignore
-        @Test
-        public void testStub1()
-        {
-        }
-
-        @Test
-        public void testStub2()
-        {
-        }
-    }
-
-    public static class Dummy2
-    {
-
-        @Test
-        public void testNotMuchA()
-        {
-
-        }
-
-        @Test
-        public void testStub1A()
-        {
-            Assert.fail( "We will fail" );
-        }
-
-        @Test
-        public void testStub2A()
-        {
-        }
-    }
-
-}
diff --git a/surefire-providers/surefire-junit47/src/test/java/org/apache/maven/surefire/junitcore/MockReporter.java b/surefire-providers/surefire-junit47/src/test/java/org/apache/maven/surefire/junitcore/MockReporter.java
new file mode 100644
index 000000000..6c7f702dc
--- /dev/null
+++ b/surefire-providers/surefire-junit47/src/test/java/org/apache/maven/surefire/junitcore/MockReporter.java
@@ -0,0 +1,114 @@
+package org.apache.maven.surefire.junitcore;
+
+import org.apache.maven.surefire.report.ReportEntry;
+import org.apache.maven.surefire.report.Reporter;
+import org.apache.maven.surefire.report.ReporterException;
+
+import java.util.ArrayList;
+import java.util.List;
+import java.util.concurrent.atomic.AtomicInteger;
+
+public class MockReporter implements Reporter
+{
+    private final List<String> events = new ArrayList<String>( );
+    public static final String RUN_STARTED = "RUN_STARTED";
+    public static final String RUN_COMPLETED = "RUN_COMPLETED";
+    public static final String SET_STARTED = "SET_STARTED";
+    public static final String SET_COMPLETED = "SET_COMPLETED";
+    public static final String TEST_STARTED = "TEST_STARTED";
+    public static final String TEST_COMPLETED = "TEST_COMPLETED";
+    public static final String TEST_FAILED= "TEST_FAILED";
+    public static final String TEST_ERROR = "TEST_ERROR";
+    public static final String TEST_SKIPPED = "TEST_SKIPPED";
+
+    private final AtomicInteger testSucceeded = new AtomicInteger( );
+    private final AtomicInteger testIgnored = new AtomicInteger( );
+    private final AtomicInteger testFailed = new AtomicInteger( );
+    private final AtomicInteger testError = new AtomicInteger( );
+
+
+    public void runStarting( )
+    {
+        events.add(RUN_STARTED);
+    }
+
+    public void runCompleted()
+    {
+        events.add( RUN_COMPLETED);
+    }
+
+    public void testSetStarting( ReportEntry report )
+        throws ReporterException
+    {
+        events.add( SET_STARTED);
+    }
+
+    public void testSetCompleted( ReportEntry report )
+        throws ReporterException
+    {
+        events.add( SET_COMPLETED);
+    }
+
+    public void testStarting( ReportEntry report )
+    {
+        events.add( TEST_STARTED);
+    }
+
+    public void testSucceeded( ReportEntry report )
+    {
+        events.add( TEST_COMPLETED);
+        testSucceeded.incrementAndGet();
+
+    }
+
+    public void testError( ReportEntry report, String stdOut, String stdErr )
+    {
+        events.add( TEST_ERROR);
+        testError.incrementAndGet();
+    }
+
+    public void testFailed( ReportEntry report, String stdOut, String stdErr )
+    {
+        events.add( TEST_FAILED);
+        testFailed.incrementAndGet();
+    }
+
+    public void testSkipped( ReportEntry report )
+    {
+        events.add( TEST_SKIPPED);
+        testIgnored.incrementAndGet();
+    }
+
+    public void reset()
+    {
+    }
+
+    public void writeMessage( String message )
+    {
+    }
+
+    public void writeFooter( String footer )
+    {
+    }
+
+    public List<String> getEvents()
+    {
+        return events;
+    }
+
+    public int getTestSucceeded()
+    {
+        return testSucceeded.get();
+    }
+
+    public int getTestIgnored()
+    {
+        return testIgnored.get();
+    }
+
+    public int getTestFailed()
+    {
+        return testFailed.get();
+    }
+
+}
