diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/DependencyScanner.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/DependencyScanner.java
index 189ea800f..df36f0869 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/DependencyScanner.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/DependencyScanner.java
@@ -39,137 +39,146 @@
 
 /**
  * Scans dependencies looking for tests.
- *
+ * 
  * @author Aslak Knutsen
  */
-public class DependencyScanner {
+public class DependencyScanner
+{
 
-	private final List<File> dependenciesToScan;
+    private final List<File> dependenciesToScan;
 
-	protected final List<String> includes;
+    protected final List<String> includes;
 
-	protected final @Nonnull List<String> excludes;
+    protected final @Nonnull List<String> excludes;
 
-	protected final List<String> specificTests;
+    protected final List<String> specificTests;
 
-	public DependencyScanner(List<File> dependenciesToScan, List<String> includes, @Nonnull List<String> excludes, List<String> specificTests)
-	{
-		this.dependenciesToScan = dependenciesToScan;
+    public DependencyScanner( List<File> dependenciesToScan, List<String> includes, @Nonnull List<String> excludes, List<String> specificTests )
+    {
+        this.dependenciesToScan = dependenciesToScan;
         this.includes = includes;
         this.excludes = excludes;
         this.specificTests = specificTests;
-	}
-
-	public DefaultScanResult scan() throws MojoExecutionException
-	{
-		Matcher matcher = new Matcher(includes, excludes, specificTests);
-		List<String> found = new ArrayList<String>();
-		for(File artifact : dependenciesToScan)
-		{
-			try
-			{
-				found.addAll(scanArtifact(artifact, matcher));
-			}
-			catch (IOException e)
-			{
-				throw new MojoExecutionException("Could not scan dependency " + artifact.toString(), e);
-			}
-		}
-		return new DefaultScanResult(found);
-	}
-
-	private List<String> scanArtifact(File artifact, Matcher matcher) throws IOException
-	{
-		List<String> found = new ArrayList<String>();
-
-		if(artifact != null) {
-			if(artifact.isFile()) {
-				JarFile jar = null;
-				try {
-					jar = new JarFile(artifact);
-					Enumeration<JarEntry> entries = jar.entries();
-					while(entries.hasMoreElements())
-					{
-						JarEntry entry = entries.nextElement();
-						if(matcher.shouldInclude(entry.getName()))
-						{
-							found.add(convertJarFileResourceToJavaClassName( entry.getName() ));
-						}
-					}
-				}
-				finally
-				{
-					if(jar != null)
-					{
-						jar.close();
-					}
-				}
-			}
-		}
-		return found;
-	}
-
-	public static List<File> filter(List<Artifact> artifacts, List<String> groupArtifactIds)
-	{
-		List<File> matches = new ArrayList<File>();
-		if(groupArtifactIds == null || artifacts == null)
-		{
-			return matches;
-		}
-		for(Artifact artifact : artifacts)
-		{
-			for(String groups : groupArtifactIds)
-			{
-				String[] groupArtifact = groups.split(":");
-				if(groupArtifact.length != 2)
-				{
-					throw new IllegalArgumentException(
-							"dependencyToScan argument should be in format 'groupid:artifactid': " + groups);
-				}
-				if(
-						artifact.getGroupId().matches(groupArtifact[0]) &&
-						artifact.getArtifactId().matches(groupArtifact[1]))
-				{
-					matches.add(artifact.getFile());
-				}
-			}
-		}
-		return matches;
-	}
-
-	private class Matcher {
-
-		private MatchPatterns includes;
-		private MatchPatterns excludes;
-
-		private SpecificFileFilter specificTestFilter;
-
-		public Matcher(@Nullable List<String> includes, @Nonnull List<String> excludes, @Nullable List<String> specificTests)
-		{
-			String[] specific = specificTests == null ? new String[0] : processIncludesExcludes( specificTests );
-			specificTestFilter = new SpecificFileFilter( specific );
-
-			if(includes != null && includes.size() > 0)
-			{
-				this.includes = MatchPatterns.from(processIncludesExcludes(includes));
-			}
-			else
-			{
-				this.includes = MatchPatterns.from("**");
-			}
-			this.excludes = MatchPatterns.from(processIncludesExcludes(excludes));
-		}
-
-		public boolean shouldInclude(String name)
-		{
-			if(!name.endsWith(".class"))
-			{
-				return false;
-			}
-			boolean isIncluded = includes.matches(name, false);
-			boolean isExcluded = excludes.matches(name, false);
-
-			return isIncluded && !isExcluded && specificTestFilter.accept(name);
-		}
-	}
+    }
+
+    public DefaultScanResult scan()
+        throws MojoExecutionException
+    {
+        Matcher matcher = new Matcher( includes, excludes, specificTests );
+        List<String> found = new ArrayList<String>();
+        for ( File artifact : dependenciesToScan )
+        {
+            try
+            {
+                found.addAll( scanArtifact( artifact, matcher ) );
+            }
+            catch ( IOException e )
+            {
+                throw new MojoExecutionException( "Could not scan dependency " + artifact.toString(), e );
+            }
+        }
+        return new DefaultScanResult( found );
+    }
+
+    private List<String> scanArtifact( File artifact, Matcher matcher )
+        throws IOException
+    {
+        List<String> found = new ArrayList<String>();
+
+        if ( artifact != null )
+        {
+            if ( artifact.isFile() )
+            {
+                JarFile jar = null;
+                try
+                {
+                    jar = new JarFile( artifact );
+                    Enumeration<JarEntry> entries = jar.entries();
+                    while ( entries.hasMoreElements() )
+                    {
+                        JarEntry entry = entries.nextElement();
+                        if ( matcher.shouldInclude( entry.getName() ) )
+                        {
+                            found.add( convertJarFileResourceToJavaClassName( entry.getName() ) );
+                        }
+                    }
+                }
+                finally
+                {
+                    if ( jar != null )
+                    {
+                        jar.close();
+                    }
+                }
+            }
+        }
+        return found;
+    }
+
+    public static List<File> filter( List<Artifact> artifacts, List<String> groupArtifactIds )
+    {
+        List<File> matches = new ArrayList<File>();
+        if ( groupArtifactIds == null || artifacts == null )
+        {
+            return matches;
+        }
+        for ( Artifact artifact : artifacts )
+        {
+            for ( String groups : groupArtifactIds )
+            {
+                String[] groupArtifact = groups.split( ":" );
+                if ( groupArtifact.length != 2 )
+                {
+                    throw new IllegalArgumentException(
+                                                        "dependencyToScan argument should be in format 'groupid:artifactid': "
+                                                            + groups );
+                }
+                if ( artifact.getGroupId().matches( groupArtifact[0] )
+                    && artifact.getArtifactId().matches( groupArtifact[1] ) )
+                {
+                    matches.add( artifact.getFile() );
+                }
+            }
+        }
+        return matches;
+    }
+
+    private class Matcher
+    {
+
+        private MatchPatterns includes;
+
+        private MatchPatterns excludes;
+
+        private SpecificFileFilter specificTestFilter;
+
+        public Matcher( @Nullable List<String> includes, @Nonnull List<String> excludes, @Nullable List<String> specificTests )
+        {
+            String[] specific = specificTests == null ? new String[0] : processIncludesExcludes( specificTests );
+            specificTestFilter = new SpecificFileFilter( specific );
+
+            if ( includes != null && includes.size() > 0 )
+            {
+                this.includes = MatchPatterns.from( processIncludesExcludes( includes ) );
+            }
+            else
+            {
+                this.includes = MatchPatterns.from( "**" );
+            }
+            this.excludes = MatchPatterns.from( processIncludesExcludes( excludes ) );
+        }
+
+        public boolean shouldInclude( String name )
+        {
+            if ( !name.endsWith( ".class" ) )
+            {
+                return false;
+            }
+            name = ScannerUtil.convertJarFileResourceToSystemFileSeparator( name );
+            boolean isIncluded = includes.matches( name, false );
+            boolean isExcluded = excludes.matches( name, false );
+
+            return isIncluded && !isExcluded && specificTestFilter.accept( name );
+        }
+    }
 }
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/ScannerUtil.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/ScannerUtil.java
index 8b80301b3..875219438 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/ScannerUtil.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/ScannerUtil.java
@@ -36,6 +36,8 @@ private ScannerUtil() {}
     private static final String JAVA_SOURCE_FILE_EXTENSION = ".java";
 
     private static final String JAVA_CLASS_FILE_EXTENSION = ".class";
+    
+    private static final boolean IS_NON_UNIX_FS = (!FS.equals( "/" ));
 
     public static @Nonnull String convertToJavaClassName( @Nonnull String test )
     {
@@ -47,6 +49,11 @@ private ScannerUtil() {}
         return StringUtils.removeEnd( test, ".class" ).replace( "/", "." );
     }
 
+    public static @Nonnull String convertJarFileResourceToSystemFileSeparator( @Nonnull String path )
+    {
+        return ( IS_NON_UNIX_FS ? path.replace( "/", FS ) : path );
+    }
+
     public static @Nonnull String stripBaseDir( String basedir, String test )
     {
         return StringUtils.removeStart( test, basedir );
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/SpecificFileFilter.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/SpecificFileFilter.java
index 73d52e565..272ceb64c 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/SpecificFileFilter.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/SpecificFileFilter.java
@@ -19,18 +19,16 @@
  * under the License.
  */
 
-import java.util.Collections;
 import java.util.HashSet;
 import java.util.Set;
-import org.apache.maven.shared.utils.io.SelectorUtils;
 
 import javax.annotation.Nullable;
 
+import org.apache.maven.shared.utils.io.SelectorUtils;
+
 public class SpecificFileFilter
 {
 
-    private static final char FS = System.getProperty( "file.separator" ).charAt( 0 );
-
     private Set<String> names;
 
     public SpecificFileFilter( @Nullable String[] classNames )
@@ -38,12 +36,10 @@ public SpecificFileFilter( @Nullable String[] classNames )
         if ( classNames != null && classNames.length > 0 )
         {
             this.names = new HashSet<String>();
-            boolean isBackslashFs = '\\' == FS;
             for ( String name : classNames )
             {
-                names.add( isBackslashFs ? name.replace( '/', FS ) : name );
+                names.add( ScannerUtil.convertJarFileResourceToSystemFileSeparator( name ) );
             }
-            Collections.addAll( names, classNames );
         }
     }
 
