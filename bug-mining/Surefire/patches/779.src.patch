diff --git a/Jenkinsfile b/Jenkinsfile
index ddb5f8483..a495ff3b5 100644
--- a/Jenkinsfile
+++ b/Jenkinsfile
@@ -24,8 +24,8 @@ properties(
         buildDiscarder(logRotator(artifactNumToKeepStr: env.BRANCH_NAME == 'master' ? '15' : '5',
                                   daysToKeepStr: env.BRANCH_NAME == 'master' ? '30' : '14',
                                   numToKeepStr: env.BRANCH_NAME == 'master' ? '20' : '10')
-        )//,
-        //disableConcurrentBuilds()
+        ),
+        disableConcurrentBuilds(abortPrevious: true)
     ]
 )
 // final def oses = ['linux':'ubuntu && maven', 'windows':'windows-he']
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
index d658737ce..05b5059de 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
@@ -120,6 +120,7 @@ public class StatelessXmlReporter implements StatelessReportEventListener<Wrappe
 
     private final boolean enablePropertiesElement;
 
+    @Deprecated
     public StatelessXmlReporter(
             File reportsDirectory,
             String reportNameSuffix,
@@ -205,17 +206,10 @@ private Map<String, Map<String, List<WrappedReportEntry>>> arrangeMethodStatisti
         Map<String, Map<String, List<WrappedReportEntry>>> classMethodStatistics = new LinkedHashMap<>();
         for (WrappedReportEntry methodEntry : aggregateCacheFromMultipleReruns(testSetReportEntry, testSetStats)) {
             String testClassName = methodEntry.getSourceName();
-            Map<String, List<WrappedReportEntry>> stats = classMethodStatistics.get(testClassName);
-            if (stats == null) {
-                stats = new LinkedHashMap<>();
-                classMethodStatistics.put(testClassName, stats);
-            }
+            Map<String, List<WrappedReportEntry>> stats =
+                    classMethodStatistics.computeIfAbsent(testClassName, k -> new LinkedHashMap<>());
             String methodName = methodEntry.getName();
-            List<WrappedReportEntry> methodRuns = stats.get(methodName);
-            if (methodRuns == null) {
-                methodRuns = new ArrayList<>();
-                stats.put(methodName, methodRuns);
-            }
+            List<WrappedReportEntry> methodRuns = stats.computeIfAbsent(methodName, k -> new ArrayList<>());
             methodRuns.add(methodEntry);
         }
         return classMethodStatistics;
@@ -416,7 +410,7 @@ private void startTestElement(XMLWriter ppw, WrappedReportEntry report) throws I
 
         String className = phrasedClassName
                 ? report.getReportSourceName(reportNameSuffix)
-                : report.getSourceName(reportNameSuffix);
+                : report.getSourceText() != null ? report.getSourceText() : report.getSourceName(reportNameSuffix);
         if (className != null) {
             ppw.addAttribute("classname", extraEscapeAttribute(className));
         }
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetStats.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetStats.java
index 1431d8fde..de4a9ce66 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetStats.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetStats.java
@@ -252,7 +252,7 @@ static String concatenateWithTestGroup(MessageBuilder builder, ReportEntry repor
         if (phrasedClassName && report.getReportNameWithGroup() != null) {
             return builder.strong(report.getReportNameWithGroup()).toString();
         } else {
-            String testClass = report.getNameWithGroup();
+            String testClass = report.getSourceText() != null ? report.getSourceText() : report.getNameWithGroup();
             int indexOfGroup = testClass.indexOf(GROUP_PREFIX);
             int delimiter = testClass.lastIndexOf('.', indexOfGroup == -1 ? testClass.length() : indexOfGroup);
             String pkg = testClass.substring(0, 1 + delimiter);
diff --git a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/TestSetStatsTest.java b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/TestSetStatsTest.java
index f7cab66e7..f68aa6bb0 100644
--- a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/TestSetStatsTest.java
+++ b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/TestSetStatsTest.java
@@ -44,8 +44,10 @@ public class TestSetStatsTest {
 
     @Test
     public void shouldConcatenateWithTestGroup() {
+        when(reportEntry.getSourceText()).thenReturn(null);
         when(reportEntry.getNameWithGroup()).thenReturn("pkg.MyTest (my group)");
         String actual = TestSetStats.concatenateWithTestGroup(buffer(), reportEntry, false);
+        verify(reportEntry, times(1)).getSourceText();
         verify(reportEntry, times(1)).getNameWithGroup();
         verifyNoMoreInteractions(reportEntry);
         String expected = buffer().a("pkg.").strong("MyTest (my group)").toString();
@@ -54,6 +56,7 @@ public void shouldConcatenateWithTestGroup() {
 
     @Test
     public void shouldConcatenateWithJUnit5TestGroup() {
+        when(reportEntry.getSourceText()).thenReturn(null);
         when(reportEntry.getReportNameWithGroup()).thenReturn("pkg.MyTest (my group)");
         String actual = TestSetStats.concatenateWithTestGroup(buffer(), reportEntry, true);
         verify(reportEntry, atLeastOnce()).getReportNameWithGroup();
@@ -64,11 +67,13 @@ public void shouldConcatenateWithJUnit5TestGroup() {
 
     @Test
     public void shouldFallBackToTestGroupIfJUnit5TestGroupIsNull() {
+        when(reportEntry.getSourceText()).thenReturn(null);
         when(reportEntry.getReportNameWithGroup()).thenReturn(null);
         when(reportEntry.getNameWithGroup()).thenReturn("pkg.MyTest (my group)");
         String actual = TestSetStats.concatenateWithTestGroup(buffer(), reportEntry, true);
         verify(reportEntry, atLeastOnce()).getReportNameWithGroup();
         verify(reportEntry, atLeastOnce()).getNameWithGroup();
+        verify(reportEntry, atLeastOnce()).getSourceText();
         verifyNoMoreInteractions(reportEntry);
         String expected = buffer().a("pkg.").strong("MyTest (my group)").toString();
         assertThat(actual).isEqualTo(expected);
diff --git a/surefire-its/pom.xml b/surefire-its/pom.xml
index c908adcca..5b19ddae6 100644
--- a/surefire-its/pom.xml
+++ b/surefire-its/pom.xml
@@ -33,8 +33,12 @@
 
   <properties>
     <project.reporting.outputEncoding>UTF-8</project.reporting.outputEncoding>
-    <its.forkCount>1C</its.forkCount>
+    <surefire.rerunFailingTestsCount>0</surefire.rerunFailingTestsCount>
+    <its.forkCount>0.5C</its.forkCount>
     <its.threadCount>1</its.threadCount>
+    <maven.deploy.skip>true</maven.deploy.skip>
+    <maven.install.skip>true</maven.install.skip>
+    <maven.javadoc.skip>true</maven.javadoc.skip>
   </properties>
 
   <dependencies>
@@ -110,6 +114,11 @@
       <artifactId>assertj-core</artifactId>
       <scope>test</scope>
     </dependency>
+    <dependency>
+      <groupId>org.xmlunit</groupId>
+      <artifactId>xmlunit-core</artifactId>
+      <scope>test</scope>
+    </dependency>
   </dependencies>
 
   <build>
@@ -189,18 +198,6 @@
           </execution>
         </executions>
       </plugin>
-      <plugin>
-        <artifactId>maven-install-plugin</artifactId>
-        <configuration>
-          <skip>true</skip>
-        </configuration>
-      </plugin>
-      <plugin>
-        <artifactId>maven-deploy-plugin</artifactId>
-        <configuration>
-          <skip>true</skip>
-        </configuration>
-      </plugin>
     </plugins>
   </build>
   <profiles>
@@ -217,7 +214,6 @@
               <runOrder>alphabetical</runOrder>
               <forkCount>${its.forkCount}</forkCount>
               <threadCount>${its.threadCount}</threadCount>
-              <rerunFailingTestsCount>1</rerunFailingTestsCount>
               <perCoreThreadCount>false</perCoreThreadCount>
               <argLine>-server -Xmx64m -XX:+UseG1GC -XX:+TieredCompilation -XX:TieredStopAtLevel=1 -Djava.awt.headless=true -Djdk.net.URLClassPath.disableClassPathURLCheck=true</argLine>
               <!-- Pass current surefire version to the main suite so that it -->
@@ -251,6 +247,7 @@
       <properties>
         <its.forkCount>0.4C</its.forkCount>
         <its.threadCount>1</its.threadCount>
+        <surefire.rerunFailingTestsCount>1</surefire.rerunFailingTestsCount>
       </properties>
     </profile>
     <profile>
diff --git a/surefire-its/src/test/java/org/apache/maven/surefire/its/ArchUnitIT.java b/surefire-its/src/test/java/org/apache/maven/surefire/its/ArchUnitIT.java
new file mode 100644
index 000000000..f95d3397d
--- /dev/null
+++ b/surefire-its/src/test/java/org/apache/maven/surefire/its/ArchUnitIT.java
@@ -0,0 +1,70 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+package org.apache.maven.surefire.its;
+
+import javax.xml.transform.Source;
+
+import org.apache.maven.surefire.its.fixture.OutputValidator;
+import org.apache.maven.surefire.its.fixture.SurefireJUnit4IntegrationTestCase;
+import org.apache.maven.surefire.its.fixture.TestFile;
+import org.hamcrest.collection.IsIterableWithSize;
+import org.junit.Before;
+import org.junit.Test;
+import org.w3c.dom.Node;
+import org.xmlunit.builder.Input;
+import org.xmlunit.xpath.JAXPXPathEngine;
+
+import static org.apache.maven.surefire.its.fixture.HelperAssertions.assumeJavaVersion;
+import static org.hamcrest.MatcherAssert.assertThat;
+
+/**
+ *
+ */
+@SuppressWarnings("checkstyle:magicnumber")
+public class ArchUnitIT extends SurefireJUnit4IntegrationTestCase {
+
+    @Before
+    public void setUp() {
+        assumeJavaVersion(17);
+    }
+
+    @Test
+    public void simpleCucumberUsage() throws Exception {
+        OutputValidator outputValidator = unpack("archunit")
+                .maven()
+                .withFailure()
+                .executeTest()
+                .verifyTextInLog("BUILD FAILURE")
+                .verifyTextInLog("classes that have simple name ending with 'DTO'")
+                .assertTestSuiteResults(1, 0, 1, 0);
+
+        TestFile xmlReportFile = outputValidator.getSurefireReportsXmlFile("TEST-custom.ArchUnitTest.xml");
+        xmlReportFile.assertFileExists();
+
+        Source source = Input.fromFile(xmlReportFile.getFile()).build();
+
+        Iterable<Node> ite = new JAXPXPathEngine().selectNodes("//testcase", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+        ite = new JAXPXPathEngine().selectNodes("//testcase[@classname='ArchUnitTest']", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+
+        ite = new JAXPXPathEngine().selectNodes("//testcase[@name='DTO_IN_PACKAGE_DTO']", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+    }
+}
diff --git a/surefire-its/src/test/java/org/apache/maven/surefire/its/CucumberIT.java b/surefire-its/src/test/java/org/apache/maven/surefire/its/CucumberIT.java
new file mode 100644
index 000000000..5098d8813
--- /dev/null
+++ b/surefire-its/src/test/java/org/apache/maven/surefire/its/CucumberIT.java
@@ -0,0 +1,84 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+package org.apache.maven.surefire.its;
+
+import javax.xml.transform.Source;
+
+import org.apache.maven.surefire.its.fixture.OutputValidator;
+import org.apache.maven.surefire.its.fixture.SurefireJUnit4IntegrationTestCase;
+import org.apache.maven.surefire.its.fixture.TestFile;
+import org.hamcrest.collection.IsIterableWithSize;
+import org.junit.Before;
+import org.junit.Test;
+import org.w3c.dom.Node;
+import org.xmlunit.builder.Input;
+import org.xmlunit.xpath.JAXPXPathEngine;
+
+import static org.apache.maven.surefire.its.fixture.HelperAssertions.assumeJavaVersion;
+import static org.hamcrest.MatcherAssert.assertThat;
+
+/**
+ *
+ */
+@SuppressWarnings("checkstyle:magicnumber")
+public class CucumberIT extends SurefireJUnit4IntegrationTestCase {
+
+    @Before
+    public void setUp() {
+        assumeJavaVersion(17);
+    }
+
+    @Test
+    public void simpleCucumberUsage() throws Exception {
+        OutputValidator outputValidator = unpack("cucumber-tests")
+                .maven()
+                .withFailure()
+                .executeTest()
+                .verifyTextInLog("BUILD FAILURE")
+                .verifyTextInLog("expected: <11> but was: <15>")
+                .assertTestSuiteResults(3, 0, 1, 0);
+
+        TestFile xmlReportFile = outputValidator.getSurefireReportsXmlFile("TEST-cz.fafejta.SimpleTest.xml");
+        xmlReportFile.assertFileExists();
+
+        Source source = Input.fromFile(xmlReportFile.getFile()).build();
+
+        Iterable<Node> ite = new JAXPXPathEngine().selectNodes("//testcase", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+        ite = new JAXPXPathEngine().selectNodes("//testcase[@classname='cz.fafejta.SimpleTest']", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+
+        xmlReportFile = outputValidator.getSurefireReportsXmlFile("TEST-cz.fafejta.RunCucumberTest.xml");
+        xmlReportFile.assertFileExists();
+
+        source = Input.fromFile(xmlReportFile.getFile()).build();
+
+        ite = new JAXPXPathEngine().selectNodes("//testcase", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(2));
+
+        ite = new JAXPXPathEngine().selectNodes("//testcase[@classname='RunCucumberTest']", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(2));
+
+        ite = new JAXPXPathEngine().selectNodes("//testcase[@name='Sum test - Valid test']", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+
+        ite = new JAXPXPathEngine().selectNodes("//testcase[@name='Sum test - Invalid test']", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+    }
+}
diff --git a/surefire-its/src/test/java/org/apache/maven/surefire/its/JUnitPlatformEnginesIT.java b/surefire-its/src/test/java/org/apache/maven/surefire/its/JUnitPlatformEnginesIT.java
index 255aea291..8f6b7b366 100644
--- a/surefire-its/src/test/java/org/apache/maven/surefire/its/JUnitPlatformEnginesIT.java
+++ b/surefire-its/src/test/java/org/apache/maven/surefire/its/JUnitPlatformEnginesIT.java
@@ -73,15 +73,10 @@ public class JUnitPlatformEnginesIT extends SurefireJUnit4IntegrationTestCase {
     @Parameters(name = "{0}")
     public static Iterable<Object[]> artifactVersions() {
         List<Object[]> args = new ArrayList<>();
-        args.add(new Object[] {"1.2.0", "5.2.0", "1.1.0", "1.0.0"});
-        args.add(new Object[] {"1.3.2", "5.3.2", "1.1.1", "1.0.0"});
-        args.add(new Object[] {"1.4.2", "5.4.2", "1.1.1", "1.0.0"});
-        args.add(new Object[] {"1.5.2", "5.5.2", "1.2.0", "1.1.0"});
-        args.add(new Object[] {"1.6.3", "5.6.3", "1.2.0", "1.1.0"});
-        args.add(new Object[] {"1.7.2", "5.7.2", "1.2.0", "1.1.0"});
         args.add(new Object[] {"1.8.2", "5.8.2", "1.2.0", "1.1.2"});
         args.add(new Object[] {"1.9.1", "5.9.1", "1.2.0", "1.1.2"});
         args.add(new Object[] {"1.10.2", "5.10.2", "1.3.0", "1.1.2"});
+        args.add(new Object[] {"1.13.4", "5.13.4", "1.3.0", "1.1.2"});
         return args;
     }
 
diff --git a/surefire-its/src/test/java/org/apache/maven/surefire/its/JUnitPlatformIT.java b/surefire-its/src/test/java/org/apache/maven/surefire/its/JUnitPlatformIT.java
index 2f5774bd8..247d6c492 100644
--- a/surefire-its/src/test/java/org/apache/maven/surefire/its/JUnitPlatformIT.java
+++ b/surefire-its/src/test/java/org/apache/maven/surefire/its/JUnitPlatformIT.java
@@ -48,16 +48,11 @@ public class JUnitPlatformIT extends SurefireJUnit4IntegrationTestCase {
     @Parameters(name = "{0}")
     public static Iterable<Object[]> artifactVersions() {
         List<Object[]> args = new ArrayList<>();
-        args.add(new Object[] {"5.2.0", "0.8.0"});
-        args.add(new Object[] {"5.3.2", "0.9.0"});
-        args.add(new Object[] {"5.4.2", "1.0.0"});
-        args.add(new Object[] {"5.5.2", "0.8.15"});
-        args.add(new Object[] {"5.6.2", "1.3.5"});
-        args.add(new Object[] {"5.7.2", "1.5.5"});
         args.add(new Object[] {"5.8.2", "1.6.5"});
         args.add(new Object[] {"5.9.1", "1.7.1"});
         args.add(new Object[] {"5.10.2", "1.8.5"});
-        args.add(new Object[] {"5.11.0-M2", "1.8.5"});
+        args.add(new Object[] {"5.11.4", "1.8.5"});
+        args.add(new Object[] {"5.13.4", "1.8.5"});
         return args;
     }
 
diff --git a/surefire-its/src/test/java/org/apache/maven/surefire/its/fixture/SurefireLauncher.java b/surefire-its/src/test/java/org/apache/maven/surefire/its/fixture/SurefireLauncher.java
index 466513892..dcd6a5779 100755
--- a/surefire-its/src/test/java/org/apache/maven/surefire/its/fixture/SurefireLauncher.java
+++ b/surefire-its/src/test/java/org/apache/maven/surefire/its/fixture/SurefireLauncher.java
@@ -86,7 +86,7 @@ private List<String> getInitialGoals() {
         jacocoAgent = jacocoAgent.replace("\"", "");
         goals.add("-Djacoco.agent=" + jacocoAgent);
         goals.add("-nsu");
-
+        goals.add("-Dmaven.build.cache.enabled=false");
         return goals;
     }
 
diff --git a/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire1787JUnit5IT.java b/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire1787JUnit5IT.java
index 962877b0b..1f7752414 100644
--- a/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire1787JUnit5IT.java
+++ b/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire1787JUnit5IT.java
@@ -18,9 +18,18 @@
  */
 package org.apache.maven.surefire.its.jiras;
 
+import javax.xml.transform.Source;
+
+import org.apache.maven.surefire.its.fixture.OutputValidator;
 import org.apache.maven.surefire.its.fixture.SurefireJUnit4IntegrationTestCase;
+import org.apache.maven.surefire.its.fixture.TestFile;
+import org.hamcrest.collection.IsIterableWithSize;
 import org.junit.Test;
+import org.w3c.dom.Node;
+import org.xmlunit.builder.Input;
+import org.xmlunit.xpath.JAXPXPathEngine;
 
+import static org.hamcrest.MatcherAssert.assertThat;
 import static org.hamcrest.Matchers.containsString;
 import static org.hamcrest.Matchers.equalTo;
 
@@ -134,7 +143,7 @@ public void junit4Runner() {
 
     @Test
     public void junit5Suite() throws Exception {
-        unpack("junit5-suite")
+        OutputValidator outputValidator = unpack("junit5-suite")
                 .executeTest()
                 .verifyErrorFree(1)
                 .verifyTextInLog(
@@ -142,5 +151,15 @@ public void junit5Suite() throws Exception {
                 .verifyTextInLog("Running pkg.JUnit5Test")
                 .verifyTextInLog("Running pkg.domain.AxTest")
                 .assertThatLogLine(containsString("Running pkg.domain.BxTest"), equalTo(0));
+
+        TestFile xmlReportFile = outputValidator.getSurefireReportsXmlFile("TEST-pkg.JUnit5Tests.xml");
+        xmlReportFile.assertFileExists();
+
+        Source source = Input.fromFile(xmlReportFile.getFile()).build();
+        Iterable<Node> ite = new JAXPXPathEngine().selectNodes("//testcase", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+
+        ite = new JAXPXPathEngine().selectNodes("//testcase[@classname='pkg.domain.AxTest' and @name='test']", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
     }
 }
diff --git a/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire1914XmlReportingParameterizedTestIT.java b/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire1914XmlReportingParameterizedTestIT.java
index 07e75e439..16042f9b9 100644
--- a/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire1914XmlReportingParameterizedTestIT.java
+++ b/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire1914XmlReportingParameterizedTestIT.java
@@ -42,7 +42,7 @@ public class Surefire1914XmlReportingParameterizedTestIT extends SurefireJUnit4I
 
     @Parameters(name = "{0}")
     public static Iterable<?> junitJupiterVersions() {
-        return Arrays.asList("5.2.0", "5.8.2", "5.9.1");
+        return Arrays.asList("5.8.2", "5.9.1", "5.13.4");
     }
 
     @Test
diff --git a/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire2032NestedSkippedIT.java b/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire2032NestedSkippedIT.java
index 41de00419..43d36e809 100644
--- a/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire2032NestedSkippedIT.java
+++ b/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire2032NestedSkippedIT.java
@@ -18,15 +18,19 @@
  */
 package org.apache.maven.surefire.its.jiras;
 
-import java.util.Arrays;
-import java.util.List;
+import javax.xml.transform.Source;
 
 import org.apache.maven.surefire.its.fixture.OutputValidator;
 import org.apache.maven.surefire.its.fixture.SurefireJUnit4IntegrationTestCase;
+import org.apache.maven.surefire.its.fixture.TestFile;
+import org.hamcrest.MatcherAssert;
+import org.hamcrest.collection.IsIterableWithSize;
 import org.junit.Test;
+import org.w3c.dom.Node;
+import org.xmlunit.builder.Input;
+import org.xmlunit.xpath.JAXPXPathEngine;
 
-import static java.nio.charset.StandardCharsets.UTF_8;
-import static org.assertj.core.api.Assertions.assertThat;
+import static org.hamcrest.MatcherAssert.assertThat;
 
 /**
  * Integration Test for SUREFIRE-2032
@@ -38,33 +42,48 @@ public void testXmlReport() {
         OutputValidator validator =
                 unpack("surefire-2032-nested-test-class-skipped").executeTest().assertTestSuiteResults(4, 0, 0, 2);
 
-        String redXmlReport = validator
-                .getSurefireReportsFile("TEST-jira2032.DisabledNestedTest$RedTaggedEnabledTest.xml", UTF_8)
-                .readFileToString();
+        TestFile xmlReportFile = validator.getSurefireReportsXmlFile("TEST-jira2032.DisabledNestedTest.xml");
+        xmlReportFile.assertFileExists();
 
-        // Enabled nested subclass
-        List<String> redTestCaseResults = Arrays.asList(redXmlReport
-                .substring(redXmlReport.indexOf("<testcase "), redXmlReport.indexOf("</testsuite>"))
-                .split(".(?=<testcase )"));
+        Source source = Input.fromFile(xmlReportFile.getFile()).build();
 
-        assertThat(redTestCaseResults)
-                .hasSize(2)
-                .filteredOn(testCaseResult -> testCaseResult.contains("<skipped"))
-                .isEmpty();
+        Iterable<Node> ite = new JAXPXPathEngine().selectNodes("//testcase", source);
+        MatcherAssert.assertThat(ite, IsIterableWithSize.iterableWithSize(4));
 
-        // Disabled nested subclass
-        String orangeXmlReport = validator
-                .getSurefireReportsFile("TEST-jira2032.DisabledNestedTest$OrangeTaggedDisabledTest.xml", UTF_8)
-                .readFileToString();
+        ite = new JAXPXPathEngine()
+                .selectNodes(
+                        "//testcase[@name='test1' and @classname='jira2032.DisabledNestedTest$OrangeTaggedDisabledTest']",
+                        source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
 
-        List<String> orangeTestCaseResults = Arrays.asList(orangeXmlReport
-                .substring(orangeXmlReport.indexOf("<testcase "), orangeXmlReport.indexOf("</testsuite>"))
-                .split(".(?=<testcase )"));
+        ite = new JAXPXPathEngine()
+                .selectNodes(
+                        "//testcase[@name='test2' and @classname='jira2032.DisabledNestedTest$OrangeTaggedDisabledTest']",
+                        source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
 
-        assertThat(orangeTestCaseResults)
-                .hasSize(2)
-                .filteredOn(testCaseResult -> testCaseResult.contains("<skipped"))
-                .map(testCaseResult -> testCaseResult.substring(0, testCaseResult.indexOf("classname")))
-                .containsExactlyInAnyOrder("<testcase name=\"test1\" ", "<testcase name=\"test2\" ");
+        ite = new JAXPXPathEngine()
+                .selectNodes(
+                        "//testcase[@name='test1' and @classname='jira2032.DisabledNestedTest$OrangeTaggedDisabledTest']/skipped[@message='class jira2032.DisabledNestedTest$OrangeTaggedDisabledTest is @Disabled']",
+                        source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+
+        ite = new JAXPXPathEngine()
+                .selectNodes(
+                        "//testcase[@name='test2' and @classname='jira2032.DisabledNestedTest$OrangeTaggedDisabledTest']/skipped[@message='class jira2032.DisabledNestedTest$OrangeTaggedDisabledTest is @Disabled']",
+                        source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+
+        ite = new JAXPXPathEngine()
+                .selectNodes(
+                        "//testcase[@name='test1' and @classname='jira2032.DisabledNestedTest$RedTaggedEnabledTest']",
+                        source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+
+        ite = new JAXPXPathEngine()
+                .selectNodes(
+                        "//testcase[@name='test2' and @classname='jira2032.DisabledNestedTest$RedTaggedEnabledTest']",
+                        source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
     }
 }
diff --git a/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire2117XmlReportingNestedIT.java b/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire2117XmlReportingNestedIT.java
index 010748fdf..8fcfe0544 100644
--- a/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire2117XmlReportingNestedIT.java
+++ b/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire2117XmlReportingNestedIT.java
@@ -42,7 +42,7 @@ public class Surefire2117XmlReportingNestedIT extends SurefireJUnit4IntegrationT
 
     @Parameters(name = "{0}")
     public static Iterable<?> junitJupiterVersions() {
-        return Arrays.asList("5.2.0", "5.8.2", "5.9.1");
+        return Arrays.asList("5.8.2", "5.9.1", "5.13.4");
     }
 
     @Test
@@ -53,11 +53,11 @@ public void testXmlReport() {
                 .verifyErrorFree(9);
 
         validator
-                .getSurefireReportsFile("TEST-jira2117.NestedJupiterTest$A.xml", UTF_8)
+                .getSurefireReportsFile("TEST-jira2117.NestedJupiterTest.xml", UTF_8)
                 .assertContainsText("<testcase name=\"level1_test\" " + "classname=\"jira2117.NestedJupiterTest$A\"");
 
         validator
-                .getSurefireReportsFile("TEST-jira2117.NestedJupiterTest$B$C.xml", UTF_8)
+                .getSurefireReportsFile("TEST-jira2117.NestedJupiterTest.xml", UTF_8)
                 .assertContainsText("<testcase name=\"level2_test_nonparameterized\" "
                         + "classname=\"jira2117.NestedJupiterTest$B$C\"")
                 .assertContainsText("<testcase name=\"level2_test_parameterized(String)[1] paramValue1\" "
@@ -65,24 +65,19 @@ public void testXmlReport() {
                 .assertContainsText("<testcase name=\"level2_test_parameterized(String)[2] paramValue2\" "
                         + "classname=\"jira2117.NestedJupiterTest$B$C\"");
 
-        String expectedDisplayNameForNestedClassA =
-                String.join(" ", "Display name of the main test class", "Display name of level 1 nested class A");
+        String expectedDisplayNameForNestedClassA = "Display name of level 1 nested class A";
 
         validator
-                .getSurefireReportsFile("TEST-jira2117.NestedDisplayNameTest$A.xml", UTF_8)
+                .getSurefireReportsFile("TEST-jira2117.NestedDisplayNameTest.xml", UTF_8)
                 .assertContainsText("<testcase name=\"level1_test_without_display_name\" " + "classname=\""
                         + expectedDisplayNameForNestedClassA + "\"")
                 .assertContainsText("<testcase name=\"Display name of level 1 test method\" " + "classname=\""
                         + expectedDisplayNameForNestedClassA + "\"");
 
-        String expectedDisplayNameForNestedClassC = String.join(
-                " ",
-                "Display name of the main test class",
-                "Display name of level 1 nested class B",
-                "Display name of level 2 nested class C");
+        String expectedDisplayNameForNestedClassC = "Display name of level 2 nested class C";
 
         validator
-                .getSurefireReportsFile("TEST-jira2117.NestedDisplayNameTest$B$C.xml", UTF_8)
+                .getSurefireReportsFile("TEST-jira2117.NestedDisplayNameTest.xml", UTF_8)
                 .assertContainsText("<testcase name=\"Display name of non-parameterized level 2 test method\" "
                         + "classname=\"" + expectedDisplayNameForNestedClassC + "\"")
                 .assertContainsText(
diff --git a/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire2298IT.java b/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire2298IT.java
new file mode 100644
index 000000000..f3eebb378
--- /dev/null
+++ b/surefire-its/src/test/java/org/apache/maven/surefire/its/jiras/Surefire2298IT.java
@@ -0,0 +1,92 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *   http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+package org.apache.maven.surefire.its.jiras;
+
+import javax.xml.transform.Source;
+
+import org.apache.maven.surefire.its.fixture.OutputValidator;
+import org.apache.maven.surefire.its.fixture.SurefireJUnit4IntegrationTestCase;
+import org.apache.maven.surefire.its.fixture.TestFile;
+import org.hamcrest.collection.IsIterableWithSize;
+import org.junit.Before;
+import org.junit.Test;
+import org.w3c.dom.Node;
+import org.xmlunit.builder.Input;
+import org.xmlunit.xpath.JAXPXPathEngine;
+
+import static org.apache.maven.surefire.its.fixture.HelperAssertions.assumeJavaVersion;
+import static org.hamcrest.MatcherAssert.assertThat;
+
+/**
+ *
+ */
+@SuppressWarnings("checkstyle:magicnumber")
+public class Surefire2298IT extends SurefireJUnit4IntegrationTestCase {
+
+    @Before
+    public void setUp() {
+        assumeJavaVersion(17);
+    }
+
+    @Test
+    public void shouldNotCreateFilesForNested() throws Exception {
+        OutputValidator outputValidator = unpack("surefire-2298-nested-class")
+                .maven()
+                .executeTest()
+                .verifyTextInLog("BUILD SUCCESS")
+                .assertTestSuiteResults(4, 0, 0, 0);
+
+        outputValidator
+                .getSurefireReportsXmlFile("io.olamy.BaseNestedTest$Inner.txt")
+                .assertFileNotExists();
+
+        TestFile xmlReportFile = outputValidator.getSurefireReportsXmlFile("TEST-io.olamy.FirstNestedTest.xml");
+        xmlReportFile.assertFileExists();
+
+        /**
+         * <testsuite version="3.0.2" name="FirstNestedTest" time="0.019" tests="1" errors="0" skipped="0" failures="0">
+         * <testcase name="outerTest" classname="FirstNestedTest" time="0.007"/>
+         * <testcase name="innerTest" classname="BaseNestedTest$Inner" time="0.001"/>
+         * </testsuite>
+         **/
+        Source source = Input.fromFile(xmlReportFile.getFile()).build();
+        Iterable<Node> ite = new JAXPXPathEngine().selectNodes("//testcase", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(2));
+        ite = new JAXPXPathEngine().selectNodes("//testcase[@classname='io.olamy.FirstNestedTest']", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+        ite = new JAXPXPathEngine().selectNodes("//testcase[@classname='io.olamy.BaseNestedTest$Inner']", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+
+        xmlReportFile = outputValidator.getSurefireReportsXmlFile("TEST-io.olamy.SecondNestedTest.xml");
+        /**
+         * <testsuite  name="SecondNestedTest" time="0.003" tests="1" errors="0" skipped="0" failures="0">
+         * <testcase name="outerTest" classname="SecondNestedTest" time="0.001"/>
+         * <testcase name="innerTest" classname="BaseNestedTest$Inner" time="0.0"/>
+         * </testsuite>
+         */
+        source = Input.fromFile(xmlReportFile.getFile()).build();
+
+        ite = new JAXPXPathEngine().selectNodes("//testcase", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(2));
+        ite = new JAXPXPathEngine().selectNodes("//testcase[@classname='io.olamy.SecondNestedTest']", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+        ite = new JAXPXPathEngine().selectNodes("//testcase[@classname='io.olamy.BaseNestedTest$Inner']", source);
+        assertThat(ite, IsIterableWithSize.iterableWithSize(1));
+    }
+}
diff --git a/surefire-its/src/test/resources/archunit/pom.xml b/surefire-its/src/test/resources/archunit/pom.xml
new file mode 100644
index 000000000..e72331f8e
--- /dev/null
+++ b/surefire-its/src/test/resources/archunit/pom.xml
@@ -0,0 +1,45 @@
+<?xml version="1.0"?>
+<project xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 https://maven.apache.org/xsd/maven-4.0.0.xsd"
+         xmlns="http://maven.apache.org/POM/4.0.0">
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>custom</groupId>
+  <artifactId>surefire-test</artifactId>
+  <version>0.0.1</version>
+
+  <dependencies>
+    <dependency>
+      <groupId>com.tngtech.archunit</groupId>
+      <artifactId>archunit</artifactId>
+      <version>1.4.0</version>
+      <scope>test</scope>
+    </dependency>
+    <dependency>
+      <groupId>com.tngtech.archunit</groupId>
+      <artifactId>archunit-junit5</artifactId>
+      <version>1.4.0</version>
+      <scope>test</scope>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <pluginManagement>
+      <plugins>
+        <plugin>
+          <groupId>org.apache.maven.plugins</groupId>
+          <artifactId>maven-compiler-plugin</artifactId>
+          <version>3.14.0</version>
+        </plugin>
+      </plugins>
+    </pluginManagement>
+    <plugins>
+      <plugin>
+        <groupId>org.apache.maven.plugins</groupId>
+        <artifactId>maven-surefire-plugin</artifactId>
+        <version>${surefire.version}</version>
+      </plugin>
+    </plugins>
+  </build>
+
+</project>
diff --git a/surefire-its/src/test/resources/archunit/src/test/java/custom/ArchUnitTest.java b/surefire-its/src/test/resources/archunit/src/test/java/custom/ArchUnitTest.java
new file mode 100644
index 000000000..9b37031a9
--- /dev/null
+++ b/surefire-its/src/test/resources/archunit/src/test/java/custom/ArchUnitTest.java
@@ -0,0 +1,16 @@
+package custom;
+
+import com.tngtech.archunit.core.importer.ImportOption;
+import com.tngtech.archunit.junit.AnalyzeClasses;
+import com.tngtech.archunit.junit.ArchTest;
+import com.tngtech.archunit.lang.ArchRule;
+import com.tngtech.archunit.lang.syntax.ArchRuleDefinition;
+
+@AnalyzeClasses(packages = "custom", importOptions = ImportOption.DoNotIncludeTests.class)
+public class ArchUnitTest {
+
+    @ArchTest
+    public static final ArchRule DTO_IN_PACKAGE_DTO= ArchRuleDefinition.classes()
+        .that().haveSimpleNameEndingWith("DTO")
+        .should().resideInAPackage("..dto..");
+}
diff --git a/surefire-its/src/test/resources/archunit/src/test/java/custom/MyDTO.java b/surefire-its/src/test/resources/archunit/src/test/java/custom/MyDTO.java
new file mode 100644
index 000000000..d44339243
--- /dev/null
+++ b/surefire-its/src/test/resources/archunit/src/test/java/custom/MyDTO.java
@@ -0,0 +1,10 @@
+package custom;
+public class MyDTO {
+    private String param;
+    public String getParam() {
+        return param;
+    }
+    public void setParam(String param) {
+        this.param = param;
+    }
+}
diff --git a/surefire-its/src/test/resources/cucumber-tests/pom.xml b/surefire-its/src/test/resources/cucumber-tests/pom.xml
new file mode 100644
index 000000000..80099cf57
--- /dev/null
+++ b/surefire-its/src/test/resources/cucumber-tests/pom.xml
@@ -0,0 +1,79 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project xmlns="http://maven.apache.org/POM/4.0.0"
+         xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
+    <modelVersion>4.0.0</modelVersion>
+
+    <groupId>org.example</groupId>
+    <artifactId>cucumberSurefireBug</artifactId>
+    <version>1.0-SNAPSHOT</version>
+
+    <properties>
+        <maven.compiler.source>17</maven.compiler.source>
+        <maven.compiler.target>17</maven.compiler.target>
+        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
+    </properties>
+
+    <dependencyManagement>
+        <dependencies>
+            <dependency>
+                <groupId>org.junit</groupId>
+                <artifactId>junit-bom</artifactId>
+                <version>5.13.1</version>
+                <type>pom</type>
+                <scope>import</scope>
+            </dependency>
+            <dependency>
+                <groupId>io.cucumber</groupId>
+                <artifactId>cucumber-bom</artifactId>
+                <version>7.23.0</version>
+                <type>pom</type>
+                <scope>import</scope>
+            </dependency>
+        </dependencies>
+    </dependencyManagement>
+
+    <dependencies>
+        <dependency>
+            <groupId>org.junit.jupiter</groupId>
+            <artifactId>junit-jupiter</artifactId>
+            <scope>test</scope>
+        </dependency>
+        <dependency>
+            <groupId>org.junit.platform</groupId>
+            <artifactId>junit-platform-suite</artifactId>
+            <scope>test</scope>
+        </dependency>
+        <dependency>
+            <groupId>io.cucumber</groupId>
+            <artifactId>cucumber-java</artifactId>
+        </dependency>
+        <dependency>
+            <groupId>io.cucumber</groupId>
+            <artifactId>cucumber-junit-platform-engine</artifactId>
+            <scope>test</scope>
+        </dependency>
+    </dependencies>
+
+    <build>
+        <plugins>
+            <plugin>
+                <groupId>org.apache.maven.plugins</groupId>
+                <artifactId>maven-compiler-plugin</artifactId>
+                <version>3.14.0</version>
+            </plugin>
+            <plugin>
+                <groupId>org.apache.maven.plugins</groupId>
+                <artifactId>maven-surefire-plugin</artifactId>
+                <version>${surefire.version}</version>
+                <configuration>
+                    <properties>
+                        <configurationParameters>
+                            cucumber.junit-platform.naming-strategy=surefire
+                        </configurationParameters>
+                    </properties>
+                </configuration>
+            </plugin>
+        </plugins>
+    </build>
+</project>
diff --git a/surefire-its/src/test/resources/cucumber-tests/src/test/java/cz/fafejta/MySteps.java b/surefire-its/src/test/resources/cucumber-tests/src/test/java/cz/fafejta/MySteps.java
new file mode 100644
index 000000000..c856990ca
--- /dev/null
+++ b/surefire-its/src/test/resources/cucumber-tests/src/test/java/cz/fafejta/MySteps.java
@@ -0,0 +1,13 @@
+package cz.fafejta;
+
+import org.junit.jupiter.api.Assertions;
+
+import io.cucumber.java.en.Given;
+
+public class MySteps {
+
+    @Given("{int} plus {int} is {int}")
+    public void sumStep(int a, int b, int c) {
+        Assertions.assertEquals(c, a + b);
+    }
+}
diff --git a/surefire-its/src/test/resources/cucumber-tests/src/test/java/cz/fafejta/RunCucumberTest.java b/surefire-its/src/test/resources/cucumber-tests/src/test/java/cz/fafejta/RunCucumberTest.java
new file mode 100644
index 000000000..4a7922065
--- /dev/null
+++ b/surefire-its/src/test/resources/cucumber-tests/src/test/java/cz/fafejta/RunCucumberTest.java
@@ -0,0 +1,14 @@
+package cz.fafejta;
+
+import org.junit.platform.suite.api.*;
+
+import static io.cucumber.junit.platform.engine.Constants.GLUE_PROPERTY_NAME;
+import static io.cucumber.junit.platform.engine.Constants.JUNIT_PLATFORM_NAMING_STRATEGY_PROPERTY_NAME;
+
+@Suite
+@IncludeEngines("cucumber")
+@SelectPackages("cz.fafejta")
+@ConfigurationParameter(key = GLUE_PROPERTY_NAME, value = "cz.fafejta")
+@ConfigurationParameter(key = JUNIT_PLATFORM_NAMING_STRATEGY_PROPERTY_NAME, value = "long")
+public class RunCucumberTest {
+}
diff --git a/surefire-its/src/test/resources/cucumber-tests/src/test/java/cz/fafejta/SimpleTest.java b/surefire-its/src/test/resources/cucumber-tests/src/test/java/cz/fafejta/SimpleTest.java
new file mode 100644
index 000000000..faeea419c
--- /dev/null
+++ b/surefire-its/src/test/resources/cucumber-tests/src/test/java/cz/fafejta/SimpleTest.java
@@ -0,0 +1,13 @@
+package cz.fafejta;
+
+import org.junit.jupiter.api.Assertions;
+import org.junit.jupiter.api.Test;
+
+public class SimpleTest {
+
+    @Test
+    public void test() {
+        final String x = "";
+        Assertions.assertNotNull(x);
+    }
+}
diff --git a/surefire-its/src/test/resources/cucumber-tests/src/test/resources/cz/fafejta/sum.feature b/surefire-its/src/test/resources/cucumber-tests/src/test/resources/cz/fafejta/sum.feature
new file mode 100644
index 000000000..c30422922
--- /dev/null
+++ b/surefire-its/src/test/resources/cucumber-tests/src/test/resources/cz/fafejta/sum.feature
@@ -0,0 +1,7 @@
+Feature: Sum test
+
+  Scenario: Valid test
+    Given 10 plus 5 is 15
+
+  Scenario: Invalid test
+    Given 10 plus 5 is 11
diff --git a/surefire-its/src/test/resources/surefire-1643-parallel-junit5/pom.xml b/surefire-its/src/test/resources/surefire-1643-parallel-junit5/pom.xml
index 247569be6..b840f5f58 100644
--- a/surefire-its/src/test/resources/surefire-1643-parallel-junit5/pom.xml
+++ b/surefire-its/src/test/resources/surefire-1643-parallel-junit5/pom.xml
@@ -3,7 +3,7 @@
          xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
   <modelVersion>4.0.0</modelVersion>
   <groupId>org.apache.maven.plugins.surefire</groupId>
-  <artifactId>junit-platform-1.0.0</artifactId>
+  <artifactId>junit-platform-1.0.0-surefire-1643</artifactId>
   <version>1.0</version>
   <name>[SUREFIRE-1643] JUnit 5: Parallel Test mixed</name>
 
diff --git a/surefire-its/src/test/resources/surefire-2298-nested-class/pom.xml b/surefire-its/src/test/resources/surefire-2298-nested-class/pom.xml
new file mode 100644
index 000000000..d8b340cef
--- /dev/null
+++ b/surefire-its/src/test/resources/surefire-2298-nested-class/pom.xml
@@ -0,0 +1,67 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+  xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/xsd/maven-4.0.0.xsd">
+  <modelVersion>4.0.0</modelVersion>
+
+  <groupId>org.apache.maven.plugins.surefire</groupId>
+  <artifactId>junit-platform-1.0.0-surefire-2298</artifactId>
+  <version>1.0</version>
+  <name>[SUREFIRE-2298] JUnit 5: Nested class in report</name>
+
+
+  <properties>
+    <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
+    <maven.compiler.release>17</maven.compiler.release>
+  </properties>
+
+  <dependencyManagement>
+    <dependencies>
+      <dependency>
+        <groupId>org.junit</groupId>
+        <artifactId>junit-bom</artifactId>
+        <version>5.12.0</version>
+        <type>pom</type>
+        <scope>import</scope>
+      </dependency>
+    </dependencies>
+  </dependencyManagement>
+
+  <dependencies>
+    <dependency>
+      <groupId>org.junit.jupiter</groupId>
+      <artifactId>junit-jupiter-api</artifactId>
+      <scope>test</scope>
+    </dependency>
+    <!-- Optionally: parameterized tests support -->
+    <dependency>
+      <groupId>org.junit.jupiter</groupId>
+      <artifactId>junit-jupiter-params</artifactId>
+      <scope>test</scope>
+    </dependency>
+  </dependencies>
+
+  <build>
+    <pluginManagement><!-- lock down plugins versions to avoid using Maven defaults (may be moved to parent pom) -->
+      <plugins>
+        <!-- clean lifecycle, see https://maven.apache.org/ref/current/maven-core/lifecycles.html#clean_Lifecycle -->
+        <plugin>
+          <artifactId>maven-clean-plugin</artifactId>
+          <version>3.4.0</version>
+        </plugin>
+        <!-- default lifecycle, jar packaging: see https://maven.apache.org/ref/current/maven-core/default-bindings.html#Plugin_bindings_for_jar_packaging -->
+        <plugin>
+          <artifactId>maven-resources-plugin</artifactId>
+          <version>3.3.1</version>
+        </plugin>
+        <plugin>
+          <artifactId>maven-compiler-plugin</artifactId>
+          <version>3.13.0</version>
+        </plugin>
+        <plugin>
+          <artifactId>maven-surefire-plugin</artifactId>
+          <version>${surefire.version}</version>
+        </plugin>
+      </plugins>
+    </pluginManagement>
+  </build>
+</project>
diff --git a/surefire-its/src/test/resources/surefire-2298-nested-class/src/main/java/io/olamy/App.java b/surefire-its/src/test/resources/surefire-2298-nested-class/src/main/java/io/olamy/App.java
new file mode 100644
index 000000000..5354cd8a6
--- /dev/null
+++ b/surefire-its/src/test/resources/surefire-2298-nested-class/src/main/java/io/olamy/App.java
@@ -0,0 +1,10 @@
+package io.olamy;
+
+/**
+ * Hello world!
+ */
+public class App {
+    public static void main(String[] args) {
+        System.out.println("Hello World!");
+    }
+}
diff --git a/surefire-its/src/test/resources/surefire-2298-nested-class/src/test/java/io/olamy/BaseNestedTest.java b/surefire-its/src/test/resources/surefire-2298-nested-class/src/test/java/io/olamy/BaseNestedTest.java
new file mode 100644
index 000000000..362cd4014
--- /dev/null
+++ b/surefire-its/src/test/resources/surefire-2298-nested-class/src/test/java/io/olamy/BaseNestedTest.java
@@ -0,0 +1,23 @@
+package io.olamy;
+
+import org.junit.jupiter.api.*;
+
+abstract class BaseNestedTest {
+    @Test
+    void outerTest() {
+    }
+
+    @Nested
+    class Inner {
+
+        @Test
+        void innerTest() {
+        }
+    }
+}
+
+class FirstNestedTest extends BaseNestedTest {
+}
+
+class SecondNestedTest extends BaseNestedTest {
+}
diff --git a/surefire-providers/surefire-junit-platform/src/main/java/org/apache/maven/surefire/junitplatform/RunListenerAdapter.java b/surefire-providers/surefire-junit-platform/src/main/java/org/apache/maven/surefire/junitplatform/RunListenerAdapter.java
index 5cf7b066e..26f0e359b 100644
--- a/surefire-providers/surefire-junit-platform/src/main/java/org/apache/maven/surefire/junitplatform/RunListenerAdapter.java
+++ b/surefire-providers/surefire-junit-platform/src/main/java/org/apache/maven/surefire/junitplatform/RunListenerAdapter.java
@@ -18,8 +18,8 @@
  */
 package org.apache.maven.surefire.junitplatform;
 
-import java.util.Collections;
-import java.util.List;
+import java.lang.annotation.Annotation;
+import java.lang.reflect.Method;
 import java.util.Map;
 import java.util.Objects;
 import java.util.Optional;
@@ -36,11 +36,13 @@
 import org.apache.maven.surefire.api.report.TestOutputReceiver;
 import org.apache.maven.surefire.api.report.TestOutputReportEntry;
 import org.apache.maven.surefire.api.report.TestReportListener;
+import org.apache.maven.surefire.api.util.ReflectionUtils;
 import org.apache.maven.surefire.report.ClassMethodIndexer;
 import org.apache.maven.surefire.report.PojoStackTraceWriter;
 import org.apache.maven.surefire.report.RunModeSetter;
 import org.junit.platform.engine.TestExecutionResult;
 import org.junit.platform.engine.TestSource;
+import org.junit.platform.engine.UniqueId;
 import org.junit.platform.engine.support.descriptor.ClassSource;
 import org.junit.platform.engine.support.descriptor.MethodSource;
 import org.junit.platform.launcher.TestExecutionListener;
@@ -49,7 +51,6 @@
 
 import static java.util.Collections.emptyMap;
 import static java.util.stream.Collectors.joining;
-import static java.util.stream.Collectors.toList;
 import static org.apache.maven.surefire.api.util.internal.ObjectUtils.systemProps;
 import static org.apache.maven.surefire.shared.lang3.StringUtils.isNotBlank;
 import static org.junit.platform.engine.TestExecutionResult.Status.FAILED;
@@ -219,15 +220,23 @@ private SimpleReportEntry createReportEntry(
             Map<String, String> systemProperties,
             String reason,
             Integer elapsedTime) {
-        String[] classMethodName = toClassMethodName(testIdentifier);
-        String className = classMethodName[0];
-        String classText = classMethodName[1];
+        ResultDisplay classMethodName = toClassMethodName(testIdentifier);
+
+        String className = classMethodName.getClassName();
+
+        String classText = classMethodName.getDisplayName();
         if (Objects.equals(className, classText)) {
             classText = null;
         }
+        if (classMethodName.getClassDisplayName() != null) {
+            classText = classMethodName.getClassDisplayName();
+        }
+
+        // classText = classMethodName[0]; // testIdentifier.getLegacyReportingName();
+
         boolean failed = testExecutionResult == null || testExecutionResult.getStatus() == FAILED;
-        String methodName = failed || testIdentifier.isTest() ? classMethodName[2] : null;
-        String methodText = failed || testIdentifier.isTest() ? classMethodName[3] : null;
+        String methodName = failed || testIdentifier.isTest() ? classMethodName.getMethodSignature() : null;
+        String methodText = failed || testIdentifier.isTest() ? classMethodName.getMethodDisplayName() : null;
         if (Objects.equals(methodName, methodText)) {
             methodText = null;
         }
@@ -283,6 +292,55 @@ private StackTraceWriter toStackTraceWriter(String realClassName, String realMet
         return new PojoStackTraceWriter(realClassName, realMethodName, throwable);
     }
 
+    private TestIdentifier findTopParent(TestIdentifier testIdentifier) {
+        if (!hasParentId(testIdentifier)) {
+            return testIdentifier;
+        }
+        TestIdentifier parent =
+                // Get the parent test identifier using the parent ID object is from 1.10
+                // use deprecated method
+                testPlan.getTestIdentifier(
+                        testIdentifier.getParentIdObject().get().toString());
+        return !parent.getParentIdObject().isPresent() ? testIdentifier : findTopParent(parent);
+    }
+
+    /**
+     * Checks if the test identifier has a parent ID but using reflection as it's only available from 1.8
+     *
+     * @param testIdentifier the test identifier to check
+     * @return true if the test identifier has a parent ID, false otherwise
+     */
+    private boolean hasParentId(TestIdentifier testIdentifier) {
+        Method getParentIdObjectMethod = ReflectionUtils.tryGetMethod(testIdentifier.getClass(), "getParentIdObject");
+        if (getParentIdObjectMethod == null) {
+            return false;
+        }
+        try {
+            Optional<UniqueId> uniqueIdOptional = (Optional<UniqueId>) getParentIdObjectMethod.invoke(testIdentifier);
+            return uniqueIdOptional.isPresent();
+        } catch (Throwable ignore) {
+            // ignore this
+        }
+        return false;
+    }
+
+    private TestIdentifier findFirstParentContainerAndSourceClass(TestIdentifier testIdentifier) {
+        if (!hasParentId(testIdentifier)
+                || (testIdentifier.isContainer()
+                        && testIdentifier
+                                .getSource()
+                                .filter(ClassSource.class::isInstance)
+                                .isPresent())) {
+            return testIdentifier;
+        }
+        TestIdentifier parent =
+                // Get the parent test identifier using the parent ID object is from 1.10
+                // use deprecated method
+                testPlan.getTestIdentifier(
+                        testIdentifier.getParentIdObject().get().toString());
+        return findFirstParentContainerAndSourceClass(parent);
+    }
+
     /**
      * <ul>
      *     <li>[0] class name - used in stacktrace parser</li>
@@ -294,21 +352,39 @@ private StackTraceWriter toStackTraceWriter(String realClassName, String realMet
      * @param testIdentifier a class or method
      * @return 4 elements string array
      */
-    private String[] toClassMethodName(TestIdentifier testIdentifier) {
+    private ResultDisplay toClassMethodName(TestIdentifier testIdentifier) {
+
+        // find the first class or method source in the hierarchy just below the root level
+        // without parent and with ClassSource
+        Optional<String> classLevelName = Optional.empty();
+        TestIdentifier parent = findTopParent(testIdentifier);
+        if (parent != null
+                && parent.getSource().filter(ClassSource.class::isInstance).isPresent()) {
+            ClassSource classSource = (ClassSource) parent.getSource().get();
+            classLevelName = Optional.of(classSource.getClassName());
+        }
+
+        String classDisplayName = null;
+
+        if (testIdentifier.isTest()) {
+            TestIdentifier parentContainer = findFirstParentContainerAndSourceClass(testIdentifier);
+            Optional<String> parentDisplayNameTagValue = findDisplayNameTagValue(parentContainer);
+            classDisplayName = parentDisplayNameTagValue.orElse(parentContainer.getLegacyReportingName());
+        }
         Optional<TestSource> testSource = testIdentifier.getSource();
         String display = testIdentifier.getDisplayName();
 
         if (testSource.filter(MethodSource.class::isInstance).isPresent()) {
             MethodSource methodSource = testSource.map(MethodSource.class::cast).get();
             String realClassName = methodSource.getClassName();
-
-            String[] source = collectAllTestIdentifiersInHierarchy(testIdentifier)
+            ResultDisplay source = collectAllTestIdentifiersInHierarchy(testIdentifier)
                     .filter(i ->
                             i.getSource().map(ClassSource.class::isInstance).orElse(false))
                     .findFirst()
                     .map(this::toClassMethodName)
-                    .map(s -> new String[] {s[0], s[1]})
-                    .orElse(new String[] {realClassName, realClassName});
+                    .map(s -> new ResultDisplay(
+                            s.getClassName(), s.getDisplayName(), null, null, s.getClassDisplayName()))
+                    .orElse(new ResultDisplay(realClassName, realClassName, null, null, classDisplayName));
 
             String parentDisplay = collectAllTestIdentifiersInHierarchy(testIdentifier)
                     .filter(identifier -> identifier
@@ -351,30 +427,89 @@ private String[] toClassMethodName(TestIdentifier testIdentifier) {
             //     param     ||  m()[1]  | [1] <param>
             //  param+displ  ||  m()[1]  |   displ
 
-            return new String[] {source[0], source[1], methodDesc, methodDisp};
+            return new ResultDisplay(
+                    classLevelName.orElse(source.getClassName()),
+                    source.getDisplayName(),
+                    methodDesc,
+                    methodDisp,
+                    classDisplayName);
         } else if (testSource.filter(ClassSource.class::isInstance).isPresent()) {
-            List<String> parentClassDisplays = collectAllTestIdentifiersInHierarchy(testIdentifier)
-                    .filter(identifier -> identifier
-                            .getSource()
-                            .filter(ClassSource.class::isInstance)
-                            .isPresent())
-                    .map(TestIdentifier::getDisplayName)
-                    .collect(toList());
-
-            Collections.reverse(parentClassDisplays);
-            String classDisplay = Stream.concat(parentClassDisplays.stream(), Stream.of(display))
-                    .collect(joining(" "));
-
             ClassSource classSource = testSource.map(ClassSource.class::cast).get();
             String className = classSource.getClassName();
-            String simpleClassName = className.substring(1 + className.lastIndexOf('.'));
-            String source = classDisplay.replace(' ', '$').equals(simpleClassName) ? className : classDisplay;
-            return new String[] {className, source, null, null};
+            Optional<String> displayNameTagValue = findDisplayNameTagValue(testIdentifier);
+            return new ResultDisplay(
+                    classLevelName.orElse(className),
+                    displayNameTagValue.orElse(className),
+                    null,
+                    null,
+                    classDisplayName); // != null ? classDisplayName : className);
         } else {
             String source = testPlan.getParent(testIdentifier)
                     .map(TestIdentifier::getDisplayName)
                     .orElse(display);
-            return new String[] {source, source, display, display};
+            return new ResultDisplay(classLevelName.orElse(source), source, display, display, classDisplayName);
+        }
+    }
+
+    private Optional<String> findDisplayNameTagValue(TestIdentifier testIdentifier) {
+        try {
+            Class<? extends Annotation> displayNameClazz = (Class<? extends Annotation>)
+                    Thread.currentThread().getContextClassLoader().loadClass("org.junit.jupiter.api.DisplayName");
+            Optional<?> displayNameAnn = testIdentifier
+                    .getSource()
+                    .filter(ClassSource.class::isInstance)
+                    .map(s -> ((ClassSource) s).getJavaClass())
+                    .filter(m -> m.isAnnotationPresent(displayNameClazz))
+                    .map(method -> method.getAnnotation(displayNameClazz));
+
+            Method valueMethod = displayNameClazz.getMethod("value");
+            return displayNameAnn.map(a -> {
+                try {
+                    return (String) valueMethod.invoke(a);
+                } catch (Throwable e) {
+                    return null;
+                }
+            });
+        } catch (Exception e) {
+            // very old version of JUnit 5, may not have DisplayName annotation
+            return Optional.empty();
+        }
+    }
+
+    private static class ResultDisplay {
+        private String className, displayName, methodSignature, methodDisplayName, classDisplayName;
+
+        ResultDisplay(
+                String className,
+                String displayName,
+                String methodSignature,
+                String methodDisplayName,
+                String classDisplayName) {
+            this.className = className;
+            this.displayName = displayName;
+            this.methodSignature = methodSignature;
+            this.methodDisplayName = methodDisplayName;
+            this.classDisplayName = classDisplayName;
+        }
+
+        public String getClassName() {
+            return className;
+        }
+
+        public String getDisplayName() {
+            return displayName;
+        }
+
+        public String getMethodSignature() {
+            return methodSignature;
+        }
+
+        public String getMethodDisplayName() {
+            return methodDisplayName;
+        }
+
+        public String getClassDisplayName() {
+            return classDisplayName;
         }
     }
 
