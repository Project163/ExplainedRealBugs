diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/StartupReportConfiguration.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/StartupReportConfiguration.java
index d3cca28a9..28e7ff04f 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/StartupReportConfiguration.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/StartupReportConfiguration.java
@@ -19,13 +19,6 @@
  * under the License.
  */
 
-import java.io.File;
-import java.io.PrintStream;
-import java.util.List;
-import java.util.Map;
-import java.util.Properties;
-import java.util.concurrent.ConcurrentHashMap;
-
 import org.apache.maven.plugin.surefire.report.ConsoleOutputFileReporter;
 import org.apache.maven.plugin.surefire.report.DirectConsoleOutput;
 import org.apache.maven.plugin.surefire.report.FileReporter;
@@ -35,6 +28,11 @@
 import org.apache.maven.plugin.surefire.runorder.StatisticsReporter;
 
 import javax.annotation.Nonnull;
+import java.io.File;
+import java.io.PrintStream;
+import java.util.List;
+import java.util.Map;
+import java.util.concurrent.ConcurrentHashMap;
 
 import static org.apache.maven.plugin.surefire.report.ConsoleReporter.BRIEF;
 import static org.apache.maven.plugin.surefire.report.ConsoleReporter.PLAIN;
@@ -79,8 +77,6 @@ public final class StartupReportConfiguration
 
     private final String xsdSchemaLocation;
 
-    private final Properties testVmSystemProperties = new Properties();
-
     private final Map<String, Map<String, List<WrappedReportEntry>>> testClassMethodRunHistory
         = new ConcurrentHashMap<String, Map<String, List<WrappedReportEntry>>>();
 
@@ -217,11 +213,6 @@ public File getStatisticsFile()
         return statisticsFile;
     }
 
-    public Properties getTestVmSystemProperties()
-    {
-        return testVmSystemProperties;
-    }
-
     public boolean isTrimStackTrace()
     {
         return trimStackTrace;
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/ForkConfiguration.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/ForkConfiguration.java
index 8ff676886..cd4ae2ba9 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/ForkConfiguration.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/ForkConfiguration.java
@@ -21,7 +21,7 @@
 
 import org.apache.maven.plugin.surefire.AbstractSurefireMojo;
 import org.apache.maven.plugin.surefire.booterclient.lazytestprovider.OutputStreamFlushableCommandline;
-import org.apache.maven.plugin.surefire.util.ImmutableMap;
+import org.apache.maven.surefire.util.internal.ImmutableMap;
 import org.apache.maven.plugin.surefire.util.Relocator;
 import org.apache.maven.shared.utils.StringUtils;
 import org.apache.maven.surefire.booter.Classpath;
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/ForkStarter.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/ForkStarter.java
index 7619d0b63..a2a5095c3 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/ForkStarter.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/ForkStarter.java
@@ -57,7 +57,6 @@
 import java.util.ArrayList;
 import java.util.Collection;
 import java.util.Map;
-import java.util.Properties;
 import java.util.Queue;
 import java.util.concurrent.ArrayBlockingQueue;
 import java.util.concurrent.Callable;
@@ -270,8 +269,7 @@ private RunResult run( SurefireProperties effectiveSystemProperties, Map<String,
         TestLessInputStreamBuilder builder = new TestLessInputStreamBuilder();
         PropertiesWrapper props = new PropertiesWrapper( providerProperties );
         TestLessInputStream stream = builder.build();
-        Properties sysProps = startupReportConfiguration.getTestVmSystemProperties();
-        ForkClient forkClient = new ForkClient( forkedReporterFactory, sysProps, stream, log );
+        ForkClient forkClient = new ForkClient( forkedReporterFactory, stream, log );
         Thread shutdown = createImmediateShutdownHookThread( builder, providerConfiguration.getShutdown() );
         ScheduledFuture<?> ping = triggerPingTimerForShutdown( builder );
         try
@@ -347,10 +345,7 @@ public RunResult call()
                     {
                         DefaultReporterFactory reporter = new DefaultReporterFactory( startupReportConfiguration, log );
                         defaultReporterFactories.add( reporter );
-
-                        Properties vmProps = startupReportConfiguration.getTestVmSystemProperties();
-
-                        ForkClient forkClient = new ForkClient( reporter, vmProps, testProvidingInputStream, log )
+                        ForkClient forkClient = new ForkClient( reporter, testProvidingInputStream, log )
                         {
                             @Override
                             protected void stopOnNextTest()
@@ -413,9 +408,8 @@ public RunResult call()
                         DefaultReporterFactory forkedReporterFactory =
                             new DefaultReporterFactory( startupReportConfiguration, log );
                         defaultReporterFactories.add( forkedReporterFactory );
-                        Properties vmProps = startupReportConfiguration.getTestVmSystemProperties();
-                        ForkClient forkClient = new ForkClient( forkedReporterFactory, vmProps,
-                                                                      builder.getImmediateCommands(), log )
+                        ForkClient forkClient =
+                                new ForkClient( forkedReporterFactory, builder.getImmediateCommands(), log )
                         {
                             @Override
                             protected void stopOnNextTest()
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/output/ForkClient.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/output/ForkClient.java
index b94fba6a8..17da4df09 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/output/ForkClient.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/booterclient/output/ForkClient.java
@@ -27,22 +27,26 @@
 import org.apache.maven.surefire.report.ReportEntry;
 import org.apache.maven.surefire.report.RunListener;
 import org.apache.maven.surefire.report.StackTraceWriter;
+import org.apache.maven.surefire.report.TestSetReportEntry;
 
 import java.io.BufferedReader;
 import java.io.File;
 import java.io.IOException;
 import java.io.StringReader;
 import java.nio.ByteBuffer;
-import java.util.Properties;
+import java.util.Collections;
+import java.util.Map;
 import java.util.Queue;
 import java.util.Set;
 import java.util.StringTokenizer;
 import java.util.TreeSet;
+import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.ConcurrentLinkedQueue;
 import java.util.concurrent.atomic.AtomicLong;
 
 import static java.lang.Integer.decode;
 import static java.lang.System.currentTimeMillis;
+import static java.util.Collections.unmodifiableMap;
 import static org.apache.maven.surefire.booter.ForkingRunListener.BOOTERCODE_BYE;
 import static org.apache.maven.surefire.booter.ForkingRunListener.BOOTERCODE_CONSOLE;
 import static org.apache.maven.surefire.booter.ForkingRunListener.BOOTERCODE_DEBUG;
@@ -83,7 +87,7 @@ public class ForkClient
 
     private final DefaultReporterFactory defaultReporterFactory;
 
-    private final Properties testVmSystemProperties;
+    private final Map<String, String> testVmSystemProperties = new ConcurrentHashMap<String, String>();
 
     private final NotifiableTestStream notifiableTestStream;
 
@@ -108,11 +112,10 @@ public class ForkClient
     // prevents from printing same warning
     private boolean printedErrorStream;
 
-    public ForkClient( DefaultReporterFactory defaultReporterFactory, Properties testVmSystemProperties,
+    public ForkClient( DefaultReporterFactory defaultReporterFactory,
                        NotifiableTestStream notifiableTestStream, ConsoleLogger log )
     {
         this.defaultReporterFactory = defaultReporterFactory;
-        this.testVmSystemProperties = testVmSystemProperties;
         this.notifiableTestStream = notifiableTestStream;
         this.log = log;
     }
@@ -210,7 +213,7 @@ private void processLine( String event )
             case BOOTERCODE_TESTSET_COMPLETED:
                 testsInProgress.clear();
 
-                getTestSetReporter().testSetCompleted( createReportEntry( remaining ) );
+                getTestSetReporter().testSetCompleted( createReportEntry( remaining, testVmSystemProperties ) );
                 break;
             case BOOTERCODE_TEST_STARTING:
                 ReportEntry reportEntry = createReportEntry( remaining );
@@ -254,10 +257,7 @@ private void processLine( String event )
                 StringBuilder value = new StringBuilder();
                 unescapeString( key, remaining.substring( 0, keyEnd ) );
                 unescapeString( value, remaining.substring( keyEnd + 1 ) );
-                synchronized ( testVmSystemProperties )
-                {
-                    testVmSystemProperties.put( key.toString(), value.toString() );
-                }
+                testVmSystemProperties.put( key.toString(), value.toString() );
                 break;
             case BOOTERCODE_STDOUT:
                 writeTestOutput( remaining, true );
@@ -360,7 +360,12 @@ private String createConsoleMessage( String remaining )
         return unescape( remaining );
     }
 
-    private ReportEntry createReportEntry( String untokenized )
+    private TestSetReportEntry createReportEntry( String untokenized )
+    {
+        return createReportEntry( untokenized, Collections.<String, String>emptyMap() );
+    }
+
+    private TestSetReportEntry createReportEntry( String untokenized, Map<String, String> systemProperties )
     {
         StringTokenizer tokens = new StringTokenizer( untokenized, "," );
         try
@@ -374,7 +379,7 @@ private ReportEntry createReportEntry( String untokenized )
             final StackTraceWriter stackTraceWriter =
                     tokens.hasMoreTokens() ? deserializeStackTraceWriter( tokens ) : null;
 
-            return reportEntry( source, name, group, stackTraceWriter, elapsed, message );
+            return reportEntry( source, name, group, stackTraceWriter, elapsed, message, systemProperties );
         }
         catch ( RuntimeException e )
         {
@@ -403,6 +408,11 @@ private String unescape( String source )
         return stringBuffer.toString();
     }
 
+    public final Map<String, String> getTestVmSystemProperties()
+    {
+        return unmodifiableMap( testVmSystemProperties );
+    }
+
     /**
      * Used when getting reporters on the plugin side of a fork.
      * Used by testing purposes only. May not be volatile variable.
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
index aa858f26c..60c6dfe37 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
@@ -39,7 +39,7 @@
 import java.util.LinkedHashMap;
 import java.util.List;
 import java.util.Map;
-import java.util.Properties;
+import java.util.Map.Entry;
 import java.util.StringTokenizer;
 
 import static org.apache.maven.plugin.surefire.report.DefaultReporterFactory.TestResultType;
@@ -131,10 +131,10 @@ public void testSetCompleted( WrappedReportEntry testSetReportEntry, TestSetStat
 
             createTestSuiteElement( ppw, testSetReportEntry, testSetStats, testSetReportEntry.elapsedTimeAsString() );
 
-            showProperties( ppw );
+            showProperties( ppw, testSetReportEntry.getSystemProperties() );
 
             // Iterate through all the test methods in the test class
-            for ( Map.Entry<String, List<WrappedReportEntry>> entry : methodRunHistoryMap.entrySet() )
+            for ( Entry<String, List<WrappedReportEntry>> entry : methodRunHistoryMap.entrySet() )
             {
                 List<WrappedReportEntry> methodEntryList = entry.getValue();
                 if ( methodEntryList == null )
@@ -458,31 +458,26 @@ private static void addOutputStreamElement( OutputStreamWriter outputStreamWrite
      *
      * @param xmlWriter The test suite to report to
      */
-    private static void showProperties( XMLWriter xmlWriter )
+    private static void showProperties( XMLWriter xmlWriter, Map<String, String> systemProperties )
     {
         xmlWriter.startElement( "properties" );
-
-        Properties systemProperties = System.getProperties();
-
-        if ( systemProperties != null )
+        for ( final Entry<String, String> entry : systemProperties.entrySet() )
         {
-            for ( final String key : systemProperties.stringPropertyNames() )
-            {
-                String value = systemProperties.getProperty( key );
+            final String key = entry.getKey();
+            String value = entry.getValue();
 
-                if ( value == null )
-                {
-                    value = "null";
-                }
+            if ( value == null )
+            {
+                value = "null";
+            }
 
-                xmlWriter.startElement( "property" );
+            xmlWriter.startElement( "property" );
 
-                xmlWriter.addAttribute( "name", key );
+            xmlWriter.addAttribute( "name", key );
 
-                xmlWriter.addAttribute( "value", extraEscape( value, true ) );
+            xmlWriter.addAttribute( "value", extraEscape( value, true ) );
 
-                xmlWriter.endElement();
-            }
+            xmlWriter.endElement();
         }
         xmlWriter.endElement();
     }
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetRunListener.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetRunListener.java
index eea8a7e33..e10b8e829 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetRunListener.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetRunListener.java
@@ -29,6 +29,7 @@
 import org.apache.maven.surefire.report.ConsoleOutputReceiver;
 import org.apache.maven.surefire.report.ReportEntry;
 import org.apache.maven.surefire.report.RunListener;
+import org.apache.maven.surefire.report.TestSetReportEntry;
 
 import static org.apache.maven.plugin.surefire.report.ReportEntryType.ERROR;
 import static org.apache.maven.plugin.surefire.report.ReportEntryType.FAILURE;
@@ -144,7 +145,7 @@ public void writeTestOutput( byte[] buf, int off, int len, boolean stdout )
     }
 
     @Override
-    public void testSetStarting( ReportEntry report )
+    public void testSetStarting( TestSetReportEntry report )
     {
         detailsForThis.testSetStart();
         consoleReporter.testSetStarting( report );
@@ -158,7 +159,7 @@ public void clearCapture()
     }
 
     @Override
-    public void testSetCompleted( ReportEntry report )
+    public void testSetCompleted( TestSetReportEntry report )
     {
         final WrappedReportEntry wrap = wrapTestSet( report );
         final List<String> testResults =
@@ -262,11 +263,11 @@ private WrappedReportEntry wrap( ReportEntry other, ReportEntryType reportEntryT
         return new WrappedReportEntry( other, reportEntryType, estimatedElapsed, testStdOut, testStdErr );
     }
 
-    private WrappedReportEntry wrapTestSet( ReportEntry other )
+    private WrappedReportEntry wrapTestSet( TestSetReportEntry other )
     {
         return new WrappedReportEntry( other, null, other.getElapsed() != null
             ? other.getElapsed()
-            : detailsForThis.getElapsedSinceTestSetStart(), testStdOut, testStdErr );
+            : detailsForThis.getElapsedSinceTestSetStart(), testStdOut, testStdErr, other.getSystemProperties() );
     }
 
     public void close()
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/WrappedReportEntry.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/WrappedReportEntry.java
index 439fdec2e..402fda0fb 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/WrappedReportEntry.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/WrappedReportEntry.java
@@ -21,14 +21,19 @@
 
 import org.apache.maven.surefire.report.ReportEntry;
 import org.apache.maven.surefire.report.StackTraceWriter;
+import org.apache.maven.surefire.report.TestSetReportEntry;
 
+import java.util.Collections;
+import java.util.Map;
+
+import static java.util.Collections.unmodifiableMap;
 import static org.apache.maven.surefire.util.internal.StringUtils.NL;
 
 /**
  * @author Kristian Rosenvold
  */
 public class WrappedReportEntry
-    implements ReportEntry
+    implements TestSetReportEntry
 {
     private final ReportEntry original;
 
@@ -40,15 +45,26 @@ public class WrappedReportEntry
 
     private final Utf8RecodingDeferredFileOutputStream stdErr;
 
+    private final Map<String, String> systemProperties;
+
     public WrappedReportEntry( ReportEntry original, ReportEntryType reportEntryType, Integer estimatedElapsed,
                                Utf8RecodingDeferredFileOutputStream stdout,
-                               Utf8RecodingDeferredFileOutputStream stdErr )
+                               Utf8RecodingDeferredFileOutputStream stdErr,
+                               Map<String, String> systemProperties )
     {
         this.original = original;
         this.reportEntryType = reportEntryType;
         this.elapsed = estimatedElapsed;
         this.stdout = stdout;
         this.stdErr = stdErr;
+        this.systemProperties = unmodifiableMap( systemProperties );
+    }
+
+    public WrappedReportEntry( ReportEntry original, ReportEntryType reportEntryType, Integer estimatedElapsed,
+                               Utf8RecodingDeferredFileOutputStream stdout,
+                               Utf8RecodingDeferredFileOutputStream stdErr )
+    {
+        this( original, reportEntryType, estimatedElapsed, stdout, stdErr, Collections.<String, String>emptyMap() );
     }
 
     @Override
@@ -171,4 +187,10 @@ public String getNameWithGroup()
     {
         return original.getNameWithGroup();
     }
+
+    @Override
+    public Map<String, String> getSystemProperties()
+    {
+        return systemProperties;
+    }
 }
diff --git a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/booterclient/ForkingRunListenerTest.java b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/booterclient/ForkingRunListenerTest.java
index 19356f59e..12b20872c 100644
--- a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/booterclient/ForkingRunListenerTest.java
+++ b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/booterclient/ForkingRunListenerTest.java
@@ -34,16 +34,16 @@
 import org.apache.maven.surefire.report.RunListener;
 import org.apache.maven.surefire.report.SimpleReportEntry;
 import org.apache.maven.surefire.report.StackTraceWriter;
+import org.apache.maven.surefire.report.TestSetReportEntry;
+import org.hamcrest.MatcherAssert;
 
 import java.io.ByteArrayOutputStream;
 import java.io.IOException;
 import java.io.PrintStream;
 import java.nio.charset.Charset;
 import java.util.List;
-import java.util.Properties;
 import java.util.StringTokenizer;
 
-import static org.hamcrest.MatcherAssert.assertThat;
 import static org.hamcrest.Matchers.greaterThan;
 import static org.hamcrest.Matchers.is;
 
@@ -94,7 +94,7 @@ public void testSetStarting()
         throws ReporterException, IOException
     {
         final StandardTestRun standardTestRun = new StandardTestRun();
-        ReportEntry expected = createDefaultReportEntry();
+        TestSetReportEntry expected = createDefaultReportEntry();
         standardTestRun.run().testSetStarting( expected );
         standardTestRun.assertExpected( MockReporter.SET_STARTING, expected );
     }
@@ -103,7 +103,7 @@ public void testSetCompleted()
         throws ReporterException, IOException
     {
         final StandardTestRun standardTestRun = new StandardTestRun();
-        ReportEntry expected = createDefaultReportEntry();
+        TestSetReportEntry expected = createDefaultReportEntry();
         standardTestRun.run().testSetCompleted( expected );
         standardTestRun.assertExpected( MockReporter.SET_COMPLETED, expected );
     }
@@ -221,27 +221,24 @@ public void testSystemProperties()
         createForkingRunListener( defaultChannel );
 
         TestSetMockReporterFactory providerReporterFactory = new TestSetMockReporterFactory();
-        final Properties testVmSystemProperties = new Properties();
         NullConsoleLogger log = new NullConsoleLogger();
-        ForkClient forkStreamClient = new ForkClient( providerReporterFactory, testVmSystemProperties,
-                                                      new MockNotifiableTestStream(), log );
+        ForkClient forkStreamClient = new ForkClient( providerReporterFactory, new MockNotifiableTestStream(), log );
 
-        forkStreamClient.consumeMultiLineContent( content.toString( "utf-8" ) );
+        forkStreamClient.consumeMultiLineContent( content.toString( "UTF-8" ) );
 
-        assertThat( testVmSystemProperties.size(), is( greaterThan( 1 ) ) );
+        MatcherAssert.assertThat( forkStreamClient.getTestVmSystemProperties().size(), is( greaterThan( 1 ) ) );
     }
 
     public void testMultipleEntries()
         throws ReporterException, IOException
     {
-
         final StandardTestRun standardTestRun = new StandardTestRun();
         standardTestRun.run();
 
         reset();
         RunListener forkingReporter = createForkingRunListener( defaultChannel );
 
-        ReportEntry reportEntry = createDefaultReportEntry();
+        TestSetReportEntry reportEntry = createDefaultReportEntry();
         forkingReporter.testSetStarting( reportEntry );
         forkingReporter.testStarting( reportEntry );
         forkingReporter.testSucceeded( reportEntry );
@@ -249,10 +246,9 @@ public void testMultipleEntries()
 
         TestSetMockReporterFactory providerReporterFactory = new TestSetMockReporterFactory();
         NullConsoleLogger log = new NullConsoleLogger();
-        ForkClient forkStreamClient = new ForkClient( providerReporterFactory, new Properties(),
-                                                      new MockNotifiableTestStream(), log );
+        ForkClient forkStreamClient = new ForkClient( providerReporterFactory, new MockNotifiableTestStream(), log );
 
-        forkStreamClient.consumeMultiLineContent( content.toString( "utf-8" ) );
+        forkStreamClient.consumeMultiLineContent( content.toString( "UTF-8" ) );
 
         final MockReporter reporter = (MockReporter) forkStreamClient.getReporter();
         final List<String> events = reporter.getEvents();
@@ -276,20 +272,19 @@ public void test2DifferentChannels()
                 .testSkipped( secondExpected );
 
         TestSetMockReporterFactory providerReporterFactory = new TestSetMockReporterFactory();
-        Properties vmProps = new Properties();
         NotifiableTestStream notifiableTestStream = new MockNotifiableTestStream();
         NullConsoleLogger log = new NullConsoleLogger();
 
-        ForkClient forkStreamClient = new ForkClient( providerReporterFactory, vmProps, notifiableTestStream, log );
-        forkStreamClient.consumeMultiLineContent( content.toString( "utf-8" ) );
+        ForkClient forkStreamClient = new ForkClient( providerReporterFactory, notifiableTestStream, log );
+        forkStreamClient.consumeMultiLineContent( content.toString( "UTF-8" ) );
 
         MockReporter reporter = (MockReporter) forkStreamClient.getReporter();
         Assert.assertEquals( MockReporter.TEST_STARTING, reporter.getFirstEvent() );
         Assert.assertEquals( expected, reporter.getFirstData() );
         Assert.assertEquals( 1, reporter.getEvents().size() );
 
-        forkStreamClient = new ForkClient( providerReporterFactory, vmProps, notifiableTestStream, log );
-        forkStreamClient.consumeMultiLineContent( anotherContent.toString( "utf-8" ) );
+        forkStreamClient = new ForkClient( providerReporterFactory, notifiableTestStream, log );
+        forkStreamClient.consumeMultiLineContent( anotherContent.toString( "UTF-8" ) );
         MockReporter reporter2 = (MockReporter) forkStreamClient.getReporter();
         Assert.assertEquals( MockReporter.TEST_SKIPPED, reporter2.getFirstEvent() );
         Assert.assertEquals( secondExpected, reporter2.getFirstData() );
@@ -357,7 +352,7 @@ public void clientReceiveContent()
         {
             TestSetMockReporterFactory providerReporterFactory = new TestSetMockReporterFactory();
             NullConsoleLogger log = new NullConsoleLogger();
-            final ForkClient forkStreamClient = new ForkClient( providerReporterFactory, new Properties(),
+            final ForkClient forkStreamClient = new ForkClient( providerReporterFactory,
                                                                 new MockNotifiableTestStream(), log );
             forkStreamClient.consumeMultiLineContent( content.toString( ) );
             reporter = (MockReporter) forkStreamClient.getReporter();
diff --git a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/booterclient/MockReporter.java b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/booterclient/MockReporter.java
index bfc8faf2d..150d44331 100644
--- a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/booterclient/MockReporter.java
+++ b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/booterclient/MockReporter.java
@@ -19,13 +19,15 @@
  * under the License.
  */
 
-import java.util.ArrayList;
-import java.util.List;
-import java.util.concurrent.atomic.AtomicInteger;
 import org.apache.maven.plugin.surefire.log.api.ConsoleLogger;
 import org.apache.maven.surefire.report.ConsoleOutputReceiver;
 import org.apache.maven.surefire.report.ReportEntry;
 import org.apache.maven.surefire.report.RunListener;
+import org.apache.maven.surefire.report.TestSetReportEntry;
+
+import java.util.ArrayList;
+import java.util.List;
+import java.util.concurrent.atomic.AtomicInteger;
 
 /**
  * Internal tests use only.
@@ -66,14 +68,14 @@ public class MockReporter
     private final AtomicInteger testFailed = new AtomicInteger();
 
     @Override
-    public void testSetStarting( ReportEntry report )
+    public void testSetStarting( TestSetReportEntry report )
     {
         events.add( SET_STARTING );
         data.add( report );
     }
 
     @Override
-    public void testSetCompleted( ReportEntry report )
+    public void testSetCompleted( TestSetReportEntry report )
     {
         events.add( SET_COMPLETED );
         data.add( report );
diff --git a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporterTest.java b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporterTest.java
index c5b7a1e4e..445eaa826 100644
--- a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporterTest.java
+++ b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporterTest.java
@@ -38,6 +38,7 @@
 import java.util.concurrent.ConcurrentHashMap;
 import java.util.concurrent.atomic.AtomicInteger;
 
+import static org.apache.maven.surefire.util.internal.ObjectUtils.systemProps;
 import static org.apache.maven.surefire.util.internal.StringUtils.UTF_8;
 
 @SuppressWarnings( "ResultOfMethodCallIgnored" )
@@ -90,7 +91,7 @@ public void testFileNameWithoutSuffix()
 
         ReportEntry reportEntry = new SimpleReportEntry( getClass().getName(), getClass().getName(), 12 );
         WrappedReportEntry testSetReportEntry =
-            new WrappedReportEntry( reportEntry, ReportEntryType.SUCCESS, 12, null, null );
+            new WrappedReportEntry( reportEntry, ReportEntryType.SUCCESS, 12, null, null, systemProps() );
         stats.testSucceeded( testSetReportEntry );
         reporter.testSetCompleted( testSetReportEntry, stats );
 
@@ -105,7 +106,7 @@ public void testAllFieldsSerialized()
     {
         ReportEntry reportEntry = new SimpleReportEntry( getClass().getName(), TEST_ONE, 12 );
         WrappedReportEntry testSetReportEntry =
-            new WrappedReportEntry( reportEntry, ReportEntryType.SUCCESS, 12, null, null );
+            new WrappedReportEntry( reportEntry, ReportEntryType.SUCCESS, 12, null, null, systemProps() );
         expectedReportFile = new File( reportDir, "TEST-" + TEST_ONE + ".xml" );
 
         stats.testSucceeded( testSetReportEntry );
@@ -177,7 +178,7 @@ public void testOutputRerunFlakyFailure()
         ReportEntry reportEntry = new SimpleReportEntry( getClass().getName(), TEST_ONE, 12 );
 
         WrappedReportEntry testSetReportEntry =
-            new WrappedReportEntry( reportEntry, ReportEntryType.SUCCESS, 12, null, null );
+            new WrappedReportEntry( reportEntry, ReportEntryType.SUCCESS, 12, null, null, systemProps() );
         expectedReportFile = new File( reportDir, "TEST-" + TEST_ONE + ".xml" );
 
         stats.testSucceeded( testSetReportEntry );
@@ -294,5 +295,4 @@ class Inner
     {
 
     }
-
 }
diff --git a/maven-surefire-common/src/test/java/org/apache/maven/surefire/JUnit4SuiteTest.java b/maven-surefire-common/src/test/java/org/apache/maven/surefire/JUnit4SuiteTest.java
index 9fb45bfe2..f7cec19fd 100644
--- a/maven-surefire-common/src/test/java/org/apache/maven/surefire/JUnit4SuiteTest.java
+++ b/maven-surefire-common/src/test/java/org/apache/maven/surefire/JUnit4SuiteTest.java
@@ -36,7 +36,6 @@
 import org.apache.maven.plugin.surefire.runorder.RunEntryStatisticsMapTest;
 import org.apache.maven.plugin.surefire.util.DependenciesScannerTest;
 import org.apache.maven.plugin.surefire.util.DirectoryScannerTest;
-import org.apache.maven.plugin.surefire.util.ImmutableMapTest;
 import org.apache.maven.plugin.surefire.util.SpecificFileFilterTest;
 import org.apache.maven.surefire.report.ConsoleOutputFileReporterTest;
 import org.apache.maven.surefire.report.FileReporterTest;
@@ -73,8 +72,7 @@
     TestLessInputStreamBuilderTest.class,
     SPITest.class,
     SurefireReflectorTest.class,
-    ImmutableMapTest.class,
-    SurefireHelperTest.class,
+    SurefireHelperTest.class
 } )
 @RunWith( Suite.class )
 public class JUnit4SuiteTest
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/booter/ForkingRunListener.java b/surefire-api/src/main/java/org/apache/maven/surefire/booter/ForkingRunListener.java
index d2c112b3d..55395c05d 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/booter/ForkingRunListener.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/booter/ForkingRunListener.java
@@ -19,9 +19,6 @@
  * under the License.
  */
 
-import java.io.PrintStream;
-import java.util.Properties;
-
 import org.apache.maven.plugin.surefire.log.api.ConsoleLogger;
 import org.apache.maven.plugin.surefire.log.api.ConsoleLoggerUtils;
 import org.apache.maven.surefire.report.ConsoleOutputReceiver;
@@ -31,9 +28,15 @@
 import org.apache.maven.surefire.report.SafeThrowable;
 import org.apache.maven.surefire.report.SimpleReportEntry;
 import org.apache.maven.surefire.report.StackTraceWriter;
+import org.apache.maven.surefire.report.TestSetReportEntry;
+
+import java.io.PrintStream;
+import java.util.Map.Entry;
 
 import static java.lang.Integer.toHexString;
 import static java.nio.charset.Charset.defaultCharset;
+import static org.apache.maven.surefire.util.internal.ObjectUtils.systemProps;
+import static org.apache.maven.surefire.util.internal.ObjectUtils.useNonNull;
 import static org.apache.maven.surefire.util.internal.StringUtils.encodeStringForForkCommunication;
 import static org.apache.maven.surefire.util.internal.StringUtils.escapeBytesToPrintable;
 import static org.apache.maven.surefire.util.internal.StringUtils.escapeToPrintable;
@@ -132,13 +135,13 @@ public ForkingRunListener( PrintStream target, int testSetChannelId, boolean tri
     }
 
     @Override
-    public void testSetStarting( ReportEntry report )
+    public void testSetStarting( TestSetReportEntry report )
     {
         encodeAndWriteToTarget( toString( BOOTERCODE_TESTSET_STARTING, report, testSetChannelId ) );
     }
 
     @Override
-    public void testSetCompleted( ReportEntry report )
+    public void testSetCompleted( TestSetReportEntry report )
     {
         encodeAndWriteToTarget( toString( BOOTERCODE_TESTSET_COMPLETED, report, testSetChannelId ) );
     }
@@ -187,15 +190,10 @@ public void testExecutionSkippedByUser()
 
     void sendProps()
     {
-        Properties systemProperties = System.getProperties();
-
-        if ( systemProperties != null )
+        for ( Entry<String, String> entry : systemProps().entrySet() )
         {
-            for ( final String key : systemProperties.stringPropertyNames() )
-            {
-                String value = systemProperties.getProperty( key );
-                encodeAndWriteToTarget( toPropertyString( key, value == null ? "null" : value ) );
-            }
+            String value = entry.getValue();
+            encodeAndWriteToTarget( toPropertyString( entry.getKey(), useNonNull( value, "null" ) ) );
         }
     }
 
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/report/CategorizedReportEntry.java b/surefire-api/src/main/java/org/apache/maven/surefire/report/CategorizedReportEntry.java
index c357cbafb..47b0c48b0 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/report/CategorizedReportEntry.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/report/CategorizedReportEntry.java
@@ -19,6 +19,9 @@
  * under the License.
  */
 
+import java.util.Collections;
+import java.util.Map;
+
 /**
  * @author Kristian Rosenvold
  */
@@ -47,16 +50,23 @@ public CategorizedReportEntry( String source, String name, String group, StackTr
     public CategorizedReportEntry( String source, String name, String group, StackTraceWriter stackTraceWriter,
                                    Integer elapsed, String message )
     {
-        super( source, name, stackTraceWriter, elapsed, message );
+        this( source, name, group, stackTraceWriter, elapsed, message, Collections.<String, String>emptyMap() );
+    }
+
+    public CategorizedReportEntry( String source, String name, String group, StackTraceWriter stackTraceWriter,
+                                   Integer elapsed, String message, Map<String, String> systemProperties )
+    {
+        super( source, name, stackTraceWriter, elapsed, message, systemProperties );
         this.group = group;
     }
 
-    public static ReportEntry reportEntry( String source, String name, String group, StackTraceWriter stackTraceWriter,
-                                           Integer elapsed, String message )
+    public static TestSetReportEntry reportEntry( String source, String name, String group,
+                                                  StackTraceWriter stackTraceWriter, Integer elapsed, String message,
+                                                  Map<String, String> systemProperties )
     {
         return group != null
-            ? new CategorizedReportEntry( source, name, group, stackTraceWriter, elapsed, message )
-            : new SimpleReportEntry( source, name, stackTraceWriter, elapsed, message );
+            ? new CategorizedReportEntry( source, name, group, stackTraceWriter, elapsed, message, systemProperties )
+            : new SimpleReportEntry( source, name, stackTraceWriter, elapsed, message, systemProperties );
     }
 
     @Override
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/report/RunListener.java b/surefire-api/src/main/java/org/apache/maven/surefire/report/RunListener.java
index 22cda617d..32c0abd1f 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/report/RunListener.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/report/RunListener.java
@@ -34,7 +34,7 @@ public interface RunListener
      * @param report the report entry describing the testset
      * @throws ReporterException When reporting fails
      */
-    void testSetStarting( ReportEntry report );
+    void testSetStarting( TestSetReportEntry report );
 
     /**
      * Indicates end of a given test-set
@@ -42,7 +42,7 @@ public interface RunListener
      * @param report the report entry describing the testset
      * @throws ReporterException When reporting fails
      */
-    void testSetCompleted( ReportEntry report );
+    void testSetCompleted( TestSetReportEntry report );
 
     /**
      * Event fired when a test is about to start
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/report/SimpleReportEntry.java b/surefire-api/src/main/java/org/apache/maven/surefire/report/SimpleReportEntry.java
index 0dd42641a..1013f397d 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/report/SimpleReportEntry.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/report/SimpleReportEntry.java
@@ -19,12 +19,19 @@
  * under the License.
  */
 
+import org.apache.maven.surefire.util.internal.ImmutableMap;
+
+import java.util.Collections;
+import java.util.Map;
+
 /**
  * @author Kristian Rosenvold
  */
 public class SimpleReportEntry
-    implements ReportEntry
+    implements TestSetReportEntry
 {
+    private final Map<String, String> systemProperties;
+
     private final String source;
 
     private final String name;
@@ -45,6 +52,11 @@ public SimpleReportEntry( String source, String name )
         this( source, name, null, null );
     }
 
+    public SimpleReportEntry( String source, String name, Map<String, String> systemProperties )
+    {
+        this( source, name, null, null, systemProperties );
+    }
+
     private SimpleReportEntry( String source, String name, StackTraceWriter stackTraceWriter )
     {
         this( source, name, stackTraceWriter, null );
@@ -57,11 +69,11 @@ public SimpleReportEntry( String source, String name, Integer elapsed )
 
     public SimpleReportEntry( String source, String name, String message )
     {
-        this( source, name, null, null, message );
+        this( source, name, null, null, message, Collections.<String, String>emptyMap() );
     }
 
     protected SimpleReportEntry( String source, String name, StackTraceWriter stackTraceWriter, Integer elapsed,
-                                 String message )
+                                 String message, Map<String, String> systemProperties )
     {
         if ( source == null )
         {
@@ -81,13 +93,19 @@ protected SimpleReportEntry( String source, String name, StackTraceWriter stackT
         this.message = message;
 
         this.elapsed = elapsed;
-    }
 
+        this.systemProperties = new ImmutableMap<String, String>( systemProperties );
+    }
 
     public SimpleReportEntry( String source, String name, StackTraceWriter stackTraceWriter, Integer elapsed )
     {
-        //noinspection ThrowableResultOfMethodCallIgnored
-        this( source, name, stackTraceWriter, elapsed, safeGetMessage( stackTraceWriter ) );
+        this( source, name, stackTraceWriter, elapsed, Collections.<String, String>emptyMap() );
+    }
+
+    public SimpleReportEntry( String source, String name, StackTraceWriter stackTraceWriter, Integer elapsed,
+                              Map<String, String> systemProperties )
+    {
+        this( source, name, stackTraceWriter, elapsed, safeGetMessage( stackTraceWriter ), systemProperties );
     }
 
     public static SimpleReportEntry assumption( String source, String name, String message )
@@ -193,6 +211,12 @@ public String getNameWithGroup()
         return getName();
     }
 
+    @Override
+    public Map<String, String> getSystemProperties()
+    {
+        return systemProperties;
+    }
+
     private boolean isElapsedTimeEqual( SimpleReportEntry en )
     {
         return elapsed != null ? elapsed.equals( en.elapsed ) : en.elapsed == null;
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/report/TestSetReportEntry.java b/surefire-api/src/main/java/org/apache/maven/surefire/report/TestSetReportEntry.java
new file mode 100644
index 000000000..02d8669ea
--- /dev/null
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/report/TestSetReportEntry.java
@@ -0,0 +1,35 @@
+package org.apache.maven.surefire.report;
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import java.util.Map;
+
+/**
+ * Describes test-set when started and finished.
+ *
+ * @author <a href="mailto:tibordigana@apache.org">Tibor Digana (tibor17)</a>
+ * @see RunListener#testSetStarting(TestSetReportEntry)
+ * @see RunListener#testSetCompleted(TestSetReportEntry)
+ * @since 2.20.1
+ */
+public interface TestSetReportEntry extends ReportEntry
+{
+    Map<String, String> getSystemProperties();
+}
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/ImmutableMap.java b/surefire-api/src/main/java/org/apache/maven/surefire/util/internal/ImmutableMap.java
similarity index 94%
rename from maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/ImmutableMap.java
rename to surefire-api/src/main/java/org/apache/maven/surefire/util/internal/ImmutableMap.java
index 576194dfc..003d88444 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/util/ImmutableMap.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/util/internal/ImmutableMap.java
@@ -1,4 +1,4 @@
-package org.apache.maven.plugin.surefire.util;
+package org.apache.maven.surefire.util.internal;
 
 /*
  * Licensed to the Apache Software Foundation (ASF) under one
@@ -20,14 +20,15 @@
  */
 
 import java.util.AbstractMap;
-import java.util.Collections;
 import java.util.LinkedHashSet;
 import java.util.Map;
 import java.util.Set;
 
+import static java.util.Collections.unmodifiableSet;
+
 /**
  * Copies input map in {@link #ImmutableMap(Map) constructor}, and Entries are linked and thread-safe.
- * The map is immutable.
+ * The map is immutable with linear list of entries.
  *
  * @param <K> key
  * @param <V> value
@@ -68,7 +69,7 @@ public Set<Entry<K, V>> entrySet()
             entries.add( node );
             node = node.next;
         }
-        return Collections.<Entry<K, V>>unmodifiableSet( entries );
+        return unmodifiableSet( entries );
     }
 
     static final class Node<K, V>
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/util/internal/ObjectUtils.java b/surefire-api/src/main/java/org/apache/maven/surefire/util/internal/ObjectUtils.java
index 996c3be56..bc4fdd953 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/util/internal/ObjectUtils.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/util/internal/ObjectUtils.java
@@ -1 +1,87 @@
-package org.apache.maven.surefire.util.internal;

/*
 * Licensed to the Apache Software Foundation (ASF) under one
 * or more contributor license agreements.  See the NOTICE file
 * distributed with this work for additional information
 * regarding copyright ownership.  The ASF licenses this file
 * to you under the Apache License, Version 2.0 (the
 * "License"); you may not use this file except in compliance
 * with the License.  You may obtain a copy of the License at
 *
 *     http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing,
 * software distributed under the License is distributed on an
 * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
 * KIND, either express or implied.  See the License for the
 * specific language governing permissions and limitations
 * under the License.
 */

/**
 * Similar to Java 7 java.util.Objects.
 *
 * @author <a href="mailto:tibordigana@apache.org">Tibor Digana (tibor17)</a>
 * @since 2.20
 */
public final class ObjectUtils
{
    private ObjectUtils()
    {
        throw new IllegalStateException( "no instantiable constructor" );
    }

    public static <T> T useNonNull( T target, T fallback )
    {
        return isNull( target ) ? fallback : target;
    }

    /*
    * In JDK7 use java.util.Objects instead.
    * todo
    * */
    public static boolean isNull( Object target )
    {
        return target == null;
    }

    /*
    * In JDK7 use java.util.Objects instead.
    * todo
    * */
    public static boolean nonNull( Object target )
    {
        return !isNull( target );
    }

    /*
    * In JDK7 use java.util.Objects instead.
    * todo
    * */
    public static <T> T requireNonNull( T obj, String message )
    {
        if ( isNull( obj ) )
        {
            throw new NullPointerException( message );
        }
        return obj;
    }

    /*
    * In JDK7 use java.util.Objects instead.
    * todo
    * */
    public static <T> T requireNonNull( T obj )
    {
        return requireNonNull( obj, null );
    }
}
\ No newline at end of file
+package org.apache.maven.surefire.util.internal;
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import java.lang.management.ManagementFactory;
+import java.util.Map;
+
+/**
+ * Similar to Java 7 java.util.Objects.
+ *
+ * @author <a href="mailto:tibordigana@apache.org">Tibor Digana (tibor17)</a>
+ * @since 2.20
+ */
+public final class ObjectUtils
+{
+    private ObjectUtils()
+    {
+        throw new IllegalStateException( "no instantiable constructor" );
+    }
+
+    public static <T> T useNonNull( T target, T fallback )
+    {
+        return isNull( target ) ? fallback : target;
+    }
+
+    /*
+    * In JDK7 use java.util.Objects instead.
+    * todo
+    * */
+    public static boolean isNull( Object target )
+    {
+        return target == null;
+    }
+
+    /*
+    * In JDK7 use java.util.Objects instead.
+    * todo
+    * */
+    public static boolean nonNull( Object target )
+    {
+        return !isNull( target );
+    }
+
+    /*
+    * In JDK7 use java.util.Objects instead.
+    * todo
+    * */
+    public static <T> T requireNonNull( T obj, String message )
+    {
+        if ( isNull( obj ) )
+        {
+            throw new NullPointerException( message );
+        }
+        return obj;
+    }
+
+    /*
+    * In JDK7 use java.util.Objects instead.
+    * todo
+    * */
+    public static <T> T requireNonNull( T obj )
+    {
+        return requireNonNull( obj, null );
+    }
+
+    public static Map<String, String> systemProps()
+    {
+        return ManagementFactory.getRuntimeMXBean().getSystemProperties();
+    }
+}
diff --git a/surefire-api/src/test/java/org/apache/maven/JUnit4SuiteTest.java b/surefire-api/src/test/java/org/apache/maven/JUnit4SuiteTest.java
index 22378bf5d..da6e6e42e 100644
--- a/surefire-api/src/test/java/org/apache/maven/JUnit4SuiteTest.java
+++ b/surefire-api/src/test/java/org/apache/maven/JUnit4SuiteTest.java
@@ -39,6 +39,7 @@
 import org.apache.maven.surefire.util.UrlUtilsTest;
 import org.apache.maven.surefire.util.internal.ByteBufferTest;
 import org.apache.maven.surefire.util.internal.ConcurrencyUtilsTest;
+import org.apache.maven.surefire.util.internal.ImmutableMapTest;
 import org.apache.maven.surefire.util.internal.StringUtilsTest;
 import org.apache.maven.surefire.util.internal.SystemUtilsTest;
 import org.junit.runner.RunWith;
@@ -70,7 +71,8 @@
     UrlUtilsTest.class,
     SpecificTestClassFilterTest.class,
     FundamentalFilterTest.class,
-    SystemUtilsTest.class
+    SystemUtilsTest.class,
+    ImmutableMapTest.class
 } )
 @RunWith( Suite.class )
 public class JUnit4SuiteTest
diff --git a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/util/ImmutableMapTest.java b/surefire-api/src/test/java/org/apache/maven/surefire/util/internal/ImmutableMapTest.java
similarity index 96%
rename from maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/util/ImmutableMapTest.java
rename to surefire-api/src/test/java/org/apache/maven/surefire/util/internal/ImmutableMapTest.java
index 8fcf2bb9c..b104cc35b 100644
--- a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/util/ImmutableMapTest.java
+++ b/surefire-api/src/test/java/org/apache/maven/surefire/util/internal/ImmutableMapTest.java
@@ -1,4 +1,4 @@
-package org.apache.maven.plugin.surefire.util;
+package org.apache.maven.surefire.util.internal;
 
 /*
  * Licensed to the Apache Software Foundation (ASF) under one
@@ -19,7 +19,7 @@
  * under the License.
  */
 
-import org.apache.maven.plugin.surefire.util.ImmutableMap.Node;
+import org.apache.maven.surefire.util.internal.ImmutableMap.Node;
 import org.junit.Before;
 import org.junit.Test;
 
diff --git a/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/jiras/Surefire1364SystemPropertiesIT.java b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/jiras/Surefire1364SystemPropertiesIT.java
new file mode 100644
index 000000000..d13b0f24a
--- /dev/null
+++ b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/jiras/Surefire1364SystemPropertiesIT.java
@@ -0,0 +1,203 @@
+package org.apache.maven.surefire.its.jiras;
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import org.apache.maven.surefire.its.fixture.OutputValidator;
+import org.apache.maven.surefire.its.fixture.SurefireJUnit4IntegrationTestCase;
+import org.apache.maven.surefire.its.fixture.SurefireLauncher;
+import org.junit.Test;
+
+/**
+ * Report XML should contain system properties of forked JVM.
+ *
+ * @author <a href="mailto:tibordigana@apache.org">Tibor Digana (tibor17)</a>
+ * @since 2.20.1
+ */
+public class Surefire1364SystemPropertiesIT
+        extends SurefireJUnit4IntegrationTestCase
+{
+    @Test
+    public void junit3Forked()
+    {
+        SurefireLauncher launcher = unpack( "surefire-1364" );
+        OutputValidator validator = launcher.setForkJvm()
+                                            .activateProfile( "junit3" )
+                                            .forkMode( "once" )
+                                            .executeTest()
+                                            .verifyErrorFree( 2 );
+
+        validator.getSurefireReportsXmlFile( "TEST-FirstTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+
+        validator.getSurefireReportsXmlFile( "TEST-SecondTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+    }
+
+    @Test
+    public void junit3InProcess()
+    {
+        SurefireLauncher launcher = unpack( "surefire-1364" );
+        OutputValidator validator = launcher.setForkJvm()
+                                            .activateProfile( "junit3" )
+                                            .forkMode( "never" )
+                                            .executeTest()
+                                            .verifyErrorFree( 2 );
+
+        validator.getSurefireReportsXmlFile( "TEST-FirstTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+
+        validator.getSurefireReportsXmlFile( "TEST-SecondTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+    }
+
+    @Test
+    public void junit4Forked()
+    {
+        SurefireLauncher launcher = unpack( "surefire-1364" );
+        OutputValidator validator = launcher.setForkJvm()
+                                            .forkMode( "once" )
+                                            .executeTest()
+                                            .verifyErrorFree( 2 );
+
+        validator.getSurefireReportsXmlFile( "TEST-FirstTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+
+        validator.getSurefireReportsXmlFile( "TEST-SecondTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+    }
+
+    @Test
+    public void junit4InProcess()
+    {
+        SurefireLauncher launcher = unpack( "surefire-1364" );
+        OutputValidator validator = launcher.setForkJvm()
+                                            .forkMode( "never" )
+                                            .executeTest()
+                                            .verifyErrorFree( 2 );
+
+        validator.getSurefireReportsXmlFile( "TEST-FirstTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+
+        validator.getSurefireReportsXmlFile( "TEST-SecondTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+    }
+
+    @Test
+    public void junit47Forked()
+    {
+        SurefireLauncher launcher = unpack( "surefire-1364" );
+        OutputValidator validator = launcher.setForkJvm()
+                                            .activateProfile( "junit47" )
+                                            .forkMode( "once" )
+                                            .executeTest()
+                                            .verifyErrorFree( 2 );
+
+        validator.getSurefireReportsXmlFile( "TEST-FirstTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+
+        validator.getSurefireReportsXmlFile( "TEST-SecondTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+    }
+
+    @Test
+    public void junit47InProcess()
+    {
+        SurefireLauncher launcher = unpack( "surefire-1364" );
+        OutputValidator validator = launcher.setForkJvm()
+                                            .activateProfile( "junit47" )
+                                            .forkMode( "never" )
+                                            .executeTest()
+                                            .verifyErrorFree( 2 );
+
+        validator.getSurefireReportsXmlFile( "TEST-FirstTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+
+        validator.getSurefireReportsXmlFile( "TEST-SecondTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+    }
+
+    @Test
+    public void junit47ForkedParallel()
+    {
+        SurefireLauncher launcher = unpack( "surefire-1364" );
+        OutputValidator validator = launcher.setForkJvm()
+                                            .activateProfile( "junit47" )
+                                            .forkMode( "once" )
+                                            .parallelClasses()
+                                            .threadCount( 2 )
+                                            .disablePerCoreThreadCount()
+                                            .executeTest()
+                                            .verifyErrorFree( 2 );
+
+        validator.getSurefireReportsXmlFile( "TEST-FirstTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+
+        validator.getSurefireReportsXmlFile( "TEST-SecondTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+    }
+
+    @Test
+    public void junit47InProcessParallel()
+    {
+        SurefireLauncher launcher = unpack( "surefire-1364" );
+        OutputValidator validator = launcher.setForkJvm()
+                                            .activateProfile( "junit47" )
+                                            .forkMode( "never" )
+                                            .parallelClasses()
+                                            .threadCount( 2 )
+                                            .disablePerCoreThreadCount()
+                                            .executeTest()
+                                            .verifyErrorFree( 2 );
+
+        validator.getSurefireReportsXmlFile( "TEST-FirstTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+
+        validator.getSurefireReportsXmlFile( "TEST-SecondTest.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+    }
+
+    @Test
+    public void testNg()
+    {
+        SurefireLauncher launcher = unpack( "surefire-1364" );
+        OutputValidator validator = launcher.setForkJvm()
+                                            .activateProfile( "testng" )
+                                            .forkMode( "once" )
+                                            .executeTest()
+                                            .verifyErrorFree( 3 );
+
+        validator.getSurefireReportsXmlFile( "TEST-TestSuite.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+    }
+
+    @Test
+    public void testNgInProcess()
+    {
+        SurefireLauncher launcher = unpack( "surefire-1364" );
+        OutputValidator validator = launcher.setForkJvm()
+                                            .activateProfile( "testng" )
+                                            .forkMode( "never" )
+                                            .executeTest()
+                                            .verifyErrorFree( 3 );
+
+        validator.getSurefireReportsXmlFile( "TEST-TestSuite.xml" )
+                .assertContainsText( "<property name=\"forkedProp\" value=\"forkedValue1\"/>" );
+    }
+}
diff --git a/surefire-integration-tests/src/test/resources/surefire-1364/pom.xml b/surefire-integration-tests/src/test/resources/surefire-1364/pom.xml
new file mode 100644
index 000000000..f93565a1d
--- /dev/null
+++ b/surefire-integration-tests/src/test/resources/surefire-1364/pom.xml
@@ -0,0 +1,156 @@
+<?xml version="1.0" encoding="UTF-8"?>
+<!--
+  ~ Licensed to the Apache Software Foundation (ASF) under one
+  ~ or more contributor license agreements.  See the NOTICE file
+  ~ distributed with this work for additional information
+  ~ regarding copyright ownership.  The ASF licenses this file
+  ~ to you under the Apache License, Version 2.0 (the
+  ~ "License"); you may not use this file except in compliance
+  ~ with the License.  You may obtain a copy of the License at
+  ~
+  ~     http://www.apache.org/licenses/LICENSE-2.0
+  ~
+  ~ Unless required by applicable law or agreed to in writing,
+  ~ software distributed under the License is distributed on an
+  ~ "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+  ~ KIND, either express or implied.  See the License for the
+  ~ specific language governing permissions and limitations
+  ~ under the License.
+  -->
+
+<project xmlns="http://maven.apache.org/POM/4.0.0" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
+         xsi:schemaLocation="http://maven.apache.org/POM/4.0.0 http://maven.apache.org/maven-v4_0_0.xsd">
+    <modelVersion>4.0.0</modelVersion>
+
+    <parent>
+        <groupId>org.apache.maven.surefire</groupId>
+        <artifactId>it-parent</artifactId>
+        <version>1.0</version>
+    </parent>
+
+    <groupId>org.apache.maven.plugins.surefire</groupId>
+    <artifactId>surefire-1364</artifactId>
+    <version>1.0</version>
+
+    <properties>
+        <project.build.sourceEncoding>UTF-8</project.build.sourceEncoding>
+        <maven.compiler.source>1.6</maven.compiler.source>
+        <maven.compiler.target>1.6</maven.compiler.target>
+        <forkedMode>once</forkedMode>
+    </properties>
+
+    <dependencies>
+        <dependency>
+            <groupId>junit</groupId>
+            <artifactId>junit</artifactId>
+            <version>4.12</version>
+            <scope>test</scope>
+        </dependency>
+    </dependencies>
+
+    <build>
+        <pluginManagement>
+            <plugins>
+                <plugin>
+                    <groupId>org.apache.maven.plugins</groupId>
+                    <artifactId>maven-compiler-plugin</artifactId>
+                    <configuration>
+                        <testIncludes>
+                            <testInclude>FirstTest.java</testInclude>
+                            <testInclude>SecondTest.java</testInclude>
+                        </testIncludes>
+                    </configuration>
+                </plugin>
+                <plugin>
+                    <groupId>org.apache.maven.plugins</groupId>
+                    <artifactId>maven-surefire-plugin</artifactId>
+                    <configuration>
+                        <forkMode>${forkedMode}</forkMode>
+                        <systemPropertyVariables>
+                            <forkedProp>forkedValue${surefire.forkNumber}</forkedProp>
+                        </systemPropertyVariables>
+                    </configuration>
+                </plugin>
+            </plugins>
+        </pluginManagement>
+    </build>
+    <profiles>
+        <profile>
+            <id>junit3</id>
+            <build>
+                <pluginManagement>
+                    <plugins>
+                        <plugin>
+                            <groupId>org.apache.maven.plugins</groupId>
+                            <artifactId>maven-surefire-plugin</artifactId>
+                            <dependencies>
+                                <dependency>
+                                    <groupId>org.apache.maven.surefire</groupId>
+                                    <artifactId>surefire-junit3</artifactId>
+                                    <version>${surefire.version}</version>
+                                </dependency>
+                            </dependencies>
+                        </plugin>
+                    </plugins>
+                </pluginManagement>
+            </build>
+        </profile>
+        <profile>
+            <id>junit47</id>
+            <build>
+                <pluginManagement>
+                    <plugins>
+                        <plugin>
+                            <groupId>org.apache.maven.plugins</groupId>
+                            <artifactId>maven-surefire-plugin</artifactId>
+                            <dependencies>
+                                <dependency>
+                                    <groupId>org.apache.maven.surefire</groupId>
+                                    <artifactId>surefire-junit47</artifactId>
+                                    <version>${surefire.version}</version>
+                                </dependency>
+                            </dependencies>
+                        </plugin>
+                    </plugins>
+                </pluginManagement>
+            </build>
+        </profile>
+        <profile>
+            <id>testng</id>
+            <dependencies>
+                <dependency>
+                    <groupId>org.testng</groupId>
+                    <artifactId>testng</artifactId>
+                    <version>6.8.21</version>
+                    <scope>test</scope>
+                </dependency>
+            </dependencies>
+            <build>
+                <pluginManagement>
+                    <plugins>
+                        <plugin>
+                            <groupId>org.apache.maven.plugins</groupId>
+                            <artifactId>maven-compiler-plugin</artifactId>
+                            <configuration>
+                                <testIncludes>
+                                    <testInclude>*.java</testInclude>
+                                </testIncludes>
+                            </configuration>
+                        </plugin>
+                        <plugin>
+                            <groupId>org.apache.maven.plugins</groupId>
+                            <artifactId>maven-surefire-plugin</artifactId>
+                            <dependencies>
+                                <dependency>
+                                    <groupId>org.apache.maven.surefire</groupId>
+                                    <artifactId>surefire-testng</artifactId>
+                                    <version>${surefire.version}</version>
+                                </dependency>
+                            </dependencies>
+                        </plugin>
+                    </plugins>
+                </pluginManagement>
+            </build>
+        </profile>
+    </profiles>
+</project>
diff --git a/surefire-integration-tests/src/test/resources/surefire-1364/src/test/java/FirstTest.java b/surefire-integration-tests/src/test/resources/surefire-1364/src/test/java/FirstTest.java
new file mode 100644
index 000000000..f2a9e66b3
--- /dev/null
+++ b/surefire-integration-tests/src/test/resources/surefire-1364/src/test/java/FirstTest.java
@@ -0,0 +1,30 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import junit.framework.TestCase;
+import org.junit.Test;
+
+public class FirstTest extends TestCase
+{
+    @Test
+    public void test() throws InterruptedException
+    {
+        Thread.sleep( 100 );
+    }
+}
diff --git a/surefire-integration-tests/src/test/resources/surefire-1364/src/test/java/SecondTest.java b/surefire-integration-tests/src/test/resources/surefire-1364/src/test/java/SecondTest.java
new file mode 100644
index 000000000..cfd9b51ed
--- /dev/null
+++ b/surefire-integration-tests/src/test/resources/surefire-1364/src/test/java/SecondTest.java
@@ -0,0 +1,30 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import junit.framework.TestCase;
+import org.junit.Test;
+
+public class SecondTest extends TestCase
+{
+    @Test
+    public void test() throws InterruptedException
+    {
+        Thread.sleep( 100 );
+    }
+}
diff --git a/surefire-integration-tests/src/test/resources/surefire-1364/src/test/java/ThirdTest.java b/surefire-integration-tests/src/test/resources/surefire-1364/src/test/java/ThirdTest.java
new file mode 100644
index 000000000..f3633d6a2
--- /dev/null
+++ b/surefire-integration-tests/src/test/resources/surefire-1364/src/test/java/ThirdTest.java
@@ -0,0 +1,30 @@
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+import org.testng.annotations.Test;
+
+
+public class ThirdTest
+{
+    @Test
+    public void test() throws InterruptedException
+    {
+        Thread.sleep( 100 );
+    }
+}
\ No newline at end of file
diff --git a/surefire-providers/common-junit4/src/main/java/org/apache/maven/surefire/junit4/MockReporter.java b/surefire-providers/common-junit4/src/main/java/org/apache/maven/surefire/junit4/MockReporter.java
index 12cbb4c2d..9f3b6ff96 100644
--- a/surefire-providers/common-junit4/src/main/java/org/apache/maven/surefire/junit4/MockReporter.java
+++ b/surefire-providers/common-junit4/src/main/java/org/apache/maven/surefire/junit4/MockReporter.java
@@ -24,6 +24,7 @@
 import java.util.concurrent.atomic.AtomicInteger;
 import org.apache.maven.surefire.report.ReportEntry;
 import org.apache.maven.surefire.report.RunListener;
+import org.apache.maven.surefire.report.TestSetReportEntry;
 
 /**
  * Internal tests use only.
@@ -56,13 +57,13 @@ public MockReporter()
     }
 
     @Override
-    public void testSetStarting( ReportEntry report )
+    public void testSetStarting( TestSetReportEntry report )
     {
         events.add( SET_STARTED );
     }
 
     @Override
-    public void testSetCompleted( ReportEntry report )
+    public void testSetCompleted( TestSetReportEntry report )
     {
         events.add( SET_COMPLETED );
     }
diff --git a/surefire-providers/surefire-junit3/src/main/java/org/apache/maven/surefire/junit/JUnit3Provider.java b/surefire-providers/surefire-junit3/src/main/java/org/apache/maven/surefire/junit/JUnit3Provider.java
index adfda35b8..b8c83e1f8 100644
--- a/surefire-providers/surefire-junit3/src/main/java/org/apache/maven/surefire/junit/JUnit3Provider.java
+++ b/surefire-providers/surefire-junit3/src/main/java/org/apache/maven/surefire/junit/JUnit3Provider.java
@@ -25,7 +25,6 @@
 import org.apache.maven.surefire.providerapi.ProviderParameters;
 import org.apache.maven.surefire.report.ConsoleOutputCapture;
 import org.apache.maven.surefire.report.ConsoleOutputReceiver;
-import org.apache.maven.surefire.report.ReportEntry;
 import org.apache.maven.surefire.report.ReporterFactory;
 import org.apache.maven.surefire.report.RunListener;
 import org.apache.maven.surefire.report.SimpleReportEntry;
@@ -36,6 +35,10 @@
 import org.apache.maven.surefire.util.ScanResult;
 import org.apache.maven.surefire.util.TestsToRun;
 
+import java.util.Map;
+
+import static org.apache.maven.surefire.util.internal.ObjectUtils.systemProps;
+
 /**
  * @author Kristian Rosenvold
  */
@@ -95,8 +98,8 @@ else if ( forkTestSet instanceof Class )
         {
             final RunListener reporter = reporterFactory.createReporter();
             ConsoleOutputCapture.startCapture( (ConsoleOutputReceiver) reporter );
-
-            final String smClassName = System.getProperty( "surefire.security.manager" );
+            final Map<String, String> systemProperties = systemProps();
+            final String smClassName = systemProperties.get( "surefire.security.manager" );
             if ( smClassName != null )
             {
                 SecurityManager securityManager =
@@ -107,7 +110,7 @@ else if ( forkTestSet instanceof Class )
             for ( Class<?> clazz : testsToRun )
             {
                 SurefireTestSet surefireTestSet = createTestSet( clazz );
-                executeTestSet( surefireTestSet, reporter, testClassLoader );
+                executeTestSet( surefireTestSet, reporter, testClassLoader, systemProperties );
             }
 
         }
@@ -126,10 +129,11 @@ private SurefireTestSet createTestSet( Class<?> clazz )
             : new PojoTestSet( clazz );
     }
 
-    private void executeTestSet( SurefireTestSet testSet, RunListener reporter, ClassLoader classLoader )
+    private void executeTestSet( SurefireTestSet testSet, RunListener reporter, ClassLoader classLoader,
+                                 Map<String, String> systemProperties )
         throws TestSetFailedException
     {
-        ReportEntry report = new SimpleReportEntry( this.getClass().getName(), testSet.getName() );
+        SimpleReportEntry report = new SimpleReportEntry( getClass().getName(), testSet.getName(), systemProperties );
 
         reporter.testSetStarting( report );
 
diff --git a/surefire-providers/surefire-junit3/src/test/java/org/apache/maven/surefire/junit/JUnitTestSetTest.java b/surefire-providers/surefire-junit3/src/test/java/org/apache/maven/surefire/junit/JUnitTestSetTest.java
index 359a79f3f..9c08fd903 100644
--- a/surefire-providers/surefire-junit3/src/test/java/org/apache/maven/surefire/junit/JUnitTestSetTest.java
+++ b/surefire-providers/surefire-junit3/src/test/java/org/apache/maven/surefire/junit/JUnitTestSetTest.java
@@ -19,16 +19,17 @@
  * under the License.
  */
 
-import java.util.ArrayList;
-import java.util.List;
+import junit.framework.Test;
+import junit.framework.TestCase;
+import junit.framework.TestSuite;
 import org.apache.maven.surefire.common.junit3.JUnit3Reflector;
 import org.apache.maven.surefire.report.ReportEntry;
 import org.apache.maven.surefire.report.RunListener;
+import org.apache.maven.surefire.report.TestSetReportEntry;
 import org.apache.maven.surefire.testset.TestSetFailedException;
 
-import junit.framework.Test;
-import junit.framework.TestCase;
-import junit.framework.TestSuite;
+import java.util.ArrayList;
+import java.util.List;
 
 public class JUnitTestSetTest
     extends TestCase
@@ -64,12 +65,12 @@ public static class SuccessListener
         private List<ReportEntry> succeededTests = new ArrayList<ReportEntry>();
 
         @Override
-        public void testSetStarting( ReportEntry report )
+        public void testSetStarting( TestSetReportEntry report )
         {
         }
 
         @Override
-        public void testSetCompleted( ReportEntry report )
+        public void testSetCompleted( TestSetReportEntry report )
         {
         }
 
diff --git a/surefire-providers/surefire-junit4/src/main/java/org/apache/maven/surefire/junit4/JUnit4Provider.java b/surefire-providers/surefire-junit4/src/main/java/org/apache/maven/surefire/junit4/JUnit4Provider.java
index 12842fae6..ad29224e5 100644
--- a/surefire-providers/surefire-junit4/src/main/java/org/apache/maven/surefire/junit4/JUnit4Provider.java
+++ b/surefire-providers/surefire-junit4/src/main/java/org/apache/maven/surefire/junit4/JUnit4Provider.java
@@ -31,7 +31,6 @@
 import org.apache.maven.surefire.providerapi.ProviderParameters;
 import org.apache.maven.surefire.report.ConsoleOutputReceiver;
 import org.apache.maven.surefire.report.PojoStackTraceWriter;
-import org.apache.maven.surefire.report.ReportEntry;
 import org.apache.maven.surefire.report.ReporterFactory;
 import org.apache.maven.surefire.report.RunListener;
 import org.apache.maven.surefire.report.SimpleReportEntry;
@@ -66,6 +65,7 @@
 import static org.apache.maven.surefire.report.SimpleReportEntry.withException;
 import static org.apache.maven.surefire.testset.TestListResolver.optionallyWildcardFilter;
 import static org.apache.maven.surefire.util.TestsToRun.fromClass;
+import static org.apache.maven.surefire.util.internal.ObjectUtils.systemProps;
 import static org.junit.runner.Request.aClass;
 import static org.junit.runner.Request.method;
 
@@ -232,7 +232,7 @@ public void update( Command command )
 
     private void executeTestSet( Class<?> clazz, RunListener reporter, Notifier notifier )
     {
-        final ReportEntry report = new SimpleReportEntry( getClass().getName(), clazz.getName() );
+        final SimpleReportEntry report = new SimpleReportEntry( getClass().getName(), clazz.getName(), systemProps() );
         reporter.testSetStarting( report );
         try
         {
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ClassesParallelRunListener.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ClassesParallelRunListener.java
index e8ac7860c..52a7ffbab 100644
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ClassesParallelRunListener.java
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ClassesParallelRunListener.java
@@ -40,7 +40,7 @@ public ClassesParallelRunListener( Map<String, TestSet> classMethodCounts, Repor
     }
 
     @Override
-    public void checkIfTestSetCanBeReported( TestSet testSetForTest )
+    protected void checkIfTestSetCanBeReported( TestSet testSetForTest )
     {
         TestSet currentlyAttached = TestSet.getThreadTestSet();
         if ( currentlyAttached != null && currentlyAttached != testSetForTest )
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ConcurrentRunListener.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ConcurrentRunListener.java
index 56e3e1a61..27008ee44 100644
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ConcurrentRunListener.java
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/ConcurrentRunListener.java
@@ -26,6 +26,7 @@
 import org.apache.maven.surefire.report.ReporterFactory;
 import org.apache.maven.surefire.report.RunListener;
 import org.apache.maven.surefire.report.StackTraceWriter;
+import org.apache.maven.surefire.report.TestSetReportEntry;
 import org.apache.maven.surefire.testset.TestSetFailedException;
 
 import static org.apache.maven.surefire.junitcore.TestMethod.getThreadTestMethod;
@@ -70,12 +71,12 @@ protected RunListener initialValue()
     }
 
     @Override
-    public void testSetStarting( ReportEntry description )
+    public void testSetStarting( TestSetReportEntry description )
     {
     }
 
     @Override
-    public void testSetCompleted( ReportEntry result )
+    public void testSetCompleted( TestSetReportEntry result )
     {
         final RunListener reporterManager = getRunListener();
         for ( TestSet testSet : classMethodCounts.values() )
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/MethodsParallelRunListener.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/MethodsParallelRunListener.java
index 0e487b069..b478670e8 100644
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/MethodsParallelRunListener.java
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/MethodsParallelRunListener.java
@@ -44,7 +44,7 @@ public MethodsParallelRunListener( Map<String, TestSet> classMethodCounts, Repor
     }
 
     @Override
-    public void checkIfTestSetCanBeReported( TestSet testSetForTest )
+    protected void checkIfTestSetCanBeReported( TestSet testSetForTest )
     {
         synchronized ( lock )
         {
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/NonConcurrentRunListener.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/NonConcurrentRunListener.java
index 0e5ee776a..e9897bd47 100644
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/NonConcurrentRunListener.java
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/NonConcurrentRunListener.java
@@ -23,11 +23,17 @@
 import org.apache.maven.surefire.report.ConsoleOutputReceiver;
 import org.apache.maven.surefire.report.RunListener;
 import org.apache.maven.surefire.report.SimpleReportEntry;
+import org.apache.maven.surefire.report.TestSetReportEntry;
 import org.apache.maven.surefire.testset.TestSetFailedException;
 import org.junit.runner.Description;
 import org.junit.runner.Result;
 import org.junit.runner.notification.Failure;
 
+import java.util.Collections;
+import java.util.Map;
+
+import static org.apache.maven.surefire.util.internal.ObjectUtils.systemProps;
+
 /**
  * A class to be used when there is no JUnit parallelism (methods or/and class). This allow to workaround JUnit
  * limitation a la Junit4 provider. Specifically, we can redirect properly the output even if we don't have class
@@ -60,10 +66,20 @@ protected SimpleReportEntry createReportEntry( Description description )
         return new SimpleReportEntry( extractDescriptionClassName( description ), description.getDisplayName() );
     }
 
-    protected SimpleReportEntry createReportEntryForTestSet( Description description )
+    private TestSetReportEntry createReportEntryForTestSet( Description description, Map<String, String> systemProps )
     {
         String testClassName = extractDescriptionClassName( description );
-        return new SimpleReportEntry( testClassName, testClassName );
+        return new SimpleReportEntry( testClassName, testClassName, systemProps );
+    }
+
+    private TestSetReportEntry createTestSetReportEntryStarted( Description description )
+    {
+        return createReportEntryForTestSet( description, Collections.<String, String>emptyMap() );
+    }
+
+    private TestSetReportEntry createTestSetReportEntryFinished( Description description )
+    {
+        return createReportEntryForTestSet( description, systemProps() );
     }
 
     @Override
@@ -93,10 +109,11 @@ private void finishLastTestSetIfNecessary( Description description )
             currentTestSetDescription = description;
             if ( lastFinishedDescription != null )
             {
-                reporter.testSetCompleted( createReportEntryForTestSet( lastFinishedDescription ) );
+                TestSetReportEntry reportEntry = createTestSetReportEntryFinished( lastFinishedDescription );
+                reporter.testSetCompleted( reportEntry );
                 lastFinishedDescription = null;
             }
-            reporter.testSetStarting( createReportEntryForTestSet( description ) );
+            reporter.testSetStarting( createTestSetReportEntryStarted( description ) );
         }
     }
 
@@ -166,7 +183,7 @@ public void testRunFinished( Result result )
     {
         if ( lastFinishedDescription != null )
         {
-            reporter.testSetCompleted( createReportEntryForTestSet( lastFinishedDescription ) );
+            reporter.testSetCompleted( createTestSetReportEntryFinished( lastFinishedDescription ) );
             lastFinishedDescription = null;
         }
     }
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestSet.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestSet.java
index d7bb7220c..0f0532732 100644
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestSet.java
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/TestSet.java
@@ -19,17 +19,21 @@
  * under the License.
  */
 
+import org.apache.maven.surefire.report.ReportEntry;
+import org.apache.maven.surefire.report.RunListener;
+import org.apache.maven.surefire.report.SimpleReportEntry;
+import org.apache.maven.surefire.report.TestSetReportEntry;
+import org.junit.runner.Description;
+
 import java.util.Collection;
+import java.util.Collections;
 import java.util.List;
+import java.util.Map;
 import java.util.concurrent.ConcurrentLinkedQueue;
 import java.util.concurrent.atomic.AtomicBoolean;
 import java.util.concurrent.atomic.AtomicInteger;
 
-import org.apache.maven.surefire.report.ReportEntry;
-import org.apache.maven.surefire.report.RunListener;
-import org.apache.maven.surefire.report.SimpleReportEntry;
-
-import org.junit.runner.Description;
+import static org.apache.maven.surefire.util.internal.ObjectUtils.systemProps;
 
 /**
  * * Represents the test-state of a testset that is run.
@@ -64,7 +68,7 @@ public void replay( RunListener target )
         {
             try
             {
-                ReportEntry report = createReportEntry( null );
+                TestSetReportEntry report = createReportEntryStarted();
 
                 target.testSetStarting( report );
 
@@ -87,7 +91,7 @@ public void replay( RunListener target )
 
                 int elapsed = (int) ( endTime - startTile );
 
-                report = createReportEntry( elapsed );
+                report = createReportEntryCompleted( elapsed );
 
                 target.testSetCompleted( report );
             }
@@ -106,7 +110,17 @@ public TestMethod createThreadAttachedTestMethod( ReportEntry description )
         return testMethod;
     }
 
-    private ReportEntry createReportEntry( Integer elapsed )
+    private TestSetReportEntry createReportEntryStarted()
+    {
+        return createReportEntry( null, Collections.<String, String>emptyMap() );
+    }
+
+    private TestSetReportEntry createReportEntryCompleted( int elapsed )
+    {
+        return createReportEntry( elapsed, systemProps() );
+    }
+
+    private TestSetReportEntry createReportEntry( Integer elapsed, Map<String, String> systemProps )
     {
         final String className = testSetDescription.getClassName();
         final boolean isJunit3 = className == null;
@@ -120,7 +134,7 @@ private ReportEntry createReportEntry( Integer elapsed )
         {
             classNameToUse = className;
         }
-        return new SimpleReportEntry( classNameToUse, classNameToUse, elapsed );
+        return new SimpleReportEntry( classNameToUse, classNameToUse, null, elapsed, systemProps );
     }
 
     public void incrementTestMethodCount()
diff --git a/surefire-providers/surefire-testng/src/main/java/org/apache/maven/surefire/testng/TestSuite.java b/surefire-providers/surefire-testng/src/main/java/org/apache/maven/surefire/testng/TestSuite.java
index a74ef0d83..ca40f7c76 100644
--- a/surefire-providers/surefire-testng/src/main/java/org/apache/maven/surefire/testng/TestSuite.java
+++ b/surefire-providers/surefire-testng/src/main/java/org/apache/maven/surefire/testng/TestSuite.java
@@ -19,13 +19,15 @@
  * under the License.
  */
 
-import org.apache.maven.surefire.report.ReportEntry;
 import org.apache.maven.surefire.report.ReporterException;
 import org.apache.maven.surefire.report.RunListener;
 import org.apache.maven.surefire.report.SimpleReportEntry;
+import org.apache.maven.surefire.report.TestSetReportEntry;
 
 import java.util.Map;
 
+import static org.apache.maven.surefire.util.internal.ObjectUtils.systemProps;
+
 /**
  * Abstract class which implements common functions.
  */
@@ -41,7 +43,7 @@ final String getSuiteName()
 
     final void startTestSuite( RunListener reporterManager )
     {
-        ReportEntry report = new SimpleReportEntry( getClass().getName(), getSuiteName() );
+        TestSetReportEntry report = new SimpleReportEntry( getClass().getName(), getSuiteName(), systemProps() );
 
         try
         {
@@ -55,7 +57,7 @@ final void startTestSuite( RunListener reporterManager )
 
     final void finishTestSuite( RunListener reporterManager )
     {
-        ReportEntry report = new SimpleReportEntry( getClass().getName(), getSuiteName() );
+        SimpleReportEntry report = new SimpleReportEntry( getClass().getName(), getSuiteName(), systemProps() );
         reporterManager.testSetCompleted( report );
     }
 }
