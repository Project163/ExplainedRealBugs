diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/report/XMLReporter.java b/surefire-api/src/main/java/org/apache/maven/surefire/report/XMLReporter.java
index c5743030b..06084e77b 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/report/XMLReporter.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/report/XMLReporter.java
@@ -19,12 +19,6 @@
  * under the License.
  */
 
-import org.apache.maven.surefire.util.PrettyPrintXMLWriter;
-import org.codehaus.plexus.util.IOUtil;
-import org.codehaus.plexus.util.StringUtils;
-import org.codehaus.plexus.util.xml.Xpp3Dom;
-import org.codehaus.plexus.util.xml.Xpp3DomWriter;
-
 import java.io.BufferedWriter;
 import java.io.File;
 import java.io.FileNotFoundException;
@@ -40,6 +34,11 @@
 import java.util.Properties;
 import java.util.StringTokenizer;
 
+import org.apache.maven.surefire.util.PrettyPrintXMLWriter;
+import org.codehaus.plexus.util.IOUtil;
+import org.codehaus.plexus.util.xml.Xpp3Dom;
+import org.codehaus.plexus.util.xml.Xpp3DomWriter;
+
 
 /**
  * XML format reporter.
@@ -273,9 +272,25 @@ private void showProperties( Xpp3Dom testSuite )
     private static String escapeAttribute( String attribute )
     {
         // Shouldn't Xpp3Dom do this itself?
-        String s = StringUtils.replace( attribute, "<", "&lt;" );
-        s = StringUtils.replace( s, ">", "&gt;" );
-        return s;
+        StringBuffer sb = new StringBuffer ( attribute.length() * 2 );
+        for (int i = 0; i < attribute.length(); i++ ) {
+            char c = attribute.charAt( i );
+            if ( c < 32 ) {
+                if ( c == '\n' || c == '\r' || c == '\t') {
+                    sb.append( c );
+                } else {
+                    sb.append( "&#" ).append( (int) c).append( ';' );
+                }
+            } else if ( c == '<') {
+                sb.append( "&lt;" );
+            } else if ( c == '>') {
+                sb.append( "&gt;" );
+            }
+            else {
+                sb.append( c );
+            }
+        }
+        return sb.toString();
 
     }
 
diff --git a/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/Surefire224WellFormedXmlFailuresTest.java b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/Surefire224WellFormedXmlFailuresTest.java
index 48b4dfb90..d6b74f6db 100644
--- a/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/Surefire224WellFormedXmlFailuresTest.java
+++ b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/Surefire224WellFormedXmlFailuresTest.java
@@ -26,7 +26,7 @@ public void testWellFormedXmlFailures ()
         // verifier.verifyErrorFreeLog();
         verifier.resetStreams();
         
-        HelperAssertions.assertTestSuiteResults( 3, 0, 3, 0, testDir );
+        HelperAssertions.assertTestSuiteResults( 4, 0, 4, 0, testDir );
         
     }
 }
diff --git a/surefire-integration-tests/src/test/resources/surefire-224-wellFormedXmlFailures/pom.xml b/surefire-integration-tests/src/test/resources/surefire-224-wellFormedXmlFailures/pom.xml
index f9317330a..0f43afb73 100644
--- a/surefire-integration-tests/src/test/resources/surefire-224-wellFormedXmlFailures/pom.xml
+++ b/surefire-integration-tests/src/test/resources/surefire-224-wellFormedXmlFailures/pom.xml
@@ -43,7 +43,6 @@
       <plugin>
         <groupId>org.apache.maven.plugins</groupId>
         <artifactId>maven-surefire-plugin</artifactId>
-        <version>2.1</version>
         <configuration>
           <testFailureIgnore>true</testFailureIgnore>
         </configuration>
diff --git a/surefire-integration-tests/src/test/resources/surefire-224-wellFormedXmlFailures/src/test/java/TestSurefire3.java b/surefire-integration-tests/src/test/resources/surefire-224-wellFormedXmlFailures/src/test/java/TestSurefire3.java
index dc7dea231..fa3431577 100644
--- a/surefire-integration-tests/src/test/resources/surefire-224-wellFormedXmlFailures/src/test/java/TestSurefire3.java
+++ b/surefire-integration-tests/src/test/resources/surefire-224-wellFormedXmlFailures/src/test/java/TestSurefire3.java
@@ -33,4 +33,9 @@ public void testGreater()
         fail( ">" );
     }
 
+    public void testU0000()
+    {
+        fail( "\u0000" );
+    }
+
 }
