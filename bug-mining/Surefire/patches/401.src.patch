diff --git a/maven-surefire-report-plugin/src/main/java/org/apache/maven/plugins/surefire/report/SurefireReportGenerator.java b/maven-surefire-report-plugin/src/main/java/org/apache/maven/plugins/surefire/report/SurefireReportGenerator.java
index 5e8b84259..944832a23 100644
--- a/maven-surefire-report-plugin/src/main/java/org/apache/maven/plugins/surefire/report/SurefireReportGenerator.java
+++ b/maven-surefire-report-plugin/src/main/java/org/apache/maven/plugins/surefire/report/SurefireReportGenerator.java
@@ -666,19 +666,24 @@ private String getErrorLineNumber( String className, String source )
     {
         StringTokenizer tokenizer = new StringTokenizer( source );
 
-        String lineNo = "";
-
         while ( tokenizer.hasMoreTokens() )
         {
             String token = tokenizer.nextToken();
             if ( token.startsWith( className ) )
             {
                 int idx = token.indexOf( ":" );
-                lineNo = token.substring( idx + 1, token.indexOf( ")" ) );
-                break;
+                if ( idx >= 0 )
+                {
+                    int closeIdx = token.lastIndexOf( ")" );
+
+                    if ( closeIdx > idx + 1 )
+                    {
+                        return token.substring( idx + 1, closeIdx );
+                    }
+                }
             }
         }
-        return lineNo;
+        return "";
     }
 
     private void constructHotLinks( Sink sink, ResourceBundle bundle )
