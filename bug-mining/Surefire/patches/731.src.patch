diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
index 45f1c5003..66cdf8c2b 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
@@ -511,6 +511,7 @@ private static void addOutputStreamElement( OutputStreamWriter outputStreamWrite
             outputStreamWriter.flush();
             eos.getUnderlying().write( ByteConstantsHolder.CDATA_START_BYTES ); // emit cdata
             utf8RecodingDeferredFileOutputStream.writeTo( eos );
+            utf8RecodingDeferredFileOutputStream.free();
             eos.getUnderlying().write( ByteConstantsHolder.CDATA_END_BYTES );
             eos.flush();
             xmlWriter.endElement();
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetRunListener.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetRunListener.java
index 2884f68a5..d795bf828 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetRunListener.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/TestSetRunListener.java
@@ -197,6 +197,16 @@ public void testSetStarting( TestSetReportEntry report )
 
     private void clearCapture()
     {
+        if ( testStdOut != null )
+        {
+            testStdOut.commit();
+        }
+
+        if ( testStdErr != null )
+        {
+            testStdErr.commit();
+        }
+
         testStdOut = initDeferred( "stdout" );
         testStdErr = initDeferred( "stderr" );
     }
@@ -275,6 +285,7 @@ public void testSkipped( ReportEntry reportEntry )
     @Override
     public void testExecutionSkippedByUser()
     {
+        clearCapture();
     }
 
     @Override
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/Utf8RecodingDeferredFileOutputStream.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/Utf8RecodingDeferredFileOutputStream.java
index a452f7528..e118ec2f3 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/Utf8RecodingDeferredFileOutputStream.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/Utf8RecodingDeferredFileOutputStream.java
@@ -22,6 +22,7 @@
 import java.io.IOException;
 import java.io.OutputStream;
 import java.io.RandomAccessFile;
+import java.io.UncheckedIOException;
 import java.lang.ref.SoftReference;
 import java.nio.Buffer;
 import java.nio.ByteBuffer;
@@ -29,14 +30,22 @@
 import java.nio.file.Path;
 
 import static java.nio.charset.StandardCharsets.UTF_8;
+// import static java.nio.file.Files.delete;
+import static java.nio.file.Files.notExists;
+import static java.nio.file.Files.size;
 import static java.util.Objects.requireNonNull;
 import static org.apache.maven.surefire.api.util.internal.StringUtils.NL;
 
 import org.apache.maven.surefire.api.util.SureFireFileManager;
 
 /**
- * A deferred file output stream decorator that recodes the bytes written into the stream from the VM default encoding
- * to UTF-8.
+ * A deferred file output stream decorator that encodes the string from the VM to UTF-8.
+ * <br>
+ * The deferred file is temporary file, and it is created at the first {@link #write(String, boolean) write}.
+ * The {@link #writeTo(OutputStream) reads} can be called anytime.
+ * It is highly recommended to {@link #commit() commit} the cache which would close the file stream
+ * and subsequent reads may continue.
+ * The {@link #free()} method would commit and delete the deferred file.
  *
  * @author Andreas Gudian
  */
@@ -123,13 +132,12 @@ public synchronized long getByteCount()
     {
         try
         {
-            long length = 0;
-            if ( storage != null )
+            sync();
+            if ( storage != null && !closed )
             {
-                sync();
-                length = storage.length();
+                storage.getFD().sync();
             }
-            return length;
+            return file == null ? 0 : size( file );
         }
         catch ( IOException e )
         {
@@ -141,36 +149,87 @@ public synchronized long getByteCount()
     public synchronized void writeTo( OutputStream out )
         throws IOException
     {
+        if ( file != null && notExists( file ) )
+        {
+            storage = null;
+        }
+
+        if ( ( storage == null && file != null ) || ( storage != null && !storage.getChannel().isOpen() ) )
+        {
+            storage = new RandomAccessFile( file.toFile(), "rw" );
+        }
+
         if ( storage != null )
         {
             sync();
+            final long currentFilePosition = storage.getFilePointer();
             storage.seek( 0L );
-            byte[] buffer = new byte[CACHE_SIZE];
-            for ( int readCount; ( readCount = storage.read( buffer ) ) != -1; )
+            try
+            {
+                byte[] buffer = new byte[CACHE_SIZE];
+                for ( int readCount; ( readCount = storage.read( buffer ) ) != -1; )
+                {
+                    out.write( buffer, 0, readCount );
+                }
+            }
+            finally
             {
-                out.write ( buffer, 0, readCount );
+                storage.seek( currentFilePosition );
             }
         }
     }
 
+    public synchronized void commit()
+    {
+        if ( storage == null )
+        {
+            return;
+        }
+
+        try
+        {
+            sync();
+            storage.close();
+        }
+        catch ( IOException e )
+        {
+            throw new UncheckedIOException( e );
+        }
+        finally
+        {
+            storage = null;
+            cache = null;
+            largeCache = null;
+        }
+    }
+
     public synchronized void free()
     {
         if ( !closed )
         {
             closed = true;
-            if ( cache != null )
+            if ( file != null )
             {
                 try
                 {
-                    sync();
-                    storage.close();
-                    Files.delete( file );
+                    commit();
+                    //todo delete( file ); uncomment L485 assertThat( file ).doesNotExist() in StatelessXmlReporterTest
                 }
-                catch ( IOException e )
+                catch ( /*todo uncomment IOException |*/ UncheckedIOException e )
                 {
+                    /*todo uncomment file.toFile()
+                        .deleteOnExit();*/
+                }
+                finally
+                {
+                    // todo should be removed after uncommented delete( file )
                     file.toFile()
                         .deleteOnExit();
                 }
+
+                storage = null;
+                cache = null;
+                largeCache = null;
             }
         }
     }
@@ -184,14 +243,17 @@ private void sync() throws IOException
 
         isDirty = false;
 
-        ( (Buffer) cache ).flip();
-        byte[] array = cache.array();
-        int offset = cache.arrayOffset() + ( (Buffer) cache ).position();
-        int length = cache.remaining();
-        ( (Buffer) cache ).clear();
-        storage.write( array, offset, length );
-        // the data that you wrote with the mode "rw" may still only be kept in memory and may be read back
-        // storage.getFD().sync();
+        if ( storage != null && cache != null )
+        {
+            ( (Buffer) cache ).flip();
+            byte[] array = cache.array();
+            int offset = cache.arrayOffset() + ( (Buffer) cache ).position();
+            int length = cache.remaining();
+            ( (Buffer) cache ).clear();
+            storage.write( array, offset, length );
+            // the data that you wrote with the mode "rw" may still only be kept in memory and may be read back
+            // storage.getFD().sync();
+        }
     }
 
     @SuppressWarnings( "checkstyle:innerassignment" )
diff --git a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporterTest.java b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporterTest.java
index 8744c91f0..47fb587fb 100644
--- a/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporterTest.java
+++ b/maven-surefire-common/src/test/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporterTest.java
@@ -380,12 +380,16 @@ public void testLengthOnDeferredFile() throws Exception
 
         assertThat( out.getByteCount() ).isZero();
 
-        RandomAccessFile storage = mock( RandomAccessFile.class );
+        File f = File.createTempFile( "test", "tmp" );
+        RandomAccessFile storage = new RandomAccessFile( f, "rw" );
         setInternalState( out, "storage", storage );
-        when( storage.length() ).thenReturn( 1L );
+        setInternalState( out, "file", f.toPath() );
+        storage.writeByte( 0 );
+        storage.getFD().sync();
         assertThat( out.getByteCount() ).isEqualTo( 1 );
 
-        when( storage.length() ).thenThrow( IOException.class );
+        storage.close();
+        assertThat( f.delete() ).isTrue();
         assertThat( out.getByteCount() ).isZero();
         out.free();
     }
@@ -482,7 +486,7 @@ public void testSyncOnDeferredFile() throws Exception
         assertThat( (boolean) getInternalState( out, "closed" ) ).isFalse();
         out.free();
         assertThat( (boolean) getInternalState( out, "closed" ) ).isTrue();
-        assertThat( file ).doesNotExist();
+        //todo assertThat( file ).doesNotExist();
         out.free();
         assertThat( (boolean) getInternalState( out, "closed" ) ).isTrue();
     }
