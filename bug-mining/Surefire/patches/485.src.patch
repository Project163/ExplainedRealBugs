diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/booter/TwoPropertiesWrapper.java b/surefire-api/src/main/java/org/apache/maven/surefire/booter/BiProperty.java
similarity index 93%
rename from surefire-api/src/main/java/org/apache/maven/surefire/booter/TwoPropertiesWrapper.java
rename to surefire-api/src/main/java/org/apache/maven/surefire/booter/BiProperty.java
index 5c6e6903d..b49e12bd2 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/booter/TwoPropertiesWrapper.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/booter/BiProperty.java
@@ -27,12 +27,12 @@
  * @param <P1> first property
  * @param <P2> second property
  */
-final class TwoPropertiesWrapper<P1, P2>
+final class BiProperty<P1, P2>
 {
     private final P1 p1;
     private final P2 p2;
 
-    TwoPropertiesWrapper( P1 p1, P2 p2 )
+    BiProperty( P1 p1, P2 p2 )
     {
         this.p1 = p1;
         this.p2 = p2;
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/booter/MasterProcessListener.java b/surefire-api/src/main/java/org/apache/maven/surefire/booter/CommandListener.java
similarity index 93%
rename from surefire-api/src/main/java/org/apache/maven/surefire/booter/MasterProcessListener.java
rename to surefire-api/src/main/java/org/apache/maven/surefire/booter/CommandListener.java
index 89a4f89a7..523ca7644 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/booter/MasterProcessListener.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/booter/CommandListener.java
@@ -20,9 +20,9 @@
  */
 
 /**
- * listener interface
+ * Command listener interface.
  */
-public interface MasterProcessListener
+public interface CommandListener
 {
     void update( Command command );
 }
diff --git a/surefire-api/src/main/java/org/apache/maven/surefire/booter/MasterProcessReader.java b/surefire-api/src/main/java/org/apache/maven/surefire/booter/CommandReader.java
similarity index 53%
rename from surefire-api/src/main/java/org/apache/maven/surefire/booter/MasterProcessReader.java
rename to surefire-api/src/main/java/org/apache/maven/surefire/booter/CommandReader.java
index dabe80af1..45e8a2442 100644
--- a/surefire-api/src/main/java/org/apache/maven/surefire/booter/MasterProcessReader.java
+++ b/surefire-api/src/main/java/org/apache/maven/surefire/booter/CommandReader.java
@@ -29,6 +29,7 @@
 import java.util.NoSuchElementException;
 import java.util.Queue;
 import java.util.concurrent.ConcurrentLinkedQueue;
+import java.util.concurrent.CopyOnWriteArrayList;
 import java.util.concurrent.CountDownLatch;
 import java.util.concurrent.Semaphore;
 import java.util.concurrent.atomic.AtomicReference;
@@ -55,12 +56,14 @@
  * @author <a href="mailto:tibordigana@apache.org">Tibor Digana (tibor17)</a>
  * @since 2.19
  */
-public final class MasterProcessReader
+public final class CommandReader
 {
-    private static final MasterProcessReader READER = new MasterProcessReader();
+    private static final String LAST_TEST_SYMBOL = "";
 
-    private final Queue<TwoPropertiesWrapper<MasterProcessCommand, MasterProcessListener>> listeners
-        = new ConcurrentLinkedQueue<TwoPropertiesWrapper<MasterProcessCommand, MasterProcessListener>>();
+    private static final CommandReader READER = new CommandReader();
+
+    private final Queue<BiProperty<MasterProcessCommand, CommandListener>> listeners
+        = new ConcurrentLinkedQueue<BiProperty<MasterProcessCommand, CommandListener>>();
 
     private final Thread commandThread = newDaemonThread( new CommandRunnable(), "surefire-forkedjvm-command-thread" );
 
@@ -68,23 +71,15 @@ public final class MasterProcessReader
 
     private final CountDownLatch startMonitor = new CountDownLatch( 1 );
 
-    private final Node headTestClassQueue = new Node();
-
-    private final Semaphore newCommandNotifier = new Semaphore( 0 );
+    private final Semaphore nextCommandNotifier = new Semaphore( 0 );
 
-    private volatile Node tailTestClassQueue = headTestClassQueue;
+    private final CopyOnWriteArrayList<String> testClasses = new CopyOnWriteArrayList<String>();
 
     private volatile Shutdown shutdown;
 
-    private static class Node
-    {
-        final AtomicReference<Node> successor = new AtomicReference<Node>();
-        volatile String item;
-    }
-
-    public static MasterProcessReader getReader()
+    public static CommandReader getReader()
     {
-        final MasterProcessReader reader = READER;
+        final CommandReader reader = READER;
         if ( reader.state.compareAndSet( NEW, RUNNABLE ) )
         {
             reader.commandThread.start();
@@ -92,7 +87,7 @@ public static MasterProcessReader getReader()
         return reader;
     }
 
-    public MasterProcessReader setShutdown( Shutdown shutdown )
+    public CommandReader setShutdown( Shutdown shutdown )
     {
         this.shutdown = shutdown;
         return this;
@@ -122,47 +117,46 @@ public boolean awaitStarted()
     /**
      * @param listener listener called with <em>Any</em> {@link MasterProcessCommand command type}
      */
-    public void addListener( MasterProcessListener listener )
+    public void addListener( CommandListener listener )
     {
-        listeners.add( new TwoPropertiesWrapper<MasterProcessCommand, MasterProcessListener>( null, listener ) );
+        listeners.add( new BiProperty<MasterProcessCommand, CommandListener>( null, listener ) );
     }
 
-    public void addTestListener( MasterProcessListener listener )
+    public void addTestListener( CommandListener listener )
     {
         addListener( RUN_CLASS, listener );
     }
 
-    public void addTestsFinishedListener( MasterProcessListener listener )
+    public void addTestsFinishedListener( CommandListener listener )
     {
         addListener( TEST_SET_FINISHED, listener );
     }
 
-    public void addSkipNextListener( MasterProcessListener listener )
+    public void addSkipNextListener( CommandListener listener )
     {
         addListener( SKIP_SINCE_NEXT_TEST, listener );
     }
 
-    public void addShutdownListener( MasterProcessListener listener )
+    public void addShutdownListener( CommandListener listener )
     {
         addListener( SHUTDOWN, listener );
     }
 
-    public void addNoopListener( MasterProcessListener listener )
+    public void addNoopListener( CommandListener listener )
     {
         addListener( NOOP, listener );
     }
 
-    private void addListener( MasterProcessCommand cmd, MasterProcessListener listener )
+    private void addListener( MasterProcessCommand cmd, CommandListener listener )
     {
-        listeners.add( new TwoPropertiesWrapper<MasterProcessCommand, MasterProcessListener>( cmd, listener ) );
+        listeners.add( new BiProperty<MasterProcessCommand, CommandListener>( cmd, listener ) );
     }
 
-    public void removeListener( MasterProcessListener listener )
+    public void removeListener( CommandListener listener )
     {
-        for ( Iterator<TwoPropertiesWrapper<MasterProcessCommand, MasterProcessListener>> it = listeners.iterator();
-            it.hasNext(); )
+        for ( Iterator<BiProperty<MasterProcessCommand, CommandListener>> it = listeners.iterator(); it.hasNext(); )
         {
-            TwoPropertiesWrapper<MasterProcessCommand, MasterProcessListener> listenerWrapper = it.next();
+            BiProperty<MasterProcessCommand, CommandListener> listenerWrapper = it.next();
             if ( listener == listenerWrapper.getP2() )
             {
                 it.remove();
@@ -170,9 +164,15 @@ public void removeListener( MasterProcessListener listener )
         }
     }
 
+    /**
+     * The iterator can be used only in one Thread.
+     *
+     * @param originalOutStream original stream in current JVM process
+     * @return Iterator with test classes lazily loaded as commands from the main process
+     */
     Iterable<String> getIterableClasses( PrintStream originalOutStream )
     {
-        return new ClassesIterable( headTestClassQueue, originalOutStream );
+        return new ClassesIterable( originalOutStream );
     }
 
     public void stop()
@@ -190,107 +190,39 @@ private boolean isStopped()
         return state.get() == TERMINATED;
     }
 
-    private static boolean isLastNode( Node current )
-    {
-        return current.successor.get() == current;
-    }
-
     private boolean isQueueFull()
     {
-        return isLastNode( tailTestClassQueue );
+        return testClasses.contains( LAST_TEST_SYMBOL );
     }
 
-    /**
-     * thread-safety: Must be called from single thread like here the reader thread only.
-     */
-    private boolean addTestClassToQueue( String item )
-    {
-        if ( tailTestClassQueue.item == null )
-        {
-            tailTestClassQueue.item = item;
-            Node newNode = new Node();
-            tailTestClassQueue.successor.set( newNode );
-            tailTestClassQueue = newNode;
-            return true;
-        }
-        else
-        {
-            return false;
-        }
-    }
-
-    /**
-     * After this method returns the queue is closed, new item cannot be added and method
-     * {@link #isQueueFull()} returns true.
-     */
-    @SuppressWarnings( { "all", "checkstyle:needbraces", "checkstyle:emptystatement" } )
     public void makeQueueFull()
     {
-        // order between (#compareAndSet, and #get) matters in multithreading
-        for ( Node tail = this.tailTestClassQueue;
-              !tail.successor.compareAndSet( null, tail ) && tail.successor.get() != tail;
-              tail = tail.successor.get() );
+        testClasses.addIfAbsent( LAST_TEST_SYMBOL );
     }
 
-    /**
-     * thread-safety: Must be called from single thread like here the reader thread only.
-     */
-    private void insertToQueue( Command cmd )
+    public boolean insertToQueue( String test )
     {
-        MasterProcessCommand expectedCommandType = cmd.getCommandType();
-        switch ( expectedCommandType )
+        if ( isNotBlank( test ) && !isQueueFull() )
         {
-            case RUN_CLASS:
-                addTestClassToQueue( cmd.getData() );
-                break;
-            case TEST_SET_FINISHED:
-                makeQueueFull();
-                break;
-            default:
-                // checkstyle noop
-                break;
-        }
-    }
-
-    private void insertToListeners( Command cmd )
-    {
-        MasterProcessCommand expectedCommandType = cmd.getCommandType();
-        for ( TwoPropertiesWrapper<MasterProcessCommand, MasterProcessListener> listenerWrapper
-            : MasterProcessReader.this.listeners )
-        {
-            MasterProcessCommand commandType = listenerWrapper.getP1();
-            MasterProcessListener listener = listenerWrapper.getP2();
-            if ( commandType == null || commandType == expectedCommandType )
-            {
-                listener.update( cmd );
-            }
+            testClasses.add( test );
+            return true;
         }
-    }
-
-    /**
-     * thread-safety: Must be called from single thread like here the reader thread only.
-     */
-    private void insert( Command cmd )
-    {
-        insertToQueue( cmd );
-        insertToListeners( cmd );
+        return false;
     }
 
     private final class ClassesIterable
         implements Iterable<String>
     {
-        private final Node head;
         private final PrintStream originalOutStream;
 
-        ClassesIterable( Node head, PrintStream originalOutStream )
+        ClassesIterable( PrintStream originalOutStream )
         {
-            this.head = head;
             this.originalOutStream = originalOutStream;
         }
 
         public Iterator<String> iterator()
         {
-            return new ClassesIterator( head, originalOutStream );
+            return new ClassesIterator( originalOutStream );
         }
     }
 
@@ -299,13 +231,12 @@ private final class ClassesIterator
     {
         private final PrintStream originalOutStream;
 
-        private Node current;
-
         private String clazz;
 
-        private ClassesIterator( Node current, PrintStream originalOutStream )
+        private int nextQueueIndex = 0;
+
+        private ClassesIterator( PrintStream originalOutStream )
         {
-            this.current = current;
             this.originalOutStream = originalOutStream;
         }
 
@@ -322,7 +253,7 @@ public String next()
             {
                 if ( isBlank( clazz ) )
                 {
-                    throw new NoSuchElementException();
+                    throw new NoSuchElementException( CommandReader.this.isStopped() ? "stream was stopped" : "" );
                 }
                 else
                 {
@@ -342,7 +273,7 @@ public void remove()
 
         private void popUnread()
         {
-            if ( isStopped() )
+            if ( CommandReader.this.isStopped() || CommandReader.this.isQueueFull() )
             {
                 clazz = null;
                 return;
@@ -350,69 +281,22 @@ private void popUnread()
 
             if ( isBlank( clazz ) )
             {
-                do
+                requestNextTest();
+                CommandReader.this.awaitNextTest();
+                if ( CommandReader.this.isStopped() || CommandReader.this.isQueueFull() )
                 {
-                    requestNextTest();
-                    /**
-                     * this branching should be refactored to
-                     * waitNextTest();
-                     * if ( isStopped() )
-                     * {
-                     *      clazz = null;
-                     *      return;
-                     * }
-                     * clazz = current.item;
-                     * if ( !isLastNode( current ) )
-                     * {
-                     *      current = current.successor.get();
-                     * }
-                     */
-                    if ( isLastNode( current ) )
-                    {
-                        clazz = null;
-                    }
-                    else if ( current.item == null )
-                    {
-                        do
-                        {
-                            awaitNextTest();
-                            if ( isStopped() )
-                            {
-                                clazz = null;
-                                return;
-                            }
-                        } while ( current.item == null && !isLastNode( current ) );
-                        clazz = current.item;
-                        current = current.successor.get();
-                    }
-                    else
-                    {
-                        clazz = current.item;
-                        current = current.successor.get();
-                    }
+                    clazz = null;
+                    return;
                 }
-                while ( tryNullWhiteClass() );
+                clazz = CommandReader.this.testClasses.get( nextQueueIndex++ );
             }
 
-            if ( isStopped() )
+            if ( CommandReader.this.isStopped() )
             {
                 clazz = null;
             }
         }
 
-        private boolean tryNullWhiteClass()
-        {
-            if ( clazz != null && isBlank( clazz ) )
-            {
-                clazz = null;
-                return true;
-            }
-            else
-            {
-                return false;
-            }
-        }
-
         private void requestNextTest()
         {
             byte[] encoded = encodeStringForForkCommunication( ( (char) BOOTERCODE_NEXT_TEST ) + ",0,want more!\n" );
@@ -420,28 +304,14 @@ private void requestNextTest()
         }
     }
 
-    /**
-     * thread-safety: Must be called from single thread like here the reader thread only.
-     */
-    private Command read( DataInputStream stdIn )
-        throws IOException
-    {
-        Command command = decode( stdIn );
-        if ( command != null )
-        {
-            insertToQueue( command );
-        }
-        return command;
-    }
-
     private void awaitNextTest()
     {
-        newCommandNotifier.acquireUninterruptibly();
+        nextCommandNotifier.acquireUninterruptibly();
     }
 
     private void wakeupIterator()
     {
-        newCommandNotifier.release();
+        nextCommandNotifier.release();
     }
 
     private final class CommandRunnable
@@ -449,14 +319,14 @@ private final class CommandRunnable
     {
         public void run()
         {
-            MasterProcessReader.this.startMonitor.countDown();
+            CommandReader.this.startMonitor.countDown();
             DataInputStream stdIn = new DataInputStream( System.in );
             boolean isTestSetFinished = false;
             try
             {
-                while ( MasterProcessReader.this.state.get() == RUNNABLE )
+                while ( CommandReader.this.state.get() == RUNNABLE )
                 {
-                    Command command = read( stdIn );
+                    Command command = decode( stdIn );
                     if ( command == null )
                     {
                         System.err.println( "[SUREFIRE] std/in stream corrupted: first sequence not recognized" );
@@ -466,29 +336,36 @@ public void run()
                     {
                         switch ( command.getCommandType() )
                         {
+                            case RUN_CLASS:
+                                String test = command.getData();
+                                boolean inserted = CommandReader.this.insertToQueue( test );
+                                CommandReader.this.wakeupIterator();
+                                if ( inserted )
+                                {
+                                    insertToListeners( command );
+                                }
+                                break;
                             case TEST_SET_FINISHED:
+                                CommandReader.this.makeQueueFull();
                                 isTestSetFinished = true;
-                                wakeupIterator();
-                                break;
-                            case RUN_CLASS:
-                                wakeupIterator();
+                                CommandReader.this.wakeupIterator();
+                                insertToListeners( command );
                                 break;
                             case SHUTDOWN:
-                                insertToQueue( Command.TEST_SET_FINISHED );
-                                wakeupIterator();
+                                CommandReader.this.makeQueueFull();
+                                CommandReader.this.wakeupIterator();
+                                insertToListeners( command );
                                 break;
                             default:
-                                // checkstyle do nothing
+                                insertToListeners( command );
                                 break;
                         }
-
-                        insertToListeners( command );
                     }
                 }
             }
             catch ( EOFException e )
             {
-                MasterProcessReader.this.state.set( TERMINATED );
+                CommandReader.this.state.set( TERMINATED );
                 if ( !isTestSetFinished )
                 {
                     exitByConfiguration();
@@ -497,7 +374,7 @@ public void run()
             }
             catch ( IOException e )
             {
-                MasterProcessReader.this.state.set( TERMINATED );
+                CommandReader.this.state.set( TERMINATED );
                 // If #stop() method is called, reader thread is interrupted and cause is InterruptedException.
                 if ( !( e.getCause() instanceof InterruptedException ) )
                 {
@@ -510,22 +387,33 @@ public void run()
                 // ensure fail-safe iterator as well as safe to finish in for-each loop using ClassesIterator
                 if ( !isTestSetFinished )
                 {
-                    insert( Command.TEST_SET_FINISHED );
+                    CommandReader.this.makeQueueFull();
+                }
+                CommandReader.this.wakeupIterator();
+            }
+        }
+
+        private void insertToListeners( Command cmd )
+        {
+            MasterProcessCommand expectedCommandType = cmd.getCommandType();
+            for ( BiProperty<MasterProcessCommand, CommandListener> listenerWrapper : CommandReader.this.listeners )
+            {
+                MasterProcessCommand commandType = listenerWrapper.getP1();
+                CommandListener listener = listenerWrapper.getP2();
+                if ( commandType == null || commandType == expectedCommandType )
+                {
+                    listener.update( cmd );
                 }
-                wakeupIterator();
             }
         }
 
-        /**
-         * thread-safety: Must be called from single thread like here the reader thread only.
-         */
         private void exitByConfiguration()
         {
-            Shutdown shutdown = MasterProcessReader.this.shutdown; // won't read inconsistent changes through the stack
+            Shutdown shutdown = CommandReader.this.shutdown; // won't read inconsistent changes through the stack
             if ( shutdown != null )
             {
-                insert( Command.TEST_SET_FINISHED ); // lazily
-                wakeupIterator();
+                CommandReader.this.makeQueueFull();
+                CommandReader.this.wakeupIterator();
                 insertToListeners( toShutdown( shutdown ) );
                 switch ( shutdown )
                 {
@@ -541,4 +429,5 @@ private void exitByConfiguration()
             }
         }
     }
+
 }
diff --git a/surefire-booter/src/main/java/org/apache/maven/surefire/booter/ForkedBooter.java b/surefire-booter/src/main/java/org/apache/maven/surefire/booter/ForkedBooter.java
index a0421cc64..ba1c9b766 100644
--- a/surefire-booter/src/main/java/org/apache/maven/surefire/booter/ForkedBooter.java
+++ b/surefire-booter/src/main/java/org/apache/maven/surefire/booter/ForkedBooter.java
@@ -73,7 +73,7 @@ public final class ForkedBooter
      */
     public static void main( String... args )
     {
-        final MasterProcessReader reader = startupMasterProcessReader();
+        final CommandReader reader = startupMasterProcessReader();
         final ScheduledFuture<?> pingScheduler = listenToShutdownCommands( reader );
         final PrintStream originalOut = System.out;
         try
@@ -155,12 +155,12 @@ else if ( readTestsFromInputStream )
         }
     }
 
-    private static MasterProcessReader startupMasterProcessReader()
+    private static CommandReader startupMasterProcessReader()
     {
-        return MasterProcessReader.getReader();
+        return CommandReader.getReader();
     }
 
-    private static ScheduledFuture<?> listenToShutdownCommands( MasterProcessReader reader )
+    private static ScheduledFuture<?> listenToShutdownCommands( CommandReader reader )
     {
         reader.addShutdownListener( createExitHandler( reader ) );
         AtomicBoolean pingDone = new AtomicBoolean( true );
@@ -169,9 +169,9 @@ private static ScheduledFuture<?> listenToShutdownCommands( MasterProcessReader
                                                    0, PING_TIMEOUT_IN_SECONDS, SECONDS );
     }
 
-    private static MasterProcessListener createPingHandler( final AtomicBoolean pingDone )
+    private static CommandListener createPingHandler( final AtomicBoolean pingDone )
     {
-        return new MasterProcessListener()
+        return new CommandListener()
         {
             public void update( Command command )
             {
@@ -180,9 +180,9 @@ public void update( Command command )
         };
     }
 
-    private static MasterProcessListener createExitHandler( final MasterProcessReader reader )
+    private static CommandListener createExitHandler( final CommandReader reader )
     {
-        return new MasterProcessListener()
+        return new CommandListener()
         {
             public void update( Command command )
             {
@@ -191,7 +191,7 @@ public void update( Command command )
         };
     }
 
-    private static Runnable createPingJob( final AtomicBoolean pingDone, final MasterProcessReader reader  )
+    private static Runnable createPingJob( final AtomicBoolean pingDone, final CommandReader reader  )
     {
         return new Runnable()
         {
@@ -212,7 +212,7 @@ private static void encodeAndWriteToOutput( String string, PrintStream out )
         out.write( encodeBytes, 0, encodeBytes.length );
     }
 
-    private static void exit( int returnCode, Shutdown shutdownType, MasterProcessReader reader )
+    private static void exit( int returnCode, Shutdown shutdownType, CommandReader reader )
     {
         switch ( shutdownType )
         {
diff --git a/surefire-booter/src/main/java/org/apache/maven/surefire/booter/LazyTestsToRun.java b/surefire-booter/src/main/java/org/apache/maven/surefire/booter/LazyTestsToRun.java
index d3e770ca5..c94f032db 100644
--- a/surefire-booter/src/main/java/org/apache/maven/surefire/booter/LazyTestsToRun.java
+++ b/surefire-booter/src/main/java/org/apache/maven/surefire/booter/LazyTestsToRun.java
@@ -32,6 +32,8 @@
  * The method {@link #iterator()} returns an Iterator that blocks on calls to
  * {@link Iterator#hasNext()} or {@link Iterator#next()} until new classes are available, or no more
  * classes will be available or the internal stream is closed.
+ * The iterator can be used only in one Thread and it is the thread which executes
+ * {@link org.apache.maven.surefire.providerapi.SurefireProvider provider implementation}.
  *
  * @author Andreas Gudian
  * @author Tibor Digana
@@ -57,7 +59,7 @@ private final class BlockingIterator
         implements Iterator<Class<?>>
     {
         private final Iterator<String> it =
-            MasterProcessReader.getReader().getIterableClasses( originalOutStream ).iterator();
+            CommandReader.getReader().getIterableClasses( originalOutStream ).iterator();
 
         public boolean hasNext()
         {
@@ -77,15 +79,18 @@ public void remove()
 
     }
 
-    /* (non-Javadoc)
-      * @see org.apache.maven.surefire.util.TestsToRun#iterator()
-      */
+    /**
+     * The iterator can be used only in one Thread.
+     * {@inheritDoc}
+     * @see org.apache.maven.surefire.util.TestsToRun#iterator()
+     * */
     public Iterator<Class<?>> iterator()
     {
         return new BlockingIterator();
     }
 
     /* (non-Javadoc)
+     * {@inheritDoc}
       * @see org.apache.maven.surefire.util.TestsToRun#toString()
       */
     public String toString()
@@ -94,6 +99,7 @@ public String toString()
     }
 
     /* (non-Javadoc)
+     * {@inheritDoc}
      * @see org.apache.maven.surefire.util.TestsToRun#allowEagerReading()
      */
     public boolean allowEagerReading()
diff --git a/surefire-booter/src/test/java/org/apache/maven/surefire/booter/MasterProcessReaderTest.java b/surefire-booter/src/test/java/org/apache/maven/surefire/booter/CommandReaderTest.java
similarity index 69%
rename from surefire-booter/src/test/java/org/apache/maven/surefire/booter/MasterProcessReaderTest.java
rename to surefire-booter/src/test/java/org/apache/maven/surefire/booter/CommandReaderTest.java
index fc56421e5..528497459 100644
--- a/surefire-booter/src/test/java/org/apache/maven/surefire/booter/MasterProcessReaderTest.java
+++ b/surefire-booter/src/test/java/org/apache/maven/surefire/booter/CommandReaderTest.java
@@ -31,26 +31,20 @@
 import java.io.PrintStream;
 import java.io.UnsupportedEncodingException;
 import java.nio.ByteBuffer;
-import java.util.Arrays;
 import java.util.Iterator;
 import java.util.NoSuchElementException;
-import java.util.Random;
 import java.util.concurrent.BlockingQueue;
 import java.util.concurrent.CountDownLatch;
 import java.util.concurrent.ExecutionException;
-import java.util.concurrent.ExecutorService;
-import java.util.concurrent.Executors;
-import java.util.concurrent.Future;
 import java.util.concurrent.FutureTask;
 import java.util.concurrent.LinkedBlockingQueue;
-import java.util.concurrent.TimeUnit;
 
 import static org.apache.maven.surefire.util.internal.StringUtils.FORK_STREAM_CHARSET_NAME;
 import static org.junit.Assert.assertFalse;
 import static org.junit.Assert.assertTrue;
 import static org.junit.Assert.fail;
 import static org.hamcrest.MatcherAssert.assertThat;
-import static org.hamcrest.Matchers.*;
+import static org.hamcrest.Matchers.is;
 
 /**
  * Testing singleton {@code MasterProcessReader} in multiple class loaders.
@@ -59,11 +53,11 @@
  * @since 2.19
  */
 @RunWith( NewClassLoaderRunner.class )
-public class MasterProcessReaderTest
+public class CommandReaderTest
 {
     private final BlockingQueue<Byte> blockingStream = new LinkedBlockingQueue<Byte>();
     private InputStream realInputStream;
-    private MasterProcessReader reader;
+    private CommandReader reader;
 
     @Before
     public void init()
@@ -71,9 +65,9 @@ public void init()
     {
         Thread.interrupted();
         realInputStream = System.in;
-        addThisTestToPipeline( getClass().getName() );
+        addTestToPipeline( getClass().getName() );
         System.setIn( new SystemInputStream() );
-        reader = MasterProcessReader.getReader();
+        reader = CommandReader.getReader();
     }
 
     @After
@@ -113,7 +107,7 @@ public void run()
             {
                 Iterator<String> it = reader.getIterableClasses( new PrintStream( new ByteArrayOutputStream() ) )
                     .iterator();
-                assertThat( it.next(), is( MasterProcessReaderTest.class.getName() ) );
+                assertThat( it.next(), is( CommandReaderTest.class.getName() ) );
             }
         };
         FutureTask<Object> futureTask = new FutureTask<Object>( runnable, null );
@@ -141,7 +135,7 @@ public void run()
             {
                 Iterator<String> it = reader.getIterableClasses( new PrintStream( new ByteArrayOutputStream() ) )
                     .iterator();
-                assertThat( it.next(), is( MasterProcessReaderTest.class.getName() ) );
+                assertThat( it.next(), is( CommandReaderTest.class.getName() ) );
                 counter.countDown();
                 assertThat( it.next(), is( PropertiesWrapperTest.class.getName() ) );
             }
@@ -150,7 +144,7 @@ public void run()
         Thread t = new Thread( futureTask );
         t.start();
         counter.await();
-        addThisTestToPipeline( PropertiesWrapperTest.class.getName() );
+        addTestToPipeline( PropertiesWrapperTest.class.getName() );
         try
         {
             futureTask.get();
@@ -161,46 +155,6 @@ public void run()
         }
     }
 
-    // @Test
-    public void readTwoClassesInTwoThreads()
-        throws Throwable
-    {
-        final Iterable<String> lazyTestSet =
-            reader.getIterableClasses( new PrintStream( new ByteArrayOutputStream() ) );
-
-        class Provider implements Runnable
-        {
-            public void run()
-            {
-                Iterator<String> it = lazyTestSet.iterator();
-                assertThat( it.next(), is( MasterProcessReaderTest.class.getName() ) );
-                assertThat( it.next(), is( PropertiesWrapperTest.class.getName() ) );
-                assertFalse( it.hasNext() );
-            }
-        }
-
-        ExecutorService es = Executors.newFixedThreadPool( 2 );
-        Future<?> result1 = es.submit( new Provider() );
-        Random rnd = new Random();
-        TimeUnit.MILLISECONDS.sleep( rnd.nextInt( 50 ) );
-        Future<?> result2 = es.submit( new Provider() );
-        TimeUnit.MILLISECONDS.sleep( rnd.nextInt( 50 ) );
-        addThisTestToPipeline( PropertiesWrapperTest.class.getName() );
-        TimeUnit.MILLISECONDS.sleep( rnd.nextInt( 50 ) );
-        addTestSetFinishedToPipeline();
-        for ( Future<?> result : Arrays.asList( result1, result2 ) )
-        {
-            try
-            {
-                result.get();
-            }
-            catch ( ExecutionException e )
-            {
-                throw e.getCause();
-            }
-        }
-    }
-
     @Test( timeout = 15000 )
     public void shouldAwaitReaderUp()
         throws TestSetFailedException
@@ -219,7 +173,7 @@ public int read()
         {
             try
             {
-                return MasterProcessReaderTest.this.blockingStream.take();
+                return CommandReaderTest.this.blockingStream.take();
             }
             catch ( InterruptedException e )
             {
@@ -228,7 +182,7 @@ public int read()
         }
     }
 
-    private void addThisTestToPipeline( String cls )
+    private void addTestToPipeline( String cls )
         throws UnsupportedEncodingException
     {
         byte[] clazz = cls.getBytes( FORK_STREAM_CHARSET_NAME );
@@ -242,13 +196,4 @@ private void addThisTestToPipeline( String cls )
             blockingStream.add( buffer.get() );
         }
     }
-
-    private void addTestSetFinishedToPipeline()
-        throws UnsupportedEncodingException
-    {
-        for ( byte b : MasterProcessCommand.TEST_SET_FINISHED.encode() )
-        {
-            blockingStream.add( b );
-        }
-    }
 }
diff --git a/surefire-booter/src/test/java/org/apache/maven/surefire/booter/JUnit4SuiteTest.java b/surefire-booter/src/test/java/org/apache/maven/surefire/booter/JUnit4SuiteTest.java
index 5e8477532..2bdcf21b3 100644
--- a/surefire-booter/src/test/java/org/apache/maven/surefire/booter/JUnit4SuiteTest.java
+++ b/surefire-booter/src/test/java/org/apache/maven/surefire/booter/JUnit4SuiteTest.java
@@ -32,7 +32,7 @@
  */
 @Suite.SuiteClasses( {
     ClasspathTest.class,
-    MasterProcessReaderTest.class,
+    CommandReaderTest.class,
     PropertiesWrapperTest.class,
     SurefireReflectorTest.class
 } )
diff --git a/surefire-providers/surefire-junit4/src/main/java/org/apache/maven/surefire/junit4/JUnit4Provider.java b/surefire-providers/surefire-junit4/src/main/java/org/apache/maven/surefire/junit4/JUnit4Provider.java
index 948d514ab..85b2a98e6 100644
--- a/surefire-providers/surefire-junit4/src/main/java/org/apache/maven/surefire/junit4/JUnit4Provider.java
+++ b/surefire-providers/surefire-junit4/src/main/java/org/apache/maven/surefire/junit4/JUnit4Provider.java
@@ -20,8 +20,8 @@
  */
 
 import org.apache.maven.surefire.booter.Command;
-import org.apache.maven.surefire.booter.MasterProcessListener;
-import org.apache.maven.surefire.booter.MasterProcessReader;
+import org.apache.maven.surefire.booter.CommandListener;
+import org.apache.maven.surefire.booter.CommandReader;
 import org.apache.maven.surefire.common.junit4.ClassMethod;
 import org.apache.maven.surefire.common.junit4.JUnit4RunListener;
 import org.apache.maven.surefire.common.junit4.JUnit4TestChecker;
@@ -92,14 +92,14 @@ public class JUnit4Provider
 
     private final int rerunFailingTestsCount;
 
-    private final MasterProcessReader commandsReader;
+    private final CommandReader commandsReader;
 
     private TestsToRun testsToRun;
 
     public JUnit4Provider( ProviderParameters booterParameters )
     {
         // don't start a thread in MasterProcessReader while we are in in-plugin process
-        commandsReader = booterParameters.isInsideFork() ? MasterProcessReader.getReader().setShutdown(
+        commandsReader = booterParameters.isInsideFork() ? CommandReader.getReader().setShutdown(
             booterParameters.getShutdown() ) : null;
         providerParameters = booterParameters;
         testClassLoader = booterParameters.getTestClassLoader();
@@ -170,7 +170,7 @@ else if ( forkTestSet instanceof Class )
 
                 if ( commandsReader != null )
                 {
-                    commandsReader.addShutdownListener( new MasterProcessListener()
+                    commandsReader.addShutdownListener( new CommandListener()
                     {
                         public void update( Command command )
                         {
@@ -224,9 +224,9 @@ private void closeCommandsReader()
         }
     }
 
-    private MasterProcessListener registerPleaseStopJunitListener( final Notifier notifier )
+    private CommandListener registerPleaseStopJunitListener( final Notifier notifier )
     {
-        MasterProcessListener listener = new MasterProcessListener()
+        CommandListener listener = new CommandListener()
         {
             public void update( Command command )
             {
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreProvider.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreProvider.java
index f2fa49f5c..5e03bffd1 100644
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreProvider.java
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/JUnitCoreProvider.java
@@ -20,8 +20,8 @@
  */
 
 import org.apache.maven.surefire.booter.Command;
-import org.apache.maven.surefire.booter.MasterProcessListener;
-import org.apache.maven.surefire.booter.MasterProcessReader;
+import org.apache.maven.surefire.booter.CommandListener;
+import org.apache.maven.surefire.booter.CommandReader;
 import org.apache.maven.surefire.common.junit4.JUnit4RunListener;
 import org.apache.maven.surefire.common.junit4.JUnitTestFailureListener;
 import org.apache.maven.surefire.common.junit4.Notifier;
@@ -83,14 +83,14 @@ public class JUnitCoreProvider
 
     private final TestListResolver testResolver;
 
-    private final MasterProcessReader commandsReader;
+    private final CommandReader commandsReader;
 
     private TestsToRun testsToRun;
 
     public JUnitCoreProvider( ProviderParameters providerParameters )
     {
         commandsReader = providerParameters.isInsideFork()
-            ? MasterProcessReader.getReader().setShutdown( providerParameters.getShutdown() )
+            ? CommandReader.getReader().setShutdown( providerParameters.getShutdown() )
             : null;
         this.providerParameters = providerParameters;
         testClassLoader = providerParameters.getTestClassLoader();
@@ -167,7 +167,7 @@ else if ( forkTestSet instanceof Class )
 
             if ( commandsReader != null )
             {
-                commandsReader.addShutdownListener( new MasterProcessListener()
+                commandsReader.addShutdownListener( new CommandListener()
                 {
                     public void update( Command command )
                     {
@@ -225,9 +225,9 @@ private void closeCommandsReader()
         }
     }
 
-    private MasterProcessListener registerPleaseStopJunitListener( final Notifier stoppable )
+    private CommandListener registerPleaseStopJunitListener( final Notifier stoppable )
     {
-        MasterProcessListener listener = new MasterProcessListener()
+        CommandListener listener = new CommandListener()
         {
             public void update( Command command )
             {
diff --git a/surefire-providers/surefire-testng/src/main/java/org/apache/maven/surefire/testng/TestNGProvider.java b/surefire-providers/surefire-testng/src/main/java/org/apache/maven/surefire/testng/TestNGProvider.java
index 75d8463ad..5444fde2b 100644
--- a/surefire-providers/surefire-testng/src/main/java/org/apache/maven/surefire/testng/TestNGProvider.java
+++ b/surefire-providers/surefire-testng/src/main/java/org/apache/maven/surefire/testng/TestNGProvider.java
@@ -20,8 +20,8 @@
  */
 
 import org.apache.maven.surefire.booter.Command;
-import org.apache.maven.surefire.booter.MasterProcessListener;
-import org.apache.maven.surefire.booter.MasterProcessReader;
+import org.apache.maven.surefire.booter.CommandListener;
+import org.apache.maven.surefire.booter.CommandReader;
 import org.apache.maven.surefire.cli.CommandLineOption;
 import org.apache.maven.surefire.providerapi.AbstractProvider;
 import org.apache.maven.surefire.providerapi.ProviderParameters;
@@ -66,7 +66,7 @@ public class TestNGProvider
 
     private final List<CommandLineOption> mainCliOptions;
 
-    private final MasterProcessReader commandsReader;
+    private final CommandReader commandsReader;
 
     private TestsToRun testsToRun;
 
@@ -74,7 +74,7 @@ public TestNGProvider( ProviderParameters booterParameters )
     {
         // don't start a thread in MasterProcessReader while we are in in-plugin process
         commandsReader = booterParameters.isInsideFork()
-            ? MasterProcessReader.getReader().setShutdown( booterParameters.getShutdown() )
+            ? CommandReader.getReader().setShutdown( booterParameters.getShutdown() )
             : null;
         providerParameters = booterParameters;
         testClassLoader = booterParameters.getTestClassLoader();
@@ -140,7 +140,7 @@ else if ( forkTestSet instanceof Class )
 
                     if ( commandsReader != null )
                     {
-                        commandsReader.addShutdownListener( new MasterProcessListener()
+                        commandsReader.addShutdownListener( new CommandListener()
                         {
                             public void update( Command command )
                             {
@@ -189,9 +189,9 @@ private void closeCommandsReader()
         }
     }
 
-    private MasterProcessListener registerPleaseStopListener()
+    private CommandListener registerPleaseStopListener()
     {
-        MasterProcessListener listener = new MasterProcessListener()
+        CommandListener listener = new CommandListener()
         {
             public void update( Command command )
             {
