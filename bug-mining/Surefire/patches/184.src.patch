diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/AbstractSurefireMojo.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/AbstractSurefireMojo.java
index eced49d85..b1146f109 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/AbstractSurefireMojo.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/AbstractSurefireMojo.java
@@ -108,8 +108,9 @@ protected List initialize()
         try
         {
             wellKnownProviders = new ProviderList( new ProviderInfo[]{ new TestNgProviderInfo( getTestNgArtifact() ),
-                new JUnitCoreProviderInfo( getJunitArtifact() ), new JUnit4ProviderInfo( getJunitArtifact() ),
-                new JUnit3ProviderInfo() }, new DynamicProviderInfo( null ) );
+                new JUnitCoreProviderInfo( getJunitArtifact() ),
+                new JUnit4ProviderInfo( getJunitArtifact(), getJunitDepArtifact() ), new JUnit3ProviderInfo() },
+                                                   new DynamicProviderInfo( null ) );
 
             return wellKnownProviders.resolve( getLog() );
         }
@@ -481,14 +482,12 @@ private Artifact getTestNgArtifact()
 
     private Artifact getJunitArtifact()
     {
-        Artifact junitArtifact;
-        junitArtifact = (Artifact) getProjectArtifactMap().get( getJunitArtifactName() );
-        // SUREFIRE-378, junit can have an alternate artifact name
-        if ( junitArtifact == null && "junit:junit".equals( getJunitArtifactName() ) )
-        {
-            junitArtifact = (Artifact) getProjectArtifactMap().get( "junit:junit-dep" );
-        }
-        return junitArtifact;
+        return (Artifact) getProjectArtifactMap().get( getJunitArtifactName() );
+    }
+
+    private Artifact getJunitDepArtifact()
+    {
+        return (Artifact) getProjectArtifactMap().get( "junit:junit-dep" );
     }
 
     protected ForkStarter createForkStarter( ProviderInfo provider, ForkConfiguration forkConfiguration,
@@ -578,8 +577,8 @@ protected ForkConfiguration getForkConfiguration()
 
     protected ClassLoaderConfiguration getClassLoaderConfiguration( ForkConfiguration fork )
     {
-        return fork.isForking() ? new ClassLoaderConfiguration( isUseSystemClassLoader(),
-                                                                isUseManifestOnlyJar() )
+        return fork.isForking()
+            ? new ClassLoaderConfiguration( isUseSystemClassLoader(), isUseManifestOnlyJar() )
             : new ClassLoaderConfiguration( false, false );
     }
 
@@ -986,9 +985,12 @@ class JUnit4ProviderInfo
     {
         private final Artifact junitArtifact;
 
-        JUnit4ProviderInfo( Artifact junitArtifact )
+        private final Artifact junitDepArtifact;
+
+        JUnit4ProviderInfo( Artifact junitArtifact, Artifact junitDepArtifact )
         {
             this.junitArtifact = junitArtifact;
+            this.junitDepArtifact = junitDepArtifact;
         }
 
         public String getProviderName()
@@ -998,7 +1000,7 @@ public String getProviderName()
 
         public boolean isApplicable()
         {
-            return isAnyJunit4( junitArtifact );
+            return junitDepArtifact != null || isAnyJunit4( junitArtifact );
         }
 
         public void addProviderProperties()
diff --git a/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/JUnit44Dep.java b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/JUnit44DepIT.java
similarity index 82%
rename from surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/JUnit44Dep.java
rename to surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/JUnit44DepIT.java
index 2ca7714e1..bdb70f9aa 100644
--- a/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/JUnit44Dep.java
+++ b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/JUnit44DepIT.java
@@ -24,10 +24,10 @@
  *
  * @author <a href="mailto:dfabulich@apache.org">Dan Fabulich</a>
  */
-public class JUnit44Dep
+public class JUnit44DepIT
     extends SurefireVerifierTestClass
 {
-    public JUnit44Dep()
+    public JUnit44DepIT()
     {
         super( "/junit44-dep" );
     }
@@ -39,4 +39,14 @@ public void testJUnit44Dep()
         verifyErrorFreeLog();
         assertTestSuiteResults( 1, 0, 0, 0 );
     }
+    public void testJUnit44DepWithSneaky381()
+        throws Exception
+    {
+        activateProfile("provided381");
+        executeTest();
+        verifyErrorFreeLog();
+        assertTestSuiteResults( 1, 0, 0, 0 );
+    }
+
+
 }
diff --git a/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/SurefireVerifierTestClass.java b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/SurefireVerifierTestClass.java
index 1368a8246..745d133b7 100644
--- a/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/SurefireVerifierTestClass.java
+++ b/surefire-integration-tests/src/test/java/org/apache/maven/surefire/its/SurefireVerifierTestClass.java
@@ -229,6 +229,12 @@ protected void forkMode( String forkMode )
         addGoal( "-DforkMode=" + forkMode );
     }
 
+    protected void activateProfile( String profile )
+    {
+        addGoal("-P" + profile);
+    }
+
+
     public void assertTestSuiteResults( int total, int errors, int failures, int skipped )
         throws MavenReportException
     {
diff --git a/surefire-integration-tests/src/test/resources/junit44-dep/pom.xml b/surefire-integration-tests/src/test/resources/junit44-dep/pom.xml
index 62334756e..fe6cdf6c6 100644
--- a/surefire-integration-tests/src/test/resources/junit44-dep/pom.xml
+++ b/surefire-integration-tests/src/test/resources/junit44-dep/pom.xml
@@ -36,7 +36,20 @@
       <scope>test</scope>
     </dependency>
   </dependencies>
-  
+
+  <profiles>
+    <profile>
+      <id>provided381</id>
+      <dependencies>
+        <dependency>
+          <groupId>junit</groupId>
+          <artifactId>junit</artifactId>
+          <version>3.8.1</version>
+          <scope>provided</scope>
+        </dependency>
+      </dependencies>
+    </profile>
+  </profiles>
   <build>
     <plugins>
       <plugin>
