diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/FileReporter.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/FileReporter.java
index 3bab9f538..f2e8e2845 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/FileReporter.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/FileReporter.java
@@ -27,9 +27,11 @@
 import org.apache.maven.surefire.report.ReportEntry;
 import org.apache.maven.surefire.report.ReporterException;
 
+import static org.apache.maven.plugin.surefire.report.FileReporterUtils.stripIllegalFilenameChars;
+
 /**
  * Base class for file reporters.
- *
+ * 
  * @author <a href="mailto:brett@apache.org">Brett Porter</a>
  * @author Kristian Rosenvold
  */
@@ -55,12 +57,12 @@ private PrintWriter testSetStarting( ReportEntry report )
 
         File reportDir = reportFile.getParentFile();
 
-        //noinspection ResultOfMethodCallIgnored
+        // noinspection ResultOfMethodCallIgnored
         reportDir.mkdirs();
 
         if ( deleteOnStarting && reportFile.exists() )
         {
-            //noinspection ResultOfMethodCallIgnored
+            // noinspection ResultOfMethodCallIgnored
             reportFile.delete();
         }
 
@@ -89,11 +91,13 @@ public static File getReportFile( File reportsDirectory, String reportEntryName,
 
         if ( reportNameSuffix != null && reportNameSuffix.length() > 0 )
         {
-            reportFile = new File( reportsDirectory, reportEntryName + "-" + reportNameSuffix + fileExtension );
+            reportFile =
+                new File( reportsDirectory, stripIllegalFilenameChars( reportEntryName + "-" + reportNameSuffix
+                    + fileExtension ) );
         }
         else
         {
-            reportFile = new File( reportsDirectory, reportEntryName + fileExtension );
+            reportFile = new File( reportsDirectory, stripIllegalFilenameChars( reportEntryName + fileExtension ) );
         }
         return reportFile;
     }
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/FileReporterUtils.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/FileReporterUtils.java
new file mode 100644
index 000000000..5009da9fa
--- /dev/null
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/FileReporterUtils.java
@@ -0,0 +1,50 @@
+package org.apache.maven.plugin.surefire.report;
+
+/*
+ * Licensed to the Apache Software Foundation (ASF) under one
+ * or more contributor license agreements.  See the NOTICE file
+ * distributed with this work for additional information
+ * regarding copyright ownership.  The ASF licenses this file
+ * to you under the Apache License, Version 2.0 (the
+ * "License"); you may not use this file except in compliance
+ * with the License.  You may obtain a copy of the License at
+ *
+ *     http://www.apache.org/licenses/LICENSE-2.0
+ *
+ * Unless required by applicable law or agreed to in writing,
+ * software distributed under the License is distributed on an
+ * "AS IS" BASIS, WITHOUT WARRANTIES OR CONDITIONS OF ANY
+ * KIND, either express or implied.  See the License for the
+ * specific language governing permissions and limitations
+ * under the License.
+ */
+
+/**
+ * Utils class for file-based reporters
+ * 
+ * @author Andreas Gudian
+ */
+public class FileReporterUtils
+{
+    public static String stripIllegalFilenameChars( String original )
+    {
+        String result = original;
+        String illegalChars = getOSSpecificIllegalChars();
+        for ( int i = 0; i < illegalChars.length(); i++ )
+            result = result.replace( illegalChars.charAt( i ), '_' );
+
+        return result;
+    }
+
+    private static String getOSSpecificIllegalChars()
+    {
+        if ( System.getProperty( "os.name" ).toLowerCase().startsWith( "win" ) )
+        {
+            return "\\/:*?\"<>|\0";
+        }
+        else
+        {
+            return "/\0";
+        }
+    }
+}
diff --git a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
index d72a08ed3..cb3314fe8 100644
--- a/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
+++ b/maven-surefire-common/src/main/java/org/apache/maven/plugin/surefire/report/StatelessXmlReporter.java
@@ -32,6 +32,8 @@
 import org.apache.maven.surefire.report.ReporterException;
 import org.apache.maven.surefire.report.SafeThrowable;
 
+import static org.apache.maven.plugin.surefire.report.FileReporterUtils.stripIllegalFilenameChars;
+
 /**
  * XML format reporter writing to <code>TEST-<i>reportName</i>[-<i>suffix</i>].xml</code> file like written and read
  * by Ant's <a href="http://ant.apache.org/manual/Tasks/junit.html"><code>&lt;junit&gt;</code></a> and
@@ -148,16 +150,18 @@ private File getReportFile( ReportEntry report, File reportsDirectory, String re
 
         if ( reportNameSuffix != null && reportNameSuffix.length() > 0 )
         {
-            reportFile = new File( reportsDirectory, "TEST-" + report.getName() + "-" + reportNameSuffix + ".xml" );
+            reportFile =
+                new File( reportsDirectory, stripIllegalFilenameChars( "TEST-" + report.getName() + "-"
+                    + reportNameSuffix + ".xml" ) );
         }
         else
         {
-            reportFile = new File( reportsDirectory, "TEST-" + report.getName() + ".xml" );
+            reportFile = new File( reportsDirectory, stripIllegalFilenameChars( "TEST-" + report.getName() + ".xml" ) );
         }
 
         return reportFile;
     }
-
+    
     private static void startTestElement( XMLWriter ppw, WrappedReportEntry report, String reportNameSuffix )
     {
         ppw.startElement( "testcase" );
diff --git a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/NonConcurrentRunListener.java b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/NonConcurrentRunListener.java
index cf4d19d46..dcf861512 100644
--- a/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/NonConcurrentRunListener.java
+++ b/surefire-providers/surefire-junit47/src/main/java/org/apache/maven/surefire/junitcore/NonConcurrentRunListener.java
@@ -24,7 +24,6 @@
 import org.apache.maven.surefire.report.RunListener;
 import org.apache.maven.surefire.report.SimpleReportEntry;
 import org.apache.maven.surefire.testset.TestSetFailedException;
-
 import org.junit.runner.Description;
 import org.junit.runner.Result;
 import org.junit.runner.notification.Failure;
@@ -39,7 +38,7 @@ public class NonConcurrentRunListener
     implements ConsoleOutputReceiver
 {
 
-    private java.lang.Class<?> currentTestClass;
+    private Description currentTestSetDescription;
 
     private Description lastFinishedDescription;
 
@@ -57,14 +56,20 @@ public synchronized void writeTestOutput( byte[] buf, int off, int len, boolean
 
     protected SimpleReportEntry createReportEntry( Description description )
     {
-        return new SimpleReportEntry( description.getClassName(), description.getDisplayName()/*,
-                                       (int) ( System.currentTimeMillis() - startTime ) */);
+        return new SimpleReportEntry( description.getClassName(), description.getDisplayName()/*
+                                                                                               * , (int) (
+                                                                                               * System.currentTimeMillis
+                                                                                               * () - startTime )
+                                                                                               */);
     }
 
     protected SimpleReportEntry createReportEntryForTestSet( Description description )
     {
-        return new SimpleReportEntry( description.getClassName(), description.getClassName() /*,
-                                       (int) ( System.currentTimeMillis() - startTime ) */);
+        return new SimpleReportEntry( description.getClassName(), description.getClassName() /*
+                                                                                              * , (int) (
+                                                                                              * System.currentTimeMillis
+                                                                                              * () - startTime )
+                                                                                              */);
     }
 
     @Override
@@ -77,9 +82,9 @@ public void testStarted( Description description )
 
     private void finishLastTestSetIfNeccessary( Description description )
     {
-        if ( !description.getTestClass().equals( currentTestClass ) )
+        if ( describesNewTestSet( description ) )
         {
-            currentTestClass = description.getTestClass();
+            currentTestSetDescription = description;
             if ( lastFinishedDescription != null )
             {
                 reporter.testSetCompleted( createReportEntryForTestSet( lastFinishedDescription ) );
@@ -89,6 +94,25 @@ private void finishLastTestSetIfNeccessary( Description description )
         }
     }
 
+    private boolean describesNewTestSet( Description description )
+    {
+        if ( currentTestSetDescription != null )
+        {
+            if ( null != description.getTestClass() )
+            {
+                return !description.getTestClass().equals( currentTestSetDescription.getTestClass() );
+            }
+            else if ( description.isSuite() )
+            {
+                return description.getChildren().equals( currentTestSetDescription.getChildren() );
+            }
+            
+            return false;
+        }
+
+        return true;
+    }
+
     @Override
     public void testFinished( Description description )
         throws Exception
