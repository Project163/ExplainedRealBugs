diff --git a/Slim/Router.php b/Slim/Router.php
index 180d55d2..cf1bdc42 100644
--- a/Slim/Router.php
+++ b/Slim/Router.php
@@ -30,6 +30,13 @@ use Slim\Route;
  */
 class Router extends RouteCollector implements RouterInterface
 {
+    /**
+     * Parser
+     *
+     * @var \FastRoute\RouteParser
+     */
+    private $routeParser;
+
     /**
      * Routes
      *
@@ -62,6 +69,7 @@ class Router extends RouteCollector implements RouterInterface
         $parser = $parser ? $parser : new StdParser;
         $generator = $generator ? $generator : new GroupCountBasedGenerator;
         parent::__construct($parser, $generator);
+        $this->routeParser = $parser;
     }
 
     /**
@@ -181,14 +189,44 @@ class Router extends RouteCollector implements RouterInterface
         $route = $this->namedRoutes[$name];
         $pattern = $route->getPattern();
 
-        $url = preg_replace_callback('/{([^}]+)}/', function ($match) use ($data) {
-            $segmentName = explode(':', $match[1])[0];
-            if (!isset($data[$segmentName])) {
-                throw new InvalidArgumentException('Missing data for URL segment: ' . $segmentName);
+        $routeDatas = ($this->routeParser->parse($pattern));
+        // $routeDatas is an array of all possible routes that can be made. There is
+        // one routedata for each optional parameter plus one for no optional parameters.
+        //
+        // The most specific is last, so we look for that first.
+        $routeDatas = array_reverse($routeDatas);
+
+        $segments = [];
+        foreach ($routeDatas as $routeData) {
+            foreach ($routeData as $item) {
+                if (is_string($item)) {
+                    // this segment is a static string
+                    $segments[] = $item;
+                    continue;
+                }
+
+                // This segment has a parameter: first element is the name
+                if (!array_key_exists($item[0], $data)) {
+                    // we don't have a data element for this segment: cancel
+                    // testing this routeData item, so that we can try a less
+                    // specific routeData item.
+                    $segments = [];
+                    $segmentName = $item[0];
+                    break;
+                }
+                $segments[] = $data[$item[0]];
             }
+            if (!empty($segments)) {
+                // we found all the parameters for this route data, no need to check
+                // less specific ones
+                break;
+            }
+        }
 
-            return $data[$segmentName];
-        }, $pattern);
+        if (empty($segments)) {
+            throw new InvalidArgumentException('Missing data for URL segment: ' . $segmentName);
+        }
+        $url = implode('', $segments);
 
         if ($queryParams) {
             $url .= '?' . http_build_query($queryParams);
