{"url":"https://api.github.com/repos/slimphp/Slim/issues/598","repository_url":"https://api.github.com/repos/slimphp/Slim","labels_url":"https://api.github.com/repos/slimphp/Slim/issues/598/labels{/name}","comments_url":"https://api.github.com/repos/slimphp/Slim/issues/598/comments","events_url":"https://api.github.com/repos/slimphp/Slim/issues/598/events","html_url":"https://github.com/slimphp/Slim/issues/598","id":18236161,"node_id":"MDU6SXNzdWUxODIzNjE2MQ==","number":598,"title":"Decrypt function may inadvertently corrupt data","user":{"login":"manuelh","id":2478320,"node_id":"MDQ6VXNlcjI0NzgzMjA=","avatar_url":"https://avatars.githubusercontent.com/u/2478320?v=4","gravatar_id":"","url":"https://api.github.com/users/manuelh","html_url":"https://github.com/manuelh","followers_url":"https://api.github.com/users/manuelh/followers","following_url":"https://api.github.com/users/manuelh/following{/other_user}","gists_url":"https://api.github.com/users/manuelh/gists{/gist_id}","starred_url":"https://api.github.com/users/manuelh/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/manuelh/subscriptions","organizations_url":"https://api.github.com/users/manuelh/orgs","repos_url":"https://api.github.com/users/manuelh/repos","events_url":"https://api.github.com/users/manuelh/events{/privacy}","received_events_url":"https://api.github.com/users/manuelh/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2013-08-19T12:15:13Z","updated_at":"2013-09-13T15:15:10Z","closed_at":"2013-09-13T15:15:10Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"In Slim\\Http\\Util.php the decrypt function uses $res = str_replace(\"\\x0\", '', $decryptedData); to remove extra padding adding during encryption.\n\nExtra padding is only ever appended at the end of the data. When using str_replace it looks for \"\\x0\" throughout the whole file data, potentially removing valid data and corrupting it. This will lead to the verification check ( if ( $verificationString === $value[2] )) inside of decodeSecureCookie() to fail.\n\nInstead, if we replace str_replace() with rtrim(), rtrim() will only remove \"\\x0\" from the end of the data, which is the desired behavior.\n\nBelow, using our sample data:\n\nEncode:\n\n```\n─[       0/     4F7]──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[dataEncode]─\n       0     61 3a 33 3a 7b 73 3a 31  30 3a 22 73 6c 69 6d 2e  66 6c 61 73 68 22 3b 61  3a 30 3a 7b 7d 73 3a 31  31 3a 22 41 63 63 65 73  73 54 6f 6b 65 6e      a:3:{s:10:\"slim.flash\";a:0:{}s:11:\"AccessToken\n      2E     22 3b 4f 3a 31 33 3a 22  4f 41 75 74 68 52 65 73  70 6f 6e 63 65 22 3a 37  3a 7b 73 3a 35 3a 22 74  6f 6b 65 6e 22 3b 73 3a  34 30 3a 22 64 64      \";O:13:\"OAuthResponce\":7:{s:5:\"token\";s:40:\"dd\n      5C     58 6b 6a 34 6a 49 34 63  76 4c 7a 71 49 59 39 74  77 38 78 72 49 37 67 52  69 7a 68 39 65 39 56 38  36 32 4b 52 6f 52 22 3b  73 3a 39 3a 22 74      Xkj4jI4cvLzqIY9tw8xrI7gRizh9e9V862KRoR\";s:9:\"t\n      8A     6f 6b 65 6e 54 79 70 65  22 3b 73 3a 36 3a 22 42  65 61 72 65 72 22 3b 73  3a 37 3a 22 65 78 70 69  72 65 73 22 3b 73 3a 31  30 3a 22 31 33 37      okenType\";s:6:\"Bearer\";s:7:\"expires\";s:10:\"137\n      B8     36 39 31 37 31 35 38 22  3b 73 3a 39 3a 22 65 78  70 69 72 65 73 49 6e 22  3b 73 3a 34 3a 22 33 36  30 30 22 3b 73 3a 31 34  3a 22 00 2a 00 5f      6917158\";s:9:\"expiresIn\";s:4:\"3600\";s:14:\".*._\n      E6     64 65 73 63 72 69 70 74  6f 72 22 3b 4f 3a 32 37  3a 22 44 72 53 6c 75 6d  70 5c 50 72 6f 74 6f 62  75 66 5c 44 65 73 63 72  69 70 74 6f 72 22      descriptor\";O:27:\"DrSlump\\Protobuf\\Descriptor\"\n     114     3a 34 3a 7b 73 3a 38 3a  22 00 2a 00 63 6c 61 73  73 22 3b 73 3a 31 33 3a  22 4f 41 75 74 68 52 65  73 70 6f 6e 63 65 22 3b  73 3a 37 3a 22 00      :4:{s:8:\".*.class\";s:13:\"OAuthResponce\";s:7:\".\n     142     2a 00 6e 61 6d 65 22 3b  73 3a 31 33 3a 22 4f 41  75 74 68 52 65 73 70 6f  6e 63 65 22 3b 73 3a 39  3a 22 00 2a 00 66 69 65  6c 64 73 22 3b 61      *.name\";s:13:\"OAuthResponce\";s:9:\".*.fields\";a\n     170     3a 34 3a 7b 69 3a 31 3b  4f 3a 32 32 3a 22 44 72  53 6c 75 6d 70 5c 50 72  6f 74 6f 62 75 66 5c 46  69 65 6c 64 22 3a 38 3a  7b 73 3a 36 3a 22      :4:{i:1;O:22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"\n     19E     6e 75 6d 62 65 72 22 3b  69 3a 31 3b 73 3a 34 3a  22 6e 61 6d 65 22 3b 73  3a 35 3a 22 74 6f 6b 65  6e 22 3b 73 3a 34 3a 22  74 79 70 65 22 3b      number\";i:1;s:4:\"name\";s:5:\"token\";s:4:\"type\";\n     1CC     69 3a 39 3b 73 3a 34 3a  22 72 75 6c 65 22 3b 69  3a 32 3b 73 3a 39 3a 22  72 65 66 65 72 65 6e 63  65 22 3b 4e 3b 73 3a 37  3a 22 64 65 66 61      i:9;s:4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"defa\n     1FA     75 6c 74 22 3b 4e 3b 73  3a 36 3a 22 70 61 63 6b  65 64 22 3b 62 3a 30 3b  73 3a 39 3a 22 65 78 74  65 6e 73 69 6f 6e 22 3b  62 3a 30 3b 7d 69      ult\";N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}i\n     228     3a 32 3b 4f 3a 32 32 3a  22 44 72 53 6c 75 6d 70  5c 50 72 6f 74 6f 62 75  66 5c 46 69 65 6c 64 22  3a 38 3a 7b 73 3a 36 3a  22 6e 75 6d 62 65      :2;O:22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"numbe\n     256     72 22 3b 69 3a 32 3b 73  3a 34 3a 22 6e 61 6d 65  22 3b 73 3a 39 3a 22 74  6f 6b 65 6e 54 79 70 65  22 3b 73 3a 34 3a 22 74  79 70 65 22 3b 69      r\";i:2;s:4:\"name\";s:9:\"tokenType\";s:4:\"type\";i\n     284     3a 39 3b 73 3a 34 3a 22  72 75 6c 65 22 3b 69 3a  32 3b 73 3a 39 3a 22 72  65 66 65 72 65 6e 63 65  22 3b 4e 3b 73 3a 37 3a  22 64 65 66 61 75      :9;s:4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"defau\n     2B2     6c 74 22 3b 4e 3b 73 3a  36 3a 22 70 61 63 6b 65  64 22 3b 62 3a 30 3b 73  3a 39 3a 22 65 78 74 65  6e 73 69 6f 6e 22 3b 62  3a 30 3b 7d 69 3a      lt\";N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}i:\n     2E0     33 3b 4f 3a 32 32 3a 22  44 72 53 6c 75 6d 70 5c  50 72 6f 74 6f 62 75 66  5c 46 69 65 6c 64 22 3a  38 3a 7b 73 3a 36 3a 22  6e 75 6d 62 65 72      3;O:22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"number\n     30E     22 3b 69 3a 33 3b 73 3a  34 3a 22 6e 61 6d 65 22  3b 73 3a 37 3a 22 65 78  70 69 72 65 73 22 3b 73  3a 34 3a 22 74 79 70 65  22 3b 69 3a 39 3b      \";i:3;s:4:\"name\";s:7:\"expires\";s:4:\"type\";i:9;\n     33C     73 3a 34 3a 22 72 75 6c  65 22 3b 69 3a 32 3b 73  3a 39 3a 22 72 65 66 65  72 65 6e 63 65 22 3b 4e  3b 73 3a 37 3a 22 64 65  66 61 75 6c 74 22      s:4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"default\"\n     36A     3b 4e 3b 73 3a 36 3a 22  70 61 63 6b 65 64 22 3b  62 3a 30 3b 73 3a 39 3a  22 65 78 74 65 6e 73 69  6f 6e 22 3b 62 3a 30 3b  7d 69 3a 34 3b 4f      ;N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}i:4;O\n     398     3a 32 32 3a 22 44 72 53  6c 75 6d 70 5c 50 72 6f  74 6f 62 75 66 5c 46 69  65 6c 64 22 3a 38 3a 7b  73 3a 36 3a 22 6e 75 6d  62 65 72 22 3b 69      :22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"number\";i\n     3C6     3a 34 3b 73 3a 34 3a 22  6e 61 6d 65 22 3b 73 3a  39 3a 22 65 78 70 69 72  65 73 49 6e 22 3b 73 3a  34 3a 22 74 79 70 65 22  3b 69 3a 39 3b 73      :4;s:4:\"name\";s:9:\"expiresIn\";s:4:\"type\";i:9;s\n     3F4     3a 34 3a 22 72 75 6c 65  22 3b 69 3a 32 3b 73 3a  39 3a 22 72 65 66 65 72  65 6e 63 65 22 3b 4e 3b  73 3a 37 3a 22 64 65 66  61 75 6c 74 22 3b      :4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"default\";\n     422     4e 3b 73 3a 36 3a 22 70  61 63 6b 65 64 22 3b 62  3a 30 3b 73 3a 39 3a 22  65 78 74 65 6e 73 69 6f  6e 22 3b 62 3a 30 3b 7d  7d 73 3a 38 3a 22      N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}}s:8:\"\n     450     00 2a 00 6e 61 6d 65 73  22 3b 61 3a 34 3a 7b 73  3a 35 3a 22 74 6f 6b 65  6e 22 3b 69 3a 31 3b 73  3a 39 3a 22 74 6f 6b 65  6e 54 79 70 65 22      .*.names\";a:4:{s:5:\"token\";i:1;s:9:\"tokenType\"\n     47E     3b 69 3a 32 3b 73 3a 37  3a 22 65 78 70 69 72 65  73 22 3b 69 3a 33 3b 73  3a 39 3a 22 65 78 70 69  72 65 73 49 6e 22 3b 69  3a 34 3b 7d 7d 73      ;i:2;s:7:\"expires\";i:3;s:9:\"expiresIn\";i:4;}}s\n     4AC     3a 31 34 3a 22 00 2a 00  5f 65 78 74 65 6e 73 69  6f 6e 73 22 3b 61 3a 30  3a 7b 7d 73 3a 31 31 3a  22 00 2a 00 5f 75 6e 6b  6e 6f 77 6e 22 3b      :14:\".*._extensions\";a:0:{}s:11:\".*._unknown\";\n     4DA     61 3a 30 3a 7b 7d 7d 73  3a 37 3a 22 75 73 65 72  5f 69 64 22 3b 69 3a 33  32 36 38 3b 7d                                                           a:0:{}}s:7:\"user_id\";i:3268;}\n```\n\nDecode:\n\n```\n─[       0/     4E9]──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[dataDecode]─\n       0     61 3a 33 3a 7b 73 3a 31  30 3a 22 73 6c 69 6d 2e  66 6c 61 73 68 22 3b 61  3a 30 3a 7b 7d 73 3a 31  31 3a 22 41 63 63 65 73  73 54 6f 6b 65 6e      a:3:{s:10:\"slim.flash\";a:0:{}s:11:\"AccessToken\n      2E     22 3b 4f 3a 31 33 3a 22  4f 41 75 74 68 52 65 73  70 6f 6e 63 65 22 3a 37  3a 7b 73 3a 35 3a 22 74  6f 6b 65 6e 22 3b 73 3a  34 30 3a 22 64 64      \";O:13:\"OAuthResponce\":7:{s:5:\"token\";s:40:\"dd\n      5C     58 6b 6a 34 6a 49 34 63  76 4c 7a 71 49 59 39 74  77 38 78 72 49 37 67 52  69 7a 68 39 65 39 56 38  36 32 4b 52 6f 52 22 3b  73 3a 39 3a 22 74      Xkj4jI4cvLzqIY9tw8xrI7gRizh9e9V862KRoR\";s:9:\"t\n      8A     6f 6b 65 6e 54 79 70 65  22 3b 73 3a 36 3a 22 42  65 61 72 65 72 22 3b 73  3a 37 3a 22 65 78 70 69  72 65 73 22 3b 73 3a 31  30 3a 22 31 33 37      okenType\";s:6:\"Bearer\";s:7:\"expires\";s:10:\"137\n      B8     36 39 31 37 31 35 38 22  3b 73 3a 39 3a 22 65 78  70 69 72 65 73 49 6e 22  3b 73 3a 34 3a 22 33 36  30 30 22 3b 73 3a 31 34  3a 22 2a 5f 64 65      6917158\";s:9:\"expiresIn\";s:4:\"3600\";s:14:\"*_de\n      E6     73 63 72 69 70 74 6f 72  22 3b 4f 3a 32 37 3a 22  44 72 53 6c 75 6d 70 5c  50 72 6f 74 6f 62 75 66  5c 44 65 73 63 72 69 70  74 6f 72 22 3a 34      scriptor\";O:27:\"DrSlump\\Protobuf\\Descriptor\":4\n     114     3a 7b 73 3a 38 3a 22 2a  63 6c 61 73 73 22 3b 73  3a 31 33 3a 22 4f 41 75  74 68 52 65 73 70 6f 6e  63 65 22 3b 73 3a 37 3a  22 2a 6e 61 6d 65      :{s:8:\"*class\";s:13:\"OAuthResponce\";s:7:\"*name\n     142     22 3b 73 3a 31 33 3a 22  4f 41 75 74 68 52 65 73  70 6f 6e 63 65 22 3b 73  3a 39 3a 22 2a 66 69 65  6c 64 73 22 3b 61 3a 34  3a 7b 69 3a 31 3b      \";s:13:\"OAuthResponce\";s:9:\"*fields\";a:4:{i:1;\n     170     4f 3a 32 32 3a 22 44 72  53 6c 75 6d 70 5c 50 72  6f 74 6f 62 75 66 5c 46  69 65 6c 64 22 3a 38 3a  7b 73 3a 36 3a 22 6e 75  6d 62 65 72 22 3b      O:22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"number\";\n     19E     69 3a 31 3b 73 3a 34 3a  22 6e 61 6d 65 22 3b 73  3a 35 3a 22 74 6f 6b 65  6e 22 3b 73 3a 34 3a 22  74 79 70 65 22 3b 69 3a  39 3b 73 3a 34 3a      i:1;s:4:\"name\";s:5:\"token\";s:4:\"type\";i:9;s:4:\n     1CC     22 72 75 6c 65 22 3b 69  3a 32 3b 73 3a 39 3a 22  72 65 66 65 72 65 6e 63  65 22 3b 4e 3b 73 3a 37  3a 22 64 65 66 61 75 6c  74 22 3b 4e 3b 73      \"rule\";i:2;s:9:\"reference\";N;s:7:\"default\";N;s\n     1FA     3a 36 3a 22 70 61 63 6b  65 64 22 3b 62 3a 30 3b  73 3a 39 3a 22 65 78 74  65 6e 73 69 6f 6e 22 3b  62 3a 30 3b 7d 69 3a 32  3b 4f 3a 32 32 3a      :6:\"packed\";b:0;s:9:\"extension\";b:0;}i:2;O:22:\n     228     22 44 72 53 6c 75 6d 70  5c 50 72 6f 74 6f 62 75  66 5c 46 69 65 6c 64 22  3a 38 3a 7b 73 3a 36 3a  22 6e 75 6d 62 65 72 22  3b 69 3a 32 3b 73      \"DrSlump\\Protobuf\\Field\":8:{s:6:\"number\";i:2;s\n     256     3a 34 3a 22 6e 61 6d 65  22 3b 73 3a 39 3a 22 74  6f 6b 65 6e 54 79 70 65  22 3b 73 3a 34 3a 22 74  79 70 65 22 3b 69 3a 39  3b 73 3a 34 3a 22      :4:\"name\";s:9:\"tokenType\";s:4:\"type\";i:9;s:4:\"\n     284     72 75 6c 65 22 3b 69 3a  32 3b 73 3a 39 3a 22 72  65 66 65 72 65 6e 63 65  22 3b 4e 3b 73 3a 37 3a  22 64 65 66 61 75 6c 74  22 3b 4e 3b 73 3a      rule\";i:2;s:9:\"reference\";N;s:7:\"default\";N;s:\n     2B2     36 3a 22 70 61 63 6b 65  64 22 3b 62 3a 30 3b 73  3a 39 3a 22 65 78 74 65  6e 73 69 6f 6e 22 3b 62  3a 30 3b 7d 69 3a 33 3b  4f 3a 32 32 3a 22      6:\"packed\";b:0;s:9:\"extension\";b:0;}i:3;O:22:\"\n     2E0     44 72 53 6c 75 6d 70 5c  50 72 6f 74 6f 62 75 66  5c 46 69 65 6c 64 22 3a  38 3a 7b 73 3a 36 3a 22  6e 75 6d 62 65 72 22 3b  69 3a 33 3b 73 3a      DrSlump\\Protobuf\\Field\":8:{s:6:\"number\";i:3;s:\n     30E     34 3a 22 6e 61 6d 65 22  3b 73 3a 37 3a 22 65 78  70 69 72 65 73 22 3b 73  3a 34 3a 22 74 79 70 65  22 3b 69 3a 39 3b 73 3a  34 3a 22 72 75 6c      4:\"name\";s:7:\"expires\";s:4:\"type\";i:9;s:4:\"rul\n     33C     65 22 3b 69 3a 32 3b 73  3a 39 3a 22 72 65 66 65  72 65 6e 63 65 22 3b 4e  3b 73 3a 37 3a 22 64 65  66 61 75 6c 74 22 3b 4e  3b 73 3a 36 3a 22      e\";i:2;s:9:\"reference\";N;s:7:\"default\";N;s:6:\"\n     36A     70 61 63 6b 65 64 22 3b  62 3a 30 3b 73 3a 39 3a  22 65 78 74 65 6e 73 69  6f 6e 22 3b 62 3a 30 3b  7d 69 3a 34 3b 4f 3a 32  32 3a 22 44 72 53      packed\";b:0;s:9:\"extension\";b:0;}i:4;O:22:\"DrS\n     398     6c 75 6d 70 5c 50 72 6f  74 6f 62 75 66 5c 46 69  65 6c 64 22 3a 38 3a 7b  73 3a 36 3a 22 6e 75 6d  62 65 72 22 3b 69 3a 34  3b 73 3a 34 3a 22      lump\\Protobuf\\Field\":8:{s:6:\"number\";i:4;s:4:\"\n     3C6     6e 61 6d 65 22 3b 73 3a  39 3a 22 65 78 70 69 72  65 73 49 6e 22 3b 73 3a  34 3a 22 74 79 70 65 22  3b 69 3a 39 3b 73 3a 34  3a 22 72 75 6c 65      name\";s:9:\"expiresIn\";s:4:\"type\";i:9;s:4:\"rule\n     3F4     22 3b 69 3a 32 3b 73 3a  39 3a 22 72 65 66 65 72  65 6e 63 65 22 3b 4e 3b  73 3a 37 3a 22 64 65 66  61 75 6c 74 22 3b 4e 3b  73 3a 36 3a 22 70      \";i:2;s:9:\"reference\";N;s:7:\"default\";N;s:6:\"p\n     422     61 63 6b 65 64 22 3b 62  3a 30 3b 73 3a 39 3a 22  65 78 74 65 6e 73 69 6f  6e 22 3b 62 3a 30 3b 7d  7d 73 3a 38 3a 22 2a 6e  61 6d 65 73 22 3b      acked\";b:0;s:9:\"extension\";b:0;}}s:8:\"*names\";\n     450     61 3a 34 3a 7b 73 3a 35  3a 22 74 6f 6b 65 6e 22  3b 69 3a 31 3b 73 3a 39  3a 22 74 6f 6b 65 6e 54  79 70 65 22 3b 69 3a 32  3b 73 3a 37 3a 22      a:4:{s:5:\"token\";i:1;s:9:\"tokenType\";i:2;s:7:\"\n     47E     65 78 70 69 72 65 73 22  3b 69 3a 33 3b 73 3a 39  3a 22 65 78 70 69 72 65  73 49 6e 22 3b 69 3a 34  3b 7d 7d 73 3a 31 34 3a  22 2a 5f 65 78 74      expires\";i:3;s:9:\"expiresIn\";i:4;}}s:14:\"*_ext\n     4AC     65 6e 73 69 6f 6e 73 22  3b 61 3a 30 3a 7b 7d 73  3a 31 31 3a 22 2a 5f 75  6e 6b 6e 6f 77 6e 22 3b  61 3a 30 3a 7b 7d 7d 73  3a 37 3a 22 75 73      ensions\";a:0:{}s:11:\"*_unknown\";a:0:{}}s:7:\"us\n     4DA     65 72 5f 69 64 22 3b 69  3a 33 32 36 38 3b 7d                                                                                                       er_id\";i:3268;}\n```\n\nMismatch! 4F7(Content Length) Expected - 4E9(Content Length) actual\nContent length has changed - the content of the decrypted file has changed from the original.\n\nUsing our modified line:\n$res = rtrim($decryptedData, \"\\0\");\nrtrim() will remove the extra padding)from the end of data only - as desired.\n\nEncode:\n\n```\n─[       0/     4F7]──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[dataEncode]─\n       0     61 3a 33 3a 7b 73 3a 31  30 3a 22 73 6c 69 6d 2e  66 6c 61 73 68 22 3b 61  3a 30 3a 7b 7d 73 3a 31  31 3a 22 41 63 63 65 73  73 54 6f 6b 65 6e      a:3:{s:10:\"slim.flash\";a:0:{}s:11:\"AccessToken\n      2E     22 3b 4f 3a 31 33 3a 22  4f 41 75 74 68 52 65 73  70 6f 6e 63 65 22 3a 37  3a 7b 73 3a 35 3a 22 74  6f 6b 65 6e 22 3b 73 3a  34 30 3a 22 34 63      \";O:13:\"OAuthResponce\":7:{s:5:\"token\";s:40:\"4c\n      5C     47 36 4a 38 4a 6a 36 33  4d 78 7a 4a 63 6f 78 77  54 63 74 43 42 78 64 71  38 6b 34 51 74 7a 6f 7a  44 62 4f 76 52 52 22 3b  73 3a 39 3a 22 74      G6J8Jj63MxzJcoxwTctCBxdq8k4QtzozDbOvRR\";s:9:\"t\n      8A     6f 6b 65 6e 54 79 70 65  22 3b 73 3a 36 3a 22 42  65 61 72 65 72 22 3b 73  3a 37 3a 22 65 78 70 69  72 65 73 22 3b 73 3a 31  30 3a 22 31 33 37      okenType\";s:6:\"Bearer\";s:7:\"expires\";s:10:\"137\n      B8     36 39 31 37 35 39 33 22  3b 73 3a 39 3a 22 65 78  70 69 72 65 73 49 6e 22  3b 73 3a 34 3a 22 33 36  30 30 22 3b 73 3a 31 34  3a 22 00 2a 00 5f      6917593\";s:9:\"expiresIn\";s:4:\"3600\";s:14:\".*._\n      E6     64 65 73 63 72 69 70 74  6f 72 22 3b 4f 3a 32 37  3a 22 44 72 53 6c 75 6d  70 5c 50 72 6f 74 6f 62  75 66 5c 44 65 73 63 72  69 70 74 6f 72 22      descriptor\";O:27:\"DrSlump\\Protobuf\\Descriptor\"\n     114     3a 34 3a 7b 73 3a 38 3a  22 00 2a 00 63 6c 61 73  73 22 3b 73 3a 31 33 3a  22 4f 41 75 74 68 52 65  73 70 6f 6e 63 65 22 3b  73 3a 37 3a 22 00      :4:{s:8:\".*.class\";s:13:\"OAuthResponce\";s:7:\".\n     142     2a 00 6e 61 6d 65 22 3b  73 3a 31 33 3a 22 4f 41  75 74 68 52 65 73 70 6f  6e 63 65 22 3b 73 3a 39  3a 22 00 2a 00 66 69 65  6c 64 73 22 3b 61      *.name\";s:13:\"OAuthResponce\";s:9:\".*.fields\";a\n     170     3a 34 3a 7b 69 3a 31 3b  4f 3a 32 32 3a 22 44 72  53 6c 75 6d 70 5c 50 72  6f 74 6f 62 75 66 5c 46  69 65 6c 64 22 3a 38 3a  7b 73 3a 36 3a 22      :4:{i:1;O:22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"\n     19E     6e 75 6d 62 65 72 22 3b  69 3a 31 3b 73 3a 34 3a  22 6e 61 6d 65 22 3b 73  3a 35 3a 22 74 6f 6b 65  6e 22 3b 73 3a 34 3a 22  74 79 70 65 22 3b      number\";i:1;s:4:\"name\";s:5:\"token\";s:4:\"type\";\n     1CC     69 3a 39 3b 73 3a 34 3a  22 72 75 6c 65 22 3b 69  3a 32 3b 73 3a 39 3a 22  72 65 66 65 72 65 6e 63  65 22 3b 4e 3b 73 3a 37  3a 22 64 65 66 61      i:9;s:4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"defa\n     1FA     75 6c 74 22 3b 4e 3b 73  3a 36 3a 22 70 61 63 6b  65 64 22 3b 62 3a 30 3b  73 3a 39 3a 22 65 78 74  65 6e 73 69 6f 6e 22 3b  62 3a 30 3b 7d 69      ult\";N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}i\n     228     3a 32 3b 4f 3a 32 32 3a  22 44 72 53 6c 75 6d 70  5c 50 72 6f 74 6f 62 75  66 5c 46 69 65 6c 64 22  3a 38 3a 7b 73 3a 36 3a  22 6e 75 6d 62 65      :2;O:22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"numbe\n     256     72 22 3b 69 3a 32 3b 73  3a 34 3a 22 6e 61 6d 65  22 3b 73 3a 39 3a 22 74  6f 6b 65 6e 54 79 70 65  22 3b 73 3a 34 3a 22 74  79 70 65 22 3b 69      r\";i:2;s:4:\"name\";s:9:\"tokenType\";s:4:\"type\";i\n     284     3a 39 3b 73 3a 34 3a 22  72 75 6c 65 22 3b 69 3a  32 3b 73 3a 39 3a 22 72  65 66 65 72 65 6e 63 65  22 3b 4e 3b 73 3a 37 3a  22 64 65 66 61 75      :9;s:4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"defau\n     2B2     6c 74 22 3b 4e 3b 73 3a  36 3a 22 70 61 63 6b 65  64 22 3b 62 3a 30 3b 73  3a 39 3a 22 65 78 74 65  6e 73 69 6f 6e 22 3b 62  3a 30 3b 7d 69 3a      lt\";N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}i:\n     2E0     33 3b 4f 3a 32 32 3a 22  44 72 53 6c 75 6d 70 5c  50 72 6f 74 6f 62 75 66  5c 46 69 65 6c 64 22 3a  38 3a 7b 73 3a 36 3a 22  6e 75 6d 62 65 72      3;O:22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"number\n     30E     22 3b 69 3a 33 3b 73 3a  34 3a 22 6e 61 6d 65 22  3b 73 3a 37 3a 22 65 78  70 69 72 65 73 22 3b 73  3a 34 3a 22 74 79 70 65  22 3b 69 3a 39 3b      \";i:3;s:4:\"name\";s:7:\"expires\";s:4:\"type\";i:9;\n     33C     73 3a 34 3a 22 72 75 6c  65 22 3b 69 3a 32 3b 73  3a 39 3a 22 72 65 66 65  72 65 6e 63 65 22 3b 4e  3b 73 3a 37 3a 22 64 65  66 61 75 6c 74 22      s:4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"default\"\n     36A     3b 4e 3b 73 3a 36 3a 22  70 61 63 6b 65 64 22 3b  62 3a 30 3b 73 3a 39 3a  22 65 78 74 65 6e 73 69  6f 6e 22 3b 62 3a 30 3b  7d 69 3a 34 3b 4f      ;N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}i:4;O\n     398     3a 32 32 3a 22 44 72 53  6c 75 6d 70 5c 50 72 6f  74 6f 62 75 66 5c 46 69  65 6c 64 22 3a 38 3a 7b  73 3a 36 3a 22 6e 75 6d  62 65 72 22 3b 69      :22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"number\";i\n     3C6     3a 34 3b 73 3a 34 3a 22  6e 61 6d 65 22 3b 73 3a  39 3a 22 65 78 70 69 72  65 73 49 6e 22 3b 73 3a  34 3a 22 74 79 70 65 22  3b 69 3a 39 3b 73      :4;s:4:\"name\";s:9:\"expiresIn\";s:4:\"type\";i:9;s\n     3F4     3a 34 3a 22 72 75 6c 65  22 3b 69 3a 32 3b 73 3a  39 3a 22 72 65 66 65 72  65 6e 63 65 22 3b 4e 3b  73 3a 37 3a 22 64 65 66  61 75 6c 74 22 3b      :4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"default\";\n     422     4e 3b 73 3a 36 3a 22 70  61 63 6b 65 64 22 3b 62  3a 30 3b 73 3a 39 3a 22  65 78 74 65 6e 73 69 6f  6e 22 3b 62 3a 30 3b 7d  7d 73 3a 38 3a 22      N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}}s:8:\"\n     450     00 2a 00 6e 61 6d 65 73  22 3b 61 3a 34 3a 7b 73  3a 35 3a 22 74 6f 6b 65  6e 22 3b 69 3a 31 3b 73  3a 39 3a 22 74 6f 6b 65  6e 54 79 70 65 22      .*.names\";a:4:{s:5:\"token\";i:1;s:9:\"tokenType\"\n     47E     3b 69 3a 32 3b 73 3a 37  3a 22 65 78 70 69 72 65  73 22 3b 69 3a 33 3b 73  3a 39 3a 22 65 78 70 69  72 65 73 49 6e 22 3b 69  3a 34 3b 7d 7d 73      ;i:2;s:7:\"expires\";i:3;s:9:\"expiresIn\";i:4;}}s\n     4AC     3a 31 34 3a 22 00 2a 00  5f 65 78 74 65 6e 73 69  6f 6e 73 22 3b 61 3a 30  3a 7b 7d 73 3a 31 31 3a  22 00 2a 00 5f 75 6e 6b  6e 6f 77 6e 22 3b      :14:\".*._extensions\";a:0:{}s:11:\".*._unknown\";\n     4DA     61 3a 30 3a 7b 7d 7d 73  3a 37 3a 22 75 73 65 72  5f 69 64 22 3b 69 3a 33  32 36 38 3b 7d                                                           a:0:{}}s:7:\"user_id\";i:3268;}\n```\n\nDecode:\n\n```\n─[       0/     4F7]──────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────────[dataDecode]─\n       0     61 3a 33 3a 7b 73 3a 31  30 3a 22 73 6c 69 6d 2e  66 6c 61 73 68 22 3b 61  3a 30 3a 7b 7d 73 3a 31  31 3a 22 41 63 63 65 73  73 54 6f 6b 65 6e      a:3:{s:10:\"slim.flash\";a:0:{}s:11:\"AccessToken\n      2E     22 3b 4f 3a 31 33 3a 22  4f 41 75 74 68 52 65 73  70 6f 6e 63 65 22 3a 37  3a 7b 73 3a 35 3a 22 74  6f 6b 65 6e 22 3b 73 3a  34 30 3a 22 34 63      \";O:13:\"OAuthResponce\":7:{s:5:\"token\";s:40:\"4c\n      5C     47 36 4a 38 4a 6a 36 33  4d 78 7a 4a 63 6f 78 77  54 63 74 43 42 78 64 71  38 6b 34 51 74 7a 6f 7a  44 62 4f 76 52 52 22 3b  73 3a 39 3a 22 74      G6J8Jj63MxzJcoxwTctCBxdq8k4QtzozDbOvRR\";s:9:\"t\n      8A     6f 6b 65 6e 54 79 70 65  22 3b 73 3a 36 3a 22 42  65 61 72 65 72 22 3b 73  3a 37 3a 22 65 78 70 69  72 65 73 22 3b 73 3a 31  30 3a 22 31 33 37      okenType\";s:6:\"Bearer\";s:7:\"expires\";s:10:\"137\n      B8     36 39 31 37 35 39 33 22  3b 73 3a 39 3a 22 65 78  70 69 72 65 73 49 6e 22  3b 73 3a 34 3a 22 33 36  30 30 22 3b 73 3a 31 34  3a 22 00 2a 00 5f      6917593\";s:9:\"expiresIn\";s:4:\"3600\";s:14:\".*._\n      E6     64 65 73 63 72 69 70 74  6f 72 22 3b 4f 3a 32 37  3a 22 44 72 53 6c 75 6d  70 5c 50 72 6f 74 6f 62  75 66 5c 44 65 73 63 72  69 70 74 6f 72 22      descriptor\";O:27:\"DrSlump\\Protobuf\\Descriptor\"\n     114     3a 34 3a 7b 73 3a 38 3a  22 00 2a 00 63 6c 61 73  73 22 3b 73 3a 31 33 3a  22 4f 41 75 74 68 52 65  73 70 6f 6e 63 65 22 3b  73 3a 37 3a 22 00      :4:{s:8:\".*.class\";s:13:\"OAuthResponce\";s:7:\".\n     142     2a 00 6e 61 6d 65 22 3b  73 3a 31 33 3a 22 4f 41  75 74 68 52 65 73 70 6f  6e 63 65 22 3b 73 3a 39  3a 22 00 2a 00 66 69 65  6c 64 73 22 3b 61      *.name\";s:13:\"OAuthResponce\";s:9:\".*.fields\";a\n     170     3a 34 3a 7b 69 3a 31 3b  4f 3a 32 32 3a 22 44 72  53 6c 75 6d 70 5c 50 72  6f 74 6f 62 75 66 5c 46  69 65 6c 64 22 3a 38 3a  7b 73 3a 36 3a 22      :4:{i:1;O:22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"\n     19E     6e 75 6d 62 65 72 22 3b  69 3a 31 3b 73 3a 34 3a  22 6e 61 6d 65 22 3b 73  3a 35 3a 22 74 6f 6b 65  6e 22 3b 73 3a 34 3a 22  74 79 70 65 22 3b      number\";i:1;s:4:\"name\";s:5:\"token\";s:4:\"type\";\n     1CC     69 3a 39 3b 73 3a 34 3a  22 72 75 6c 65 22 3b 69  3a 32 3b 73 3a 39 3a 22  72 65 66 65 72 65 6e 63  65 22 3b 4e 3b 73 3a 37  3a 22 64 65 66 61      i:9;s:4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"defa\n     1FA     75 6c 74 22 3b 4e 3b 73  3a 36 3a 22 70 61 63 6b  65 64 22 3b 62 3a 30 3b  73 3a 39 3a 22 65 78 74  65 6e 73 69 6f 6e 22 3b  62 3a 30 3b 7d 69      ult\";N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}i\n     228     3a 32 3b 4f 3a 32 32 3a  22 44 72 53 6c 75 6d 70  5c 50 72 6f 74 6f 62 75  66 5c 46 69 65 6c 64 22  3a 38 3a 7b 73 3a 36 3a  22 6e 75 6d 62 65      :2;O:22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"numbe\n     256     72 22 3b 69 3a 32 3b 73  3a 34 3a 22 6e 61 6d 65  22 3b 73 3a 39 3a 22 74  6f 6b 65 6e 54 79 70 65  22 3b 73 3a 34 3a 22 74  79 70 65 22 3b 69      r\";i:2;s:4:\"name\";s:9:\"tokenType\";s:4:\"type\";i\n     284     3a 39 3b 73 3a 34 3a 22  72 75 6c 65 22 3b 69 3a  32 3b 73 3a 39 3a 22 72  65 66 65 72 65 6e 63 65  22 3b 4e 3b 73 3a 37 3a  22 64 65 66 61 75      :9;s:4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"defau\n     2B2     6c 74 22 3b 4e 3b 73 3a  36 3a 22 70 61 63 6b 65  64 22 3b 62 3a 30 3b 73  3a 39 3a 22 65 78 74 65  6e 73 69 6f 6e 22 3b 62  3a 30 3b 7d 69 3a      lt\";N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}i:\n     2E0     33 3b 4f 3a 32 32 3a 22  44 72 53 6c 75 6d 70 5c  50 72 6f 74 6f 62 75 66  5c 46 69 65 6c 64 22 3a  38 3a 7b 73 3a 36 3a 22  6e 75 6d 62 65 72      3;O:22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"number\n     30E     22 3b 69 3a 33 3b 73 3a  34 3a 22 6e 61 6d 65 22  3b 73 3a 37 3a 22 65 78  70 69 72 65 73 22 3b 73  3a 34 3a 22 74 79 70 65  22 3b 69 3a 39 3b      \";i:3;s:4:\"name\";s:7:\"expires\";s:4:\"type\";i:9;\n     33C     73 3a 34 3a 22 72 75 6c  65 22 3b 69 3a 32 3b 73  3a 39 3a 22 72 65 66 65  72 65 6e 63 65 22 3b 4e  3b 73 3a 37 3a 22 64 65  66 61 75 6c 74 22      s:4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"default\"\n     36A     3b 4e 3b 73 3a 36 3a 22  70 61 63 6b 65 64 22 3b  62 3a 30 3b 73 3a 39 3a  22 65 78 74 65 6e 73 69  6f 6e 22 3b 62 3a 30 3b  7d 69 3a 34 3b 4f      ;N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}i:4;O\n     398     3a 32 32 3a 22 44 72 53  6c 75 6d 70 5c 50 72 6f  74 6f 62 75 66 5c 46 69  65 6c 64 22 3a 38 3a 7b  73 3a 36 3a 22 6e 75 6d  62 65 72 22 3b 69      :22:\"DrSlump\\Protobuf\\Field\":8:{s:6:\"number\";i\n     3C6     3a 34 3b 73 3a 34 3a 22  6e 61 6d 65 22 3b 73 3a  39 3a 22 65 78 70 69 72  65 73 49 6e 22 3b 73 3a  34 3a 22 74 79 70 65 22  3b 69 3a 39 3b 73      :4;s:4:\"name\";s:9:\"expiresIn\";s:4:\"type\";i:9;s\n     3F4     3a 34 3a 22 72 75 6c 65  22 3b 69 3a 32 3b 73 3a  39 3a 22 72 65 66 65 72  65 6e 63 65 22 3b 4e 3b  73 3a 37 3a 22 64 65 66  61 75 6c 74 22 3b      :4:\"rule\";i:2;s:9:\"reference\";N;s:7:\"default\";\n     422     4e 3b 73 3a 36 3a 22 70  61 63 6b 65 64 22 3b 62  3a 30 3b 73 3a 39 3a 22  65 78 74 65 6e 73 69 6f  6e 22 3b 62 3a 30 3b 7d  7d 73 3a 38 3a 22      N;s:6:\"packed\";b:0;s:9:\"extension\";b:0;}}s:8:\"\n     450     00 2a 00 6e 61 6d 65 73  22 3b 61 3a 34 3a 7b 73  3a 35 3a 22 74 6f 6b 65  6e 22 3b 69 3a 31 3b 73  3a 39 3a 22 74 6f 6b 65  6e 54 79 70 65 22      .*.names\";a:4:{s:5:\"token\";i:1;s:9:\"tokenType\"\n     47E     3b 69 3a 32 3b 73 3a 37  3a 22 65 78 70 69 72 65  73 22 3b 69 3a 33 3b 73  3a 39 3a 22 65 78 70 69  72 65 73 49 6e 22 3b 69  3a 34 3b 7d 7d 73      ;i:2;s:7:\"expires\";i:3;s:9:\"expiresIn\";i:4;}}s\n     4AC     3a 31 34 3a 22 00 2a 00  5f 65 78 74 65 6e 73 69  6f 6e 73 22 3b 61 3a 30  3a 7b 7d 73 3a 31 31 3a  22 00 2a 00 5f 75 6e 6b  6e 6f 77 6e 22 3b      :14:\".*._extensions\";a:0:{}s:11:\".*._unknown\";\n     4DA     61 3a 30 3a 7b 7d 7d 73  3a 37 3a 22 75 73 65 72  5f 69 64 22 3b 69 3a 33  32 36 38 3b 7d                                                           a:0:{}}s:7:\"user_id\";i:3268;}\n```\n\nWith our fix. 4F7 (Content Length)  Expected - 4F7 (Content Length) actual.\nContent length matches and data content is the same. The decrypted file correctly matches the original file.\n","closed_by":{"login":"codeguy","id":31677,"node_id":"MDQ6VXNlcjMxNjc3","avatar_url":"https://avatars.githubusercontent.com/u/31677?v=4","gravatar_id":"","url":"https://api.github.com/users/codeguy","html_url":"https://github.com/codeguy","followers_url":"https://api.github.com/users/codeguy/followers","following_url":"https://api.github.com/users/codeguy/following{/other_user}","gists_url":"https://api.github.com/users/codeguy/gists{/gist_id}","starred_url":"https://api.github.com/users/codeguy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/codeguy/subscriptions","organizations_url":"https://api.github.com/users/codeguy/orgs","repos_url":"https://api.github.com/users/codeguy/repos","events_url":"https://api.github.com/users/codeguy/events{/privacy}","received_events_url":"https://api.github.com/users/codeguy/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/slimphp/Slim/issues/598/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/slimphp/Slim/issues/598/timeline","performed_via_github_app":null,"state_reason":"completed"}