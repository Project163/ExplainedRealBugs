{"url":"https://api.github.com/repos/typeorm/typeorm/issues/4219","repository_url":"https://api.github.com/repos/typeorm/typeorm","labels_url":"https://api.github.com/repos/typeorm/typeorm/issues/4219/labels{/name}","comments_url":"https://api.github.com/repos/typeorm/typeorm/issues/4219/comments","events_url":"https://api.github.com/repos/typeorm/typeorm/issues/4219/events","html_url":"https://github.com/typeorm/typeorm/issues/4219","id":451066347,"node_id":"MDU6SXNzdWU0NTEwNjYzNDc=","number":4219,"title":"class-transformer-shim: support metadata reflection","user":{"login":"haschu","id":13450260,"node_id":"MDQ6VXNlcjEzNDUwMjYw","avatar_url":"https://avatars.githubusercontent.com/u/13450260?v=4","gravatar_id":"","url":"https://api.github.com/users/haschu","html_url":"https://github.com/haschu","followers_url":"https://api.github.com/users/haschu/followers","following_url":"https://api.github.com/users/haschu/following{/other_user}","gists_url":"https://api.github.com/users/haschu/gists{/gist_id}","starred_url":"https://api.github.com/users/haschu/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/haschu/subscriptions","organizations_url":"https://api.github.com/users/haschu/orgs","repos_url":"https://api.github.com/users/haschu/repos","events_url":"https://api.github.com/users/haschu/events{/privacy}","received_events_url":"https://api.github.com/users/haschu/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2019-06-01T09:32:04Z","updated_at":"2019-06-06T10:31:55Z","closed_at":"2019-06-01T18:59:44Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Issue type:**\r\n\r\n[ ] question\r\n[ ] bug report\r\n[x] feature request\r\n[ ] documentation issue\r\n\r\n**TypeORM version:**\r\n\r\n[x] `latest`\r\n[ ] `@next`\r\n[ ] `0.x.x` (or put your version here)\r\n\r\n---\r\n\r\nTypeORM provides a [class-transformer-shim](https://github.com/typeorm/typeorm/blob/master/extra/typeorm-class-transformer-shim.js), which is awesome for browser/fronend application usage.\r\n\r\nHowever, the transformation of `Date` types for example - or any other type, that isn't passed via a decorator and a typeFunction - requires additional `class-transformer` code:\r\n\r\n```ts\r\n@Entity()\r\nexport class Photo {\r\n\r\n    @PrimaryGeneratedColumn()\r\n    id: number;\r\n\r\n    @Column()\r\n    url: string;\r\n    \r\n    // Works fine => class-transformer creates User objects :)\r\n    @ManyToOne(type => User, user => user.photos)\r\n    user: User;\r\n    \r\n    // No Date object, class-transformer leaves that as string :(\r\n    @CreateDateColumn()\r\n    createdAt: Date;\r\n\r\n}\r\n```\r\n\r\nTo make it work, we need to write:\r\n\r\n```ts\r\nimport { Type } from 'class-transformer';\r\n\r\n//...\r\n\r\n@Type(() => Date)\r\n@CreateDateColumn()\r\ncreatedAt: Date;\r\n```\r\n\r\nwhich I find annoying, especially when sharing entities between backend and frontend. One would also have to import the `class-transformer` library into his backend, but actually it's only used on the frontend side. Plus of course, it saves us lots of code lines.\r\n\r\nWe could solve this, if [typeorm-class-transformer-shim.js](https://github.com/typeorm/typeorm/blob/master/extra/typeorm-class-transformer-shim.js) would support metadata reflection. \r\nIf the client imports \"reflect-metadata\", we could use `design:type` and automatically pass it to the `@Type` decorator of class-transformer, as we already do with typeFunctions.\r\n\r\nPR is on the way. ","closed_by":{"login":"pleerock","id":1753397,"node_id":"MDQ6VXNlcjE3NTMzOTc=","avatar_url":"https://avatars.githubusercontent.com/u/1753397?v=4","gravatar_id":"","url":"https://api.github.com/users/pleerock","html_url":"https://github.com/pleerock","followers_url":"https://api.github.com/users/pleerock/followers","following_url":"https://api.github.com/users/pleerock/following{/other_user}","gists_url":"https://api.github.com/users/pleerock/gists{/gist_id}","starred_url":"https://api.github.com/users/pleerock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pleerock/subscriptions","organizations_url":"https://api.github.com/users/pleerock/orgs","repos_url":"https://api.github.com/users/pleerock/repos","events_url":"https://api.github.com/users/pleerock/events{/privacy}","received_events_url":"https://api.github.com/users/pleerock/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/4219/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/typeorm/typeorm/issues/4219/timeline","performed_via_github_app":null,"state_reason":"completed"}