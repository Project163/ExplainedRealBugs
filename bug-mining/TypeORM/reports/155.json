{"url":"https://api.github.com/repos/typeorm/typeorm/issues/9895","repository_url":"https://api.github.com/repos/typeorm/typeorm","labels_url":"https://api.github.com/repos/typeorm/typeorm/issues/9895/labels{/name}","comments_url":"https://api.github.com/repos/typeorm/typeorm/issues/9895/comments","events_url":"https://api.github.com/repos/typeorm/typeorm/issues/9895/events","html_url":"https://github.com/typeorm/typeorm/issues/9895","id":1644826974,"node_id":"I_kwDOAyVBJc5iChFe","number":9895,"title":"Cannot query using \"find\" with \"order\" when custom non-entity object column type is used","user":{"login":"dylanseago","id":3598502,"node_id":"MDQ6VXNlcjM1OTg1MDI=","avatar_url":"https://avatars.githubusercontent.com/u/3598502?v=4","gravatar_id":"","url":"https://api.github.com/users/dylanseago","html_url":"https://github.com/dylanseago","followers_url":"https://api.github.com/users/dylanseago/followers","following_url":"https://api.github.com/users/dylanseago/following{/other_user}","gists_url":"https://api.github.com/users/dylanseago/gists{/gist_id}","starred_url":"https://api.github.com/users/dylanseago/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/dylanseago/subscriptions","organizations_url":"https://api.github.com/users/dylanseago/orgs","repos_url":"https://api.github.com/users/dylanseago/repos","events_url":"https://api.github.com/users/dylanseago/events{/privacy}","received_events_url":"https://api.github.com/users/dylanseago/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":333605711,"node_id":"MDU6TGFiZWwzMzM2MDU3MTE=","url":"https://api.github.com/repos/typeorm/typeorm/labels/bug","name":"bug","color":"fc2929","default":true,"description":null},{"id":2454823078,"node_id":"MDU6TGFiZWwyNDU0ODIzMDc4","url":"https://api.github.com/repos/typeorm/typeorm/labels/requires%20triage","name":"requires triage","color":"f9aeb0","default":false,"description":""}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2023-03-28T23:59:38Z","updated_at":"2023-04-07T08:35:55Z","closed_at":"2023-04-07T08:35:54Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Issue description\n\nCannot query using \"find\" with \"order\" when custom non-entity object column type is used\n\n### Expected Behavior\n\nWhen using a custom column type that is an `object`, I expect typeorm to allow ordering on that property because the underlying database column type may still be sortable despite the TypeScript type being an object.\n\n### Actual Behavior\n\nThe `typeorm` type definition `FindOptionsOrder` appears to be assuming that the column having an `object` type is another entity and requires \"order\" nested structure to match the fields of that object. However that's not correct when custom column transformers are in use. See the example in \"Steps to reproduce\" where a custom numeric \"BigNumber\" column is created by transforming between the string and `BigNumber` object. The underlying column type is numeric and thus should be sortable using `FindOptionsOrder` even though the TypeScript type is a `BigNumber` object.\n\n### Steps to reproduce\n\n```\r\nimport {\r\n  BaseEntity,\r\n  Column,\r\n  Entity,\r\n} from 'typeorm'\r\nimport { BigNumber } from 'bignumber.js'\r\n\r\n@Entity()\r\nexport class ExampleModel extends BaseEntity {\r\n  @Column({\r\n    type: 'numeric',\r\n    transformer: {\r\n      from: (value: any): BigNumber | null | undefined => {\r\n        if (typeof value === 'undefined' || value === null) {\r\n          return value\r\n        }\r\n        return new BigNumber(value)\r\n      },\r\n      to: (value: any): string | null | undefined => {\r\n        if (typeof value === 'undefined' || value === null) {\r\n          return value\r\n        }\r\n        return (value as BigNumber).toFixed()\r\n      },\r\n    },\r\n  })\r\n  total: BigNumber | null\r\n}\r\n\r\n// Type 'string' is not assignable to type 'FindOptionsOrder<BigNumber>'.ts(2322)\r\nExampleModel.find({ order: { total: 'DESC' }})\r\n```\n\n### My Environment\n\n| Dependency          | Version  |\r\n| ---                 | ---      |\r\n| Operating System    | macOS 13.2.1 |\r\n| Node.js version     | 14.21.3 |\r\n| Typescript version  | 4.8.4  |\r\n| TypeORM version     | 0.3.12 |\r\n\n\n### Additional Context\n\n_No response_\n\n### Relevant Database Driver(s)\n\n- [ ] aurora-mysql\n- [ ] aurora-postgres\n- [ ] better-sqlite3\n- [ ] cockroachdb\n- [ ] cordova\n- [ ] expo\n- [ ] mongodb\n- [ ] mysql\n- [ ] nativescript\n- [ ] oracle\n- [X] postgres\n- [ ] react-native\n- [ ] sap\n- [ ] spanner\n- [ ] sqlite\n- [ ] sqlite-abstract\n- [ ] sqljs\n- [ ] sqlserver\n\n### Are you willing to resolve this issue by submitting a Pull Request?\n\nYes, I have the time, and I know how to start.","closed_by":{"login":"AlexMesser","id":17142628,"node_id":"MDQ6VXNlcjE3MTQyNjI4","avatar_url":"https://avatars.githubusercontent.com/u/17142628?v=4","gravatar_id":"","url":"https://api.github.com/users/AlexMesser","html_url":"https://github.com/AlexMesser","followers_url":"https://api.github.com/users/AlexMesser/followers","following_url":"https://api.github.com/users/AlexMesser/following{/other_user}","gists_url":"https://api.github.com/users/AlexMesser/gists{/gist_id}","starred_url":"https://api.github.com/users/AlexMesser/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/AlexMesser/subscriptions","organizations_url":"https://api.github.com/users/AlexMesser/orgs","repos_url":"https://api.github.com/users/AlexMesser/repos","events_url":"https://api.github.com/users/AlexMesser/events{/privacy}","received_events_url":"https://api.github.com/users/AlexMesser/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/9895/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/typeorm/typeorm/issues/9895/timeline","performed_via_github_app":null,"state_reason":"completed"}