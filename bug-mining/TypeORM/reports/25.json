{"url":"https://api.github.com/repos/typeorm/typeorm/issues/2719","repository_url":"https://api.github.com/repos/typeorm/typeorm","labels_url":"https://api.github.com/repos/typeorm/typeorm/issues/2719/labels{/name}","comments_url":"https://api.github.com/repos/typeorm/typeorm/issues/2719/comments","events_url":"https://api.github.com/repos/typeorm/typeorm/issues/2719/events","html_url":"https://github.com/typeorm/typeorm/issues/2719","id":354572778,"node_id":"MDU6SXNzdWUzNTQ1NzI3Nzg=","number":2719,"title":"TypeError: str.replace is not a function in util/StringUtils.ts","user":{"login":"sinner","id":429686,"node_id":"MDQ6VXNlcjQyOTY4Ng==","avatar_url":"https://avatars.githubusercontent.com/u/429686?v=4","gravatar_id":"","url":"https://api.github.com/users/sinner","html_url":"https://github.com/sinner","followers_url":"https://api.github.com/users/sinner/followers","following_url":"https://api.github.com/users/sinner/following{/other_user}","gists_url":"https://api.github.com/users/sinner/gists{/gist_id}","starred_url":"https://api.github.com/users/sinner/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/sinner/subscriptions","organizations_url":"https://api.github.com/users/sinner/orgs","repos_url":"https://api.github.com/users/sinner/repos","events_url":"https://api.github.com/users/sinner/events{/privacy}","received_events_url":"https://api.github.com/users/sinner/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":628495539,"node_id":"MDU6TGFiZWw2Mjg0OTU1Mzk=","url":"https://api.github.com/repos/typeorm/typeorm/labels/comp:%20migrations","name":"comp: migrations","color":"1d76db","default":false,"description":null}],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":13,"created_at":"2018-08-28T05:06:44Z","updated_at":"2024-04-05T08:48:23Z","closed_at":"2018-10-27T15:07:17Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[ ] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[x] `postgres`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n[ ] `expo`\r\n\r\n**TypeORM version:**\r\n\r\n[x] `latest`\r\n[ ] `@next`\r\n[ ] `0.x.x` (or put your version here)\r\n\r\n**Steps to reproduce or a small repository showing the problem:**\r\n\r\nI've created an entity, so my User entity has the following structure:\r\n\r\n```ts\r\nimport {\r\n    Entity, PrimaryGeneratedColumn, Column, CreateDateColumn, UpdateDateColumn, ManyToOne,\r\n    BeforeInsert, BeforeUpdate, JoinColumn\r\n} from \"typeorm\";\r\n\r\nimport {Contains, IsInt, Length, IsEmail, IsFQDN, IsDate, Min, Max, MaxLength, MinLength} from \"class-validator\";\r\n\r\n/**\r\n * User Entity\r\n */\r\n@Entity()\r\nexport class User {\r\n\r\n    @PrimaryGeneratedColumn()\r\n    id: number;\r\n\r\n    @Column({\r\n        name: \"uuid\",\r\n        type: \"varchar\",\r\n        length: 150,\r\n        unique: true\r\n    })\r\n    uuid: string;\r\n\r\n    @Column({\r\n        name: \"email\",\r\n        type: \"varchar\",\r\n        length: 180,\r\n        unique: true\r\n    })\r\n    @IsEmail()\r\n    @MaxLength(180, {\r\n        message: \"Email is too long\"\r\n    })\r\n    email: string;\r\n\r\n    @Column({\r\n        name: \"username\",\r\n        type: \"varchar\",\r\n        length: 50,\r\n        unique: true\r\n    })\r\n    @MinLength(3, {\r\n        message: \"Username is too short\"\r\n    })\r\n    @MaxLength(50, {\r\n        message: \"Username is too long\"\r\n    })\r\n    username: string;\r\n\r\n    @Column({\r\n        name: \"password\",\r\n        type: \"varchar\",\r\n        length: 150\r\n    })\r\n    password: string;\r\n\r\n    @Column({\r\n        name: \"salt\",\r\n        type: \"varchar\",\r\n        length: 150\r\n    })\r\n    salt: string;\r\n\r\n    @Column({\r\n        name: \"first_name\",\r\n        type: \"varchar\",\r\n        length: 150,\r\n        nullable: true\r\n    })\r\n    @MaxLength(150, {\r\n        message: \"First name is too long\"\r\n    })\r\n    firstName: string;\r\n\r\n    @Column({\r\n        name: \"last_name\",\r\n        type: \"varchar\",\r\n        length: 150,\r\n        nullable: true\r\n    })\r\n    @MaxLength(150, {\r\n        message: \"Last name is too long\"\r\n    })\r\n    lastName: string;\r\n\r\n    @Column({\r\n        name: \"display_name\",\r\n        type: \"varchar\",\r\n        length: 150,\r\n        nullable: true\r\n    })\r\n    @MaxLength(150, {\r\n        message: \"Display name is too long\"\r\n    })\r\n    displayName: string;\r\n\r\n    @Column({\r\n        name: \"activation_code\",\r\n        type: \"varchar\",\r\n        length: 150\r\n    })\r\n    activationCode: string;\r\n\r\n    @Column({\r\n        name: \"roles\",\r\n        type: \"simple-array\"\r\n    })\r\n    roles: string[];\r\n\r\n    @Column({\r\n        name: \"created_at\",\r\n        type: \"timestamp\"\r\n    })\r\n    @CreateDateColumn()\r\n    createdAt: Date;\r\n\r\n    @ManyToOne(type => User)\r\n    @JoinColumn({ name: \"created_by_id\" })\r\n    createdBy: User;\r\n\r\n    @Column({\r\n        name: \"updated_at\",\r\n        type: \"timestamp\"\r\n    })\r\n    @UpdateDateColumn()\r\n    updatedAt: Date;\r\n\r\n    @ManyToOne(type => User)\r\n    @JoinColumn({ name: \"updated_by_id\" })\r\n    updatedBy: User;\r\n\r\n    @Column({\r\n        name: \"is_email_confirmed\",\r\n        type: \"boolean\"\r\n    })\r\n    isEmailConfirmed: boolean;\r\n\r\n    @Column({\r\n        name: \"is_active\",\r\n        type: \"boolean\"\r\n    })\r\n    isActive: boolean;\r\n\r\n    /**\r\n     *\r\n     * @param {string} email\r\n     * @param {string} username\r\n     * @param {string} password\r\n     * @param {string} salt\r\n     * @param {string} displayName\r\n     * @param {string} activationCode\r\n     * @param {string[]} roles\r\n     * @param {number} isActive\r\n     */\r\n    constructor(displayName?: string, \r\n                email?: string, \r\n                username?: string, \r\n                password?: string, \r\n                salt?: string, \r\n                activationCode?: string, \r\n                roles?: string[], \r\n                isEmailConfirmed?: boolean, \r\n                isActive?: boolean) {\r\n        this.email = email;\r\n        this.username = username;\r\n        this.password = password;\r\n        this.salt = salt;\r\n        this.displayName = displayName;\r\n        this.activationCode = activationCode;\r\n        this.roles = roles;\r\n        this.isEmailConfirmed = isEmailConfirmed;\r\n        this.isActive = isActive;\r\n    }\r\n\r\n    @BeforeInsert()\r\n    beforeCreate() {\r\n        this.createdAt = new Date();\r\n        this.updatedAt = this.createdAt;\r\n    }\r\n\r\n    @BeforeUpdate()\r\n    beforeUpdate() {\r\n        this.updatedAt = new Date();\r\n    }\r\n\r\n}\r\n```\r\n\r\nWhen I tried to generate the proper migration for it running:\r\n\r\n```sh\r\nts-node ./node_modules/.bin/typeorm migration:generate -n\r\n```\r\n\r\nI'm receiving this response:\r\n\r\n```sh\r\nnode@133cd09eb3d4:/var/srv/app$ ts-node ./node_modules/.bin/typeorm migration:generate -n\r\nError during migration generation:\r\nTypeError: str.replace is not a function\r\n    at Object.camelCase (/var/srv/app/src/util/StringUtils.ts:9:15)\r\n    at Function.MigrationGenerateCommand.getTemplate (/var/srv/app/src/commands/MigrationGenerateCommand.ts:118:16)\r\n    at Object.<anonymous> (/var/srv/app/src/commands/MigrationGenerateCommand.ts:88:62)\r\n    at step (/var/srv/app/node_modules/typeorm/commands/MigrationGenerateCommand.js:32:23)\r\n    at Object.next (/var/srv/app/node_modules/typeorm/commands/MigrationGenerateCommand.js:13:53)\r\n    at fulfilled (/var/srv/app/node_modules/typeorm/commands/MigrationGenerateCommand.js:4:58)\r\n    at <anonymous>\r\n    at process._tickDomainCallback (internal/process/next_tick.js:228:7)\r\n```","closed_by":{"login":"pleerock","id":1753397,"node_id":"MDQ6VXNlcjE3NTMzOTc=","avatar_url":"https://avatars.githubusercontent.com/u/1753397?v=4","gravatar_id":"","url":"https://api.github.com/users/pleerock","html_url":"https://github.com/pleerock","followers_url":"https://api.github.com/users/pleerock/followers","following_url":"https://api.github.com/users/pleerock/following{/other_user}","gists_url":"https://api.github.com/users/pleerock/gists{/gist_id}","starred_url":"https://api.github.com/users/pleerock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pleerock/subscriptions","organizations_url":"https://api.github.com/users/pleerock/orgs","repos_url":"https://api.github.com/users/pleerock/repos","events_url":"https://api.github.com/users/pleerock/events{/privacy}","received_events_url":"https://api.github.com/users/pleerock/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/2719/reactions","total_count":12,"+1":9,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":3},"timeline_url":"https://api.github.com/repos/typeorm/typeorm/issues/2719/timeline","performed_via_github_app":null,"state_reason":"completed"}