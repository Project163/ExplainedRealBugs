[{"id":2406696710,"node_id":"MDE0Ok1lbnRpb25lZEV2ZW50MjQwNjY5NjcxMA==","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/2406696710","actor":{"login":"next-zz","id":8634283,"node_id":"MDQ6VXNlcjg2MzQyODM=","avatar_url":"https://avatars.githubusercontent.com/u/8634283?v=4","gravatar_id":"","url":"https://api.github.com/users/next-zz","html_url":"https://github.com/next-zz","followers_url":"https://api.github.com/users/next-zz/followers","following_url":"https://api.github.com/users/next-zz/following{/other_user}","gists_url":"https://api.github.com/users/next-zz/gists{/gist_id}","starred_url":"https://api.github.com/users/next-zz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/next-zz/subscriptions","organizations_url":"https://api.github.com/users/next-zz/orgs","repos_url":"https://api.github.com/users/next-zz/repos","events_url":"https://api.github.com/users/next-zz/events{/privacy}","received_events_url":"https://api.github.com/users/next-zz/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2019-06-12T09:17:18Z","performed_via_github_app":null},{"id":2406696711,"node_id":"MDE1OlN1YnNjcmliZWRFdmVudDI0MDY2OTY3MTE=","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/2406696711","actor":{"login":"next-zz","id":8634283,"node_id":"MDQ6VXNlcjg2MzQyODM=","avatar_url":"https://avatars.githubusercontent.com/u/8634283?v=4","gravatar_id":"","url":"https://api.github.com/users/next-zz","html_url":"https://github.com/next-zz","followers_url":"https://api.github.com/users/next-zz/followers","following_url":"https://api.github.com/users/next-zz/following{/other_user}","gists_url":"https://api.github.com/users/next-zz/gists{/gist_id}","starred_url":"https://api.github.com/users/next-zz/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/next-zz/subscriptions","organizations_url":"https://api.github.com/users/next-zz/orgs","repos_url":"https://api.github.com/users/next-zz/repos","events_url":"https://api.github.com/users/next-zz/events{/privacy}","received_events_url":"https://api.github.com/users/next-zz/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2019-06-12T09:17:18Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/501611996","html_url":"https://github.com/typeorm/typeorm/issues/4277#issuecomment-501611996","issue_url":"https://api.github.com/repos/typeorm/typeorm/issues/4277","id":501611996,"node_id":"MDEyOklzc3VlQ29tbWVudDUwMTYxMTk5Ng==","user":{"login":"Tallyrald","id":35098410,"node_id":"MDQ6VXNlcjM1MDk4NDEw","avatar_url":"https://avatars.githubusercontent.com/u/35098410?v=4","gravatar_id":"","url":"https://api.github.com/users/Tallyrald","html_url":"https://github.com/Tallyrald","followers_url":"https://api.github.com/users/Tallyrald/followers","following_url":"https://api.github.com/users/Tallyrald/following{/other_user}","gists_url":"https://api.github.com/users/Tallyrald/gists{/gist_id}","starred_url":"https://api.github.com/users/Tallyrald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tallyrald/subscriptions","organizations_url":"https://api.github.com/users/Tallyrald/orgs","repos_url":"https://api.github.com/users/Tallyrald/repos","events_url":"https://api.github.com/users/Tallyrald/events{/privacy}","received_events_url":"https://api.github.com/users/Tallyrald/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-06-13T08:51:03Z","updated_at":"2019-06-13T08:51:03Z","body":"It seems the problem originates from somewhere in SelectQueryBuilder's getManyAndCount() method.\r\nLooking at the logs whenever the cache option is omitted (that is cache is disabled on the query) 3 queries are run.\r\n1) The one mentioned above which fetches the required user ids (I believe it's this part here)\r\nhttps://github.com/typeorm/typeorm/blob/0d47ccdb0255a480a9fe0044cbac152675337d52/src/query-builder/SelectQueryBuilder.ts#L1794-L1804\r\n2) The data fetching query generated by the same method using the loadRawResults method\r\nhttps://github.com/typeorm/typeorm/blob/0d47ccdb0255a480a9fe0044cbac152675337d52/src/query-builder/SelectQueryBuilder.ts#L1806-L1835\r\n3) The entity counting query\r\nhttps://github.com/typeorm/typeorm/blob/0d47ccdb0255a480a9fe0044cbac152675337d52/src/query-builder/SelectQueryBuilder.ts#L1731-L1743\r\n\r\nHowever, with caching enabled on the query, the counting query is missing from the logs so I assume it does not get executed for some reason and therefore `!results[0][\"cnt\"]` (see 3rd linked code line 1742) returns true since it doesn't exist. Even better in my debugging session the `result` variable contained raw text results from the second query instead of the counting query. I haven't been able to narrow it down any further yet.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/501611996/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Tallyrald","id":35098410,"node_id":"MDQ6VXNlcjM1MDk4NDEw","avatar_url":"https://avatars.githubusercontent.com/u/35098410?v=4","gravatar_id":"","url":"https://api.github.com/users/Tallyrald","html_url":"https://github.com/Tallyrald","followers_url":"https://api.github.com/users/Tallyrald/followers","following_url":"https://api.github.com/users/Tallyrald/following{/other_user}","gists_url":"https://api.github.com/users/Tallyrald/gists{/gist_id}","starred_url":"https://api.github.com/users/Tallyrald/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Tallyrald/subscriptions","organizations_url":"https://api.github.com/users/Tallyrald/orgs","repos_url":"https://api.github.com/users/Tallyrald/repos","events_url":"https://api.github.com/users/Tallyrald/events{/privacy}","received_events_url":"https://api.github.com/users/Tallyrald/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":2432074838,"node_id":"MDEyOkxhYmVsZWRFdmVudDI0MzIwNzQ4Mzg=","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/2432074838","actor":{"login":"Kononnable","id":9082099,"node_id":"MDQ6VXNlcjkwODIwOTk=","avatar_url":"https://avatars.githubusercontent.com/u/9082099?v=4","gravatar_id":"","url":"https://api.github.com/users/Kononnable","html_url":"https://github.com/Kononnable","followers_url":"https://api.github.com/users/Kononnable/followers","following_url":"https://api.github.com/users/Kononnable/following{/other_user}","gists_url":"https://api.github.com/users/Kononnable/gists{/gist_id}","starred_url":"https://api.github.com/users/Kononnable/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Kononnable/subscriptions","organizations_url":"https://api.github.com/users/Kononnable/orgs","repos_url":"https://api.github.com/users/Kononnable/repos","events_url":"https://api.github.com/users/Kononnable/events{/privacy}","received_events_url":"https://api.github.com/users/Kononnable/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2019-06-22T17:48:37Z","label":{"name":"comp: cache","color":"1d76db"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/537832460","html_url":"https://github.com/typeorm/typeorm/issues/4277#issuecomment-537832460","issue_url":"https://api.github.com/repos/typeorm/typeorm/issues/4277","id":537832460,"node_id":"MDEyOklzc3VlQ29tbWVudDUzNzgzMjQ2MA==","user":{"login":"mikelduffy","id":831939,"node_id":"MDQ6VXNlcjgzMTkzOQ==","avatar_url":"https://avatars.githubusercontent.com/u/831939?v=4","gravatar_id":"","url":"https://api.github.com/users/mikelduffy","html_url":"https://github.com/mikelduffy","followers_url":"https://api.github.com/users/mikelduffy/followers","following_url":"https://api.github.com/users/mikelduffy/following{/other_user}","gists_url":"https://api.github.com/users/mikelduffy/gists{/gist_id}","starred_url":"https://api.github.com/users/mikelduffy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikelduffy/subscriptions","organizations_url":"https://api.github.com/users/mikelduffy/orgs","repos_url":"https://api.github.com/users/mikelduffy/repos","events_url":"https://api.github.com/users/mikelduffy/events{/privacy}","received_events_url":"https://api.github.com/users/mikelduffy/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2019-10-03T07:55:49Z","updated_at":"2019-10-03T07:55:49Z","body":"Faced a similar issue. This is happening in the [getFromCache](https://github.com/typeorm/typeorm/blob/master/src/cache/RedisQueryResultCache.ts#L98) function when being used with a cache id (`userBasicList` in your case). The cache stores the JSON string of a single query/result set using the cache id as the key. So when used with `findAndCount` the cache will always return the results for the first query (raw elements) rather than the second query (total element count).","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/537832460/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"mikelduffy","id":831939,"node_id":"MDQ6VXNlcjgzMTkzOQ==","avatar_url":"https://avatars.githubusercontent.com/u/831939?v=4","gravatar_id":"","url":"https://api.github.com/users/mikelduffy","html_url":"https://github.com/mikelduffy","followers_url":"https://api.github.com/users/mikelduffy/followers","following_url":"https://api.github.com/users/mikelduffy/following{/other_user}","gists_url":"https://api.github.com/users/mikelduffy/gists{/gist_id}","starred_url":"https://api.github.com/users/mikelduffy/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/mikelduffy/subscriptions","organizations_url":"https://api.github.com/users/mikelduffy/orgs","repos_url":"https://api.github.com/users/mikelduffy/repos","events_url":"https://api.github.com/users/mikelduffy/events{/privacy}","received_events_url":"https://api.github.com/users/mikelduffy/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/577175390","html_url":"https://github.com/typeorm/typeorm/issues/4277#issuecomment-577175390","issue_url":"https://api.github.com/repos/typeorm/typeorm/issues/4277","id":577175390,"node_id":"MDEyOklzc3VlQ29tbWVudDU3NzE3NTM5MA==","user":{"login":"Ponjimon","id":770632,"node_id":"MDQ6VXNlcjc3MDYzMg==","avatar_url":"https://avatars.githubusercontent.com/u/770632?v=4","gravatar_id":"","url":"https://api.github.com/users/Ponjimon","html_url":"https://github.com/Ponjimon","followers_url":"https://api.github.com/users/Ponjimon/followers","following_url":"https://api.github.com/users/Ponjimon/following{/other_user}","gists_url":"https://api.github.com/users/Ponjimon/gists{/gist_id}","starred_url":"https://api.github.com/users/Ponjimon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ponjimon/subscriptions","organizations_url":"https://api.github.com/users/Ponjimon/orgs","repos_url":"https://api.github.com/users/Ponjimon/repos","events_url":"https://api.github.com/users/Ponjimon/events{/privacy}","received_events_url":"https://api.github.com/users/Ponjimon/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-01-22T13:12:55Z","updated_at":"2020-01-22T13:12:55Z","body":"Any update on this? ","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/577175390/reactions","total_count":11,"+1":10,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":1},"performed_via_github_app":null,"event":"commented","actor":{"login":"Ponjimon","id":770632,"node_id":"MDQ6VXNlcjc3MDYzMg==","avatar_url":"https://avatars.githubusercontent.com/u/770632?v=4","gravatar_id":"","url":"https://api.github.com/users/Ponjimon","html_url":"https://github.com/Ponjimon","followers_url":"https://api.github.com/users/Ponjimon/followers","following_url":"https://api.github.com/users/Ponjimon/following{/other_user}","gists_url":"https://api.github.com/users/Ponjimon/gists{/gist_id}","starred_url":"https://api.github.com/users/Ponjimon/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Ponjimon/subscriptions","organizations_url":"https://api.github.com/users/Ponjimon/orgs","repos_url":"https://api.github.com/users/Ponjimon/repos","events_url":"https://api.github.com/users/Ponjimon/events{/privacy}","received_events_url":"https://api.github.com/users/Ponjimon/received_events","type":"User","user_view_type":"public","site_admin":false}},{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/589531199","html_url":"https://github.com/typeorm/typeorm/issues/4277#issuecomment-589531199","issue_url":"https://api.github.com/repos/typeorm/typeorm/issues/4277","id":589531199,"node_id":"MDEyOklzc3VlQ29tbWVudDU4OTUzMTE5OQ==","user":{"login":"Thibaut-B","id":951180,"node_id":"MDQ6VXNlcjk1MTE4MA==","avatar_url":"https://avatars.githubusercontent.com/u/951180?v=4","gravatar_id":"","url":"https://api.github.com/users/Thibaut-B","html_url":"https://github.com/Thibaut-B","followers_url":"https://api.github.com/users/Thibaut-B/followers","following_url":"https://api.github.com/users/Thibaut-B/following{/other_user}","gists_url":"https://api.github.com/users/Thibaut-B/gists{/gist_id}","starred_url":"https://api.github.com/users/Thibaut-B/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Thibaut-B/subscriptions","organizations_url":"https://api.github.com/users/Thibaut-B/orgs","repos_url":"https://api.github.com/users/Thibaut-B/repos","events_url":"https://api.github.com/users/Thibaut-B/events{/privacy}","received_events_url":"https://api.github.com/users/Thibaut-B/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2020-02-21T07:22:24Z","updated_at":"2021-10-21T11:50:14Z","body":"Same problem for me...","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/589531199/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"Thibaut-B","id":951180,"node_id":"MDQ6VXNlcjk1MTE4MA==","avatar_url":"https://avatars.githubusercontent.com/u/951180?v=4","gravatar_id":"","url":"https://api.github.com/users/Thibaut-B","html_url":"https://github.com/Thibaut-B","followers_url":"https://api.github.com/users/Thibaut-B/followers","following_url":"https://api.github.com/users/Thibaut-B/following{/other_user}","gists_url":"https://api.github.com/users/Thibaut-B/gists{/gist_id}","starred_url":"https://api.github.com/users/Thibaut-B/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/Thibaut-B/subscriptions","organizations_url":"https://api.github.com/users/Thibaut-B/orgs","repos_url":"https://api.github.com/users/Thibaut-B/repos","events_url":"https://api.github.com/users/Thibaut-B/events{/privacy}","received_events_url":"https://api.github.com/users/Thibaut-B/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":3843622987,"node_id":"MDEyOkxhYmVsZWRFdmVudDM4NDM2MjI5ODc=","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/3843622987","actor":{"login":"imnotjames","id":1551593,"node_id":"MDQ6VXNlcjE1NTE1OTM=","avatar_url":"https://avatars.githubusercontent.com/u/1551593?v=4","gravatar_id":"","url":"https://api.github.com/users/imnotjames","html_url":"https://github.com/imnotjames","followers_url":"https://api.github.com/users/imnotjames/followers","following_url":"https://api.github.com/users/imnotjames/following{/other_user}","gists_url":"https://api.github.com/users/imnotjames/gists{/gist_id}","starred_url":"https://api.github.com/users/imnotjames/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imnotjames/subscriptions","organizations_url":"https://api.github.com/users/imnotjames/orgs","repos_url":"https://api.github.com/users/imnotjames/repos","events_url":"https://api.github.com/users/imnotjames/events{/privacy}","received_events_url":"https://api.github.com/users/imnotjames/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-10-06T06:14:04Z","label":{"name":"bug","color":"fc2929"},"performed_via_github_app":null},{"id":3843622991,"node_id":"MDEyOkxhYmVsZWRFdmVudDM4NDM2MjI5OTE=","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/3843622991","actor":{"login":"imnotjames","id":1551593,"node_id":"MDQ6VXNlcjE1NTE1OTM=","avatar_url":"https://avatars.githubusercontent.com/u/1551593?v=4","gravatar_id":"","url":"https://api.github.com/users/imnotjames","html_url":"https://github.com/imnotjames","followers_url":"https://api.github.com/users/imnotjames/followers","following_url":"https://api.github.com/users/imnotjames/following{/other_user}","gists_url":"https://api.github.com/users/imnotjames/gists{/gist_id}","starred_url":"https://api.github.com/users/imnotjames/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imnotjames/subscriptions","organizations_url":"https://api.github.com/users/imnotjames/orgs","repos_url":"https://api.github.com/users/imnotjames/repos","events_url":"https://api.github.com/users/imnotjames/events{/privacy}","received_events_url":"https://api.github.com/users/imnotjames/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-10-06T06:14:04Z","label":{"name":"driver: mariadb","color":"0052cc"},"performed_via_github_app":null},{"id":3843622995,"node_id":"MDEyOkxhYmVsZWRFdmVudDM4NDM2MjI5OTU=","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/3843622995","actor":{"login":"imnotjames","id":1551593,"node_id":"MDQ6VXNlcjE1NTE1OTM=","avatar_url":"https://avatars.githubusercontent.com/u/1551593?v=4","gravatar_id":"","url":"https://api.github.com/users/imnotjames","html_url":"https://github.com/imnotjames","followers_url":"https://api.github.com/users/imnotjames/followers","following_url":"https://api.github.com/users/imnotjames/following{/other_user}","gists_url":"https://api.github.com/users/imnotjames/gists{/gist_id}","starred_url":"https://api.github.com/users/imnotjames/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imnotjames/subscriptions","organizations_url":"https://api.github.com/users/imnotjames/orgs","repos_url":"https://api.github.com/users/imnotjames/repos","events_url":"https://api.github.com/users/imnotjames/events{/privacy}","received_events_url":"https://api.github.com/users/imnotjames/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"labeled","commit_id":null,"commit_url":null,"created_at":"2020-10-06T06:14:04Z","label":{"name":"driver: mysql","color":"0052cc"},"performed_via_github_app":null},{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/784570224","html_url":"https://github.com/typeorm/typeorm/issues/4277#issuecomment-784570224","issue_url":"https://api.github.com/repos/typeorm/typeorm/issues/4277","id":784570224,"node_id":"MDEyOklzc3VlQ29tbWVudDc4NDU3MDIyNA==","user":{"login":"xmflsct","id":292204,"node_id":"MDQ6VXNlcjI5MjIwNA==","avatar_url":"https://avatars.githubusercontent.com/u/292204?v=4","gravatar_id":"","url":"https://api.github.com/users/xmflsct","html_url":"https://github.com/xmflsct","followers_url":"https://api.github.com/users/xmflsct/followers","following_url":"https://api.github.com/users/xmflsct/following{/other_user}","gists_url":"https://api.github.com/users/xmflsct/gists{/gist_id}","starred_url":"https://api.github.com/users/xmflsct/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xmflsct/subscriptions","organizations_url":"https://api.github.com/users/xmflsct/orgs","repos_url":"https://api.github.com/users/xmflsct/repos","events_url":"https://api.github.com/users/xmflsct/events{/privacy}","received_events_url":"https://api.github.com/users/xmflsct/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-02-23T22:51:52Z","updated_at":"2021-02-23T22:51:52Z","body":"Same, using `postgres` and `redis`.","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/784570224/reactions","total_count":2,"+1":2,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"xmflsct","id":292204,"node_id":"MDQ6VXNlcjI5MjIwNA==","avatar_url":"https://avatars.githubusercontent.com/u/292204?v=4","gravatar_id":"","url":"https://api.github.com/users/xmflsct","html_url":"https://github.com/xmflsct","followers_url":"https://api.github.com/users/xmflsct/followers","following_url":"https://api.github.com/users/xmflsct/following{/other_user}","gists_url":"https://api.github.com/users/xmflsct/gists{/gist_id}","starred_url":"https://api.github.com/users/xmflsct/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/xmflsct/subscriptions","organizations_url":"https://api.github.com/users/xmflsct/orgs","repos_url":"https://api.github.com/users/xmflsct/repos","events_url":"https://api.github.com/users/xmflsct/events{/privacy}","received_events_url":"https://api.github.com/users/xmflsct/received_events","type":"User","user_view_type":"public","site_admin":false}},{"actor":{"login":"vasu2652","id":22323578,"node_id":"MDQ6VXNlcjIyMzIzNTc4","avatar_url":"https://avatars.githubusercontent.com/u/22323578?v=4","gravatar_id":"","url":"https://api.github.com/users/vasu2652","html_url":"https://github.com/vasu2652","followers_url":"https://api.github.com/users/vasu2652/followers","following_url":"https://api.github.com/users/vasu2652/following{/other_user}","gists_url":"https://api.github.com/users/vasu2652/gists{/gist_id}","starred_url":"https://api.github.com/users/vasu2652/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vasu2652/subscriptions","organizations_url":"https://api.github.com/users/vasu2652/orgs","repos_url":"https://api.github.com/users/vasu2652/repos","events_url":"https://api.github.com/users/vasu2652/events{/privacy}","received_events_url":"https://api.github.com/users/vasu2652/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-05-02T19:03:00Z","updated_at":"2021-05-02T19:03:00Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/7610","repository_url":"https://api.github.com/repos/typeorm/typeorm","labels_url":"https://api.github.com/repos/typeorm/typeorm/issues/7610/labels{/name}","comments_url":"https://api.github.com/repos/typeorm/typeorm/issues/7610/comments","events_url":"https://api.github.com/repos/typeorm/typeorm/issues/7610/events","html_url":"https://github.com/typeorm/typeorm/pull/7610","id":874017855,"node_id":"MDExOlB1bGxSZXF1ZXN0NjI4NjU5NTM2","number":7610,"title":"Fix: remove unnecessary caching of SELECT DISTINCT query while using repository functions","user":{"login":"vasu2652","id":22323578,"node_id":"MDQ6VXNlcjIyMzIzNTc4","avatar_url":"https://avatars.githubusercontent.com/u/22323578?v=4","gravatar_id":"","url":"https://api.github.com/users/vasu2652","html_url":"https://github.com/vasu2652","followers_url":"https://api.github.com/users/vasu2652/followers","following_url":"https://api.github.com/users/vasu2652/following{/other_user}","gists_url":"https://api.github.com/users/vasu2652/gists{/gist_id}","starred_url":"https://api.github.com/users/vasu2652/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vasu2652/subscriptions","organizations_url":"https://api.github.com/users/vasu2652/orgs","repos_url":"https://api.github.com/users/vasu2652/repos","events_url":"https://api.github.com/users/vasu2652/events{/privacy}","received_events_url":"https://api.github.com/users/vasu2652/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":3,"created_at":"2021-05-02T19:03:00Z","updated_at":"2021-07-25T05:13:06Z","closed_at":"2021-07-25T05:13:06Z","author_association":"NONE","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":52773157,"node_id":"MDEwOlJlcG9zaXRvcnk1Mjc3MzE1Nw==","name":"typeorm","full_name":"typeorm/typeorm","private":false,"owner":{"login":"typeorm","id":20165699,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwMTY1Njk5","avatar_url":"https://avatars.githubusercontent.com/u/20165699?v=4","gravatar_id":"","url":"https://api.github.com/users/typeorm","html_url":"https://github.com/typeorm","followers_url":"https://api.github.com/users/typeorm/followers","following_url":"https://api.github.com/users/typeorm/following{/other_user}","gists_url":"https://api.github.com/users/typeorm/gists{/gist_id}","starred_url":"https://api.github.com/users/typeorm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/typeorm/subscriptions","organizations_url":"https://api.github.com/users/typeorm/orgs","repos_url":"https://api.github.com/users/typeorm/repos","events_url":"https://api.github.com/users/typeorm/events{/privacy}","received_events_url":"https://api.github.com/users/typeorm/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/typeorm/typeorm","description":"ORM for TypeScript and JavaScript. Supports MySQL, PostgreSQL, MariaDB, SQLite, MS SQL Server, Oracle, SAP Hana, WebSQL databases. Works in NodeJS, Browser, Ionic, Cordova and Electron platforms.","fork":false,"url":"https://api.github.com/repos/typeorm/typeorm","forks_url":"https://api.github.com/repos/typeorm/typeorm/forks","keys_url":"https://api.github.com/repos/typeorm/typeorm/keys{/key_id}","collaborators_url":"https://api.github.com/repos/typeorm/typeorm/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/typeorm/typeorm/teams","hooks_url":"https://api.github.com/repos/typeorm/typeorm/hooks","issue_events_url":"https://api.github.com/repos/typeorm/typeorm/issues/events{/number}","events_url":"https://api.github.com/repos/typeorm/typeorm/events","assignees_url":"https://api.github.com/repos/typeorm/typeorm/assignees{/user}","branches_url":"https://api.github.com/repos/typeorm/typeorm/branches{/branch}","tags_url":"https://api.github.com/repos/typeorm/typeorm/tags","blobs_url":"https://api.github.com/repos/typeorm/typeorm/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/typeorm/typeorm/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/typeorm/typeorm/git/refs{/sha}","trees_url":"https://api.github.com/repos/typeorm/typeorm/git/trees{/sha}","statuses_url":"https://api.github.com/repos/typeorm/typeorm/statuses/{sha}","languages_url":"https://api.github.com/repos/typeorm/typeorm/languages","stargazers_url":"https://api.github.com/repos/typeorm/typeorm/stargazers","contributors_url":"https://api.github.com/repos/typeorm/typeorm/contributors","subscribers_url":"https://api.github.com/repos/typeorm/typeorm/subscribers","subscription_url":"https://api.github.com/repos/typeorm/typeorm/subscription","commits_url":"https://api.github.com/repos/typeorm/typeorm/commits{/sha}","git_commits_url":"https://api.github.com/repos/typeorm/typeorm/git/commits{/sha}","comments_url":"https://api.github.com/repos/typeorm/typeorm/comments{/number}","issue_comment_url":"https://api.github.com/repos/typeorm/typeorm/issues/comments{/number}","contents_url":"https://api.github.com/repos/typeorm/typeorm/contents/{+path}","compare_url":"https://api.github.com/repos/typeorm/typeorm/compare/{base}...{head}","merges_url":"https://api.github.com/repos/typeorm/typeorm/merges","archive_url":"https://api.github.com/repos/typeorm/typeorm/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/typeorm/typeorm/downloads","issues_url":"https://api.github.com/repos/typeorm/typeorm/issues{/number}","pulls_url":"https://api.github.com/repos/typeorm/typeorm/pulls{/number}","milestones_url":"https://api.github.com/repos/typeorm/typeorm/milestones{/number}","notifications_url":"https://api.github.com/repos/typeorm/typeorm/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/typeorm/typeorm/labels{/name}","releases_url":"https://api.github.com/repos/typeorm/typeorm/releases{/id}","deployments_url":"https://api.github.com/repos/typeorm/typeorm/deployments","created_at":"2016-02-29T07:41:14Z","updated_at":"2025-11-09T20:57:36Z","pushed_at":"2025-11-09T20:57:31Z","git_url":"git://github.com/typeorm/typeorm.git","ssh_url":"git@github.com:typeorm/typeorm.git","clone_url":"https://github.com/typeorm/typeorm.git","svn_url":"https://github.com/typeorm/typeorm","homepage":"http://typeorm.io","size":31490,"stargazers_count":36005,"watchers_count":36005,"language":"TypeScript","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":6454,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":523,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["active-record","cockroachdb","data-mapper","database","electron","hacktoberfest","javascript","mariadb","mysql","oracle","orm","postgresql","react-native","sap","sap-hana","sqlite","sqlserver","typeorm","typescript","websql"],"visibility":"public","forks":6454,"open_issues":523,"watchers":36005,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/typeorm/typeorm/pulls/7610","html_url":"https://github.com/typeorm/typeorm/pull/7610","diff_url":"https://github.com/typeorm/typeorm/pull/7610.diff","patch_url":"https://github.com/typeorm/typeorm/pull/7610.patch","merged_at":null},"body":"Fix: remove unnecessary caching of preselect query while using the repository functions.\r\n\r\n### Description of change\r\n\r\nWhen using repository functions like findOne or find or findAndCount with cache enabled the default behavior of TypeOrm is trying to cache the intended query with the provided identifier and also a preselect query with a SELECT DISTINCT to resolve the PrimaryColumn.\r\n\r\nDue to this data invalidation is going a bit out of control and we are getting to see stale data for a period of time after mutation on the entity.\r\n\r\nCurrent Behaviour: Return stale data even after invalidation using the provided identifier.\r\n\r\nExpected Behaviour: Return updated data after invalidation using provided the identifier.\r\n\r\nCloses: #2721, #5983, #4277\r\n\r\n\r\n\r\n### Pull-Request Checklist\r\n\r\n<!--\r\n  Please make sure to review and check all of the following.\r\n\r\n  If an item is not applicable, you can add \"N/A\" to the end.\r\n-->\r\n\r\n- [x] Code is up-to-date with the `master` branch\r\n- [x] `npm run lint` passes with this change\r\n- [x] `npm run test` passes with this change\r\n- [x] This pull request links relevant issues as `Fixes #2721 #5983 #4277`\r\n- [x] There are new or updated unit tests validating the change\r\n- [ ] Documentation has been updated to reflect this change N/A\r\n- [x] The new commits follow conventions explained in [CONTRIBUTING.md](https://github.com/typeorm/typeorm/blob/master/CONTRIBUTING.md)\r\n\r\n<!--\r\n  ðŸŽ‰ Thank you for contributing and making TypeORM even better!\r\n-->\r\n","reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/7610/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/typeorm/typeorm/issues/7610/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":4675147392,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ2NzUxNDczOTI=","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/4675147392","actor":{"login":"vasu2652","id":22323578,"node_id":"MDQ6VXNlcjIyMzIzNTc4","avatar_url":"https://avatars.githubusercontent.com/u/22323578?v=4","gravatar_id":"","url":"https://api.github.com/users/vasu2652","html_url":"https://github.com/vasu2652","followers_url":"https://api.github.com/users/vasu2652/followers","following_url":"https://api.github.com/users/vasu2652/following{/other_user}","gists_url":"https://api.github.com/users/vasu2652/gists{/gist_id}","starred_url":"https://api.github.com/users/vasu2652/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vasu2652/subscriptions","organizations_url":"https://api.github.com/users/vasu2652/orgs","repos_url":"https://api.github.com/users/vasu2652/repos","events_url":"https://api.github.com/users/vasu2652/events{/privacy}","received_events_url":"https://api.github.com/users/vasu2652/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"7104baa96004558603c968b19774a6dd3ec3b7e0","commit_url":"https://api.github.com/repos/vasu2652/typeorm/commits/7104baa96004558603c968b19774a6dd3ec3b7e0","created_at":"2021-05-02T19:08:08Z","performed_via_github_app":null},{"id":4675147396,"node_id":"MDE1OlJlZmVyZW5jZWRFdmVudDQ2NzUxNDczOTY=","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/4675147396","actor":{"login":"vasu2652","id":22323578,"node_id":"MDQ6VXNlcjIyMzIzNTc4","avatar_url":"https://avatars.githubusercontent.com/u/22323578?v=4","gravatar_id":"","url":"https://api.github.com/users/vasu2652","html_url":"https://github.com/vasu2652","followers_url":"https://api.github.com/users/vasu2652/followers","following_url":"https://api.github.com/users/vasu2652/following{/other_user}","gists_url":"https://api.github.com/users/vasu2652/gists{/gist_id}","starred_url":"https://api.github.com/users/vasu2652/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/vasu2652/subscriptions","organizations_url":"https://api.github.com/users/vasu2652/orgs","repos_url":"https://api.github.com/users/vasu2652/repos","events_url":"https://api.github.com/users/vasu2652/events{/privacy}","received_events_url":"https://api.github.com/users/vasu2652/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"ef2da1d264e1862ae77b7f3ba29853b4be748906","commit_url":"https://api.github.com/repos/vasu2652/typeorm/commits/ef2da1d264e1862ae77b7f3ba29853b4be748906","created_at":"2021-05-02T19:08:08Z","performed_via_github_app":null},{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/903175661","html_url":"https://github.com/typeorm/typeorm/issues/4277#issuecomment-903175661","issue_url":"https://api.github.com/repos/typeorm/typeorm/issues/4277","id":903175661,"node_id":"IC_kwDOAyVBJc411V3t","user":{"login":"piosystems","id":3983248,"node_id":"MDQ6VXNlcjM5ODMyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/3983248?v=4","gravatar_id":"","url":"https://api.github.com/users/piosystems","html_url":"https://github.com/piosystems","followers_url":"https://api.github.com/users/piosystems/followers","following_url":"https://api.github.com/users/piosystems/following{/other_user}","gists_url":"https://api.github.com/users/piosystems/gists{/gist_id}","starred_url":"https://api.github.com/users/piosystems/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/piosystems/subscriptions","organizations_url":"https://api.github.com/users/piosystems/orgs","repos_url":"https://api.github.com/users/piosystems/repos","events_url":"https://api.github.com/users/piosystems/events{/privacy}","received_events_url":"https://api.github.com/users/piosystems/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-08-21T20:59:45Z","updated_at":"2021-10-21T11:50:03Z","body":"The bug is still in place as at 0.2.37. Any upcoming fix?","author_association":"NONE","reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/comments/903175661/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"performed_via_github_app":null,"event":"commented","actor":{"login":"piosystems","id":3983248,"node_id":"MDQ6VXNlcjM5ODMyNDg=","avatar_url":"https://avatars.githubusercontent.com/u/3983248?v=4","gravatar_id":"","url":"https://api.github.com/users/piosystems","html_url":"https://github.com/piosystems","followers_url":"https://api.github.com/users/piosystems/followers","following_url":"https://api.github.com/users/piosystems/following{/other_user}","gists_url":"https://api.github.com/users/piosystems/gists{/gist_id}","starred_url":"https://api.github.com/users/piosystems/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/piosystems/subscriptions","organizations_url":"https://api.github.com/users/piosystems/orgs","repos_url":"https://api.github.com/users/piosystems/repos","events_url":"https://api.github.com/users/piosystems/events{/privacy}","received_events_url":"https://api.github.com/users/piosystems/received_events","type":"User","user_view_type":"public","site_admin":false}},{"id":5385478964,"node_id":"MEE_lADOAyVBJc4bIEivzwAAAAFA_-M0","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/5385478964","actor":{"login":"imnotjames","id":1551593,"node_id":"MDQ6VXNlcjE1NTE1OTM=","avatar_url":"https://avatars.githubusercontent.com/u/1551593?v=4","gravatar_id":"","url":"https://api.github.com/users/imnotjames","html_url":"https://github.com/imnotjames","followers_url":"https://api.github.com/users/imnotjames/followers","following_url":"https://api.github.com/users/imnotjames/following{/other_user}","gists_url":"https://api.github.com/users/imnotjames/gists{/gist_id}","starred_url":"https://api.github.com/users/imnotjames/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imnotjames/subscriptions","organizations_url":"https://api.github.com/users/imnotjames/orgs","repos_url":"https://api.github.com/users/imnotjames/repos","events_url":"https://api.github.com/users/imnotjames/events{/privacy}","received_events_url":"https://api.github.com/users/imnotjames/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-09-30T07:10:37Z","performed_via_github_app":null},{"id":5385478970,"node_id":"SE_lADOAyVBJc4bIEivzwAAAAFA_-M6","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/5385478970","actor":{"login":"imnotjames","id":1551593,"node_id":"MDQ6VXNlcjE1NTE1OTM=","avatar_url":"https://avatars.githubusercontent.com/u/1551593?v=4","gravatar_id":"","url":"https://api.github.com/users/imnotjames","html_url":"https://github.com/imnotjames","followers_url":"https://api.github.com/users/imnotjames/followers","following_url":"https://api.github.com/users/imnotjames/following{/other_user}","gists_url":"https://api.github.com/users/imnotjames/gists{/gist_id}","starred_url":"https://api.github.com/users/imnotjames/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/imnotjames/subscriptions","organizations_url":"https://api.github.com/users/imnotjames/orgs","repos_url":"https://api.github.com/users/imnotjames/repos","events_url":"https://api.github.com/users/imnotjames/events{/privacy}","received_events_url":"https://api.github.com/users/imnotjames/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-09-30T07:10:37Z","performed_via_github_app":null},{"id":5385478973,"node_id":"MEE_lADOAyVBJc4bIEivzwAAAAFA_-M9","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/5385478973","actor":{"login":"pleerock","id":1753397,"node_id":"MDQ6VXNlcjE3NTMzOTc=","avatar_url":"https://avatars.githubusercontent.com/u/1753397?v=4","gravatar_id":"","url":"https://api.github.com/users/pleerock","html_url":"https://github.com/pleerock","followers_url":"https://api.github.com/users/pleerock/followers","following_url":"https://api.github.com/users/pleerock/following{/other_user}","gists_url":"https://api.github.com/users/pleerock/gists{/gist_id}","starred_url":"https://api.github.com/users/pleerock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pleerock/subscriptions","organizations_url":"https://api.github.com/users/pleerock/orgs","repos_url":"https://api.github.com/users/pleerock/repos","events_url":"https://api.github.com/users/pleerock/events{/privacy}","received_events_url":"https://api.github.com/users/pleerock/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-09-30T07:10:38Z","performed_via_github_app":null},{"id":5385478975,"node_id":"SE_lADOAyVBJc4bIEivzwAAAAFA_-M_","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/5385478975","actor":{"login":"pleerock","id":1753397,"node_id":"MDQ6VXNlcjE3NTMzOTc=","avatar_url":"https://avatars.githubusercontent.com/u/1753397?v=4","gravatar_id":"","url":"https://api.github.com/users/pleerock","html_url":"https://github.com/pleerock","followers_url":"https://api.github.com/users/pleerock/followers","following_url":"https://api.github.com/users/pleerock/following{/other_user}","gists_url":"https://api.github.com/users/pleerock/gists{/gist_id}","starred_url":"https://api.github.com/users/pleerock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pleerock/subscriptions","organizations_url":"https://api.github.com/users/pleerock/orgs","repos_url":"https://api.github.com/users/pleerock/repos","events_url":"https://api.github.com/users/pleerock/events{/privacy}","received_events_url":"https://api.github.com/users/pleerock/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-09-30T07:10:38Z","performed_via_github_app":null},{"id":5474870445,"node_id":"REFE_lADOAyVBJc4bIEivzwAAAAFGU-St","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/5474870445","actor":{"login":"eugenio165","id":33187923,"node_id":"MDQ6VXNlcjMzMTg3OTIz","avatar_url":"https://avatars.githubusercontent.com/u/33187923?v=4","gravatar_id":"","url":"https://api.github.com/users/eugenio165","html_url":"https://github.com/eugenio165","followers_url":"https://api.github.com/users/eugenio165/followers","following_url":"https://api.github.com/users/eugenio165/following{/other_user}","gists_url":"https://api.github.com/users/eugenio165/gists{/gist_id}","starred_url":"https://api.github.com/users/eugenio165/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eugenio165/subscriptions","organizations_url":"https://api.github.com/users/eugenio165/orgs","repos_url":"https://api.github.com/users/eugenio165/repos","events_url":"https://api.github.com/users/eugenio165/events{/privacy}","received_events_url":"https://api.github.com/users/eugenio165/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"fe17e7f822878dcf8d2dc370db5a3bb886924b85","commit_url":"https://api.github.com/repos/eugenio165/typeorm/commits/fe17e7f822878dcf8d2dc370db5a3bb886924b85","created_at":"2021-10-17T23:32:09Z","performed_via_github_app":null},{"actor":{"login":"eugenio165","id":33187923,"node_id":"MDQ6VXNlcjMzMTg3OTIz","avatar_url":"https://avatars.githubusercontent.com/u/33187923?v=4","gravatar_id":"","url":"https://api.github.com/users/eugenio165","html_url":"https://github.com/eugenio165","followers_url":"https://api.github.com/users/eugenio165/followers","following_url":"https://api.github.com/users/eugenio165/following{/other_user}","gists_url":"https://api.github.com/users/eugenio165/gists{/gist_id}","starred_url":"https://api.github.com/users/eugenio165/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eugenio165/subscriptions","organizations_url":"https://api.github.com/users/eugenio165/orgs","repos_url":"https://api.github.com/users/eugenio165/repos","events_url":"https://api.github.com/users/eugenio165/events{/privacy}","received_events_url":"https://api.github.com/users/eugenio165/received_events","type":"User","user_view_type":"public","site_admin":false},"created_at":"2021-10-17T23:43:38Z","updated_at":"2021-10-17T23:43:38Z","source":{"type":"issue","issue":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/8283","repository_url":"https://api.github.com/repos/typeorm/typeorm","labels_url":"https://api.github.com/repos/typeorm/typeorm/issues/8283/labels{/name}","comments_url":"https://api.github.com/repos/typeorm/typeorm/issues/8283/comments","events_url":"https://api.github.com/repos/typeorm/typeorm/issues/8283/events","html_url":"https://github.com/typeorm/typeorm/pull/8283","id":1028471383,"node_id":"PR_kwDOAyVBJc4tS7O5","number":8283,"title":"fix: create a different cacheId if present for count query in getManyAndCount","user":{"login":"eugenio165","id":33187923,"node_id":"MDQ6VXNlcjMzMTg3OTIz","avatar_url":"https://avatars.githubusercontent.com/u/33187923?v=4","gravatar_id":"","url":"https://api.github.com/users/eugenio165","html_url":"https://github.com/eugenio165","followers_url":"https://api.github.com/users/eugenio165/followers","following_url":"https://api.github.com/users/eugenio165/following{/other_user}","gists_url":"https://api.github.com/users/eugenio165/gists{/gist_id}","starred_url":"https://api.github.com/users/eugenio165/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eugenio165/subscriptions","organizations_url":"https://api.github.com/users/eugenio165/orgs","repos_url":"https://api.github.com/users/eugenio165/repos","events_url":"https://api.github.com/users/eugenio165/events{/privacy}","received_events_url":"https://api.github.com/users/eugenio165/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":5,"created_at":"2021-10-17T23:43:38Z","updated_at":"2021-11-09T16:41:01Z","closed_at":"2021-10-21T11:48:57Z","author_association":"CONTRIBUTOR","type":null,"active_lock_reason":null,"draft":false,"repository":{"id":52773157,"node_id":"MDEwOlJlcG9zaXRvcnk1Mjc3MzE1Nw==","name":"typeorm","full_name":"typeorm/typeorm","private":false,"owner":{"login":"typeorm","id":20165699,"node_id":"MDEyOk9yZ2FuaXphdGlvbjIwMTY1Njk5","avatar_url":"https://avatars.githubusercontent.com/u/20165699?v=4","gravatar_id":"","url":"https://api.github.com/users/typeorm","html_url":"https://github.com/typeorm","followers_url":"https://api.github.com/users/typeorm/followers","following_url":"https://api.github.com/users/typeorm/following{/other_user}","gists_url":"https://api.github.com/users/typeorm/gists{/gist_id}","starred_url":"https://api.github.com/users/typeorm/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/typeorm/subscriptions","organizations_url":"https://api.github.com/users/typeorm/orgs","repos_url":"https://api.github.com/users/typeorm/repos","events_url":"https://api.github.com/users/typeorm/events{/privacy}","received_events_url":"https://api.github.com/users/typeorm/received_events","type":"Organization","user_view_type":"public","site_admin":false},"html_url":"https://github.com/typeorm/typeorm","description":"ORM for TypeScript and JavaScript. Supports MySQL, PostgreSQL, MariaDB, SQLite, MS SQL Server, Oracle, SAP Hana, WebSQL databases. Works in NodeJS, Browser, Ionic, Cordova and Electron platforms.","fork":false,"url":"https://api.github.com/repos/typeorm/typeorm","forks_url":"https://api.github.com/repos/typeorm/typeorm/forks","keys_url":"https://api.github.com/repos/typeorm/typeorm/keys{/key_id}","collaborators_url":"https://api.github.com/repos/typeorm/typeorm/collaborators{/collaborator}","teams_url":"https://api.github.com/repos/typeorm/typeorm/teams","hooks_url":"https://api.github.com/repos/typeorm/typeorm/hooks","issue_events_url":"https://api.github.com/repos/typeorm/typeorm/issues/events{/number}","events_url":"https://api.github.com/repos/typeorm/typeorm/events","assignees_url":"https://api.github.com/repos/typeorm/typeorm/assignees{/user}","branches_url":"https://api.github.com/repos/typeorm/typeorm/branches{/branch}","tags_url":"https://api.github.com/repos/typeorm/typeorm/tags","blobs_url":"https://api.github.com/repos/typeorm/typeorm/git/blobs{/sha}","git_tags_url":"https://api.github.com/repos/typeorm/typeorm/git/tags{/sha}","git_refs_url":"https://api.github.com/repos/typeorm/typeorm/git/refs{/sha}","trees_url":"https://api.github.com/repos/typeorm/typeorm/git/trees{/sha}","statuses_url":"https://api.github.com/repos/typeorm/typeorm/statuses/{sha}","languages_url":"https://api.github.com/repos/typeorm/typeorm/languages","stargazers_url":"https://api.github.com/repos/typeorm/typeorm/stargazers","contributors_url":"https://api.github.com/repos/typeorm/typeorm/contributors","subscribers_url":"https://api.github.com/repos/typeorm/typeorm/subscribers","subscription_url":"https://api.github.com/repos/typeorm/typeorm/subscription","commits_url":"https://api.github.com/repos/typeorm/typeorm/commits{/sha}","git_commits_url":"https://api.github.com/repos/typeorm/typeorm/git/commits{/sha}","comments_url":"https://api.github.com/repos/typeorm/typeorm/comments{/number}","issue_comment_url":"https://api.github.com/repos/typeorm/typeorm/issues/comments{/number}","contents_url":"https://api.github.com/repos/typeorm/typeorm/contents/{+path}","compare_url":"https://api.github.com/repos/typeorm/typeorm/compare/{base}...{head}","merges_url":"https://api.github.com/repos/typeorm/typeorm/merges","archive_url":"https://api.github.com/repos/typeorm/typeorm/{archive_format}{/ref}","downloads_url":"https://api.github.com/repos/typeorm/typeorm/downloads","issues_url":"https://api.github.com/repos/typeorm/typeorm/issues{/number}","pulls_url":"https://api.github.com/repos/typeorm/typeorm/pulls{/number}","milestones_url":"https://api.github.com/repos/typeorm/typeorm/milestones{/number}","notifications_url":"https://api.github.com/repos/typeorm/typeorm/notifications{?since,all,participating}","labels_url":"https://api.github.com/repos/typeorm/typeorm/labels{/name}","releases_url":"https://api.github.com/repos/typeorm/typeorm/releases{/id}","deployments_url":"https://api.github.com/repos/typeorm/typeorm/deployments","created_at":"2016-02-29T07:41:14Z","updated_at":"2025-11-09T20:57:36Z","pushed_at":"2025-11-09T20:57:31Z","git_url":"git://github.com/typeorm/typeorm.git","ssh_url":"git@github.com:typeorm/typeorm.git","clone_url":"https://github.com/typeorm/typeorm.git","svn_url":"https://github.com/typeorm/typeorm","homepage":"http://typeorm.io","size":31490,"stargazers_count":36005,"watchers_count":36005,"language":"TypeScript","has_issues":true,"has_projects":true,"has_downloads":true,"has_wiki":true,"has_pages":false,"has_discussions":false,"forks_count":6454,"mirror_url":null,"archived":false,"disabled":false,"open_issues_count":523,"license":{"key":"mit","name":"MIT License","spdx_id":"MIT","url":"https://api.github.com/licenses/mit","node_id":"MDc6TGljZW5zZTEz"},"allow_forking":true,"is_template":false,"web_commit_signoff_required":false,"topics":["active-record","cockroachdb","data-mapper","database","electron","hacktoberfest","javascript","mariadb","mysql","oracle","orm","postgresql","react-native","sap","sap-hana","sqlite","sqlserver","typeorm","typescript","websql"],"visibility":"public","forks":6454,"open_issues":523,"watchers":36005,"default_branch":"master","permissions":{"admin":false,"maintain":false,"push":false,"triage":false,"pull":true}},"pull_request":{"url":"https://api.github.com/repos/typeorm/typeorm/pulls/8283","html_url":"https://github.com/typeorm/typeorm/pull/8283","diff_url":"https://github.com/typeorm/typeorm/pull/8283.diff","patch_url":"https://github.com/typeorm/typeorm/pull/8283.patch","merged_at":"2021-10-21T11:48:56Z"},"body":"<!--\r\n  ðŸ˜€ Wonderful!  Thank you for opening a pull request for TypeORM.\r\n\r\n  Please fill in the information below to expedite the review\r\n  and (hopefully) merge of your change.\r\n\r\n  If unsure about something.. just do as best as you're able,\r\n  or reach out through our community support channels!\r\n  https://github.com/typeorm/typeorm/blob/master/docs/support.md\r\n-->\r\n\r\n### Description of change\r\n\r\nCreates a different cacheId (if provided) for the count query in `getManyAndCount` so that it does not retreive the cache for the previous query (the select immediately above it). Previously, when providing a `cacheId` and using `getManyAndCount` or `findAndCount`, the count query would use the exact same `cacheId` as the select query above it, causing the `count` value to return as 0 (because it doesnt even exist in the select query result). Providing a different `cacheId` for the count query solves the problem. Only happens when explicitly defining a `cacheId`.\r\n\r\nFixes #4277 \r\n<!--\r\n  Please be clear and concise what the change is intended to do,\r\n  why this change is needed, and how you've verified that it\r\n  corrects what you intended.\r\n\r\n  In some cases it may be helpful to include the current behavior\r\n  and the new behavior.\r\n\r\n  If the change is related to an open issue, you can link it here.\r\n  If you include `Fixes #0000` (replacing `0000` with the issue number)\r\n  when this is merged it will automatically mark the issue as fixed and\r\n  close it.\r\n-->\r\n\r\n\r\n### Pull-Request Checklist\r\n\r\n<!--\r\n  Please make sure to review and check all of the following.\r\n\r\n  If an item is not applicable, you can add \"N/A\" to the end.\r\n-->\r\n\r\n- [x] Code is up-to-date with the `master` branch\r\n- [x] `npm run lint` passes with this change\r\n- [x] `npm run test` passes with this change\r\n- [x] This pull request links relevant issues as `Fixes #0000`\r\n- [x] There are new or updated unit tests validating the change\r\n- [ ] Documentation has been updated to reflect this change **N/A**\r\n- [x] The new commits follow conventions explained in [CONTRIBUTING.md](https://github.com/typeorm/typeorm/blob/master/CONTRIBUTING.md)\r\n\r\n<!--\r\n  ðŸŽ‰ Thank you for contributing and making TypeORM even better!\r\n-->\r\n","reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/8283/reactions","total_count":1,"+1":1,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/typeorm/typeorm/issues/8283/timeline","performed_via_github_app":null,"state_reason":null}},"event":"cross-referenced"},{"id":5497956606,"node_id":"CE_lADOAyVBJc4bIEivzwAAAAFHtCj-","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/5497956606","actor":{"login":"pleerock","id":1753397,"node_id":"MDQ6VXNlcjE3NTMzOTc=","avatar_url":"https://avatars.githubusercontent.com/u/1753397?v=4","gravatar_id":"","url":"https://api.github.com/users/pleerock","html_url":"https://github.com/pleerock","followers_url":"https://api.github.com/users/pleerock/followers","following_url":"https://api.github.com/users/pleerock/following{/other_user}","gists_url":"https://api.github.com/users/pleerock/gists{/gist_id}","starred_url":"https://api.github.com/users/pleerock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pleerock/subscriptions","organizations_url":"https://api.github.com/users/pleerock/orgs","repos_url":"https://api.github.com/users/pleerock/repos","events_url":"https://api.github.com/users/pleerock/events{/privacy}","received_events_url":"https://api.github.com/users/pleerock/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"closed","commit_id":null,"commit_url":null,"created_at":"2021-10-21T11:48:57Z","state_reason":null,"performed_via_github_app":null},{"id":5497957259,"node_id":"REFE_lADOAyVBJc4bIEivzwAAAAFHtCuL","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/5497957259","actor":{"login":"pleerock","id":1753397,"node_id":"MDQ6VXNlcjE3NTMzOTc=","avatar_url":"https://avatars.githubusercontent.com/u/1753397?v=4","gravatar_id":"","url":"https://api.github.com/users/pleerock","html_url":"https://github.com/pleerock","followers_url":"https://api.github.com/users/pleerock/followers","following_url":"https://api.github.com/users/pleerock/following{/other_user}","gists_url":"https://api.github.com/users/pleerock/gists{/gist_id}","starred_url":"https://api.github.com/users/pleerock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pleerock/subscriptions","organizations_url":"https://api.github.com/users/pleerock/orgs","repos_url":"https://api.github.com/users/pleerock/repos","events_url":"https://api.github.com/users/pleerock/events{/privacy}","received_events_url":"https://api.github.com/users/pleerock/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"referenced","commit_id":"9f14e488281fb08d8ea1a95c6cc363e1234fa307","commit_url":"https://api.github.com/repos/typeorm/typeorm/commits/9f14e488281fb08d8ea1a95c6cc363e1234fa307","created_at":"2021-10-21T11:49:04Z","performed_via_github_app":null},{"id":5497958976,"node_id":"MEE_lADOAyVBJc4bIEivzwAAAAFHtDJA","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/5497958976","actor":{"login":"eugenio165","id":33187923,"node_id":"MDQ6VXNlcjMzMTg3OTIz","avatar_url":"https://avatars.githubusercontent.com/u/33187923?v=4","gravatar_id":"","url":"https://api.github.com/users/eugenio165","html_url":"https://github.com/eugenio165","followers_url":"https://api.github.com/users/eugenio165/followers","following_url":"https://api.github.com/users/eugenio165/following{/other_user}","gists_url":"https://api.github.com/users/eugenio165/gists{/gist_id}","starred_url":"https://api.github.com/users/eugenio165/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eugenio165/subscriptions","organizations_url":"https://api.github.com/users/eugenio165/orgs","repos_url":"https://api.github.com/users/eugenio165/repos","events_url":"https://api.github.com/users/eugenio165/events{/privacy}","received_events_url":"https://api.github.com/users/eugenio165/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-21T11:49:24Z","performed_via_github_app":null},{"id":5497958981,"node_id":"SE_lADOAyVBJc4bIEivzwAAAAFHtDJF","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/5497958981","actor":{"login":"eugenio165","id":33187923,"node_id":"MDQ6VXNlcjMzMTg3OTIz","avatar_url":"https://avatars.githubusercontent.com/u/33187923?v=4","gravatar_id":"","url":"https://api.github.com/users/eugenio165","html_url":"https://github.com/eugenio165","followers_url":"https://api.github.com/users/eugenio165/followers","following_url":"https://api.github.com/users/eugenio165/following{/other_user}","gists_url":"https://api.github.com/users/eugenio165/gists{/gist_id}","starred_url":"https://api.github.com/users/eugenio165/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/eugenio165/subscriptions","organizations_url":"https://api.github.com/users/eugenio165/orgs","repos_url":"https://api.github.com/users/eugenio165/repos","events_url":"https://api.github.com/users/eugenio165/events{/privacy}","received_events_url":"https://api.github.com/users/eugenio165/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-21T11:49:24Z","performed_via_github_app":null},{"id":5497958988,"node_id":"MEE_lADOAyVBJc4bIEivzwAAAAFHtDJM","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/5497958988","actor":{"login":"aamirpinger","id":43044635,"node_id":"MDQ6VXNlcjQzMDQ0NjM1","avatar_url":"https://avatars.githubusercontent.com/u/43044635?v=4","gravatar_id":"","url":"https://api.github.com/users/aamirpinger","html_url":"https://github.com/aamirpinger","followers_url":"https://api.github.com/users/aamirpinger/followers","following_url":"https://api.github.com/users/aamirpinger/following{/other_user}","gists_url":"https://api.github.com/users/aamirpinger/gists{/gist_id}","starred_url":"https://api.github.com/users/aamirpinger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aamirpinger/subscriptions","organizations_url":"https://api.github.com/users/aamirpinger/orgs","repos_url":"https://api.github.com/users/aamirpinger/repos","events_url":"https://api.github.com/users/aamirpinger/events{/privacy}","received_events_url":"https://api.github.com/users/aamirpinger/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"mentioned","commit_id":null,"commit_url":null,"created_at":"2021-10-21T11:49:24Z","performed_via_github_app":null},{"id":5497958997,"node_id":"SE_lADOAyVBJc4bIEivzwAAAAFHtDJV","url":"https://api.github.com/repos/typeorm/typeorm/issues/events/5497958997","actor":{"login":"aamirpinger","id":43044635,"node_id":"MDQ6VXNlcjQzMDQ0NjM1","avatar_url":"https://avatars.githubusercontent.com/u/43044635?v=4","gravatar_id":"","url":"https://api.github.com/users/aamirpinger","html_url":"https://github.com/aamirpinger","followers_url":"https://api.github.com/users/aamirpinger/followers","following_url":"https://api.github.com/users/aamirpinger/following{/other_user}","gists_url":"https://api.github.com/users/aamirpinger/gists{/gist_id}","starred_url":"https://api.github.com/users/aamirpinger/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/aamirpinger/subscriptions","organizations_url":"https://api.github.com/users/aamirpinger/orgs","repos_url":"https://api.github.com/users/aamirpinger/repos","events_url":"https://api.github.com/users/aamirpinger/events{/privacy}","received_events_url":"https://api.github.com/users/aamirpinger/received_events","type":"User","user_view_type":"public","site_admin":false},"event":"subscribed","commit_id":null,"commit_url":null,"created_at":"2021-10-21T11:49:24Z","performed_via_github_app":null}]