{"url":"https://api.github.com/repos/typeorm/typeorm/issues/4878","repository_url":"https://api.github.com/repos/typeorm/typeorm","labels_url":"https://api.github.com/repos/typeorm/typeorm/issues/4878/labels{/name}","comments_url":"https://api.github.com/repos/typeorm/typeorm/issues/4878/comments","events_url":"https://api.github.com/repos/typeorm/typeorm/issues/4878/events","html_url":"https://github.com/typeorm/typeorm/issues/4878","id":504429843,"node_id":"MDU6SXNzdWU1MDQ0Mjk4NDM=","number":4878,"title":"URL Connection string not overridden by supplied options","user":{"login":"ryanmr","id":13507,"node_id":"MDQ6VXNlcjEzNTA3","avatar_url":"https://avatars.githubusercontent.com/u/13507?v=4","gravatar_id":"","url":"https://api.github.com/users/ryanmr","html_url":"https://github.com/ryanmr","followers_url":"https://api.github.com/users/ryanmr/followers","following_url":"https://api.github.com/users/ryanmr/following{/other_user}","gists_url":"https://api.github.com/users/ryanmr/gists{/gist_id}","starred_url":"https://api.github.com/users/ryanmr/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ryanmr/subscriptions","organizations_url":"https://api.github.com/users/ryanmr/orgs","repos_url":"https://api.github.com/users/ryanmr/repos","events_url":"https://api.github.com/users/ryanmr/events{/privacy}","received_events_url":"https://api.github.com/users/ryanmr/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[],"state":"closed","locked":false,"assignee":null,"assignees":[],"milestone":null,"comments":1,"created_at":"2019-10-09T05:48:28Z","updated_at":"2020-07-06T22:56:17Z","closed_at":"2020-07-06T22:56:17Z","author_association":"NONE","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"**Issue type:**\r\n\r\n[ ] question\r\n[x] bug report\r\n[ ] feature request\r\n[ ] documentation issue\r\n\r\n**Database system/driver:**\r\n\r\n[ ] `cordova`\r\n[ ] `mongodb`\r\n[ ] `mssql`\r\n[x] `mysql` / `mariadb`\r\n[ ] `oracle`\r\n[ ] `postgres`\r\n[ ] `cockroachdb`\r\n[ ] `sqlite`\r\n[ ] `sqljs`\r\n[ ] `react-native`\r\n[ ] `expo`\r\n\r\n**TypeORM version:**\r\n\r\n[x] `latest`\r\n[ ] `@next`\r\n[ ] `0.x.x` (or put your version here)\r\n\r\n**Steps to reproduce or a small repository showing the problem:**\r\n\r\nFrom the docs:\r\n\r\n> url - Connection url where perform connection to. Please note that other connection options will override parameters set from url.\r\n\r\nIn my particular situation, I pass `url` for host, port, database, etc in the TypeORM options but supply username and password directly.\r\n\r\n```ts\r\n    TypeOrmModule.forRoot({\r\n      type: 'mysql',\r\n      url: DB_CONNECTION, // CONNECTION STRING\r\n      // for example: mysql://localhost:3306/dev\r\n      username: DB_USERNAME, // abc\r\n      password: DB_PASSWORD, // abc\r\n      database: 'dev',\r\n      entities: ['src/**/**.entity{.ts,.js}'],\r\n    }),\r\n```\r\n\r\nThe _username_ and _password_ are not set in the given connection string, and based on the documentation, the two values should have priority from the options vs the unspecified values in the connection string url.\r\n\r\nIt seems like [this could be reversed](https://github.com/typeorm/typeorm/blob/358e8a1a4872a950b471835cb48ff2bbc74cf6ce/src/driver/DriverUtils.ts#L31) and this would work as documented.\r\n\r\n```ts\r\nreturn Object.assign({}, options, urlDriverOptions);\r\n```\r\n\r\n```\r\n// before\r\n{\r\n  type: 'mysql',\r\n  url: 'mysql://localhost:3306/dev',\r\n  username: '',\r\n  password: '',\r\n  database: 'dev',\r\n  entities: [ 'src/**/**.entity{.ts,.js}' ],\r\n  host: 'localhost',\r\n  port: 3306\r\n}\r\n\r\n// after\r\n{\r\n  type: 'mysql',\r\n  url: 'mysql://localhost:3306/dev',\r\n  username: 'abc',\r\n  password: 'abc',\r\n  database: 'dev',\r\n  entities: [ 'src/**/**.entity{.ts,.js}' ],\r\n  host: 'localhost',\r\n  port: 3306\r\n}\r\n```\r\n\r\nAnother solution I think, may be to [enhance the current parsing](https://github.com/typeorm/typeorm/blob/488d21090aadb52c88dc9b5f66302f68aea97d95/src/driver/DriverUtils.ts#L90) and switching the order of the order object assign.\r\n\r\nThanks for the consideration.\r\n\r\n","closed_by":{"login":"pleerock","id":1753397,"node_id":"MDQ6VXNlcjE3NTMzOTc=","avatar_url":"https://avatars.githubusercontent.com/u/1753397?v=4","gravatar_id":"","url":"https://api.github.com/users/pleerock","html_url":"https://github.com/pleerock","followers_url":"https://api.github.com/users/pleerock/followers","following_url":"https://api.github.com/users/pleerock/following{/other_user}","gists_url":"https://api.github.com/users/pleerock/gists{/gist_id}","starred_url":"https://api.github.com/users/pleerock/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/pleerock/subscriptions","organizations_url":"https://api.github.com/users/pleerock/orgs","repos_url":"https://api.github.com/users/pleerock/repos","events_url":"https://api.github.com/users/pleerock/events{/privacy}","received_events_url":"https://api.github.com/users/pleerock/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/typeorm/typeorm/issues/4878/reactions","total_count":3,"+1":3,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/typeorm/typeorm/issues/4878/timeline","performed_via_github_app":null,"state_reason":"completed"}