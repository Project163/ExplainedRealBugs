{"url":"https://api.github.com/repos/gofiber/fiber/issues/3149","repository_url":"https://api.github.com/repos/gofiber/fiber","labels_url":"https://api.github.com/repos/gofiber/fiber/issues/3149/labels{/name}","comments_url":"https://api.github.com/repos/gofiber/fiber/issues/3149/comments","events_url":"https://api.github.com/repos/gofiber/fiber/issues/3149/events","html_url":"https://github.com/gofiber/fiber/issues/3149","id":2548932817,"node_id":"I_kwDODfYWS86X7aDR","number":3149,"title":"üìù [Proposal]: Add TestConfig to app.Test() for configurable testing","user":{"login":"grivera64","id":68245631,"node_id":"MDQ6VXNlcjY4MjQ1NjMx","avatar_url":"https://avatars.githubusercontent.com/u/68245631?v=4","gravatar_id":"","url":"https://api.github.com/users/grivera64","html_url":"https://github.com/grivera64","followers_url":"https://api.github.com/users/grivera64/followers","following_url":"https://api.github.com/users/grivera64/following{/other_user}","gists_url":"https://api.github.com/users/grivera64/gists{/gist_id}","starred_url":"https://api.github.com/users/grivera64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grivera64/subscriptions","organizations_url":"https://api.github.com/users/grivera64/orgs","repos_url":"https://api.github.com/users/grivera64/repos","events_url":"https://api.github.com/users/grivera64/events{/privacy}","received_events_url":"https://api.github.com/users/grivera64/received_events","type":"User","user_view_type":"public","site_admin":false},"labels":[{"id":2842354375,"node_id":"MDU6TGFiZWwyODQyMzU0Mzc1","url":"https://api.github.com/repos/gofiber/fiber/labels/%E2%9C%8F%EF%B8%8F%20Feature","name":"‚úèÔ∏è Feature","color":"0E8A16","default":false,"description":""},{"id":3947514349,"node_id":"LA_kwDODfYWS87rSknt","url":"https://api.github.com/repos/gofiber/fiber/labels/v3","name":"v3","color":"436eee","default":false,"description":""},{"id":6105563014,"node_id":"LA_kwDODfYWS88AAAABa-t_hg","url":"https://api.github.com/repos/gofiber/fiber/labels/%F0%9F%93%9D%20Proposal","name":"üìù Proposal","color":"880D94","default":false,"description":""}],"state":"closed","locked":false,"assignee":{"login":"grivera64","id":68245631,"node_id":"MDQ6VXNlcjY4MjQ1NjMx","avatar_url":"https://avatars.githubusercontent.com/u/68245631?v=4","gravatar_id":"","url":"https://api.github.com/users/grivera64","html_url":"https://github.com/grivera64","followers_url":"https://api.github.com/users/grivera64/followers","following_url":"https://api.github.com/users/grivera64/following{/other_user}","gists_url":"https://api.github.com/users/grivera64/gists{/gist_id}","starred_url":"https://api.github.com/users/grivera64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grivera64/subscriptions","organizations_url":"https://api.github.com/users/grivera64/orgs","repos_url":"https://api.github.com/users/grivera64/repos","events_url":"https://api.github.com/users/grivera64/events{/privacy}","received_events_url":"https://api.github.com/users/grivera64/received_events","type":"User","user_view_type":"public","site_admin":false},"assignees":[{"login":"grivera64","id":68245631,"node_id":"MDQ6VXNlcjY4MjQ1NjMx","avatar_url":"https://avatars.githubusercontent.com/u/68245631?v=4","gravatar_id":"","url":"https://api.github.com/users/grivera64","html_url":"https://github.com/grivera64","followers_url":"https://api.github.com/users/grivera64/followers","following_url":"https://api.github.com/users/grivera64/following{/other_user}","gists_url":"https://api.github.com/users/grivera64/gists{/gist_id}","starred_url":"https://api.github.com/users/grivera64/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/grivera64/subscriptions","organizations_url":"https://api.github.com/users/grivera64/orgs","repos_url":"https://api.github.com/users/grivera64/repos","events_url":"https://api.github.com/users/grivera64/events{/privacy}","received_events_url":"https://api.github.com/users/grivera64/received_events","type":"User","user_view_type":"public","site_admin":false}],"milestone":{"url":"https://api.github.com/repos/gofiber/fiber/milestones/1","html_url":"https://github.com/gofiber/fiber/milestone/1","labels_url":"https://api.github.com/repos/gofiber/fiber/milestones/1/labels","id":6659753,"node_id":"MDk6TWlsZXN0b25lNjY1OTc1Mw==","number":1,"title":"v3","description":"features and adjustments for version 3","creator":{"login":"ReneWerner87","id":7063188,"node_id":"MDQ6VXNlcjcwNjMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7063188?v=4","gravatar_id":"","url":"https://api.github.com/users/ReneWerner87","html_url":"https://github.com/ReneWerner87","followers_url":"https://api.github.com/users/ReneWerner87/followers","following_url":"https://api.github.com/users/ReneWerner87/following{/other_user}","gists_url":"https://api.github.com/users/ReneWerner87/gists{/gist_id}","starred_url":"https://api.github.com/users/ReneWerner87/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ReneWerner87/subscriptions","organizations_url":"https://api.github.com/users/ReneWerner87/orgs","repos_url":"https://api.github.com/users/ReneWerner87/repos","events_url":"https://api.github.com/users/ReneWerner87/events{/privacy}","received_events_url":"https://api.github.com/users/ReneWerner87/received_events","type":"User","user_view_type":"public","site_admin":false},"open_issues":23,"closed_issues":545,"state":"open","created_at":"2021-04-14T09:34:42Z","updated_at":"2025-11-09T22:33:11Z","due_on":null,"closed_at":null},"comments":21,"created_at":"2024-09-25T20:24:54Z","updated_at":"2024-11-22T07:43:40Z","closed_at":"2024-11-22T07:43:39Z","author_association":"MEMBER","type":null,"active_lock_reason":null,"sub_issues_summary":{"total":0,"completed":0,"percent_completed":0},"issue_dependencies_summary":{"blocked_by":0,"total_blocked_by":0,"blocking":0,"total_blocking":0},"body":"### Feature Proposal Description\r\n\r\n~This issue proposes to add a `TestWithInterrupt` method to the App struct for internal testing.~\r\nThis issue proposed to add a `TestConfig` struct as an optional parameter to app.Test() for internal testing.\r\n\r\nCurrently, [`app.Test()`](https://github.com/gofiber/fiber/blob/main/app.go#L869) allows us to test whether an endpoint completely returns before the given timeout. If it doesn't, any provided reponse is discarded and an error only returns.\r\n\r\n~`TestWithInterrupt` aims to provide a way to not discard the response. In most currently available cases, there would be an EOF error (which would be returned by `TestWithInterrupt` as an expected behavior).~\r\nThe `TestConfig` struct aims to provide a way to tell `app.Test()` to not discard the response (via the new field \"ErrOnTimeout\"). It would look like the following:\r\n\r\n```go\r\ntype TestConfig struct {\r\n    Timeout      time.Duration\r\n    ErrOnTimeout bool\r\n}\r\n```\r\n\r\nIn most currently available cases, there would be an EOF error (which would be returned as an expected behavior).\r\n\r\nThis method though is useful for buffered streaming that is allowed via fasthttp. This feature is coming to Fiber through the following issue and pull request:\r\n\r\nIssue:\r\n#3127 \r\n\r\nPR:\r\n#3131 \r\n\r\n### Alignment with Express API\r\n\r\nN/A as it is a test feature, that is similar to [app.Test](https://github.com/gofiber/fiber/blob/main/app.go#L869).\r\n\r\n### HTTP RFC Standards Compliance\r\n\r\nN/A as it is a test feature, that is similar to [app.Test](https://github.com/gofiber/fiber/blob/main/app.go#L869).\r\n\r\n### API Stability\r\n\r\nThis would be a new method, keeping the current [app.Test](https://github.com/gofiber/fiber/blob/main/app.go#L869) the same. This will help avoid changes to current tests.\r\n\r\n### Feature Examples\r\n\r\n```go\r\napp := New()\r\napp.Get(\"/\", func(c Ctx) error {\r\n\ttime.Sleep(1 * time.Second)\r\n\treturn c.SendString(\"Should never be called\")\r\n})\r\n\r\nrespBody, err := app.Test(httptest.NewRequest(MethodGet, \"/\", nil), &TestConfig{\r\n    Timeout: 100*time.Millisecond,\r\n    ErrOnTimeout: false,  // If false, do not discard response\r\n})\r\n```\r\n\r\n\r\n### Checklist:\r\n\r\n- [X] I agree to follow Fiber's [Code of Conduct](https://github.com/gofiber/fiber/blob/master/.github/CODE_OF_CONDUCT.md).\r\n- [X] I have searched for existing issues that describe my proposal before opening this one.\r\n- [X] I understand that a proposal that does not meet these guidelines may be closed without explanation.","closed_by":{"login":"ReneWerner87","id":7063188,"node_id":"MDQ6VXNlcjcwNjMxODg=","avatar_url":"https://avatars.githubusercontent.com/u/7063188?v=4","gravatar_id":"","url":"https://api.github.com/users/ReneWerner87","html_url":"https://github.com/ReneWerner87","followers_url":"https://api.github.com/users/ReneWerner87/followers","following_url":"https://api.github.com/users/ReneWerner87/following{/other_user}","gists_url":"https://api.github.com/users/ReneWerner87/gists{/gist_id}","starred_url":"https://api.github.com/users/ReneWerner87/starred{/owner}{/repo}","subscriptions_url":"https://api.github.com/users/ReneWerner87/subscriptions","organizations_url":"https://api.github.com/users/ReneWerner87/orgs","repos_url":"https://api.github.com/users/ReneWerner87/repos","events_url":"https://api.github.com/users/ReneWerner87/events{/privacy}","received_events_url":"https://api.github.com/users/ReneWerner87/received_events","type":"User","user_view_type":"public","site_admin":false},"reactions":{"url":"https://api.github.com/repos/gofiber/fiber/issues/3149/reactions","total_count":0,"+1":0,"-1":0,"laugh":0,"hooray":0,"confused":0,"heart":0,"rocket":0,"eyes":0},"timeline_url":"https://api.github.com/repos/gofiber/fiber/issues/3149/timeline","performed_via_github_app":null,"state_reason":"completed"}