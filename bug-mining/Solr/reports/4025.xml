<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:34:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-12733] SolrMetricReporterTest failure</title>
                <link>https://issues.apache.org/jira/browse/SOLR-12733</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Since the change to async logger, this test fails 100% of the time for me locally. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; confirmed that it fails for him too so it&apos;s not something weird in my environment.&lt;/p&gt;

&lt;p&gt;Why there are no reports from Jenkins of this failure is a mystery.&lt;/p&gt;

&lt;p&gt;The &lt;em&gt;test&lt;/em&gt; succeeds, but there is a thread leak and the stack trace points to &quot;lmax.disruptor&quot; which is certainly a part of the async logging.&lt;/p&gt;

&lt;p&gt;And why, if this is something generic, it doesn&apos;t fail many many tests is another mystery so I suspect it&apos;s something specific to the test, perhaps having to do with mocking the metric reporter, but that&apos;s a wild shot in the dark.&lt;/p&gt;

&lt;p&gt;My working hypothesis is that &quot;something isn&apos;t being closed/shutdown correctly&quot;, but that&apos;s...a little vague.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Sep 04, 2018 9:38:00 AM com.carrotsearch.randomizedtesting.ThreadLeakControl checkThreadLeaks
WARNING: Will linger awaiting termination of 1 leaked thread(s).
Sep 04, 2018 9:38:20 AM com.carrotsearch.randomizedtesting.ThreadLeakControl checkThreadLeaks
SEVERE: 1 thread leaked from SUITE scope at org.apache.solr.metrics.SolrMetricReporterTest: 
   1) &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;[id=14, name=Log4j2-TF-1-AsyncLoggerConfig--1, state=TIMED_WAITING, group=TGRP-SolrMetricReporterTest]
        at sun.misc.Unsafe.park(Native Method)
        at java.util.concurrent.locks.LockSupport.parkNanos(LockSupport.java:215)
        at java.util.concurrent.locks.AbstractQueuedSynchronizer$ConditionObject.awaitNanos(AbstractQueuedSynchronizer.java:2078)
        at com.lmax.disruptor.TimeoutBlockingWaitStrategy.waitFor(TimeoutBlockingWaitStrategy.java:38)
        at com.lmax.disruptor.ProcessingSequenceBarrier.waitFor(ProcessingSequenceBarrier.java:56)
        at com.lmax.disruptor.BatchEventProcessor.run(BatchEventProcessor.java:128)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13182858">SOLR-12733</key>
            <summary>SolrMetricReporterTest failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="erickerickson">Erick Erickson</assignee>
                                    <reporter username="erickerickson">Erick Erickson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Sep 2018 16:43:42 +0000</created>
                <updated>Sat, 8 Jun 2019 15:02:54 +0000</updated>
                            <resolved>Thu, 6 Sep 2018 01:51:02 +0000</resolved>
                                                    <fixVersion>7.5</fixVersion>
                    <fixVersion>8.0</fixVersion>
                                    <component>logging</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16604467" author="dsmiley" created="Wed, 5 Sep 2018 14:23:27 +0000"  >&lt;p&gt;BTW your description doesn&apos;t indicate &lt;b&gt;which&lt;/b&gt; test fails; you say &quot;this&quot; test. &#160;Any way I figured it out from your stack trace.&lt;/p&gt;

&lt;p&gt;DateMathParserTest fails for me reliably as well.&lt;/p&gt;

&lt;p&gt;Both of these tests extend LuceneTestCase directly. &#160;If I change them to subclass SolrTestCaseJ4 then this problem doesn&apos;t surface! &#160;So that&apos;s the clue. &#160;There must be some log related ceremony&#160;occurring only in SolrTestCaseJ4. &#160;Perhaps all Solr tests now need to subclass SolrTestCaseJ4 or a derivative?&lt;/p&gt;</comment>
                            <comment id="16604538" author="erickerickson" created="Wed, 5 Sep 2018 15:19:39 +0000"  >&lt;p&gt;Oops, forgot the &quot;Test&quot; at the end. Well, &lt;em&gt;&lt;b&gt;I&lt;/b&gt;&lt;/em&gt; knew what I meant &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Thanks for digging into this, I got wrapped up yesterday and didn&apos;t get back to it. I&apos;d wondered about the superclass but hadn&apos;t gotten to test it yet.&lt;/p&gt;

&lt;p&gt;Anyway, I&apos;ll fix up both tests and, I hope, check them in today.&lt;/p&gt;

&lt;p&gt;Thanks again!&lt;br/&gt;
 Erick&lt;/p&gt;</comment>
                            <comment id="16605132" author="jira-bot" created="Thu, 6 Sep 2018 01:11:08 +0000"  >&lt;p&gt;Commit 37375ae6008a069ce1362e287dfd55bed0a27f7f in lucene-solr&apos;s branch refs/heads/master from Erick&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=37375ae&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=37375ae&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12733&quot; title=&quot;SolrMetricReporterTest failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12733&quot;&gt;&lt;del&gt;SOLR-12733&lt;/del&gt;&lt;/a&gt;: SolrMetricReporterTest failure&lt;/p&gt;</comment>
                            <comment id="16605133" author="jira-bot" created="Thu, 6 Sep 2018 01:16:41 +0000"  >&lt;p&gt;Commit 8fd0c58e8edc61dac5d472685eab1fbbfdc9951f in lucene-solr&apos;s branch refs/heads/branch_7x from Erick&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8fd0c58&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8fd0c58&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12733&quot; title=&quot;SolrMetricReporterTest failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12733&quot;&gt;&lt;del&gt;SOLR-12733&lt;/del&gt;&lt;/a&gt;: SolrMetricReporterTest failure&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 37375ae)&lt;/p&gt;</comment>
                            <comment id="16605154" author="erickerickson" created="Thu, 6 Sep 2018 01:51:02 +0000"  >&lt;p&gt;Fixed DateMathParserTest too.&lt;/p&gt;

&lt;p&gt;no other tests failed, but we need to keep an eye out for them.&lt;/p&gt;

&lt;p&gt;Thanks David!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12938562" name="SOLR-12733.patch" size="2166" author="erickerickson" created="Thu, 6 Sep 2018 01:10:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 10 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3xpqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>