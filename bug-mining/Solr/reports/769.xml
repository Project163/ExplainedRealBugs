<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:25:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2970] CSV ResponseWriter returns fields defined as stored=false in schema</title>
                <link>https://issues.apache.org/jira/browse/SOLR-2970</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;1. Add &amp;amp;wt=csv to a query&lt;br/&gt;
2. You get columns for non-stored fields&lt;/p&gt;</description>
                <environment></environment>
        <key id="12535165">SOLR-2970</key>
            <summary>CSV ResponseWriter returns fields defined as stored=false in schema</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="janhoy">Jan H&#248;ydahl</assignee>
                                    <reporter username="janhoy">Jan H&#248;ydahl</reporter>
                        <labels>
                    </labels>
                <created>Wed, 14 Dec 2011 14:30:43 +0000</created>
                <updated>Fri, 10 May 2013 10:39:01 +0000</updated>
                            <resolved>Wed, 18 Jan 2012 14:57:17 +0000</resolved>
                                                    <fixVersion>3.6</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                    <component>Response Writers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13170277" author="janhoy" created="Thu, 15 Dec 2011 15:22:41 +0000"  >&lt;p&gt;This simple patch (for trunk) fixes it&lt;/p&gt;</comment>
                            <comment id="13170302" author="yseeley@gmail.com" created="Thu, 15 Dec 2011 15:52:46 +0000"  >&lt;p&gt;The other side of the coin is that if a client asks for x,y,z they may be expecting those columns in that order.&lt;/p&gt;

&lt;p&gt;IMO, the problem is more about CSV not having a native representation for null/missing (i.e. if you ask for a sparse field, you will get zero length strings for the missing values too).&lt;/p&gt;</comment>
                            <comment id="13170307" author="janhoy" created="Thu, 15 Dec 2011 16:01:02 +0000"  >&lt;p&gt;The same solution seems to be valid for 3.x.&lt;br/&gt;
I don&apos;t see any side effects of always skipping fields which are not stored?&lt;/p&gt;</comment>
                            <comment id="13170315" author="janhoy" created="Thu, 15 Dec 2011 16:10:53 +0000"  >&lt;p&gt;Take the example:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Query: http://localhost:8983/solr/ac/select/?q=*%3A*&amp;amp;wt=csv
id,subtext,textphon,textng,score,action,value,textnge,type,textsuggest,popularity
a1,&quot;Born 1898, author of Narnia&quot;,,,1023.9588,search,author_facet,,author,C.S. Lewis,256
a2,Swedish fake author,,,799.97003,search,author_facet,,author,Carl Larsson,200
a3,Norwegian famous author,,,359.992,search,author_facet,,author,Petter Dass,90
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Fields textphon, textng and textnge are not stored. After the patch, we get:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Query: http://localhost:8983/solr/ac/select/?q=*%3A*&amp;amp;wt=csv
id,subtext,score,action,value,type,textsuggest,popularity
a1,&quot;Born 1898, author of Narnia&quot;,1023.9588,search,author_facet,author,C.S. Lewis,256
a2,Swedish fake author,799.97003,search,author_facet,author,Carl Larsson,200
a3,Norwegian famous author,359.992,search,author_facet,author,Petter Dass,90
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You can still ask for specific fields in any order:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Query: http://localhost:8983/solr/ac/select?q=*:*&amp;amp;wt=csv&amp;amp;fl=type,subtext,id
type,subtext,id
author,&quot;Born 1898, author of Narnia&quot;,a1
author,Swedish fake author,a2
author,Norwegian famous author,a3
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is it ever correct to return non-stored fields?&lt;/p&gt;</comment>
                            <comment id="13170357" author="chrismattmann" created="Thu, 15 Dec 2011 17:28:14 +0000"  >&lt;p&gt;I ran into this when I was putting together the original patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1925&quot; title=&quot;CSV Response Writer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1925&quot;&gt;&lt;del&gt;SOLR-1925&lt;/del&gt;&lt;/a&gt;, and believe that indeed the order of a field requested is important. And yes, as Yonik put it, CSV doesn&apos;t seem to have a native representation for null.&lt;/p&gt;

&lt;p&gt;What about a configuration parameter (perhaps attached to the request) to identify a &quot;placeholder&quot; for missing or non-stored values? We see this a lot in science data, when the data quality flag specifies that we should put in a fill value.&lt;/p&gt;</comment>
                            <comment id="13170377" author="yseeley@gmail.com" created="Thu, 15 Dec 2011 18:04:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;Query: &lt;a href=&quot;http://localhost:8983/solr/ac/select/?q=*%3A*&amp;amp;wt=csv&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/ac/select/?q=*%3A*&amp;amp;wt=csv&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ah, thanks for the example Jan.  I didn&apos;t realize those non-stored fields were returned by default!&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is it ever correct to return non-stored fields?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If the user explicitly asks for the non-stored field, it can be OK to still return it.  It&apos;s less a matter of correctness and more a matter of what&apos;s most useful.&lt;/p&gt;
</comment>
                            <comment id="13170440" author="janhoy" created="Thu, 15 Dec 2011 19:38:43 +0000"  >&lt;p&gt;So there are two distinct issues here&lt;br/&gt;
A) CSV attempts to return fields which are not stored - which is bound to always return blank value&lt;br/&gt;
B) When returning a stored field which has no value (null) for a document, there is no way to distinguish that from the empty string case&lt;/p&gt;

&lt;p&gt;I think B) should have its own JIRA.&lt;/p&gt;

&lt;p&gt;For A), I still cannot see any usecase where you want to ask for a non-stored field in the CSV output, even if you ask for it explicitly - since it will always be null/empty. If you ask the XML or JSON writer for a non-stored field, you never get it no matter what - it formally does not exist in this context.&lt;/p&gt;</comment>
                            <comment id="13170876" author="janhoy" created="Fri, 16 Dec 2011 10:01:24 +0000"  >&lt;p&gt;Created &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2974&quot; title=&quot;CSVResponseWriter: configurable NULL placeholder value&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2974&quot;&gt;SOLR-2974&lt;/a&gt; for B)&lt;/p&gt;

&lt;p&gt;I see that today you can explicitly specify non-existing fields in field-list and they will all end up in the response, e.g. &amp;amp;wt=csv&amp;amp;fl=id,type,foo,nonexisting&lt;/p&gt;

&lt;p&gt;If this is useful in some cases then let&apos;s continue to support it - coupled with the improvement in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2974&quot; title=&quot;CSVResponseWriter: configurable NULL placeholder value&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2974&quot;&gt;SOLR-2974&lt;/a&gt;&lt;br/&gt;
But the default case when &quot;fl&quot; is not specified, or specified as &quot;*&quot;, CSV writer should output only the stored fields.&lt;/p&gt;</comment>
                            <comment id="13170888" author="janhoy" created="Fri, 16 Dec 2011 10:30:07 +0000"  >&lt;p&gt;Updated patch which will respect explicit &quot;fl&quot; but output only stored fields for the default or &quot;*&quot; case&lt;/p&gt;</comment>
                            <comment id="13170890" author="janhoy" created="Fri, 16 Dec 2011 10:33:29 +0000"  >&lt;p&gt;Hmm, seems as the CSV writer does not support returning functions as fields either.&lt;br/&gt;
&lt;a href=&quot;http://localhost:8983/solr/ac/select/?q=*%3A*&amp;amp;wt=xml&amp;amp;fl=log(popularity&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/ac/select/?q=*%3A*&amp;amp;wt=xml&amp;amp;fl=log(popularity&lt;/a&gt;) works but&lt;br/&gt;
&lt;a href=&quot;http://localhost:8983/solr/ac/select/?q=*%3A*&amp;amp;wt=csv&amp;amp;fl=log(popularity&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/ac/select/?q=*%3A*&amp;amp;wt=csv&amp;amp;fl=log(popularity&lt;/a&gt;) does not&lt;br/&gt;
But I can spin that off as a separate issue as well, and focus on fixing this one bug&lt;/p&gt;</comment>
                            <comment id="13171585" author="is49" created="Sat, 17 Dec 2011 15:00:26 +0000"  >&lt;p&gt;When using fl=*, is it possible to include an option to output all the field data (stored and not stored)? I ask, because the CSV ResponseWriter is very useful to back up and/or transfer data between solr indexes and spreadsheets/databases.&lt;/p&gt;

&lt;p&gt;Perhaps default to stored fields, but provide an option to export all fields (without having to specify each field name)?&lt;/p&gt;</comment>
                            <comment id="13171948" author="janhoy" created="Sun, 18 Dec 2011 22:12:13 +0000"  >&lt;p&gt;Dan, the problem is that non-stored fields are not stored &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; So they cannot be output. Even if it could be possible to un-invert indexed fields, that is, IMHO, not a task for the CSV writer.&lt;/p&gt;</comment>
                            <comment id="13186789" author="janhoy" created="Mon, 16 Jan 2012 09:04:09 +0000"  >&lt;p&gt;Updated patch with test case.&lt;br/&gt;
Think this approaches ready for commit. Comments?&lt;/p&gt;</comment>
                            <comment id="13186796" author="janhoy" created="Mon, 16 Jan 2012 09:14:36 +0000"  >&lt;p&gt;Added CHANGES.txt entry to patch (assuming it will be committed in 3.x)&lt;/p&gt;</comment>
                            <comment id="13188483" author="janhoy" created="Wed, 18 Jan 2012 14:53:53 +0000"  >&lt;p&gt;Patch for 3.x&lt;/p&gt;</comment>
                            <comment id="13188486" author="janhoy" created="Wed, 18 Jan 2012 14:57:17 +0000"  >&lt;p&gt;Committed to trunk and 3x&lt;/p&gt;</comment>
                            <comment id="13188532" author="simonw" created="Wed, 18 Jan 2012 16:20:29 +0000"  >&lt;p&gt;jan, I think we just had a failure related to this commit can you look into this: &lt;a href=&quot;https://builds.apache.org/job/Lucene-Solr-tests-only-3.x-java7/1570/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Lucene-Solr-tests-only-3.x-java7/1570/&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13188540" author="janhoy" created="Wed, 18 Jan 2012 16:44:07 +0000"  >&lt;p&gt;Looking...&lt;/p&gt;</comment>
                            <comment id="13188552" author="janhoy" created="Wed, 18 Jan 2012 17:03:43 +0000"  >&lt;p&gt;Committed the attached fix to the test. On my MacBook, the order of fields for &quot;*&quot; was different than on build server, so test passed locally..&lt;/p&gt;</comment>
                            <comment id="13239983" author="janhoy" created="Tue, 27 Mar 2012 21:51:56 +0000"  >&lt;p&gt;Committed test fix to trunk, rev 1306025&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="12548284">SOLR-3281</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12511009" name="SOLR-2970-3x-fixtest.patch" size="1586" author="janhoy" created="Wed, 18 Jan 2012 17:03:43 +0000"/>
                            <attachment id="12510987" name="SOLR-2970-3x.patch" size="3430" author="janhoy" created="Wed, 18 Jan 2012 14:53:53 +0000"/>
                            <attachment id="12510682" name="SOLR-2970.patch" size="3448" author="janhoy" created="Mon, 16 Jan 2012 09:14:36 +0000"/>
                            <attachment id="12510680" name="SOLR-2970.patch" size="2893" author="janhoy" created="Mon, 16 Jan 2012 09:04:09 +0000"/>
                            <attachment id="12507678" name="SOLR-2970.patch" size="1239" author="janhoy" created="Fri, 16 Dec 2011 10:30:07 +0000"/>
                            <attachment id="12507540" name="SOLR-2970.patch" size="562" author="janhoy" created="Thu, 15 Dec 2011 15:22:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>220849</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 35 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03hhb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18265</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>