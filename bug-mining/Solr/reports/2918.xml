<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:12:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7729] ConcurrentUpdateSolrClient ignoring the collection parameter in some methods</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7729</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Some of the methods in &lt;tt&gt;ConcurrentUpdateSolrClient&lt;/tt&gt; accept an aditional &lt;tt&gt;collection&lt;/tt&gt; parameter, some of this methods are: &lt;tt&gt;add(String collection, SolrInputDocument doc)&lt;/tt&gt; and &lt;tt&gt;request(SolrRequest, String collection)&lt;/tt&gt;. &lt;/p&gt;

&lt;p&gt;This collection parameter is being ignored in this cases but works for others like &lt;tt&gt;commit(String collection)&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=elyograg&quot; class=&quot;user-hover&quot; rel=&quot;elyograg&quot;&gt;elyograg&lt;/a&gt; noted that:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Looking into how an update request actually gets added to the background&lt;br/&gt;
queue in ConcurrentUpdateSolrClient, it appears that the &quot;collection&quot;&lt;br/&gt;
information is ignored before the request is added to the queue.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;From the source, when a commit is issued or the &lt;tt&gt;UpdateParams.WAIT_SEARCHER&lt;/tt&gt; is set in the request params the collection parameter is used, otherwise the request &lt;tt&gt;UpdateRequest req&lt;/tt&gt; is queued without any regarding of the collection.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12841054">SOLR-7729</key>
            <summary>ConcurrentUpdateSolrClient ignoring the collection parameter in some methods</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="jorgelbg">Jorge Luis Betancourt Gonzalez</reporter>
                        <labels>
                            <label>client</label>
                            <label>solrj</label>
                    </labels>
                <created>Sat, 27 Jun 2015 06:27:38 +0000</created>
                <updated>Fri, 17 Jun 2016 13:11:10 +0000</updated>
                            <resolved>Tue, 19 Apr 2016 21:54:22 +0000</resolved>
                                    <version>5.1</version>
                                    <fixVersion>6.1</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                    <component>SolrJ</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14647958" author="ngavalda" created="Thu, 30 Jul 2015 17:09:06 +0000"  >&lt;p&gt;Here&apos;s a resolution proposal in the attached patch. It fixes the issue on my development environment (solrj 5.2.1).&lt;/p&gt;

&lt;p&gt;I added two unit tests to ConcurrentUpdateSolrClientTest:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the simple testCollectionParameters, duplicated from BasicHttpSolrClientTest&lt;/li&gt;
	&lt;li&gt;a second test using SendDocsRunnable to send multiple concurrent add requests, using the collection parameter&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Feel free to modify it (or ask me to rework it) if it doesn&apos;t meet solr&apos;s quality standards.&lt;/p&gt;</comment>
                            <comment id="14648187" author="jorgelbg" created="Thu, 30 Jul 2015 19:44:15 +0000"  >&lt;p&gt;I&apos;m going to give it a try to your patch, I was also working on a fix for this, but I&apos;m out on holidays &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; nevertheless I&apos;m going to give it a try. &lt;/p&gt;</comment>
                            <comment id="14950040" author="ngavalda" created="Fri, 9 Oct 2015 07:51:00 +0000"  >&lt;p&gt;Jorge, did you get a chance to look into the patch?&lt;/p&gt;</comment>
                            <comment id="15206885" author="githubbot" created="Tue, 22 Mar 2016 17:51:30 +0000"  >&lt;p&gt;GitHub user nicolasgavalda opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/24&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/24&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7729&quot; title=&quot;ConcurrentUpdateSolrClient ignoring the collection parameter in some methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7729&quot;&gt;&lt;del&gt;SOLR-7729&lt;/del&gt;&lt;/a&gt;: ConcurrentUpdateSolrClient ignoring the collection parameter in some methods&lt;/p&gt;

&lt;p&gt;    This is a fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7729&quot; title=&quot;ConcurrentUpdateSolrClient ignoring the collection parameter in some methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7729&quot;&gt;&lt;del&gt;SOLR-7729&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
    I submitted a similar patch on JIRA for the 5.2.1 version, this is an updated version for the master branch.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/nicolasgavalda/lucene-solr&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/nicolasgavalda/lucene-solr&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7729&quot; title=&quot;ConcurrentUpdateSolrClient ignoring the collection parameter in some methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7729&quot;&gt;&lt;del&gt;SOLR-7729&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/24.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/24.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #24&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit c9c14eb96525b90271ce6acc4594db12d6799bf3&lt;br/&gt;
Author: Nicolas Gavalda &amp;lt;nicolas.gavalda@ametys.org&amp;gt;&lt;br/&gt;
Date:   2016-03-22T16:11:55Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7729&quot; title=&quot;ConcurrentUpdateSolrClient ignoring the collection parameter in some methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7729&quot;&gt;&lt;del&gt;SOLR-7729&lt;/del&gt;&lt;/a&gt;: ConcurrentUpdateSolrClient ignoring the collection parameter&lt;br/&gt;
    in some methods.&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15232330" author="markrmiller@gmail.com" created="Fri, 8 Apr 2016 15:25:48 +0000"  >&lt;p&gt;Here is a patch that updates this to trunk.&lt;/p&gt;

&lt;p&gt;This is all kind of awkward because the user can easily already have the collection in the base url the client uses, but what can you do. This at least fixes the bug.&lt;/p&gt;</comment>
                            <comment id="15232406" author="ngavalda" created="Fri, 8 Apr 2016 16:12:49 +0000"  >&lt;p&gt;IMHO the point of this API is to have a unique SolrClient variable which can be used to query multiple collections. It would be bothersome to have to declare a new SolrClient for each new collection to query.&lt;/p&gt;

&lt;p&gt;I had already updated the patch to trunk in the pull request I submitted two weeks ago, I hope you didn&apos;t bother too much with the update &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Once the fix is committed to master, could it be merged in 6.x and maybe in 5.x?&lt;/p&gt;</comment>
                            <comment id="15232462" author="markrmiller@gmail.com" created="Fri, 8 Apr 2016 16:40:30 +0000"  >&lt;p&gt;The problem is that the client is not smart about this at all. If you start it with a collection url and then choose a collection, the behavior is no good. This is a common way to init SolrJ clients, so that API was not very well thought out to begin with IMO.&lt;/p&gt;</comment>
                            <comment id="15239351" author="markrmiller@gmail.com" created="Wed, 13 Apr 2016 14:40:53 +0000"  >&lt;blockquote&gt;&lt;p&gt;I had already updated the patch to trunk in the pull request I submitted two weeks ago, I hope you didn&apos;t bother too much with the update &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Trunk moves fairly fast sometimes, the pull request patch is what I updated to work with trunk: &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/24.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/24.patch&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Once the fix is committed to master, could it be merged in 6.x and maybe in 5.x?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It will go in 6.1. Will consider 5.5.1.&lt;/p&gt;


&lt;p&gt;I&apos;ll commit this shortly.&lt;/p&gt;</comment>
                            <comment id="15239487" author="jira-bot" created="Wed, 13 Apr 2016 15:54:06 +0000"  >&lt;p&gt;Commit 0a5f7f8b5e35a053031cc89b40e7c315cfcef82d in lucene-solr&apos;s branch refs/heads/master from markrmiller&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0a5f7f8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0a5f7f8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7729&quot; title=&quot;ConcurrentUpdateSolrClient ignoring the collection parameter in some methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7729&quot;&gt;&lt;del&gt;SOLR-7729&lt;/del&gt;&lt;/a&gt;: ConcurrentUpdateSolrClient ignores the collection parameter in some methods.&lt;/p&gt;</comment>
                            <comment id="15239950" author="jira-bot" created="Wed, 13 Apr 2016 20:12:29 +0000"  >&lt;p&gt;Commit bf984af6f0824ea00eddf8732e8d4cf8323da022 in lucene-solr&apos;s branch refs/heads/branch_6x from markrmiller&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=bf984af&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=bf984af&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7729&quot; title=&quot;ConcurrentUpdateSolrClient ignoring the collection parameter in some methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7729&quot;&gt;&lt;del&gt;SOLR-7729&lt;/del&gt;&lt;/a&gt;: ConcurrentUpdateSolrClient ignores the collection parameter in some methods.&lt;/p&gt;</comment>
                            <comment id="15239974" author="markrmiller@gmail.com" created="Wed, 13 Apr 2016 20:32:55 +0000"  >&lt;p&gt;I don&apos;t know if I like this for a 5.5.1 release because if you used a collection specific URL and set the collection it would have worked and now it will not. It&apos;s not the best even for a 5.6 (may not happen) or 6.1 release, but much more tolerable.&lt;/p&gt;

&lt;p&gt;I&apos;m still wondering what we can try and do about it.&lt;/p&gt;</comment>
                            <comment id="15240224" author="jira-bot" created="Wed, 13 Apr 2016 23:21:21 +0000"  >&lt;p&gt;Commit 0a5f7f8b5e35a053031cc89b40e7c315cfcef82d in lucene-solr&apos;s branch refs/heads/jira/&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8908&quot; title=&quot;Registering each ZkIndexSchemaReader as an OnReconnect listener introduces a memory leak&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8908&quot;&gt;&lt;del&gt;SOLR-8908&lt;/del&gt;&lt;/a&gt; from markrmiller&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0a5f7f8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0a5f7f8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7729&quot; title=&quot;ConcurrentUpdateSolrClient ignoring the collection parameter in some methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7729&quot;&gt;&lt;del&gt;SOLR-7729&lt;/del&gt;&lt;/a&gt;: ConcurrentUpdateSolrClient ignores the collection parameter in some methods.&lt;/p&gt;</comment>
                            <comment id="15242892" author="ngavalda" created="Fri, 15 Apr 2016 12:37:27 +0000"  >&lt;p&gt;I upgraded to solr 6, so merging it to the 5.5 branch is not a necessary for me anymore, you can ignore this part if you don&apos;t want to change the behavior in 5.5.1.&lt;br/&gt;
Thanks for the commits!&lt;/p&gt;</comment>
                            <comment id="15249556" author="githubbot" created="Wed, 20 Apr 2016 09:36:23 +0000"  >&lt;p&gt;Github user nicolasgavalda closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/24&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/24&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15277257" author="hossman" created="Mon, 9 May 2016 23:01:31 +0000"  >
&lt;p&gt;Manually correcting fixVersion per Step #S5 of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-7271&quot; title=&quot;Cleanup jira&amp;#39;s concept of &amp;#39;master&amp;#39; and &amp;#39;6.0&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-7271&quot;&gt;&lt;del&gt;LUCENE-7271&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15293285" author="steve_rowe" created="Fri, 20 May 2016 12:37:58 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt;, should this go into 6.0.1?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12748030" name="SOLR-7729-ConcurrentUpdateSolrClient-collection.patch" size="10366" author="ngavalda" created="Thu, 30 Jul 2015 17:09:06 +0000"/>
                            <attachment id="12797737" name="SOLR-7729.patch" size="11127" author="markrmiller@gmail.com" created="Fri, 8 Apr 2016 15:25:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 26 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2gktj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>