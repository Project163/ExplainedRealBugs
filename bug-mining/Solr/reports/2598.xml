<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:07:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7935] NPE from VersionInfo.lookupVersion during core reload</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7935</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The test from &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7836&quot; title=&quot;Possible deadlock when closing refcounted index writers.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7836&quot;&gt;&lt;del&gt;SOLR-7836&lt;/del&gt;&lt;/a&gt; sometimes fails with a NPE where an add looks up version info from the index.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12856456">SOLR-7935</key>
            <summary>NPE from VersionInfo.lookupVersion during core reload</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="yseeley@gmail.com">Yonik Seeley</reporter>
                        <labels>
                    </labels>
                <created>Sun, 16 Aug 2015 15:11:58 +0000</created>
                <updated>Tue, 15 Dec 2015 13:54:58 +0000</updated>
                            <resolved>Tue, 18 Aug 2015 14:14:51 +0000</resolved>
                                                    <fixVersion>5.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14698725" author="yseeley@gmail.com" created="Sun, 16 Aug 2015 15:35:54 +0000"  >&lt;p&gt;Here&apos;s a trace from one of the fails&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;   &amp;gt; Caused by: java.lang.RuntimeException: org.apache.solr.common.SolrException: Error opening &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; searcher
   &amp;gt;    at __randomizedtesting.SeedInfo.seed([FF8C00109137C2A5]:0)
   &amp;gt;    at org.apache.solr.search.TestReloadDeadlock$1.run(TestReloadDeadlock.java:166)
   &amp;gt; Caused by: org.apache.solr.common.SolrException: Error opening &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; searcher
   &amp;gt;    at org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:1673)
   &amp;gt;    at org.apache.solr.core.SolrCore.getRealtimeSearcher(SolrCore.java:1530)
   &amp;gt;    at org.apache.solr.update.VersionInfo.getVersionFromIndex(VersionInfo.java:202)
   &amp;gt;    at org.apache.solr.update.UpdateLog.lookupVersion(UpdateLog.java:783)
   &amp;gt;    at org.apache.solr.update.VersionInfo.lookupVersion(VersionInfo.java:195)
   &amp;gt;    at org.apache.solr.update.processor.DistributedUpdateProcessor.versionAdd(DistributedUpdateProcessor.java:1088)
   &amp;gt;    at org.apache.solr.update.processor.DistributedUpdateProcessor.processAdd(DistributedUpdateProcessor.java:705)
   &amp;gt;    at org.apache.solr.update.processor.LogUpdateProcessor.processAdd(LogUpdateProcessorFactory.java:104)
   &amp;gt;    at org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.handleAdds(JsonLoader.java:470)
   &amp;gt;    at org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.processUpdate(JsonLoader.java:134)
   &amp;gt;    at org.apache.solr.handler.loader.JsonLoader$SingleThreadedJsonLoader.load(JsonLoader.java:113)
   &amp;gt;    at org.apache.solr.handler.loader.JsonLoader.load(JsonLoader.java:76)
   &amp;gt;    at org.apache.solr.handler.UpdateRequestHandler$1.load(UpdateRequestHandler.java:98)
   &amp;gt;    at org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:74)
   &amp;gt;    at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:151)
   &amp;gt;    at org.apache.solr.core.SolrCore.execute(SolrCore.java:2079)
   &amp;gt;    at org.apache.solr.servlet.DirectSolrConnection.request(DirectSolrConnection.java:131)
   &amp;gt;    at org.apache.solr.SolrTestCaseJ4.updateJ(SolrTestCaseJ4.java:1104)
   &amp;gt;    at org.apache.solr.SolrTestCaseJ4.addAndGetVersion(SolrTestCaseJ4.java:1250)
   &amp;gt;    at org.apache.solr.search.TestReloadDeadlock.addDoc(TestReloadDeadlock.java:200)
   &amp;gt;    at org.apache.solr.search.TestReloadDeadlock.access$100(TestReloadDeadlock.java:46)
   &amp;gt;    at org.apache.solr.search.TestReloadDeadlock$1.run(TestReloadDeadlock.java:156)
   &amp;gt; Caused by: java.lang.NullPointerException
   &amp;gt;    at org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:1642)
   &amp;gt;    ... 21 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14700561" author="yseeley@gmail.com" created="Tue, 18 Aug 2015 01:15:10 +0000"  >&lt;p&gt;OK, so what I think is happening here:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ulog is reused for the new core&lt;/li&gt;
	&lt;li&gt;ulog has a reference to the uhandler that is set at the end of the DUH2 constructor&lt;/li&gt;
	&lt;li&gt;a request that needs a version check comes in after the ulog.uhandler reference is set, but before the core.uhandler reference is set, leading to a NPE when it is used to try and open a new realtime searcher&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14700566" author="yseeley@gmail.com" created="Tue, 18 Aug 2015 01:22:09 +0000"  >&lt;p&gt;Here&apos;s a simple patch that avoids going through the update handler to get the latest writer.&lt;/p&gt;</comment>
                            <comment id="14701250" author="yseeley@gmail.com" created="Tue, 18 Aug 2015 13:33:12 +0000"  >&lt;p&gt;OK, looping the test overnight seems to verify that this patch works to fix the NPE fails.&lt;/p&gt;</comment>
                            <comment id="14701295" author="jira-bot" created="Tue, 18 Aug 2015 14:04:07 +0000"  >&lt;p&gt;Commit 1696417 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1696417&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1696417&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7935&quot; title=&quot;NPE from VersionInfo.lookupVersion during core reload&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7935&quot;&gt;&lt;del&gt;SOLR-7935&lt;/del&gt;&lt;/a&gt;:fix race that can cause a NPE in openNewSearcher called from an update concurrent with a core reload&lt;/p&gt;</comment>
                            <comment id="14701300" author="jira-bot" created="Tue, 18 Aug 2015 14:06:20 +0000"  >&lt;p&gt;Commit 1696420 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1696420&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1696420&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7935&quot; title=&quot;NPE from VersionInfo.lookupVersion during core reload&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7935&quot;&gt;&lt;del&gt;SOLR-7935&lt;/del&gt;&lt;/a&gt;:fix race that can cause a NPE in openNewSearcher called from an update concurrent with a core reload&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12750942" name="SOLR-7935.patch" size="1236" author="yseeley@gmail.com" created="Tue, 18 Aug 2015 01:22:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 14 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2iz8f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>