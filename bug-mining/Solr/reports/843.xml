<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:26:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3074] SolrPluginUtils.docListToSolrDocumentList is broken, existing test is also broken</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3074</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;testDocListConversion() is not testing what it&apos;s suppossed to test. Because added test documents are not committed.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://search-lucene.com/m/uwh9l2SHH4e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://search-lucene.com/m/uwh9l2SHH4e&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12540328">SOLR-3074</key>
            <summary>SolrPluginUtils.docListToSolrDocumentList is broken, existing test is also broken</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="iorixxx">Ahmet Arslan</assignee>
                                    <reporter username="iorixxx">Ahmet Arslan</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 Jan 2012 08:44:26 +0000</created>
                <updated>Fri, 10 May 2013 10:40:06 +0000</updated>
                            <resolved>Thu, 22 Mar 2012 19:33:48 +0000</resolved>
                                    <version>3.5</version>
                                    <fixVersion>3.6</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13198402" author="hossman" created="Thu, 2 Feb 2012 00:47:42 +0000"  >&lt;p&gt;Ahmet: thanks for raising this issue, and for your patch.&lt;/p&gt;

&lt;p&gt;you didn&apos;t mention it in jira, but in your linked email you suggested that the method being tested (docListToSolrDocumentList) isn&apos;t actually doing what it&apos;s suppose to...&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Regardless of Set&amp;lt;String&amp;gt; fields parameter, SolrPluginUtils#docListToSolrDocumentList method loads all of the stored fields. Shouldn&apos;t it just load the fields given in the set? Should I file a jira ticket?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Digging deeper, i found two problems...&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;docListToSolrDocumentList is delegating the field list to SolrIndexSearcher.doc, which means those fields are read immediately, but the rest of the fields will be lazy loaded&lt;/li&gt;
	&lt;li&gt;docListToSolrDocumentList is calling DocumentBuilder.loadStoredFields which loads all of the fields &amp;#8211; regardless of which field list was passed to docListToSolrDocumentList&lt;/li&gt;
	&lt;li&gt;docListToSolrDocumentList has some really bizare code in it, preventing stored fields from being returned if they are the result of a copyField.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Since there are no other usages of DocumentBuilder.loadStoredFields in Solr, it&apos;s not clear to me what the intended point of it&apos;s crazy logic was&lt;/p&gt;</comment>
                            <comment id="13198407" author="hossman" created="Thu, 2 Feb 2012 00:50:05 +0000"  >&lt;p&gt;additions to Ahmet&apos;s patch showing the additional problems found.&lt;/p&gt;

&lt;p&gt;given that neither of these two methods are used anywhere in Solr, and they are so clearly broken i suggest we deprecate them in 3.6 as &quot;completely broken&quot; and remove in trunk.&lt;/p&gt;</comment>
                            <comment id="13234039" author="hossman" created="Wed, 21 Mar 2012 02:23:42 +0000"  >&lt;p&gt;barring objections i&apos;m going to...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;remove these methods in trunk&lt;/li&gt;
	&lt;li&gt;mark then &quot;@deprecated apparently  this method has behaved as documented for a very long time, and is unneeded in Solr, so it is deprecated and will be removed in Solr 4&quot; in 3x&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;...tomorrow.&lt;/p&gt;</comment>
                            <comment id="13234814" author="ryantxu" created="Wed, 21 Mar 2012 18:29:30 +0000"  >&lt;blockquote&gt;&lt;p&gt;remove these methods in trunk&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1&lt;/p&gt;


&lt;p&gt;I &lt;b&gt;think&lt;/b&gt; this was used long ago before the javabin format took over serializing DocList &lt;/p&gt;</comment>
                            <comment id="13235264" author="hossman" created="Thu, 22 Mar 2012 00:50:34 +0000"  >&lt;p&gt;Oy...&lt;/p&gt;

&lt;p&gt;so i started down the road of removing all this from trunk, and then realized i somehow overlooked the fact that clustering is using docListToSolrDocumentList&lt;/p&gt;

&lt;p&gt;so then i started trying to fix clustering to have the logic it needed, and then realized that the code i wound up with actually implemented the documented contract of docListToSolrDocumentList in a way that made the new tests in this issue pass.&lt;/p&gt;

&lt;p&gt;So this new patch:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;fixes docListToSolrDocumentList&lt;/li&gt;
	&lt;li&gt;fixes the test for docListToSolrDocumentList&lt;/li&gt;
	&lt;li&gt;removes DocumentBuilder.loadStoredFields&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;my &lt;em&gt;new&lt;/em&gt; plan is to commit as is to trunk, and backport all but the DocumentBuilder.java changes to 3x (i&apos;ll just deprecate loadStoredFields in 3x)&lt;/p&gt;

&lt;p&gt;comments?&lt;/p&gt;</comment>
                            <comment id="13235932" author="hossman" created="Thu, 22 Mar 2012 19:33:49 +0000"  >&lt;p&gt;r1303977 - trunk fix of SolrPluginUtils &amp;amp; test, removal of loadStoredFields method&lt;/p&gt;

&lt;p&gt;r1304001 - backport to 3x, but leave loadStoredFields in place with a scary freaking deprecation warning.&lt;/p&gt;

&lt;p&gt;Ahmet: thanks for your report and especially for your test case&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12519387" name="SOLR-3074.patch" size="6173" author="hossman" created="Thu, 22 Mar 2012 00:50:34 +0000"/>
                            <attachment id="12512885" name="SOLR-3074.patch" size="3276" author="hossman" created="Thu, 2 Feb 2012 00:50:05 +0000"/>
                            <attachment id="12512392" name="SOLR-3074.patch" size="1135" author="iorixxx" created="Mon, 30 Jan 2012 08:45:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>225741</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 35 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03guf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18162</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>