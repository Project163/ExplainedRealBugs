<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:35:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-8808] SolrJ deleteById causes missing content stream exception</title>
                <link>https://issues.apache.org/jira/browse/SOLR-8808</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;client.deleteById(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;()); 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Causes&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;org.apache.solr.client.solrj.impl.HttpSolrClient$RemoteSolrException: Error from server at http:&lt;span class=&quot;code-comment&quot;&gt;//127.0.0.1:50083/collection1: Error from server at http://127.0.0.1:50083/control_collection: missing content stream
&lt;/span&gt;        at __randomizedtesting.SeedInfo.seed([6C4973F1A077B797:65D362791DA8A1AD]:0)
        at org.apache.solr.client.solrj.impl.HttpSolrClient.executeMethod(HttpSolrClient.java:576)
        at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:240)
        at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:229)
        at org.apache.solr.client.solrj.SolrRequest.process(SolrRequest.java:149)
        at org.apache.solr.client.solrj.SolrClient.commit(SolrClient.java:482)
        at org.apache.solr.client.solrj.SolrClient.commit(SolrClient.java:463)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Although this is not a big issue, it had me puzzled for a while. A test unrelated to one i was working on started sending empty deletes. Causing above trace.&lt;/p&gt;

&lt;p&gt;Perhaps SolrJ should guard for empty input, just ignore and return.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12948396">SOLR-8808</key>
            <summary>SolrJ deleteById causes missing content stream exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="markus17">Markus Jelsma</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 Mar 2016 13:27:07 +0000</created>
                <updated>Thu, 14 Mar 2019 13:07:31 +0000</updated>
                            <resolved>Sun, 14 Oct 2018 02:27:02 +0000</resolved>
                                    <version>5.5</version>
                                    <fixVersion>7.6</fixVersion>
                    <fixVersion>8.0</fixVersion>
                                    <component>SolrJ</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15192487" author="gerlowskija" created="Sun, 13 Mar 2016 19:12:15 +0000"  >&lt;p&gt;+1 for this JIRA.&lt;/p&gt;

&lt;p&gt;SolrJ code tends to take a laissez-faire approach to validating inputs, which has a tendency for allowing odd errors to crop up down the line.  This is a good example of that.  Would love to see this get fixed here (and elsewhere in SolrJ at large, as a separate story).&lt;/p&gt;

&lt;p&gt;Anyone see any downsides to fixing this that I might be missing?&lt;/p&gt;
</comment>
                            <comment id="15194284" author="gerlowskija" created="Mon, 14 Mar 2016 22:23:14 +0000"  >&lt;p&gt;Uploaded patch contains changes to SolrClient.java.  It also adds a simple test to a few SolrClient related test-files that verify the behavior.&lt;/p&gt;

&lt;p&gt;One aspect of this change that I hadn&apos;t thought about when I first saw it is that &lt;tt&gt;deleteById&lt;/tt&gt; has an UpdateResponse return value.  Since this patch changes deleteByid to not send a request when no IDs were given, it&apos;s not super clear what the best value to return here is.  The patch I uploaded just returns a blank value type created via the no-arg ctor.&lt;/p&gt;

&lt;p&gt;This means that in practice, a SolrJ user could call deleteById() and get a return value just fine.  But if they go to pull out the request timestamp, or the headers later on, they could get bitten by an NPE.  So while it looks like this patch is an obvious improvement, it really might just kick the can down the road a bit and lead to errors later on.&lt;/p&gt;

&lt;p&gt;That said, I still think it&apos;s an improvement, and this is the right thing to do.  Just wanted to call it out in case anyone has a suggestion for getting around that limitation.&lt;/p&gt;</comment>
                            <comment id="16648458" author="gerlowskija" created="Fri, 12 Oct 2018 21:23:39 +0000"  >&lt;p&gt;Picking this guy back up in a bit of time I have.  &lt;/p&gt;

&lt;p&gt;Looks like the &lt;tt&gt;missing content stream&lt;/tt&gt; error is produced by all 4 SolrClient impl&apos;s in this case.&lt;/p&gt;

&lt;p&gt;There&apos;s a few options for how we can handle this:&lt;/p&gt;

&lt;p&gt;1. Return a dummy response&lt;br/&gt;
2. Head off the RSE by checking whether the list is null/empty initially and throwing a clearer exception (IllegalArgumentException)&lt;br/&gt;
3. Correct the underlying request code in HttpSolrClient and ConcurrentUpdateSolrClient to handle this case.&lt;/p&gt;

&lt;p&gt;My vote for fixing this is to (2).  We can make the exception message much better to clear up any potential confusion.  And since the behavior already throws an exception, the change won&apos;t risk breaking any clients.&lt;/p&gt;

&lt;p&gt;I initially liked the idea of returning a dummy response, but now that Solr&apos;s update API returns some useful data (the &quot;rf&quot; field) that people could be looking at and acting on, mocking up a dummy response seems a little sketchy.&lt;/p&gt;</comment>
                            <comment id="16649217" author="jira-bot" created="Sun, 14 Oct 2018 02:16:03 +0000"  >&lt;p&gt;Commit 6d1b2e2f38a8979c65c1a208a0dd4cfc2de951ed in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gerlowskija&quot; class=&quot;user-hover&quot; rel=&quot;gerlowskija&quot;&gt;gerlowskija&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6d1b2e2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6d1b2e2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8808&quot; title=&quot;SolrJ deleteById causes missing content stream exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8808&quot;&gt;&lt;del&gt;SOLR-8808&lt;/del&gt;&lt;/a&gt;: Add null/empty check to SolrClient.deleteByIds&lt;/p&gt;</comment>
                            <comment id="16649219" author="jira-bot" created="Sun, 14 Oct 2018 02:17:07 +0000"  >&lt;p&gt;Commit 6f6e4b8368e5b913fbe9b070e4c8b82e0ca53920 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gerlowskija&quot; class=&quot;user-hover&quot; rel=&quot;gerlowskija&quot;&gt;gerlowskija&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6f6e4b8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6f6e4b8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8808&quot; title=&quot;SolrJ deleteById causes missing content stream exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8808&quot;&gt;&lt;del&gt;SOLR-8808&lt;/del&gt;&lt;/a&gt;: Add null/empty check to SolrClient.deleteByIds&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12793417" name="SOLR-8808.patch" size="16858" author="gerlowskija" created="Mon, 14 Mar 2016 22:23:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 5 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2uefb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>