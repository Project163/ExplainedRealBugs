<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:33:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4170] SOLR-4170: The &apos;backup&apos; ReplicationHandler command can sometimes use a stale index directory rather than the current one.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4170</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I&apos;m using SolrCloud. When I&apos;m trying to create index snapshot - exception occurs:&lt;br/&gt;
INFO: &lt;span class=&quot;error&quot;&gt;&amp;#91;test&amp;#93;&lt;/span&gt; webapp=/solr path=/replication params=&lt;/p&gt;
{command=backup&amp;amp;numberToKeep=1}
&lt;p&gt; status=0 QTime=1&lt;br/&gt;
Dec 07, 2012 6:00:02 PM org.apache.solr.handler.SnapShooter createSnapshot&lt;br/&gt;
SEVERE: Exception while creating snapshot&lt;br/&gt;
java.io.FileNotFoundException: File /solr/cores/test/data/index/segments_g does not exist&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter$FileCopier.copyFile(SnapShooter.java:194)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter$FileCopier.copyFiles(SnapShooter.java:185)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter.createSnapshot(SnapShooter.java:105)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter$1.run(SnapShooter.java:78)&lt;/p&gt;

&lt;p&gt;Issue occurs randomly. Reloading core usually helps, but sometimes core has to be reloaded couple of times to make snapshot possible.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12623548">SOLR-4170</key>
            <summary>SOLR-4170: The &apos;backup&apos; ReplicationHandler command can sometimes use a stale index directory rather than the current one.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="mrzewucki">Marcin Rzewucki</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Dec 2012 13:33:45 +0000</created>
                <updated>Mon, 9 May 2016 18:57:43 +0000</updated>
                            <resolved>Tue, 8 Jan 2013 02:08:30 +0000</resolved>
                                    <version>4.0</version>
                                    <fixVersion>4.1</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13530787" author="teofili" created="Thu, 13 Dec 2012 08:26:03 +0000"  >&lt;p&gt;where do you store index files? NFS?&lt;/p&gt;</comment>
                            <comment id="13531152" author="mrzewucki" created="Thu, 13 Dec 2012 16:30:06 +0000"  >&lt;p&gt;no, ephemeral storage in AWS (ext4)&lt;/p&gt;</comment>
                            <comment id="13531565" author="mrzewucki" created="Thu, 13 Dec 2012 22:09:37 +0000"  >&lt;p&gt;The issue might be caused by frequent index changes. I found a temporary workaround for this: I stop updates, reload core on each node in SolrCloud (just for sure), create index snapshot and resume updates. Awkward, but works and I need reliable solution. Anyway, if solr has the ability to make an index snapshot it should take care of this process even in case of frequent updates. That&apos;s why I&apos;d prefer to fix it in Solr instead of finding workarounds for this issue.&lt;/p&gt;</comment>
                            <comment id="13531572" author="markrmiller@gmail.com" created="Thu, 13 Dec 2012 22:18:00 +0000"  >&lt;p&gt;Any chance you can test the latest 4x build?&lt;/p&gt;</comment>
                            <comment id="13532036" author="markrmiller@gmail.com" created="Fri, 14 Dec 2012 04:27:29 +0000"  >&lt;p&gt;I think this may be fixed on 4.X.&lt;/p&gt;</comment>
                            <comment id="13540191" author="mrzewucki" created="Thu, 27 Dec 2012 22:24:01 +0000"  >&lt;p&gt;Tried with solr_41 (4.1.0.2012.12.14.09.42.29). It seems to be fixed only partially. Issue occurs once new index directory is created:&lt;br/&gt;
SEVERE: Exception while creating snapshot&lt;br/&gt;
java.io.FileNotFoundException: /solr/cores/aws/search/data/index/segments_1rg (No such file or directory)&lt;br/&gt;
        at java.io.RandomAccessFile.open(Native Method)&lt;br/&gt;
        at java.io.RandomAccessFile.&amp;lt;init&amp;gt;(Unknown Source)&lt;br/&gt;
        at org.apache.lucene.store.MMapDirectory.openInput(MMapDirectory.java:223)&lt;br/&gt;
        at org.apache.lucene.store.Directory.copy(Directory.java:200)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter$FileCopier.copyFile(SnapShooter.java:205)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter$FileCopier.copyFiles(SnapShooter.java:189)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter.createSnapshot(SnapShooter.java:107)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter$1.run(SnapShooter.java:77)&lt;/p&gt;

&lt;p&gt;File &quot;segments_1rg&quot; exists, but in /solr/cores/aws/search/data/index.20121227160834580/ directory. Seems like &quot;index.properties&quot;/getNewIndexDir is not respected by snapshotting process. Could you check that, please ?&lt;/p&gt;</comment>
                            <comment id="13546521" author="markrmiller@gmail.com" created="Tue, 8 Jan 2013 02:08:30 +0000"  >&lt;p&gt;Thanks for the report Marcin!&lt;/p&gt;</comment>
                            <comment id="13546523" author="commit-tag-bot" created="Tue, 8 Jan 2013 02:09:53 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Mark Robert Miller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1430111&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1430111&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4170&quot; title=&quot;SOLR-4170: The &amp;#39;backup&amp;#39; ReplicationHandler command can sometimes use a stale index directory rather than the current one.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4170&quot;&gt;&lt;del&gt;SOLR-4170&lt;/del&gt;&lt;/a&gt;: The &apos;backup&apos; ReplicationHandler command can sometimes use a stale index directory rather than the current one.&lt;/p&gt;</comment>
                            <comment id="13546534" author="commit-tag-bot" created="Tue, 8 Jan 2013 02:20:33 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Mark Robert Miller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1430112&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1430112&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4170&quot; title=&quot;SOLR-4170: The &amp;#39;backup&amp;#39; ReplicationHandler command can sometimes use a stale index directory rather than the current one.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4170&quot;&gt;&lt;del&gt;SOLR-4170&lt;/del&gt;&lt;/a&gt;: The &apos;backup&apos; ReplicationHandler command can sometimes use a stale index directory rather than the current one.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>297258</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 46 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14nfb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>235260</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>