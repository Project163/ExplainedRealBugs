<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:19:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-1852] enablePositionIncrements=&quot;true&quot; can cause searches to fail when they are parsed as phrase queries</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1852</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Symptom: searching for a string like a domain name containing a &apos;.&apos;, the Solr 1.4 analyzer tells me that I will get a match, but when I enter the search either in the client or directly in Solr, the search fails. &lt;br/&gt;
test string:  Identi.ca&lt;/p&gt;

&lt;p&gt;queries that fail:  IdentiCa, Identi.ca, Identi-ca&lt;/p&gt;

&lt;p&gt;query that matches: Identi ca&lt;/p&gt;


&lt;p&gt;schema in use is:&lt;br/&gt;
&lt;a href=&quot;http://drupalcode.org/viewvc/drupal/contributions/modules/apachesolr/schema.xml?revision=1.1.2.1.2.34&amp;amp;content-type=text%2Fplain&amp;amp;view=co&amp;amp;pathrev=DRUPAL-6--1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://drupalcode.org/viewvc/drupal/contributions/modules/apachesolr/schema.xml?revision=1.1.2.1.2.34&amp;amp;content-type=text%2Fplain&amp;amp;view=co&amp;amp;pathrev=DRUPAL-6--1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Screen shots:&lt;/p&gt;

&lt;p&gt;analysis:  &lt;a href=&quot;http://img.skitch.com/20100327-nt1uc1ctykgny28n8bgu99h923.png&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://img.skitch.com/20100327-nt1uc1ctykgny28n8bgu99h923.png&lt;/a&gt;&lt;br/&gt;
dismax search: &lt;a href=&quot;http://img.skitch.com/20100327-byiduuiry78caka7q5smsw7fp.png&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://img.skitch.com/20100327-byiduuiry78caka7q5smsw7fp.png&lt;/a&gt;&lt;br/&gt;
dismax search: &lt;a href=&quot;http://img.skitch.com/20100327-gckm8uhjx3t7px31ygfqc2ugdq.png&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://img.skitch.com/20100327-gckm8uhjx3t7px31ygfqc2ugdq.png&lt;/a&gt;&lt;br/&gt;
standard search: &lt;a href=&quot;http://img.skitch.com/20100327-usqyqju1d12ymcpb2cfbtdwyh.png&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://img.skitch.com/20100327-usqyqju1d12ymcpb2cfbtdwyh.png&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Whether or not the bug appears is determined by the surrounding text:&lt;/p&gt;

&lt;p&gt;&quot;would be great to have support for Identi.ca on the follow block&quot;&lt;/p&gt;

&lt;p&gt;fails to match &quot;Identi.ca&quot;, but putting the content on its own or in another sentence:&lt;/p&gt;

&lt;p&gt;&quot;Support Identi.ca&quot;&lt;/p&gt;

&lt;p&gt;the search matches.  Testing suggests the word &quot;for&quot; is the problem, and it looks like the bug occurs when a stop word preceeds a word that is split up using the word delimiter filter.&lt;/p&gt;

&lt;p&gt;Setting enablePositionIncrements=&quot;false&quot; in the stop filter and reindexing causes the searches to match.&lt;/p&gt;


&lt;p&gt;According to Mark Miller in #solr, this bug appears to be fixed already in Solr trunk, either due to the upgraded lucene or changes to the WordDelimiterFactory&lt;/p&gt;</description>
                <environment></environment>
        <key id="12460457">SOLR-1852</key>
            <summary>enablePositionIncrements=&quot;true&quot; can cause searches to fail when they are parsed as phrase queries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rcmuir">Robert Muir</assignee>
                                    <reporter username="pwolanin">Peter Wolanin</reporter>
                        <labels>
                    </labels>
                <created>Sat, 27 Mar 2010 23:04:46 +0000</created>
                <updated>Thu, 16 Sep 2010 19:59:40 +0000</updated>
                            <resolved>Wed, 2 Jun 2010 18:35:48 +0000</resolved>
                                    <version>1.4</version>
                                    <fixVersion>1.4.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="12850608" author="pwolanin" created="Sat, 27 Mar 2010 23:36:21 +0000"  >&lt;p&gt;This patch was created by Mark Miller - it&apos;s a back port of Solr trunk code plus a tweak to let 1.4 compile&lt;/p&gt;

&lt;p&gt;With this updated WordDelimiterFilter if I reindex the bug seems to be fixed.&lt;/p&gt;

&lt;p&gt;In terms of the bug&apos;s symptoms to reproduce it, it looks as though Identi.ca is treated as phrase query as if I had quoted it like &quot;Identi ca&quot;.  That phrase search also fails.  I had expected that Identi.ca would be the same as Identi ca (i.e. 2 separate tokens, not a phrase).&lt;/p&gt;</comment>
                            <comment id="12850610" author="pwolanin" created="Sun, 28 Mar 2010 00:01:03 +0000"  >&lt;p&gt;The changes in the patch originate at &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1706&quot; title=&quot;wrong tokens output from WordDelimiterFilter depending upon options&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1706&quot;&gt;&lt;del&gt;SOLR-1706&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1657&quot; title=&quot;convert the rest of solr to use the new tokenstream API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1657&quot;&gt;&lt;del&gt;SOLR-1657&lt;/del&gt;&lt;/a&gt;, however I don&apos;t think it&apos;s actually the same bug as &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1706&quot; title=&quot;wrong tokens output from WordDelimiterFilter depending upon options&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1706&quot;&gt;&lt;del&gt;SOLR-1706&lt;/del&gt;&lt;/a&gt; intended to fix since the the admin analyzer interface the generated tokens look correct.&lt;/p&gt;</comment>
                            <comment id="12850612" author="rcmuir" created="Sun, 28 Mar 2010 00:18:36 +0000"  >&lt;blockquote&gt;&lt;p&gt;The changes in the patch originate at &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1706&quot; title=&quot;wrong tokens output from WordDelimiterFilter depending upon options&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1706&quot;&gt;&lt;del&gt;SOLR-1706&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1657&quot; title=&quot;convert the rest of solr to use the new tokenstream API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1657&quot;&gt;&lt;del&gt;SOLR-1657&lt;/del&gt;&lt;/a&gt;, however I don&apos;t think it&apos;s actually the same bug as &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1706&quot; title=&quot;wrong tokens output from WordDelimiterFilter depending upon options&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1706&quot;&gt;&lt;del&gt;SOLR-1706&lt;/del&gt;&lt;/a&gt; intended to fix since the the admin analyzer interface the generated tokens look correct. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, I don&apos;t like the situation at all, as its not obvious to me at a glance how the trunk impl fixes your problem, but at the same time how this changed behavior slipped passed the random tests on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1710&quot; title=&quot;convert worddelimiterfilter to new tokenstream API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1710&quot;&gt;&lt;del&gt;SOLR-1710&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="12850613" author="rcmuir" created="Sun, 28 Mar 2010 00:27:06 +0000"  >&lt;p&gt;ok, so your bug relates somehow to how the accumulated position increment gap is handled.&lt;/p&gt;

&lt;p&gt;This is how your stopword fits into the situation, somehow the new code is handling it &quot;better&quot;  for your case, but perhaps its wrong.&lt;/p&gt;

&lt;p&gt;there are quite a few tests in TestWordDelimiter, which it passes, but I&apos;ll spend some time tonight verifying its correctness before we declare success...&lt;/p&gt;</comment>
                            <comment id="12850671" author="rcmuir" created="Sun, 28 Mar 2010 13:03:13 +0000"  >&lt;p&gt;attached is a testcase demonstrating the bug.&lt;/p&gt;

&lt;p&gt;The problem is that if you have, for example &quot;the lucene.solr&quot;, where &quot;the&quot; is a stopword, the Solr 1.4 WordDelimiter bumps the position increment of &lt;b&gt;both&lt;/b&gt; &quot;lucene&quot; and &quot;solr&quot; tokens:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;lucene (posInc=2)&lt;/li&gt;
	&lt;li&gt;solr (posInc=2)&lt;/li&gt;
	&lt;li&gt;lucenesolr (posInc=0)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Instead it should look like:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;lucene (posInc=2)&lt;/li&gt;
	&lt;li&gt;solr (posInc=1)&lt;/li&gt;
	&lt;li&gt;lucenesolr (posInc=0)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In my opinion the behavior of trunk is correct, and this is a bug. &lt;br/&gt;
But I don&apos;t know how to fix just Solr 1.4&apos;s WDF in a better way than dropping in the entire rewritten WDF...&lt;/p&gt;</comment>
                            <comment id="12852216" author="rcmuir" created="Thu, 1 Apr 2010 01:36:43 +0000"  >&lt;p&gt;I&apos;m afraid of WDF, but I don&apos;t think I am the only one, and I think it would be good to fix this bug.&lt;/p&gt;

&lt;p&gt;If no one objects, I&apos;d like to commit these patches (testcase and backport the trunk filter) to the 1.5 branch in a few days.&lt;/p&gt;
</comment>
                            <comment id="12852233" author="pwolanin" created="Thu, 1 Apr 2010 03:12:52 +0000"  >&lt;p&gt;I&apos;m confused by that comment - I thought this code is already in 1.5/trunk and the issue is backporting to the 1.4 branch?&lt;/p&gt;</comment>
                            <comment id="12852234" author="rcmuir" created="Thu, 1 Apr 2010 03:17:55 +0000"  >&lt;p&gt;Peter it is... but admittedly it has not been in trunk for very long, and WDF is pretty complex.&lt;/p&gt;

&lt;p&gt;It&apos;s a bit scary to backport a rewrite of it for this reason, but at the same time, we&apos;ve got this bug &lt;br/&gt;
and the other config bugs found in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1706&quot; title=&quot;wrong tokens output from WordDelimiterFilter depending upon options&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1706&quot;&gt;&lt;del&gt;SOLR-1706&lt;/del&gt;&lt;/a&gt;, so I think its the right thing to do... &lt;/p&gt;</comment>
                            <comment id="12852811" author="rcmuir" created="Fri, 2 Apr 2010 13:19:58 +0000"  >&lt;p&gt;Committed the test to trunk: revision 930262.&lt;/p&gt;</comment>
                            <comment id="12870624" author="pwolanin" created="Mon, 24 May 2010 14:59:44 +0000"  >&lt;p&gt;now this has been in trunk longer, do you feel any more confident about a back port?&lt;/p&gt;</comment>
                            <comment id="12870628" author="rcmuir" created="Mon, 24 May 2010 15:05:40 +0000"  >&lt;blockquote&gt;&lt;p&gt;now this has been in trunk longer, do you feel any more confident about a back port?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I feel more confident about the new implementation of WordDelimiterFilter, yes.&lt;/p&gt;

&lt;p&gt;I suppose the question here is if the 1.5 branch is dead or not (no one seems to commit to it)&lt;/p&gt;</comment>
                            <comment id="12870631" author="rcmuir" created="Mon, 24 May 2010 15:09:06 +0000"  >&lt;p&gt;Also, Mark mentioned to me he had concerns about &apos;index back-compat&apos;.&lt;/p&gt;

&lt;p&gt;Obviously, if we fix the bug, we &apos;break&apos; this in the sense that you now index with correct positions...&lt;/p&gt;</comment>
                            <comment id="12871123" author="pwolanin" created="Tue, 25 May 2010 12:56:28 +0000"  >&lt;p&gt;I&apos;m thinking about 1.4 backporting - not sure what&apos;s happening with 1.5&lt;/p&gt;

&lt;p&gt;Yes, you&apos;d have to re-index if we have to backport to 1.4, but I assume that&apos;s only going to affect documents that would currently have broken searches?&lt;/p&gt;</comment>
                            <comment id="12873454" author="rcmuir" created="Sun, 30 May 2010 16:41:19 +0000"  >&lt;p&gt;I am willing to do the backport here if people want this in 1.4.1, just let me know.&lt;/p&gt;</comment>
                            <comment id="12873461" author="pwolanin" created="Sun, 30 May 2010 17:31:06 +0000"  >&lt;p&gt;&lt;br/&gt;
Yes, I&apos;d propose to have this in 1.4.1 since it&apos;s a pretty serious bug in the places where it manifests.&lt;/p&gt;</comment>
                            <comment id="12874399" author="rcmuir" created="Wed, 2 Jun 2010 03:35:50 +0000"  >&lt;p&gt;here is the patch for solr 1.4. This also fixes &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1706&quot; title=&quot;wrong tokens output from WordDelimiterFilter depending upon options&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1706&quot;&gt;&lt;del&gt;SOLR-1706&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="12874727" author="rcmuir" created="Wed, 2 Jun 2010 18:35:48 +0000"  >&lt;p&gt;Committed revision 950711. Thanks Peter!&lt;/p&gt;</comment>
                            <comment id="12910287" author="mbennett" created="Thu, 16 Sep 2010 19:59:40 +0000"  >&lt;p&gt;I realize this is closed, but I found a workaround for those who are still working with a pre-fix version.&lt;/p&gt;

&lt;p&gt;Just put the stopwords filter after the Word Delimiter filter. That worked for us without impacting much else, until we can get over to the new version.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12439994" name="SOLR-1852.patch" size="52704" author="pwolanin" created="Sat, 27 Mar 2010 23:36:21 +0000"/>
                            <attachment id="12446096" name="SOLR-1852_solr14branch.patch" size="55449" author="rcmuir" created="Wed, 2 Jun 2010 03:35:50 +0000"/>
                            <attachment id="12440009" name="SOLR-1852_testcase.patch" size="1979" author="rcmuir" created="Sun, 28 Mar 2010 13:03:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5614</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 years, 10 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03oan:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19369</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>