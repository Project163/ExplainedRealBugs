<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:39:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-13672] Admin UI/ZK Status page: Zookeeper 3.5 : 4lw.commands.whitellist error</title>
                <link>https://issues.apache.org/jira/browse/SOLR-13672</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;After upgrading to Solr 8.2 and Zookeeper 3.5.5 one sees the following error in the Admin UI / Cloud / ZkStatus: &lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#222222&quot;&gt;*&quot;Errors: - membership: Check 4lw.commands.whitelist setting in zookeeper&lt;/font&gt;&lt;br/&gt;
 &lt;font color=&quot;#222222&quot;&gt;configuration file.&quot;*&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#222222&quot;&gt;Aside of the UI, the Solr Cloud nodes seem to work perfectly normal.&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#222222&quot;&gt;This issue only occurs with ZooKeeper ensembles. It does not appear if one Zookeeper standalone instance is used.&lt;/font&gt;&lt;/p&gt;

&lt;p&gt;&lt;font color=&quot;#222222&quot;&gt;We tried the 4lw.commands.whitelist with wildcard * and &quot;mntr,conf,ruok&quot; (with and without spaces).&lt;/font&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13248399">SOLR-13672</key>
            <summary>Admin UI/ZK Status page: Zookeeper 3.5 : 4lw.commands.whitellist error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="janhoy">Jan H&#248;ydahl</assignee>
                                    <reporter username="jornfranke">J&#246;rn Franke</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Aug 2019 18:23:47 +0000</created>
                <updated>Tue, 21 Jan 2020 16:58:28 +0000</updated>
                            <resolved>Wed, 7 Aug 2019 08:03:25 +0000</resolved>
                                    <version>8.2</version>
                                    <fixVersion>8.3</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16898708" author="janhoy" created="Fri, 2 Aug 2019 08:48:49 +0000"  >&lt;p&gt;Ok, I reproduced it here. Apparently 3.5.5 has some new format of the response in `conf` 4lw command, e.g.:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;clientPort=2181
secureClientPort=-1
dataDir=/data/version-2
dataDirSize=201326640
dataLogDir=/datalog/version-2
dataLogSize=582
tickTime=2000
maxClientCnxns=60
minSessionTimeout=4000
maxSessionTimeout=40000
serverId=1
initLimit=5
syncLimit=2
electionAlg=3
electionPort=3888
quorumPort=2888
peerType=0
membership: 
server.1=zoo1:2888:3888:participant;0.0.0.0:2181
server.2=zoo2:2888:3888:participant;0.0.0.0:2181
server.3=zoo3:2888:3888:participant;0.0.0.0:2181
version=0Connection closed by foreign host.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Obviously the parsing logic expects strictly &lt;tt&gt;key=value&lt;/tt&gt; for each line, but there is a line here that is only &lt;tt&gt;membership:&lt;/tt&gt; which I believe causes some parsing error in &lt;tt&gt;ZookeeperStatusHandler&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="16898853" author="elyograg" created="Fri, 2 Aug 2019 12:32:52 +0000"  >&lt;p&gt;I think I would call this a bug in ZK.  But since getting a fix from them could take a long time, we need to tackle this in Solr.&lt;/p&gt;

&lt;p&gt;There are probably two ways to handle this.  1) Look for the = separator, and if not found, use the : separator.  2) Treat the conf output as a .properties file and let Java parse it for us.&lt;/p&gt;

&lt;p&gt;I&apos;m attaching a patch that takes the first approach.&lt;/p&gt;</comment>
                            <comment id="16898913" author="janhoy" created="Fri, 2 Aug 2019 14:07:55 +0000"  >&lt;p&gt;Sorry, did not see your patch since I was working on PR&#160;&lt;a href=&quot;https://github.com/apache/lucene-solr/pull/818&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;GitHub Pull Request #818&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The &quot;membership: &quot; line looks like a header line for the server.N lines that follows. Or it could possibly be that is is supposed to have a value and they used wrong separator. Anyway, my PR explicitly skip that line and print warnings for other unknown/malformed lines found in the future.&lt;/p&gt;

&lt;p&gt;I decided to also make visible a few of the new configs in the UI. Here&apos;s how the page now looks like if it finds two good zk servers and one which is not configured with whitelist:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12976536/12976536_zk-status.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="16898980" author="elyograg" created="Fri, 2 Aug 2019 15:24:54 +0000"  >&lt;p&gt;I checked the ZK server code for parsing a config file. That code treats it as a properties file.  We might want to do the same.&lt;/p&gt;</comment>
                            <comment id="16898983" author="elyograg" created="Fri, 2 Aug 2019 15:27:13 +0000"  >&lt;p&gt;I was just noticing in the screenshot that our error message says the problem was with the &apos;ruok&apos; command.  If it&apos;s actually the &apos;conf&apos; command that&apos;s failing, maybe the error message needs a little improving.&lt;/p&gt;</comment>
                            <comment id="16899173" author="janhoy" created="Fri, 2 Aug 2019 19:53:19 +0000"  >&lt;p&gt;The screenshot shows another error where whitelist is not configured for one of the zk hosts. The ruok command is the first we try so when it fails we fail the whole host.&lt;br/&gt;
We now explicitly skip the &#8216;membership:&#8221; line.&lt;br/&gt;
We are not parsing a config file but text response from a socket call. It&#8217;s a mess, some commands respond with tab separated lines, other with = separated &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16899184" author="jornfranke" created="Fri, 2 Aug 2019 20:17:22 +0000"  >&lt;p&gt;thanks for the quick check, I was about to send the ZK information when you already commented the issue&lt;/p&gt;</comment>
                            <comment id="16899263" author="janhoy" created="Fri, 2 Aug 2019 23:04:35 +0000"  >&lt;p&gt;PR reviews welcome. Hope to merge next week.&lt;/p&gt;

&lt;p&gt;PS. There&#8217;s an email thread on zk list about why that membership: line exists, may perhaps lead to a ZK Jira, but anyway, the parsing logic is now more robust. Earlier we aborted everything if a line did not have a separator, now we instead log it but continue.&lt;/p&gt;</comment>
                            <comment id="16901798" author="jira-bot" created="Wed, 7 Aug 2019 07:10:48 +0000"  >&lt;p&gt;Commit 1123afae94f36027bcb7b2dc40b089653ed4d1c8 in lucene-solr&apos;s branch refs/heads/master from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=1123afa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=1123afa&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13672&quot; title=&quot;Admin UI/ZK Status page: Zookeeper 3.5 : 4lw.commands.whitellist error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13672&quot;&gt;&lt;del&gt;SOLR-13672&lt;/del&gt;&lt;/a&gt;: Cloud -&amp;gt; Zk Status page now parses response from Zookeeper 3.5.5 correctly&lt;/p&gt;</comment>
                            <comment id="16901799" author="jira-bot" created="Wed, 7 Aug 2019 07:10:50 +0000"  >&lt;p&gt;Commit 64884be0444e3ed7ae2a0adce2689b03da934188 in lucene-solr&apos;s branch refs/heads/master from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=64884be&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=64884be&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13672&quot; title=&quot;Admin UI/ZK Status page: Zookeeper 3.5 : 4lw.commands.whitellist error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13672&quot;&gt;&lt;del&gt;SOLR-13672&lt;/del&gt;&lt;/a&gt;: Zk Status page now parses response from Zookeeper 3.5.5 correctly (#818)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13672&quot; title=&quot;Admin UI/ZK Status page: Zookeeper 3.5 : 4lw.commands.whitellist error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13672&quot;&gt;&lt;del&gt;SOLR-13672&lt;/del&gt;&lt;/a&gt;: Cloud -&amp;gt; Zk Status page now parses response from Zookeeper 3.5.5 correctly&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16901800" author="jira-bot" created="Wed, 7 Aug 2019 07:10:50 +0000"  >&lt;p&gt;Commit 64884be0444e3ed7ae2a0adce2689b03da934188 in lucene-solr&apos;s branch refs/heads/master from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=64884be&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=64884be&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13672&quot; title=&quot;Admin UI/ZK Status page: Zookeeper 3.5 : 4lw.commands.whitellist error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13672&quot;&gt;&lt;del&gt;SOLR-13672&lt;/del&gt;&lt;/a&gt;: Zk Status page now parses response from Zookeeper 3.5.5 correctly (#818)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13672&quot; title=&quot;Admin UI/ZK Status page: Zookeeper 3.5 : 4lw.commands.whitellist error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13672&quot;&gt;&lt;del&gt;SOLR-13672&lt;/del&gt;&lt;/a&gt;: Cloud -&amp;gt; Zk Status page now parses response from Zookeeper 3.5.5 correctly&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16901804" author="janhoy" created="Wed, 7 Aug 2019 07:21:34 +0000"  >&lt;p&gt;Merged to Master. Used the GitHub UI and the intention was to squash merge but appears that all individual commits were merged, sorry for the noise.&lt;/p&gt;</comment>
                            <comment id="16901852" author="jira-bot" created="Wed, 7 Aug 2019 08:03:10 +0000"  >&lt;p&gt;Commit f853198f72f802611c3e0ee8882cdd6a80a818aa in lucene-solr&apos;s branch refs/heads/branch_8x from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=f853198&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=f853198&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13672&quot; title=&quot;Admin UI/ZK Status page: Zookeeper 3.5 : 4lw.commands.whitellist error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13672&quot;&gt;&lt;del&gt;SOLR-13672&lt;/del&gt;&lt;/a&gt;: Cloud -&amp;gt; Zk Status page now parses response from Zookeeper 3.5.5 correctly&lt;/p&gt;

&lt;p&gt;(Back ported from 8 commits on master branch)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13251044">ZOOKEEPER-3511</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12976525" name="SOLR-13672.patch" size="839" author="elyograg" created="Fri, 2 Aug 2019 12:33:16 +0000"/>
                            <attachment id="12976536" name="zk-status.png" size="83720" author="janhoy" created="Fri, 2 Aug 2019 14:07:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z05928:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>