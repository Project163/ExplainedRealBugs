<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:36:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4234] Add support for binary files in ZooKeeper.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4234</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I was attempting to get the ShowFileHandler to show a .png file, and it was failing.  But in non-ZK mode it worked just fine!   It took a while, but it seems that we upload to zk as a text, and download as well.  I&apos;ve attached a unit test that demonstrates the problem, and a fix.  You have to have a binary file in the conf directory to make the test work, I put solr.png in the collection1/conf/velocity directory.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12625292">SOLR-4234</key>
            <summary>Add support for binary files in ZooKeeper.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="epugh">Eric Pugh</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Dec 2012 22:19:43 +0000</created>
                <updated>Mon, 9 May 2016 18:48:25 +0000</updated>
                            <resolved>Wed, 22 May 2013 16:52:36 +0000</resolved>
                                    <version>4.0</version>
                                    <fixVersion>4.4</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13539717" author="epugh" created="Wed, 26 Dec 2012 22:21:23 +0000"  >&lt;p&gt;Testcase and patch for binary files in ZK.&lt;/p&gt;</comment>
                            <comment id="13539727" author="epugh" created="Wed, 26 Dec 2012 22:41:20 +0000"  >&lt;p&gt;This is the patch to allow the ShowFileHandler to take binaries.&lt;/p&gt;</comment>
                            <comment id="13539728" author="epugh" created="Wed, 26 Dec 2012 22:42:00 +0000"  >&lt;p&gt;Without this patch, a request like this would fail: &lt;a href=&quot;http://localhost:8983/solr/my_search_core_shard1_replica1/admin/file?file=/velocity/header.png&amp;amp;contentType=image/png&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/my_search_core_shard1_replica1/admin/file?file=/velocity/header.png&amp;amp;contentType=image/png&lt;/a&gt;   &lt;/p&gt;</comment>
                            <comment id="13539870" author="ehatcher" created="Thu, 27 Dec 2012 08:50:16 +0000"  >&lt;p&gt;lol - while I like /admin/file and of course mixing and matching it with the VelocityResponseWriter, I cringe at ZK serving up favicons.&lt;/p&gt;

&lt;p&gt;But hey, better that it works for binary files than didn&apos;t, so +1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;One minor issue with the patch is the incorrect javadoc added to the ByteArrayStream ctor &quot;Construct a &amp;lt;code&amp;gt;ContentStream&amp;lt;/code&amp;gt; from a &amp;lt;code&amp;gt;File&amp;lt;/code&amp;gt;&quot;, so let&apos;s get that correct.&lt;/p&gt;</comment>
                            <comment id="13543245" author="epugh" created="Thu, 3 Jan 2013 20:18:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ehatcher&quot; class=&quot;user-hover&quot; rel=&quot;ehatcher&quot;&gt;ehatcher&lt;/a&gt;, are there any other changes needed to be made?  And one nice thing about fixing the upload aspect of ZKCli, is that we can potentially load jar files from a Solr Core (./core/lib/myjar.jar), which is something that only non ZK mode works with.   Right now, the ZKCli munges up the binary jar file when you upload to ZK.  &lt;/p&gt;</comment>
                            <comment id="13546527" author="markrmiller@gmail.com" created="Tue, 8 Jan 2013 02:11:48 +0000"  >&lt;p&gt;Hey Eric - do you think there will be an issue with back compat here?&lt;/p&gt;</comment>
                            <comment id="13546847" author="epugh" created="Tue, 8 Jan 2013 12:59:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; you mean if I have already loaded data using the String method into ZK, swapping to bytes will cause issues?   &lt;/p&gt;

&lt;p&gt;I&apos;ll go ahead and test that today by hand, and let you know.  Do you think I need to craft a unit test that loads solrconfig as strings, and then uses the new byte approach?   &lt;/p&gt;</comment>
                            <comment id="13546886" author="markrmiller@gmail.com" created="Tue, 8 Jan 2013 13:38:56 +0000"  >&lt;p&gt;Yeah, my main concern is that 4.0 cloud users will have trouble reading info from zk with 4.1. I&apos;m not sure we necessarily need a unit test, but at least a verification that people can easily upgrade if we put this in.&lt;/p&gt;</comment>
                            <comment id="13553186" author="epugh" created="Mon, 14 Jan 2013 22:11:01 +0000"  >&lt;p&gt;Consolidated patch file, with ZkCLI, ShowFileRequestHandler, and demoing using Velocity /browse interface.&lt;/p&gt;</comment>
                            <comment id="13553188" author="epugh" created="Mon, 14 Jan 2013 22:11:51 +0000"  >&lt;p&gt;This solr.png is a copy of the main one, and needs to go in the /collection1/conf/velocity directory.&lt;/p&gt;</comment>
                            <comment id="13553190" author="epugh" created="Mon, 14 Jan 2013 22:13:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; Okay, I&apos;ve gone through on Trunk and 4.x and tested out first loading the configuration files into ZooKeeper as UTF-8 String, and then doing it as bytes[] and everything DOES WORK!&lt;br/&gt;
I have consolidated the patch into a single SOLR4234_binary_files.patch, but you do need to add solr.png to the /velocity directory.  &lt;/p&gt;</comment>
                            <comment id="13553302" author="markrmiller@gmail.com" created="Tue, 15 Jan 2013 00:07:22 +0000"  >&lt;p&gt;Hey Eric, I&quot;m seeing the following tests fail:&lt;/p&gt;

&lt;p&gt;java.lang.AssertionError: Make sure we did download each file in the original configuration&lt;br/&gt;
	at __randomizedtesting.SeedInfo.seed(&lt;span class=&quot;error&quot;&gt;&amp;#91;BB2B109CDBABDCE7:9F4DBD9251646A81&amp;#93;&lt;/span&gt;:0)&lt;br/&gt;
	at org.junit.Assert.fail(Assert.java:93)&lt;br/&gt;
	at org.junit.Assert.assertTrue(Assert.java:43)&lt;br/&gt;
	at org.apache.solr.cloud.ZkCLITest.testUpConfigLinkConfigClearZk(ZkCLITest.java:182)&lt;/p&gt;
</comment>
                            <comment id="13554113" author="ehatcher" created="Tue, 15 Jan 2013 18:39:57 +0000"  >&lt;p&gt;I&apos;m not a fan of this change: &lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Index: example/solr/collection1/conf/velocity/header.vm&lt;br/&gt;
===================================================================&lt;br/&gt;
&amp;#8212; example/solr/collection1/conf/velocity/header.vm	(revision 1433108)&lt;br/&gt;
+++ example/solr/collection1/conf/velocity/header.vm	(working copy)&lt;br/&gt;
@@ -1,3 +1,3 @@&lt;br/&gt;
 &amp;lt;div id=&quot;head&quot;&amp;gt;&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;lt;span &amp;gt;&amp;lt;a href=&quot;#url_for_home#if($request.params.get(&apos;debugQuery&apos;))?debugQuery=true#end&quot;&amp;gt;&amp;lt;img src=&quot;#
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {url_root}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;/img/solr.png&quot; id=&quot;logo&quot;/&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/span&amp;gt;&lt;br/&gt;
+  &amp;lt;span &amp;gt;&amp;lt;a href=&quot;#url_for_home#if($request.params.get(&apos;debugQuery&apos;))?debugQuery=true#end&quot;&amp;gt;&amp;lt;img src=&quot;#&lt;/p&gt;
&lt;div class=&quot;error&quot;&gt;&lt;span class=&quot;error&quot;&gt;Unknown macro: {url_for_solr}&lt;/span&gt; &lt;/div&gt;
&lt;p&gt;/admin/file?file=/velocity/solr.png&amp;amp;contentType=image/png&quot; id=&quot;logo&quot;/&amp;gt;&amp;lt;/a&amp;gt;&amp;lt;/span&amp;gt;&lt;br/&gt;
 &amp;lt;/div&amp;gt;&lt;/p&gt;&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;This means that solr.png needs to be duplicated into every core&apos;s configuration rather than coming from the Solr web app itself.  I get this as an example of serving a binary file from ZK, but let&apos;s not bake it into the collection1 example like this.  &lt;/p&gt;</comment>
                            <comment id="13554541" author="steve_rowe" created="Tue, 15 Jan 2013 23:54:42 +0000"  >&lt;p&gt;Mark, Erik, Eric: can we push this to 4.2?&lt;/p&gt;</comment>
                            <comment id="13555197" author="epugh" created="Wed, 16 Jan 2013 16:53:27 +0000"  >&lt;p&gt;This isn&apos;t worth delaying a release!   I am somewhat struggling to figure out why the test is failing.  Going to try on a new code checkout.&lt;/p&gt;</comment>
                            <comment id="13564022" author="markrmiller@gmail.com" created="Mon, 28 Jan 2013 03:47:21 +0000"  >&lt;p&gt;Let me know if you make any progress Eric - I&apos;d like this to make 4.2.&lt;/p&gt;</comment>
                            <comment id="13595318" author="markrmiller@gmail.com" created="Thu, 7 Mar 2013 00:07:29 +0000"  >&lt;p&gt;Ping - still interested in this Eric? I&apos;ll get to it eventually anyway, but it may take a little longer.&lt;/p&gt;</comment>
                            <comment id="13655696" author="commit-tag-bot" created="Mon, 13 May 2013 00:30:27 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; markrmiller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1481675&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1481675&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4234&quot; title=&quot;Add support for binary files in ZooKeeper.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4234&quot;&gt;&lt;del&gt;SOLR-4234&lt;/del&gt;&lt;/a&gt;: Add support for binary files in ZooKeeper.&lt;/p&gt;</comment>
                            <comment id="13655697" author="commit-tag-bot" created="Mon, 13 May 2013 00:35:11 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; markrmiller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1481676&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1481676&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4234&quot; title=&quot;Add support for binary files in ZooKeeper.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4234&quot;&gt;&lt;del&gt;SOLR-4234&lt;/del&gt;&lt;/a&gt;: Add support for binary files in ZooKeeper.&lt;/p&gt;</comment>
                            <comment id="13664248" author="markrmiller@gmail.com" created="Wed, 22 May 2013 16:52:36 +0000"  >&lt;p&gt;This is done.&lt;/p&gt;</comment>
                            <comment id="13716821" author="steve_rowe" created="Tue, 23 Jul 2013 18:38:41 +0000"  >&lt;p&gt;Bulk close resolved 4.4 issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12564788" name="SOLR4234_binary_files.patch" size="6721" author="epugh" created="Mon, 14 Jan 2013 22:11:01 +0000"/>
                            <attachment id="12562412" name="binary_upload_download.patch" size="4278" author="epugh" created="Wed, 26 Dec 2012 22:21:23 +0000"/>
                            <attachment id="12562415" name="fix_show_file_handler_with_binaries.patch" size="1916" author="epugh" created="Wed, 26 Dec 2012 22:41:20 +0000"/>
                            <attachment id="12564789" name="solr.png" size="7926" author="epugh" created="Mon, 14 Jan 2013 22:11:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>301834</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16wuv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>248455</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>