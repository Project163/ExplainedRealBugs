<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:11:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-17421] With overseer node role enabled, overseer may be stopped without giving-up leadership</title>
                <link>https://issues.apache.org/jira/browse/SOLR-17421</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Overseer may retain the leadership status while the thread pool that is supposed to consume the collection state mutator queue was already shut down.&lt;/p&gt;

&lt;p&gt;Occurrences of this but are probably not frequent. But when it happens, it has a huge impact. The overseer cluster state updater is stuck and all collection admin requests are very likely to fail. Because of the stuck overseer, all the enqueued operations (collection creation, deletion...) fail and remain in the collection API queue.&lt;/p&gt;
&lt;h2&gt;&lt;a name=&quot;Rootcause&quot;&gt;&lt;/a&gt;Root cause&lt;/h2&gt;

&lt;p&gt;Root cause is the &lt;tt&gt;QUIT&lt;/tt&gt; command does not cancel overseer election if any error happens while shutting down the state updater thread pool.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
level:  ERROR
    logger:  org.apache.solr.cloud.Overseer
    message:  Overseer could not process the current clusterstate state update message, skipping the message: {
&lt;span class=&quot;code-quote&quot;&gt;&quot;operation&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;quit&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;72073405485023239-&amp;lt;host&amp;gt;_solr-n_0000000948&quot;&lt;/span&gt;}
    node_name:  &amp;lt;host&amp;gt;:8983_solr
    threadId:  281272
    threadName:  OverseerStateUpdate-72073405485023239-&amp;lt;host&amp;gt;_solr-n_0000000948
    thrown:  java.lang.RuntimeException: Timeout waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; pool org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor@2c1da18d[Shutting down, pool size = 1, active threads = 1, queued tasks = 0, completed tasks = 0] to shutdown.
at org.apache.solr.common.util.ExecutorUtil.awaitTermination(ExecutorUtil.java:142)
at org.apache.solr.common.util.ExecutorUtil.awaitTermination(ExecutorUtil.java:129)
at org.apache.solr.common.util.ExecutorUtil.shutdownAndAwaitTermination(ExecutorUtil.java:112)
at org.apache.solr.cloud.OverseerTaskProcessor.close(OverseerTaskProcessor.java:431)
at org.apache.solr.cloud.Overseer$ClusterStateUpdater.processMessage(Overseer.java:601)
at org.apache.solr.cloud.Overseer$ClusterStateUpdater.processQueueItem(Overseer.java:450)
at org.apache.solr.cloud.Overseer$ClusterStateUpdater.run(Overseer.java:377)
at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:1583)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;h2&gt;&lt;a name=&quot;Proximatecause&quot;&gt;&lt;/a&gt;Proximate cause&lt;/h2&gt;

&lt;p&gt;It seems to me long running operations in the collection API could trigger the bug more frequently. Because of a long running operation, we get an exception when shutting down the thread pool. This has a 60 seconds timeout.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13589893">SOLR-17421</key>
            <summary>With overseer node role enabled, overseer may be stopped without giving-up leadership</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="pierre.salagnac">Pierre Salagnac</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 23 Aug 2024 15:42:50 +0000</created>
                <updated>Tue, 28 Jan 2025 22:17:54 +0000</updated>
                            <resolved>Wed, 28 Aug 2024 02:44:25 +0000</resolved>
                                    <version>8.11</version>
                    <version>9.6</version>
                                    <fixVersion>9.8</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17877229" author="jira-bot" created="Wed, 28 Aug 2024 02:03:16 +0000"  >&lt;p&gt;Commit 8513516ed39dd3190786aa93bdbe02e608ff7d9d in solr&apos;s branch refs/heads/main from Pierre Salagnac&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=8513516ed39&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=8513516ed39&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17421&quot; title=&quot;With overseer node role enabled, overseer may be stopped without giving-up leadership&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17421&quot;&gt;&lt;del&gt;SOLR-17421&lt;/del&gt;&lt;/a&gt;: Make sure overseer drops leadership after QUIT failure (#2663)&lt;/p&gt;

&lt;p&gt;Overseer might be stopped after a failure of the QUIT operation if we don&apos;t give up on leadership.&lt;br/&gt;
At least, this happens if we get a timeout error when closing the thread pool for cluster state updater.  There might be other scenarios.&lt;/p&gt;</comment>
                            <comment id="17877230" author="jira-bot" created="Wed, 28 Aug 2024 02:07:28 +0000"  >&lt;p&gt;Commit 90eeda25825327d58700840d8e8bb48b7d16f39d in solr&apos;s branch refs/heads/branch_9x from Pierre Salagnac&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=90eeda25825&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=90eeda25825&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17421&quot; title=&quot;With overseer node role enabled, overseer may be stopped without giving-up leadership&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17421&quot;&gt;&lt;del&gt;SOLR-17421&lt;/del&gt;&lt;/a&gt;: Make sure overseer drops leadership after QUIT failure (#2663)&lt;/p&gt;

&lt;p&gt;Overseer might be stopped after a failure of the QUIT operation if we don&apos;t give up on leadership.&lt;br/&gt;
At least, this happens if we get a timeout error when closing the thread pool for cluster state updater.  There might be other scenarios.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 8513516ed39dd3190786aa93bdbe02e608ff7d9d)&lt;/p&gt;</comment>
                            <comment id="17877233" author="dsmiley" created="Wed, 28 Aug 2024 02:44:25 +0000"  >&lt;p&gt;Merged.&lt;/p&gt;

&lt;p&gt;Thanks for contributing!&lt;/p&gt;</comment>
                            <comment id="17921947" author="anshumg" created="Tue, 28 Jan 2025 22:17:54 +0000"  >&lt;p&gt;Closing after the 9.8.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            41 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1r1gg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>