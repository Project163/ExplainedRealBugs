<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:48:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5875] QueryComponent.mergeIds() unmarshals all docs&apos; sort field values once per doc instead of once per shard</title>
                <link>https://issues.apache.org/jira/browse/SOLR-5875</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5354&quot; title=&quot;Distributed sort is broken with CUSTOM FieldType&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5354&quot;&gt;&lt;del&gt;SOLR-5354&lt;/del&gt;&lt;/a&gt; added unmarshalling of distributed sort field values in &lt;tt&gt;QueryComponent.mergeIds()&lt;/tt&gt;, but incorrectly performs this (unmarshalling all docs&apos; sort field values) for every doc, and stores the result with each doc.  This is unnecessary, inefficient, and extremely wasteful of memory.&lt;/p&gt;

&lt;p&gt;In an offline conversation, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alexey&quot; class=&quot;user-hover&quot; rel=&quot;alexey&quot;&gt;alexey&lt;/a&gt; described the issue to me and located the likely problem, and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman_lucene%40fucit.org&quot; class=&quot;user-hover&quot; rel=&quot;hossman_lucene@fucit.org&quot;&gt;hossman_lucene@fucit.org&lt;/a&gt; located the problem code via inspection.&lt;/p&gt;

&lt;p&gt;This bug is very likely the problem described on the solr-user mailing list here: &lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/lucene-solr-user/201403.mbox/%3c83f549bdf8deecbc7567c324ee0cb91f@cluster38.e-active.nl%3e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;SolrCloud constantly crashes after upgrading to Solr 4.7&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12701913">SOLR-5875</key>
            <summary>QueryComponent.mergeIds() unmarshals all docs&apos; sort field values once per doc instead of once per shard</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sarowe">Steven Rowe</assignee>
                                    <reporter username="sarowe">Steven Rowe</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Mar 2014 15:05:22 +0000</created>
                <updated>Wed, 30 Oct 2019 17:49:05 +0000</updated>
                            <resolved>Mon, 17 Mar 2014 15:31:16 +0000</resolved>
                                    <version>4.7</version>
                                    <fixVersion>4.7.1</fixVersion>
                    <fixVersion>4.8</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13937899" author="steve_rowe" created="Mon, 17 Mar 2014 15:08:02 +0000"  >&lt;p&gt;Simple patch with fix.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alexey.serba&quot; class=&quot;user-hover&quot; rel=&quot;alexey.serba&quot;&gt;alexey.serba&lt;/a&gt; has confirmed that this solved the excessive memory use issue he saw.&lt;/p&gt;

&lt;p&gt;Committing shortly.&lt;/p&gt;</comment>
                            <comment id="13937915" author="jira-bot" created="Mon, 17 Mar 2014 15:24:55 +0000"  >&lt;p&gt;Commit 1578434 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1578434&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1578434&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5875&quot; title=&quot;QueryComponent.mergeIds() unmarshals all docs&amp;#39; sort field values once per doc instead of once per shard&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5875&quot;&gt;&lt;del&gt;SOLR-5875&lt;/del&gt;&lt;/a&gt;: QueryComponent.mergeIds() unmarshals all docs&apos; sort field values once per doc instead of once per shard.&lt;/p&gt;</comment>
                            <comment id="13937917" author="jira-bot" created="Mon, 17 Mar 2014 15:26:37 +0000"  >&lt;p&gt;Commit 1578435 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1578435&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1578435&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5875&quot; title=&quot;QueryComponent.mergeIds() unmarshals all docs&amp;#39; sort field values once per doc instead of once per shard&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5875&quot;&gt;&lt;del&gt;SOLR-5875&lt;/del&gt;&lt;/a&gt;: QueryComponent.mergeIds() unmarshals all docs&apos; sort field values once per doc instead of once per shard. (merged trunk r1578434)&lt;/p&gt;</comment>
                            <comment id="13937920" author="jira-bot" created="Mon, 17 Mar 2014 15:30:26 +0000"  >&lt;p&gt;Commit 1578438 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_4_7&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1578438&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1578438&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5875&quot; title=&quot;QueryComponent.mergeIds() unmarshals all docs&amp;#39; sort field values once per doc instead of once per shard&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5875&quot;&gt;&lt;del&gt;SOLR-5875&lt;/del&gt;&lt;/a&gt;: QueryComponent.mergeIds() unmarshals all docs&apos; sort field values once per doc instead of once per shard. (merged trunk r1578434)&lt;/p&gt;</comment>
                            <comment id="13937922" author="steve_rowe" created="Mon, 17 Mar 2014 15:31:16 +0000"  >&lt;p&gt;Committed to trunk, branch_4x and the lucene_solr_4_7 branch.&lt;/p&gt;</comment>
                            <comment id="13937946" author="erickerickson" created="Mon, 17 Mar 2014 15:59:57 +0000"  >&lt;p&gt;Hmmm, is it possible to have the original person who posted the problem give it a test run? For something like this it&apos;d be good to have some proof that if fixes the problem described.&lt;/p&gt;

&lt;p&gt;Just a thought.&lt;/p&gt;

&lt;p&gt;Erick&lt;/p&gt;</comment>
                            <comment id="13937953" author="steve_rowe" created="Mon, 17 Mar 2014 16:04:24 +0000"  >&lt;p&gt;Erick, as I mentioned above, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alexey.serba&quot; class=&quot;user-hover&quot; rel=&quot;alexey.serba&quot;&gt;alexey.serba&lt;/a&gt; gave it a test run and it fixed the memory issue he saw.&lt;/p&gt;</comment>
                            <comment id="13957749" author="steve_rowe" created="Wed, 2 Apr 2014 15:03:39 +0000"  >&lt;p&gt;Bulk close 4.7.1 issues&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12674031">SOLR-5354</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12635091" name="SOLR-5875.patch" size="1044" author="sarowe" created="Mon, 17 Mar 2014 15:08:02 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>380253</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 33 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1tinb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>380536</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>