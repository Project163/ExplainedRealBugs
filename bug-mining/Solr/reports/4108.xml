<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:36:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-12514] Rule-base Authorization plugin skips authorization if querying node does not have collection replica</title>
                <link>https://issues.apache.org/jira/browse/SOLR-12514</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Solr serves client requests going throught 3 steps - init(), authorize() and handle-request (&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/releases/lucene-solr/7.3.1/solr/core/src/java/org/apache/solr/servlet/HttpSolrCall.java#L471&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;link git-link&lt;/a&gt;).&lt;br/&gt;
 init() initializes all required information to be used by authorize(). init() skips initializing if request is to be served remotely, which leads to skipping authorization step (&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/releases/lucene-solr/7.3.1/solr/core/src/java/org/apache/solr/servlet/HttpSolrCall.java#L291&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;link git-link&lt;/a&gt;).&lt;br/&gt;
 init() relies on &apos;cores&apos; object which only has information of local node (which is perfect as per design). It should actually be getting security information (security.json) from zookeeper, which has global view of the cluster.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Example:&lt;br/&gt;
SolrCloud setup consists of 2 nodes (solr-7.3.1):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-javascript&quot;&gt;
live_nodes: [
 &lt;span class=&quot;code-quote&quot;&gt;&quot;localhost:8983_solr&quot;&lt;/span&gt;,
 &lt;span class=&quot;code-quote&quot;&gt;&quot;localhost:8984_solr&quot;&lt;/span&gt;,
]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Two collections are created - &apos;collection-rf-1&apos; with RF=1 and &apos;collection-rf-2&apos; with RF=2.&lt;/p&gt;

&lt;p&gt;Two users are created - &apos;collection-rf-1-user&apos; and &apos;collection-rf-2-user&apos;.&lt;/p&gt;

&lt;p&gt;Security configuration is as below (security.json attached):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-javascript&quot;&gt;
&lt;span class=&quot;code-quote&quot;&gt;&quot;authorization&quot;&lt;/span&gt;:{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.RuleBasedAuthorizationPlugin&quot;&lt;/span&gt;,
  &lt;span class=&quot;code-quote&quot;&gt;&quot;permissions&quot;&lt;/span&gt;:[
    { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;read&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;collection&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;collection-rf-2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;collection-rf-2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;index&quot;&lt;/span&gt;:1},
    { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;read&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;collection&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;collection-rf-1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;collection-rf-1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;index&quot;&lt;/span&gt;:2},
    { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;read&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;*&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;index&quot;&lt;/span&gt;:3},
    ...
  &lt;span class=&quot;code-quote&quot;&gt;&quot;user-role&quot;&lt;/span&gt;:
    { &lt;span class=&quot;code-quote&quot;&gt;&quot;collection-rf-1-user&quot;&lt;/span&gt;:[ &lt;span class=&quot;code-quote&quot;&gt;&quot;collection-rf-1&quot;&lt;/span&gt;], &lt;span class=&quot;code-quote&quot;&gt;&quot;collection-rf-2-user&quot;&lt;/span&gt;:[ &lt;span class=&quot;code-quote&quot;&gt;&quot;collection-rf-2&quot;&lt;/span&gt;]},
    ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Basically, its setup to that &apos;collection-rf-1-user&apos; user can only access &apos;collection-rf-1&apos; collection and &apos;collection-rf-2-user&apos; user can only access &apos;collection-rf-2&apos; collection.&lt;/p&gt;

&lt;p&gt;Also note that &apos;collection-rf-1&apos; collection replica is only on &apos;localhost:8983_solr&apos; node, whereas &apos;&apos;collection-rf-2&apos; collection replica is on both live nodes.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Authorization does not work as expected for &apos;collection-rf-1&apos; collection:&lt;/p&gt;

&lt;p&gt;$ curl -u collection-rf-2-user:password &apos;http://&lt;b&gt;localhost:8983&lt;/b&gt;/solr/collection-rf-1/select?q=&lt;b&gt;:&lt;/b&gt;&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-html&quot;&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;meta http-equiv=&lt;span class=&quot;code-quote&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt; content=&lt;span class=&quot;code-quote&quot;&gt;&quot;text/html;charset=utf-8&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Error 403 Unauthorized request, Response code: 403&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;h2&amp;gt;&lt;/span&gt;HTTP ERROR 403&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;Problem accessing /solr/collection-rf-1/select. Reason:
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;pre&amp;gt;&lt;/span&gt; Unauthorized request, Response code: 403&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/pre&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;$ curl -u collection-rf-2-user:password &apos;http://&lt;b&gt;localhost:8984&lt;/b&gt;/solr/collection-rf-1/select?q=&lt;b&gt;:&lt;/b&gt;&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-javascript&quot;&gt;
 {
   &lt;span class=&quot;code-quote&quot;&gt;&quot;responseHeader&quot;&lt;/span&gt;:{
     &lt;span class=&quot;code-quote&quot;&gt;&quot;zkConnected&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,
     &lt;span class=&quot;code-quote&quot;&gt;&quot;status&quot;&lt;/span&gt;:0,
     &lt;span class=&quot;code-quote&quot;&gt;&quot;QTime&quot;&lt;/span&gt;:0,
     &lt;span class=&quot;code-quote&quot;&gt;&quot;params&quot;&lt;/span&gt;:{
       &lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;*:*&quot;&lt;/span&gt;}},
   &lt;span class=&quot;code-quote&quot;&gt;&quot;response&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;numFound&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;start&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;docs&quot;&lt;/span&gt;:[]
 }}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Whereas authorization works perfectly for &apos;collection-rf-2&apos; collection (as both nodes have replica):&lt;/p&gt;

&lt;p&gt;$ curl -u collection-rf-1-user:password &apos;http://&lt;b&gt;localhost:8984&lt;/b&gt;/solr/collection-rf-2/select?q=&lt;b&gt;:&lt;/b&gt;&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-html&quot;&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;meta http-equiv=&lt;span class=&quot;code-quote&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt; content=&lt;span class=&quot;code-quote&quot;&gt;&quot;text/html;charset=utf-8&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Error 403 Unauthorized request, Response code: 403&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;h2&amp;gt;&lt;/span&gt;HTTP ERROR 403&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;Problem accessing /solr/collection-rf-2/select. Reason:
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;pre&amp;gt;&lt;/span&gt; Unauthorized request, Response code: 403&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/pre&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;$ curl -u collection-rf-1-user:password &apos;http://&lt;b&gt;localhost:8983&lt;/b&gt;/solr/collection-rf-2/select?q=&lt;b&gt;:&lt;/b&gt;&apos;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-html&quot;&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;html&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;head&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;meta http-equiv=&lt;span class=&quot;code-quote&quot;&gt;&quot;Content-Type&quot;&lt;/span&gt; content=&lt;span class=&quot;code-quote&quot;&gt;&quot;text/html;charset=utf-8&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;title&amp;gt;&lt;/span&gt;Error 403 Unauthorized request, Response code: 403&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/title&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/head&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;body&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;h2&amp;gt;&lt;/span&gt;HTTP ERROR 403&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/h2&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;p&amp;gt;&lt;/span&gt;Problem accessing /solr/collection-rf-2/select. Reason:
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;pre&amp;gt;&lt;/span&gt; Unauthorized request, Response code: 403&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/pre&amp;gt;&lt;/span&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/p&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/body&amp;gt;&lt;/span&gt;
 &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/html&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13167969">SOLR-12514</key>
            <summary>Rule-base Authorization plugin skips authorization if querying node does not have collection replica</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="noble.paul">Noble Paul</assignee>
                                    <reporter username="mahesh.kumar.vs">Mahesh Kumar Vasanthu Somashekar</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Jun 2018 06:26:29 +0000</created>
                <updated>Thu, 21 Nov 2019 00:42:30 +0000</updated>
                            <resolved>Fri, 4 Jan 2019 04:05:10 +0000</resolved>
                                    <version>7.3.1</version>
                                    <fixVersion>6.6.6</fixVersion>
                    <fixVersion>7.7</fixVersion>
                                    <component>security</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="16521962" author="varunthacker" created="Mon, 25 Jun 2018 07:48:27 +0000"  >&lt;p&gt;Hi Mahesh,&lt;/p&gt;

&lt;p&gt;Are you trying this on Solr 7.3.1 ?&lt;/p&gt;

&lt;p&gt;Here are the steps that I tried on Solr 7.3&#160; and Solr 7.3.1 which worked for me. Can you spot if I am doing anything differently which is why I wasn&apos;t able to reproduce this&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Start a 2 node solr cluster
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
bin/solr start -e cloud -noprompt&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;Create a collection with 1 shards X 1 replica
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/admin/collections?action=create&amp;amp;name=test_collection&amp;amp;numShards=1&amp;amp;replicationFactor=1&amp;amp;createNodeSet=192.168.1.3:7574_solr&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;Upload a security.json like this
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{
&lt;span class=&quot;code-quote&quot;&gt;&quot;authentication&quot;&lt;/span&gt;:{
&lt;span class=&quot;code-quote&quot;&gt;&quot;blockUnknown&quot;&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.BasicAuthPlugin&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;credentials&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;solr&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;IV0EHq1OnNrj6gvRCwvFwTrZ1+z1oBbnQdiVC3otuq0= Ndd7LKvVBAaZIF0QAVi1ekCfAJXr1GGfLtRUXhgrF8c=&quot;&lt;/span&gt;}
},
&lt;span class=&quot;code-quote&quot;&gt;&quot;authorization&quot;&lt;/span&gt;:{
&lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.RuleBasedAuthorizationPlugin&quot;&lt;/span&gt;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;permissions&quot;&lt;/span&gt;:[{ &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;read&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;collection&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;test_collection&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;search_user&quot;&lt;/span&gt;}],
&lt;span class=&quot;code-quote&quot;&gt;&quot;user-role&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;solr&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;search_user&quot;&lt;/span&gt;}
}}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;ol&gt;
	&lt;li&gt;Query against port 8983 as the collection is only hosted on 7574
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
curl -u solr:SolrRocks &lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/test_collection/select?q=*:*&apos;&lt;/span&gt;
&lt;/span&gt;
{

&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;responseHeader&quot;&lt;/span&gt;:{

&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;zkConnected&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,

&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;status&quot;&lt;/span&gt;:0,

&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;QTime&quot;&lt;/span&gt;:24,

&#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;params&quot;&lt;/span&gt;:{

&#160; &#160; &#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;*:*&quot;&lt;/span&gt;}},

&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;response&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;numFound&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;start&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;docs&quot;&lt;/span&gt;:[]

&#160; }}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="16522548" author="mahesh.kumar.vs" created="Mon, 25 Jun 2018 17:06:26 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Yes, I&apos;m using Solr-7.3.1&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Create another user without &apos;search-user&apos; role, meaning user doesn&apos;t have access to &apos;test_collection&apos;.&lt;/p&gt;

&lt;p&gt;Run query using this user hitting all Solr nodes.&lt;/p&gt;

&lt;p&gt;You would see 200 response from nodes which doesn&apos;t have replica (which is not expected) and 403 response from nodes which has replica (expected).&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="16522660" author="hgadre" created="Mon, 25 Jun 2018 18:30:03 +0000"  >&lt;p&gt;Yes I also have observed this behavior with &lt;a href=&quot;https://github.com/apache/sentry/blob/74842080936b93a8ef9b874774fd841764adc42c/sentry-binding/sentry-binding-solr/src/main/java/org/apache/sentry/binding/solr/authz/SentrySolrPluginImpl.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Solr Sentry authorization plugin&lt;/a&gt;. The root cause was the fact that the authorization framework relies on PermissionNameProvider interface to figure out the permissions to be checked against the authorization database. The individual request handlers in Solr are expected to implement this interface so as to define which permissions to check for which functionality. Now in case a core is not available on a given Solr server, the authorization context provides null value for the request handler. The Sentry plugin performs an &quot;instanceof&quot; check against the request handler reference. If this check fails (either because the request handler is null or does not implement PermissionNameProvider interface), it approves the request anyway. This is required since there are many request handlers in Solr which don&apos;t support authorization (Ref: &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11623&quot; title=&quot;Every request handler in Solr should implement PermissionNameProvider interface&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11623&quot;&gt;&lt;del&gt;SOLR-11623&lt;/del&gt;&lt;/a&gt;) and the authorization plugin needs to play nice with these request handlers. Now once the request is approved by the authorization plugin, the&#160;forwarded request is executed as a solr admin user (which has all the permissions). As a result, an user without authorization can see the query results.&lt;/p&gt;

&lt;p&gt;The fix was to use the &quot;proxy users&quot; functionality provided by the Hadoop authentication plugin. In this case, Solr automatically applies a &quot;doAs&quot; parameter to the query being forwarded to the remote solr server. This forces the remote Solr instance to treat this as a request from original user instead of from solr admin. Hence when it performs the authorization check, the request is rejected appropriately. This fix works well in our environment because we only support Hadoop authentication plugin which has &quot;proxy users&quot; support. We will need to think about generic solution for it to be applicable for all users.&#160;Let me upload the patch for reference.&#160;&lt;/p&gt;</comment>
                            <comment id="16522680" author="hgadre" created="Mon, 25 Jun 2018 18:55:26 +0000"  >&lt;p&gt;I think we should consider changing the visibility of this Jira to &quot;private&quot; and follow the regular process of fixing security vulnerability (e.g. filing CVE etc.). &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mahesh.kumar.vs&quot; class=&quot;user-hover&quot; rel=&quot;mahesh.kumar.vs&quot;&gt;mahesh.kumar.vs&lt;/a&gt; for future reference, such security issues should be reported to the security@apache mailing list instead of regular bug filing process.&lt;/p&gt;</comment>
                            <comment id="16522993" author="mahesh.kumar.vs" created="Tue, 26 Jun 2018 00:29:40 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hgadre&quot; class=&quot;user-hover&quot; rel=&quot;hgadre&quot;&gt;hgadre&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Thanks for the reply and for the patch.&lt;/p&gt;

&lt;p&gt;If query requires hitting multiple shards distributed on multiple nodes, would it&#160;run one remote query for authorization and if passed trigger remote queries in parallel hitting all required shards?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Thanks for sharing the process details, I&apos;ll keep that in mind for future reference. Is there an official page with the process?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16523248" author="noble.paul" created="Tue, 26 Jun 2018 06:00:17 +0000"  >&lt;p&gt;I see this code in the patch&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
+      /**
+       * When Solr is configured in secure mode (with Sentry), the request
+       * forwarding logic allows an unauthorized user to perform arbitrary operation in
+       * Solr. The reason is that authorization framework design requires access to
+       * RequestHandler reference to figure out the appropriate permissions to test against
+       * Sentry (or any other authorization back-end).But in &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; of request forwarding
+       * scenario, such reference is not available (since no local core can be found in that
+       * &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt;). When no request handler reference is available, authorization plugin needs
+       * to allow that request to go through. This is because there are many request handlers
+       * which &lt;span class=&quot;code-keyword&quot;&gt;do&lt;/span&gt; not implement PermissionNameProvider &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; and the authorization framework
+       * needs to play well with these request handlers (Ref: SOLR-11623). Internally request is
+       * forwarded using the Solr admin credentials. Hence the remote Solr instance bypass the
+       * authorization check, resulting in &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; vulnerability.
+       * This code change uses proxy users support in Hadoop authentication framework
+       * to pass original user-name via doAs param. That forces the remote Solr node to perfrom
+       * authorization check &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; the forwarded request, avoiding &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; vulnerability.
+       **/
+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (cores.getAuthenticationPlugin() &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; HadoopAuthPlugin) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There should be no need to handle a per implementation handling in security framework. If we go down this rabbit hole, this is going to be a nightmare. if we implement a solution, it should be universal to all authorization providers. &lt;/p&gt;

&lt;p&gt;If a node does not host a collection,it should forward the request as is without using inter-node communication. If it is basic auth send the header down to the target node and do not send the PKI header&lt;/p&gt;

</comment>
                            <comment id="16523532" author="janhoy" created="Tue, 26 Jun 2018 10:30:47 +0000"  >&lt;p&gt;Agree that we need a common generic solution to this, not custom solutions per plugin.&lt;/p&gt;

&lt;p&gt;Do we currently have a way to forward a request as-is, i.e. retaining certain request headers while dropping others etc?&#160;Would not the Solr node forwarding the request need to act as a some kind of &lt;a href=&quot;https://www.mnot.net/blog/2011/07/11/what_proxies_must_do&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;HTTP proxy&lt;/a&gt;? Or could we respond with HTTP 302 moved temporarily and return the address of a node actually hosting the collection &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16523540" author="noble.paul" created="Tue, 26 Jun 2018 10:35:23 +0000"  >&lt;p&gt;Why not forward all headers other than a few blacklisted ones? Even 302 is a good option. We just have to ensure that SolrJ works correctly with 302&lt;/p&gt;</comment>
                            <comment id="16523546" author="janhoy" created="Tue, 26 Jun 2018 10:44:37 +0000"  >&lt;p&gt;There are a bunch of complexities arising here, so it&apos;s tempting to throw a 302 as a quick-fix. We can then advertise that clients using this type of auth can either comply with 302 responses or preemptively read the cluster state and route requests intelligently to nodes hosting a collection - the same way as CloudSolrClient already does.&lt;/p&gt;

&lt;p&gt;If we go down the proxy style forwarding route, I imagine that we get other problems down the road. Say we add a IP-based auth plugin and tjen&#160;the request gets forwarded to another node, and IP auth fails etc.&lt;/p&gt;

&lt;p&gt;On the other hand - if we want Admin UI to play nicely with an authenticated user (given that the UI gets auth support in the future), we end up with CORS issues if the UI has to send query requests to different nodes...&lt;/p&gt;</comment>
                            <comment id="16535851" author="hgadre" created="Sat, 7 Jul 2018 17:27:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mahesh.kumar.vs&quot; class=&quot;user-hover&quot; rel=&quot;mahesh.kumar.vs&quot;&gt;mahesh.kumar.vs&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Thanks for sharing the process details, I&apos;ll keep that in mind for future reference. Is there an official page with the process?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Here is the info : &lt;a href=&quot;https://www.apache.org/security/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.apache.org/security/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt;&#160;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;There should be no need to handle a per implementation handling in security framework. If we go down this rabbit hole, this is going to be a nightmare. if we implement a solution, it should be universal to all authorization providers.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes I didn&apos;t upload the patch with the intent of committing. This is just a reference to show how this has been solved with Hadoop auth plugin. I see two options being discussed here,&lt;/p&gt;

&lt;p&gt;(a) Forward the original request as is (i.e. to keep all the original HTTP headers intact etc.).&lt;/p&gt;

&lt;p&gt;(b) Change the&#160;behaviour of Solr request forwarding logic to return 302 response&#160;&lt;/p&gt;

&lt;p&gt;With option (a) we will be implementing a generalised version of &quot;proxy users&quot; functionality in Hadoop. With option (b) we will be making a backwards incompatible change in the Solr behaviour since solrj is not the only client that talks to Solr. So we should exercise some caution with option (b).&lt;/p&gt;</comment>
                            <comment id="16535876" author="janhoy" created="Sat, 7 Jul 2018 19:33:57 +0000"  >&lt;blockquote&gt;&lt;p&gt;With option (b) we will be making a backwards incompatible change in the Solr behaviour&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Not really, If we only return 302 in case A: auth+autz is enabled anf B: current node does not host the collection. Rather force client change rather than staying insecure.&lt;/p&gt;

&lt;p&gt;The third option (c) which was suggested above is to have initial node fetch enough info about the (locally missing) collection from zk to be able to carry out authorization before forwarding using PKI. Is that even possible without spinning up a core?&lt;/p&gt;</comment>
                            <comment id="16535892" author="hgadre" created="Sat, 7 Jul 2018 20:26:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=janhoy&quot; class=&quot;user-hover&quot; rel=&quot;janhoy&quot;&gt;janhoy&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Not really, If we only return 302 in case A: auth+autz is enabled anf B: current node does not host the collection. Rather force client change rather than staying insecure.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Well...currently Solr does not return 302 response in the case that you mentioned (auth+autz is enabled and current node does not host the collection). So from client perspective this indeed is a backwards incompatible change. This security issue is a design limitation of the Solr security framework and ideally it should be fixed without affecting the current client/server interaction semantics.&lt;/p&gt;

&lt;p&gt;The third option seems better as it addresses the design limitation (that any node can figure out the handler class name for a given request). Can we just read the solrconfig.xml for all the collections and prepare this mapping at the startup? This can be a lightweight code which does not involve spinning up a core.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16607083" author="janhoy" created="Fri, 7 Sep 2018 12:48:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;Can we just read the solrconfig.xml for all the collections and prepare this mapping at the startup? This can be a lightweight code which does not involve spinning up a core.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yea, guess the only way to map path to handler is through solrconfig.xml. Do all handlers support empty constructor, and can we know that the&#160;getPermissionName() methods will never expect the presence of core or other structures? In that case we could instantiate each handler just to call the method.&lt;/p&gt;

&lt;p&gt;However, it feels a bit fragile, doesn&apos;t it?&#160;&lt;/p&gt;</comment>
                            <comment id="16607933" author="noble.paul" created="Sat, 8 Sep 2018 06:54:11 +0000"  >&lt;blockquote&gt;&lt;p&gt;Can we just read the solrconfig.xml for all the collections and prepare this mapping at the startup? This can be a lightweight code which does not involve spinning up a core.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Well, NO.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;A node&#160;only keep the config details of collections&#160;only if it has replicas of that collection. If we load&#160;all configs on startup, the node is not notified of config updates. So, it may have stale data .It will also be a problem if the handlers are loaded from a runtime lib&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The solution is&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Add a custom handler that serves the permissions at &lt;tt&gt;&amp;lt;collection-name&amp;gt;/check-perm?path=&amp;lt;path&amp;gt;&amp;amp;method=&amp;lt;HTTP-METHOD&amp;gt;&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;If a request comes in check if it is served by the node&lt;/li&gt;
	&lt;li&gt;if not, identify a node that serves that collection and hit the permissions path&lt;/li&gt;
	&lt;li&gt;respond appropriately&lt;/li&gt;
	&lt;li&gt;cache the details with a TTL of say 5secs to avoid too many requests&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16650522" author="varunthacker" created="Mon, 15 Oct 2018 17:33:44 +0000"  >&lt;p&gt;We should validate the &quot;collection&quot; param in a test as well.&lt;/p&gt;</comment>
                            <comment id="16660811" author="cpoerschke" created="Tue, 23 Oct 2018 15:14:15 +0000"  >&lt;p&gt;Attached demo script to illustrate the issue. In the script as a memory aid the collection with 2 replicas is called &lt;tt&gt;d(uet)&lt;/tt&gt; for use by D(anny) and the 1 replica collection is called &lt;tt&gt;s(olo)&lt;/tt&gt; for use by S(andy). The cluster itself contains two nodes and the scripts does port-collection-user permutations of queries &amp;#8211; and as described above the problem is that Danny is able to query Sandy&apos;s solo collection by sending a request to the node that has a duet collection replica but not a solo collection replica.&lt;/p&gt;

&lt;p&gt;Disclaimer: The demo script is just that, a demo script without an actual solution to the issue. But am sharing it in case it helps anyone else also interested in this ticket but not yet so familiar with the &lt;a href=&quot;http://lucene.apache.org/solr/guide/7_5/securing-solr.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://lucene.apache.org/solr/guide/7_5/securing-solr.html&lt;/a&gt; functionality or what Java based test code for the issue fix would look like.&lt;/p&gt;</comment>
                            <comment id="16720637" author="ctargett" created="Thu, 13 Dec 2018 21:53:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt;, Since you said you had a sense for the right solution here, could you work this through the rest of the process of committing a fix?&lt;/p&gt;</comment>
                            <comment id="16722488" author="noble.paul" created="Sun, 16 Dec 2018 13:38:18 +0000"  >&lt;p&gt;I have discussed with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt; about a possible fix for this. he is eager to work on a fix at the earliest&lt;/p&gt;</comment>
                            <comment id="16725481" author="noble.paul" created="Thu, 20 Dec 2018 00:55:08 +0000"  >&lt;p&gt;A simple solution is as follows,&lt;br/&gt;
If a request comes to a node that cannot be serviced by the node, it needs to be forwarded to another node. DO NOT send the PKI header in the forwarded request. The &lt;tt&gt;AuthenticationPlugin&lt;/tt&gt; must be able to intercept such a request and copy the necessary headers into the forwarded request&lt;/p&gt;</comment>
                            <comment id="16725690" author="janhoy" created="Thu, 20 Dec 2018 09:03:02 +0000"  >&lt;p&gt;Guess that is what &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12799&quot; title=&quot;Allow Authentication Plugins to easily intercept internode requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12799&quot;&gt;&lt;del&gt;SOLR-12799&lt;/del&gt;&lt;/a&gt; gives us, so a user specifying forwardCredentials=true for basicAuth will be covered. Perhaps we can require all Auth plugins to implement interceptInternodeRequest() and make it the default?&lt;/p&gt;</comment>
                            <comment id="16725878" author="janhoy" created="Thu, 20 Dec 2018 14:12:59 +0000"  >&lt;p&gt;This vulnerability was mentioned on the public Github PR for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12799&quot; title=&quot;Allow Authentication Plugins to easily intercept internode requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12799&quot;&gt;&lt;del&gt;SOLR-12799&lt;/del&gt;&lt;/a&gt;, see&#160;&lt;a href=&quot;https://github.com/apache/lucene-solr/pull/458#issuecomment-448766770&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/458#issuecomment-448766770&lt;/a&gt;&#160;So we can assume it is publicly known...&lt;/p&gt;</comment>
                            <comment id="16731217" author="noble.paul" created="Mon, 31 Dec 2018 07:22:08 +0000"  >&lt;p&gt;fix was simpler than we thought earlier.&#160;&lt;/p&gt;

&lt;p&gt;The real bug was that when for remoteQuery requests the SolrRequestInfo was not set. PKI plugin assumed that it is always set&lt;/p&gt;</comment>
                            <comment id="16731544" author="noble.paul" created="Tue, 1 Jan 2019 09:09:09 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt; The only test that fails with the patch is &lt;tt&gt;TestSolrCloudWithSecureImpersonation.testForwarding&lt;/tt&gt; . Can you take a look please&lt;/p&gt;</comment>
                            <comment id="16732117" author="janhoy" created="Wed, 2 Jan 2019 14:49:45 +0000"  >&lt;p&gt;I saw your commit. Don&apos;t you also need a test where a request succeeds to a Jetty without the collection?&lt;/p&gt;

&lt;p&gt;Also, are you handling this as&#160;a security issue or as a plain bug, or something in between?&lt;/p&gt;</comment>
                            <comment id="16733809" author="noble.paul" created="Fri, 4 Jan 2019 03:48:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=janhoy&quot; class=&quot;user-hover&quot; rel=&quot;janhoy&quot;&gt;janhoy&lt;/a&gt; I&apos;m adding another test as well&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Also, are you handling this as&#160;a security issue or as a plain bug, or something in between?&lt;/p&gt;&lt;/blockquote&gt;


&lt;p&gt;This is a serious security issue.&#160;&lt;/p&gt;</comment>
                            <comment id="16733871" author="janhoy" created="Fri, 4 Jan 2019 07:00:05 +0000"  >&lt;p&gt;OK, just thought the public commit meaaage was a bit revealing.. See vulnerability checklist at &lt;a href=&quot;https://www.apache.org/security/committers.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.apache.org/security/committers.html&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="16733886" author="janhoy" created="Fri, 4 Jan 2019 07:16:05 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m adding another test as well&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;&#160;The new positive test is ok, but it is written inside the try clause, so if there is a regression where a request with credentials fails with permission denied then it won&apos;t be caught by that test, but that is quite theoretical I guess.&lt;/p&gt;</comment>
                            <comment id="16733938" author="janhoy" created="Fri, 4 Jan 2019 08:33:06 +0000"  >&lt;p&gt;I ran &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cpoerschke&quot; class=&quot;user-hover&quot; rel=&quot;cpoerschke&quot;&gt;cpoerschke&lt;/a&gt;&apos;s script on a clean master, and user &apos;danny&apos; was denied access to collection &apos;solo&apos; on both port 8983 and 7574.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Also tested with branch_7x, OK&lt;/b&gt;&lt;/p&gt;</comment>
                            <comment id="16824835" author="noble.paul" created="Wed, 24 Apr 2019 05:43:25 +0000"  >&lt;p&gt;This is fixed in all the major releases and this ticket is made public&lt;/p&gt;</comment>
                            <comment id="16825011" author="ichattopadhyaya" created="Wed, 24 Apr 2019 10:39:24 +0000"  >&lt;p&gt;This was also backported to Solr 6.6.6; sorry I forgot to update here (now done).&lt;/p&gt;</comment>
                            <comment id="16825249" author="hgadre" created="Wed, 24 Apr 2019 15:12:43 +0000"  >&lt;p&gt;Is there a CVE associated with this issue? I don&apos;t see one.&lt;/p&gt;</comment>
                            <comment id="16825259" author="risdenk" created="Wed, 24 Apr 2019 15:24:59 +0000"  >&lt;p&gt;From the notification email: CVE-2018-11802&lt;/p&gt;</comment>
                            <comment id="16825260" author="hgadre" created="Wed, 24 Apr 2019 15:26:52 +0000"  >&lt;p&gt;Ok great. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krisden&quot; class=&quot;user-hover&quot; rel=&quot;krisden&quot;&gt;krisden&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13207233">SOLR-13098</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12953371" name="SOLR-12514.patch" size="2599" author="noble.paul" created="Mon, 31 Dec 2018 07:20:59 +0000"/>
                            <attachment id="12929075" name="SOLR-12514.patch" size="4576" author="hgadre" created="Mon, 25 Jun 2018 18:51:54 +0000"/>
                            <attachment id="12928990" name="Screen Shot 2018-06-24 at 9.36.45 PM.png" size="36451" author="mahesh.kumar.vs" created="Mon, 25 Jun 2018 06:23:26 +0000"/>
                            <attachment id="12945237" name="demo.sh" size="2079" author="cpoerschke" created="Tue, 23 Oct 2018 15:13:27 +0000"/>
                            <attachment id="12928989" name="security.json" size="2202" author="mahesh.kumar.vs" created="Mon, 25 Jun 2018 06:23:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 29 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3v6lj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>