<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:39:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-13580] java 13 changes to locale specific Numeric parsing rules affect ParseNumeric UpdateProcessors when using &apos;local&apos; config option  - notably affects French</title>
                <link>https://issues.apache.org/jira/browse/SOLR-13580</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Per &lt;a href=&quot;https://bugs.openjdk.java.net/browse/JDK-8221432&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;JDK-8221432&lt;/a&gt; Java13 has updated to &lt;a href=&quot;http://cldr.unicode.org/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CLDR 35.1&lt;/a&gt; &#8211; which controls the definition of language &amp;amp; locale specific formatting characters &#8211; in a non-backwards compatible way due to &quot;French&quot; changes in &lt;a href=&quot;http://cldr.unicode.org/index/downloads/cldr-34#TOC-Detailed-Data-Changes&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;CLDR 34&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This impacts people who use any of the &quot;ParseNumeric&quot; UpdateProcessors in conjunction with the &quot;locale=fr&quot; or &quot;locale=fr_FR&quot; init param and expect the (pre java13) existing behavior of treating U+00A0 (NO BREAK SPACE) as a &quot;grouping&quot; character (ie: between thousands and million, between millions and billions, etc...). Starting with java13 the JVM expects U+202F (NARROW NO BREAK SPACE) in it&apos;s place.&lt;/p&gt;

&lt;p&gt;Notably: upgrading to jdk13-ea+26 caused failures in Solr&apos;s ParsingFieldUpdateProcessorsTest which was initially had hardcoded test data that used U+00A0. ParsingFieldUpdateProcessorsTest has since been updated to account for this discrepency by modifying the test data used to determine the &quot;expected&quot; character for the current JVM, but there is nothing Solr or the ParseNumeric UpdateProcessors can do to help mitigate this change in behavior for end users who upgrade to java13.&lt;/p&gt;

&lt;p&gt;Affected users with U+00A0 characters in their incoming SolrInputDocuments will see the ParseNumeric UpdateProcessors (configured with locale=fr...) &quot;skip&quot; these values as unparsable, most likely resulting in a failure to index into a numeric field since the original &quot;String&quot; value will be left as is.&lt;/p&gt;

&lt;p&gt;Affected users may want to consider updating their configs to include a &lt;tt&gt;RegexReplaceProcessorFactory&lt;/tt&gt; configured to strip out all whitespace characters, prior to any ParseNumeric update processors configured expect french langauge numbers&lt;br/&gt;
 &#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13241601">SOLR-13580</key>
            <summary>java 13 changes to locale specific Numeric parsing rules affect ParseNumeric UpdateProcessors when using &apos;local&apos; config option  - notably affects French</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10004">Not A Bug</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                            <label>Java13</label>
                    </labels>
                <created>Tue, 25 Jun 2019 23:07:30 +0000</created>
                <updated>Fri, 26 Jul 2019 09:01:38 +0000</updated>
                            <resolved>Fri, 28 Jun 2019 22:43:24 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16872793" author="hossman" created="Tue, 25 Jun 2019 23:16:00 +0000"  >&lt;p&gt;i&apos;ve already submitted an openjdk ticket, will update this jira once public.&lt;/p&gt;

&lt;p&gt;I&apos;m attaching a patch for ParsingFieldUpdateProcessorsTest that:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;improves the test overall by changing all the &lt;tt&gt;assertTrue(v instanceOf X)&lt;/tt&gt; patterns to use &lt;tt&gt;org.hamcrest.core.IsInstanceOf&lt;/tt&gt; so we get decent failure messages in this type of situation&lt;/li&gt;
	&lt;li&gt;adds an &lt;tt&gt;assumeThat&lt;/tt&gt; to the affected test methods validating that &lt;tt&gt;NumberFormat.getInstance(new Locale(&quot;fr&quot;,&quot;FR&quot;));&lt;/tt&gt; behaves as expected when parsing a number with the french grouping seperator.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;..i&apos;ll go ahead and commit ASAP to fix the 13-ea jenkins builds once precommit passes.&lt;/p&gt;</comment>
                            <comment id="16872794" author="jira-bot" created="Tue, 25 Jun 2019 23:26:14 +0000"  >&lt;p&gt;Commit 583c219183b2bca85936a095727d287c5c28526b in lucene-solr&apos;s branch refs/heads/master from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=583c219&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=583c219&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13580&quot; title=&quot;java 13 changes to locale specific Numeric parsing rules affect ParseNumeric UpdateProcessors when using &amp;#39;local&amp;#39; config option  - notably affects French&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13580&quot;&gt;&lt;del&gt;SOLR-13580&lt;/del&gt;&lt;/a&gt;: add assumeThat calls to ParsingFieldUpdateProcessorsTest to skip test methods impacted by java 13-ea bug in NumberFormat.parse()&lt;/p&gt;</comment>
                            <comment id="16872801" author="jira-bot" created="Tue, 25 Jun 2019 23:47:38 +0000"  >&lt;p&gt;Commit eeed1827d8cc9d934ce1be479a52dfc9e744cc54 in lucene-solr&apos;s branch refs/heads/branch_8x from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=eeed182&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=eeed182&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13580&quot; title=&quot;java 13 changes to locale specific Numeric parsing rules affect ParseNumeric UpdateProcessors when using &amp;#39;local&amp;#39; config option  - notably affects French&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13580&quot;&gt;&lt;del&gt;SOLR-13580&lt;/del&gt;&lt;/a&gt;: add assumeThat calls to ParsingFieldUpdateProcessorsTest to skip test methods impacted by java 13-ea bug in NumberFormat.parse()&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 583c219183b2bca85936a095727d287c5c28526b)&lt;/p&gt;</comment>
                            <comment id="16874358" author="hossman" created="Thu, 27 Jun 2019 17:16:57 +0000"  >&lt;p&gt;&lt;a href=&quot;https://bugs.openjdk.java.net/browse/JDK-8226867&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.openjdk.java.net/browse/JDK-8226867&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;JDK-13 uses the CLDR v35 . From CLDR v34, the French grouping separator changed from no-break space U+00A0 to narrow no-break space U+202F. (Reference Release Notes for CLDR v34 : http://cldr.unicode.org/index/downloads/cldr-34 )
&quot;10\u202F0898,83491&quot; will give the expected result :
### input = 10?0898,83491
100898.83491
class java.lang.Double
java.text.ParsePosition[index=13,errorIndex=-1] 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Linked issue: &lt;a href=&quot;https://bugs.openjdk.java.net/browse/JDK-8225245&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.openjdk.java.net/browse/JDK-8225245&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;Instead of hardcoding \u00A0, applications can use DecimalFormatSymbols.getInstance(Locale.FRENCH).getGroupingSeparator().&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;...so it looks like we can change the test to work regardless of java version by using  DecimalFormatSymbols to determine the corect grouping character at runtime &amp;#8211; but that won&apos;t change the fact that end users who don&apos;t know any better might see a back compat break (in the ParseNumeric UpdateProcessors) if they upgrade to java13 ... so we should mak sure the isue description spells this out.&lt;/p&gt;

&lt;p&gt;not sure there is much we can safely do to mitigate this for users across all possible locales that my be affected.&lt;/p&gt;</comment>
                            <comment id="16875165" author="jira-bot" created="Fri, 28 Jun 2019 19:11:11 +0000"  >&lt;p&gt;Commit 8b72e91df7b8ea545b6344d665bbb80e27a80aa4 in lucene-solr&apos;s branch refs/heads/master from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=8b72e91&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=8b72e91&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13580&quot; title=&quot;java 13 changes to locale specific Numeric parsing rules affect ParseNumeric UpdateProcessors when using &amp;#39;local&amp;#39; config option  - notably affects French&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13580&quot;&gt;&lt;del&gt;SOLR-13580&lt;/del&gt;&lt;/a&gt;: update test to account for different versions of java using different locale specific numeric formatting characters&lt;/p&gt;</comment>
                            <comment id="16875188" author="jira-bot" created="Fri, 28 Jun 2019 19:49:36 +0000"  >&lt;p&gt;Commit 881aabe28a0678d65074a6240ca976fcbfab27bf in lucene-solr&apos;s branch refs/heads/branch_8x from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=881aabe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=881aabe&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13580&quot; title=&quot;java 13 changes to locale specific Numeric parsing rules affect ParseNumeric UpdateProcessors when using &amp;#39;local&amp;#39; config option  - notably affects French&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13580&quot;&gt;&lt;del&gt;SOLR-13580&lt;/del&gt;&lt;/a&gt;: update test to account for different versions of java using different locale specific numeric formatting characters&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 8b72e91df7b8ea545b6344d665bbb80e27a80aa4)&lt;/p&gt;</comment>
                            <comment id="16875273" author="hossman" created="Fri, 28 Jun 2019 22:38:10 +0000"  >&lt;p&gt;updated summary &amp;amp; description to be helpful to end users who might see a change in behavior and think there is a bug in the UpdaeProcessors&lt;/p&gt;</comment>
                            <comment id="16875276" author="hossman" created="Fri, 28 Jun 2019 22:43:06 +0000"  >&lt;p&gt;update dsecription with a possible workaround that just occured to me&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12972914" name="SOLR-13580.patch" size="30465" author="hossman" created="Tue, 25 Jun 2019 23:13:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 20 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z043q8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>