<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:18:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9154] Config API does not work when adding a component with DirectSolrSpellChecker</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9154</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When trying to add a DirectSolrSpellchecker using the Config API (JSON), there seems to be a loss of information w.r.t the param types. The accuracy field, only in this specific case needs to be defined as a float it seems. While this is possible when updating the solrconfig,xml directly, the field type (float) can not be specified using JSON. &lt;/p&gt;

&lt;p&gt;Here are the steps to reproduce this issue:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;#Bootstrapping
bin/solr start -c
bin/solr create -c foo
bin/post -c foo example/exampledocs/books.csv

#Add spell checker - This would hang and the logs contain recurring exceptions as mentioned below
curl http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/foo/config -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Content-type:application/json&apos;&lt;/span&gt; -d &lt;span class=&quot;code-quote&quot;&gt;&apos;{&lt;span class=&quot;code-quote&quot;&gt;&quot;update-searchcomponent&quot;&lt;/span&gt;: {&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;spellcheck&quot;&lt;/span&gt;,       &lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.SpellCheckComponent&quot;&lt;/span&gt;,       &lt;span class=&quot;code-quote&quot;&gt;&quot;spellchecker&quot;&lt;/span&gt;:[         { &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;text_index_dictionary&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;text&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;classname&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.DirectSolrSpellChecker&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;distanceMeasure&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.lucene.search.spell.LevensteinDistance&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;accuracy&quot;&lt;/span&gt;:0.5, &lt;span class=&quot;code-quote&quot;&gt;&quot;maxEdits&quot;&lt;/span&gt;:2, &lt;span class=&quot;code-quote&quot;&gt;&quot;minPrefix&quot;&lt;/span&gt;:1, &lt;span class=&quot;code-quote&quot;&gt;&quot;maxInspections&quot;&lt;/span&gt;:5, &lt;span class=&quot;code-quote&quot;&gt;&quot;minQueryLength&quot;&lt;/span&gt;:4, &lt;span class=&quot;code-quote&quot;&gt;&quot;maxQueryFrequency&quot;&lt;/span&gt;:0.001, &lt;span class=&quot;code-quote&quot;&gt;&quot;thresholdTokenFrequency&quot;&lt;/span&gt;:0.01}]}}&apos;&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2016-05-24 04:08:44.371 ERROR (SolrConfigHandler-refreshconf) [c:foo s:shard1 r:core_node1 x:foo_shard1_replica1] o.a.s.h.SolrConfigHandler Unable to refresh conf 
org.apache.solr.common.SolrException: Unable to reload core [foo_shard1_replica1]
	at org.apache.solr.core.CoreContainer.reload(CoreContainer.java:944)
	at org.apache.solr.core.SolrCore.lambda$getConfListener$7(SolrCore.java:2510)
	at org.apache.solr.handler.SolrConfigHandler$Command$1.run(SolrConfigHandler.java:218)
Caused by: org.apache.solr.common.SolrException: java.lang.&lt;span class=&quot;code-object&quot;&gt;Double&lt;/span&gt; cannot be &lt;span class=&quot;code-keyword&quot;&gt;cast&lt;/span&gt; to java.lang.&lt;span class=&quot;code-object&quot;&gt;Float&lt;/span&gt;
	at org.apache.solr.core.SolrCore.&amp;lt;init&amp;gt;(SolrCore.java:773)
	at org.apache.solr.core.SolrCore.reload(SolrCore.java:462)
	at org.apache.solr.core.CoreContainer.reload(CoreContainer.java:938)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12972274">SOLR-9154</key>
            <summary>Config API does not work when adding a component with DirectSolrSpellChecker</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="anshum">Anshum Gupta</assignee>
                                    <reporter username="anshum">Anshum Gupta</reporter>
                        <labels>
                    </labels>
                <created>Tue, 24 May 2016 04:15:28 +0000</created>
                <updated>Mon, 2 Jan 2017 18:34:49 +0000</updated>
                            <resolved>Mon, 2 Jan 2017 18:34:49 +0000</resolved>
                                                    <fixVersion>6.4</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                    <component>config-api</component>
                    <component>spellchecker</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15300599" author="anshumg" created="Wed, 25 May 2016 18:27:08 +0000"  >&lt;p&gt;Seems like all assignments have issues in the init method for this class. This was the first one so this is all that got hit and logged.&lt;br/&gt;
I&apos;ll work on a patch.&lt;/p&gt;</comment>
                            <comment id="15300703" author="anshumg" created="Wed, 25 May 2016 19:30:29 +0000"  >&lt;p&gt;I&apos;m not purely convinced with the patch but this works. If someone has a better idea, feel free to suggest, else I&apos;ll commit this after adding a test.&lt;/p&gt;</comment>
                            <comment id="15355332" author="alexandre.drouin" created="Wed, 29 Jun 2016 14:35:20 +0000"  >&lt;p&gt;Would it be possible to convert the config variable to a SolrParams (e.g.: using SolrParams.toSolrParams)?  This way you could use get* methods instead of parsing the string yourself.&lt;/p&gt;</comment>
                            <comment id="15360313" author="dsmiley" created="Sat, 2 Jul 2016 19:55:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;Would it be possible to convert the config variable to a SolrParams (e.g.: using SolrParams.toSolrParams)? This way you could use get* methods instead of parsing the string yourself.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1 &amp;#8211; I&apos;ve often felt the annoying differences between NamedList and SolrParams for the simple name=value cases.  A convenience method on NamedList &lt;tt&gt;toSolrParams()&lt;/tt&gt; would make this more obvious.  These initializers could be updated to use SolrParams instead.  That&apos;s obviously a bigger refactoring &amp;amp; scope change than just the spellchecker, but it seems inevitable something broader than just this patch should get done as it&apos;s inevitable this same bug pattern will appear again!&lt;/p&gt;

&lt;p&gt;Another possible change, possibly simpler, is to have NamedList have getFloatVal, getDoubleVal, getStringVal, getIntVal, getLongVal.  It already has getBooleanArg which is named poorly (IMO).  And then, update everyone to use these rather than getVal.  These added methods could do float/double conversions, treating them equivalently.  Maybe String parsing too.&lt;/p&gt;</comment>
                            <comment id="15791836" author="anshumg" created="Sun, 1 Jan 2017 23:38:28 +0000"  >&lt;p&gt;I think this is better, but I&apos;m not sure if for the sake of this patch, we should expose &lt;em&gt;params&lt;/em&gt;.&lt;/p&gt;</comment>
                            <comment id="15791960" author="jira-bot" created="Mon, 2 Jan 2017 01:23:33 +0000"  >&lt;p&gt;Commit 93562da610bf8756351be7720c69872bc1cea727 in lucene-solr&apos;s branch refs/heads/master from anshum&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=93562da&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=93562da&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9154&quot; title=&quot;Config API does not work when adding a component with DirectSolrSpellChecker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9154&quot;&gt;&lt;del&gt;SOLR-9154&lt;/del&gt;&lt;/a&gt;: Fix DirectSolrSpellChecker to work when added through the Config API&lt;/p&gt;</comment>
                            <comment id="15793296" author="jira-bot" created="Mon, 2 Jan 2017 18:34:13 +0000"  >&lt;p&gt;Commit fb39e397dbd17fea68f5d46baf80f5af8f5b59d0 in lucene-solr&apos;s branch refs/heads/branch_6x from anshum&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=fb39e39&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=fb39e39&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9154&quot; title=&quot;Config API does not work when adding a component with DirectSolrSpellChecker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9154&quot;&gt;&lt;del&gt;SOLR-9154&lt;/del&gt;&lt;/a&gt;: Fix DirectSolrSpellChecker to work when added through the Config API&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12845258" name="SOLR-9154.patch" size="3831" author="anshum" created="Sun, 1 Jan 2017 23:38:28 +0000"/>
                            <attachment id="12806196" name="SOLR-9154.patch" size="3138" author="anshum" created="Wed, 25 May 2016 19:30:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 46 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2yelb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>