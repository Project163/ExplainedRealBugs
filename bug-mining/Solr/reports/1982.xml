<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:53:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2853] SpellCheckCollator.collate method creates the a PossibilityIterator with maxTries instead of maxCollations</title>
                <link>https://issues.apache.org/jira/browse/SOLR-2853</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Class SpellCheckCollator creates a new possibility iterator based on the spellcheck results.  The iterator is created with: &lt;br/&gt;
PossibilityIterator possibilityIter = new PossibilityIterator(result.getSuggestions(), maxTries, maxEvaluations);&lt;/p&gt;

&lt;p&gt;The issue is maxTries, should be maxCollations.  Correct me if I&apos;m wrong.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12528761">SOLR-2853</key>
            <summary>SpellCheckCollator.collate method creates the a PossibilityIterator with maxTries instead of maxCollations</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdyer">James Dyer</assignee>
                                    <reporter username="mtraynham">Matt Traynham</reporter>
                        <labels>
                    </labels>
                <created>Tue, 25 Oct 2011 21:19:20 +0000</created>
                <updated>Mon, 9 May 2016 18:56:04 +0000</updated>
                            <resolved>Wed, 9 Jul 2014 14:25:36 +0000</resolved>
                                    <version>3.3</version>
                    <version>4.0-ALPHA</version>
                                    <fixVersion>4.10</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>spellchecker</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13135468" author="jdyer" created="Tue, 25 Oct 2011 22:00:31 +0000"  >&lt;p&gt;Matt,&lt;/p&gt;

&lt;p&gt;Thanks for taking such a deep dive into this code.  Its great to see people checking for things like this.  I think the current code is correct, however.  What PossibilityIterator is returning is a set of word combinations that SpellCheckCollator then needs to test against the index.  So PossibilityIterator will return up to &quot;maxTries&quot; word combinations.  But some of these possibilities could be nonsense and will return 0 hits when queried for against the index. SpellCheckCollator will throw these 0-hit possibilities out, trying each possibility until it has as many good ones as requested by &quot;maxCollations&quot;, or until it has exhausted the list.  (If the user sets maxCollationTries to zero, SpellCheckCollator won&apos;t test any and in this case will just return the first &quot;maxCollations&quot; possibilities back to the user.)  Make sense? &lt;/p&gt;</comment>
                            <comment id="13135542" author="mtraynham" created="Tue, 25 Oct 2011 23:18:22 +0000"  >&lt;p&gt;Ahh yes, that makes sense.  I was under the assumption that one might want up to a &quot;maxCollations&quot; of possibilities returned, instead of just the first one, even if &quot;maxTries&quot; is zero.  But thanks that clears up my issue.&lt;/p&gt;

&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; No problem looking into code, it&apos;s very interesting work.&lt;/p&gt;</comment>
                            <comment id="13135546" author="mtraynham" created="Tue, 25 Oct 2011 23:19:59 +0000"  >&lt;p&gt;Marking as invalid, based upon Mr. Dyer&apos;s comment.&lt;/p&gt;</comment>
                            <comment id="13136014" author="jdyer" created="Wed, 26 Oct 2011 14:29:59 +0000"  >&lt;p&gt;Matt,&lt;/p&gt;

&lt;p&gt;Actuall, if you wouldn&apos;t mind, could you re-open this one (I can&apos;t), or otherwise I can open another issue.  Taking a closer look after reading your last comment, there is a bug in the case the user sets &quot;maxCollationTries&quot; to 0.  In SpellCheckCollator, we have:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (maxTries &amp;lt; 1) {
  maxTries = 1;
  verifyCandidateWithQuery = &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But I think in this case we need it to set &quot;maxTries&quot; to the same value as &quot;maxCollations&quot;.  The current code will, as you point out, only return 1 collation no mater how many the user specified, unless &quot;maxTries&quot; &amp;gt; 0.  I would think most users who want multiple collations would also want them verified, so this is probably not something that would get easily caught.  An extra test case might be prudent as well.&lt;/p&gt;
</comment>
                            <comment id="13136045" author="mtraynham" created="Wed, 26 Oct 2011 15:32:56 +0000"  >&lt;p&gt;Reopened&lt;/p&gt;</comment>
                            <comment id="13136132" author="mtraynham" created="Wed, 26 Oct 2011 17:32:35 +0000"  >&lt;p&gt;James,&lt;br/&gt;
Thanks for looking into this again.  I completely agree with your fix and appreciate the 411 on the context between maxTries and maxCollations.&lt;/p&gt;

&lt;p&gt;Matt&lt;/p&gt;</comment>
                            <comment id="13136155" author="mtraynham" created="Wed, 26 Oct 2011 17:50:44 +0000"  >&lt;p&gt;Attaching patch&lt;/p&gt;</comment>
                            <comment id="13152105" author="jdyer" created="Thu, 17 Nov 2011 15:37:39 +0000"  >&lt;p&gt;Updated patch &amp;amp; added a unit test.  &lt;/p&gt;

&lt;p&gt;With &quot;spellcheck.maxCollationTries=0&amp;amp;spellcheck.maxCollations=2&quot;, the patched version will return 2 collations as requested.  Prior to the patch, &quot;spellcheck.maxCollations&quot; is ignored if &quot;spellcheck.maxCollationTries&quot; is zero.&lt;/p&gt;</comment>
                            <comment id="14053678" author="shalinmangar" created="Mon, 7 Jul 2014 14:06:52 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jdyer&quot; class=&quot;user-hover&quot; rel=&quot;jdyer&quot;&gt;jdyer&lt;/a&gt;, is there a reason why this patch was not committed?&lt;/p&gt;</comment>
                            <comment id="14053698" author="jdyer" created="Mon, 7 Jul 2014 14:26:54 +0000"  >&lt;p&gt;Shalin,  Probably back in 2011 I got sidetracked doing something else and never simply forgot!  I can look into verifying the problem still exists and that the patch works in the next day or so, unless you want to.&lt;/p&gt;</comment>
                            <comment id="14053703" author="shalinmangar" created="Mon, 7 Jul 2014 14:30:33 +0000"  >&lt;p&gt;Thanks James, I figured as much. Please do if you have the time. Otherwise I&apos;ll look at it by the end of the week. We need to do something about &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3029&quot; title=&quot;Poor json formatting of spelling collation info&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3029&quot;&gt;&lt;del&gt;SOLR-3029&lt;/del&gt;&lt;/a&gt; as well.&lt;/p&gt;</comment>
                            <comment id="14055493" author="jdyer" created="Tue, 8 Jul 2014 20:42:48 +0000"  >&lt;p&gt;This issue actually is fixed already.  Before closing, I will commit the unit test and backport to 4.x/&lt;/p&gt;</comment>
                            <comment id="14056284" author="jira-bot" created="Wed, 9 Jul 2014 14:22:13 +0000"  >&lt;p&gt;Commit 1609171 from jdyer@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1609171&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1609171&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2853&quot; title=&quot;SpellCheckCollator.collate method creates the a PossibilityIterator with maxTries instead of maxCollations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2853&quot;&gt;&lt;del&gt;SOLR-2853&lt;/del&gt;&lt;/a&gt;: unit test for &quot;spellcheck.maxCollationTries=0&quot;&lt;/p&gt;</comment>
                            <comment id="14056286" author="jira-bot" created="Wed, 9 Jul 2014 14:24:17 +0000"  >&lt;p&gt;Commit 1609173 from jdyer@apache.org in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1609173&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1609173&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2853&quot; title=&quot;SpellCheckCollator.collate method creates the a PossibilityIterator with maxTries instead of maxCollations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2853&quot;&gt;&lt;del&gt;SOLR-2853&lt;/del&gt;&lt;/a&gt;: unit test for &quot;spellcheck.maxCollationTries=0&quot;&lt;/p&gt;</comment>
                            <comment id="14056288" author="jdyer" created="Wed, 9 Jul 2014 14:25:36 +0000"  >&lt;p&gt;Thanks for reporting this issue, Matt!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12504072" name="SOLR-2853.patch" size="2414" author="jdyer" created="Thu, 17 Nov 2011 15:37:39 +0000"/>
                            <attachment id="12500921" name="SOLR-2853.patch" size="785" author="mtraynham" created="Wed, 26 Oct 2011 17:50:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>214621</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 19 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03i67:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18377</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>