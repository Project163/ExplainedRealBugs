<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:10:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-17298] Multithreaded search breaks limits, and possibly other things</title>
                <link>https://issues.apache.org/jira/browse/SOLR-17298</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13350&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-13350&lt;/a&gt; was merged to main somewhat unexpectedly, and then back-ported to 9x without any response to feedback from multiple committers, including feedback that&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;By turning it on by default, it breaks the recently released CPU limits (as shown by changes to unit tests).&lt;/li&gt;
	&lt;li&gt;Incompatibility with timeAllowed, cpuTimeAllowed, segmentTerminateEarly, GraphQuery, RankQuery and JoinQuery was not clearly documented&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I have not verified it yet, but I would also be worried about the health of CPU time logging to be added in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16986&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-16986&lt;/a&gt; after this change.&lt;/p&gt;

&lt;p&gt;Given that:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Some of the above issues represent back compatibility breaks or potential back compatibility breaks for released features&lt;/li&gt;
	&lt;li&gt;The decision to break compatibility within the 9x release series deserves a formal vote (or a fix).&lt;/li&gt;
	&lt;li&gt;There has been no communication/response from the committer who merged these changes since May 6 (aside from the backport to 9x on May 13) it seems that this state may persist for some time.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Therefore it appears necessary to file this issue to ensure anything but a 9.6.1 is blocked until the above issues are sorted out. This ticket can serve as a parent ticket to whatever various solutions are agreed upon.&lt;/p&gt;

&lt;p&gt;Multi-threaded search is an awesome feature that has taken a very long time to be realized and is obviously desirable, but we have now placed ourselves in an awkward position by not resolving these last few issues before back porting.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13579682">SOLR-17298</key>
            <summary>Multithreaded search breaks limits, and possibly other things</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gus">Gus Heck</assignee>
                                    <reporter username="gus">Gus Heck</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 17 May 2024 15:08:48 +0000</created>
                <updated>Fri, 17 Oct 2025 20:05:05 +0000</updated>
                            <resolved>Fri, 16 Aug 2024 04:05:30 +0000</resolved>
                                    <version>9.7</version>
                    <version>10.0</version>
                                    <fixVersion>9.7</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="13200">3h 40m</timespent>
                                <comments>
                            <comment id="17868373" author="cpoerschke" created="Wed, 24 Jul 2024 13:40:45 +0000"  >&lt;blockquote&gt;&lt;ul&gt;
	&lt;li&gt;The code presents a possibility for users to receive a non-numeric max score (&quot;NaN&quot;).&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;
&lt;p&gt;I&apos;d be interested in investigating this, appreciate any pointers but will also just have a look around in the meantime. Thanks!&lt;/p&gt;</comment>
                            <comment id="17868416" author="cpoerschke" created="Wed, 24 Jul 2024 16:08:11 +0000"  >&lt;blockquote&gt;&lt;p&gt;* By turning it on by default, it breaks the recently released CPU limits (as shown by changes to unit tests).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/solr/pull/2590&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/pull/2590&lt;/a&gt; explores to explicitly not support multi-threaded search if query limits are used, this would then remove the need for the unit tests to change.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;* Incompatibility with timeAllowed, cpuTimeAllowed, segmentTerminateEarly, GraphQuery, RankQuery and JoinQuery was not clearly documented&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/solr/pull/2590&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/pull/2590&lt;/a&gt; does not include any documentation changes. Would suggest to separately add the documentation for the new &lt;tt&gt;multiThreaded=(true|false)&lt;/tt&gt; parameter.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;* The code presents a possibility for users to receive a non-numeric max score (&quot;NaN&quot;).&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/solr/pull/2588&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/pull/2588&lt;/a&gt; proposes to add some assertions related to this.&lt;/p&gt;</comment>
                            <comment id="17868682" author="gus_heck" created="Thu, 25 Jul 2024 12:54:25 +0000"  >&lt;p&gt;Thanks for looking into this, I&apos;m working on a way to support multi-threaded search, I just got tests to pass, but I&apos;m still pondering if it works in real-world use (was about to PR it but just realized I have a remaining doubt)&lt;/p&gt;</comment>
                            <comment id="17868833" author="gus_heck" created="Fri, 26 Jul 2024 00:53:26 +0000"  >&lt;p&gt;Added PR that seems to allow searching with &amp;amp;cpuTimeAllowed and multithreading. Also enabled &amp;amp;timeAllowed for multi-threaded search which probably never needed to be disallowed.&lt;/p&gt;</comment>
                            <comment id="17869629" author="jira-bot" created="Tue, 30 Jul 2024 12:55:13 +0000"  >&lt;p&gt;Commit adc3f7abbd3074dd974dd5a04705565ca69e5332 in solr&apos;s branch refs/heads/main from Gus Heck&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=adc3f7abbd3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=adc3f7abbd3&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt; - ThreadCpuTimer safe for multi-threaded search (#2595)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt; Simplify ThreadCpuTimer by never instantiating it, and instead tracking any number of contexts per thread. This avoids thread safety issues previously caused by keeping state in a field. Ensure explicit correspondence between reported cpu time and the measurement of cpu used by limits when limits are in play. Also add TestInjection for cpu delay and use it in TestCpuAllowedLimit&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17869640" author="jira-bot" created="Tue, 30 Jul 2024 13:24:00 +0000"  >&lt;p&gt;Commit 8ab0278644e2c2731faae9f43c50c959bbe2f712 in solr&apos;s branch refs/heads/main from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=8ab0278644e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=8ab0278644e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13350&quot; title=&quot;Explore collector managers for multi-threaded search&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13350&quot;&gt;&lt;del&gt;SOLR-13350&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt;: multi-threaded search: revert TestFiltering.java change (#2589)&lt;/p&gt;
</comment>
                            <comment id="17869643" author="jira-bot" created="Tue, 30 Jul 2024 13:26:04 +0000"  >&lt;p&gt;Commit e042ba8b3aba771cba61cbb3fd166c0057ffb514 in solr&apos;s branch refs/heads/branch_9x from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=e042ba8b3ab&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=e042ba8b3ab&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13350&quot; title=&quot;Explore collector managers for multi-threaded search&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13350&quot;&gt;&lt;del&gt;SOLR-13350&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt;: multi-threaded search: revert TestFiltering.java change (#2589)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 8ab0278644e2c2731faae9f43c50c959bbe2f712)&lt;/p&gt;</comment>
                            <comment id="17869660" author="gus_heck" created="Tue, 30 Jul 2024 14:35:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt; What was your reason for disallowing RankQuery, GraphQuery and JoinQuery? Tests seem to pass with the check commented out:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;MTCollectorQueryCheck &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; QueryVisitor {

  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; QueryVisitor subVisitor = &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;;

  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; allowMt(Query query) {
    &lt;span class=&quot;code-comment&quot;&gt;//      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (query &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; RankQuery || query &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; GraphQuery || query &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt;
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// JoinQuery) {
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;//        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;;
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;//      }
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
  }
...
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17870192" author="jira-bot" created="Thu, 1 Aug 2024 13:11:42 +0000"  >&lt;p&gt;Commit 15d79eb3f561d6d6321efabb0270b81908e740d9 in solr&apos;s branch refs/heads/branch_9x from Gus Heck&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=15d79eb3f56&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=15d79eb3f56&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt; backport from main. &lt;/p&gt;

&lt;p&gt;Simplify ThreadCpuTimer by never instantiating it, and instead tracking any number of contexts per thread. This avoids thread safety issues previously caused by keeping state in a field. Also add TestInjection for cpu delay and use it in TestCpuAllowedLimit (#2604)&lt;/p&gt;</comment>
                            <comment id="17870633" author="dsmiley" created="Fri, 2 Aug 2024 21:34:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;What was your reason for disallowing RankQuery, GraphQuery and JoinQuery? Tests seem to pass with the check commented out&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Just a guess &amp;#8211; the multiThreaded enablement is often effectively ignored based on internal heuristics on the segment count and other factors (available processor thread count?).  Thus it&apos;s possible those queries you listed do have an issue but the tests using them don&apos;t tickle the heuristics just right to enable them.  &lt;/p&gt;

&lt;p&gt;BTW this JIRA issue starts off with a rant.  That rant very much resonates with me, I was also annoyed and felt things were done improperly, but I don&apos;t think a JIRA description is the place to rant.  Just get to the point of what this JIRA issue is about.  Rant in a comment on the offending issue or on the dev list.&lt;/p&gt;</comment>
                            <comment id="17871482" author="jira-bot" created="Tue, 6 Aug 2024 22:27:29 +0000"  >&lt;p&gt;Commit 7ebbcd3493cc5658ad86480906813144125fbc43 in solr&apos;s branch refs/heads/main from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=7ebbcd3493c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=7ebbcd3493c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13350&quot; title=&quot;Explore collector managers for multi-threaded search&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13350&quot;&gt;&lt;del&gt;SOLR-13350&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt;: use multiThreaded=false default; document multiThreaded parameter; (#2596)&lt;/p&gt;

&lt;p&gt;Co-authored-by: Gus Heck &amp;lt;gus@apache.org&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17871671" author="gus_heck" created="Wed, 7 Aug 2024 14:32:43 +0000"  >&lt;p&gt;Just realized that the posibility of NaN was not actually a new possibility, I just missed the bit where similar code was removed, so removing that from the description.&lt;/p&gt;</comment>
                            <comment id="17871709" author="cpoerschke" created="Wed, 7 Aug 2024 15:49:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;Just realized that the posibility of NaN was not actually a new possibility, I just missed the bit where similar code was removed, so removing that from the description.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks for that! Should we then &lt;em&gt;not&lt;/em&gt; proceed with the &lt;a href=&quot;https://github.com/apache/solr/pull/2588&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/pull/2588&lt;/a&gt; addition of assertions?&lt;/p&gt;</comment>
                            <comment id="17872335" author="gus_heck" created="Fri, 9 Aug 2024 12:35:05 +0000"  >&lt;p&gt;Yeah, probably no need&lt;/p&gt;</comment>
                            <comment id="17873257" author="anshumg" created="Tue, 13 Aug 2024 16:34:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gus&quot; class=&quot;user-hover&quot; rel=&quot;gus&quot;&gt;gus&lt;/a&gt; - should we defer this to the next release ?&lt;/p&gt;</comment>
                            <comment id="17873447" author="jira-bot" created="Wed, 14 Aug 2024 08:31:36 +0000"  >&lt;p&gt;Commit 84d1fbc45e173b3da268215e77c1c8cf7af84c78 in solr&apos;s branch refs/heads/branch_9x from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=84d1fbc45e1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=84d1fbc45e1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13350&quot; title=&quot;Explore collector managers for multi-threaded search&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13350&quot;&gt;&lt;del&gt;SOLR-13350&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt;: use multiThreaded=false default; document multiThreaded parameter; (#2596)&lt;/p&gt;

&lt;p&gt;Co-authored-by: Gus Heck &amp;lt;gus@apache.org&amp;gt;&lt;br/&gt;
(cherry picked from commit 7ebbcd3493cc5658ad86480906813144125fbc43)&lt;/p&gt;</comment>
                            <comment id="17873455" author="jira-bot" created="Wed, 14 Aug 2024 08:42:34 +0000"  >&lt;p&gt;Commit 365cf8915ee55ff0660d5e242bc5fdf845573107 in solr&apos;s branch refs/heads/branch_9_7 from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=365cf8915ee&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=365cf8915ee&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13350&quot; title=&quot;Explore collector managers for multi-threaded search&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13350&quot;&gt;&lt;del&gt;SOLR-13350&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt;: use multiThreaded=false default; document multiThreaded parameter; (#2596)&lt;/p&gt;

&lt;p&gt;Co-authored-by: Gus Heck &amp;lt;gus@apache.org&amp;gt;&lt;br/&gt;
(cherry picked from commit 7ebbcd3493cc5658ad86480906813144125fbc43)&lt;br/&gt;
(cherry picked from commit 84d1fbc45e173b3da268215e77c1c8cf7af84c78)&lt;/p&gt;</comment>
                            <comment id="17873630" author="anshumg" created="Wed, 14 Aug 2024 16:56:34 +0000"  >&lt;p&gt;As this is now an optional feature, I think we can move forward with the release. Is there anything pending here for the next release or can we resolve this?&lt;/p&gt;</comment>
                            <comment id="17873656" author="gus_heck" created="Wed, 14 Aug 2024 17:27:19 +0000"  >&lt;p&gt;We still have an undocumented artificial incompatibility until I get the latest PR back ported. I will try to do that this evening. Life has been busy sorry.&lt;/p&gt;</comment>
                            <comment id="17873791" author="jira-bot" created="Thu, 15 Aug 2024 04:22:38 +0000"  >&lt;p&gt;Commit e5051e8bed85646f268cb93af9305c0842e02c71 in solr&apos;s branch refs/heads/main from Gus Heck&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=e5051e8bed8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=e5051e8bed8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt; verify that graph, join and rerank queries are unaffected by the use of multithreaded search and re-enable them. (#2625)&lt;/p&gt;
</comment>
                            <comment id="17873795" author="jira-bot" created="Thu, 15 Aug 2024 05:45:30 +0000"  >&lt;p&gt;Commit d3c8f74fb79b92ea04780e6d6ee4a535033ef2f6 in solr&apos;s branch refs/heads/branch_9x from Gus Heck&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=d3c8f74fb79&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=d3c8f74fb79&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt; verify that graph, join and rerank queries are unaffected by the use of multithreaded search and re-enable them. (#2625) (#2648)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit e5051e8bed85646f268cb93af9305c0842e02c71)&lt;/p&gt;</comment>
                            <comment id="17874093" author="jira-bot" created="Fri, 16 Aug 2024 01:50:14 +0000"  >&lt;p&gt;Commit ee1198804ff39fad2d5886883991b724e77bd625 in solr&apos;s branch refs/heads/branch_9_7 from Gus Heck&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=ee1198804ff&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=ee1198804ff&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt; verify that graph, join and rerank queries are unaffected by the use of multithreaded search and re-enable them. (#2625) (#2648) (#2649)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit e5051e8bed85646f268cb93af9305c0842e02c71)&lt;/p&gt;</comment>
                            <comment id="17889249" author="jira-bot" created="Mon, 14 Oct 2024 14:46:56 +0000"  >&lt;p&gt;Commit 7405bb19fa424ec79c6daaafd986670dc54d7dfe in solr&apos;s branch refs/heads/main from David Smiley&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=7405bb19fa4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=7405bb19fa4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17414&quot; title=&quot;multiThreaded=true can result in RejectedExecutionException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17414&quot;&gt;&lt;del&gt;SOLR-17414&lt;/del&gt;&lt;/a&gt;: multiThreaded search: don&apos;t throw RejectedExecutionException (#2701)&lt;/p&gt;

&lt;p&gt;When searching with multiThreaded=true, the internal tasks may now block instead of enqueuing with a risk of rejection. Solr will use less resources under stress but to get the most of your machine, you may want to increase the thread pool.&lt;br/&gt;
And:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Revert ExecutorUtil change from &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Revert ExecutorUtil change from &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13350&quot; title=&quot;Explore collector managers for multi-threaded search&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13350&quot;&gt;&lt;del&gt;SOLR-13350&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;rename CoreContainer.collectorManager to indexSearcherExecutor&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17889320" author="jira-bot" created="Mon, 14 Oct 2024 19:43:15 +0000"  >&lt;p&gt;Commit 8d07c7321ce2a789291e139b26898500fc2b9cac in solr&apos;s branch refs/heads/branch_9x from David Smiley&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=8d07c7321ce&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=8d07c7321ce&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17414&quot; title=&quot;multiThreaded=true can result in RejectedExecutionException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17414&quot;&gt;&lt;del&gt;SOLR-17414&lt;/del&gt;&lt;/a&gt;: multiThreaded search: don&apos;t throw RejectedExecutionException (#2701)&lt;/p&gt;

&lt;p&gt;When searching with multiThreaded=true, the internal tasks may now block instead of enqueuing with a risk of rejection. Solr will use less resources under stress but to get the most of your machine, you may want to increase the thread pool.&lt;br/&gt;
And:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Revert ExecutorUtil change from &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17298&quot; title=&quot;Multithreaded search breaks limits, and possibly other things&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17298&quot;&gt;&lt;del&gt;SOLR-17298&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Revert ExecutorUtil change from &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13350&quot; title=&quot;Explore collector managers for multi-threaded search&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13350&quot;&gt;&lt;del&gt;SOLR-13350&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;rename CoreContainer.collectorManager to indexSearcherExecutor&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;(cherry picked from commit 7405bb19fa424ec79c6daaafd986670dc54d7dfe)&lt;/p&gt;</comment>
                            <comment id="17892911" author="anshumg" created="Fri, 25 Oct 2024 17:18:52 +0000"  >&lt;p&gt;Closing after the 9.7.0 release&lt;/p&gt;</comment>
                            <comment id="17926120" author="dsmiley" created="Tue, 11 Feb 2025 18:28:04 +0000"  >&lt;p&gt;I doubt multiThreaded=true has its intended effect with query limits due to how &lt;a href=&quot;https://github.com/apache/solr/blob/861a7761707457a65a3736ecc274cff3c8cb56e5/solr/core/src/java/org/apache/solr/search/SolrIndexSearcher.java#L779&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;SolrIndexSearcher.search&lt;/a&gt; works (something I worked on).  Notice this method creates a new IndexSearcher using its simplest constructor, thus without the executor.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310361">
                    <name>Blocked</name>
                                                                <inwardlinks description="Blocked">
                                        <issuelink>
            <issuekey id="13567471">SOLR-17150</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13224397">SOLR-13350</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13551147">SOLR-16986</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            39 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1paj4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>