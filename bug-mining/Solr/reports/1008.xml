<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:29:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3775] Unexpected RuntimeException</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3775</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Hi. I&apos;m using Solr 4.0 Beta (no modifications to default installation) to index, and it&apos;s blowing up on Word *.DOC files:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;curl
&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/update/extract?literal.id=doc15&amp;amp;commit=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; -F &lt;span class=&quot;code-quote&quot;&gt;&quot;myfile=@15.doc&quot;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here&apos;s the exception. And the same files go through Solr 3.6.1 just fine.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    &amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
    &amp;lt;response&amp;gt;
    &amp;lt;lst name=&quot;responseHeader&quot;&amp;gt;&amp;lt;int name=&quot;status&quot;&amp;gt;500&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;QTime&quot;&amp;gt;18&amp;lt;/int
    &amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;lst name=&quot;error&quot;&amp;gt;&amp;lt;str
name=&quot;msg&quot;&amp;gt;org.apache.tika.exception.TikaException
    : Unexpected RuntimeException from
org.apache.tika.parser.microsoft.OfficeParser
    @328c62ce&amp;lt;/str&amp;gt;&amp;lt;str name=&quot;trace&quot;&amp;gt;org.apache.solr.common.SolrException: 
org.apache.tika.exception.TikaException: Unexpected RuntimeException from org.apache.tika.parser.microsoft.OfficeParser@328c62ce
            at
org.apache.solr.handler.extraction.ExtractingDocumentLoader.load(Extr
    actingDocumentLoader.java:230)
            at
org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(Co
    ntentStreamHandlerBase.java:74)
            at
org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandl
    erBase.java:129)
            at
org.apache.solr.core.RequestHandlers$LazyRequestHandlerWrapper.handle
    Request(RequestHandlers.java:240)
            at org.apache.solr.core.SolrCore.execute(SolrCore.java:1656)
            at
org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter
    .java:454)
            at
org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilte
    r.java:275)
            at
org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(Servlet
    Handler.java:1337)
            at
org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java
    :484)
            at
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.j
    ava:119)
            at
org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:524)
            at
org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandl
    er.java:233)
            at
org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandl
    er.java:1065)
            at
org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:
    413)
            at
org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandle
    r.java:192)
            at
org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandle
    r.java:999)
            at
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.j
    ava:117)
            at
org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(Cont
    extHandlerCollection.java:250)
            at
org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerColl
    ection.java:149)
            at
org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper
    .java:111)
            at org.eclipse.jetty.server.Server.handle(Server.java:351)
            at
org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(Abstrac
    tHttpConnection.java:454)
            at
org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(Blockin
    gHttpConnection.java:47)
            at
org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(Abstra
    ctHttpConnection.java:890)
            at
org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.header
    Complete(AbstractHttpConnection.java:944)
            at
org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:642)
            at
org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:230)

            at
org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpCo
    nnection.java:66)
            at
org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(So
    cketConnector.java:254)
            at
org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPoo
    l.java:599)
            at
org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool
    .java:534)
            at java.lang.Thread.run(Unknown Source)
    Caused by: org.apache.tika.exception.TikaException: Unexpected RuntimeException
    from org.apache.tika.parser.microsoft.OfficeParser@328c62ce
            at
org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:244
    )
            at
org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242
    )
            at
org.apache.tika.parser.AutoDetectParser.parse(AutoDetectParser.java:1
    20)
            at
org.apache.solr.handler.extraction.ExtractingDocumentLoader.load(Extr
    actingDocumentLoader.java:224)
            ... 31 more
    Caused by: java.lang.ArrayIndexOutOfBoundsException: 7
            at
org.apache.poi.util.LittleEndian.getInt(LittleEndian.java:163)
            at
org.apache.poi.hwpf.model.Colorref.&amp;amp;lt;init&amp;amp;gt;(Colorref.java:81)
            at
org.apache.poi.hwpf.model.types.SHDAbstractType.fillFields(SHDAbstrac
    tType.java:56)
            at
org.apache.poi.hwpf.usermodel.ShadingDescriptor.&amp;amp;lt;init&amp;amp;gt;(ShadingD
    escriptor.java:38)
            at
org.apache.poi.hwpf.sprm.CharacterSprmUncompressor.unCompressCHPOpera
    tion(CharacterSprmUncompressor.java:582)
            at
org.apache.poi.hwpf.sprm.CharacterSprmUncompressor.uncompressCHP(Char
    acterSprmUncompressor.java:65)
            at
org.apache.poi.hwpf.model.StyleSheet.createChp(StyleSheet.java:288)
            at
org.apache.poi.hwpf.model.StyleSheet.&amp;amp;lt;init&amp;amp;gt;(StyleSheet.java:121
    )
            at
org.apache.poi.hwpf.HWPFDocument.&amp;amp;lt;init&amp;amp;gt;(HWPFDocument.java:346)
            at
org.apache.tika.parser.microsoft.WordExtractor.parse(WordExtractor.ja
    va:77)
            at
org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java
    :185)
            at
org.apache.tika.parser.microsoft.OfficeParser.parse(OfficeParser.java
    :160)
            at
org.apache.tika.parser.CompositeParser.parse(CompositeParser.java:242
    )
            ... 34 more
    &amp;lt;/str&amp;gt;&amp;lt;int name=&quot;code&quot;&amp;gt;500&amp;lt;/int&amp;gt;&amp;lt;/lst&amp;gt;
    &amp;lt;/response&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12605638">SOLR-3775</key>
            <summary>Unexpected RuntimeException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="10101">Abandoned</resolution>
                                        <assignee username="uschindler">Uwe Schindler</assignee>
                                    <reporter username="acougarm">Alex C</reporter>
                        <labels>
                    </labels>
                <created>Fri, 31 Aug 2012 05:33:47 +0000</created>
                <updated>Fri, 31 Aug 2012 12:55:00 +0000</updated>
                            <resolved>Fri, 31 Aug 2012 06:31:52 +0000</resolved>
                                    <version>4.0-BETA</version>
                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13445694" author="thetaphi" created="Fri, 31 Aug 2012 05:43:56 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
as the exception suggests, this issue has nothing to do with Apache Solr, i is caused by the libraray called &lt;a href=&quot;http://tika.apache.org/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Apache TIKA&lt;/a&gt; that itsself uses &lt;a href=&quot;http://poi.apache.org/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Apache POI&lt;/a&gt; that is bundled with extracting module to do the file parsing stuff. We cannot fix this issue, it would be better to report this to the &lt;a href=&quot;https://issues.apache.org/jira/browse/TIKA&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;TIKA issue tracker&lt;/a&gt; - which may also forward you to Apache POI (which is the root cause of this issue) - so you&apos;d better open the issue on &lt;a href=&quot;https://issues.apache.org/bugzilla/buglist.cgi?product=POI&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;their side&lt;/a&gt;. It would be also good to attach the .doc file causing this to their issue.&lt;/p&gt;</comment>
                            <comment id="13445699" author="thetaphi" created="Fri, 31 Aug 2012 05:52:44 +0000"  >&lt;p&gt;This might be your issue: &lt;a href=&quot;https://issues.apache.org/bugzilla/show_bug.cgi?id=39526&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://issues.apache.org/bugzilla/show_bug.cgi?id=39526&lt;/a&gt;, a full list of those issues is: &lt;a href=&quot;https://issues.apache.org/bugzilla/buglist.cgi?query_format=specific&amp;amp;order=relevance+desc&amp;amp;bug_status=__open__&amp;amp;product=POI&amp;amp;content=ArrayIndexOutOfBoundsException&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://issues.apache.org/bugzilla/buglist.cgi?query_format=specific&amp;amp;order=relevance+desc&amp;amp;bug_status=__open__&amp;amp;product=POI&amp;amp;content=ArrayIndexOutOfBoundsException&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13445706" author="acougarm" created="Fri, 31 Aug 2012 06:03:49 +0000"  >&lt;p&gt;Thanks, Uwe. &lt;/p&gt;</comment>
                            <comment id="13445720" author="thetaphi" created="Fri, 31 Aug 2012 06:31:52 +0000"  >&lt;p&gt;This is a POI (or TIKA) issue.&lt;/p&gt;</comment>
                            <comment id="13445772" author="thetaphi" created="Fri, 31 Aug 2012 08:36:06 +0000"  >&lt;p&gt;Just to inform you: I added an explicit test for a Word 97-2003 document to Solr, which passes perfectly like pdf, docx,... (trunk revision 1379357, 4.x branch 1379358). So it must be an issue with your word documents or a new bug in Apache POI (because 4.0 uses a newer TIKA/POI version than 3.6).&lt;/p&gt;</comment>
                            <comment id="13445886" author="jkrupan" created="Fri, 31 Aug 2012 12:55:00 +0000"  >&lt;p&gt;Thanks for reporting the issue. Although it is true that the Solr project can&apos;t fix Tika/POI issues directly, it is very useful for us to be able to report to Solr/SolrCell users that MS Word 97 may encounter ingestion problems.&lt;/p&gt;

&lt;p&gt;Can you confirm whether none of your Word 97 files are being parsed, or is it just some of them?&lt;/p&gt;

&lt;p&gt;This may be this POI bug:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/bugzilla/show_bug.cgi?id=53380&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://issues.apache.org/bugzilla/show_bug.cgi?id=53380&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Please comment on that bug directly if you feel it does match and indicate its level of importance to you. It does not appear to have seen any activity since it was reported back in June.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>243215</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03cpj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17492</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>