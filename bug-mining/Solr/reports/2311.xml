<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:01:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7039] First collection created with stateFormat=2 results in a weird /clusterstate.json</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7039</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;With the 5.0 branch, when I do:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;bin/solr -c &amp;amp;&amp;amp; bin/solr create -c foo
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;tt&gt;/clusterstate.json&lt;/tt&gt; in ZK has and invalid definition of the foo collection&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;:{
    &lt;span class=&quot;code-quote&quot;&gt;&quot;replicationFactor&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;router&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;compositeId&quot;&lt;/span&gt;},
    &lt;span class=&quot;code-quote&quot;&gt;&quot;maxShardsPerNode&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;autoAddReplicas&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;shards&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;shard1&quot;&lt;/span&gt;:{
        &lt;span class=&quot;code-quote&quot;&gt;&quot;range&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;80000000-7fffffff&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;state&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;active&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;replicas&quot;&lt;/span&gt;:{}}}}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;To verify this isn&apos;t the UI sending back the wrong data, I went into the zkCli.sh command-line and got:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[zk: localhost:9983(CONNECTED) 2] get /clusterstate.json
{&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;:{
    &lt;span class=&quot;code-quote&quot;&gt;&quot;replicationFactor&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;router&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;compositeId&quot;&lt;/span&gt;},
    &lt;span class=&quot;code-quote&quot;&gt;&quot;maxShardsPerNode&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;autoAddReplicas&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;shards&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;shard1&quot;&lt;/span&gt;:{
        &lt;span class=&quot;code-quote&quot;&gt;&quot;range&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;80000000-7fffffff&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;state&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;active&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;replicas&quot;&lt;/span&gt;:{}}}}}
cZxid = 0x20
ctime = Mon Jan 26 14:56:44 MST 2015
mZxid = 0x65
mtime = Mon Jan 26 14:57:16 MST 2015
pZxid = 0x20
cversion = 0
dataVersion = 1
aclVersion = 0
ephemeralOwner = 0x0
dataLength = 247
numChildren = 0
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The &lt;tt&gt;/collections/foo/state.json&lt;/tt&gt; looks correct:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;foo&quot;&lt;/span&gt;:{
    &lt;span class=&quot;code-quote&quot;&gt;&quot;replicationFactor&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;router&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;compositeId&quot;&lt;/span&gt;},
    &lt;span class=&quot;code-quote&quot;&gt;&quot;maxShardsPerNode&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;autoAddReplicas&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;shards&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;shard1&quot;&lt;/span&gt;:{
        &lt;span class=&quot;code-quote&quot;&gt;&quot;range&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;80000000-7fffffff&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;state&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;active&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;replicas&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;core_node1&quot;&lt;/span&gt;:{
            &lt;span class=&quot;code-quote&quot;&gt;&quot;core&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;foo_shard1_replica1&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;base_url&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//192.168.1.2:8983/solr&quot;&lt;/span&gt;,
&lt;/span&gt;            &lt;span class=&quot;code-quote&quot;&gt;&quot;node_name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;192.168.1.2:8983_solr&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;state&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;active&quot;&lt;/span&gt;,
            &lt;span class=&quot;code-quote&quot;&gt;&quot;leader&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;}}}}}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Here&apos;s the weird thing ... If I create a second collection using the same script, all is well and /clusterstate.json is empty&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;bin/solr create -c foo2
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Calling this a blocker because 5.0 can&apos;t be released with this happening.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12770203">SOLR-7039</key>
            <summary>First collection created with stateFormat=2 results in a weird /clusterstate.json</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="noble.paul">Noble Paul</assignee>
                                    <reporter username="thelabdude">Timothy Potter</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Jan 2015 22:03:26 +0000</created>
                <updated>Mon, 9 May 2016 18:54:53 +0000</updated>
                            <resolved>Tue, 27 Jan 2015 13:46:10 +0000</resolved>
                                    <version>5.0</version>
                                    <fixVersion>5.0</fixVersion>
                    <fixVersion>5.1</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14293427" author="noble.paul" created="Tue, 27 Jan 2015 12:24:55 +0000"  >&lt;p&gt;The bug was due to the serialization logic of clusterstate.&lt;/p&gt;</comment>
                            <comment id="14293486" author="jira-bot" created="Tue, 27 Jan 2015 13:21:29 +0000"  >&lt;p&gt;Commit 1655032 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1655032&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1655032&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7039&quot; title=&quot;First collection created with stateFormat=2 results in a weird /clusterstate.json&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7039&quot;&gt;&lt;del&gt;SOLR-7039&lt;/del&gt;&lt;/a&gt; First collection created with stateFormat=2 writes to clusterstate.json also&lt;/p&gt;</comment>
                            <comment id="14293500" author="jira-bot" created="Tue, 27 Jan 2015 13:31:03 +0000"  >&lt;p&gt;Commit 1655036 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1655036&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1655036&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7039&quot; title=&quot;First collection created with stateFormat=2 results in a weird /clusterstate.json&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7039&quot;&gt;&lt;del&gt;SOLR-7039&lt;/del&gt;&lt;/a&gt; First collection created with stateFormat=2 writes to clusterstate.json also&lt;/p&gt;</comment>
                            <comment id="14293529" author="jira-bot" created="Tue, 27 Jan 2015 13:44:29 +0000"  >&lt;p&gt;Commit 1655039 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_5_0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1655039&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1655039&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7039&quot; title=&quot;First collection created with stateFormat=2 results in a weird /clusterstate.json&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7039&quot;&gt;&lt;del&gt;SOLR-7039&lt;/del&gt;&lt;/a&gt; First collection created with stateFormat=2 writes to clusterstate.json also&lt;/p&gt;</comment>
                            <comment id="14332784" author="anshumg" created="Mon, 23 Feb 2015 05:01:54 +0000"  >&lt;p&gt;Bulk close after 5.0 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12694772" name="SOLR-7039.patch" size="4697" author="noble.paul" created="Tue, 27 Jan 2015 12:24:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24tgn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>