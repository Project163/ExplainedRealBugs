<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:50:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16089] DOWN replica causes missing data on Cloud&gt;Nodes admin ui screen for unrelated nodes</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16089</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;If a node is &lt;tt&gt;/live_nodes&lt;/tt&gt;, but a replica hosted on that node is &lt;tt&gt;DOWN&lt;/tt&gt; ( or missing from the Metrics API response section for that node for any other reason) this breaks a brittle assumption in the &lt;tt&gt;cloud.js&lt;/tt&gt; logic that generates the data structure used to power the &lt;tt&gt;/solr/#/~cloud?view=nodes&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;The current assumption is that &lt;em&gt;any&lt;/em&gt; replica found in the &lt;tt&gt;CLUSTERSTATUS&lt;/tt&gt; response, hosted on a live_node, will be found in the Metrics API response &amp;#8211; when this is not true, the javascript throws a &lt;tt&gt;TypeError&lt;/tt&gt; while looping over the metrics API response, leaving the datastructure it was building incomplete.&lt;/p&gt;

&lt;p&gt;This means that, depending on &lt;em&gt;where&lt;/em&gt; in the (effectively) random order that the metrics API returns node details, all or some of the nodes visible on the resulting admin UI screen will be missing data from the metrics API (most notably in the Disk Usage column) depending on whether they came &quot;after&quot; the node hosting the problematic replica.&lt;/p&gt;

&lt;p&gt;There is nothing obvious in the UI to indicate that a particular node/replica is having a problem &amp;#8211; making it particularly hard to identify why columns like Disk Usage are &quot;blank&quot;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13432706">SOLR-16089</key>
            <summary>DOWN replica causes missing data on Cloud&gt;Nodes admin ui screen for unrelated nodes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Tue, 8 Mar 2022 21:43:38 +0000</created>
                <updated>Wed, 26 Apr 2023 23:31:52 +0000</updated>
                            <resolved>Tue, 15 Mar 2022 18:03:16 +0000</resolved>
                                                    <fixVersion>8.11.2</fixVersion>
                    <fixVersion>9.1</fixVersion>
                                    <component>Admin UI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17503193" author="hossman" created="Tue, 8 Mar 2022 21:55:06 +0000"  >&lt;p&gt;Steps to reproduce...&lt;/p&gt;

&lt;p&gt;1. Create the example cloud cluster with some data and shutdown &quot;node2&quot;...&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;./bin/solr -e cloud -noprompt
./bin/post -c gettingstarted example/exampledocs/books.csv
./bin/solr stop -p 7574
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;(At this point, if you load the admin UI, the Cloud&amp;gt;Nodes screen will function as designed &#8211; it will recognize that some of the replicas in the CLUSTERSTATUS are on nodes that are not alive, and that node will be highlighted in RED w/o causing any problems viewing the data from the other node)&lt;/p&gt;

&lt;p&gt;2. Pick a replica on node2 and jack it up so that even when the node is restarted, the replica can&apos;t even start recovery&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;rm -rf example/cloud/node2/solr/gettingstarted_shard2_*/data/*
chmod a-w example/cloud/node2/solr/gettingstarted_shard2_*/data/
./bin/solr start -cloud -p 7574 -s example/cloud/node2/solr -z localhost:9983
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;ul&gt;
	&lt;li&gt;Now the cluster status will say we have a down replica on a live node&lt;/li&gt;
	&lt;li&gt;The metrics API response will not list the down core at all&lt;/li&gt;
	&lt;li&gt;the absence of data from the DOWN replica (may) cause the Disk Usage column to be completley empty for both nodes, depending on what order the nodes were returned in my the metrics API
	&lt;ul&gt;
		&lt;li&gt;see attached screenshot&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17503211" author="hossman" created="Tue, 8 Mar 2022 22:44:21 +0000"  >&lt;p&gt;Attaching a patch with a fix.&lt;/p&gt;

&lt;p&gt;Beyond just preventing the &lt;tt&gt;TypeError&lt;/tt&gt; from aborting the logic for all other nodes, this patch moves a few bits of logic around so that data which is not directly dependent on the core metrics is still included in the response for each core, even if the core is not included in the metrics response (notable: the replica status)&lt;/p&gt;</comment>
                            <comment id="17503406" author="janhoy" created="Wed, 9 Mar 2022 08:59:42 +0000"  >&lt;p&gt;Thanks for reporting and diving into the complex relationship between these data sources! I skimmed your patch and understand the issue. I did not attempt to understand every single line of the patch though, and I have not spun it up for a test.&lt;br/&gt;
I&apos;m +1 to trust your thorough approach, so feel free to merge. But if you need a deeper peer reivew, let us know - I might find some time this week to take it for a spin and re-read the patch.&lt;/p&gt;</comment>
                            <comment id="17507121" author="jira-bot" created="Tue, 15 Mar 2022 17:44:35 +0000"  >&lt;p&gt;Commit 8d164438fb7d88b0f544aeeb96f7f2c3f90f23d9 in solr&apos;s branch refs/heads/main from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=8d16443&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=8d16443&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16089&quot; title=&quot;DOWN replica causes missing data on Cloud&amp;gt;Nodes admin ui screen for unrelated nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16089&quot;&gt;&lt;del&gt;SOLR-16089&lt;/del&gt;&lt;/a&gt;: Fix empty columns in Cloud Node UI Screen when replica is in down state.&lt;/p&gt;</comment>
                            <comment id="17507138" author="jira-bot" created="Tue, 15 Mar 2022 18:02:06 +0000"  >&lt;p&gt;Commit b326de297924c2b92606efe697a9432c76c75b7b in solr&apos;s branch refs/heads/branch_9x from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=b326de2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=b326de2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16089&quot; title=&quot;DOWN replica causes missing data on Cloud&amp;gt;Nodes admin ui screen for unrelated nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16089&quot;&gt;&lt;del&gt;SOLR-16089&lt;/del&gt;&lt;/a&gt;: Fix empty columns in Cloud Node UI Screen when replica is in down state.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 8d164438fb7d88b0f544aeeb96f7f2c3f90f23d9)&lt;/p&gt;</comment>
                            <comment id="17507139" author="hossman" created="Tue, 15 Mar 2022 18:03:16 +0000"  >&lt;p&gt;Thanks Jan.&lt;/p&gt;

&lt;p&gt;It&apos;s a pretty low risk change (but also not a high severity bug) so i went ahead and committed to main &amp;amp; 9x.&lt;/p&gt;</comment>
                            <comment id="17536151" author="jira-bot" created="Thu, 12 May 2022 14:33:50 +0000"  >&lt;p&gt;Commit 7d4ea50e7608e0199c8f176d36a76582b681a2cf in lucene-solr&apos;s branch refs/heads/branch_8_11 from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7d4ea50e760&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7d4ea50e760&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16089&quot; title=&quot;DOWN replica causes missing data on Cloud&amp;gt;Nodes admin ui screen for unrelated nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16089&quot;&gt;&lt;del&gt;SOLR-16089&lt;/del&gt;&lt;/a&gt;: Fix empty columns in Cloud Node UI Screen when replica is in down state.&lt;/p&gt;

&lt;p&gt;Backport from &lt;a href=&quot;https://github.com/apache/solr/commit/8d164438fb7d88b0f544aeeb96f7f2c3f90f23d9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/commit/8d164438fb7d88b0f544aeeb96f7f2c3f90f23d9&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17557594" author="mdrob" created="Wed, 22 Jun 2022 17:34:48 +0000"  >&lt;p&gt;Closing after the 8.11.2 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13534236">SOLR-16773</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13040851" name="SOLR-16089.patch" size="4996" author="hossman" created="Tue, 8 Mar 2022 22:44:17 +0000"/>
                            <attachment id="13040849" name="SOLR-16089.screenshot.png" size="131853" author="hossman" created="Tue, 8 Mar 2022 21:55:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 20 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10aps:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>