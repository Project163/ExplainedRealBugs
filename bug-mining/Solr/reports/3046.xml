<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:15:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9363] TestStressCloudBlindAtomicUpdates.test_dv_stored() failure</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9363</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;My Jenkins found a reproducing seed - though note that in order to reproduce I had to a) run the test at the same SHA as the one listed, and b) leave off &lt;tt&gt;-Dtests.method=test_dv_stored&lt;/tt&gt;; under those conditions it failed both times I ran it:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Checking out Revision 53a34b312e78ce6f56c0bb41304ac834b28b9534 (refs/remotes/origin/master)
[...]
  [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=TestStressCloudBlindAtomicUpdates -Dtests.method=test_dv_stored -Dtests.seed=60C9AAFC94FD8921 -Dtests.multiplier=2 -Dtests.nightly=true -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=id -Dtests.timezone=America/Puerto_Rico -Dtests.asserts=true -Dtests.file.encoding=UTF-8
   [junit4] FAILURE 9.09s J0 | TestStressCloudBlindAtomicUpdates.test_dv_stored &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: expected:&amp;lt;332&amp;gt; but was:&amp;lt;205&amp;gt;
   [junit4]    &amp;gt;        at __randomizedtesting.SeedInfo.seed([60C9AAFC94FD8921:F2F5CB7828BAB4F9]:0)
   [junit4]    &amp;gt;        at org.apache.solr.cloud.TestStressCloudBlindAtomicUpdates.checkField(TestStressCloudBlindAtomicUpdates.java:253)
   [junit4]    &amp;gt;        at org.apache.solr.cloud.TestStressCloudBlindAtomicUpdates.test_dv_stored(TestStressCloudBlindAtomicUpdates.java:192)
   [junit4]    &amp;gt;        at java.lang.Thread.run(Thread.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12994000">SOLR-9363</key>
            <summary>TestStressCloudBlindAtomicUpdates.test_dv_stored() failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="sarowe">Steven Rowe</reporter>
                        <labels>
                    </labels>
                <created>Mon, 1 Aug 2016 15:39:01 +0000</created>
                <updated>Sat, 8 Jun 2019 15:37:02 +0000</updated>
                            <resolved>Tue, 2 Aug 2016 18:30:20 +0000</resolved>
                                                    <fixVersion>6.2</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15402270" author="steve_rowe" created="Mon, 1 Aug 2016 15:41:00 +0000"  >&lt;p&gt;Attaching the compressed log, trimmed to include just the failing test output.&lt;/p&gt;</comment>
                            <comment id="15402486" author="hossman" created="Mon, 1 Aug 2016 17:46:15 +0000"  >&lt;p&gt;I&apos;ve started looking into his.&lt;/p&gt;

&lt;p&gt;So far, my experience mostly matches sarowe&apos;s...&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;in order to reproduce I had to a) run the test at the same SHA as the one listed, and b) leave off &lt;tt&gt;-Dtests.method=test_dv_stored&lt;/tt&gt;; under those conditions it failed both times I ran it&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;...except that i have definitely seen the failure reproduce multiple times on the HEAD of master, w/o needing to explicitly check out that GIT SHA (which is a relief, because the only diff between 53a34b312 and d86c369533 (current HEAD) is some css and html changes to the admin UI which would have been confusing as hell)&lt;/p&gt;


&lt;p&gt;Since the test passes when &lt;tt&gt;-Dtests.method=test_dv_stored&lt;/tt&gt; is included in the run line, that suggests that the failure is related to some sort of state left over from previous method runs that doesn&apos;t exist when running a single test &amp;#8211; this is certainly possible since it&apos;s a cloud test that re-uses a MiniSolrCloudCluster and collection &amp;#8211; it&apos;s certainly where i&apos;ll start digging into the logs.&lt;/p&gt;

&lt;p&gt;&amp;#8212;&lt;/p&gt;

&lt;p&gt;One other note: All the failures i see happen at the same point as sarowe, and with teh same &quot;expected&quot; value, but the actual value seems to vary...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: expected:&amp;lt;332&amp;gt; but was:&amp;lt;264&amp;gt;

   [junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: expected:&amp;lt;332&amp;gt; but was:&amp;lt;330&amp;gt;

   [junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: expected:&amp;lt;332&amp;gt; but was:&amp;lt;264&amp;gt;

   [junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: expected:&amp;lt;332&amp;gt; but was:&amp;lt;263&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15403074" author="hossman" created="Tue, 2 Aug 2016 00:08:16 +0000"  >&lt;p&gt;I should have mentioned earlier, but the particular assertion that fails is before the test even gets started on anything remotely interesting related to atomic updates &amp;#8211; it&apos;s a beginning of the test sanity check that the index is starting with the expected number of documents.&lt;/p&gt;

&lt;p&gt;After getting hung up on a small red herring for a bit (git bisect identified a commit related to &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-7390&quot; title=&quot;Let BKDWriter use temp heap for sorting points in proportion to IndexWriter&amp;#39;s indexing buffer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-7390&quot;&gt;&lt;del&gt;LUCENE-7390&lt;/del&gt;&lt;/a&gt; &amp;#8211; which has to do with IndexWriter buffering &amp;#8211; as being where this seed started fail, but it turns out RandomCodec was modified in that commit to consume more entropy, which makes it meaninless if this seed passed prior to that commit) I&apos;ve been wading through things and i think ultimatley i&apos;ve identified 2 unrelated problems:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;TestInjection&apos;s use of Random doesn&apos;t create reproducible sequences of events when running individual test methods vs an entire class&lt;/li&gt;
	&lt;li&gt;replicas which are in the middle of recovery will ignore explicit commits (ie: &lt;tt&gt;Ignoring commit while not ACTIVE - state: BUFFERING replay: false&lt;/tt&gt;) but will aparently still participate in search requests.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;...neither of which really has anything to do with atomic updates.&lt;/p&gt;

&lt;p&gt;I&apos;ll file more detailed bugs on both of these issues, in the meantime i&apos;m pretty sure that in this test i can work around the combination of #1 + #2 ... details once i do some experimenting.&lt;/p&gt;</comment>
                            <comment id="15403178" author="hossman" created="Tue, 2 Aug 2016 01:23:48 +0000"  >&lt;p&gt;Here&apos;s a patch i&apos;m currently hammering at on my laptop.&lt;/p&gt;

&lt;p&gt;because of hte nature of the change, the old seed no longer produces the same sequence of events, but using &lt;tt&gt;-Dtests.nightly=true -Dtests.multiplier=3 -Dtests.asserts=true&lt;/tt&gt; should help tickle TestInjection related &quot;failures&quot; as much as possible (due to the use of &lt;tt&gt;atLeast(...)&lt;/tt&gt; and &lt;tt&gt;usually()&lt;/tt&gt;)&lt;/p&gt;</comment>
                            <comment id="15404246" author="jira-bot" created="Tue, 2 Aug 2016 16:01:48 +0000"  >&lt;p&gt;Commit c17605b4a9978311b6b231f202d70dd800e473e6 in lucene-solr&apos;s branch refs/heads/branch_6x from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c17605b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c17605b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9363&quot; title=&quot;TestStressCloudBlindAtomicUpdates.test_dv_stored() failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9363&quot;&gt;&lt;del&gt;SOLR-9363&lt;/del&gt;&lt;/a&gt;: tweak test to work around &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9366&quot; title=&quot;replicas in LIR seem to still be participating in search requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9366&quot;&gt;SOLR-9366&lt;/a&gt; + &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9367&quot; title=&quot;TestInjection&amp;#39;s use of a static Random means that sequences of events can be diff for the same test seed depending on wether individual methods are run, or entire test classes, or multiple classes in the same slave JVM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9367&quot;&gt;&lt;del&gt;SOLR-9367&lt;/del&gt;&lt;/a&gt; since those issues are not key to what&apos;s being tested here&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 04321c401c6584395c76c509f8513c5e5e4730ee)&lt;/p&gt;</comment>
                            <comment id="15404249" author="jira-bot" created="Tue, 2 Aug 2016 16:01:53 +0000"  >&lt;p&gt;Commit 04321c401c6584395c76c509f8513c5e5e4730ee in lucene-solr&apos;s branch refs/heads/master from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=04321c4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=04321c4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9363&quot; title=&quot;TestStressCloudBlindAtomicUpdates.test_dv_stored() failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9363&quot;&gt;&lt;del&gt;SOLR-9363&lt;/del&gt;&lt;/a&gt;: tweak test to work around &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9366&quot; title=&quot;replicas in LIR seem to still be participating in search requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9366&quot;&gt;SOLR-9366&lt;/a&gt; + &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9367&quot; title=&quot;TestInjection&amp;#39;s use of a static Random means that sequences of events can be diff for the same test seed depending on wether individual methods are run, or entire test classes, or multiple classes in the same slave JVM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9367&quot;&gt;&lt;del&gt;SOLR-9367&lt;/del&gt;&lt;/a&gt; since those issues are not key to what&apos;s being tested here&lt;/p&gt;</comment>
                            <comment id="15438998" author="mikemccand" created="Fri, 26 Aug 2016 13:59:34 +0000"  >&lt;p&gt;Bulk close resolved issues after 6.2.0 release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12972506">SOLR-9159</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12994130">SOLR-9366</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12994138">SOLR-9367</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12821342" name="Lucene-Solr-Nightly-master.271.log.gz" size="3583901" author="sarowe" created="Mon, 1 Aug 2016 15:41:00 +0000"/>
                            <attachment id="12821478" name="SOLR-9363.patch" size="2624" author="hossman" created="Tue, 2 Aug 2016 01:23:48 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31r6n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>