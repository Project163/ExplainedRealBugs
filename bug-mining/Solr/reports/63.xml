<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:05:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-320] DirectUpdateHandler2 threading issue</title>
                <link>https://issues.apache.org/jira/browse/SOLR-320</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;While working on an embedded Solr solution, I noticed that one of the threads created during typical usage of (SolrCore, DocumentBuilder and UpdateHandler), was not dying.&lt;/p&gt;

&lt;p&gt;I wrote a small embedded Solr app, and running it under JDB made it clear that the environment was not finishing cleanly because of a thread called &quot;pool-2-thread-1&quot; in &quot;cond. waiting&quot; state. After a quick grep, I saw that only one class uses a thread pool, and that is the DirectUpdateHandler2. It uses an instance of ScheduledExecutorService to manage autocommit threads, but it apparently isn&apos;t dieing correctly.&lt;/p&gt;

&lt;p&gt;I&apos;ll start working on a patch, but the original author of the handler probably has more knowledge (see &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-65&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-65&lt;/a&gt;)&lt;/p&gt;</description>
                <environment>&lt;p&gt;Ubuntu 7.04, Java 1.6.0-b105&lt;/p&gt;</environment>
        <key id="12374680">SOLR-320</key>
            <summary>DirectUpdateHandler2 threading issue</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="klaasm">Mike Klaas</assignee>
                                    <reporter username="stuhood">Stu Hood</reporter>
                        <labels>
                    </labels>
                <created>Thu, 26 Jul 2007 15:07:26 +0000</created>
                <updated>Fri, 10 May 2013 10:40:00 +0000</updated>
                            <resolved>Thu, 26 Jul 2007 17:12:51 +0000</resolved>
                                    <version>1.2</version>
                                    <fixVersion>1.3</fixVersion>
                                    <component>update</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12515731" author="stuhood" created="Thu, 26 Jul 2007 15:08:59 +0000"  >&lt;p&gt;Linking back to the original patch, to get the attention of someone more knowledgable.&lt;/p&gt;</comment>
                            <comment id="12515734" author="stuhood" created="Thu, 26 Jul 2007 15:16:22 +0000"  >&lt;p&gt;Here is a little embedded Solr testcase that exhibits the problem. See the README file for instructions.&lt;/p&gt;</comment>
                            <comment id="12515746" author="stuhood" created="Thu, 26 Jul 2007 15:38:06 +0000"  >&lt;p&gt;Additionally, with the attached files, I noticed that disabling autoCommit fixes the problem.&lt;/p&gt;</comment>
                            <comment id="12515784" author="klaasm" created="Thu, 26 Jul 2007 17:09:48 +0000"  >&lt;p&gt;Thanks for the bug report!  I should be able to fix this momentarily.&lt;/p&gt;</comment>
                            <comment id="12515788" author="klaasm" created="Thu, 26 Jul 2007 17:12:23 +0000"  >&lt;p&gt;This fixes the problem for me:&lt;/p&gt;

&lt;p&gt;Index: src/java/org/apache/solr/update/DirectUpdateHandler2.java&lt;br/&gt;
===================================================================&lt;br/&gt;
&amp;#8212; src/java/org/apache/solr/update/DirectUpdateHandler2.java   (revision 559884)&lt;br/&gt;
+++ src/java/org/apache/solr/update/DirectUpdateHandler2.java   (working copy)&lt;br/&gt;
@@ -566,6 +566,7 @@&lt;br/&gt;
         tracker.pending.cancel( true );&lt;br/&gt;
         tracker.pending = null;&lt;br/&gt;
       }&lt;br/&gt;
+      tracker.scheduler.shutdown(); &lt;br/&gt;
       doDeletions();&lt;br/&gt;
       closeSearcher();&lt;br/&gt;
       closeWriter();&lt;/p&gt;</comment>
                            <comment id="12515789" author="klaasm" created="Thu, 26 Jul 2007 17:12:51 +0000"  >&lt;p&gt;Fixed in r559887&lt;/p&gt;</comment>
                            <comment id="12515799" author="stuhood" created="Thu, 26 Jul 2007 17:38:45 +0000"  >&lt;p&gt;Thanks Mike!&lt;/p&gt;</comment>
                            <comment id="12515809" author="skeptikos" created="Thu, 26 Jul 2007 17:53:38 +0000"  >&lt;p&gt;This was biting me too... thanks for filing the detailed report + testcase, Stu, and the super-quick fix, Mike!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12354643">SOLR-65</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12362622" name="solr-runner.tgz" size="24793" author="stuhood" created="Thu, 26 Jul 2007 15:16:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7271</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            18 years, 18 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03xiv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>20864</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>