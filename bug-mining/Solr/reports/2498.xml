<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:05:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7493] Requests aren&apos;t distributed evenly if the collection isn&apos;t present locally</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7493</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I had a SolrCloud cluster where every node is behind a simple round-robin load balancer.&lt;br/&gt;
This cluster had two collections (A, B), and the slices of each were partitioned such that one collection (A) used two thirds of the nodes, and the other collection (B) used the remaining third of the nodes.&lt;/p&gt;

&lt;p&gt;I observed that every request for collection B that the load balancer sent to a node with (only) slices for collection A got proxied to one &lt;b&gt;specific&lt;/b&gt; node hosting a slice for collection B. This node started running pretty hot, for obvious reasons.&lt;/p&gt;

&lt;p&gt;This meant that one specific node was handling the fan-out for slightly more than two-thirds of the requests against collection B.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12826349">SOLR-7493</key>
            <summary>Requests aren&apos;t distributed evenly if the collection isn&apos;t present locally</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="jwartes">Jeff Wartes</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Apr 2015 16:31:31 +0000</created>
                <updated>Mon, 9 May 2016 18:49:33 +0000</updated>
                            <resolved>Wed, 10 Jun 2015 13:49:39 +0000</resolved>
                                    <version>5.0</version>
                                    <fixVersion>5.2.1</fixVersion>
                    <fixVersion>5.3</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14521785" author="jwartes" created="Thu, 30 Apr 2015 16:38:22 +0000"  >&lt;p&gt;It looks like this happens because SolrDispatchFilter&apos;s getRemoteCoreURL eventually takes the first viable entry from a HashMap.values list of cores. &lt;/p&gt;

&lt;p&gt;HashMap.values ordering is always the same, if you load the HashMap with the same data in the same order. So if the list from ZK is presented in the same order on every node, every node will use the same ordering on every request.&lt;/p&gt;

&lt;p&gt;There might be a better solution, but this patch would randomize that ordering per-request. &lt;br/&gt;
My environment is a bit messed up at the moment, so I haven&apos;t done much more than verify this compiles.&lt;/p&gt;</comment>
                            <comment id="14523132" author="markrmiller@gmail.com" created="Fri, 1 May 2015 12:21:10 +0000"  >&lt;p&gt;+1, thanks Jeff!&lt;/p&gt;</comment>
                            <comment id="14575909" author="shalinmangar" created="Sat, 6 Jun 2015 19:59:34 +0000"  >&lt;ul&gt;
	&lt;li&gt;Uses a random seeded with tests.seed of System.currentTimeMillis for shuffling&lt;/li&gt;
	&lt;li&gt;Added a simple test which creates creates 3 jettys, 2 collections A, B such that A has replicas on node1, node2 and collection B has replica on node3. The test fires 10 search requests to node3 intended for collection A and asserts that all requests do not go to the same replica of collection A.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14575913" author="jira-bot" created="Sat, 6 Jun 2015 20:03:33 +0000"  >&lt;p&gt;Commit 1683946 from shalin@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1683946&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1683946&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7493&quot; title=&quot;Requests aren&amp;#39;t distributed evenly if the collection isn&amp;#39;t present locally&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7493&quot;&gt;&lt;del&gt;SOLR-7493&lt;/del&gt;&lt;/a&gt;: Requests aren&apos;t distributed evenly if the collection isn&apos;t present locally&lt;/p&gt;</comment>
                            <comment id="14575917" author="jira-bot" created="Sat, 6 Jun 2015 20:11:22 +0000"  >&lt;p&gt;Commit 1683948 from shalin@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1683948&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1683948&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7493&quot; title=&quot;Requests aren&amp;#39;t distributed evenly if the collection isn&amp;#39;t present locally&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7493&quot;&gt;&lt;del&gt;SOLR-7493&lt;/del&gt;&lt;/a&gt;: Initialize random correctly&lt;/p&gt;</comment>
                            <comment id="14575919" author="jira-bot" created="Sat, 6 Jun 2015 20:17:42 +0000"  >&lt;p&gt;Commit 1683950 from shalin@apache.org in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1683950&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1683950&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7493&quot; title=&quot;Requests aren&amp;#39;t distributed evenly if the collection isn&amp;#39;t present locally&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7493&quot;&gt;&lt;del&gt;SOLR-7493&lt;/del&gt;&lt;/a&gt;: Requests aren&apos;t distributed evenly if the collection isn&apos;t present locally. Merges r1683946 and r1683948 from trunk.&lt;/p&gt;</comment>
                            <comment id="14575921" author="shalinmangar" created="Sat, 6 Jun 2015 20:18:09 +0000"  >&lt;p&gt;Thanks Jeff!&lt;/p&gt;</comment>
                            <comment id="14577714" author="shalinmangar" created="Mon, 8 Jun 2015 19:43:01 +0000"  >&lt;p&gt;Reopening to backport to 5.2.1&lt;/p&gt;</comment>
                            <comment id="14580536" author="jira-bot" created="Wed, 10 Jun 2015 13:49:07 +0000"  >&lt;p&gt;Commit 1684674 from shalin@apache.org in branch &apos;dev/branches/lucene_solr_5_2&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1684674&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1684674&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7493&quot; title=&quot;Requests aren&amp;#39;t distributed evenly if the collection isn&amp;#39;t present locally&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7493&quot;&gt;&lt;del&gt;SOLR-7493&lt;/del&gt;&lt;/a&gt;: Requests aren&apos;t distributed evenly if the collection isn&apos;t present locally. Merging r1683950 from branch_5x&lt;/p&gt;</comment>
                            <comment id="14580551" author="jira-bot" created="Wed, 10 Jun 2015 14:02:06 +0000"  >&lt;p&gt;Commit 1684675 from shalin@apache.org in branch &apos;dev/branches/lucene_solr_5_2&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1684675&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1684675&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7493&quot; title=&quot;Requests aren&amp;#39;t distributed evenly if the collection isn&amp;#39;t present locally&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7493&quot;&gt;&lt;del&gt;SOLR-7493&lt;/del&gt;&lt;/a&gt;: Fix compile issue after backport&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12738197" name="SOLR-7493.patch" size="7597" author="shalin" created="Sat, 6 Jun 2015 19:59:34 +0000"/>
                            <attachment id="12729524" name="SOLR-7493.patch" size="1604" author="jwartes" created="Thu, 30 Apr 2015 16:38:22 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 23 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2e5c7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>