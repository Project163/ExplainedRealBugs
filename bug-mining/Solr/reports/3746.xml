<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:30:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-11809] QueryComponent.prepare rq parameter parsing fails under SOLR 7.2</title>
                <link>https://issues.apache.org/jira/browse/SOLR-11809</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The LTR functionality that works under SOLR 7.0 and 7.1 stopped working in 7.2.&lt;br/&gt;
From the solr-user mailing list it appears it might be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11501&quot; title=&quot;Depending on the parser, QParser should not parse local-params&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11501&quot;&gt;&lt;del&gt;SOLR-11501&lt;/del&gt;&lt;/a&gt; .&lt;br/&gt;
I am attaching the minimal working collection definition (attached &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12904284/12904284_ltr-sample.zip&quot; title=&quot;ltr-sample.zip attached to SOLR-11809&quot;&gt;ltr-sample.zip&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;) that shows the problem.&lt;/p&gt;

&lt;p&gt;Please deploy the collection (unpack under &quot;server/solr&quot;), run solr and invoke the URL below.&lt;br/&gt;
  &lt;a href=&quot;http://localhost:8983/solr/ltr-sample/select?q=*:*&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/ltr-sample/select?q=*:*&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Behaviour:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;under 7.0 and 7.1 - empty resultset is returned (there is no data in the collection)&lt;/li&gt;
	&lt;li&gt;under 7.2 - error: &quot;rq parameter must be a RankQuery&quot;. The stacktrace
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2018-01-02 20:51:06.807 INFO  (qtp205125520-20) [   x:ltr-sample] o.a.s.c.S.Request [ltr-sample]  webapp=/solr path=/select params={q=*:*&amp;amp;_=1514909140928} status=400 QTime=23
2018-01-02 21:04:27.293 ERROR (qtp205125520-17) [   x:ltr-sample] o.a.s.h.RequestHandlerBase org.apache.solr.common.SolrException: rq parameter must be a RankQuery
	at org.apache.solr.handler.component.QueryComponent.prepare(QueryComponent.java:183)
	at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:269)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:177)
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:2503)
	at org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:710)
	at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:516)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:382)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:326)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1751)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:582)
	[..]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;i have checked - the same issue exists when I try to invoke the &lt;em&gt;rerank&lt;/em&gt; query parser.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Windows 10, java version &quot;1.8.0_151&quot;&lt;/p&gt;</environment>
        <key id="13128081">SOLR-11809</key>
            <summary>QueryComponent.prepare rq parameter parsing fails under SOLR 7.2</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cpoerschke">Christine Poerschke</assignee>
                                    <reporter username="dwojtas@gmail.com">Dariusz Wojtas</reporter>
                        <labels>
                    </labels>
                <created>Tue, 2 Jan 2018 21:10:46 +0000</created>
                <updated>Sat, 8 Jun 2019 15:13:02 +0000</updated>
                            <resolved>Mon, 8 Jan 2018 20:54:03 +0000</resolved>
                                    <version>7.2</version>
                                    <fixVersion>7.2.1</fixVersion>
                    <fixVersion>7.3</fixVersion>
                    <fixVersion>8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16311095" author="cpoerschke" created="Thu, 4 Jan 2018 09:52:19 +0000"  >&lt;p&gt;Hello &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dwojtas%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;dwojtas@gmail.com&quot;&gt;dwojtas@gmail.com&lt;/a&gt; - thanks for noticing and reporting this problem, first on the &lt;a href=&quot;http://apache.markmail.org/thread/rnj6wlncka7lblrh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;mailing list&lt;/a&gt; and then with attachment here.&lt;/p&gt;

&lt;p&gt;Please find attached a draft patch which would (probably) fix the issue.&lt;/p&gt;

&lt;p&gt;next steps (help welcome):&lt;br/&gt;
(1) code review input and confirmation the draft patch solves the issue&lt;br/&gt;
(2) decide on name for the new parameter and create/use relevant constant&lt;br/&gt;
(3) update &lt;a href=&quot;https://github.com/apache/lucene-solr/tree/master/solr/solr-ref-guide&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Solr Ref Guide&lt;/a&gt; to mention new parameter where &apos;rq&apos; parameter is mentioned in general and specifically for the rerank and ltr parser entries&lt;/p&gt;</comment>
                            <comment id="16311735" author="dsmiley" created="Thu, 4 Jan 2018 17:46:40 +0000"  >&lt;p&gt;I suspect that the right solution is for &quot;rq&quot; to be parsed without care for whatever defType is. The rationale is that defType is almost exclusively for the &quot;q&quot; parameter; other parameters use the default of &quot;lucene&quot;.  Also note that RQ must produce a query of a certain type, which is more evidence that defType is irrelevant.  I can appreciate that &quot;hl.q&quot; param is an exception since when used it&apos;s a tweak of &quot;q&quot; in some way.&lt;/p&gt;</comment>
                            <comment id="16316237" author="cpoerschke" created="Mon, 8 Jan 2018 12:41:30 +0000"  >&lt;blockquote&gt;&lt;p&gt;... for &quot;rq&quot; to be parsed without care for whatever defType is. ... RQ must produce a query of a certain type ...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Makes sense to me. Attaching revised patch.&lt;/p&gt;</comment>
                            <comment id="16316420" author="dsmiley" created="Mon, 8 Jan 2018 14:48:02 +0000"  >&lt;p&gt;+1 very good; commit away&lt;/p&gt;

&lt;p&gt;I definitely overlooked this in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11501&quot; title=&quot;Depending on the parser, QParser should not parse local-params&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11501&quot;&gt;&lt;del&gt;SOLR-11501&lt;/del&gt;&lt;/a&gt;.  And the tests for this feature use &lt;tt&gt;q={!edismax}...&lt;/tt&gt; which is unnatural to how typical Solr queries are issued (they would use defType).&lt;/p&gt;</comment>
                            <comment id="16316940" author="jira-bot" created="Mon, 8 Jan 2018 20:06:49 +0000"  >&lt;p&gt;Commit 2828656892114ab7bb4c7742eac9c4e6f49f69ab in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cpoerschke&quot; class=&quot;user-hover&quot; rel=&quot;cpoerschke&quot;&gt;cpoerschke&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2828656&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2828656&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11809&quot; title=&quot;QueryComponent.prepare rq parameter parsing fails under SOLR 7.2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11809&quot;&gt;&lt;del&gt;SOLR-11809&lt;/del&gt;&lt;/a&gt;: QueryComponent.prepare rq parsing could fail under SOLR 7.2.0 - fix:&lt;br/&gt;
QueryComponent&apos;s rq parameter parsing no longer considers the defType parameter.&lt;br/&gt;
(Christine Poerschke and David Smiley in response to bug report/analysis from Dariusz Wojtas and Diego Ceccarelli)&lt;/p&gt;</comment>
                            <comment id="16316993" author="jira-bot" created="Mon, 8 Jan 2018 20:22:12 +0000"  >&lt;p&gt;Commit 6437477706b818e2c77f7e3a93ab1b2725f0563e in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cpoerschke&quot; class=&quot;user-hover&quot; rel=&quot;cpoerschke&quot;&gt;cpoerschke&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6437477&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6437477&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11809&quot; title=&quot;QueryComponent.prepare rq parameter parsing fails under SOLR 7.2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11809&quot;&gt;&lt;del&gt;SOLR-11809&lt;/del&gt;&lt;/a&gt;: QueryComponent.prepare rq parsing could fail under SOLR 7.2.0 - fix:&lt;br/&gt;
QueryComponent&apos;s rq parameter parsing no longer considers the defType parameter.&lt;br/&gt;
(Christine Poerschke and David Smiley in response to bug report/analysis from Dariusz Wojtas and Diego Ceccarelli)&lt;/p&gt;</comment>
                            <comment id="16317000" author="jira-bot" created="Mon, 8 Jan 2018 20:25:48 +0000"  >&lt;p&gt;Commit 2ec80a272909588a2dd0f276ada4f798979c4fac in lucene-solr&apos;s branch refs/heads/branch_7_2 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cpoerschke&quot; class=&quot;user-hover&quot; rel=&quot;cpoerschke&quot;&gt;cpoerschke&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2ec80a2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2ec80a2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11809&quot; title=&quot;QueryComponent.prepare rq parameter parsing fails under SOLR 7.2&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11809&quot;&gt;&lt;del&gt;SOLR-11809&lt;/del&gt;&lt;/a&gt;: QueryComponent.prepare rq parsing could fail under SOLR 7.2.0 - fix:&lt;br/&gt;
QueryComponent&apos;s rq parameter parsing no longer considers the defType parameter.&lt;br/&gt;
(Christine Poerschke and David Smiley in response to bug report/analysis from Dariusz Wojtas and Diego Ceccarelli)&lt;/p&gt;</comment>
                            <comment id="16317046" author="cpoerschke" created="Mon, 8 Jan 2018 20:54:03 +0000"  >&lt;p&gt;Thanks everyone!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="13110042">SOLR-11501</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12905086" name="SOLR-11809.patch" size="2510" author="cpoerschke" created="Mon, 8 Jan 2018 12:40:00 +0000"/>
                            <attachment id="12904556" name="SOLR-11809.patch" size="3144" author="cpoerschke" created="Thu, 4 Jan 2018 09:51:17 +0000"/>
                            <attachment id="12904284" name="ltr-sample.zip" size="47629" author="dwojtas@gmail.com" created="Tue, 2 Jan 2018 21:09:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 45 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ofsv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>