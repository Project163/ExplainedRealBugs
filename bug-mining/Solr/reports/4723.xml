<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:48:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-15286] A brand new replica in the legacy setup reports healthy before replicating index from its leader</title>
                <link>https://issues.apache.org/jira/browse/SOLR-15286</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;In the legacy mode when you add a brand new replica it immediately starts reporting healthy even if it hasn&apos;t fully replicated index from its leader. This issue is also exhibited when you shut down a replica and start it after a lot of data is indexed on the leader.&lt;/p&gt;

&lt;p&gt;If the replica reports healthy LB would continue to forward incoming requests to it and this would result in inconsistent data being retuned to the caller.&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13367349">SOLR-15286</key>
            <summary>A brand new replica in the legacy setup reports healthy before replicating index from its leader</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="anshum">Anshum Gupta</assignee>
                                    <reporter username="praste">Pushkar Raste</reporter>
                        <labels>
                    </labels>
                <created>Wed, 24 Mar 2021 20:25:06 +0000</created>
                <updated>Thu, 12 May 2022 00:26:24 +0000</updated>
                            <resolved>Wed, 22 Sep 2021 17:29:27 +0000</resolved>
                                    <version>8.8.1</version>
                                    <fixVersion>9.0</fixVersion>
                                    <component>replication (java)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="14400">4h</timespent>
                                <comments>
                            <comment id="17308170" author="praste" created="Wed, 24 Mar 2021 20:34:00 +0000"  >&lt;p&gt;Here is a solution I am thinking of.&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;On startup check if the node is follower.&lt;/li&gt;
	&lt;li&gt;If yes, check the index generation on the node and check the replicable index generation on the leader&lt;/li&gt;
	&lt;li&gt;Mark the node (follower) health only if its index generation is with a configurable threshold from the leader index generation.&lt;/li&gt;
	&lt;li&gt;Once the node has caught with the leader (within the configuration threshold) mark it an instance variable to indicate to indicate a initial sync with leader is done&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;We can have another option to always ensure that replica is within acceptable index generation threshold from its leader.&lt;/p&gt;</comment>
                            <comment id="17388379" author="anshumg" created="Wed, 28 Jul 2021 00:50:45 +0000"  >&lt;p&gt;Thanks for the patch, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=praste&quot; class=&quot;user-hover&quot; rel=&quot;praste&quot;&gt;praste&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Can you please create a PR instead as that&apos;s easier to review and iterate? Let me know in case you need help with that. &lt;/p&gt;</comment>
                            <comment id="17388383" author="praste" created="Wed, 28 Jul 2021 01:02:27 +0000"  >&lt;p&gt;Sure. Will do it tonight. &#160;&lt;/p&gt;</comment>
                            <comment id="17388416" author="praste" created="Wed, 28 Jul 2021 03:00:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anshum&quot; class=&quot;user-hover&quot; rel=&quot;anshum&quot;&gt;anshum&lt;/a&gt; &lt;br/&gt;
Here is the PR :&#160;&lt;a href=&quot;https://github.com/apache/solr/pull/238&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/pull/238&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17402350" author="mdrob" created="Fri, 20 Aug 2021 17:45:15 +0000"  >&lt;p&gt;Possibly related to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6420&quot; title=&quot;ADDREPLICA can add a replica that reports green without actually replicating&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6420&quot;&gt;SOLR-6420&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17418712" author="jira-bot" created="Wed, 22 Sep 2021 16:47:06 +0000"  >&lt;p&gt;Commit 3cd71244d23704a7addf34eeac9f728862518f48 in solr&apos;s branch refs/heads/main from Pushkar Raste&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=3cd7124&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=3cd7124&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15286&quot; title=&quot;A brand new replica in the legacy setup reports healthy before replicating index from its leader&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15286&quot;&gt;&lt;del&gt;SOLR-15286&lt;/del&gt;&lt;/a&gt;: A brand new follower in the legacy mode should wait to replicate index before reporting healthy (#238)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15286&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-15286&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Added log to the HealthCheckHandler for legacy mode to report followers healthy based on the index generation diff&lt;/p&gt;

&lt;p&gt;Co-authored-by: Pushkar Raste &amp;lt;praste@apple.com&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17510877" author="jira-bot" created="Tue, 22 Mar 2022 20:19:16 +0000"  >&lt;p&gt;Commit 18186dcdc17cb844a87c3541e2425c7fd4fd1453 in solr&apos;s branch refs/heads/branch_9_0 from Anshum Gupta&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=18186dc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=18186dc&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Update branch_9_0 changelog (#692)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Cleanup CHANGES.txt on branch_9_0&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15286&quot; title=&quot;A brand new replica in the legacy setup reports healthy before replicating index from its leader&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15286&quot;&gt;&lt;del&gt;SOLR-15286&lt;/del&gt;&lt;/a&gt;: Add missing changelog entry&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Fix Changelog entries, remove some entries that no longer make sense and update others&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15317&quot; title=&quot;Parts of internal SolR communication fail when the CertAuthPlugin is active&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15317&quot;&gt;&lt;del&gt;SOLR-15317&lt;/del&gt;&lt;/a&gt;: Remove change log entry from 9.0 as this was released in 8.9, still need to figure where to add this back&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Cleanup merge markers&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17535397" author="janhoy" created="Thu, 12 May 2022 00:26:24 +0000"  >&lt;p&gt;Closing after the 9.0.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13031128" name="SOLR-15286.patch" size="226920" author="praste" created="Wed, 28 Jul 2021 00:38:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0p5h4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>