<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:03:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7421] RecoveryAfterSoftCommitTest fails frequently on Jenkins due to full index replication taking longer than 30 seconds</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7421</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;RecoveryAfterSoftCommitTest is failing frequently on Jenkins because the test only gives 30 seconds for the replica to recover after healing the partition. It looks like it&apos;s taking &amp;gt;30 seconds to replicate the full index from the leader (the test is designed so that peer sync can&apos;t work). It seems bad that it takes &amp;gt;30 seconds to replicate an index with only 115 documents in it ... wonder if there is cruft laying around from other tests? I&apos;ve run beast on this test locally and it always passes. What&apos;s weird is I see log messages like:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;   [junit4]   2&amp;gt; 1436627 T4242 N:127.0.0.1:63274_ecb%2Fay C476 oash.IndexFetcher.fetchLatestIndex &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt; of files in latest index in master: 263
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;263 files for an index with 115 docs? Doesn&apos;t seem right!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12822085">SOLR-7421</key>
            <summary>RecoveryAfterSoftCommitTest fails frequently on Jenkins due to full index replication taking longer than 30 seconds</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="thelabdude">Timothy Potter</reporter>
                        <labels>
                    </labels>
                <created>Sat, 18 Apr 2015 13:50:42 +0000</created>
                <updated>Mon, 9 May 2016 18:50:05 +0000</updated>
                            <resolved>Sun, 26 Apr 2015 06:13:14 +0000</resolved>
                                                    <fixVersion>5.2</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14501365" author="thelabdude" created="Sat, 18 Apr 2015 13:52:15 +0000"  >&lt;p&gt;Full log for the failing test from a recent Jenkins failure - &lt;a href=&quot;https://builds.apache.org/job/Lucene-Solr-Tests-5.x-Java7/2969/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Lucene-Solr-Tests-5.x-Java7/2969/&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="14501377" author="jira-bot" created="Sat, 18 Apr 2015 14:11:27 +0000"  >&lt;p&gt;Commit 1674512 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thelabdude&quot; class=&quot;user-hover&quot; rel=&quot;thelabdude&quot;&gt;thelabdude&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1674512&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1674512&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7421&quot; title=&quot;RecoveryAfterSoftCommitTest fails frequently on Jenkins due to full index replication taking longer than 30 seconds&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7421&quot;&gt;&lt;del&gt;SOLR-7421&lt;/del&gt;&lt;/a&gt;: Marking test as a BadApple for now until we can figure out what is causing replication to take so long for a small index&lt;/p&gt;</comment>
                            <comment id="14501379" author="jira-bot" created="Sat, 18 Apr 2015 14:16:14 +0000"  >&lt;p&gt;Commit 1674516 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thelabdude&quot; class=&quot;user-hover&quot; rel=&quot;thelabdude&quot;&gt;thelabdude&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1674516&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1674516&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7421&quot; title=&quot;RecoveryAfterSoftCommitTest fails frequently on Jenkins due to full index replication taking longer than 30 seconds&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7421&quot;&gt;&lt;del&gt;SOLR-7421&lt;/del&gt;&lt;/a&gt;: Marking test as a BadApple for now until we can figure out what is causing replication to take so long for a small index&lt;/p&gt;</comment>
                            <comment id="14501397" author="shalinmangar" created="Sat, 18 Apr 2015 14:47:36 +0000"  >&lt;p&gt;Thanks for looking into this, Tim.&lt;/p&gt;

&lt;p&gt;This test was written to force flush a segment and then cause softCommit and then trigger a full replication. In order to force flush a segment, the test sets maxBufferedDocs to 2 which is why it creates so many files. Now that we have the ability to change the peer sync limit via &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6359&quot; title=&quot;Allow customization of the number of records and logs kept by UpdateLog&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6359&quot;&gt;&lt;del&gt;SOLR-6359&lt;/del&gt;&lt;/a&gt;, we should set the limit to a small value (say n=4) and only add n+1 documents to simulate the same behavior without creating such a lot of index files.&lt;/p&gt;</comment>
                            <comment id="14501401" author="shalinmangar" created="Sat, 18 Apr 2015 14:55:25 +0000"  >&lt;p&gt;Also for this particular seed, the merge policy chosen is LogDocMergePolicy with minMergeSize=1000 so no merges happen at all.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;   [junit4]   2&amp;gt; 752435 T2587 N:127.0.0.1:42328_ c:collection1 oasu.RandomMergePolicy.&amp;lt;init&amp;gt; RandomMergePolicy wrapping &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.lucene.index.LogDocMergePolicy: [LogDocMergePolicy: minMergeSize=1000, mergeFactor=28, maxMergeSize=9223372036854775807, maxMergeSizeForForcedMerge=9223372036854775807, calibrateSizeByDeletes=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;, maxMergeDocs=2147483647, maxCFSSegmentSizeMB=8.796093022207999E12, noCFSRatio=0.4225057358391613]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14502062" author="shalinmangar" created="Sun, 19 Apr 2015 19:03:32 +0000"  >&lt;ol&gt;
	&lt;li&gt;numRecordsToKeep is set to 2 instead of the default 100 so that we don&apos;t need to add so many records to trigger a full replication&lt;/li&gt;
	&lt;li&gt;solr.cloud.wait-for-updates-with-stale-state-pause is set to 500ms for this test because it needlessly adds a 7 second delay and is not useful for this test.&lt;/li&gt;
	&lt;li&gt;I changed the BadApple to AwaitsFix so that the test isn&apos;t skipped on jenkins.&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="14502331" author="shalinmangar" created="Mon, 20 Apr 2015 04:36:59 +0000"  >&lt;ol&gt;
	&lt;li&gt;Use compoundFile=true to cut down on the number of files created.&lt;/li&gt;
	&lt;li&gt;AwaitsFix also prevents jenkins from running this test so I removed it&lt;/li&gt;
	&lt;li&gt;I checked out the revision before &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6640&quot; title=&quot;Replication can cause index corruption.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6640&quot;&gt;&lt;del&gt;SOLR-6640&lt;/del&gt;&lt;/a&gt; was fixed and ran the modified test (with compoundFile=true) and verified that the test still reproduces the corrupt index exception.&lt;/li&gt;
	&lt;li&gt;I beasted the test overnight on slow and fast hardware and was not able to get it to fail&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I&apos;ll commit this shortly.&lt;/p&gt;</comment>
                            <comment id="14502338" author="jira-bot" created="Mon, 20 Apr 2015 04:44:04 +0000"  >&lt;p&gt;Commit 1674733 from shalin@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1674733&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1674733&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7421&quot; title=&quot;RecoveryAfterSoftCommitTest fails frequently on Jenkins due to full index replication taking longer than 30 seconds&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7421&quot;&gt;&lt;del&gt;SOLR-7421&lt;/del&gt;&lt;/a&gt;: RecoveryAfterSoftCommitTest fails frequently on Jenkins due to full index replication taking longer than 30 seconds&lt;/p&gt;</comment>
                            <comment id="14502339" author="jira-bot" created="Mon, 20 Apr 2015 04:44:59 +0000"  >&lt;p&gt;Commit 1674734 from shalin@apache.org in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1674734&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1674734&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7421&quot; title=&quot;RecoveryAfterSoftCommitTest fails frequently on Jenkins due to full index replication taking longer than 30 seconds&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7421&quot;&gt;&lt;del&gt;SOLR-7421&lt;/del&gt;&lt;/a&gt;: RecoveryAfterSoftCommitTest fails frequently on Jenkins due to full index replication taking longer than 30 seconds&lt;/p&gt;</comment>
                            <comment id="14512907" author="shalinmangar" created="Sun, 26 Apr 2015 06:13:14 +0000"  >&lt;p&gt;Last failure was 8 days ago.&lt;/p&gt;</comment>
                            <comment id="14586942" author="anshumg" created="Mon, 15 Jun 2015 21:44:54 +0000"  >&lt;p&gt;Bulk close for 5.2.0.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12818698">SOLR-7354</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12726367" name="RecoveryAfterSoftCommitTest_failure.log" size="355005" author="thelabdude" created="Sat, 18 Apr 2015 13:52:15 +0000"/>
                            <attachment id="12726509" name="SOLR-7421.patch" size="4189" author="shalin" created="Mon, 20 Apr 2015 04:36:59 +0000"/>
                            <attachment id="12726459" name="SOLR-7421.patch" size="4044" author="shalin" created="Sun, 19 Apr 2015 19:03:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 23 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2dftj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>