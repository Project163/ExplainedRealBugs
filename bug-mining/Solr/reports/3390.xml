<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:22:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-10520] BlockJoinFacetComponet duplicate counts when rows&gt;0</title>
                <link>https://issues.apache.org/jira/browse/SOLR-10520</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;when we have rows&amp;gt;0 every shard receive:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;ids=2,3,6,7,9&amp;amp;isShard=true&amp;amp;shards.purpose=64&amp;amp;distrib=false&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;this is ShardRequest.PURPOSE_GET_TOP_IDS&lt;br/&gt;
In this case &lt;tt&gt;child_facet_fields&lt;/tt&gt; are merged once again unnecessary. &lt;br/&gt;
failure is &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.AssertionError: don&lt;span class=&quot;code-quote&quot;&gt;&apos;t({3=[1], s=[6], white=[0, 3, 5, 6, 7, 8, 9, 10], xl=[8], don&apos;&lt;/span&gt;t=[0, 1, 2, 5, 6, 8, 10], 6=[0, 2, 7], xml=[3, 6, 8], xxxl=[0, 7, 9], l=[8, 10], m=[5, 9, 10], xxl=[5], grey=[9]} COLOR_s:[don&apos;t (14), white (16), grey (2)] SIZE_s:[m (6), xxl (2), 6 (6), s (2), xml (6), xxxl (6), 3 (2), l (4), xl (2)]) expected:&amp;lt;7&amp;gt; but was:&amp;lt;14&amp;gt;
	at __....
org.apache.solr.search.join.BlockJoinFacetDistribTest.testBJQFacetComponent(BlockJoinFacetDistribTest.java:148)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;see test patch attached&lt;br/&gt;
I suppose it&apos;s worth to exclude not only PURPOSE_GET_TOP_IDS but any other too, and make sure that &lt;em&gt;reduce&lt;/em&gt; is done only once on distributed search. &lt;/p&gt;
</description>
                <environment></environment>
        <key id="13065024">SOLR-10520</key>
            <summary>BlockJoinFacetComponet duplicate counts when rows&gt;0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mkhl">Mikhail Khludnev</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Apr 2017 08:57:10 +0000</created>
                <updated>Sat, 8 Jun 2019 15:21:27 +0000</updated>
                            <resolved>Fri, 28 Apr 2017 09:27:41 +0000</resolved>
                                                    <fixVersion>6.6</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>2</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15980406" author="osavrasov" created="Sun, 23 Apr 2017 14:31:17 +0000"  >&lt;p&gt;I think the component should handle shard responses only in case of ShardRequest.PURPOSE_GET_TOP_IDS, like for example FacetComponent. Appropriate fix is attached. The test is modified to randomly choose either 0 or 10 value for &quot;rows&quot; parameter. Random value of &quot;distrib.singlePass&quot; is also verified. The test may be extended to check other parameters that potentially affect shards purpose flow.&lt;/p&gt;</comment>
                            <comment id="15982614" author="mkhludnev" created="Tue, 25 Apr 2017 09:20:35 +0000"  >&lt;p&gt;added more test variability. committing it soon.  &lt;/p&gt;</comment>
                            <comment id="15982660" author="jira-bot" created="Tue, 25 Apr 2017 10:13:57 +0000"  >&lt;p&gt;Commit 680f4d7fd378868254786107de92a894758f667c in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mkhludnev&quot; class=&quot;user-hover&quot; rel=&quot;mkhludnev&quot;&gt;mkhludnev&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=680f4d7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=680f4d7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10520&quot; title=&quot;BlockJoinFacetComponet duplicate counts when rows&amp;gt;0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10520&quot;&gt;&lt;del&gt;SOLR-10520&lt;/del&gt;&lt;/a&gt;: fix child.facet.field counts&lt;/p&gt;</comment>
                            <comment id="15988513" author="mkhludnev" created="Fri, 28 Apr 2017 09:27:24 +0000"  >&lt;p&gt;branch_6x commit &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;a=commitdiff;h=ea3f9bb87d1e6c3cf812122c3a6f9160a8b49a19&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;a=commitdiff;h=ea3f9bb87d1e6c3cf812122c3a6f9160a8b49a19&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12863979" name="SOLR-10520-test.patch" size="757" author="mkhl" created="Wed, 19 Apr 2017 08:59:23 +0000"/>
                            <attachment id="12864924" name="SOLR-10520.patch" size="3128" author="mkhl" created="Tue, 25 Apr 2017 09:20:35 +0000"/>
                            <attachment id="12864676" name="SOLR_10520.patch" size="2420" author="osavrasov" created="Sun, 23 Apr 2017 14:31:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 29 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3dssn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>