<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:12:09 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-8155] json.facet - prefix parameter doesn&apos;t work properly</title>
                <link>https://issues.apache.org/jira/browse/SOLR-8155</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When using prefix in nested facets, not all values are found.&lt;br/&gt;
In the following query, I use facet with prefix in both old way (facet.field) and new way (json.facet).&lt;br/&gt;
In old way, I get 5 values. In new way I get only 3.&lt;/p&gt;

&lt;p&gt;This is the field definition in the schema:&lt;br/&gt;
&amp;lt;field name=&quot;topics_f&quot; type=&quot;string&quot; indexed=&quot;true&quot; stored=&quot;true&quot; required=&quot;false&quot; multiValued=&quot;true&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;When I add to the schema docValues=&quot;true&quot; the issue is solved.&lt;/p&gt;

&lt;p&gt;Query:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/mycore/select?q=*%3A*&amp;amp;rows=0&amp;amp;wt=json&amp;amp;indent=true&amp;amp;facet=true&amp;amp;facet.field=topics_f&amp;amp;facet.prefix=2&amp;amp;json.facet=&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/mycore/select?q=*%3A*&amp;amp;rows=0&amp;amp;wt=json&amp;amp;indent=true&amp;amp;facet=true&amp;amp;facet.field=topics_f&amp;amp;facet.prefix=2&amp;amp;json.facet=&lt;/a&gt;{trendFieldFacet:{type:terms,%20field:topics_f,%20%20prefix:%222%22%20}}&lt;/p&gt;

&lt;p&gt;Response:&lt;/p&gt;

&lt;p&gt;{&lt;br/&gt;
  &quot;responseHeader&quot;: {&lt;br/&gt;
    &quot;status&quot;: 0,&lt;br/&gt;
    &quot;QTime&quot;: 0,&lt;br/&gt;
    &quot;params&quot;: {&lt;br/&gt;
      &quot;q&quot;: &quot;&lt;b&gt;:&lt;/b&gt;&quot;,&lt;br/&gt;
      &quot;json.facet&quot;: &quot;{trendFieldFacet:{type:terms, field:topics_f,  prefix:\&quot;2\&quot; }}&quot;,&lt;br/&gt;
      &quot;facet.field&quot;: &quot;topics_f&quot;,&lt;br/&gt;
      &quot;indent&quot;: &quot;true&quot;,&lt;br/&gt;
      &quot;facet.prefix&quot;: &quot;2&quot;,&lt;br/&gt;
      &quot;rows&quot;: &quot;0&quot;,&lt;br/&gt;
      &quot;wt&quot;: &quot;json&quot;,&lt;br/&gt;
      &quot;facet&quot;: &quot;true&quot;,&lt;br/&gt;
      &quot;_&quot;: &quot;1444566142012&quot;&lt;br/&gt;
    }&lt;br/&gt;
  },&lt;br/&gt;
  &quot;response&quot;: &lt;/p&gt;
{
    &quot;numFound&quot;: 17,
    &quot;start&quot;: 0,
    &quot;docs&quot;: []
  }
&lt;p&gt;,&lt;br/&gt;
  &quot;facet_counts&quot;: {&lt;br/&gt;
    &quot;facet_queries&quot;: {},&lt;br/&gt;
    &quot;facet_fields&quot;: &lt;/p&gt;
{
      &quot;topics_f&quot;: [
        &quot;2/device/iphone&quot;,
        4,
        &quot;2/device/samsung&quot;,
        4,
        &quot;2/city/london&quot;,
        1,
        &quot;2/city/rome&quot;,
        1,
        &quot;2/device/other&quot;,
        1
      ]
    }
&lt;p&gt;,&lt;br/&gt;
    &quot;facet_dates&quot;: {},&lt;br/&gt;
    &quot;facet_ranges&quot;: {},&lt;br/&gt;
    &quot;facet_intervals&quot;: {},&lt;br/&gt;
    &quot;facet_heatmaps&quot;: {}&lt;br/&gt;
  },&lt;br/&gt;
  &quot;facets&quot;: {&lt;br/&gt;
    &quot;count&quot;: 17,&lt;br/&gt;
    &quot;trendFieldFacet&quot;: {&lt;br/&gt;
      &quot;buckets&quot;: [&lt;br/&gt;
        &lt;/p&gt;
{
          &quot;val&quot;: &quot;2/device/iphone&quot;,
          &quot;count&quot;: 4
        }
&lt;p&gt;,&lt;br/&gt;
        &lt;/p&gt;
{
          &quot;val&quot;: &quot;2/device/samsung&quot;,
          &quot;count&quot;: 4
        }
&lt;p&gt;,&lt;/p&gt;
        {
          &quot;val&quot;: &quot;2/device/other&quot;,
          &quot;count&quot;: 1
        }
&lt;p&gt;      ]&lt;br/&gt;
    }&lt;br/&gt;
  }&lt;br/&gt;
}&lt;/p&gt;</description>
                <environment></environment>
        <key id="12904035">SOLR-8155</key>
            <summary>json.facet - prefix parameter doesn&apos;t work properly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="yonesher">Yosi Nesher</reporter>
                        <labels>
                    </labels>
                <created>Sun, 11 Oct 2015 13:17:49 +0000</created>
                <updated>Mon, 11 Apr 2016 18:12:02 +0000</updated>
                            <resolved>Sat, 5 Mar 2016 23:57:31 +0000</resolved>
                                    <version>5.3</version>
                                    <fixVersion>5.5.1</fixVersion>
                    <fixVersion>5.6</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>Facet Module</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15140484" author="mkhludnev" created="Wed, 10 Feb 2016 08:12:16 +0000"  >&lt;p&gt;I think I see it while working on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8466&quot; title=&quot;Add support for UnInvertedField based faceting to FacetComponent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8466&quot;&gt;&lt;del&gt;SOLR-8466&lt;/del&gt;&lt;/a&gt;. There is a testcase for older facets, which reproduces the issue. I&apos;m going to port it for json.facets.&lt;/p&gt;</comment>
                            <comment id="15146206" author="mkhludnev" created="Sat, 13 Feb 2016 21:31:38 +0000"  >&lt;p&gt;attaching a failing test &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12791643/12791643_SOLR-8155.patch&quot; title=&quot;SOLR-8155.patch attached to SOLR-8155&quot;&gt;SOLR-8155.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="15181898" author="yseeley@gmail.com" created="Sat, 5 Mar 2016 23:41:49 +0000"  >&lt;p&gt;OK, so there was a bug in the generic accumulation code used when there was a facet prefix or when a bucket sort other than count was used.&lt;br/&gt;
This patch fixes the bug and re-enables facet.prefix when facet.method=uif (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8466&quot; title=&quot;Add support for UnInvertedField based faceting to FacetComponent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8466&quot;&gt;&lt;del&gt;SOLR-8466&lt;/del&gt;&lt;/a&gt;) and enables the test code for that as well.&lt;/p&gt;</comment>
                            <comment id="15181902" author="jira-bot" created="Sat, 5 Mar 2016 23:47:57 +0000"  >&lt;p&gt;Commit 85557261431f9314253ebe282eb6d400bf7cae03 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8555726&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8555726&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8155&quot; title=&quot;json.facet - prefix parameter doesn&amp;#39;t work properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8155&quot;&gt;&lt;del&gt;SOLR-8155&lt;/del&gt;&lt;/a&gt;: fix UnInvertedField.collectDocsGeneric, used for facet.prefix or non-count sorting&lt;/p&gt;</comment>
                            <comment id="15181906" author="jira-bot" created="Sat, 5 Mar 2016 23:52:50 +0000"  >&lt;p&gt;Commit 4d5a33e9ba2cdd40ef1ff0230deae895fa517279 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4d5a33e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4d5a33e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8155&quot; title=&quot;json.facet - prefix parameter doesn&amp;#39;t work properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8155&quot;&gt;&lt;del&gt;SOLR-8155&lt;/del&gt;&lt;/a&gt;: fix UnInvertedField.collectDocsGeneric, used for facet.prefix or non-count sorting&lt;/p&gt;</comment>
                            <comment id="15181907" author="jira-bot" created="Sat, 5 Mar 2016 23:53:03 +0000"  >&lt;p&gt;Commit 1b332b1da5fa490a541ea46823c6681501549113 in lucene-solr&apos;s branch refs/heads/branch_6_0 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1b332b1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1b332b1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8155&quot; title=&quot;json.facet - prefix parameter doesn&amp;#39;t work properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8155&quot;&gt;&lt;del&gt;SOLR-8155&lt;/del&gt;&lt;/a&gt;: fix UnInvertedField.collectDocsGeneric, used for facet.prefix or non-count sorting&lt;/p&gt;</comment>
                            <comment id="15181912" author="yseeley@gmail.com" created="Sat, 5 Mar 2016 23:57:31 +0000"  >&lt;p&gt;OK, this fix will be in 6.0&lt;br/&gt;
If we have a future 5.x release, we should backport at that time.&lt;/p&gt;</comment>
                            <comment id="15235628" author="jira-bot" created="Mon, 11 Apr 2016 18:08:04 +0000"  >&lt;p&gt;Commit 0073ba9700d5df7b00d77a5d5dd831316f138042 in lucene-solr&apos;s branch refs/heads/branch_5x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0073ba9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0073ba9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8155&quot; title=&quot;json.facet - prefix parameter doesn&amp;#39;t work properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8155&quot;&gt;&lt;del&gt;SOLR-8155&lt;/del&gt;&lt;/a&gt;: fix UnInvertedField.collectDocsGeneric, used for facet.prefix or non-count sorting&lt;/p&gt;</comment>
                            <comment id="15235638" author="jira-bot" created="Mon, 11 Apr 2016 18:11:16 +0000"  >&lt;p&gt;Commit c3446734a2b6dccd8092f5672651779223076dac in lucene-solr&apos;s branch refs/heads/branch_5_5 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c344673&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c344673&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8155&quot; title=&quot;json.facet - prefix parameter doesn&amp;#39;t work properly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8155&quot;&gt;&lt;del&gt;SOLR-8155&lt;/del&gt;&lt;/a&gt;: fix UnInvertedField.collectDocsGeneric, used for facet.prefix or non-count sorting&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12791643" name="SOLR-8155.patch" size="7536" author="yseeley@gmail.com" created="Sat, 5 Mar 2016 23:41:49 +0000"/>
                            <attachment id="12787834" name="SOLR-8155.patch" size="4072" author="mkhl" created="Sat, 13 Feb 2016 21:31:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 32 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2mv2n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>