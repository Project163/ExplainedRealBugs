<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:36:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4791] solr.xml sharedLib does not work in 4.3.0</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4791</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The sharedLib attribute on &lt;tt&gt;&amp;lt;solr&amp;gt;&lt;/tt&gt; tag in solr.xml stopped working in 4.3.&lt;/p&gt;

&lt;p&gt;Using old-style solr.xml with sharedLib defined on solr tag. Solr does not load any of them. Simply swapping out solr.war with the 4.2.1 one, brings sharedLib loading back.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12646340">SOLR-4791</key>
            <summary>solr.xml sharedLib does not work in 4.3.0</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="erickerickson">Erick Erickson</assignee>
                                    <reporter username="janhoy">Jan H&#248;ydahl</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 May 2013 01:36:46 +0000</created>
                <updated>Mon, 9 May 2016 18:50:40 +0000</updated>
                            <resolved>Fri, 10 May 2013 10:57:38 +0000</resolved>
                                    <version>4.3</version>
                                    <fixVersion>4.4</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>multicore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="13650354" author="janhoy" created="Tue, 7 May 2013 01:39:22 +0000"  >&lt;p&gt;This is the log output&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;40   [localhost-startStop-1] INFO  org.apache.solr.core.CoreContainer  &#8211; looking for solr config file: /Users/janhoy/git/openesp/build/openesp/bin/../conf/solr/solr.xml
44   [localhost-startStop-1] INFO  org.apache.solr.core.CoreContainer  &#8211; New CoreContainer 218790518
47   [localhost-startStop-1] INFO  org.apache.solr.core.CoreContainer  &#8211; Loading CoreContainer using Solr Home: &apos;/Users/janhoy/git/openesp/build/openesp/bin/../conf/solr/&apos;
48   [localhost-startStop-1] INFO  org.apache.solr.core.SolrResourceLoader  &#8211; new SolrResourceLoader for directory: &apos;/Users/janhoy/git/openesp/build/openesp/bin/../conf/solr/&apos;
373  [localhost-startStop-1] INFO  org.apache.solr.core.CoreContainer  &#8211; loading shared library: /Users/janhoy/git/openesp/build/openesp/bin/../lib/solr
374  [localhost-startStop-1] INFO  org.apache.solr.core.SolrResourceLoader  &#8211; Adding &apos;file:/Users/janhoy/git/openesp/build/openesp/lib/solr/&apos; to classloader
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...it believes that the folder is a file... while in 4.2.1 it looks like this&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;INFO: looking for solr.xml: /Users/janhoy/git/openesp/build/openesp/bin/../conf/solr/solr.xml
mai 07, 2013 3:18:46 AM org.apache.solr.core.CoreContainer &amp;lt;init&amp;gt;
INFO: New CoreContainer 39755063
mai 07, 2013 3:18:46 AM org.apache.solr.core.CoreContainer load
INFO: Loading CoreContainer using Solr Home: &apos;/Users/janhoy/git/openesp/build/openesp/bin/../conf/solr/&apos;
(...)
mai 07, 2013 3:18:46 AM org.apache.solr.core.CoreContainer load
INFO: loading shared library: /Users/janhoy/git/openesp/build/openesp/bin/../lib/solr
mai 07, 2013 3:18:46 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding &apos;file:/Users/janhoy/git/openesp/build/openesp/lib/solr/activation-1.1.jar&apos; to classloader
mai 07, 2013 3:18:46 AM org.apache.solr.core.SolrResourceLoader replaceClassLoader
INFO: Adding &apos;file:/Users/janhoy/git/openesp/build/openesp/lib/solr/apache-mime4j-core-0.7.2.jar&apos; to classloader
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13650359" author="elyograg" created="Tue, 7 May 2013 01:48:07 +0000"  >&lt;p&gt;I upgraded my dev server to 4.3.  If the sharedLib is set to &quot;lib&quot; (relative to solr.solr.home) then it does seem to work, although it&apos;s my understanding that even without a sharedLib setting, &quot;lib&quot; is checked, so that&apos;s a useless bit of config.&lt;/p&gt;</comment>
                            <comment id="13650606" author="janhoy" created="Tue, 7 May 2013 08:36:20 +0000"  >&lt;p&gt;Sure, &lt;tt&gt;./lib&lt;/tt&gt; is hardcoded, try another path&lt;/p&gt;</comment>
                            <comment id="13651563" author="rjernst" created="Wed, 8 May 2013 02:24:56 +0000"  >&lt;p&gt;I believe the attached patch should fix the problem.&lt;/p&gt;

&lt;p&gt;I haven&apos;t come up with a test yet...would need to add a test solr.xml that specifies sharedLib (and uses a different name than &quot;lib&quot;).&lt;/p&gt;

&lt;p&gt;On a side note, it is annoying that the 1 argument addToClassLoader expects a single file, while the 3 argument one expects a directory...&lt;/p&gt;</comment>
                            <comment id="13651567" author="markrmiller@gmail.com" created="Wed, 8 May 2013 02:38:01 +0000"  >&lt;p&gt;I think someone did recently write such a new test, right Erick? I&apos;m pretty sure I saw a JIRA issue. Though it likely didn&apos;t specify an alternate lib location I would assume since it did not fail.&lt;/p&gt;</comment>
                            <comment id="13651662" author="rjernst" created="Wed, 8 May 2013 06:39:59 +0000"  >&lt;p&gt;Ok, I went down a rabbit hole and fixed another bug (if quiet was false, no files would ever be loaded in the 3 arg version of addToClassPath).  I also removed the single arg version of addToClassPath, since it was only used in one place, and the documentation was wrong anyway (claimed it worked with a directory path, but only worked for a single file).&lt;/p&gt;

&lt;p&gt;I added two tests, one which tests adding paths to SolrResourceLoader, and another to ensure CoreContainer loads sharedLib correctly (and works with the default &quot;lib&quot;).&lt;/p&gt;

&lt;p&gt;All of this is in the new patch.&lt;/p&gt;</comment>
                            <comment id="13651790" author="erickerickson" created="Wed, 8 May 2013 11:07:31 +0000"  >&lt;p&gt;Ryan:&lt;/p&gt;

&lt;p&gt;Looks great! I&apos;ll check it in today trunk and 4x.....&lt;/p&gt;

&lt;p&gt;I took out a couple of unused imports I noticed that had probably been hanging around since forever but otherwise I didn&apos;t change anything....&lt;/p&gt;</comment>
                            <comment id="13651816" author="janhoy" created="Wed, 8 May 2013 11:46:25 +0000"  >&lt;p&gt;Tested the patch in my environment, works well (with old-style solr.xml, not tested with new style).&lt;/p&gt;</comment>
                            <comment id="13651820" author="janhoy" created="Wed, 8 May 2013 12:01:26 +0000"  >&lt;p&gt;Tested with new style solr.xml, and it works as well.&lt;/p&gt;</comment>
                            <comment id="13651854" author="erickerickson" created="Wed, 8 May 2013 12:42:50 +0000"  >&lt;p&gt;trunk: 1480228&lt;br/&gt;
4x:    1480252&lt;/p&gt;

&lt;p&gt;Thanks Ryan for the patch and Jan for testing!&lt;/p&gt;

&lt;p&gt;Ryan: My apologies, I forgot to add this to CHANGES.txt. I have another patch to commit sometime in the next couple of days and I&apos;ll add this (with attribution!) in then.&lt;/p&gt;</comment>
                            <comment id="13652016" author="erickerickson" created="Wed, 8 May 2013 16:08:15 +0000"  >&lt;p&gt;Apparently causing a test failure...&lt;/p&gt;</comment>
                            <comment id="13652017" author="erickerickson" created="Wed, 8 May 2013 16:10:30 +0000"  >&lt;p&gt;Could someone with a windows machine try this patch out? Other then having to indent, all it does is try to delete the directory created in the new test. The only changed code is the adding try and the finally block. Passes on my Mac....&lt;/p&gt;</comment>
                            <comment id="13652028" author="rcmuir" created="Wed, 8 May 2013 16:20:05 +0000"  >&lt;p&gt;Probably need to close() the classloader I think? ill test on a windows box if this does the trick&lt;/p&gt;</comment>
                            <comment id="13652040" author="rcmuir" created="Wed, 8 May 2013 16:33:39 +0000"  >&lt;p&gt;We can also only do this in trunk. there is no close() method in java6. So I think in branch_4x, the test should have an assumeFalse(Constants.WINDOWS)&lt;/p&gt;</comment>
                            <comment id="13652057" author="rcmuir" created="Wed, 8 May 2013 16:58:28 +0000"  >&lt;p&gt;totally untested patch. Ill try it on my windows machien in a few.&lt;/p&gt;

&lt;p&gt;I know that Uwe knows a trick for java6 (at least a best-effort we can do, which we should). But i still think we should have an assume() for windows there since it may not work on all jvms.&lt;/p&gt;</comment>
                            <comment id="13652063" author="rcmuir" created="Wed, 8 May 2013 17:09:23 +0000"  >&lt;p&gt;This works on my windows box with trunk (where it fails before). Ill take care of this...&lt;/p&gt;</comment>
                            <comment id="13652081" author="erickerickson" created="Wed, 8 May 2013 17:24:36 +0000"  >&lt;p&gt;Thanks, man. I was taking a wild shot in the dark, obviously missing....&lt;/p&gt;</comment>
                            <comment id="13652096" author="rcmuir" created="Wed, 8 May 2013 17:32:29 +0000"  >&lt;p&gt;I committed the close()&apos;ing (and a best-effort hack+assume). So I think we are now ok.&lt;/p&gt;</comment>
                            <comment id="13652188" author="thetaphi" created="Wed, 8 May 2013 18:31:26 +0000"  >&lt;p&gt;Thanks for referring to my Schindler-hack in the comment! I did this the same way in forbidden-apis, so the hack comes from there: &lt;a href=&quot;https://code.google.com/p/forbidden-apis/source/browse/trunk/src/main/java/de/thetaphi/forbiddenapis/AbstractCheckMojo.java?r=153#229&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://code.google.com/p/forbidden-apis/source/browse/trunk/src/main/java/de/thetaphi/forbiddenapis/AbstractCheckMojo.java?r=153#229&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So I told this Robert privately (was on phone) how to handle URLClassLoader without reflecting methods. The addition of the Closeable interface to URLClassLoader is one of the &quot;important&quot; Java 7 bug fixes, which is also listed in Java 7&apos;s release notes (which was added to make e.g. Tomcat be able to remove the JAR files of a webapp when redeploying them on a windows container...).&lt;/p&gt;</comment>
                            <comment id="13653608" author="shalinmangar" created="Fri, 10 May 2013 07:18:48 +0000"  >&lt;p&gt;Is there anything left here? Can I backport the commits to 4.3.1?&lt;/p&gt;</comment>
                            <comment id="13654369" author="erickerickson" created="Fri, 10 May 2013 10:56:40 +0000"  >&lt;p&gt;Go for it. Be sure to apply both the &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4791&quot; title=&quot;solr.xml sharedLib does not work in 4.3.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4791&quot;&gt;&lt;del&gt;SOLR-4791&lt;/del&gt;&lt;/a&gt;.patch and closeLoader.patch. They were originally applied in that order, but I doubt it matters.&lt;/p&gt;</comment>
                            <comment id="13654370" author="erickerickson" created="Fri, 10 May 2013 10:57:38 +0000"  >&lt;p&gt;Haven&apos;t seen any test failures since Robert added the patch so I&apos;m marking this resolved.&lt;/p&gt;</comment>
                            <comment id="13654423" author="rcmuir" created="Fri, 10 May 2013 12:38:36 +0000"  >&lt;p&gt;shouldn&apos;t this have a changes entry?&lt;/p&gt;</comment>
                            <comment id="13654526" author="commit-tag-bot" created="Fri, 10 May 2013 14:54:02 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; erick&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1481038&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1481038&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;added to CHANGES.txt for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4791&quot; title=&quot;solr.xml sharedLib does not work in 4.3.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4791&quot;&gt;&lt;del&gt;SOLR-4791&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13654533" author="commit-tag-bot" created="Fri, 10 May 2013 15:00:55 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;lucene_solr_4_3 commit&amp;#93;&lt;/span&gt; erick&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1481043&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1481043&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;added to CHANGES.txt for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4791&quot; title=&quot;solr.xml sharedLib does not work in 4.3.0&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4791&quot;&gt;&lt;del&gt;SOLR-4791&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13683761" author="janhoy" created="Fri, 14 Jun 2013 20:44:47 +0000"  >&lt;p&gt;Testing the new 4.3.1 - still not getting sharedLib to work. Seems this issue was never backported to 4.3.1 even if the CHANGES entry was???&lt;/p&gt;</comment>
                            <comment id="13683834" author="erickerickson" created="Fri, 14 Jun 2013 21:52:07 +0000"  >&lt;p&gt;I certainly never backported it, and there&apos;s no commit bag bot entry that&apos;d make me believe it was.....&lt;/p&gt;

&lt;p&gt;Erick&lt;/p&gt;</comment>
                            <comment id="13683878" author="janhoy" created="Fri, 14 Jun 2013 22:47:29 +0000"  >&lt;p&gt;Ok, I see what happened, the CHANGES commit 1481043 went to lucene_solr_4_3, but it should have been on branch_4x. You fix?&lt;/p&gt;</comment>
                            <comment id="13684082" author="shalinmangar" created="Sat, 15 Jun 2013 05:16:12 +0000"  >&lt;p&gt;Ah, so what should we do now? I saw the commit bot entry on lucene_solr_4_3 and assumed that erick had backported this issue. The release vote has passed and artifacts are making their way into the mirrors.&lt;/p&gt;</comment>
                            <comment id="13684154" author="erickerickson" created="Sat, 15 Jun 2013 12:12:41 +0000"  >&lt;p&gt;I don&apos;t think we should re-spin the release at this point, or release a 4.3.2, especially when we&apos;re already talking about 4.4 relatively soon.&lt;/p&gt;</comment>
                            <comment id="13690306" author="erickerickson" created="Fri, 21 Jun 2013 14:09:24 +0000"  >&lt;p&gt;right, it missed 4.3.1 but will be in 4.4&lt;/p&gt;

&lt;p&gt;Erick&lt;/p&gt;
</comment>
                            <comment id="13716878" author="steve_rowe" created="Tue, 23 Jul 2013 18:38:51 +0000"  >&lt;p&gt;Bulk close resolved 4.4 issues&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12582310" name="SOLR-4791-test.patch" size="4166" author="erickerickson" created="Wed, 8 May 2013 16:10:30 +0000"/>
                            <attachment id="12582283" name="SOLR-4791.patch" size="11494" author="erickerickson" created="Wed, 8 May 2013 11:07:31 +0000"/>
                            <attachment id="12582263" name="SOLR-4791.patch" size="12005" author="rjernst" created="Wed, 8 May 2013 06:39:59 +0000"/>
                            <attachment id="12582242" name="SOLR-4791.patch" size="623" author="rjernst" created="Wed, 8 May 2013 02:24:56 +0000"/>
                            <attachment id="12582314" name="closeLoader.patch" size="2800" author="rcmuir" created="Wed, 8 May 2013 16:58:28 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>326698</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kd0v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>327043</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>