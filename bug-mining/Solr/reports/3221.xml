<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:19:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9977] reproducible failures in DistribDocExpirationUpdateProcessorTest due to IndexWriterConfig randomization</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9977</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Here&apos;s an example of a seed that currently fails reliably on master...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ant test  -Dtestcase=DistribDocExpirationUpdateProcessorTest -Dtests.method=test -Dtests.seed=34988FCF7C369D9 -Dtests.slow=true -Dtests.locale=el -Dtests.timezone=Etc/GMT+10 -Dtests.asserts=true -Dtests.file.encoding=US-ASCII
   [junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: Exactly one shard should have changed, instead: [core_node1, core_node2] nodes=([expiry_shard2_replica1(core_node1), expiry_shard1_replica1(core_node2)]) expected:&amp;lt;1&amp;gt; but was:&amp;lt;2&amp;gt;
   [junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([34988FCF7C369D9:8B1DB726593F0421]:0)
   [junit4]    &amp;gt; 	at org.apache.solr.cloud.DistribDocExpirationUpdateProcessorTest.test(DistribDocExpirationUpdateProcessorTest.java:116)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The meat of the test is to verify that the periodic DBQs triggered by the DocExpirationUpdateProcessor don&apos;t cause unnecessary new searchers w/cache flushing/warming.  &amp;#8211; only shards affected by  deltheetes get their searchers re-opened.&lt;/p&gt;

&lt;p&gt;enabling infoStream logging on the test shows that (something I havne&apos;t fully dug into in) the randomized IndexWriterConfig is causing the IndexWriter to generate a new segments file after a commit early in the test &amp;#8211; completely unrelated to the DBQ+commit logic we&apos;re paying close attention to &amp;#8211; that still contains the exact same underlying segments/docs.  It&apos;s just a new segments file name with a new index version# &amp;#8211; which throws off the index version# tracking the test is using to make sure only the segment that should be impacted by our DBQ is impacted by the DBQ.&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Since this kind of randomized index changing under the covers contradicts the methodology used in the test, it should be removed so we can reliably know that the only reason an reader/searcher changes is either because the solr code being tested does it deliberately, or because of a bug that needs fixed.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13035726">SOLR-9977</key>
            <summary>reproducible failures in DistribDocExpirationUpdateProcessorTest due to IndexWriterConfig randomization</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Jan 2017 23:58:28 +0000</created>
                <updated>Sat, 8 Jun 2019 15:33:41 +0000</updated>
                            <resolved>Wed, 18 Jan 2017 00:38:07 +0000</resolved>
                                                    <fixVersion>6.5</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15827136" author="jira-bot" created="Wed, 18 Jan 2017 00:37:40 +0000"  >&lt;p&gt;Commit 70f312943e53e60c27e3ccf589bd3829b63e5d84 in lucene-solr&apos;s branch refs/heads/branch_6x from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=70f3129&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=70f3129&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9977&quot; title=&quot;reproducible failures in DistribDocExpirationUpdateProcessorTest due to IndexWriterConfig randomization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9977&quot;&gt;&lt;del&gt;SOLR-9977&lt;/del&gt;&lt;/a&gt;: Fix config bug in DistribDocExpirationUpdateProcessorTest that allowed false assumptions about when index version changes&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 9ee48aa857e15461dd6ec6482194141da72e0ba2)&lt;/p&gt;</comment>
                            <comment id="15827138" author="jira-bot" created="Wed, 18 Jan 2017 00:37:42 +0000"  >&lt;p&gt;Commit 9ee48aa857e15461dd6ec6482194141da72e0ba2 in lucene-solr&apos;s branch refs/heads/master from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9ee48aa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9ee48aa&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9977&quot; title=&quot;reproducible failures in DistribDocExpirationUpdateProcessorTest due to IndexWriterConfig randomization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9977&quot;&gt;&lt;del&gt;SOLR-9977&lt;/del&gt;&lt;/a&gt;: Fix config bug in DistribDocExpirationUpdateProcessorTest that allowed false assumptions about when index version changes&lt;/p&gt;</comment>
                            <comment id="15878514" author="jira-bot" created="Wed, 22 Feb 2017 15:49:44 +0000"  >&lt;p&gt;Commit c58eac13378f618532190348574d96a72ef413e7 in lucene-solr&apos;s branch refs/heads/branch_6x from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c58eac1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c58eac1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9977&quot; title=&quot;reproducible failures in DistribDocExpirationUpdateProcessorTest due to IndexWriterConfig randomization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9977&quot;&gt;&lt;del&gt;SOLR-9977&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9979&quot; title=&quot;Macro expansion should not be done in shard requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9979&quot;&gt;&lt;del&gt;SOLR-9979&lt;/del&gt;&lt;/a&gt;: move CHANGES entries to correct section (Bug)&lt;/p&gt;

&lt;p&gt;Aparently these were shifted during merge/cherry-picks&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 38 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38ul3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>