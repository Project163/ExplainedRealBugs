<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:14:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7374] Backup/Restore should provide a param for specifying the directory implementation it should use</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7374</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Currently when we create a backup we use SimpleFSDirectory to write the backup indexes. Similarly during a restore we open the index using FSDirectory.open . &lt;/p&gt;

&lt;p&gt;We should provide a param called &lt;tt&gt;directoryImpl&lt;/tt&gt; or &lt;tt&gt;type&lt;/tt&gt; which will be used to specify the Directory implementation to backup the index. &lt;br/&gt;
Likewise during a restore you would need to specify the directory impl which was used during backup so that the index can be opened correctly.&lt;/p&gt;

&lt;p&gt;This param will address the problem that currently if a user is running Solr on HDFS there is no way to use the backup/restore functionality as the directory is hardcoded.&lt;/p&gt;

&lt;p&gt;With this one could be running Solr on a local FS but backup the index on HDFS etc.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12820026">SOLR-7374</key>
            <summary>Backup/Restore should provide a param for specifying the directory implementation it should use</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="varun">Varun Thacker</assignee>
                                    <reporter username="varun">Varun Thacker</reporter>
                        <labels>
                    </labels>
                <created>Fri, 10 Apr 2015 11:33:25 +0000</created>
                <updated>Thu, 21 Nov 2019 00:42:28 +0000</updated>
                            <resolved>Mon, 27 Jun 2016 06:41:31 +0000</resolved>
                                                    <fixVersion>6.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="14493005" author="janhoy" created="Mon, 13 Apr 2015 20:20:41 +0000"  >&lt;p&gt;Looking forward to a collection backup command, we can imagine a cluster wide set of Directory configurations, such as an &lt;tt&gt;S3Directory&lt;/tt&gt; configured with API keys etc. So should be letting each core/shard backup/restore command be able to write/read the backup directly to/from such cluster-wide locations. One way could be to support protocol and config in the &lt;tt&gt;location&lt;/tt&gt; attribute, e.g. &lt;tt&gt;s3:/backups/collection1/shard1&lt;/tt&gt;. Would make it super simple for Overseer to kick off a bunch of backup jobs across a cluster and let each shard write directly to correct target instead of intermediate local stoage. No idea of how to configure cluster-wide Directory configs though.&lt;/p&gt;</comment>
                            <comment id="15207510" author="hgadre" created="Tue, 22 Mar 2016 23:25:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; are you still working on this? If not, I would like to take a crack at it...&lt;/p&gt;</comment>
                            <comment id="15211093" author="varunthacker" created="Thu, 24 Mar 2016 22:50:26 +0000"  >&lt;p&gt;Hi Hrishikesh,&lt;/p&gt;

&lt;p&gt;Please feel free to work on it. I&apos;ve not got time to even look back at this issue unfortunately.&lt;/p&gt;

&lt;p&gt;I&apos;ll be glad to review if you work on a patch though&lt;/p&gt;</comment>
                            <comment id="15211148" author="hgadre" created="Thu, 24 Mar 2016 23:49:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; Sure. I think at the high-level we can expose API to configure Directory configurations for storing snapshots (e.g. local filesystem, HDFS, S3 etc.). As part of the implementation, we can store this config to ZK. Once this mechanism in place, we can pass appropriate directory configuration during the backup command execution. Does this make sense?&lt;/p&gt;

&lt;p&gt;CC  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt; (who is also interested in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5750&quot; title=&quot;Backup/Restore API for SolrCloud&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5750&quot;&gt;&lt;del&gt;SOLR-5750&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;</comment>
                            <comment id="15228886" author="dsmiley" created="Wed, 6 Apr 2016 18:53:49 +0000"  >&lt;p&gt;+1 to a specifying protocol/impl as a prefix.  Presumably there would need to then be a way to register them and look them up.&lt;/p&gt;</comment>
                            <comment id="15281198" author="hgadre" created="Thu, 12 May 2016 04:35:36 +0000"  >&lt;p&gt;Please find the patch attached. It includes following&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;A backup repository interface and concrete implementations for local file-system and HDFS&lt;/li&gt;
	&lt;li&gt;Ability to configure repositories via solr.xml&lt;/li&gt;
	&lt;li&gt;Refactored the &quot;core&quot; level backup/restore to use this repository interface&lt;/li&gt;
	&lt;li&gt;Unit test for HDFS integration.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15282280" author="hgadre" created="Fri, 13 May 2016 00:23:20 +0000"  >&lt;p&gt;Updated patch (includes couple of bug fixes).&lt;/p&gt;</comment>
                            <comment id="15292265" author="tomasflobbe" created="Thu, 19 May 2016 22:29:17 +0000"  >&lt;p&gt;I came to this issue following the discussion in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9055&quot; title=&quot;Make collection backup/restore extensible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9055&quot;&gt;&lt;del&gt;SOLR-9055&lt;/del&gt;&lt;/a&gt;. I really like this patch. It should also allow future improvements (like making the backups incremental) and since it&apos;s really low level most of the logic is in the SnapShooter can be shared no matter what storage system is used. &lt;/p&gt;

&lt;p&gt;Small comment. There seems to be a bug in &lt;tt&gt;BackupRepositoryFactory&lt;/tt&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;BackupRepositoryFactory.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isDefault &amp;amp;&amp;amp; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.defaultBackupRepoPlugin != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;)) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.defaultBackupRepoPlugin != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SolrException(ErrorCode.SERVER_ERROR, &lt;span class=&quot;code-quote&quot;&gt;&quot;More than one backup repository is configured as &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;&quot;&lt;/span&gt;);
    }
    &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.defaultBackupRepoPlugin = backupRepoPlugins[i];
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Some improvements to &lt;tt&gt;TestSolrXml&lt;/tt&gt; could catch this?&lt;br/&gt;
I&apos;d also add some more logging to this class, like &lt;tt&gt;logging.info(&quot;Adding BackupRepositoryFactory foo&quot;);&lt;/tt&gt;. Configuration is pretty open to mistakes that are difficult to track.&lt;/p&gt;</comment>
                            <comment id="15292559" author="hgadre" created="Fri, 20 May 2016 02:11:15 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tflobbe&quot; class=&quot;user-hover&quot; rel=&quot;tflobbe&quot;&gt;tflobbe&lt;/a&gt; Thanks for the review. Let me submit an updated patch with your comments.&lt;/p&gt;</comment>
                            <comment id="15295832" author="hgadre" created="Mon, 23 May 2016 01:52:34 +0000"  >&lt;p&gt;Here is an updated patch which addresses the review comments from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tflobbe&quot; class=&quot;user-hover&quot; rel=&quot;tflobbe&quot;&gt;tflobbe&lt;/a&gt; &lt;/p&gt;</comment>
                            <comment id="15302519" author="markrmiller@gmail.com" created="Thu, 26 May 2016 17:23:19 +0000"  >&lt;p&gt;Where are we at here? I&apos;d really like to get this in so that &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9055&quot; title=&quot;Make collection backup/restore extensible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9055&quot;&gt;&lt;del&gt;SOLR-9055&lt;/del&gt;&lt;/a&gt; can also be wrapped up. What do you think @varunthacker1989 &lt;/p&gt;</comment>
                            <comment id="15307998" author="hgadre" created="Tue, 31 May 2016 16:05:08 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; could you please review the patch?&lt;/p&gt;</comment>
                            <comment id="15312753" author="markrmiller@gmail.com" created="Thu, 2 Jun 2016 17:48:25 +0000"  >&lt;p&gt;I&apos;m going to steal this issue &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15316839" author="markrmiller@gmail.com" created="Mon, 6 Jun 2016 17:42:29 +0000"  >&lt;p&gt;I&apos;m try to pinpoint if this has destabilized TestReplicationHandlerBackup or if it was before. Otherwise this is looking pretty good, just want to do a little manual testing. Anything else would be nitpicky mostly, but perhaps more comments coming.&lt;/p&gt;</comment>
                            <comment id="15323481" author="hgadre" created="Thu, 9 Jun 2016 22:15:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; Let me know if you need anything from my side. If you could post the test params (for failure), I can take a look.&lt;/p&gt;</comment>
                            <comment id="15325052" author="hgadre" created="Fri, 10 Jun 2016 18:39:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; Please find the updated patch which resolves the TestReplicationHandlerBackup failure.&lt;/p&gt;</comment>
                            <comment id="15329338" author="markrmiller@gmail.com" created="Tue, 14 Jun 2016 11:22:44 +0000"  >&lt;p&gt;Thanks, I&apos;m pretty much ready with this.&lt;/p&gt;

&lt;p&gt;One comment: Shouldn&apos;t we make BackupRepository an abstract class rather than interface? We can only add default methods in Java 8, but branch6x is still Java 7 right? Backcompat will be easier with abstract for now I think.&lt;/p&gt;</comment>
                            <comment id="15329512" author="markrmiller@gmail.com" created="Tue, 14 Jun 2016 13:41:02 +0000"  >&lt;p&gt;Just found the follow fail. Does not seem to be repeatable by seed, must be timing or something.&lt;/p&gt;

&lt;p&gt;   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt; ERROR   0.72s J4  | TestReplicationHandlerBackup.doTestBackup &amp;lt;&amp;lt;&amp;lt;&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; Throwable #1: java.util.NoSuchElementException&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at __randomizedtesting.SeedInfo.seed(&lt;span class=&quot;error&quot;&gt;&amp;#91;2234E0A12F864773:63BFC0C40838B43C&amp;#93;&lt;/span&gt;:0)&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at sun.nio.fs.UnixDirectoryStream$UnixDirectoryIterator.next(UnixDirectoryStream.java:215)&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at sun.nio.fs.UnixDirectoryStream$UnixDirectoryIterator.next(UnixDirectoryStream.java:132)&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at org.apache.solr.handler.TestReplicationHandlerBackup.doTestBackup(TestReplicationHandlerBackup.java:174)&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;   2&amp;gt; 563888 INFO  (SUITE-TestReplicationHandlerBackup-seed#&lt;span class=&quot;error&quot;&gt;&amp;#91;2234E0A12F864773&amp;#93;&lt;/span&gt;-worker) [    ] o.a.s.SolrTestCaseJ4 ###deleteCore&lt;/p&gt;

&lt;p&gt;   NOTE: reproduce with: ant test  -Dtestcase=TestReplicationHandlerBackup -Dtests.method=doTestBackup -Dtests.seed=2234E0A12F864773 -Dtests.slow=true -Dtests.locale=sk -Dtests.timezone=Asia/Calcutta -Dtests.asserts=true -Dtests.file.encoding=US-ASCII&lt;/p&gt;</comment>
                            <comment id="15329554" author="dsmiley" created="Tue, 14 Jun 2016 14:06:52 +0000"  >&lt;blockquote&gt;&lt;p&gt;One comment: Shouldn&apos;t we make BackupRepository an abstract class rather than interface? We can only add default methods in Java 8, but branch6x is still Java 7 right?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No; we&apos;re all Java 8 now &amp;#8211; master &amp;amp; 6x.  You must be thinking of 5x which was Java 7.&lt;/p&gt;</comment>
                            <comment id="15329679" author="markrmiller@gmail.com" created="Tue, 14 Jun 2016 15:35:17 +0000"  >&lt;p&gt;Looks like for the test fail we may just have to check the backup status and wait in a spot we are not.&lt;/p&gt;</comment>
                            <comment id="15329707" author="hgadre" created="Tue, 14 Jun 2016 15:51:33 +0000"  >&lt;p&gt;Looking into this...&lt;/p&gt;</comment>
                            <comment id="15331892" author="varunthacker" created="Wed, 15 Jun 2016 15:07:39 +0000"  >&lt;p&gt;Hi Hrishikesh,&lt;/p&gt;

&lt;p&gt;Patch is looking good! &lt;/p&gt;

&lt;p&gt;Here are my main two concerns &lt;/p&gt;

&lt;p&gt;I think we need to deal with the &quot;location&quot; param better. Before this patch we used to read location as a query param . If the query param is empty then we read it from the cluster property. &lt;br/&gt;
With this patch we are adding the ability to specify &quot;location&quot; in the solr.xml file but it will never be used? CollectionsHandler will bail out early today .&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; location = req.getParams().get(&lt;span class=&quot;code-quote&quot;&gt;&quot;location&quot;&lt;/span&gt;);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (location == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
          location = h.coreContainer.getZkController().getZkStateReader().getClusterProperty(&lt;span class=&quot;code-quote&quot;&gt;&quot;location&quot;&lt;/span&gt;, (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
        }
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (location == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SolrException(ErrorCode.BAD_REQUEST, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;location&apos;&lt;/span&gt; is not specified as a query parameter or set as a cluster property&quot;&lt;/span&gt;);
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;One approach would be to deprecate the usage of cluster prop and look at query param followed by solr.xml ? Looking at three places seems messy . &lt;/p&gt;

&lt;p&gt;&lt;tt&gt;repo&lt;/tt&gt; is the key used to specify the implementation. In Solr xml the tag is called &lt;tt&gt;repository&lt;/tt&gt; . Should we just use repository throughout?&lt;/p&gt;

&lt;p&gt;Small changes:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Javadocs for BackupRepository - s/index/indexes&lt;/li&gt;
	&lt;li&gt;I think we should follow the &lt;tt&gt;if (condition)&lt;/tt&gt; spacing convention ? Some of the places don&apos;t have spaceIn and some do.&lt;/li&gt;
	&lt;li&gt;In &lt;tt&gt;BackupRepositoryFactory&lt;/tt&gt; : In these two log log lines can we mention the name as well - &lt;tt&gt;LOG.info(&quot;Default configuration for backup repository is with configuration params {}&quot;, defaultBackupRepoPlugin);&lt;/tt&gt; and &lt;tt&gt;LOG.info(&quot;Added backup repository with configuration params {}&quot;, backupRepoPlugins[i]);&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Can we reuse the &quot;location&quot; string with (BackupRepository.DEFAULT_LOCATION_PROPERTY) on line 871/925 of CoreAdminOperation? Let&apos;s fix it in CollectionsHandler and OverseerCollectionMessageHandler as well?&lt;/li&gt;
	&lt;li&gt;In RestoreCore do we need to deprecate the old RestoreCore ctor ? Any reason why we can&apos;t remove it directly?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15331898" author="markrmiller@gmail.com" created="Wed, 15 Jun 2016 15:12:57 +0000"  >&lt;p&gt;I have the following changes already in my local copy:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;fixed formatting&lt;/li&gt;
	&lt;li&gt;use BackupRepository.DEFAULT_LOCATION_PROPERTY&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Let me take a look at the location param in solr.xml issue.&lt;/p&gt;</comment>
                            <comment id="15331958" author="markrmiller@gmail.com" created="Wed, 15 Jun 2016 15:59:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;&quot;location&quot; in the solr.xml &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The baseLocation in the test solr.xml files just looks like dev cruft to me.&lt;/p&gt;</comment>
                            <comment id="15332011" author="markrmiller@gmail.com" created="Wed, 15 Jun 2016 16:22:22 +0000"  >&lt;p&gt;New patch.&lt;/p&gt;</comment>
                            <comment id="15332029" author="markrmiller@gmail.com" created="Wed, 15 Jun 2016 16:29:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;deprecate the usage of cluster prop and look at query param followed by solr.xml &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It is a bit odd to have some config in solr.xml and then default location as a cluster prop, but much nicer to be able to easily change the default location on the fly. solr.xml is a pain to change and requires a restart.&lt;/p&gt;</comment>
                            <comment id="15332291" author="hgadre" created="Wed, 15 Jun 2016 18:41:20 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; Thanks for the comments!&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I think we need to deal with the &quot;location&quot; param better. Before this patch we used to read location as a query param . If the query param is empty then we read it from the cluster property. &lt;/p&gt;&lt;/blockquote&gt;

&lt;blockquote&gt;&lt;p&gt;With this patch we are adding the ability to specify &quot;location&quot; in the solr.xml file but it will never be used? CollectionsHandler will bail out early today .&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is a partial patch handling ONLY core level changes. The collection level changes are being captured in the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9055&quot; title=&quot;Make collection backup/restore extensible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9055&quot;&gt;&lt;del&gt;SOLR-9055&lt;/del&gt;&lt;/a&gt;. I did this to keep the patch relatively short and easier to review. In the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9055&quot; title=&quot;Make collection backup/restore extensible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9055&quot;&gt;&lt;del&gt;SOLR-9055&lt;/del&gt;&lt;/a&gt; - I have changed the CollectionsHandler implementation to read default location from solr.xml (instead of cluster property). Since this core level operation is &quot;internal&quot; - technically we don&apos;t have to handle the case for missing &quot;location&quot; param in this patch (i.e. we can keep the original behavior). I think I made this change to simplify unit testing.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;One approach would be to deprecate the usage of cluster prop and look at query param followed by solr.xml ? Looking at three places seems messy .&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Mark&amp;#93;&lt;/span&gt; It is a bit odd to have some config in solr.xml and then default location as a cluster prop, but much nicer to be able to easily change the default location on the fly. solr.xml is a pain to change and requires a restart.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree that cluster property approach is more convenient as compared to solr.xml. But since we allow users to configure multiple repositories in solr.xml, we can not really use the current cluster property as is. This is because user may want to specify different location for different file-systems (or repositories). Hence at minimum we need one cluster property per repository configuration (e.g. name could be &amp;lt;repository-name&amp;gt;-location). But based on my understanding CLUSTERPROP API implementation requires fixed (or well-known) property names,&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/651499c82df482b493b0ed166c2ab7196af0a794/solr/solrj/src/java/org/apache/solr/common/cloud/ClusterProperties.java#L90&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/651499c82df482b493b0ed166c2ab7196af0a794/solr/solrj/src/java/org/apache/solr/common/cloud/ClusterProperties.java#L90&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;We may have to relax this restriction for this work. On the other hand, specifying default location in solr.xml is not so bad since user can always specify a location parameter to avoid restarting the Solr cluster. Thoughts?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Can we reuse the &quot;location&quot; string with (BackupRepository.DEFAULT_LOCATION_PROPERTY) on line 871/925 of CoreAdminOperation? Let&apos;s fix it in CollectionsHandler and OverseerCollectionMessageHandler as well?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Let me fix the CoreAdminOperation in this patch. I will defer the collection level changes to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9055&quot; title=&quot;Make collection backup/restore extensible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9055&quot;&gt;&lt;del&gt;SOLR-9055&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;In RestoreCore do we need to deprecate the old RestoreCore ctor ? Any reason why we can&apos;t remove it directly?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The deprecated constructor is used by the ReplicationHandler. The new constructor expects the BackupRepository reference which can be obtained only via CoreContainer. I couldn&apos;t find a way to get hold of CoreContainer in ReplicationHandler. Hence I didn&apos;t remove this constructor.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;repo is the key used to specify the implementation. In Solr xml the tag is called repository . Should we just use repository throughout?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sure that make sense. Let me fix this.&lt;/p&gt;

</comment>
                            <comment id="15332447" author="hgadre" created="Wed, 15 Jun 2016 20:03:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; Here is an updated patch.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Fixed trailing white-spaces&lt;/li&gt;
	&lt;li&gt;Removed unused and deprecated constructor from RestoreCore&lt;/li&gt;
	&lt;li&gt;Renamed constant referring to &quot;location&quot; property in BackupRepository interface.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;All the other review comments were already incorporated in your earlier patch.&lt;/p&gt;</comment>
                            <comment id="15333537" author="varunthacker" created="Thu, 16 Jun 2016 10:33:50 +0000"  >&lt;p&gt;Hi Hrishikesh,&lt;/p&gt;

&lt;p&gt;Thanks for the updated patch! Looks good&lt;/p&gt;

&lt;p&gt;While reviewing it I didn&apos;t understand one thing -&lt;/p&gt;

&lt;p&gt;In &lt;tt&gt;ReplicationHandler#restore&lt;/tt&gt; why are we always using &lt;tt&gt;LocalFileSystemRepository&lt;/tt&gt; and not reading any &lt;tt&gt;repository&lt;/tt&gt; param? &lt;br/&gt;
Currently to backup/restore in standalone mode we use the replication handler ( &lt;a href=&quot;https://cwiki.apache.org/confluence/display/solr/Making+and+Restoring+Backups+of+SolrCores&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/solr/Making+and+Restoring+Backups+of+SolrCores&lt;/a&gt; ) . I think we should read the &lt;tt&gt;repository&lt;/tt&gt; param and initialize accordingly.&lt;/p&gt;

&lt;p&gt;The backup/restore operation that is in CoreAdminOperation was added as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5750&quot; title=&quot;Backup/Restore API for SolrCloud&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5750&quot;&gt;&lt;del&gt;SOLR-5750&lt;/del&gt;&lt;/a&gt; for the Overseer to be able to call backup/restore on individual cores.&lt;/p&gt;


&lt;p&gt;I don&apos;t think this set of comments is entirely true. The first version of backup which had been there for ages allowed an empty location param and resorted to the cores data directory. It had nothing to do with shared file systems . The back compat part is true though.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-comment&quot;&gt;// Note - This logic is only applicable to the usecase where a shared file-system is exposed via
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// local file-system &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; (primarily &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; backwards compatibility). For other use-cases, users
&lt;/span&gt;    &lt;span class=&quot;code-comment&quot;&gt;// will be required to specify &lt;span class=&quot;code-quote&quot;&gt;&quot;location&quot;&lt;/span&gt; where the backup should be stored.&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Lastly you mentioned this in a previous comment &lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;This is a partial patch handling ONLY core level changes. The collection level changes are being captured in the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9055&quot; title=&quot;Make collection backup/restore extensible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9055&quot;&gt;&lt;del&gt;SOLR-9055&lt;/del&gt;&lt;/a&gt;. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;However &lt;tt&gt;TestHdfsBackupRestore&lt;/tt&gt;  added in this patch is a solr cloud test . What other work is left for supporting collection level changes? &lt;br/&gt;
I only briefly looked at &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9055&quot; title=&quot;Make collection backup/restore extensible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9055&quot;&gt;&lt;del&gt;SOLR-9055&lt;/del&gt;&lt;/a&gt; and couldn&apos;t tell why we need ShardRequestProcessor  etc. &lt;br/&gt;
I would think the only work required would be in CollectionsHandler to deal with &quot;location&quot; , in OverseerCollectionMessageHandler the part where we read/write the meta information and ZK configs?&lt;/p&gt;</comment>
                            <comment id="15333604" author="varunthacker" created="Thu, 16 Jun 2016 11:29:02 +0000"  >&lt;p&gt;Also i found &lt;tt&gt;ZkStateReader#BACKUP_LOCATION&lt;/tt&gt; constant. We should merge those two constants I guess&lt;/p&gt;</comment>
                            <comment id="15334207" author="hgadre" created="Thu, 16 Jun 2016 17:21:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; Thanks for the comments.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;In ReplicationHandler#restore why are we always using LocalFileSystemRepository and not reading any repository param? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The reason is that ReplicationHandler is not configured with the CoreContainer (which is required to fetch the repository configuration). Also building two parallel implementations for the same functionality doesn&apos;t quite make sense. Can we instead make the Core level Backup/Restore APIs public (i.e. not limited to Solrcloud)? This allows users to keep using ReplicationHandler in case of local file-system but if they need to integrate with other file-systems they can move to these core level APIs. If feasible, we can even deprecate (and remove) backup/restore APIs from ReplicationHandler in future.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;However TestHdfsBackupRestore added in this patch is a solr cloud test . What other work is left for supporting collection level changes? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I had to implement this test as a &quot;cloud&quot; test so as to enable testing these core level operations (since these operations are enabled only in the cloud mode). The collection-level changes include,&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Backup/restore collection metadata&lt;/li&gt;
	&lt;li&gt;Check the version compatibility during restore&lt;/li&gt;
	&lt;li&gt;Strategy interface to define &quot;how&quot; backup operation is performed (e.g. copying the index files vs. a file-system snapshot etc.)&lt;/li&gt;
&lt;/ul&gt;


&lt;blockquote&gt;&lt;p&gt;I only briefly looked at &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9055&quot; title=&quot;Make collection backup/restore extensible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9055&quot;&gt;&lt;del&gt;SOLR-9055&lt;/del&gt;&lt;/a&gt; and couldn&apos;t tell why we need ShardRequestProcessor etc. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The main reason is to implement a index backup strategy. Also in general processing shard requests is such a common functionality that embedding it in the OverseerCollectionMessageHandler doesn&apos;t quite seem right (from modularity perspective).&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Also i found ZkStateReader#BACKUP_LOCATION constant. We should merge those two constants I guess&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Make sense. Let me do that.&lt;/p&gt;
</comment>
                            <comment id="15334233" author="varunthacker" created="Thu, 16 Jun 2016 17:33:14 +0000"  >&lt;blockquote&gt;&lt;p&gt;Also building two parallel implementations for the same functionality doesn&apos;t quite make sense.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Indeed . It&apos;s far from ideal right now. We document the core level backup/restore via the replication handler as thats where it was supported . &lt;/p&gt;

&lt;p&gt;With &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5750&quot; title=&quot;Backup/Restore API for SolrCloud&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5750&quot;&gt;&lt;del&gt;SOLR-5750&lt;/del&gt;&lt;/a&gt; a hook to Core Admin to leverage it . It was simply for convenience and not meant to be made public. Maybe we should fix it leverage the ReplicationHandler instead . Or we could deprecate the usage via Replication Handler as it&apos;s more of a core admin operation anyways.&lt;/p&gt;

&lt;p&gt;But I think let&apos;s keep that to a separate Jira/discussion? For the scope of this Jira can we just support it in ReplicationHandler as well ?&lt;/p&gt;</comment>
                            <comment id="15334905" author="hgadre" created="Thu, 16 Jun 2016 23:10:09 +0000"  >&lt;blockquote&gt;&lt;p&gt;For the scope of this Jira can we just support it in ReplicationHandler as well ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sure I am working on this. It looks like we may not be able to provide identical behavior w.r.t. core level backup/restore API. &lt;br/&gt;
Specifically when user does not specify &quot;location&quot; parameter, the existing ReplicationHandler implementation uses a directory relative to the &quot;data&quot; directory. e.g.&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/a4455a4b14f2bf947db1136f9d5fc7d0d88d32ef/solr/core/src/java/org/apache/solr/handler/ReplicationHandler.java#L419&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/a4455a4b14f2bf947db1136f9d5fc7d0d88d32ef/solr/core/src/java/org/apache/solr/handler/ReplicationHandler.java#L419&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/a4455a4b14f2bf947db1136f9d5fc7d0d88d32ef/solr/core/src/java/org/apache/solr/handler/SnapShooter.java#L67&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/a4455a4b14f2bf947db1136f9d5fc7d0d88d32ef/solr/core/src/java/org/apache/solr/handler/SnapShooter.java#L67&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;While this logic is OK on a local file-system, it would not work if user is using a different file-system for backup/restore. e.g. consider a case when a user configures HDFS repository without a default location (and using local file-system for storing index files). &lt;/p&gt;

&lt;p&gt;Note - when only a single repository is configured, we use it as a &quot;default&quot;.  Now consider a case when a user invokes backup/restore without specifying &quot;location&quot; and &quot;repository&quot; parameters, we don&apos;t want to use the &quot;data&quot; directory as the location since it may not be valid on HDFS. So I am adding a constraint that if &quot;repository&quot; parameter is specified then location must be specified either via &quot;location&quot; parameter OR via a repository configuration in solr.xml&lt;/p&gt;

&lt;p&gt;When &quot;repository&quot; parameter is not specified, we default to &quot;LocalFileSystem&quot; instead of configured default repository in solr.xml. This is to handle the use-case mentioned above. It also helps to maintain the backwards compatibility with the existing API behavior. &lt;/p&gt;

&lt;p&gt;On the other hand the Core level BACKUP API always fetches the &quot;default&quot; repository configuration from solr.xml and require that location be specified either via &quot;location&quot; parameter OR via a repository configuration. I hope this small difference in API behavior should be OK (since we should aim to retire one of the APIs).&lt;/p&gt;</comment>
                            <comment id="15334985" author="hgadre" created="Thu, 16 Jun 2016 23:41:44 +0000"  >&lt;blockquote&gt;&lt;p&gt;For the scope of this Jira can we just support it in ReplicationHandler as well ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It looks like we are also creating a snapshot as part of post commit/optimize operation. Not sure which repository should we use for this? Would this require adding another config param to ReplicationHandler?&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/a4455a4b14f2bf947db1136f9d5fc7d0d88d32ef/solr/core/src/java/org/apache/solr/handler/ReplicationHandler.java#L1324&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/a4455a4b14f2bf947db1136f9d5fc7d0d88d32ef/solr/core/src/java/org/apache/solr/handler/ReplicationHandler.java#L1324&lt;/a&gt;&lt;/p&gt;

</comment>
                            <comment id="15336417" author="hgadre" created="Fri, 17 Jun 2016 16:36:27 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; OK I think I have addressed all the review comments. Could you please take a look?&lt;/p&gt;</comment>
                            <comment id="15339387" author="varunthacker" created="Mon, 20 Jun 2016 11:57:44 +0000"  >&lt;p&gt;Changes look good!&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;It looks like we are also creating a snapshot as part of post commit/optimize operation. Not sure which repository should we use for this? Would this require adding another config param to ReplicationHandler?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Let&apos;s stick to the current model of reading from the solr.xml file and defaulting to local if its not defined ?&lt;/p&gt;</comment>
                            <comment id="15339700" author="markrmiller@gmail.com" created="Mon, 20 Jun 2016 15:22:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;, do you want to take this back for the commit now that you&apos;re back from vacation? &lt;/p&gt;</comment>
                            <comment id="15339971" author="hgadre" created="Mon, 20 Jun 2016 17:27:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Let&apos;s stick to the current model of reading from the solr.xml file and defaulting to local if its not defined ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I am not sure if you realize the problem here. This is the code snippet that I am wondering about,&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/a4455a4b14f2bf947db1136f9d5fc7d0d88d32ef/solr/core/src/java/org/apache/solr/handler/ReplicationHandler.java#L1324&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/a4455a4b14f2bf947db1136f9d5fc7d0d88d32ef/solr/core/src/java/org/apache/solr/handler/ReplicationHandler.java#L1324&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This particular code is invoked as a callback (and not directly as part of handling a user request). &lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/a4455a4b14f2bf947db1136f9d5fc7d0d88d32ef/solr/core/src/java/org/apache/solr/handler/ReplicationHandler.java#L1182&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/a4455a4b14f2bf947db1136f9d5fc7d0d88d32ef/solr/core/src/java/org/apache/solr/handler/ReplicationHandler.java#L1182&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So in case there are multiple repositories configured, we need a way to configure &lt;b&gt;which&lt;/b&gt; repository to use. In case of backup/restore API - this configuration parameter was passed by the user. I wonder if we need to add a config param in the ReplicationHandler ? &lt;/p&gt;


</comment>
                            <comment id="15340021" author="varunthacker" created="Mon, 20 Jun 2016 17:49:25 +0000"  >&lt;p&gt;Hi Hrishikesh,&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;So in case there are multiple repositories configured, we need a way to configure which repository to use&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Alternatively how do you feel about forcing a default repository if multiple repos are configured? Currently if there is just 1 we make that default but when there are multiple repositories we don&apos;t necessarily need to provide a default.&lt;/p&gt;

&lt;p&gt;Mark - Sure I can assign it to myself. I&apos;d like your opinion and Hrishikesh&apos;s opinion on this comment though  -&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;I had to implement &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; test as a &lt;span class=&quot;code-quote&quot;&gt;&quot;cloud&quot;&lt;/span&gt; test so as to enable testing these core level operations (since these operations are enabled only in the cloud mode). The collection-level changes include,
- Backup/restore collection metadata
- Check the version compatibility during restore
- Strategy &lt;span class=&quot;code-keyword&quot;&gt;interface&lt;/span&gt; to define &lt;span class=&quot;code-quote&quot;&gt;&quot;how&quot;&lt;/span&gt; backup operation is performed (e.g. copying the index files vs. a file-system snapshot etc.)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I feel the first point should be part of this Jira . We can then say this patch effectively solves makes the repository interface work for both standalone and cloud.&lt;/p&gt;

&lt;p&gt;Points 2/3 seem more like better guarantee checks and more options and aren&apos;t cloud related. We could tackle that in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9055&quot; title=&quot;Make collection backup/restore extensible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9055&quot;&gt;&lt;del&gt;SOLR-9055&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15340439" author="hgadre" created="Mon, 20 Jun 2016 21:28:55 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Alternatively how do you feel about forcing a default repository if multiple repos are configured? Currently if there is just 1 we make that default but when there are multiple repositories we don&apos;t necessarily need to provide a default.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes we can force the user to have a default repository if multiple repos are configured. But it seems to me that the code under consideration is added as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-561&quot; title=&quot;Solr replication by Solr (for windows also)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-561&quot;&gt;&lt;del&gt;SOLR-561&lt;/del&gt;&lt;/a&gt; (i.e. Solr replication). Do we need to incorporate these changes in the replication work-flow? My gut feeling is that we shouldn&apos;t make any changes to this code as part of this JIRA.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I feel the first point should be part of this Jira . We can then say this patch effectively solves makes the repository interface work for both standalone and cloud.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Based on JIRA description, I thought the requirement for this JIRA is to support core level backup/restore. But I am OK with repurposing this JIRA to cover Solr cloud as well. Its just that the patch will grow in size &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; I generally prefer to keep patch short which makes it easier to review and test. But if you are OK with larger patch, I can resubmit it. Let me know.&lt;/p&gt;
</comment>
                            <comment id="15341157" author="varunthacker" created="Tue, 21 Jun 2016 05:48:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do we need to incorporate these changes in the replication work-flow?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I think having a mandatory default repository and using that for this workflow should be enough right?&lt;/p&gt;</comment>
                            <comment id="15341266" author="markrmiller@gmail.com" created="Tue, 21 Jun 2016 07:11:03 +0000"  >&lt;p&gt;I don&apos;t see a problem with breaking off the full cloud work into another JIRA. Let&apos;s just relate them and then we can wrap this up and have a fresh canavas to discuss what has not already been reviewed.&lt;/p&gt;

&lt;p&gt;Which repo the replication handler should use seems a bit tricky. I don&apos;t like any of the current options that much. Still thinking about that a bit. &lt;/p&gt;
</comment>
                            <comment id="15341289" author="markrmiller@gmail.com" created="Tue, 21 Jun 2016 07:25:05 +0000"  >&lt;p&gt;So I think we do want it configurable in ReplicationHandler config, but if it&apos;s not config&apos;d, perhaps we could default to the first repo defined? And local if no repos are defined? Forcing a default for this seems annoying, same as forcing config. &lt;/p&gt;</comment>
                            <comment id="15341836" author="varunthacker" created="Tue, 21 Jun 2016 14:11:31 +0000"  >&lt;p&gt;FYI I created &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9239&quot; title=&quot;Deprecate  backup/restore via replication handler in favour of an equvalent core admin api&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9239&quot;&gt;SOLR-9239&lt;/a&gt; for discussing the two approaches that we have for core level backup/restore&lt;/p&gt;</comment>
                            <comment id="15341858" author="varunthacker" created="Tue, 21 Jun 2016 14:22:35 +0000"  >&lt;p&gt;Regarding the cloud level changes required, I agree with you&apos;ll - lets just then do it in another Jira as long as it&apos;s not &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9055&quot; title=&quot;Make collection backup/restore extensible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9055&quot;&gt;&lt;del&gt;SOLR-9055&lt;/del&gt;&lt;/a&gt; as those have other enhancements  . I guess I got thrown off by this comment previously.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The collection level changes are being captured in the patch for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9055&quot; title=&quot;Make collection backup/restore extensible&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9055&quot;&gt;&lt;del&gt;SOLR-9055&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="15342101" author="hgadre" created="Tue, 21 Jun 2016 16:26:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;So I think we do want it configurable in ReplicationHandler config, but if it&apos;s not config&apos;d, perhaps we could default to the first repo defined? And local if no repos are defined? Forcing a default for this seems annoying, same as forcing config.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Personally I think that the code under consideration is quite unrelated to backup/restore functionality. It was added as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-561&quot; title=&quot;Solr replication by Solr (for windows also)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-561&quot;&gt;&lt;del&gt;SOLR-561&lt;/del&gt;&lt;/a&gt; to implement replication. So my suggestion is to not consider it as part of this JIRA. We can file a separate JIRA for tracking. The backup/restore API in ReplicationHandler already accept repository parameter in my latest patch.&lt;/p&gt;</comment>
                            <comment id="15342117" author="markrmiller@gmail.com" created="Tue, 21 Jun 2016 16:37:36 +0000"  >&lt;p&gt;I have no strong preference on whether that needs to use a Repository here or not, but &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; has not seemed very amenable to ignoring it yet.&lt;/p&gt;</comment>
                            <comment id="15342235" author="varunthacker" created="Tue, 21 Jun 2016 17:22:53 +0000"  >&lt;p&gt;Yeah we can tackle that in another Jira . Whether we enforce a default repository or not , it could warrant a param in the replication handler and hence could be tackled separately.&lt;/p&gt;


&lt;p&gt;For the patch , One thing I&apos;d like to address would be - In TestHdfsBackupRestore make &lt;tt&gt;runCoreAdminCommand&lt;/tt&gt; use the Replication handler instead since thats the current documented way of running core backups/restore.&lt;/p&gt;</comment>
                            <comment id="15342842" author="hgadre" created="Tue, 21 Jun 2016 22:01:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; Please find the latest patch.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;For the patch , One thing I&apos;d like to address would be - In TestHdfsBackupRestore make runCoreAdminCommand use the Replication handler instead since thats the current documented way of running core backups/restore.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Instead of replacing the usage of core admin API with replication handler, I just added another test which uses replication handler. This way we can test both the APIs.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; I made a small change in HdfsDirectory class to define a constant for the buffer size. This way we can use the same value for both HdfsDirectory as well as HdfsBackupRepository.&lt;/p&gt;</comment>
                            <comment id="15343072" author="hgadre" created="Wed, 22 Jun 2016 00:01:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; I have filed &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9242&quot; title=&quot;Collection level backup/restore should provide a param for specifying the repository implementation it should use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9242&quot;&gt;&lt;del&gt;SOLR-9242&lt;/del&gt;&lt;/a&gt; to track the work required to enable this feature at the collection level backup/restore.&lt;/p&gt;</comment>
                            <comment id="15344284" author="varunthacker" created="Wed, 22 Jun 2016 13:13:24 +0000"  >&lt;p&gt;Hi Hrishikesh ,&lt;/p&gt;

&lt;p&gt;I took your latest patch and made a few minor changes. I&apos;ll list them out as accurately as I can ( I closed the window where I was noted down the changes while making them )&lt;/p&gt;

&lt;p&gt;1. In &lt;tt&gt;BackupRepository&lt;/tt&gt; removed some modifiers that were not needed.&lt;br/&gt;
2. Created &lt;tt&gt;BackupRestoreUtils&lt;/tt&gt; for some of the tests to reuse the classes. Methods like &lt;tt&gt;indexDocs&lt;/tt&gt; and {{verifyDocs]} were moved there and made to reuse in our all backup/restore tests&lt;br/&gt;
3. Made some modifications to the CHANGES entry&lt;br/&gt;
4. Merged the replication handler and core admin handler test in &lt;tt&gt;TestHdfsBackupRestoreCore&lt;/tt&gt; to one. We test it randomly &lt;/p&gt;

&lt;p&gt;I&apos;ve run the test suite once and it passes along with precommit. Let me know if this looks good . I plan to go over it one more time tomorrow morning and commit it otherwise&lt;/p&gt;</comment>
                            <comment id="15344745" author="hgadre" created="Wed, 22 Jun 2016 17:01:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; Thanks for the review. I think the changes look good. I have one question though.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;4. Merged the replication handler and core admin handler test in TestHdfsBackupRestoreCore to one. We test it randomly&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Wouldn&apos;t it be better to test both ways every time? I see that this pattern is used extensively in other tests too. My main concern is that the probability of one of the test not being executed in multiple iterations is &amp;gt; 0.  If someone makes any subsequent changes to this code, this unit test doesn&apos;t provide a strong assurance that these changes are correct since one of the tests may not have been executed at all. So developers end up diagnosing and fixing such issues after committing the code (which could have been done before the first commit itself). &lt;/p&gt;

&lt;p&gt;I do think that random tests are very useful to test the Solr cloud behavior (e.g. chaos monkey tests). But in this case, I am not sure if we need randomness. Any thoughts?&lt;/p&gt;</comment>
                            <comment id="15344773" author="hgadre" created="Wed, 22 Jun 2016 17:21:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; Oh BTW let&apos;s not hold up the patch for this. This is more of a question than a review comment &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15344893" author="markrmiller@gmail.com" created="Wed, 22 Jun 2016 18:03:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;So developers end up diagnosing and fixing such issues after committing the code&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This is a common issue, and usually it comes down to what the developers judge at commit. There is so much random testing going on, if we did it all in one run, the test run would take forever. At the same time, you want common paths to be fairly well tested every run.&lt;/p&gt;

&lt;p&gt;At the end of the day, I generally do it based on how painful it is in extra test time vs how core the functionality being tested is.&lt;/p&gt;

&lt;p&gt;If you are writing or changing tests, you generally run them many times before committing (at least you probably should in many cases - there is a beasting target and scripts to help with this), and you will find most things. The many Jenkins machines that are running tests all the time will find them otherwise, and that is okay too.&lt;/p&gt;

&lt;p&gt;We have a fairly lax commit then review policy and following up with a fix or two based on jenkins random fails is common.&lt;/p&gt;

&lt;p&gt;I&apos;ll leave this one for you and Varun to figure out, just giving some context.&lt;/p&gt;</comment>
                            <comment id="15346787" author="hgadre" created="Thu, 23 Jun 2016 17:17:16 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; Thanks for the insight. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; I am ok with the current test configuration. Let me know if anything is needed from my side.&lt;/p&gt;</comment>
                            <comment id="15346795" author="varunthacker" created="Thu, 23 Jun 2016 17:22:03 +0000"  >&lt;p&gt;I&apos;ve got precommit to pass. Running the test suite one more time and then committing it.&lt;/p&gt;

&lt;p&gt;I pondered marking BackupRepository as experimental in case we need iron it out , but decided against it . &lt;/p&gt;

&lt;p&gt;Do you plan on tackling &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9242&quot; title=&quot;Collection level backup/restore should provide a param for specifying the repository implementation it should use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9242&quot;&gt;&lt;del&gt;SOLR-9242&lt;/del&gt;&lt;/a&gt; as well?&lt;/p&gt;</comment>
                            <comment id="15346820" author="hgadre" created="Thu, 23 Jun 2016 17:28:12 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Do you plan on tackling &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9242&quot; title=&quot;Collection level backup/restore should provide a param for specifying the repository implementation it should use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9242&quot;&gt;&lt;del&gt;SOLR-9242&lt;/del&gt;&lt;/a&gt; as well?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yup. I already have a patch ready for submission. Just waiting for this patch to get committed to trunk.&lt;/p&gt;</comment>
                            <comment id="15346907" author="jira-bot" created="Thu, 23 Jun 2016 18:19:47 +0000"  >&lt;p&gt;Commit 07be2c42ba24fea7c4e84836aa4c3f8d059f71d6 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=07be2c4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=07be2c4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7374&quot; title=&quot;Backup/Restore should provide a param for specifying the directory implementation it should use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7374&quot;&gt;&lt;del&gt;SOLR-7374&lt;/del&gt;&lt;/a&gt;: Core level backup/restore now supports specifying a directory implementation&lt;/p&gt;</comment>
                            <comment id="15348204" author="varunthacker" created="Fri, 24 Jun 2016 12:40:45 +0000"  >&lt;p&gt;I was looking at &lt;a href=&quot;http://jenkins.thetaphi.de/job/Lucene-Solr-master-Solaris/668/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.thetaphi.de/job/Lucene-Solr-master-Solaris/668/&lt;/a&gt; , and it doesn&apos;t seem related to this jira from what I understood. It&apos;s been failing for quite a while also unfortunately.&lt;/p&gt;</comment>
                            <comment id="15350478" author="jira-bot" created="Mon, 27 Jun 2016 06:39:08 +0000"  >&lt;p&gt;Commit 36183cad87dfc3fc8f0a1e0b0c210e8bd14a4ce0 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=36183ca&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=36183ca&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7374&quot; title=&quot;Backup/Restore should provide a param for specifying the directory implementation it should use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7374&quot;&gt;&lt;del&gt;SOLR-7374&lt;/del&gt;&lt;/a&gt;: Fixing test failures like build #3366. Index a minimum of 1 doc&lt;/p&gt;</comment>
                            <comment id="15350479" author="jira-bot" created="Mon, 27 Jun 2016 06:39:56 +0000"  >&lt;p&gt;Commit eb071436331595cc453cd9c7d9c82d3269bb5e40 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=eb07143&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=eb07143&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7374&quot; title=&quot;Backup/Restore should provide a param for specifying the directory implementation it should use&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7374&quot;&gt;&lt;del&gt;SOLR-7374&lt;/del&gt;&lt;/a&gt;: Fixing test failures like build #3366. Index a minimum of 1 doc&lt;/p&gt;</comment>
                            <comment id="15350482" author="varunthacker" created="Mon, 27 Jun 2016 06:41:31 +0000"  >&lt;p&gt;Thanks Hrishikesh and Mark! &lt;/p&gt;</comment>
                            <comment id="15439045" author="mikemccand" created="Fri, 26 Aug 2016 14:00:34 +0000"  >&lt;p&gt;Bulk close resolved issues after 6.2.0 release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13242279">SOLR-13587</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12981546">SOLR-9242</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12964311">SOLR-9055</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="13006053">SOLR-9536</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12812468" name="SOLR-7374.patch" size="102819" author="varun" created="Wed, 22 Jun 2016 13:13:24 +0000"/>
                            <attachment id="12812314" name="SOLR-7374.patch" size="91945" author="hgadre" created="Tue, 21 Jun 2016 22:01:44 +0000"/>
                            <attachment id="12811405" name="SOLR-7374.patch" size="85771" author="hgadre" created="Fri, 17 Jun 2016 16:36:27 +0000"/>
                            <attachment id="12810913" name="SOLR-7374.patch" size="81539" author="hgadre" created="Wed, 15 Jun 2016 20:03:46 +0000"/>
                            <attachment id="12810876" name="SOLR-7374.patch" size="82433" author="markrmiller@gmail.com" created="Wed, 15 Jun 2016 16:25:06 +0000"/>
                            <attachment id="12809529" name="SOLR-7374.patch" size="76034" author="hgadre" created="Fri, 10 Jun 2016 18:39:29 +0000"/>
                            <attachment id="12805563" name="SOLR-7374.patch" size="75907" author="hgadre" created="Mon, 23 May 2016 01:52:34 +0000"/>
                            <attachment id="12803770" name="SOLR-7374.patch" size="69746" author="hgadre" created="Fri, 13 May 2016 00:23:20 +0000"/>
                            <attachment id="12803571" name="SOLR-7374.patch" size="69633" author="hgadre" created="Thu, 12 May 2016 04:35:36 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2d3ev:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>