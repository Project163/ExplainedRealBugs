<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:18:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7495] Unexpected docvalues type NUMERIC when grouping by a int facet</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7495</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Hey All,&lt;br/&gt;
After upgrading from solr 4.10 to 5.1 with solr could&lt;br/&gt;
I&apos;m getting a IllegalStateException when i try to facet a int field.&lt;/p&gt;

&lt;p&gt;IllegalStateException: unexpected docvalues type NUMERIC for field &apos;year&apos; (expected=SORTED). Use UninvertingReader or index with docvalues.&lt;/p&gt;



&lt;p&gt;schema.xml&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; ?&amp;gt;
&amp;lt;schema name=&lt;span class=&quot;code-quote&quot;&gt;&quot;schema&quot;&lt;/span&gt; version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.2&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;fields&amp;gt;
        &amp;lt;!-- solar cloud version field --&amp;gt;
        &amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;_version_&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;&quot;&lt;/span&gt; indexed=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; stored=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;

        &amp;lt;!-- Common fields --&amp;gt;
        &amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; indexed=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; stored=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;  multiValued=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt; required=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;index_type&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; indexed=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;  stored=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;  multiValued=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt; required=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;

        &amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;year&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&quot;&lt;/span&gt; indexed=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; stored=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;model&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; indexed=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; stored=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;year_make_model&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; indexed=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; stored=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
    &amp;lt;/fields&amp;gt;

    &amp;lt;!-- Field Types --&amp;gt;
    &amp;lt;types&amp;gt;
        &amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.StrField&quot;&lt;/span&gt; sortMissingLast=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; /&amp;gt;
        &amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.BoolField&quot;&lt;/span&gt; sortMissingLast=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.TrieIntField&quot;&lt;/span&gt; precisionStep=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt; positionIncrementGap=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.TrieFloatField&quot;&lt;/span&gt; precisionStep=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt; positionIncrementGap=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt;&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.TrieLongField&quot;&lt;/span&gt; precisionStep=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt; positionIncrementGap=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;double&lt;/span&gt;&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.TrieDoubleField&quot;&lt;/span&gt; precisionStep=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt; positionIncrementGap=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;date&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.TrieDateField&quot;&lt;/span&gt; precisionStep=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt; positionIncrementGap=&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;/&amp;gt;
        &amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;text_ngram&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.TextField&quot;&lt;/span&gt; positionIncrementGap=&lt;span class=&quot;code-quote&quot;&gt;&quot;100&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;analyzer type=&lt;span class=&quot;code-quote&quot;&gt;&quot;index&quot;&lt;/span&gt;&amp;gt;
                &amp;lt;tokenizer class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.StandardTokenizerFactory&quot;&lt;/span&gt;/&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.StopFilterFactory&quot;&lt;/span&gt; ignoreCase=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; words=&lt;span class=&quot;code-quote&quot;&gt;&quot;stopwords.txt&quot;&lt;/span&gt; /&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.LowerCaseFilterFactory&quot;&lt;/span&gt;/&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.EdgeNGramFilterFactory&quot;&lt;/span&gt; minGramSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt; maxGramSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;15&quot;&lt;/span&gt;/&amp;gt;
            &amp;lt;/analyzer&amp;gt;
            &amp;lt;analyzer type=&lt;span class=&quot;code-quote&quot;&gt;&quot;query&quot;&lt;/span&gt;&amp;gt;
                &amp;lt;tokenizer class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.StandardTokenizerFactory&quot;&lt;/span&gt;/&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.StopFilterFactory&quot;&lt;/span&gt; ignoreCase=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; words=&lt;span class=&quot;code-quote&quot;&gt;&quot;stopwords.txt&quot;&lt;/span&gt; /&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.SynonymFilterFactory&quot;&lt;/span&gt; synonyms=&lt;span class=&quot;code-quote&quot;&gt;&quot;synonyms.txt&quot;&lt;/span&gt; ignoreCase=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; expand=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.LowerCaseFilterFactory&quot;&lt;/span&gt;/&amp;gt;
            &amp;lt;/analyzer&amp;gt;
        &amp;lt;/fieldType&amp;gt;
        &amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;text_general&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.TextField&quot;&lt;/span&gt; positionIncrementGap=&lt;span class=&quot;code-quote&quot;&gt;&quot;100&quot;&lt;/span&gt;&amp;gt;
            &amp;lt;analyzer type=&lt;span class=&quot;code-quote&quot;&gt;&quot;index&quot;&lt;/span&gt;&amp;gt;
                &amp;lt;tokenizer class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.StandardTokenizerFactory&quot;&lt;/span&gt;/&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.StopFilterFactory&quot;&lt;/span&gt; ignoreCase=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; words=&lt;span class=&quot;code-quote&quot;&gt;&quot;stopwords.txt&quot;&lt;/span&gt; /&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.LowerCaseFilterFactory&quot;&lt;/span&gt;/&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.EdgeNGramFilterFactory&quot;&lt;/span&gt; minGramSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt; maxGramSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;15&quot;&lt;/span&gt;/&amp;gt;
            &amp;lt;/analyzer&amp;gt;
            &amp;lt;analyzer type=&lt;span class=&quot;code-quote&quot;&gt;&quot;query&quot;&lt;/span&gt;&amp;gt;
                &amp;lt;tokenizer class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.StandardTokenizerFactory&quot;&lt;/span&gt;/&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.StopFilterFactory&quot;&lt;/span&gt; ignoreCase=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; words=&lt;span class=&quot;code-quote&quot;&gt;&quot;stopwords.txt&quot;&lt;/span&gt; /&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.SynonymFilterFactory&quot;&lt;/span&gt; synonyms=&lt;span class=&quot;code-quote&quot;&gt;&quot;synonyms.txt&quot;&lt;/span&gt; ignoreCase=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; expand=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;/&amp;gt;
                &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.LowerCaseFilterFactory&quot;&lt;/span&gt;/&amp;gt;
            &amp;lt;/analyzer&amp;gt;
        &amp;lt;/fieldType&amp;gt;

        &amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;location_rpt&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.SpatialRecursivePrefixTreeFieldType&quot;&lt;/span&gt; geo=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; distErrPct=&lt;span class=&quot;code-quote&quot;&gt;&quot;0.025&quot;&lt;/span&gt; maxDistErr=&lt;span class=&quot;code-quote&quot;&gt;&quot;0.000009&quot;&lt;/span&gt; units=&lt;span class=&quot;code-quote&quot;&gt;&quot;degrees&quot;&lt;/span&gt; /&amp;gt;
    &amp;lt;/types&amp;gt;

    &amp;lt;uniqueKey&amp;gt;id&amp;lt;/uniqueKey&amp;gt;

    &amp;lt;defaultSearchField&amp;gt;name&amp;lt;/defaultSearchField&amp;gt;

    &amp;lt;solrQueryParser defaultOperator=&lt;span class=&quot;code-quote&quot;&gt;&quot;OR&quot;&lt;/span&gt;/&amp;gt;
&amp;lt;/schema&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;query :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;http:&lt;span class=&quot;code-comment&quot;&gt;//solr.dev:8983/solr/my_collection/select?wt=json&amp;amp;fl=id&amp;amp;fq=index_type:foobar&amp;amp;group=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;group.field=year_make_model&amp;amp;group.facet=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;facet=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;facet.field=year&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;



&lt;p&gt;Exception :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;ull:org.apache.solr.common.SolrException: Exception during facet.field: year
    at org.apache.solr.request.SimpleFacets$3.call(SimpleFacets.java:627)
    at org.apache.solr.request.SimpleFacets$3.call(SimpleFacets.java:612)
    at java.util.concurrent.FutureTask.run(FutureTask.java:262)
    at org.apache.solr.request.SimpleFacets$2.execute(SimpleFacets.java:566)
    at org.apache.solr.request.SimpleFacets.getFacetFieldCounts(SimpleFacets.java:637)
    at org.apache.solr.request.SimpleFacets.getFacetCounts(SimpleFacets.java:280)
    at org.apache.solr.handler.component.FacetComponent.process(FacetComponent.java:106)
    at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:222)
    at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:143)
    at org.apache.solr.core.SolrCore.execute(SolrCore.java:1984)
    at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:829)
    at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:446)
    at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:220)
    at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)
    at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)
    at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557)
    at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)
    at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075)
    at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384)
    at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)
    at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009)
    at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)
    at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)
    at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)
    at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)
    at org.eclipse.jetty.server.Server.handle(Server.java:368)
    at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)
    at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)
    at org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:953)
    at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:1014)
    at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:861)
    at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:240)
    at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72)
    at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264)
    at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)
    at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)
    at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
Caused by: java.lang.IllegalStateException: unexpected docvalues type NUMERIC &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; field &lt;span class=&quot;code-quote&quot;&gt;&apos;year&apos;&lt;/span&gt; (expected=SORTED). Use UninvertingReader or index with docvalues.
    at org.apache.lucene.index.DocValues.checkField(DocValues.java:208)
    at org.apache.lucene.index.DocValues.getSorted(DocValues.java:264)
    at org.apache.lucene.search.grouping.term.TermGroupFacetCollector$SV.doSetNextReader(TermGroupFacetCollector.java:135)
    at org.apache.lucene.search.SimpleCollector.getLeafCollector(SimpleCollector.java:33)
    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:705)
    at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:428)
    at org.apache.solr.request.SimpleFacets.getGroupedCounts(SimpleFacets.java:532)
    at org.apache.solr.request.SimpleFacets.getTermCounts(SimpleFacets.java:458)
    at org.apache.solr.request.SimpleFacets.getTermCounts(SimpleFacets.java:381)
    at org.apache.solr.request.SimpleFacets$3.call(SimpleFacets.java:621)
    ... 37 more

org.apache.solr.client.solrj.impl.HttpSolrClient$RemoteSolrException: Error from server at http:&lt;span class=&quot;code-comment&quot;&gt;//10.0.2.15:8983/solr/my_collection_shard2_replica1: Exception during facet.field: year
&lt;/span&gt;    at org.apache.solr.client.solrj.impl.HttpSolrClient.executeMethod(HttpSolrClient.java:556)
    at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:233)
    at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:225)
    at org.apache.solr.client.solrj.SolrClient.request(SolrClient.java:1220)
    at org.apache.solr.handler.component.HttpShardHandler$1.call(HttpShardHandler.java:221)
    at org.apache.solr.handler.component.HttpShardHandler$1.call(HttpShardHandler.java:184)
    at java.util.concurrent.FutureTask.run(FutureTask.java:262)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:471)
    at java.util.concurrent.FutureTask.run(FutureTask.java:262)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1145)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:615)
    at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12826573">SOLR-7495</key>
            <summary>Unexpected docvalues type NUMERIC when grouping by a int facet</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dpgove">Dennis Gove</assignee>
                                    <reporter username="FabioBatSilva">Fabio Silva</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 May 2015 15:55:43 +0000</created>
                <updated>Tue, 14 May 2019 13:43:54 +0000</updated>
                            <resolved>Thu, 5 Jan 2017 03:27:18 +0000</resolved>
                                    <version>5.0</version>
                    <version>5.1</version>
                    <version>5.2</version>
                    <version>5.3</version>
                                    <fixVersion>6.4</fixVersion>
                                        <due></due>
                            <votes>30</votes>
                                    <watches>45</watches>
                                                                                                                <comments>
                            <comment id="14538019" author="dizzu333" created="Mon, 11 May 2015 15:12:46 +0000"  >&lt;p&gt;I&apos;m having the same problem, Solr 5.1, without using SolrCloud.&lt;br/&gt;
The problem seemed to have been fixed if I made the field I was trying to facet on multivalued. But then the logs were all full of &quot;Error creating FieldCache for field: brand_id&quot;&lt;br/&gt;
We wanted to upgrade to Solr 5.1, but we cannot get past this bug.&lt;/p&gt;</comment>
                            <comment id="14566096" author="simplebread" created="Sat, 30 May 2015 16:53:47 +0000"  >&lt;p&gt;Currently, I think Facet.field only works fine when the it is multi-valued or single-valued StrField when grouping. There isn&apos;t a GroupedFacetCollector that works on numerics.&lt;/p&gt;

&lt;p&gt;The reason is in TermGroupFacetCollector class, we init facetFieldTermsIndex as SortedDocValues (if single-valued). In this case, if facet.field is numeric, it will throw this exception. &lt;/p&gt;</comment>
                            <comment id="14652674" author="ncoult" created="Mon, 3 Aug 2015 22:26:45 +0000"  >&lt;p&gt;We are having the same problem in Solr 5.2.&lt;/p&gt;</comment>
                            <comment id="14661934" author="dizzu333" created="Fri, 7 Aug 2015 14:41:52 +0000"  >&lt;p&gt;Any news when this would be solved? For now, Solr 5 seems much much more buggy then 4.x...&lt;/p&gt;</comment>
                            <comment id="14661953" author="fabiobatsilva" created="Fri, 7 Aug 2015 14:55:49 +0000"  >&lt;p&gt;I ended working around this bug, i created a string field &lt;b&gt;year_s&lt;/b&gt; only to be able to use it as group facet.&lt;/p&gt;</comment>
                            <comment id="14718476" author="varunthacker" created="Fri, 28 Aug 2015 12:36:32 +0000"  >&lt;p&gt;Test case which reproduces this problem.&lt;/p&gt;

&lt;p&gt;Currently &lt;tt&gt;group.facet&lt;/tt&gt; is broken on all numeric non multi-valued fields.&lt;/p&gt;</comment>
                            <comment id="14736462" author="vdilipm@gmail.com" created="Wed, 9 Sep 2015 08:42:06 +0000"  >&lt;p&gt;I also have the same problem in solr 5.3. &lt;/p&gt;</comment>
                            <comment id="14906294" author="yseeley@gmail.com" created="Thu, 24 Sep 2015 12:42:52 +0000"  >&lt;p&gt;These bugs started with &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-5666&quot; title=&quot;Add UninvertingReader&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-5666&quot;&gt;&lt;del&gt;LUCENE-5666&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14910143" author="oschrenk" created="Mon, 28 Sep 2015 08:05:51 +0000"  >&lt;p&gt;Is there another way of faceting numeric data now?&lt;/p&gt;</comment>
                            <comment id="14935458" author="smgadaleta" created="Tue, 29 Sep 2015 17:10:38 +0000"  >&lt;p&gt;We have the same problem and it is preventing us from upgrading solr.&lt;/p&gt;</comment>
                            <comment id="14941011" author="spyk" created="Fri, 2 Oct 2015 10:46:34 +0000"  >&lt;p&gt;Same error with 5.3.1. Changing the grouping field to string type as mentioned above temporarily resolved the issue for me.&lt;/p&gt;</comment>
                            <comment id="14987661" author="antonkhoff" created="Tue, 3 Nov 2015 17:20:26 +0000"  >&lt;p&gt;I confirm we have the same issue starting from 5.1 and it still exists in 5.3.1. Sounds like a major one to me, hope it can be fixed soon&lt;/p&gt;</comment>
                            <comment id="14988029" author="kunningham" created="Tue, 3 Nov 2015 20:15:11 +0000"  >&lt;p&gt;Changing the type to multi int allowed us to temporarily work around the issue.&lt;/p&gt;</comment>
                            <comment id="15042147" author="peterciuffetti" created="Fri, 4 Dec 2015 20:08:56 +0000"  >&lt;p&gt;The multi value work around is not available to me because I also need the fields affected by this bug to be sortable.  And the string work around would only give me sortable values if the int&apos;s were fixed width (some of my int fields are, some are not).&lt;/p&gt;</comment>
                            <comment id="15042220" author="dsmiley" created="Fri, 4 Dec 2015 20:54:49 +0000"  >&lt;p&gt;Ok; you could use two fields then, one for sorting purposes, one for grouping purposes.  This is a typical pattern &amp;#8211; indexing a field different ways for different purposes.&lt;/p&gt;</comment>
                            <comment id="15043348" author="gus_heck" created="Sat, 5 Dec 2015 15:28:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=PeterCiuffetti&quot; class=&quot;user-hover&quot; rel=&quot;PeterCiuffetti&quot;&gt;PeterCiuffetti&lt;/a&gt; I recently contributed &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8113&quot; title=&quot;Accept replacement strings in CloneFieldUpdateProcessorFactory&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8113&quot;&gt;&lt;del&gt;SOLR-8113&lt;/del&gt;&lt;/a&gt; which was specifically motivated by the need to sort when fields were multivalued. (by creating a copy that was single valued containing the first value).&lt;/p&gt;</comment>
                            <comment id="15063790" author="sebastien.cail" created="Fri, 18 Dec 2015 10:19:39 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I m having the same problem in SOLR 5.3.0&lt;/p&gt;</comment>
                            <comment id="15229414" author="kramachandran@commvault.com" created="Thu, 7 Apr 2016 00:20:53 +0000"  >&lt;p&gt;Having the same issue in 5.5, will this be fixed any time soon?&lt;/p&gt;</comment>
                            <comment id="15229670" author="elyograg" created="Thu, 7 Apr 2016 04:30:42 +0000"  >&lt;p&gt;A question for everyone having this problem ... is your numeric field defined with docValues=&quot;true&quot;?  Does your index contain multiple shards?  The error message in the original report shows that Fabio&apos;s index &lt;b&gt;is&lt;/b&gt; sharded, and the schema shows that the field in question did &lt;b&gt;not&lt;/b&gt; have docValues.&lt;/p&gt;

&lt;p&gt;I suspect that if you add docValues, which &lt;b&gt;will require a reindex&lt;/b&gt;, that the problem might go away.  The problem also might only exist on a multi-shard (distributed) index.&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8088&quot; title=&quot;Distributed grouping seems to require docValues in 5.x, didn&amp;#39;t in 4.x&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8088&quot;&gt;SOLR-8088&lt;/a&gt;.  The field I was trying to group on is a text field, not numeric, but docValues might also fix this problem.  Since this issue is about a numeric field, there&apos;s no need to worry about things like lowercasing.&lt;/p&gt;

&lt;p&gt;Adding docValues makes sorting, faceting, and grouping use less memory, and also usually makes them faster.  It also makes the index larger.&lt;/p&gt;</comment>
                            <comment id="15230355" author="mjhilt" created="Thu, 7 Apr 2016 14:53:54 +0000"  >&lt;p&gt;We had this problem using Solr 5.1 on an index that was &lt;b&gt;not sharded&lt;/b&gt;. The fields in question did not have docValues set however.&lt;/p&gt;</comment>
                            <comment id="15230375" author="fabiobatsilva" created="Thu, 7 Apr 2016 15:09:20 +0000"  >&lt;p&gt;IRC I tried &lt;b&gt;docValues=&quot;true&quot;&lt;/b&gt; and got the same results&lt;/p&gt;</comment>
                            <comment id="15230515" author="elyograg" created="Thu, 7 Apr 2016 16:34:45 +0000"  >&lt;p&gt;Did you reindex? Just adding the parameter to the field definition is not enough.&lt;/p&gt;</comment>
                            <comment id="15230530" author="fabiobatsilva" created="Thu, 7 Apr 2016 16:38:31 +0000"  >&lt;p&gt;I had fresh SOLR install&lt;/p&gt;</comment>
                            <comment id="15236395" author="pcdev" created="Tue, 12 Apr 2016 01:22:27 +0000"  >&lt;p&gt;group.facet also breaks range queries.  I&apos;m finding v5 almost non-usable.&lt;/p&gt;

&lt;p&gt;I tried setting docValues to true on the fields (and re-indexing), but it hasn&apos;t worked differently.&lt;/p&gt;

&lt;p&gt;The only workaround I found was using facet queries with multi-valued fields, but that doesn&apos;t help with everything.&lt;/p&gt;

&lt;p&gt;The work around doesn&apos;t apply to range facets.&lt;/p&gt;

&lt;p&gt;For example:&lt;/p&gt;

&lt;p&gt;This works...&lt;/p&gt;

&lt;p&gt;&amp;amp;facet.range=rounded_price&amp;amp;f.rounded_price.facet.range.start=0&amp;amp;f.rounded_price.facet.range.end=100&amp;amp;f.rounded_price.facet.range.gap=10&amp;amp;facet=on&lt;/p&gt;

&lt;p&gt;But simply adding &quot;group.facet&quot; fails...&lt;/p&gt;

&lt;p&gt;&amp;amp;facet.range=rounded_price&amp;amp;f.rounded_price.facet.range.start=0&amp;amp;f.rounded_price.facet.range.end=100&amp;amp;f.rounded_price.facet.range.gap=10&amp;amp;facet=on&amp;amp;group.facet=true&amp;amp;group.field=anyNumericField&lt;/p&gt;</comment>
                            <comment id="15237746" author="sstults" created="Tue, 12 Apr 2016 18:44:15 +0000"  >&lt;p&gt;SimpleFacets uses the insanity collector wrapper to return null docValues on grouping fields that are single-valued numerics. It looks like this also needs to be done on the facet field as well (when grouping). The attached patch first checks to see if the grouping field collector needs to be wrapped (that&apos;s what we&apos;ve been doing) and then a second wrapper is applied if the facet field needs to be wrapped as well. &lt;/p&gt;

&lt;p&gt;The new patch includes the previously attached unit test (now working).&lt;/p&gt;</comment>
                            <comment id="15277256" author="ncoult" created="Mon, 9 May 2016 23:01:25 +0000"  >&lt;p&gt;Is this still a bug in Solr 6?&lt;/p&gt;</comment>
                            <comment id="15366626" author="antonkhoff" created="Thu, 7 Jul 2016 19:21:22 +0000"  >&lt;p&gt;And what about 6.1?&lt;/p&gt;</comment>
                            <comment id="15379318" author="sstults" created="Fri, 15 Jul 2016 12:30:42 +0000"  >&lt;p&gt;The patched test &lt;tt&gt;testSimpleGroupedFacet&lt;/tt&gt; verifies that this is still an issue with 6.1. It fails with:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Caused by: java.lang.IllegalStateException: unexpected docvalues type NUMERIC for field &apos;duration_i1&apos; (expected=SORTED). Use UninvertingReader or index with docvalues.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;However, when SimpleFacets.java is also patched the test passes. So this appears to still be necessary in 6.1.&lt;/p&gt;</comment>
                            <comment id="15385097" author="ncoult" created="Wed, 20 Jul 2016 00:14:23 +0000"  >&lt;p&gt;Can you supply your patch for 6.1?&lt;br/&gt;
Thanks&lt;/p&gt;</comment>
                            <comment id="15385813" author="sstults" created="Wed, 20 Jul 2016 13:01:44 +0000"  >&lt;p&gt;The patch uploaded in April works for me on the 6.1 branch. Is it not working for you?&lt;/p&gt;</comment>
                            <comment id="15386783" author="ncoult" created="Wed, 20 Jul 2016 23:13:07 +0000"  >&lt;p&gt;The patch did not cleanly apply but it does compile and run correctly, thanks!&lt;/p&gt;</comment>
                            <comment id="15514067" author="sstults" created="Thu, 22 Sep 2016 18:19:54 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rcmuir&quot; class=&quot;user-hover&quot; rel=&quot;rcmuir&quot;&gt;rcmuir&lt;/a&gt; could you weigh in on the approach of the patch? I&apos;d be happy to tweak it or take a completely different angle if that&apos;ll help close this issue.&lt;/p&gt;</comment>
                            <comment id="15664554" author="mjhilt" created="Mon, 14 Nov 2016 18:00:35 +0000"  >&lt;p&gt;I have been testing this patch out on Solr 6.x. It does correct the problem (at least on 6.0.1), but only when the field does NOT have docValues enabled. Is this expected? Can the existing patch be extended to support docValues too, or is that a completely separate implementation?&lt;/p&gt;</comment>
                            <comment id="15799964" author="dpgove" created="Thu, 5 Jan 2017 01:41:03 +0000"  >&lt;p&gt;This patch applies cleanly to branch_6x.&lt;/p&gt;

&lt;p&gt;I did see the test fail before applying the change to SimpleFacets and then saw it pass after applying the change to SimpleFacets. Going to run through all the tests before committing this change.&lt;/p&gt;</comment>
                            <comment id="15800146" author="jira-bot" created="Thu, 5 Jan 2017 03:19:37 +0000"  >&lt;p&gt;Commit 6e10e36216db9861530b4407866e292a89927a9e in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dpgove&quot; class=&quot;user-hover&quot; rel=&quot;dpgove&quot;&gt;dpgove&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6e10e36&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6e10e36&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7495&quot; title=&quot;Unexpected docvalues type NUMERIC when grouping by a int facet&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7495&quot;&gt;&lt;del&gt;SOLR-7495&lt;/del&gt;&lt;/a&gt;: Support Facet.field on a non-DocValued, single-value, int field&lt;/p&gt;</comment>
                            <comment id="15800158" author="jira-bot" created="Thu, 5 Jan 2017 03:25:45 +0000"  >&lt;p&gt;Commit f9e3554838f3a43742928d11a7dcd9a8409e0c97 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dpgove&quot; class=&quot;user-hover&quot; rel=&quot;dpgove&quot;&gt;dpgove&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=f9e3554&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=f9e3554&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7495&quot; title=&quot;Unexpected docvalues type NUMERIC when grouping by a int facet&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7495&quot;&gt;&lt;del&gt;SOLR-7495&lt;/del&gt;&lt;/a&gt;: Support Facet.field on a non-DocValued, single-value, int field&lt;/p&gt;</comment>
                            <comment id="15801757" author="eqw3rty" created="Thu, 5 Jan 2017 16:14:11 +0000"  >&lt;p&gt;AFAIS you can wrap any field into InsanityWrapper. What is the idea behind such strict check?&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;if (sf != null &amp;amp;&amp;amp; !sf.hasDocValues() &amp;amp;&amp;amp; !sf.multiValued() &amp;amp;&amp;amp; sf.getType().getNumericType() != null) {&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;What about other field types (e.g., Numeric DocValued or Dates)?&lt;/p&gt;</comment>
                            <comment id="15812880" author="sstults" created="Mon, 9 Jan 2017 21:21:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rcmuir&quot; class=&quot;user-hover&quot; rel=&quot;rcmuir&quot;&gt;rcmuir&lt;/a&gt; added that line at the same time as the Insanity wrapper itself as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-5666&quot; title=&quot;Add UninvertingReader&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-5666&quot;&gt;&lt;del&gt;LUCENE-5666&lt;/del&gt;&lt;/a&gt;, but I&apos;ll take a crack at an explanation. There&apos;s only a couple of cases outlined Insanity where we need to wrap the field, essentially returning null instead of the docValues. When the collector returns null the stored values of the field are used instead of docValues. Since stored values are slower than docValues we only want to wrap the particular field type that&apos;s problematic. &lt;/p&gt;</comment>
                            <comment id="15813055" author="dsmiley" created="Mon, 9 Jan 2017 22:34:31 +0000"  >&lt;p&gt;FieldCache &quot;insanity&quot; is when the same field is uninverted into memory multiple ways for different types (i.e. as a number and also as a string).  The FieldCache is today also known as UninvertingReader.  Obviously something to be avoided and signified possible Solr usage error.  I recall it was easier to trigger this than nowadays.&lt;/p&gt;</comment>
                            <comment id="16807499" author="jiajun" created="Tue, 2 Apr 2019 08:11:19 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dpgove&quot; class=&quot;user-hover&quot; rel=&quot;dpgove&quot;&gt;dpgove&lt;/a&gt;,&lt;/p&gt;

&lt;p&gt;Probably this ticket should be reopen due to the group facet does not work for PointField!&lt;/p&gt;

&lt;p&gt;I got an &quot;Unexpected docvalues type SORTED_NUMERIC&quot; exception when I perform group facet on an IntPointField. Debugging into the source code, the cause is that internally the docvalue type for PointField is &quot;NUMERIC&quot; (single value) or &quot;SORTED_NUMERIC&quot; (multi value), while the TermGroupFacetCollector class requires the facet field must have a &quot;SORTED&quot; or &quot;SOTRTED_SET&quot; docvalue type: &lt;a href=&quot;https://github.com/apache/lucene-solr/blob/2480b74887eff01f729d62a57b415d772f947c91/lucene/grouping/src/java/org/apache/lucene/search/grouping/TermGroupFacetCollector.java#L313&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/2480b74887eff01f729d62a57b415d772f947c91/lucene/grouping/src/java/org/apache/lucene/search/grouping/TermGroupFacetCollector.java#L313&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;When I change schema for all int field to TrieIntField, the group facet then work. Since internally the docvalue type for TrieField is SORTED (single value) or SORTED_SET (multi value).&lt;/p&gt;

&lt;p&gt;Regarding that the &quot;TrieField&quot; is depreciated in Solr7, can someone help on this grouping facet issue for PointField.&lt;/p&gt;

&lt;p&gt;Thanks.&lt;/p&gt;</comment>
                            <comment id="16807510" author="jiajun" created="Tue, 2 Apr 2019 08:23:47 +0000"  >&lt;p&gt;In addtional, all place of &quot;${solr.tests.IntegerFieldType}&quot; in the unit test files seems to be using the &quot;TrieintField&quot;, if change to &quot;IntPointField&quot;, some unit tests will fail, for example:&#160;&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/3de0b3671998cc9bc723d10f1b31ce48cbd4fa64/solr/core/src/test/org/apache/solr/request/SimpleFacetsTest.java#L417&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/3de0b3671998cc9bc723d10f1b31ce48cbd4fa64/solr/core/src/test/org/apache/solr/request/SimpleFacetsTest.java#L417&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16812951" author="jiajun" created="Tue, 9 Apr 2019 02:45:31 +0000"  >&lt;p&gt;I created a new ticket&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13381&quot; title=&quot;Unexpected docvalues type SORTED_NUMERIC Exception when grouping by a PointField facet&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13381&quot;&gt;SOLR-13381&lt;/a&gt; about the issue for PointField.&lt;/p&gt;</comment>
                            <comment id="16839133" author="boqin" created="Tue, 14 May 2019 06:08:31 +0000"  >&lt;p&gt;I got an &quot;unexpected docvalues type NUMERIC for field &apos;id&apos; (expected=SORTED)&quot; Exception when groupingSearch by a NumericDocValuesField.&lt;br/&gt;
Is this a known problem?&lt;/p&gt;


&lt;p&gt;The version of Lucene I am using is 8.0.0&lt;/p&gt;</comment>
                            <comment id="16839430" author="erickerickson" created="Tue, 14 May 2019 13:43:54 +0000"  >&lt;p&gt;Please do not comment on tickets, use the Solr user&apos;s list first, and especially don&apos;t&#160; comment on closed tickets as it makes the Jira system (which we use for bugs/development) harder to use.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12713517">LUCENE-5666</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12845679" name="SOLR-7495.patch" size="4826" author="dpgove" created="Thu, 5 Jan 2017 01:41:03 +0000"/>
                            <attachment id="12798330" name="SOLR-7495.patch" size="7073" author="sstults" created="Tue, 12 Apr 2016 18:44:15 +0000"/>
                            <attachment id="12752987" name="SOLR-7495.patch" size="1598" author="varun" created="Fri, 28 Aug 2015 12:36:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 27 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2e6pj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>