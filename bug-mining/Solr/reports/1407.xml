<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:36:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4829] transaction log reference leak</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4829</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Failure to dereference tlogs or RecentUpdates can cause old transaction logs to never be closed &amp;amp; deleted.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12647948">SOLR-4829</key>
            <summary>transaction log reference leak</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="yseeley@gmail.com">Yonik Seeley</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 May 2013 12:18:41 +0000</created>
                <updated>Mon, 9 May 2016 18:58:05 +0000</updated>
                            <resolved>Thu, 16 May 2013 21:04:02 +0000</resolved>
                                    <version>4.1</version>
                                    <fixVersion>4.3.1</fixVersion>
                    <fixVersion>4.4</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13659472" author="yseeley@gmail.com" created="Thu, 16 May 2013 12:20:44 +0000"  >&lt;p&gt;After a code review, one source leak is in ElectionContext.java:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!success &amp;amp;&amp;amp; ulog.getRecentUpdates().getVersions(1).isEmpty()) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3933&quot; title=&quot;Distributed commits are not guaranteed to be ordered within a request.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3933&quot;&gt;&lt;del&gt;SOLR-3933&lt;/del&gt;&lt;/a&gt; (Solr 4.1)&lt;/p&gt;</comment>
                            <comment id="13659509" author="markrmiller@gmail.com" created="Thu, 16 May 2013 13:22:23 +0000"  >&lt;p&gt;It&apos;s actually &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3939&quot; title=&quot;An empty or just replicated index cannot become the leader of a shard after a leader goes down.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3939&quot;&gt;&lt;del&gt;SOLR-3939&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13659512" author="markrmiller@gmail.com" created="Thu, 16 May 2013 13:24:47 +0000"  >&lt;p&gt;This one actually occured to me when i was reading the user thread on this the other day - it didn&apos;t seem like the culprit for that guy though because it only happens on election (unless he was losing the leader consistently for some ugly reason).&lt;/p&gt;</comment>
                            <comment id="13659518" author="yseeley@gmail.com" created="Thu, 16 May 2013 13:30:47 +0000"  >&lt;p&gt;Here&apos;s a patch that should hopefully fix things up wrt getRecentUpdates.&lt;/p&gt;</comment>
                            <comment id="13659520" author="markrmiller@gmail.com" created="Thu, 16 May 2013 13:35:29 +0000"  >&lt;p&gt;This looks like it reintroduces the NPE you can get with no ulog in ElectionContext - when I put in the null check yesterday or the day before, I was torn between just letting the node become leader if it has no ulog and was active and throwing a specific exception about having no ulog - i ended up choosing the former thinking if we didn&apos;t want to support no ulog in solrcloud mode, that should be checked on startup.&lt;/p&gt;</comment>
                            <comment id="13659533" author="yseeley@gmail.com" created="Thu, 16 May 2013 13:52:50 +0000"  >&lt;blockquote&gt;&lt;p&gt;This looks like it reintroduces the NPE you can get with no ulog in ElectionContext&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ah, thanks - I got a merge conflict and then missed your update.  I&apos;ll fix.&lt;/p&gt;</comment>
                            <comment id="13659677" author="yseeley@gmail.com" created="Thu, 16 May 2013 16:24:41 +0000"  >&lt;p&gt;Here&apos;s another version that cleans up tlog references during tlog recovery in the event an unexpected exception (like a commit throwing something other than IOException).&lt;/p&gt;

&lt;p&gt;Aside: we should keep in mind that when index corruption happens, lucene can throw exceptions other than IOException.&lt;/p&gt;</comment>
                            <comment id="13659947" author="sbower" created="Thu, 16 May 2013 20:36:28 +0000"  >&lt;p&gt;I patched my 4.3.0 install with the attached patch on a solr instance with my broken index that was causing this issue to begin with and i see that the tlog files are limited to 10 files properly and I am not building up orphaned FileDescriptors any more. Additionally I&apos;ve verified with lsof that the tlog isn&apos;t leaking open file...&lt;/p&gt;</comment>
                            <comment id="13659996" author="yseeley@gmail.com" created="Thu, 16 May 2013 21:03:25 +0000"  >&lt;p&gt;Thanks for verifying Steven!&lt;br/&gt;
Committed to trunk, 4x, 4.3.1&lt;/p&gt;</comment>
                            <comment id="13686918" author="shalinmangar" created="Tue, 18 Jun 2013 16:52:38 +0000"  >&lt;p&gt;Bulk close after 4.3.1 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12647966">SOLR-4831</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12583496" name="SOLR-4829.patch" size="5636" author="yseeley@gmail.com" created="Thu, 16 May 2013 16:24:41 +0000"/>
                            <attachment id="12583480" name="SOLR-4829.patch" size="4055" author="yseeley@gmail.com" created="Thu, 16 May 2013 13:58:13 +0000"/>
                            <attachment id="12583478" name="SOLR-4829.patch" size="4001" author="yseeley@gmail.com" created="Thu, 16 May 2013 13:30:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>328304</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kn7j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>328648</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>