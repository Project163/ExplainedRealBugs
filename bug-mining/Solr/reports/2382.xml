<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:03:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7092] Stop the HDFS lease recovery retries on HdfsTransactionLog on close and try to avoid lease recovery on closed files.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7092</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description></description>
                <environment></environment>
        <key id="12773537">SOLR-7092</key>
            <summary>Stop the HDFS lease recovery retries on HdfsTransactionLog on close and try to avoid lease recovery on closed files.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="markrmiller@gmail.com">Mark Miller</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 Feb 2015 18:56:35 +0000</created>
                <updated>Mon, 9 May 2016 18:51:56 +0000</updated>
                            <resolved>Tue, 24 Mar 2015 12:41:35 +0000</resolved>
                                                    <fixVersion>5.1</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14337877" author="markrmiller@gmail.com" created="Thu, 26 Feb 2015 05:02:40 +0000"  >&lt;p&gt;Patch to stop retrying if the log is closed. Previously would retry for like 15 min even after close.&lt;/p&gt;</comment>
                            <comment id="14372911" author="markrmiller@gmail.com" created="Sat, 21 Mar 2015 17:30:27 +0000"  >&lt;p&gt;Patch that seems to behave better.&lt;/p&gt;</comment>
                            <comment id="14372913" author="markrmiller@gmail.com" created="Sat, 21 Mar 2015 17:36:01 +0000"  >&lt;p&gt;There still appears to be an internal HDFS lease renewer that I don&apos;t see how to stop, but with the latest patch, I&apos;ve had good results so far.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; [junit4]   2&amp;gt; 504053 T130 oahh.LeaseRenewer.run WARN Failed to renew lease for [DFSClient_NONMAPREDUCE_-1506464199_13] for 429 seconds.  Will retry shortly ... java.net.ConnectException: Call From totalmetal/127.0.1.1 to localhost:43747 failed on connection exception: java.net.ConnectException: Connection refused; For more details see:  http://wiki.apache.org/hadoop/ConnectionRefused
   [junit4]   2&amp;gt; 	at sun.reflect.GeneratedConstructorAccessor179.newInstance(Unknown Source)
   [junit4]   2&amp;gt; 	at sun.reflect.DelegatingConstructorAccessorImpl.newInstance(DelegatingConstructorAccessorImpl.java:45)
   [junit4]   2&amp;gt; 	at java.lang.reflect.Constructor.newInstance(Constructor.java:422)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.net.NetUtils.wrapWithMessage(NetUtils.java:783)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.net.NetUtils.wrapException(NetUtils.java:730)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.ipc.Client.call(Client.java:1410)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.ipc.Client.call(Client.java:1359)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.ipc.ProtobufRpcEngine$Invoker.invoke(ProtobufRpcEngine.java:206)
   [junit4]   2&amp;gt; 	at com.sun.proxy.$Proxy39.renewLease(Unknown Source)
   [junit4]   2&amp;gt; 	at sun.reflect.GeneratedMethodAccessor34.invoke(Unknown Source)
   [junit4]   2&amp;gt; 	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
   [junit4]   2&amp;gt; 	at java.lang.reflect.Method.invoke(Method.java:497)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.io.retry.RetryInvocationHandler.invokeMethod(RetryInvocationHandler.java:186)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.io.retry.RetryInvocationHandler.invoke(RetryInvocationHandler.java:102)
   [junit4]   2&amp;gt; 	at com.sun.proxy.$Proxy39.renewLease(Unknown Source)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.hdfs.protocolPB.ClientNamenodeProtocolTranslatorPB.renewLease(ClientNamenodeProtocolTranslatorPB.java:519)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.hdfs.DFSClient.renewLease(DFSClient.java:773)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.hdfs.LeaseRenewer.renew(LeaseRenewer.java:417)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.hdfs.LeaseRenewer.run(LeaseRenewer.java:442)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.hdfs.LeaseRenewer.access$700(LeaseRenewer.java:71)
   [junit4]   2&amp;gt; 	at org.apache.hadoop.hdfs.LeaseRenewer$1.run(LeaseRenewer.java:298)
   [junit4]   2&amp;gt; 	at java.lang.Thread.run(Thread.java:745)
   [junit4]   2&amp;gt; Caused by: java.net.ConnectException: Connection refused&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14372968" author="jira-bot" created="Sat, 21 Mar 2015 19:08:55 +0000"  >&lt;p&gt;Commit 1668311 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1668311&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1668311&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7092&quot; title=&quot;Stop the HDFS lease recovery retries on HdfsTransactionLog on close and try to avoid lease recovery on closed files.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7092&quot;&gt;&lt;del&gt;SOLR-7092&lt;/del&gt;&lt;/a&gt;: Stop the HDFS lease recovery retries in HdfsTransactionLog on close and try to avoid lease recovery on closed files.&lt;/p&gt;</comment>
                            <comment id="14372986" author="jira-bot" created="Sat, 21 Mar 2015 20:16:15 +0000"  >&lt;p&gt;Commit 1668313 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1668313&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1668313&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7092&quot; title=&quot;Stop the HDFS lease recovery retries on HdfsTransactionLog on close and try to avoid lease recovery on closed files.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7092&quot;&gt;&lt;del&gt;SOLR-7092&lt;/del&gt;&lt;/a&gt;: Stop the HDFS lease recovery retries in HdfsTransactionLog on close and try to avoid lease recovery on closed files.&lt;/p&gt;</comment>
                            <comment id="14372991" author="markrmiller@gmail.com" created="Sat, 21 Mar 2015 20:23:47 +0000"  >&lt;p&gt;I&apos;m still looking into this area of the code, but that should improve some of the current stdout / stderr errors that have grown more common.&lt;/p&gt;</comment>
                            <comment id="14375057" author="jira-bot" created="Sun, 22 Mar 2015 17:12:08 +0000"  >&lt;p&gt;Commit 1668412 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1668412&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1668412&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7092&quot; title=&quot;Stop the HDFS lease recovery retries on HdfsTransactionLog on close and try to avoid lease recovery on closed files.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7092&quot;&gt;&lt;del&gt;SOLR-7092&lt;/del&gt;&lt;/a&gt;: Do a little better at clean up in new test code.&lt;/p&gt;</comment>
                            <comment id="14377782" author="jira-bot" created="Tue, 24 Mar 2015 12:38:41 +0000"  >&lt;p&gt;Commit 1668862 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1668862&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1668862&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7092&quot; title=&quot;Stop the HDFS lease recovery retries on HdfsTransactionLog on close and try to avoid lease recovery on closed files.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7092&quot;&gt;&lt;del&gt;SOLR-7092&lt;/del&gt;&lt;/a&gt;: Do a little better at clean up in new test code.&lt;/p&gt;</comment>
                            <comment id="14377784" author="markrmiller@gmail.com" created="Tue, 24 Mar 2015 12:41:35 +0000"  >&lt;p&gt;This should be fixed now. I&apos;ve improved the &apos;thread leak&apos; handling situation with &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7289&quot; title=&quot;Tests should not ignore all leaking threads and instead just ignore the known leaking threads.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7289&quot;&gt;&lt;del&gt;SOLR-7289&lt;/del&gt;&lt;/a&gt; as well so that it&apos;s more difficult for this to sneak by.&lt;/p&gt;</comment>
                            <comment id="14380577" author="markrmiller@gmail.com" created="Wed, 25 Mar 2015 19:21:42 +0000"  >&lt;blockquote&gt;&lt;p&gt;and try to avoid lease recovery on closed files.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This was added to this issue to reduce how often we were starting up lease recovery stuff when we did not need to.&lt;/p&gt;

&lt;p&gt;It was also something I wanted to do because I had seen a situation where recovery of leases on closed files was taking a very long time and causing odd issues with Solr. So I rolled in this change.&lt;/p&gt;

&lt;p&gt;It seems that sometimes HDFS does not like it when you make a bunch of lease recovery calls (hopefully just because they are all on files that don&apos;t even need it). Usually, trying to recover a lease on a closed file just returns - but on larger indexes something problematic seems to happen instead. I&apos;ve got more to find out in that area, but this improves the situation.&lt;/p&gt;</comment>
                            <comment id="14495262" author="thelabdude" created="Wed, 15 Apr 2015 00:30:19 +0000"  >&lt;p&gt;Bulk close after 5.1 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12780640">SOLR-7215</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12780640">SOLR-7215</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12784686">SOLR-7289</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12766902">SOLR-6969</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12706175" name="SOLR-7092.patch" size="6262" author="markrmiller@gmail.com" created="Sat, 21 Mar 2015 17:30:27 +0000"/>
                            <attachment id="12700970" name="SOLR-7092.patch" size="4243" author="markrmiller@gmail.com" created="Thu, 26 Feb 2015 05:02:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 32 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i25dnj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>