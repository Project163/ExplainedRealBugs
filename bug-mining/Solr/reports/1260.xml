<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:34:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4471] Replication occurs even when a slave is already up to date.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4471</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Scenario: master/slave replication, master delta index runs every 10 minutes, slave poll interval is 10 sec.&lt;/p&gt;

&lt;p&gt;There was an issue &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4413&quot; title=&quot;SolrCore#getIndexDir() contract change between 3.6 and 4.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4413&quot;&gt;&lt;del&gt;SOLR-4413&lt;/del&gt;&lt;/a&gt; - slave reads index from wrong directory, so slave is full copy index from master every time, which is fixed after applying this patch from 4413 (see script below).&lt;/p&gt;

&lt;p&gt;Now on replication the slave downloads only updated files, but slave is create a new segement file and also a new version of index (generation is identical with master). On next polling the slave is download the full index again, because the new version slave is force a full copy.&lt;/p&gt;

&lt;p&gt;Problem is the new version of index on the slave after first replication.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mkdir work
cd work
svn co http://svn.apache.org/repos/asf/lucene/dev/branches/lucene_solr_4_1/
cd lucene_solr_4_1
patch -p0 &amp;lt; ../../patches/SOLR-4413.patch
cd solr
ant dist
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

</description>
                <environment></environment>
        <key id="12632803">SOLR-4471</key>
            <summary>Replication occurs even when a slave is already up to date.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="acharton">Andre Charton</reporter>
                        <labels>
                            <label>master</label>
                            <label>replication</label>
                            <label>slave</label>
                            <label>version</label>
                    </labels>
                <created>Mon, 18 Feb 2013 09:14:11 +0000</created>
                <updated>Mon, 9 May 2016 18:45:16 +0000</updated>
                            <resolved>Sat, 23 Feb 2013 03:28:14 +0000</resolved>
                                    <version>4.1</version>
                                    <fixVersion>4.2</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>replication (java)</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="13583053" author="anithian" created="Thu, 21 Feb 2013 09:42:33 +0000"  >&lt;p&gt;I have a proposed solution with a bit of extra commentary on it in the code so it&apos;s clear what I am doing. &lt;/p&gt;</comment>
                            <comment id="13583217" author="markrmiller@gmail.com" created="Thu, 21 Feb 2013 14:18:12 +0000"  >&lt;p&gt;Looks like we need a test for this.&lt;/p&gt;</comment>
                            <comment id="13583465" author="anithian" created="Thu, 21 Feb 2013 19:28:55 +0000"  >&lt;p&gt;I&apos;ll work on the test if no one else is. I think I see that my slave_gen &amp;gt; master_gen+1 is not needed but simply slave_gen &amp;gt; mater. I&apos;ll see if I can put some tests around it and re-submit a patch soon.&lt;/p&gt;</comment>
                            <comment id="13583468" author="markrmiller@gmail.com" created="Thu, 21 Feb 2013 19:32:27 +0000"  >&lt;p&gt;I&apos;m working on some improved tests in this area, but I&apos;d appreciate any help or additional test work. We can&apos;t have too many for this stuff. &lt;/p&gt;</comment>
                            <comment id="13583528" author="acharton" created="Thu, 21 Feb 2013 20:35:17 +0000"  >&lt;p&gt;Today after debugging in a bigger environment I found slave marked the index as stale (method isStale() in SnapPuller). This is because segment the file, which comes from master and is different in size than the file on slave. This only happens if there are enough data and also &apos;delta-date&apos;. With few data file looks same (exists + same size). &lt;br/&gt;
So again: problem is that slave generates this segment file after replication (and also a new version). In the end the version number is may a &quot;subproblem&quot; of this new segment file. I&apos;m note sure how lucene work, but that looks for me as the general problem. &lt;br/&gt;
I also checked solr 3.6.1, the version is same. Also 3.6 didn&apos;t create index dir with time stamp (eg. index.12345) and segment files are same slave &amp;lt;-&amp;gt; master.&lt;/p&gt;</comment>
                            <comment id="13583567" author="heldersepu" created="Thu, 21 Feb 2013 21:32:12 +0000"  >&lt;p&gt;I also tested this:&lt;/p&gt;

&lt;p&gt;Upgraded servers to the latest n-Build&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Do a commit on the Master&lt;/li&gt;
	&lt;li&gt;The Slave seems replicate only what it needs (correct way)&lt;/li&gt;
	&lt;li&gt;Next replication cycle comes and slave will download entire index&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;First I noticed this behavior when clicking two times on the &lt;b&gt;replicate now&lt;/b&gt; button &lt;br/&gt;
but I changed my pollInterval to 30 seconds and the problem is more evident.&lt;/p&gt;</comment>
                            <comment id="13583594" author="acharton" created="Thu, 21 Feb 2013 22:08:46 +0000"  >&lt;p&gt;One shot: I tried to set commit after replication as soft commit and it works for me:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;SnapPuller line 622 ff&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;      &lt;span class=&quot;code-comment&quot;&gt;// update our commit point to the right dir
&lt;/span&gt;      CommitUpdateCommand cuc = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CommitUpdateCommand(req, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
      ...
      cuc.softCommit = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;; &lt;span class=&quot;code-comment&quot;&gt;// use soft commit here, so on commit no &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; segment info are generated - on slave.
&lt;/span&gt;      ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Now slave didn&apos;t generate new segment file, also index version looks fine.&lt;/p&gt;

&lt;p&gt;Somebody agree?&lt;/p&gt;</comment>
                            <comment id="13583599" author="anithian" created="Thu, 21 Feb 2013 22:14:12 +0000"  >&lt;p&gt;When your replication is downloading the full index what is the value of the isFullCopyNeeded variable? Are you getting a full copy b/c the variable value is true or b/c the index is &quot;stale&quot;?&lt;/p&gt;</comment>
                            <comment id="13583603" author="markrmiller@gmail.com" created="Thu, 21 Feb 2013 22:16:25 +0000"  >&lt;blockquote&gt;&lt;p&gt;Somebody agree? &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s kind of a workaround, but there is more to this. I&apos;ve already advanced a bit beyond this though - I&apos;m not using a soft commit, I&apos;m just not doing that commit unless isFullCopyNeeded. I&apos;m running into an issue with the version though. Somehow, after the replication happens, the commit timestamp we store is not getting set to the value of the index we replicated in - it&apos;s like it&apos;s stale.&lt;/p&gt;</comment>
                            <comment id="13583621" author="acharton" created="Thu, 21 Feb 2013 22:37:39 +0000"  >&lt;p&gt;@Amit: First thought was version, but it was because setup was to small. Now I see it&apos;s stale b/c file exits and size is diff (-&amp;gt; segment file).&lt;br/&gt;
@Mark: why this comment &quot;// update our commit point to the right dir&quot; - how we mark replicated index as ready for search?&lt;/p&gt;
</comment>
                            <comment id="13583629" author="markrmiller@gmail.com" created="Thu, 21 Feb 2013 22:45:36 +0000"  >&lt;blockquote&gt;&lt;p&gt;why this comment &quot;// update our commit point to the right dir&quot; &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s needed when you switch Directory&apos;s.&lt;/p&gt;</comment>
                            <comment id="13583631" author="markrmiller@gmail.com" created="Thu, 21 Feb 2013 22:46:09 +0000"  >&lt;p&gt;Or it was at one point - once we have some more thorough testing and some more fixes, we will have to see how that turns out.&lt;/p&gt;</comment>
                            <comment id="13583685" author="markrmiller@gmail.com" created="Thu, 21 Feb 2013 23:49:17 +0000"  >&lt;p&gt;In the test i was building on, pre commit was screwing with things. I&apos;ve taken that out for now and am making some progress.&lt;/p&gt;</comment>
                            <comment id="13583707" author="anithian" created="Fri, 22 Feb 2013 00:04:29 +0000"  >&lt;p&gt;One question in the unit tests, I noticed that it&apos;s one method test() which I am trying to break out into multiple unit test methods but was wondering if there is an order to the private test method invocations that caused this one single test() method.&lt;/p&gt;</comment>
                            <comment id="13583710" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 00:08:56 +0000"  >&lt;p&gt;Your guess is as good as mine - someone else originally wrote these. I think it tries to make order not matter, I don&apos;t know how successful it is. I generally just comment out the methods I&apos;m not currently working with.&lt;/p&gt;</comment>
                            <comment id="13583717" author="anithian" created="Fri, 22 Feb 2013 00:11:46 +0000"  >&lt;p&gt;&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; So I tried to create a @BeforeClass and @AfterClass annotation to keep the server static.. now I just moved them to setup and teardown so each test creates and destroys jetty instances. I hate single methods that test 10 things so I hope that others agree.&lt;/p&gt;</comment>
                            <comment id="13583742" author="acharton" created="Fri, 22 Feb 2013 00:34:19 +0000"  >&lt;p&gt;Sorry for the spam - but which test method - can&apos;t find any related to the SnapPuller on trunk. But may is better to have no test method than the one with 10 aspects.&lt;/p&gt;</comment>
                            <comment id="13583748" author="anithian" created="Fri, 22 Feb 2013 00:39:43 +0000"  >&lt;p&gt;It&apos;s in the TestReplicationHandler.java file.&lt;/p&gt;</comment>
                            <comment id="13583787" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 01:27:32 +0000"  >&lt;p&gt;Here is where I am at. A couple fixes, a test that catches at least some of this.&lt;/p&gt;</comment>
                            <comment id="13583796" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 01:34:51 +0000"  >&lt;p&gt;Amit: I think that&apos;s a fine change - I&apos;d only check if it affects the overall test time much.&lt;/p&gt;</comment>
                            <comment id="13583801" author="anithian" created="Fri, 22 Feb 2013 01:38:40 +0000"  >&lt;p&gt;Mark, do you have any details you can provide about the underlying issue that you are trying to resolve in case there is something we can do to help?&lt;/p&gt;</comment>
                            <comment id="13583803" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 01:41:18 +0000"  >&lt;p&gt;I think that patch may solve things for you. It at least fixes some things. Next I want to write more tests or try and think of what is not currently being tested. If you can break that patch, that would help as I can then add that test and fix it.&lt;/p&gt;</comment>
                            <comment id="13583807" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 01:46:38 +0000"  >&lt;p&gt;One thing that does seem to mess things up is precommit. I&apos;m not sure that&apos;s the most useful feature at the moment anyway, but avoid it in your testing &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13583859" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 03:09:28 +0000"  >&lt;p&gt;Another test and fix for when a new index directory is forced. Turns out we are doing things different somehow currently and don&apos;t need that commit at all any more to update our commit points. Some other improvement or bug fix.&lt;/p&gt;</comment>
                            <comment id="13584039" author="anithian" created="Fri, 22 Feb 2013 07:10:53 +0000"  >&lt;p&gt;This doesn&apos;t add anything new other than break out the test() method into separate actual junit tests. Also it&apos;s better to ensure each test has a clean set of jetty servers initialized so as to ensure state from previous tests don&apos;t leak into future ones.&lt;/p&gt;</comment>
                            <comment id="13584064" author="anithian" created="Fri, 22 Feb 2013 07:41:36 +0000"  >&lt;p&gt;Sorry I&apos;m trying to read the patch and perhaps I&apos;m missing something but where is the commit that I thought was needed to signal new data? If that&apos;s not needed can you explain why just for my understanding?&lt;/p&gt;

&lt;p&gt;Also why is there such a distinction between getIndexDir and getNewIndexDir and why can&apos;t all calls route through one? It&apos;s a bit confusing to me at the moment.&lt;/p&gt;</comment>
                            <comment id="13584289" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 14:05:33 +0000"  >&lt;p&gt;No, the commit was not to single new data - see the comment - it was mainly about fixing an issue when restarting the writer.&lt;/p&gt;

&lt;p&gt;At one point, it may have also been what triggered a new searcher, but we have done that explicitly instead for a while now.&lt;/p&gt;

&lt;p&gt;getIndexDir and getNewIndexDir are kind of complicated. getNewIndexDir should always be safe to use, but it does this extra step of reading a properties file sometimes. Technically, it&apos;s mainly supposed to be critical to use getNewIndexDir when making new writers and searchers - i sometimes use it elsewhere in replication to be sure any kind of race is not an issue.&lt;/p&gt;</comment>
                            <comment id="13584325" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 15:01:01 +0000"  >&lt;p&gt;I think I&apos;m about ready to commit what I have. I think it fixes the glaring issues and has some improved tests. Then it will be easier to build on top of that if needed.&lt;/p&gt;</comment>
                            <comment id="13584328" author="heldersepu" created="Fri, 22 Feb 2013 15:10:35 +0000"  >&lt;p&gt;Once you commit, Can you generate a .war file?&lt;br/&gt;
I would like to test it on the servers&lt;/p&gt;

&lt;p&gt;Solr 4.1 reduced my index size by more than 50%, Me so happy!&lt;br/&gt;
But this problem with the replication is a show stopper.&lt;/p&gt;

&lt;p&gt;Let me know if there is anything I can do to help. &lt;/p&gt;</comment>
                            <comment id="13584390" author="acharton" created="Fri, 22 Feb 2013 16:17:26 +0000"  >&lt;p&gt;For me patch looks good, together with 4413 replication in solr 4.x is working. &lt;br/&gt;
Thanks for that ( especially from network team, because angry about heavy network usage during replications)!&lt;/p&gt;

&lt;p&gt;@Helder try:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;build script to apply patches in solr, copy content in build.sh an run - may it works for you&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mkdir patches
cd patches
wget https://issues.apache.org/jira/secure/attachment/12570408/SOLR-4471.patch
wget https://issues.apache.org/jira/secure/attachment/12569673/SOLR-4413.patch
cd ..
mkdir work
cd work
svn co http://svn.apache.org/repos/asf/lucene/dev/branches/lucene_solr_4_1/
cd lucene_solr_4_1
patch -p0 &amp;lt; ../../patches/SOLR-4413.patch
patch -p0 &amp;lt; ../../patches/SOLR-4471.patch
cd solr
ant dist
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13584397" author="heldersepu" created="Fri, 22 Feb 2013 16:25:46 +0000"  >&lt;p&gt;I think I will have to start by installing SVN and ANT...&lt;br/&gt;
My servers are VM clones of production servers, they have the bare minimum to run solr, no extra bells and whistles.&lt;br/&gt;
Anything else I might need?&lt;/p&gt;</comment>
                            <comment id="13584408" author="heldersepu" created="Fri, 22 Feb 2013 16:33:01 +0000"  >&lt;p&gt;Andre if you already have a .war file, I would appreciate it very much if you can upload it somewhere, it will save me a lot of troubles&lt;/p&gt;</comment>
                            <comment id="13584432" author="commit-tag-bot" created="Fri, 22 Feb 2013 17:00:11 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Mark Robert Miller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449115&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449115&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4471&quot; title=&quot;Replication occurs even when a slave is already up to date.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4471&quot;&gt;&lt;del&gt;SOLR-4471&lt;/del&gt;&lt;/a&gt;: Replication occurs even when a slave is already up to date.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4484&quot; title=&quot;ReplicationHandler#loadReplicationProperties still uses Files rather than the Directory to try and read the replication properties files.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4484&quot;&gt;&lt;del&gt;SOLR-4484&lt;/del&gt;&lt;/a&gt;: ReplicationHandler#loadReplicationProperties still uses Files rather than the Directory to try and read the replication properties files.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4488&quot; title=&quot;Return slave replication details for a master if the master has also acted like a slave.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4488&quot;&gt;&lt;del&gt;SOLR-4488&lt;/del&gt;&lt;/a&gt;: Return slave replication details for a master if the master has also acted like a slave.&lt;/p&gt;</comment>
                            <comment id="13584440" author="commit-tag-bot" created="Fri, 22 Feb 2013 17:10:10 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Mark Robert Miller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449117&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449117&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4471&quot; title=&quot;Replication occurs even when a slave is already up to date.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4471&quot;&gt;&lt;del&gt;SOLR-4471&lt;/del&gt;&lt;/a&gt;: Replication occurs even when a slave is already up to date.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4484&quot; title=&quot;ReplicationHandler#loadReplicationProperties still uses Files rather than the Directory to try and read the replication properties files.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4484&quot;&gt;&lt;del&gt;SOLR-4484&lt;/del&gt;&lt;/a&gt;: ReplicationHandler#loadReplicationProperties still uses Files rather than the Directory to try and read the replication properties files.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4488&quot; title=&quot;Return slave replication details for a master if the master has also acted like a slave.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4488&quot;&gt;&lt;del&gt;SOLR-4488&lt;/del&gt;&lt;/a&gt;: Return slave replication details for a master if the master has also acted like a slave.&lt;/p&gt;</comment>
                            <comment id="13584470" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 17:31:46 +0000"  >&lt;p&gt;I&apos;ve put up an intermediate build of the current 4X branch at &lt;a href=&quot;http://people.apache.org/~markrmiller/solr-4.2-SNAPSHOT.tgz&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://people.apache.org/~markrmiller/solr-4.2-SNAPSHOT.tgz&lt;/a&gt; that includes the current fixes.&lt;/p&gt;</comment>
                            <comment id="13584488" author="anithian" created="Fri, 22 Feb 2013 18:00:07 +0000"  >&lt;p&gt;Sorry to spam again. Thanks for the explanation! I saw a bunch of changes and I thought they were all to this patch but didn&apos;t realize it was for other bugs. I am attaching my latest test class with some refactorings to hopefully make new tests easier. I think it&apos;s as fast but even if it&apos;s a bit slower, I&apos;d rather have a slower clean test class than a dirtier fast one &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13584524" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 18:36:08 +0000"  >&lt;p&gt;Thanks, I&apos;ll commit this shortly.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I&apos;d rather have a slower clean test class than a dirtier fast one&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It depends on the time difference I think.&lt;/p&gt;

&lt;p&gt;In this case, it doesn&apos;t look like a problem. I&apos;m not sure what the original motivation to have them together was.&lt;/p&gt;</comment>
                            <comment id="13584528" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 18:40:40 +0000"  >&lt;blockquote&gt;&lt;p&gt;but didn&apos;t realize it was for other bugs. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I did &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4484&quot; title=&quot;ReplicationHandler#loadReplicationProperties still uses Files rather than the Directory to try and read the replication properties files.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4484&quot;&gt;&lt;del&gt;SOLR-4484&lt;/del&gt;&lt;/a&gt; because it was causing me problems with the test so had to be fixed for this fix.&lt;/p&gt;

&lt;p&gt;I did &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4488&quot; title=&quot;Return slave replication details for a master if the master has also acted like a slave.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4488&quot;&gt;&lt;del&gt;SOLR-4488&lt;/del&gt;&lt;/a&gt; because I used it as part of the new testing.&lt;/p&gt;</comment>
                            <comment id="13584719" author="shikhar" created="Fri, 22 Feb 2013 21:32:47 +0000"  >&lt;p&gt;We ran into the same issue with full copies happening with each incremental. Patch works! Thank you.&lt;/p&gt;</comment>
                            <comment id="13584726" author="heldersepu" created="Fri, 22 Feb 2013 21:36:11 +0000"  >&lt;p&gt;I just tested the .war in the solr-4.2-SNAPSHOT.tgz and replication is working as intended!&lt;br/&gt;
Thanks a bunch&lt;/p&gt;</comment>
                            <comment id="13584763" author="commit-tag-bot" created="Fri, 22 Feb 2013 22:18:19 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Mark Robert Miller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449240&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449240&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4471&quot; title=&quot;Replication occurs even when a slave is already up to date.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4471&quot;&gt;&lt;del&gt;SOLR-4471&lt;/del&gt;&lt;/a&gt;: Improve and clean up TestReplicationHandler.&lt;/p&gt;</comment>
                            <comment id="13584768" author="commit-tag-bot" created="Fri, 22 Feb 2013 22:26:10 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Mark Robert Miller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449241&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449241&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4471&quot; title=&quot;Replication occurs even when a slave is already up to date.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4471&quot;&gt;&lt;del&gt;SOLR-4471&lt;/del&gt;&lt;/a&gt;: Improve and clean up TestReplicationHandler.&lt;/p&gt;</comment>
                            <comment id="13584887" author="commit-tag-bot" created="Sat, 23 Feb 2013 00:34:14 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Mark Robert Miller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449258&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449258&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4471&quot; title=&quot;Replication occurs even when a slave is already up to date.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4471&quot;&gt;&lt;del&gt;SOLR-4471&lt;/del&gt;&lt;/a&gt;: Fix up test.&lt;/p&gt;</comment>
                            <comment id="13584892" author="commit-tag-bot" created="Sat, 23 Feb 2013 00:42:13 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Mark Robert Miller&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449259&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1449259&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4471&quot; title=&quot;Replication occurs even when a slave is already up to date.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4471&quot;&gt;&lt;del&gt;SOLR-4471&lt;/del&gt;&lt;/a&gt;: Fix up test.&lt;/p&gt;</comment>
                            <comment id="13584989" author="markrmiller@gmail.com" created="Sat, 23 Feb 2013 03:28:14 +0000"  >&lt;p&gt;Thanks all for the help!&lt;/p&gt;</comment>
                            <comment id="13585978" author="raulgrande83" created="Mon, 25 Feb 2013 16:38:56 +0000"  >&lt;p&gt;I have problems with 4.2-SNAPSHOT version. My slaves doesn&apos;t replicate even when master&apos;s version is higher than theirs. See image here: &lt;a href=&quot;http://oi50.tinypic.com/o8uzad.jpg&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://oi50.tinypic.com/o8uzad.jpg&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Why logs say &quot;Slave in sync with master&quot; when clearly isn&apos;t??&lt;/p&gt;</comment>
                            <comment id="13586019" author="anithian" created="Mon, 25 Feb 2013 17:25:55 +0000"  >&lt;p&gt;I&apos;m curious about something. What does:&lt;br/&gt;
1) &lt;a href=&quot;http://localhost:17045/solr/replication?command=indexversion&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:17045/solr/replication?command=indexversion&lt;/a&gt; yield&lt;br/&gt;
2) &lt;a href=&quot;http://localhost:&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:&lt;/a&gt;&amp;lt;your slave port&amp;gt;/solr/replication?command=details yield&lt;/p&gt;

&lt;p&gt;I have noticed that what you see on the UI vs what you see in the indexversion and details sometimes differ and I wonder if that is a culprit here? Does #1,#2 jive with the versions that you see in the UI?&lt;/p&gt;</comment>
                            <comment id="13586912" author="raulgrande83" created="Tue, 26 Feb 2013 07:55:30 +0000"  >&lt;p&gt;When I do &lt;a href=&quot;http://localhost:17045/solr/replication?command=indexversion&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:17045/solr/replication?command=indexversion&lt;/a&gt; response is:&lt;br/&gt;
&amp;lt;long name=&quot;generation&quot;&amp;gt;29037&amp;lt;/long&amp;gt;&lt;/p&gt;

&lt;p&gt;That&apos;s the same version than slaves have, but on the UI generation in master is now 29082.&lt;/p&gt;</comment>
                            <comment id="13588450" author="markrmiller@gmail.com" created="Wed, 27 Feb 2013 15:44:16 +0000"  >&lt;blockquote&gt;
&lt;p&gt;When I do &lt;a href=&quot;http://localhost:17045/solr/replication?command=indexversion&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:17045/solr/replication?command=indexversion&lt;/a&gt; response is:&lt;br/&gt;
&amp;lt;long name=&quot;generation&quot;&amp;gt;29037&amp;lt;/long&amp;gt;&lt;br/&gt;
That&apos;s the same version than slaves have, but on the UI generation in master is now 29082.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sounds like perhaps that needs it&apos;s own new JIRA issue?&lt;/p&gt;</comment>
                            <comment id="13589364" author="raulgrande83" created="Thu, 28 Feb 2013 09:15:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4511&quot; title=&quot;Repeater doesn&amp;#39;t return correct index version to slaves&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4511&quot;&gt;&lt;del&gt;SOLR-4511&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13654278" author="thetaphi" created="Fri, 10 May 2013 10:34:38 +0000"  >&lt;p&gt;Closed after release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12633395">SOLR-4482</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12631261">SOLR-4413</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12736347">SOLR-6415</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12570408" name="SOLR-4471.patch" size="14476" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 03:09:28 +0000"/>
                            <attachment id="12570390" name="SOLR-4471.patch" size="12281" author="markrmiller@gmail.com" created="Fri, 22 Feb 2013 01:27:32 +0000"/>
                            <attachment id="12570283" name="SOLR-4471.patch" size="1875" author="anithian" created="Thu, 21 Feb 2013 09:42:33 +0000"/>
                            <attachment id="12570502" name="SOLR-4471_TestRefactor.diff" size="16824" author="anithian" created="Fri, 22 Feb 2013 18:00:07 +0000"/>
                            <attachment id="12570432" name="SOLR-4471_Tests.patch" size="11741" author="anithian" created="Fri, 22 Feb 2013 07:10:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>313299</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1i2dj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>313644</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>