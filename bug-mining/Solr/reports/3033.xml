<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:15:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9285] ArrayIndexOutOfBoundsException when ValueSourceAugmenter used with RTG on uncommitted doc</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9285</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Found in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9180&quot; title=&quot;need better cloud &amp;amp; RTG testing of TestPseudoReturnFields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9180&quot;&gt;&lt;del&gt;SOLR-9180&lt;/del&gt;&lt;/a&gt; testing.&lt;/p&gt;

&lt;p&gt;Even in single node solr envs, doing an RTG for an uncommitted doc that uses ValueSourceAugmenter (ie: simple field aliasing, or functions in fl) causes an ArrayIndexOutOfBoundsException&lt;/p&gt;</description>
                <environment></environment>
        <key id="12987228">SOLR-9285</key>
            <summary>ArrayIndexOutOfBoundsException when ValueSourceAugmenter used with RTG on uncommitted doc</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Wed, 6 Jul 2016 17:46:59 +0000</created>
                <updated>Sat, 8 Jun 2019 15:37:12 +0000</updated>
                            <resolved>Mon, 18 Jul 2016 17:35:01 +0000</resolved>
                                                    <fixVersion>6.2</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15364727" author="hossman" created="Wed, 6 Jul 2016 17:48:37 +0000"  >&lt;p&gt;Assertion...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-comment&quot;&gt;// also check real-time-get from transaction log
&lt;/span&gt;    assertJQ(req(&lt;span class=&quot;code-quote&quot;&gt;&quot;qt&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;/get&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;99&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;fl&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;val_ss:val_i, val2_ss:10, subject&quot;&lt;/span&gt;)
             ,&lt;span class=&quot;code-quote&quot;&gt;&quot;/doc=={&lt;span class=&quot;code-quote&quot;&gt;&apos;val2_ss&apos;&lt;/span&gt;:10,&lt;span class=&quot;code-quote&quot;&gt;&apos;val_ss&apos;&lt;/span&gt;:1,&lt;span class=&quot;code-quote&quot;&gt;&apos;subject&apos;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&apos;uncommitted&apos;&lt;/span&gt;}&quot;&lt;/span&gt;
    );
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Failure...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4] ERROR   0.06s J1 | TestPseudoReturnFields.testMultiValuedRTG &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.ArrayIndexOutOfBoundsException: -1
   [junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([35D25075C14EB91B:4D9722282B16D95D]:0)
   [junit4]    &amp;gt; 	at java.util.ArrayList.elementData(ArrayList.java:418)
   [junit4]    &amp;gt; 	at java.util.ArrayList.get(ArrayList.java:431)
   [junit4]    &amp;gt; 	at java.util.Collections$UnmodifiableList.get(Collections.java:1309)
   [junit4]    &amp;gt; 	at org.apache.solr.response.transform.ValueSourceAugmenter.transform(ValueSourceAugmenter.java:94)
   [junit4]    &amp;gt; 	at org.apache.solr.response.transform.DocTransformers.transform(DocTransformers.java:76)
   [junit4]    &amp;gt; 	at org.apache.solr.handler.component.RealTimeGetComponent.process(RealTimeGetComponent.java:219)
   [junit4]    &amp;gt; 	at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:292)
   [junit4]    &amp;gt; 	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:154)
   [junit4]    &amp;gt; 	at org.apache.solr.core.SolrCore.execute(SolrCore.java:2035)
   [junit4]    &amp;gt; 	at org.apache.solr.util.TestHarness.query(TestHarness.java:310)
   [junit4]    &amp;gt; 	at org.apache.solr.util.TestHarness.query(TestHarness.java:292)
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertJQ(SolrTestCaseJ4.java:846)
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertJQ(SolrTestCaseJ4.java:815)
   [junit4]    &amp;gt; 	at org.apache.solr.search.TestPseudoReturnFields.testMultiValuedRTG(TestPseudoReturnFields.java:108)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="15364845" author="hossman" created="Wed, 6 Jul 2016 18:35:15 +0000"  >&lt;p&gt;See also...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;TestPseudoReturnFields.testFunctionsRTG&lt;/li&gt;
	&lt;li&gt;TestPseudoReturnFields.testFunctionsAndExplicitRTG&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15365128" author="jira-bot" created="Wed, 6 Jul 2016 21:26:18 +0000"  >&lt;p&gt;Commit fee9526208375fec6a7651249b182fbca1a29703 in lucene-solr&apos;s branch refs/heads/branch_6x from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=fee9526&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=fee9526&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9180&quot; title=&quot;need better cloud &amp;amp; RTG testing of TestPseudoReturnFields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9180&quot;&gt;&lt;del&gt;SOLR-9180&lt;/del&gt;&lt;/a&gt;: More comprehensive tests of psuedo-fields for RTG and SolrCloud requests&lt;/p&gt;

&lt;p&gt;This commit also includes new @AwaitsFix&apos;ed tests for the following known issues...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9285&quot; title=&quot;ArrayIndexOutOfBoundsException when ValueSourceAugmenter used with RTG on uncommitted doc&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9285&quot;&gt;&lt;del&gt;SOLR-9285&lt;/del&gt;&lt;/a&gt; ArrayIndexOutOfBoundsException when ValueSourceAugmenter used with RTG on uncommitted doc&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9286&quot; title=&quot;SolrCloud RTG: psuedo-fields (like ValueSourceAugmenter, [shard], etc...) silently fails (even for committed doc)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9286&quot;&gt;&lt;del&gt;SOLR-9286&lt;/del&gt;&lt;/a&gt; SolrCloud RTG: psuedo-fields (like ValueSourceAugmenter, &lt;span class=&quot;error&quot;&gt;&amp;#91;shard&amp;#93;&lt;/span&gt;, etc...) silently fails (even for committed doc)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9287&quot; title=&quot;single node RTG: NPE if score is requested&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9287&quot;&gt;&lt;del&gt;SOLR-9287&lt;/del&gt;&lt;/a&gt; single node RTG: NPE if score is requested&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9288&quot; title=&quot;RTG: fl=[docid] silently missing for uncommitted docs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9288&quot;&gt;&lt;del&gt;SOLR-9288&lt;/del&gt;&lt;/a&gt; RTG: fl=&lt;span class=&quot;error&quot;&gt;&amp;#91;docid&amp;#93;&lt;/span&gt; silently missing for uncommitted docs&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9289&quot; title=&quot;SolrCloud RTG: fl=[docid] silently ignored for all docs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9289&quot;&gt;&lt;del&gt;SOLR-9289&lt;/del&gt;&lt;/a&gt; SolrCloud RTG: fl=&lt;span class=&quot;error&quot;&gt;&amp;#91;docid&amp;#93;&lt;/span&gt; silently ignored for all docs&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;(cherry picked from commit ae316f1e39e58d89758f997913a38059d74ccb47)&lt;/p&gt;</comment>
                            <comment id="15365135" author="jira-bot" created="Wed, 6 Jul 2016 21:26:30 +0000"  >&lt;p&gt;Commit ae316f1e39e58d89758f997913a38059d74ccb47 in lucene-solr&apos;s branch refs/heads/master from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ae316f1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ae316f1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9180&quot; title=&quot;need better cloud &amp;amp; RTG testing of TestPseudoReturnFields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9180&quot;&gt;&lt;del&gt;SOLR-9180&lt;/del&gt;&lt;/a&gt;: More comprehensive tests of psuedo-fields for RTG and SolrCloud requests&lt;/p&gt;

&lt;p&gt;This commit also includes new @AwaitsFix&apos;ed tests for the following known issues...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9285&quot; title=&quot;ArrayIndexOutOfBoundsException when ValueSourceAugmenter used with RTG on uncommitted doc&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9285&quot;&gt;&lt;del&gt;SOLR-9285&lt;/del&gt;&lt;/a&gt; ArrayIndexOutOfBoundsException when ValueSourceAugmenter used with RTG on uncommitted doc&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9286&quot; title=&quot;SolrCloud RTG: psuedo-fields (like ValueSourceAugmenter, [shard], etc...) silently fails (even for committed doc)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9286&quot;&gt;&lt;del&gt;SOLR-9286&lt;/del&gt;&lt;/a&gt; SolrCloud RTG: psuedo-fields (like ValueSourceAugmenter, &lt;span class=&quot;error&quot;&gt;&amp;#91;shard&amp;#93;&lt;/span&gt;, etc...) silently fails (even for committed doc)&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9287&quot; title=&quot;single node RTG: NPE if score is requested&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9287&quot;&gt;&lt;del&gt;SOLR-9287&lt;/del&gt;&lt;/a&gt; single node RTG: NPE if score is requested&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9288&quot; title=&quot;RTG: fl=[docid] silently missing for uncommitted docs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9288&quot;&gt;&lt;del&gt;SOLR-9288&lt;/del&gt;&lt;/a&gt; RTG: fl=&lt;span class=&quot;error&quot;&gt;&amp;#91;docid&amp;#93;&lt;/span&gt; silently missing for uncommitted docs&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9289&quot; title=&quot;SolrCloud RTG: fl=[docid] silently ignored for all docs&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9289&quot;&gt;&lt;del&gt;SOLR-9289&lt;/del&gt;&lt;/a&gt; SolrCloud RTG: fl=&lt;span class=&quot;error&quot;&gt;&amp;#91;docid&amp;#93;&lt;/span&gt; silently ignored for all docs&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15372019" author="hossman" created="Tue, 12 Jul 2016 01:14:32 +0000"  >
&lt;p&gt;The root cause of the AIOOBE is that when a doc is found in the &lt;tt&gt;UpdateLog&lt;/tt&gt;, the RTG component explicitly passes -1 to &lt;tt&gt;DocTransformer.transform()&lt;/tt&gt;, and currently &lt;tt&gt;ValueSourceAugmenter.transform()&lt;/tt&gt; doesn&apos;t account for this possibility when using it&apos;s IndexReader to lookup the FunctionValues for the document.&lt;/p&gt;

&lt;p&gt;Obviously, even if it did do some sanity checking for negative docids, that wouldn&apos;t really address the root of the problem &amp;#8211; getting usable FunctionValues.&lt;/p&gt;

&lt;p&gt;The RTG Component already has a code path where it sometimes uses &lt;tt&gt;ulog.openRealtimeSearcher()&lt;/tt&gt; when doc are found in the update log, instead of returning the document directly from the ulog command &amp;#8211; but that code path is currently confined to situations where &lt;tt&gt;fq&lt;/tt&gt; params are included in the RTG request (so it can evaluate them against the Realtime Searcher to ensure the doc should really be returned)&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;I&apos;m attaching a straw man patch that:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;refactors the &lt;tt&gt;ulog.openRealtimeSearcher()&lt;/tt&gt; logic in RTG Component to also apply when there are transformers&lt;/li&gt;
	&lt;li&gt;Adds a new light weight (private) &lt;tt&gt;RTGResultContext&lt;/tt&gt; class for wrapping realtime {{SolrIndexSearcher}}s for use with transformers.&lt;/li&gt;
	&lt;li&gt;Fixes &lt;tt&gt;ValueSourceAugmenter.setContext&lt;/tt&gt; to use &lt;tt&gt;ResultContext.getSearcher()&lt;/tt&gt; instead of the one that comes from the request
	&lt;ul&gt;
		&lt;li&gt;Independent of anything else, this seems like a bug (it certainly violates the javadocs of &lt;tt&gt;ResultContext.getRequest()&lt;/tt&gt;, even if it was getting the same SolrQueryRequest via a more round about way)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;



&lt;p&gt;This patch fixes all existing &lt;tt&gt;@AwaitsFix(&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9285&quot; title=&quot;ArrayIndexOutOfBoundsException when ValueSourceAugmenter used with RTG on uncommitted doc&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9285&quot;&gt;&lt;del&gt;SOLR-9285&lt;/del&gt;&lt;/a&gt;)&lt;/tt&gt; tests, and doesn&apos;t seem to cause any new test failures in the code base, but i don&apos;t think we should commit it as is for the simple reason that it seems like it is overkill: Simple transformers like RenameFieldTransformer can operate just fine on docs from the UpdateLog w/o any need for a (realtime) SolrIndexSearcher.&lt;/p&gt;

&lt;p&gt;As noted in the patch with a &lt;tt&gt;nocommit&lt;/tt&gt; I think what would be best is to enahnce this patch by adding a &lt;tt&gt;boolean needsSolrIndexSearcher()&lt;/tt&gt; method to the &lt;tt&gt;DocTransformer&lt;/tt&gt; API, which defaults to &lt;tt&gt;false&lt;/tt&gt; but any transformers like &lt;tt&gt;ValueSourceAugmenter&lt;/tt&gt; that actually &lt;em&gt;need&lt;/em&gt; access to a &lt;tt&gt;SolrIndexSearcher&lt;/tt&gt; in their &lt;tt&gt;setContext&lt;/tt&gt; method could ask for it, and the code in this patch that sets &lt;tt&gt;mustUseRealtimeSearcher = true&lt;/tt&gt; anytime there is a transformer could be modified to instead use &lt;tt&gt;transformer.needsSolrIndexSearcher()&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Questions/comments/concerns?&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;Reviewing the RTG Component code also makes me realize that in general we should have more RTG+transformer tests which:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;use &lt;tt&gt;fq&lt;/tt&gt; params&lt;/li&gt;
	&lt;li&gt;ask for uncommited ids both immediately after adding them (before a realtime searcher may have been opened) &lt;b&gt;AND&lt;/b&gt; &quot;after&quot; a realtime searcher has been opened (for whatever reason)&lt;/li&gt;
	&lt;li&gt;ask for multiple ids in a single request (to ensure nothing broken in the looping logic)
	&lt;ul&gt;
		&lt;li&gt;mixing commited, uncommited, and uncommited but in an already re-opened realtime searcher&lt;/li&gt;
		&lt;li&gt;mixing them in various orders, since that affects &lt;b&gt;when&lt;/b&gt; a realtime searcher might be opened&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="15372147" author="dsmiley" created="Tue, 12 Jul 2016 04:08:13 +0000"  >&lt;p&gt;Your plan makes sense to me Hoss.  Thanks for your thoroughness.&lt;/p&gt;</comment>
                            <comment id="15374189" author="hossman" created="Wed, 13 Jul 2016 02:18:50 +0000"  >&lt;blockquote&gt;&lt;p&gt;Reviewing the RTG Component code also makes me realize that in general we should have more RTG+transformer tests which:&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;updated patch with a randomized test along these lines ... still some holes to fill in, but mostly feature complete.&lt;/p&gt;</comment>
                            <comment id="15374299" author="yseeley@gmail.com" created="Wed, 13 Jul 2016 04:03:23 +0000"  >&lt;blockquote&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;refactors the ulog.openRealtimeSearcher() logic in RTG Component to also apply when there are transformers&lt;/li&gt;
	&lt;li&gt;Adds a new light weight (private) RTGResultContext class for wrapping realtime {{SolrIndexSearcher}}s for use with transformers.&lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;+1, this sounds like the right approach.&lt;/p&gt;

&lt;blockquote&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Fixes ValueSourceAugmenter.setContext to use ResultContext.getSearcher() instead of the one that comes from the request&lt;br/&gt;
           Independent of anything else, this seems like a bug &lt;/li&gt;
&lt;/ul&gt;
&lt;/blockquote&gt;

&lt;p&gt;Yep.  ResultContext having a getSearcher is relatively new... I added it to support &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7830&quot; title=&quot;topdocs facet function&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7830&quot;&gt;SOLR-7830&lt;/a&gt;, but I obviously didn&apos;t find all the places that needed changing.&lt;/p&gt;</comment>
                            <comment id="15378734" author="hossman" created="Fri, 15 Jul 2016 01:48:24 +0000"  >&lt;p&gt;Heavily beefed up test, nearly finished.&lt;/p&gt;

&lt;p&gt;Uncovered &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9308&quot; title=&quot;SolrCloud RTG doesn&amp;#39;t forward any params to shards, causes fqs &amp;amp; non-default fl params to be ignored&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9308&quot;&gt;&lt;del&gt;SOLR-9308&lt;/del&gt;&lt;/a&gt; &amp;amp; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9309&quot; title=&quot;SolrCloud RTG with multiple &amp;quot;id&amp;quot; params has inconsistent behavior if only 0 or 1 ids are returned&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9309&quot;&gt;&lt;del&gt;SOLR-9309&lt;/del&gt;&lt;/a&gt; in the process &amp;#8211; currently just working around them with commented out TODOs in test since they are secondary to the primary goal here.&lt;/p&gt;</comment>
                            <comment id="15380364" author="hossman" created="Sat, 16 Jul 2016 00:29:41 +0000"  >
&lt;p&gt;Updated patch:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;fully fleshed out &lt;tt&gt;TestRandomFlRTGCloud&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;added the previously proposed &lt;tt&gt;needsSolrIndexSearcher&lt;/tt&gt; method to &lt;tt&gt;DocTransformer&lt;/tt&gt;
	&lt;ul&gt;
		&lt;li&gt;default impl always returns &lt;tt&gt;false&lt;/tt&gt;&lt;/li&gt;
		&lt;li&gt;&lt;tt&gt;ValueSourceAugmenter&lt;/tt&gt; overrides to always returns &lt;tt&gt;true&lt;/tt&gt;&lt;/li&gt;
		&lt;li&gt;&lt;tt&gt;DocTransformers&lt;/tt&gt; overrides to return &lt;tt&gt;true&lt;/tt&gt; if any of the wrapped/child transformers return &lt;tt&gt;true&lt;/tt&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;There are almost certainly some other &lt;tt&gt;DocTransformer&lt;/tt&gt; subclasses that should return true from this method, but I&apos;d like to move forward with committing as is and target fixing any other classes (and adding test coverage for them) in other issues.  (As things stand in this patch they are no worse off then before.)&lt;/p&gt;

&lt;p&gt;Unless there are objections, I&apos;ll try to commit/backport this on monday. (possibly after filing some new issues so i can update some TODO comments in tests with concrete jira IDs)&lt;/p&gt;</comment>
                            <comment id="15382624" author="hossman" created="Mon, 18 Jul 2016 17:12:06 +0000"  >
&lt;p&gt;Minor patch updates after doing a re-read this morning:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Updated some TODO comments to refer to (newly created) &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9314&quot; title=&quot;Add all known transformers to TestRandomFlRTGCloud and fix any bugs found&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9314&quot;&gt;&lt;del&gt;SOLR-9314&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Updated TestPseudoReturnFields to replace some TODO comments with more coverage of &lt;tt&gt;abs(val_i)&lt;/tt&gt; now that it works.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;...committing &amp;amp; backporting now.&lt;/p&gt;</comment>
                            <comment id="15382670" author="jira-bot" created="Mon, 18 Jul 2016 17:33:48 +0000"  >&lt;p&gt;Commit 9bde118c2f755ffc060b893248f64ff7da9400c2 in lucene-solr&apos;s branch refs/heads/branch_6x from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9bde118&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9bde118&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9285&quot; title=&quot;ArrayIndexOutOfBoundsException when ValueSourceAugmenter used with RTG on uncommitted doc&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9285&quot;&gt;&lt;del&gt;SOLR-9285&lt;/del&gt;&lt;/a&gt;: Fixed AIOOBE when using ValueSourceAugmenter in single node RTG&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 4123b3bf26156227174ef3c417b36309c2beeb9a)&lt;/p&gt;</comment>
                            <comment id="15382671" author="jira-bot" created="Mon, 18 Jul 2016 17:33:50 +0000"  >&lt;p&gt;Commit 4123b3bf26156227174ef3c417b36309c2beeb9a in lucene-solr&apos;s branch refs/heads/master from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4123b3b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4123b3b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9285&quot; title=&quot;ArrayIndexOutOfBoundsException when ValueSourceAugmenter used with RTG on uncommitted doc&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9285&quot;&gt;&lt;del&gt;SOLR-9285&lt;/del&gt;&lt;/a&gt;: Fixed AIOOBE when using ValueSourceAugmenter in single node RTG&lt;/p&gt;</comment>
                            <comment id="15439056" author="mikemccand" created="Fri, 26 Aug 2016 14:00:49 +0000"  >&lt;p&gt;Bulk close resolved issues after 6.2.0 release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12974890">SOLR-9180</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12987229">SOLR-9286</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12990465">SOLR-9314</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12818586" name="SOLR-9285.patch" size="49696" author="hossman" created="Mon, 18 Jul 2016 17:12:06 +0000"/>
                            <attachment id="12818280" name="SOLR-9285.patch" size="42141" author="hossman" created="Sat, 16 Jul 2016 00:29:41 +0000"/>
                            <attachment id="12818078" name="SOLR-9285.patch" size="38017" author="hossman" created="Fri, 15 Jul 2016 01:48:24 +0000"/>
                            <attachment id="12817576" name="SOLR-9285.patch" size="31118" author="hossman" created="Wed, 13 Jul 2016 02:18:50 +0000"/>
                            <attachment id="12817311" name="SOLR-9285.patch" size="10102" author="hossman" created="Tue, 12 Jul 2016 01:14:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i30lx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>