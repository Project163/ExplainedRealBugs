<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:24:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2509] spellcheck: StringIndexOutOfBoundsException: String index out of range: -1</title>
                <link>https://issues.apache.org/jira/browse/SOLR-2509</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;I&apos;m a french user of SOLR and i&apos;ve encountered a problem since i&apos;ve installed SOLR 3.1.&lt;/p&gt;

&lt;p&gt;I&apos;ve got an error with this query : &lt;br/&gt;
cle_frbr:&quot;LYSROUGE1149-73190&quot;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;SEE COMMENTS BELOW&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;I&apos;ve tested to escape the minus char and the query worked :&lt;br/&gt;
cle_frbr:&quot;LYSROUGE1149(BACKSLASH)-73190&quot;&lt;/p&gt;

&lt;p&gt;But, strange fact, if i change one letter in my query it works :&lt;br/&gt;
cle_frbr:&quot;LASROUGE1149-73190&quot;&lt;/p&gt;


&lt;p&gt;I&apos;ve tested the same query on SOLR 1.4 and it works !&lt;/p&gt;

&lt;p&gt;Can someone test the query on next line on a 3.1 SOLR version and tell me if he have the same problem ? &lt;br/&gt;
yourfield:&quot;LYSROUGE1149-73190&quot;&lt;/p&gt;

&lt;p&gt;Where do the problem come from ?&lt;/p&gt;

&lt;p&gt;Thank you by advance for your help.&lt;/p&gt;

&lt;p&gt;Tom&lt;/p&gt;</description>
                <environment>&lt;p&gt;Debian Lenny&lt;br/&gt;
JAVA Version &quot;1.6.0_20&quot;&lt;/p&gt;</environment>
        <key id="12506875">SOLR-2509</key>
            <summary>spellcheck: StringIndexOutOfBoundsException: String index out of range: -1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="erickerickson">Erick Erickson</assignee>
                                    <reporter username="calitom">Thomas Gambier</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 May 2011 16:21:21 +0000</created>
                <updated>Fri, 10 May 2013 10:40:00 +0000</updated>
                            <resolved>Wed, 7 Dec 2011 14:47:09 +0000</resolved>
                                    <version>3.1</version>
                                    <fixVersion>3.6</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13032320" author="calitom" created="Thu, 12 May 2011 08:43:40 +0000"  >&lt;p&gt;More investigation :&lt;/p&gt;

&lt;p&gt;I&apos;ve located that spellchecker collate function is the trouble.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/spell?q=cle_frbr%3A&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/spell?q=cle_frbr%3A&lt;/a&gt;&quot;LYSROUGE1149-73190&quot;&amp;amp;spellcheck=true&amp;amp;spellcheck.collate=true&lt;br/&gt;
The query failed with the same error as above.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/spell?q=cle_frbr%3A&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/spell?q=cle_frbr%3A&lt;/a&gt;&quot;LYSROUGE1149-73190&quot;&amp;amp;spellcheck=true&lt;br/&gt;
This query works fine.&lt;/p&gt;</comment>
                            <comment id="13050211" author="hossman" created="Thu, 16 Jun 2011 04:40:43 +0000"  >&lt;p&gt;Moved original stack trace out of description for brevity...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;The error is :
HTTP ERROR 500

Problem accessing /solr/select. Reason:

    String index out of range: -1

java.lang.StringIndexOutOfBoundsException: String index out of range: -1
	at java.lang.AbstractStringBuilder.replace(AbstractStringBuilder.java:797)
	at java.lang.StringBuilder.replace(StringBuilder.java:271)
	at org.apache.solr.spelling.SpellCheckCollator.getCollation(SpellCheckCollator.java:131)
	at org.apache.solr.spelling.SpellCheckCollator.collate(SpellCheckCollator.java:69)
	at org.apache.solr.handler.component.SpellCheckComponent.addCollationsToResponse(SpellCheckComponent.java:179)
	at org.apache.solr.handler.component.SpellCheckComponent.process(SpellCheckComponent.java:157)
	at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:194)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:1360)
	at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:356)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:252)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
	at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)
	at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)
	at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
	at org.mortbay.jetty.Server.handle(Server.java:326)
	at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
	at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)
	at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)
	at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
	at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
	at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)
	at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13050212" author="hossman" created="Thu, 16 Jun 2011 04:41:54 +0000"  >&lt;p&gt;the stack trace is different, but based on the fact that it has to do with using spellcheck.collate and &quot;-&quot; in the query this smells like it might be realted to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1630&quot; title=&quot;StringIndexOutOfBoundsException in SpellCheckComponent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1630&quot;&gt;&lt;del&gt;SOLR-1630&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13090066" author="janhoy" created="Wed, 24 Aug 2011 07:51:45 +0000"  >&lt;p&gt;I see this issue in 1.4 with query &quot;Irano-Hind&quot; and spellcheck w/collate. However, I cannot reproduce in 3.1, so my issue was probably &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1630&quot; title=&quot;StringIndexOutOfBoundsException in SpellCheckComponent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1630&quot;&gt;&lt;del&gt;SOLR-1630&lt;/del&gt;&lt;/a&gt; related.&lt;/p&gt;

&lt;p&gt;Sure you&apos;re on 3.1? Can you describe closer what you do, what field type you use, how you setup spellcheck etc?&lt;/p&gt;</comment>
                            <comment id="13151129" author="seg" created="Wed, 16 Nov 2011 10:37:59 +0000"  >
&lt;p&gt;We seem to be hitting this bug in in 4.0 also. I&apos;ve attached the simplest (that I could come up with) config, schema and document that enables me to reproduce the exception on the latest nightly build (from &lt;a href=&quot;https://builds.apache.org/job/Solr-trunk/lastSuccessfulBuild/artifact/artifacts/apache-solr-4.0-2011-11-16_08-54-59.tgz&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Solr-trunk/lastSuccessfulBuild/artifact/artifacts/apache-solr-4.0-2011-11-16_08-54-59.tgz&lt;/a&gt;) &lt;/p&gt;

&lt;p&gt;To reproduce:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Start a Solr instance using the attached schema.xml and solrconfig.xml&lt;/li&gt;
	&lt;li&gt;Add the attached document.xml to the index&lt;/li&gt;
	&lt;li&gt;Query for hypenated-wotd with spellchecking on and collation on (e.g. &lt;a href=&quot;http://localhost:8983/solr/select?&amp;amp;q=hypenated-wotd&amp;amp;spellcheck=true&amp;amp;spellcheck.collate=true&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/select?&amp;amp;q=hypenated-wotd&amp;amp;spellcheck=true&amp;amp;spellcheck.collate=true&lt;/a&gt;)&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;This will log the following exception (very similar to the one above, but included for completeness)&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Nov 16, 2011 11:18:33 AM org.apache.solr.core.SolrCore execute
INFO: [] webapp=/solr path=/select params={spellcheck.collate=true&amp;amp;spellcheck=true&amp;amp;q=hypenated-wotd} hits=0 status=500 QTime=34 
Nov 16, 2011 11:18:33 AM org.apache.solr.common.SolrException log
SEVERE: java.lang.StringIndexOutOfBoundsException: String index out of range: -4
	at java.lang.AbstractStringBuilder.replace(AbstractStringBuilder.java:797)
	at java.lang.StringBuilder.replace(StringBuilder.java:271)
	at org.apache.solr.spelling.SpellCheckCollator.getCollation(SpellCheckCollator.java:131)
	at org.apache.solr.spelling.SpellCheckCollator.collate(SpellCheckCollator.java:70)
	at org.apache.solr.handler.component.SpellCheckComponent.addCollationsToResponse(SpellCheckComponent.java:177)
	at org.apache.solr.handler.component.SpellCheckComponent.process(SpellCheckComponent.java:154)
	at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:194)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:1475)
	at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:353)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:248)
	at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)
	at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)
	at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)
	at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)
	at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)
	at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)
	at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)
	at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)
	at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)
	at org.mortbay.jetty.Server.handle(Server.java:326)
	at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)
	at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)
	at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)
	at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)
	at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)
	at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)
	at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13151281" author="jdyer" created="Wed, 16 Nov 2011 16:00:01 +0000"  >&lt;p&gt;This patch contains a failing unit test, based on Steffan&apos;s config files.&lt;/p&gt;</comment>
                            <comment id="13155380" author="seg" created="Tue, 22 Nov 2011 19:55:51 +0000"  >&lt;p&gt;This patch passes James&apos; new unit tests, but fails testCollate() in org.apache.solr.handler.component.SpellCheckComponentTest, since the collation &quot;pixmaa-a-b-c-d-e-f-g&quot; is now returned for the query &quot;pixma-a-b-c-d-e-f-g&quot; with the word &quot;pixmaa&quot; in the index. The test expects the collation &quot;pixmaa&quot; to be returned. &lt;/p&gt;

&lt;p&gt;I&apos;m not really in a position to decide which behavior is correct. The new behavior passes James&apos; tests and fixes the StringIndexOutOfBoundsException, but may deviate enough from the current behavior to cause problems for existing users.&lt;/p&gt;</comment>
                            <comment id="13162416" author="erickerickson" created="Sun, 4 Dec 2011 16:31:54 +0000"  >&lt;p&gt;This seems like a fairly straight-forward patch code-change wise, but I confess I know nothing about this code. So if someone who does can take a glance at the actual changes (three lines total, and unit tests, cool!) and render an opinion on Steffan&apos;s note about the collation issue is something to be concerned about or not I can alter the failing test and get this into the code.&lt;/p&gt;</comment>
                            <comment id="13163103" author="jdyer" created="Mon, 5 Dec 2011 22:16:52 +0000"  >&lt;p&gt;Steffen&apos;s changes are most certainly correct.  The index contains &quot;pixmaa&quot; and we are querying on &quot;pixma-a-b-c-d-e-f-g&quot;.  The spelling index is using analyzer &quot;lowerpunctfilt&quot; (solrconfig-spellcheckcomponent.xml, line 44) which includes WordDelimiterFilter and &quot;generateWordParts=1&quot;.  So we would expect this query to tokenize down to &quot;pixma&quot; &quot;a&quot; &quot;b&quot; &quot;c&quot; &quot;d&quot; &quot;e&quot; &quot;f&quot; &quot;g&quot;.  As the Collate feature is only supposed to replace the misspelled token with the new one, I wonder why this test scenario would expect all 8 tokens to be replaced by 1 token &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/warning.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.&lt;/p&gt;

&lt;p&gt;Indeed, this test scenario was added during a refactoring (r1022768) with no JIRA # or bug mentioned at all in the comments.  So we can&apos;t know for sure why it was added.  I&apos;m thinking this is invalid.  I would expect the correct collation to be &quot;pixma-a-b-c-d-e-f-g&quot;.  &lt;/p&gt;

&lt;p&gt;Just for grins, I put a &quot;println&quot; in SpellingQueryConverter to show the start &amp;amp; end offsets for each token before and after the patch.  In both cases, we get the same token texts, but prior to the patch the offset values are clearly wrong.&lt;/p&gt;

&lt;p&gt;--before:&lt;br/&gt;
TOKEN: pixma so=0 eo=19&lt;br/&gt;
TOKEN: a so=0 eo=19&lt;br/&gt;
TOKEN: b so=0 eo=19&lt;br/&gt;
TOKEN: c so=0 eo=19&lt;br/&gt;
TOKEN: d so=0 eo=19&lt;br/&gt;
TOKEN: e so=0 eo=19&lt;br/&gt;
TOKEN: f so=0 eo=19&lt;br/&gt;
TOKEN: g so=0 eo=19&lt;br/&gt;
TOKEN: pixmaabcdefg so=0 eo=19&lt;/p&gt;

&lt;p&gt;--after:&lt;br/&gt;
TOKEN: pixma so=0 eo=5&lt;br/&gt;
TOKEN: a so=6 eo=7&lt;br/&gt;
TOKEN: b so=8 eo=9&lt;br/&gt;
TOKEN: c so=10 eo=11&lt;br/&gt;
TOKEN: d so=12 eo=13&lt;br/&gt;
TOKEN: e so=14 eo=15&lt;br/&gt;
TOKEN: f so=16 eo=17&lt;br/&gt;
TOKEN: g so=18 eo=19&lt;br/&gt;
TOKEN: pixmaabcdefg so=0 eo=19&lt;/p&gt;

</comment>
                            <comment id="13163114" author="yseeley@gmail.com" created="Mon, 5 Dec 2011 22:34:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;Indeed, this test scenario was added during a refactoring (r1022768) with no JIRA # or bug mentioned at all in the comments. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;My commit &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;The commit comment said &quot;tests: fix resource leaks and simplify&quot;, and hopefully that&apos;s all I did!&lt;/p&gt;

&lt;p&gt;Looking back wrt pixma, it looks like I replaced this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;-  @Test
-  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testCollate2() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
-    SolrCore core = h.getCore();
-    SearchComponent speller = core.getSearchComponent(&lt;span class=&quot;code-quote&quot;&gt;&quot;spellcheck&quot;&lt;/span&gt;);
-    assertTrue(&lt;span class=&quot;code-quote&quot;&gt;&quot;speller is &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; and it shouldn&apos;t be&quot;&lt;/span&gt;, speller != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
-
-    ModifiableSolrParams params = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ModifiableSolrParams();
-    params.add(CommonParams.QT, &lt;span class=&quot;code-quote&quot;&gt;&quot;spellCheckCompRH&quot;&lt;/span&gt;);
-    params.add(SpellCheckComponent.SPELLCHECK_BUILD, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;);
-    params.add(CommonParams.Q, &lt;span class=&quot;code-quote&quot;&gt;&quot;pixma-a-b-c-d-e-f-g&quot;&lt;/span&gt;);
-    params.add(SpellCheckComponent.COMPONENT_NAME, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;);
-    params.add(SpellCheckComponent.SPELLCHECK_COLLATE, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;);
-
-    SolrRequestHandler handler = core.getRequestHandler(&lt;span class=&quot;code-quote&quot;&gt;&quot;spellCheckCompRH&quot;&lt;/span&gt;);
-    SolrQueryResponse rsp = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SolrQueryResponse();
-    rsp.add(&lt;span class=&quot;code-quote&quot;&gt;&quot;responseHeader&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SimpleOrderedMap());
-    handler.handleRequest(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LocalSolrQueryRequest(core, params), rsp);
-    NamedList values = rsp.getValues();
-    NamedList spellCheck = (NamedList) values.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;spellcheck&quot;&lt;/span&gt;);
-    NamedList suggestions = (NamedList) spellCheck.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;suggestions&quot;&lt;/span&gt;);
-    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; collation = (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) suggestions.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;collation&quot;&lt;/span&gt;);
-    assertEquals(&lt;span class=&quot;code-quote&quot;&gt;&quot;pixmaa&quot;&lt;/span&gt;, collation);
-  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;With this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+    assertJQ(req(&lt;span class=&quot;code-quote&quot;&gt;&quot;json.nl&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;map&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;qt&quot;&lt;/span&gt;,rh, SpellCheckComponent.COMPONENT_NAME, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;pixma-a-b-c-d-e-f-g&quot;&lt;/span&gt;, SpellCheckComponent.SPELLCHECK_COLLATE, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;)
+       ,&lt;span class=&quot;code-quote&quot;&gt;&quot;/spellcheck/suggestions/collation==&lt;span class=&quot;code-quote&quot;&gt;&apos;pixmaa&apos;&lt;/span&gt;&quot;&lt;/span&gt;
+    );
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13163695" author="jdyer" created="Tue, 6 Dec 2011 16:51:59 +0000"  >&lt;p&gt;ahhhh.  I see in r1022768 you combined &quot;testCollate()&quot; with &quot;testCollate2()&quot;, where this test scenario was originally.  Thanks for the clarification (and sorry!).  So in fact this was added with &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1630&quot; title=&quot;StringIndexOutOfBoundsException in SpellCheckComponent&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1630&quot;&gt;&lt;del&gt;SOLR-1630&lt;/del&gt;&lt;/a&gt; (r987509), the comments therein are not very reassuring that it was a &quot;correct&quot; or &quot;final&quot; fix.&lt;/p&gt;</comment>
                            <comment id="13163770" author="erickerickson" created="Tue, 6 Dec 2011 19:43:51 +0000"  >&lt;p&gt;Here&apos;s the updated patch. The only difference between this and the original is that I changed the failing test to expect pixmaa rather than pixma-a-b-c-d-e-f-g.&lt;/p&gt;

&lt;p&gt;If nobody objects, I&apos;ll commit this tomorrow (7-Dec) on both trunk and 3x.&lt;/p&gt;</comment>
                            <comment id="13164434" author="erickerickson" created="Wed, 7 Dec 2011 14:47:10 +0000"  >
&lt;p&gt;Trunk r: 1211456&lt;br/&gt;
3x r:    1211457&lt;/p&gt;</comment>
                            <comment id="13165200" author="erickerickson" created="Thu, 8 Dec 2011 13:01:51 +0000"  >&lt;p&gt;By the way, many thanks to Thomas and Steffen!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12548838">SOLR-3300</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12506298" name="SOLR-2509.patch" size="5954" author="erickerickson" created="Tue, 6 Dec 2011 19:43:50 +0000"/>
                            <attachment id="12504793" name="SOLR-2509.patch" size="4958" author="seg" created="Tue, 22 Nov 2011 19:55:51 +0000"/>
                            <attachment id="12503897" name="SOLR-2509.patch" size="3369" author="jdyer" created="Wed, 16 Nov 2011 16:00:00 +0000"/>
                            <attachment id="12503866" name="document.xml" size="105" author="seg" created="Wed, 16 Nov 2011 10:38:45 +0000"/>
                            <attachment id="12503867" name="schema.xml" size="1951" author="seg" created="Wed, 16 Nov 2011 10:38:45 +0000"/>
                            <attachment id="12503868" name="solrconfig.xml" size="1113" author="seg" created="Wed, 16 Nov 2011 10:38:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>361</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 50 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03kbj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18725</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>