<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:22:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2520] JSONResponseWriter w/json.wrf can produce invalid javascript depending on unicode chars in response data</title>
                <link>https://issues.apache.org/jira/browse/SOLR-2520</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Please see &lt;a href=&quot;http://timelessrepo.com/json-isnt-a-javascript-subset&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://timelessrepo.com/json-isnt-a-javascript-subset&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If a stored field contains Unicode characters that are valid in Json but not valid in Javascript, and you use the query option to ask for JSONP (json.wrf), solr does &lt;b&gt;not&lt;/b&gt; escape them, resulting in content that explodes on contact with browsers. That is, there are certain Unicode characters that are valid JSON but invalid in Javascript source, and a JSONP response is javascript source, to be incorporated in an HTML script tag. Further investigation suggests that only one character is a problem here:  U+2029 must be represented as \u2029 instead of left &apos;as-is&apos;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12507311">SOLR-2520</key>
            <summary>JSONResponseWriter w/json.wrf can produce invalid javascript depending on unicode chars in response data</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="bmargulies">Benson Margulies</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 May 2011 00:05:25 +0000</created>
                <updated>Fri, 3 Jun 2011 16:44:56 +0000</updated>
                            <resolved>Tue, 17 May 2011 02:14:59 +0000</resolved>
                                    <version>4.0-ALPHA</version>
                                    <fixVersion>3.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13034151" author="hossman" created="Mon, 16 May 2011 17:55:03 +0000"  >&lt;p&gt;I&apos;m confused here: As far as i can tell, the JSONResponseWriter does in fact output valid JSON (the link mentioned points out that there are control characters valid in JSON which are not valid in javascript, but that&apos;s what the response writer produces &amp;#8211; JSON) ... so what is the bug?&lt;/p&gt;

&lt;p&gt;And what do you mean by &quot;the query option to ask for jsonp&quot; ? ...  i don&apos;t see that option in the JSONResponseWriter&lt;/p&gt;

&lt;p&gt;(is this bug about some third party response writer?)&lt;/p&gt;</comment>
                            <comment id="13034159" author="bmargulies" created="Mon, 16 May 2011 18:05:46 +0000"  >&lt;p&gt;Fun happens when you specify something in json.wrf. This demands &apos;jsonp&apos; instead of json, which results in the result being treated as javascript, not json.  wt=json&amp;amp;json.wrf=SOME_PREFIX will cause Solr to respond with&lt;/p&gt;

&lt;p&gt;     SOME_PREFIX(&lt;/p&gt;
{whatever it was otherwise going to return})&lt;br/&gt;
&lt;br/&gt;
instead of just&lt;br/&gt;
&lt;br/&gt;
     {whatever it was otherwise going to return}

&lt;p&gt;If there is then an interesting Unicode character in there, Chrome implodes and firefox quietly rejects.&lt;/p&gt;
</comment>
                            <comment id="13034179" author="hossman" created="Mon, 16 May 2011 18:31:28 +0000"  >&lt;p&gt;Benson: thanks for the clarification, i&apos;ve updated the summary to attempt to clarify the root of the issue.&lt;/p&gt;

&lt;p&gt;Would make more sense to have a &quot;JavascriptResponseWriter&quot; or to have the JSONResponseWriter do unicode escaping/stripping if/when json.wrf is specified?&lt;/p&gt;</comment>
                            <comment id="13034187" author="bmargulies" created="Mon, 16 May 2011 18:38:24 +0000"  >&lt;p&gt;I&apos;d vote for the later. I assume that there is some large inventory of people who are currently using json.wrf=foo and who would benefit from the change. However, I have limited context here, so if anyone else knows more about how users are using this stuff I hope they will speak up. Sorry not to have been fully clear on the first attempt.&lt;/p&gt;</comment>
                            <comment id="13034197" author="yseeley@gmail.com" created="Mon, 16 May 2011 18:56:16 +0000"  >&lt;p&gt;It looks like we already escape \u2028 (see &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1936&quot; title=&quot;Json output Incorrect escaping Unicode Character &amp;#39;LINE SEPARATOR&amp;#39; (U+2028)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1936&quot;&gt;&lt;del&gt;SOLR-1936&lt;/del&gt;&lt;/a&gt;), so we should just do the same for \u2029?&lt;/p&gt;</comment>
                            <comment id="13034352" author="bmargulies" created="Mon, 16 May 2011 21:49:35 +0000"  >&lt;p&gt;Yes, that looks like that.&lt;/p&gt;</comment>
                            <comment id="13034399" author="yseeley@gmail.com" created="Mon, 16 May 2011 22:44:29 +0000"  >&lt;p&gt;Here&apos;s a patch w/ simple test.&lt;/p&gt;</comment>
                            <comment id="13034501" author="yseeley@gmail.com" created="Tue, 17 May 2011 02:14:59 +0000"  >&lt;p&gt;Committed to trunk and 3x.&lt;br/&gt;
Thanks for bringing this to our attention Benson!&lt;/p&gt;</comment>
                            <comment id="13043596" author="rcmuir" created="Fri, 3 Jun 2011 16:44:56 +0000"  >&lt;p&gt;Bulk close for 3.2&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12479399" name="SOLR-2520.patch" size="1946" author="yseeley@gmail.com" created="Mon, 16 May 2011 22:44:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5020</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03k9b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18715</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>