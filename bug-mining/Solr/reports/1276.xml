<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:34:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4526] Admin UI depends on optional system info</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4526</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;A user on IRC was having trouble getting file descriptor counts and JVM memory usage in the admin UI, but it worked perfectly fine on another system.  The problem system uses OpenJDK, the other one uses the Apple JDK.  The user had tracked it down to an exception while trying to get open file descriptor info.&lt;/p&gt;

&lt;p&gt;Looking in the SystemInfoHandler.java file, I see a comment reference to com.sun.management.UnixOperatingSystemMXBean at the point where it is getting file descriptor info.  A little extra searching turned up &lt;a href=&quot;https://issues.apache.org/jira/browse/ZOOKEEPER-1579&quot; title=&quot;Compile error of UnixOperationSystemMXBean with open JDK&quot; class=&quot;issue-link&quot; data-issue-key=&quot;ZOOKEEPER-1579&quot;&gt;ZOOKEEPER-1579&lt;/a&gt; which refers to &lt;a href=&quot;https://issues.apache.org/jira/browse/HBASE-6945&quot; title=&quot;Compilation errors when using non-Sun JDKs to build HBase-0.94&quot; class=&quot;issue-link&quot; data-issue-key=&quot;HBASE-6945&quot;&gt;&lt;del&gt;HBASE-6945&lt;/del&gt;&lt;/a&gt;, the same problem with OpenJDK.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Oracle Corporation OpenJDK 64-Bit Server VM (1.7.0_15 23.7-b01)&lt;/p&gt;</environment>
        <key id="12635165">SOLR-4526</key>
            <summary>Admin UI depends on optional system info</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="steffkes">Stefan Matheis</assignee>
                                    <reporter username="elyograg">Shawn Heisey</reporter>
                        <labels>
                    </labels>
                <created>Mon, 4 Mar 2013 17:45:45 +0000</created>
                <updated>Thu, 16 Feb 2017 15:55:32 +0000</updated>
                            <resolved>Tue, 5 Mar 2013 15:03:28 +0000</resolved>
                                    <version>4.1</version>
                                    <fixVersion>4.2</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>Admin UI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13592519" author="elyograg" created="Mon, 4 Mar 2013 19:15:18 +0000"  >&lt;p&gt;If File descriptor info just isn&apos;t available in OpenJDK, then that is life.  The file descriptor problem seems to be causing another problem - the JVM memory info isn&apos;t showing up on the dashboard.  I haven&apos;t looked at the code yet, and I don&apos;t know javascript very well, but the user suspects that when the file descriptor info is not found, it causes the code that puts the JVM memory info together to be skipped.&lt;/p&gt;</comment>
                            <comment id="13592553" author="hossman" created="Mon, 4 Mar 2013 19:42:13 +0000"  >&lt;p&gt;I&apos;m confused: SystemInfoHandler doesn&apos;t directly depend on UnixOperatingSystemMXBean, it uses reflection to ensure that it only calls methods on the OperatingSystemMXBean if they already exist &amp;#8211; so even if it isn&apos;t a sun JVM, or isn&apos;t an UnixOperatingSystemMXBean instance, or is an older version of UnixOperatingSystemMXBean that doesn&apos;t have some of those methods, it still shouldn&apos;t be an error &amp;#8211; at worst those properties just won&apos;t be included in the response.&lt;/p&gt;

&lt;p&gt;perhaps the problem is just that that admin UI Javascript assumes those properties will always be available? (but that wouldn&apos;t explain the comment about &quot;tracked it down to an exception while trying to get open file descriptor info&quot;)&lt;/p&gt;

&lt;p&gt;can anyone who can actually reproduce this problem please post the specifics of the exception they see, or the behavior they see in the admin ui (ie: screenshot)&lt;/p&gt;</comment>
                            <comment id="13592581" author="elyograg" created="Mon, 4 Mar 2013 20:09:55 +0000"  >&lt;p&gt;I think perhaps I was a little too aggressive in framing this issue.  I should have scaled it back a little bit to focus on the UI issue, not the java classes.  The title may need changing, and it may require filing another issue.  I see two problems.  With OpenJDK, the file descriptor info and the JVM memory info are not showing on the dashboard.  Side note: I don&apos;t have OpenJDK running anywhere and don&apos;t have unallocated hardware I can fiddle with right now.&lt;/p&gt;

&lt;p&gt;The underlying issue is that the user says the file descriptor info is not found in /admin/system output running under OpenJDK, but it is there under Apple or Oracle JVMs.  If the info is available at all from OpenJDK, it may require a code change to get it.&lt;/p&gt;

&lt;p&gt;The java issue is triggering a javascript issue.  An educated guess is that the code that populates the file descriptor bar is failing and causing the JVM memory bar calculation (JVM memory info is available in /admin/system) to be skipped entirely.  A simple fix for that issue would be to re-order the javascript code so that jvm memory is done before the file descriptor.  A better fix would be to make sure that a nonexistent piece of information doesn&apos;t cause problems.&lt;/p&gt;

&lt;p&gt;I&apos;m very weak in both javascript and java reflection, or I would have already tried to come up with patches.&lt;/p&gt;</comment>
                            <comment id="13592597" author="elyograg" created="Mon, 4 Mar 2013 20:22:10 +0000"  >&lt;p&gt;Additional note from the user on IRC: I adjusted the live server config to run the solr built-in jetty and now all the stats are showing up, even on openjdk, so the issue seems to be with older jetty versions.&lt;/p&gt;</comment>
                            <comment id="13592616" author="felixbuenemann" created="Mon, 4 Mar 2013 20:49:39 +0000"  >&lt;p&gt;The problem turned out to be jetty6 vs. jetty8 and not OpenJDK. The dev system was running Solr&apos;s built-in jetty, while the production system was running the jetty version that was shipping with Ubuntu 12.04 Server. I noticed this after building a VM to simulate the problem with the closed Oracle JDK7 and encountered the same behavior.&lt;/p&gt;

&lt;p&gt;I&apos;m attaching two screenshots to show the problem.&lt;/p&gt;</comment>
                            <comment id="13592629" author="felixbuenemann" created="Mon, 4 Mar 2013 20:56:58 +0000"  >&lt;p&gt;Screenshots illustrating the problem. The JVM values are only empty because of an exception in index.js, which was looking for the missing keys &apos;maxFileDescriptorCount&apos; and &apos;openFileDescriptorCount&apos; in system_data&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;system&amp;#39;&amp;#93;&lt;/span&gt;.&lt;/p&gt;</comment>
                            <comment id="13592638" author="hossman" created="Mon, 4 Mar 2013 21:06:27 +0000"  >&lt;p&gt;Felix: can you confirm no errors in the server logs, just javacsript was having problems from the null keys?&lt;/p&gt;

&lt;p&gt;asigning to steffkes in the hopes that he can take a look &amp;#8211; but based on the screen shot i&apos;m not really sure what if anything it could do better in a situation like this &amp;#8211; if the values aren&apos;t available from the JVM, showing &quot;blank&quot; bar sharts seems as good an option as any ... i guess maybe labeling them with &quot;?&quot; could be a little better though.&lt;/p&gt;</comment>
                            <comment id="13592648" author="felixbuenemann" created="Mon, 4 Mar 2013 21:17:10 +0000"  >&lt;p&gt;Hoss: I&apos;ll try to get my VM back into the prober state and check it.&lt;/p&gt;

&lt;p&gt;Regarding what the JS could do better: It would be a good idea to check if the accessed array keys are undefined, to avoid an exception. This would make the JS code more verbose though.&lt;br/&gt;
Had the code checked for undefined values, it would have shown the JVM usage just fine.&lt;/p&gt;</comment>
                            <comment id="13592661" author="felixbuenemann" created="Mon, 4 Mar 2013 21:36:23 +0000"  >&lt;p&gt;Hoss: Solr is not logging any errors. I&apos;ve tried with logging for solr and children set to INFO.&lt;/p&gt;</comment>
                            <comment id="13592685" author="thetaphi" created="Mon, 4 Mar 2013 21:55:05 +0000"  >&lt;p&gt;The general problem here is the admin UI, as mentioned by Felix. The output of the MX data is very JVM-specific, so the UI should not rely on key/value pairs are always available. If you e.g. start Solr with IBM J9, the whole Andmin UI shows nothing at all for those statistics, same for JRockit. If you look into browser JS logs you see errors about missing keys.&lt;/p&gt;

&lt;p&gt;The RequestHandler on the Solr side is fine and produces no log entries. Because of that you will see no errors in the log file, as the UI cannot log anything to the Solr log.&lt;/p&gt;

&lt;p&gt;The reason why the Ubuntu-Jetty does not display those information might be because the Webapp context is restricted and does not provide the OS-MXBean. The Jetty included with Solr has no security settings at all and the webapp is running in the root context.&lt;/p&gt;</comment>
                            <comment id="13593254" author="felixbuenemann" created="Tue, 5 Mar 2013 09:25:18 +0000"  >&lt;p&gt;I could provide a patch against index.js to remove the hard dependencies, if there is consensus that this data should not be relied on. However it needs to be decided what to display in this case (eg. hide the bar, show &quot;Data not available&quot;, ...).&lt;/p&gt;</comment>
                            <comment id="13593269" author="thetaphi" created="Tue, 5 Mar 2013 09:51:26 +0000"  >&lt;p&gt;You cannot rely on this data because it is very JVM specific, so we have to handle it proper. As said before, IBJ J9 and Oracle JRockit fail to display anything in that area (because of the bugs in index.js).&lt;/p&gt;</comment>
                            <comment id="13593338" author="felixbuenemann" created="Tue, 5 Mar 2013 11:31:34 +0000"  >&lt;p&gt;The attached patch against trunk makes the dashboard js code less reliant on provided system and jvm data by checking for their existance. It also improves the matching of load average among operating systems (should now work with Linux, Mac OS X, *BSD, Irix, etc.)&lt;/p&gt;

&lt;p&gt;The patch should also apply cleanly against 4.1.0 with minor offset.&lt;/p&gt;</comment>
                            <comment id="13593339" author="felixbuenemann" created="Tue, 5 Mar 2013 11:33:00 +0000"  >&lt;p&gt;Btw. if desired I can split out the changes to loadaverage matching into a different patch/ticket, but steffkes said on IRC it&apos;d be ok to include.&lt;/p&gt;</comment>
                            <comment id="13593343" author="thetaphi" created="Tue, 5 Mar 2013 11:39:09 +0000"  >&lt;blockquote&gt;&lt;p&gt;The patch should also apply cleanly against 4.1.0 with minor offset.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s not an issue, as we merge using SVN tools. Patches are only applied to trunk.&lt;/p&gt;</comment>
                            <comment id="13593355" author="felixbuenemann" created="Tue, 5 Mar 2013 12:04:53 +0000"  >&lt;p&gt;Updated the patch, because the previous version contained a copy&apos;n&apos;paste error, causing jvm memory info to always be hidden.&lt;/p&gt;</comment>
                            <comment id="13593461" author="commit-tag-bot" created="Tue, 5 Mar 2013 15:12:14 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Stefan Matheis&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1452835&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1452835&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4526&quot; title=&quot;Admin UI depends on optional system info&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4526&quot;&gt;&lt;del&gt;SOLR-4526&lt;/del&gt;&lt;/a&gt;: Admin UI depends on optional system info&lt;/p&gt;</comment>
                            <comment id="13593491" author="commit-tag-bot" created="Tue, 5 Mar 2013 15:42:13 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Stefan Matheis&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1452838&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1452838&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4526&quot; title=&quot;Admin UI depends on optional system info&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4526&quot;&gt;&lt;del&gt;SOLR-4526&lt;/del&gt;&lt;/a&gt;: Admin UI depends on optional system info (merge r1452835)&lt;/p&gt;</comment>
                            <comment id="13654292" author="thetaphi" created="Fri, 10 May 2013 10:34:40 +0000"  >&lt;p&gt;Closed after release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12610349">HBASE-6945</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12615286">ZOOKEEPER-1579</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12572082" name="SOLR-4526.patch" size="4134" author="felixbuenemann" created="Tue, 5 Mar 2013 12:04:53 +0000"/>
                            <attachment id="12571957" name="built-in-jetty8.png" size="132198" author="felixbuenemann" created="Mon, 4 Mar 2013 20:56:58 +0000"/>
                            <attachment id="12571956" name="ubuntu-jetty6.png" size="157310" author="felixbuenemann" created="Mon, 4 Mar 2013 20:56:58 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>315658</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1igx3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>316001</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>