<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:32:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2890] omitTermFreqAndPositions and omitNorms don&apos;t work properly when used on fieldTypes</title>
                <link>https://issues.apache.org/jira/browse/SOLR-2890</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Setting omitTermFreqAndPositions=&quot;true&quot; doesn&apos;t work when I put it on a fieldType definition for my text field.  It did work when I put it on the field definition.  I think this option and probably all options should be settable at the fieldType level.  I did some investigation and found that the value of this option was being reset on line 54 of TextField.&lt;/p&gt;

&lt;p&gt;FYI I am trying to put this on a field type for use by the SpellCheck component which has no use for term frequencies and positions from the source field.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12531093">SOLR-2890</key>
            <summary>omitTermFreqAndPositions and omitNorms don&apos;t work properly when used on fieldTypes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="dsmiley">David Smiley</reporter>
                        <labels>
                    </labels>
                <created>Fri, 11 Nov 2011 04:06:29 +0000</created>
                <updated>Mon, 9 May 2016 18:48:19 +0000</updated>
                            <resolved>Fri, 30 Nov 2012 20:34:40 +0000</resolved>
                                    <version>3.4</version>
                                    <fixVersion>4.1</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>Schema and Analysis</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13495717" author="petdance" created="Mon, 12 Nov 2012 22:51:40 +0000"  >&lt;p&gt;I believe this is a Bug, not an Improvement, and that it is not Minor.&lt;/p&gt;

&lt;p&gt;The docs at &lt;a href=&quot;http://wiki.apache.org/solr/SchemaXml&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/solr/SchemaXml&lt;/a&gt; explicitly state that &quot;Common options that field types can have are...&quot; and lists omitTermFreqAndPositions.&lt;/p&gt;

&lt;p&gt;In my case, I created a custom type for ISBNs specified like so:&lt;/p&gt;

&lt;p&gt;        &amp;lt;fieldType name=&quot;isbn&quot; class=&quot;solr.TextField&quot; stored=&quot;true&quot; sortMissingLast=&quot;true&quot; omitNorms=&quot;true&quot; omitTermFreqAndPositions=&quot;true&quot;&amp;gt;&lt;br/&gt;
            &amp;lt;analyzer&amp;gt;&lt;br/&gt;
                &amp;lt;!-- Remove anything not a digit or X --&amp;gt;&lt;br/&gt;
                &amp;lt;charFilter class=&quot;solr.PatternReplaceCharFilterFactory&quot;&lt;br/&gt;
                    pattern=&quot;&lt;span class=&quot;error&quot;&gt;&amp;#91;^0-9Xx&amp;#93;&lt;/span&gt;&quot;&lt;br/&gt;
                    replacement=&quot;&quot;&lt;br/&gt;
                    replace=&quot;all&quot;&lt;br/&gt;
                    /&amp;gt;&lt;br/&gt;
                &amp;lt;tokenizer class=&quot;solr.KeywordTokenizerFactory&quot; /&amp;gt;&lt;br/&gt;
                &amp;lt;filter class=&quot;solr.LowerCaseFilterFactory&quot;/&amp;gt;&lt;br/&gt;
            &amp;lt;/analyzer&amp;gt;&lt;br/&gt;
        &amp;lt;/fieldType&amp;gt;&lt;/p&gt;


&lt;p&gt;with the field definition like so:&lt;/p&gt;

&lt;p&gt;        &amp;lt;field name=&quot;isbn&quot; type=&quot;isbn&quot; omitTermFreqAndPositions=&quot;true&quot; multiValued=&quot;true&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;It was surprising, then, to find that my core&apos;s index directory had 600MB of *.prx files, when there should not be any position information anywhere in the core.&lt;/p&gt;

&lt;p&gt;When I then updated the field definition to:&lt;/p&gt;

&lt;p&gt;        &amp;lt;field name=&quot;isbn&quot; type=&quot;isbn&quot; omitTermFreqAndPositions=&quot;true&quot; multiValued=&quot;true&quot; /&amp;gt;&lt;/p&gt;

&lt;p&gt;and reindexed the core, the *.prx files were no longer created.&lt;/p&gt;

&lt;p&gt;Based on David Smiley&apos;s reading of the code at in TextField.java, the culprit seems to be:&lt;/p&gt;

&lt;p&gt;    if (schema.getVersion()&amp;gt; 1.1f) properties &amp;amp;= ~OMIT_TF_POSITIONS;&lt;/p&gt;

&lt;p&gt;which is at least reassuring that omitNorms and omitPositions seem to be unchanged.&lt;/p&gt;

&lt;p&gt;The fix to this could be as simple as changing the wiki to state that omitTermFreqAndPositions must be specified at the field level.&lt;/p&gt;</comment>
                            <comment id="13495945" author="dsmiley" created="Tue, 13 Nov 2012 04:39:57 +0000"  >&lt;p&gt;--then change the wiki &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;But this is still a problem, sure.  It&apos;s &quot;minor&quot; because the work-around is trivial.&lt;/p&gt;

&lt;p&gt;Minor aside:  You should use a regex at the TokenFilter level, not the CharFilter.  It&apos;s a bit slower at the CharFilter and there might be problems with highlighting if you use the regex to change the field length.  CharFilters are designed to work in advance of the Tokenizer when you need to modify what the Tokenizer sees.  There will never be such a problem with KeywordTokenizer.&lt;/p&gt;</comment>
                            <comment id="13497520" author="yseeley@gmail.com" created="Wed, 14 Nov 2012 22:09:04 +0000"  >&lt;p&gt;IIRC, I think the intent was to exclude positions by default for all the field types that didn&apos;t need them (except for text field which by default would).&lt;br/&gt;
If the option is set on a fieldType, it should become the default for any fields using that fieldType.&lt;/p&gt;</comment>
                            <comment id="13506198" author="hossman" created="Thu, 29 Nov 2012 04:03:39 +0000"  >&lt;p&gt;This seems like a really bad bug for two reasons:&lt;/p&gt;

&lt;p&gt;1) even if there is a trivial work around, it&apos;s the kind of thing that most users aren&apos;t going to be savvy enough to even realize isn&apos;t working properly (ie: it has no obvious &quot;ERROR&quot;) ... you really have to go out of your way to discover that the extra data is in your index even though you asked for it not to be.&lt;/p&gt;

&lt;p&gt;2) it appears to have been broken for years and yet none of the tests anyone has written in that time have managed to tickle it to make any one notice.&lt;/p&gt;

&lt;p&gt;So i spent a bit of time trying to write an exhaustive test of the way all the diff version specific default props work, to prove that the defaults did what they should, and that overriding them did what it should &amp;#8211; which lead me to discover there is a similar problem with omitNorms on fieldTYpes.&lt;/p&gt;

&lt;p&gt;I&apos;m updating the summary to note this for future searchers, and i&apos;ll attach my patch with test and fixes for review&lt;/p&gt;
</comment>
                            <comment id="13506199" author="hossman" created="Thu, 29 Nov 2012 04:04:00 +0000"  >&lt;p&gt;patch with fix &amp;amp; tests&lt;/p&gt;</comment>
                            <comment id="13506206" author="dsmiley" created="Thu, 29 Nov 2012 04:32:58 +0000"  >&lt;p&gt;+1 Great work Hoss!  I&apos;m sure developing that test was non-trivial.&lt;/p&gt;</comment>
                            <comment id="13507618" author="commit-tag-bot" created="Fri, 30 Nov 2012 20:04:14 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Chris M. Hostetter&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415817&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415817&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2890&quot; title=&quot;omitTermFreqAndPositions and omitNorms don&amp;#39;t work properly when used on fieldTypes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2890&quot;&gt;&lt;del&gt;SOLR-2890&lt;/del&gt;&lt;/a&gt;: Fixed a bug that prevented omitNorms and omitTermFreqAndPositions options from being respected in some &amp;lt;fieldType/&amp;gt; declarations&lt;/p&gt;
</comment>
                            <comment id="13507630" author="commit-tag-bot" created="Fri, 30 Nov 2012 20:30:22 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Chris M. Hostetter&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415837&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415837&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2890&quot; title=&quot;omitTermFreqAndPositions and omitNorms don&amp;#39;t work properly when used on fieldTypes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2890&quot;&gt;&lt;del&gt;SOLR-2890&lt;/del&gt;&lt;/a&gt;: Fixed a bug that prevented omitNorms and omitTermFreqAndPositions options from being respected in some &amp;lt;fieldType/&amp;gt; declarations (merge r1415817)&lt;/p&gt;
</comment>
                            <comment id="13610481" author="commit-tag-bot" created="Fri, 22 Mar 2013 16:12:42 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Chris M. Hostetter&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415837&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415837&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2890&quot; title=&quot;omitTermFreqAndPositions and omitNorms don&amp;#39;t work properly when used on fieldTypes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2890&quot;&gt;&lt;del&gt;SOLR-2890&lt;/del&gt;&lt;/a&gt;: Fixed a bug that prevented omitNorms and omitTermFreqAndPositions options from being respected in some &amp;lt;fieldType/&amp;gt; declarations (merge r1415817)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12392783">SOLR-523</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12555313" name="SOLR-2890.patch" size="18356" author="hossman" created="Thu, 29 Nov 2012 04:04:00 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>216831</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03hy7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18341</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>