<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:09:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-8288] DistributedUpdateProcessor#doFinish should explicitly check and ensure it does not try to put itself into LIR.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-8288</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;We have to be careful about this because currently, something like a commit is sent over http even to the local node and if that fails for some reason, the leader might try and LIR itself.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12912834">SOLR-8288</key>
            <summary>DistributedUpdateProcessor#doFinish should explicitly check and ensure it does not try to put itself into LIR.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="markrmiller@gmail.com">Mark Miller</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Nov 2015 14:09:03 +0000</created>
                <updated>Mon, 9 May 2016 18:51:35 +0000</updated>
                            <resolved>Fri, 13 Nov 2015 22:09:44 +0000</resolved>
                                                    <fixVersion>5.4</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15004019" author="markrmiller@gmail.com" created="Fri, 13 Nov 2015 14:09:53 +0000"  >&lt;p&gt;First patch.&lt;/p&gt;</comment>
                            <comment id="15004209" author="mdrob" created="Fri, 13 Nov 2015 16:26:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;+        if (leaderCoreNodeName != null &amp;amp;&amp;amp; cloudDesc.getCoreNodeName().equals(leaderCoreNodeName) // we are still same leader&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;This null check is not necessary.&lt;/p&gt;


&lt;p&gt;Is it worth adding a test where a node tries to put itself into recovery? Not sure if that&apos;s something that is actually possible to stub out.&lt;/p&gt;</comment>
                            <comment id="15004246" author="markrmiller@gmail.com" created="Fri, 13 Nov 2015 16:42:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;This null check is not necessary.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I was originally trying to use leaderCoreNodeName for the identity check, in which case you do need the null check. I switched to using the core url for the check, but I have left this null check in - I find it makes it much more explicit that that variable can be null here, rather than just counting on the fact that the equals method will handle the null how we want.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is it worth adding a test where a node tries to put itself into recovery?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If you can add a test for this, it would be nice to have, but I don&apos;t see a good way to do it without some invasive ugly code. It should probably spin out into it&apos;s own JIRA unless something can be done quickly.&lt;/p&gt;</comment>
                            <comment id="15004456" author="mdrob" created="Fri, 13 Nov 2015 18:29:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;If you can add a test for this, it would be nice to have, but I don&apos;t see a good way to do it without some invasive ugly code. It should probably spin out into it&apos;s own JIRA unless something can be done quickly.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yea, I don&apos;t see an immediately apparent way to do this. Was hoping you knew something I didn&apos;t. Filed &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8289&quot; title=&quot;Add a test that verifies a core cannot put itself into LIR&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8289&quot;&gt;SOLR-8289&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15004792" author="jira-bot" created="Fri, 13 Nov 2015 22:07:15 +0000"  >&lt;p&gt;Commit 1714271 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1714271&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1714271&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8288&quot; title=&quot;DistributedUpdateProcessor#doFinish should explicitly check and ensure it does not try to put itself into LIR.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8288&quot;&gt;&lt;del&gt;SOLR-8288&lt;/del&gt;&lt;/a&gt;: DistributedUpdateProcessor#doFinish should explicitly check and ensure it does not try to put itself into LIR.&lt;/p&gt;</comment>
                            <comment id="15004795" author="jira-bot" created="Fri, 13 Nov 2015 22:09:19 +0000"  >&lt;p&gt;Commit 1714272 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1714272&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1714272&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8288&quot; title=&quot;DistributedUpdateProcessor#doFinish should explicitly check and ensure it does not try to put itself into LIR.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8288&quot;&gt;&lt;del&gt;SOLR-8288&lt;/del&gt;&lt;/a&gt;: DistributedUpdateProcessor#doFinish should explicitly check and ensure it does not try to put itself into LIR.&lt;/p&gt;</comment>
                            <comment id="15004799" author="mdrob" created="Fri, 13 Nov 2015 22:10:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;+            &amp;amp;&amp;amp; !stdNode.getNodeProps().getCoreUrl().equals(leaderProps.getCoreUrl())) { // we do not want to put ourself into LIR&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If we are comparing URLs, then would it make sense to check against the &lt;a href=&quot;https://github.com/apache/lucene-solr/blob/eab11f7fe242710216786db70814a0f492342b38/solr/core/src/java/org/apache/solr/update/processor/DistributedUpdateProcessor.java#L824&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;replicaURL&lt;/a&gt; that we saw the error on? &lt;/p&gt;

&lt;p&gt;&lt;tt&gt;replicaUrl.equals(leaderProps.getCoreUrl())&lt;/tt&gt; instead?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12912925">SOLR-8289</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12772206" name="SOLR-8288.patch" size="3592" author="markrmiller@gmail.com" created="Fri, 13 Nov 2015 14:09:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 1 week, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2oczz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>