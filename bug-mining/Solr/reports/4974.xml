<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:52:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16099] HTTP Client threads can hang in Jetty&apos;s InputStreamResponseListener when using HTTP2 - impacts intra-node communication</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16099</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;There apearrs to be a Jetty HttpClient bug that makes it possible for a request thread to hang indefinitely while waiting to parse the response from remote jetty servers. The cause of the hung thread is because it calls &lt;tt&gt;.wait()&lt;/tt&gt; on monitor lock that &lt;em&gt;should&lt;/em&gt; be notified by another (internal jetty client) thread when a chunk of data is available from the wire &#8211; but in some cases this evidently may not happen.&lt;/p&gt;

&lt;p&gt;In the case of &lt;tt&gt;distrib=true&lt;/tt&gt; requests processed by Solr (aggregating multiple per-shard responses from other nodes) this can manifest with stack traces that look like the following (taken from Solr 8.8.2)...&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; &quot;thread&quot;,{
   &quot;id&quot;:14253,
   &quot;name&quot;:&quot;httpShardExecutor-7-thread-13819-...&quot;,
   &quot;state&quot;:&quot;WAITING&quot;,
   &quot;lock&quot;:&quot;org.eclipse.jetty.client.util.InputStreamResponseListener@12b59075&quot;,
   &quot;lock-waiting&quot;:{
     &quot;name&quot;:&quot;org.eclipse.jetty.client.util.InputStreamResponseListener@12b59075&quot;,
     &quot;owner&quot;:null},
   &quot;synchronizers-locked&quot;:[&quot;java.util.concurrent.ThreadPoolExecutor$Worker@1ec1aed0&quot;],
   &quot;cpuTime&quot;:&quot;65.4882ms&quot;,
   &quot;userTime&quot;:&quot;60.0000ms&quot;,
   &quot;stackTrace&quot;:[&quot;java.base@11.0.14/java.lang.Object.wait(Native Method)&quot;,
     &quot;java.base@11.0.14/java.lang.Object.wait(Unknown Source)&quot;,
     &quot;org.eclipse.jetty.client.util.InputStreamResponseListener$Input.read(InputStreamResponseListener.java:318)&quot;,
     &quot;org.apache.solr.common.util.FastInputStream.readWrappedStream(FastInputStream.java:90)&quot;,
     &quot;org.apache.solr.common.util.FastInputStream.refill(FastInputStream.java:99)&quot;,
     &quot;org.apache.solr.common.util.FastInputStream.readByte(FastInputStream.java:217)&quot;,
     &quot;org.apache.solr.common.util.JavaBinCodec._init(JavaBinCodec.java:211)&quot;,
     &quot;org.apache.solr.common.util.JavaBinCodec.initRead(JavaBinCodec.java:202)&quot;,
     &quot;org.apache.solr.common.util.JavaBinCodec.unmarshal(JavaBinCodec.java:195)&quot;,
     &quot;org.apache.solr.client.solrj.impl.BinaryResponseParser.processResponse(BinaryResponseParser.java:51)&quot;,
     &quot;org.apache.solr.client.solrj.impl.Http2SolrClient.processErrorsAndResponse(Http2SolrClient.java:696)&quot;,
     &quot;org.apache.solr.client.solrj.impl.Http2SolrClient.request(Http2SolrClient.java:412)&quot;,
     &quot;org.apache.solr.client.solrj.impl.Http2SolrClient.request(Http2SolrClient.java:761)&quot;,
     &quot;org.apache.solr.client.solrj.impl.LBSolrClient.doRequest(LBSolrClient.java:369)&quot;,
     &quot;org.apache.solr.client.solrj.impl.LBSolrClient.request(LBSolrClient.java:297)&quot;,
     &quot;org.apache.solr.handler.component.HttpShardHandlerFactory.makeLoadBalancedRequest(HttpShardHandlerFactory.java:371)&quot;,
     &quot;org.apache.solr.handler.component.ShardRequestor.call(ShardRequestor.java:132)&quot;,
     &quot;org.apache.solr.handler.component.ShardRequestor.call(ShardRequestor.java:41)&quot;,
     &quot;java.base@11.0.14/java.util.concurrent.FutureTask.run(Unknown Source)&quot;,
     &quot;java.base@11.0.14/java.util.concurrent.Executors$RunnableAdapter.call(Unknown Source)&quot;,
     &quot;java.base@11.0.14/java.util.concurrent.FutureTask.run(Unknown Source)&quot;,
     &quot;com.codahale.metrics.InstrumentedExecutorService$InstrumentedRunnable.run(InstrumentedExecutorService.java:180)&quot;,
     &quot;org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:218)&quot;,
     &quot;org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor$$Lambda$175/0x0000000840243c40.run(Unknown Source)&quot;,
     &quot;java.base@11.0.14/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source)&quot;,
     &quot;java.base@11.0.14/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source)&quot;,
     &quot;java.base@11.0.14/java.lang.Thread.run(Unknown Source)&quot;]},
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;...these &lt;tt&gt;httpShardExecutor&lt;/tt&gt; threads can stay hung, tying up system resources, indefinitely (unless they get a spuriuos &lt;tt&gt;notify()&lt;/tt&gt; from the JVM). (In once case, it seems to have caused a request to hang for &lt;b&gt;10.3 hours&lt;/b&gt;)&lt;/p&gt;

&lt;p&gt;Anecdotally:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;There is some evidence that this problem did &lt;em&gt;&lt;b&gt;NOT&lt;/b&gt;&lt;/em&gt; affect Solr 8.6.3, but does affect later versions
	&lt;ul&gt;
		&lt;li&gt;suggesting the bug didn&apos;t exist in Jetty until &lt;em&gt;after&lt;/em&gt; 9.4.27.v20200227&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Forcing the Jetty HttpClient to use HTTP1.1 transport seems to prevent this problem from happening
	&lt;ul&gt;
		&lt;li&gt;In Solr this can be done by setting the &lt;tt&gt;&quot;solr.http1&quot;&lt;/tt&gt; system property&lt;/li&gt;
		&lt;li&gt;Or using the &lt;tt&gt;Http2SolrClient.Builder.useHttp1_1()&lt;/tt&gt; method in client application code&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13433740">SOLR-16099</key>
            <summary>HTTP Client threads can hang in Jetty&apos;s InputStreamResponseListener when using HTTP2 - impacts intra-node communication</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="krisden">Kevin Risden</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Mon, 14 Mar 2022 23:21:27 +0000</created>
                <updated>Fri, 17 Oct 2025 20:05:38 +0000</updated>
                            <resolved>Mon, 12 Dec 2022 16:55:37 +0000</resolved>
                                                    <fixVersion>9.2</fixVersion>
                    <fixVersion>10.0</fixVersion>
                                    <component>Server</component>
                    <component>SolrCloud</component>
                    <component>SolrJ</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>9</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="17506622" author="hossman" created="Mon, 14 Mar 2022 23:25:03 +0000"  >&lt;p&gt;I&apos;m filing this issue for tracking purposes and to raise visibility of the symptoms and workaround - I don&apos;t know if/how it can be &quot;fixed&quot; in Solr.&lt;/p&gt;

&lt;p&gt;This popped up for me when dealing with a customer who noticed they were running out of disk on nodes hosting PULL replicas of large collection that were getting lots of document updates. The hung threads were holding &lt;tt&gt;SolrIndexSearcher&lt;/tt&gt; references, which had open file handles to segments that were no longer in use by the &quot;current&quot; index but couldn&apos;t be overwritten by the filesystem because of the open file handles).&lt;/p&gt;

&lt;p&gt;This problem could manifest in other ways for other people &#8211; the most likely (beyond the obvious failure or &quot;slow&quot; request metrics) being high memory usage as these threads and the object they hold references to taking up Heap space indefinitely.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;While investigating open jetty issues that might pertain to this, I discovered that Ishan &amp;amp; Noble have apparently &lt;a href=&quot;https://github.com/fullstorydev/lucene-solr/pull/121&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;been aware of this problem&lt;/a&gt; &lt;a href=&quot;https://github.com/fullstorydev/lucene-solr/pull/106&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;for a while&lt;/a&gt;, and already have &lt;a href=&quot;https://github.com/eclipse/jetty.project/issues/7192&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;an open ticket with the Jetty project (#7192)&lt;/a&gt; regarding these symptoms.&lt;/p&gt;

&lt;p&gt;(Ishan alluded to this problem in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15840&quot; title=&quot;Performance degradation with Http2 client&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15840&quot;&gt;SOLR-15840&lt;/a&gt;, but that Jira is a general &quot;Task&quot; regarding questions about the performance of HTTP2 in Solr, that doesn&apos;t explicitly call out that this &quot;Bug&quot; exists and can hang threads - hence I&apos;ve opened this new Jira.)&lt;/p&gt;

&lt;p&gt;So far the only known &lt;a href=&quot;https://github.com/eclipse/jetty.project/issues/7192#issuecomment-989727192&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;steps to reliably reproduce&lt;/a&gt; are fairly onerous (they crashed my machine while attempting to run them) which makes it hard to easily identify a root cause, but the &lt;a href=&quot;https://github.com/eclipse/jetty.project/issues/7192#issuecomment-991068558&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;latest analysis from jetty dev&lt;/a&gt; &lt;tt&gt;sbordet&lt;/tt&gt; is...&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;We were able to get a failure, so we instrumented the client to understand why it was waiting, and found that it was waiting for a request whose headers arrived fine (with a 200 status code) but the client was waiting for the response body (no errors).&lt;/p&gt;

&lt;p&gt;We tried to track this request on the server logs, but we could not find any information.&lt;br/&gt;
Any attempt to increment the log level to DEBUG makes the failure non-reproducible, so we are a bit stuck trying to understand what&apos;s going on.&lt;/p&gt;

&lt;p&gt;From our point of view, the client received response headers and it&apos;s waiting for the content, but it never arrives.&lt;br/&gt;
We cannot explain how the response headers arrived, but not the content, but we don&apos;t have information about the server &#8211; whether there was an error on the server or similar, because the logs don&apos;t show any error.&lt;/p&gt;

&lt;p&gt;At this point I&apos;m throwing the ball in your court: are you sure that you are sending the response content?&lt;/p&gt;

&lt;p&gt;...&lt;/p&gt;

&lt;p&gt;If we can track the tcpdump and see that the HTTP/2 frames reach the client, then it&apos;s a Jetty client problem;&lt;br/&gt;
otherwise the server did not send the HTTP/2 frames and this could be either for a Jetty server problem, or because the application did not send any data.&lt;br/&gt;
In this way we&apos;re trying to restrict the problem.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The issue seems to have stalled out ~2 months ago while attempting to provide usable &lt;tt&gt;tcpdump&lt;/tt&gt; trace of the affected requests.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noblepaul&quot; class=&quot;user-hover&quot; rel=&quot;noblepaul&quot;&gt;noblepaul&lt;/a&gt; : Do you have any more info on this that you can share? If you can reliably reproduce this can you update the jetty ticket w/usable &lt;tt&gt;tcpdump&lt;/tt&gt; logs?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;One thing we may want to consider (in Solr) is replacing our usage of &lt;tt&gt;InputStreamResponseListener&lt;/tt&gt; with a variant implementation that uses a &quot;timeout&quot; instead of an unlimited &lt;tt&gt;wait()&lt;/tt&gt; (along the lines of a &lt;a href=&quot;https://github.com/eclipse/jetty.project/issues/7259&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;spin-off jetty enhancement issue&lt;/a&gt; one of the jetty devs filed). We could probably (with some effort) tweak the impacted Solr APIs to propogate the (remaining) &lt;tt&gt;timeAllowed&lt;/tt&gt; (if that option was specified) down to this class &#8211; and/or have an &quot;extreme&quot; default (ie: 30min) just to prevent threads from sticking around forever.&lt;/p&gt;</comment>
                            <comment id="17515004" author="hossman" created="Thu, 31 Mar 2022 00:58:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;One thing we may want to consider (in Solr) is replacing our usage of &lt;tt&gt;InputStreamResponseListener&lt;/tt&gt; with a variant implementation...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I created &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16129&quot; title=&quot;Solr specific InputStreamResponseListener to prevent client threads from hanging forever&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16129&quot;&gt;SOLR-16129&lt;/a&gt; to track this workaround/improvement.&lt;/p&gt;</comment>
                            <comment id="17604980" author="hossman" created="Wed, 14 Sep 2022 21:18:46 +0000"  >&lt;p&gt;FYI: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;a new &lt;a href=&quot;https://github.com/eclipse/jetty.project/issues/8558&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Jetty Issue#8558&lt;/a&gt; has been opened with a more isolated test case that has helped the jetty devs understand the root cause of this issue.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://github.com/eclipse/jetty.project/issues/7192&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;Jetty Issue#7192&lt;/a&gt; has been closed&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17621333" author="risdenk" created="Thu, 20 Oct 2022 19:31:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15955&quot; title=&quot;Update Jetty dependency to 10&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15955&quot;&gt;&lt;del&gt;SOLR-15955&lt;/del&gt;&lt;/a&gt; is trying to get to Jetty 10 - based on the commit in the fixed issue upstream - &lt;a href=&quot;https://github.com/eclipse/jetty.project/commit/dab4fe60d305416dd1d4dbd8da855e0482b63de9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/eclipse/jetty.project/commit/dab4fe60d305416dd1d4dbd8da855e0482b63de9&lt;/a&gt; isn&apos;t in Jetty 10.0.12 yet.&lt;/p&gt;</comment>
                            <comment id="17629060" author="houston" created="Fri, 4 Nov 2022 15:53:48 +0000"  >&lt;p&gt;Note, this is why some tests fail frequently, including &lt;tt&gt;TestDistributedStatsComponentCardinality&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="17631418" author="giantyang" created="Thu, 10 Nov 2022 03:18:26 +0000"  >&lt;p&gt;We have encountered similar problem:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.mail-archive.com/users@solr.apache.org/msg04497.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.mail-archive.com/users@solr.apache.org/msg04497.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17631723" author="elyograg" created="Thu, 10 Nov 2022 15:49:47 +0000"  >&lt;p&gt;I have two questions that I hope can be answered:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Could this be the cause of people getting &quot;Caused by: java.util.concurrent.RejectedExecutionException: Max requests queued per destination 3000 exceeded for HttpDestination&lt;a href=&quot;http://localhost:8983/]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;[http://localhost:8983&lt;/a&gt;@d368dfe,queue=3000,pool=MultiplexConnectionPool@3f16228[c=0/4/4,a=0,i=0,q=3000]&quot;?
	&lt;ul&gt;
		&lt;li&gt;That is a thread on the users list that I am looking at right now.&#160; I found another thread on the mailing list where they solved the same problem by switching the solr client to use http1.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Would the upcoming upgrade to Jetty 10 fix it?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17631813" author="risdenk" created="Thu, 10 Nov 2022 17:47:30 +0000"  >&lt;blockquote&gt;&lt;p&gt;Could this be the cause of people getting &quot;Caused by: java.util.concurrent.RejectedExecutionException: Max requests queued per destination 3000 exceeded for HttpDestination[http://localhost:8983@d368dfe,queue=3000,pool=MultiplexConnectionPool@3f16228[c=0/4/4,a=0,i=0,q=3000]&quot;?&lt;br/&gt;
That is a thread on the users list that I am looking at right now.  I found another thread on the mailing list where they solved the same problem by switching the solr client to use http1.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No idea to be honest. I know I&apos;ve seen that same max requests queued when you do load testing and open a connection per request since of sending requests over an existing connection. So the error message is not 100% clear what causes it.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Would the upcoming upgrade to Jetty 10 fix it?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;See comment above. &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15955&quot; title=&quot;Update Jetty dependency to 10&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15955&quot;&gt;&lt;del&gt;SOLR-15955&lt;/del&gt;&lt;/a&gt; is trying to get to Jetty 10 - based on the commit in the fixed issue upstream - &lt;a href=&quot;https://github.com/eclipse/jetty.project/commit/dab4fe60d305416dd1d4dbd8da855e0482b63de9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/eclipse/jetty.project/commit/dab4fe60d305416dd1d4dbd8da855e0482b63de9&lt;/a&gt; isn&apos;t in Jetty 10.0.12 yet.&lt;/p&gt;

&lt;p&gt;There isn&apos;t a Jetty 10.x (or 9.x) release with the fix as of yet.&lt;/p&gt;</comment>
                            <comment id="17632017" author="giantyang" created="Fri, 11 Nov 2022 01:41:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;Could this be the cause of people getting &quot;Caused by: java.util.concurrent.RejectedExecutionException: Max requests queued per destination 3000 exceeded for HttpDestination&lt;a href=&quot;http://localhost:8983/]&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;[http://localhost:8983&lt;/a&gt;@d368dfe,queue=3000,pool=MultiplexConnectionPool@3f16228[c=0/4/4,a=0,i=0,q=3000]&quot;?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;From our tests, such problems often occur in high stress tests.&lt;/p&gt;

&lt;p&gt;In the scenario with many shards, the coordination node will encounter this situation. If a timeout exception occurs in a shard, all shard requests will be interrupted, which will lead to some resource leakage.&lt;/p&gt;

&lt;p&gt;It is also related to the following issue&#160; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16229&quot; title=&quot;Interrupted searches exhaust connections of SolrJ HTTP/2 client&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16229&quot;&gt;&lt;del&gt;SOLR-16229&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17645481" author="risdenk" created="Fri, 9 Dec 2022 21:07:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.13&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/eclipse/jetty.project/releases/tag/jetty-10.0.13&lt;/a&gt; just released has &lt;a href=&quot;https://github.com/eclipse/jetty.project/commit/dab4fe60d305416dd1d4dbd8da855e0482b63de9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/eclipse/jetty.project/commit/dab4fe60d305416dd1d4dbd8da855e0482b63de9&lt;/a&gt; included.&lt;/p&gt;</comment>
                            <comment id="17646141" author="jira-bot" created="Mon, 12 Dec 2022 15:04:09 +0000"  >&lt;p&gt;Commit 7a96c5112b8544ddf0bc1c9ba5e80c4d1b454cd9 in solr&apos;s branch refs/heads/main from Kevin Risden&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=7a96c5112b8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=7a96c5112b8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16099&quot; title=&quot;HTTP Client threads can hang in Jetty&amp;#39;s InputStreamResponseListener when using HTTP2 - impacts intra-node communication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16099&quot;&gt;&lt;del&gt;SOLR-16099&lt;/del&gt;&lt;/a&gt;: Upgrade to Jetty 10.0.13 (#1230)&lt;/p&gt;
</comment>
                            <comment id="17646204" author="jira-bot" created="Mon, 12 Dec 2022 16:51:39 +0000"  >&lt;p&gt;Commit 4c54fffb8aa6e3937f3b127f33b4b6f38beadb9b in solr&apos;s branch refs/heads/branch_9x from Kevin Risden&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=4c54fffb8aa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=4c54fffb8aa&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16099&quot; title=&quot;HTTP Client threads can hang in Jetty&amp;#39;s InputStreamResponseListener when using HTTP2 - impacts intra-node communication&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16099&quot;&gt;&lt;del&gt;SOLR-16099&lt;/del&gt;&lt;/a&gt;: Upgrade to Jetty 10.0.13 (#1230)&lt;/p&gt;
</comment>
                            <comment id="17646210" author="risdenk" created="Mon, 12 Dec 2022 16:55:37 +0000"  >&lt;p&gt;I&apos;m going to mark this as resolved since the Jetty 10.0.13 upgrade has the fix for this. I commented on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16129&quot; title=&quot;Solr specific InputStreamResponseListener to prevent client threads from hanging forever&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16129&quot;&gt;SOLR-16129&lt;/a&gt; about the workaround that was never implemented.&lt;/p&gt;</comment>
                            <comment id="17646260" author="houston" created="Mon, 12 Dec 2022 18:15:55 +0000"  >&lt;p&gt;Thanks for getting this done so fast &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krisden&quot; class=&quot;user-hover&quot; rel=&quot;krisden&quot;&gt;krisden&lt;/a&gt;! I was following the release, but not as closely haha&lt;/p&gt;

&lt;p&gt;I&apos;m really excited to see how many of the flaky tests are &quot;fixed&quot; by this!&lt;/p&gt;</comment>
                            <comment id="17705489" author="houston" created="Mon, 27 Mar 2023 18:04:12 +0000"  >&lt;p&gt;Closing after the 9.2.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                            <outwardlinks description="incorporates">
                                        <issuelink>
            <issuekey id="13416157">SOLR-15840</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13436773">SOLR-16129</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13424820">SOLR-15955</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 33 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10h2o:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>