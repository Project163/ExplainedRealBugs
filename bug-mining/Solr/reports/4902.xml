<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:51:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16219] ICUCollationField tried to access protected field org.apache.solr.schema.IndexSchema.luceneVersion</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16219</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I&apos;ve tried to recreate Solr 8 configuration in Solr 9, but the following part in the config causes an error when creating core. (not SolrCould environment, if it matters)&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;fieldType name=&lt;span class=&quot;code-quote&quot;&gt;&quot;text_gen_sort&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.ICUCollationField&quot;&lt;/span&gt; locale=&quot;&quot; 
numeric=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; strength=&lt;span class=&quot;code-quote&quot;&gt;&quot;primary&quot;&lt;/span&gt; multiValued=&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; /&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The following paths has been added in the &lt;tt&gt;solrconfig.xml&lt;/tt&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;lib path=&lt;span class=&quot;code-quote&quot;&gt;&quot;..../solr/modules/analysis-extras/lib/solr-analysis-extras-9.0.0.jar&quot;&lt;/span&gt; /&amp;gt;
&amp;lt;lib path=&lt;span class=&quot;code-quote&quot;&gt;&quot;..../solr/modules/analysis-extras/lib/icu4j-68.2.jar&quot;&lt;/span&gt; /&amp;gt;
&amp;lt;lib path=&lt;span class=&quot;code-quote&quot;&gt;&quot;..../solr/modules/analysis-extras/lib/lucene-analysis-icu-9.0.0.jar&quot;&lt;/span&gt; /&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;and I checked, that the paths to jars are correct.&lt;/p&gt;

&lt;p&gt;The stack trace is lengthy, here the relevant part of it:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;h3&amp;gt;Caused by:&amp;lt;/h3&amp;gt;&amp;lt;pre&amp;gt;java.lang.IllegalAccessError: 
&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;org.apache.solr.schema.ICUCollationField tried to access
&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; field org.apache.solr.schema.IndexSchema.luceneVersion
(org.apache.solr.schema.ICUCollationField is in
unnamed module of loader java.net.FactoryURLClassLoader @61639b88;
org.apache.solr.schema.IndexSchema is in unnamed module of loader
org.eclipse.jetty.webapp.WebAppClassLoader @6a988392)
at org.apache.solr.schema.ICUCollationField.init(ICUCollationField.java:128)
at org.apache.solr.schema.FieldType.setArgs(FieldType.java:202)
at org.apache.solr.schema.FieldTypePluginLoader.init(FieldTypePluginLoader.java:149)
at org.apache.solr.schema.FieldTypePluginLoader.init(FieldTypePluginLoader.java:43)
at org.apache.solr.util.plugin.AbstractPluginLoader.load(AbstractPluginLoader.java:189)
at org.apache.solr.schema.IndexSchema.readSchema(IndexSchema.java:531)
at org.apache.solr.schema.IndexSchema.&amp;lt;init&amp;gt;(IndexSchema.java:188)
at org.apache.solr.schema.ManagedIndexSchema.&amp;lt;init&amp;gt;(ManagedIndexSchema.java:119)
at org.apache.solr.schema.ManagedIndexSchemaFactory.create(ManagedIndexSchemaFactory.java:279)
at org.apache.solr.schema.ManagedIndexSchemaFactory.create(ManagedIndexSchemaFactory.java:51)
at org.apache.solr.core.ConfigSetService.createIndexSchema(ConfigSetService.java:342)
at org.apache.solr.core.ConfigSetService.lambda$loadConfigSet$0(ConfigSetService.java:253)
at org.apache.solr.core.ConfigSet.&amp;lt;init&amp;gt;(ConfigSet.java:49)
at org.apache.solr.core.ConfigSetService.loadConfigSet(ConfigSetService.java:249)
at org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:1550)
at org.apache.solr.core.CoreContainer.create(CoreContainer.java:1426)
at org.apache.solr.handler.admin.CoreAdminOperation.lambda$&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt;$0(CoreAdminOperation.java:92)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Previous configuration with the same 3 libraries and the field type worked. I used &lt;tt&gt;bin/solr create_core -c my_core -d my_configset&lt;/tt&gt;. The change is in the &lt;tt&gt;managed-schema.xml&lt;/tt&gt;. (It used to be just &lt;tt&gt;manages-schema&lt;/tt&gt; in Solr 8, but I recreated the configuration from the new default.)&lt;/p&gt;

&lt;p&gt;This looks to me like some kind of a bug. What can be the cause of this and how to overcome the problem?&lt;/p&gt;

&lt;p&gt;(I&apos;ve also created SO question on this - &lt;a href=&quot;https://stackoverflow.com/questions/72416721/how-to-configure-icucollationfield-type-in-solr-9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/questions/72416721/how-to-configure-icucollationfield-type-in-solr-9&lt;/a&gt; )&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;To recreate, just add the above mentioned parts to solrconfig.xml and managed-schema.xml (from _default ) and try to create a core using the configset.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13447337">SOLR-16219</key>
            <summary>ICUCollationField tried to access protected field org.apache.solr.schema.IndexSchema.luceneVersion</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="magibney">Michael Gibney</assignee>
                                    <reporter username="Suzi">Roman</reporter>
                        <labels>
                    </labels>
                <created>Sat, 28 May 2022 15:37:35 +0000</created>
                <updated>Tue, 10 Jan 2023 20:45:32 +0000</updated>
                            <resolved>Wed, 21 Sep 2022 20:13:53 +0000</resolved>
                                    <version>9.0</version>
                                    <fixVersion>9.1</fixVersion>
                                    <component>Schema and Analysis</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="17543501" author="mgibney" created="Sat, 28 May 2022 17:31:10 +0000"  >&lt;p&gt;What JVM are you using?&lt;/p&gt;</comment>
                            <comment id="17543510" author="JIRAUSER290157" created="Sat, 28 May 2022 18:22:18 +0000"  >&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160;Private Build OpenJDK 64-Bit Server VM 13.0.7 13.0.7+5-Ubuntu-0ubuntu120.04&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17543520" author="elyograg" created="Sat, 28 May 2022 19:12:37 +0000"  >&lt;p&gt;Do you have more than one core loaded with the same &amp;lt;lib&amp;gt; config that adds those jars?&#160; If you do, that can cause serious problems with certain classes.&#160; I have seen something similar with another Lucene ICU class ... if the jar gets loaded more than once, then Java will throw class not found errors.&lt;/p&gt;

&lt;p&gt;One possible solution is to remove all the &amp;lt;lib&amp;gt; config from all the solrconfig.xml files you are using, create a &quot;lib&quot; subdirectory in your solr home location, and put all the extra jars that your Solr install needs in that location.&#160; Then restart Solr.&#160; They will be loaded exactly once, and all cores will be able to use them.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17543522" author="JIRAUSER290157" created="Sat, 28 May 2022 19:34:26 +0000"  >&lt;p&gt;The problem was with the very first core I&apos;ve tried to create, so it&apos;s something else.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I&apos;ve learned there is now SOLR_MODULES mechanism to add modules.&lt;/p&gt;

&lt;p&gt;However, adding&lt;/p&gt;

&lt;p&gt;SOLR_MODULES=extraction,analysis-extras&lt;/p&gt;

&lt;p&gt;in bin/sorl.in.sh as advised in the documentation leads to&lt;/p&gt;

&lt;p&gt;ERROR: Error CREATEing SolrCore &apos;test3&apos;: Unable to create core &lt;span class=&quot;error&quot;&gt;&amp;#91;test3&amp;#93;&lt;/span&gt; Caused by: solr.ICUCollationField&lt;/p&gt;

&lt;p&gt;In the analysis-extras README using solrconfig.xml is still being advised. I have not found any documentation on how to add analysis-extras via SOLR_MODULES.&lt;/p&gt;

&lt;p&gt;&#8212;&lt;/p&gt;

&lt;p&gt;As you recommended I&apos;ve copied analysis-extras/lib/* to solr/lib/* and added -Dsolr.sharedLib=path to the lib,&lt;/p&gt;

&lt;p&gt;and after that I am still having exactly same issue as originally.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17543531" author="elyograg" created="Sat, 28 May 2022 20:17:24 +0000"  >&lt;p&gt;I&apos;ve just duplicated the issue with my install from the main branch that shows as version 10.0.0-SNAPSHOT.&#160; I was wrong on the possible classloader issues.&#160; I am absolutely sure that the jars have only been loaded once.&lt;/p&gt;

&lt;p&gt;What version of Java were you using with Solr 8?&#160; Solr 8 only required Java 8, but Solr 9 requires Java 11.&#160; I am running OpenJDK version 11.&lt;/p&gt;

&lt;p&gt;Looking at the error message, I can&apos;t figure out why it&apos;s throwing an illegal access error.&#160; The protected field it&apos;s accessing is in the same package, so Java should allow the access.&#160; In my IDE, the code does not show any errors.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17543533" author="elyograg" created="Sat, 28 May 2022 20:30:24 +0000"  >&lt;p&gt;I found this:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://stackoverflow.com/a/10538366/2665648&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://stackoverflow.com/a/10538366/2665648&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I was able to get it to start correctly by moving all the extra jars from ${solr.solr.home}/lib to /opt/solr/server/solr-webapp/webapp/WEB-INF/lib ... thus ensuring that the extra jars were loaded by the same classloader as solr-core and the rest of the solr jars.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17543536" author="elyograg" created="Sat, 28 May 2022 20:37:49 +0000"  >&lt;p&gt;We can solve this in the code by not accessing fields directly as is being done here, but through a public method instead.&#160; I bet this is not the only place in the code that does this.&lt;/p&gt;

&lt;p&gt;Keeping fields private and using methods to reach them is one of the very earliest things I learned about designing classes in Java.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17543563" author="JIRAUSER290157" created="Sun, 29 May 2022 04:02:40 +0000"  >&lt;p&gt;Thank you for reproducing the issue!&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ java -version
openjdk version &lt;span class=&quot;code-quote&quot;&gt;&quot;13.0.7&quot;&lt;/span&gt; 2021-04-20
OpenJDK &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment (build 13.0.7+5-Ubuntu-0ubuntu120.04)
OpenJDK 64-Bit Server VM (build 13.0.7+5-Ubuntu-0ubuntu120.04, mixed mode, sharing)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I used the same version of java with Solr 8.&lt;/p&gt;

&lt;p&gt;Is there a bug, packaging problem or some problem specifically with my setup?&lt;/p&gt;</comment>
                            <comment id="17543585" author="JIRAUSER290157" created="Sun, 29 May 2022 08:18:24 +0000"  >&lt;p&gt;Is this the culprit?&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160; @Override&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; protected void init(IndexSchema schema, Map&amp;lt;String, String&amp;gt; args) {&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; failHardOnUdvas = &lt;b&gt;schema.luceneVersion&lt;/b&gt;.onOrAfter(UDVAS_FORBIDDEN_AS_OF);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; if (on(trueProperties, USE_DOCVALUES_AS_STORED)) {&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; // fail fast at fieldType init&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; warnOrFailUdvas(failHardOnUdvas);&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

{&#160; &#160; }

&lt;p&gt;}}&lt;br/&gt;
&lt;tt&gt;&#160; &#160; properties &amp;amp;= ~USE_DOCVALUES_AS_STORED;&lt;/tt&gt;&lt;br/&gt;
{{&#160; &#160; properties |= TOKENIZED; // this ensures ou&#160; /** The Default Lucene Match Version for this IndexSchema */&lt;br/&gt;
&#160; public Version getDefaultLuceneMatchVersion()&lt;/p&gt;

{ &#160; &#160; return luceneVersion; &#160; }

&lt;p&gt;r analyzer gets hit}}&lt;br/&gt;
&lt;tt&gt;&#160; &#160; setup(schema.getResourceLoader(), args);&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; super.init(schema, args);&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;{&lt;/p&gt;

{&#160; }

&lt;p&gt;}}&lt;/p&gt;

&lt;p&gt;If so, I believe this problem is unique to this particulat case:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;$ ack &apos;\.luceneVersion&apos;&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;solr/modules/analysis-extras/src/java/org/apache/solr/schema/ICUCollationField.java&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;128: &#160; &#160;failHardOnUdvas = schema.luceneVersion.onOrAfter(UDVAS_FORBIDDEN_AS_OF);&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;solr/CHANGES.txt&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;3813:* &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12972&quot; title=&quot;deprecate-and-remove unused SolrIndexConfig.luceneVersion (LUCENE-5871 follow-on)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12972&quot;&gt;&lt;del&gt;SOLR-12972&lt;/del&gt;&lt;/a&gt;: deprecate unused SolrIndexConfig.luceneVersion (Christine Poerschke)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;solr/core/src/java/org/apache/solr/schema/IndexSchema.java&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;199: &#160; &#160;this.luceneVersion = Objects.requireNonNull(luceneVersion);&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;and this method should be called instead?&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;&#160; /** The Default Lucene Match Version for this IndexSchema */&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; public Version getDefaultLuceneMatchVersion() {&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; return luceneVersion;&lt;/tt&gt;&lt;/p&gt;

{\{&#160; }

&lt;p&gt;}}&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;But I am not a Java programmer. Maybe, someone can provide a patch if this sounds reasonable?&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Or alternatively the whole check for luceneVersion can be skipped as it has been deprecated? - probably not as the UDVAS check has been added in 9.0.0&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cpoerschke&quot; class=&quot;user-hover&quot; rel=&quot;cpoerschke&quot;&gt;cpoerschke&lt;/a&gt; ? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=magibney&quot; class=&quot;user-hover&quot; rel=&quot;magibney&quot;&gt;magibney&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="17543649" author="elyograg" created="Sun, 29 May 2022 14:44:33 +0000"  >&lt;p&gt;The thing that was removed was a completely unused variable in a completely different class.&#160; It sounds similar, but isn&apos;t related.&lt;/p&gt;

&lt;p&gt;You are correct.&#160; Replacing this code on line 128:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
schema.luceneVersion
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;With this code&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
schema.getDefaultLuceneMatchVersion()
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;should fix the issue.&lt;br/&gt;
&#160;&lt;br/&gt;
In the meantime, there is a hack of a workaround &#8211; move those three jars to WEB-INF/lib in the solr webapp instead of trying to load them with &amp;lt;lib&amp;gt; config or ${solr.solr.home}/lib.&lt;/p&gt;</comment>
                            <comment id="17543650" author="elyograg" created="Sun, 29 May 2022 14:45:42 +0000"  >&lt;p&gt;If somebody else wants to tackle committing that change, feel free.&#160; I will proceed with it tomorrow otherwise.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17543725" author="mgibney" created="Sun, 29 May 2022 21:13:54 +0000"  >&lt;p&gt;Yes, the proposed fix would definitely address the issue here; and having introduced that code, I&apos;d be happy to commit the fix to main and backport to branch_9x (probably Tuesday?), unless you&apos;d prefer to Shawn. (And needless to say, thanks to you both for reporting the problem and troubleshooting/determining the workaround!).&lt;/p&gt;

&lt;p&gt;The direct fix for this problem is trivial in size. My concern (which if I can turn it around quickly I will add to the fix, and if not will add separately later) is that this issue is evidently not covered by existing unit tests nor integration tests. So I&apos;ll be casting a bit of a wider net in looking into this, and hopefully add tests to prevent this (or anything similar) happening again.&lt;/p&gt;</comment>
                            <comment id="17543737" author="elyograg" created="Mon, 30 May 2022 01:10:57 +0000"  >&lt;p&gt;I&apos;m trying to figure out if there is a way we can temporarily flag accesses of a protected field from another class in the same package, and review each one to determine whether it is likely that the classes in question will be loaded by different classloaders.&#160; I think some developer docs have been started ... it&apos;s probably a good idea in the module section of those docs to warn against this.&lt;/p&gt;

&lt;p&gt;For me, the effort of looking into that is hampered by something relating to eclipse, the IDE that I am most familiar with.&#160; Currently in the latest eclipse version, the main branch shows a number of errors in addition to the thousands of warnings that have always been there.&#160; These errors do not interrupt building with gradle.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=magibney&quot; class=&quot;user-hover&quot; rel=&quot;magibney&quot;&gt;magibney&lt;/a&gt; I am happy to let you fix it.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17544649" author="mgibney" created="Wed, 1 Jun 2022 00:20:50 +0000"  >&lt;p&gt;I have an integration test for this, and a fix (no PR yet, but soon). It&apos;s worth noting that exactly the same issue arose with the AnalyticsComponent (fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13643&quot; title=&quot;ResponseBuilder should provide accessors/setters for analytics response handling&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13643&quot;&gt;&lt;del&gt;SOLR-13643&lt;/del&gt;&lt;/a&gt;).&lt;/p&gt;

&lt;p&gt;Is there a more general way that we could prevent this kind of thing from happening in the future? This is a problem for any part of the code that gets packaged/deployed as separate jar files (outside of WEB-INF). In practice iiuc it&apos;s a concern only for classes that declare themselves in a package that already exists in core or solrj &amp;#8211; and there aren&apos;t that many contrib/modules (currently) that do that (most are scoped to new/special packages). I&apos;m really curious if anyone has any ideas, e.g., of how to have class loading in unit tests be more closely analogous to what one would see in a production environment. Or should we proceed with a &quot;just don&apos;t do that, and try to be vigilant in code reviews&quot; approach?&lt;/p&gt;</comment>
                            <comment id="17554253" author="JIRAUSER290157" created="Tue, 14 Jun 2022 18:59:25 +0000"  >&lt;p&gt;hi! Any news on this?&lt;/p&gt;</comment>
                            <comment id="17554559" author="mgibney" created="Wed, 15 Jun 2022 12:42:31 +0000"  >&lt;p&gt;Hi Roman; I&apos;ll make absolutely certain to get this into 9.1 and the first 9.0 bugfix release, but I&apos;m likely to hop onto those releases (assuming they won&apos;t be too long in coming) &amp;#8211; unfortunately I don&apos;t have the bandwidth at the moment to actively push for a release (and I&apos;m glad that in the meantime there&apos;s a workaround based on jar file placement).&lt;/p&gt;

&lt;p&gt;To be clear, I&apos;m not going to get hung up on the &quot;more general way that we could prevent this kind of thing from happening in the future&quot;. I&apos;ll try to get the PR up this week; thanks for your patience!&lt;/p&gt;</comment>
                            <comment id="17554618" author="JIRAUSER290157" created="Wed, 15 Jun 2022 14:04:01 +0000"  >&lt;p&gt;Thank you very much! I just wanted to say it&apos;s still important and prevent the ticket from being automatically closed &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Unfortunately Java is not my cup of coffee, so I can&apos;t help much.&lt;/p&gt;</comment>
                            <comment id="17602364" author="risdenk" created="Fri, 9 Sep 2022 14:09:02 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16407&quot; title=&quot;Classloading Issue when using ICUCollationField from analysis-extras module&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16407&quot;&gt;&lt;del&gt;SOLR-16407&lt;/del&gt;&lt;/a&gt; was just filed with the same root cause. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=magibney&quot; class=&quot;user-hover&quot; rel=&quot;magibney&quot;&gt;magibney&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=elyograg&quot; class=&quot;user-hover&quot; rel=&quot;elyograg&quot;&gt;elyograg&lt;/a&gt; looks like this change (schema.getDefaultLuceneMatchVersion()) didn&apos;t get committed?&lt;/p&gt;</comment>
                            <comment id="17602368" author="thomas.woeckinger" created="Fri, 9 Sep 2022 14:22:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16407&quot; title=&quot;Classloading Issue when using ICUCollationField from analysis-extras module&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16407&quot;&gt;&lt;del&gt;SOLR-16407&lt;/del&gt;&lt;/a&gt; was just filed with the same root cause. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=magibney&quot; class=&quot;user-hover&quot; rel=&quot;magibney&quot;&gt;magibney&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=elyograg&quot; class=&quot;user-hover&quot; rel=&quot;elyograg&quot;&gt;elyograg&lt;/a&gt; looks like this change (schema.getDefaultLuceneMatchVersion()) didn&apos;t get committed?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;So are there any plans about releasing a 9.0.1 or a 9.1.0 version where this fix is included?&lt;/p&gt;

&lt;p&gt;If so, maybe &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16406&quot; title=&quot;Module loading does not work when using SOLR_MODULES in solr.in.sh&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16406&quot;&gt;&lt;del&gt;SOLR-16406&lt;/del&gt;&lt;/a&gt; should be fixed too.&lt;/p&gt;</comment>
                            <comment id="17602397" author="mgibney" created="Fri, 9 Sep 2022 14:38:37 +0000"  >&lt;p&gt;Yes! apologies, this has been on my radar and I was definitely planning to get it into 9.0.1 or 9.1.0. I&apos;ll try to commit the fix (there&apos;s an integration test as well iirc) by next week. And I do think that &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16046&quot; title=&quot;Thread leak in TestLeaderElectionZkExpiry&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16046&quot;&gt;SOLR-16046&lt;/a&gt; is just a manifestation of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16407&quot; title=&quot;Classloading Issue when using ICUCollationField from analysis-extras module&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16407&quot;&gt;&lt;del&gt;SOLR-16407&lt;/del&gt;&lt;/a&gt; (and this issue).&lt;/p&gt;</comment>
                            <comment id="17607052" author="thomas.woeckinger" created="Tue, 20 Sep 2022 09:42:42 +0000"  >&lt;p&gt;There is still the the old version in both branches &lt;b&gt;main&lt;/b&gt; and &lt;b&gt;9.X.&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;I can provide a pull request for the changes.&lt;/p&gt;

&lt;p&gt;This should go in before the next release, otherwise the analysis-extras module is not useable&lt;/p&gt;</comment>
                            <comment id="17607366" author="mgibney" created="Tue, 20 Sep 2022 19:00:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thomas.woeckinger&quot; class=&quot;user-hover&quot; rel=&quot;thomas.woeckinger&quot;&gt;thomas.woeckinger&lt;/a&gt; (et al) thanks so much for your patience with this, and for keeping an eye out. Just pushed &lt;a href=&quot;https://github.com/apache/solr/pull/1028&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR #1028&lt;/a&gt; to address this; working to get this merged ASAP and backported for 9.1 release.&lt;/p&gt;</comment>
                            <comment id="17607943" author="jira-bot" created="Wed, 21 Sep 2022 19:29:22 +0000"  >&lt;p&gt;Commit 223f8107608a89a85107902de8b2231262b325ce in solr&apos;s branch refs/heads/main from Michael Gibney&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=223f8107608&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=223f8107608&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16219&quot; title=&quot;ICUCollationField tried to access protected field org.apache.solr.schema.IndexSchema.luceneVersion&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16219&quot;&gt;&lt;del&gt;SOLR-16219&lt;/del&gt;&lt;/a&gt;: ICUCollationField protected field IllegalAccessException from different classloader (#1028)&lt;/p&gt;
</comment>
                            <comment id="17607953" author="jira-bot" created="Wed, 21 Sep 2022 19:58:53 +0000"  >&lt;p&gt;Commit 4ebfc21e049ec4dbcb7b6eda1cd019bee8051e38 in solr&apos;s branch refs/heads/branch_9x from Michael Gibney&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=4ebfc21e049&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=4ebfc21e049&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16219&quot; title=&quot;ICUCollationField tried to access protected field org.apache.solr.schema.IndexSchema.luceneVersion&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16219&quot;&gt;&lt;del&gt;SOLR-16219&lt;/del&gt;&lt;/a&gt;: ICUCollationField protected field IllegalAccessException from different classloader (#1028)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 223f8107608a89a85107902de8b2231262b325ce)&lt;/p&gt;</comment>
                            <comment id="17656882" author="ishan" created="Tue, 10 Jan 2023 20:45:32 +0000"  >&lt;p&gt;Bulk closing 9.1 issues.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13480868">SOLR-16407</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 44 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z12roo:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>