<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:37:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3369] shards.tolerant=true broken on group queries</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3369</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;In a distributed environment, shards.tolerant=true allows for partial results to be returned when individual shards are down.  For group=true and facet=true queries, using this feature results in an error when shards are down.  This patch allows users to use the shard tolerance feature with facet and grouping queries. &lt;/p&gt;</description>
                <environment>&lt;p&gt;Distributed environment (shards)&lt;/p&gt;</environment>
        <key id="12551315">SOLR-3369</key>
            <summary>shards.tolerant=true broken on group queries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="rblack">Russell Black</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Apr 2012 22:38:01 +0000</created>
                <updated>Tue, 23 Jul 2013 18:38:52 +0000</updated>
                            <resolved>Tue, 2 Jul 2013 16:15:20 +0000</resolved>
                                    <version>4.0-ALPHA</version>
                                    <fixVersion>4.4</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>5</votes>
                                    <watches>12</watches>
                                                                                                                <comments>
                            <comment id="13256963" author="martijn.v.groningen" created="Wed, 18 Apr 2012 21:10:38 +0000"  >&lt;p&gt;I took a quick look. Patch also seems to add support for adding shards.info parameter for grouping and adds exception information to the response when a shard request fails.&lt;/p&gt;

&lt;p&gt;I don&apos;t that think that shards.tolerant is a supported feature in Solr 3.x versions (I couldn&apos;t find any reference of this param in the 3.6 source). So I think we shouldn&apos;t add this to the 3.6 branch since that would be adding a new feature to a Solr version that is actually in maintenance mode.&lt;/p&gt;

</comment>
                            <comment id="13257057" author="rblack" created="Wed, 18 Apr 2012 22:57:07 +0000"  >&lt;p&gt;Martijn,&lt;/p&gt;

&lt;p&gt;You&apos;re right, 3.6 doesn&apos;t have this feature.  My mistake.  Just use the trunk patch if you wish.  &lt;/p&gt;

&lt;p&gt;The reason I had a 3.6 version of this patch is that we have backported &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3134&quot; title=&quot;Include shard Information in response&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3134&quot;&gt;&lt;del&gt;SOLR-3134&lt;/del&gt;&lt;/a&gt; (original shards info/tolerance feature) to 3.6.  &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3369&quot; title=&quot;shards.tolerant=true broken on group queries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3369&quot;&gt;&lt;del&gt;SOLR-3369&lt;/del&gt;&lt;/a&gt;-shards-tolerant-3_6.patch is intended to be applied on top of that, and is of no use without it.  I just posted our &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3134&quot; title=&quot;Include shard Information in response&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3134&quot;&gt;&lt;del&gt;SOLR-3134&lt;/del&gt;&lt;/a&gt; backport patch if you have an interest in adding shards.info and shards.tolerant to 3.x.  If not, at least the patch will be available for other 3.x users who want that feature.&lt;/p&gt;</comment>
                            <comment id="13258329" author="rblack" created="Fri, 20 Apr 2012 15:47:38 +0000"  >&lt;p&gt;removed 3.6 from affected versions&lt;/p&gt;</comment>
                            <comment id="13540622" author="rblack" created="Fri, 28 Dec 2012 22:48:22 +0000"  >&lt;p&gt;The patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3557&quot; title=&quot;Avoid NPE for distributed request when shards.tolerant=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3557&quot;&gt;&lt;del&gt;SOLR-3557&lt;/del&gt;&lt;/a&gt; contained some overlap with the patch on this ticket.  I am updating the patch on this ticket accordingly.  &lt;/p&gt;</comment>
                            <comment id="13603244" author="ferrylandzaat" created="Fri, 15 Mar 2013 09:07:58 +0000"  >&lt;p&gt;Is there any plan to fix this issue? We want to upgrade from 3.x and really need this patch to make the system reliable.&lt;/p&gt;</comment>
                            <comment id="13650755" author="aboiscrettez" created="Tue, 7 May 2013 12:16:23 +0000"  >&lt;p&gt;Same here, with Solr 4.2.1 it is still not possible to do queries with both shards.tolerant=true and grouping.&lt;/p&gt;

&lt;p&gt;Is there anything wrong with the patch itself ?&lt;/p&gt;</comment>
                            <comment id="13650759" author="ryantxu" created="Tue, 7 May 2013 12:23:46 +0000"  >&lt;p&gt;If someone adds a test to exercise this patch, I&apos;ll commit it.&lt;/p&gt;</comment>
                            <comment id="13658443" author="djice" created="Wed, 15 May 2013 15:19:20 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;here is a test, you just have to copy it in solr/core/src/test/org/apache/solr/:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;TestDistributedGroupingWithShardTolerantActivated.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;package&lt;/span&gt; org.apache.solr;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.ArrayList;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.Arrays;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; java.util.List;

&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.lucene.util.LuceneTestCase.Slow;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.solr.client.solrj.SolrServer;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.solr.client.solrj.SolrServerException;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.solr.client.solrj.embedded.JettySolrRunner;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.solr.cloud.ChaosMonkey;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.solr.common.params.CommonParams;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.solr.common.params.ModifiableSolrParams;
&lt;span class=&quot;code-keyword&quot;&gt;import&lt;/span&gt; org.apache.solr.common.params.ShardParams;


@Slow
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TestDistributedGroupingWithShardTolerantActivated &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; BaseDistributedSearchTestCase {

  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; t1=&lt;span class=&quot;code-quote&quot;&gt;&quot;a_t&quot;&lt;/span&gt;;
  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; i1=&lt;span class=&quot;code-quote&quot;&gt;&quot;a_si&quot;&lt;/span&gt;;
  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; s1=&lt;span class=&quot;code-quote&quot;&gt;&quot;a_s&quot;&lt;/span&gt;;
  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tlong = &lt;span class=&quot;code-quote&quot;&gt;&quot;other_tl1&quot;&lt;/span&gt;;
  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tdate_a = &lt;span class=&quot;code-quote&quot;&gt;&quot;a_n_tdt&quot;&lt;/span&gt;;
  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; tdate_b = &lt;span class=&quot;code-quote&quot;&gt;&quot;b_n_tdt&quot;&lt;/span&gt;;
  &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; oddField=&lt;span class=&quot;code-quote&quot;&gt;&quot;oddField_s&quot;&lt;/span&gt;;

  @Override
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void doTest() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    del(&lt;span class=&quot;code-quote&quot;&gt;&quot;*:*&quot;&lt;/span&gt;);
    commit();

    handle.clear();
    handle.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;QTime&quot;&lt;/span&gt;, SKIPVAL);
    handle.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;timestamp&quot;&lt;/span&gt;, SKIPVAL);
    handle.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;grouped&quot;&lt;/span&gt;, UNORDERED);   &lt;span class=&quot;code-comment&quot;&gt;// distrib grouping doesn&apos;t guarantee order of top level group commands
&lt;/span&gt;
    indexr(id,1, i1, 100, tlong, 100,t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;now is the time &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; all good men&quot;&lt;/span&gt;,
           tdate_a, &lt;span class=&quot;code-quote&quot;&gt;&quot;2010-04-20T11:00:00Z&quot;&lt;/span&gt;,
           tdate_b, &lt;span class=&quot;code-quote&quot;&gt;&quot;2009-08-20T11:00:00Z&quot;&lt;/span&gt;,
           &lt;span class=&quot;code-quote&quot;&gt;&quot;foo_f&quot;&lt;/span&gt;, 1.414f, &lt;span class=&quot;code-quote&quot;&gt;&quot;foo_b&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;foo_d&quot;&lt;/span&gt;, 1.414d);
    indexr(id,2, i1, 50 , tlong, 50,t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;to come to the aid of their country.&quot;&lt;/span&gt;,
           tdate_a, &lt;span class=&quot;code-quote&quot;&gt;&quot;2010-05-02T11:00:00Z&quot;&lt;/span&gt;,
           tdate_b, &lt;span class=&quot;code-quote&quot;&gt;&quot;2009-11-02T11:00:00Z&quot;&lt;/span&gt;);
    indexr(id,3, i1, 2, tlong, 2,t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;how now brown cow&quot;&lt;/span&gt;,
           tdate_a, &lt;span class=&quot;code-quote&quot;&gt;&quot;2010-05-03T11:00:00Z&quot;&lt;/span&gt;);
    indexr(id,4, i1, -100 ,tlong, 101,
           t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;the quick fox jumped over the lazy dog&quot;&lt;/span&gt;,
           tdate_a, &lt;span class=&quot;code-quote&quot;&gt;&quot;2010-05-03T11:00:00Z&quot;&lt;/span&gt;,
           tdate_b, &lt;span class=&quot;code-quote&quot;&gt;&quot;2010-05-03T11:00:00Z&quot;&lt;/span&gt;);
    indexr(id,5, i1, 500, tlong, 500 ,
           t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;the quick fox jumped way over the lazy dog&quot;&lt;/span&gt;,
           tdate_a, &lt;span class=&quot;code-quote&quot;&gt;&quot;2010-05-05T11:00:00Z&quot;&lt;/span&gt;);
    indexr(id,6, i1, -600, tlong, 600 ,t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;humpty dumpy sat on a wall&quot;&lt;/span&gt;);
    indexr(id,7, i1, 123, tlong, 123 ,t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;humpty dumpy had a great fall&quot;&lt;/span&gt;);
    indexr(id,8, i1, 876, tlong, 876,
           tdate_b, &lt;span class=&quot;code-quote&quot;&gt;&quot;2010-01-05T11:00:00Z&quot;&lt;/span&gt;,
           t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;all the kings horses and all the kings men&quot;&lt;/span&gt;);
    indexr(id,9, i1, 7, tlong, 7,t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;couldn&apos;t put humpty together again&quot;&lt;/span&gt;);
    indexr(id,10, i1, 4321, tlong, 4321,t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; too shall pass&quot;&lt;/span&gt;);
    indexr(id,11, i1, -987, tlong, 987,
           t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;An eye &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; eye only ends up making the whole world blind.&quot;&lt;/span&gt;);
    indexr(id,12, i1, 379, tlong, 379,
           t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;Great works are performed, not by strength, but by perseverance.&quot;&lt;/span&gt;);

    indexr(id, 14, &lt;span class=&quot;code-quote&quot;&gt;&quot;SubjectTerms_mfacet&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]  {&lt;span class=&quot;code-quote&quot;&gt;&quot;mathematical models&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;mathematical analysis&quot;&lt;/span&gt;});
    indexr(id, 15, &lt;span class=&quot;code-quote&quot;&gt;&quot;SubjectTerms_mfacet&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]  {&lt;span class=&quot;code-quote&quot;&gt;&quot;test 1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;test 2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;test3&quot;&lt;/span&gt;});
    indexr(id, 16, &lt;span class=&quot;code-quote&quot;&gt;&quot;SubjectTerms_mfacet&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]  {&lt;span class=&quot;code-quote&quot;&gt;&quot;test 1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;test 2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;test3&quot;&lt;/span&gt;});
    &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] vals = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[100];
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i=0; i&amp;lt;100; i++) {
      vals[i] = &lt;span class=&quot;code-quote&quot;&gt;&quot;test &quot;&lt;/span&gt; + i;
    }
    indexr(id, 17, &lt;span class=&quot;code-quote&quot;&gt;&quot;SubjectTerms_mfacet&quot;&lt;/span&gt;, vals);

    indexr(
        id, 18, i1, 232, tlong, 332,
        t1,&lt;span class=&quot;code-quote&quot;&gt;&quot;no eggs on wall, lesson learned&quot;&lt;/span&gt;,
        oddField, &lt;span class=&quot;code-quote&quot;&gt;&quot;odd man out&quot;&lt;/span&gt;
    );
    indexr(
        id, 19, i1, 232, tlong, 432,
        t1, &lt;span class=&quot;code-quote&quot;&gt;&quot;many eggs on wall&quot;&lt;/span&gt;,
        oddField, &lt;span class=&quot;code-quote&quot;&gt;&quot;odd man in&quot;&lt;/span&gt;
    );
    indexr(
        id, 20, i1, 232, tlong, 532,
        t1, &lt;span class=&quot;code-quote&quot;&gt;&quot;some eggs on wall&quot;&lt;/span&gt;,
        oddField, &lt;span class=&quot;code-quote&quot;&gt;&quot;odd man between&quot;&lt;/span&gt;
    );
    indexr(
        id, 21, i1, 232, tlong, 632,
        t1, &lt;span class=&quot;code-quote&quot;&gt;&quot;a few eggs on wall&quot;&lt;/span&gt;,
        oddField, &lt;span class=&quot;code-quote&quot;&gt;&quot;odd man under&quot;&lt;/span&gt;
    );
    indexr(
        id, 22, i1, 232, tlong, 732,
        t1, &lt;span class=&quot;code-quote&quot;&gt;&quot;any eggs on wall&quot;&lt;/span&gt;,
        oddField, &lt;span class=&quot;code-quote&quot;&gt;&quot;odd man above&quot;&lt;/span&gt;
    );
    indexr(
        id, 23, i1, 233, tlong, 734,
        t1, &lt;span class=&quot;code-quote&quot;&gt;&quot;dirty eggs&quot;&lt;/span&gt;,
        oddField, &lt;span class=&quot;code-quote&quot;&gt;&quot;odd eggs&quot;&lt;/span&gt;
    );

    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 100; i &amp;lt; 150; i++) {
      indexr(id, i);
    }

    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[] values = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;[]{9999, 99999, 999999, 9999999};
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; shard = 0; shard &amp;lt; clients.size(); shard++) {
      &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; groupValue = values[shard];
      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 500; i &amp;lt; 600; i++) {
        index_specific(shard, i1, groupValue, s1, &lt;span class=&quot;code-quote&quot;&gt;&quot;a&quot;&lt;/span&gt;, id, i * (shard + 1), t1, shard);
      }
    }

    commit();
    
    &lt;span class=&quot;code-comment&quot;&gt;// SOLR-3369: shrds.tolreant=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; with grouping
&lt;/span&gt;    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; numDownServers = 0; numDownServers &amp;lt; jettys.size() - 1; numDownServers++) {
      List&amp;lt;JettySolrRunner&amp;gt; upJettys = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;JettySolrRunner&amp;gt;(jettys);
      List&amp;lt;SolrServer&amp;gt; upClients = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;SolrServer&amp;gt;(clients);
      List&amp;lt;JettySolrRunner&amp;gt; downJettys = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;JettySolrRunner&amp;gt;();
      List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; upShards = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ArrayList&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;(Arrays.asList(shardsArr));
      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; numDownServers; i++) {
        &lt;span class=&quot;code-comment&quot;&gt;// shut down some of the jettys
&lt;/span&gt;        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; indexToRemove = r.nextInt(upJettys.size());
        JettySolrRunner downJetty = upJettys.remove(indexToRemove);
        upClients.remove(indexToRemove);
        upShards.remove(indexToRemove);
        ChaosMonkey.stop(downJetty);
        downJettys.add(downJetty);
      }

      simpleQuery(&lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;*:*&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;rows&quot;&lt;/span&gt;, 100, &lt;span class=&quot;code-quote&quot;&gt;&quot;fl&quot;&lt;/span&gt;,
          &lt;span class=&quot;code-quote&quot;&gt;&quot;id,&quot;&lt;/span&gt; + i1, &lt;span class=&quot;code-quote&quot;&gt;&quot;group&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;group.query&quot;&lt;/span&gt;, t1 + &lt;span class=&quot;code-quote&quot;&gt;&quot;:kings OR &quot;&lt;/span&gt; + t1
              + &lt;span class=&quot;code-quote&quot;&gt;&quot;:eggs&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;group.limit&quot;&lt;/span&gt;, 10, &lt;span class=&quot;code-quote&quot;&gt;&quot;sort&quot;&lt;/span&gt;, i1 + &lt;span class=&quot;code-quote&quot;&gt;&quot; asc, id asc&quot;&lt;/span&gt;,
          CommonParams.TIME_ALLOWED, 1, ShardParams.SHARDS_INFO, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;,
          ShardParams.SHARDS_TOLERANT, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;);
      
      &lt;span class=&quot;code-comment&quot;&gt;// restart the jettys
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (JettySolrRunner downJetty : downJettys) {
        downJetty.start();
      }
    }
  }

  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; void simpleQuery(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;... queryParams) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; SolrServerException {
    ModifiableSolrParams params = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ModifiableSolrParams();
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; i = 0; i &amp;lt; queryParams.length; i += 2) {
      params.add(queryParams[i].toString(), queryParams[i + 1].toString());
    }
    params.set(&lt;span class=&quot;code-quote&quot;&gt;&quot;shards&quot;&lt;/span&gt;, shards);
    queryServer(params);
  }

}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Your patch works perfectly in &quot;select&quot; mode. In &quot;browse&quot; mode there in a other exception:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR org.apache.solr.core.SolrCore:log:85  - java.lang.NullPointerException
    at org.apache.solr.handler.component.SpellCheckComponent.finishStage(SpellCheckComponent.java:297)
    at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:317)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Thank you very much for this patch, &lt;b&gt;we hope it will be in the next release of solr&lt;/b&gt;.&lt;/p&gt;</comment>
                            <comment id="13658664" author="rblack" created="Wed, 15 May 2013 18:53:27 +0000"  >&lt;p&gt;This test case fails sometimes because it occasionally tries to use one of the &quot;down&quot; servers as the collator.  I&apos;ll fix this and include it in a new patch.&lt;/p&gt;</comment>
                            <comment id="13659018" author="rblack" created="Wed, 15 May 2013 23:31:30 +0000"  >&lt;p&gt;As requested, I added a test case to the patch file.  &lt;/p&gt;</comment>
                            <comment id="13659021" author="ryantxu" created="Wed, 15 May 2013 23:35:02 +0000"  >&lt;p&gt;latest patch adds:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+      &lt;span class=&quot;code-comment&quot;&gt;// test group query
&lt;/span&gt;+      queryPartialResults(upShards, upClients, 
+          &lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;*:*&quot;&lt;/span&gt;, 
+          &lt;span class=&quot;code-quote&quot;&gt;&quot;rows&quot;&lt;/span&gt;, 100, 
+          &lt;span class=&quot;code-quote&quot;&gt;&quot;fl&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;id,&quot;&lt;/span&gt; + i1, 
+          &lt;span class=&quot;code-quote&quot;&gt;&quot;group&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;, 
+          &lt;span class=&quot;code-quote&quot;&gt;&quot;group.query&quot;&lt;/span&gt;, t1 + &lt;span class=&quot;code-quote&quot;&gt;&quot;:kings OR &quot;&lt;/span&gt; + t1 + &lt;span class=&quot;code-quote&quot;&gt;&quot;:eggs&quot;&lt;/span&gt;, 
+          &lt;span class=&quot;code-quote&quot;&gt;&quot;group.limit&quot;&lt;/span&gt;, 10, 
+          &lt;span class=&quot;code-quote&quot;&gt;&quot;sort&quot;&lt;/span&gt;, i1 + &lt;span class=&quot;code-quote&quot;&gt;&quot; asc, id asc&quot;&lt;/span&gt;,
+          CommonParams.TIME_ALLOWED, 1, 
+          ShardParams.SHARDS_INFO, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;,
+          ShardParams.SHARDS_TOLERANT, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;but does not include TestDistributedGroupingWithShardTolerantActivated.java&lt;/p&gt;

&lt;p&gt;Is this intentional?&lt;/p&gt;</comment>
                            <comment id="13659030" author="rblack" created="Wed, 15 May 2013 23:39:35 +0000"  >&lt;p&gt;Yes, this is intentional.  TestDistributedGroupingWithShardTolerantActivated.java duplicated much of what was in TestDistributedSearch.java.  TestDistributedSearch.java already has the framework in place for dealing with partial results.  &lt;/p&gt;</comment>
                            <comment id="13673482" author="rblack" created="Mon, 3 Jun 2013 19:43:41 +0000"  >&lt;p&gt;Ryan, is there anything preventing this patch from committing?  Was the test case satisfactory?&lt;/p&gt;</comment>
                            <comment id="13691975" author="shalinmangar" created="Mon, 24 Jun 2013 13:56:02 +0000"  >&lt;p&gt;This patch looks alright on first pass. There&apos;s something wrong with the solrcloud tests in trunk right now (unrelated to the patch). I&apos;ll wait for it to be fixed and then commit once I get a clean pass on all tests.&lt;/p&gt;</comment>
                            <comment id="13697919" author="jira-bot" created="Tue, 2 Jul 2013 16:10:17 +0000"  >&lt;p&gt;Commit 1498992 from shalin@apache.org&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1498992&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1498992&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3369&quot; title=&quot;shards.tolerant=true broken on group queries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3369&quot;&gt;&lt;del&gt;SOLR-3369&lt;/del&gt;&lt;/a&gt;: shards.tolerant=true is broken for group queries&lt;/p&gt;</comment>
                            <comment id="13697922" author="jira-bot" created="Tue, 2 Jul 2013 16:12:58 +0000"  >&lt;p&gt;Commit 1498993 from shalin@apache.org&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1498993&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1498993&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3369&quot; title=&quot;shards.tolerant=true broken on group queries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3369&quot;&gt;&lt;del&gt;SOLR-3369&lt;/del&gt;&lt;/a&gt;: shards.tolerant=true is broken for group queries&lt;/p&gt;</comment>
                            <comment id="13697927" author="shalinmangar" created="Tue, 2 Jul 2013 16:15:08 +0000"  >&lt;p&gt;shards.tolerant already works for facet queries so this issue is only about group queries.&lt;/p&gt;</comment>
                            <comment id="13716882" author="steve_rowe" created="Tue, 23 Jul 2013 18:38:52 +0000"  >&lt;p&gt;Bulk close resolved 4.4 issues&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12542632">SOLR-3134</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12583403" name="SOLR-3369-shards-tolerant.patch" size="8799" author="rblack" created="Wed, 15 May 2013 23:31:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>236179</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i02n07:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>13328</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>