<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:28:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-11363] TestCloudJSONFacetJoinDomain fails with Points enabled</title>
                <link>https://issues.apache.org/jira/browse/SOLR-11363</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;As Hoss noted in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10939&quot; title=&quot;JoinQParser gives incorrect results with numeric PointsFields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10939&quot;&gt;&lt;del&gt;SOLR-10939&lt;/del&gt;&lt;/a&gt;, this test still had points disabled, and enabling them causes tests to fail.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13103023">SOLR-11363</key>
            <summary>TestCloudJSONFacetJoinDomain fails with Points enabled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="yseeley@gmail.com">Yonik Seeley</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Sep 2017 18:25:54 +0000</created>
                <updated>Sat, 8 Jun 2019 15:19:31 +0000</updated>
                            <resolved>Tue, 19 Sep 2017 17:51:49 +0000</resolved>
                                    <version>7.0</version>
                                    <fixVersion>7.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16170894" author="yseeley@gmail.com" created="Mon, 18 Sep 2017 23:31:11 +0000"  >&lt;p&gt;Hmmm, I disabled domain switches and set the number of fields and values to 1, and things still fail.&lt;br/&gt;
This looks like something fundamentally broken with faceting on points.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.AssertionError: {main(json.facet={facet_1+:+{+type:terms,+field:field_0_is,+limit:+2}+}),extra(q=(field_0_ss:0+OR+field_0_ss:0+OR+field_0_ss:1+OR+field_0_ss:0+OR+field_0_ss:1+OR+field_0_ss:1)&amp;amp;rows=0)} ===&amp;gt; {responseHeader={zkConnected=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,status=0,QTime=454},response={numFound=109,start=0,maxScore=2.0918934,docs=[]},facets={count=109,facet_1={buckets=[{val=0,count=122}, {val=1,count=102}]}}} --&amp;gt; facet_1: q=field_0_is:0+AND+(field_0_ss:0+OR+field_0_ss:0+OR+field_0_ss:1+OR+field_0_ss:0+OR+field_0_ss:1+OR+field_0_ss:1)&amp;amp;rows=0 
Expected :122
Actual   :82
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16170902" author="hossman" created="Mon, 18 Sep 2017 23:41:17 +0000"  >&lt;p&gt;yonik: I assume you noticed the &quot;count=122&quot; even though &quot;numFound=109&quot; ?&lt;/p&gt;

&lt;p&gt;Is it possible the faceting code is double counting when a (single) doc contains the same value multiple times in a multi-valued points field?  (Is there a non-randomized test covering this situation?)&lt;/p&gt;</comment>
                            <comment id="16170925" author="yseeley@gmail.com" created="Tue, 19 Sep 2017 00:04:52 +0000"  >&lt;p&gt;OK, I boiled it down to a very simple case that fails (when added to TestJsonFacets:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  @Test
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void testRepeatedNumerics() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    Client client = Client.localClient();
    client.add(sdoc(&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;cat_s&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;A&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;where_s&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;NY&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;num_d&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;4&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;num_i&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;val_b&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;sparse_s&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;one&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;num_is&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;num_is&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;), &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
    client.commit();

    client.testJQ(params(&lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;id:1&quot;&lt;/span&gt;
        , &lt;span class=&quot;code-quote&quot;&gt;&quot;json.facet&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;{f1:{terms:num_is}}&quot;&lt;/span&gt;
        )
        , &lt;span class=&quot;code-quote&quot;&gt;&quot;facets=={count:1, &quot;&lt;/span&gt; +
            &lt;span class=&quot;code-quote&quot;&gt;&quot;f1:{buckets:[{val:0, count:1}]}}&quot;&lt;/span&gt;
    );
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The actual count being returned now is &quot;2&quot;, which is incorrect... it should be the number of documents containing 0, which is 1&lt;/p&gt;</comment>
                            <comment id="16170955" author="yseeley@gmail.com" created="Tue, 19 Sep 2017 00:40:21 +0000"  >&lt;p&gt;Yep, that&apos;s it.... old string docvalue based numerics deduped multiple values 1,2,2,3 became 1,2,3&lt;br/&gt;
SortedNumericDocValues (which we now use for points) does not dedup, and the JSON Facet API does not account for duplicate values.&lt;/p&gt;

&lt;p&gt;edit: and now I notice Hoss&apos; response above saying exactly that&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16170970" author="hossman" created="Tue, 19 Sep 2017 01:13:22 +0000"  >&lt;p&gt;linking to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10924&quot; title=&quot;PointField multivalued docValues don&amp;#39;t &amp;quot;dedup&amp;quot; like TrieField&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10924&quot;&gt;&lt;del&gt;SOLR-10924&lt;/del&gt;&lt;/a&gt; for posterity.&lt;/p&gt;</comment>
                            <comment id="16171018" author="yseeley@gmail.com" created="Tue, 19 Sep 2017 02:33:28 +0000"  >&lt;p&gt;Draft patch attached.&lt;/p&gt;</comment>
                            <comment id="16172066" author="jira-bot" created="Tue, 19 Sep 2017 17:39:52 +0000"  >&lt;p&gt;Commit 7cc9ee65633f653cb5ebe5c031db4d339b809466 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=7cc9ee6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=7cc9ee6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11363&quot; title=&quot;TestCloudJSONFacetJoinDomain fails with Points enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11363&quot;&gt;&lt;del&gt;SOLR-11363&lt;/del&gt;&lt;/a&gt;: handle repeated values in points docvalues fields&lt;/p&gt;</comment>
                            <comment id="16172069" author="jira-bot" created="Tue, 19 Sep 2017 17:40:53 +0000"  >&lt;p&gt;Commit ee2a2763af789eeb6a33cf3e9f7cf969caa3c56b in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ee2a276&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ee2a276&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11363&quot; title=&quot;TestCloudJSONFacetJoinDomain fails with Points enabled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11363&quot;&gt;&lt;del&gt;SOLR-11363&lt;/del&gt;&lt;/a&gt;: handle repeated values in points docvalues fields&lt;/p&gt;</comment>
                            <comment id="16207297" author="shalinmangar" created="Tue, 17 Oct 2017 11:03:19 +0000"  >&lt;p&gt;Bulk close after 7.1.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13081943">SOLR-10939</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13081199">SOLR-10924</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12887810" name="SOLR-11363.patch" size="5222" author="yseeley@gmail.com" created="Tue, 19 Sep 2017 02:32:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 5 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3k76f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>