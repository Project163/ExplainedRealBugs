<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:19:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9976] SegmentsInfoRequestHandlerTest has test method order execution problems</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9976</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;while helping to run tests on a feature branch, sarowe found this failure...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=SegmentsInfoRequestHandlerTest -Dtests.method=testSegmentInfosData -Dtests.seed=5BB5CF0D868944FB -Dtests.slow=true -Dtests.locale=zh-CN -Dtests.timezone=Pacific/Samoa -Dtests.asserts=true -Dtests.file.encoding=UTF-8
   [junit4] ERROR   0.12s J11 | SegmentsInfoRequestHandlerTest.testSegmentInfosData &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.RuntimeException: Exception during query
   [junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([5BB5CF0D868944FB:271CED563061F364]:0)
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:821)
   [junit4]    &amp;gt; 	at org.apache.solr.handler.admin.SegmentsInfoRequestHandlerTest.testSegmentInfosData(SegmentsInfoRequestHandlerTest.java:71)
   [junit4]    &amp;gt; 	at java.lang.Thread.run(Thread.java:745)
   [junit4]    &amp;gt; Caused by: java.lang.RuntimeException: REQUEST FAILED: xpath=10=sum(//lst[@name=&apos;segments&apos;]/lst/int[@name=&apos;size&apos;])
   [junit4]    &amp;gt; 	xml response was: &amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
   [junit4]    &amp;gt; &amp;lt;response&amp;gt;
   [junit4]    &amp;gt; &amp;lt;lst name=&quot;responseHeader&quot;&amp;gt;&amp;lt;int name=&quot;status&quot;&amp;gt;0&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;QTime&quot;&amp;gt;0&amp;lt;/int&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;lst name=&quot;segments&quot;&amp;gt;&amp;lt;lst name=&quot;_4&quot;&amp;gt;&amp;lt;str name=&quot;name&quot;&amp;gt;_4&amp;lt;/str&amp;gt;&amp;lt;int name=&quot;delCount&quot;&amp;gt;5&amp;lt;/int&amp;gt;&amp;lt;long name=&quot;sizeInBytes&quot;&amp;gt;1995&amp;lt;/long&amp;gt;&amp;lt;int name=&quot;size&quot;&amp;gt;9&amp;lt;/int&amp;gt;&amp;lt;date name=&quot;age&quot;&amp;gt;2017-01-16T06:10:10.308Z&amp;lt;/date&amp;gt;&amp;lt;str name=&quot;source&quot;&amp;gt;merge&amp;lt;/str&amp;gt;&amp;lt;str name=&quot;version&quot;&amp;gt;7.0.0&amp;lt;/str&amp;gt;&amp;lt;bool name=&quot;mergeCandidate&quot;&amp;gt;true&amp;lt;/bool&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;lst name=&quot;_5&quot;&amp;gt;&amp;lt;str name=&quot;name&quot;&amp;gt;_5&amp;lt;/str&amp;gt;&amp;lt;int name=&quot;delCount&quot;&amp;gt;0&amp;lt;/int&amp;gt;&amp;lt;long name=&quot;sizeInBytes&quot;&amp;gt;1562&amp;lt;/long&amp;gt;&amp;lt;int name=&quot;size&quot;&amp;gt;5&amp;lt;/int&amp;gt;&amp;lt;date name=&quot;age&quot;&amp;gt;2017-01-16T06:10:10.341Z&amp;lt;/date&amp;gt;&amp;lt;str name=&quot;source&quot;&amp;gt;flush&amp;lt;/str&amp;gt;&amp;lt;str name=&quot;version&quot;&amp;gt;7.0.0&amp;lt;/str&amp;gt;&amp;lt;bool name=&quot;mergeCandidate&quot;&amp;gt;true&amp;lt;/bool&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;/lst&amp;gt;
   [junit4]    &amp;gt; &amp;lt;/response&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...this failure reproduces (on master at least), but only if you remove the &lt;tt&gt;-Dtests.method=testSegmentInfosData&lt;/tt&gt; restriction so that all tests run.  &lt;/p&gt;

&lt;p&gt;At quick glance, it&apos;s pretty obvious this test doesn&apos;t do proper cleanup between methods before rebuilding the index (AFAICT there&apos;s no reason not to just build the index once in &lt;tt&gt;&amp;#64;BeforeClass&lt;/tt&gt;) and that seems to be leading to failures if the methods are executed in a particular order such that the method counting total docs/deletes in all segments runs after enough docs have been added to trigger a merge.  (pretty sure we also need to force the merge policy settings to ensure it doesn&apos;t randomly merge)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13035633">SOLR-9976</key>
            <summary>SegmentsInfoRequestHandlerTest has test method order execution problems</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Jan 2017 18:48:26 +0000</created>
                <updated>Sat, 8 Jun 2019 15:28:45 +0000</updated>
                            <resolved>Tue, 17 Jan 2017 21:57:20 +0000</resolved>
                                                    <fixVersion>6.5</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="15826899" author="jira-bot" created="Tue, 17 Jan 2017 21:50:26 +0000"  >&lt;p&gt;Commit 4714173611deac077ee5f4d78ab0d7cc0692a4bd in lucene-solr&apos;s branch refs/heads/branch_6x from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4714173&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4714173&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9976&quot; title=&quot;SegmentsInfoRequestHandlerTest has test method order execution problems&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9976&quot;&gt;&lt;del&gt;SOLR-9976&lt;/del&gt;&lt;/a&gt;: Fix init bug in SegmentsInfoRequestHandlerTest&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 39eec660ca79b62947321390e07e83d84be419e5)&lt;/p&gt;

&lt;p&gt;manually resolved conflicts:&lt;br/&gt;
	solr/CHANGES.txt&lt;/p&gt;</comment>
                            <comment id="15826900" author="jira-bot" created="Tue, 17 Jan 2017 21:50:28 +0000"  >&lt;p&gt;Commit 39eec660ca79b62947321390e07e83d84be419e5 in lucene-solr&apos;s branch refs/heads/master from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=39eec66&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=39eec66&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9976&quot; title=&quot;SegmentsInfoRequestHandlerTest has test method order execution problems&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9976&quot;&gt;&lt;del&gt;SOLR-9976&lt;/del&gt;&lt;/a&gt;: Fix init bug in SegmentsInfoRequestHandlerTest&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 44 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38u0f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>