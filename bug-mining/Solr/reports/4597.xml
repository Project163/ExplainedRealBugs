<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:46:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-14983] Score returned in search request is original score and not reranked score</title>
                <link>https://issues.apache.org/jira/browse/SOLR-14983</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Score returned in search request is original score and not reranked score post the changes in&#160;&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-8412&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/LUCENE-8412&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Commit -&#160;&lt;a href=&quot;https://github.com/apache/lucene-solr/commit/55bfadbce115a825a75686fe0bfe71406bc3ee44#diff-4e354f104ed52bd7f620b0c05ae8467d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/commit/55bfadbce115a825a75686fe0bfe71406bc3ee44#diff-4e354f104ed52bd7f620b0c05ae8467d&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Specifically -&#160;&lt;/p&gt;

&lt;p&gt;if (cmd.getSort() != null &amp;amp;&amp;amp; query instanceof RankQuery == false &amp;amp;&amp;amp; (cmd.getFlags() &amp;amp; GET_SCORES) != 0) &lt;/p&gt;
{

&#160; &#160;&#160;TopFieldCollector.populateScores(topDocs.scoreDocs, this, query);

}

&lt;p&gt;in SolrIndexSearcher.java recomputes the score but outputs only the original score and not the reranked score.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The issue is cmd.getQuery() is a type of RankQuery but the &quot;query&quot; variable is a boolean query and probably replacing query with cmd.getQuery() should be the right fix for this so that the score is not overriden for rerank queries&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13329143">SOLR-14983</key>
            <summary>Score returned in search request is original score and not reranked score</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cpoerschke">Christine Poerschke</assignee>
                                    <reporter username="krishan1390">Krishan Goyal</reporter>
                        <labels>
                    </labels>
                <created>Thu, 24 Sep 2020 06:53:45 +0000</created>
                <updated>Thu, 12 May 2022 00:26:43 +0000</updated>
                            <resolved>Thu, 12 Nov 2020 13:22:41 +0000</resolved>
                                    <version>8.0</version>
                                    <fixVersion>8.8</fixVersion>
                    <fixVersion>9.0</fixVersion>
                                        <due></due>
                            <votes>2</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="17208576" author="cpoerschke" created="Tue, 6 Oct 2020 08:46:57 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krishan1390&quot; class=&quot;user-hover&quot; rel=&quot;krishan1390&quot;&gt;krishan1390&lt;/a&gt; for opening this issue with a link into the code!&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Score returned in search request is original score and not reranked score post ...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Could you share more details on how to observe and reproduce the issue?&lt;/p&gt;

&lt;p&gt;I just tried the following steps on &lt;tt&gt;branch_7_7&lt;/tt&gt; and &lt;tt&gt;branch_8x&lt;/tt&gt; and it &lt;em&gt;seemed&lt;/em&gt; that the reranked score was being returned, perhaps a particular kind of query or re-ranking query is needed to encounter the issue?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
git checkout $branch # branch_7_7 or branch_8x

cd solr ; ant dist server # on master branch use gradle equivalent instead

bin/solr start -e techproducts

curl &lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/techproducts/select?rows=3&amp;amp;fl=id,score&amp;amp;q=*:*&apos;&lt;/span&gt;
&lt;/span&gt;
curl &lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/techproducts/select?rows=3&amp;amp;fl=id,score&amp;amp;q=*:*&amp;amp;rq=\{!rerank+reRankQuery=id:VDBDB1A16\}&apos;&lt;/span&gt;
&lt;/span&gt;
curl &lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/techproducts/select?rows=3&amp;amp;fl=id,score&amp;amp;q=*:*&amp;amp;rq=\{!rerank+reRankQuery=id:VDBDB1A16+reRankWeight=1\}&apos;&lt;/span&gt;
&lt;/span&gt;
curl &lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/techproducts/select?rows=3&amp;amp;fl=id,score&amp;amp;q=*:*&amp;amp;rq=\{!rerank+reRankQuery=id:VDBDB1A16+reRankWeight=2\}&apos;&lt;/span&gt;
&lt;/span&gt;
curl &lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/techproducts/select?rows=3&amp;amp;fl=id,score&amp;amp;q=*:*&amp;amp;rq=\{!rerank+reRankQuery=id:VDBDB1A16+reRankWeight=3\}&apos;&lt;/span&gt;
&lt;/span&gt;
bin/solr stop
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17216661" author="krishan1390" created="Mon, 19 Oct 2020 11:48:00 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cpoerschke&quot; class=&quot;user-hover&quot; rel=&quot;cpoerschke&quot;&gt;cpoerschke&lt;/a&gt;, This was happening on the LTR reranker when &quot;sort&quot; is present in the request.&#160;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/techproducts/query?q=test&amp;amp;rq=%7B!ltr%20model=myModel%20reRankDocs=100%7D&amp;amp;fl=id,price,score,%5Bfeatures%5D&amp;amp;sort=price%20desc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/techproducts/query?q=test&amp;amp;rq=%7B!ltr%20model=myModel%20reRankDocs=100%7D&amp;amp;fl=id,price,score,%5Bfeatures%5D&amp;amp;sort=price%20desc&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;The features and models are provided from &lt;a href=&quot;https://lucene.apache.org/solr/guide/6_6/learning-to-rank.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lucene.apache.org/solr/guide/6_6/learning-to-rank.html&lt;/a&gt;&#160;&lt;/p&gt;


&lt;p&gt;Unfortunately, I am not able to reproduce right now (so could have been a different request structure) but I remember that if cmd.getSort() = null (which happens when &quot;sort&quot; is absent in request) the score returned is the reranked score. But if&#160;cmd.getSort() != null, the score returned is the original score.&#160;&lt;/p&gt;


&lt;p&gt;Root cause looked to me that&#160;&quot;query&quot; variable is a boolean query where as&#160;cmd.getQuery() is a type of RankQuery (and RankQuery is explicitly skipped in this condition).&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If this info is not enough, I can debug further to try to reproduce again and provide exact query on the example data.&#160;&lt;/p&gt;</comment>
                            <comment id="17223207" author="baik" created="Thu, 29 Oct 2020 21:02:20 +0000"  >&lt;p&gt;&lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13014381/13014381_0001-LUCENE-9542-Unit-test-to-reproduce-bug.patch&quot; title=&quot;0001-LUCENE-9542-Unit-test-to-reproduce-bug.patch attached to SOLR-14983&quot;&gt;0001-LUCENE-9542-Unit-test-to-reproduce-bug.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&#160;contains a unit test that reproduces the bug.&lt;/p&gt;

&lt;p&gt;We&apos;re experiencing the same problem after migrating from Solr 6 to Solr 8.&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krishan1390&quot; class=&quot;user-hover&quot; rel=&quot;krishan1390&quot;&gt;krishan1390&lt;/a&gt;&apos;s suggestion of changing query -&amp;gt; cmd.getQuery() works, but for the longer term, it might be better to add some API that indicates whether the top collector has already computed the scores. That way, the lazy score computation. which &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-8412&quot; title=&quot;Remove trackDocScores from TopFieldCollector factory methods&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-8412&quot;&gt;&lt;del&gt;LUCENE-8412&lt;/del&gt;&lt;/a&gt;&#160;introduced AFTER the top doc collection stage, can more reliably decide if it should compute and overwrite the scores.&lt;/p&gt;

&lt;p&gt;In other words, instead of this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
TopDocs topDocs = topCollector.topDocs(0, len);
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (cmd.getSort() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; query &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; RankQuery == &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt; &amp;amp;&amp;amp; (cmd.getFlags() &amp;amp; GET_SCORES) != 0) {
  TopFieldCollector.populateScores(topDocs.scoreDocs, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, query);
} &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Do something like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
TopDocs topDocs = topCollector.topDocs(0, len);
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (cmd.getSort() != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !topCollector.hasAlreadyComputedScores() &amp;amp;&amp;amp; (cmd.getFlags() &amp;amp; GET_SCORES) != 0) {
  TopFieldCollector.populateScores(topDocs.scoreDocs, &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;, query);
}
 &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Although a counter-argument to this generic solution could be that this problem is currently limited to ReRankQuery&apos;s, which is unique in the sense that its score modifying behavior is implemented in the top doc collector layer, as opposed to in the Weight/Scorer layer since it wants to do the score modification for only a subset of the matched docs.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17225542" author="cpoerschke" created="Tue, 3 Nov 2020 16:41:06 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krishan1390&quot; class=&quot;user-hover&quot; rel=&quot;krishan1390&quot;&gt;krishan1390&lt;/a&gt; for the clarification that this was happening on the LTR reranker when &quot;sort&quot; is present and thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Baik&quot; class=&quot;user-hover&quot; rel=&quot;Baik&quot;&gt;Baik&lt;/a&gt; for the reproducing unit test and analysis!&lt;/p&gt;

&lt;p&gt;Based on that then here&apos;s a &lt;tt&gt;techproducts&lt;/tt&gt; request/response illustration:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ curl &lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/techproducts/select?fl=id,score&amp;amp;q=inStock:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;fq=cat:memory&amp;amp;rq=\{!rerank+reRankQuery=id:VDBDB1A16\}&amp;amp;sort=score+desc&apos;&lt;/span&gt;
&lt;/span&gt;{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;responseHeader&quot;&lt;/span&gt;:{
    &lt;span class=&quot;code-quote&quot;&gt;&quot;status&quot;&lt;/span&gt;:0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;QTime&quot;&lt;/span&gt;:3,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;params&quot;&lt;/span&gt;:{
      &lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;inStock:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;fl&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;id,score&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;fq&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;cat:memory&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;sort&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;score desc&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;rq&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;{!rerank reRankQuery=id:VDBDB1A16}&quot;&lt;/span&gt;}},
  &lt;span class=&quot;code-quote&quot;&gt;&quot;response&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;numFound&quot;&lt;/span&gt;:3,&lt;span class=&quot;code-quote&quot;&gt;&quot;start&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;maxScore&quot;&lt;/span&gt;:0.10401889,&lt;span class=&quot;code-quote&quot;&gt;&quot;numFoundExact&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;docs&quot;&lt;/span&gt;:[
      {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;VDBDB1A16&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;score&quot;&lt;/span&gt;:2.9140575},
      {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;TWINX2048-3200PRO&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;score&quot;&lt;/span&gt;:0.10401889},
      {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;VS1GB400C3&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;score&quot;&lt;/span&gt;:0.10401889}]
  }}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;vs.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ curl &lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/techproducts/select?fl=id,score&amp;amp;q=inStock:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;fq=cat:memory&amp;amp;rq=\{!rerank+reRankQuery=id:VDBDB1A16\}&amp;amp;sort=score+desc,id+asc&apos;&lt;/span&gt;
&lt;/span&gt;{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;responseHeader&quot;&lt;/span&gt;:{
    &lt;span class=&quot;code-quote&quot;&gt;&quot;status&quot;&lt;/span&gt;:0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;QTime&quot;&lt;/span&gt;:0,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;params&quot;&lt;/span&gt;:{
      &lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;inStock:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;fl&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;id,score&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;fq&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;cat:memory&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;sort&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;score desc,id asc&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;rq&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;{!rerank reRankQuery=id:VDBDB1A16}&quot;&lt;/span&gt;}},
  &lt;span class=&quot;code-quote&quot;&gt;&quot;response&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;numFound&quot;&lt;/span&gt;:3,&lt;span class=&quot;code-quote&quot;&gt;&quot;start&quot;&lt;/span&gt;:0,&lt;span class=&quot;code-quote&quot;&gt;&quot;maxScore&quot;&lt;/span&gt;:0.10401889,&lt;span class=&quot;code-quote&quot;&gt;&quot;numFoundExact&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;docs&quot;&lt;/span&gt;:[
      {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;VDBDB1A16&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;score&quot;&lt;/span&gt;:0.10401889},
      {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;TWINX2048-3200PRO&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;score&quot;&lt;/span&gt;:0.10401889},
      {
        &lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;VS1GB400C3&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;score&quot;&lt;/span&gt;:0.10401889}]
  }}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;(I&apos;m going to move this JIRA ticket across from LUCENE to SOLR for visibility and since this concerns the &lt;tt&gt;SolrIndexSearcher&lt;/tt&gt; class. Any use of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-9542&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/LUCENE-9542&lt;/a&gt; should then redirect seamlessly to the SOLR ticket.)&lt;/p&gt;</comment>
                            <comment id="17225544" author="cpoerschke" created="Tue, 3 Nov 2020 16:44:20 +0000"  >&lt;p&gt;Attached &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14983&quot; title=&quot;Score returned in search request is original score and not reranked score&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14983&quot;&gt;&lt;del&gt;SOLR-14983&lt;/del&gt;&lt;/a&gt;.patch file&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;has the proposed &lt;tt&gt;cmd.getQuery()&lt;/tt&gt; instead of &lt;tt&gt;query&lt;/tt&gt; fix&lt;/li&gt;
	&lt;li&gt;adds a &lt;tt&gt;testReranking&lt;/tt&gt; case into the existing &lt;tt&gt;SolrIndexSearcherTest&lt;/tt&gt; suite using &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Baik&quot; class=&quot;user-hover&quot; rel=&quot;Baik&quot;&gt;Baik&lt;/a&gt;&apos;s 0001-&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14983&quot; title=&quot;Score returned in search request is original score and not reranked score&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14983&quot;&gt;&lt;del&gt;LUCENE-9542&lt;/del&gt;&lt;/a&gt;-Unit-test-to-reproduce-bug.patch approach of a private &lt;tt&gt;RankQuery&lt;/tt&gt; class that produces known value scores.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;What do you think?&lt;/p&gt;</comment>
                            <comment id="17225605" author="baik" created="Tue, 3 Nov 2020 18:32:36 +0000"  >&lt;p&gt;Looks good on our side.&lt;/p&gt;</comment>
                            <comment id="17225923" author="krishan1390" created="Wed, 4 Nov 2020 08:20:55 +0000"  >&lt;p&gt;Yea looks good. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cpoerschke&quot; class=&quot;user-hover&quot; rel=&quot;cpoerschke&quot;&gt;cpoerschke&lt;/a&gt;&#160;and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Baik&quot; class=&quot;user-hover&quot; rel=&quot;Baik&quot;&gt;Baik&lt;/a&gt;&#160;for the fix and test cases.&#160;&lt;/p&gt;</comment>
                            <comment id="17225928" author="cpoerschke" created="Wed, 4 Nov 2020 08:40:27 +0000"  >&lt;p&gt;Attached unit test tweak:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the SolrIndexSearcher change is in two places yet the unit test previously did not reflect that. Either &lt;tt&gt;getDocListAndSetNC&lt;/tt&gt; or &lt;tt&gt;getDocListNC&lt;/tt&gt; is called based on the presence or absence of the &lt;tt&gt;GET_DOCSET&lt;/tt&gt; flag &#8211; e.g. &lt;a href=&quot;https://github.com/apache/lucene-solr/blob/releases/lucene-solr/8.7.0/solr/core/src/java/org/apache/solr/search/SolrIndexSearcher.java#L1406-L1414&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/releases/lucene-solr/8.7.0/solr/core/src/java/org/apache/solr/search/SolrIndexSearcher.java#L1406-L1414&lt;/a&gt; &#8211; and so the unit test now covers both flag possibilities.&lt;/li&gt;
&lt;/ul&gt;


&lt;hr /&gt;
&lt;p&gt;Looking ahead to patch commit time:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krishan1390&quot; class=&quot;user-hover&quot; rel=&quot;krishan1390&quot;&gt;krishan1390&lt;/a&gt;, do you have any preference as to &lt;tt&gt;solr/CHANGES.txt&lt;/tt&gt; attribution choice of name for yourself e.g. &quot;Krishan&quot; (current JIRA full name) or &quot;krishan1390&quot; (JIRA Username) or a variant of the two or something else perhaps? It&apos;s entirely your choice, different people use different styles e.g. &lt;a href=&quot;https://lucene.apache.org/solr/8_6_3/changes/Changes.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lucene.apache.org/solr/8_6_3/changes/Changes.html&lt;/a&gt; for the 8.6.3 release.&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=Baik&quot; class=&quot;user-hover&quot; rel=&quot;Baik&quot;&gt;Baik&lt;/a&gt;, I&apos;m going to assume you wish to use &quot;Jason Baik&quot; (current JIRA full name) for your &lt;tt&gt;solr/CHANGES.txt&lt;/tt&gt; attribution choice of name but if you prefer a different style, please let me know.&lt;/li&gt;
	&lt;li&gt;&quot;precommit&quot; checks now pass (two unused imports needed removing) and I&apos;m yet to fully run all the solr test suites but assuming they pass and if there&apos;s no further comments or concerns etc. here then I&apos;ll aim to commit the change middle of next week hopefully.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17228076" author="krishan1390" created="Sun, 8 Nov 2020 16:25:27 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cpoerschke&quot; class=&quot;user-hover&quot; rel=&quot;cpoerschke&quot;&gt;cpoerschke&lt;/a&gt;&#160;for your consideration to add my name. Can you please keep it as &quot;Krishan Goyal&quot;.&#160;&lt;/p&gt;</comment>
                            <comment id="17230620" author="jira-bot" created="Thu, 12 Nov 2020 13:15:17 +0000"  >&lt;p&gt;Commit 2f02040a4c45e4dfdb1f569ae05637c86f0f001b in lucene-solr&apos;s branch refs/heads/master from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=2f02040&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=2f02040&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14983&quot; title=&quot;Score returned in search request is original score and not reranked score&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14983&quot;&gt;&lt;del&gt;SOLR-14983&lt;/del&gt;&lt;/a&gt;: Fix response returning original score instead of reranked score due to query and filter combining.&lt;br/&gt;
(Krishan Goyal, Jason Baik, Christine Poerschke)&lt;/p&gt;</comment>
                            <comment id="17230622" author="jira-bot" created="Thu, 12 Nov 2020 13:20:51 +0000"  >&lt;p&gt;Commit ad27dd7c56e4f9e1d1828206e7595b557ed070cb in lucene-solr&apos;s branch refs/heads/branch_8x from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=ad27dd7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=ad27dd7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14983&quot; title=&quot;Score returned in search request is original score and not reranked score&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14983&quot;&gt;&lt;del&gt;SOLR-14983&lt;/del&gt;&lt;/a&gt;: Fix response returning original score instead of reranked score due to query and filter combining.&lt;br/&gt;
(Krishan Goyal, Jason Baik, Christine Poerschke)&lt;/p&gt;</comment>
                            <comment id="17230624" author="cpoerschke" created="Thu, 12 Nov 2020 13:22:41 +0000"  >&lt;p&gt;Thanks everyone!&lt;/p&gt;</comment>
                            <comment id="17535580" author="janhoy" created="Thu, 12 May 2022 00:26:43 +0000"  >&lt;p&gt;Closing after the 9.0.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13014381" name="0001-LUCENE-9542-Unit-test-to-reproduce-bug.patch" size="6019" author="Baik" created="Thu, 29 Oct 2020 20:43:38 +0000"/>
                            <attachment id="13014680" name="SOLR-14983.patch" size="6414" author="cpoerschke" created="Wed, 4 Nov 2020 08:38:05 +0000"/>
                            <attachment id="13014661" name="SOLR-14983.patch" size="6306" author="cpoerschke" created="Tue, 3 Nov 2020 16:43:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0ivf4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>