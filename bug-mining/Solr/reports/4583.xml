<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:46:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-14767] Adding document in XML format fails with NumberFormatException</title>
                <link>https://issues.apache.org/jira/browse/SOLR-14767</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Indexing the following document&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;doc&amp;gt; 
      &amp;lt;field name = &lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;&amp;gt;001&amp;lt;/field&amp;gt; 
      &amp;lt;field name = &lt;span class=&quot;code-quote&quot;&gt;&quot;stars_i&quot;&lt;/span&gt; &amp;gt;14.0&amp;lt;/field&amp;gt; 
 &amp;lt;/doc&amp;gt; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;fails with following stack trace&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
ERROR: [doc=001] Error adding field &lt;span class=&quot;code-quote&quot;&gt;&apos;stars_i&apos;&lt;/span&gt;=&lt;span class=&quot;code-quote&quot;&gt;&apos;14.0&apos;&lt;/span&gt; msg=For input string: &lt;span class=&quot;code-quote&quot;&gt;&quot;14.0&quot;&lt;/span&gt;
	at org.apache.solr.update.DocumentBuilder.toDocument(DocumentBuilder.java:221)
	at org.apache.solr.update.AddUpdateCommand.getLuceneDocument(AddUpdateCommand.java:109)
	at org.apache.solr.update.DirectUpdateHandler2.updateDocOrDocValues(DirectUpdateHandler2.java:975)
	at org.apache.solr.update.DirectUpdateHandler2.doNormalUpdate(DirectUpdateHandler2.java:341)
	at org.apache.solr.update.DirectUpdateHandler2.addDoc0(DirectUpdateHandler2.java:288)
	at org.apache.solr.update.DirectUpdateHandler2.addDoc(DirectUpdateHandler2.java:235)
	at org.apache.solr.update.processor.RunUpdateProcessorFactory$RunUpdateProcessor.processAdd(RunUpdateProcessorFactory.java:73)
	at org.apache.solr.update.processor.UpdateRequestProcessor.processAdd(UpdateRequestProcessor.java:55)
	at org.apache.solr.update.processor.NestedUpdateProcessorFactory$NestedUpdateProcessor.processAdd(NestedUpdateProcessorFactory.java:79)
	at org.apache.solr.update.processor.UpdateRequestProcessor.processAdd(UpdateRequestProcessor.java:55)
	at org.apache.solr.update.processor.DistributedUpdateProcessor.doLocalAdd(DistributedUpdateProcessor.java:259)
	at org.apache.solr.update.processor.DistributedUpdateProcessor.doVersionAdd(DistributedUpdateProcessor.java:498)
	at org.apache.solr.update.processor.DistributedUpdateProcessor.lambda$versionAdd$0(DistributedUpdateProcessor.java:339)
	at org.apache.solr.update.VersionBucket.runWithLock(VersionBucket.java:50)
	at org.apache.solr.update.processor.DistributedUpdateProcessor.versionAdd(DistributedUpdateProcessor.java:339)
	at org.apache.solr.update.processor.DistributedUpdateProcessor.processAdd(DistributedUpdateProcessor.java:225)
	at org.apache.solr.update.processor.DistributedZkUpdateProcessor.processAdd(DistributedZkUpdateProcessor.java:245)
	at org.apache.solr.update.processor.LogUpdateProcessorFactory$LogUpdateProcessor.processAdd(LogUpdateProcessorFactory.java:106)
	at org.apache.solr.update.processor.UpdateRequestProcessor.processAdd(UpdateRequestProcessor.java:55)
	at org.apache.solr.update.processor.AddSchemaFieldsUpdateProcessorFactory$AddSchemaFieldsUpdateProcessor.processAdd(AddSchemaFieldsUpdateProcessorFactory.java:481)
	at org.apache.solr.update.processor.UpdateRequestProcessor.processAdd(UpdateRequestProcessor.java:55)
	at org.apache.solr.update.processor.FieldMutatingUpdateProcessor.processAdd(FieldMutatingUpdateProcessor.java:118)
	at org.apache.solr.update.processor.UpdateRequestProcessor.processAdd(UpdateRequestProcessor.java:55)
	at org.apache.solr.update.processor.FieldMutatingUpdateProcessor.processAdd(FieldMutatingUpdateProcessor.java:118)
	at org.apache.solr.update.processor.UpdateRequestProcessor.processAdd(UpdateRequestProcessor.java:55)
	at org.apache.solr.update.processor.FieldMutatingUpdateProcessor.processAdd(FieldMutatingUpdateProcessor.java:118)
	at org.apache.solr.update.processor.UpdateRequestProcessor.processAdd(UpdateRequestProcessor.java:55)
	at org.apache.solr.update.processor.FieldMutatingUpdateProcessor.processAdd(FieldMutatingUpdateProcessor.java:118)
	at org.apache.solr.update.processor.UpdateRequestProcessor.processAdd(UpdateRequestProcessor.java:55)
	at org.apache.solr.update.processor.FieldNameMutatingUpdateProcessorFactory$1.processAdd(FieldNameMutatingUpdateProcessorFactory.java:75)
	at org.apache.solr.update.processor.UpdateRequestProcessor.processAdd(UpdateRequestProcessor.java:55)
	at org.apache.solr.update.processor.FieldMutatingUpdateProcessor.processAdd(FieldMutatingUpdateProcessor.java:118)
	at org.apache.solr.update.processor.UpdateRequestProcessor.processAdd(UpdateRequestProcessor.java:55)
	at org.apache.solr.update.processor.AbstractDefaultValueUpdateProcessorFactory$DefaultValueUpdateProcessor.processAdd(AbstractDefaultValueUpdateProcessorFactory.java:92)
	at org.apache.solr.handler.loader.XMLLoader.processUpdate(XMLLoader.java:263)
	at org.apache.solr.handler.loader.XMLLoader.load(XMLLoader.java:190)
	at org.apache.solr.handler.UpdateRequestHandler$1.load(UpdateRequestHandler.java:97)
	at org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:68)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:212)
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:2602)
	at org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:812)
	at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:588)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:437)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:351)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1596)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:545)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:590)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1610)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1300)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:485)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1580)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1215)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:221)
	at org.eclipse.jetty.server.handler.InetAccessHandler.handle(InetAccessHandler.java:177)
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:322)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:500)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:383)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:547)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:375)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:273)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:103)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:117)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:336)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:313)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:171)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:129)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:375)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:806)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:938)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834)
Caused by: java.lang.NumberFormatException: For input string: &lt;span class=&quot;code-quote&quot;&gt;&quot;14.0&quot;&lt;/span&gt;
	at java.base/java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.parseInt(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.java:652)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.parseInt(&lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.java:770)
	at org.apache.solr.schema.IntPointField.createField(IntPointField.java:149)
	at org.apache.solr.schema.PointField.createFields(PointField.java:251)
	at org.apache.solr.update.DocumentBuilder.addField(DocumentBuilder.java:65)
	at org.apache.solr.update.DocumentBuilder.toDocument(DocumentBuilder.java:172)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but same document successfully indexed with JSON format&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;001&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;stars_i&quot;&lt;/span&gt;: 14.0}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13323798">SOLR-14767</key>
            <summary>Adding document in XML format fails with NumberFormatException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="4" iconUrl="https://issues.apache.org/jira/images/icons/statuses/reopened.png" description="This issue was once resolved, but the resolution was deemed incorrect. From here issues are either marked assigned or resolved.">Reopened</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="munendrasn">Munendra S N</assignee>
                                    <reporter username="munendrasn">Munendra S N</reporter>
                        <labels>
                    </labels>
                <created>Thu, 20 Aug 2020 16:18:06 +0000</created>
                <updated>Wed, 4 Nov 2020 15:32:27 +0000</updated>
                                                                                <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="17181312" author="munendrasn" created="Thu, 20 Aug 2020 16:30:26 +0000"  >&lt;p&gt;This bug was encountered by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apoorvprecisely&quot; class=&quot;user-hover&quot; rel=&quot;apoorvprecisely&quot;&gt;apoorvprecisely&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also, Same document gets indexed when added as atomic update&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;doc&amp;gt; 
      &amp;lt;field name = &lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;&amp;gt;001&amp;lt;/field&amp;gt; 
      &amp;lt;field name = &lt;span class=&quot;code-quote&quot;&gt;&quot;stars_i&quot;&lt;/span&gt;  update=&lt;span class=&quot;code-quote&quot;&gt;&quot;add&quot;&lt;/span&gt;&amp;gt;14.0&amp;lt;/field&amp;gt; 
 &amp;lt;/doc&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In case of XML, all values are parsed as string and then converted to required type based on field type&lt;/p&gt;

&lt;p&gt;It works in case of atomic update because, the value is first converted to integer using &lt;tt&gt;toNativeType&lt;/tt&gt; and then atomic update is applied. The &lt;tt&gt;toNativeType&lt;/tt&gt; handles converting String to integer, if it fails falls back to parsing float and then getting integer value&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Override
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; toNativeType(&lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; val) {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (val == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (val &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt;) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; ((&lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt;) val).intValue();
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (val &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; CharSequence) &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.parseInt( val.toString());
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (NumberFormatException e) {
      &lt;span class=&quot;code-object&quot;&gt;Float&lt;/span&gt; v = &lt;span class=&quot;code-object&quot;&gt;Float&lt;/span&gt;.parseFloat(val.toString());
      &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; v.intValue();
    }
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.toNativeType(val);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;In case, full document indexing(non-atomic update) the IndexableField is created using &lt;tt&gt;createField&lt;/tt&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
@Override
  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; IndexableField createField(SchemaField field, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; value) {
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; intValue = (value &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt;) ? ((&lt;span class=&quot;code-object&quot;&gt;Number&lt;/span&gt;) value).intValue() : &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt;.parseInt(value.toString());
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; IntPoint(field.getName(), intValue);
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The same problem exist with LongPoint, TrieInt and TrieLong fields.&lt;/p&gt;</comment>
                            <comment id="17203948" author="jira-bot" created="Tue, 29 Sep 2020 13:57:42 +0000"  >&lt;p&gt;Commit 63f0b6b706dcbc8e92a8ff3ee8b81d6d6900aa67 in lucene-solr&apos;s branch refs/heads/master from Apoorv Bhawsar&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=63f0b6b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=63f0b6b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14767&quot; title=&quot;Adding document in XML format fails with NumberFormatException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14767&quot;&gt;SOLR-14767&lt;/a&gt; : Fix NumberFormatException when int/long field value is floating num (#1775)&lt;/p&gt;
</comment>
                            <comment id="17203965" author="jira-bot" created="Tue, 29 Sep 2020 14:12:24 +0000"  >&lt;p&gt;Commit b2028defdc035b6a55b9ce0abf9e049f60f05dc6 in lucene-solr&apos;s branch refs/heads/branch_8x from Apoorv Bhawsar&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=b2028de&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=b2028de&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14767&quot; title=&quot;Adding document in XML format fails with NumberFormatException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14767&quot;&gt;SOLR-14767&lt;/a&gt; : Fix NumberFormatException when int/long field value is floating num (#1775)&lt;/p&gt;
</comment>
                            <comment id="17203979" author="munendrasn" created="Tue, 29 Sep 2020 14:25:48 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=apoorvprecisely&quot; class=&quot;user-hover&quot; rel=&quot;apoorvprecisely&quot;&gt;apoorvprecisely&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17203999" author="dsmiley" created="Tue, 29 Sep 2020 14:54:48 +0000"  >&lt;p&gt;FWIW this looks a lot more like an &quot;Improvement&quot; than a &quot;Bug&quot;.&lt;/p&gt;</comment>
                            <comment id="17204006" author="munendrasn" created="Tue, 29 Sep 2020 14:59:11 +0000"  >&lt;p&gt;This already works with atomic updates(updating existing field value) but not with adding new document with the field. Since, it had different behavior, I thought it should probably be considered as bug. Let me know if you think otherwise, I will move it to improvement&lt;/p&gt;</comment>
                            <comment id="17204172" author="hossman" created="Tue, 29 Sep 2020 17:50:21 +0000"  >&lt;p&gt;This change has broken JsonLoaderTest causing reliably reproducing jenkins failures...&lt;/p&gt;

&lt;p&gt;Passess...&#160;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@slate:~/lucene/dev [j11] [*master] $ git co 1dba76c0d31b6f0294c1f257e5a1fc51a722b82f
...
hossman@slate:~/lucene/dev [j11] [DIRTY:1dba76c0d31] $ ./gradlew :solr:core:test --tests &quot;org.apache.solr.handler.JsonLoaderTest&quot; -Ptests.jvms=6 -Ptests.haltonfailure=false -Ptests.jvmargs=&apos;-XX:+UseCompressedOops -XX:+UseSerialGC&apos; -Ptests.seed=B65FB0896CCB43ED -Ptests.multiplier=3 -Ptests.badapples=false -Ptests.file.encoding=US-ASCII
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Fails...&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@slate:~/lucene/dev [j11] [DIRTY:1dba76c0d31] $ git co 63f0b6b706dcbc8e92a8ff3ee8b81d6d6900aa67
...
hossman@slate:~/lucene/dev [j11] [DIRTY:63f0b6b706d] $ ./gradlew :solr:core:test --tests &quot;org.apache.solr.handler.JsonLoaderTest&quot; -Ptests.jvms=6 -Ptests.haltonfailure=false -Ptests.jvmargs=&apos;-XX:+UseCompressedOops -XX:+UseSerialGC&apos; -Ptests.seed=B65FB0896CCB43ED -Ptests.multiplier=3 -Ptests.badapples=false -Ptests.file.encoding=US-ASCII
...
org.apache.solr.handler.JsonLoaderTest &amp;gt; testAddBigIntegerValueToTrieField FAILED
    junit.framework.AssertionFailedError: Expected exception SolrException but no exception was thrown
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17204177" author="munendrasn" created="Tue, 29 Sep 2020 18:02:32 +0000"  >&lt;p&gt;Looking into this&lt;/p&gt;</comment>
                            <comment id="17204190" author="jira-bot" created="Tue, 29 Sep 2020 18:23:36 +0000"  >&lt;p&gt;Commit 274a3d69d29a811f459b1c898eb4497168ee2156 in lucene-solr&apos;s branch refs/heads/master from Munendra S N&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=274a3d6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=274a3d6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Revert &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14767&quot; title=&quot;Adding document in XML format fails with NumberFormatException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14767&quot;&gt;SOLR-14767&lt;/a&gt; : Fix NumberFormatException when int/long field value is floating num&quot;&lt;/p&gt;

&lt;p&gt;This reverts commit 63f0b6b706dcbc8e92a8ff3ee8b81d6d6900aa67.&lt;/p&gt;</comment>
                            <comment id="17204191" author="jira-bot" created="Tue, 29 Sep 2020 18:25:57 +0000"  >&lt;p&gt;Commit 22cdd55cdf64086f0a7215c8de0536634ace5f93 in lucene-solr&apos;s branch refs/heads/branch_8x from S N Munendra&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=22cdd55&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=22cdd55&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Revert &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14767&quot; title=&quot;Adding document in XML format fails with NumberFormatException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14767&quot;&gt;SOLR-14767&lt;/a&gt; : Fix NumberFormatException when int/long field value is floating num&quot;&lt;/p&gt;

&lt;p&gt;This reverts commit b2028defdc035b6a55b9ce0abf9e049f60f05dc6.&lt;/p&gt;</comment>
                            <comment id="17204196" author="munendrasn" created="Tue, 29 Sep 2020 18:35:15 +0000"  >&lt;p&gt;For now, I have reverted the change as I&apos;m not sure what should be the right fix&lt;/p&gt;

&lt;p&gt;When string is passed, the value is parsed as long and if it fails then fallback is to parse it as Double and then long value. In the affected test, BigInteger was passed which is parsed as String in JsonLoader &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4891&quot; title=&quot;JsonLoader should preserve field value types from the JSON content stream&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4891&quot;&gt;&lt;del&gt;SOLR-4891&lt;/del&gt;&lt;/a&gt;. Previously, Long.parserLong used to fail with NFE but here, we are parsing it as double as fallback which caused the test failure&lt;/p&gt;

&lt;p&gt;Parsing BigInteger for long and int fields were expected to fail with that I think we fix current JIRA but again, the behavior for atomic update(toNativeType is called first which has fallback) vs full new doc indexing is different(no fallback)&lt;/p&gt;

&lt;p&gt;I&apos;m not sure what would be best approach - should we remove fallback from toNativeType too?&lt;/p&gt;

&lt;p&gt;I ran all update related tests before committing but didn&apos;t run the whole test suite, apologies for  breaking the build&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 7 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0hyhs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>