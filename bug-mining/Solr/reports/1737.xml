<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:45:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5679] Shard splitting fails with ClassCastException on clusterstate.json with router as string</title>
                <link>https://issues.apache.org/jira/browse/SOLR-5679</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5246&quot; title=&quot;Shard splitting should support collections configured with a hash router and routeField.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5246&quot;&gt;&lt;del&gt;SOLR-5246&lt;/del&gt;&lt;/a&gt; added support for splitting collections configured with a router.field but the fix was not back-compatible.&lt;/p&gt;

&lt;p&gt;After upgrading an old SolrCloud cluster to 4.6 or 4.6.1, shard splitting can fail with the following message:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;ERROR o.a.s.handler.admin.CoreAdminHandler - ERROR executing split:&lt;br/&gt;
java.lang.ClassCastException: java.lang.String cannot be cast to java.util.Map&lt;br/&gt;
        at org.apache.solr.handler.admin.CoreAdminHandler.handleSplitAction(CoreAdminHandler.java:285) &lt;span class=&quot;error&quot;&gt;&amp;#91;solr-core-4.6.1.jar:4.6.1 1560866 - mark - 2014-01-23 20:21:50&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.solr.handler.admin.CoreAdminHandler.handleRequestBody(CoreAdminHandler.java:193) &lt;span class=&quot;error&quot;&gt;&amp;#91;solr-core-4.6.1.jar:4.6.1 1560866 - mark - 2014-01-23 20:21:50&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135) &lt;span class=&quot;error&quot;&gt;&amp;#91;solr-core-4.6.1.jar:4.6.1 1560866 - mark - 2014-01-23 20:21:50&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This happens because the cluster state still contains the router as a string. The clusterstate.json is supposed to auto-upgrade if cluster state is upgraded but according to the user report that did not happen. In any case, we need to fix the core admin split.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12692280">SOLR-5679</key>
            <summary>Shard splitting fails with ClassCastException on clusterstate.json with router as string</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="shalin">Shalin Shekhar Mangar</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 Jan 2014 14:08:50 +0000</created>
                <updated>Wed, 2 Oct 2019 17:24:40 +0000</updated>
                            <resolved>Thu, 30 Jan 2014 16:10:31 +0000</resolved>
                                    <version>4.6</version>
                    <version>4.6.1</version>
                                    <fixVersion>4.7</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13886703" author="jira-bot" created="Thu, 30 Jan 2014 16:06:51 +0000"  >&lt;p&gt;Commit 1562872 from shalin@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1562872&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1562872&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5679&quot; title=&quot;Shard splitting fails with ClassCastException on clusterstate.json with router as string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5679&quot;&gt;&lt;del&gt;SOLR-5679&lt;/del&gt;&lt;/a&gt;: &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5679&quot; title=&quot;Shard splitting fails with ClassCastException on clusterstate.json with router as string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5679&quot;&gt;&lt;del&gt;SOLR-5679&lt;/del&gt;&lt;/a&gt;: Shard splitting fails with ClassCastException on collections upgraded from 4.5 and earlier versions&lt;/p&gt;</comment>
                            <comment id="13886707" author="jira-bot" created="Thu, 30 Jan 2014 16:08:49 +0000"  >&lt;p&gt;Commit 1562873 from shalin@apache.org in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1562873&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1562873&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5679&quot; title=&quot;Shard splitting fails with ClassCastException on clusterstate.json with router as string&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5679&quot;&gt;&lt;del&gt;SOLR-5679&lt;/del&gt;&lt;/a&gt;: Shard splitting fails with ClassCastException on collections upgraded from 4.5 and earlier versions&lt;/p&gt;</comment>
                            <comment id="13886710" author="shalinmangar" created="Thu, 30 Jan 2014 16:10:31 +0000"  >&lt;p&gt;This is fixed.&lt;/p&gt;

&lt;p&gt;I&apos;ll investigate the auto-upgrade of clusterstate.json separately.&lt;/p&gt;</comment>
                            <comment id="13906475" author="bretthoerner" created="Thu, 20 Feb 2014 01:51:21 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;, is there a ticket for the auto-upgrade of clusterstate?&lt;/p&gt;

&lt;p&gt;Thanks a lot for this patch, btw!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>370875</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 39 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1rx3b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>371180</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>