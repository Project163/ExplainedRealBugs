<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:39:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-13490] waitForState/registerCollectionStateWatcher can see stale liveNodes data due to (Zk) Watcher race condition</title>
                <link>https://issues.apache.org/jira/browse/SOLR-13490</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I was investigating some failures in &lt;tt&gt;TestCloudSearcherWarming.testRepFactor1LeaderStartup&lt;/tt&gt; which lead me to the hunch that &lt;tt&gt;waitForState&lt;/tt&gt; wasn&apos;t ensuring that the predicates registered would always be called if/when a node was shutdown.&lt;/p&gt;

&lt;p&gt;Digging into it a bit more, I found that the root cause seems to be the way the &lt;tt&gt;CollectionStateWatcher&lt;/tt&gt; / &lt;tt&gt;CollectionStatePredicate&lt;/tt&gt; APIs pass in &lt;b&gt;both&lt;/b&gt; the &lt;tt&gt;DocCollection&lt;/tt&gt;, and the &quot;current&quot; &lt;tt&gt;liveNodes&lt;/tt&gt; - but are only &lt;em&gt;triggered&lt;/em&gt; by the &lt;tt&gt;StateWatcher&lt;/tt&gt; on the &lt;tt&gt;state.json&lt;/tt&gt; (which is used to rebuild the &lt;tt&gt;DocCollection&lt;/tt&gt;) - when the &lt;tt&gt;CollectionStateWatcher&lt;/tt&gt; / &lt;tt&gt;CollectionStatePredicate&lt;/tt&gt; are called, they get the &quot;fresh&quot; &lt;tt&gt;DocCollection&lt;/tt&gt; but they get the &lt;em&gt;cached&lt;/em&gt; &lt;tt&gt;ZkStateReader.liveNodes&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Meanwhile, the &lt;tt&gt;LiveNodeWatcher&lt;/tt&gt; only calls &lt;tt&gt;refreshLiveNodes()&lt;/tt&gt; only updates &lt;tt&gt;ZkStateReader.liveNodes&lt;/tt&gt; and triggers any &lt;tt&gt;LiveNodesListener&lt;/tt&gt; - it does &lt;b&gt;NOT&lt;/b&gt; invoke any &lt;tt&gt;CollectionStateWatcher&lt;/tt&gt; that may have replicas hosted on any of changed nodes.&lt;/p&gt;

&lt;p&gt;Since there is no garunteed order that Watchers will be triggered, this means there is a race condition where the following can happen...&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;client1 has a ZkStateReader with cached &lt;tt&gt;liveNodes=&lt;span class=&quot;error&quot;&gt;&amp;#91;N1, N2, N3&amp;#93;&lt;/span&gt;&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;client1 registers a &lt;tt&gt;CollectionStateWatcher&lt;/tt&gt; &quot;watcherZ&quot; that cares if &quot;replicaX&quot; of collectionA is on a &quot;down&quot; node&lt;/li&gt;
	&lt;li&gt;client2 causes shutdown of node N1 which is hosting replicaX&lt;/li&gt;
	&lt;li&gt;client1&apos;s zkStateReader gets a WatchedEvent for state.json of collectionA
	&lt;ul&gt;
		&lt;li&gt;DocCollection for collectionA is rebuilt&lt;/li&gt;
		&lt;li&gt;watcherZ is fired w/cached &lt;tt&gt;liveNodes=&lt;span class=&quot;error&quot;&gt;&amp;#91;N1, N2, N3&amp;#93;&lt;/span&gt;&lt;/tt&gt; and the new DocCollection
		&lt;ul&gt;
			&lt;li&gt;watcherZ sees that replicaX is on N1, but thinks N1 is live&lt;/li&gt;
			&lt;li&gt;watcherZ says &quot;everything ok, not the event i was waiting for&quot; and doesn&apos;t take any action&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;client1&apos;s zkStateReader gets a WatchedEvent for LIVE_NODES_ZKNODE
	&lt;ul&gt;
		&lt;li&gt;zkStateReader.liveNodes is rebuilt&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;...at no point in this sequence (or after this) will watcherZ be notified fired with the updated liveNodes (unless/until another &lt;tt&gt;state.json&lt;/tt&gt; change is made for collectionA.&lt;/p&gt;
&lt;hr /&gt;
&lt;p&gt;While this is definitely be problematic in &lt;em&gt;tests&lt;/em&gt; that deal with node lifecyle and use things like &lt;tt&gt;SolrCloudTestCase.waitForState(..., SolrCloudTestCase.clusterShape(...))&lt;/tt&gt; to check for the expected shards/replicas, a cursory search of how/where &lt;tt&gt;ZkStateReader.waitForState(...)&lt;/tt&gt; and &lt;tt&gt;ZkStateReader.registerCollectionStateWatcher(...)&lt;/tt&gt; are used in solr-core suggests that could also lead to bad behavior in situations like reacting to shard leader loss, waiting for all leaders of SYSTEM_COLL to come online for upgrade, running PrepRecoveryOp, etc... (anywhere that liveNodes is used by the watcher/predicate)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13235562">SOLR-13490</key>
            <summary>waitForState/registerCollectionStateWatcher can see stale liveNodes data due to (Zk) Watcher race condition</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Sat, 25 May 2019 00:03:10 +0000</created>
                <updated>Fri, 26 Jul 2019 08:56:25 +0000</updated>
                            <resolved>Mon, 17 Jun 2019 19:44:14 +0000</resolved>
                                                    <fixVersion>8.2</fixVersion>
                    <fixVersion>9.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16847971" author="hossman" created="Sat, 25 May 2019 00:04:34 +0000"  >
&lt;p&gt;I&apos;m attaching a test case i started working up before i fully understood that problem that explicitly tests:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;calling waitForState w/a predicate that cares about liveNodes after we are confident a jetty node has completed shutdown&lt;/li&gt;
	&lt;li&gt;calling waitForState w/a predicate that uses a countdown latch so we can be sure we don&apos;t shut down jetty until after the watcher has been set and the initial &quot;sanity checks&quot; of the predicate have been called&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;The first test passes reliable because there is no bug in that situation, but the second can easily fail &amp;#8211; allthouh not 100% reliably &amp;#8211; w/beasting due to the race condition of what order the WatchedEvents (state.json vs liveNodes) get processed.&lt;/p&gt;

&lt;p&gt;(FWIW: It should be possible to write a third test where we register a &lt;tt&gt;CollectionStateWatcher&lt;/tt&gt; that &lt;b&gt;only&lt;/b&gt; cares about liveNodes, and shutdown a node that isn&apos;t even part of the collection and assert the watcher gets triggered.  Atest like that would be garunteed to fail based on how ZkStateReader currently works, but i don&apos;t think it would really be valid test given the javadocs/implications of how &lt;tt&gt;CollectionStateWatcher&lt;/tt&gt; (and &lt;tt&gt;CollectionStatePredicate&lt;/tt&gt; ) are mean to be used ... nothing about them suggests that they will be called on any liveNode change &amp;#8211; just that when there is a &lt;em&gt;collection&lt;/em&gt; state change, the liveNodes will be current&lt;/p&gt;</comment>
                            <comment id="16847973" author="hossman" created="Sat, 25 May 2019 00:07:26 +0000"  >&lt;p&gt;Here are some half thought out solutions for this problem in general...&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;&lt;tt&gt;StateWatcher.process()&lt;/tt&gt; (and &lt;tt&gt;LegacyClusterStateWatcher.process()&lt;/tt&gt; ) could forcibly call &lt;tt&gt;updateLiveNodes()&lt;/tt&gt; before evaluating the &lt;tt&gt;CollectionWatch&amp;lt;CollectionStateWatcher&amp;gt;&lt;/tt&gt; instances for the collection(s)&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;refreshLiveNodes(...)&lt;/tt&gt; could (in the &apos;fire listeners&apos; block) compute &lt;tt&gt;oldLiveNodes xor newLiveNodes&lt;/tt&gt; then loop over every &lt;tt&gt;DocCollection&lt;/tt&gt; in &lt;tt&gt;legacyCollectionStates&lt;/tt&gt; and &lt;tt&gt;watchedCollectionStates&lt;/tt&gt; and evaluated the &lt;tt&gt;CollectionWatch&amp;lt;CollectionStateWatcher&amp;gt;&lt;/tt&gt; instances for any collection with a replica on one of hte affected nodes&lt;/li&gt;
	&lt;li&gt;Deprecate/Redesign the &lt;tt&gt;CollectionStateWatcher&lt;/tt&gt; API so that instead of &lt;tt&gt;boolean onStateChanged(Set&amp;lt;String&amp;gt; liveNodes, DocCollection collectionState); }} we have {{boolean onStateChanged(ZkStateReader stateReader, DocCollection collectionState); }} ... impls that care about the live nodes can call {{stateReader.updateLiveNodes()&lt;/tt&gt; themselves (although that method would also need to be changed to return &lt;tt&gt;Set&amp;lt;String&amp;gt;&lt;/tt&gt; instead of &lt;tt&gt;void&lt;/tt&gt; but that seems like a good idea in general.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;...&lt;/p&gt;

&lt;p&gt;All of these have their pros/cons in terms of human work to make the change vs wasted CPU cost ... although I wonder if there could be a good hybrid between #2 and #3 where we:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;add a new (simplified) versions of &lt;tt&gt;CollectionStateWatcher&lt;/tt&gt; / &lt;tt&gt;CollectionStatePredicate&lt;/tt&gt; that are &lt;b&gt;only&lt;/b&gt; told to know about the (updated) &lt;tt&gt;DocCollection&lt;/tt&gt;
	&lt;ul&gt;
		&lt;li&gt;For now assume we&apos;d call them &lt;tt&gt;DocCollectionWatcher&lt;/tt&gt; &amp;amp; &lt;tt&gt;DocCollectionPredicate&lt;/tt&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;switch as many instances as possible to this new API if they don&apos;t care about live nodes&lt;/li&gt;
	&lt;li&gt;refactor the existing &lt;tt&gt;ZkStateReader.registerCollectionStateWatcher(...)&lt;/tt&gt; impl to automatically create &amp;amp; register both a &lt;tt&gt;LiveNodesListener&lt;/tt&gt; and &lt;tt&gt;DocCollectionWatcher&lt;/tt&gt; wrapper around any client specified &lt;tt&gt;CollectionStateWatcher&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;?&lt;/p&gt;</comment>
                            <comment id="16848230" author="jira-bot" created="Sat, 25 May 2019 15:44:17 +0000"  >&lt;p&gt;Commit 94657636281d93dc9918e212d3bc3c07a4f9d3d3 in lucene-solr&apos;s branch refs/heads/branch_8x from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=9465763&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=9465763&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Fix TestCloudSearcherWarming to work around &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13490&quot; title=&quot;waitForState/registerCollectionStateWatcher can see stale liveNodes data due to (Zk) Watcher race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13490&quot;&gt;&lt;del&gt;SOLR-13490&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also clean up some crufty System.out/System.err pollution&lt;/p&gt;

&lt;p&gt;(cherry picked from commit af4e1d324a389bac8cfcbffcbef20d4647957a61)&lt;/p&gt;</comment>
                            <comment id="16848231" author="jira-bot" created="Sat, 25 May 2019 15:44:22 +0000"  >&lt;p&gt;Commit af4e1d324a389bac8cfcbffcbef20d4647957a61 in lucene-solr&apos;s branch refs/heads/master from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=af4e1d3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=af4e1d3&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Fix TestCloudSearcherWarming to work around &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13490&quot; title=&quot;waitForState/registerCollectionStateWatcher can see stale liveNodes data due to (Zk) Watcher race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13490&quot;&gt;&lt;del&gt;SOLR-13490&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Also clean up some crufty System.out/System.err pollution&lt;/p&gt;</comment>
                            <comment id="16850933" author="gus_heck" created="Wed, 29 May 2019 15:01:36 +0000"  >&lt;p&gt;I tend to like #3 because it simplifies the API such that it&apos;s only watching one thing at a time which is simpler. Your hypothetical watcher sounds like it wants to watch two things (live nodes and state) and I like the solution to not conflate the two items. The watcher can watch one or the other and query when it sees a change, or it can watch both and keep a state machine if it prefers. The watching code will know which strategy is best/most efficient for whatever it does (or get it wrong, but not require changes to zkStateReader when that&apos;s discovered). Passing back the ZkStateReader is likely redundant for code that has set a watch (via a reference zkStateReader it already holds)&lt;/p&gt;</comment>
                            <comment id="16862363" author="hossman" created="Wed, 12 Jun 2019 18:39:09 +0000"  >&lt;blockquote&gt;&lt;p&gt;Your hypothetical watcher sounds like it wants to watch two things (live nodes and state) and I like the solution to not conflate the two items. ...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The problem is this isn&apos;t hypothetical: there are already lots of uses of CollectionStateWatcher in the code base (not to mention the &lt;b&gt;additional&lt;/b&gt; hypothetical end user use cases via the existing CloudSolrClient&apos;s public API) that care about both the liveNodes and the DocCollection instance (mostly because it&apos;s imposible to know if a replica listed in DocCollection is &quot;active&quot; w/o consulting liveNodes).&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The watcher can watch one or the other and query when it sees a change, ...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The problem with &quot;Watch X, and then ask ZkStateReader for Y when notified about X&quot; is that Y might not be updated in the local state until &lt;b&gt;after&lt;/b&gt; the notification of X happens &#8211; Anybody that cares about both X &amp;amp; Y really &lt;em&gt;must&lt;/em&gt; watch both. (the watcher could ignores the local data in ZkStateReader and do a &quot;force refresh&quot; of data from ZK, but that&apos;s more intensive on ZK then just waiting on a second watcher, and still doesn&apos;t garuntee it won&apos;t &apos;miss&apos; updates to Y that happen on the quorum &lt;em&gt;after&lt;/em&gt; the watcher for X fires) ...&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;... or it can watch both and keep a state machine if it prefers.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;but since ZkStateReader already has (public) watch/predicate APIs that &lt;em&gt;imply&lt;/em&gt; they &quot;watch&quot; both liveNodes &amp;amp; a DocCollection (and have callback methods that pass both as args), I&apos;m starting to come around to thinking that the best solution is:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;&quot;Fix&quot; and Keep (and clearly document) the existing CollectionStateWatcher/Predicate based APIs to &quot;notify&quot; on &lt;b&gt;both&lt;/b&gt; DocCollection &lt;em&gt;and&lt;/em&gt; liveNode changes&lt;/li&gt;
	&lt;li&gt;For clients that don&apos;t care about liveNodes, add newer &amp;amp; simpler Watcher/Predicate APIs that &lt;b&gt;only&lt;/b&gt; notify on changes to the DocCollection.&lt;/li&gt;
	&lt;li&gt;Update javadocs to encourage people to use the most restrictive Watchers/Predicates for their usecase&lt;/li&gt;
&lt;/ol&gt;


&lt;hr /&gt;
&lt;p&gt;These changes aren&apos;t actually as hard/complex as i initially imagined they would be when i initially speculated about them &#8211; I&apos;m attaching a new patch that &quot;fixes&quot; ZkStateReader by:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;add new DocCollectionWatcher &amp;amp; DocCollectionPredicate interfaces&lt;/li&gt;
	&lt;li&gt;add new registerDocCollectionWatcher(...), removeDocCollectionWatcher(...) &amp;amp; waitForState(..., DocCollectionPredicate) impls in ZkStateReader&lt;/li&gt;
	&lt;li&gt;refactor the existing CollectionStateWatcher &amp;amp; CollectionStatePredicate methods in ZkStateReader to be syntactic sugar around using a DocCollectionWatcher + LiveNodesListener.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;On the testing side:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;patch includes my earlier TestWaitForStateWithJettyShutdowns&lt;/li&gt;
	&lt;li&gt;all existing tests in TestCollectionStateWatchers still pass (AFAICT ... haven&apos;t beasted agressively yet)
	&lt;ul&gt;
		&lt;li&gt;added additional testing showing that liveNode changes are enough to ensure that CollectionStateWatchers are notified.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Still TODO...&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;add&#160;DocCollectionWatcher &amp;amp; DocCollectionPredicate impls to CloudSolrClient and update javadocs of existing methods similar to changes already made in ZkStateReader&lt;/li&gt;
	&lt;li&gt;clone TestCollectionStateWatchers into TestDocCollectionWatcher and modify to test the new simplified API directly&lt;/li&gt;
	&lt;li&gt;audit all existing uses of CollectionStateWatchers and waitForState throughout the code base:
	&lt;ul&gt;
		&lt;li&gt;see what existing impls/callers don&apos;t care about liveNodes and can be refactored to use the new lighter weight methods&lt;/li&gt;
		&lt;li&gt;add new static factory helpers (like &quot;clusterShape(...)&quot;) when appropriate&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;hr /&gt;
&lt;p&gt;I&apos;m planning to keep moving forward on this ... any feedback/concerns on the API/impl/docs would be apprecaited.&lt;/p&gt;</comment>
                            <comment id="16863561" author="hossman" created="Fri, 14 Jun 2019 00:11:09 +0000"  >
&lt;p&gt;Update patch...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;added DocCollectionWatcher &amp;amp; DocCollectionPredicate watch/waitFor impls to CloudSolrClient and updated javadocs of existing methods&lt;/li&gt;
	&lt;li&gt;cloned TestCollectionStateWatchers into TestDocCollectionWatcher and modify to test the new simplified API&lt;/li&gt;
	&lt;li&gt;optimize several existing uses of CollectionStateWatcher/CollectionStatePredicate &amp;#8211; that don&apos;t care about liveNodes &amp;#8211; to use the new simplified APIs instead&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;NOTE: I didn&apos;t bother trying to update every &lt;em&gt;test&lt;/em&gt; that uses CollectionStateWatcher/CollectionStatePredicate but doesn&apos;t care about liveNodes ... there are a lot of them to go through, for not much gain, and I didn&apos;t want the patch to get out of hand.&lt;/p&gt;

&lt;p&gt;(Most of them use the MiniSolrCloudCluster helper method for waitforState(...) which periodically logs &amp;#8211; and fails with details of &amp;#8211; both the the liveNodes and DocCollection in the event of failure, which may be useful info even if the caller doesn&apos;t pass a predicate that actaully cares about liveNodes ... so not a slame dunk that it would make sense to change in every situation)&lt;/p&gt;

&lt;hr /&gt;

&lt;p&gt;I think this is good to go unless there are any objections.&lt;/p&gt;</comment>
                            <comment id="16863964" author="lucenesolrqa" created="Fri, 14 Jun 2019 11:45:58 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/error.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;red&quot;&gt;-1 overall&lt;/font&gt;&lt;/b&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Vote &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Runtime &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Comment &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; Prechecks &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; test4tests &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m  0s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; The patch appears to include 5 new or modified test files. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; master Compile Tests &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; compile &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  5m 34s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; master passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; Patch Compile Tests &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; compile &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  5m 10s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; javac &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  5m 10s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; Release audit (RAT) &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  3m 44s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; Check forbidden APIs &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  3m 10s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; Validate source patterns &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  3m 10s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; Other Tests &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt;-1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt; unit &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt; 91m  9s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;red&quot;&gt; core in the patch failed. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; unit &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 14m 37s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; solrj in the patch passed. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; unit &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 25s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; test-framework in the patch passed. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt;&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt;122m 44s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Reason &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Tests &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Failed junit tests &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; solr.cloud.AliasIntegrationTest &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Report/Notes &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JIRA Issue &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13490&quot; title=&quot;waitForState/registerCollectionStateWatcher can see stale liveNodes data due to (Zk) Watcher race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13490&quot;&gt;&lt;del&gt;SOLR-13490&lt;/del&gt;&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JIRA Patch URL &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12971740/SOLR-13490.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12971740/SOLR-13490.patch&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Optional Tests &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  compile  javac  unit  ratsources  checkforbiddenapis  validatesourcepatterns  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; uname &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Linux lucene2-us-west.apache.org 4.4.0-112-generic #135-Ubuntu SMP Fri Jan 19 11:48:36 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Build tool &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; ant &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Personality &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; /home/jenkins/jenkins-slave/workspace/PreCommit-SOLR-Build/sourcedir/dev-tools/test-patch/lucene-solr-yetus-personality.sh &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; git revision &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; master / 81e8b38 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; ant &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; version: Apache Ant(TM) version 1.9.6 compiled on July 20 2018 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Default Java &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; LTS &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; unit &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/job/PreCommit-SOLR-Build/435/artifact/out/patch-unit-solr_core.txt&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-SOLR-Build/435/artifact/out/patch-unit-solr_core.txt&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  Test Results &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/job/PreCommit-SOLR-Build/435/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-SOLR-Build/435/testReport/&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; modules &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; C: solr/core solr/solrj solr/test-framework U: solr &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Console output &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/job/PreCommit-SOLR-Build/435/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-SOLR-Build/435/console&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Powered by &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Apache Yetus 0.7.0   &lt;a href=&quot;http://yetus.apache.org&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://yetus.apache.org&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;



&lt;p&gt;This message was automatically generated.&lt;/p&gt;
</comment>
                            <comment id="16864472" author="hossman" created="Fri, 14 Jun 2019 21:55:28 +0000"  >&lt;p&gt;Gah ... it jus occured to me i shouldn&apos;t be adding a &lt;tt&gt;DocCollectionPredicate&lt;/tt&gt; interface &amp;#8211; we should just be using a &lt;tt&gt;java.util.function.Predicate&amp;lt;DocCollection&amp;gt;&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;I&apos;ll work on simplify the patch in this way...&lt;/p&gt;</comment>
                            <comment id="16864513" author="hossman" created="Fri, 14 Jun 2019 23:10:09 +0000"  >&lt;p&gt;patch updated to use java.util.function.Predicate ... still beasting...&lt;/p&gt;</comment>
                            <comment id="16864604" author="lucenesolrqa" created="Sat, 15 Jun 2019 05:25:03 +0000"  >&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/check.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;b&gt;&lt;font color=&quot;green&quot;&gt;+1 overall&lt;/font&gt;&lt;/b&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Vote &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Runtime &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Comment &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; Prechecks &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; test4tests &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m  0s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; The patch appears to include 5 new or modified test files. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; master Compile Tests &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; compile &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  2m 38s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; master passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; Patch Compile Tests &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; compile &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  2m 31s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; javac &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  2m 31s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; Release audit (RAT) &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  2m  6s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; Check forbidden APIs &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  1m 53s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; Validate source patterns &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  1m 53s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; the patch passed &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt;&amp;nbsp;&lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; &lt;font color=&quot;brown&quot;&gt; Other Tests &lt;/font&gt; &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; unit &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; 49m  0s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; core in the patch passed. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; unit &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  6m 44s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; solrj in the patch passed. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;+1&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; unit &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt;  0m 32s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;green&quot;&gt; test-framework in the patch passed. &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt;&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; &lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; 64m 31s&lt;/font&gt; &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;font color=&quot;black&quot;&gt; &lt;/font&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;

&lt;p&gt;&lt;br class=&quot;atl-forced-newline&quot; /&gt;
&lt;br class=&quot;atl-forced-newline&quot; /&gt;&lt;/p&gt;
&lt;div class=&apos;table-wrap&apos;&gt;
&lt;table class=&apos;confluenceTable&apos;&gt;&lt;tbody&gt;
&lt;tr&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Subsystem &lt;/th&gt;
&lt;th class=&apos;confluenceTh&apos;&gt; Report/Notes &lt;/th&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JIRA Issue &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13490&quot; title=&quot;waitForState/registerCollectionStateWatcher can see stale liveNodes data due to (Zk) Watcher race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13490&quot;&gt;&lt;del&gt;SOLR-13490&lt;/del&gt;&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; JIRA Patch URL &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/12971853/SOLR-13490.patch&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/secure/attachment/12971853/SOLR-13490.patch&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Optional Tests &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  compile  javac  unit  ratsources  checkforbiddenapis  validatesourcepatterns  &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; uname &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Linux lucene1-us-west 4.4.0-137-generic #163~14.04.1-Ubuntu SMP Mon Sep 24 17:14:57 UTC 2018 x86_64 x86_64 x86_64 GNU/Linux &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Build tool &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; ant &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Personality &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; /home/jenkins/jenkins-slave/workspace/PreCommit-SOLR-Build/sourcedir/dev-tools/test-patch/lucene-solr-yetus-personality.sh &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; git revision &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; master / abb5ea0 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; ant &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; version: Apache Ant(TM) version 1.9.3 compiled on July 24 2018 &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Default Java &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; LTS &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt;  Test Results &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/job/PreCommit-SOLR-Build/436/testReport/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-SOLR-Build/436/testReport/&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; modules &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; C: solr/core solr/solrj solr/test-framework U: solr &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Console output &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; &lt;a href=&quot;https://builds.apache.org/job/PreCommit-SOLR-Build/436/console&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/PreCommit-SOLR-Build/436/console&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;tr&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Powered by &lt;/td&gt;
&lt;td class=&apos;confluenceTd&apos;&gt; Apache Yetus 0.7.0   &lt;a href=&quot;http://yetus.apache.org&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://yetus.apache.org&lt;/a&gt; &lt;/td&gt;
&lt;/tr&gt;
&lt;/tbody&gt;&lt;/table&gt;
&lt;/div&gt;



&lt;p&gt;This message was automatically generated.&lt;/p&gt;
</comment>
                            <comment id="16865773" author="jira-bot" created="Mon, 17 Jun 2019 16:59:55 +0000"  >&lt;p&gt;Commit 5a974860fa83408a86ca64b417f3111b037da7eb in lucene-solr&apos;s branch refs/heads/master from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=5a97486&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=5a97486&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13490&quot; title=&quot;waitForState/registerCollectionStateWatcher can see stale liveNodes data due to (Zk) Watcher race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13490&quot;&gt;&lt;del&gt;SOLR-13490&lt;/del&gt;&lt;/a&gt;: Fix CollectionStateWatcher/CollectionStatePredicate based APIs in ZkStateReader and CloudSolrClient to be triggered on liveNode changes.&lt;/p&gt;

&lt;p&gt;Also add Predicate&amp;lt;DocCollection&amp;gt; equivilents for callers that don&apos;t care about liveNodes.&lt;/p&gt;</comment>
                            <comment id="16865837" author="jira-bot" created="Mon, 17 Jun 2019 18:07:18 +0000"  >&lt;p&gt;Commit 2f2333a7814876871873cf050de8439c0c681c91 in lucene-solr&apos;s branch refs/heads/branch_8x from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=2f2333a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=2f2333a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13490&quot; title=&quot;waitForState/registerCollectionStateWatcher can see stale liveNodes data due to (Zk) Watcher race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13490&quot;&gt;&lt;del&gt;SOLR-13490&lt;/del&gt;&lt;/a&gt;: Fix CollectionStateWatcher/CollectionStatePredicate based APIs in ZkStateReader and CloudSolrClient to be triggered on liveNode changes.&lt;/p&gt;

&lt;p&gt;Also add Predicate&amp;lt;DocCollection&amp;gt; equivilents for callers that don&apos;t care about liveNodes.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 5a974860fa83408a86ca64b417f3111b037da7eb)&lt;/p&gt;</comment>
                            <comment id="16866041" author="jira-bot" created="Mon, 17 Jun 2019 22:39:00 +0000"  >&lt;p&gt;Commit 592d10d7ce82c9d0f38ea66f3c2f1a4113649728 in lucene-solr&apos;s branch refs/heads/branch_8x from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=592d10d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=592d10d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13490&quot; title=&quot;waitForState/registerCollectionStateWatcher can see stale liveNodes data due to (Zk) Watcher race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13490&quot;&gt;&lt;del&gt;SOLR-13490&lt;/del&gt;&lt;/a&gt;: fix TestWaitForStateWithJettyShutdowns to use correct (randomized) JettyConfig&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 7eb8703df64b4fdda8113ddcbcd0b4d2413ecc38)&lt;/p&gt;</comment>
                            <comment id="16866042" author="jira-bot" created="Mon, 17 Jun 2019 22:39:02 +0000"  >&lt;p&gt;Commit 7eb8703df64b4fdda8113ddcbcd0b4d2413ecc38 in lucene-solr&apos;s branch refs/heads/master from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7eb8703&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7eb8703&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13490&quot; title=&quot;waitForState/registerCollectionStateWatcher can see stale liveNodes data due to (Zk) Watcher race condition&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13490&quot;&gt;&lt;del&gt;SOLR-13490&lt;/del&gt;&lt;/a&gt;: fix TestWaitForStateWithJettyShutdowns to use correct (randomized) JettyConfig&lt;/p&gt;</comment>
                            <comment id="16893593" author="ivera" created="Fri, 26 Jul 2019 08:56:25 +0000"  >&lt;p&gt;Closing after the 8.2.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12971853" name="SOLR-13490.patch" size="76493" author="hossman" created="Fri, 14 Jun 2019 23:09:45 +0000"/>
                            <attachment id="12971740" name="SOLR-13490.patch" size="77521" author="hossman" created="Fri, 14 Jun 2019 00:10:13 +0000"/>
                            <attachment id="12971607" name="SOLR-13490.patch" size="47217" author="hossman" created="Wed, 12 Jun 2019 18:33:23 +0000"/>
                            <attachment id="12969717" name="SOLR-13490.patch" size="7504" author="hossman" created="Sat, 25 May 2019 00:04:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z032m8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>