<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:26:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9321] Remove deprecated methods of ClusterState</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9321</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description></description>
                <environment></environment>
        <key id="12990889">SOLR-9321</key>
            <summary>Remove deprecated methods of ClusterState</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="caomanhdat">Cao Manh Dat</assignee>
                                    <reporter username="ichattopadhyaya">Ishan Chattopadhyaya</reporter>
                        <labels>
                    </labels>
                <created>Tue, 19 Jul 2016 19:32:09 +0000</created>
                <updated>Sat, 8 Jun 2019 15:37:46 +0000</updated>
                            <resolved>Wed, 2 Aug 2017 15:10:07 +0000</resolved>
                                                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15384714" author="ichattopadhyaya" created="Tue, 19 Jul 2016 19:34:25 +0000"  >&lt;p&gt;Patch to remove the deprecated usages.&lt;/p&gt;</comment>
                            <comment id="16028704" author="gerlowskija" created="Tue, 30 May 2017 02:00:33 +0000"  >&lt;p&gt;The attached patch replaces calls to each ClusterState method with &lt;tt&gt;clusterState.getCollection.SomeSliceRelatedMethod&lt;/tt&gt;.  It doesn&apos;t change the error-case handling around each of this uses though.  The direct ClusterState methods will return &lt;tt&gt;null&lt;/tt&gt; when the collection information cannot be found; the non-deprecated replacement calls throw a SolrException instead.  Ends up causing a lot of test failures with the patch as is.&lt;/p&gt;

&lt;p&gt;In the process of changing out the error handling for some of these calls.  Will update the patch when I can get tests passing locally.&lt;/p&gt;</comment>
                            <comment id="16028707" author="ichattopadhyaya" created="Tue, 30 May 2017 02:06:12 +0000"  >&lt;p&gt;Did you forget to attach the patch?&lt;/p&gt;</comment>
                            <comment id="16029333" author="gerlowskija" created="Tue, 30 May 2017 12:18:27 +0000"  >&lt;p&gt;I do regularly make that mistake, but did not do so here.  Though I see in hindsight that my comment was ambiguous.&lt;/p&gt;

&lt;p&gt;References to the &quot;attached patch&quot; above are referring to the patch added in July of last year.  I&apos;m working on an updated patch locally, but I&apos;m still coaxing it through some test failures and making error-handling tweaks surrounding those method calls where appropriate.  Hope to have it up later today.&lt;/p&gt;

&lt;p&gt;Relatedly, this JIRA only explicitly covers &lt;tt&gt;getSlicesMap&lt;/tt&gt;, &lt;tt&gt;getSlices&lt;/tt&gt;, and &lt;tt&gt;getActiveSlices&lt;/tt&gt;.  The July-2016 patch limits its changes to those methods.  But there are a number of other deprecated methods in ClusterState.  Should usage of these methods be removed as well?&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;getLeader&lt;/li&gt;
	&lt;li&gt;getReplica&lt;/li&gt;
	&lt;li&gt;getSlice&lt;/li&gt;
	&lt;li&gt;getActiveSlicesMap&lt;/li&gt;
	&lt;li&gt;getCollections&lt;/li&gt;
	&lt;li&gt;getZkClusterStateVersion&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16032725" author="gerlowskija" created="Thu, 1 Jun 2017 10:00:02 +0000"  >&lt;p&gt;Update patch on top of master.  All tests pass locally.&lt;/p&gt;

&lt;p&gt;As I mentioned above, two questions about this issue:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ClusterState has a number of other deprecated methods not mentioned in the issue title.  Should any remaining usage of these also be cleaned up?  (I&apos;ve held off from doing so in this version of the patch, but I can add that in you want).&lt;/li&gt;
	&lt;li&gt;I&apos;ve removed all usage of the 3 clusterState methods.  I&apos;ve also removed those 3 deprecated methods.  We&apos;re approaching the 7.X branch and I&apos;ve seen a lot of traffic lately around removing deprecated methods prior to that, so it seemed like the right thing to do.  If I made the wrong call here though, it&apos;s quick enough to reverse, and I&apos;m happy to do that.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16032751" author="ichattopadhyaya" created="Thu, 1 Jun 2017 10:22:31 +0000"  >&lt;p&gt;+1 to remove other methods as well. Feel free to do that in this patch (although I had initially planned to do so in another issue).&lt;br/&gt;
Thanks for taking this up, Jason. I forgot about this issue and the patch after I added it.&lt;/p&gt;</comment>
                            <comment id="16034173" author="gerlowskija" created="Fri, 2 Jun 2017 05:40:06 +0000"  >&lt;p&gt;Updated patch removes the usage of all deprecated methods from &lt;tt&gt;ClusterState&lt;/tt&gt;, with the exception of &lt;tt&gt;getZkClusterStateVersion&lt;/tt&gt;.  All tests pass locally.&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;getZkClusterStateVersion&lt;/tt&gt; has no successor in the &lt;tt&gt;DocCollection&lt;/tt&gt; class, so removing the few places it is used is a less obvious swap.  Since the method is used to determine whether the ClusterState has changed since some access/read, my first hunch is that ClusterState.hashCode might be a suitable replacement for determining this.&lt;/p&gt;

&lt;p&gt;ClusterState.hashCode bases the hash largely off of the ZK-node-version.  Since getZkClusterStateVersion was deprecated out of concerns for its use of Zk-node-version (see javadocs), it doesn&apos;t really seem in the spirit of the deprecation to replace calls with ClusterState.hashCode.  At least as hashCode is written now.&lt;/p&gt;

&lt;p&gt;Do you have any advice/suggestions/opinions on what we can replace those getZkClusterStateVersion calls with?&lt;/p&gt;</comment>
                            <comment id="16047240" author="gerlowskija" created="Mon, 12 Jun 2017 23:49:44 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt; any suggestions on how to replace that last deprecated method (&lt;tt&gt;getZkClusterStateVersion&lt;/tt&gt;)?&lt;/p&gt;

&lt;p&gt;Based on my somewhat-naive understanding of the code involved, my suggestion/vote would be to work towards a solution where &lt;tt&gt;ZkStateWriter&lt;/tt&gt; maintains a node with the express purpose of tracking the versioning of the ClusterState nodes.  The reason for deprecating getZkClusterStateVersion wouldn&apos;t be relevant anymore, and we could un-deprecate the method.  &lt;/p&gt;

&lt;p&gt;But that would stretch the scope of this JIRA beyond the initial aim.  Would it be reasonable to split the resolution of &lt;tt&gt;getZkClusterStateVersion&lt;/tt&gt; into a separate JIRA, since it appears more involved than a find-replace?  &lt;/p&gt;</comment>
                            <comment id="16100931" author="steve_rowe" created="Tue, 25 Jul 2017 23:12:26 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt;, do you have time to finish up and commit this 7.0 blocker?&lt;/p&gt;</comment>
                            <comment id="16106903" author="caomanhdat" created="Mon, 31 Jul 2017 07:32:27 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt;, I can take a look if you kinda busy.&lt;/p&gt;</comment>
                            <comment id="16106954" author="caomanhdat" created="Mon, 31 Jul 2017 08:15:23 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gerlowskija&quot; class=&quot;user-hover&quot; rel=&quot;gerlowskija&quot;&gt;gerlowskija&lt;/a&gt; I think for 7.0 we should not remove &lt;tt&gt;getZkClusterStateVersion&lt;/tt&gt; because &lt;tt&gt;stateFormat=1&lt;/tt&gt; still there. I think we should node that this method will be removed in 8.0&lt;/p&gt;</comment>
                            <comment id="16107028" author="caomanhdat" created="Mon, 31 Jul 2017 09:28:25 +0000"  >&lt;p&gt;Updated patch for master branch. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gerlowskija&quot; class=&quot;user-hover&quot; rel=&quot;gerlowskija&quot;&gt;gerlowskija&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16107066" author="ichattopadhyaya" created="Mon, 31 Jul 2017 09:58:19 +0000"  >&lt;p&gt;Thanks Dat, please take it forward! &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16108533" author="jira-bot" created="Tue, 1 Aug 2017 07:50:37 +0000"  >&lt;p&gt;Commit 8f6546e54046756fb4c0f7d4ed3e8f38e10ba7f5 in lucene-solr&apos;s branch refs/heads/branch_7_0 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8f6546e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8f6546e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9321&quot; title=&quot;Remove deprecated methods of ClusterState&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9321&quot;&gt;&lt;del&gt;SOLR-9321&lt;/del&gt;&lt;/a&gt;: Remove deprecated methods of ClusterState&lt;/p&gt;</comment>
                            <comment id="16108537" author="jira-bot" created="Tue, 1 Aug 2017 07:55:12 +0000"  >&lt;p&gt;Commit 93ed4770ac82eb732c7409f82d02009e0fabe390 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=93ed477&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=93ed477&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9321&quot; title=&quot;Remove deprecated methods of ClusterState&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9321&quot;&gt;&lt;del&gt;SOLR-9321&lt;/del&gt;&lt;/a&gt;: Remove deprecated methods of ClusterState&lt;/p&gt;</comment>
                            <comment id="16108539" author="jira-bot" created="Tue, 1 Aug 2017 07:55:55 +0000"  >&lt;p&gt;Commit 729c8e826c1f9934e1687d3bfffe5a484e0c93a5 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=729c8e8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=729c8e8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9321&quot; title=&quot;Remove deprecated methods of ClusterState&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9321&quot;&gt;&lt;del&gt;SOLR-9321&lt;/del&gt;&lt;/a&gt;: Remove deprecated methods of ClusterState&lt;/p&gt;</comment>
                            <comment id="16108553" author="jira-bot" created="Tue, 1 Aug 2017 08:17:31 +0000"  >&lt;p&gt;Commit 292fca651a169e6f653567023951c92b63708c54 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=292fca6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=292fca6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9321&quot; title=&quot;Remove deprecated methods of ClusterState&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9321&quot;&gt;&lt;del&gt;SOLR-9321&lt;/del&gt;&lt;/a&gt;: Remove tests, they were accidentally added because of cherry-pick&lt;/p&gt;</comment>
                            <comment id="16108554" author="jira-bot" created="Tue, 1 Aug 2017 08:18:21 +0000"  >&lt;p&gt;Commit b0b61310aaf72ce7646344a8e8403740ac318197 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b0b6131&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b0b6131&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9321&quot; title=&quot;Remove deprecated methods of ClusterState&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9321&quot;&gt;&lt;del&gt;SOLR-9321&lt;/del&gt;&lt;/a&gt;: Remove tests, they were accidentally added because of cherry-pick&lt;/p&gt;</comment>
                            <comment id="16111081" author="caomanhdat" created="Wed, 2 Aug 2017 15:10:07 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gerlowskija&quot; class=&quot;user-hover&quot; rel=&quot;gerlowskija&quot;&gt;gerlowskija&lt;/a&gt;!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13075210">SOLR-10755</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12879594" name="SOLR-9321.patch" size="83601" author="caomanhdat" created="Mon, 31 Jul 2017 09:27:54 +0000"/>
                            <attachment id="12870925" name="SOLR-9321.patch" size="94888" author="gerlowskija" created="Fri, 2 Jun 2017 05:40:06 +0000"/>
                            <attachment id="12870762" name="SOLR-9321.patch" size="45699" author="gerlowskija" created="Thu, 1 Jun 2017 10:00:02 +0000"/>
                            <attachment id="12818901" name="SOLR-9321.patch" size="49085" author="ichattopadhyaya" created="Tue, 19 Jul 2016 19:34:25 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 15 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i317zj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>