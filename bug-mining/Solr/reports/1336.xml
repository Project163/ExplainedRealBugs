<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:35:27 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4608] Update Log replay should use the default processor chain</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4608</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;If a processor chain is used with custom processors, &lt;br/&gt;
they are not used in case of node failure during log replay.&lt;/p&gt;

&lt;p&gt;Here is the code:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-style: solid;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;border-bottom-style: solid;&quot;&gt;&lt;b&gt;UpdateLog.java&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void doReplay(TransactionLog translog) {
      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
        loglog.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;Starting log replay &quot;&lt;/span&gt; + translog + &lt;span class=&quot;code-quote&quot;&gt;&quot; active=&quot;&lt;/span&gt;+activeLog + &lt;span class=&quot;code-quote&quot;&gt;&quot; starting pos=&quot;&lt;/span&gt; + recoveryInfo.positionOfStart);

        tlogReader = translog.getReader(recoveryInfo.positionOfStart);

        &lt;span class=&quot;code-comment&quot;&gt;// NOTE: we don&apos;t currently handle a core reload during recovery.  This would cause the core
&lt;/span&gt;        &lt;span class=&quot;code-comment&quot;&gt;// to change underneath us.
&lt;/span&gt;
        &lt;span class=&quot;code-comment&quot;&gt;// TODO: use the standard request factory?  We won&apos;t get any custom configuration instantiating &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; way.
&lt;/span&gt;        RunUpdateProcessorFactory runFac = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RunUpdateProcessorFactory();
        DistributedUpdateProcessorFactory magicFac = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; DistributedUpdateProcessorFactory();
        runFac.init(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; NamedList());
        magicFac.init(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; NamedList());

        UpdateRequestProcessor proc = magicFac.getInstance(req, rsp, runFac.getInstance(req, rsp, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 

&lt;p&gt;I think this is a big issue, because a lot of people will discover it when a node will crash in the best case... and I think it&apos;s too late.&lt;/p&gt;

&lt;p&gt;It means to me that processor chains are not usable with Solr Cloud currently.&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12637559">SOLR-4608</key>
            <summary>Update Log replay should use the default processor chain</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="lboutros">Ludovic Boutros</reporter>
                        <labels>
                    </labels>
                <created>Mon, 18 Mar 2013 16:00:26 +0000</created>
                <updated>Mon, 9 May 2016 18:48:55 +0000</updated>
                            <resolved>Thu, 21 Mar 2013 18:08:39 +0000</resolved>
                                    <version>4.1</version>
                    <version>4.2</version>
                                    <fixVersion>4.2.1</fixVersion>
                    <fixVersion>4.3</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13605333" author="yseeley@gmail.com" created="Mon, 18 Mar 2013 16:36:38 +0000"  >&lt;p&gt;Right, we should use the default chain (although only processors at or after the distrib update processor factory - just like non-leaders do).&lt;br/&gt;
Normally, custom processors should go before the distributed processor, so this shouldn&apos;t affect most people.&lt;/p&gt;</comment>
                            <comment id="13605824" author="yseeley@gmail.com" created="Mon, 18 Mar 2013 23:58:49 +0000"  >&lt;p&gt;Hmmm, it appears that making this change causes RecoveryZkTest to fail for some reason.  Not sure why yet...&lt;/p&gt;

&lt;p&gt;edit: actually, it looks like this test is failing on a clean checkout of trunk too - so probably not related to this.&lt;/p&gt;</comment>
                            <comment id="13606201" author="lboutros" created="Tue, 19 Mar 2013 10:07:50 +0000"  >&lt;p&gt;Thanks Mark and Yonik.&lt;/p&gt;

&lt;p&gt;Yonik, could you please post the code of this change ? &lt;br/&gt;
I could try to patch the 4.1/4.2 branches and then test it.&lt;/p&gt;

</comment>
                            <comment id="13606393" author="yseeley@gmail.com" created="Tue, 19 Mar 2013 15:15:38 +0000"  >&lt;p&gt;Here&apos;s a patch that uses the default chain for both log replaying and peer sync replaying.&lt;/p&gt;</comment>
                            <comment id="13606411" author="markrmiller@gmail.com" created="Tue, 19 Mar 2013 15:35:22 +0000"  >&lt;p&gt;Report back soon and hopefully we can get this in 4.2.1.&lt;/p&gt;</comment>
                            <comment id="13606510" author="lboutros" created="Tue, 19 Mar 2013 17:07:08 +0000"  >&lt;p&gt;Anything after the DistributedUpdateProcessor will not be applied, right ?&lt;/p&gt;

&lt;p&gt;Do I need to create one default processor chain with my custom processor before the DistributedUpdateProcessor, and the real one used by the update handler with my custom processor after the DistributedUpdateProcessor ?&lt;/p&gt;</comment>
                            <comment id="13606639" author="yseeley@gmail.com" created="Tue, 19 Mar 2013 18:28:47 +0000"  >&lt;blockquote&gt;&lt;p&gt;Anything after the DistributedUpdateProcessor will not be applied, right ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Everything before the distributed update processor will be applied before buffering, and everything after should be applied while replaying.&lt;/p&gt;</comment>
                            <comment id="13608060" author="lboutros" created="Wed, 20 Mar 2013 19:32:35 +0000"  >&lt;p&gt;You&apos;re right Yonik, it works now. Thanks.&lt;br/&gt;
Do you think the patch could be committed in the different branches ?&lt;br/&gt;
If I can help, just ask.&lt;/p&gt;</comment>
                            <comment id="13608964" author="markrmiller@gmail.com" created="Thu, 21 Mar 2013 14:19:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;, this ready to be committed? I&apos;d like to toss it in 4.2.1.&lt;/p&gt;</comment>
                            <comment id="13609216" author="commit-tag-bot" created="Thu, 21 Mar 2013 17:59:32 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Yonik Seeley&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1459424&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1459424&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4608&quot; title=&quot;Update Log replay should use the default processor chain&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4608&quot;&gt;&lt;del&gt;SOLR-4608&lt;/del&gt;&lt;/a&gt;: use default update processor chain during log replay and peersync&lt;/p&gt;</comment>
                            <comment id="13609252" author="commit-tag-bot" created="Thu, 21 Mar 2013 18:16:54 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Yonik Seeley&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1459427&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1459427&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4608&quot; title=&quot;Update Log replay should use the default processor chain&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4608&quot;&gt;&lt;del&gt;SOLR-4608&lt;/del&gt;&lt;/a&gt;: use default update processor chain during log replay and peersync&lt;/p&gt;</comment>
                            <comment id="13653944" author="thetaphi" created="Fri, 10 May 2013 10:33:30 +0000"  >&lt;p&gt;Closed after release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12574351" name="SOLR-4608.patch" size="3729" author="yseeley@gmail.com" created="Tue, 19 Mar 2013 15:15:38 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>318050</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ivnz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>318391</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>