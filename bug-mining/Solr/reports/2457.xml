<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:05:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7542] Schema API: Can&apos;t remove single dynamic copy field directive</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7542</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;In a managed schema containing just a single dynamic copy field directive - i.e. a glob source or destination - deleting the copy field directive fails.  For example, the default configset (data_driven_schema_configs) has such a schema: the &lt;tt&gt;*&lt;/tt&gt;-&amp;gt;&lt;tt&gt;&amp;#95;text&amp;#95;&lt;/tt&gt; copy field directive is the only one. &lt;/p&gt;

&lt;p&gt;To reproduce:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;bin/solr start -c
bin/solr create my_solr_coll
curl &quot;http://localhost:8983/solr/my_solr_coll/schema&quot; -d&apos;{&quot;delete-copy-field&quot;:{&quot;source&quot;:&quot;*&quot;, &quot;dest&quot;:&quot;_text_&quot;}}&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The deletion fails, and an NPE is logged: &lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR - 2015-05-13 12:37:36.780; [my_solr_coll shard1 core_node1 my_solr_coll_shard1_replica1] org.apache.solr.common.SolrException; null:java.lang.NullPointerException
        at org.apache.solr.schema.IndexSchema.getCopyFieldProperties(IndexSchema.java:1450)
        at org.apache.solr.schema.IndexSchema.getNamedPropertyValues(IndexSchema.java:1406)
        at org.apache.solr.schema.IndexSchema.persist(IndexSchema.java:390)
        at org.apache.solr.schema.SchemaManager.doOperations(SchemaManager.java:120)
        at org.apache.solr.schema.SchemaManager.performOperations(SchemaManager.java:94)
        at org.apache.solr.handler.SchemaHandler.handleRequestBody(SchemaHandler.java:57)
        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:143)
        at org.apache.solr.core.SolrCore.execute(SolrCore.java:1984)
        at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:829)
        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:446)
        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:220)
[...]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12829571">SOLR-7542</key>
            <summary>Schema API: Can&apos;t remove single dynamic copy field directive</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sarowe">Steven Rowe</assignee>
                                    <reporter username="sarowe">Steven Rowe</reporter>
                        <labels>
                    </labels>
                <created>Wed, 13 May 2015 14:45:30 +0000</created>
                <updated>Mon, 15 Jun 2015 21:42:44 +0000</updated>
                            <resolved>Wed, 13 May 2015 15:42:11 +0000</resolved>
                                    <version>5.1</version>
                                    <fixVersion>5.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14542039" author="steve_rowe" created="Wed, 13 May 2015 14:52:33 +0000"  >&lt;p&gt;The issue is that the schema can&apos;t be persisted once there are no more dynamic copy fields (glob copy field directives).&lt;/p&gt;

&lt;p&gt;One workaround is to first add another copy field directive (e.g. &lt;tt&gt;&amp;#42;unlikely_field_suffix&lt;/tt&gt;&amp;#45;&amp;gt;&lt;tt&gt;&amp;#95;text&amp;#95;&lt;/tt&gt;).  The copy field directive that you want to remove (&lt;tt&gt;*&lt;/tt&gt;-&amp;gt;&lt;tt&gt;&amp;#95;text&amp;#95;&lt;/tt&gt; in our example) can then be successfully deleted.&lt;/p&gt;

&lt;p&gt;The fix is a null check on the internal array containing the dynamic copy fields.&lt;/p&gt;

&lt;p&gt;AFAICT, this is also a problem in schemas that start out with zero dynamic copy fields - in that case I think it won&apos;t be possible to make any schema modifications at all.&lt;/p&gt;</comment>
                            <comment id="14542048" author="steve_rowe" created="Wed, 13 May 2015 14:58:18 +0000"  >&lt;p&gt;Patch with test that fails before applying the fix and succeeds afterward.&lt;/p&gt;

&lt;p&gt;I&apos;ve added null checks on all access to the dynamic copy fields array in IndexSchema.&lt;/p&gt;

&lt;p&gt;Committing shortly.&lt;/p&gt;</comment>
                            <comment id="14542087" author="jira-bot" created="Wed, 13 May 2015 15:19:59 +0000"  >&lt;p&gt;Commit 1679225 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1679225&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1679225&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7542&quot; title=&quot;Schema API: Can&amp;#39;t remove single dynamic copy field directive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7542&quot;&gt;&lt;del&gt;SOLR-7542&lt;/del&gt;&lt;/a&gt;: Schema API: Can&apos;t remove single dynamic copy field directive&lt;/p&gt;</comment>
                            <comment id="14542124" author="jira-bot" created="Wed, 13 May 2015 15:41:30 +0000"  >&lt;p&gt;Commit 1679229 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1679229&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1679229&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7542&quot; title=&quot;Schema API: Can&amp;#39;t remove single dynamic copy field directive&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7542&quot;&gt;&lt;del&gt;SOLR-7542&lt;/del&gt;&lt;/a&gt;: Schema API: Can&apos;t remove single dynamic copy field directive (merged trunk r1679225)&lt;/p&gt;</comment>
                            <comment id="14542125" author="steve_rowe" created="Wed, 13 May 2015 15:42:11 +0000"  >&lt;p&gt;Committed to trunk and branch_5x.&lt;/p&gt;</comment>
                            <comment id="14586801" author="anshumg" created="Mon, 15 Jun 2015 21:42:44 +0000"  >&lt;p&gt;Bulk close for 5.2.0.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12732583" name="SOLR-7542.patch" size="41704" author="sarowe" created="Wed, 13 May 2015 14:58:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 23 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2eomn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>