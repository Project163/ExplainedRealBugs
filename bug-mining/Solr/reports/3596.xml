<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:26:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-10939] JoinQParser gives incorrect results with numeric PointsFields</title>
                <link>https://issues.apache.org/jira/browse/SOLR-10939</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;If you try to use the {&lt;tt&gt;!join&lt;/tt&gt;} QParser with numeric points fields, you will get silently incorrect results.&lt;/p&gt;

&lt;p&gt;The underlying root cause seems to be that JoinQParser&apos;s JoinQuery assumes every field it&apos;s dealing with has indexed terms. (AFAICT it won&apos;t even work with &lt;tt&gt;indexed=&quot;false&quot; docValues=&quot;true&quot;&lt;/tt&gt; Trie fields????)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13081943">SOLR-10939</key>
            <summary>JoinQParser gives incorrect results with numeric PointsFields</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                            <label>numeric-tries-to-points</label>
                    </labels>
                <created>Thu, 22 Jun 2017 22:28:39 +0000</created>
                <updated>Sat, 8 Jun 2019 15:21:23 +0000</updated>
                            <resolved>Mon, 7 Aug 2017 16:33:49 +0000</resolved>
                                                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16060122" author="hossman" created="Thu, 22 Jun 2017 22:29:19 +0000"  >
&lt;p&gt;At the lucene level it appears that &lt;tt&gt;JoinUtil&lt;/tt&gt; does support joining on numeric Points fields (w/o DocValues) if the appropriate numeric type is specified &amp;#8211; so it seems like:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;ScoreJoinQParser should use the numeric join if the from/to fields are numeric&lt;/li&gt;
	&lt;li&gt;JoinQParser should behave as if &lt;tt&gt;score=None&lt;/tt&gt; was specified (and delegate to ScoreJoinQParser) if the from/to fields are numeric&lt;/li&gt;
	&lt;li&gt;in both cases, better error handling should validate that the fields are of the same numeric type.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16060162" author="jira-bot" created="Thu, 22 Jun 2017 23:06:40 +0000"  >&lt;p&gt;Commit 8d92e08c9c19f478b944ac2d3d4735fc9bb921b0 in lucene-solr&apos;s branch refs/heads/master from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8d92e08&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8d92e08&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10939&quot; title=&quot;JoinQParser gives incorrect results with numeric PointsFields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10939&quot;&gt;&lt;del&gt;SOLR-10939&lt;/del&gt;&lt;/a&gt;: update @SuppressPointFields on TestJoin to note why points are suppressed&lt;/p&gt;

&lt;p&gt;Also update the annotation on TestCloudJSONFacetJoinDomain since &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9989&quot; title=&quot;Add support for PointFields in FacetModule (JSON Facets)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9989&quot;&gt;&lt;del&gt;SOLR-9989&lt;/del&gt;&lt;/a&gt; is resolved but the join problems&lt;br/&gt;
still prevent that test from passing with points enabled&lt;/p&gt;</comment>
                            <comment id="16095108" author="hossman" created="Thu, 20 Jul 2017 18:06:45 +0000"  >&lt;p&gt;Bulk editing 27 jiras matching the following JQL query to include the &quot;numeric-tries-to-points label...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;(issue in linkedIssues(SOLR-10807) OR issue in linkedIssues(SOLR-8396) OR issue in linkedIssues(SOLR-9995)) AND project = SOLR AND status != CLOSED
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;these 27 jiras can be identified by searching for the comment string &quot;20170720hossbulkeditlabel&quot;&lt;/p&gt;

&lt;p&gt;email notification is being suppressed.&lt;/p&gt;</comment>
                            <comment id="16112114" author="yseeley@gmail.com" created="Thu, 3 Aug 2017 03:20:11 +0000"  >&lt;p&gt;FYI, the approach I&apos;m taking on this one is to refactor the graph code so it can be shared with the join code (this pseudo-join is like a single-step graph traversal).&lt;/p&gt;</comment>
                            <comment id="16114487" author="yseeley@gmail.com" created="Fri, 4 Aug 2017 15:10:44 +0000"  >&lt;p&gt;Here&apos;s a patch that refactors and reuses the graph points collector for join.&lt;br/&gt;
I also made some changes to the join test:&lt;br/&gt;
1) if Points are selected, then docValues must be enabled (an exception is thrown otherwise)&lt;br/&gt;
2) removed testing joins across incompatible fields (for example matching an int field to a text field won&apos;t result in any matches)&lt;/p&gt;</comment>
                            <comment id="16116822" author="jira-bot" created="Mon, 7 Aug 2017 16:29:44 +0000"  >&lt;p&gt;Commit bd5c09b1eeb61123f3c799fa6428f2202e6d9356 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=bd5c09b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=bd5c09b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10939&quot; title=&quot;JoinQParser gives incorrect results with numeric PointsFields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10939&quot;&gt;&lt;del&gt;SOLR-10939&lt;/del&gt;&lt;/a&gt;: add point support to join query&lt;/p&gt;</comment>
                            <comment id="16116823" author="jira-bot" created="Mon, 7 Aug 2017 16:30:31 +0000"  >&lt;p&gt;Commit 1f7517d71966a3da4a1dbee202ca01967ebf5434 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1f7517d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1f7517d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10939&quot; title=&quot;JoinQParser gives incorrect results with numeric PointsFields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10939&quot;&gt;&lt;del&gt;SOLR-10939&lt;/del&gt;&lt;/a&gt;: add point support to join query&lt;/p&gt;</comment>
                            <comment id="16116824" author="jira-bot" created="Mon, 7 Aug 2017 16:30:38 +0000"  >&lt;p&gt;Commit d057bf2279412204fc5b5af16e3d8856393f0f30 in lucene-solr&apos;s branch refs/heads/branch_7_0 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d057bf2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d057bf2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10939&quot; title=&quot;JoinQParser gives incorrect results with numeric PointsFields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10939&quot;&gt;&lt;del&gt;SOLR-10939&lt;/del&gt;&lt;/a&gt;: add point support to join query&lt;/p&gt;</comment>
                            <comment id="16161551" author="hossman" created="Mon, 11 Sep 2017 16:40:25 +0000"  >&lt;p&gt;@yonik: just noticed that you resolved this issue, but didn&apos;t remove the &lt;tt&gt;@SuppressPointFields(bugUrl=&quot;https://issues.apache.org/jira/browse/SOLR-10939&quot;)&lt;/tt&gt; from the existing test that was affected (TestCloudJSONFacetJoinDomain)&lt;/p&gt;</comment>
                            <comment id="16177213" author="varunthacker" created="Fri, 22 Sep 2017 21:53:17 +0000"  >&lt;p&gt;I was doing some benchmarking of the &quot;join&quot; domain switch feature and I discovered something interesting .&lt;/p&gt;

&lt;p&gt;Essentially I am doing a 3 level nested facet. Top two levels ask for the top 10 and the third level does a join domain switch . So a 100 joins . &lt;/p&gt;

&lt;p&gt;For a 3M data set in one shard , queries always take ~66 seconds when executing the join domain on a string field.  When executed on a int point field it takes 4/5 seconds. So that&apos;s more than a 10x speedup&lt;/p&gt;

&lt;p&gt;Currently how the implementation works is it rewrites the query to a GraphPointsCollector when it&apos;s a points field . It uses &lt;tt&gt;JoinQParserPlugin#getDocSetEnumerate&lt;/tt&gt; otherwise. &lt;/p&gt;

&lt;p&gt;I&apos;m wondering if we would see similar improvements if we could move non point fields to use GraphTermsCollector instead ? I am posting this comment without investigating if it&apos;s even possible. If it is I&apos;ll create a separate jira. Any thoughts?&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12920497">SOLR-8396</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13103023">SOLR-11363</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12880414" name="SOLR-10939.patch" size="23479" author="yseeley@gmail.com" created="Fri, 4 Aug 2017 15:07:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 8 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3gmvr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>