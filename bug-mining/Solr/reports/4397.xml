<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:42:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-14079] SPLITSHARD splitByPrefix doesn&apos;t work in async mode</title>
                <link>https://issues.apache.org/jira/browse/SOLR-14079</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;If you specify async=whatever in conjunction with splitByPrefix, the ranges are calculated by the shard leader, but that information does not make it back to the overseer and the split proceeds to just split down the middle.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13274269">SOLR-14079</key>
            <summary>SPLITSHARD splitByPrefix doesn&apos;t work in async mode</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="yseeley@gmail.com">Yonik Seeley</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Dec 2019 00:42:51 +0000</created>
                <updated>Tue, 21 Jan 2020 16:56:52 +0000</updated>
                            <resolved>Sat, 14 Dec 2019 05:20:47 +0000</resolved>
                                    <version>8.3</version>
                                    <fixVersion>8.4</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="16995262" author="yseeley@gmail.com" created="Fri, 13 Dec 2019 01:22:48 +0000"  >&lt;p&gt;Fix attached, targeted for 8.4.&#160; Thanks to my colleagues who debugged this, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=megancarey&quot; class=&quot;user-hover&quot; rel=&quot;megancarey&quot;&gt;megancarey&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andy_vuong&quot; class=&quot;user-hover&quot; rel=&quot;andy_vuong&quot;&gt;andy_vuong&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mbwaheed&quot; class=&quot;user-hover&quot; rel=&quot;mbwaheed&quot;&gt;mbwaheed&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=murblanc&quot; class=&quot;user-hover&quot; rel=&quot;murblanc&quot;&gt;murblanc&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16995428" author="murblanc" created="Fri, 13 Dec 2019 07:32:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yseeley%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yseeley@gmail.com&quot;&gt;yseeley@gmail.com&lt;/a&gt;, is there a fundamental reason this can&apos;t work async, or is it rather an issue in the async call/response pairing that make such calls fail under some conditions? (for example a &quot;dangling&quot; non consumed response from a previous call that is then returned in error in a future async call)&lt;br/&gt;
As you know, we&apos;ve observed these async calls to sometimes work, and sometimes fail. I&apos;d rather fix issues in the async calling logic that might benefit other areas than work around them and switch to synchronous calls. Plus, there&apos;s a value to async calls (if they can be made in parallel, which is not the case in current split code) because a single thread can do multiple things at the same time.&lt;/p&gt;</comment>
                            <comment id="16995429" author="murblanc" created="Fri, 13 Dec 2019 07:36:34 +0000"  >&lt;p&gt;The patch is using different but constant async id&apos;s for the different stages. Isn&apos;t there a risk of collision between these async split calls and other concurrent async split calls that would be using the same id&apos;s?&lt;/p&gt;</comment>
                            <comment id="16995589" author="yseeley@gmail.com" created="Fri, 13 Dec 2019 12:45:30 +0000"  >&lt;blockquote&gt;&lt;p&gt;The patch is using different but constant async id&apos;s for the different stages.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s just the test using the constant async ids for the different split calls.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;is there a fundamental reason this can&apos;t work async&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We could use an async call and then wait for it (effectively turning it into a synchronous call), but at that point in the code, it is synchronous behavior we want (we can&apos;t proceed until we know the ranges for the new sub-shards.)&lt;/p&gt;

&lt;p&gt;I&apos;m new to the Overseer (I&apos;ve successfully avoided it before &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;, so my assumption on async calls is that I just didn&apos;t know how to use the API properly, and that the response looks different when using async.  Because of this, the returned &quot;ranges&quot; wasn&apos;t found.  If there are bugs/problems with async calls, or other bugs in SplitShardCmd, then those can be handled in additional JIRA issues.&lt;/p&gt;
</comment>
                            <comment id="16995772" author="murblanc" created="Fri, 13 Dec 2019 17:19:53 +0000"  >&lt;p&gt;Ok makes sense to use the patch as is. Didn&apos;t realize the id&apos;s were for tests (looked really too quickly at the diff).&lt;/p&gt;

&lt;p&gt;I&apos;ll try to understand if there&apos;s a general issue with the way async calls are managed between nodes and the overseer. I suppose there is because the implementation for smart shard splits did work in some instances and did fail in other. A new Jira is indeed appropriate in that case.&lt;/p&gt;</comment>
                            <comment id="16995984" author="jira-bot" created="Fri, 13 Dec 2019 22:55:15 +0000"  >&lt;p&gt;Commit 5f8e65c58f5849302d3aaacd65eea46eab258a57 in lucene-solr&apos;s branch refs/heads/master from Yonik Seeley&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=5f8e65c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=5f8e65c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14079&quot; title=&quot;SPLITSHARD splitByPrefix doesn&amp;#39;t work in async mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14079&quot;&gt;&lt;del&gt;SOLR-14079&lt;/del&gt;&lt;/a&gt;: fix SPLITSHARD splitByPrefix in async mode&lt;/p&gt;</comment>
                            <comment id="16995986" author="jira-bot" created="Fri, 13 Dec 2019 22:56:14 +0000"  >&lt;p&gt;Commit 1be81700becc96eb0322e4d704d5aaddba365e23 in lucene-solr&apos;s branch refs/heads/branch_8x from Yonik Seeley&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=1be8170&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=1be8170&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14079&quot; title=&quot;SPLITSHARD splitByPrefix doesn&amp;#39;t work in async mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14079&quot;&gt;&lt;del&gt;SOLR-14079&lt;/del&gt;&lt;/a&gt;: fix SPLITSHARD splitByPrefix in async mode&lt;/p&gt;</comment>
                            <comment id="16995998" author="jira-bot" created="Fri, 13 Dec 2019 23:07:19 +0000"  >&lt;p&gt;Commit 9c5c5a16e9943af25daa71d30671cb297fbf07da in lucene-solr&apos;s branch refs/heads/branch_8_4 from Yonik Seeley&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=9c5c5a1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=9c5c5a1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14079&quot; title=&quot;SPLITSHARD splitByPrefix doesn&amp;#39;t work in async mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14079&quot;&gt;&lt;del&gt;SOLR-14079&lt;/del&gt;&lt;/a&gt;: fix SPLITSHARD splitByPrefix in async mode&lt;/p&gt;</comment>
                            <comment id="16996053" author="jira-bot" created="Sat, 14 Dec 2019 01:34:12 +0000"  >&lt;p&gt;Commit 6821b8e4e560d3e87fd882b0a872cb51f3c2dc8e in lucene-solr&apos;s branch refs/heads/jira/&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13101&quot; title=&quot;Shared storage via a new SHARED replica type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13101&quot;&gt;&lt;del&gt;SOLR-13101&lt;/del&gt;&lt;/a&gt; from Yonik Seeley&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=6821b8e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=6821b8e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14079&quot; title=&quot;SPLITSHARD splitByPrefix doesn&amp;#39;t work in async mode&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14079&quot;&gt;&lt;del&gt;SOLR-14079&lt;/del&gt;&lt;/a&gt;: fix SPLITSHARD splitByPrefix in async mode&lt;/p&gt;</comment>
                            <comment id="17004955" author="jpountz" created="Sun, 29 Dec 2019 20:50:21 +0000"  >&lt;p&gt;Closing after the 8.4.0 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12988741" name="SOLR-14079.patch" size="4079" author="yseeley@gmail.com" created="Fri, 13 Dec 2019 01:16:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 46 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09msw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>