<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:02:12 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-6775] Creating backup snapshot null pointer exception</title>
                <link>https://issues.apache.org/jira/browse/SOLR-6775</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I set up Solr Replication. I have one master on a server, one slave on another server. The replication of data appears functioning correctly. The issue is when the master SOLR tries to create a snapshot backup it gets a null pointer exception. &lt;/p&gt;

&lt;p&gt;org.apache.solr.handler.SnapShooter createSnapshot method calls org.apache.solr.handler.SnapPuller.delTree(snapShotDir); at line 162 and the exception happens within  org.apache.solr.handler.SnapPuller at line 1026 because snapShotDir is null. &lt;br/&gt;
Here is the actual log output:&lt;/p&gt;

&lt;p&gt;58319963 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.core.SolrCore  - newest commit generation = 349&lt;br/&gt;
58319983 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-19&amp;#93;&lt;/span&gt; INFO  org.apache.solr.handler.SnapShooter  - Creating backup snapshot...&lt;br/&gt;
Exception in thread &quot;Thread-19&quot; java.lang.NullPointerException&lt;br/&gt;
        at org.apache.solr.handler.SnapPuller.delTree(SnapPuller.java:1026)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter.createSnapshot(SnapShooter.java:162)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter$1.run(SnapShooter.java:91)&lt;/p&gt;

&lt;p&gt;I may have missed how to set the directory in the documentation but I&apos;ve looked around without much luck. I thought the process was to use the same directory as the index data for the snapshots. Is this a known issue with this release or am I missing how to set the value? If someone could tell me how to set snapshotdir or confirm that it is an issue and a different way of backing up the index is needed it would be much appreciated. &lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux Server, Java version &quot;1.7.0_21&quot;, Solr version 4.10.0&lt;/p&gt;</environment>
        <key id="12756990">SOLR-6775</key>
            <summary>Creating backup snapshot null pointer exception</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="RyanBs">Ryan Hesson</reporter>
                        <labels>
                            <label>snapshot</label>
                            <label>solr</label>
                    </labels>
                <created>Fri, 21 Nov 2014 15:00:32 +0000</created>
                <updated>Mon, 9 May 2016 18:50:52 +0000</updated>
                            <resolved>Thu, 5 Feb 2015 10:39:22 +0000</resolved>
                                    <version>4.10</version>
                                    <fixVersion>5.1</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>replication (java)</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14221100" author="varunthacker" created="Fri, 21 Nov 2014 16:39:53 +0000"  >&lt;p&gt;Hi Ryan,&lt;/p&gt;

&lt;p&gt;Can you copy-paste your replication hander setting and the API call that you made. I will try to reproduce it.&lt;/p&gt;</comment>
                            <comment id="14221134" author="ryanbs" created="Fri, 21 Nov 2014 17:11:40 +0000"  >&lt;p&gt;Sure, I really appreciate the help. Please let me know if I can share any more information. &lt;/p&gt;

&lt;p&gt;Thank you for your time,&lt;/p&gt;

&lt;p&gt;Ryan&lt;/p&gt;

&lt;p&gt;This is my setting on the master Solr index: &lt;/p&gt;

&lt;p&gt;  &amp;lt;requestHandler name=&quot;/replication&quot; class=&quot;solr.ReplicationHandler&quot; &amp;gt;&lt;br/&gt;
       &amp;lt;lst name=&quot;master&quot;&amp;gt;&lt;br/&gt;
         &amp;lt;str name=&quot;replicateAfter&quot;&amp;gt;commit&amp;lt;/str&amp;gt;&lt;br/&gt;
         &amp;lt;str name=&quot;replicateAfter&quot;&amp;gt;startup&amp;lt;/str&amp;gt;&lt;br/&gt;
         &amp;lt;str name=&quot;backupAfter&quot;&amp;gt;optimize&amp;lt;/str&amp;gt;&lt;br/&gt;
         &amp;lt;str name=&quot;confFiles&quot;&amp;gt;schema.xml,stopwords.txt&amp;lt;/str&amp;gt;&lt;br/&gt;
       &amp;lt;/lst&amp;gt;&lt;br/&gt;
       &amp;lt;int name=&quot;maxNumberOfBackups&quot;&amp;gt;2&amp;lt;/int&amp;gt;&lt;br/&gt;
  &amp;lt;/requestHandler&amp;gt;&lt;/p&gt;

&lt;p&gt;This is my setting on the slave Solr index:&lt;/p&gt;

&lt;p&gt;  &amp;lt;requestHandler name=&quot;/replication&quot; class=&quot;solr.ReplicationHandler&quot; &amp;gt;&lt;br/&gt;
       &amp;lt;lst name=&quot;slave&quot;&amp;gt;&lt;br/&gt;
         &amp;lt;str name=&quot;masterUrl&quot;&amp;gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;Server URL&amp;#93;&lt;/span&gt;:8983/solr/&lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt;&amp;lt;/str&amp;gt;&lt;br/&gt;
         &amp;lt;str name=&quot;pollInterval&quot;&amp;gt;01:00:00&amp;lt;/str&amp;gt;&lt;br/&gt;
       &amp;lt;/lst&amp;gt;&lt;br/&gt;
  &amp;lt;/requestHandler&amp;gt;&lt;/p&gt;

&lt;p&gt;Far as API call, I know I&apos;m doing add/update documents to the core and then a commit. Here&apos;s additional log info if it helps:&lt;/p&gt;

&lt;p&gt;58316473 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.update.processor.LogUpdateProcessor  &#8211; &lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; webapp=/solr path=/update params=&lt;/p&gt;
{wt=javabin&amp;amp;version=2} {add=[559991 (1485389611244978176)]} 0 14&lt;br/&gt;
58316500 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.update.processor.LogUpdateProcessor  &#8211; &lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; webapp=/solr path=/update params={wt=javabin&amp;amp;version=2}
&lt;p&gt; &lt;/p&gt;
{add=[560030 (1485389611278532608)]}
&lt;p&gt; 0 9&lt;br/&gt;
58316507 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.update.processor.LogUpdateProcessor  &#8211; &lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; webapp=/solr path=/update params=&lt;/p&gt;
{wt=javabin&amp;amp;version=2} {add=[539417 (1485389611289018368)]} 0 4&lt;br/&gt;
58316523 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.update.processor.LogUpdateProcessor  &#8211; &lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; webapp=/solr path=/update params={wt=javabin&amp;amp;version=2}
&lt;p&gt; &lt;/p&gt;
{add=[568646 (1485389611304747008)]}
&lt;p&gt; 0 5&lt;br/&gt;
58316537 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.update.processor.LogUpdateProcessor  &#8211; &lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; webapp=/solr path=/update params=&lt;/p&gt;
{wt=javabin&amp;amp;version=2}
&lt;p&gt; &lt;/p&gt;
{add=[635394 (1485389611318378496)]}
&lt;p&gt; 0 6&lt;br/&gt;
58316677 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.update.UpdateHandler  &#8211; start commit&lt;/p&gt;
{,optimize=false,openSearcher=true,waitSearcher=true,expungeDeletes=false,softCommit=false,prepareCommit=false}
&lt;p&gt;58316714 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.core.SolrCore  &#8211; SolrDeletionPolicy.onCommit: commits: num=2&lt;br/&gt;
        commit&lt;/p&gt;
{dir=NRTCachingDirectory(NIOFSDirectory@/index/solr-4.10.0/[Company Name]/[Core Name]/data/index lockFactory=NativeFSLockFactory@/index/solr-4.10.0/[Company Name]/[Core Name]/data/index; maxCacheMB=48.0 maxMergeSizeMB=4.0),segFN=segments_9n,generation=347}
&lt;p&gt;        commit&lt;/p&gt;
{dir=NRTCachingDirectory(NIOFSDirectory@/index/solr-4.10.0/[Company Name]/[Core Name]/data/index lockFactory=NativeFSLockFactory@/index/solr-4.10.0/[Company Name]/[Core Name]/data/index; maxCacheMB=48.0 maxMergeSizeMB=4.0),segFN=segments_9o,generation=348}&lt;br/&gt;
58316714 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.core.SolrCore  &#8211; newest commit generation = 348&lt;br/&gt;
58316717 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.search.SolrIndexSearcher  &#8211; Opening Searcher@1ff79df&lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; main&lt;br/&gt;
58316721 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.update.UpdateHandler  &#8211; end_commit_flush&lt;br/&gt;
58316721 &lt;span class=&quot;error&quot;&gt;&amp;#91;searcherExecutor-6-thread-1&amp;#93;&lt;/span&gt; INFO  org.apache.solr.core.SolrCore  &#8211; QuerySenderListener sending requests to Searcher@1ff79df&lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; main{StandardDirectoryReader(segments_9o:1720:nrt _ik(4.10.0):C90144/5:delGen=1 _il(4.10.0):C5)}&lt;br/&gt;
58316721 &lt;span class=&quot;error&quot;&gt;&amp;#91;searcherExecutor-6-thread-1&amp;#93;&lt;/span&gt; INFO  org.apache.solr.core.SolrCore  &#8211; QuerySenderListener done.&lt;br/&gt;
58316722 &lt;span class=&quot;error&quot;&gt;&amp;#91;searcherExecutor-6-thread-1&amp;#93;&lt;/span&gt; INFO  org.apache.solr.core.SolrCore  &#8211; &lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; Registered new searcher Searcher@1ff79df&lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; main{StandardDirectoryReader(segments_9o:1720:nrt _ik(4.10.0):C90144/5:delGen=1 _il(4.10.0):C5)}&lt;br/&gt;
58316735 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.update.processor.LogUpdateProcessor  &#8211; &lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; webapp=/solr path=/update params={waitSearcher=true&amp;amp;commit=true&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;softCommit=false} {commit=} 0 58&lt;br/&gt;
58316737 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.update.UpdateHandler  &#8211; start commit{,optimize=true,openSearcher=true,waitSearcher=true,expungeDeletes=false,softCommit=false,prepareCommit=false}&lt;br/&gt;
58319963 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.core.SolrCore  &#8211; SolrDeletionPolicy.onCommit: commits: num=2&lt;br/&gt;
        commit{dir=NRTCachingDirectory(NIOFSDirectory@/index/solr-4.10.0/[Company Name]/[Core Name]/data/index lockFactory=NativeFSLockFactory@/index/solr-4.10.0/[Company Name]/[Core Name]/data/index; maxCacheMB=48.0 maxMergeSizeMB=4.0),segFN=segments_9o,generation=348}
&lt;p&gt;        commit&lt;/p&gt;
{dir=NRTCachingDirectory(NIOFSDirectory@/index/solr-4.10.0/[Company Name]/[Core Name]/data/index lockFactory=NativeFSLockFactory@/index/solr-4.10.0/[Company Name]/[Core Name]/data/index; maxCacheMB=48.0 maxMergeSizeMB=4.0),segFN=segments_9p,generation=349}
&lt;p&gt;58319963 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.core.SolrCore  &#8211; newest commit generation = 349&lt;br/&gt;
58319983 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-19&amp;#93;&lt;/span&gt; INFO  org.apache.solr.handler.SnapShooter  &#8211; Creating backup snapshot...&lt;br/&gt;
Exception in thread &quot;Thread-19&quot; java.lang.NullPointerException&lt;br/&gt;
        at org.apache.solr.handler.SnapPuller.delTree(SnapPuller.java:1026)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter.createSnapshot(SnapShooter.java:162)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter$1.run(SnapShooter.java:91)&lt;br/&gt;
58320080 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.search.SolrIndexSearcher  &#8211; Opening Searcher@ff73af&lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; main&lt;br/&gt;
58320083 &lt;span class=&quot;error&quot;&gt;&amp;#91;qtp12610551-16&amp;#93;&lt;/span&gt; INFO  org.apache.solr.update.UpdateHandler  &#8211; end_commit_flush&lt;br/&gt;
58320083 &lt;span class=&quot;error&quot;&gt;&amp;#91;searcherExecutor-6-thread-1&amp;#93;&lt;/span&gt; INFO  org.apache.solr.core.SolrCore  &#8211; QuerySenderListener sending requests to Searcher@ff73af&lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; main&lt;/p&gt;
{StandardDirectoryReader(segments_9p:1722:nrt _im(4.10.0):C90144)}
&lt;p&gt;58320084 &lt;span class=&quot;error&quot;&gt;&amp;#91;searcherExecutor-6-thread-1&amp;#93;&lt;/span&gt; INFO  org.apache.solr.core.SolrCore  &#8211; QuerySenderListener done.&lt;br/&gt;
58320084 &lt;span class=&quot;error&quot;&gt;&amp;#91;searcherExecutor-6-thread-1&amp;#93;&lt;/span&gt; INFO  org.apache.solr.core.SolrCore  &#8211; &lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; Registered new searcher Searcher@ff73af&lt;span class=&quot;error&quot;&gt;&amp;#91;Core Name&amp;#93;&lt;/span&gt; main&lt;/p&gt;
{StandardDirectoryReader(segments_9p:1722:nrt _im(4.10.0):C90144)}

</comment>
                            <comment id="14224639" author="ryanbs" created="Tue, 25 Nov 2014 14:57:40 +0000"  >&lt;p&gt;Not sure if this helps at all but I get the same NullPointerException using SOLR version 4.10.2 . Reading the documentation it sounds like SOLR is supposed to place snapshot backups in the same data directory as the index. I&apos;m not sure how others would not experience this same scenario if they were to set up backupAfter in the ReplicationHandler.&lt;/p&gt;

&lt;p&gt;If you look at the code repository here for version 4.9:&lt;br/&gt;
&lt;a href=&quot;http://grepcode.com/file/repo1.maven.org/maven2/org.apache.solr/solr-core/4.9.0/org/apache/solr/handler/SnapShooter.java?av=f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://grepcode.com/file/repo1.maven.org/maven2/org.apache.solr/solr-core/4.9.0/org/apache/solr/handler/SnapShooter.java?av=f&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;it doesn&apos;t appear the createSnapshot(...) method sets variable snapShotDir equal to anything before it sends it to the SnapPuller.delTree(snapShotDir) method. This appears to be the cause of the null pointer exception to me.&lt;/p&gt;

&lt;p&gt;Hope this helps,&lt;/p&gt;

&lt;p&gt;Ryan&lt;/p&gt;

&lt;p&gt;&amp;#8211;&lt;br/&gt;
Ryan E. Hesson&lt;/p&gt;
</comment>
                            <comment id="14304744" author="sfatula" created="Wed, 4 Feb 2015 07:37:57 +0000"  >&lt;p&gt;I have the exact same issue on Solr 4.10.3.&lt;/p&gt;

&lt;p&gt;803906 &lt;span class=&quot;error&quot;&gt;&amp;#91;Thread-52&amp;#93;&lt;/span&gt; INFO  org.apache.solr.handler.SnapShooter  &#8211; Creating backup snapshot...&lt;br/&gt;
Exception in thread &quot;Thread-52&quot; java.lang.NullPointerException&lt;br/&gt;
        at org.apache.solr.handler.SnapPuller.delTree(SnapPuller.java:1026)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter.createSnapshot(SnapShooter.java:162)&lt;br/&gt;
        at org.apache.solr.handler.SnapShooter$1.run(SnapShooter.java:91)&lt;/p&gt;</comment>
                            <comment id="14304800" author="varunthacker" created="Wed, 4 Feb 2015 08:52:12 +0000"  >&lt;p&gt;Whoops thats my fault. Looks like when we split the duties and added a blocking call to &lt;tt&gt;validateCreateSnapshot&lt;/tt&gt; , we forgot to call it when snapshots are triggered on commits. &lt;/p&gt;

&lt;p&gt;It was only added to explicit calls made to the snapshot command.&lt;/p&gt;

&lt;p&gt;So the fix is very simple, but I&apos;ll try improving the tests so that it can catch it in the future.&lt;/p&gt;
</comment>
                            <comment id="14305061" author="ryanbs" created="Wed, 4 Feb 2015 13:18:41 +0000"  >&lt;p&gt;Varun,&lt;/p&gt;

&lt;p&gt;I appreciate the update. I&apos;m eager to set this up again. &lt;/p&gt;

&lt;p&gt;Can I ask what is the best way to path SOLR? Would we drop the &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6775&quot; title=&quot;Creating backup snapshot null pointer exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6775&quot;&gt;&lt;del&gt;SOLR-6775&lt;/del&gt;&lt;/a&gt;.patch file into a folder? Or if I download 4.10.2 again and reinstall will it now include the patch? I appreciate any suggestions.&lt;/p&gt;

&lt;p&gt;Thank you,&lt;/p&gt;

&lt;p&gt;Ryan&lt;/p&gt;

&lt;p&gt;&amp;#8211;&lt;br/&gt;
Ryan E. Hesson&lt;br/&gt;
Boscov&apos;s Department Stores, LLC&lt;br/&gt;
Email: rhesson@boscovs.com&lt;br/&gt;
Phone: (610)898-6185&lt;/p&gt;
</comment>
                            <comment id="14306908" author="varunthacker" created="Thu, 5 Feb 2015 09:28:34 +0000"  >&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;I added a test &lt;tt&gt;TestReplicationHandlerBackup.testBackupOnCommit&lt;/tt&gt; which will fail without the fix in ReplicationHandler.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Cleaned up a bit of code in &lt;tt&gt;TestReplicationHandlerBackup.doTestBackup&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Moved out CheckBackupStatus and reused it in BasicDistributedZk2Test.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;All tests pass and precommit is happy.&lt;/p&gt;

&lt;p&gt;Precommit was only happy after I did &lt;tt&gt;svn propset svn:eol-style native ./solr/core/src/test/org/apache/solr/handler/CheckBackupStatus.java&lt;/tt&gt;&lt;/p&gt;</comment>
                            <comment id="14306918" author="varunthacker" created="Thu, 5 Feb 2015 09:38:07 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=RyanBs&quot; class=&quot;user-hover&quot; rel=&quot;RyanBs&quot;&gt;RyanBs&lt;/a&gt; ,&lt;/p&gt;

&lt;p&gt;If you want to get it up and running before it comes out as part of an official release you could do this - &lt;/p&gt;

&lt;p&gt;1. Download the Solr 4.10 branch from here - &lt;a href=&quot;https://github.com/apache/lucene-solr/tree/lucene_solr_4_10&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/tree/lucene_solr_4_10&lt;/a&gt;&lt;br/&gt;
2. Apply the patch using  &lt;tt&gt;patch -p0 &amp;lt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6775&quot; title=&quot;Creating backup snapshot null pointer exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6775&quot;&gt;&lt;del&gt;SOLR-6775&lt;/del&gt;&lt;/a&gt;.patch&lt;/tt&gt;&lt;br/&gt;
3. Then run &apos;ant example&apos; from the solr/ directory. Once that is complete the solr war will be present under the dist folder. You could use that.&lt;/p&gt;</comment>
                            <comment id="14306981" author="jira-bot" created="Thu, 5 Feb 2015 10:37:27 +0000"  >&lt;p&gt;Commit 1657523 from shalin@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1657523&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1657523&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6775&quot; title=&quot;Creating backup snapshot null pointer exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6775&quot;&gt;&lt;del&gt;SOLR-6775&lt;/del&gt;&lt;/a&gt;: Creating backup snapshot results in null pointer exception&lt;/p&gt;</comment>
                            <comment id="14306982" author="jira-bot" created="Thu, 5 Feb 2015 10:38:57 +0000"  >&lt;p&gt;Commit 1657524 from shalin@apache.org in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1657524&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1657524&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6775&quot; title=&quot;Creating backup snapshot null pointer exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6775&quot;&gt;&lt;del&gt;SOLR-6775&lt;/del&gt;&lt;/a&gt;: Creating backup snapshot results in null pointer exception&lt;/p&gt;</comment>
                            <comment id="14306984" author="shalinmangar" created="Thu, 5 Feb 2015 10:39:22 +0000"  >&lt;p&gt;Thanks Ryan and Varun!&lt;/p&gt;</comment>
                            <comment id="14307893" author="jira-bot" created="Thu, 5 Feb 2015 20:07:00 +0000"  >&lt;p&gt;Commit 1657680 from shalin@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1657680&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1657680&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6775&quot; title=&quot;Creating backup snapshot null pointer exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6775&quot;&gt;&lt;del&gt;SOLR-6775&lt;/del&gt;&lt;/a&gt;: Import the right Lists class&lt;/p&gt;</comment>
                            <comment id="14307897" author="jira-bot" created="Thu, 5 Feb 2015 20:08:07 +0000"  >&lt;p&gt;Commit 1657681 from shalin@apache.org in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1657681&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1657681&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6775&quot; title=&quot;Creating backup snapshot null pointer exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6775&quot;&gt;&lt;del&gt;SOLR-6775&lt;/del&gt;&lt;/a&gt;: Import the right Lists class&lt;/p&gt;</comment>
                            <comment id="14313471" author="markrmiller@gmail.com" created="Tue, 10 Feb 2015 03:28:55 +0000"  >&lt;p&gt;The related tests have been failing on windows runs since this went in. A couple unrelated tests as well.&lt;/p&gt;

&lt;p&gt;junit.framework.TestSuite.org.apache.solr.core.TestSolrConfigHandler&lt;br/&gt;
junit.framework.TestSuite.org.apache.solr.cloud.BasicDistributedZk2Test&lt;br/&gt;
org.apache.solr.handler.TestReplicationHandlerBackup.doTestBackup&lt;br/&gt;
org.apache.solr.handler.TestReplicationHandlerBackup.testBackupOnCommit&lt;/p&gt;</comment>
                            <comment id="14313522" author="varunthacker" created="Tue, 10 Feb 2015 04:17:17 +0000"  >&lt;p&gt;I&apos;ll look into it.&lt;/p&gt;</comment>
                            <comment id="14314485" author="markrmiller@gmail.com" created="Tue, 10 Feb 2015 17:22:52 +0000"  >&lt;p&gt;I think a lot of tests even not on windows started failing with this...&lt;/p&gt;</comment>
                            <comment id="14314649" author="varunthacker" created="Tue, 10 Feb 2015 18:51:40 +0000"  >&lt;p&gt;Looking at one of the Jenkins here are the stack traces - &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;[junit4] ERROR   3.52s | TestReplicationHandlerBackup.doTestBackup &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.io.IOException: Could not remove the following files (in the order of attempts):
   [junit4]    &amp;gt;    C:\Users\JenkinsSlave\workspace\Lucene-Solr-5.x-Windows\solr\build\solr-core\test\J0\temp\solr.handler.TestReplicationHandlerBackup E514A9DF49C1148E-001\solr-instance-001\collection1: java.nio.file.DirectoryNotEmptyException: C:\Users\JenkinsSlave\workspace\Lucene-Solr-5.x-Windows\solr\build\solr-core\test\J0\temp\solr.handler.TestReplicationHandlerBackup E514A9DF49C1148E-001\solr-instance-001\collection1
   [junit4]    &amp;gt;    C:\Users\JenkinsSlave\workspace\Lucene-Solr-5.x-Windows\solr\build\solr-core\test\J0\temp\solr.handler.TestReplicationHandlerBackup E514A9DF49C1148E-001\solr-instance-001: java.nio.file.DirectoryNotEmptyException: C:\Users\JenkinsSlave\workspace\Lucene-Solr-5.x-Windows\solr\build\solr-core\test\J0\temp\solr.handler.TestReplicationHandlerBackup E514A9DF49C1148E-001\solr-instance-001
   [junit4]    &amp;gt;        at __randomizedtesting.SeedInfo.seed([E514A9DF49C1148E:A49F89BA6E7FE7C1]:0)
   [junit4]    &amp;gt;        at org.apache.lucene.util.IOUtils.rm(IOUtils.java:294)
   [junit4]    &amp;gt;        at org.apache.solr.handler.TestReplicationHandler$SolrInstance.tearDown(TestReplicationHandler.java:1509)
   [junit4]    &amp;gt;        at org.apache.solr.handler.TestReplicationHandlerBackup.tearDown(TestReplicationHandlerBackup.java:115)
   [junit4]    &amp;gt;        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=TestReplicationHandlerBackup -Dtests.method=testBackupOnCommit -Dtests.seed=E514A9DF49C1148E -Dtests.slow=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; -Dtests.locale=pt_PT -Dtests.timezone=Africa/Lubumbashi -Dtests.asserts=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; -Dtests.file.encoding=UTF-8
   [junit4] ERROR   3.18s | TestReplicationHandlerBackup.testBackupOnCommit &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.io.IOException: Could not remove the following files (in the order of attempts):
   [junit4]    &amp;gt;    C:\Users\JenkinsSlave\workspace\Lucene-Solr-5.x-Windows\solr\build\solr-core\test\J0\temp\solr.handler.TestReplicationHandlerBackup E514A9DF49C1148E-001\solr-instance-002\collection1: java.nio.file.DirectoryNotEmptyException: C:\Users\JenkinsSlave\workspace\Lucene-Solr-5.x-Windows\solr\build\solr-core\test\J0\temp\solr.handler.TestReplicationHandlerBackup E514A9DF49C1148E-001\solr-instance-002\collection1
   [junit4]    &amp;gt;    C:\Users\JenkinsSlave\workspace\Lucene-Solr-5.x-Windows\solr\build\solr-core\test\J0\temp\solr.handler.TestReplicationHandlerBackup E514A9DF49C1148E-001\solr-instance-002: java.nio.file.DirectoryNotEmptyException: C:\Users\JenkinsSlave\workspace\Lucene-Solr-5.x-Windows\solr\build\solr-core\test\J0\temp\solr.handler.TestReplicationHandlerBackup E514A9DF49C1148E-001\solr-instance-002
   [junit4]    &amp;gt;        at __randomizedtesting.SeedInfo.seed([E514A9DF49C1148E:CCFC47343639A897]:0)
   [junit4]    &amp;gt;        at org.apache.lucene.util.IOUtils.rm(IOUtils.java:294)
   [junit4]    &amp;gt;        at org.apache.solr.handler.TestReplicationHandler$SolrInstance.tearDown(TestReplicationHandler.java:1509)
   [junit4]    &amp;gt;        at org.apache.solr.handler.TestReplicationHandlerBackup.tearDown(TestReplicationHandlerBackup.java:115)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It happened because we added this to the solrconfig files - &lt;tt&gt;&amp;lt;str name=&quot;backupAfter&quot;&amp;gt;commit&amp;lt;/str&amp;gt;&lt;/tt&gt; which means an extra backup got created which we forgot to remove. I&apos;ll put up a patch to fix it.&lt;/p&gt;

&lt;p&gt;One question though - Why doesn&apos;t it reproduce on my mac? &lt;/p&gt;</comment>
                            <comment id="14315944" author="varunthacker" created="Wed, 11 Feb 2015 10:15:37 +0000"  >&lt;p&gt;Patch which doesn&apos;t attempt to cleanup the temp directory since &lt;tt&gt;LuceneTestCase.createTempDir&lt;/tt&gt; states that &quot;The folder will be automatically removed after the test class completes successfully.&quot;&lt;/p&gt;</comment>
                            <comment id="14317612" author="shalinmangar" created="Thu, 12 Feb 2015 05:06:15 +0000"  >&lt;p&gt;Thanks Varun. I committed your patch r1659149 on trunk and r1659151 on branch_5x.&lt;/p&gt;</comment>
                            <comment id="14317613" author="jira-bot" created="Thu, 12 Feb 2015 05:06:30 +0000"  >&lt;p&gt;Commit 1659149 from shalin@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1659149&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1659149&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6775&quot; title=&quot;Creating backup snapshot null pointer exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6775&quot;&gt;&lt;del&gt;SOLR-6775&lt;/del&gt;&lt;/a&gt;: Do not attempt cleanup of temp directory because it is handled by test framework&lt;/p&gt;</comment>
                            <comment id="14317618" author="jira-bot" created="Thu, 12 Feb 2015 05:11:34 +0000"  >&lt;p&gt;Commit 1659151 from shalin@apache.org in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1659151&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1659151&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6775&quot; title=&quot;Creating backup snapshot null pointer exception&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6775&quot;&gt;&lt;del&gt;SOLR-6775&lt;/del&gt;&lt;/a&gt;: Do not attempt cleanup of temp directory because it is handled by test framework&lt;/p&gt;</comment>
                            <comment id="14317658" author="varunthacker" created="Thu, 12 Feb 2015 06:03:11 +0000"  >&lt;p&gt;Thanks Shalin! I&apos;ll keep an eye out on the builds&lt;/p&gt;</comment>
                            <comment id="14495344" author="thelabdude" created="Wed, 15 Apr 2015 00:30:42 +0000"  >&lt;p&gt;Bulk close after 5.1 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12696717" name="SOLR-6775.patch" size="20893" author="varun" created="Thu, 5 Feb 2015 09:28:34 +0000"/>
                            <attachment id="12696413" name="SOLR-6775.patch" size="822" author="varun" created="Wed, 4 Feb 2015 08:52:12 +0000"/>
                            <attachment id="12698053" name="SOLR-6775_test_fix.patch" size="5892" author="varun" created="Wed, 11 Feb 2015 10:15:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 32 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i22nl3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>