<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:22:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-10480] Offset does not allow for full pagination in JSON Facet API</title>
                <link>https://issues.apache.org/jira/browse/SOLR-10480</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I have a SolrCloud cluster and when I use the JSON facet API to do term faceting like this:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;json.facet={&quot;results&quot;:{&quot;type&quot;: &quot;terms&quot;, &quot;field&quot;: &quot;my_field&quot;, &quot;limit&quot;: 100, &quot;offset&quot;: 100, &quot;numBuckets&quot;: true}}&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;it does work correctly. &lt;br/&gt;
However the &lt;em&gt;numBuckets&lt;/em&gt; tells me in return that I have more than 6 millions buckets but as soon as I start to grow the &lt;em&gt;offset&lt;/em&gt; value to browse these buckets, it doesn&apos;t return anything anymore (when I reach an offset of around 300).&lt;br/&gt;
What is even weirder is that if I put a bigger &lt;em&gt;limit&lt;/em&gt;, like 10&apos;000, I can increase the &lt;em&gt;offset&lt;/em&gt; until around 29&apos;000 before it doesn&apos;t return anything.&lt;br/&gt;
And the returned &lt;em&gt;numBuckets&lt;/em&gt; doesn&apos;t change all the while.&lt;/p&gt;

&lt;p&gt;It is a big problem because we can&apos;t paginate till the end of the buckets.&lt;/p&gt;

&lt;p&gt;Might be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7452&quot; title=&quot;json facet api returning inconsistent counts in cloud set up&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7452&quot;&gt;&lt;del&gt;SOLR-7452&lt;/del&gt;&lt;/a&gt;, I don&apos;t know...&lt;/p&gt;</description>
                <environment></environment>
        <key id="13063484">SOLR-10480</key>
            <summary>Offset does not allow for full pagination in JSON Facet API</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="The_matrixme">Maxime Dar&#231;ot</reporter>
                        <labels>
                    </labels>
                <created>Wed, 12 Apr 2017 13:32:56 +0000</created>
                <updated>Sat, 8 Jun 2019 15:22:55 +0000</updated>
                            <resolved>Wed, 26 Apr 2017 03:08:59 +0000</resolved>
                                    <version>6.4.1</version>
                                    <fixVersion>6.6</fixVersion>
                                    <component>Facet Module</component>
                    <component>SolrCloud</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15966030" author="varunthacker" created="Wed, 12 Apr 2017 15:13:03 +0000"  >&lt;p&gt;I believe &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=kramachandran%40commvault.com&quot; class=&quot;user-hover&quot; rel=&quot;kramachandran@commvault.com&quot;&gt;kramachandran@commvault.com&lt;/a&gt; brought it up on the mailing list as well : &lt;a href=&quot;http://solr.markmail.org/search/JSON+facet+bucket+list+not+correct+with+sharded+query&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://solr.markmail.org/search/JSON+facet+bucket+list+not+correct+with+sharded+query&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15979060" author="yseeley@gmail.com" created="Fri, 21 Apr 2017 16:51:55 +0000"  >&lt;p&gt;I think this is probably caused by a bad estimate for numBuckets... meaning that if you keep paging, you should get all the values (we&apos;re just wrong about the number of values).&lt;/p&gt;</comment>
                            <comment id="15979095" author="the_matrixme" created="Fri, 21 Apr 2017 17:24:51 +0000"  >&lt;p&gt;This is definitely an issue about the pagination and not about the estimate of numBuckets. Indeed if for one faceted query I put a limit of 100 I can go up to an offset of around 300 before the query doesn&apos;t return anything anymore (which would mean that there are around 300 buckets), while with the same query but a limit of 10&apos;000, I can go up to around 30&apos;000 for the offset (which means that there are definitely a lot more than 300 buckets).&lt;/p&gt;</comment>
                            <comment id="15981352" author="kramachandran@commvault.com" created="Mon, 24 Apr 2017 15:26:44 +0000"  >&lt;p&gt;I agree with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=The_matrixme&quot; class=&quot;user-hover&quot; rel=&quot;The_matrixme&quot;&gt;The_matrixme&lt;/a&gt;, in my case with shard query facet query does not return result with pagination.  I have sample code to demo the issue. &lt;a href=&quot;https://gist.github.com/mrkarthik/8848dfb54536df4a24103d6939b54f61&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gist.github.com/mrkarthik/8848dfb54536df4a24103d6939b54f61&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15983121" author="yseeley@gmail.com" created="Tue, 25 Apr 2017 16:06:47 +0000"  >&lt;p&gt;OK, I was able to reproduce this issue and am looking for the root cause.&lt;/p&gt;</comment>
                            <comment id="15983791" author="yseeley@gmail.com" created="Tue, 25 Apr 2017 23:05:34 +0000"  >&lt;p&gt;OK, found and patched the issue.&lt;/p&gt;

&lt;p&gt;As an aside, paging with an offset with distributed faceting has the same issue as distributed search.  To return buckets N though N+10, each shard returns 0 through N+10, the merger sorts the merged bucket list, and then finally N through N+10 is returned to the client.&lt;/p&gt;</comment>
                            <comment id="15984098" author="jira-bot" created="Wed, 26 Apr 2017 02:57:01 +0000"  >&lt;p&gt;Commit 1f7777693769bad1cd8fc40b339d00c43f16f9d1 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1f77776&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1f77776&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10480&quot; title=&quot;Offset does not allow for full pagination in JSON Facet API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10480&quot;&gt;&lt;del&gt;SOLR-10480&lt;/del&gt;&lt;/a&gt;: fix offset param handling in JSON Facet API&lt;/p&gt;</comment>
                            <comment id="15984104" author="jira-bot" created="Wed, 26 Apr 2017 03:04:15 +0000"  >&lt;p&gt;Commit b90bfaba1f065598033b60f0ba5ffaa40053eb42 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b90bfab&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b90bfab&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10480&quot; title=&quot;Offset does not allow for full pagination in JSON Facet API&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10480&quot;&gt;&lt;del&gt;SOLR-10480&lt;/del&gt;&lt;/a&gt;: fix offset param handling in JSON Facet API&lt;/p&gt;</comment>
                            <comment id="15984109" author="yseeley@gmail.com" created="Wed, 26 Apr 2017 03:08:59 +0000"  >&lt;p&gt;Committed the fix.  Thanks for the bug reports!&lt;/p&gt;</comment>
                            <comment id="15986161" author="the_matrixme" created="Thu, 27 Apr 2017 07:53:16 +0000"  >&lt;p&gt;Well, thanks for the fix. Looking forward to use the version 6.6.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="13070327">SOLR-10642</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13065939">SOLR-10546</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12865021" name="SOLR-10480.patch" size="4357" author="yseeley@gmail.com" created="Tue, 25 Apr 2017 23:05:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 29 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3djbb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>