<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:34:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-12648] Autoscaling framework based replica placement is not used unless a policy is specified or non-empty cluster policy exists</title>
                <link>https://issues.apache.org/jira/browse/SOLR-12648</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Assign.java has a piece of code to decide which placement framework to use (we have three today):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (rulesMap == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; policyName == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; autoScalingConfig.getPolicy().getClusterPolicy().isEmpty())
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Note that the presence of cluster preferences is not a criteria. So even if a user adds cluster preferences, they will not be respected unless a policy also exists.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13177914">SOLR-12648</key>
            <summary>Autoscaling framework based replica placement is not used unless a policy is specified or non-empty cluster policy exists</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="shalin">Shalin Shekhar Mangar</reporter>
                        <labels>
                    </labels>
                <created>Thu, 9 Aug 2018 09:20:47 +0000</created>
                <updated>Wed, 2 Oct 2019 17:24:09 +0000</updated>
                            <resolved>Wed, 3 Oct 2018 11:29:48 +0000</resolved>
                                    <version>7.4</version>
                                    <fixVersion>7.6</fixVersion>
                    <fixVersion>8.0</fixVersion>
                                    <component>AutoScaling</component>
                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16604305" author="shalinmangar" created="Wed, 5 Sep 2018 11:39:24 +0000"  >&lt;p&gt;Patch with the fix. I&apos;ll add a test as well.&lt;/p&gt;</comment>
                            <comment id="16606894" author="shalinmangar" created="Fri, 7 Sep 2018 09:35:42 +0000"  >&lt;p&gt;Here&apos;s a patch with a test that fails without the fix. The test tries to add a replica which has an index size that can only be satisfied by a single node. If the autoscaling engine is not used then the first node will be selected which will fail the asserts.&lt;/p&gt;

&lt;p&gt;I&apos;ll commit this after running precommit and tests.&lt;/p&gt;</comment>
                            <comment id="16625549" author="shalinmangar" created="Mon, 24 Sep 2018 08:57:56 +0000"  >&lt;p&gt;Blocked by &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12756&quot; title=&quot;Refactor Assign and extract replica placement strategies out of it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12756&quot;&gt;&lt;del&gt;SOLR-12756&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16630220" author="shalinmangar" created="Thu, 27 Sep 2018 11:14:46 +0000"  >&lt;p&gt;Patch that builds on master after the &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12756&quot; title=&quot;Refactor Assign and extract replica placement strategies out of it&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12756&quot;&gt;&lt;del&gt;SOLR-12756&lt;/del&gt;&lt;/a&gt; commit.&lt;/p&gt;</comment>
                            <comment id="16636748" author="shalinmangar" created="Wed, 3 Oct 2018 10:20:37 +0000"  >&lt;p&gt;Patch passes all tests and precommit.&lt;/p&gt;

&lt;p&gt;It also fixes a bug where implicitly added cluster preferences were being persisted in ZK when we added the scheduled and auto add replicas trigger. Now we use the empty flag to decide whether to write the cluster preferences and policy in the MapWriter implementation. I added a test for this new behavior in TestPolicy.&lt;/p&gt;</comment>
                            <comment id="16636753" author="jira-bot" created="Wed, 3 Oct 2018 10:23:03 +0000"  >&lt;p&gt;Commit 65105aa81b1ac61b5e163ca249419184433233df in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=65105aa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=65105aa&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12648&quot; title=&quot;Autoscaling framework based replica placement is not used unless a policy is specified or non-empty cluster policy exists&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12648&quot;&gt;&lt;del&gt;SOLR-12648&lt;/del&gt;&lt;/a&gt;: Autoscaling framework based replica placement is not used unless a policy is specified or non-empty cluster policy exists&lt;/p&gt;</comment>
                            <comment id="16636795" author="jira-bot" created="Wed, 3 Oct 2018 11:07:02 +0000"  >&lt;p&gt;Commit a4beebd402b86a26e5205f5b49e44238134a2265 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=a4beebd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=a4beebd&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12648&quot; title=&quot;Autoscaling framework based replica placement is not used unless a policy is specified or non-empty cluster policy exists&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12648&quot;&gt;&lt;del&gt;SOLR-12648&lt;/del&gt;&lt;/a&gt;: Autoscaling framework based replica placement is not used unless a policy is specified or non-empty cluster policy exists&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 65105aa81b1ac61b5e163ca249419184433233df)&lt;/p&gt;</comment>
                            <comment id="16636824" author="shalinmangar" created="Wed, 3 Oct 2018 11:26:26 +0000"  >&lt;p&gt;Re-opening because I think we can use the emptyPreferences information in CloudUtil.usePolicyFramework helper method instead of comparing against default preferences.&lt;/p&gt;</comment>
                            <comment id="16636826" author="jira-bot" created="Wed, 3 Oct 2018 11:29:28 +0000"  >&lt;p&gt;Commit c576a9bca03c46110923c2b6c2ea3b4385634b7f in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c576a9b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c576a9b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12648&quot; title=&quot;Autoscaling framework based replica placement is not used unless a policy is specified or non-empty cluster policy exists&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12648&quot;&gt;&lt;del&gt;SOLR-12648&lt;/del&gt;&lt;/a&gt;: Use the information whether custom preferences were specified in the CloudUtil.usePolicyFramework method instead of comparing directly against default preferences. Comparing against default preferences was wrong because it ignores the case where the user explicitly added the same preferences as the default ones.&lt;/p&gt;</comment>
                            <comment id="16637910" author="jira-bot" created="Thu, 4 Oct 2018 07:54:34 +0000"  >&lt;p&gt;Commit 55fb20e82281a265e23fe949f97b8f878c212d5b in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=55fb20e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=55fb20e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12648&quot; title=&quot;Autoscaling framework based replica placement is not used unless a policy is specified or non-empty cluster policy exists&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12648&quot;&gt;&lt;del&gt;SOLR-12648&lt;/del&gt;&lt;/a&gt;: Remove unused import&lt;/p&gt;</comment>
                            <comment id="16637922" author="jira-bot" created="Thu, 4 Oct 2018 08:13:08 +0000"  >&lt;p&gt;Commit 05949a32c9a1a20cce1623e6b76bc8397c4bc325 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=05949a3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=05949a3&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12648&quot; title=&quot;Autoscaling framework based replica placement is not used unless a policy is specified or non-empty cluster policy exists&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12648&quot;&gt;&lt;del&gt;SOLR-12648&lt;/del&gt;&lt;/a&gt;: Use the information whether custom preferences were specified in the CloudUtil.usePolicyFramework method instead of comparing directly against default preferences. Comparing against default preferences was wrong because it ignores the case where the user explicitly added the same preferences as the default ones.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="13184015">SOLR-12756</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12942261" name="SOLR-12648.patch" size="24062" author="shalin" created="Wed, 3 Oct 2018 10:17:42 +0000"/>
                            <attachment id="12941528" name="SOLR-12648.patch" size="14461" author="shalin" created="Thu, 27 Sep 2018 11:14:18 +0000"/>
                            <attachment id="12938795" name="SOLR-12648.patch" size="16254" author="shalin" created="Fri, 7 Sep 2018 09:34:03 +0000"/>
                            <attachment id="12938456" name="SOLR-12648.patch" size="4162" author="shalin" created="Wed, 5 Sep 2018 11:39:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 6 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3wvbr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>