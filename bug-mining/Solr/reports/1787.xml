<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:46:48 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5739] SPLITSHARD creates shards &quot;...Ignoring commit while not ACTIVE&quot;</title>
                <link>https://issues.apache.org/jira/browse/SOLR-5739</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I&apos;ve tried to use the SPLITSHARD command from the Solr collection-Api.&lt;br/&gt;
A JUnit test successfully runs before the split, but fails after splitting the shard, stopping and restarting Solr. It won&apos;t fail if Solr isn&apos;t restarted after splitting.&lt;/p&gt;

&lt;p&gt;I found some entries in files &quot;solr.log&quot; and &quot;core.properties&quot; which may give hints. &lt;/p&gt;

&lt;h6&gt;&lt;a name=&quot;Aftersplit%3A&quot;&gt;&lt;/a&gt;After split:&lt;/h6&gt;
&lt;p&gt;&lt;tt&gt;org.apache.solr.update.UpdateLog; Starting to buffer updates. FSUpdateLog{state=ACTIVE, tlog=null&lt;/tt&gt;&lt;br/&gt;
 is logged for both newly created shards in &quot;solr.log&quot;&lt;/p&gt;

&lt;p&gt;&quot;clusterstate.json&quot; from Solr Cloud admin page shows: &lt;br/&gt;
&lt;tt&gt;shard1 state: inactive (replica: active)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;shard1_0 state: active parent shard1 (replica active)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;shard1_1 state: active parent shard1 (replica active)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;Both &quot;core.properties&quot; files of the newly created shards have&lt;br/&gt;
&lt;tt&gt;shardState=construction and shardParent=shard1&lt;/tt&gt;&lt;br/&gt;
entries.&lt;br/&gt;
The &quot;core.properties&quot; file of the parent shard is not changed.&lt;/p&gt;
&lt;h6&gt;&lt;a name=&quot;WhenrestartingSolr&quot;&gt;&lt;/a&gt;When restarting Solr&lt;/h6&gt;
&lt;p&gt; and running the JUnit again these entries are logged:&lt;br/&gt;
&lt;tt&gt;org.apache.solr.update.processor.DistributedUpdateProcessor; Ignoring commit while not ACTIVE - state: BUFFERING replay:0&lt;/tt&gt;&lt;br/&gt;
 in &quot;solr.log&quot;&lt;/p&gt;

&lt;p&gt;I mainly I followed the steps of this tutorial &lt;a href=&quot;http://architects.dzone.com/articles/solr-43-shard-splitting-quick&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://architects.dzone.com/articles/solr-43-shard-splitting-quick&lt;/a&gt;. &lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;(install solr-4.6.1)&lt;/li&gt;
	&lt;li&gt;create a small cluster:&lt;br/&gt;
java -Dbootstrap_confdir=./solr/portalse/conf -Dcollection.configName=portalse -DzkRun -DnumShards=1 -DmaxShardsPerNode=2 -DreplicationFactor=1 -jar start.jar&lt;/li&gt;
	&lt;li&gt;Run the unit test (after termination only one document exists).&lt;/li&gt;
	&lt;li&gt;Split the only shard:&lt;br/&gt;
curl &apos;http://localhost:8983/solr/admin/collections?action=SPLITSHARD&amp;amp;collection=portalse&amp;amp;shard=shard1&apos;&lt;br/&gt;
shard &quot;collection1_shard1_0_replica1&quot; created (1 document)&lt;br/&gt;
shard &quot;collection1_shard1_1_replica1&quot; created (0 documents)&lt;/li&gt;
	&lt;li&gt;commit index:&lt;br/&gt;
curl &apos;http://localhost:8983/solr/portalse/update&apos; --data-binary &apos;&amp;lt;commit/&amp;gt;&apos; -H &apos;Content-type:application/xml&apos;&lt;/li&gt;
	&lt;li&gt;stop Solr by pressing Ctl-C.&lt;/li&gt;
	&lt;li&gt;restart Solr:&lt;br/&gt;
java -DzkRun -jar start.jar&lt;/li&gt;
	&lt;li&gt;Run the unit test from step 2 again.&lt;/li&gt;
&lt;/ol&gt;
</description>
                <environment>&lt;p&gt;Windows 7 64 bit, Debian 3.11.1&lt;/p&gt;</environment>
        <key id="12695533">SOLR-5739</key>
            <summary>SPLITSHARD creates shards &quot;...Ignoring commit while not ACTIVE&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="grumi">G&#252;nther Ruck</reporter>
                        <labels>
                    </labels>
                <created>Mon, 17 Feb 2014 15:03:45 +0000</created>
                <updated>Mon, 9 May 2016 18:50:49 +0000</updated>
                            <resolved>Tue, 18 Feb 2014 00:43:35 +0000</resolved>
                                    <version>4.6.1</version>
                                    <fixVersion>4.7</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13903318" author="shalinmangar" created="Mon, 17 Feb 2014 15:45:22 +0000"  >&lt;p&gt;Thanks G&#252;nther. I can reproduce this issue. The shardState, shardRange and shardParent params are supposed to be used only once and then discarded. They should not be stored in core.properties.&lt;/p&gt;</comment>
                            <comment id="13903368" author="shalinmangar" created="Mon, 17 Feb 2014 16:58:12 +0000"  >&lt;p&gt;Patch uses createShard overseer command to create the shard removing the need to pass shard state, range and parent to the core admin create command.&lt;/p&gt;</comment>
                            <comment id="13903428" author="jira-bot" created="Mon, 17 Feb 2014 18:30:40 +0000"  >&lt;p&gt;Commit 1569072 from shalin@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1569072&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1569072&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5739&quot; title=&quot;SPLITSHARD creates shards &amp;quot;...Ignoring commit while not ACTIVE&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5739&quot;&gt;&lt;del&gt;SOLR-5739&lt;/del&gt;&lt;/a&gt;: Sub-shards created by shard splitting have their update log set to buffering mode on restarts&lt;/p&gt;</comment>
                            <comment id="13903431" author="jira-bot" created="Mon, 17 Feb 2014 18:32:07 +0000"  >&lt;p&gt;Commit 1569073 from shalin@apache.org in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1569073&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1569073&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5739&quot; title=&quot;SPLITSHARD creates shards &amp;quot;...Ignoring commit while not ACTIVE&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5739&quot;&gt;&lt;del&gt;SOLR-5739&lt;/del&gt;&lt;/a&gt;: Sub-shards created by shard splitting have their update log set to buffering mode on restarts&lt;/p&gt;</comment>
                            <comment id="13903433" author="shalinmangar" created="Mon, 17 Feb 2014 18:32:49 +0000"  >&lt;p&gt;Thanks G&#252;nther!&lt;/p&gt;</comment>
                            <comment id="13903614" author="shalinmangar" created="Tue, 18 Feb 2014 00:07:09 +0000"  >&lt;p&gt;Argh, I didn&apos;t actually remove the state, range and parent params from the core admin call.&lt;/p&gt;</comment>
                            <comment id="13903632" author="shalinmangar" created="Tue, 18 Feb 2014 00:29:30 +0000"  >&lt;p&gt;Removes the shardRange, shardParent and shardState params from CloudDescriptor and related access methods.&lt;/p&gt;</comment>
                            <comment id="13903643" author="jira-bot" created="Tue, 18 Feb 2014 00:39:55 +0000"  >&lt;p&gt;Commit 1569154 from shalin@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1569154&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1569154&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5739&quot; title=&quot;SPLITSHARD creates shards &amp;quot;...Ignoring commit while not ACTIVE&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5739&quot;&gt;&lt;del&gt;SOLR-5739&lt;/del&gt;&lt;/a&gt;: Removed shard state, range and parent from CoreAdmin calls and CoreDescriptor&lt;/p&gt;</comment>
                            <comment id="13903648" author="jira-bot" created="Tue, 18 Feb 2014 00:42:22 +0000"  >&lt;p&gt;Commit 1569155 from shalin@apache.org in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1569155&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1569155&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5739&quot; title=&quot;SPLITSHARD creates shards &amp;quot;...Ignoring commit while not ACTIVE&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5739&quot;&gt;&lt;del&gt;SOLR-5739&lt;/del&gt;&lt;/a&gt;: Removed shard state, range and parent from CoreAdmin calls and CoreDescriptor&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12629449" name="SOLR-5739-fix.patch" size="7255" author="shalin" created="Tue, 18 Feb 2014 00:29:30 +0000"/>
                            <attachment id="12629396" name="SOLR-5739.patch" size="4077" author="shalin" created="Mon, 17 Feb 2014 16:58:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>374041</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 40 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1sghr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>374341</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>