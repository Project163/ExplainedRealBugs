<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:03:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7173] Fix ReplicationFactorTest on Windows</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7173</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The ReplicationFactorTest fails on the Windows build with NoHttpResponseException, as seen here: &lt;a href=&quot;http://jenkins.thetaphi.de/job/Lucene-Solr-trunk-Windows/4502/testReport/junit/org.apache.solr.cloud/ReplicationFactorTest/test/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://jenkins.thetaphi.de/job/Lucene-Solr-trunk-Windows/4502/testReport/junit/org.apache.solr.cloud/ReplicationFactorTest/test/&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Adding a retry logic similar to HttpPartitionTest&apos;s doSend() method makes the test pass on Windows.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12778191">SOLR-7173</key>
            <summary>Fix ReplicationFactorTest on Windows</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thelabdude">Timothy Potter</assignee>
                                    <reporter username="ichattopadhyaya">Ishan Chattopadhyaya</reporter>
                        <labels>
                    </labels>
                <created>Fri, 27 Feb 2015 11:35:55 +0000</created>
                <updated>Tue, 2 Jul 2019 12:45:24 +0000</updated>
                            <resolved>Thu, 12 Mar 2015 20:42:44 +0000</resolved>
                                                    <fixVersion>5.1</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14340039" author="ichattopadhyaya" created="Fri, 27 Feb 2015 11:37:39 +0000"  >&lt;p&gt;Here&apos;s the patch to fix the test, as tested on my Windows box.&lt;/p&gt;</comment>
                            <comment id="14343348" author="thelabdude" created="Mon, 2 Mar 2015 16:37:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt; thanks for taking this up ... a couple of minor suggestions about your patch:&lt;/p&gt;

&lt;p&gt;1) please add some logging around the retries&lt;/p&gt;

&lt;p&gt;2) I&apos;ve found it better to use recursion with a decrementing counter vs. nested re-try blocks so something like the following, see where I use maxRetries as a param:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; sendBatch(List&amp;lt;SolrInputDocument&amp;gt; batch, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; waitBeforeRetry, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; maxRetries) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; Exception {
    &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; sent = 0;
    &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Timer.Context sendTimerCtxt = sendBatchToSolrTimer.time();
    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
      UpdateRequest updateRequest = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; UpdateRequest();
      ModifiableSolrParams params = updateRequest.getParams();
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (params == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        params = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ModifiableSolrParams();
        updateRequest.setParams(params);
      }
      updateRequest.add(batch);
      cloudSolrServer.request(updateRequest);
      sent = batch.size();
    } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception exc) {
      Throwable rootCause = SolrException.getRootCause(exc);
      &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; wasCommError = ...
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (wasCommError) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (--maxRetries &amp;gt; 0) {
          log.warn(&lt;span class=&quot;code-quote&quot;&gt;&quot;ERROR: &quot;&lt;/span&gt; + rootCause + &lt;span class=&quot;code-quote&quot;&gt;&quot; ... Sleeping &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &quot;&lt;/span&gt;
              + waitBeforeRetry + &lt;span class=&quot;code-quote&quot;&gt;&quot; seconds before re-&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; ...&quot;&lt;/span&gt;);
          &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.sleep(waitBeforeRetry * 1000L);
          sent = sendBatch(batch, waitBeforeRetry, maxRetries);
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
          log.error(&lt;span class=&quot;code-quote&quot;&gt;&quot;No more retries available! Add batch failed due to: &quot;&lt;/span&gt; + rootCause);
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; exc;
        }
      }
    } &lt;span class=&quot;code-keyword&quot;&gt;finally&lt;/span&gt; {
      sendTimerCtxt.stop();
    }

    batch.clear();
    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; sent;
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14345197" author="ichattopadhyaya" created="Tue, 3 Mar 2015 15:17:20 +0000"  >&lt;p&gt;Thanks for your suggestion. I&apos;ve updated the patch; I&apos;ve added the warning before retrying. However, instead of the recursive approach (through my initial few attempts, couldn&apos;t get the tests to pass), I went for an iterative one; do you suggest I go with the recursive approach?&lt;/p&gt;

&lt;p&gt;Also, since I had copied the initial retry logic from HttpPartitionTest&apos;s sendDoc(), should I update that code as well with this iterative/recursive retry?&lt;/p&gt;</comment>
                            <comment id="14345986" author="markrmiller@gmail.com" created="Tue, 3 Mar 2015 23:19:02 +0000"  >&lt;p&gt;Awesome, thank you. I figured we where just missing some retries - this issue should also solve &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6944&quot; title=&quot;ReplicationFactorTest and HttpPartitionTest both fail with org.apache.http.NoHttpResponseException: The target server failed to respond&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6944&quot;&gt;SOLR-6944&lt;/a&gt; (this can also still happen on linux too, just doesn&apos;t happen consistently like on windows).&lt;/p&gt;</comment>
                            <comment id="14345988" author="markrmiller@gmail.com" created="Tue, 3 Mar 2015 23:19:57 +0000"  >&lt;blockquote&gt;&lt;p&gt;should I update that code as well with this iterative/recursive retry?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes. All the better if we can just consolidate the code in some test util method rather than duping it.&lt;/p&gt;</comment>
                            <comment id="14352664" author="ichattopadhyaya" created="Mon, 9 Mar 2015 08:15:58 +0000"  >&lt;p&gt;Updating the patch, now covers the HttpPartitionTest&apos;s retry logic. The retry logic is now in the AbstractFullDistribZkTest.sendDocsWithRetry().&lt;/p&gt;</comment>
                            <comment id="14359081" author="jira-bot" created="Thu, 12 Mar 2015 17:58:31 +0000"  >&lt;p&gt;Commit 1666266 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thelabdude&quot; class=&quot;user-hover&quot; rel=&quot;thelabdude&quot;&gt;thelabdude&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1666266&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1666266&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7173&quot; title=&quot;Fix ReplicationFactorTest on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7173&quot;&gt;&lt;del&gt;SOLR-7173&lt;/del&gt;&lt;/a&gt;: Fix ReplicationFactorTest on Windows&lt;/p&gt;</comment>
                            <comment id="14359084" author="thelabdude" created="Thu, 12 Mar 2015 17:59:51 +0000"  >&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="14359331" author="jira-bot" created="Thu, 12 Mar 2015 20:28:51 +0000"  >&lt;p&gt;Commit 1666289 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thelabdude&quot; class=&quot;user-hover&quot; rel=&quot;thelabdude&quot;&gt;thelabdude&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1666289&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1666289&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7173&quot; title=&quot;Fix ReplicationFactorTest on Windows&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7173&quot;&gt;&lt;del&gt;SOLR-7173&lt;/del&gt;&lt;/a&gt;: Fix ReplicationFactorTest on Windows&lt;/p&gt;</comment>
                            <comment id="14495261" author="thelabdude" created="Wed, 15 Apr 2015 00:30:19 +0000"  >&lt;p&gt;Bulk close after 5.1 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="12777421">SOLR-7156</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13242738">SOLR-13598</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12766506">SOLR-6944</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12703390" name="SOLR-7173.patch" size="6102" author="ichattopadhyaya" created="Mon, 9 Mar 2015 08:15:58 +0000"/>
                            <attachment id="12702179" name="SOLR-7173.patch" size="3685" author="ichattopadhyaya" created="Tue, 3 Mar 2015 15:17:20 +0000"/>
                            <attachment id="12701340" name="SOLR-7173.patch" size="3724" author="ichattopadhyaya" created="Fri, 27 Feb 2015 11:37:39 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 32 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2658v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>