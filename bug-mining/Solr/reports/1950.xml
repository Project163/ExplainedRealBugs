<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:51:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-6164] Copy Fields Schema additions are not distributed to other nodes</title>
                <link>https://issues.apache.org/jira/browse/SOLR-6164</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I took a closer look at the tests added in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6145&quot; title=&quot;Concurrent Schema API field additions can result in endless loop&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6145&quot;&gt;&lt;del&gt;SOLR-6145&lt;/del&gt;&lt;/a&gt;, and the copy fields aren&apos;t being distributed &amp;#8211; it just looks that way b/c we are adding the same copy field directive multiple times to random servers and by chance, they&apos;ll be added to all the servers.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12720975">SOLR-6164</key>
            <summary>Copy Fields Schema additions are not distributed to other nodes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sarowe">Steven Rowe</assignee>
                                    <reporter username="gchanan">Gregory Chanan</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Jun 2014 20:20:05 +0000</created>
                <updated>Mon, 9 May 2016 18:55:04 +0000</updated>
                            <resolved>Tue, 17 Jun 2014 22:53:36 +0000</resolved>
                                                    <fixVersion>4.9</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14029754" author="gchanan" created="Thu, 12 Jun 2014 20:29:12 +0000"  >&lt;p&gt;Here&apos;s a patch.  It does the following:&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;The ZkIndexSchemaReader now adds the copy fields to the managed schema from what is in Zk.  This is done by clearing the copy field info and recreating it.  That seemed more straightforward than trying to maintain the existing copy fields and diffing what is in Zk.&lt;/li&gt;
	&lt;li&gt;Improves the existing tests in a few ways:&lt;/li&gt;
	&lt;li&gt;Instead of a long sleep and then checking, we loop with short sleeps and exit as soon as we see success.&lt;/li&gt;
	&lt;li&gt;Combines the put (add field), post (add field) and copy field test cases into one.  This ensures the commands &quot;play nicely&quot; together and reduces the amount of code / execution time.&lt;/li&gt;
	&lt;li&gt;Adds more testing to the copy fields commands.  Randomly decide if the copy field source and dest will be an existing field, a new field, or a dynamic field.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14029815" author="gchanan" created="Thu, 12 Jun 2014 21:11:03 +0000"  >&lt;p&gt;Previous patch used its own Random rather than the RandomizedRunner&apos;s version.&lt;/p&gt;</comment>
                            <comment id="14033988" author="steve_rowe" created="Tue, 17 Jun 2014 16:26:05 +0000"  >&lt;p&gt;+1, this looks great &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gchanan&quot; class=&quot;user-hover&quot; rel=&quot;gchanan&quot;&gt;gchanan&lt;/a&gt; - the code to update copyfields just wasn&apos;t there at all previously.  I want to get this into the 4.9 release - I&apos;ll commit shortly.&lt;/p&gt;

&lt;p&gt;Separately, &lt;tt&gt;ManagedIndexSchema.shallowCopy()&lt;/tt&gt; is geared exclusively toward what addFields() needs - other modifications aren&apos;t dealt with.  I think it should be reworked to just shallowly copy everything, and then the pieces that need to be can be handled in the reloading code.  Not sure how to detect that reloading of any piece is required ... maybe some form of checksum over the sorted serialized pieces?  I guess just always reloading - as is currently done for both fields and copyFields now too - is at least correct, if not the most performant solution.&lt;/p&gt;</comment>
                            <comment id="14034130" author="gchanan" created="Tue, 17 Jun 2014 18:00:02 +0000"  >&lt;p&gt;Thanks for taking a look, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I guess just always reloading - as is currently done for both fields and copyFields now too - is at least correct, if not the most performant solution.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That was my thought for this patch &amp;#8211; get something in that works and we can refine later.  I think that the idea of a checksum over the serialized pieces is a good one, though of course there&apos;s a question of the granularity.  Here&apos;s a complementary optimization: let&apos;s say you have a checksum over all the copyFields and a single copy field is added.  As things are now, you&apos;d have to recreate all the copy fields just to add a single one, though that may at least happen rarely.  It may make sense to put some unique identifier on each copyfield, so you can easily detect we already have that, so can just skip adding it.    It also makes implementing deleting fields/copyFields easier if we ever want to implement that.  Although this depends on what we decide in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6155&quot; title=&quot;Multiple copy field directives are created in a mutable managed schema when identical copy field directives are added&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6155&quot;&gt;&lt;del&gt;SOLR-6155&lt;/del&gt;&lt;/a&gt; I guess; if only one copyfield is allowed, the src/dst becomes a unique identifier.&lt;/p&gt;</comment>
                            <comment id="14034493" author="steve_rowe" created="Tue, 17 Jun 2014 22:23:46 +0000"  >&lt;p&gt;Gregory&apos;s patch with a CHANGES.txt entry; also cleaned up the test a little.&lt;/p&gt;

&lt;p&gt;Committing shortly.&lt;/p&gt;</comment>
                            <comment id="14034495" author="jira-bot" created="Tue, 17 Jun 2014 22:24:48 +0000"  >&lt;p&gt;Commit 1603300 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1603300&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1603300&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6164&quot; title=&quot;Copy Fields Schema additions are not distributed to other nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6164&quot;&gt;&lt;del&gt;SOLR-6164&lt;/del&gt;&lt;/a&gt;: Copy Fields Schema additions are not distributed to other nodes&lt;/p&gt;</comment>
                            <comment id="14034502" author="jira-bot" created="Tue, 17 Jun 2014 22:29:15 +0000"  >&lt;p&gt;Commit 1603301 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1603301&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1603301&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6164&quot; title=&quot;Copy Fields Schema additions are not distributed to other nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6164&quot;&gt;&lt;del&gt;SOLR-6164&lt;/del&gt;&lt;/a&gt;: add eol-style property to TestCloudManagedSchemaConcurrent.java&lt;/p&gt;</comment>
                            <comment id="14034528" author="jira-bot" created="Tue, 17 Jun 2014 22:47:08 +0000"  >&lt;p&gt;Commit 1603303 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1603303&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1603303&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6164&quot; title=&quot;Copy Fields Schema additions are not distributed to other nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6164&quot;&gt;&lt;del&gt;SOLR-6164&lt;/del&gt;&lt;/a&gt;: Copy Fields Schema additions are not distributed to other nodes (merged trunk r1603300 and r1603301)&lt;/p&gt;</comment>
                            <comment id="14034540" author="jira-bot" created="Tue, 17 Jun 2014 22:53:22 +0000"  >&lt;p&gt;Commit 1603308 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_4_9&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1603308&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1603308&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6164&quot; title=&quot;Copy Fields Schema additions are not distributed to other nodes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6164&quot;&gt;&lt;del&gt;SOLR-6164&lt;/del&gt;&lt;/a&gt;: Copy Fields Schema additions are not distributed to other nodes (merged trunk r1603300 and r1603301)&lt;/p&gt;</comment>
                            <comment id="14034542" author="steve_rowe" created="Tue, 17 Jun 2014 22:53:37 +0000"  >&lt;p&gt;Comitted to trunk, branch_4x and lucene_solr_4_9.&lt;/p&gt;

&lt;p&gt;Thanks Gregory!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12650907" name="SOLR-6164.patch" size="31509" author="sarowe" created="Tue, 17 Jun 2014 22:23:45 +0000"/>
                            <attachment id="12650133" name="SOLR-6164.patch" size="31251" author="gchanan" created="Thu, 12 Jun 2014 20:29:12 +0000"/>
                            <attachment id="12650143" name="SOLR-6164v2.patch" size="31204" author="gchanan" created="Thu, 12 Jun 2014 21:11:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>399173</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1wpw7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>399287</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>