<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:30:21 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3849] ScriptEngineTest failure RE system properties and ThreadLeakError</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3849</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;100% reproducible for me:&lt;br/&gt;
solr$ ant test  -Dtestcase=ScriptEngineTest&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;[junit4:junit4] &amp;lt;JUnit4&amp;gt; says hi! Master seed: E62CC5FBAC2CEFA4
[junit4:junit4] Executing 1 suite with 1 JVM.
[junit4:junit4] 
[junit4:junit4] Suite: org.apache.solr.update.processor.ScriptEngineTest
[junit4:junit4] OK      0.17s | ScriptEngineTest.testPut
[junit4:junit4] OK      0.02s | ScriptEngineTest.testEvalReader
[junit4:junit4] IGNOR/A 0.10s | ScriptEngineTest.testJRuby
[junit4:junit4]    &amp;gt; Assumption #1: got: &amp;lt;[null]&amp;gt;, expected: each not null
[junit4:junit4] OK      0.01s | ScriptEngineTest.testEvalText
[junit4:junit4] OK      0.01s | ScriptEngineTest.testGetEngineByExtension
[junit4:junit4] OK      0.01s | ScriptEngineTest.testGetEngineByName
[junit4:junit4]   2&amp;gt; -9 T9 ccr.ThreadLeakControl.checkThreadLeaks WARNING Will linger awaiting termination of 2 leaked thread(s).
[junit4:junit4]   2&amp;gt; 20163 T9 ccr.ThreadLeakControl.checkThreadLeaks SEVERE 1 thread leaked from SUITE scope at org.apache.solr.update.processor.ScriptEngineTest: 
[junit4:junit4]   2&amp;gt; 	   1) Thread[id=11, name=AppKit Thread, state=RUNNABLE, group=main]
[junit4:junit4]   2&amp;gt; 	        at (empty stack)
[junit4:junit4]   2&amp;gt; 20164 T9 ccr.ThreadLeakControl.tryToInterruptAll Starting to interrupt leaked threads:
[junit4:junit4]   2&amp;gt; 	   1) Thread[id=11, name=AppKit Thread, state=RUNNABLE, group=main]
[junit4:junit4]   2&amp;gt; 23172 T9 ccr.ThreadLeakControl.tryToInterruptAll SEVERE There are still zombie threads that couldn&apos;t be terminated:
[junit4:junit4]   2&amp;gt; 	   1) Thread[id=11, name=AppKit Thread, state=RUNNABLE, group=main]
[junit4:junit4]   2&amp;gt; 	        at (empty stack)
[junit4:junit4]   2&amp;gt; NOTE: test params are: codec=SimpleText, sim=RandomSimilarityProvider(queryNorm=true,coord=yes): {}, locale=es_PR, timezone=America/Edmonton
[junit4:junit4]   2&amp;gt; NOTE: Mac OS X 10.8.1 x86_64/Oracle Corporation 1.7.0_07 (64-bit)/cpus=4,threads=1,free=65764312,total=85065728
[junit4:junit4]   2&amp;gt; NOTE: All tests run in this JVM: [ScriptEngineTest]
[junit4:junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=ScriptEngineTest -Dtests.seed=E62CC5FBAC2CEFA4 -Dtests.slow=true -Dtests.locale=es_PR -Dtests.timezone=America/Edmonton -Dtests.file.encoding=UTF-8
[junit4:junit4] ERROR   0.00s | ScriptEngineTest (suite) &amp;lt;&amp;lt;&amp;lt;
[junit4:junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: System properties invariant violated.
[junit4:junit4]    &amp;gt; New keys:
[junit4:junit4]    &amp;gt;   sun.awt.enableExtraMouseButtons=true
[junit4:junit4]    &amp;gt;   sun.font.fontmanager=sun.font.CFontManager
[junit4:junit4]    &amp;gt; 
[junit4:junit4]    &amp;gt; 	at com.carrotsearch.randomizedtesting.rules.SystemPropertiesInvariantRule$1.evaluate(SystemPropertiesInvariantRule.java:66)
[junit4:junit4]    &amp;gt; 	at com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:39)
[junit4:junit4]    &amp;gt; 	at com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:39)
[junit4:junit4]    &amp;gt; 	at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)
[junit4:junit4]    &amp;gt; 	at org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:43)
[junit4:junit4]    &amp;gt; 	at org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)
[junit4:junit4]    &amp;gt; 	at org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:70)
[junit4:junit4]    &amp;gt; 	at org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:55)
[junit4:junit4]    &amp;gt; 	at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)
[junit4:junit4]    &amp;gt; 	at com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:358)
[junit4:junit4]    &amp;gt; 	at java.lang.Thread.run(Thread.java:722)
[junit4:junit4]    &amp;gt; Throwable #2: com.carrotsearch.randomizedtesting.ThreadLeakError: 1 thread leaked from SUITE scope at org.apache.solr.update.processor.ScriptEngineTest: 
[junit4:junit4]    &amp;gt;    1) Thread[id=11, name=AppKit Thread, state=RUNNABLE, group=main]
[junit4:junit4]    &amp;gt;         at (empty stack)
[junit4:junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([E62CC5FBAC2CEFA4]:0)
[junit4:junit4]    &amp;gt; Throwable #3: com.carrotsearch.randomizedtesting.ThreadLeakError: There are still zombie threads that couldn&apos;t be terminated:
[junit4:junit4]    &amp;gt;    1) Thread[id=11, name=AppKit Thread, state=RUNNABLE, group=main]
[junit4:junit4]    &amp;gt;         at (empty stack)
[junit4:junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([E62CC5FBAC2CEFA4]:0)
[junit4:junit4] Completed in 24.29s, 6 tests, 1 failure, 2 errors, 1 skipped &amp;lt;&amp;lt;&amp;lt; FAILURES!
[junit4:junit4] 
[junit4:junit4] JVM J0:     1.38 ..    26.54 =    25.16s
[junit4:junit4] Execution time total: 26 seconds
[junit4:junit4] Tests summary: 1 suite, 6 tests, 3 suite-level errors, 1 ignored (1 assumption)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;Mac OS X 10.8.1 x86_64/Oracle Corporation 1.7.0_07 (64-bit)/cpus=4,threads=1,free=65764312,total=85065728&lt;/p&gt;</environment>
        <key id="12608001">SOLR-3849</key>
            <summary>ScriptEngineTest failure RE system properties and ThreadLeakError</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="uschindler">Uwe Schindler</assignee>
                                    <reporter username="dsmiley">David Smiley</reporter>
                        <labels>
                    </labels>
                <created>Tue, 18 Sep 2012 04:31:48 +0000</created>
                <updated>Mon, 9 May 2016 18:45:49 +0000</updated>
                            <resolved>Tue, 18 Sep 2012 15:10:36 +0000</resolved>
                                    <version>6.0</version>
                                    <fixVersion>4.0</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>update</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13457651" author="dweiss" created="Tue, 18 Sep 2012 07:02:14 +0000"  >&lt;p&gt;I&apos;ll take over, this seems like an unknown system thread (AppKit Thread) probably forked by AWT. Why is AWT forked with this test, I&apos;ll have to take a look.&lt;/p&gt;</comment>
                            <comment id="13457665" author="thetaphi" created="Tue, 18 Sep 2012 07:26:54 +0000"  >&lt;p&gt;To fix this we should maybe use &quot;-Djava.awt.headless=true&quot; as sysprop in our test runner. This causes AWT to be disabled and should always be used on servers.&lt;/p&gt;

&lt;p&gt;The cause of this issue maybe related by a scripting engine that is on your classpath in addition to JavaScirpt? Maybe introduced by Apache ANT/lib folder?&lt;/p&gt;</comment>
                            <comment id="13457668" author="thetaphi" created="Tue, 18 Sep 2012 07:30:56 +0000"  >&lt;p&gt;Simple patch to enable headless mode (this makes sense for tests as we dont need window toolkit).&lt;/p&gt;

&lt;p&gt;Does this solve the issue? I have no MacOSX with Cocoa...&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;http://docs.oracle.com/javase/1.4.2/docs/guide/awt/AWTChanges.html#headless&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://docs.oracle.com/javase/1.4.2/docs/guide/awt/AWTChanges.html#headless&lt;/a&gt; for more infor about headless&lt;/p&gt;</comment>
                            <comment id="13457676" author="dweiss" created="Tue, 18 Sep 2012 07:54:44 +0000"  >&lt;p&gt;David can you see if Uwe&apos;s patch solves the problem? I agree this is probably AWT starting up for some reason. We can ignore those properties (and threads) but it&apos;s probably better that we caught them &amp;#8211; they shouldn&apos;t be running or starting up.&lt;/p&gt;</comment>
                            <comment id="13457680" author="thetaphi" created="Tue, 18 Sep 2012 08:02:35 +0000"  >&lt;p&gt;Setting this proerty is a real-world use-case: -Djava.awt.headless=true is e.g. set by the startup scripts of Tomcat or Jetty, as servlet containers are software to be run on a server and nothing ever should start up AWT there.&lt;/p&gt;</comment>
                            <comment id="13457761" author="rcmuir" created="Tue, 18 Sep 2012 12:01:18 +0000"  >&lt;p&gt;There used to be at least some solr contrib test that would fire up AWT on my mac.&lt;/p&gt;

&lt;p&gt;I think we should set headless too.&lt;/p&gt;</comment>
                            <comment id="13457765" author="thetaphi" created="Tue, 18 Sep 2012 12:17:17 +0000"  >&lt;p&gt;+1, we should do this in all cases (unrelated to this issue)&lt;/p&gt;</comment>
                            <comment id="13457869" author="dsmiley" created="Tue, 18 Sep 2012 14:57:09 +0000"  >&lt;p&gt;Patch worked!&lt;/p&gt;</comment>
                            <comment id="13457877" author="thetaphi" created="Tue, 18 Sep 2012 15:06:23 +0000"  >&lt;p&gt;OK, I commit that one!&lt;/p&gt;</comment>
                            <comment id="13457881" author="thetaphi" created="Tue, 18 Sep 2012 15:10:36 +0000"  >&lt;p&gt;Committed trunk revision: 1387212&lt;br/&gt;
Committed 4.x revision: 1387213&lt;/p&gt;

&lt;p&gt;Thanks for trying out!&lt;/p&gt;</comment>
                            <comment id="13458010" author="dweiss" created="Tue, 18 Sep 2012 18:08:07 +0000"  >&lt;p&gt;Good to see these assertions are actually useful for spotting things like this. Thanks for testing, guys.&lt;/p&gt;</comment>
                            <comment id="13481696" author="daubman" created="Mon, 22 Oct 2012 19:28:55 +0000"  >&lt;p&gt;This appears to still be affecting me in 4_0_0 (1400746)&lt;br/&gt;
Running under OS X 10.8.2 with $ java -version              &lt;br/&gt;
java version &quot;1.7.0_09&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.7.0_09-b05)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 23.5-b02, mixed mode)&lt;/p&gt;

&lt;p&gt;--&lt;del&gt;snip&lt;/del&gt;--&lt;br/&gt;
$ ant test -Dtestcase=ScriptEngineTest&lt;br/&gt;
...&lt;br/&gt;
common.test:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; &amp;lt;JUnit4&amp;gt; says &#1605;&#1585;&#1581;&#1576;&#1575;! Master seed: 4050036B906720D2&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; Executing 1 suite with 1 JVM.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; Suite: org.apache.solr.update.processor.ScriptEngineTest&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; IGNOR/A 0.10s | ScriptEngineTest.testJRuby&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; Assumption #1: got: &amp;lt;&lt;span class=&quot;error&quot;&gt;&amp;#91;null&amp;#93;&lt;/span&gt;&amp;gt;, expected: each not null&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; OK      0.11s | ScriptEngineTest.testPut&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; OK      0.01s | ScriptEngineTest.testEvalReader&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; OK      0.01s | ScriptEngineTest.testEvalText&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; OK      0.01s | ScriptEngineTest.testGetEngineByExtension&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; OK      0.01s | ScriptEngineTest.testGetEngineByName&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;   2&amp;gt; NOTE: test params are: codec=Lucene3x, sim=RandomSimilarityProvider(queryNorm=true,coord=crazy): {}, locale=es_DO, timezone=America/Godthab&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;   2&amp;gt; NOTE: Mac OS X 10.8.2 x86_64/Oracle Corporation 1.7.0_09 (64-bit)/cpus=8,threads=1,free=2966056,total=12320768&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;   2&amp;gt; NOTE: All tests run in this JVM: &lt;span class=&quot;error&quot;&gt;&amp;#91;ScriptEngineTest&amp;#93;&lt;/span&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=ScriptEngineTest -Dtests.seed=4050036B906720D2 -Dtests.slow=true -Dtests.locale=es_DO -Dtests.timezone=America/Godthab -Dtests.file.encoding=US-ASCII&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; ERROR   0.00s | ScriptEngineTest (suite) &amp;lt;&amp;lt;&amp;lt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; Throwable #1: java.lang.AssertionError: System properties invariant violated.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; New keys:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt;   sun.awt.enableExtraMouseButtons=true&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt;   sun.font.fontmanager=sun.font.CFontManager&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at __randomizedtesting.SeedInfo.seed(&lt;span class=&quot;error&quot;&gt;&amp;#91;4050036B906720D2&amp;#93;&lt;/span&gt;:0)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at com.carrotsearch.randomizedtesting.rules.SystemPropertiesInvariantRule$1.evaluate(SystemPropertiesInvariantRule.java:66)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:39)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at com.carrotsearch.randomizedtesting.rules.NoShadowingOrOverridesOnMethodsRule$1.evaluate(NoShadowingOrOverridesOnMethodsRule.java:39)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at org.apache.lucene.util.TestRuleAssertionsRequired$1.evaluate(TestRuleAssertionsRequired.java:43)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at org.apache.lucene.util.TestRuleMarkFailure$1.evaluate(TestRuleMarkFailure.java:48)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at org.apache.lucene.util.TestRuleIgnoreAfterMaxFailures$1.evaluate(TestRuleIgnoreAfterMaxFailures.java:70)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at org.apache.lucene.util.TestRuleIgnoreTestSuites$1.evaluate(TestRuleIgnoreTestSuites.java:55)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at com.carrotsearch.randomizedtesting.rules.StatementAdapter.evaluate(StatementAdapter.java:36)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at com.carrotsearch.randomizedtesting.ThreadLeakControl$StatementRunner.run(ThreadLeakControl.java:358)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at java.lang.Thread.run(Thread.java:722)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; Completed in 1.14s, 6 tests, 1 failure, 1 skipped &amp;lt;&amp;lt;&amp;lt; FAILURES!&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; Tests with failures:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt;   - org.apache.solr.update.processor.ScriptEngineTest (suite)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; JVM J0:     0.92 ..     2.86 =     1.94s&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; Execution time total: 2.96 sec.&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;junit4:junit4&amp;#93;&lt;/span&gt; Tests summary: 1 suite, 6 tests, 1 suite-level error, 1 ignored (1 assumption)&lt;/p&gt;

&lt;p&gt;BUILD FAILED&lt;br/&gt;
/Users/adaubman/Projects/lucene_solr_4_0_0/build.xml:40: The following error occurred while executing this line:&lt;br/&gt;
/Users/adaubman/Projects/lucene_solr_4_0_0/solr/build.xml:179: The following error occurred while executing this line:&lt;br/&gt;
/Users/adaubman/Projects/lucene_solr_4_0_0/lucene/module-build.xml:63: The following error occurred while executing this line:&lt;br/&gt;
/Users/adaubman/Projects/lucene_solr_4_0_0/lucene/common-build.xml:1142: The following error occurred while executing this line:&lt;br/&gt;
/Users/adaubman/Projects/lucene_solr_4_0_0/lucene/common-build.xml:815: There were test failures: 1 suite, 6 tests, 1 suite-level error, 1 ignored (1 assumption)&lt;/p&gt;

&lt;p&gt;Total time: 24 seconds&lt;br/&gt;
--&lt;del&gt;snip&lt;/del&gt;--&lt;/p&gt;</comment>
                            <comment id="13481716" author="steve_rowe" created="Mon, 22 Oct 2012 19:44:23 +0000"  >&lt;p&gt;I see the exact same failure on OS X 10.8.2 w/ Java 1.7.0_07.  However, this test succeeds w/ Java 1.6.0_37.&lt;/p&gt;</comment>
                            <comment id="13481721" author="dweiss" created="Mon, 22 Oct 2012 19:48:24 +0000"  >&lt;p&gt;Interesting. We could ignore those properties but they indicate that an AWT daemon was for some reason startup up and messed up system properties. Uwe may want to kill it rather than just ignoring these props.&lt;/p&gt;</comment>
                            <comment id="13481722" author="thetaphi" created="Mon, 22 Oct 2012 19:49:01 +0000"  >&lt;p&gt;Do anybody of you maybe have a custom scriptng engine in classpath? This could cause some bootup of some non-JDK script environment bootup that modifies those system variables. Maybe Apple/Macintosh has some CrazyUselessAsAlwaysM&#228;cintrashEngine shipped by default.&lt;/p&gt;</comment>
                            <comment id="13481727" author="dweiss" created="Mon, 22 Oct 2012 19:51:55 +0000"  >&lt;p&gt;The way to check is to substitute system properties with a custom implementation of Properties, override setProperty and dump a stack trace when these are actually set to see who the offender is. I&apos;ll take a look unless somebody beats me to it.&lt;/p&gt;</comment>
                            <comment id="13481741" author="thetaphi" created="Mon, 22 Oct 2012 20:08:15 +0000"  >&lt;p&gt;The strange thing about this issue is still the fact that we have:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;sysproperty key=&lt;span class=&quot;code-quote&quot;&gt;&quot;java.awt.headless&quot;&lt;/span&gt; value=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Why is AWT booted up at all? This seems to be some OS-X Java bug.&lt;/p&gt;</comment>
                            <comment id="13481744" author="steve_rowe" created="Mon, 22 Oct 2012 20:12:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do anybody of you maybe have a custom scriptng engine in classpath?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;My CLASSPATH env. var. is undefined.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Maybe Apple/Macintosh has some CrazyUselessAsAlwaysM&#228;cintrashEngine shipped by default.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Oracle produces 1.7 JDK for OS X, and the 1.6 JDK comes from Apple.&lt;/p&gt;</comment>
                            <comment id="13481745" author="rcmuir" created="Mon, 22 Oct 2012 20:15:20 +0000"  >&lt;p&gt;when I run &apos;ant check-svn-working-copy&apos; (even on 1.6) on my apple it boots up AWT as well.&lt;/p&gt;

&lt;p&gt;I thought we were passing headless to all this stuff now?&lt;/p&gt;</comment>
                            <comment id="13481762" author="thetaphi" created="Mon, 22 Oct 2012 20:40:55 +0000"  >&lt;p&gt;Digging around the source code of OpenJDK i found the following horrible class:&lt;br/&gt;
&lt;a href=&quot;http://cr.openjdk.java.net/~michaelm/7113349/7u4/1/jdk/new/raw_files/new/src/macosx/classes/apple/applescript/AppleScriptEngineFactory.java&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://cr.openjdk.java.net/~michaelm/7113349/7u4/1/jdk/new/raw_files/new/src/macosx/classes/apple/applescript/AppleScriptEngineFactory.java&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In fact this one is the factory class for (as I said before) Apple&apos;s custom &#196;ppleScript engine. If you look at the static ctor, you know what&apos;s happening: As soon as the scripting engine manager is loading the factory class via SPI from rt.jar, this code is executed and boots up AWT. The question is, why &quot;java.awt.headless=true&quot; does not prevent this, but I assume the &quot;if&quot; statement for that is missing.&lt;/p&gt;</comment>
                            <comment id="13481766" author="thetaphi" created="Mon, 22 Oct 2012 20:45:04 +0000"  >&lt;p&gt;We should file a bug at Oracle telling them that this scripting engine does not respect &quot;headless&quot; setting.&lt;/p&gt;</comment>
                            <comment id="13481774" author="dweiss" created="Mon, 22 Oct 2012 20:50:36 +0000"  >&lt;p&gt;Thanks for digging, Uwe. So these property invariants are actually useful &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Since this breaks the tests we should add these two to the ignore set (at least until Oracle fixes this?). LuceneTestCase:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  /**
   * These property keys will be ignored in verification of altered properties.
   * @see SystemPropertiesInvariantRule
   * @see #ruleChain
   * @see #classRules
   */
  &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; [] IGNORED_INVARIANT_PROPERTIES = {
    &lt;span class=&quot;code-quote&quot;&gt;&quot;user.timezone&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;java.rmi.server.randomIDs&quot;&lt;/span&gt;
  };
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13481783" author="thetaphi" created="Mon, 22 Oct 2012 20:53:26 +0000"  >&lt;p&gt;Can we ignore those &lt;b&gt;only&lt;/b&gt; for this test?&lt;/p&gt;</comment>
                            <comment id="13481786" author="dweiss" created="Mon, 22 Oct 2012 20:57:01 +0000"  >&lt;p&gt;I think you&apos;d have to redefine the entire rule chain by shadowing the field. It&apos;s JUnit, not me &amp;#8211; sorry.&lt;/p&gt;</comment>
                            <comment id="13506860" author="commit-tag-bot" created="Thu, 29 Nov 2012 22:06:25 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Steven Rowe&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415402&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415402&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3849&quot; title=&quot;ScriptEngineTest failure RE system properties and ThreadLeakError&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3849&quot;&gt;&lt;del&gt;SOLR-3849&lt;/del&gt;&lt;/a&gt;: Maven configuration += -Djava.awt.headless=true; also, upgrade maven-surefire-plugin to 2.12.4&lt;/p&gt;
</comment>
                            <comment id="13506878" author="commit-tag-bot" created="Thu, 29 Nov 2012 22:18:18 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Steven Rowe&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415410&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415410&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3849&quot; title=&quot;ScriptEngineTest failure RE system properties and ThreadLeakError&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3849&quot;&gt;&lt;del&gt;SOLR-3849&lt;/del&gt;&lt;/a&gt;: Maven configuration += -Djava.awt.headless=true; also, upgrade maven-surefire-plugin to 2.12.4 (merge trunk r1415402)&lt;/p&gt;
</comment>
                            <comment id="13610484" author="commit-tag-bot" created="Fri, 22 Mar 2013 16:12:50 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Steven Rowe&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415410&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1415410&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3849&quot; title=&quot;ScriptEngineTest failure RE system properties and ThreadLeakError&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3849&quot;&gt;&lt;del&gt;SOLR-3849&lt;/del&gt;&lt;/a&gt;: Maven configuration += -Djava.awt.headless=true; also, upgrade maven-surefire-plugin to 2.12.4 (merge trunk r1415402)&lt;/p&gt;</comment>
                            <comment id="13610812" author="commit-tag-bot" created="Fri, 22 Mar 2013 16:36:56 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Uwe Schindler&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1387213&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1387213&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Merged revision(s) 1387212 from lucene/dev/trunk:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3849&quot; title=&quot;ScriptEngineTest failure RE system properties and ThreadLeakError&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3849&quot;&gt;&lt;del&gt;SOLR-3849&lt;/del&gt;&lt;/a&gt;: Pass &quot;-Djava.awt.headless=true&quot; to test runner to prevent enabling AWT, spawning threads and modifying sysprops. Tests need no GUI and this also mimics the behaviour of the default startup scripts of Tomcat and Jetty.&lt;/p&gt;</comment>
                            <comment id="13654062" author="thetaphi" created="Fri, 10 May 2013 10:33:54 +0000"  >&lt;p&gt;Closed after release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12545533" name="SOLR-3849.patch" size="683" author="uschindler" created="Tue, 18 Sep 2012 07:30:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>243146</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03ca7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17423</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>