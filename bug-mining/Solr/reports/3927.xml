<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:33:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5351] More Like This Handler uses only first field in mlt.fl when using stream.body</title>
                <link>https://issues.apache.org/jira/browse/SOLR-5351</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The documentation at: &lt;a href=&quot;http://wiki.apache.org/solr/MoreLikeThisHandler&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/solr/MoreLikeThisHandler&lt;/a&gt; indicates that one can use multiple fields for similarity in mlt.fl:&lt;br/&gt;
&lt;a href=&quot;http://localhost:8983/solr/mlt?stream.body=electronics%20memory&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.interestingTerms=list&amp;amp;mlt.mintf=0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/mlt?stream.body=electronics%20memory&amp;amp;mlt.fl=manu,cat&amp;amp;mlt.interestingTerms=list&amp;amp;mlt.mintf=0&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In trying this, only one field is used. &lt;br/&gt;
Looking at the code, it only looks at the first field:&lt;/p&gt;

&lt;p&gt; public DocListAndSet getMoreLikeThis( Reader reader, int start, int rows, List&amp;lt;Query&amp;gt; filters, List&amp;lt;InterestingTerm&amp;gt; terms, int flags ) throws IOException&lt;br/&gt;
    {&lt;br/&gt;
      // analyzing with the first field: previous (stupid) behavior&lt;br/&gt;
      rawMLTQuery = mlt.like(reader, mlt.getFieldNames()&lt;span class=&quot;error&quot;&gt;&amp;#91;0&amp;#93;&lt;/span&gt;); &lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux,Windows&lt;/p&gt;</environment>
        <key id="12673882">SOLR-5351</key>
            <summary>More Like This Handler uses only first field in mlt.fl when using stream.body</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dweiss">Dawid Weiss</assignee>
                                    <reporter username="zygw">Zygmunt Wiercioch</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Oct 2013 14:01:38 +0000</created>
                <updated>Thu, 27 Sep 2018 09:33:22 +0000</updated>
                            <resolved>Fri, 25 May 2018 09:41:51 +0000</resolved>
                                    <version>4.4</version>
                                    <fixVersion>7.4</fixVersion>
                                    <component>MoreLikeThis</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="13925680" author="teofili" created="Mon, 10 Mar 2014 11:47:04 +0000"  >&lt;p&gt;the problem to me is not (only) on the Solr side, but I think Lucene&apos;s MoreLikeThis should support multiple fields instead of just one, e.g. adding a new method like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Query like(Reader r, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;... fieldNames) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; </comment>
                            <comment id="13969610" author="upayavira" created="Tue, 15 Apr 2014 15:09:52 +0000"  >&lt;p&gt;These two snippets of code seem to work. I will recraft it as a patch soon. However, I wonder if there are more standard ways of rereading a Reader.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;ResettingReader &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; Reader {
    	Reader wrapped;
    	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; ResettingReader(Reader reader) {
    		wrapped = reader;
    	}
    	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; read(&lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt;[]buf, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; off, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; len) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    		&lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; wrapped.read(buf, off, len);
    	}
    	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void close() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    		wrapped.reset();
    	}
    	&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void reallyClose() &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    		wrapped.close();
    	}
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; DocListAndSet getMoreLikeThis( Reader reader, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; start, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; rows, List&amp;lt;Query&amp;gt; filters, List&amp;lt;InterestingTerm&amp;gt; terms, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; flags ) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
    {
     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (mlt.getFieldNames().length==1) {
    	rawMLTQuery = mlt.like(reader, mlt.getFieldNames()[0]);
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
        BooleanQuery mltQuery = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BooleanQuery();
        ResettingReader reader2 = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ResettingReader(reader);
        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; fieldName : mlt.getFieldNames()) {
      	  BooleanQuery singleFieldQuery = (BooleanQuery)mlt.like(reader2, fieldName);
      	  &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (BooleanClause clause : singleFieldQuery.getClauses()) {
            mltQuery.add(clause);
    	  }
        }
        reader2.reallyClose();
        rawMLTQuery = mltQuery;
      }
      ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14557727" author="kaismh" created="Sun, 24 May 2015 12:46:27 +0000"  >&lt;p&gt;Thanks Upayavira for your solution, I tried it with Solr 4.10 and it works well. I agree with Tommaso, this should be handled at the Lucene level.&lt;/p&gt;</comment>
                            <comment id="16365277" author="dweiss" created="Thu, 15 Feb 2018 09:14:25 +0000"  >&lt;p&gt;This issue is still present in all releases of Solr. When you use multiple mlt.fl fields and a text stream on input, only the first field is taken into account, with this comment in MoreLikeThisHandler:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; DocListAndSet getMoreLikeThis( Reader reader, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; start, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; rows, List&amp;lt;Query&amp;gt; filters, List&amp;lt;InterestingTerm&amp;gt; terms, &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; flags ) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException
    {
      &lt;span class=&quot;code-comment&quot;&gt;// analyzing with the first field: previous (stupid) behavior
&lt;/span&gt;      rawMLTQuery = mlt.like(mlt.getFieldNames()[0], reader);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It is stupid and trappy, I&apos;d like to fix it. If there are any reasons to keep this behavior for backward compatibility please let me know. I assume it&apos;s just a bug (prevents you from using mlt.qf, etc.).&lt;/p&gt;</comment>
                            <comment id="16365298" author="dweiss" created="Thu, 15 Feb 2018 09:40:25 +0000"  >&lt;p&gt;My plan is to apply the stream (reader) to all fields expressed in mlt.fl. If there is one field, nothing changes. If multiple fields are provided, we have to buffer the reader and then pass the buffer&apos;s content to all requested fields, effectively extracting terms of interest. Some care must be taken to apply boosting properly (I&apos;d create a parent Boolean query with sub-clauses for each field, they can preserve all their parameters: min matches, field-boosts, etc.).&lt;/p&gt;</comment>
                            <comment id="16381978" author="dweiss" created="Thu, 1 Mar 2018 13:17:37 +0000"  >&lt;p&gt;I implemented support for multiple fields in the MLT handler. I also corrected the test which had bugs in it (expected exception block was not guarded and always falling through, effectively verifying nothing). I also cleaned up the code formatting a bit; this will obscure the patch slightly, but shouldn&apos;t be too bad.&lt;/p&gt;

&lt;p&gt;If there are no objections, I&apos;d like to commit it in soon.&lt;/p&gt;</comment>
                            <comment id="16382048" author="teofili" created="Thu, 1 Mar 2018 14:18:55 +0000"  >&lt;p&gt;+1 thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dweiss&quot; class=&quot;user-hover&quot; rel=&quot;dweiss&quot;&gt;dweiss&lt;/a&gt; , the patch looks good to me !&lt;/p&gt;</comment>
                            <comment id="16490477" author="jira-bot" created="Fri, 25 May 2018 09:40:19 +0000"  >&lt;p&gt;Commit d2e9ad200802801423061fe6019c8e8c6dc1b62f in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dawid.weiss&quot; class=&quot;user-hover&quot; rel=&quot;dawid.weiss&quot;&gt;dawid.weiss&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d2e9ad2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d2e9ad2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5351&quot; title=&quot;More Like This Handler uses only first field in mlt.fl when using stream.body&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5351&quot;&gt;&lt;del&gt;SOLR-5351&lt;/del&gt;&lt;/a&gt;: Fixed More Like This Handler to use all fields provided in mlt.fl when used with content stream. The similarity is calculated between the content stream&apos;s value and all fields listed in mlt.fl.&lt;/p&gt;</comment>
                            <comment id="16490478" author="jira-bot" created="Fri, 25 May 2018 09:40:21 +0000"  >&lt;p&gt;Commit 41ecad9897bb8949bfed730cd988aec58aa69775 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dawid.weiss&quot; class=&quot;user-hover&quot; rel=&quot;dawid.weiss&quot;&gt;dawid.weiss&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=41ecad9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=41ecad9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5351&quot; title=&quot;More Like This Handler uses only first field in mlt.fl when using stream.body&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5351&quot;&gt;&lt;del&gt;SOLR-5351&lt;/del&gt;&lt;/a&gt;: Fixed More Like This Handler to use all fields provided in mlt.fl when used with content stream. The similarity is calculated between the content stream&apos;s value and all fields listed in mlt.fl.&lt;/p&gt;</comment>
                            <comment id="16490479" author="dweiss" created="Fri, 25 May 2018 09:41:51 +0000"  >&lt;p&gt;Committing in to master and 7.4, sorry for the delay.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13187844">SOLR-12812</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12912610" name="SOLR-5351.patch" size="15913" author="dweiss" created="Thu, 1 Mar 2018 13:51:54 +0000"/>
                            <attachment id="12912602" name="SOLR-5351.patch" size="15545" author="dweiss" created="Thu, 1 Mar 2018 13:15:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353505</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 25 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1oy4f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>353797</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>