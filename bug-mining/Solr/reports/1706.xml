<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:44:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4992] Solr queries don&apos;t propagate Java OutOfMemoryError back to the JVM</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4992</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Solr (specifically SolrDispatchFilter.doFilter() but there might be other places) handle generic java.lang.Throwable errors but that &quot;hides&quot; OutOfMemoryError scenarios.&lt;/p&gt;

&lt;p&gt;IndexWriter does this too but that has a specific exclusion for OOM scenarios and handles them explicitly (stops committing and just logs to the transaction log).&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;
Example Stack trace:
2013-06-26 19:31:33,801 [qtp632640515-62] ERROR
solr.servlet.SolrDispatchFilter Q:22 -
null:java.lang.RuntimeException: java.lang.OutOfMemoryError: Java heap
space
at org.apache.solr.servlet.SolrDispatchFilter.sendError(SolrDispatchFilter.java:670)
at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:380)
at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:155)
at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1423)
at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:450)
at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:138)
at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:564)
at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:213)
at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1083)
at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:379)
at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:175)
at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1017)
at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:136)
at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:258)
at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:109)
at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)
at org.eclipse.jetty.server.Server.handle(Server.java:445)
at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:260)
at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:225)
at org.eclipse.jetty.io.AbstractConnection$ReadCallback.run(AbstractConnection.java:358)
at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:596)
at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:527)
at java.lang.Thread.run(Thread.java:722)
Caused by: java.lang.OutOfMemoryError: Java heap space

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12655984">SOLR-4992</key>
            <summary>Solr queries don&apos;t propagate Java OutOfMemoryError back to the JVM</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="dancollins">Daniel Collins</reporter>
                        <labels>
                    </labels>
                <created>Wed, 3 Jul 2013 08:14:11 +0000</created>
                <updated>Mon, 9 May 2016 18:56:58 +0000</updated>
                            <resolved>Mon, 20 Jan 2014 14:41:39 +0000</resolved>
                                    <version>4.3.1</version>
                                    <fixVersion>4.7</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>search</component>
                    <component>SolrCloud</component>
                    <component>update</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="13717163" author="steve_rowe" created="Tue, 23 Jul 2013 18:47:19 +0000"  >&lt;p&gt;Bulk move 4.4 issues to 4.5 and 5.0&lt;/p&gt;</comment>
                            <comment id="13794295" author="markrmiller@gmail.com" created="Mon, 14 Oct 2013 17:27:24 +0000"  >&lt;p&gt;We like to catch those throwables because of things like assertion errors - we still want to close resources, etc.&lt;/p&gt;

&lt;p&gt;One idea is to always do:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;     } &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Throwable t) {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (t &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; OutOfMemoryError) {
          &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; (OutOfMemoryError)t;
        }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But that is difficult to enforce over time.&lt;/p&gt;</comment>
                            <comment id="13794297" author="andyetitmoves" created="Mon, 14 Oct 2013 17:30:31 +0000"  >&lt;p&gt;Doesn&apos;t `finally` offer a cleaner way to do that?&lt;/p&gt;</comment>
                            <comment id="13794616" author="markrmiller@gmail.com" created="Mon, 14 Oct 2013 23:18:21 +0000"  >&lt;p&gt;I think for some cases it does.&lt;/p&gt;

&lt;p&gt;It&apos;s a little painful for closing collections of items or if you need to close a lot of items serially, nesting one finally after another.&lt;/p&gt;

&lt;p&gt;It does seem like we should probably stop catching throwable in most cases anyway. In some cases, you might still catch it, log something and then throw if instanceOf Error I think, but in general, we need OOM&apos;s to bubble up. It seems like the best way to ensure that is to try and minimize use of catch (Throwable...&lt;/p&gt;</comment>
                            <comment id="13794646" author="markrmiller@gmail.com" created="Mon, 14 Oct 2013 23:41:40 +0000"  >&lt;p&gt;Here is a first (somewhat conservative) pass at improving the situation.&lt;/p&gt;</comment>
                            <comment id="13797956" author="markrmiller@gmail.com" created="Thu, 17 Oct 2013 14:35:23 +0000"  >&lt;p&gt;Here is a more complete patch. I&apos;d like to commit shortly and iterate if their are any concerns - this covers a lot of classes and will be outdated very quickly.&lt;/p&gt;</comment>
                            <comment id="13797969" author="yseeley@gmail.com" created="Thu, 17 Oct 2013 14:54:41 +0000"  >&lt;p&gt;Are there response format implications to this?&lt;br/&gt;
For example, on certain errors (like OOM) will I still get a JSON response format back (assuming that&apos;s the writer I&apos;m using)?&lt;/p&gt;</comment>
                            <comment id="13798004" author="markrmiller@gmail.com" created="Thu, 17 Oct 2013 15:25:09 +0000"  >&lt;p&gt;In most cases I still try and log or send the same response before propagating the Throwable. Just fixed some stuff around the SolrDispatcher here on a closer review.&lt;/p&gt;</comment>
                            <comment id="13798039" author="dsmiley" created="Thu, 17 Oct 2013 16:26:59 +0000"  >&lt;p&gt;FYI I thought I&apos;d point out some utilities Google Guava has in this regard:&lt;br/&gt;
&lt;a href=&quot;http://code.google.com/p/guava-libraries/wiki/ClosingResourcesExplained&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://code.google.com/p/guava-libraries/wiki/ClosingResourcesExplained&lt;/a&gt;   &quot;Closer&quot;, as well as various utility methods on the &quot;Throwables&quot; class.&lt;/p&gt;</comment>
                            <comment id="13799305" author="markrmiller@gmail.com" created="Fri, 18 Oct 2013 17:11:07 +0000"  >&lt;p&gt;Nice David.&lt;/p&gt;</comment>
                            <comment id="13869705" author="markrmiller@gmail.com" created="Mon, 13 Jan 2014 17:12:25 +0000"  >&lt;p&gt;I&apos;m going to commit my current progress. I think it&apos;s all okay and we can make improvements on it over time.&lt;/p&gt;</comment>
                            <comment id="13869716" author="jira-bot" created="Mon, 13 Jan 2014 17:27:25 +0000"  >&lt;p&gt;Commit 1557778 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1557778&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1557778&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4992&quot; title=&quot;Solr queries don&amp;#39;t propagate Java OutOfMemoryError back to the JVM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4992&quot;&gt;&lt;del&gt;SOLR-4992&lt;/del&gt;&lt;/a&gt;: Solr eats OutOfMemoryError exceptions in many cases.&lt;/p&gt;</comment>
                            <comment id="13869723" author="jira-bot" created="Mon, 13 Jan 2014 17:35:14 +0000"  >&lt;p&gt;Commit 1557783 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1557783&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1557783&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4992&quot; title=&quot;Solr queries don&amp;#39;t propagate Java OutOfMemoryError back to the JVM&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4992&quot;&gt;&lt;del&gt;SOLR-4992&lt;/del&gt;&lt;/a&gt;: Solr eats OutOfMemoryError exceptions in many cases.&lt;/p&gt;</comment>
                            <comment id="13876476" author="markrmiller@gmail.com" created="Mon, 20 Jan 2014 14:41:39 +0000"  >&lt;p&gt;Thanks Daniel - let&apos;s do further specific work in new issues.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12929841">SOLR-8539</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12608950" name="SOLR-4992.patch" size="63788" author="markrmiller@gmail.com" created="Thu, 17 Oct 2013 15:26:56 +0000"/>
                            <attachment id="12608940" name="SOLR-4992.patch" size="62154" author="markrmiller@gmail.com" created="Thu, 17 Oct 2013 14:35:23 +0000"/>
                            <attachment id="12608383" name="SOLR-4992.patch" size="41677" author="markrmiller@gmail.com" created="Mon, 14 Oct 2013 23:41:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>336259</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 44 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1m02v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>336583</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>