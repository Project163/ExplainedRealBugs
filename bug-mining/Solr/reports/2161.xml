<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:58:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-6704] TrieDateField type drops schema properties in branch 4.10</title>
                <link>https://issues.apache.org/jira/browse/SOLR-6704</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Properties set in the FieldType, like multiValued, docValues, etc are dropped on TrieDateField type.&lt;br/&gt;
This is only happening in the 4.10 branch, 5x and trunk don&apos;t seem to have this issue. &lt;/p&gt;</description>
                <environment></environment>
        <key id="12752814">SOLR-6704</key>
            <summary>TrieDateField type drops schema properties in branch 4.10</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tflobbe">Tomas Eduardo Fernandez Lobbe</assignee>
                                    <reporter username="tflobbe">Tomas Eduardo Fernandez Lobbe</reporter>
                        <labels>
                    </labels>
                <created>Tue, 4 Nov 2014 19:32:58 +0000</created>
                <updated>Wed, 2 Oct 2019 17:30:31 +0000</updated>
                            <resolved>Wed, 5 Nov 2014 22:48:16 +0000</resolved>
                                    <version>4.10.2</version>
                                    <fixVersion>4.10.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="14196662" author="tomasflobbe" created="Tue, 4 Nov 2014 19:33:57 +0000"  >&lt;p&gt;I&apos;m attaching two test cases that pass in trunk and 5x but fail in 4.10&lt;/p&gt;</comment>
                            <comment id="14196691" author="tomasflobbe" created="Tue, 4 Nov 2014 19:45:46 +0000"  >&lt;p&gt;The problem seems to be that the &quot;setArgs&quot; should be delegating to the wrappedField. This is not an issue in 5x or trunk because the implementation was changed and TrieDateField is no longer decorating TrieField but extending it. &lt;br/&gt;
I&apos;m wondering if we are missing other methods in TrieDateField too. I&apos;ll take a look&lt;/p&gt;</comment>
                            <comment id="14198909" author="tomasflobbe" created="Wed, 5 Nov 2014 19:21:11 +0000"  >&lt;p&gt;Looks like this was caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6211&quot; title=&quot;TrieDateField doesn&amp;#39;t default to omitNorms=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6211&quot;&gt;&lt;del&gt;SOLR-6211&lt;/del&gt;&lt;/a&gt;. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;, you proposed not calling &lt;tt&gt;super.init()&lt;/tt&gt; from &lt;tt&gt;init()&lt;/tt&gt; and instead override &lt;tt&gt;hasProperty(p)&lt;/tt&gt; and &lt;tt&gt;isMultiValued()&lt;/tt&gt;. &lt;tt&gt;properties&lt;/tt&gt; are never set in the wrapped instance because &lt;tt&gt;setArgs&lt;/tt&gt; is never called. If we call &lt;tt&gt;wrappedField.setArgs&lt;/tt&gt; like I did in my initial patch, then we need to make sure anything that requires properties is delegated to wrappedField. If instead we do &lt;tt&gt;super.init()&lt;/tt&gt; from &lt;tt&gt;init()&lt;/tt&gt; this is not needed. &lt;br/&gt;
Here is a patch (for branch 4.10.x) with these changes, old and new tests passing. Any thoughts?&lt;/p&gt;</comment>
                            <comment id="14199040" author="steve_rowe" created="Wed, 5 Nov 2014 20:38:44 +0000"  >&lt;p&gt;Yeah, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6211&quot; title=&quot;TrieDateField doesn&amp;#39;t default to omitNorms=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6211&quot;&gt;&lt;del&gt;SOLR-6211&lt;/del&gt;&lt;/a&gt; did cause this - it was an incomplete fix.  My thought then was that there should not be two active copies of properties, one in the wrapped impl and another in the containing class.  I still think that&apos;s better; this is fixed in trunk and 5x because extending instead of wrapping results in just one properties copy.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If we call &lt;tt&gt;wrappedField.setArgs&lt;/tt&gt; like I did in my initial patch, then we need to make sure anything that requires properties is delegated to wrappedField. If instead we do &lt;tt&gt;super.init()&lt;/tt&gt; from &lt;tt&gt;init()&lt;/tt&gt; this is not needed.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;tt&gt;super.init()&lt;/tt&gt; calls &lt;tt&gt;PrimitiveFieldType.init()&lt;/tt&gt;, which conditionally sets the omit norms property (doing this would have fixed &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6211&quot; title=&quot;TrieDateField doesn&amp;#39;t default to omitNorms=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6211&quot;&gt;&lt;del&gt;SOLR-6211&lt;/del&gt;&lt;/a&gt;), and then chains to &lt;tt&gt;FieldType.init()&lt;/tt&gt;, which is a no-op.  The only place &lt;tt&gt;setArgs()&lt;/tt&gt; is called is from &lt;tt&gt;FieldTypePluginLoader.init()&lt;/tt&gt;. The way your second patch fixes the problem is by removing the overridden &lt;tt&gt;hasProperty()&lt;/tt&gt; and &lt;tt&gt;isMultiValued()&lt;/tt&gt; methods on &lt;tt&gt;TrieDateField&lt;/tt&gt;, so that queries are answered with the containing class&apos;s copy of properties instead of the wrapped class&apos;s copy.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Here is a patch (for branch 4.10.x) with these changes, old and new tests passing. Any thoughts?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1, it&apos;s the simplest fix.  In hindsight I should have gone this way with the &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6211&quot; title=&quot;TrieDateField doesn&amp;#39;t default to omitNorms=true&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6211&quot;&gt;&lt;del&gt;SOLR-6211&lt;/del&gt;&lt;/a&gt; fix.&lt;/p&gt;

&lt;p&gt;Thanks Tom&#225;s!&lt;/p&gt;</comment>
                            <comment id="14199054" author="tomasflobbe" created="Wed, 5 Nov 2014 20:44:45 +0000"  >&lt;p&gt;Thanks for reviewing. Will also include the tests in trunk and branch 5x&lt;/p&gt;</comment>
                            <comment id="14199085" author="tomasflobbe" created="Wed, 5 Nov 2014 21:08:13 +0000"  >&lt;p&gt;Patch for trunk attached. It only includes the tests. This will also be merged to branch 5x&lt;/p&gt;</comment>
                            <comment id="14199108" author="tomasflobbe" created="Wed, 5 Nov 2014 21:21:19 +0000"  >&lt;p&gt;Patch for branch 4.10.x&lt;/p&gt;</comment>
                            <comment id="14199201" author="jira-bot" created="Wed, 5 Nov 2014 22:04:10 +0000"  >&lt;p&gt;Commit 1636980 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tflobbe&quot; class=&quot;user-hover&quot; rel=&quot;tflobbe&quot;&gt;tflobbe&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1636980&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1636980&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6704&quot; title=&quot;TrieDateField type drops schema properties in branch 4.10&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6704&quot;&gt;&lt;del&gt;SOLR-6704&lt;/del&gt;&lt;/a&gt;: Added unit tests that uncovered TrieDateField bug in branch 4.10.x&lt;/p&gt;</comment>
                            <comment id="14199217" author="jira-bot" created="Wed, 5 Nov 2014 22:17:36 +0000"  >&lt;p&gt;Commit 1636985 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tflobbe&quot; class=&quot;user-hover&quot; rel=&quot;tflobbe&quot;&gt;tflobbe&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1636985&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1636985&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6704&quot; title=&quot;TrieDateField type drops schema properties in branch 4.10&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6704&quot;&gt;&lt;del&gt;SOLR-6704&lt;/del&gt;&lt;/a&gt;: Added unit tests that uncovered TrieDateField bug in branch 4.10.x&lt;/p&gt;</comment>
                            <comment id="14199276" author="jira-bot" created="Wed, 5 Nov 2014 22:46:49 +0000"  >&lt;p&gt;Commit 1636998 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tflobbe&quot; class=&quot;user-hover&quot; rel=&quot;tflobbe&quot;&gt;tflobbe&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_4_10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1636998&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1636998&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6704&quot; title=&quot;TrieDateField type drops schema properties in branch 4.10&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6704&quot;&gt;&lt;del&gt;SOLR-6704&lt;/del&gt;&lt;/a&gt;: fixed bug in TrieDateField that was making Solr drop schema properties defined in the field type&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12724341">SOLR-6211</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12679631" name="SOLR-6704-branch_4_10.patch" size="1982" author="tflobbe" created="Wed, 5 Nov 2014 21:21:19 +0000"/>
                            <attachment id="12679627" name="SOLR-6704-trunk.patch" size="3981" author="tflobbe" created="Wed, 5 Nov 2014 21:08:13 +0000"/>
                            <attachment id="12679603" name="SOLR-6704.patch" size="5238" author="tflobbe" created="Wed, 5 Nov 2014 19:21:11 +0000"/>
                            <attachment id="12679294" name="SOLR-6704.patch" size="3884" author="tflobbe" created="Tue, 4 Nov 2014 19:45:46 +0000"/>
                            <attachment id="12679289" name="testcases.patch" size="3372" author="tflobbe" created="Tue, 4 Nov 2014 19:33:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 2 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i21yj3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>