<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:35:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-12814] Metrics history causing &quot;HttpParser URI is too large &gt;8192&quot; when many collections</title>
                <link>https://issues.apache.org/jira/browse/SOLR-12814</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;If you have a lot of collections, like 50 or more, the new metrics page in version 7.5 can&apos;t run its queries&#160;because the default&#160;solr.jetty.request.header.size and&#160;solr.jetty.response.header.size values are too small.&lt;/p&gt;

&lt;p&gt;If I up the header values from&#160;8192 to&#160;65536 the commands will work.&lt;/p&gt;

&lt;p&gt;command to change the defaults:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
sed -i &lt;span class=&quot;code-quote&quot;&gt;&apos;s/\&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.jetty.request.header.size\&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;=\&lt;span class=&quot;code-quote&quot;&gt;&quot;8192\&quot;&lt;/span&gt;/\&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.jetty.request.header.size\&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;=\&lt;span class=&quot;code-quote&quot;&gt;&quot;65536\&quot;&lt;/span&gt;/g&apos;&lt;/span&gt; /opt/solr/server/etc/jetty.xml 
sed -i &lt;span class=&quot;code-quote&quot;&gt;&apos;s/\&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.jetty.response.header.size\&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;=\&lt;span class=&quot;code-quote&quot;&gt;&quot;8192\&quot;&lt;/span&gt;/\&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.jetty.response.header.size\&quot;&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;=\&lt;span class=&quot;code-quote&quot;&gt;&quot;65536\&quot;&lt;/span&gt;/g&apos;&lt;/span&gt; /opt/solr/server/etc/jetty.xml
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;before changing the header size log:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2018-09-27 13:06:45.434 INFO (qtp534906248-14) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={wt=javabin&amp;amp;version=2&amp;amp;key=solr.jvm:os.processCpuLoad&amp;amp;key=solr.node:CONTAINER.fs.coreRoot.usableSpace&amp;amp;key=solr.jvm:os.systemLoadAverage&amp;amp;key=solr.jvm:memory.heap.used} status=0 QTime=0
2018-09-27 13:07:45.527 WARN (qtp534906248-17) [ ] o.e.j.h.HttpParser URI is too large &amp;gt;8192
2018-09-27 13:07:45.530 INFO (qtp534906248-16) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={wt=javabin&amp;amp;version=2&amp;amp;key=solr.jvm:os.processCpuLoad&amp;amp;key=solr.node:CONTAINER.fs.coreRoot.usableSpace&amp;amp;key=solr.jvm:os.systemLoadAverage&amp;amp;key=solr.jvm:memory.heap.used} status=0 QTime=0
2018-09-27 13:08:45.621 WARN (qtp534906248-20) [ ] o.e.j.h.HttpParser URI is too large &amp;gt;8192
2018-09-27 13:08:45.625 INFO (qtp534906248-15) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={wt=javabin&amp;amp;version=2&amp;amp;key=solr.jvm:os.processCpuLoad&amp;amp;key=solr.node:CONTAINER.fs.coreRoot.usableSpace&amp;amp;key=solr.jvm:os.systemLoadAverage&amp;amp;key=solr.jvm:memory.heap.used} status=0 QTime=0
2018-09-27 13:09:45.725 WARN (qtp534906248-20) [ ] o.e.j.h.HttpParser URI is too large &amp;gt;8192
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;After changing the header size log:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
attached as a file because its very &lt;span class=&quot;code-object&quot;&gt;long&lt;/span&gt; and ugly&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is it possible to break up this command into batches so that it can run without modifying the header sizes?&#160;&lt;/p&gt;

&lt;p&gt;Thanks!&lt;br/&gt;
 -Matt&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;3x zookeeper and 3x solr cloud servers,&lt;/p&gt;

&lt;p&gt;50 test collections with 0 data in them&lt;/p&gt;</environment>
        <key id="13187910">SOLR-12814</key>
            <summary>Metrics history causing &quot;HttpParser URI is too large &gt;8192&quot; when many collections</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="janhoy">Jan H&#248;ydahl</assignee>
                                    <reporter username="mmedway">matthew medway</reporter>
                        <labels>
                            <label>URI</label>
                            <label>header</label>
                            <label>http</label>
                            <label>httpparser</label>
                            <label>large</label>
                            <label>metrics</label>
                            <label>solr</label>
                            <label>solrcloud</label>
                            <label>too</label>
                            <label>uri</label>
                    </labels>
                <created>Thu, 27 Sep 2018 13:17:11 +0000</created>
                <updated>Sat, 8 Jun 2019 15:01:07 +0000</updated>
                            <resolved>Thu, 4 Oct 2018 16:43:27 +0000</resolved>
                                    <version>7.5</version>
                                    <fixVersion>7.5.1</fixVersion>
                    <fixVersion>7.6</fixVersion>
                    <fixVersion>8.0</fixVersion>
                                    <component>metrics</component>
                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16630482" author="janhoy" created="Thu, 27 Sep 2018 14:09:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;...the new metrics page in version 7.5 can&apos;t run its queries...&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Please be more specific on which metrics page your are referring to, and provide steps to reproduce. Is it the &quot;Cloud-&amp;gt;Nodes&quot; page?&lt;/p&gt;</comment>
                            <comment id="16630499" author="janhoy" created="Thu, 27 Sep 2018 14:13:00 +0000"  >&lt;p&gt;Looks like you are talking about the metrics HTTP API. Have you tried to simply POST your request instead of GET? That is a common way to allow huge requests. See e.g. &lt;a href=&quot;https://superuser.com/questions/149329/what-is-the-curl-command-line-syntax-to-do-a-post-request&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://superuser.com/questions/149329/what-is-the-curl-command-line-syntax-to-do-a-post-request&lt;/a&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16630552" author="elyograg" created="Thu, 27 Sep 2018 14:52:17 +0000"  >&lt;p&gt;I started a 7.5.0 cloud example, created 50 collections, and tried two things:&lt;/p&gt;

&lt;p&gt;1) /solr/admin/metrics&lt;br/&gt;
2) the &quot;Cloud-&amp;gt;Nodes&quot; tab in the UI.&lt;/p&gt;

&lt;p&gt;The metrics page worked just fine &amp;#8211; the URL was very short, and that didn&apos;t result in additional requests with a long URL.  The Nodes tab did not work, and caused an error in the log about the URI being too large.&lt;/p&gt;

&lt;p&gt;I would think that it should be possible for the UI to use POST for the requests on the &quot;nodes&quot; tab instead of GET.  This is not within user control, it would have to be done in the code.&lt;/p&gt;</comment>
                            <comment id="16630621" author="janhoy" created="Thu, 27 Sep 2018 15:34:49 +0000"  >&lt;p&gt;I wonder if this is the MetricsHistoryHandler that issues that request? If you simply sit waiting for a minute without invoking the Cloud-&amp;gt;Nodes tab at all, you&apos;ll get things like this in the log:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2018-09-27 15:32:40.180 DEBUG (MetricsHistoryHandler-12-thread-1) [ &#160; ] o.a.h.headers http-outgoing-46 &amp;gt;&amp;gt; GET /solr/admin/metrics?key=solr.core.27.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.47.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.50.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.5.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.38.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.1.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.43.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.35.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.41.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.26.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.3.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.4.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.39.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.20.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.19.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.30.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.32.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.7.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.32.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.9.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.44.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.12.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.29.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.39.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.31.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.27.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.11.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.43.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.15.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.20.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.50.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.44.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.24.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.33.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.15.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.10.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.40.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.45.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.23.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.47.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.43.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.49.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.32.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.42.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.16.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.30.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.3.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.3.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.13.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.12.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.17.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.16.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.49.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.37.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.18.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.15.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.9.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.14.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.24.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.23.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.25.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.28.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.19.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.7.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.2.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.22.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.41.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.27.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.21.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.10.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.31.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.20.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.5.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.21.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.17.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.48.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.1.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.8.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.23.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.17.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.11.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.2.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.37.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.47.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.35.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.6.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.4.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.2.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.44.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.40.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.45.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.42.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.18.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.29.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.33.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.31.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.8.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.1.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.9.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.49.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.22.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.26.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.21.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.7.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.28.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.29.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.22.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.46.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.10.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.14.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.11.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.25.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.30.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.34.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.36.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.13.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.46.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.12.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.33.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.50.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.42.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.41.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.40.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.48.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.28.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.16.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.18.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.46.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.26.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.36.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.6.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.25.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.19.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.38.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.48.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.8.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.13.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.6.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.35.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.34.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.38.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.37.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.36.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.34.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.4.shard1.replica_n1%3AQUERY.%2Fselect.requests&amp;amp;key=solr.core.14.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.39.shard1.replica_n1%3AUPDATE.%2Fupdate.requests&amp;amp;key=solr.core.45.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.5.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;key=solr.core.24.shard1.replica_n1%3AINDEX.sizeInBytes&amp;amp;wt=javabin&amp;amp;version=2 HTTP/1.1&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16630626" author="mmedway" created="Thu, 27 Sep 2018 15:39:40 +0000"  >&lt;p&gt;yea, without doing anything i can run&#160;&quot;tail -f /var/solr/logs/solr.log&quot; and just watch for the error to happen.&#160;&lt;/p&gt;

&lt;p&gt;I should clarify that the metrics api works fine but the nodes page is not showing stats correctly just like &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=elyograg&quot; class=&quot;user-hover&quot; rel=&quot;elyograg&quot;&gt;elyograg&lt;/a&gt;&#160;said&lt;/p&gt;</comment>
                            <comment id="16630655" author="janhoy" created="Thu, 27 Sep 2018 15:54:26 +0000"  >&lt;p&gt;Hmm, can you detail what stats are wrong in nodes page? Screenshot? I did a quick test with one node and 50 empty collections and all looks normal. Perhaps in a distributed cluster things are different?&lt;/p&gt;</comment>
                            <comment id="16630665" author="mmedway" created="Thu, 27 Sep 2018 16:04:32 +0000"  >&lt;p&gt;Hrmm. The nodes page is still working this time, maybe its because i had the bigger headers set earlier today.&#160; I am now getting the error about URI being too large again:&lt;/p&gt;

&lt;p&gt;cat /var/solr/logs/solr.log | grep -i WARN -B 10 -A 10&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
--
2018-09-27 15:58:49.887 INFO (qtp534906248-19) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/info/system params={wt=json&amp;amp;_=1538063896110} status=0 QTime=7
2018-09-27 15:58:49.902 INFO (qtp534906248-19) [ ] o.a.s.h.a.CollectionsHandler Invoked Collection Action :list with params action=LIST&amp;amp;wt=json&amp;amp;_=1538063896110 and sendToOCPQueue=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
2018-09-27 15:58:49.902 INFO (qtp534906248-19) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/collections params={action=LIST&amp;amp;wt=json&amp;amp;_=1538063896110} status=0 QTime=0
2018-09-27 15:58:49.927 INFO (qtp534906248-16) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/collections params={action=CLUSTERSTATUS&amp;amp;wt=json&amp;amp;_=1538063896110} status=0 QTime=41
2018-09-27 15:58:49.977 INFO (qtp534906248-21) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/info/system params={wt=javabin&amp;amp;version=2&amp;amp;_=1538063896110} status=0 QTime=31
2018-09-27 15:58:49.978 INFO (qtp534906248-14) [ ] o.a.s.h.a.AdminHandlersProxy Fetched response from 3 nodes: [172.19.1.223:8983_solr, 172.19.7.118:8983_solr, 172.19.0.107:8983_solr]
2018-09-27 15:58:49.978 INFO (qtp534906248-14) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/info/system params={nodes=172.19.0.107:8983_solr,172.19.1.223:8983_solr,172.19.7.118:8983_solr&amp;amp;wt=json&amp;amp;_=1538063896110} status=0 QTime=36
2018-09-27 15:58:49.996 INFO (qtp534906248-18) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={prefix=CONTAINER.fs,org.eclipse.jetty.server.handler.DefaultHandler.get-requests,INDEX.sizeInBytes,SEARCHER.searcher.numDocs,SEARCHER.searcher.deletedDocs,SEARCHER.searcher.warmupTime&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;_=1538063896206} status=0 QTime=38
2018-09-27 15:58:49.998 INFO (qtp534906248-19) [ ] o.a.s.h.a.AdminHandlersProxy Fetched response from 3 nodes: [172.19.1.223:8983_solr, 172.19.7.118:8983_solr, 172.19.0.107:8983_solr]
2018-09-27 15:58:49.998 INFO (qtp534906248-19) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={nodes=172.19.0.107:8983_solr,172.19.1.223:8983_solr,172.19.7.118:8983_solr&amp;amp;prefix=CONTAINER.fs,org.eclipse.jetty.server.handler.DefaultHandler.get-requests,INDEX.sizeInBytes,SEARCHER.searcher.numDocs,SEARCHER.searcher.deletedDocs,SEARCHER.searcher.warmupTime&amp;amp;wt=json&amp;amp;_=1538063896206} status=0 QTime=54
2018-09-27 15:59:03.747 WARN (qtp534906248-12) [ ] o.e.j.h.HttpParser URI is too large &amp;gt;8192
2018-09-27 15:59:03.753 INFO (qtp534906248-17) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={wt=javabin&amp;amp;version=2&amp;amp;key=solr.jvm:os.processCpuLoad&amp;amp;key=solr.node:CONTAINER.fs.coreRoot.usableSpace&amp;amp;key=solr.jvm:os.systemLoadAverage&amp;amp;key=solr.jvm:memory.heap.used} status=0 QTime=1
2018-09-27 16:00:02.130 INFO (qtp534906248-12) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={} status=0 QTime=311
2018-09-27 16:00:02.206 INFO (qtp534906248-21) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={} status=0 QTime=388
2018-09-27 16:00:02.230 INFO (qtp534906248-19) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={} status=0 QTime=404
2018-09-27 16:00:03.856 WARN (qtp534906248-12) [ ] o.e.j.h.HttpParser URI is too large &amp;gt;8192
2018-09-27 16:00:03.859 INFO (qtp534906248-14) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={wt=javabin&amp;amp;version=2&amp;amp;key=solr.jvm:os.processCpuLoad&amp;amp;key=solr.node:CONTAINER.fs.coreRoot.usableSpace&amp;amp;key=solr.jvm:os.systemLoadAverage&amp;amp;key=solr.jvm:memory.heap.used} status=0 QTime=0
2018-09-27 16:00:19.599 INFO (qtp534906248-12) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/cores params={indexInfo=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;amp;wt=json&amp;amp;_=1538063985822} status=0 QTime=0
2018-09-27 16:00:19.601 INFO (qtp534906248-17) [ ] o.a.s.h.a.CollectionsHandler Invoked Collection Action :clusterstatus with params action=CLUSTERSTATUS&amp;amp;wt=json&amp;amp;_=1538063985823 and sendToOCPQueue=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
2018-09-27 16:00:19.612 INFO (qtp534906248-14) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/info/system params={wt=json&amp;amp;_=1538063985823} status=0 QTime=12
2018-09-27 16:00:19.624 INFO (qtp534906248-18) [ ] o.a.s.h.a.CollectionsHandler Invoked Collection Action :list with params action=LIST&amp;amp;wt=json&amp;amp;_=1538063985823 and sendToOCPQueue=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
2018-09-27 16:00:19.625 INFO (qtp534906248-18) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/collections params={action=LIST&amp;amp;wt=json&amp;amp;_=1538063985823} status=0 QTime=0
2018-09-27 16:00:19.659 INFO (qtp534906248-17) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/collections params={action=CLUSTERSTATUS&amp;amp;wt=json&amp;amp;_=1538063985823} status=0 QTime=58
2018-09-27 16:00:19.702 INFO (qtp534906248-16) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={prefix=CONTAINER.fs,org.eclipse.jetty.server.handler.DefaultHandler.get-requests,INDEX.sizeInBytes,SEARCHER.searcher.numDocs,SEARCHER.searcher.deletedDocs,SEARCHER.searcher.warmupTime&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;_=1538063985922} status=0 QTime=29
2018-09-27 16:00:19.703 INFO (qtp534906248-18) [ ] o.a.s.h.a.AdminHandlersProxy Fetched response from 3 nodes: [172.19.1.223:8983_solr, 172.19.7.118:8983_solr, 172.19.0.107:8983_solr]
2018-09-27 16:00:19.703 INFO (qtp534906248-18) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={nodes=172.19.0.107:8983_solr,172.19.1.223:8983_solr,172.19.7.118:8983_solr&amp;amp;prefix=CONTAINER.fs,org.eclipse.jetty.server.handler.DefaultHandler.get-requests,INDEX.sizeInBytes,SEARCHER.searcher.numDocs,SEARCHER.searcher.deletedDocs,SEARCHER.searcher.warmupTime&amp;amp;wt=json&amp;amp;_=1538063985922} status=0 QTime=33
--
2018-09-27 16:01:02.752 INFO (qtp534906248-17) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/info/system params={wt=json&amp;amp;_=1538064028971} status=0 QTime=6
2018-09-27 16:01:02.771 INFO (qtp534906248-17) [ ] o.a.s.h.a.CollectionsHandler Invoked Collection Action :list with params action=LIST&amp;amp;wt=json&amp;amp;_=1538064028971 and sendToOCPQueue=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;
2018-09-27 16:01:02.771 INFO (qtp534906248-17) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/collections params={action=LIST&amp;amp;wt=json&amp;amp;_=1538064028971} status=0 QTime=0
2018-09-27 16:01:02.798 INFO (qtp534906248-19) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/collections params={action=CLUSTERSTATUS&amp;amp;wt=json&amp;amp;_=1538064028971} status=0 QTime=48
2018-09-27 16:01:02.841 INFO (qtp534906248-21) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/info/system params={wt=javabin&amp;amp;version=2&amp;amp;_=1538064028971} status=0 QTime=30
2018-09-27 16:01:02.842 INFO (qtp534906248-15) [ ] o.a.s.h.a.AdminHandlersProxy Fetched response from 3 nodes: [172.19.1.223:8983_solr, 172.19.7.118:8983_solr, 172.19.0.107:8983_solr]
2018-09-27 16:01:02.842 INFO (qtp534906248-15) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/info/system params={nodes=172.19.0.107:8983_solr,172.19.1.223:8983_solr,172.19.7.118:8983_solr&amp;amp;wt=json&amp;amp;_=1538064028971} status=0 QTime=34
2018-09-27 16:01:02.851 INFO (qtp534906248-16) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={prefix=CONTAINER.fs,org.eclipse.jetty.server.handler.DefaultHandler.get-requests,INDEX.sizeInBytes,SEARCHER.searcher.numDocs,SEARCHER.searcher.deletedDocs,SEARCHER.searcher.warmupTime&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;_=1538064029069} status=0 QTime=38
2018-09-27 16:01:02.852 INFO (qtp534906248-17) [ ] o.a.s.h.a.AdminHandlersProxy Fetched response from 3 nodes: [172.19.1.223:8983_solr, 172.19.7.118:8983_solr, 172.19.0.107:8983_solr]
2018-09-27 16:01:02.852 INFO (qtp534906248-17) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={nodes=172.19.0.107:8983_solr,172.19.1.223:8983_solr,172.19.7.118:8983_solr&amp;amp;prefix=CONTAINER.fs,org.eclipse.jetty.server.handler.DefaultHandler.get-requests,INDEX.sizeInBytes,SEARCHER.searcher.numDocs,SEARCHER.searcher.deletedDocs,SEARCHER.searcher.warmupTime&amp;amp;wt=json&amp;amp;_=1538064029069} status=0 QTime=44
2018-09-27 16:01:03.962 WARN (qtp534906248-20) [ ] o.e.j.h.HttpParser URI is too large &amp;gt;8192
2018-09-27 16:01:03.966 INFO (qtp534906248-21) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={wt=javabin&amp;amp;version=2&amp;amp;key=solr.jvm:os.processCpuLoad&amp;amp;key=solr.node:CONTAINER.fs.coreRoot.usableSpace&amp;amp;key=solr.jvm:os.systemLoadAverage&amp;amp;key=solr.jvm:memory.heap.used} status=0 QTime=0
2018-09-27 16:02:04.071 WARN (qtp534906248-14) [ ] o.e.j.h.HttpParser URI is too large &amp;gt;8192
2018-09-27 16:02:04.077 INFO (qtp534906248-16) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={wt=javabin&amp;amp;version=2&amp;amp;key=solr.jvm:os.processCpuLoad&amp;amp;key=solr.node:CONTAINER.fs.coreRoot.usableSpace&amp;amp;key=solr.jvm:os.systemLoadAverage&amp;amp;key=solr.jvm:memory.heap.used} status=0 QTime=0
2018-09-27 16:03:04.181 WARN (qtp534906248-21) [ ] o.e.j.h.HttpParser URI is too large &amp;gt;8192
2018-09-27 16:03:04.185 INFO (qtp534906248-20) [ ] o.a.s.s.HttpSolrCall [admin] webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/metrics params={wt=javabin&amp;amp;version=2&amp;amp;key=solr.jvm:os.processCpuLoad&amp;amp;key=solr.node:CONTAINER.fs.coreRoot.usableSpace&amp;amp;key=solr.jvm:os.systemLoadAverage&amp;amp;key=solr.jvm:memory.heap.used} status=0 QTime=0

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16630746" author="janhoy" created="Thu, 27 Sep 2018 17:09:57 +0000"  >&lt;p&gt;Definitely looks like requests from nodes page. Will have a look if we can explicitly do POST for these. The initial request only specifies prefix params but somehow they seem to be translated into a longer list of key params somewhere?&lt;/p&gt;</comment>
                            <comment id="16630804" author="mmedway" created="Thu, 27 Sep 2018 17:49:30 +0000"  >&lt;p&gt;Amazing! looking forward to your next update thanks!&lt;/p&gt;</comment>
                            <comment id="16630938" author="elyograg" created="Thu, 27 Sep 2018 19:25:02 +0000"  >&lt;p&gt;Now here&apos;s something interesting.&lt;/p&gt;

&lt;p&gt;As I mentioned, I used the cloud example, so everything&apos;s on localhost.  Windows 10 Professional, 64-bit.&lt;/p&gt;

&lt;p&gt;If I use &quot;localhost&quot; to access the UI, the Nodes tab doesn&apos;t work.  But if I use the IP address of my machine, then it DOES work!  That&apos;s really strange.&lt;/p&gt;

&lt;p&gt; &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12941586/12941586_screencapture-nodes-actual-IP.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Here&apos;s something showing the collections I created:&lt;/p&gt;

&lt;p&gt; &lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12941587/12941587_screencapture-cloud-graph.png&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt; &lt;/p&gt;</comment>
                            <comment id="16630945" author="elyograg" created="Thu, 27 Sep 2018 19:33:30 +0000"  >&lt;p&gt;OK, now I&apos;m REALLY confused.&lt;/p&gt;

&lt;p&gt;After accessing the URL with the IP address, I tried the localhost URL again, and it worked.  And then I added another 50 collections, and it&apos;s STILL working.&lt;/p&gt;</comment>
                            <comment id="16630953" author="elyograg" created="Thu, 27 Sep 2018 19:38:22 +0000"  >&lt;p&gt;The developer console is showing all the requests made to create the page as GET requests, none as POST.  I stopped and restarted the example ... and it is still working.  How&apos;s that for frustrating?&lt;/p&gt;</comment>
                            <comment id="16630978" author="janhoy" created="Thu, 27 Sep 2018 20:11:47 +0000"  >&lt;p&gt;Think I found the place where the huge GET request is created&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
First MetricsHistoryHandler wants to collect global metrics:

collectGlobalMetrics:481, MetricsHistoryHandler -&amp;gt;
getReplicaInfo:169, SolrClientNodeStateProvider -&amp;gt;
fetchReplicaMetrics:186, SolrClientNodeStateProvider -&amp;gt;
fetchReplicaMetrics:195, SolrClientNodeStateProvider

  params.add(&lt;span class=&quot;code-quote&quot;&gt;&quot;key&quot;&lt;/span&gt;, metricsKeyVsTag.keySet().toArray(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[0])); &amp;lt;--- This keyset is huge and overruns the limit
...
  SimpleSolrResponse rsp = ctx.invoke(solrNode, CommonParams.METRICS_PATH, params); &amp;lt;--- Invoke the request
...
  GenericSolrRequest request = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; GenericSolrRequest(SolrRequest.METHOD.GET, path, params); &amp;lt;--- Which uses get&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ab&quot; class=&quot;user-hover&quot; rel=&quot;ab&quot;&gt;ab&lt;/a&gt;&#160;and&#160;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt;&#160;you may know this part of the code. Below is screenshot from debug session where you see &lt;tt&gt;SolrClientNodeStateProvider&lt;/tt&gt; class trying to invoke a huge request with 150 metric keys:&lt;/p&gt;

&lt;p&gt;&lt;span class=&quot;image-wrap&quot; style=&quot;&quot;&gt;&lt;img src=&quot;https://issues.apache.org/jira/secure/attachment/12941593/12941593_screenshot-debug.png&quot; width=&quot;900&quot; style=&quot;border: 0px solid black&quot; /&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="16636093" author="janhoy" created="Tue, 2 Oct 2018 20:45:30 +0000"  >&lt;p&gt;Simple solution was to change from GET to POST, see&#160;&lt;a href=&quot;https://github.com/apache/lucene-solr/pull/461&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;GitHub Pull Request #461&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Tested same way I used to verify the bug, i.e. creating 50 collections locally. With the patch we see that all&#160;the scheduled metrics history queries every minute succeed.&lt;/p&gt;

&lt;p&gt;I plan to commit this on Thursday. If you&#160;believe this should be fixed in another way, then&#160;shout out!&lt;/p&gt;</comment>
                            <comment id="16636097" author="mmedway" created="Tue, 2 Oct 2018 20:49:56 +0000"  >&lt;p&gt;yay!!&lt;/p&gt;</comment>
                            <comment id="16638494" author="jira-bot" created="Thu, 4 Oct 2018 16:38:06 +0000"  >&lt;p&gt;Commit 5fb384c9898176d34fffe2b310a0a815d8aebecb in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=janhoy&quot; class=&quot;user-hover&quot; rel=&quot;janhoy&quot;&gt;janhoy&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5fb384c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5fb384c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12814&quot; title=&quot;Metrics history causing &amp;quot;HttpParser URI is too large &amp;gt;8192&amp;quot; when many collections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12814&quot;&gt;&lt;del&gt;SOLR-12814&lt;/del&gt;&lt;/a&gt;: Metrics history causing &quot;HttpParser URI is too large &amp;gt;8192&quot; when many collections&lt;br/&gt;
This fixes #461&lt;/p&gt;</comment>
                            <comment id="16638497" author="jira-bot" created="Thu, 4 Oct 2018 16:39:30 +0000"  >&lt;p&gt;Commit 46a530a04e8ac31265d3bbb2bde264360373c5aa in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=janhoy&quot; class=&quot;user-hover&quot; rel=&quot;janhoy&quot;&gt;janhoy&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=46a530a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=46a530a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12814&quot; title=&quot;Metrics history causing &amp;quot;HttpParser URI is too large &amp;gt;8192&amp;quot; when many collections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12814&quot;&gt;&lt;del&gt;SOLR-12814&lt;/del&gt;&lt;/a&gt;: Metrics history causing &quot;HttpParser URI is too large &amp;gt;8192&quot; when many collections&lt;br/&gt;
This fixes #461&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 5fb384c9898176d34fffe2b310a0a815d8aebecb)&lt;/p&gt;</comment>
                            <comment id="16638500" author="jira-bot" created="Thu, 4 Oct 2018 16:43:10 +0000"  >&lt;p&gt;Commit 2f8cae6c285fc8a756a48a3dc5999775659ce4ae in lucene-solr&apos;s branch refs/heads/branch_7_5 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=janhoy&quot; class=&quot;user-hover&quot; rel=&quot;janhoy&quot;&gt;janhoy&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2f8cae6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2f8cae6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12814&quot; title=&quot;Metrics history causing &amp;quot;HttpParser URI is too large &amp;gt;8192&amp;quot; when many collections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12814&quot;&gt;&lt;del&gt;SOLR-12814&lt;/del&gt;&lt;/a&gt;: Metrics history causing &quot;HttpParser URI is too large &amp;gt;8192&quot; when many collections&lt;br/&gt;
This fixes #461&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 5fb384c9898176d34fffe2b310a0a815d8aebecb)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12941537" name="longmetricsquery.txt" size="10286" author="mmedway" created="Thu, 27 Sep 2018 13:14:59 +0000"/>
                            <attachment id="12941587" name="screencapture-cloud-graph.png" size="345340" author="elyograg" created="Thu, 27 Sep 2018 19:24:24 +0000"/>
                            <attachment id="12941586" name="screencapture-nodes-actual-IP.png" size="74899" author="elyograg" created="Thu, 27 Sep 2018 19:23:45 +0000"/>
                            <attachment id="12941593" name="screenshot-debug.png" size="235388" author="janhoy" created="Thu, 27 Sep 2018 20:09:14 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 6 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3yklr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>