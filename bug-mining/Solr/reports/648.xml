<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:22:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2567] Solr should default to TieredMergePolicy</title>
                <link>https://issues.apache.org/jira/browse/SOLR-2567</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;even if we set a luceneMatchVersion to &amp;gt;= 3.2 (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2557&quot; title=&quot;ensure example configuration files have the correct LUCENE_MATCH_VERSION&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2557&quot;&gt;&lt;del&gt;SOLR-2557&lt;/del&gt;&lt;/a&gt;),&lt;br/&gt;
Solr still defaults to LogByte&lt;/p&gt;</description>
                <environment></environment>
        <key id="12508936">SOLR-2567</key>
            <summary>Solr should default to TieredMergePolicy</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rcmuir">Robert Muir</assignee>
                                    <reporter username="rcmuir">Robert Muir</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Jun 2011 10:07:30 +0000</created>
                <updated>Sat, 2 Jul 2011 02:43:14 +0000</updated>
                            <resolved>Wed, 8 Jun 2011 18:03:04 +0000</resolved>
                                                    <fixVersion>3.3</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                    <component>update</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13042080" author="rcmuir" created="Wed, 1 Jun 2011 10:09:33 +0000"  >&lt;p&gt;the patch currently adjusts the default based on luceneMatchVersion, but this is confusing if we release 3.2 that &quot;disagrees&quot; with lucene&apos;s actual 3.2 defaults.&lt;/p&gt;

&lt;p&gt;we could check onOrAfter 3.3 at least to be safe so we don&apos;t surprise anyone when 3.3 comes out&lt;/p&gt;</comment>
                            <comment id="13042406" author="rcmuir" created="Wed, 1 Jun 2011 20:37:59 +0000"  >&lt;p&gt;updated the patch, to check onOrAfter 3.3.&lt;/p&gt;

&lt;p&gt;Also it applies mergefactor and compoundfile to TieredMergePolicy.&lt;/p&gt;

&lt;p&gt;I think this is ready to commit.&lt;/p&gt;</comment>
                            <comment id="13042413" author="mikemccand" created="Wed, 1 Jun 2011 20:42:05 +0000"  >&lt;p&gt;Patch looks great &amp;#8211; thanks Robert!&lt;/p&gt;</comment>
                            <comment id="13042426" author="yseeley@gmail.com" created="Wed, 1 Jun 2011 20:54:45 +0000"  >&lt;blockquote&gt;&lt;p&gt;the patch currently adjusts the default based on luceneMatchVersion, but this is confusing if we release 3.2 that &quot;disagrees&quot; with lucene&apos;s actual 3.2 defaults.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t think all of Solr&apos;s defaults need to match Lucene&apos;s defaults in general - we can take it on a case-by-case basis.  In this case, a TieredMergePolicy default certainly does make sense.  I&apos;m not even sure it needed to be linked to luceneMatchVersion... it&apos;s a rare solr user that would depend on the specifics of merging or docid behavioral changes.&lt;/p&gt;</comment>
                            <comment id="13042442" author="rcmuir" created="Wed, 1 Jun 2011 21:16:53 +0000"  >&lt;p&gt;Well, mostly here I was admitting that I screwed this up for 3.2&lt;/p&gt;

&lt;p&gt;One of the major reasons we respun was to ensure solr used the most recent lucene version configuration so it had features like this... yet it still didnt enable TieredMP.&lt;/p&gt;

&lt;p&gt;I guess what I&apos;m saying is... I&apos;m willing to respin if anyone thinks its a huge deal. In this case I honestly think our 3.2RC is a good release even though this isn&apos;t enabled yet, and we should just target 3.3.&lt;/p&gt;</comment>
                            <comment id="13042447" author="thetaphi" created="Wed, 1 Jun 2011 21:30:23 +0000"  >&lt;p&gt;I just wanted to remember that the matchVersion stuff this time is done without reparsing each time &lt;b&gt;duck&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;I agree with Yonik, that in the case of Solr, we can easily change the default without matchVersion, as nothing in solr depends on docids in order. Solr always used real docids.&lt;/p&gt;</comment>
                            <comment id="13042452" author="mikemccand" created="Wed, 1 Jun 2011 21:35:02 +0000"  >&lt;p&gt;I don&apos;t think we should respin &amp;#8211; just make it the default MP for 3.3?&lt;/p&gt;

&lt;p&gt;But, I think we should use luceneMatchVersion to conditionalize it.&lt;br/&gt;
It&apos;s a biggish change, that docIDs can now be &quot;shuffled&quot;, so in case&lt;br/&gt;
there is some Solr app out there that relies on docIDs staying in order,&lt;br/&gt;
we should respect the luceneMatchVersion.&lt;/p&gt;</comment>
                            <comment id="13042457" author="thetaphi" created="Wed, 1 Jun 2011 21:40:28 +0000"  >&lt;p&gt;Additionally, I dont think its a problem to respin because of that. If we want consistency in Solr with Lucene (and I am huge +1 to be consistent in all case - this time against Yonik), we should respin and fix this (along with the small issues brought on the vote thread).&lt;/p&gt;</comment>
                            <comment id="13042458" author="rcmuir" created="Wed, 1 Jun 2011 21:40:35 +0000"  >&lt;blockquote&gt;&lt;p&gt;Solr always used real docids.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Even when you sort only by score? in this case the lucene docid is the &quot;tiebreaker&quot;, no?&lt;/p&gt;</comment>
                            <comment id="13042461" author="markrmiller@gmail.com" created="Wed, 1 Jun 2011 21:46:50 +0000"  >&lt;p&gt;My initial reaction was it was not worth re-spinning for this either. But mostly based on the assumption that the user could just configure it, and at worst we could drop a note about it.&lt;/p&gt;

&lt;p&gt;Then I saw that there would be some side affects to that based on this patch? I didn&apos;t really look closely, but from memory, I guess it would disable being able to set compound file? And you wouldn&apos;t be able to change the tiered policies settings? Or does Solr&apos;s config any given method voodoo work in this case?&lt;/p&gt;

&lt;p&gt;Either way, I&apos;d be fine if we didn&apos;t respin or if we did. It would still be an improvement, even if it didn&apos;t support compound, and then that can be another improvement.&lt;/p&gt;</comment>
                            <comment id="13042465" author="rcmuir" created="Wed, 1 Jun 2011 21:47:44 +0000"  >&lt;blockquote&gt;&lt;p&gt;Additionally, I dont think its a problem to respin because of that. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You are right, its no problem at all to respin, I don&apos;t mind doing this at all. The only problem is that committers must spend their time to re-review the release candidate, but I suppose if they watch the commits list they can be more confident in their checking and not have to waste a lot of time, since its only this issue and maybe two other small things that were found.&lt;/p&gt;

&lt;p&gt;In fact, Mike committed a &quot;HuperDuper&quot; automated-checker to do some of the grunt work of checking a release to luceneutil today: &lt;a href=&quot;http://code.google.com/a/apache-extras.org/p/luceneutil/source/detail?r=5bf3a0ea4922bbeb38a0a16c503b42e07c028eab&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://code.google.com/a/apache-extras.org/p/luceneutil/source/detail?r=5bf3a0ea4922bbeb38a0a16c503b42e07c028eab&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;So maybe its a good opportunity to use this utility to aid in easier review of release candidates.&lt;/p&gt;</comment>
                            <comment id="13042471" author="rcmuir" created="Wed, 1 Jun 2011 21:57:19 +0000"  >&lt;blockquote&gt;
&lt;p&gt;Then I saw that there would be some side affects to that based on this patch? I didn&apos;t really look closely, but from memory, I guess it would disable being able to set compound file? And you wouldn&apos;t be able to change the tiered policies settings? Or does Solr&apos;s config any given method voodoo work in this case?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Right, this is definitely a downside to not having this patch, they cannot set compoundFile or mergeFactor. &lt;/p&gt;

&lt;p&gt;And you are also right about tiered policy settings... you will notice I didn&apos;t actually enable these in the patch. I guess thats because I thought it would be confusing to add &quot;MP-specific&quot; settings all piled in to the config. I was planning on opening another issue for this to allow for a factory configuration like other things, especially so I can pass a &apos;long&apos; random seed so that tests can use MockRandomMergePolicy &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13042475" author="rcmuir" created="Wed, 1 Jun 2011 22:07:53 +0000"  >&lt;p&gt;Anyway, I&apos;m interested in what others think the right thing to do here is... we can bring it to the dev@ list if it will grab more attention.&lt;/p&gt;

&lt;p&gt;the choices to me seem to be:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;release 3.2 as is, enable TieredMergePolicy in 3.3, using luceneMatchVersion &amp;gt;= 3.3&lt;/li&gt;
	&lt;li&gt;release 3.2 as is, enable TieredMergePolicy in 3.3, just changing the default completely.&lt;/li&gt;
	&lt;li&gt;respin and use this patch, with TieredMergePolicy defaulted on for luceneMatchVersion &amp;gt;= 3.2 (consistent with lucene), but you don&apos;t have total configuration over all its settings (just mergefactor and compoundfile).&lt;/li&gt;
	&lt;li&gt;respin like the above, but also quickly try to add support for MergePolicyFactory or similar, so that all tieredMP settings are exposed&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;and maybe there are other ideas I haven&apos;t mentioned.&lt;/p&gt;</comment>
                            <comment id="13042479" author="steve_rowe" created="Wed, 1 Jun 2011 22:12:22 +0000"  >&lt;p&gt;+1 for #1 (release 3.2 as is, enable full TMP support in 3.3)&lt;/p&gt;</comment>
                            <comment id="13042484" author="mikemccand" created="Wed, 1 Jun 2011 22:20:49 +0000"  >&lt;p&gt;+1 for #1 too&lt;/p&gt;</comment>
                            <comment id="13042533" author="yseeley@gmail.com" created="Thu, 2 Jun 2011 00:36:00 +0000"  >&lt;p&gt;Yeah, our release process can be painful enough (esp given the 72 hr thing) that I don&apos;t think this should keep us from releasing 3.2.&lt;br/&gt;
I&apos;m fine with #1 or #2&lt;/p&gt;</comment>
                            <comment id="13042658" author="rcmuir" created="Thu, 2 Jun 2011 09:21:17 +0000"  >&lt;p&gt;OK, I created &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2572&quot; title=&quot;improve mergepolicy configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2572&quot;&gt;&lt;del&gt;SOLR-2572&lt;/del&gt;&lt;/a&gt; to improve mergepolicy configuration. &lt;/p&gt;

&lt;p&gt;This way when we enable TieredMP, the user will be able to configure all of its options&lt;/p&gt;</comment>
                            <comment id="13046100" author="rcmuir" created="Wed, 8 Jun 2011 17:36:09 +0000"  >&lt;p&gt;ok, here&apos;s a patch for committing.&lt;/p&gt;

&lt;p&gt;After reviewing &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2572&quot; title=&quot;improve mergepolicy configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2572&quot;&gt;&lt;del&gt;SOLR-2572&lt;/del&gt;&lt;/a&gt;, I think its overkill at the moment.&lt;/p&gt;

&lt;p&gt;This is because SolrPluginUtils.applySetters takes care of all possible parameters we have in all of our mergepolicies (including contrib) available today: all the parameters are setters that take primitive types.&lt;/p&gt;

&lt;p&gt;So, I&apos;d like to commit this shortly and cancel &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2572&quot; title=&quot;improve mergepolicy configuration&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2572&quot;&gt;&lt;del&gt;SOLR-2572&lt;/del&gt;&lt;/a&gt; as &quot;won&apos;t fix&quot;.&lt;/p&gt;

&lt;p&gt;I added a test that configures some tiered-mp specific stuff.&lt;/p&gt;</comment>
                            <comment id="13058959" author="rcmuir" created="Sat, 2 Jul 2011 02:43:14 +0000"  >&lt;p&gt;Bulk close for 3.3&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12509069">SOLR-2572</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12481844" name="SOLR-2567.patch" size="10851" author="rcmuir" created="Wed, 8 Jun 2011 17:36:09 +0000"/>
                            <attachment id="12481142" name="SOLR-2567.patch" size="5888" author="rcmuir" created="Wed, 1 Jun 2011 20:37:59 +0000"/>
                            <attachment id="12481056" name="SOLR-2567.patch" size="4977" author="rcmuir" created="Wed, 1 Jun 2011 10:08:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4975</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 21 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03jzb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18670</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>