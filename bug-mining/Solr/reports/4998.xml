<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:55:16 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16648] NullPointerException when using facets in More Like This Handler</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16648</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I have a MoreLikeThis query handler set up on my index:&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;&amp;lt;requestHandler name=&quot;/mlt&quot; class=&quot;solr.MoreLikeThisHandler&quot;&amp;gt;&lt;br/&gt;
&#160; &#160; &amp;lt;lst name=&quot;defaults&quot;&amp;gt;&lt;br/&gt;
&#160; &#160; &#160; &amp;lt;str name=&quot;echoParams&quot;&amp;gt;all&amp;lt;/str&amp;gt;&lt;br/&gt;
&#160; &#160; &#160; &amp;lt;int name=&quot;rows&quot;&amp;gt;10&amp;lt;/int&amp;gt;&lt;br/&gt;
&#160;&#160;&#160;&#160;&#160;&#160; &amp;lt;str name=&quot;mlt.fl&quot;&amp;gt;text&amp;lt;/str&amp;gt;&lt;br/&gt;
&#160; &#160; &amp;lt;/lst&amp;gt;&lt;br/&gt;
&#160; &amp;lt;/requestHandler&amp;gt;&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;If I use faceting on a query with no no tagging and exclusion everything works as expected. eg:&lt;br/&gt;
&#160;&lt;br/&gt;
/mlt?facet.field=genre&amp;amp;facet.mincount=1&amp;amp;facet=true&amp;amp;fq=genre:{GENRE_VALUE}&amp;amp;indent=true&amp;amp;q.op=OR&amp;amp;q=id:{DOCUMENT_ID}&lt;/p&gt;


&lt;p&gt;When I add tagging and exclusion the facet counts are not returned and I get a null pointer exception:&lt;br/&gt;
&#160;&lt;br/&gt;
/mlt?facet.field={!ex=g}genre&amp;amp;facet.mincount=1&amp;amp;facet=true&amp;amp;fq={!tag=g}genre:{GENRE_VALUE}&amp;amp;indent=true&amp;amp;q.op=OR&amp;amp;q=id:{DOCUMENT_ID}&lt;br/&gt;
&#160;&lt;br/&gt;
Here is the stack trace:&lt;/p&gt;
&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
at java.base/java.util.Objects.requireNonNull(Objects.java:208)&lt;br/&gt;
at com.github.benmanes.caffeine.cache.BoundedLocalCache.put(BoundedLocalCache.java:2196)&lt;br/&gt;
at com.github.benmanes.caffeine.cache.BoundedLocalCache.putIfAbsent(BoundedLocalCache.java:2182)&lt;br/&gt;
at com.github.benmanes.caffeine.cache.LocalAsyncCache$AsyncAsMapView.putIfAbsent(LocalAsyncCache.java:316)&lt;br/&gt;
at com.github.benmanes.caffeine.cache.LocalAsyncCache$AsyncAsMapView.putIfAbsent(LocalAsyncCache.java:291)&lt;br/&gt;
at org.apache.solr.search.CaffeineCache.computeAsync(CaffeineCache.java:209)&lt;br/&gt;
at org.apache.solr.search.CaffeineCache.computeIfAbsent(CaffeineCache.java:250)&lt;br/&gt;
at org.apache.solr.search.SolrIndexSearcher.getAndCacheDocSet(SolrIndexSearcher.java:970)&lt;br/&gt;
at org.apache.solr.search.SolrIndexSearcher.getPositiveDocSet(SolrIndexSearcher.java:927)&lt;br/&gt;
at org.apache.solr.search.SolrIndexSearcher.getProcessedFilter(SolrIndexSearcher.java:1192)&lt;br/&gt;
at org.apache.solr.search.SolrIndexSearcher.getDocSet(SolrIndexSearcher.java:1091)&lt;br/&gt;
at org.apache.solr.request.SimpleFacets.computeDocSet(SimpleFacets.java:258)&lt;br/&gt;
at org.apache.solr.request.SimpleFacets.parseParams(SimpleFacets.java:216)&lt;br/&gt;
at org.apache.solr.request.SimpleFacets.getFacetFieldCounts(SimpleFacets.java:898)&lt;br/&gt;
at org.apache.solr.handler.component.FacetComponent.getFacetCounts(FacetComponent.java:337)&lt;br/&gt;
at org.apache.solr.handler.component.FacetComponent.getFacetCounts(FacetComponent.java:299)&lt;br/&gt;
at org.apache.solr.handler.MoreLikeThisHandler.handleRequestBody(MoreLikeThisHandler.java:223)&lt;br/&gt;
at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:224)&lt;br/&gt;
at org.apache.solr.core.SolrCore.execute(SolrCore.java:2865)&lt;br/&gt;
at org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:887)&lt;br/&gt;
at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:606)&lt;br/&gt;
at org.apache.solr.servlet.SolrDispatchFilter.dispatch(SolrDispatchFilter.java:250)&lt;br/&gt;
at org.apache.solr.servlet.SolrDispatchFilter.lambda$doFilter$0(SolrDispatchFilter.java:218)&lt;br/&gt;
at org.apache.solr.servlet.ServletUtils.traceHttpRequestExecution2(ServletUtils.java:257)&lt;br/&gt;
at org.apache.solr.servlet.ServletUtils.rateLimitRequest(ServletUtils.java:227)&lt;br/&gt;
at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:213)&lt;br/&gt;
at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:195)&lt;br/&gt;
at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:201)&lt;br/&gt;
at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1626)&lt;br/&gt;
at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:552)&lt;br/&gt;
at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)&lt;br/&gt;
at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)&lt;br/&gt;
at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)&lt;br/&gt;
at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)&lt;br/&gt;
at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)&lt;br/&gt;
at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)&lt;br/&gt;
at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1440)&lt;br/&gt;
at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)&lt;br/&gt;
at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:505)&lt;br/&gt;
at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)&lt;br/&gt;
at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)&lt;br/&gt;
at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1355)&lt;br/&gt;
at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)&lt;br/&gt;
at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:191)&lt;br/&gt;
at org.eclipse.jetty.server.handler.InetAccessHandler.handle(InetAccessHandler.java:177)&lt;br/&gt;
at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146)&lt;br/&gt;
at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)&lt;br/&gt;
at org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:322)&lt;br/&gt;
at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:772)&lt;br/&gt;
at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)&lt;br/&gt;
at org.eclipse.jetty.server.Server.handle(Server.java:516)&lt;br/&gt;
at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:487)&lt;br/&gt;
at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:732)&lt;br/&gt;
at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:479)&lt;br/&gt;
at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)&lt;br/&gt;
at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)&lt;br/&gt;
at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)&lt;br/&gt;
at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)&lt;br/&gt;
at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)&lt;br/&gt;
at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)&lt;br/&gt;
at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)&lt;br/&gt;
at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)&lt;br/&gt;
at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)&lt;br/&gt;
at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)&lt;br/&gt;
at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)&lt;br/&gt;
at java.base/java.lang.Thread.run(Thread.java:833)&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13523290">SOLR-16648</key>
            <summary>NullPointerException when using facets in More Like This Handler</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mkhl">Mikhail Khludnev</assignee>
                                    <reporter username="gracesainsbury">Grace Sainsbury</reporter>
                        <labels>
                    </labels>
                <created>Mon, 6 Feb 2023 19:03:30 +0000</created>
                <updated>Mon, 27 Mar 2023 18:07:30 +0000</updated>
                            <resolved>Thu, 9 Feb 2023 07:00:43 +0000</resolved>
                                    <version>9.1.1</version>
                                    <fixVersion>9.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="17685725" author="jira-bot" created="Wed, 8 Feb 2023 07:22:50 +0000"  >&lt;p&gt;Commit 96f690cddf0765c96be2d56c12b53195ba8f556f in solr&apos;s branch refs/heads/main from Mikhail Khludnev&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=96f690cddf0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=96f690cddf0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16648&quot; title=&quot;NullPointerException when using facets in More Like This Handler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16648&quot;&gt;&lt;del&gt;SOLR-16648&lt;/del&gt;&lt;/a&gt;: NullPointerException when excluding facets in More Like This Handler (#1339)&lt;/p&gt;
</comment>
                            <comment id="17685742" author="jira-bot" created="Wed, 8 Feb 2023 07:55:19 +0000"  >&lt;p&gt;Commit 8531e8fab14a0a3b1dc878eb9819efd851a8dd7f in solr&apos;s branch refs/heads/branch_9x from Mikhail Khludnev&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=8531e8fab14&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=8531e8fab14&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16648&quot; title=&quot;NullPointerException when using facets in More Like This Handler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16648&quot;&gt;&lt;del&gt;SOLR-16648&lt;/del&gt;&lt;/a&gt;: NullPointerException when excluding facets in More Like This Handler (#1339) (#1310)&lt;/p&gt;
</comment>
                            <comment id="17691370" author="jira-bot" created="Tue, 21 Feb 2023 04:54:12 +0000"  >&lt;p&gt;Commit 8531e8fab14a0a3b1dc878eb9819efd851a8dd7f in solr&apos;s branch refs/heads/jira/&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16636&quot; title=&quot;ZkStateReader.waitForState should not register a watch if state already matches predicate&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16636&quot;&gt;&lt;del&gt;SOLR-16636&lt;/del&gt;&lt;/a&gt;_revert from Mikhail Khludnev&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=8531e8fab14&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=8531e8fab14&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16648&quot; title=&quot;NullPointerException when using facets in More Like This Handler&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16648&quot;&gt;&lt;del&gt;SOLR-16648&lt;/del&gt;&lt;/a&gt;: NullPointerException when excluding facets in More Like This Handler (#1339) (#1310)&lt;/p&gt;
</comment>
                            <comment id="17705515" author="houston" created="Mon, 27 Mar 2023 18:04:15 +0000"  >&lt;p&gt;Closing after the 9.2.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 33 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1fots:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>