<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:35:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3758] SpellCheckComponent doesn&apos;t work when using group.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3758</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;It seems like spellchecker using solr.DirectSolrSpellChecker doesn&apos;t work when grouping results.&lt;/p&gt;

&lt;p&gt;/select?q=mispeled&lt;br/&gt;
Gives me correct spellingsuggestions&lt;/p&gt;

&lt;p&gt;but..&lt;br/&gt;
/select?q=mispeled&amp;amp;group=true&amp;amp;group.main=true&amp;amp;group.field=title&lt;br/&gt;
don&apos;t give any suggestions.&lt;/p&gt;

&lt;p&gt;It worked in 3.5 with indexbased spellchecker.&lt;/p&gt;

&lt;p&gt;It seems like if i mispell something that returns 0 results i dont get any suggestions. If i misspell something that genereate a result i get suggestions on it.&lt;br/&gt;
It should come up with proper suggestions even if there are no results to be displayed (But there is things that should be suggested).&lt;br/&gt;
Long story short. Same functionality as in 3.5 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux Debian 6 / SolrCloud with 2 shards and 2 replicas.&lt;/p&gt;</environment>
        <key id="12604989">SOLR-3758</key>
            <summary>SpellCheckComponent doesn&apos;t work when using group.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="jdyer">James Dyer</assignee>
                                    <reporter username="mr.johnsson">Christian Johnsson</reporter>
                        <labels>
                            <label>DirectSolrSpellChecker</label>
                            <label>bug</label>
                            <label>spellchecker</label>
                            <label>suggestions</label>
                    </labels>
                <created>Sun, 26 Aug 2012 02:54:12 +0000</created>
                <updated>Fri, 10 May 2013 10:32:56 +0000</updated>
                            <resolved>Mon, 1 Apr 2013 20:27:43 +0000</resolved>
                                    <version>4.2</version>
                                    <fixVersion>4.3</fixVersion>
                                    <component>SolrCloud</component>
                    <component>spellchecker</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13611243" author="jdyer" created="Fri, 22 Mar 2013 21:02:42 +0000"  >&lt;p&gt;Use case from user list:&lt;/p&gt;

&lt;p&gt;From: alxsss@aim.com &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;mailto:alxsss@aim.com&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;alxsss@aim.com&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/mail_small.gif&quot; height=&quot;12&quot; width=&quot;13&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt; &lt;br/&gt;
Sent: Friday, March 22, 2013 12:53 PM&lt;br/&gt;
To: solr-user@lucene.apache.org&lt;br/&gt;
Subject: Re: strange behaviour of wordbreak spellchecker in solr cloud&lt;/p&gt;

&lt;p&gt;Hello,&lt;/p&gt;


&lt;p&gt;Further investigation shows the following pattern, for both DirectIndex and wordbreak spellchekers.&lt;/p&gt;

&lt;p&gt;Assume that in all cases there are spellchecker results when distrib=false&lt;/p&gt;

&lt;p&gt;In distributed mode (distrib=true)&lt;br/&gt;
  case when matches=0&lt;br/&gt;
    1. group=true,  no spellcheck results&lt;/p&gt;

&lt;p&gt;    2. group=false , there are spellcheck results&lt;/p&gt;

&lt;p&gt;  case when matches&amp;gt;0&lt;br/&gt;
    1. group=true, there are spellcheck results&lt;br/&gt;
    2. group =false, there are spellcheck results&lt;/p&gt;


&lt;p&gt;Do these constitute a failing test case?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;br/&gt;
Alex.&lt;/p&gt;





&lt;p&gt;----&lt;del&gt;Original Message&lt;/del&gt;----&lt;br/&gt;
From: alxsss &amp;lt;alxsss@aim.com&amp;gt;&lt;br/&gt;
To: solr-user &amp;lt;solr-user@lucene.apache.org&amp;gt;&lt;br/&gt;
Sent: Thu, Mar 21, 2013 6:50 pm&lt;br/&gt;
Subject: Re: strange behaviour of wordbreak spellchecker in solr cloud&lt;/p&gt;



&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I am debugging the SpellCheckComponent#finishStage. &lt;/p&gt;

&lt;p&gt;From the responses I see that not only wordbreak, but also directSpellchecker &lt;br/&gt;
does not return some results in distributed mode. &lt;br/&gt;
The request handler I was using had &lt;/p&gt;

&lt;p&gt;&amp;lt;str name=&quot;group&quot;&amp;gt;true&amp;lt;/str&amp;gt;&lt;/p&gt;


&lt;p&gt;So, I desided to turn of grouping and I see spellcheck results in distributed &lt;br/&gt;
mode.&lt;/p&gt;


&lt;p&gt;curl &apos;server1:8983/solr/test/testhandler?q=paulusoles&amp;amp;indent=true&amp;amp;rows=10&amp;amp;shards.qt=testhandler&apos;&lt;br/&gt;
has no spellchek results &lt;br/&gt;
but&lt;/p&gt;

&lt;p&gt;curl &apos;server1:8983/solr/test/testhandler?q=paulusoles&amp;amp;indent=true&amp;amp;rows=10&amp;amp;shards.qt=testhandler&lt;br/&gt;
&amp;amp;group=false&apos;&lt;br/&gt;
returns results.&lt;/p&gt;

&lt;p&gt;So, the conclusion is that grouping causes the distributed spellcheker to fail.&lt;/p&gt;

&lt;p&gt;Could please you point me to the class that may be responsible to this issue?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;br/&gt;
Alex.&lt;/p&gt;</comment>
                            <comment id="13614570" author="jdyer" created="Tue, 26 Mar 2013 21:40:29 +0000"  >&lt;p&gt;I did looked a little at this and it seems that when &quot;group=true&quot;, the first stage request doesn&apos;t reach all the shards.  For the case I was testing, with 2 shards, only 1 shard would get the request.  This would make the spellchecker work some of the time and fail others.  I haven&apos;t figured out for sure why this happens though.  Possibly the grouping logic short-circuits and doesn&apos;t bother requesting to shards that are known not to contain the groups that will be returned?&lt;/p&gt;</comment>
                            <comment id="13614599" author="alxksn" created="Tue, 26 Mar 2013 21:56:32 +0000"  >&lt;p&gt;Hi,&lt;/p&gt;

&lt;p&gt;Commenting out&lt;br/&gt;
 if (!params.getBool(COMPONENT_NAME, false) || spellCheckers.isEmpty()) &lt;/p&gt;
{
      return;
    }

&lt;p&gt;in SpellCheckComponent#process()&lt;/p&gt;

&lt;p&gt;solves the issue, because when group=true params.getBool(COMPONENT_NAME, false) is false.&lt;/p&gt;

&lt;p&gt;Which part constructs this params variable?&lt;/p&gt;

&lt;p&gt;Thanks.&lt;br/&gt;
Alex.&lt;/p&gt;


</comment>
                            <comment id="13615833" author="jdyer" created="Wed, 27 Mar 2013 22:12:56 +0000"  >&lt;p&gt;Here&apos;s a patch that changes SpellCheckComponent#modifyRequest to do its work when the request purpose is ShardRequest.PURPOSE_GET_TOP_GROUPS rather than ShardRequest.PURPOSE_GET_TOP_IDS when grouping is enabled.  On grouped requests, intra-shard requests with ShardRequest.PURPOSE_GET_TOP_IDS are only sent to shards that contain Top Groups, so SpellCheckComponent wouldn&apos;t have the opportunity to find all of its suggestions in a grouped scenario. &lt;/p&gt;

&lt;p&gt;There is also a change to DistributedSpellCheckComponentTest to randomly enable grouping for each test scenario.  However, we still get failures related to the &quot;correctlySpelled&quot; flag and with the use of &quot;alternativeTermCount&quot;.  So we still need to investigate why distributed vs non-dist return different results in these cases.&lt;/p&gt;

&lt;p&gt;This patch I think is complete enough for evaluation purposes.&lt;/p&gt;</comment>
                            <comment id="13617664" author="jdyer" created="Fri, 29 Mar 2013 19:54:30 +0000"  >&lt;p&gt;Here&apos;s an updated patch with all tests passing and nocommits removed.  I also reorganized DistributedSpellCheckComponentTest to make it more readable.&lt;/p&gt;

&lt;p&gt;I plan to commit this in a few days.&lt;/p&gt;</comment>
                            <comment id="13619120" author="jdyer" created="Mon, 1 Apr 2013 20:27:43 +0000"  >&lt;p&gt;trunk r1463219&lt;br/&gt;
branch 4x r1463220&lt;/p&gt;</comment>
                            <comment id="13653771" author="thetaphi" created="Fri, 10 May 2013 10:32:56 +0000"  >&lt;p&gt;Closed after release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12576147" name="SOLR-3758.patch" size="12037" author="jdyer" created="Fri, 29 Mar 2013 19:54:30 +0000"/>
                            <attachment id="12575779" name="SOLR-3758.patch" size="10445" author="jdyer" created="Wed, 27 Mar 2013 22:12:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>243229</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03csn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17506</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>