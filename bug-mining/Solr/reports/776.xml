<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:25:22 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3073] Distributed Grouping fails if the uniqueKey is a UUID</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3073</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Attempting to use distributed grouping (using a StrField as the group.fieldname) with a UUID as the uniqueKey results in an error because the classname (java.util.UUID) is prepended to the field value during the second phase of the grouping.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12540314">SOLR-3073</key>
            <summary>Distributed Grouping fails if the uniqueKey is a UUID</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="martijn.v.groningen">Martijn van Groningen</assignee>
                                    <reporter username="dkrisman">Devon Krisman</reporter>
                        <labels>
                    </labels>
                <created>Mon, 30 Jan 2012 00:47:39 +0000</created>
                <updated>Fri, 10 May 2013 10:40:50 +0000</updated>
                            <resolved>Tue, 20 Mar 2012 12:44:01 +0000</resolved>
                                    <version>3.5</version>
                    <version>4.0-ALPHA</version>
                                    <fixVersion>3.6</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13195898" author="dkrisman" created="Mon, 30 Jan 2012 00:51:37 +0000"  >&lt;p&gt;This is the error that happens when you try to run a distributed grouping search with a UUID as the uniqueKey:&lt;/p&gt;

&lt;p&gt;SEVERE: org.apache.solr.common.SolrException: Invalid UUID String: &apos;java.util.UUID:317db1e1-b778-ec66-ef68-ddd00b096632&apos;&lt;br/&gt;
        at org.apache.solr.schema.UUIDField.toInternal(UUIDField.java:85)&lt;br/&gt;
        at org.apache.solr.handler.component.QueryComponent.process(QueryComponent.java:217)&lt;br/&gt;
        at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:194)&lt;br/&gt;
        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)&lt;br/&gt;
        at org.apache.solr.core.SolrCore.execute(SolrCore.java:1372)&lt;br/&gt;
        at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:356)&lt;br/&gt;
        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:252)&lt;br/&gt;
        at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)&lt;br/&gt;
        at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)&lt;br/&gt;
        at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)&lt;br/&gt;
        at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)&lt;br/&gt;
        at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)&lt;br/&gt;
        at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)&lt;br/&gt;
        at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)&lt;br/&gt;
        at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)&lt;br/&gt;
        at org.mortbay.jetty.Server.handle(Server.java:326)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection$RequestHandler.content(HttpConnection.java:945)&lt;br/&gt;
        at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:756)&lt;br/&gt;
        at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:218)&lt;br/&gt;
        at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)&lt;br/&gt;
        at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)&lt;br/&gt;
        at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)&lt;/p&gt;

&lt;p&gt;The request handlers append the field Object&apos;s classname to its string value if it is from an unrecognized class, the attached patch should add java.util.UUID to the recognized classtypes for Solr&apos;s response handlers.&lt;/p&gt;</comment>
                            <comment id="13196094" author="martijn.v.groningen" created="Mon, 30 Jan 2012 12:51:30 +0000"  >&lt;p&gt;Thanks for noticing this issue! &lt;/p&gt;

&lt;p&gt;I&apos;m not sure if the response writers were ever meant to serialize UUID instances. So maybe this is a general response writing bug?&lt;/p&gt;

&lt;p&gt;I attached an alternative fix for this issue. Instead of invoking FieldType#toObject method it invokes FieldType#toExternal method in the TopGroupsResultTransformer class. I think this is a better approach for distributed grouping since there is no overhead of creating an UUID object (UUID#fromString). For distributed grouping we can just threat all ids as strings.&lt;/p&gt;</comment>
                            <comment id="13196159" author="yseeley@gmail.com" created="Mon, 30 Jan 2012 15:01:22 +0000"  >&lt;p&gt;I assume the results of TopGroupsResultTransformer is never exposed to the end user (i.e. the end user won&apos;t know that we use strings internally)?  If so, this fix seems easiest.  If not, then UUIDField itself should be fixed to not return a UUID from toObject.&lt;/p&gt;</comment>
                            <comment id="13196228" author="martijn.v.groningen" created="Mon, 30 Jan 2012 17:05:35 +0000"  >&lt;p&gt;The client reading the final response (end user) isn&apos;t aware of how ids are exposed between shards. &lt;/p&gt;

&lt;p&gt;A client might however use the internal api (group.distibuted.first / group.distibuted.second). I think since this is an internal api which isn&apos;t meant to be used by end users, the last patch can be committed.&lt;/p&gt;</comment>
                            <comment id="13196594" author="hossman" created="Tue, 31 Jan 2012 00:51:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;If not, then UUIDField itself should be fixed to not return a UUID from toObject.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Wouldn&apos;t that defeat the entire point of toObject? ... I thought the whole purpose was to give more robust response writers like JavaBin access to the best possible representation of hte values, even if they weren&apos;t &quot;simple&quot; (ie: strings, ints, etc...) so writers that can handle complex types can use complex types.&lt;/p&gt;

&lt;p&gt;if grouping just needs the string representation of hte unique key field then that&apos;s what toExternal is for.&lt;/p&gt;</comment>
                            <comment id="13196597" author="yseeley@gmail.com" created="Tue, 31 Jan 2012 00:56:33 +0000"  >&lt;blockquote&gt;&lt;p&gt;Wouldn&apos;t that defeat the entire point of toObject?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;There&apos;s been an implicit assumption that whatever toObject produces, it&apos;s generic enough that response writers can handle it.&lt;/p&gt;</comment>
                            <comment id="13196598" author="thetaphi" created="Tue, 31 Jan 2012 00:57:12 +0000"  >&lt;blockquote&gt;&lt;p&gt;if grouping just needs the string representation of hte unique key field then that&apos;s what toExternal is for.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree!&lt;/p&gt;</comment>
                            <comment id="13196599" author="thetaphi" created="Tue, 31 Jan 2012 00:58:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;There&apos;s been an implicit assumption that whatever toObject produces, it&apos;s generic enough that response writers can handle it.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;ResponseWriters can handle j.u.UUID? because they fallback to toString()?&lt;/p&gt;</comment>
                            <comment id="13196603" author="hossman" created="Tue, 31 Jan 2012 01:03:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;ResponseWriters can handle j.u.UUID? because they fallback to toString()?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;right ... i specifically remember asking when toObject was introduced if we should call it &quot;toSimpleObject&quot; and give it javadocs listing the allowed interfaces, and someone (ryan? noble?) said no, FieldTpes should be allowed to return any Object and it&apos;s up to the client to decide how to deal with objects they can&apos;t handle (ie: toString)&lt;/p&gt;

&lt;p&gt;Incase of UUIDField, the JavaBinCodec can serialize it and you get a java.util.UUID object on the other side.&lt;/p&gt;</comment>
                            <comment id="13196990" author="martijn.v.groningen" created="Tue, 31 Jan 2012 15:57:53 +0000"  >&lt;p&gt;I committed the patch that I attached to trunk and 3x branch.&lt;/p&gt;</comment>
                            <comment id="13233379" author="martijn.v.groningen" created="Tue, 20 Mar 2012 12:44:01 +0000"  >&lt;p&gt;Actual error is fixed, so this issue is resolved.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12512411" name="SOLR-3073-3x.patch" size="1470" author="martijn.v.groningen" created="Mon, 30 Jan 2012 12:51:30 +0000"/>
                            <attachment id="12512381" name="SOLR-3073-3x.patch" size="2002" author="dkrisman" created="Mon, 30 Jan 2012 00:48:55 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>225727</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 36 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03gun:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18163</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>