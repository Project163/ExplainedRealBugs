<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:02:03 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7059] Using paramset with multi-valued keys leads to a 500</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7059</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Here&apos;s my use case:&lt;br/&gt;
I wanted to use param-sets to have &lt;tt&gt;facet.field=field1&amp;amp;facet.field=field2&lt;/tt&gt;&lt;br/&gt;
For the same, here is what I updated:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;curl http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/bike/config/params -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Content-type:application/json&apos;&lt;/span&gt; -d 
&lt;/span&gt;&apos;{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;set&quot;&lt;/span&gt; : { 
    &lt;span class=&quot;code-quote&quot;&gt;&quot;facets&quot;&lt;/span&gt; : {
      &lt;span class=&quot;code-quote&quot;&gt;&quot;facet.field&quot;&lt;/span&gt;:[&lt;span class=&quot;code-quote&quot;&gt;&quot;start_station_name&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;end_station_name&quot;&lt;/span&gt;]
    }
  }
}&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When I tried to use the same, I got a 500.&lt;/p&gt;

&lt;p&gt;After looking at the code, seems like, RequestParams uses MapSolrParams, which banks on Map&amp;lt;String,String&amp;gt; map.&lt;/p&gt;

&lt;p&gt;This would need to change to support the multi-values.&lt;/p&gt;

&lt;p&gt;I also tried sending:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;solr-5.0.0-SNAPSHOT &amp;gt; curl http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/bike/config/params -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Content-type:application/json&apos;&lt;/span&gt; -d &lt;span class=&quot;code-quote&quot;&gt;&apos;{&lt;span class=&quot;code-quote&quot;&gt;&quot;update&quot;&lt;/span&gt; : { &lt;span class=&quot;code-quote&quot;&gt;&quot;facets&quot;&lt;/span&gt; : {&lt;span class=&quot;code-quote&quot;&gt;&quot;facet.field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;start_station_name&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;facet.field&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;end_station_name&quot;&lt;/span&gt;}}}&apos;&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This overwrote the value of facet.field with the last seen/parsed value i.e. there was only one value in the end. This is expected as that&apos;s noggit&apos;s behavior i.e.  doesn&apos;t complain and just overwrites the previous value with the same key.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12770914">SOLR-7059</key>
            <summary>Using paramset with multi-valued keys leads to a 500</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="noble.paul">Noble Paul</assignee>
                                    <reporter username="anshum">Anshum Gupta</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Jan 2015 05:27:39 +0000</created>
                <updated>Mon, 9 May 2016 18:57:53 +0000</updated>
                            <resolved>Thu, 29 Jan 2015 08:20:50 +0000</resolved>
                                    <version>5.0</version>
                                    <fixVersion>5.0</fixVersion>
                    <fixVersion>5.1</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14296440" author="anshumg" created="Thu, 29 Jan 2015 06:17:03 +0000"  >&lt;p&gt;If this doesn&apos;t really affect anything other than paramSets, which is a new feature, we should fix this (if we&apos;re able to, before 6640 is resolved).&lt;/p&gt;</comment>
                            <comment id="14296526" author="jira-bot" created="Thu, 29 Jan 2015 07:40:33 +0000"  >&lt;p&gt;Commit 1655541 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1655541&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1655541&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7059&quot; title=&quot;Using paramset with multi-valued keys leads to a 500&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7059&quot;&gt;&lt;del&gt;SOLR-7059&lt;/del&gt;&lt;/a&gt;: Using paramset with multi-valued keys leads to a 500. SolrParams need an aray instead of a list&lt;/p&gt;</comment>
                            <comment id="14296532" author="jira-bot" created="Thu, 29 Jan 2015 07:44:09 +0000"  >&lt;p&gt;Commit 1655542 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1655542&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1655542&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7059&quot; title=&quot;Using paramset with multi-valued keys leads to a 500&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7059&quot;&gt;&lt;del&gt;SOLR-7059&lt;/del&gt;&lt;/a&gt;: Using paramset with multi-valued keys leads to a 500. SolrParams need an aray instead of a list&lt;/p&gt;</comment>
                            <comment id="14296564" author="jira-bot" created="Thu, 29 Jan 2015 08:19:02 +0000"  >&lt;p&gt;Commit 1655547 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_5_0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1655547&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1655547&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7059&quot; title=&quot;Using paramset with multi-valued keys leads to a 500&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7059&quot;&gt;&lt;del&gt;SOLR-7059&lt;/del&gt;&lt;/a&gt;: Using paramset with multi-valued keys leads to a 500. SolrParams need an aray instead of a list&lt;/p&gt;</comment>
                            <comment id="14297777" author="yuanyun.cn" created="Thu, 29 Jan 2015 21:58:18 +0000"  >&lt;p&gt;The change works well, but it&apos;s kind of weird now:&lt;br/&gt;
the value type of map in MapSolrParams is declared as String, but now the value can actually be string or string[].&lt;br/&gt;
protected final Map&amp;lt;String,String&amp;gt; map;&lt;/p&gt;

&lt;p&gt;The following code would be kind of weird and difficult to maintain: &lt;br/&gt;
in get method: as the map is Map&amp;lt;String,String&amp;gt; , so map.get should return string - but not in this case, as the value can be string or string[]..&lt;br/&gt;
Object  o = map.get(name); /////&lt;br/&gt;
if (o instanceof String) return  (String) o;&lt;br/&gt;
if (o instanceof String[]) { }&lt;/p&gt;

&lt;p&gt;in toString: the val is declared as object - not as string(the entry is Entry&amp;lt;String,String&amp;gt;), because the value can be string or string[].&lt;br/&gt;
for (Map.Entry&amp;lt;String,String&amp;gt; entry : map.entrySet()) {&lt;br/&gt;
  String key = entry.getKey();&lt;br/&gt;
  Object val = entry.getValue(); ////&lt;br/&gt;
}&lt;/p&gt;

&lt;p&gt;This breaks java generic and compiler check, make it harder to maintain.&lt;br/&gt;
We should open one new JIRA to refactor MapSolrParams: Maybe change Map&amp;lt;String,String&amp;gt; to Map&amp;lt;String,String[]&amp;gt; just as ModifiableSolrParams.&lt;/p&gt;

&lt;p&gt;This will require a lot of code change: but it&apos;s worth.&lt;br/&gt;
Also in Lucene/Solr, we still use raw collectio - not parameterized, we should consider refactor it a bit to make the code cleaner.&lt;/p&gt;</comment>
                            <comment id="14299713" author="noble.paul" created="Sat, 31 Jan 2015 07:44:55 +0000"  >&lt;p&gt;I guess we should just make it a Map&amp;lt;String,Object&amp;gt; .&lt;/p&gt;</comment>
                            <comment id="14332620" author="anshumg" created="Mon, 23 Feb 2015 05:01:00 +0000"  >&lt;p&gt;Bulk close after 5.0 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24xs7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>