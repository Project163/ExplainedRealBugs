<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:48:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-15482] Cross-collection join when document is missing &apos;from&apos; field throws NPE</title>
                <link>https://issues.apache.org/jira/browse/SOLR-15482</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When using &lt;tt&gt;method=crossCollection&lt;/tt&gt; in a Join query, if a document does not have the field used for the &lt;tt&gt;from&lt;/tt&gt; param, a NullPointerException is thrown.&lt;/p&gt;

&lt;p&gt;This is pretty simple to reproduce using the techproducts sample data (following assumes a clean install):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ ./bin/solr start -e cloud -noprompt

$ ./bin/post -c gettingstarted example/exampledocs/*.xml

$ curl &lt;span class=&quot;code-quote&quot;&gt;&apos;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/gettingstarted/select&apos;&lt;/span&gt; -F &lt;span class=&quot;code-quote&quot;&gt;&apos;q={!join method=&lt;span class=&quot;code-quote&quot;&gt;&quot;crossCollection&quot;&lt;/span&gt; from=manu_id_s to=manu_id_s fromIndex=gettingstarted}*:*&apos;&lt;/span&gt;
&lt;/span&gt;
{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;responseHeader&quot;&lt;/span&gt;:{
    &lt;span class=&quot;code-quote&quot;&gt;&quot;zkConnected&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;status&quot;&lt;/span&gt;:500,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;QTime&quot;&lt;/span&gt;:335,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;params&quot;&lt;/span&gt;:{
      &lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;{!join method=\&quot;&lt;/span&gt;crossCollection\&lt;span class=&quot;code-quote&quot;&gt;&quot; from=manu_id_s to=manu_id_s fromIndex=gettingstarted}*:*&quot;&lt;/span&gt;}},
  &lt;span class=&quot;code-quote&quot;&gt;&quot;error&quot;&lt;/span&gt;:{
    &lt;span class=&quot;code-quote&quot;&gt;&quot;metadata&quot;&lt;/span&gt;:[
      &lt;span class=&quot;code-quote&quot;&gt;&quot;error-class&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.solr.client.solrj.impl.BaseHttpSolrClient$RemoteSolrException&quot;&lt;/span&gt;,
      &lt;span class=&quot;code-quote&quot;&gt;&quot;root-error-class&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.solr.client.solrj.impl.BaseHttpSolrClient$RemoteSolrException&quot;&lt;/span&gt;],
    &lt;span class=&quot;code-quote&quot;&gt;&quot;msg&quot;&lt;/span&gt;:&quot;Error from server at &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;: java.lang.NullPointerException\n\tat org.apache.solr.schema.FieldType.readableToIndexed(FieldType.java:419)...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Depending on which shard the error comes from, you might see a &quot;No live SolrServers available to handle this request&quot; error, but digging into the logs for the other shard that served the query will show the same NPE in the example above (I&apos;ll put a full stack trace into a comment).&lt;/p&gt;

&lt;p&gt;&quot;Regular&quot; (non-cross-collection) joins work fine if some documents are missing the field.&lt;/p&gt;

&lt;p&gt;If we shouldn&apos;t expect XCJF to work when documents are missing the &lt;tt&gt;from&lt;/tt&gt; field, then we should document that as a limitation and also throw a more descriptive error.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13384157">SOLR-15482</key>
            <summary>Cross-collection join when document is missing &apos;from&apos; field throws NPE</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="ctargett">Cassandra Targett</reporter>
                        <labels>
                    </labels>
                <created>Wed, 16 Jun 2021 12:42:51 +0000</created>
                <updated>Tue, 28 Sep 2021 20:22:31 +0000</updated>
                            <resolved>Wed, 28 Jul 2021 22:36:08 +0000</resolved>
                                                    <fixVersion>9.0</fixVersion>
                    <fixVersion>8.10</fixVersion>
                                    <component>query parsers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="17364290" author="ctargett" created="Wed, 16 Jun 2021 12:45:35 +0000"  >&lt;p&gt;Full stack trace with the request:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2021-06-16 12:21:19.319 INFO  (qtp264978436-31) [c:gettingstarted s:shard1 r:core_node3 x:gettingstarted_shard1_replica_n1] o.a.s.c.S.Request [gettingstarted_shard1_replica_n1]  webapp=/solr path=/select params={df=_text_&amp;amp;distrib=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;amp;fl=id&amp;amp;fl=score&amp;amp;shards.purpose=16388&amp;amp;start=0&amp;amp;fsv=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;shard.url=http:&lt;span class=&quot;code-comment&quot;&gt;//192.168.1.35:8983/solr/gettingstarted_shard1_replica_n2/|http://192.168.1.35:7574/solr/gettingstarted_shard1_replica_n1/&amp;amp;rows=10&amp;amp;rid=-0&amp;amp;version=2&amp;amp;q={!join+method%3D&lt;span class=&quot;code-quote&quot;&gt;&quot;crossCollection&quot;&lt;/span&gt;+from%3Dmanu_id_s+to%3Dmanu_id_s+fromIndex%3Dgettingstarted}*:*&amp;amp;omitHeader=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;amp;NOW=1623846079063&amp;amp;isShard=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;wt=javabin} status=500 QTime=116
&lt;/span&gt;
2021-06-16 12:21:19.320 ERROR (qtp264978436-30) [c:gettingstarted s:shard2 r:core_node7 x:gettingstarted_shard2_replica_n4] o.a.s.s.HttpSolrCall java.lang.NullPointerException
	at org.apache.solr.schema.FieldType.readableToIndexed(FieldType.java:419)
	at org.apache.solr.search.join.CrossCollectionJoinQuery$TermsJoinKeyCollector.collect(CrossCollectionJoinQuery.java:133)
	at org.apache.solr.search.join.CrossCollectionJoinQuery$CrossCollectionJoinQueryWeight.getDocSet(CrossCollectionJoinQuery.java:297)
	at org.apache.solr.search.join.CrossCollectionJoinQuery$CrossCollectionJoinQueryWeight.scorer(CrossCollectionJoinQuery.java:311)
	at org.apache.lucene.search.Weight.bulkScorer(Weight.java:182)
	at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:658)
	at org.apache.lucene.search.IndexSearcher.search(IndexSearcher.java:445)
	at org.apache.solr.search.SolrIndexSearcher.buildAndRunCollectorChain(SolrIndexSearcher.java:211)
	at org.apache.solr.search.SolrIndexSearcher.getDocListNC(SolrIndexSearcher.java:1596)
	at org.apache.solr.search.SolrIndexSearcher.getDocListC(SolrIndexSearcher.java:1413)
	at org.apache.solr.search.SolrIndexSearcher.search(SolrIndexSearcher.java:596)
	at org.apache.solr.handler.component.QueryComponent.doProcessUngroupedSearch(QueryComponent.java:1508)
	at org.apache.solr.handler.component.QueryComponent.process(QueryComponent.java:398)
	at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:355)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:216)
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:2646)
	at org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:794)
	at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:567)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:427)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:357)
	at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:201)
	at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1601)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:548)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:602)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1612)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1434)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:501)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1582)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1349)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:191)
	at org.eclipse.jetty.server.handler.InetAccessHandler.handle(InetAccessHandler.java:177)
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:322)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:516)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:383)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:556)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:375)
	at org.eclipse.jetty.server.HttpChannel.run(HttpChannel.java:335)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:336)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:313)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:171)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:129)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:375)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:773)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:905)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17389856" author="ctargett" created="Thu, 29 Jul 2021 12:11:40 +0000"  >&lt;p&gt;The commits to fix this were accidentally misattributed to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15531&quot; title=&quot;IllegalArgumentException while executing streaming expression with significantTerms on an empty collection &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15531&quot;&gt;&lt;del&gt;SOLR-15531&lt;/del&gt;&lt;/a&gt; in the commit messages. They are:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Commit e7e80b1c5f6e900c11ca694e2cdc60667b788a06 in solr&apos;s branch refs/heads/main from Chris M. Hostetter
[ https://gitbox.apache.org/repos/asf?p=solr.git;h=e7e80b1 ]

SOLR-15531: Cross-collection join fixed to ignore documents that do not contain value in from field
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Commit 1e6e2ddc4212f0163567ede023d696338e6b2813 in lucene-solr&apos;s branch refs/heads/branch_8x from Chris M. Hostetter
[ https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=1e6e2dd ]

SOLR-15531: Cross-collection join fixed to ignore documents that do not contain value in from field

(cherry picked from commit e7e80b1c5f6e900c11ca694e2cdc60667b788a06)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17389988" author="jira-bot" created="Thu, 29 Jul 2021 15:51:04 +0000"  >&lt;p&gt;Commit 1925693127e81cf0125bcb55f1b05591dea8b203 in solr&apos;s branch refs/heads/main from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=1925693&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=1925693&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15482&quot; title=&quot;Cross-collection join when document is missing &amp;#39;from&amp;#39; field throws NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15482&quot;&gt;&lt;del&gt;SOLR-15482&lt;/del&gt;&lt;/a&gt;: correct CHANGES.txt entry erroneously refering to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15531&quot; title=&quot;IllegalArgumentException while executing streaming expression with significantTerms on an empty collection &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15531&quot;&gt;&lt;del&gt;SOLR-15531&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17389991" author="jira-bot" created="Thu, 29 Jul 2021 15:52:33 +0000"  >&lt;p&gt;Commit 7305a0deca941d539b71c417a9d82b8a08b32227 in lucene-solr&apos;s branch refs/heads/branch_8x from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7305a0d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7305a0d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15482&quot; title=&quot;Cross-collection join when document is missing &amp;#39;from&amp;#39; field throws NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15482&quot;&gt;&lt;del&gt;SOLR-15482&lt;/del&gt;&lt;/a&gt;: correct CHANGES.txt entry erroneously refering to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15531&quot; title=&quot;IllegalArgumentException while executing streaming expression with significantTerms on an empty collection &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15531&quot;&gt;&lt;del&gt;SOLR-15531&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 1925693127e81cf0125bcb55f1b05591dea8b203)&lt;/p&gt;</comment>
                            <comment id="17389994" author="hossman" created="Thu, 29 Jul 2021 15:53:17 +0000"  >&lt;p&gt;Sorry folks, Not sure how i screwed that up.&lt;/p&gt;</comment>
                            <comment id="17421707" author="thelabdude" created="Tue, 28 Sep 2021 20:22:31 +0000"  >&lt;p&gt;Closing after the 8.10.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13031000" name="SOLR-15482.patch" size="2739" author="hossman" created="Fri, 23 Jul 2021 21:04:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 7 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0s0bs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>