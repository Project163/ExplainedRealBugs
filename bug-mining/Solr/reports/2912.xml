<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:12:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-8875] ZkStateWriter.writePendingUpdates() can return null clusterState; NPE in Overseer</title>
                <link>https://issues.apache.org/jira/browse/SOLR-8875</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;While trying to get the test in Varun&apos;s patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5750&quot; title=&quot;Backup/Restore API for SolrCloud&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5750&quot;&gt;&lt;del&gt;SOLR-5750&lt;/del&gt;&lt;/a&gt; (SolrCloud collection backup &amp;amp; restore) to succeed, I kept hitting an NPE in Overseer in which clusterState was null.  I added a bunch of asserts and found where it was happening which I worked around temporarily.  See &lt;a href=&quot;https://github.com/apache/lucene-solr/commit/fd9c4d59e8dbe0e9fbd99a40ed2ff746c1ae7a0c#diff-9ed614eee66b9e685d73446b775dc043R247&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/commit/fd9c4d59e8dbe0e9fbd99a40ed2ff746c1ae7a0c#diff-9ed614eee66b9e685d73446b775dc043R247&lt;/a&gt; which is ZkStateWriter.writePendingUpdates() returning null, overwriting the current non-null clusterState.  This happens nearly every time for me when I run that test.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12951668">SOLR-8875</key>
            <summary>ZkStateWriter.writePendingUpdates() can return null clusterState; NPE in Overseer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dsmiley">David Smiley</assignee>
                                    <reporter username="dsmiley">David Smiley</reporter>
                        <labels>
                    </labels>
                <created>Sat, 19 Mar 2016 01:57:06 +0000</created>
                <updated>Wed, 2 Oct 2019 17:24:51 +0000</updated>
                            <resolved>Fri, 17 Jun 2016 20:13:43 +0000</resolved>
                                                    <fixVersion>5.5.2</fixVersion>
                    <fixVersion>5.6</fixVersion>
                    <fixVersion>6.0.1</fixVersion>
                    <fixVersion>6.1</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15202501" author="dsmiley" created="Sat, 19 Mar 2016 01:58:20 +0000"  >&lt;p&gt;As an aside, I think this Overseer code would be clearer to me if the &lt;tt&gt;refreshClusterState&lt;/tt&gt; boolean went away and we simply checked for &lt;tt&gt;clusterState == null&lt;/tt&gt;  (less variables and more clarity of purpose of what the &lt;tt&gt;if (refreshClusterState)&lt;/tt&gt; is to resolve &amp;#8211; it&apos;s to get a new cluster state because it has none.  In IRC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt; agreed with me.&lt;/p&gt;</comment>
                            <comment id="15215116" author="dragonsinth" created="Mon, 28 Mar 2016 23:57:44 +0000"  >&lt;p&gt;Hi David,&lt;/p&gt;

&lt;p&gt;Can you give me a little more detail on how to repro?&lt;/p&gt;

&lt;p&gt;I checked out fd9c4d59e8dbe0e9fbd99a40ed2ff746c1ae7a0c then ran TestCloudBackupRestore with -ea, and it passed for me.  Do I need to run it a bunch of times to see the problem?&lt;/p&gt;</comment>
                            <comment id="15215165" author="dsmiley" created="Tue, 29 Mar 2016 00:42:42 +0000"  >&lt;p&gt;Thanks for investigating Scott.  You need to comment out the modifications I did in Overseer that avoid overwriting the cluster state with null.  The rest of Overseer changes outside this method should remain.&lt;/p&gt;</comment>
                            <comment id="15215414" author="dragonsinth" created="Tue, 29 Mar 2016 04:41:22 +0000"  >&lt;p&gt;Can you send me a SHA that captures the state to repro?&lt;/p&gt;</comment>
                            <comment id="15216188" author="dsmiley" created="Tue, 29 Mar 2016 15:37:00 +0000"  >&lt;p&gt;I just pushed a branch by the name of this issue.  It has one edit from &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5750&quot; title=&quot;Backup/Restore API for SolrCloud&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5750&quot;&gt;&lt;del&gt;SOLR-5750&lt;/del&gt;&lt;/a&gt;&apos;s branch, which is to cause an assertion failure instead of just logging an error.  Simply run TestCloudBackupRestore.&lt;/p&gt;</comment>
                            <comment id="15216253" author="dragonsinth" created="Tue, 29 Mar 2016 16:11:41 +0000"  >&lt;p&gt;Perfect! Thank you&lt;/p&gt;</comment>
                            <comment id="15216927" author="dragonsinth" created="Tue, 29 Mar 2016 22:02:16 +0000"  >&lt;p&gt;I think this may be a one-liner; in the calling loop, I think there are cases where you can get all the way to the bottom without having actually written any updates, which fails to ever initialize ZkStateWriter.clusterState().&lt;/p&gt;

&lt;p&gt;To be honest, I&apos;m not a fan of both the Overseer loop and ZkStateWriter both trying to keep a source-of-truth clusterState variable, it&apos;s a recipe for getting out of sync.&lt;/p&gt;</comment>
                            <comment id="15219229" author="dsmiley" created="Thu, 31 Mar 2016 02:35:20 +0000"  >&lt;p&gt;This code is new to me but what you say resonates with me.  I also got the sense these two things were trying to keep track of the clusterState, and that seems redundant.  When I get back to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5750&quot; title=&quot;Backup/Restore API for SolrCloud&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5750&quot;&gt;&lt;del&gt;SOLR-5750&lt;/del&gt;&lt;/a&gt; in the next few days I&apos;ll apply this and see if it goes away.  If so I&apos;ll commit it.  It&apos;ll be good to have Jenkins beating on it for awhile.&lt;/p&gt;</comment>
                            <comment id="15226837" author="jira-bot" created="Tue, 5 Apr 2016 18:20:14 +0000"  >&lt;p&gt;Commit 4cfd33f7434509d535fa8d5faaf3d20ced1935ce in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4cfd33f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=4cfd33f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8875&quot; title=&quot;ZkStateWriter.writePendingUpdates() can return null clusterState; NPE in Overseer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8875&quot;&gt;&lt;del&gt;SOLR-8875&lt;/del&gt;&lt;/a&gt;: Fix null clusterState from ZkStateWriter. Revert my sanity check asserts in Overseer.&lt;br/&gt;
(cherry picked from commit 3bbf8aa)&lt;/p&gt;</comment>
                            <comment id="15226838" author="jira-bot" created="Tue, 5 Apr 2016 18:20:15 +0000"  >&lt;p&gt;Commit 3bbf8aaa8a9f57c43d64e9c361184c379d90b9c9 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=3bbf8aa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=3bbf8aa&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8875&quot; title=&quot;ZkStateWriter.writePendingUpdates() can return null clusterState; NPE in Overseer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8875&quot;&gt;&lt;del&gt;SOLR-8875&lt;/del&gt;&lt;/a&gt;: Fix null clusterState from ZkStateWriter. Revert my sanity check asserts in Overseer.&lt;/p&gt;</comment>
                            <comment id="15226877" author="dsmiley" created="Tue, 5 Apr 2016 18:37:47 +0000"  >&lt;p&gt;Thanks Scott!&lt;/p&gt;</comment>
                            <comment id="15293264" author="steve_rowe" created="Fri, 20 May 2016 12:31:19 +0000"  >&lt;p&gt;Reopening to backport to 6.0.1.&lt;/p&gt;</comment>
                            <comment id="15293265" author="jira-bot" created="Fri, 20 May 2016 12:31:57 +0000"  >&lt;p&gt;Commit a2732fd6f0899097defced1b8ee86dbc0099ac8d in lucene-solr&apos;s branch refs/heads/branch_6_0 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=a2732fd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=a2732fd&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8875&quot; title=&quot;ZkStateWriter.writePendingUpdates() can return null clusterState; NPE in Overseer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8875&quot;&gt;&lt;del&gt;SOLR-8875&lt;/del&gt;&lt;/a&gt;: Fix null clusterState from ZkStateWriter. Revert my sanity check asserts in Overseer.&lt;br/&gt;
(cherry picked from commit 3bbf8aa)&lt;/p&gt;</comment>
                            <comment id="15305395" author="steve_rowe" created="Sat, 28 May 2016 13:38:33 +0000"  >&lt;p&gt;Bulk close issues included in the 6.0.1 release.&lt;/p&gt;</comment>
                            <comment id="15336829" author="steve_rowe" created="Fri, 17 Jun 2016 20:09:20 +0000"  >&lt;p&gt;Reopening to backport to 5.6 and 5.5.2.&lt;/p&gt;</comment>
                            <comment id="15336840" author="jira-bot" created="Fri, 17 Jun 2016 20:13:32 +0000"  >&lt;p&gt;Commit 83bd4fc00272b5171613e44adaf523587e752f1a in lucene-solr&apos;s branch refs/heads/branch_5_5 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=83bd4fc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=83bd4fc&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8875&quot; title=&quot;ZkStateWriter.writePendingUpdates() can return null clusterState; NPE in Overseer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8875&quot;&gt;&lt;del&gt;SOLR-8875&lt;/del&gt;&lt;/a&gt;: Fix null clusterState from ZkStateWriter. Revert my sanity check asserts in Overseer.&lt;br/&gt;
(cherry picked from commit 3bbf8aa)&lt;/p&gt;</comment>
                            <comment id="15336841" author="jira-bot" created="Fri, 17 Jun 2016 20:13:34 +0000"  >&lt;p&gt;Commit 5d5719877683934b7699369fa5468d56910840f4 in lucene-solr&apos;s branch refs/heads/branch_5x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5d57198&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5d57198&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8875&quot; title=&quot;ZkStateWriter.writePendingUpdates() can return null clusterState; NPE in Overseer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8875&quot;&gt;&lt;del&gt;SOLR-8875&lt;/del&gt;&lt;/a&gt;: Fix null clusterState from ZkStateWriter. Revert my sanity check asserts in Overseer.&lt;br/&gt;
(cherry picked from commit 3bbf8aa)&lt;/p&gt;</comment>
                            <comment id="15349790" author="steve_rowe" created="Sat, 25 Jun 2016 20:33:48 +0000"  >&lt;p&gt;Bulk close issues released with 5.5.2.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12959341">SOLR-9001</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310040">
                    <name>Required</name>
                                                                <inwardlinks description="is required by">
                                        <issuelink>
            <issuekey id="12696001">SOLR-5750</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12795940" name="SOLR-8875.patch" size="513" author="dragonsinth" created="Tue, 29 Mar 2016 22:02:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 21 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2uwnz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>