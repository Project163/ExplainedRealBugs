<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:10:59 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-17418] ConfigSets created during a backup Restore command are trusted implicitly</title>
                <link>https://issues.apache.org/jira/browse/SOLR-17418</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;ConfigSets that are created via a Restore command, which basically copy a configSet from the backup and give it a new name, are created without setting the &quot;trusted&quot; metadata. And configSets that do not contain the flag are trusted implicitly if the metadata is missing.&lt;/p&gt;

&lt;p&gt;This can lead to an RCE if a user constructs their configSet cleverly.&lt;/p&gt;

&lt;p&gt;This is the copied from liuhuajin&apos;s security report reproducing instructions:&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The following four API need to be known for this vulnerability:&lt;/p&gt;

&lt;p&gt;1.Upload API :&#160;&lt;a href=&quot;http://127.0.0.1:8983/solr/admin/configs?action=UPLOAD&amp;amp;name=conf1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://127.0.0.1:8983/solr/admin/configs?action=UPLOAD&amp;amp;name=conf1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;2.Create Collection API&#160;&lt;a href=&quot;http://127.0.0.1:8983/solr/admin/collections?action=CREATE&amp;amp;name=conf4&amp;amp;numShards=1&amp;amp;replicationFactor=1&amp;amp;wt=json&amp;amp;collection.configName=conf4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://127.0.0.1:8983/solr/admin/collections?action=CREATE&amp;amp;name=conf4&amp;amp;numShards=1&amp;amp;replicationFactor=1&amp;amp;wt=json&amp;amp;collection.configName=conf4&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;3.BACKUP API:&#160;&lt;a href=&quot;http://127.0.0.1:8983/solr/admin/collections?action=BACKUP&amp;amp;collection=conf4&amp;amp;location=solrhome&amp;amp;name=conf4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://127.0.0.1:8983/solr/admin/collections?action=BACKUP&amp;amp;collection=conf4&amp;amp;location=solrhome&amp;amp;name=conf4&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;4.RESTORE Backup API:&#160;&lt;a href=&quot;http://127.0.0.1:8983/solr/admin/collections?action=RESTORE&amp;amp;collection=fy3&amp;amp;location=solrhome%5Cserver%5Csolr%5Cconf4%5Cconf4%5Czk_backup_0%5Cconfigs&amp;amp;name&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://127.0.0.1:8983/solr/admin/collections?action=RESTORE&amp;amp;collection=fy3&amp;amp;location=solrhome\server\solr\conf4\conf4\zk_backup_0\configs&amp;amp;name&lt;/a&gt;= conf4&amp;amp;collection.configName=noExist&lt;br/&gt;
Step one:&lt;/p&gt;

&lt;p&gt;I uploaded the malicious zip via the first API. The malicious zip contains a normal configuration set and backed up data.&lt;/p&gt;

&lt;p&gt;The key files are as follows:&lt;/p&gt;

&lt;p&gt;/solrconfig.xml --(Normal solrconfig.xml)&lt;/p&gt;

&lt;p&gt;/conf4/zk_backup_0/configs/conf4/solrconfig.xml (malicious solrconfig.xml)&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="13589649">SOLR-17418</key>
            <summary>ConfigSets created during a backup Restore command are trusted implicitly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="houston">Houston Putman</assignee>
                                    <reporter username="houston">Houston Putman</reporter>
                        <labels>
                    </labels>
                <created>Wed, 21 Aug 2024 19:53:30 +0000</created>
                <updated>Mon, 21 Oct 2024 21:00:59 +0000</updated>
                            <resolved>Tue, 27 Aug 2024 20:05:57 +0000</resolved>
                                                    <fixVersion>8.11.3</fixVersion>
                    <fixVersion>9.7</fixVersion>
                                    <component>Backup/Restore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17875664" author="houston" created="Wed, 21 Aug 2024 21:21:12 +0000"  >&lt;p&gt;I&apos;ve added a patch that tries to streamline some of the config uploading logic.&lt;/p&gt;

&lt;p&gt;I think it would be good if all configUpload internal APIs requires a &quot;isTrusted&quot; boolean, which defaults to &quot;false&quot;, but that can be done in Solr 10, since it will likely break the default and bootstrapped configs.&lt;/p&gt;</comment>
                            <comment id="17876843" author="houston" created="Mon, 26 Aug 2024 21:33:19 +0000"  >&lt;p&gt;I&apos;ve pared down the changes to only include the necessary parts, the rest of the code streamlining can be done separately.&lt;/p&gt;</comment>
                            <comment id="17876926" author="anshumg" created="Tue, 27 Aug 2024 06:46:36 +0000"  >&lt;p&gt;Thanks for taking care of this &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=houston&quot; class=&quot;user-hover&quot; rel=&quot;houston&quot;&gt;houston&lt;/a&gt;. This looks good to me.&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;Also, I&apos;m +1 on your suggestions about a &lt;em&gt;isTrusted&lt;/em&gt; boolean flag in Solr 10.&lt;/p&gt;</comment>
                            <comment id="17877162" author="houston" created="Tue, 27 Aug 2024 20:05:48 +0000"  >&lt;p&gt;Backported to lucene-solr/branch_8_11&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13071082" name="SOLR-17418-1.patch" size="59302" author="houston" created="Fri, 23 Aug 2024 23:45:05 +0000"/>
                            <attachment id="13071099" name="SOLR-17418-2.patch" size="42971" author="houston" created="Mon, 26 Aug 2024 21:32:15 +0000"/>
                            <attachment id="13071100" name="SOLR-17418-3.patch" size="42173" author="houston" created="Mon, 26 Aug 2024 21:37:43 +0000"/>
                            <attachment id="13071029" name="SOLR-17418.patch" size="27700" author="houston" created="Wed, 21 Aug 2024 21:20:15 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 11 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1qzyg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>