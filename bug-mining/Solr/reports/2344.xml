<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:02:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-6311] SearchHandler should use path when no qt or shard.qt parameter is specified</title>
                <link>https://issues.apache.org/jira/browse/SOLR-6311</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When performing distributed searches, you have to specify shards.qt unless you&apos;re on the default /select path for your handler. As this is configurable, even the default search handler could be on another path. The shard requests should thus default to the path if no shards.qt was specified.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12731371">SOLR-6311</key>
            <summary>SearchHandler should use path when no qt or shard.qt parameter is specified</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thelabdude">Timothy Potter</assignee>
                                    <reporter username="smolloy">Steve Molloy</reporter>
                        <labels>
                    </labels>
                <created>Fri, 1 Aug 2014 18:04:22 +0000</created>
                <updated>Mon, 9 May 2016 18:46:12 +0000</updated>
                            <resolved>Fri, 13 Feb 2015 22:36:38 +0000</resolved>
                                    <version>4.9</version>
                                    <fixVersion>5.1</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14082643" author="smolloy" created="Fri, 1 Aug 2014 18:07:53 +0000"  >&lt;p&gt;This patch will use shards.qt if specified, default to qt if not, then default to path if both were omitted.&lt;/p&gt;</comment>
                            <comment id="14085234" author="dsmiley" created="Mon, 4 Aug 2014 20:26:42 +0000"  >&lt;p&gt;Strong +1 from me; I have no idea why it wasn&apos;t this way from the beginning.&lt;/p&gt;</comment>
                            <comment id="14085258" author="yseeley@gmail.com" created="Mon, 4 Aug 2014 20:39:33 +0000"  >&lt;blockquote&gt;&lt;p&gt;When performing distributed searches, you have to specify shards.qt unless you&apos;re on the default /select path for your handler.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This was by design, and we should consider very carefully before changing it.&lt;br/&gt;
Most of the time, other handlers were used to add default parameters.  When this is the case, it&apos;s preferable to hit a bare /select handler for sub-requests as hitting the same handler again and adding defaults again will have a lot of side effects and sometimes produce incorrect distributed results.  The worst is when a handler specifies shards or something, and this causes an endless loop.&lt;/p&gt;</comment>
                            <comment id="14085293" author="dsmiley" created="Mon, 4 Aug 2014 21:13:29 +0000"  >&lt;p&gt;Good point Yonik; I forgot about that.  It&apos;s not this simple then.  In general, the need to specify shards.qt is to ensure one&apos;s customized components (e.g. spellcheck) are registered; it&apos;s not for request parameters.  Perhaps the solution is to have a shard request ignore parameters specified in the request handler?&lt;/p&gt;</comment>
                            <comment id="14086237" author="smolloy" created="Tue, 5 Aug 2014 13:08:32 +0000"  >&lt;p&gt;Thanks Yonik, hadn&apos;t thought of that. I&apos;ll think about alternatives for this as. Our main usage of different handlers is for using different sets of components (the suggester in its own handler for autocomplete being an example), in which case it seems wrong to force the request to contain shards.qt for distributed searches when we&apos;re trying to hide the fact that it&apos;s distributed by using collections.&lt;/p&gt;</comment>
                            <comment id="14089286" author="smolloy" created="Thu, 7 Aug 2014 14:47:20 +0000"  >&lt;p&gt;Haven&apos;t had much time to look into alternate solution yet, but for the point of default parameters. What is then the impact of having default parameters on /select handler itself? Is there some limitations on parameters that should be set as defaults in /select handler? Even example config comes with defaults and suggests that more can be added.&lt;/p&gt;</comment>
                            <comment id="14314389" author="thelabdude" created="Tue, 10 Feb 2015 16:09:43 +0000"  >&lt;p&gt;Same issue I stumbled upon trying to fix &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4479&quot; title=&quot;TermVectorComponent NPE when running Solr Cloud&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4479&quot;&gt;&lt;del&gt;SOLR-4479&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Most of the time, other handlers were used to add default parameters.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;True, but sometimes they also add search components so silently routing shard requests to &lt;tt&gt;/select&lt;/tt&gt; is just plain wrong.&lt;/p&gt;

&lt;p&gt;Seems like maybe the the hook to determine if the path should be applied as the default for &lt;tt&gt;shards.qt&lt;/tt&gt; is whether there are custom components defined on that instance of SearchHandler? Seems a little nuanced but better for new users than the current experience.&lt;/p&gt;</comment>
                            <comment id="14314547" author="hossman" created="Tue, 10 Feb 2015 18:06:52 +0000"  >&lt;p&gt;doesn&apos;t the initParam stuff noble added improve the situation with vanity handler paths that have defaults? and doesn&apos;t it play nice with distibuted requests? (so that it only adds the defaults on the initial request, not the per-shard requests &amp;#8211; if not it should)&lt;/p&gt;

&lt;p&gt;i think we should just bite the bullet on making the switch...&lt;/p&gt;

&lt;p&gt;straw man:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;make behavior conditional on LUCENE_MATCH_VERSION
	&lt;ul&gt;
		&lt;li&gt;if &amp;lt; X, shards.qt defaults to /select&lt;/li&gt;
		&lt;li&gt;if &amp;gt; X, shards.qt defaults to current handler&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;users who want to upgrade LUCENE_MATCH_VERSION but still get legacy behavior for vanity handler defaults should make hte burden of adding shards.qt=/select to the &quot;invariants&quot; for each of their vanity handlers&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14314656" author="noble.paul" created="Tue, 10 Feb 2015 18:52:45 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman&quot; class=&quot;user-hover&quot; rel=&quot;hossman&quot;&gt;hossman&lt;/a&gt; &lt;br/&gt;
With InitParams , the behavior is exacly similar as if we have specified the the config in the requestHandler itself&lt;/p&gt;

&lt;p&gt;But, as you said, I expect users to configure a lot more paths with the useParams feature with each mapping to a SearchHandler itself but a different set of params and a nice descriptive name. Coupled with the fact that you can change the params themselves pretty easily it will be more common. So you may see paths like &lt;tt&gt;/bestproducts-by-rating&lt;/tt&gt; &lt;tt&gt;/best-products-by-sale&lt;/tt&gt; etc. &lt;/p&gt;

&lt;p&gt;So it should not really hurt moving to shards.qt=qt&lt;/p&gt;

</comment>
                            <comment id="14316242" author="dsmiley" created="Wed, 11 Feb 2015 14:19:50 +0000"  >&lt;blockquote&gt;&lt;p&gt;i think we should just bite the bullet on making the switch...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1 to that!  It should have been done this way to begin with. I consider it a bug that distributed requests were apparently hard-coded to use /select&lt;/p&gt;</comment>
                            <comment id="14316493" author="hossman" created="Wed, 11 Feb 2015 16:39:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;It should have been done this way to begin with. I consider it a bug that distributed requests were apparently hard-coded to use /select&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Definitely not a bug.&lt;/p&gt;

&lt;p&gt;you have to remember the context of how distributed search was added &amp;#8211; prior to SolrCloud, you had to specify a &quot;shards&quot; param listing all of the cores you wanted to do a distributed search over, and the primary convinience mechanism for doing that was to register a handler like this...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;requestHandler name=&quot;/my_handler&quot; class=&quot;solr.SearchHandler&quot;/&amp;gt;
  &amp;lt;lst name=&quot;defaults&quot;&amp;gt;
    &amp;lt;str name=&quot;shards&quot;&amp;gt;foo:8983/solr,bar:8983/solr&amp;lt;/str&amp;gt;
    &amp;lt;int name=&quot;rows&quot;&amp;gt;100&amp;lt;/int&amp;gt;
  &amp;lt;/lst&amp;gt;
&amp;lt;/requestHandler&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...so the choice to have &quot;shards.qt&quot; default to &quot;/select&quot; instead of the current qt was &lt;em&gt;extremely&lt;/em&gt; important to make distributed search function correctly for most users for multiple reasons:&lt;/p&gt;

&lt;p&gt;1) so that the shards param wouldn&apos;t cause infinite recursion&lt;br/&gt;
2) so that the &quot;defaults&quot; wouldn&apos;t be automatically inherited by the per-shard requests&lt;/p&gt;

&lt;p&gt;But now is not then &amp;#8211; the default behavior of shards.qt should change to make the most sense given the features and best practice currently available in Solr.  SolrCloud solves #1, and IIUC useParams solves #2, so we can move forward.&lt;/p&gt;</comment>
                            <comment id="14316751" author="thelabdude" created="Wed, 11 Feb 2015 18:47:21 +0000"  >&lt;p&gt;I&apos;m going with &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman&quot; class=&quot;user-hover&quot; rel=&quot;hossman&quot;&gt;hossman&lt;/a&gt;&apos;s suggestion of using the LUCENE_MATCH_VERSION and am targeting this fix for the 5.1 release. So my first inclination was to do:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (req.getCore().getSolrConfig().luceneMatchVersion.onOrAfter(Version.LUCENE_5_1_0)) {
 ...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But Version.LUCENE_5_1_0 is deprecated, so do I do this instead? &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (req.getCore().getSolrConfig().luceneMatchVersion.onOrAfter(Version.LATEST)) {
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I guess it&apos;s the deprecated thing that&apos;s throwing me off.&lt;/p&gt;</comment>
                            <comment id="14316767" author="thelabdude" created="Wed, 11 Feb 2015 18:56:08 +0000"  >&lt;p&gt;nm! If I look at branch5x, my question is answered &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; sometimes you have to look outside of trunk to see clearly!&lt;/p&gt;</comment>
                            <comment id="14316919" author="thelabdude" created="Wed, 11 Feb 2015 20:24:42 +0000"  >&lt;p&gt;Patch that implements the conditional logic based on the luceneMatchVersion. I&apos;m intending this fix to be included in 5.1. The &lt;tt&gt;TermVectorComponentDistributedTest&lt;/tt&gt; test now works without specifying the &lt;tt&gt;shards.qt&lt;/tt&gt; query param. Feedback welcome!&lt;/p&gt;</comment>
                            <comment id="14316967" author="smolloy" created="Wed, 11 Feb 2015 20:57:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;Definitely not a bug. you have to remember the context of how distributed search was added &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks for the history, makes it clearer why it was needed.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;But now is not then&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Indeed, now distributed/SolrCloud is pretty much the norm...&lt;/p&gt;

&lt;p&gt;So anyhow, patch with logic on version makes sense for me, so +1. &lt;/p&gt;</comment>
                            <comment id="14320806" author="jira-bot" created="Fri, 13 Feb 2015 21:42:30 +0000"  >&lt;p&gt;Commit 1659694 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thelabdude&quot; class=&quot;user-hover&quot; rel=&quot;thelabdude&quot;&gt;thelabdude&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1659694&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1659694&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6311&quot; title=&quot;SearchHandler should use path when no qt or shard.qt parameter is specified&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6311&quot;&gt;&lt;del&gt;SOLR-6311&lt;/del&gt;&lt;/a&gt;: SearchHandler should use path when no qt or shard.qt parameter is specified&lt;/p&gt;</comment>
                            <comment id="14320854" author="jira-bot" created="Fri, 13 Feb 2015 22:13:28 +0000"  >&lt;p&gt;Commit 1659699 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thelabdude&quot; class=&quot;user-hover&quot; rel=&quot;thelabdude&quot;&gt;thelabdude&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1659699&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1659699&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6311&quot; title=&quot;SearchHandler should use path when no qt or shard.qt parameter is specified&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6311&quot;&gt;&lt;del&gt;SOLR-6311&lt;/del&gt;&lt;/a&gt;: SearchHandler should use path when no qt or shard.qt parameter is specified&lt;/p&gt;</comment>
                            <comment id="14495248" author="thelabdude" created="Wed, 15 Apr 2015 00:30:15 +0000"  >&lt;p&gt;Bulk close after 5.1 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12698174" name="SOLR-6311.patch" size="5241" author="thelabdude" created="Wed, 11 Feb 2015 20:24:42 +0000"/>
                            <attachment id="12659216" name="SOLR-6311.patch" size="1494" author="smolloy" created="Fri, 1 Aug 2014 18:07:53 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>409443</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 32 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1yg53:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>409439</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>