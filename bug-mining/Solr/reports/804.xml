<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:25:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3160] Division by zero in StatsComponent with date field always missing</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3160</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Using the StatsComponent with a date field that never has a value you&apos;ll get &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;java.lang.ArithmeticException: / by zero at org.apache.solr.handler.component.DateStatsValues.addTypeSpecificStats (StatsValuesFactory.java:384)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The problem is in this line of DateStatsValues:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;res.add(&lt;span class=&quot;code-quote&quot;&gt;&quot;mean&quot;&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Date(sum / count));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If count is 0 the division throws ArithmeticException because sum is long here. This doesn&apos;t happen with NumericStatsValues because sum is double there and the division result is Nan.&lt;br/&gt;
By the way, the result of those divisions is not even included in the output when count is 0 because of this condition in SimpleStats#getStatsFields:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isShard == &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; || (&lt;span class=&quot;code-object&quot;&gt;Long&lt;/span&gt;) stv.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;count&quot;&lt;/span&gt;) &amp;gt; 0) {
    res.add(f, stv);
} &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
    res.add(f, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Therefore, it should never throw an exception!&lt;/p&gt;</description>
                <environment></environment>
        <key id="12543975">SOLR-3160</key>
            <summary>Division by zero in StatsComponent with date field always missing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="erickerickson">Erick Erickson</assignee>
                                    <reporter username="lucacavanna">Luca Cavanna</reporter>
                        <labels>
                    </labels>
                <created>Fri, 24 Feb 2012 09:55:18 +0000</created>
                <updated>Fri, 10 May 2013 10:38:36 +0000</updated>
                            <resolved>Fri, 24 Feb 2012 14:39:44 +0000</resolved>
                                    <version>3.5</version>
                                    <fixVersion>3.6</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13215554" author="lucacavanna" created="Fri, 24 Feb 2012 11:13:43 +0000"  >&lt;p&gt;Attached patch containing some new test methods and a fix within DateStatsvalues.&lt;br/&gt;
StatsComponentTest tests now the same situation (count=0) for string, date and numeric field, and the result is the same.&lt;/p&gt;</comment>
                            <comment id="13215577" author="erickerickson" created="Fri, 24 Feb 2012 12:39:56 +0000"  >&lt;p&gt;Luca:&lt;/p&gt;

&lt;p&gt;Good catch. I&apos;ll assign it to myself (that way I won&apos;t forget!) and check it in later today. Thanks!&lt;/p&gt;</comment>
                            <comment id="13215589" author="lucacavanna" created="Fri, 24 Feb 2012 12:51:26 +0000"  >&lt;p&gt;Thanks Erick! &lt;br/&gt;
Catch is not mine, it comes from this &lt;a href=&quot;http://stackoverflow.com/q/9368926/633239&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;StackOverflow question&lt;/a&gt;, I just reported the error and worked on the patch.&lt;/p&gt;</comment>
                            <comment id="13215637" author="erickerickson" created="Fri, 24 Feb 2012 14:39:44 +0000"  >&lt;p&gt;Trunk: r1293270&lt;br/&gt;
3x:    1293272&lt;/p&gt;

&lt;p&gt;Thanks Luca!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12515913" name="SOLR-3160.patch" size="3118" author="lucacavanna" created="Fri, 24 Feb 2012 11:13:43 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>229213</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 39 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03gcn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18082</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>