<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:17:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9360] Solr script not properly checking SOLR_PID</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9360</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;In the solr script we see in 3-4 areas  this check :&lt;/p&gt;

&lt;p&gt;SOLR_PID=`ps auxww | grep start\.jar | grep -w $SOLR_PORT | grep -v grep | awk &apos;&lt;/p&gt;
{print $2}
&lt;p&gt;&apos; | sort -r`&lt;/p&gt;

&lt;p&gt;This can potentially prevent a solr instance to start in the case another process by any chance contains the port int the command itself ( not necessarily actually using the port) .&lt;/p&gt;

&lt;p&gt;e.g.&lt;br/&gt;
java -server -Djetty.port=10504 -DSTOP.PORT=9504 -DSTOP.KEY=solrrocks -DMASTER_CORE_URL=external-server:10500/solr -jar start.jar --module=http&lt;/p&gt;

&lt;p&gt;A solr is running on 10504.&lt;br/&gt;
A new Solr will not be able to start on 10500 ( but actually the port is free).&lt;br/&gt;
This should be replaced by a real check if the port is used ( like netstat or similar) .&lt;/p&gt;
</description>
                <environment></environment>
        <key id="12993568">SOLR-9360</key>
            <summary>Solr script not properly checking SOLR_PID</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="erickerickson">Erick Erickson</assignee>
                                    <reporter username="abenedetti">Alessandro Benedetti</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Jul 2016 15:30:59 +0000</created>
                <updated>Sat, 8 Jun 2019 15:37:03 +0000</updated>
                            <resolved>Fri, 4 Nov 2016 20:03:01 +0000</resolved>
                                    <version>6.1</version>
                                    <fixVersion>6.4</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                    <component>scripts and tools</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15399634" author="alessandro.benedetti" created="Fri, 29 Jul 2016 16:34:49 +0000"  >&lt;p&gt;ps replaced with netstat&lt;/p&gt;</comment>
                            <comment id="15399639" author="alessandro.benedetti" created="Fri, 29 Jul 2016 16:36:23 +0000"  >&lt;p&gt;The patch is tentative, the modification worked for me on Centos, not sure how netstat is a good solution, please people with more sys admin experience let me know.&lt;br/&gt;
Cheers&lt;/p&gt;</comment>
                            <comment id="15432690" author="alessandro.benedetti" created="Tue, 23 Aug 2016 12:05:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erickerickson&quot; class=&quot;user-hover&quot; rel=&quot;erickerickson&quot;&gt;erickerickson&lt;/a&gt; can you take a look ?&lt;br/&gt;
It is a sall change, but it was a production bug for us, quite annoying to be fair &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Cheers&lt;/p&gt;</comment>
                            <comment id="15432852" author="erickerickson" created="Tue, 23 Aug 2016 14:10:41 +0000"  >&lt;p&gt;Assigned to myself, but I&apos;m not really that up on whether netstat is a good way to fix this or not so anyone else who wants to grab it feel free.....&lt;/p&gt;

&lt;p&gt;Or render an opinion, I&apos;ll be happy to commit.&lt;/p&gt;</comment>
                            <comment id="15432858" author="alessandro.benedetti" created="Tue, 23 Aug 2016 14:14:04 +0000"  >&lt;p&gt;Thanks Erick, the only reason I tagged you is because I saw you working on some &quot;script&quot; related Jiras &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
To be fair, I hope someone illuminates us as I have limited experience in sys admin tasks, but at least it worked &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Cheers&lt;/p&gt;</comment>
                            <comment id="15432859" author="alessandro.benedetti" created="Tue, 23 Aug 2016 14:14:09 +0000"  >&lt;p&gt;Thanks Erick, the only reason I tagged you is because I saw you working on some &quot;script&quot; related Jiras &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
To be fair, I hope someone illuminates us as I have limited experience in sys admin tasks, but at least it worked &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Cheers&lt;/p&gt;</comment>
                            <comment id="15432957" author="shalinmangar" created="Tue, 23 Aug 2016 14:54:24 +0000"  >&lt;p&gt;According to the description &amp;#8211; the current script prevents starting a solr on port 10500 if another solr on 10504 is running. Why would that happen? are we not matching whole words?&lt;/p&gt;

&lt;p&gt;I think a better fix would be to match the full -Djetty.port=$SOLR_PORT string.&lt;/p&gt;

&lt;p&gt;Many OS do not have netstat by default e.g. centos minimal. Docker-solr which uses a stripped down version of debian also does not have netstat by default. Also, the -p switch used in the patch is not supported on MacOS. (thanks to &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=makuk66&quot; class=&quot;user-hover&quot; rel=&quot;makuk66&quot;&gt;makuk66&lt;/a&gt; for these tips).&lt;/p&gt;</comment>
                            <comment id="15433103" author="alessandro.benedetti" created="Tue, 23 Aug 2016 16:07:44 +0000"  >&lt;p&gt;Hi Shalin,&lt;br/&gt;
thank you very much for the feedback!&lt;br/&gt;
Currently is checking only the port number :&lt;/p&gt;

&lt;p&gt;SOLR_PID=`ps auxww | grep start\.jar | grep -w $SOLR_PORT | grep -v grep | awk &apos;&lt;/p&gt;
{print $2}
&lt;p&gt;&apos; | sort -r`&lt;/p&gt;

&lt;p&gt;This can potentially be prone to errors.&lt;br/&gt;
To me simply using the grep , even with the exact phrase ( &quot;-Djetty.port=$SOLR_PORT&quot;), could drive to errors.&lt;br/&gt;
Is there no standard way, supported also by minimal OS, to effectively check if the port is available or not ?&lt;/p&gt;

&lt;p&gt;Cheers&lt;/p&gt;</comment>
                            <comment id="15433324" author="shalinmangar" created="Tue, 23 Aug 2016 18:12:45 +0000"  >&lt;blockquote&gt;&lt;p&gt;Is there no standard way, supported also by minimal OS, to effectively check if the port is available or not ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Typically, startup scripts write the pid of the started process to a file and use that pid for figuring out if the process is still running and for killing the process. Solr doesn&apos;t do that which is why we have this problem.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;To me simply using the grep , even with the exact phrase ( &quot;-Djetty.port=$SOLR_PORT&quot;), could drive to errors.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Short of writing/using pid files, I think this is the best available workaround?&lt;/p&gt;

&lt;p&gt;&amp;lt;edit&amp;gt; - I wasn&apos;t clear earlier but the intention is to match the whole word i.e. grepping for -Djetty.port=1050 should not match -Djetty.port=10500&lt;/p&gt;</comment>
                            <comment id="15634635" author="erickerickson" created="Thu, 3 Nov 2016 23:19:46 +0000"  >&lt;p&gt;OK, the grep -w option does match whole words only, so this works.&lt;/p&gt;

&lt;p&gt;-D is a flag for grep (how universal I&apos;m not sure) and at least one other place greps (incorrectly) just for jetty.port rather than jetty\.port so I&apos;ll just use the jetty\.port=$WOLR_PORT version&lt;/p&gt;

&lt;p&gt;There&apos;s a couple of greps for &quot;solr.solr.home&quot; as well that I&apos;ll fix on the way by.&lt;/p&gt;

&lt;p&gt;I took a brief look at the windows script and it uses another mechanism, so I&apos;m not going to touch that one especially as I have no way to test it.&lt;/p&gt;</comment>
                            <comment id="15634685" author="erickerickson" created="Thu, 3 Nov 2016 23:47:22 +0000"  >&lt;p&gt;Oh, and the script &lt;em&gt;does&lt;/em&gt; use a pid file(s), this is a bit of extra logic using these patterns.&lt;/p&gt;</comment>
                            <comment id="15635037" author="erickerickson" created="Fri, 4 Nov 2016 02:57:24 +0000"  >&lt;p&gt;I think this does it, I&apos;ll check it in probably tomorrow unless people object.&lt;/p&gt;</comment>
                            <comment id="15635700" author="alessandro.benedetti" created="Fri, 4 Nov 2016 08:47:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erickerickson&quot; class=&quot;user-hover&quot; rel=&quot;erickerickson&quot;&gt;erickerickson&lt;/a&gt; I think it is fair enough &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="15637485" author="erickerickson" created="Fri, 4 Nov 2016 19:54:50 +0000"  >&lt;p&gt;Final patch, same as yesterday&apos;s but with CHANGES.txt updated.&lt;/p&gt;</comment>
                            <comment id="15637494" author="jira-bot" created="Fri, 4 Nov 2016 19:58:19 +0000"  >&lt;p&gt;Commit b2bf87dee7ea1b98eed62ccc3a921d387db39a79 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erickerickson&quot; class=&quot;user-hover&quot; rel=&quot;erickerickson&quot;&gt;erickerickson&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b2bf87d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b2bf87d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9360&quot; title=&quot;Solr script not properly checking SOLR_PID&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9360&quot;&gt;&lt;del&gt;SOLR-9360&lt;/del&gt;&lt;/a&gt;: Solr script not properly checking SOLR_PID&lt;/p&gt;</comment>
                            <comment id="15637507" author="jira-bot" created="Fri, 4 Nov 2016 20:01:34 +0000"  >&lt;p&gt;Commit 758aacc7bb6fac04bbc49262fa710f1e496e1f59 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erickerickson&quot; class=&quot;user-hover&quot; rel=&quot;erickerickson&quot;&gt;erickerickson&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=758aacc&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=758aacc&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9360&quot; title=&quot;Solr script not properly checking SOLR_PID&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9360&quot;&gt;&lt;del&gt;SOLR-9360&lt;/del&gt;&lt;/a&gt;: Solr script not properly checking SOLR_PID&lt;br/&gt;
(cherry picked from commit b2bf87d)&lt;/p&gt;</comment>
                            <comment id="15637515" author="erickerickson" created="Fri, 4 Nov 2016 20:03:01 +0000"  >&lt;p&gt;Thanks Allessandro!&lt;/p&gt;</comment>
                            <comment id="15644680" author="jira-bot" created="Mon, 7 Nov 2016 16:50:18 +0000"  >&lt;p&gt;Commit b2bf87dee7ea1b98eed62ccc3a921d387db39a79 in lucene-solr&apos;s branch refs/heads/apiv2 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erickerickson&quot; class=&quot;user-hover&quot; rel=&quot;erickerickson&quot;&gt;erickerickson&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b2bf87d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b2bf87d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9360&quot; title=&quot;Solr script not properly checking SOLR_PID&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9360&quot;&gt;&lt;del&gt;SOLR-9360&lt;/del&gt;&lt;/a&gt;: Solr script not properly checking SOLR_PID&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12837266" name="SOLR-9360.patch" size="3739" author="erickerickson" created="Fri, 4 Nov 2016 19:54:50 +0000"/>
                            <attachment id="12837023" name="SOLR-9360.patch" size="3308" author="erickerickson" created="Fri, 4 Nov 2016 02:57:24 +0000"/>
                            <attachment id="12821010" name="SOLR_9360.patch" size="2661" author="abenedetti" created="Fri, 29 Jul 2016 16:34:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 2 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i31oin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>