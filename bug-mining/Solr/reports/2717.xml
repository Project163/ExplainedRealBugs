<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:09:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5971] &apos;Illegal character in query&apos; when proxying request</title>
                <link>https://issues.apache.org/jira/browse/SOLR-5971</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;My cluster contains 3 Solr instances. I have a collection consisting of one shard with 2 replica&apos;s. So one node in the cluster does not have a replicate of the shard.&lt;/p&gt;

&lt;p&gt;The following query works when I query one of the two replica nodes:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://X.X.X.X:8080/solr/collection/select/?facet=true&amp;amp;facet.field=&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://X.X.X.X:8080/solr/collection/select/?facet=true&amp;amp;facet.field=&lt;/a&gt;&lt;/p&gt;
{!ex%3Dfilters,filter1340+key%3Dfacet1340Values}string_months_month&amp;amp;facet=true&amp;amp;q=&lt;b&gt;:&lt;/b&gt;&lt;br/&gt;
&lt;br/&gt;
But when I query the node without the replica, I get;&lt;br/&gt;
&lt;br/&gt;
{msg=Illegal character in query at index 78: &lt;a href=&quot;http://X.X.X.X:8080/solr/collection/select/?facet=true&amp;amp;facet.field=&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://X.X.X.X:8080/solr/collection/select/?facet=true&amp;amp;facet.field=&lt;/a&gt;{!ex%3Dfilters,filter1340+key%3Dfacet1340Values}
&lt;p&gt;string_months_month&amp;amp;facet=true&amp;amp;q=&lt;b&gt;:&lt;/b&gt;,trace=java.lang.IllegalArgumentException&lt;br/&gt;
	at java.net.URI.create(URI.java:842)&lt;br/&gt;
	at org.apache.http.client.methods.HttpGet.&amp;lt;init&amp;gt;(HttpGet.java:69)&lt;br/&gt;
	at org.apache.solr.servlet.SolrDispatchFilter.remoteQuery(SolrDispatchFilter.java:527)&lt;br/&gt;
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:340)&lt;br/&gt;
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:217)&lt;br/&gt;
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419)&lt;br/&gt;
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)&lt;br/&gt;
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557)&lt;br/&gt;
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075)&lt;br/&gt;
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384)&lt;br/&gt;
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)&lt;br/&gt;
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)&lt;br/&gt;
	at org.eclipse.jetty.server.Server.handle(Server.java:368)&lt;br/&gt;
	at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489)&lt;br/&gt;
	at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)&lt;br/&gt;
	at org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:942)&lt;br/&gt;
	at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:1004)&lt;br/&gt;
	at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:640)&lt;br/&gt;
	at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235)&lt;br/&gt;
	at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72)&lt;br/&gt;
	at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264)&lt;br/&gt;
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)&lt;br/&gt;
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)&lt;br/&gt;
	at java.lang.Thread.run(Thread.java:662)&lt;/p&gt;

&lt;p&gt;Without the facet.field attribute, it works fine on all the nodes.&lt;br/&gt;
Is this some kind of double escaping when proxying the request?&lt;/p&gt;</description>
                <environment>&lt;p&gt;Debian Wheezy, Java(TM) SE Runtime Environment (build 1.6.0_26-b03)&lt;/p&gt;</environment>
        <key id="12707135">SOLR-5971</key>
            <summary>&apos;Illegal character in query&apos; when proxying request</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="uschindler">Uwe Schindler</assignee>
                                    <reporter username="eric.bus">Eric Bus</reporter>
                        <labels>
                            <label>characters</label>
                            <label>exception</label>
                            <label>invalid</label>
                            <label>proxy</label>
                            <label>query</label>
                            <label>solrcloud</label>
                    </labels>
                <created>Tue, 8 Apr 2014 08:30:33 +0000</created>
                <updated>Mon, 9 May 2016 18:49:20 +0000</updated>
                            <resolved>Sun, 22 Nov 2015 10:16:13 +0000</resolved>
                                    <version>4.7.1</version>
                                    <fixVersion>5.4</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>2</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="13963323" author="elyograg" created="Tue, 8 Apr 2014 19:17:46 +0000"  >&lt;p&gt;I think &quot;index 78&quot; may correspond to the right curly brace character for the localparams on your facet.field.  What happens if you replace { with %7B and } with %7D in your URL?  Right now, I consider this a troubleshooting step, not necessarily a workaround.&lt;/p&gt;</comment>
                            <comment id="13963968" author="eric.bus" created="Wed, 9 Apr 2014 09:28:12 +0000"  >&lt;p&gt;Unfortunately, that does not change the error. After encoding the braces, the same error is reported on the node without the replica. The results on the other nodes is the same.&lt;/p&gt;</comment>
                            <comment id="14256887" author="yseeley@gmail.com" created="Tue, 23 Dec 2014 11:36:58 +0000"  >&lt;p&gt;Another user reports what looks to be the same bug:&lt;br/&gt;
&lt;a href=&quot;http://markmail.org/message/v4vkkd2tqwq4uier&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://markmail.org/message/v4vkkd2tqwq4uier&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Hi All,&lt;/p&gt;

&lt;p&gt;I am using SolrCloud 4.10.1 and I have 3 shards with replication factor of&lt;br/&gt;
2 , i.e is 6 nodes altogether.&lt;/p&gt;

&lt;p&gt;When I query the server1 out of 6 nodes in the cluster with the below query&lt;br/&gt;
, it works fine , but any other node in the cluster when queried with the&lt;br/&gt;
same query results in a *HTTP Status 500 - {msg=Illegal character in query&lt;br/&gt;
at index 181:*&lt;br/&gt;
error.&lt;/p&gt;

&lt;p&gt;The character at index 181 is the boost character ^. I have see a Jira&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5971&quot; title=&quot;&amp;#39;Illegal character in query&amp;#39; when proxying request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5971&quot;&gt;&lt;del&gt;SOLR-5971&lt;/del&gt;&lt;/a&gt; &amp;lt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5971&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-5971&lt;/a&gt;&amp;gt; for a similar&lt;br/&gt;
issue , how can I overcome this issue.&lt;/p&gt;

&lt;p&gt;The query I use is below. Thanks in Advance!&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://xxxxxx2.xxxxxxxx.com:8081/solr/dyCollection1_shard2_replica1/xxxxxxxx?q=xxxxx+xxxxx+xxxxxx&amp;amp;sort=score+desc&amp;amp;wt=json&amp;amp;indent=true&amp;amp;debugQuery=true&amp;amp;defType=edismax&amp;amp;qf=productName&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://xxxxxx2.xxxxxxxx.com:8081/solr/dyCollection1_shard2_replica1/xxxxxxxx?q=xxxxx+xxxxx+xxxxxx&amp;amp;sort=score+desc&amp;amp;wt=json&amp;amp;indent=true&amp;amp;debugQuery=true&amp;amp;defType=edismax&amp;amp;qf=productName&lt;/a&gt;&lt;br/&gt;
^1.5+productDescription&amp;amp;mm=1&amp;amp;pf=productName+productDescription&amp;amp;ps=1&amp;amp;pf2=productName+productDescription&amp;amp;pf3=productName+productDescription&amp;amp;stopwords=true&amp;amp;lowercaseOperators=true&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="15014290" author="gdgrimm" created="Thu, 19 Nov 2015 20:22:40 +0000"  >&lt;p&gt;Another customer with the same issue (running 5.3).  When the query is initially directed to a node with a core from the collection things work correctly.  When directed to a node without a core from the collection, an error is throwing showing the URL parsing error from one of the nodes WITH the proper core.&lt;/p&gt;

&lt;p&gt;So a query like this would work (node has the core on it):&lt;br/&gt;
&lt;a href=&quot;http://machine1:8983/solr/someCollection/select?q=id:something&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://machine1:8983/solr/someCollection/select?q=id:something&lt;/a&gt;^2&lt;/p&gt;

&lt;p&gt;But this query (node doesn&apos;t have the core on it):&lt;br/&gt;
&lt;a href=&quot;http://machine3:8983/solr/someCollection/select?q=id:something&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://machine3:8983/solr/someCollection/select?q=id:something&lt;/a&gt;^2&lt;/p&gt;

&lt;p&gt;Will yield an error message like:&lt;br/&gt;
Illegal character in query at index XX: &lt;a href=&quot;http://machine1:8983/solr/someCollection/select?q=id:something&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://machine1:8983/solr/someCollection/select?q=id:something&lt;/a&gt;^2&lt;/p&gt;

&lt;p&gt;So it appears that the proxy code on machine3 is mangling the URL that is being passed to machine1?&lt;/p&gt;

&lt;p&gt;Also, by URL-encoding the ^ character in the query, the issue can be avoided.  So this query would work fine against any node:&lt;br/&gt;
&lt;a href=&quot;http://machine3:8983/solr/someCollection/select?q=id:something%5E2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://machine3:8983/solr/someCollection/select?q=id:something%5E2&lt;/a&gt;&lt;/p&gt;
</comment>
                            <comment id="15014306" author="yseeley@gmail.com" created="Thu, 19 Nov 2015 20:41:25 +0000"  >&lt;p&gt;Looks like this slipped off everybody&apos;s radar.&lt;br/&gt;
Since it seems serious, I&apos;ll mark it as a blocker for the next release.&lt;/p&gt;</comment>
                            <comment id="15015046" author="suraj403" created="Fri, 20 Nov 2015 02:19:58 +0000"  >&lt;p&gt;This is critical for proper functioning of Solr Cloud. Thank you Garth for updating this case.&lt;/p&gt;</comment>
                            <comment id="15015261" author="ichattopadhyaya" created="Fri, 20 Nov 2015 05:48:52 +0000"  >&lt;p&gt;I&apos;ve been able to reproduce this locally (starting a two node cluster manually, not through a test yet). I&apos;m working on a fix for this and shall post a patch for this, unless someone else beats me to it.&lt;/p&gt;</comment>
                            <comment id="15017832" author="ichattopadhyaya" created="Fri, 20 Nov 2015 13:01:33 +0000"  >&lt;p&gt;While performing a remote query at HttpSolrCall, the original query request string is passed along as is to the httpclient to make the forward query. The problem is (maybe a newly introduced one, due to some HttpClient regression?) that httpclient throws exception for urls that contain certain special characters like &lt;tt&gt;^&lt;/tt&gt; or { or }.&lt;/p&gt;

&lt;p&gt;Added a patch which recreates another query string by URL encoding every query parameter.&lt;/p&gt;

&lt;p&gt;The reason why we missed this in our testing is that all our tests use the SolrQuery and a SolrClient to make the queries, and that uses url encoding internally. For testing this, I couldn&apos;t use an httpclient to query with such special characters in the url, since httpclient doesn&apos;t allow this in the first place. Resorted to using a java.net.URL.openStream() with the url containing weird characters to test this; added a new test suite altogether as I couldn&apos;t find out an appropriate test suite that exists right now.&lt;/p&gt;

&lt;p&gt;Can someone please review the patch? Thanks.&lt;/p&gt;</comment>
                            <comment id="15017999" author="thetaphi" created="Fri, 20 Nov 2015 13:08:41 +0000"  >&lt;p&gt;You must also pass the key name through the encoder! Its unlikely that Solr contains key names which violate the spec, but better safe than fail again in the future. forms encoding requires that both key and value is encoded. Also use the correct constants for UTF-8.&lt;/p&gt;</comment>
                            <comment id="15018005" author="ichattopadhyaya" created="Fri, 20 Nov 2015 13:14:52 +0000"  >&lt;p&gt;Thanks Uwe for looking at it. Encoded the key as well to be safe.&lt;br/&gt;
Running the full suite of tests now (it passed for me last time, apart from the ones that fail frequently at Jenkins anyway).&lt;/p&gt;</comment>
                            <comment id="15018015" author="ichattopadhyaya" created="Fri, 20 Nov 2015 13:28:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;Also use the correct constants for UTF-8.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Updated the patch to use &lt;tt&gt;StandardCharsets.UTF_8.name()&lt;/tt&gt;. There are several other instances of the use of &quot;UTF-8&quot; constant. &lt;/p&gt;

&lt;p&gt;Btw, should we change all of those to &lt;tt&gt;StandardCharsets.UTF_8.name()&lt;/tt&gt; in a separate JIRA issue? I&apos;ve included one such change in this patch, i.e. ClientUtils. That method in the ClientUtils is very similar to what we&apos;re doing here in this patch.&lt;/p&gt;</comment>
                            <comment id="15018019" author="ichattopadhyaya" created="Fri, 20 Nov 2015 13:31:18 +0000"  >&lt;p&gt;Shall we mark this as a blocker for 5.4 instead of 5.5?&lt;/p&gt;</comment>
                            <comment id="15018052" author="ichattopadhyaya" created="Fri, 20 Nov 2015 13:58:51 +0000"  >&lt;p&gt;All tests pass for me after applying this patch (some fail intermittently, and seem like unrelated and non-reproducible failures. All the usual culprits from Jenkins over past few days.).&lt;/p&gt;</comment>
                            <comment id="15018152" author="thetaphi" created="Fri, 20 Nov 2015 15:29:03 +0000"  >&lt;p&gt;One thing: Maybe we can use a HttpClient method to build the query string? How do we do that in SolrJ generally?&lt;/p&gt;</comment>
                            <comment id="15018164" author="ichattopadhyaya" created="Fri, 20 Nov 2015 15:37:37 +0000"  >&lt;p&gt;We use the &lt;tt&gt;ClientUtils.toQueryString()&lt;/tt&gt;.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  public static String toQueryString( SolrParams params, boolean xml ) {
    StringBuilder sb = new StringBuilder(128);
    try {
      String amp = xml ? &quot;&amp;amp;amp;&quot; : &quot;&amp;amp;&quot;;
      boolean first=true;
      Iterator&amp;lt;String&amp;gt; names = params.getParameterNamesIterator();
      while( names.hasNext() ) {
        String key = names.next();
        String[] valarr = params.getParams( key );
        if( valarr == null ) {
          sb.append( first?&quot;?&quot;:amp );
          sb.append(key);
          first=false;
        }
        else {
          for (String val : valarr) {
            sb.append( first? &quot;?&quot;:amp );
            sb.append(key);
            if( val != null ) {
              sb.append(&apos;=&apos;);
              sb.append( URLEncoder.encode( val, StandardCharsets.UTF_8.name() ) );
            }
            first=false;
          }
        }
      }
    }
    catch (IOException e) {throw new RuntimeException(e);}  // can&apos;t happen
    return sb.toString();
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Do you know how to use the HttpClient to build the query string?&lt;/p&gt;</comment>
                            <comment id="15018173" author="thetaphi" created="Fri, 20 Nov 2015 15:42:38 +0000"  >&lt;p&gt;OK. So your patch is fine. I am just confused why you put the utility method into RequestUtils, which is part of the json package. This seems &quot;wrong&quot; (the json package). Otherwise looks fine.&lt;/p&gt;

&lt;p&gt;I general I don&apos;t think this is a bug in SOLR, it is just &quot;wrong&quot; to accept the incoming URL anyways, so Jetty should have refused it already &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; But that is a different discussion! We just workaround on broken users violating the UR spec. So I am fine with that.&lt;/p&gt;</comment>
                            <comment id="15018192" author="ichattopadhyaya" created="Fri, 20 Nov 2015 15:55:26 +0000"  >&lt;p&gt;I couldn&apos;t think of the right place to put this. &quot;RequestUtil&quot; sounded the least wrong place to put this in (but the json part seemed bad). I was also thinking of ClientUtils (which is in a solrj package), because there is a very functionally similar method there by the same name already. Maybe I should&apos;ve kept it in HttpSolrCall itself.&lt;br/&gt;
I&apos;ll raise a patch to put this in HttpSolrCall. Does it sound fine?&lt;/p&gt;</comment>
                            <comment id="15018199" author="ichattopadhyaya" created="Fri, 20 Nov 2015 15:58:43 +0000"  >&lt;p&gt;Here goes the patch with the method in HttpSolrCall itself. Uwe, if you can think of a better place to put it in than this, please feel free to move it during the commit. Thanks.&lt;/p&gt;</comment>
                            <comment id="15018552" author="thetaphi" created="Fri, 20 Nov 2015 19:06:03 +0000"  >&lt;p&gt;Hi this patch does not pass the forbiddenapis check, because it uses HttpServletRequest.getParameterMap() &amp;amp; co. Calling these methods is forbidden in any solr code because it breaks with wrongly-configured servlet containers and is slow on Jetty. SolrRequestDispatcher&apos;s parameter parsing correctly parsers parameters into a SolrRequest. Why can&apos;t we use the SolrRequest?&lt;/p&gt;</comment>
                            <comment id="15018568" author="thetaphi" created="Fri, 20 Nov 2015 19:11:29 +0000"  >&lt;p&gt;So it is better to use the already decoded parameters: this.queryParams and use those!&lt;br/&gt;
Your code also has the problem that it cannot handle multiple identical keys (like multiple &quot;fq=&quot; parameters).&lt;/p&gt;

&lt;p&gt;I will post a new patch later so you can check it.&lt;/p&gt;</comment>
                            <comment id="15018608" author="ichattopadhyaya" created="Fri, 20 Nov 2015 19:30:08 +0000"  >&lt;p&gt;Ouch, I didn&apos;t check the precommit! The multiple parameters with same key not being handled was really bad; apologies...&lt;/p&gt;</comment>
                            <comment id="15018659" author="ichattopadhyaya" created="Fri, 20 Nov 2015 19:53:46 +0000"  >&lt;p&gt;Such mistakes, although would&apos;ve been caught by (and eventually was) precommit/forbidden apis, perhaps also shows the need for us to bolster the unit tests around request forwarding a bit more.&lt;/p&gt;</comment>
                            <comment id="15018830" author="thetaphi" created="Fri, 20 Nov 2015 21:21:25 +0000"  >&lt;p&gt;Updated patch. I added a new method to the SolrParams class: &lt;tt&gt;toQueryString()&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;This is most clean way. This allows to be used anywhere else, too (e.g. in SolrJ for building the query). This change is something for a new issue.&lt;/p&gt;</comment>
                            <comment id="15018852" author="ichattopadhyaya" created="Fri, 20 Nov 2015 21:32:15 +0000"  >&lt;p&gt;+1, LGTM.&lt;/p&gt;</comment>
                            <comment id="15019040" author="thetaphi" created="Fri, 20 Nov 2015 23:25:01 +0000"  >&lt;p&gt;New patch. I cleaned up lots of code duplication. Now SolrJ everywhere uses the SolrParams-provided method to encode query strings. So it is completely consistent.&lt;/p&gt;

&lt;p&gt;I also cleaned up the toString() used for logging query params (simplified URL encoding as documented).&lt;/p&gt;

&lt;p&gt;All core + solrj tests pass, rest is running now. If nobody objects I will commit this to trunk and 5.x branch, so it gets included in 5.4.&lt;/p&gt;</comment>
                            <comment id="15020914" author="jira-bot" created="Sun, 22 Nov 2015 09:56:24 +0000"  >&lt;p&gt;Commit 1715615 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;thetaphi&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1715615&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1715615&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5971&quot; title=&quot;&amp;#39;Illegal character in query&amp;#39; when proxying request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5971&quot;&gt;&lt;del&gt;SOLR-5971&lt;/del&gt;&lt;/a&gt;: Fix error &apos;Illegal character in query&apos; when proxying request&lt;/p&gt;</comment>
                            <comment id="15020924" author="jira-bot" created="Sun, 22 Nov 2015 10:11:29 +0000"  >&lt;p&gt;Commit 1715616 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;thetaphi&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1715616&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1715616&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merged revision(s) 1715615 from lucene/dev/trunk:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5971&quot; title=&quot;&amp;#39;Illegal character in query&amp;#39; when proxying request&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5971&quot;&gt;&lt;del&gt;SOLR-5971&lt;/del&gt;&lt;/a&gt;: Fix error &apos;Illegal character in query&apos; when proxying request&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12773613" name="SOLR-5971.patch" size="17818" author="uschindler" created="Fri, 20 Nov 2015 23:25:01 +0000"/>
                            <attachment id="12773598" name="SOLR-5971.patch" size="6815" author="uschindler" created="Fri, 20 Nov 2015 21:21:25 +0000"/>
                            <attachment id="12773533" name="SOLR-5971.patch" size="5782" author="ichattopadhyaya" created="Fri, 20 Nov 2015 15:58:43 +0000"/>
                            <attachment id="12773508" name="SOLR-5971.patch" size="7436" author="ichattopadhyaya" created="Fri, 20 Nov 2015 13:28:39 +0000"/>
                            <attachment id="12773507" name="SOLR-5971.patch" size="6478" author="ichattopadhyaya" created="Fri, 20 Nov 2015 13:14:52 +0000"/>
                            <attachment id="12773504" name="SOLR-5971.patch" size="6438" author="ichattopadhyaya" created="Fri, 20 Nov 2015 13:01:33 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>385458</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1uek7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>385725</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>