<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:18:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9707] DeleteByQuery forward requests to down replicas and set it in LiR</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9707</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;DeleteByQuery, unlike other requests, does not filter out the down replicas. Thus, the update is still forwarded to the down replica and fails, and the leader then sets the replica in LiR. In a cluster where there are lots of deleteByQuery requests, this can flood the /overseer/queue.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13016658">SOLR-9707</key>
            <summary>DeleteByQuery forward requests to down replicas and set it in LiR</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="varun">Varun Thacker</assignee>
                                    <reporter username="mewmewball">Jessica Cheng Mallet</reporter>
                        <labels>
                            <label>solrcloud</label>
                    </labels>
                <created>Mon, 31 Oct 2016 17:15:34 +0000</created>
                <updated>Thu, 21 Nov 2019 00:42:25 +0000</updated>
                            <resolved>Tue, 13 Dec 2016 01:24:37 +0000</resolved>
                                                    <fixVersion>6.4</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15667951" author="markrmiller@gmail.com" created="Tue, 15 Nov 2016 19:01:03 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yseeley%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yseeley@gmail.com&quot;&gt;yseeley@gmail.com&lt;/a&gt;, any idea if that was on purpose to avoid a state race or something?&lt;/p&gt;</comment>
                            <comment id="15667995" author="yseeley@gmail.com" created="Tue, 15 Nov 2016 19:18:57 +0000"  >&lt;p&gt;I don&apos;t think so...&lt;br/&gt;
seems like it should follow the same procedure as any other update.&lt;/p&gt;</comment>
                            <comment id="15703841" author="varunthacker" created="Tue, 29 Nov 2016 01:46:46 +0000"  >&lt;p&gt;Hi Jessica,&lt;/p&gt;

&lt;p&gt;I was trying to write a test case for this and I wasn&apos;t able to get it to fail without the patch. I realized that it&apos;s because we already filter out replicas which aren&apos;t on the live node list ( &lt;a href=&quot;https://github.com/apache/lucene-solr/blob/master/solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java#L805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/master/solr/solrj/src/java/org/apache/solr/common/cloud/ZkStateReader.java#L805&lt;/a&gt; )&lt;/p&gt;

&lt;p&gt;Attaching the updated patch with the test case for reference.&lt;/p&gt;</comment>
                            <comment id="15706307" author="varunthacker" created="Tue, 29 Nov 2016 19:35:41 +0000"  >&lt;p&gt;Its still a good idea to filter out down replica before sending the update. There might be edge cases / bugs which could lead to a replica being in down state even on a live node.&lt;/p&gt;

&lt;p&gt;The tests pass with Jessica&apos;s original patch. &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yseeley%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yseeley@gmail.com&quot;&gt;yseeley@gmail.com&lt;/a&gt; any suggestions on how we can add a test case for this or is it just safe to commit the patch without an explicit test case for it?&lt;/p&gt;</comment>
                            <comment id="15743398" author="varunthacker" created="Mon, 12 Dec 2016 22:43:00 +0000"  >&lt;p&gt;I&apos;m going to run a couple of more rounds of tests and then commit the patch without the test case. &lt;/p&gt;</comment>
                            <comment id="15743771" author="jira-bot" created="Tue, 13 Dec 2016 01:23:13 +0000"  >&lt;p&gt;Commit fecbbe081fd4a777f01517fdd8631e69797def38 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=fecbbe0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=fecbbe0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9707&quot; title=&quot;DeleteByQuery forward requests to down replicas and set it in LiR&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9707&quot;&gt;&lt;del&gt;SOLR-9707&lt;/del&gt;&lt;/a&gt;: Don&apos;t forward DeleteByQuery requests to down replicas&lt;/p&gt;</comment>
                            <comment id="15743773" author="jira-bot" created="Tue, 13 Dec 2016 01:23:51 +0000"  >&lt;p&gt;Commit a243f20973aad98f1961f48b197c90d2877704d4 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=a243f20&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=a243f20&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9707&quot; title=&quot;DeleteByQuery forward requests to down replicas and set it in LiR&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9707&quot;&gt;&lt;del&gt;SOLR-9707&lt;/del&gt;&lt;/a&gt;: Don&apos;t forward DeleteByQuery requests to down replicas&lt;/p&gt;</comment>
                            <comment id="15743775" author="varunthacker" created="Tue, 13 Dec 2016 01:24:53 +0000"  >&lt;p&gt;Thanks Jessica for catching this!&lt;/p&gt;</comment>
                            <comment id="15746189" author="jira-bot" created="Tue, 13 Dec 2016 20:30:28 +0000"  >&lt;p&gt;Commit fecbbe081fd4a777f01517fdd8631e69797def38 in lucene-solr&apos;s branch refs/heads/feature/metrics from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=fecbbe0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=fecbbe0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9707&quot; title=&quot;DeleteByQuery forward requests to down replicas and set it in LiR&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9707&quot;&gt;&lt;del&gt;SOLR-9707&lt;/del&gt;&lt;/a&gt;: Don&apos;t forward DeleteByQuery requests to down replicas&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12836181" name="SOLR-9707.diff" size="916" author="mewmewball" created="Mon, 31 Oct 2016 17:17:11 +0000"/>
                            <attachment id="12840771" name="SOLR-9707.patch" size="6755" author="varun" created="Tue, 29 Nov 2016 01:46:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 49 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i35mr3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>