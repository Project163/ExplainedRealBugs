<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:10:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-17333] Various rate limiting fixes</title>
                <link>https://issues.apache.org/jira/browse/SOLR-17333</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Solr rate limiting (introduced with &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13528&quot; title=&quot;Rate limiting in Solr&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13528&quot;&gt;&lt;del&gt;SOLR-13528&lt;/del&gt;&lt;/a&gt;) has a number of issues with its current implementation:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;live-update via clusterprops is incomplete, and does not work. Some settings can be updated, but for others &amp;#8211; namely, the actual request limits &amp;#8211; attempted changes are silently ignored. (aside from the fact that it doesn&apos;t work, the high-level approach to config changes is not ideal, mutating objects in potentially brittle ways)&lt;/li&gt;
	&lt;li&gt;there is a bug in slot borrowing that can in principle cause slots to be denied to native request types with guaranteed slots, even when plenty of slots are available. More likely consequences of the bug would be: native request types waiting up to twice as long as specified by &lt;tt&gt;slot allocation millis&lt;/tt&gt; before failing to acquire, or pointlessly waiting &lt;tt&gt;slot allocation millis&lt;/tt&gt; even when plenty of slots are available&lt;/li&gt;
	&lt;li&gt;unnecessary state-tracking of existing requests; we should instead close out rate-limiting slots via try-with-resources. This will be safer, cleaner, more efficient, and support more flexible slot-granting. (currently the outstanding state is tracked in a separate map in the &lt;tt&gt;RateLimitManager&lt;/tt&gt;, which is needlessly complex/inflexible)&lt;/li&gt;
	&lt;li&gt;refguide documentation is incomplete. Most importantly: ratelimiting won&apos;t work at all without the addition of a `Solr-Request-Type` header, but &lt;a href=&quot;https://solr.apache.org/guide/solr/9_6/deployment-guide/rate-limiters.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;as of current version v.9.6&lt;/a&gt; the refguide documentation doesn&apos;t mention the required header, so any user would be thoroughly confused!&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;I&apos;ve bundled these issues together for simplicity; I can break them apart if folks prefer, but the changes are kind of intertwined, and really IMO together constitute a single high-level follow-up to the introduction of rate limiting.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13582591">SOLR-17333</key>
            <summary>Various rate limiting fixes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="magibney">Michael Gibney</assignee>
                                    <reporter username="magibney">Michael Gibney</reporter>
                        <labels>
                    </labels>
                <created>Thu, 13 Jun 2024 18:44:46 +0000</created>
                <updated>Fri, 25 Oct 2024 17:18:56 +0000</updated>
                            <resolved>Mon, 8 Jul 2024 21:05:24 +0000</resolved>
                                                    <fixVersion>9.7</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3000">50m</timespent>
                                <comments>
                            <comment id="17863931" author="jira-bot" created="Mon, 8 Jul 2024 20:51:14 +0000"  >&lt;p&gt;Commit 9903d0342fad076daa7eedc6b5f72a73b33257ba in solr&apos;s branch refs/heads/main from Michael Gibney&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=9903d0342fa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=9903d0342fa&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17333&quot; title=&quot;Various rate limiting fixes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17333&quot;&gt;&lt;del&gt;SOLR-17333&lt;/del&gt;&lt;/a&gt;: Various rate limiting fixes (#2522)&lt;/p&gt;

&lt;p&gt;1. fix live-update of configuration&lt;br/&gt;
2. fix slot borrowing bug&lt;br/&gt;
3. cleaner state tracking via try-with-resources&lt;br/&gt;
4. fix refguide documentation to mention limitations and request header requirement&lt;/p&gt;</comment>
                            <comment id="17863935" author="jira-bot" created="Mon, 8 Jul 2024 21:03:31 +0000"  >&lt;p&gt;Commit 7a59a1d682a6f99215c770b8bade3ba8a13f122e in solr&apos;s branch refs/heads/branch_9x from Michael Gibney&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=7a59a1d682a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=7a59a1d682a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17333&quot; title=&quot;Various rate limiting fixes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17333&quot;&gt;&lt;del&gt;SOLR-17333&lt;/del&gt;&lt;/a&gt;: Various rate limiting fixes (#2522)&lt;/p&gt;

&lt;p&gt;1. fix live-update of configuration&lt;br/&gt;
2. fix slot borrowing bug&lt;br/&gt;
3. cleaner state tracking via try-with-resources&lt;br/&gt;
4. fix refguide documentation to mention limitations and request header requirement&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 9903d0342fad076daa7eedc6b5f72a73b33257ba)&lt;/p&gt;</comment>
                            <comment id="17866000" author="jira-bot" created="Mon, 15 Jul 2024 10:08:55 +0000"  >&lt;p&gt;Commit 9903d0342fad076daa7eedc6b5f72a73b33257ba in solr&apos;s branch refs/heads/pr/2550 from Michael Gibney&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=9903d0342fa&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=9903d0342fa&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17333&quot; title=&quot;Various rate limiting fixes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17333&quot;&gt;&lt;del&gt;SOLR-17333&lt;/del&gt;&lt;/a&gt;: Various rate limiting fixes (#2522)&lt;/p&gt;

&lt;p&gt;1. fix live-update of configuration&lt;br/&gt;
2. fix slot borrowing bug&lt;br/&gt;
3. cleaner state tracking via try-with-resources&lt;br/&gt;
4. fix refguide documentation to mention limitations and request header requirement&lt;/p&gt;</comment>
                            <comment id="17866526" author="jira-bot" created="Tue, 16 Jul 2024 20:28:42 +0000"  >&lt;p&gt;Commit 7a59a1d682a6f99215c770b8bade3ba8a13f122e in solr&apos;s branch refs/heads/backport_&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16842&quot; title=&quot;Eliminate special case code in solrCLI by introducing VersionTool&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16842&quot;&gt;&lt;del&gt;SOLR-16842&lt;/del&gt;&lt;/a&gt;_to_branch_9x from Michael Gibney&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=7a59a1d682a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=7a59a1d682a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17333&quot; title=&quot;Various rate limiting fixes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17333&quot;&gt;&lt;del&gt;SOLR-17333&lt;/del&gt;&lt;/a&gt;: Various rate limiting fixes (#2522)&lt;/p&gt;

&lt;p&gt;1. fix live-update of configuration&lt;br/&gt;
2. fix slot borrowing bug&lt;br/&gt;
3. cleaner state tracking via try-with-resources&lt;br/&gt;
4. fix refguide documentation to mention limitations and request header requirement&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 9903d0342fad076daa7eedc6b5f72a73b33257ba)&lt;/p&gt;</comment>
                            <comment id="17892943" author="anshumg" created="Fri, 25 Oct 2024 17:18:56 +0000"  >&lt;p&gt;Closing after the 9.7.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1psgg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>