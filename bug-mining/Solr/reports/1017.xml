<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:29:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3793] duplicate (deleted) documents included in result set when using field faceting with fq</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3793</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;G&#252;nter Hipler reported on the solr-user mailing list that he was seeing inconsistencies in facet counts compared to the numFound when drilling down onto those facets (using &quot;fq&quot;) - in particular: when adding an &quot;fq&quot; such as `fq=&lt;/p&gt;
{!term+f%3DnavNetwork}
&lt;p&gt;nebis`, the resulting numFound was higher then the number of docs reported by the facet constraint for nebis in the base request.&lt;/p&gt;

&lt;p&gt;I&apos;ve been able to trivially reproduce this using the example data from Solr 4.0-BETA, trunk@r1381400, and branch_4x@r1381400 (details in comment to follow)&lt;/p&gt;

&lt;p&gt;Important things to note from G&#252;nter&apos;s email thread with his assessment of the problem...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://mail-archives.apache.org/mod_mbox/lucene-solr-user/201208.mbox/%3CCAM_U7jfDpNrGfmWmNtNACHCDCJw4YB-rLBBvRW_WP_jdOb_cgw@mail.gmail.com%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://mail-archives.apache.org/mod_mbox/lucene-solr-user/201208.mbox/%3CCAM_U7jfDpNrGfmWmNtNACHCDCJw4YB-rLBBvRW_WP_jdOb_cgw@mail.gmail.com%3E&lt;/a&gt;&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The behaviour is not consistent. Some of the facets provide the correct result, some not.  What I can&apos;t say for sure: The behaviour was correct (if I&apos;m not wrong) once the whole index was newly created. After running some updates I got these results.&lt;/p&gt;&lt;/blockquote&gt;

&lt;blockquote&gt;&lt;p&gt;I&apos;m going to setup a new index with the Lucene 4.0 version from March (to be more exactly: it&apos;s version 4.0-2012-03-09_11-29-20) to see what are the results even in case of frequent updates ... the version deployed in march doesn&apos;t contain the error I now come across in Beta4.0 &lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="12606296">SOLR-3793</key>
            <summary>duplicate (deleted) documents included in result set when using field faceting with fq</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Wed, 5 Sep 2012 21:11:40 +0000</created>
                <updated>Fri, 10 May 2013 10:33:46 +0000</updated>
                            <resolved>Thu, 6 Sep 2012 12:36:22 +0000</resolved>
                                    <version>4.0-BETA</version>
                                    <fixVersion>4.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13449140" author="hossman" created="Wed, 5 Sep 2012 21:13:26 +0000"  >&lt;p&gt;Steps to reproduce...&lt;/p&gt;


&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;1) Start with a clean install of 4.0-BETA, containing a completley empty example index, and run solr...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example$ ls -a solr/collection1/data/
.  ..
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example$ java -jar start.jar 
2012-09-05 12:59:56.596:INFO:oejs.Server:jetty-8.1.2.v20120308
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2) In another window, index all sample documents...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ java -jar post.jar *.xml
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;3) Observe the results of a simple query faceting on &quot;cat&quot;, as well as the results of filtering on one of those cat values...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;wt=json&amp;amp;indent=true&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:2},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;wt=json&amp;amp;indent=true&amp;amp;fq=cat:electronics&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:8},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;4) Re-index some of the sample documents, forcing a new segment to be created, as well as some deletions...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ java -jar post.jar ipod_*S
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;5) observe that while the &quot;simple&quot; results are unchanged, the filtered request now includes duplicate (deleted?) documents in the result set...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;wt=json&amp;amp;indent=true&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:2},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;wt=json&amp;amp;indent=true&amp;amp;fq=cat:electronics&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:2},
  &quot;response&quot;:{&quot;numFound&quot;:6,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Interesting things to note...&lt;/p&gt;

&lt;p&gt;1) stoping &amp;amp; restarting jetty does not make the problem go away, which initially suggested to me that the problem is not related to any sort of stale-caching of filters/docsets &amp;#8211; however if you stop &amp;amp; restart jetty, or even just issue a commit, and then re-issue the same two requests in reverse order, then no duplicates are included.  do another commit, send the requests in the (original) problematic order and the problem re-appears...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;wt=json&amp;amp;indent=true&amp;amp;fq=cat:electronics&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:6},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;wt=json&amp;amp;indent=true&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:2},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ java -Ddata=args -jar post.jar &apos;&amp;lt;commit/&amp;gt;&apos;SimplePostTool version 1.5
POSTing args to http://localhost:8983/solr/update..
COMMITting Solr index changes to http://localhost:8983/solr/update..
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;wt=json&amp;amp;indent=true&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:2},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;wt=json&amp;amp;indent=true&amp;amp;fq=cat:electronics&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:3},
  &quot;response&quot;:{&quot;numFound&quot;:6,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,6,
        &quot;connector&quot;,4,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;2) Optimizing seems to eliminate the problem completley, suggesting that the root cause is definitely related to multiple segments containing deletions.&lt;/p&gt;

&lt;p&gt;3) Bizarely, the problem seems to be specific to faceting: using the same steps, with the same simple queries &amp;amp; fq, but leaving out the facet params, the duplicate documents are not returned...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ java -jar post.jar *.xml
...
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;wt=json&amp;amp;indent=true&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:13},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  }}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;wt=json&amp;amp;indent=true&amp;amp;fq=cat:electronics&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:10},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  }}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ java -jar post.jar ipod_*
...
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;wt=json&amp;amp;indent=true&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:2},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  }}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;wt=json&amp;amp;indent=true&amp;amp;fq=cat:electronics&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:3},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  }}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;




</comment>
                            <comment id="13449163" author="hossman" created="Wed, 5 Sep 2012 21:34:08 +0000"  >&lt;p&gt;The problem seems to be specific to using UnInvertedField via facet.method=fc for faceting, but only if you have not already used facet.method=enum (no idea how using UnInvertedField during the faceting could affect the total result set)...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ java -Ddata=args -jar post.jar &apos;&amp;lt;commit/&amp;gt;&apos;
SimplePostTool version 1.5
POSTing args to http://localhost:8983/solr/update..
COMMITting Solr index changes to http://localhost:8983/solr/update..
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;facet.method=enum&amp;amp;wt=json&amp;amp;indent=true&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:4},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;facet.method=enum&amp;amp;wt=json&amp;amp;indent=true&amp;amp;fq=cat:electronics&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:3},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;facet.method=fc&amp;amp;wt=json&amp;amp;indent=true&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:3},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;facet.method=fc&amp;amp;wt=json&amp;amp;indent=true&amp;amp;fq=cat:electronics&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:1},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ java -Ddata=args -jar post.jar &apos;&amp;lt;commit/&amp;gt;&apos;SimplePostTool version 1.5
POSTing args to http://localhost:8983/solr/update..
COMMITting Solr index changes to http://localhost:8983/solr/update..
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;facet.method=fc&amp;amp;wt=json&amp;amp;indent=true&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:5},
  &quot;response&quot;:{&quot;numFound&quot;:3,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,3,
        &quot;connector&quot;,2,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
hossman@frisbee:~/tmp/apache-solr-4.0.0-BETA/solr/example/exampledocs$ curl &apos;http://localhost:8983/solr/select?echoParams=none&amp;amp;q=ipod&amp;amp;rows=5&amp;amp;fl=id&amp;amp;facet=true&amp;amp;facet.field=cat&amp;amp;facet.mincount=1&amp;amp;facet.method=fc&amp;amp;wt=json&amp;amp;indent=true&amp;amp;fq=cat:electronics&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:2},
  &quot;response&quot;:{&quot;numFound&quot;:6,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;IW-02&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;F8V7067-APL-KIT&quot;},
      {
        &quot;id&quot;:&quot;MA147LL/A&quot;}]
  },
  &quot;facet_counts&quot;:{
    &quot;facet_queries&quot;:{},
    &quot;facet_fields&quot;:{
      &quot;cat&quot;:[
        &quot;electronics&quot;,6,
        &quot;connector&quot;,4,
        &quot;music&quot;,1]},
    &quot;facet_dates&quot;:{},
    &quot;facet_ranges&quot;:{}}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13449170" author="hossman" created="Wed, 5 Sep 2012 21:43:46 +0000"  >&lt;p&gt;confirmed this affects trunk &amp;amp; branch_4x&lt;/p&gt;</comment>
                            <comment id="13449581" author="yseeley@gmail.com" created="Thu, 6 Sep 2012 11:41:50 +0000"  >&lt;p&gt;Here&apos;s a patch to fix the problem.&lt;/p&gt;

&lt;p&gt;The issue was when UnInvertedField faceting cached big terms as filters, it failed to set/use liveDocs.  Later, an &quot;fq&quot; was used that retrieved the filter from the cache and used that filter as liveDocs, bringing deleted docs back from the dead. &lt;/p&gt;</comment>
                            <comment id="13449598" author="yseeley@gmail.com" created="Thu, 6 Sep 2012 12:36:22 +0000"  >&lt;p&gt;Committed to trunk and 4x&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?rev=1381568&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1381568&amp;amp;view=rev&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?rev=1381569&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1381569&amp;amp;view=rev&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13449609" author="guenterh" created="Thu, 6 Sep 2012 12:55:31 +0000"  >&lt;p&gt;Thanks Yonik,&lt;br/&gt;
I&apos;m going to test it with the upcoming nightly build&lt;br/&gt;
G&#252;nter&lt;/p&gt;</comment>
                            <comment id="13610907" author="commit-tag-bot" created="Fri, 22 Mar 2013 16:43:31 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Yonik Seeley&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1381569&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1381569&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3793&quot; title=&quot;duplicate (deleted) documents included in result set when using field faceting with fq&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3793&quot;&gt;&lt;del&gt;SOLR-3793&lt;/del&gt;&lt;/a&gt;: use livedocs when caching big terms&lt;/p&gt;</comment>
                            <comment id="13654022" author="thetaphi" created="Fri, 10 May 2013 10:33:46 +0000"  >&lt;p&gt;Closed after release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12544031" name="SOLR-3793.patch" size="3550" author="yseeley@gmail.com" created="Thu, 6 Sep 2012 11:41:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>243197</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03clj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17474</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>