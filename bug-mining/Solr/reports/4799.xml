<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:49:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-15558] Solr stop doesn&apos;t handle zombie processes</title>
                <link>https://issues.apache.org/jira/browse/SOLR-15558</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When calling solr stop on linux, this command is used&lt;br/&gt;
&lt;em&gt;CHECK_PID=`ps auxww | awk &apos;{print $2}&apos; | grep -w $SOLR_PID | sort -r | tr -d &apos; &apos;`&lt;/em&gt;&lt;br/&gt;
&lt;a href=&quot;https://github.com/apache/solr/blob/122c88a0748769432ef62cc3fb94c2226dd67aa7/solr/bin/solr#L871&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/blob/122c88a0748769432ef62cc3fb94c2226dd67aa7/solr/bin/solr#L871&lt;/a&gt;&lt;br/&gt;
&#160;&lt;br/&gt;
If Solr has stopped but remains as a zombie process then its process entry will remain in the table, so &lt;em&gt;ps auxww&lt;/em&gt; will continue to show the PID even after kill -9. So that results in something like this, with 3 minutes wasted waiting for a dead process to exit.&lt;br/&gt;
&#160;&lt;br/&gt;
&lt;em&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2021-07-21T09:15:12.365Z&amp;#93;&lt;/span&gt; Sending stop command to Solr running on port 8983 ... waiting up to 180 seconds to allow Jetty process 12622 to stop gracefully.&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2021-07-21T09:18:13.551Z&amp;#93;&lt;/span&gt;&#160; &lt;span class=&quot;error&quot;&gt;&amp;#91;|&amp;#93;&lt;/span&gt; Solr process 12622 is still running; jstacking it now.&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2021-07-21T09:18:21.806Z&amp;#93;&lt;/span&gt; 12622: Unable to open socket file /proc/12622/root/tmp/.java_pid12622: target process 12622 doesn&apos;t respond within 10500ms or HotSpot VM not loaded&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2021-07-21T09:18:21.806Z&amp;#93;&lt;/span&gt; Solr process 12622 is still running; forcefully killing it now.&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2021-07-21T09:18:21.806Z&amp;#93;&lt;/span&gt; Killed process 12622&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;2021-07-21T09:18:31.678Z&amp;#93;&lt;/span&gt; ERROR: Failed to kill previous Solr Java process 12622 ... script fails.&lt;/em&gt;&lt;br/&gt;
&#160;&lt;br/&gt;
But the output of ps auxww does identify Zombie processes under STAT:&lt;br/&gt;
&lt;em&gt;USER &#160; &#160; &#160; PID %CPU %MEM &#160; &#160;VSZ &#160; RSS TTY &#160; &#160; &#160;&lt;b&gt;STAT&lt;/b&gt; START &#160; TIME COMMAND&lt;/em&gt;&lt;br/&gt;
&lt;em&gt;root &#160; &#160;&#160;&#160;&#160;&#160;&#160; 12622&#160; 1.4 &#160;0.0 &#160; &#160; &#160; &#160; &#160; &#160;&#160; 0 &#160; &#160; 0&#160;&#160;&#160;&#160;&#160;&#160; pts/1 &#160; &#160; &lt;b&gt;Z&lt;/b&gt; &#160; &#160;10:42 &#160; 0:26 &lt;span class=&quot;error&quot;&gt;&amp;#91;java&amp;#93;&lt;/span&gt; &lt;b&gt;&amp;lt;defunct&amp;gt;&lt;/b&gt; &#160;&lt;/em&gt; &lt;br/&gt;
&#160;&lt;br/&gt;
So the CHECK_PID could filter out Zombies.&lt;br/&gt;
Obviously the bigger issue is why the process has ended up as a Zombie (in this case it was because of &lt;a href=&quot;https://blog.phusion.nl/2015/01/20/docker-and-the-pid-1-zombie-reaping-problem/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://blog.phusion.nl/2015/01/20/docker-and-the-pid-1-zombie-reaping-problem/&lt;/a&gt; and not specifying &quot;--init&quot; when running Solr inside a docker container) so maybe a message warning that the process is a zombie is worth having, so that the user has an opportunity to do something about it.&lt;br/&gt;
&#160;&lt;br/&gt;
Note from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mdrob&quot; class=&quot;user-hover&quot; rel=&quot;mdrob&quot;&gt;mdrob&lt;/a&gt;&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;That seems like a reasonable check to add, the only caution I would advise&lt;br/&gt;
is that a lot of developers use macs for local testing so make sure that&lt;br/&gt;
whatever flags you invoke are generally cross platform compatible, or&lt;br/&gt;
hidden behind appropriate conditions.&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="13391331">SOLR-15558</key>
            <summary>Solr stop doesn&apos;t handle zombie processes</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mdrob">Mike Drob</assignee>
                                    <reporter username="colvinco">Colvin Cowie</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Jul 2021 11:26:49 +0000</created>
                <updated>Tue, 8 Aug 2023 11:52:50 +0000</updated>
                            <resolved>Fri, 4 Feb 2022 19:19:03 +0000</resolved>
                                                    <fixVersion>9.0</fixVersion>
                    <fixVersion>8.11.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="6000">1h 40m</timespent>
                                <comments>
                            <comment id="17487128" author="mdrob" created="Fri, 4 Feb 2022 15:33:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=janhoy&quot; class=&quot;user-hover&quot; rel=&quot;janhoy&quot;&gt;janhoy&lt;/a&gt; - candidate for 9.0 (and 8.11.2 while we&apos;re at it)&lt;/p&gt;</comment>
                            <comment id="17487155" author="janhoy" created="Fri, 4 Feb 2022 16:16:37 +0000"  >&lt;p&gt;As long as this is tested on relevant platforms like macOS, Ubuntu, CentOS (do we support FreeBSD?), then go for it. I see you did some testing already. If we are unsure, target 9.1.&lt;/p&gt;</comment>
                            <comment id="17487251" author="jira-bot" created="Fri, 4 Feb 2022 19:14:06 +0000"  >&lt;p&gt;Commit c63be9cfb4e292768aa9a25ad26d360ff54fd5d3 in solr&apos;s branch refs/heads/main from Colvin Cowie&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=c63be9c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=c63be9c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15558&quot; title=&quot;Solr stop doesn&amp;#39;t handle zombie processes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15558&quot;&gt;&lt;del&gt;SOLR-15558&lt;/del&gt;&lt;/a&gt;: Identify zombie processes when stopping&lt;/p&gt;

&lt;p&gt;resolves #250&lt;/p&gt;</comment>
                            <comment id="17487252" author="jira-bot" created="Fri, 4 Feb 2022 19:14:09 +0000"  >&lt;p&gt;Commit 94fc474c6787caf3ad0ba3af0e828b4a03068df3 in solr&apos;s branch refs/heads/branch_9x from Colvin Cowie&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=94fc474&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=94fc474&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15558&quot; title=&quot;Solr stop doesn&amp;#39;t handle zombie processes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15558&quot;&gt;&lt;del&gt;SOLR-15558&lt;/del&gt;&lt;/a&gt;: Identify zombie processes when stopping&lt;/p&gt;

&lt;p&gt;resolves #250&lt;/p&gt;

&lt;p&gt;(cherry picked from commit c63be9cfb4e292768aa9a25ad26d360ff54fd5d3)&lt;/p&gt;</comment>
                            <comment id="17487253" author="jira-bot" created="Fri, 4 Feb 2022 19:14:11 +0000"  >&lt;p&gt;Commit 5328e3360d60c520d05cca149fe13e9533fc9106 in solr&apos;s branch refs/heads/branch_9_0 from Colvin Cowie&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=5328e33&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=5328e33&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15558&quot; title=&quot;Solr stop doesn&amp;#39;t handle zombie processes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15558&quot;&gt;&lt;del&gt;SOLR-15558&lt;/del&gt;&lt;/a&gt;: Identify zombie processes when stopping&lt;/p&gt;

&lt;p&gt;resolves #250&lt;/p&gt;

&lt;p&gt;(cherry picked from commit c63be9cfb4e292768aa9a25ad26d360ff54fd5d3)&lt;/p&gt;</comment>
                            <comment id="17487255" author="jira-bot" created="Fri, 4 Feb 2022 19:18:52 +0000"  >&lt;p&gt;Commit ab67f9f648a5aa281f9ae4369c0fad795ff15e04 in lucene-solr&apos;s branch refs/heads/branch_8_11 from Colvin Cowie&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=ab67f9f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=ab67f9f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15558&quot; title=&quot;Solr stop doesn&amp;#39;t handle zombie processes&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15558&quot;&gt;&lt;del&gt;SOLR-15558&lt;/del&gt;&lt;/a&gt;: Identify zombie processes when stopping&lt;/p&gt;

&lt;p&gt;resolves #250&lt;/p&gt;

&lt;p&gt;(cherry picked from commit c63be9cfb4e292768aa9a25ad26d360ff54fd5d3)&lt;/p&gt;</comment>
                            <comment id="17487256" author="mdrob" created="Fri, 4 Feb 2022 19:21:07 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cjcowie&quot; class=&quot;user-hover&quot; rel=&quot;cjcowie&quot;&gt;cjcowie&lt;/a&gt; - thanks for the patch, I&apos;ve committed this to our 9.0 and potential 8.11.2 release lines.&lt;/p&gt;</comment>
                            <comment id="17535577" author="janhoy" created="Thu, 12 May 2022 00:26:43 +0000"  >&lt;p&gt;Closing after the 9.0.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13444194">SOLR-16191</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0t8ig:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>