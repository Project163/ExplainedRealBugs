<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:12:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-8864] TestTestInjection needs to cleanup after itself -- causes TestCloudDeleteByQuery fail (may be symptom of larger problem?)</title>
                <link>https://issues.apache.org/jira/browse/SOLR-8864</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;&lt;a href=&quot;https://builds.apache.org/job/Lucene-Solr-Tests-6.x/65/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Lucene-Solr-Tests-6.x/65/&lt;/a&gt; recently reported a failure from TestCloudDeleteByQuery&apos;s init methods that made no sense to me &amp;#8211; looking at the logs showed an error from &quot;TestInjection.parseValue&quot; even though this test doesn&apos;t do anything to setup TestInjection...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; 527801 ERROR (qtp1490160324-5239) [n:127.0.0.1:48763_solr c:test_col s:shard1 r:core_node4 x:test_col_shard1_replica2] o.a.s.h.RequestHandlerBase java.lang.RuntimeException: No match, probably bad syntax: TRUE:0:
   [junit4]   2&amp;gt; 	at org.apache.solr.util.TestInjection.parseValue(TestInjection.java:236)
   [junit4]   2&amp;gt; 	at org.apache.solr.util.TestInjection.injectFailReplicaRequests(TestInjection.java:159)
   [junit4]   2&amp;gt; 	at org.apache.solr.update.processor.DistributedUpdateProcessor.setupRequest(DistributedUpdateProcessor.java:356)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...the immediate problem seems to be that TestTestInjection doesn&apos;t do anything to cleanup after itself (it never calls &lt;tt&gt;TestInjection.reset()&lt;/tt&gt;, and doesn&apos;t subclass SolrTestCaseJ4) but i&apos;m surprised this hasn&apos;t caused a lot more weird failures since this test was added back in december &amp;#8211; i wonder if this this &quot;bad syntax&quot; RuntimeException, when injected into the distributed updates, isn&apos;t causing a problem in most cases because of leader initiated recovery, but maybe something specific about the codepaths used in TestCloudDeleteByQuery (which is only a few weeks old) don&apos;t work.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12951044">SOLR-8864</key>
            <summary>TestTestInjection needs to cleanup after itself -- causes TestCloudDeleteByQuery fail (may be symptom of larger problem?)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Mar 2016 00:18:49 +0000</created>
                <updated>Fri, 17 Jun 2016 13:11:23 +0000</updated>
                            <resolved>Wed, 30 Mar 2016 16:37:06 +0000</resolved>
                                                    <fixVersion>6.1</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="15198471" author="hossman" created="Thu, 17 Mar 2016 00:21:59 +0000"  >&lt;p&gt;attaching full jenkins log from &lt;a href=&quot;https://builds.apache.org/job/Lucene-Solr-Tests-6.x/65/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://builds.apache.org/job/Lucene-Solr-Tests-6.x/65/&lt;/a&gt; (branch_6x @ 7687667b5ff7867249762d104707a91834d30ce3) ...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;  [junit4]   2&amp;gt; NOTE: test params are: codec=Asserting(Lucene60): {expected_shard_s=FSTOrd50, _version_=FST50,
id=FSTOrd50}, docValues:{}, maxPointsInLeafNode=212, maxMBSortInHeap=5.567883717673721, sim=ClassicSimilarity,
locale=pl, timezone=America/Mendoza
   [junit4]   2&amp;gt; NOTE: Linux 3.13.0-52-generic amd64/Oracle Corporation 1.8.0_66
(64-bit)/cpus=4,threads=1,free=304603432,total=524812288
   [junit4]   2&amp;gt; NOTE: All tests run in this JVM: [ReplicationFactorTest, TestRuleBasedAuthorizationPlugin,
TestSchemaVersionResource, TestSweetSpotSimilarityFactory, SuggesterWFSTTest, TestCharFilters, TestCoreDiscovery,
DirectUpdateHandlerTest, TestConfigOverlay, TestStandardQParsers, GraphQueryTest, StressHdfsTest,
CurrencyFieldXmlFileTest, StatelessScriptUpdateProcessorFactoryTest, TestSolrQueryParserResource, RecoveryZkTest,
TestRecovery, SuggesterTest, TestFastWriter, VMParamsZkACLAndCredentialsProvidersTest,
FieldAnalysisRequestHandlerTest, TestStressReorder, BitVectorTest, DistributedFacetPivotSmallAdvancedTest,
StatsComponentTest, DirectSolrConnectionTest, SolrTestCaseJ4Test, DirectUpdateHandlerOptimizeTest,
TestPivotHelperCode, IgnoreCommitOptimizeUpdateProcessorFactoryTest, FacetPivotSmallTest,
ClassificationUpdateProcessorFactoryTest, SharedFSAutoReplicaFailoverTest, BadIndexSchemaTest,
HLLSerializationTest, TestFuzzyAnalyzedSuggestions, SortSpecParsingTest, HardAutoCommitTest, UpdateParamsTest,
RegexBoostProcessorTest, SliceStateTest, TestSolrQueryParser, TestSchemaNameResource, SolrCloudExampleTest,
TestDocBasedVersionConstraints, TestRebalanceLeaders, TestIndexSearcher, SpatialRPTFieldTypeTest,
TestSimpleQParserPlugin, ConnectionManagerTest, CoreAdminHandlerTest, ZkStateWriterTest, TestExtendedDismaxParser,
TestFieldResource, DeleteLastCustomShardedReplicaTest, TestReqParamsAPI, TestSolrDynamicMBean, BlockCacheTest,
XmlUpdateRequestHandlerTest, TestNamedUpdateProcessors, BinaryUpdateRequestHandlerTest, UnloadDistributedZkTest,
SSLMigrationTest, TestJsonRequest, TestObjectReleaseTracker, LeaderInitiatedRecoveryOnCommitTest,
DebugComponentTest, TestSolrIndexConfig, TestManagedResourceStorage, TestCSVResponseWriter,
TestPostingsSolrHighlighter, SampleTest, TestSolrQueryResponse, HighlighterMaxOffsetTest, TestTestInjection,
HdfsTlogReplayBufferedWhileIndexingTest, TestCloudDeleteByQuery]
   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=TestCloudDeleteByQuery -Dtests.seed=F6D0A21946A344B8
-Dtests.multiplier=2 -Dtests.slow=true -Dtests.locale=pl -Dtests.timezone=America/Mendoza -Dtests.asserts=true
-Dtests.file.encoding=ISO-8859-1
   [junit4] ERROR   0.00s J2 | TestCloudDeleteByQuery (suite) &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: expected:&amp;lt;2&amp;gt; but was:&amp;lt;1&amp;gt;
   [junit4]    &amp;gt;        at __randomizedtesting.SeedInfo.seed([F6D0A21946A344B8]:0)
   [junit4]    &amp;gt;        at
org.apache.solr.cloud.TestCloudDeleteByQuery.createMiniSolrCloudCluster(TestCloudDeleteByQuery.java:173)
   [junit4]    &amp;gt;        at java.lang.Thread.run(Thread.java:745)
   [junit4] Completed [191/581 (1!)] on J2 in 15.37s, 0 tests, 1 failure &amp;lt;&amp;lt;&amp;lt; FAILURES!
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;FWIW, even when i tried adding this code to TestCloudDeleteByQuery on branch_6x i couldn&apos;t get that reproduce line to fail...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; {
    &lt;span class=&quot;code-comment&quot;&gt;// nocommit:
&lt;/span&gt;    org.apache.solr.util.TestInjection.failReplicaRequests = &lt;span class=&quot;code-quote&quot;&gt;&quot;BADSYNTAX&quot;&lt;/span&gt;;
  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; - can you take a look?&lt;/p&gt;
</comment>
                            <comment id="15199434" author="markrmiller@gmail.com" created="Thu, 17 Mar 2016 12:44:22 +0000"  >&lt;blockquote&gt;&lt;p&gt;but i&apos;m surprised this hasn&apos;t caused a lot more weird failures since this test was added back in december&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;perhaps just hard to spot - only takes one successful SolrTestCaseJ4 run after to clear it.&lt;/p&gt;</comment>
                            <comment id="15218269" author="jira-bot" created="Wed, 30 Mar 2016 16:33:26 +0000"  >&lt;p&gt;Commit 34180ad5c358dc06ae8d1149a41aa9d9ab383ca8 in lucene-solr&apos;s branch refs/heads/master from markrmiller&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=34180ad&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=34180ad&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8864&quot; title=&quot;TestTestInjection needs to cleanup after itself -- causes TestCloudDeleteByQuery fail (may be symptom of larger problem?)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8864&quot;&gt;&lt;del&gt;SOLR-8864&lt;/del&gt;&lt;/a&gt;: TestTestInjection needs to cleanup after itself.&lt;/p&gt;</comment>
                            <comment id="15218275" author="jira-bot" created="Wed, 30 Mar 2016 16:35:51 +0000"  >&lt;p&gt;Commit 28a51cef56dfc43a935590e57c7cbdc8f84a30ef in lucene-solr&apos;s branch refs/heads/branch_6x from markrmiller&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=28a51ce&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=28a51ce&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8864&quot; title=&quot;TestTestInjection needs to cleanup after itself -- causes TestCloudDeleteByQuery fail (may be symptom of larger problem?)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8864&quot;&gt;&lt;del&gt;SOLR-8864&lt;/del&gt;&lt;/a&gt;: TestTestInjection needs to cleanup after itself.&lt;/p&gt;</comment>
                            <comment id="15278961" author="hossman" created="Tue, 10 May 2016 21:21:10 +0000"  >
&lt;p&gt;Manually correcting fixVersion per Step #S5 of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-7271&quot; title=&quot;Cleanup jira&amp;#39;s concept of &amp;#39;master&amp;#39; and &amp;#39;6.0&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-7271&quot;&gt;&lt;del&gt;LUCENE-7271&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12793889" name="jenkins.log" size="963829" author="hossman" created="Thu, 17 Mar 2016 00:21:59 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 28 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ustb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>