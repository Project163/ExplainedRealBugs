<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:56:36 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-6024] StatsComponent does not work for docValues enabled multiValued fields</title>
                <link>https://issues.apache.org/jira/browse/SOLR-6024</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Harish Agarwal reported this in solr user mailing list : &lt;a href=&quot;http://search-lucene.com/m/QTPaoTJXV1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://search-lucene.com/m/QTPaoTJXV1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It is east to re-produce with default example solr setup. Following types are added example schema.xml. And exampledocs are indexed.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt; &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;cat&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt; indexed=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt; stored=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt; docValues=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt; multiValued=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;field name=&lt;span class=&quot;code-quote&quot;&gt;&quot;popularity&quot;&lt;/span&gt; type=&lt;span class=&quot;code-quote&quot;&gt;&quot;int&quot;&lt;/span&gt; indexed=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt; stored=&lt;span class=&quot;code-quote&quot;&gt;&quot;false&quot;&lt;/span&gt; docValues=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt; multiValued=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;When &lt;tt&gt;docValues=&quot;true&quot;&lt;/tt&gt; &lt;b&gt;and&lt;/b&gt; &lt;tt&gt;multiValued=&quot;true&quot;&lt;/tt&gt; are used at the same time, StatsComponent throws :&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR org.apache.solr.core.SolrCore  &#8211; org.apache.solr.common.SolrException: Type mismatch: popularity was indexed as SORTED_SET
	at org.apache.solr.request.UnInvertedField.&amp;lt;init&amp;gt;(UnInvertedField.java:193)
	at org.apache.solr.request.UnInvertedField.getUnInvertedField(UnInvertedField.java:699)
	at org.apache.solr.handler.component.SimpleStats.getStatsFields(StatsComponent.java:319)
	at org.apache.solr.handler.component.SimpleStats.getStatsCounts(StatsComponent.java:290)
	at org.apache.solr.handler.component.StatsComponent.process(StatsComponent.java:78)
	at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:221)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:1964)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;java version &quot;1.7.0_45&quot;&lt;br/&gt;
Mac OS X Version 10.7.5&lt;/p&gt;</environment>
        <key id="12710788">SOLR-6024</key>
            <summary>StatsComponent does not work for docValues enabled multiValued fields</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tflobbe">Tomas Eduardo Fernandez Lobbe</assignee>
                                    <reporter username="iorixxx">Ahmet Arslan</reporter>
                        <labels>
                            <label>StatsComponent</label>
                            <label>docValues</label>
                            <label>multiValued</label>
                    </labels>
                <created>Sun, 27 Apr 2014 14:21:37 +0000</created>
                <updated>Mon, 9 May 2016 18:46:22 +0000</updated>
                            <resolved>Thu, 4 Sep 2014 18:33:15 +0000</resolved>
                                    <version>4.8</version>
                                    <fixVersion>4.10.1</fixVersion>
                    <fixVersion>5.0</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SearchComponents - other</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="13982337" author="iorixxx" created="Sun, 27 Apr 2014 14:24:51 +0000"  >&lt;p&gt;Here are the search URLs that produce error message:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;http://localhost:8983/solr/collection1/select?stats=true&amp;amp;stats.field=popularity&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/collection1/select?stats=true&amp;amp;stats.field=popularity&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://localhost:8983/solr/collection1/select?stats=true&amp;amp;stats.field=cat&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/collection1/select?stats=true&amp;amp;stats.field=cat&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14099995" author="vzhovtiuk" created="Sun, 17 Aug 2014 17:27:26 +0000"  >&lt;p&gt;Issue reproduced in solr-4.9.0.&lt;br/&gt;
Issue not reproduced on trunk, attached test in patch don&apos;t get exception on query.&lt;br/&gt;
UnInvertedField invokation was removed in rev:&lt;br/&gt;
1595259	5/16/14 6:39 PM	rmuir		1594441, 1593789	&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-5666&quot; title=&quot;Add UninvertingReader&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-5666&quot;&gt;&lt;del&gt;LUCENE-5666&lt;/del&gt;&lt;/a&gt;: Add UninvertingReader&lt;/p&gt;</comment>
                            <comment id="14108500" author="vzhovtiuk" created="Sun, 24 Aug 2014 19:13:52 +0000"  >&lt;p&gt;Added patch based for lucene_solr_4_9 branch fixing issue,&lt;br/&gt;
for fields having docValues called org.apache.solr.request.DocValuesStats#getCounts from rev. 1595259 and UnInvertedField in other cases.&lt;/p&gt;</comment>
                            <comment id="14110959" author="tomasflobbe" created="Tue, 26 Aug 2014 17:09:50 +0000"  >&lt;p&gt;The added test fails if the codec is Lucene 4.0. Tested this on branch_4x and trunk:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4] ERROR   0.22s | StatsComponentTest.testFieldStatisticsDocValuesAndMultiValued &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: org.apache.solr.common.SolrException: java.lang.UnsupportedOperationException: Lucene 4.0 does not support SortedSet docvalues
   [junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([D7B0D3D7FE664ABF:A5CE511C61788BCE]:0)
   [junit4]    &amp;gt; 	at org.apache.solr.util.TestHarness.update(TestHarness.java:247)
   [junit4]    &amp;gt; 	at org.apache.solr.util.BaseTestHarness.checkUpdateStatus(BaseTestHarness.java:282)
   [junit4]    &amp;gt; 	at org.apache.solr.util.BaseTestHarness.validateUpdate(BaseTestHarness.java:252)
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.checkUpdateU(SolrTestCaseJ4.java:676)
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertU(SolrTestCaseJ4.java:655)
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertU(SolrTestCaseJ4.java:649)
   [junit4]    &amp;gt; 	at org.apache.solr.handler.component.StatsComponentTest.testFieldStatisticsDocValuesAndMultiValued(StatsComponentTest.java:449)
   [junit4]    &amp;gt; 	at java.lang.Thread.run(Thread.java:745)
   [junit4]    &amp;gt; Caused by: java.lang.UnsupportedOperationException: Lucene 4.0 does not support SortedSet docvalues
   [junit4]    &amp;gt; 	at org.apache.lucene.codecs.lucene40.Lucene40DocValuesWriter.addSortedSetField(Lucene40DocValuesWriter.java:540)
   [junit4]    &amp;gt; 	at org.apache.lucene.index.SortedSetDocValuesWriter.flush(SortedSetDocValuesWriter.java:164)
   [junit4]    &amp;gt; 	at org.apache.lucene.index.DefaultIndexingChain.writeDocValues(DefaultIndexingChain.java:142)
   [junit4]    &amp;gt; 	at org.apache.lucene.index.DefaultIndexingChain.flush(DefaultIndexingChain.java:96)
   [junit4]    &amp;gt; 	at org.apache.lucene.index.DocumentsWriterPerThread.flush(DocumentsWriterPerThread.java:442)
   [junit4]    &amp;gt; 	at org.apache.lucene.index.DocumentsWriter.doFlush(DocumentsWriter.java:510)
   [junit4]    &amp;gt; 	at org.apache.lucene.index.DocumentsWriter.flushAllThreads(DocumentsWriter.java:621)
   [junit4]    &amp;gt; 	at org.apache.lucene.index.IndexWriter.prepareCommitInternal(IndexWriter.java:2793)
   [junit4]    &amp;gt; 	at org.apache.lucene.index.IndexWriter.commitInternal(IndexWriter.java:2952)
   [junit4]    &amp;gt; 	at org.apache.lucene.index.IndexWriter.commit(IndexWriter.java:2919)
   [junit4]    &amp;gt; 	at org.apache.solr.update.DirectUpdateHandler2.commit(DirectUpdateHandler2.java:582)
   [junit4]    &amp;gt; 	at org.apache.solr.update.processor.RunUpdateProcessor.processCommit(RunUpdateProcessorFactory.java:95)
   [junit4]    &amp;gt; 	at org.apache.solr.update.processor.UpdateRequestProcessor.processCommit(UpdateRequestProcessor.java:64)
   [junit4]    &amp;gt; 	at org.apache.solr.update.processor.DistributedUpdateProcessor.doLocalCommit(DistributedUpdateProcessor.java:1650)
   [junit4]    &amp;gt; 	at org.apache.solr.update.processor.DistributedUpdateProcessor.processCommit(DistributedUpdateProcessor.java:1627)
   [junit4]    &amp;gt; 	at org.apache.solr.update.processor.LogUpdateProcessor.processCommit(LogUpdateProcessorFactory.java:157)
   [junit4]    &amp;gt; 	at org.apache.solr.handler.loader.XMLLoader.processUpdate(XMLLoader.java:267)
   [junit4]    &amp;gt; 	at org.apache.solr.handler.loader.XMLLoader.load(XMLLoader.java:174)
   [junit4]    &amp;gt; 	at org.apache.solr.handler.UpdateRequestHandler$1.load(UpdateRequestHandler.java:99)
   [junit4]    &amp;gt; 	at org.apache.solr.handler.ContentStreamHandlerBase.handleRequestBody(ContentStreamHandlerBase.java:74)
   [junit4]    &amp;gt; 	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135)
   [junit4]    &amp;gt; 	at org.apache.solr.core.SolrCore.execute(SolrCore.java:1985)
   [junit4]    &amp;gt; 	at org.apache.solr.servlet.DirectSolrConnection.request(DirectSolrConnection.java:131)
   [junit4]    &amp;gt; 	at org.apache.solr.util.TestHarness.update(TestHarness.java:243)
   [junit4]    &amp;gt; 	... 46 more
   [junit4]   2&amp;gt; 19528 T11 oas.SolrTestCaseJ4.deleteCore ###deleteCore

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14111278" author="tomasflobbe" created="Tue, 26 Aug 2014 20:34:11 +0000"  >&lt;p&gt;Patch for trunk. Adds &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vzhovtiuk&quot; class=&quot;user-hover&quot; rel=&quot;vzhovtiuk&quot;&gt;vzhovtiuk&lt;/a&gt;&apos;s test and suppress codec Lucene 4.0 in the test. &lt;/p&gt;</comment>
                            <comment id="14111410" author="tomasflobbe" created="Tue, 26 Aug 2014 21:58:23 +0000"  >&lt;p&gt;Added docValues fields for testing in trunk&lt;/p&gt;</comment>
                            <comment id="14112442" author="tomasflobbe" created="Wed, 27 Aug 2014 16:59:03 +0000"  >&lt;p&gt;The test I added can fail in trunk when using a codec older than Lucene 4.5 because of missing values.&lt;/p&gt;</comment>
                            <comment id="14114071" author="tomasflobbe" created="Thu, 28 Aug 2014 18:05:34 +0000"  >&lt;p&gt;Suppressing codecs older than Lucene 4.5&lt;/p&gt;</comment>
                            <comment id="14114082" author="hossman" created="Thu, 28 Aug 2014 18:10:52 +0000"  >&lt;p&gt;ok ... so from an svn management standpoint, it looks like the cleanest thing to do is backport all of the commits to DocValuesStats.java from trunk to the 4x branch (r1594441, r1594445, r1595259, r1600688, r1602997), combined with your modified version of StatsComponent.java to still conditionally use UnInvertedField.&lt;/p&gt;

&lt;p&gt;i&apos;m still not really comfortable calling this bug &quot;fixed&quot; w/o more tests thought &amp;#8211; in particular there is already plumbing in StatsComponentTest.doTestMVFieldStatisticsResult for testing that multivalued field stats &amp;#8211; we need to add multivalued=true+docValue=true+indexed=false versions of all the Trie types to the test schema and ensure that method works for them.&lt;/p&gt;

&lt;p&gt;(we should also reach down into the schema like testStatsFacetMultivaluedErrorHandling() does to assert the SchemaField objects have all the properties we expect to help ensure no one changes the docValues or indexed setting and invalidates the test)&lt;/p&gt;

&lt;p&gt;and of course: we should commit the tests to trunk and then backport to 4x.&lt;/p&gt;</comment>
                            <comment id="14114098" author="tomasflobbe" created="Thu, 28 Aug 2014 18:17:50 +0000"  >&lt;blockquote&gt;&lt;p&gt;ok ... so from an svn management standpoint, it looks like the cleanest thing to do is backport all of the commits to DocValuesStats.java from trunk to the 4x branch (r1594441, r1594445, r1595259, r1600688, r1602997), combined with your modified version of StatsComponent.java to still conditionally use UnInvertedField.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I see, I was going to ask what was the best way to bring the DocValuesStats class, it has been in trunk for long now. &lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;and of course: we should commit the tests to trunk and then backport to 4x.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Yes, that was why I was adding the &quot;-trunk&quot; patches. &lt;/p&gt;</comment>
                            <comment id="14114125" author="tomasflobbe" created="Thu, 28 Aug 2014 18:32:20 +0000"  >&lt;blockquote&gt;&lt;p&gt;we need to add multivalued=true+docValue=true+indexed=false versions&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The &quot;missing&quot; stat won&apos;t work with this configuration (on trunk). It&apos;s being calculated as: &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;DocSet missing = docs.andNot( searcher.getDocSet(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; TermRangeQuery(fieldName, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;, &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)));
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14114479" author="hossman" created="Thu, 28 Aug 2014 22:22:33 +0000"  >&lt;p&gt;Ok &amp;#8211; totally ignore my last comment.  aparently i had a stale copy of this page open in my browser, and didn&apos;t see any of tomas&apos;s updates to this issue after Vitaliy&apos;s last patch.&lt;/p&gt;

&lt;p&gt;i haven&apos;t looked closely yet, but at first glance Tomas&apos;s patch looks like most likely adds all the test concerns i had.&lt;/p&gt;</comment>
                            <comment id="14114493" author="hossman" created="Thu, 28 Aug 2014 22:30:14 +0000"  >&lt;p&gt;Gah!  .... I don&apos;t know what&apos;s up with my browser, because it just happened again (firefox doesn&apos;t like tomas!)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Yes, that was why I was adding the &quot;-trunk&quot; patches. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah ... i think it makes sense to focus on adding test coverage to trunk (and ferreting out any subtle bugs we&apos;ve been missing due to the lack of test coverate) and then worry about backporting the individual changes to 4x and manually applying the neccessary StatsComponent.java change to conditionally use UnInvertedField when needed.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The &quot;missing&quot; stat won&apos;t work with this configuration (on trunk). It&apos;s being calculated as: &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;isn&apos;t that a bug then?  we should definitely be able to get &quot;missing&quot; info from the DocValues API, and we should use it instead of depending on indexed=true for a docValues field. right?&lt;/p&gt;</comment>
                            <comment id="14115472" author="tomasflobbe" created="Fri, 29 Aug 2014 17:00:44 +0000"  >&lt;blockquote&gt;&lt;p&gt;isn&apos;t that a bug then?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think it is. I&apos;d tackle that in a different Jira, it has a workaround (use index=true) and it reproduces in trunk (unlike the issue described here). &lt;br/&gt;
After a quick look, I think it would be easy to count the missing values for the complete field, but not trivial to count the missing values when using &quot;stats.facet&quot; (for each different value)&lt;/p&gt;</comment>
                            <comment id="14115542" author="tomasflobbe" created="Fri, 29 Aug 2014 17:39:23 +0000"  >&lt;p&gt;I created &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6452&quot; title=&quot;StatsComponent &amp;quot;missing&amp;quot; stat won&amp;#39;t work with docValues=true and indexed=false&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6452&quot;&gt;&lt;del&gt;SOLR-6452&lt;/del&gt;&lt;/a&gt; for the bug with the &quot;missing&quot; stat&lt;/p&gt;</comment>
                            <comment id="14115585" author="tomasflobbe" created="Fri, 29 Aug 2014 17:56:17 +0000"  >&lt;p&gt;Added preconditions to the new test. &lt;br/&gt;
Test for docValues=true &amp;amp; indexed=false (commented out for now)&lt;/p&gt;</comment>
                            <comment id="14116897" author="vzhovtiuk" created="Sun, 31 Aug 2014 21:14:40 +0000"  >&lt;p&gt;Patch based on latest added trunk patch.&lt;br/&gt;
Added stats calculation tests for docValues and multiValued fields of float and integer numeric types, added calculate distinct count, added stats.facet query on docValues field (leads to field type exception) &lt;/p&gt;</comment>
                            <comment id="14120748" author="hossman" created="Thu, 4 Sep 2014 00:18:57 +0000"  >&lt;p&gt;tests looks good, precommit looks fine ... i tried to ping tomas earlier asking if he wanted ot commit and deal with the backpot or not but i don&apos;t think he saw it so i&apos;m going to go ahead and commit to trunk and look into doing the backport &amp;amp; fix on 4.x&lt;/p&gt;</comment>
                            <comment id="14120750" author="jira-bot" created="Thu, 4 Sep 2014 00:19:57 +0000"  >&lt;p&gt;Commit 1622386 from hossman@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1622386&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1622386&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6024&quot; title=&quot;StatsComponent does not work for docValues enabled multiValued fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6024&quot;&gt;&lt;del&gt;SOLR-6024&lt;/del&gt;&lt;/a&gt;: Fix StatsComponent when using docValues=true multiValued=true (bug only on 4x trunk commit is just test changes demonstrating correct behavior)&lt;/p&gt;</comment>
                            <comment id="14120775" author="hossman" created="Thu, 4 Sep 2014 00:51:23 +0000"  >&lt;p&gt;schema11.xml backport is pretty hairy due to divergence between trunk &amp;amp; 4x (removing deprecated types) and then trunk re-adding fieldTypes with the same name as old types.&lt;/p&gt;

&lt;p&gt;going to leave this alone for now and pick it back up tomorow - tomas said on IRC he might take a look at it first, we may wind up doing a tag team backport.&lt;/p&gt;</comment>
                            <comment id="14120978" author="tomasflobbe" created="Thu, 4 Sep 2014 05:41:22 +0000"  >&lt;p&gt;This patch includes the last changes in trunk plus the changes needed for branch 4x. &lt;br/&gt;
It also include DocValuesStats (should probably be merged from trunk instead)&lt;/p&gt;</comment>
                            <comment id="14121632" author="hossman" created="Thu, 4 Sep 2014 17:40:23 +0000"  >&lt;blockquote&gt;&lt;p&gt;This patch includes the last changes in trunk plus the changes needed for branch 4x.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;It also include DocValuesStats (should probably be merged from trunk instead)&lt;/p&gt;

&lt;p&gt;thanks tomas, looks good to me - currently running precommit (and another round of tests just to be safe) on 4x and then i&apos;ll commit.&lt;/p&gt;

&lt;p&gt;FWIW, here&apos;s my backporting steps...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;# NOTE: working dir is 4x checkout, ../dev is trunk checkout...

svn merge -c 1622386 ../dev/

# manually massaged schema11.xml, StatsComponent.java per Tomas&apos;s 4x patch
# confirm all tests *except* the new StatsComponentTest pass

# manually copy DocValuesStats.java from Tomas&apos;s 4x patch
# confirm StatsComponentTest passes now

svn add solr/core/src/java/org/apache/solr/request/DocValuesStats.java

svn merge --record-only -c 1594441 ../dev solr/core/src/java/org/apache/solr/request/DocValuesStats.java
svn merge --record-only -c 1594445 ../dev solr/core/src/java/org/apache/solr/request/DocValuesStats.java
svn merge --record-only -c 1595259 ../dev solr/core/src/java/org/apache/solr/request/DocValuesStats.java
svn merge --record-only -c 1600688 ../dev solr/core/src/java/org/apache/solr/request/DocValuesStats.java
svn merge --record-only -c 1602997 ../dev solr/core/src/java/org/apache/solr/request/DocValuesStats.java
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="14121726" author="jira-bot" created="Thu, 4 Sep 2014 18:31:34 +0000"  >&lt;p&gt;Commit 1622525 from hossman@apache.org in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1622525&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1622525&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6024&quot; title=&quot;StatsComponent does not work for docValues enabled multiValued fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6024&quot;&gt;&lt;del&gt;SOLR-6024&lt;/del&gt;&lt;/a&gt;: Fix StatsComponent when using docValues=true multiValued=true (merge r1622386, and DocValuesStats.java specific changes from r1594441, r1594445, r1595259, r1600688, r1602997)&lt;/p&gt;</comment>
                            <comment id="14121728" author="hossman" created="Thu, 4 Sep 2014 18:33:15 +0000"  >&lt;p&gt;I think we&apos;re all good.&lt;/p&gt;</comment>
                            <comment id="14128936" author="jira-bot" created="Wed, 10 Sep 2014 19:08:07 +0000"  >&lt;p&gt;Commit 1624097 from hossman@apache.org in branch &apos;dev/branches/lucene_solr_4_10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1624097&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1624097&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6024&quot; title=&quot;StatsComponent does not work for docValues enabled multiValued fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6024&quot;&gt;&lt;del&gt;SOLR-6024&lt;/del&gt;&lt;/a&gt;: Fix StatsComponent when using docValues=true multiValued=true (merge r1622525)&lt;/p&gt;</comment>
                            <comment id="14151031" author="mikemccand" created="Sun, 28 Sep 2014 09:03:52 +0000"  >&lt;p&gt;Bulk close for Lucene/Solr 4.10.1 release&lt;/p&gt;</comment>
                            <comment id="14267630" author="elrand" created="Wed, 7 Jan 2015 13:45:28 +0000"  >&lt;p&gt;Hi All,&lt;/p&gt;

&lt;p&gt;I am trying to apply this patch on Solr 4.8.&lt;br/&gt;
I have compilation problems with the class DocValuesStats.&lt;br/&gt;
I get the following errors:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; Failed to execute goal org.apache.maven.plugins:maven-compiler-plugin:3.1:compile (default-compile) on project solr-core: Compilation failure: Compilation failure:&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; /D:/ckp/src/solr_4.8/solr/core/src/java/org/apache/solr/request/DocValuesStats.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;88,21&amp;#93;&lt;/span&gt; cannot find symbol&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; symbol:   method emptySortedSet()&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; location: class org.apache.lucene.index.DocValues&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; /D:/ckp/src/solr_4.8/solr/core/src/java/org/apache/solr/request/DocValuesStats.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;116,28&amp;#93;&lt;/span&gt; cannot find symbol&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; symbol:   method emptySortedSet()&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; location: class org.apache.lucene.index.DocValues&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; /D:/ckp/src/solr_4.8/solr/core/src/java/org/apache/solr/request/DocValuesStats.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;128,28&amp;#93;&lt;/span&gt; cannot find symbol&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; symbol:   method emptySorted()&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; location: class org.apache.lucene.index.DocValues&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; /D:/ckp/src/solr_4.8/solr/core/src/java/org/apache/solr/request/DocValuesStats.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;139,34&amp;#93;&lt;/span&gt; method lookupOrd in class org.apache.lucene.index.SortedSetDocValues cannot be applied to given types;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; required: long,org.apache.lucene.util.BytesRef&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; found: int&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; reason: actual and formal argument lists differ in length&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; /D:/ckp/src/solr_4.8/solr/core/src/java/org/apache/solr/request/DocValuesStats.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;165,55&amp;#93;&lt;/span&gt; cannot find symbol&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; symbol:   method getGlobalOrds(int)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; location: variable map of type org.apache.lucene.index.MultiDocValues.OrdinalMap&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; /D:/ckp/src/solr_4.8/solr/core/src/java/org/apache/solr/request/DocValuesStats.java:&lt;span class=&quot;error&quot;&gt;&amp;#91;183,55&amp;#93;&lt;/span&gt; cannot find symbol&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; symbol:   method getGlobalOrds(int)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;ERROR&amp;#93;&lt;/span&gt; location: variable map of type org.apache.lucene.index.MultiDocValues.OrdinalMap&lt;/p&gt;

&lt;p&gt;I guess these methods are implemented in newer versions of Solr/lucene.&lt;/p&gt;

&lt;p&gt;How can I fix it in 4.8?&lt;br/&gt;
What is the oldest version the patch can be applied to?&lt;/p&gt;

&lt;p&gt;Thank you very much. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12765349">SOLR-6921</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12737856">SOLR-6452</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12666420" name="SOLR-6024-branch_4x.patch" size="37921" author="tflobbe" created="Thu, 4 Sep 2014 05:41:22 +0000"/>
                            <attachment id="12665681" name="SOLR-6024-trunk.patch" size="25489" author="vzhovtiuk" created="Sun, 31 Aug 2014 21:14:40 +0000"/>
                            <attachment id="12665377" name="SOLR-6024-trunk.patch" size="18733" author="tflobbe" created="Fri, 29 Aug 2014 17:56:17 +0000"/>
                            <attachment id="12665028" name="SOLR-6024-trunk.patch" size="16320" author="tflobbe" created="Thu, 28 Aug 2014 18:05:34 +0000"/>
                            <attachment id="12664495" name="SOLR-6024-trunk.patch" size="15735" author="tflobbe" created="Tue, 26 Aug 2014 21:58:23 +0000"/>
                            <attachment id="12664472" name="SOLR-6024-trunk.patch" size="10725" author="tflobbe" created="Tue, 26 Aug 2014 20:34:11 +0000"/>
                            <attachment id="12663981" name="SOLR-6024.patch" size="16507" author="vzhovtiuk" created="Sun, 24 Aug 2014 19:13:52 +0000"/>
                            <attachment id="12662367" name="SOLR-6024.patch" size="5117" author="vzhovtiuk" created="Sun, 17 Aug 2014 17:27:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>389109</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 45 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1v0wv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>389355</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>