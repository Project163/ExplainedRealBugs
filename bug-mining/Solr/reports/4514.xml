<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:44:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9679] Exception when removing zk node /security.json</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9679</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;To reproduce:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Upload &lt;tt&gt;security.json&lt;/tt&gt; to zk&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;bin/solr zk rm zk:/security.json -z localhost:9983&lt;/tt&gt;&lt;/li&gt;
&lt;/ol&gt;


&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2016-10-22 22:17:32.264 DEBUG (main-EventThread) [   ] o.a.s.c.c.SolrZkClient Submitting job to respond to event WatchedEvent state:SyncConnected type:NodeDeleted path:/security.json
2016-10-22 22:17:32.265 DEBUG (zkCallback-3-thread-1-processing-n:192.168.0.11:8983_solr) [   ] o.a.s.c.c.ZkStateReader Updating [/security.json] ... 
2016-10-22 22:17:32.266 ERROR (zkCallback-3-thread-1-processing-n:192.168.0.11:8983_solr) [   ] o.a.s.c.c.ZkStateReader A ZK error has occurred
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode for /security.json
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:111)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:51)
	at org.apache.zookeeper.ZooKeeper.getData(ZooKeeper.java:1155)
	at org.apache.solr.common.cloud.SolrZkClient$7.execute(SolrZkClient.java:356)
	at org.apache.solr.common.cloud.SolrZkClient$7.execute(SolrZkClient.java:353)
	at org.apache.solr.common.cloud.ZkCmdExecutor.retryOperation(ZkCmdExecutor.java:60)
	at org.apache.solr.common.cloud.SolrZkClient.getData(SolrZkClient.java:353)
	at org.apache.solr.common.cloud.ZkStateReader$3.process(ZkStateReader.java:455)
	at org.apache.solr.common.cloud.SolrZkClient$3.lambda$process$0(SolrZkClient.java:268)
	at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
	at java.util.concurrent.FutureTask.run(FutureTask.java:266)
	at org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:229)
	at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
	at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
	at java.lang.Thread.run(Thread.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;m not sure what should happen, but it would be sweet to be able to disable security by simply removing the znode... &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt; ?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13014525">SOLR-9679</key>
            <summary>Exception when removing zk node /security.json</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="janhoy">Jan H&#248;ydahl</assignee>
                                    <reporter username="janhoy">Jan H&#248;ydahl</reporter>
                        <labels>
                    </labels>
                <created>Sat, 22 Oct 2016 22:28:59 +0000</created>
                <updated>Wed, 15 Jul 2020 15:10:59 +0000</updated>
                            <resolved>Mon, 8 Jun 2020 08:51:41 +0000</resolved>
                                                    <fixVersion>8.6</fixVersion>
                                    <component>Authentication</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="15621827" author="janhoy" created="Mon, 31 Oct 2016 10:30:56 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt; any preference for this? How did you envision the recommended way of removing security from Solr (don&apos;t ask the reason why anyone would do it, could be because they want to enforce security in another component outside Solr?)&lt;br/&gt;
In the code for local &lt;tt&gt;SOLR_HOME/security.json&lt;/tt&gt; we return an empty config object if the file cannot be found on refresh. So this could be a way to solve it in the case you get a ZK node changed event and the node is gone.&lt;/p&gt;</comment>
                            <comment id="16067421" author="janhoy" created="Wed, 28 Jun 2017 23:03:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="16573129" author="janhoy" created="Wed, 8 Aug 2018 12:17:24 +0000"  >&lt;p&gt;Any views on how to tackle this gracefully? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hgadre&quot; class=&quot;user-hover&quot; rel=&quot;hgadre&quot;&gt;hgadre&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16573166" author="noble.paul" created="Wed, 8 Aug 2018 12:45:06 +0000"  >&lt;p&gt;did you try removing the &lt;tt&gt;authorization&lt;/tt&gt; and &lt;tt&gt;authentication&lt;/tt&gt; tags from &lt;tt&gt;security.json&lt;/tt&gt; instead of deleting the file altogether?&lt;/p&gt;</comment>
                            <comment id="16573173" author="janhoy" created="Wed, 8 Aug 2018 12:48:50 +0000"  >&lt;p&gt;My problem is not that I don&apos;t manage to disable security. As I said, replacing security.json with an empty JSON object does just that.&lt;/p&gt;

&lt;p&gt;This Jira is about what happens when you delete the entire file. My thinking is that it should also be a valid way to disable security and that Solr should handle it without exception, perhaps logging &quot;WARN: Security is now disabled&quot;&lt;/p&gt;</comment>
                            <comment id="16573230" author="noble.paul" created="Wed, 8 Aug 2018 13:29:19 +0000"  >&lt;p&gt;OK. yes, Solr should handle the &lt;tt&gt;NoNodeException&lt;/tt&gt; for &lt;tt&gt;security.json&lt;/tt&gt; gracefully&lt;/p&gt;</comment>
                            <comment id="17074986" author="janhoy" created="Sat, 4 Apr 2020 00:19:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt;&#160;please have a look at&#160;&lt;a href=&quot;https://github.com/apache/lucene-solr/pull/1403&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;GitHub Pull Request #1403&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;It detects &lt;tt&gt;EventType.NodeDeleted&lt;/tt&gt; , fires the callback with empty json, and recreates the watch with an &lt;tt&gt;exists()&lt;/tt&gt;&#160;call.&lt;/p&gt;

&lt;p&gt;Have not added unit tests, but tested manually: create - delete - create&lt;/p&gt;</comment>
                            <comment id="17091630" author="janhoy" created="Fri, 24 Apr 2020 14:49:05 +0000"  >&lt;p&gt;Any further comments? Probably needs a test...&lt;/p&gt;</comment>
                            <comment id="17110945" author="janhoy" created="Tue, 19 May 2020 07:55:26 +0000"  >&lt;p&gt;I updated the PR with a unit test. Please review.&lt;/p&gt;</comment>
                            <comment id="17123828" author="janhoy" created="Tue, 2 Jun 2020 13:56:58 +0000"  >&lt;p&gt;Will commit this soon&lt;/p&gt;</comment>
                            <comment id="17127797" author="jira-bot" created="Sun, 7 Jun 2020 23:12:12 +0000"  >&lt;p&gt;Commit f404a38fa6d508b9dad78ce7d38e2a9cd6bf2ed1 in lucene-solr&apos;s branch refs/heads/master from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=f404a38&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=f404a38&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9679&quot; title=&quot;Exception when removing zk node /security.json&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9679&quot;&gt;&lt;del&gt;SOLR-9679&lt;/del&gt;&lt;/a&gt;: Exception when removing zk node /security.json (#1403)&lt;/p&gt;
</comment>
                            <comment id="17127799" author="jira-bot" created="Sun, 7 Jun 2020 23:24:27 +0000"  >&lt;p&gt;Commit 0ff0c45b981cd723d046420d80753d975b9b1965 in lucene-solr&apos;s branch refs/heads/branch_8x from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=0ff0c45&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=0ff0c45&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9679&quot; title=&quot;Exception when removing zk node /security.json&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9679&quot;&gt;&lt;del&gt;SOLR-9679&lt;/del&gt;&lt;/a&gt;: Exception when removing zk node /security.json (#1403)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit f404a38fa6d508b9dad78ce7d38e2a9cd6bf2ed1)&lt;/p&gt;</comment>
                            <comment id="17128017" author="janhoy" created="Mon, 8 Jun 2020 08:29:14 +0000"  >&lt;p&gt;Re-opening to investigate test failure&lt;/p&gt;</comment>
                            <comment id="17128026" author="jira-bot" created="Mon, 8 Jun 2020 08:47:36 +0000"  >&lt;p&gt;Commit 3e538005ecb4dd20fb05c6da4e20a20e846a2a3f in lucene-solr&apos;s branch refs/heads/master from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=3e53800&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=3e53800&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9679&quot; title=&quot;Exception when removing zk node /security.json&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9679&quot;&gt;&lt;del&gt;SOLR-9679&lt;/del&gt;&lt;/a&gt;: Harden BasicAuthOnSingleNodeTest#testDeleteSecurityJsonZnode&lt;/p&gt;</comment>
                            <comment id="17128027" author="jira-bot" created="Mon, 8 Jun 2020 08:47:59 +0000"  >&lt;p&gt;Commit 0035a5be76b8b9584a5c43bf8158e2fefb5fb9f2 in lucene-solr&apos;s branch refs/heads/branch_8x from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=0035a5b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=0035a5b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9679&quot; title=&quot;Exception when removing zk node /security.json&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9679&quot;&gt;&lt;del&gt;SOLR-9679&lt;/del&gt;&lt;/a&gt;: Harden BasicAuthOnSingleNodeTest#testDeleteSecurityJsonZnode&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 3e538005ecb4dd20fb05c6da4e20a20e846a2a3f)&lt;/p&gt;</comment>
                            <comment id="17128031" author="janhoy" created="Mon, 8 Jun 2020 08:51:41 +0000"  >&lt;p&gt;Test failure was a timing issue. We immediately fired a search after removing security.json, but as this is kind of async, there is no guarantee when the change is picked up and deployed. Implemented a retry loop, failing after 10 retries/5s.&lt;/p&gt;</comment>
                            <comment id="17158399" author="broustant" created="Wed, 15 Jul 2020 15:10:59 +0000"  >&lt;p&gt;Closing after the 8.6.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 17 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i359lb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>