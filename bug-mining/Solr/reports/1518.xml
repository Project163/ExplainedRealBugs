<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:38:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4817] Solr should not fall back to the back compat built in solr.xml in SolrCloud mode.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4817</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;A hard error is much more useful, and this built in solr.xml is not very good for solrcloud - with the old style solr.xml with cores in it, you won&apos;t have persistence and with the new style, it&apos;s not really ideal either.&lt;/p&gt;

&lt;p&gt;I think it makes it easier to debug solr.home to fail on this instead - but just in solrcloud mode for now due to back compat. We might want to pull the whole internal solr.xml for 5.0.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12647350">SOLR-4817</key>
            <summary>Solr should not fall back to the back compat built in solr.xml in SolrCloud mode.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="erickerickson">Erick Erickson</assignee>
                                    <reporter username="markrmiller@gmail.com">Mark Miller</reporter>
                        <labels>
                    </labels>
                <created>Mon, 13 May 2013 18:25:19 +0000</created>
                <updated>Mon, 9 May 2016 18:54:59 +0000</updated>
                            <resolved>Mon, 26 Aug 2013 13:07:19 +0000</resolved>
                                                    <fixVersion>4.5</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13656264" author="hossman" created="Mon, 13 May 2013 19:07:18 +0000"  >&lt;p&gt;+1&lt;/p&gt;

&lt;p&gt;4.4 non/cloud mode: warn that implicit solr.xml is being used.&lt;br/&gt;
4.4 in cloud mode: fail if no solr.xml&lt;br/&gt;
5.0 in either mode: fail if no solr.xml&lt;/p&gt;</comment>
                            <comment id="13717273" author="steve_rowe" created="Tue, 23 Jul 2013 18:47:42 +0000"  >&lt;p&gt;Bulk move 4.4 issues to 4.5 and 5.0&lt;/p&gt;</comment>
                            <comment id="13748829" author="erickerickson" created="Fri, 23 Aug 2013 18:28:49 +0000"  >&lt;p&gt;Patch for trunk only, it&apos;ll take a bit of work for back-compat in 4x.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=romseygeek&quot; class=&quot;user-hover&quot; rel=&quot;romseygeek&quot;&gt;romseygeek&lt;/a&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; I had to do a bit of violence to the persist test and a couple of ZK tests just in case you want to take a quick glance at them.&lt;/p&gt;

&lt;p&gt;All tests passed a bit ago, I&apos;m trying it again now. If that works, I&apos;ll see what it would take to make it work with 4x and, if I&apos;m lucky, get it committed over the weekend.&lt;/p&gt;</comment>
                            <comment id="13748845" author="romseygeek" created="Fri, 23 Aug 2013 18:40:44 +0000"  >&lt;p&gt;I may be missing something, but this looks like it removes the &apos;fall back to built in solr.xml&apos; code entirely?  Rather than just in cloud-mode.&lt;/p&gt;</comment>
                            <comment id="13748891" author="erickerickson" created="Fri, 23 Aug 2013 19:14:59 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=romseygeek&quot; class=&quot;user-hover&quot; rel=&quot;romseygeek&quot;&gt;romseygeek&lt;/a&gt; Yes, it does remove fallback entirely, but this is for trunk only. The 4x patch will have the fallback in it, which is what&apos;s behind my comment about for trunk only and back-compat needing more work for 4x.&lt;/p&gt;</comment>
                            <comment id="13748927" author="erickerickson" created="Fri, 23 Aug 2013 19:48:42 +0000"  >&lt;p&gt;Also note I&apos;m still dealing with a couple of failed tests, they don&apos;t appear to show up if other tests fail...&lt;/p&gt;

&lt;p&gt;Nothing difficult so far, just a bit of slogging.&lt;/p&gt;</comment>
                            <comment id="13749415" author="erickerickson" created="Sat, 24 Aug 2013 15:37:27 +0000"  >&lt;p&gt;I think this is good-to-go for trunk. Since this really is changing behavior between trunk and 4x I&apos;ll put up a separate patch for 4x, I hope today.&lt;/p&gt;

&lt;p&gt;One thing this patch does is completely get rid of the fallback solr.xml string in ConfigSolrXmlOld.xml, it&apos;s made available for tests by being put in a test file solr-old-default.xml. The non-test code doesn&apos;t have any references to it. This is a stopgap during this period between deprecating persistence and getting rid of it altogether. There&apos;s a couple of odd test cases that work if the core container uses this default file but don&apos;t work if you use the standard solr.xml file, I don&apos;t have the bandwidth to chase that down now, but it&apos;ll come out when we remove persistence.&lt;/p&gt;</comment>
                            <comment id="13749489" author="erickerickson" created="Sat, 24 Aug 2013 22:40:28 +0000"  >&lt;p&gt;Latest patch, all tests pass. That said, I still need to look all the changes over in the morning. I suspect there are some changes that need to be modified re: getting tests to pass But now that all tests pass, perhaps I can be a bit more discriminating in terms of what changes are really necessary.&lt;/p&gt;

&lt;p&gt;In particular, SolrTestCaseJ4.copyTestSolrHome is a nocommit at this point. It&apos;s used once, but I&apos;m thinking of leaving it in for the future as a handy method of copying all of a conf directory to a temp dir. It might replace a number of custom copy methods in various tests going forward.&lt;/p&gt;</comment>
                            <comment id="13749724" author="erickerickson" created="Sun, 25 Aug 2013 19:21:40 +0000"  >&lt;p&gt;Re-worked it in light of lessons learned, it&apos;s cleaner now.&lt;/p&gt;

&lt;p&gt;I think it&apos;s ready to commit, all tests pass etc.&lt;/p&gt;</comment>
                            <comment id="13749742" author="erickerickson" created="Sun, 25 Aug 2013 20:49:13 +0000"  >&lt;p&gt;Final version I think. I&apos;ll probably be checking this in this evening. I tried applying it directly to 4x and it works fine, which is not surprising since I changed all the tests to NOT use the default configuration.&lt;/p&gt;

&lt;p&gt;So I&apos;ll add another test in to the 4x version to insure we create the default solr.xml when we should after I merge. It turns out that there are only a few small changes to the patch needed for 4x, the aforementioned test and putting the hard-coded bit back in and reverting removing the string from SolrConfigXmlOld.java&lt;/p&gt;</comment>
                            <comment id="13749771" author="jira-bot" created="Mon, 26 Aug 2013 00:06:07 +0000"  >&lt;p&gt;Commit 1517398 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erickoerickson&quot; class=&quot;user-hover&quot; rel=&quot;erickoerickson&quot;&gt;erickoerickson&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1517398&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1517398&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4817&quot; title=&quot;Solr should not fall back to the back compat built in solr.xml in SolrCloud mode.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4817&quot;&gt;&lt;del&gt;SOLR-4817&lt;/del&gt;&lt;/a&gt; Solr should not fall back to the back compat built in solr.xml in SolrCloud mode.&lt;/p&gt;</comment>
                            <comment id="13750064" author="jira-bot" created="Mon, 26 Aug 2013 12:54:30 +0000"  >&lt;p&gt;Commit 1517530 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erickoerickson&quot; class=&quot;user-hover&quot; rel=&quot;erickoerickson&quot;&gt;erickoerickson&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1517530&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1517530&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4817&quot; title=&quot;Solr should not fall back to the back compat built in solr.xml in SolrCloud mode.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4817&quot;&gt;&lt;del&gt;SOLR-4817&lt;/del&gt;&lt;/a&gt; Solr should not fall back to the back compat built in solr.xml in SolrCloud mode.&lt;/p&gt;</comment>
                            <comment id="13750071" author="erickerickson" created="Mon, 26 Aug 2013 13:07:19 +0000"  >&lt;p&gt;I suspect that most of the default solr.xml was actually used by tests, and often not by intention...&lt;/p&gt;

&lt;p&gt;So the code checked in for 4x is slightly different than the patch for 5 in that it puts back the default solr.xml and includes an explicit test for constructing the default since the point of the other changes is to remove the dependency on the hard-coded solr.xml.&lt;/p&gt;

&lt;p&gt;So going forward, when people write tests they&apos;ll have to either&lt;br/&gt;
1&amp;gt; reference a solrhome that contains a solr.xml file&lt;br/&gt;
or&lt;br/&gt;
2&amp;gt; copy the solr.xml file to &quot;the right place&quot;. There are several methods in SolrTestCaseJ4 to help here:&lt;br/&gt;
copyMinConf - copies a very tiny schema and config file. Does NOT copy solr.xml&lt;br/&gt;
copyMinFullSetup - as copyMinConf but DOES copy solr.xml&lt;br/&gt;
copySolrHomeToTemp - copies a robust schema and config and solr.xml to a temp dir.&lt;/p&gt;</comment>
                            <comment id="13750208" author="markrmiller@gmail.com" created="Mon, 26 Aug 2013 16:28:08 +0000"  >&lt;blockquote&gt;&lt;p&gt;I suspect that most of the default solr.xml was actually used by tests, and often not by intention...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Many of the tests were written before solr.xml existed - the built in solr.xml was included for back compat on those pre existing installs. Because it worked with back compat, the people that added solr.xml did not have to update all the tests at the time - something that&apos;s commonly done.&lt;/p&gt;

&lt;p&gt;I think that is totally okay though, because we are here to do it now that it actually must be done for 5.0 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; It&apos;s actually probably simpler to deal with now than it was back then.&lt;/p&gt;</comment>
                            <comment id="13760008" author="shalinmangar" created="Fri, 6 Sep 2013 07:03:46 +0000"  >&lt;p&gt;Just fyi, the copyMinConf, copyMinFullSetup and copySolrHomeToTemp methods throw the following exception with Solrj tests:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;junit4] ERROR   0.69s | MultiCoreExampleJettyTest.testDeleteInstanceDir &amp;lt;&amp;lt;&amp;lt;&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; Throwable #1: java.lang.RuntimeException: Cannot find resource: /Users/shalinmangar/work/oss/solr-trunk/solr/build/solr-solrj/test/J0/solr/collection1&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at __randomizedtesting.SeedInfo.seed(&lt;span class=&quot;error&quot;&gt;&amp;#91;2AFBC83FDA207BB2:4160F4A68E96AEF0&amp;#93;&lt;/span&gt;:0)&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.getFile(SolrTestCaseJ4.java:1571)&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.TEST_HOME(SolrTestCaseJ4.java:1576)&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.copyMinConf(SolrTestCaseJ4.java:1618)&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.copyMinConf(SolrTestCaseJ4.java:1603)&lt;br/&gt;
   &lt;span class=&quot;error&quot;&gt;&amp;#91;junit4&amp;#93;&lt;/span&gt;    &amp;gt; 	at org.apache.solr.client.solrj.embedded.MultiCoreExampleJettyTest.testDeleteInstanceDir(MultiCoreExampleJettyTest.java:117)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;You can reproduce the error above with the patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5023&quot; title=&quot;deleteInstanceDir is added to CoreAdminHandler but can&amp;#39;t be passed with solrj&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5023&quot;&gt;&lt;del&gt;SOLR-5023&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13760221" author="markrmiller@gmail.com" created="Fri, 6 Sep 2013 14:17:28 +0000"  >&lt;p&gt;I think it&apos;s all a bit of a mess right now (the test configs situation) - we should clean this up more. I intend to take a crack at it at some point. It&apos;s still too haphazard what is done in what tests and too difficult to understand and follow when writing new tests or debugging old ones. &lt;/p&gt;</comment>
                            <comment id="13760226" author="erickerickson" created="Fri, 6 Sep 2013 14:32:08 +0000"  >&lt;p&gt;bq: I think it&apos;s all a bit of a mess right now &lt;/p&gt;

&lt;p&gt;Yeah, it certainly is but I haven&apos;t had the energy to try to straighten it out either. Maybe we can share some of the work....&lt;/p&gt;
</comment>
                            <comment id="13787001" author="jpountz" created="Sat, 5 Oct 2013 10:18:40 +0000"  >&lt;p&gt;4.5 release -&amp;gt; bulk close&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12599848" name="SOLR-4817.patch" size="34398" author="erickerickson" created="Sun, 25 Aug 2013 20:49:13 +0000"/>
                            <attachment id="12599842" name="SOLR-4817.patch" size="34001" author="erickerickson" created="Sun, 25 Aug 2013 19:21:40 +0000"/>
                            <attachment id="12599814" name="SOLR-4817.patch" size="35112" author="erickerickson" created="Sat, 24 Aug 2013 22:40:28 +0000"/>
                            <attachment id="12599798" name="SOLR-4817.patch" size="29468" author="erickerickson" created="Sat, 24 Aug 2013 15:37:27 +0000"/>
                            <attachment id="12599681" name="SOLR-4817.patch" size="24108" author="erickerickson" created="Fri, 23 Aug 2013 18:28:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>327706</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 7 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kjin:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>328050</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>