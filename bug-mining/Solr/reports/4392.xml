<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:42:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-14064] remove some hadoop brain-damage from build environment</title>
                <link>https://issues.apache.org/jira/browse/SOLR-14064</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Some permissions and build hacks were made on behalf of hadoop. These were most definitely hacks on top of hacks.&lt;/p&gt;

&lt;p&gt;The background is that the hadoop code is a true nightmare to deal with, if you want to sandbox code with SecurityManager.&lt;/p&gt;

&lt;p&gt;Now that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krisden&quot; class=&quot;user-hover&quot; rel=&quot;krisden&quot;&gt;krisden&lt;/a&gt; has wrestled it (at least mostly?) to the ground, let&apos;s remove the hacks from solr security policy and lucene build that I added. We need to be strict: ensure things are really working (otherwise we get SecurityException). This also makes the configuration simpler.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13274029">SOLR-14064</key>
            <summary>remove some hadoop brain-damage from build environment</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rcmuir">Robert Muir</assignee>
                                    <reporter username="rcmuir">Robert Muir</reporter>
                        <labels>
                    </labels>
                <created>Thu, 12 Dec 2019 05:04:34 +0000</created>
                <updated>Tue, 24 Mar 2020 12:45:17 +0000</updated>
                            <resolved>Fri, 13 Dec 2019 08:56:12 +0000</resolved>
                                                    <fixVersion>8.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16994215" author="rcmuir" created="Thu, 12 Dec 2019 05:06:35 +0000"  >&lt;p&gt;only tested on OS X so far.&lt;/p&gt;</comment>
                            <comment id="16994227" author="rcmuir" created="Thu, 12 Dec 2019 05:15:41 +0000"  >&lt;p&gt;There were two major problems causing these hacks-on-top-of-hacks:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;stacktrace inspection of hadoop &quot;required&quot; process executions: they use $PATH hence require &amp;lt;&amp;lt;ALL FILES&amp;gt;&amp;gt; EXECUTE. Also means overriding SecurityManager methods without other setup. This breaks java security model, it falls apart unless SecurityManager has AllPermission. But, &amp;lt;&amp;lt;ALL FILES&amp;gt;&amp;gt; EXECUTE. gotta do what you gotta do.&lt;/li&gt;
	&lt;li&gt;classpath pollution of the ant build runtime into the tests classpath (&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-9090&quot; title=&quot;ant runtime is in tests classpath&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-9090&quot;&gt;&lt;del&gt;LUCENE-9090&lt;/del&gt;&lt;/a&gt;). This caused me to add initial permissions to allow crazy shit that was happening from solr tests -&amp;gt; hadoop -&amp;gt; jetty -&amp;gt; (scan of total classpath loading classes, maybe running some clinit, how fun could this get, etc)&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="16994953" author="risdenk" created="Thu, 12 Dec 2019 18:40:38 +0000"  >&lt;p&gt;This looks good on the surface. I&apos;ll run the tests on it in a bit on Windows/Mac.&lt;/p&gt;

&lt;p&gt;FYI created &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14077&quot; title=&quot;Hadoop shouldn&amp;#39;t need to look for metrics config in user home&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14077&quot;&gt;&lt;del&gt;SOLR-14077&lt;/del&gt;&lt;/a&gt; to remove the need to the hadoop metrics user.home lines.&lt;/p&gt;</comment>
                            <comment id="16995130" author="risdenk" created="Thu, 12 Dec 2019 21:27:53 +0000"  >&lt;p&gt;HDFS / Hadoop test runs on Mac and Windows look good. Running full test next.&lt;/p&gt;

&lt;p&gt;BTW not related to this change but saw this pop up. It doesn&apos;t cause a failure but seems wrong:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
  2&amp;gt; 23044 WARN  (SUITE-TestRecoveryHdfs-seed#[AC80F05AAAD3A298]-worker) [     ] o.a.s.f.DistribPackageStore Unable to create [/Users/risdenk/repos/apache/lucene-solr/solr/core/src/test-files/solr/filestore] directory in SOLR_HOME [/Users/risdenk/repos/apache/lucene-solr/solr/core/src/test-files/solr].  Features requiring &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; directory may fail.
  2&amp;gt;           =&amp;gt; java.security.AccessControlException: access denied (&lt;span class=&quot;code-quote&quot;&gt;&quot;java.io.FilePermission&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/risdenk/repos/apache/lucene-solr/solr/core/src/test-files/solr/filestore&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;write&quot;&lt;/span&gt;)
  2&amp;gt; 	at java.base/java.security.AccessControlContext.checkPermission(AccessControlContext.java:472)
  2&amp;gt; java.security.AccessControlException: access denied (&lt;span class=&quot;code-quote&quot;&gt;&quot;java.io.FilePermission&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;/Users/risdenk/repos/apache/lucene-solr/solr/core/src/test-files/solr/filestore&quot;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&quot;write&quot;&lt;/span&gt;)
  2&amp;gt; 	at java.security.AccessControlContext.checkPermission(AccessControlContext.java:472) ~[?:?]
  2&amp;gt; 	at java.security.AccessController.checkPermission(AccessController.java:897) ~[?:?]
  2&amp;gt; 	at java.lang.&lt;span class=&quot;code-object&quot;&gt;SecurityManager&lt;/span&gt;.checkPermission(&lt;span class=&quot;code-object&quot;&gt;SecurityManager&lt;/span&gt;.java:322) ~[?:?]
  2&amp;gt; 	at java.lang.&lt;span class=&quot;code-object&quot;&gt;SecurityManager&lt;/span&gt;.checkWrite(&lt;span class=&quot;code-object&quot;&gt;SecurityManager&lt;/span&gt;.java:752) ~[?:?]
  2&amp;gt; 	at java.io.File.mkdir(File.java:1323) ~[?:?]
  2&amp;gt; 	at java.io.File.mkdirs(File.java:1355) ~[?:?]
  2&amp;gt; 	at org.apache.solr.filestore.DistribPackageStore.ensurePackageStoreDir(DistribPackageStore.java:476) ~[java/:?]
  2&amp;gt; 	at org.apache.solr.filestore.DistribPackageStore.&amp;lt;init&amp;gt;(DistribPackageStore.java:65) ~[java/:?]
  2&amp;gt; 	at org.apache.solr.filestore.PackageStoreAPI.&amp;lt;init&amp;gt;(PackageStoreAPI.java:77) ~[java/:?]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16995137" author="rcmuir" created="Thu, 12 Dec 2019 21:44:09 +0000"  >&lt;p&gt;Thanks for testing! &lt;/p&gt;

&lt;p&gt;For the issue you see in package store tests, we should make a separate issue: it is wrong for a test to be modifying the source code tree! I&apos;m not familiar with the specific test but it seems like it should be using a temp directory.&lt;/p&gt;</comment>
                            <comment id="16995142" author="risdenk" created="Thu, 12 Dec 2019 21:49:21 +0000"  >&lt;p&gt;Yea agreed. Created &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14078&quot; title=&quot;DistribPackageStore tries to write to source tree&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14078&quot;&gt;&lt;del&gt;SOLR-14078&lt;/del&gt;&lt;/a&gt;. I don&apos;t think its specific to that test actually. Will comment more over there.&lt;/p&gt;</comment>
                            <comment id="16995292" author="risdenk" created="Fri, 13 Dec 2019 02:26:49 +0000"  >&lt;p&gt;Full test runs on Windows and Mac look good. +1 from me&lt;/p&gt;</comment>
                            <comment id="16995475" author="jira-bot" created="Fri, 13 Dec 2019 08:54:17 +0000"  >&lt;p&gt;Commit a6e7c770c27f6467d8aa717d4b07c8682d09ebc8 in lucene-solr&apos;s branch refs/heads/master from Robert Muir&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=a6e7c77&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=a6e7c77&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14064&quot; title=&quot;remove some hadoop brain-damage from build environment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14064&quot;&gt;&lt;del&gt;SOLR-14064&lt;/del&gt;&lt;/a&gt;: remove some hadoop brain damage from build environment&lt;/p&gt;

&lt;p&gt;Some permissions and build hacks were made on behalf of hadoop: hacks on&lt;br/&gt;
top of hacks. Now that the major problems such as classpath pollution and&lt;br/&gt;
hadoop test code are fixed, so we can remove hacks built on top of them.&lt;/p&gt;</comment>
                            <comment id="16995476" author="jira-bot" created="Fri, 13 Dec 2019 08:55:46 +0000"  >&lt;p&gt;Commit 1761e48e534225bec234ea2d0fd223f70c962d5a in lucene-solr&apos;s branch refs/heads/branch_8x from Robert Muir&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=1761e48&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=1761e48&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14064&quot; title=&quot;remove some hadoop brain-damage from build environment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14064&quot;&gt;&lt;del&gt;SOLR-14064&lt;/del&gt;&lt;/a&gt;: remove some hadoop brain damage from build environment&lt;/p&gt;

&lt;p&gt;Some permissions and build hacks were made on behalf of hadoop: hacks on&lt;br/&gt;
top of hacks. Now that the major problems such as classpath pollution and&lt;br/&gt;
hadoop test code are fixed, so we can remove hacks built on top of them.&lt;/p&gt;</comment>
                            <comment id="16995477" author="rcmuir" created="Fri, 13 Dec 2019 08:56:12 +0000"  >&lt;p&gt;Thanks Kevin!&lt;/p&gt;</comment>
                            <comment id="16995578" author="jira-bot" created="Fri, 13 Dec 2019 12:31:41 +0000"  >&lt;p&gt;Commit a6e7c770c27f6467d8aa717d4b07c8682d09ebc8 in lucene-solr&apos;s branch refs/heads/gradle-master from Robert Muir&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=a6e7c77&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=a6e7c77&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14064&quot; title=&quot;remove some hadoop brain-damage from build environment&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14064&quot;&gt;&lt;del&gt;SOLR-14064&lt;/del&gt;&lt;/a&gt;: remove some hadoop brain damage from build environment&lt;/p&gt;

&lt;p&gt;Some permissions and build hacks were made on behalf of hadoop: hacks on&lt;br/&gt;
top of hacks. Now that the major problems such as classpath pollution and&lt;br/&gt;
hadoop test code are fixed, so we can remove hacks built on top of them.&lt;/p&gt;</comment>
                            <comment id="17065626" author="romseygeek" created="Tue, 24 Mar 2020 12:45:17 +0000"  >&lt;p&gt;Bulk close for 8.5.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13271762">SOLR-13991</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13274219">SOLR-14077</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12988640" name="SOLR-14064.patch" size="1831" author="rcmuir" created="Thu, 12 Dec 2019 05:05:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 34 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z09lbk:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>