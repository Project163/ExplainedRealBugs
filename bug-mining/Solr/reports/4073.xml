<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:35:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-12986] HttpPartitionTest reliably failing seed</title>
                <link>https://issues.apache.org/jira/browse/SOLR-12986</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I&apos;ve found a reliably failing seed for HttpPartitionTest when run against master @ e81dd4e870d2a9b27e1f4366e92daa6dba054da8 ...&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=HttpPartitionTest -Dtests.method=test -Dtests.seed=E3596048AE430BB6 -Dtests.slow=true -Dtests.badapples=true -Dtests.locale=ar-OM -Dtests.timezone=America/Los_Angeles -Dtests.asserts=true -Dtests.file.encoding=UTF-8
   [junit4] FAILURE 56.2s | HttpPartitionTest.test &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: max version bucket seed not updated after recovery!
   [junit4]    &amp;gt;        at __randomizedtesting.SeedInfo.seed([E3596048AE430BB6:6B0D5F9200BF664E]:0)
   [junit4]    &amp;gt;        at org.apache.solr.cloud.HttpPartitionTest.testRf2(HttpPartitionTest.java:290)
   [junit4]    &amp;gt;        at org.apache.solr.cloud.HttpPartitionTest.test(HttpPartitionTest.java:131)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ll attach some logs, but at first glance it appears that everything is working properly, and PeerSync hapens from the leader before the replica registers itself as active, but then it stil reports an old &quot;max version&quot;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13198108">SOLR-12986</key>
            <summary>HttpPartitionTest reliably failing seed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="caomanhdat">Cao Manh Dat</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Nov 2018 17:37:09 +0000</created>
                <updated>Sat, 8 Jun 2019 15:00:32 +0000</updated>
                            <resolved>Sun, 16 Dec 2018 17:00:47 +0000</resolved>
                                                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16685522" author="hossman" created="Tue, 13 Nov 2018 17:39:52 +0000"  >&lt;p&gt;Attaching a log from running this seed.&#160; Here&apos;s some highlights that seem to indicate that the recovery is happening correctly, but something is going wrong when trying to ask the core&apos;s update log for it&apos;s max version...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; 57176 INFO  (recoveryExecutor-84-thread-1-processing-n:127.0.0.1:41793_ x:c8n_1x2_shard1_replica_n3 c:c8n_1x2 s:shard1 r:core_node4) [n:127.0.0.1:41793_ c:c8n_1x2 s:shard1 r:core_node4 x:c8n_1x2_shard1_replica_n3] o.a.s.u.IndexFingerprint IndexFingerprint millis:13.0 result:{maxVersionSpecified=9223372036854775807, maxVersionEncountered=1617036462923972608, maxInHash=1617036462923972608, versionsHash=-3091544452617928482, numVersions=13, numDocs=13, maxDoc=11}
...
 [n:127.0.0.1:41793_ c:c8n_1x2 s:shard1 r:core_node4 x:c8n_1x2_shard1_replica_n3] o.a.s.u.PeerSyncWithLeader Leader fingerprint: {maxVersionSpecified=9223372036854775807, maxVersionEncountered=1617036468130152448, maxInHash=1617036468130152448, versionsHash=2139642257268423658, numVersions=108, numDocs=108, maxDoc=39}, Our fingerprint: {maxVersionSpecified=9223372036854775807, maxVersionEncountered=1617036462923972608, maxInHash=1617036462923972608, versionsHash=-3091544452617928482, numVersions=13, numDocs=13, maxDoc=11}
...
   [junit4]   2&amp;gt; 57224 INFO  (recoveryExecutor-84-thread-1-processing-n:127.0.0.1:41793_ x:c8n_1x2_shard1_replica_n3 c:c8n_1x2 s:shard1 r:core_node4) [n:127.0.0.1:41793_ c:c8n_1x2 s:shard1 r:core_node4 x:c8n_1x2_shard1_replica_n3] o.a.s.u.PeerSyncWithLeader PeerSync: core=c8n_1x2_shard1_replica_n3 url=http://127.0.0.1:41793 Requesting updates from http://127.0.0.1:55488/c8n_1x2_shard1_replica_n1/ n=95 versions=1617036463285731328...1617036468130152448
...
   [junit4]   2&amp;gt; 57345 INFO  (recoveryExecutor-84-thread-1-processing-n:127.0.0.1:41793_ x:c8n_1x2_shard1_replica_n3 c:c8n_1x2 s:shard1 r:core_node4) [n:127.0.0.1:41793_ c:c8n_1x2 s:shard1 r:core_node4 x:c8n_1x2_shard1_replica_n3] o.a.s.u.DirectUpdateHandler2 end_commit_flush
   [junit4]   2&amp;gt; 57345 INFO  (recoveryExecutor-84-thread-1-processing-n:127.0.0.1:41793_ x:c8n_1x2_shard1_replica_n3 c:c8n_1x2 s:shard1 r:core_node4) [n:127.0.0.1:41793_ c:c8n_1x2 s:shard1 r:core_node4 x:c8n_1x2_shard1_replica_n3] o.a.s.c.RecoveryStrategy PeerSync stage of recovery was successful.
   [junit4]   2&amp;gt; 57345 INFO  (recoveryExecutor-84-thread-1-processing-n:127.0.0.1:41793_ x:c8n_1x2_shard1_replica_n3 c:c8n_1x2 s:shard1 r:core_node4) [n:127.0.0.1:41793_ c:c8n_1x2 s:shard1 r:core_node4 x:c8n_1x2_shard1_replica_n3] o.a.s.c.RecoveryStrategy Replaying updates buffered during PeerSync.
   [junit4]   2&amp;gt; 57345 INFO  (recoveryExecutor-84-thread-1-processing-n:127.0.0.1:41793_ x:c8n_1x2_shard1_replica_n3 c:c8n_1x2 s:shard1 r:core_node4) [n:127.0.0.1:41793_ c:c8n_1x2 s:shard1 r:core_node4 x:c8n_1x2_shard1_replica_n3] o.a.s.c.RecoveryStrategy No replay needed.
   [junit4]   2&amp;gt; 57345 INFO  (recoveryExecutor-84-thread-1-processing-n:127.0.0.1:41793_ x:c8n_1x2_shard1_replica_n3 c:c8n_1x2 s:shard1 r:core_node4) [n:127.0.0.1:41793_ c:c8n_1x2 s:shard1 r:core_node4 x:c8n_1x2_shard1_replica_n3] o.a.s.c.RecoveryStrategy Registering as Active after recovery.
   [junit4]   2&amp;gt; 57346 INFO  (recoveryExecutor-84-thread-1-processing-n:127.0.0.1:41793_ x:c8n_1x2_shard1_replica_n3 c:c8n_1x2 s:shard1 r:core_node4) [n:127.0.0.1:41793_ c:c8n_1x2 s:shard1 r:core_node4 x:c8n_1x2_shard1_replica_n3] o.a.s.c.ZkShardTerms Successful update of terms at /collections/c8n_1x2/terms/shard1 to Terms{values={core_node2=3, core_node4=3}, version=8}
...
   [junit4]   2&amp;gt; 57543 INFO  (TEST-HttpPartitionTest.test-seed#[E3596048AE430BB6]) [    ] o.a.s.c.AbstractFullDistribZkTestBase Took 4002.0 ms to see all replicas become active.
   [junit4]   2&amp;gt; 57543 INFO  (TEST-HttpPartitionTest.test-seed#[E3596048AE430BB6]) [    ] o.a.s.c.HttpPartitionTest After recovery, looked up NEW max version bucket seed 1617036453501468672 for core c8n_1x2_shard1_replica_n3, was: 1617036453501468672

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16685531" author="hossman" created="Tue, 13 Nov 2018 17:47:47 +0000"  >&lt;p&gt;Dat, can you please take a look at this?&lt;/p&gt;

&lt;p&gt;I suspect that maybe the issue has to do with the replica types being used?&lt;/p&gt;

&lt;p&gt;In the log from the failing seed that i attached (and other failing seds i&apos;ve seen) it&apos;s using NRT replicas...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; 35846 INFO  (qtp1233081730-94) [n:127.0.0.1:51155_    ] o.a.s.h.a.CollectionsHandler Invoked Collection Action :create with params pullReplicas=0&amp;amp;maxShardsPerNode=1&amp;amp;collection.configName=conf1&amp;amp;nrtReplicas=2&amp;amp;name=c8n_1x2&amp;amp;action=CREATE&amp;amp;numShards=1&amp;amp;tlogReplicas=0&amp;amp;stateFormat=1&amp;amp;wt=javabin&amp;amp;version=2 and sendToOCPQueue=true
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;... but in at least 2 other seeds i&apos;ve tried where the test passes it&apos;s using tlog replicas ...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ant test  -Dtestcase=HttpPartitionTest -Dtests.method=test -Dtests.seed=D6EF839EC5466577 -Dtests.slow=true -Dtests.badapples=true -Dtests.locale=ar-OM -Dtests.timezone=America/Los_Angeles -Dtests.asserts=true -Dtests.file.encoding=UTF-8
...
   [junit4]   2&amp;gt; 34178 INFO  (qtp2003220851-136) [n:127.0.0.1:34609_fv    ] o.a.s.h.a.CollectionsHandler Invoked Collection Action :create with params pullReplicas=0&amp;amp;maxShardsPerNode=1&amp;amp;collection.configName=conf1&amp;amp;nrtReplicas=0&amp;amp;name=c8n_1x2&amp;amp;action=CREATE&amp;amp;numShards=1&amp;amp;tlogReplicas=2&amp;amp;stateFormat=1&amp;amp;wt=javabin&amp;amp;version=2 and sendToOCPQueue=true
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16693340" author="jira-bot" created="Tue, 20 Nov 2018 15:01:31 +0000"  >&lt;p&gt;Commit 05167ed01df545922180b9a17bdc6e96996e0a6f in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=05167ed&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=05167ed&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12986&quot; title=&quot;HttpPartitionTest reliably failing seed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12986&quot;&gt;&lt;del&gt;SOLR-12986&lt;/del&gt;&lt;/a&gt;: HttpPartitionTest reliably failing seed&lt;/p&gt;</comment>
                            <comment id="16693352" author="caomanhdat" created="Tue, 20 Nov 2018 15:09:59 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman&quot; class=&quot;user-hover&quot; rel=&quot;hossman&quot;&gt;hossman&lt;/a&gt;, I committed a fix for this failure. I will watch the jenkins and let this issue open for couple of days.&lt;/p&gt;</comment>
                            <comment id="16693367" author="jira-bot" created="Tue, 20 Nov 2018 15:16:27 +0000"  >&lt;p&gt;Commit 05167ed01df545922180b9a17bdc6e96996e0a6f in lucene-solr&apos;s branch refs/heads/jira/http2 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=05167ed&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=05167ed&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12986&quot; title=&quot;HttpPartitionTest reliably failing seed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12986&quot;&gt;&lt;del&gt;SOLR-12986&lt;/del&gt;&lt;/a&gt;: HttpPartitionTest reliably failing seed&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12948002" name="HttpPartitionTest.fail.log.txt" size="685104" author="hossman" created="Tue, 13 Nov 2018 17:38:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|s00fzs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>