<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:25:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-11136] XMLResponseParser.readDocument makes dangerous assumptions / fails when indent=true and [child] doc transformer</title>
                <link>https://issues.apache.org/jira/browse/SOLR-11136</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>
&lt;p&gt;Some buggy code in XMLResponseParser.readDocument causes it to indirectly assume that once it encounters a nested START_ELEMENT &apos;doc&apos; (which it can recursively parse) the only other XML stream events it will find will either be an END_ELEMENT, or more &apos;doc&apos; START_ELEMENTs...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; SolrDocument readDocument( XMLStreamReader parser ) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; XMLStreamException
{
  &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( XMLStreamConstants.START_ELEMENT != parser.getEventType() ) {
    &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException( &lt;span class=&quot;code-quote&quot;&gt;&quot;must be start element, not: &quot;&lt;/span&gt;+parser.getEventType() );
  }

  &lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;
  &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;( &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; ) 
  {
    &lt;span class=&quot;code-keyword&quot;&gt;switch&lt;/span&gt; (parser.next()) {
    &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; XMLStreamConstants.START_ELEMENT:
      depth++;
      builder.setLength( 0 ); &lt;span class=&quot;code-comment&quot;&gt;// reset the text
&lt;/span&gt;      type = KnownType.get( parser.getLocalName() );

      &lt;span class=&quot;code-comment&quot;&gt;// ...
&lt;/span&gt;      
      &lt;span class=&quot;code-comment&quot;&gt;// NOTE: nothing in &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; loop modifies &lt;span class=&quot;code-quote&quot;&gt;&apos;type&apos;&lt;/span&gt; 
&lt;/span&gt;      &lt;span class=&quot;code-comment&quot;&gt;// so the &lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;&apos;&lt;/span&gt; is totally inappropriate even &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; there was no bug
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt;( type == KnownType.DOC) {
        doc.addChildDocument(readDocument(parser));
        &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; event = parser.next();                                &lt;span class=&quot;code-comment&quot;&gt;// PROBLEMATIC
&lt;/span&gt;        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (event == XMLStreamConstants.END_ELEMENT) { &lt;span class=&quot;code-comment&quot;&gt;//Doc ends
&lt;/span&gt;          &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; doc;
        }
      }
      
      &lt;span class=&quot;code-comment&quot;&gt;// ...&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Because of how the server side XML Writer code works, it&apos;s &lt;em&gt;currently&lt;/em&gt; true that child documents should always come &quot;after&quot; any other fields or transformers &amp;#8211; but depending on that is sketchy.  Where this code actually causes real problems is if the server/client uses &lt;tt&gt;indent=true&lt;/tt&gt; because then the &lt;tt&gt;parser.next();&lt;/tt&gt; call (labeled &lt;tt&gt;PROBLEMATIC&lt;/tt&gt;) can return &lt;tt&gt;XMLStreamConstants.CHARACTER&lt;/tt&gt; (or &lt;tt&gt;XMLStreamConstants.WHITESPACE&lt;/tt&gt;) because the blank space inbetween sibling child docs, or after the last child doc, causing the recursive call to &lt;tt&gt;readDocument(parser)&lt;/tt&gt; to fail (because it expects to find the reader positioned at a START_ELEMENT)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13089192">SOLR-11136</key>
            <summary>XMLResponseParser.readDocument makes dangerous assumptions / fails when indent=true and [child] doc transformer</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Fri, 21 Jul 2017 23:56:12 +0000</created>
                <updated>Sat, 8 Jun 2019 15:20:33 +0000</updated>
                            <resolved>Sat, 22 Jul 2017 00:33:48 +0000</resolved>
                                                    <fixVersion>7.0</fixVersion>
                    <fixVersion>7.1</fixVersion>
                    <fixVersion>8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16097010" author="hossman" created="Fri, 21 Jul 2017 23:58:15 +0000"  >
&lt;p&gt;Attaching a patch that:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;forces &lt;tt&gt;indent=true&lt;/tt&gt; in SolrExampleTests so this buggy situation to manifest in SolrExampleXMLTest.testChildDoctransformer&lt;/li&gt;
	&lt;li&gt;beefs up testChildDoctransformer to also sanity check things like other fields in the &lt;tt&gt;fl&lt;/tt&gt; after the &lt;tt&gt;[child]&lt;/tt&gt; transformer, and multiple &lt;tt&gt;[child]&lt;/tt&gt; transformers in a single fl.&lt;/li&gt;
	&lt;li&gt;fix to XMLResponseParser to &lt;tt&gt;continue&lt;/tt&gt; the while loop after each nested child doc, so we can leverage the existing handling of other possible &lt;tt&gt;XMLStreamConstants&lt;/tt&gt; that already exist in that switch.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;...i&apos;m still running al tests to make sure i didn&apos;t introduce any new bugs.&lt;/p&gt;</comment>
                            <comment id="16097011" author="hossman" created="Fri, 21 Jul 2017 23:59:48 +0000"  >&lt;p&gt;Found this bug due to test failures that popped up in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10494&quot; title=&quot;Switch Solr&amp;#39;s Default Response Type from XML to JSON&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10494&quot;&gt;&lt;del&gt;SOLR-10494&lt;/del&gt;&lt;/a&gt; where the default indent is being changed to true.&lt;/p&gt;</comment>
                            <comment id="16097029" author="jira-bot" created="Sat, 22 Jul 2017 00:28:36 +0000"  >&lt;p&gt;Commit eae2efcbd9cffadc94aaf89691eea4ee453940e2 in lucene-solr&apos;s branch refs/heads/master from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=eae2efcb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=eae2efcb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11136&quot; title=&quot;XMLResponseParser.readDocument makes dangerous assumptions / fails when indent=true and [child] doc transformer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11136&quot;&gt;&lt;del&gt;SOLR-11136&lt;/del&gt;&lt;/a&gt;: Fix solrj XMLResponseParser when nested docs transformer is used with indented XML&lt;/p&gt;</comment>
                            <comment id="16097031" author="jira-bot" created="Sat, 22 Jul 2017 00:33:17 +0000"  >&lt;p&gt;Commit c4d85a5849b8ae09fc957af94ca042fd5ad225dd in lucene-solr&apos;s branch refs/heads/branch_7_0 from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c4d85a5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c4d85a5&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11136&quot; title=&quot;XMLResponseParser.readDocument makes dangerous assumptions / fails when indent=true and [child] doc transformer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11136&quot;&gt;&lt;del&gt;SOLR-11136&lt;/del&gt;&lt;/a&gt;: Fix solrj XMLResponseParser when nested docs transformer is used with indented XML&lt;/p&gt;

&lt;p&gt;(cherry picked from commit eae2efcbd9cffadc94aaf89691eea4ee453940e2)&lt;/p&gt;</comment>
                            <comment id="16097032" author="jira-bot" created="Sat, 22 Jul 2017 00:33:18 +0000"  >&lt;p&gt;Commit 52f1ffed86fb0b392a38a1c403fedb4f7975d35b in lucene-solr&apos;s branch refs/heads/branch_7x from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=52f1ffe&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=52f1ffe&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11136&quot; title=&quot;XMLResponseParser.readDocument makes dangerous assumptions / fails when indent=true and [child] doc transformer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11136&quot;&gt;&lt;del&gt;SOLR-11136&lt;/del&gt;&lt;/a&gt;: Fix solrj XMLResponseParser when nested docs transformer is used with indented XML&lt;/p&gt;

&lt;p&gt;(cherry picked from commit eae2efcbd9cffadc94aaf89691eea4ee453940e2)&lt;/p&gt;</comment>
                            <comment id="16207383" author="shalinmangar" created="Tue, 17 Oct 2017 11:03:51 +0000"  >&lt;p&gt;Bulk close after 7.1.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="13064193">SOLR-10494</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12878432" name="SOLR-11136.patch" size="8177" author="hossman" created="Fri, 21 Jul 2017 23:56:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 5 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3hvgv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>