<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:02:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7033] RecoveryStrategy should not publish any state when closed / cancelled.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7033</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Currently, when closed / cancelled, RecoveryStrategy can publish a recovery failed state. In a bad loop (like when no one can become leader because no one had a last state of active) this can cause very fast looped publishing of this state to zk.&lt;/p&gt;

&lt;p&gt;It&apos;s an outstanding item to improve that specific scenario anyway, but regardless, we should fix the close / cancel path to never publish any state to zk.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12769989">SOLR-7033</key>
            <summary>RecoveryStrategy should not publish any state when closed / cancelled.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sarowe">Steven Rowe</assignee>
                                    <reporter username="markrmiller@gmail.com">Mark Miller</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Jan 2015 03:29:23 +0000</created>
                <updated>Mon, 9 May 2016 18:53:40 +0000</updated>
                            <resolved>Fri, 27 Feb 2015 18:46:49 +0000</resolved>
                                                    <fixVersion>4.10.4</fixVersion>
                    <fixVersion>5.0</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="14311077" author="markrmiller@gmail.com" created="Sun, 8 Feb 2015 03:17:22 +0000"  >&lt;p&gt;Here is a new patch that also attempts to make sure that stopped / started recoveries will pause when the last attempt started less than 10 seconds ago.&lt;/p&gt;</comment>
                            <comment id="14311084" author="markrmiller@gmail.com" created="Sun, 8 Feb 2015 03:28:49 +0000"  >&lt;p&gt;Need to move that to a per core location.&lt;/p&gt;</comment>
                            <comment id="14311087" author="markrmiller@gmail.com" created="Sun, 8 Feb 2015 03:39:03 +0000"  >&lt;p&gt;Better patch attatched.&lt;/p&gt;</comment>
                            <comment id="14311144" author="shalinmangar" created="Sun, 8 Feb 2015 06:47:14 +0000"  >&lt;p&gt;+1 LGTM&lt;/p&gt;</comment>
                            <comment id="14311430" author="markrmiller@gmail.com" created="Sun, 8 Feb 2015 17:30:56 +0000"  >&lt;p&gt;I&apos;ve added another throttle on how fast a core will attempt to become the leader in the latest patch.&lt;/p&gt;</comment>
                            <comment id="14311438" author="markrmiller@gmail.com" created="Sun, 8 Feb 2015 17:33:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;+  private final ActionThrottle recoveryThrottle = new ActionThrottle(&quot;recovery attempt&quot;, 10000);&lt;/p&gt;&lt;/blockquote&gt;
&lt;blockquote&gt;&lt;p&gt;+  private final ActionThrottle leaderThrottle = new ActionThrottle(&quot;leader attempt&quot;, 5000);&lt;/p&gt;&lt;/blockquote&gt;

&lt;blockquote&gt;&lt;p&gt;+      log.info(&quot;Throttling {} attempts - waiting for {} ms&quot;, name, sleep);&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;ll consolidate the attempts usage.&lt;/p&gt;</comment>
                            <comment id="14311470" author="markrmiller@gmail.com" created="Sun, 8 Feb 2015 18:22:29 +0000"  >&lt;p&gt;Given the reports in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5961&quot; title=&quot;Solr gets crazy on /overseer/queue state change&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5961&quot;&gt;&lt;del&gt;SOLR-5961&lt;/del&gt;&lt;/a&gt; and other cases of this I&apos;ve seen, I think this is as important as the corrupted index issue to put in 5.0.&lt;/p&gt;</comment>
                            <comment id="14311477" author="jira-bot" created="Sun, 8 Feb 2015 18:33:40 +0000"  >&lt;p&gt;Commit 1658236 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1658236&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1658236&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7033&quot; title=&quot;RecoveryStrategy should not publish any state when closed / cancelled.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7033&quot;&gt;&lt;del&gt;SOLR-7033&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5961&quot; title=&quot;Solr gets crazy on /overseer/queue state change&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5961&quot;&gt;&lt;del&gt;SOLR-5961&lt;/del&gt;&lt;/a&gt;: RecoveryStrategy should not publish any state when closed / cancelled and there should always be a pause between recoveries even when recoveries are rapidly stopped and started as well as when a node attempts to become the leader for a shard.&lt;/p&gt;</comment>
                            <comment id="14311483" author="jira-bot" created="Sun, 8 Feb 2015 18:40:25 +0000"  >&lt;p&gt;Commit 1658237 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1658237&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1658237&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7033&quot; title=&quot;RecoveryStrategy should not publish any state when closed / cancelled.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7033&quot;&gt;&lt;del&gt;SOLR-7033&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5961&quot; title=&quot;Solr gets crazy on /overseer/queue state change&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5961&quot;&gt;&lt;del&gt;SOLR-5961&lt;/del&gt;&lt;/a&gt;: RecoveryStrategy should not publish any state when closed / cancelled and there should always be a pause between recoveries even when recoveries are rapidly stopped and started as well as when a node attempts to become the leader for a shard.&lt;/p&gt;</comment>
                            <comment id="14311517" author="jira-bot" created="Sun, 8 Feb 2015 19:42:37 +0000"  >&lt;p&gt;Commit 1658251 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_5_0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1658251&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1658251&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7033&quot; title=&quot;RecoveryStrategy should not publish any state when closed / cancelled.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7033&quot;&gt;&lt;del&gt;SOLR-7033&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5961&quot; title=&quot;Solr gets crazy on /overseer/queue state change&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5961&quot;&gt;&lt;del&gt;SOLR-5961&lt;/del&gt;&lt;/a&gt;: RecoveryStrategy should not publish any state when closed / cancelled and there should always be a pause between recoveries even when recoveries are rapidly stopped and started as well as when a node attempts to become the leader for a shard.&lt;/p&gt;</comment>
                            <comment id="14313101" author="gchanan" created="Mon, 9 Feb 2015 23:05:15 +0000"  >&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (lastActionStartedAt == 0) {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Probably unlikely to happen, but I believe the call to nanoTime could return any value, even 0.  So it&apos;s possible you could markAttemptingAction and then all calls to minimumWaitBetweenActions just return.&lt;/p&gt;</comment>
                            <comment id="14313245" author="markrmiller@gmail.com" created="Tue, 10 Feb 2015 00:24:50 +0000"  >&lt;p&gt;I&apos;ll add a check. See anything else?&lt;/p&gt;</comment>
                            <comment id="14313305" author="gchanan" created="Tue, 10 Feb 2015 01:03:39 +0000"  >&lt;p&gt;Besides RecoveryStrategy.java, the rest looked fine.   I&apos;m not really familiar with the RecoveryStrategy code, so I&apos;m not sure I can say anything intelligent about it at this point.&lt;/p&gt;</comment>
                            <comment id="14313441" author="markrmiller@gmail.com" created="Tue, 10 Feb 2015 03:03:48 +0000"  >&lt;p&gt;Here is patch. If we don&apos;t end up doing an rc3, I&apos;ll spin it off into a new issue.&lt;/p&gt;</comment>
                            <comment id="14332836" author="anshumg" created="Mon, 23 Feb 2015 05:02:11 +0000"  >&lt;p&gt;Bulk close after 5.0 release.&lt;/p&gt;</comment>
                            <comment id="14340493" author="steve_rowe" created="Fri, 27 Feb 2015 18:14:48 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt;, looks like your last patch on this issue was never committed?&lt;/p&gt;</comment>
                            <comment id="14340546" author="steve_rowe" created="Fri, 27 Feb 2015 18:43:18 +0000"  >&lt;p&gt;Reopening to backport to 4.10.4&lt;/p&gt;</comment>
                            <comment id="14340556" author="jira-bot" created="Fri, 27 Feb 2015 18:46:15 +0000"  >&lt;p&gt;Commit 1662784 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_4_10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1662784&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1662784&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7033&quot; title=&quot;RecoveryStrategy should not publish any state when closed / cancelled.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7033&quot;&gt;&lt;del&gt;SOLR-7033&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5961&quot; title=&quot;Solr gets crazy on /overseer/queue state change&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5961&quot;&gt;&lt;del&gt;SOLR-5961&lt;/del&gt;&lt;/a&gt;: RecoveryStrategy should not publish any state when closed / cancelled and there should always be a pause between recoveries even when recoveries are rapidly stopped and started as well as when a node attempts to become the leader for a shard. (merged branch_5x r1658237)&lt;/p&gt;</comment>
                            <comment id="14340558" author="steve_rowe" created="Fri, 27 Feb 2015 18:46:49 +0000"  >&lt;p&gt;Committed to lucene_solr_4_10.&lt;/p&gt;</comment>
                            <comment id="14348898" author="mikemccand" created="Thu, 5 Mar 2015 15:36:24 +0000"  >&lt;p&gt;Bulk close for 4.10.4 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12769993">SOLR-7034</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12706701">SOLR-5961</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12784653">SOLR-7285</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12919021">SOLR-8371</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12697636" name="SOLR-7033.patch" size="4188" author="markrmiller@gmail.com" created="Tue, 10 Feb 2015 03:03:48 +0000"/>
                            <attachment id="12697339" name="SOLR-7033.patch" size="13447" author="markrmiller@gmail.com" created="Sun, 8 Feb 2015 17:30:56 +0000"/>
                            <attachment id="12697306" name="SOLR-7033.patch" size="10985" author="markrmiller@gmail.com" created="Sun, 8 Feb 2015 03:41:02 +0000"/>
                            <attachment id="12697301" name="SOLR-7033.patch" size="9301" author="markrmiller@gmail.com" created="Sun, 8 Feb 2015 03:17:22 +0000"/>
                            <attachment id="12694463" name="SOLR-7033.patch" size="3302" author="markrmiller@gmail.com" created="Mon, 26 Jan 2015 03:47:54 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24s6v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>