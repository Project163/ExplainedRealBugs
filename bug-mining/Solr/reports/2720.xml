<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:09:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-8307] XXE Vulnerability</title>
                <link>https://issues.apache.org/jira/browse/SOLR-8307</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Use the drop-down in the left menu to select a core. Use the &#8220;Watch Changes&#8221; feature under the &#8220;Plugins / Stats&#8221; option. When submitting the changes, XML is passed in the &#8220;stream.body&#8221; parameter and is vulnerable to XXE.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12913908">SOLR-8307</key>
            <summary>XXE Vulnerability</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ehatcher">Erik Hatcher</assignee>
                                    <reporter username="adam.johnson">Adam Johnson</reporter>
                        <labels>
                    </labels>
                <created>Tue, 17 Nov 2015 22:53:52 +0000</created>
                <updated>Mon, 9 May 2016 18:55:34 +0000</updated>
                            <resolved>Tue, 24 Nov 2015 15:25:57 +0000</resolved>
                                    <version>5.3</version>
                                    <fixVersion>5.4</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>Admin UI</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15010002" author="elyograg" created="Wed, 18 Nov 2015 01:34:06 +0000"  >&lt;p&gt;I looked up how to fix this.  I think this patch might do it.&lt;/p&gt;</comment>
                            <comment id="15010014" author="elyograg" created="Wed, 18 Nov 2015 01:55:04 +0000"  >&lt;p&gt;I&apos;m wondering whether my patch might disable xinclude in Solr&apos;s config files.  My solrconfig.xml file uses xinclude extensively.&lt;/p&gt;</comment>
                            <comment id="15010122" author="elyograg" created="Wed, 18 Nov 2015 03:12:36 +0000"  >&lt;p&gt;I patched the 5.3.2 snapshot I&apos;m trying out, and my solr install is still handling my config with no problem, so it appears that this doesn&apos;t break the xlmns for xinclude.&lt;/p&gt;</comment>
                            <comment id="15010210" author="elyograg" created="Wed, 18 Nov 2015 04:37:32 +0000"  >&lt;p&gt;I found more instances of XMLInputFactory in the codebase.  Here are the classes:&lt;/p&gt;

&lt;p&gt;org.apache.solr.handler.DocumentAnalysisRequestHandler&lt;br/&gt;
org.apache.solr.handler.XmlUpdateRequestHandlerTest&lt;br/&gt;
org.apache.solr.handler.dataimport.XPathRecordReader&lt;br/&gt;
org.apache.solr.handler.loader.XMLLoader&lt;br/&gt;
org.apache.solr.update.AddBlockUpdateTest&lt;br/&gt;
org.apache.solr.util.EmptyEntityResolver&lt;/p&gt;

&lt;p&gt;I do not know if all of these need attention or if some could be left alone.&lt;/p&gt;

&lt;p&gt;It also appear that other XML parsers are in use.  I found SAXParserFactory and DocumentBuilderFactory with grep.  The xerces library is in the ivy config.  My little patch isn&apos;t going to be enough.  This is the document I&apos;m using for information:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://www.owasp.org/index.php/XML_External_Entity_%28XXE%29_Processing&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15011010" author="ehatcher" created="Wed, 18 Nov 2015 13:52:49 +0000"  >&lt;p&gt;At a quick glance, it looks like XMLResponseParser ought to &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;EmptyEntityResolver.configureXMLInputFactory(factory);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;That&apos;s something that &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;thetaphi&lt;/a&gt; probably put in to prevent this issue in other places.  &lt;/p&gt;</comment>
                            <comment id="15011065" author="thetaphi" created="Wed, 18 Nov 2015 14:22:07 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
it should use the code pattern as Erik told. Disabling DTDs completly is not a good idea.&lt;/p&gt;

&lt;p&gt;In general all XML parsing of resources coming from network should follow the same pattern. The EmptyEntityResolver has methods for &lt;b&gt;all&lt;/b&gt; types of XML parsers to disable external entities, so use it&apos;s methods to configure. Grep on EmptyEntityResolver and you will see that all of the above listed parsers are fine (unless somebody broke them again).&lt;/p&gt;

&lt;p&gt;&lt;em&gt;Please note:&lt;/em&gt; This only affects XML coming from the network. Please don&apos;t disable xinclude or external entities in Solr&apos;s config files. Those should not be accessible through internet anyways, if they are you have bigger problems. It is a officially documented feature that you can ue xinclude and external entities to split your solr config files (I generally place the field types and fields each in a separate XML file and include them into the schema).&lt;/p&gt;</comment>
                            <comment id="15011071" author="thetaphi" created="Wed, 18 Nov 2015 14:23:59 +0000"  >&lt;p&gt;The patch attached here just modifies SolrJ. How is this related to config file parsing?&lt;/p&gt;</comment>
                            <comment id="15011084" author="thetaphi" created="Wed, 18 Nov 2015 14:30:27 +0000"  >&lt;p&gt;I checked the code: Where is the XXE risk? The stream.body is going through a safe parser. So do you have a testcase? How did you find out that there is an XXE issue? I spent a whole week 2 years ago on fixing all this problems, so how could they reappear? There are also tests that check to prevent XXE at some places!&lt;/p&gt;

&lt;p&gt;The attached patch only fixes SolrJ, but this is not really a security issue, because it is used to connect to Solr and not arbitrary web sites.&lt;/p&gt;</comment>
                            <comment id="15011174" author="elyograg" created="Wed, 18 Nov 2015 15:20:09 +0000"  >&lt;blockquote&gt;&lt;p&gt;The patch attached here just modifies SolrJ. How is this related to config file parsing?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m flailing in the dark here, and obviously do not really understand the implications of the code examples I found.  The mbeans handler is what was mentioned in the bug report, so I followed that, and it uses XMLResponseParser, so that&apos;s what I modified.  I&apos;m not at all surprised that there&apos;s a better way.&lt;/p&gt;</comment>
                            <comment id="15011180" author="ehatcher" created="Wed, 18 Nov 2015 15:22:11 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;thetaphi&lt;/a&gt; looks like the diff feature of the admin UI sends XML (it got from Solr) to SolrInfoMBeanHandler with diff=true.  And then that XML is parsed by XMLResponseParser.  Looks like a legit vector.&lt;/p&gt;</comment>
                            <comment id="15011185" author="elyograg" created="Wed, 18 Nov 2015 15:23:24 +0000"  >&lt;p&gt;Thank you for taking a look and rescuing me from my lack of knowledge.  I appreciate the things I learn from my colleagues here.&lt;/p&gt;</comment>
                            <comment id="15011225" author="thetaphi" created="Wed, 18 Nov 2015 15:43:34 +0000"  >&lt;p&gt;OK. So a misuse of response parser. This is why it is a Problem. Thanks. I would fix this with the entity resolver. Nothing more to do.&lt;/p&gt;</comment>
                            <comment id="15012694" author="ehatcher" created="Thu, 19 Nov 2015 03:13:32 +0000"  >&lt;p&gt;Here&apos;s a patch that does `EmptyEntityResolver.configureXMLInputFactory` for the SolrInfoMBeanHandler diff feature, including test case that fails without the fix.&lt;/p&gt;

&lt;p&gt;My patch includes a move of EmptyEntityResolver from solr-core to solrj too&lt;/p&gt;</comment>
                            <comment id="15012705" author="ehatcher" created="Thu, 19 Nov 2015 03:25:52 +0000"  >&lt;p&gt;Addressing &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=elyograg&quot; class=&quot;user-hover&quot; rel=&quot;elyograg&quot;&gt;elyograg&lt;/a&gt;&apos;s list above:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;org.apache.solr.handler.DocumentAnalysisRequestHandler: uses EmptyEntityResolver appropriately&lt;/li&gt;
	&lt;li&gt;org.apache.solr.handler.XmlUpdateRequestHandlerTest: this is a test, so no concern (but it does not use EmptyEntityResolver)&lt;/li&gt;
	&lt;li&gt;org.apache.solr.handler.dataimport.XPathRecordReader: uses EmptyEntityResolver&lt;/li&gt;
	&lt;li&gt;org.apache.solr.handler.loader.XMLLoader: uses EmptyEntityResolver&lt;/li&gt;
	&lt;li&gt;org.apache.solr.update.AddBlockUpdateTest:another test, so no concern, but it also does not use EmptyEntityResolver&lt;/li&gt;
	&lt;li&gt;org.apache.solr.util.EmptyEntityResolver: this is the fix to potentially evil external entity references&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So all those look fine.&lt;/p&gt;</comment>
                            <comment id="15012731" author="ehatcher" created="Thu, 19 Nov 2015 03:49:07 +0000"  >&lt;p&gt;Solr&apos;s &quot;ant test&quot; passed locally.  I&apos;ll commit to trunk and branch_5x in the next day or two, barring any objections.&lt;/p&gt;</comment>
                            <comment id="15022382" author="ehatcher" created="Mon, 23 Nov 2015 16:20:45 +0000"  >&lt;p&gt;Forgot to mention JIRA ticket on commit message.  Committed:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;trunk r1715863:  &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1715863&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1715863&amp;amp;view=rev&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;branch_5x r1715864: &lt;a href=&quot;http://svn.apache.org/viewvc?rev=1715864&amp;amp;view=rev&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?rev=1715864&amp;amp;view=rev&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="15023514" author="hossman" created="Tue, 24 Nov 2015 01:00:44 +0000"  >&lt;p&gt;the commits made for this issue have broken trunk and 5x builds due to causing the javadocs to produce broken links.&lt;/p&gt;

&lt;p&gt;some of the affected classes have fundamental problems that can/should be fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8333&quot; title=&quot;fix public methods that take/return private/package-private arguments/results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8333&quot;&gt;&lt;del&gt;SOLR-8333&lt;/del&gt;&lt;/a&gt;, but independent of that this commit &amp;#8211; and the creation of solr/solrj/src/java/org/apache/solr/util/ which competes with solr/core/src/java/org/apache/solr/util/ &amp;#8211; are breaking the build.&lt;/p&gt;

&lt;p&gt;erik: can you please revert this until a better solution is found?(i thought you mentioned earlier today that you would do this &amp;#8211; but that was ~8 hours ago and i&apos;ve seen you make several other commits &amp;amp; jira comments since then w/o actually addressing the immediate problem, so i&apos;m asking you now explicitly: please revert until this issue can be fixed in a way that does not break the build.&lt;/p&gt;</comment>
                            <comment id="15023546" author="jira-bot" created="Tue, 24 Nov 2015 01:25:00 +0000"  >&lt;p&gt;Commit 1716007 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ehatcher&quot; class=&quot;user-hover&quot; rel=&quot;ehatcher&quot;&gt;ehatcher&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1716007&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1716007&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8307&quot; title=&quot;XXE Vulnerability&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8307&quot;&gt;&lt;del&gt;SOLR-8307&lt;/del&gt;&lt;/a&gt;: move EmptyEntityResolver to another package to avoid conflict with solr-core and javadoc generation&lt;/p&gt;</comment>
                            <comment id="15023548" author="jira-bot" created="Tue, 24 Nov 2015 01:26:13 +0000"  >&lt;p&gt;Commit 1716008 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ehatcher&quot; class=&quot;user-hover&quot; rel=&quot;ehatcher&quot;&gt;ehatcher&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1716008&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1716008&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8307&quot; title=&quot;XXE Vulnerability&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8307&quot;&gt;&lt;del&gt;SOLR-8307&lt;/del&gt;&lt;/a&gt;: move EmptyEntityResolver to another package to avoid conflict with solr-core and javadoc generation (merged from trunk r1716007)&lt;/p&gt;</comment>
                            <comment id="15023554" author="ehatcher" created="Tue, 24 Nov 2015 01:31:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman_lucene%40fucit.org&quot; class=&quot;user-hover&quot; rel=&quot;hossman_lucene@fucit.org&quot;&gt;hossman_lucene@fucit.org&lt;/a&gt; - should be fixed now.  I moved EmptyEntityResolver to the common package to as to not overlap.&lt;/p&gt;

&lt;p&gt;Do we need to create a solr-core version of this class (in the util) package to keep the same fully qualified classname for this public class?   I&apos;m ok with it changing, and documenting it in CHANGES.  Objections or suggestions?&lt;/p&gt;</comment>
                            <comment id="15024608" author="ehatcher" created="Tue, 24 Nov 2015 14:37:34 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;thetaphi&lt;/a&gt; - what do you think about the public EmptyEntityResolver moving to another package?   Do you think we should create a back compatible deprecated one in the same place?   I can&apos;t imagine it is being used externally.   I&apos;ll re-open this issue and document the change at least, and add a copy of it back if desired.&lt;/p&gt;</comment>
                            <comment id="15024649" author="thetaphi" created="Tue, 24 Nov 2015 15:09:23 +0000"  >&lt;p&gt;I am fine with that. I don&apos;t think we need backwards compatibility.&lt;/p&gt;</comment>
                            <comment id="15024669" author="ehatcher" created="Tue, 24 Nov 2015 15:25:40 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;thetaphi&lt;/a&gt;.  Documented in CHANGES and committed:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;branch_5x: r1716161 &lt;a href=&quot;https://svn.apache.org/r1716161&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1716161&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;trunk: r1716160 &lt;a href=&quot;https://svn.apache.org/r1716160&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1716160&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                    </comments>
                    <attachments>
                            <attachment id="12773157" name="SOLR-8307.patch" size="8031" author="ehatcher" created="Thu, 19 Nov 2015 03:13:32 +0000"/>
                            <attachment id="12772891" name="SOLR-8307.patch" size="1145" author="elyograg" created="Wed, 18 Nov 2015 01:34:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ojlb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>