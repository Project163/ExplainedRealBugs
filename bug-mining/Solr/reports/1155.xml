<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:32:44 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4150] NPE in distributed result grouping if group.query has no results</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4150</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;If group.query has no results in a distributed search, there is an NPE in the front-end:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Dec 5, 2012 10:40:31 PM org.apache.solr.core.SolrCore execute
INFO: [collection1] webapp=/solr path=/select params={debugQuery=true&amp;amp;group.ngroups=true&amp;amp;fl=thing,eventid&amp;amp;indent=true&amp;amp;q=thing:(&quot;CODE:20517&quot;)&amp;amp;group.field=eventid&amp;amp;group.query=thing:CODE*&amp;amp;group=true&amp;amp;wt=json&amp;amp;fq=source:somewhere} status=500 QTime=745 
Dec 5, 2012 10:40:31 PM org.apache.solr.common.SolrException log
SEVERE: null:java.lang.NullPointerException
	at org.apache.solr.search.grouping.distributed.shardresultserializer.TopGroupsResultTransformer.transformToNative(TopGroupsResultTransformer.java:110)
	at org.apache.solr.search.grouping.distributed.responseprocessor.TopGroupsShardResponseProcessor.process(TopGroupsShardResponseProcessor.java:80)
	at org.apache.solr.handler.component.QueryComponent.handleGroupedResponses(QueryComponent.java:620)
	at org.apache.solr.handler.component.QueryComponent.handleResponses(QueryComponent.java:603)
	at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:309)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:1699)
	at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:455)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:276)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1337)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:484)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:119)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:524)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1065)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:413)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:192)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:999)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:117)
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:250)
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:149)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:111)
	at org.eclipse.jetty.server.Server.handle(Server.java:351)
	at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:454)
	at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:47)
	at org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:890)
	at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:944)
	at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:634)
	at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:230)
	at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:66)
	at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:254)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:599)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:534)
	at java.lang.Thread.run(Thread.java:662)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(This is in sharding, maybe not a SolrCloud problem.)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12618983">SOLR-4150</key>
            <summary>NPE in distributed result grouping if group.query has no results</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="teofili">Tommaso Teofili</assignee>
                                    <reporter username="lancenorskog">Lance Norskog</reporter>
                        <labels>
                    </labels>
                <created>Thu, 6 Dec 2012 04:00:26 +0000</created>
                <updated>Thu, 24 Jan 2013 06:33:43 +0000</updated>
                            <resolved>Thu, 13 Dec 2012 09:30:17 +0000</resolved>
                                    <version>4.0</version>
                                    <fixVersion>4.1</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13530824" author="teofili" created="Thu, 13 Dec 2012 09:30:17 +0000"  >&lt;p&gt;fixed in 1421164 (trunk) and 1421167 (branch_4x)&lt;/p&gt;</comment>
                            <comment id="13530827" author="commit-tag-bot" created="Thu, 13 Dec 2012 09:38:43 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Tommaso Teofili&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1421167&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1421167&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4150&quot; title=&quot;NPE in distributed result grouping if group.query has no results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4150&quot;&gt;&lt;del&gt;SOLR-4150&lt;/del&gt;&lt;/a&gt; - merged back to branch_4x&lt;/p&gt;</comment>
                            <comment id="13530828" author="commit-tag-bot" created="Thu, 13 Dec 2012 09:38:44 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Tommaso Teofili&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1421164&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1421164&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4150&quot; title=&quot;NPE in distributed result grouping if group.query has no results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4150&quot;&gt;&lt;del&gt;SOLR-4150&lt;/del&gt;&lt;/a&gt; - added null checks (with log warnings in case of null) to TopGroupsResultTransformer#transformToNative &lt;/p&gt;</comment>
                            <comment id="13530891" author="commit-tag-bot" created="Thu, 13 Dec 2012 10:44:12 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Tommaso Teofili&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1421211&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1421211&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4150&quot; title=&quot;NPE in distributed result grouping if group.query has no results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4150&quot;&gt;&lt;del&gt;SOLR-4150&lt;/del&gt;&lt;/a&gt; - added missing import for o.a.l.d.Document&lt;/p&gt;</comment>
                            <comment id="13531341" author="hossman" created="Thu, 13 Dec 2012 19:08:45 +0000"  >&lt;p&gt;Tommaso: I think there is still a glitch here that we should try to address..&lt;/p&gt;

&lt;p&gt;In a single node, if you ask for a &quot;group.query&quot; that matches no documents, you get a group back that explicitly says the numFound is 0.&lt;/p&gt;

&lt;p&gt;But with your patch, that group is left completely out of the response.&lt;/p&gt;

&lt;p&gt;the attached patch has a test showing the problem&lt;/p&gt;</comment>
                            <comment id="13531406" author="hossman" created="Thu, 13 Dec 2012 19:57:27 +0000"  >&lt;p&gt;I was hoping there would be a quick fix for this, but the more i dug into the shard result merging logic for grouping, the less i understood it.&lt;/p&gt;

&lt;p&gt;I went ahead and commited my tests, with a workaround to ignore the comparison of the missing group.query between the single node and distributed cases &amp;#8211; so it still demonstrates that the distributed query doesn&apos;t fail, but it ignores the fact that the responses look diff.&lt;/p&gt;

&lt;p&gt;I&apos;ve opened &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4181&quot; title=&quot;grouping response format inconsistent in distributed search when no docs match group.query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4181&quot;&gt;&lt;del&gt;SOLR-4181&lt;/del&gt;&lt;/a&gt; to try and deal with it at a later date.&lt;/p&gt;

&lt;p&gt;Committed revision 1421451.&lt;br/&gt;
Committed revision 1421456.&lt;/p&gt;</comment>
                            <comment id="13531417" author="commit-tag-bot" created="Thu, 13 Dec 2012 20:02:33 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Chris M. Hostetter&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1421456&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1421456&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4150&quot; title=&quot;NPE in distributed result grouping if group.query has no results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4150&quot;&gt;&lt;del&gt;SOLR-4150&lt;/del&gt;&lt;/a&gt;: tests for existing fix.  includes workarround for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4181&quot; title=&quot;grouping response format inconsistent in distributed search when no docs match group.query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4181&quot;&gt;&lt;del&gt;SOLR-4181&lt;/del&gt;&lt;/a&gt; (merge r1421451)&lt;/p&gt;</comment>
                            <comment id="13531419" author="commit-tag-bot" created="Thu, 13 Dec 2012 20:02:35 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Chris M. Hostetter&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1421451&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1421451&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4150&quot; title=&quot;NPE in distributed result grouping if group.query has no results&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4150&quot;&gt;&lt;del&gt;SOLR-4150&lt;/del&gt;&lt;/a&gt;: tests for existing fix.  includes workarround for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4181&quot; title=&quot;grouping response format inconsistent in distributed search when no docs match group.query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4181&quot;&gt;&lt;del&gt;SOLR-4181&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13531453" author="teofili" created="Thu, 13 Dec 2012 20:40:21 +0000"  >&lt;p&gt;thanks Hoss, I&apos;ll take a look myself too tomorrow.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12623804">SOLR-4181</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12560829" name="SOLR-4150.test.patch" size="2812" author="hossman" created="Thu, 13 Dec 2012 19:08:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>296269</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 49 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i14847:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>232778</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>