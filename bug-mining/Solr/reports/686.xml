<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:23:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2606] Solr sort no longer works on field names with some punctuation in them</title>
                <link>https://issues.apache.org/jira/browse/SOLR-2606</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;We just upgraded from Solr 1.4 to 3.2. For the most part the upgrade went fine, however we discovered that sorting on field names with dashes in them is no longer working properly. For example, the following query used to work:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://[our&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://[our&lt;/a&gt; solr server]/select/?q=computer&amp;amp;sort=static-need-binary+asc&lt;/p&gt;

&lt;p&gt;and now it gives this error:&lt;/p&gt;

&lt;p&gt;    HTTP Status 400 - undefined field static&lt;/p&gt;

&lt;p&gt;    type Status report&lt;/p&gt;

&lt;p&gt;    message undefined field static&lt;/p&gt;

&lt;p&gt;    description The request sent by the client was syntactically incorrect (undefined field static).&lt;/p&gt;

&lt;p&gt;It appears the parser for sorting has been changed so that it now tokenizes differently, and assumes field names cannot have dashes in them. However, field names clearly can have dashes in them. The exact same query which worked fine for us in 1.4 is now breaking in 3.2. Changing the sort field to use a field name that doesn&apos;t have a dash in it works just fine.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Linux&lt;/p&gt;</environment>
        <key id="12510747">SOLR-2606</key>
            <summary>Solr sort no longer works on field names with some punctuation in them</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="mitsu">Mitsu Hadeishi</reporter>
                        <labels>
                    </labels>
                <created>Sat, 18 Jun 2011 05:56:00 +0000</created>
                <updated>Fri, 15 Jun 2012 00:18:54 +0000</updated>
                            <resolved>Sun, 31 Jul 2011 22:46:42 +0000</resolved>
                                    <version>3.1</version>
                    <version>3.2</version>
                    <version>3.3</version>
                                    <fixVersion>3.4</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13052958" author="hossman" created="Wed, 22 Jun 2011 00:09:01 +0000"  >&lt;p&gt;thanks for reporting this.&lt;/p&gt;

&lt;p&gt;Another user on the mailing list reported a similar bug with 3.1 when trying to sort on a field named &quot;scores:rails_f&quot; (giving an error of &quot;undefined field scores&quot;)&lt;/p&gt;

&lt;p&gt;I&apos;m fairly certain this is caused by the enhancements made in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1297&quot; title=&quot;Enable sorting by Function Query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1297&quot;&gt;&lt;del&gt;SOLR-1297&lt;/del&gt;&lt;/a&gt; to add sorting on functions.  &lt;/p&gt;

&lt;p&gt;Work was done in that issue to try and ensure that &quot;eccentric&quot; field names could still be used in sorts even when the parsing code was changed, but evidently some basic cases involving punctuation still slipped through the cracks.&lt;/p&gt;</comment>
                            <comment id="13053121" author="janhoy" created="Wed, 22 Jun 2011 08:29:50 +0000"  >&lt;p&gt;Perhaps a test-class producting randomized (legal) field names of could be of use for this and other tests?&lt;/p&gt;</comment>
                            <comment id="13068909" author="ueland" created="Thu, 21 Jul 2011 11:12:17 +0000"  >&lt;p&gt;Confirming this issue for 3.2 (3.2-SNAPSHOT 1133561)&lt;br/&gt;
Data can be loaded from fields (fl), the issue only appears when trying to sort on such fields.&lt;/p&gt;</comment>
                            <comment id="13069860" author="yseeley@gmail.com" created="Sat, 23 Jul 2011 00:31:58 +0000"  >&lt;blockquote&gt;&lt;p&gt;Perhaps a test-class producting randomized (legal) field names of could be of use for this and other tests?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Define &quot;legal&quot; &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;br/&gt;
Lucene has no limits on fieldnames.  I&apos;ve long advocated sticking to java identifiers (minus the $) as best practice for a whole bunch of reasons.  Maybe it was a mistake not enforcing it to begin with.&lt;/p&gt;</comment>
                            <comment id="13073128" author="hossman" created="Sat, 30 Jul 2011 04:51:06 +0000"  >&lt;blockquote&gt;&lt;p&gt;Lucene has no limits on fieldnames. I&apos;ve long advocated sticking to java identifiers (minus the $) as best practice for a whole bunch of reasons. Maybe it was a mistake not enforcing it to begin with.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That ship has kind of sailed.  At this point it&apos;s really a matter of trying to do the best we can with what the users got.&lt;/p&gt;

&lt;p&gt;For those unfamiliar...&lt;/p&gt;

&lt;p&gt;Historically speaking, Solr has never enforced limits on field names except on a feature by feature basis &amp;#8211; so you can have any character you want in field names in your schema.xml, but some characters don&apos;t play nice with some features: whitespace or commas in field names have never worked with the &quot;fl&quot; param, many punctuation characters would cause you problems with the Lucene query parser, etc...&lt;/p&gt;

&lt;p&gt;for sorting, the only limitation until &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1297&quot; title=&quot;Enable sorting by Function Query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1297&quot;&gt;&lt;del&gt;SOLR-1297&lt;/del&gt;&lt;/a&gt; has ever been that you can&apos;t sort on a field containing whitespace, and that naming a field &quot;score&quot; was going to cause you problems.&lt;/p&gt;

&lt;p&gt;With &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1297&quot; title=&quot;Enable sorting by Function Query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1297&quot;&gt;&lt;del&gt;SOLR-1297&lt;/del&gt;&lt;/a&gt; the decision was sorting by function was valuable enough that &quot;things that look like functions&quot; should be parsed as functions, even though it&apos;s theoretically possible that you might have a field named &quot;log(price)&quot; (or a &quot;*&quot; dynamicField) in your schema.&lt;/p&gt;

&lt;p&gt;but at the same time, i added logic to try and ensure that if the function parsing approach didn&apos;t produce a valid sort, it would fallback to the legacy parsing approach before assuming an error (see &quot;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1297&quot; title=&quot;Enable sorting by Function Query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1297&quot;&gt;&lt;del&gt;SOLR-1297&lt;/del&gt;&lt;/a&gt;.better.field.support.patch&quot;)&lt;/p&gt;

&lt;p&gt;Apparently there are some combinations that we missed.&lt;/p&gt;

&lt;p&gt;Attached patch demonstrates the problem specifically with &quot;:&quot; and &quot;-&quot; in field names.&lt;/p&gt;

&lt;p&gt;given that rails uses &quot;:&quot; in field names when using solr, and &quot;-&quot; is a pretty common character for people to expect to work in field names, we should definitely try to get to the bottom of this.&lt;/p&gt;</comment>
                            <comment id="13073130" author="sokolov" created="Sat, 30 Jul 2011 05:13:16 +0000"  >&lt;p&gt;My money&apos;s on this:&lt;/p&gt;

&lt;p&gt;        // short circuit test for a really simple field name&lt;br/&gt;
        String field = sp.getId(null);&lt;/p&gt;

&lt;p&gt;in QueryParsing.parseSort.&lt;/p&gt;

&lt;p&gt;getId() uses isJavaIdentifer() to detect the end of a &quot;simple&quot; field name, which I&apos;m sure can&apos;t match &apos;-&apos; or &apos;:&apos;.&lt;/p&gt;</comment>
                            <comment id="13073138" author="hossman" created="Sat, 30 Jul 2011 05:33:28 +0000"  >&lt;blockquote&gt;&lt;p&gt;My money&apos;s on this:&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Mike: close, but that&apos;s kind of a red herring.&lt;/p&gt;

&lt;p&gt;If you look at &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1297&quot; title=&quot;Enable sorting by Function Query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1297&quot;&gt;&lt;del&gt;SOLR-1297&lt;/del&gt;&lt;/a&gt; and the patch I mentioned you&apos;ll note that since using java identifier rules for field names is considered the common case, that test is done first as a short circuit (like the comment says) and function parsing is done after it &amp;#8211; but if &lt;b&gt;that&lt;/b&gt; fails then the logic i mentioned was suppose to kick in (by catching the exception and then doing the quick &quot;is what&apos;s left a field name?&quot; check)&lt;/p&gt;

&lt;p&gt;after reviewing it a bit, i realized that I was kind of stupid when i added the &quot;is what&apos;s left a field name?&quot; backcompat work in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1297&quot; title=&quot;Enable sorting by Function Query&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1297&quot;&gt;&lt;del&gt;SOLR-1297&lt;/del&gt;&lt;/a&gt;, and overlooked some error cases:&lt;/p&gt;

&lt;p&gt;1) Other types of Exceptions can be thrown by the function parsing besides ParseException (notably: SolrException and NumberFormatException in this test)&lt;br/&gt;
2) the &quot;field&quot; variable wasn&apos;t being reset to null if it was determined that getId(null) had parsed a valid id but that id hadn&apos;t used up enough of the sort spec (ie: wasn&apos;t followed by whitespace).&lt;/p&gt;

&lt;p&gt;Attached patch fixes these oversights and fixes the tests in the previous patch.&lt;/p&gt;

&lt;p&gt;it would be nice to have some more tests to be sure i&apos;m still not missing something stupid.&lt;/p&gt;</comment>
                            <comment id="13073243" author="hossman" created="Sat, 30 Jul 2011 21:19:41 +0000"  >&lt;p&gt;updated patch to include some randomized testing of potential esoteric sort field names.&lt;/p&gt;

&lt;p&gt;also tweaked parse logic to use isWhitespace(peekChar()) (instead of just comparing with &lt;tt&gt;&apos; &apos;&lt;/tt&gt;) to inspect the leftovers after the short circuit getId(null) call since that&apos;s more consistent with eastws() (but didn&apos;t see an easy way to generate randomized whitespace in the test to really sanity check it)&lt;/p&gt;</comment>
                            <comment id="13073399" author="hossman" created="Sun, 31 Jul 2011 22:09:52 +0000"  >&lt;p&gt;Committed revision 1152653. - trunk&lt;/p&gt;

&lt;p&gt;I already know 3x isn&apos;t going to be a straight forward merge, at a minimum because of changes in SortField&lt;/p&gt;</comment>
                            <comment id="13073402" author="hossman" created="Sun, 31 Jul 2011 22:46:42 +0000"  >&lt;p&gt;Committed revision 1152657. - 3x&lt;/p&gt;

&lt;p&gt;If you are using Solr 3.3, you can test out this fix by applying the following patch...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://svn.apache.org/viewvc/lucene/dev/branches/branch_3x/solr/core/src/java/org/apache/solr/search/QueryParsing.java?r1=1152657&amp;amp;r2=1152656&amp;amp;pathrev=1152657&amp;amp;view=patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc/lucene/dev/branches/branch_3x/solr/core/src/java/org/apache/solr/search/QueryParsing.java?r1=1152657&amp;amp;r2=1152656&amp;amp;pathrev=1152657&amp;amp;view=patch&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13106221" author="rcmuir" created="Fri, 16 Sep 2011 14:48:53 +0000"  >&lt;p&gt;bulk close for 3.4&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12547760">SOLR-3267</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12488323" name="SOLR-2606.patch" size="9303" author="hossman" created="Sat, 30 Jul 2011 21:19:41 +0000"/>
                            <attachment id="12488289" name="SOLR-2606.patch" size="2720" author="hossman" created="Sat, 30 Jul 2011 05:33:28 +0000"/>
                            <attachment id="12488286" name="SOLR-2606.test.only.patch" size="1592" author="hossman" created="Sat, 30 Jul 2011 04:51:06 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4940</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 10 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03jqn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18631</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>