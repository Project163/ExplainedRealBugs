<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:18:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9616] Solr throws exception when expand=true on empty result</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9616</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When i run a query with expand=true with field collapsing and the result set is empty an exception is thrown:&lt;/p&gt;

&lt;p&gt;solr:8984/solr/core_en/select?&amp;amp;fq=&lt;/p&gt;
{!collapse field=pid}
&lt;p&gt;&amp;amp;expand=true&amp;amp;expand.rows=10&lt;/p&gt;

&lt;p&gt;Produces:&lt;/p&gt;

&lt;p&gt;  &quot;error&quot;:{&lt;br/&gt;
    &quot;msg&quot;:&quot;Index: 0, Size: 0&quot;,&lt;br/&gt;
    &quot;trace&quot;:&quot;java.lang.IndexOutOfBoundsException: Index: 0, Size: 0\n\tat java.util.ArrayList.rangeCheck(ArrayList.java:653)\n\tat java.util.ArrayList.get(ArrayList.java:429)\n\tat java.util.Collections$UnmodifiableList.get(Collections.java:1309)\n\tat org.apache.solr.handler.component.ExpandComponent.process(ExpandComponent.java:269)\n\tat org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:293)\n\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:156)\n\tat org.apache.solr.core.SolrCore.execute(SolrCore.java:2036)\n\tat org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:657)\n\tat org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:464)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:257)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:208)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:581)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1160)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:511)\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1092)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n\tat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:213)\n\tat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:119)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:518)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:308)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:244)\n\tat org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:273)\n\tat org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)\n\tat org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceAndRun(ExecuteProduceConsume.java:246)\n\tat org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:156)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:654)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:572)\n\tat java.lang.Thread.run(Thread.java:745)\n&quot;,&lt;br/&gt;
    &quot;code&quot;:500}}&lt;/p&gt;

&lt;p&gt;Instead i would assume to get an empty result. &lt;/p&gt;

&lt;p&gt;Is this a bug?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13010996">SOLR-9616</key>
            <summary>Solr throws exception when expand=true on empty result</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ichattopadhyaya">Ishan Chattopadhyaya</assignee>
                                    <reporter username="timo.schmidt">Timo Hund</reporter>
                        <labels>
                    </labels>
                <created>Mon, 10 Oct 2016 11:40:41 +0000</created>
                <updated>Tue, 8 Oct 2019 14:50:29 +0000</updated>
                            <resolved>Thu, 9 Nov 2017 10:10:53 +0000</resolved>
                                    <version>6.2.1</version>
                    <version>6.3</version>
                                    <fixVersion>6.4</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                    <component>SearchComponents - other</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="15562057" author="timo.schmidt" created="Mon, 10 Oct 2016 11:41:42 +0000"  >&lt;p&gt;The behaviour is the same in 6.1.0&lt;/p&gt;</comment>
                            <comment id="15562127" author="timo.schmidt" created="Mon, 10 Oct 2016 12:12:36 +0000"  >&lt;p&gt;6.0.0 is not affected&lt;/p&gt;</comment>
                            <comment id="15622385" author="githubbot" created="Mon, 31 Oct 2016 14:57:38 +0000"  >&lt;p&gt;GitHub user timohund opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/106&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/106&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9616&quot; title=&quot;Solr throws exception when expand=true on empty result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9616&quot;&gt;&lt;del&gt;SOLR-9616&lt;/del&gt;&lt;/a&gt; Return empty result, when expand component is used with empty result set.&lt;/p&gt;

&lt;p&gt;    This pull request:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Add&apos;s early return in expand component, when there is nothing to expand&lt;/li&gt;
	&lt;li&gt;Add&apos;s a regression test for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9616&quot; title=&quot;Solr throws exception when expand=true on empty result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9616&quot;&gt;&lt;del&gt;SOLR-9616&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;    Since i am very new to the code i am not sure if this has any other side effects, by checking the other tests it looks good for me, but help is appreciated.&lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/timohund/lucene-solr&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/timohund/lucene-solr&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9616&quot; title=&quot;Solr throws exception when expand=true on empty result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9616&quot;&gt;&lt;del&gt;SOLR-9616&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/106.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/106.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #106&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 692dec547d22b366099fc328507a847f1e0cf2c8&lt;br/&gt;
Author: Timo Schmidt &amp;lt;timo.hund@yahoo.com&amp;gt;&lt;br/&gt;
Date:   2016-10-31T13:53:52Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9616&quot; title=&quot;Solr throws exception when expand=true on empty result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9616&quot;&gt;&lt;del&gt;SOLR-9616&lt;/del&gt;&lt;/a&gt; Return empty result, when expand component is used with empty result set.&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Add&apos;s early return in expand component, when there is nothing to expand&lt;/li&gt;
	&lt;li&gt;Add&apos;s a regression test for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9616&quot; title=&quot;Solr throws exception when expand=true on empty result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9616&quot;&gt;&lt;del&gt;SOLR-9616&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;hr /&gt;</comment>
                            <comment id="15622780" author="joel.bernstein" created="Mon, 31 Oct 2016 17:20:09 +0000"  >&lt;p&gt;This is quite a nasty bug. Wondering if this is a recent regression, as the expand component has been around quite a long time in Solr 4.&lt;/p&gt;</comment>
                            <comment id="15622786" author="joel.bernstein" created="Mon, 31 Oct 2016 17:21:35 +0000"  >&lt;p&gt;Ah just read the above comments, looks like the bug was introduced in 6.1?&lt;/p&gt;</comment>
                            <comment id="15623472" author="joel.bernstein" created="Mon, 31 Oct 2016 21:25:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=timo.schmidt&quot; class=&quot;user-hover&quot; rel=&quot;timo.schmidt&quot;&gt;timo.schmidt&lt;/a&gt;, in looking through the stack track trace and reviewing the code, it appears that the index you were searching on was empty. Was that the case?&lt;/p&gt;</comment>
                            <comment id="15624684" author="timo.schmidt" created="Tue, 1 Nov 2016 07:53:56 +0000"  >&lt;p&gt;Joel Bernstein, yes as you described it happens with an empty index and seems to be introduced with 6.0&lt;/p&gt;</comment>
                            <comment id="15653575" author="githubbot" created="Thu, 10 Nov 2016 09:32:31 +0000"  >&lt;p&gt;Github user timohund commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/106&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/106&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    Is there anything that i can do, to help to resolve this issue?&lt;/p&gt;</comment>
                            <comment id="15689995" author="timo.schmidt" created="Wed, 23 Nov 2016 12:38:47 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbernste&quot; class=&quot;user-hover&quot; rel=&quot;jbernste&quot;&gt;jbernste&lt;/a&gt; Is there anything i can do to help? This issue might block our release. I also checked with 6.3.0 again and the problem exists there as well.&lt;/p&gt;</comment>
                            <comment id="15709359" author="hossman" created="Wed, 30 Nov 2016 18:31:04 +0000"  >&lt;p&gt;I&apos;m not in a position to apply/test the patch right now, but a quick read looks straight forward and the test seems solid: +1 from me.&lt;/p&gt;</comment>
                            <comment id="15709390" author="ichattopadhyaya" created="Wed, 30 Nov 2016 18:45:46 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman&quot; class=&quot;user-hover&quot; rel=&quot;hossman&quot;&gt;hossman&lt;/a&gt;, I can take a look.&lt;/p&gt;</comment>
                            <comment id="15709476" author="jira-bot" created="Wed, 30 Nov 2016 19:17:40 +0000"  >&lt;p&gt;Commit e64bcb37ffe9ccbe1c88cb451ff147de774aec8e in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e64bcb3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e64bcb3&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9616&quot; title=&quot;Solr throws exception when expand=true on empty result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9616&quot;&gt;&lt;del&gt;SOLR-9616&lt;/del&gt;&lt;/a&gt; Solr throws exception when expand=true on empty index&lt;/p&gt;</comment>
                            <comment id="15709552" author="jira-bot" created="Wed, 30 Nov 2016 19:41:02 +0000"  >&lt;p&gt;Commit 0c3fb754454d5bb43c4511a68ae4d362c9fb40bf in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0c3fb75&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0c3fb75&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9616&quot; title=&quot;Solr throws exception when expand=true on empty result&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9616&quot;&gt;&lt;del&gt;SOLR-9616&lt;/del&gt;&lt;/a&gt; Solr throws exception when expand=true on empty index&lt;/p&gt;</comment>
                            <comment id="15709576" author="ichattopadhyaya" created="Wed, 30 Nov 2016 19:47:01 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=timo.schmidt&quot; class=&quot;user-hover&quot; rel=&quot;timo.schmidt&quot;&gt;timo.schmidt&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16245454" author="timo.schmidt" created="Thu, 9 Nov 2017 10:04:45 +0000"  >&lt;p&gt;I seems that this bug is back in 6.6.2, is it possible to apply that patch on the 6.6 branch?&lt;/p&gt;</comment>
                            <comment id="16245457" author="timo.schmidt" created="Thu, 9 Nov 2017 10:10:53 +0000"  >&lt;p&gt;Sorry, my fault, everything is fine&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 1 week, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i34nyf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>