<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:23:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2726] NullPointerException when using spellcheck.q</title>
                <link>https://issues.apache.org/jira/browse/SOLR-2726</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When I use spellcheck.q in my query to define what will be &quot;spellchecked&quot;, I always have this error, for every configuration I try :&lt;/p&gt;

&lt;p&gt;java.lang.NullPointerException&lt;br/&gt;
at org.apache.solr.handler.component.SpellCheckComponent.getTokens(SpellCheckComponent.java:476)&lt;br/&gt;
at org.apache.solr.handler.component.SpellCheckComponent.process(SpellCheckComponent.java:131)&lt;br/&gt;
at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:202)&lt;br/&gt;
at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:129)&lt;br/&gt;
at org.apache.solr.core.SolrCore.execute(SolrCore.java:1368)&lt;br/&gt;
at org.apache.solr.servlet.SolrDispatchFilter.execute(SolrDispatchFilter.java:356)&lt;br/&gt;
at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:252)&lt;br/&gt;
at org.mortbay.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1212)&lt;br/&gt;
at org.mortbay.jetty.servlet.ServletHandler.handle(ServletHandler.java:399)&lt;br/&gt;
at org.mortbay.jetty.security.SecurityHandler.handle(SecurityHandler.java:216)&lt;br/&gt;
at org.mortbay.jetty.servlet.SessionHandler.handle(SessionHandler.java:182)&lt;br/&gt;
at org.mortbay.jetty.handler.ContextHandler.handle(ContextHandler.java:766)&lt;br/&gt;
at org.mortbay.jetty.webapp.WebAppContext.handle(WebAppContext.java:450)&lt;br/&gt;
at org.mortbay.jetty.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:230)&lt;br/&gt;
at org.mortbay.jetty.handler.HandlerCollection.handle(HandlerCollection.java:114)&lt;br/&gt;
at org.mortbay.jetty.handler.HandlerWrapper.handle(HandlerWrapper.java:152)&lt;br/&gt;
at org.mortbay.jetty.Server.handle(Server.java:326)&lt;br/&gt;
at org.mortbay.jetty.HttpConnection.handleRequest(HttpConnection.java:542)&lt;br/&gt;
at org.mortbay.jetty.HttpConnection$RequestHandler.headerComplete(HttpConnection.java:928)&lt;br/&gt;
at org.mortbay.jetty.HttpParser.parseNext(HttpParser.java:549)&lt;br/&gt;
at org.mortbay.jetty.HttpParser.parseAvailable(HttpParser.java:212)&lt;br/&gt;
at org.mortbay.jetty.HttpConnection.handle(HttpConnection.java:404)&lt;br/&gt;
at org.mortbay.jetty.bio.SocketConnector$Connection.run(SocketConnector.java:228)&lt;br/&gt;
at org.mortbay.thread.QueuedThreadPool$PoolThread.run(QueuedThreadPool.java:582)&lt;/p&gt;

&lt;p&gt;All my other functions works great, this is the only thing which doesn&apos;t work at all, just when i add &quot;&amp;amp;spellcheck.q=my%20sentence&quot; in the query...&lt;/p&gt;

&lt;p&gt;Example of a query : &lt;br/&gt;
&lt;a href=&quot;http://localhost:8983/solr/db/suggest_full?q=american%20israel&amp;amp;spellcheck.q=american%20israel&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/db/suggest_full?q=american%20israel&amp;amp;spellcheck.q=american%20israel&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;In solrconfig.xml :&lt;/p&gt;

&lt;p&gt;&amp;lt;searchComponent name=&quot;suggest_full&quot; class=&quot;solr.SpellCheckComponent&quot;&amp;gt;&lt;br/&gt;
	 &amp;lt;str name=&quot;queryAnalyzerFieldType&quot;&amp;gt;suggestTextFull&amp;lt;/str&amp;gt;&lt;br/&gt;
	 &amp;lt;lst name=&quot;spellchecker&quot;&amp;gt;&lt;br/&gt;
	  &amp;lt;str name=&quot;name&quot;&amp;gt;suggest_full&amp;lt;/str&amp;gt;&lt;br/&gt;
	  &amp;lt;str name=&quot;classname&quot;&amp;gt;org.apache.solr.spelling.suggest.Suggester&amp;lt;/str&amp;gt;&lt;br/&gt;
	  &amp;lt;str name=&quot;lookupImpl&quot;&amp;gt;org.apache.solr.spelling.suggest.tst.TSTLookup&amp;lt;/str&amp;gt;&lt;br/&gt;
	  &amp;lt;str name=&quot;field&quot;&amp;gt;text_suggest_full&amp;lt;/str&amp;gt;&lt;br/&gt;
	  &amp;lt;str name=&quot;fieldType&quot;&amp;gt;suggestTextFull&amp;lt;/str&amp;gt;&lt;br/&gt;
	 &amp;lt;/lst&amp;gt;&lt;br/&gt;
&amp;lt;/searchComponent&amp;gt;&lt;/p&gt;

&lt;p&gt;&amp;lt;requestHandler name=&quot;/suggest_full&quot; class=&quot;org.apache.solr.handler.component.SearchHandler&quot;&amp;gt;&lt;br/&gt;
	&amp;lt;lst name=&quot;defaults&quot;&amp;gt;&lt;br/&gt;
	 &amp;lt;str name=&quot;spellcheck&quot;&amp;gt;true&amp;lt;/str&amp;gt;&lt;br/&gt;
	 &amp;lt;str name=&quot;spellcheck.dictionary&quot;&amp;gt;suggest_full&amp;lt;/str&amp;gt;&lt;br/&gt;
	 &amp;lt;str name=&quot;spellcheck.count&quot;&amp;gt;10&amp;lt;/str&amp;gt;&lt;br/&gt;
	 &amp;lt;str name=&quot;spellcheck.onlyMorePopular&quot;&amp;gt;true&amp;lt;/str&amp;gt;&lt;br/&gt;
	&amp;lt;/lst&amp;gt;&lt;br/&gt;
	&amp;lt;arr name=&quot;components&quot;&amp;gt;&lt;br/&gt;
	 &amp;lt;str&amp;gt;suggest_full&amp;lt;/str&amp;gt;&lt;br/&gt;
	&amp;lt;/arr&amp;gt;&lt;br/&gt;
&amp;lt;/requestHandler&amp;gt;&lt;/p&gt;

&lt;p&gt;I&apos;m using SolR 3.3, and I tried it too on SolR 4.0&lt;/p&gt;</description>
                <environment>&lt;p&gt;ubuntu&lt;/p&gt;</environment>
        <key id="12519799">SOLR-2726</key>
            <summary>NullPointerException when using spellcheck.q</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="rcmuir">Robert Muir</assignee>
                                    <reporter username="vshamsnejad">valentin</reporter>
                        <labels>
                            <label>nullpointerexception</label>
                            <label>spellcheck</label>
                    </labels>
                <created>Tue, 23 Aug 2011 07:48:44 +0000</created>
                <updated>Sun, 27 Nov 2011 12:36:02 +0000</updated>
                            <resolved>Fri, 16 Sep 2011 14:47:19 +0000</resolved>
                                    <version>3.3</version>
                    <version>4.0-ALPHA</version>
                                    <fixVersion>3.5</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                    <component>spellchecker</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13090274" author="vshamsnejad" created="Wed, 24 Aug 2011 14:58:19 +0000"  >&lt;p&gt;I&apos;ve run some tests, and I found that it makes this error when i add a spellcheck component to a handler and i try to use spellcheck.q&lt;/p&gt;

&lt;p&gt;So spellcheck.q works with this kind of use :&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/db/suggest_full?q=american%20israel&amp;amp;spellcheck.q=american%20israel&amp;amp;qt=spellchecker&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/db/suggest_full?q=american%20israel&amp;amp;spellcheck.q=american%20israel&amp;amp;qt=spellchecker&lt;/a&gt; (with the original spellchecker of db)&lt;/p&gt;

&lt;p&gt;But this spellchecker has the class solr.SpellCheckerRequestHandler that doesn&apos;t have all the options I want (like collation).&lt;/p&gt;</comment>
                            <comment id="13091725" author="befehl" created="Fri, 26 Aug 2011 12:06:00 +0000"  >&lt;p&gt;The NPE comes from SpellCheckComponent.process --&amp;gt; SpellCheckComponent.getTokens because there is no analyzer defined, but if using &quot;spellcheck.q&quot; there is an analyzer required.&lt;br/&gt;
This issue is manifold.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;there is no default analyzer defined (like the WhitespaceAnalyzer if only using &quot;q&quot; paramter for suggest)&lt;/li&gt;
	&lt;li&gt;there cannot be any analyzer defined at all for this, beause:
	&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
		&lt;li&gt;no analyzer or spellcheck.analyzer parameter is read from solrconfig.xml for this&lt;/li&gt;
		&lt;li&gt;the class SolrSpellChecker has only getQueryAnalyzer() but no setQueryAnalzyer() to set one&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;How should we fix this?&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;add a default analyzer?&lt;/li&gt;
	&lt;li&gt;add setQueryAnalyzer() to SolrSpellChecker?&lt;/li&gt;
	&lt;li&gt;set analyzer at Suggester.init or SolrSpellChecker.init or SpellCheckComponent.prepare?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Any opinions?&lt;/p&gt;</comment>
                            <comment id="13094558" author="befehl" created="Wed, 31 Aug 2011 14:16:49 +0000"  >&lt;p&gt;According to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-572&quot; title=&quot;Spell Checker as a Search Component&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-572&quot;&gt;&lt;del&gt;SOLR-572&lt;/del&gt;&lt;/a&gt; the default analyzer should be WhitespaceAnalyzer. &lt;br/&gt;
With this &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2726&quot; title=&quot;NullPointerException when using spellcheck.q&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2726&quot;&gt;&lt;del&gt;SOLR-2726&lt;/del&gt;&lt;/a&gt;.patch I added the WhitespaceAnalyzer to &quot;init&quot; of Suggester.java.&lt;br/&gt;
Now spellcheck.q works without NPE.&lt;/p&gt;

&lt;p&gt;Tip:&lt;br/&gt;
To get suggestions with multiple words like &quot;New Y&quot; for &quot;New York&quot; and also for &quot;New Year&quot; you can use queryAnalyzerFieldType with an analyzer having a PatternReplaceFilterFactory for e.g. &quot;_&quot; (underscore).&lt;br/&gt;
If you now lookup up suggestions with New_Y you will get suggestions for &quot;New York&quot;, &quot;New Year&quot;, ...&lt;/p&gt;</comment>
                            <comment id="13102375" author="rcmuir" created="Sun, 11 Sep 2011 23:22:51 +0000"  >&lt;p&gt;In my opinion, since the base class SolrSpellChecker has this &apos;analyzer&apos; field (that it wants to be non-null),&lt;br/&gt;
it should at least take care of it in its init() method, and we should make sure subclasses call super.init(args) in their init() methods.&lt;/p&gt;

&lt;p&gt;When i had this bug in directspellchecker i copied-pasted the below code from AbstractLuceneSpellChecker to fix it, but i think its dumb &lt;br/&gt;
to put this in every spellchecker subclass, and its trappy for someone trying to implement their own spellchecker:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    if (field != null &amp;amp;&amp;amp; core.getSchema().getFieldTypeNoEx(field) != null)  {
      analyzer = core.getSchema().getFieldType(field).getQueryAnalyzer();
    }
    fieldTypeName = (String) config.get(FIELD_TYPE);
    if (core.getSchema().getFieldTypes().containsKey(fieldTypeName))  {
      FieldType fieldType = core.getSchema().getFieldTypes().get(fieldTypeName);
      analyzer = fieldType.getQueryAnalyzer();
    }
    if (analyzer == null)   {
      LOG.info(&quot;Using WhitespaceAnalyzer for dictionary: &quot; + name);
      analyzer = new WhitespaceAnalyzer(core.getSolrConfig().luceneMatchVersion);
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13105534" author="rcmuir" created="Thu, 15 Sep 2011 17:39:34 +0000"  >&lt;p&gt;patch: moves the analyzer construction to SolrSpellChecker&apos;s init (since SolrSpellChecker has this variable).&lt;/p&gt;

&lt;p&gt;also adds a test.&lt;/p&gt;

&lt;p&gt;if we don&apos;t want to do it this way, then the alternative is to make getAnalyzer() abstract in SolrSpellChecker and remove the &apos;analyzer&apos; variable, this way subclasses &lt;b&gt;know&lt;/b&gt; they must deal with this.&lt;/p&gt;
</comment>
                            <comment id="13106192" author="rcmuir" created="Fri, 16 Sep 2011 14:47:19 +0000"  >&lt;p&gt;Thanks valentin, Bernd!&lt;/p&gt;</comment>
                            <comment id="13157834" author="thetaphi" created="Sun, 27 Nov 2011 12:36:02 +0000"  >&lt;p&gt;Bulk close after 3.5 is released&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12494662" name="SOLR-2726.patch" size="8668" author="rcmuir" created="Thu, 15 Sep 2011 17:39:34 +0000"/>
                            <attachment id="12492460" name="SOLR-2726.patch" size="1103" author="befehl" created="Wed, 31 Aug 2011 14:16:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3126</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03iyn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18505</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>