<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:23:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-10815] TestPointFields.testDatePointFieldSortAndFunction() failure</title>
                <link>https://issues.apache.org/jira/browse/SOLR-10815</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;My Jenkins found a reproducing branch_6x seed for a &lt;tt&gt;TestPointFields.testDatePointFieldSortAndFunction()&lt;/tt&gt; failure - note that I had to remove &lt;tt&gt;-Dtests.method=testDatePointFieldSortAndFunction&lt;/tt&gt; from the repro line to get it to reproduce:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Checking out Revision 0f740194e27f4c22d0c79e48115afb2cfd9331dc (refs/remotes/origin/branch_6x)
[...]
   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=TestPointFields -Dtests.method=testDatePointFieldSortAndFunction -Dtests.seed=A1DB5991BA201A4D -Dtests.multiplier=2 -Dtests.nightly=true -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=sv -Dtests.timezone=Europe/Copenhagen -Dtests.asserts=true -Dtests.file.encoding=ISO-8859-1
   [junit4] ERROR   0.43s J6 | TestPointFields.testDatePointFieldSortAndFunction &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.RuntimeException: Exception during query
   [junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([A1DB5991BA201A4D:7666668E19C1B553]:0)
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:895)
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:862)
   [junit4]    &amp;gt; 	at org.apache.solr.schema.TestPointFields.doTestDatePointFunctionQuery(TestPointFields.java:2763)
   [junit4]    &amp;gt; 	at org.apache.solr.schema.TestPointFields.testDatePointFieldSortAndFunction(TestPointFields.java:872)
   [junit4]    &amp;gt; 	at java.lang.Thread.run(Thread.java:745)
   [junit4]    &amp;gt; Caused by: java.lang.RuntimeException: REQUEST FAILED: xpath=//result/doc[10]/date[@name=&apos;number_p_dt_dv_ns&apos;][.=&apos;1995-01-10T10:59:11Z&apos;]
   [junit4]    &amp;gt; 	xml response was: &amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
   [junit4]    &amp;gt; &amp;lt;response&amp;gt;
   [junit4]    &amp;gt; &amp;lt;lst name=&quot;responseHeader&quot;&amp;gt;&amp;lt;int name=&quot;status&quot;&amp;gt;0&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;QTime&quot;&amp;gt;0&amp;lt;/int&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;result name=&quot;response&quot; numFound=&quot;10&quot; start=&quot;0&quot;&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;str name=&quot;id&quot;&amp;gt;9&amp;lt;/str&amp;gt;&amp;lt;date name=&quot;number_p_dt_dv_ns&quot;&amp;gt;1995-01-10T10:59:20Z&amp;lt;/date&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;str name=&quot;id&quot;&amp;gt;8&amp;lt;/str&amp;gt;&amp;lt;date name=&quot;number_p_dt_dv_ns&quot;&amp;gt;1995-01-10T10:59:19Z&amp;lt;/date&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;str name=&quot;id&quot;&amp;gt;7&amp;lt;/str&amp;gt;&amp;lt;date name=&quot;number_p_dt_dv_ns&quot;&amp;gt;1995-01-10T10:59:18Z&amp;lt;/date&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;str name=&quot;id&quot;&amp;gt;0&amp;lt;/str&amp;gt;&amp;lt;date name=&quot;number_p_dt_dv_ns&quot;&amp;gt;1995-01-10T10:59:11Z&amp;lt;/date&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;str name=&quot;id&quot;&amp;gt;3&amp;lt;/str&amp;gt;&amp;lt;date name=&quot;number_p_dt_dv_ns&quot;&amp;gt;1995-01-10T10:59:14Z&amp;lt;/date&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;str name=&quot;id&quot;&amp;gt;2&amp;lt;/str&amp;gt;&amp;lt;date name=&quot;number_p_dt_dv_ns&quot;&amp;gt;1995-01-10T10:59:13Z&amp;lt;/date&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;str name=&quot;id&quot;&amp;gt;1&amp;lt;/str&amp;gt;&amp;lt;date name=&quot;number_p_dt_dv_ns&quot;&amp;gt;1995-01-10T10:59:12Z&amp;lt;/date&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;str name=&quot;id&quot;&amp;gt;6&amp;lt;/str&amp;gt;&amp;lt;date name=&quot;number_p_dt_dv_ns&quot;&amp;gt;1995-01-10T10:59:17Z&amp;lt;/date&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;str name=&quot;id&quot;&amp;gt;5&amp;lt;/str&amp;gt;&amp;lt;date name=&quot;number_p_dt_dv_ns&quot;&amp;gt;1995-01-10T10:59:16Z&amp;lt;/date&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;doc&amp;gt;&amp;lt;str name=&quot;id&quot;&amp;gt;4&amp;lt;/str&amp;gt;&amp;lt;date name=&quot;number_p_dt_dv_ns&quot;&amp;gt;1995-01-10T10:59:15Z&amp;lt;/date&amp;gt;&amp;lt;/doc&amp;gt;&amp;lt;/result&amp;gt;
   [junit4]    &amp;gt; &amp;lt;/response&amp;gt;
   [junit4]    &amp;gt; 	request was:q=*:*&amp;amp;fl=id,+number_p_dt_dv_ns&amp;amp;sort=product(-1,ms(number_p_dt_dv_ns))+asc&amp;amp;wt=xml
   [junit4]    &amp;gt; 	at org.apache.solr.SolrTestCaseJ4.assertQ(SolrTestCaseJ4.java:888)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13077280">SOLR-10815</key>
            <summary>TestPointFields.testDatePointFieldSortAndFunction() failure</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sarowe">Steven Rowe</assignee>
                                    <reporter username="sarowe">Steven Rowe</reporter>
                        <labels>
                    </labels>
                <created>Mon, 5 Jun 2017 16:24:17 +0000</created>
                <updated>Sat, 8 Jun 2019 15:22:18 +0000</updated>
                            <resolved>Tue, 6 Jun 2017 18:27:51 +0000</resolved>
                                                    <fixVersion>6.7</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16039406" author="steve_rowe" created="Tue, 6 Jun 2017 18:26:17 +0000"  >&lt;p&gt;The issue appears to be that this line, called from &lt;tt&gt;testDatePointFieldSortAndFunction()&lt;/tt&gt;, loses precision when converting dates that differ by single seconds into floats for multiplication; as a result, all of the sort values are the same, and the tie breaking sort is by lucene doc value, which can vary depending on previous tests&apos; doc additions and resulting index merges:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;doTestDatePointFunctionQuery()&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2763: assertQ(req(&lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;*:*&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;fl&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;id, &quot;&lt;/span&gt; + field, &lt;span class=&quot;code-quote&quot;&gt;&quot;sort&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;product(-1,ms(&quot;&lt;/span&gt; + field + &lt;span class=&quot;code-quote&quot;&gt;&quot;)) asc&quot;&lt;/span&gt;),
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman&quot; class=&quot;user-hover&quot; rel=&quot;hossman&quot;&gt;hossman&lt;/a&gt; pointed me to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10266&quot; title=&quot;invalid assumptions about doc order in TestPointFields, masking test bug with date functions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10266&quot;&gt;&lt;del&gt;SOLR-10266&lt;/del&gt;&lt;/a&gt;, where &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10266?focusedCommentId=15923703&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-15923703&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;wrote&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;Hoss Man I checked the test and you actually right. The test is badly written, It should change from&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;assertQ(req(&lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;*:*&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;fl&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;id, &quot;&lt;/span&gt; + dvFieldName, &lt;span class=&quot;code-quote&quot;&gt;&quot;sort&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;product(-1,&quot;&lt;/span&gt; + dvFieldName + &lt;span class=&quot;code-quote&quot;&gt;&quot;) asc&quot;&lt;/span&gt;),&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;to&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;assertQ(req(&lt;span class=&quot;code-quote&quot;&gt;&quot;q&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;*:*&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;fl&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;id, &quot;&lt;/span&gt; + dvFieldName, &lt;span class=&quot;code-quote&quot;&gt;&quot;sort&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;product(-1,ms(&quot;&lt;/span&gt; + dvFieldName + &lt;span class=&quot;code-quote&quot;&gt;&quot;,&quot;&lt;/span&gt;+baseDate+&lt;span class=&quot;code-quote&quot;&gt;&quot;)) desc&quot;&lt;/span&gt;)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;But the sorting by function on DatePointField still work. Because &lt;tt&gt;ProductFloatFunction&lt;/tt&gt; is used for &lt;tt&gt;product()&lt;/tt&gt; so the long value ( of date field ) will be converted into float before doing multiplication. It lead into losing some last decimals. So they will end up with same value &lt;tt&gt;7.8973554E11&lt;/tt&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The attached patch (for branch_6x) applies the same fix as outlined by Dat above; with the patch, the seed in the description no longer reproduces.&lt;/p&gt;

&lt;p&gt;Committing shortly.&lt;/p&gt;</comment>
                            <comment id="16039412" author="jira-bot" created="Tue, 6 Jun 2017 18:27:23 +0000"  >&lt;p&gt;Commit d7fdbc48a4f31fde34752409e541823ba2ff8f38 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d7fdbc4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d7fdbc4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10815&quot; title=&quot;TestPointFields.testDatePointFieldSortAndFunction() failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10815&quot;&gt;&lt;del&gt;SOLR-10815&lt;/del&gt;&lt;/a&gt;: avoid long-&amp;gt;float precision loss in &apos;product(-1,ms(date_field)&apos; by subtracting a base date: &apos;product(-1,ms(date_field,base_date_field))&apos;&lt;/p&gt;</comment>
                            <comment id="16039413" author="jira-bot" created="Tue, 6 Jun 2017 18:27:26 +0000"  >&lt;p&gt;Commit 98e103731f15782e9d0c67b3998216801d2164a1 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=98e1037&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=98e1037&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10815&quot; title=&quot;TestPointFields.testDatePointFieldSortAndFunction() failure&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10815&quot;&gt;&lt;del&gt;SOLR-10815&lt;/del&gt;&lt;/a&gt;: avoid long-&amp;gt;float precision loss in &apos;product(-1,ms(date_field)&apos; by subtracting a base date: &apos;product(-1,ms(date_field,base_date_field))&apos;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13050112">SOLR-10266</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12871653" name="SOLR-10815.patch" size="928" author="sarowe" created="Tue, 6 Jun 2017 18:26:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 24 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3fvrz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>