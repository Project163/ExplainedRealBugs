<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:29:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-11447] ZkStateWriter should process commands in atomic</title>
                <link>https://issues.apache.org/jira/browse/SOLR-11447</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;ZkStateWriter should process all the ZkWriteCommands correspond to a message in atomic ( we are processing one by one command right now ). Some ZkWriteCommands can get lost. Here is the case :&lt;br/&gt;
1. We process DOWNNODE message ( whatever message that produces multiple ZkWriteComand ).&lt;br/&gt;
2. We poll that message from stateUpdateQueue and push it to workQueue ( for backup ).&lt;br/&gt;
3. The DOWNNODE message is converted into multiple ZkWriteCommand&lt;br/&gt;
4. We enqueue one by one ZkWriteCommand into ZkStateWriter. Any command can trigger flush, which calls the onWrite() callback to empty workQueue&lt;br/&gt;
5. The Overseer gets restarted, and the rest of ZkWriteCommands (which not get processed in step 4) will be lost because the workQueue is empty now (because onWrite() callback in step 4)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13107885">SOLR-11447</key>
            <summary>ZkStateWriter should process commands in atomic</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="caomanhdat">Cao Manh Dat</assignee>
                                    <reporter username="caomanhdat">Cao Manh Dat</reporter>
                        <labels>
                    </labels>
                <created>Mon, 9 Oct 2017 04:17:11 +0000</created>
                <updated>Wed, 2 Oct 2019 17:24:26 +0000</updated>
                            <resolved>Tue, 17 Oct 2017 04:13:24 +0000</resolved>
                                                    <fixVersion>7.2</fixVersion>
                    <fixVersion>8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16198035" author="caomanhdat" created="Tue, 10 Oct 2017 02:08:01 +0000"  >&lt;p&gt;My patch for this ticket, including test. This patch&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;ZkStateWriter.enqueueUpdate now accept a list of ZkWriteCommand instead of just single ZkWriteCommand&lt;/li&gt;
	&lt;li&gt;do some refactoring in enqueueUpdate to makes it cleaner&lt;/li&gt;
	&lt;li&gt;do a change on ZkStateWriter.maybeFlushAfter, right now we use updates.size() to trigger the flush, but I think this logic is wrong, because of updates.size() equals to the number of collection get changed not how many ZkWriteCommand get processed.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;But I kinda confuse on handling ZkStateWriter.maybeFlushBefore with multiple commands, can you please take a look?&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16203188" author="caomanhdat" created="Fri, 13 Oct 2017 08:17:42 +0000"  >&lt;p&gt;Updated patch :&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Removing maybeFlushBefore()&lt;/li&gt;
	&lt;li&gt;Handle NO_OP correctly&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Will commit soon.&lt;/p&gt;</comment>
                            <comment id="16203191" author="jira-bot" created="Fri, 13 Oct 2017 08:23:57 +0000"  >&lt;p&gt;Commit 8a7d04a6582e6f1509660300d5421da034593420 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8a7d04a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8a7d04a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11447&quot; title=&quot;ZkStateWriter should process commands in atomic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11447&quot;&gt;&lt;del&gt;SOLR-11447&lt;/del&gt;&lt;/a&gt;: ZkStateWriter should process commands in atomic&lt;/p&gt;</comment>
                            <comment id="16205625" author="jira-bot" created="Mon, 16 Oct 2017 09:32:57 +0000"  >&lt;p&gt;Commit dea85256a485800b8ddebc149bc6765e7da90412 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=dea8525&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=dea8525&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11447&quot; title=&quot;ZkStateWriter should process commands in atomic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11447&quot;&gt;&lt;del&gt;SOLR-11447&lt;/del&gt;&lt;/a&gt;: ZkStateWriter should process commands in atomic&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12892005" name="SOLR-11447.patch" size="29238" author="caomanhdat" created="Fri, 13 Oct 2017 08:17:14 +0000"/>
                            <attachment id="12891192" name="SOLR-11447.patch" size="21504" author="caomanhdat" created="Tue, 10 Oct 2017 02:13:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 5 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3l0i7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>