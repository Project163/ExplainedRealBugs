<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:48:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-15531] IllegalArgumentException while executing streaming expression with significantTerms on an empty collection </title>
                <link>https://issues.apache.org/jira/browse/SOLR-15531</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;We use the significantTerms function quite a lot against aliases. Recently that ran into an error, when one of our collections in that alias didn&apos;t contain any documents. &lt;/p&gt;

&lt;p&gt;It&apos;s very easy to reproduce:&lt;br/&gt;
1. Create an empty collection&lt;br/&gt;
2. Execute the following streaming expression&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;significantTerms(empty,
                 q=&quot;concepts_ss:[* TO *]&quot;,
                 field=&quot;concepts_ss&quot;,
                 limit=&quot;50&quot;,
                 minDocFreq=&quot;3&quot;,
                 maxDocFreq=&quot;0.7&quot;,
                 minTermLength=&quot;4&quot;)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Solr Log Stacktrace:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2021-07-12 16:01:29.622 ERROR (qtp1508181426-479) [c:empty s:shard1 r:core_node2 x:empty_shard1_replica_n1] o.a.s.h.RequestHandlerBase java.lang.IllegalArgumentException: length needs to be &amp;gt;= 1
	at org.apache.lucene.util.SparseFixedBitSet.&amp;lt;init&amp;gt;(SparseFixedBitSet.java:60)
	at org.apache.solr.search.SignificantTermsQParserPlugin$SignifcantTermsCollector.&amp;lt;init&amp;gt;(SignificantTermsQParserPlugin.java:115)
	at org.apache.solr.search.SignificantTermsQParserPlugin$SignificantTermsQuery.getAnalyticsCollector(SignificantTermsQParserPlugin.java:92)
	at org.apache.solr.search.AnalyticsQuery.getFilterCollector(AnalyticsQuery.java:76)
	at org.apache.solr.search.SolrIndexSearcher.getProcessedFilter(SolrIndexSearcher.java:1079)
	at org.apache.solr.search.SolrIndexSearcher.getDocListNC(SolrIndexSearcher.java:1532)
	at org.apache.solr.search.SolrIndexSearcher.getDocListC(SolrIndexSearcher.java:1413)
	at org.apache.solr.search.SolrIndexSearcher.search(SolrIndexSearcher.java:596)
	at org.apache.solr.handler.component.QueryComponent.doProcessUngroupedSearch(QueryComponent.java:1513)
	at org.apache.solr.handler.component.QueryComponent.process(QueryComponent.java:403)
	at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:360)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:214)
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:2627)
	at org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:795)
	at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:568)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:415)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:345)
	at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1596)
	at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:545)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
	at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:590)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
	at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1610)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
	at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1300)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
	at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:485)
	at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1580)
	at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
	at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1215)
	at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
	at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:221)
	at org.eclipse.jetty.server.handler.InetAccessHandler.handle(InetAccessHandler.java:177)
	at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:322)
	at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
	at org.eclipse.jetty.server.Server.handle(Server.java:500)
	at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:383)
	at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:547)
	at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:375)
	at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:273)
	at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
	at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:103)
	at org.eclipse.jetty.io.ChannelEndPoint$2.run(ChannelEndPoint.java:117)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:336)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:313)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:171)
	at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:129)
	at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:375)
	at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:806)
	at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:938)
	at java.base/java.lang.Thread.run(Unknown Source)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I&apos;ve already prepared Unit Tests to reproduce and a fix for the issue. I&apos;ll attach a pull request soon.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13389185">SOLR-15531</key>
            <summary>IllegalArgumentException while executing streaming expression with significantTerms on an empty collection </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mdrob">Mike Drob</assignee>
                                    <reporter username="badbenarnold">Benedikt Arnold</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Jul 2021 16:15:17 +0000</created>
                <updated>Tue, 28 Sep 2021 20:27:40 +0000</updated>
                            <resolved>Thu, 15 Jul 2021 19:44:23 +0000</resolved>
                                    <version>8.7</version>
                                    <fixVersion>9.0</fixVersion>
                    <fixVersion>8.10</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4200">1h 10m</timespent>
                                <comments>
                            <comment id="17379344" author="badbenarnold" created="Mon, 12 Jul 2021 19:45:03 +0000"  >&lt;p&gt;This is the pull request that I mentioned: &lt;a href=&quot;https://github.com/apache/solr/pull/212&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/pull/212&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17381558" author="jira-bot" created="Thu, 15 Jul 2021 19:43:03 +0000"  >&lt;p&gt;Commit 5346024eefc7139de215ea24ccc551d624280144 in solr&apos;s branch refs/heads/main from Benedikt Arnold&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=5346024&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=5346024&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15531&quot; title=&quot;IllegalArgumentException while executing streaming expression with significantTerms on an empty collection &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15531&quot;&gt;&lt;del&gt;SOLR-15531&lt;/del&gt;&lt;/a&gt;: significantTerms streaming function should not fail on empty collections (#212)&lt;/p&gt;
</comment>
                            <comment id="17381559" author="jira-bot" created="Thu, 15 Jul 2021 19:43:54 +0000"  >&lt;p&gt;Commit b954696c1184ad4d306ea3ddbea577ba7eb6e793 in lucene-solr&apos;s branch refs/heads/branch_8x from Benedikt Arnold&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=b954696&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=b954696&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15531&quot; title=&quot;IllegalArgumentException while executing streaming expression with significantTerms on an empty collection &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15531&quot;&gt;&lt;del&gt;SOLR-15531&lt;/del&gt;&lt;/a&gt;: SignificantTerms streaming function should not fail on empty collections&lt;/p&gt;</comment>
                            <comment id="17381560" author="mdrob" created="Thu, 15 Jul 2021 19:44:24 +0000"  >&lt;p&gt;Thanks for the PR, I updated the CHANGES file, and then committed to 8.x and 9.x!&lt;/p&gt;</comment>
                            <comment id="17389075" author="jira-bot" created="Wed, 28 Jul 2021 21:13:33 +0000"  >&lt;p&gt;Commit e7e80b1c5f6e900c11ca694e2cdc60667b788a06 in solr&apos;s branch refs/heads/main from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=e7e80b1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=e7e80b1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15531&quot; title=&quot;IllegalArgumentException while executing streaming expression with significantTerms on an empty collection &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15531&quot;&gt;&lt;del&gt;SOLR-15531&lt;/del&gt;&lt;/a&gt;: Cross-collection join fixed to ignore documents that do not contain value in from field&lt;/p&gt;</comment>
                            <comment id="17389099" author="jira-bot" created="Wed, 28 Jul 2021 22:35:30 +0000"  >&lt;p&gt;Commit 1e6e2ddc4212f0163567ede023d696338e6b2813 in lucene-solr&apos;s branch refs/heads/branch_8x from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=1e6e2dd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=1e6e2dd&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15531&quot; title=&quot;IllegalArgumentException while executing streaming expression with significantTerms on an empty collection &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15531&quot;&gt;&lt;del&gt;SOLR-15531&lt;/del&gt;&lt;/a&gt;: Cross-collection join fixed to ignore documents that do not contain value in from field&lt;/p&gt;

&lt;p&gt;(cherry picked from commit e7e80b1c5f6e900c11ca694e2cdc60667b788a06)&lt;/p&gt;</comment>
                            <comment id="17389860" author="ctargett" created="Thu, 29 Jul 2021 12:13:36 +0000"  >&lt;p&gt;The last 2 commits here should have been attributed to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15482&quot; title=&quot;Cross-collection join when document is missing &amp;#39;from&amp;#39; field throws NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15482&quot;&gt;&lt;del&gt;SOLR-15482&lt;/del&gt;&lt;/a&gt; instead; this issue was already fixed and the new commits didn&apos;t touch the same files.&lt;/p&gt;</comment>
                            <comment id="17389989" author="jira-bot" created="Thu, 29 Jul 2021 15:51:06 +0000"  >&lt;p&gt;Commit 1925693127e81cf0125bcb55f1b05591dea8b203 in solr&apos;s branch refs/heads/main from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=1925693&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=1925693&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15482&quot; title=&quot;Cross-collection join when document is missing &amp;#39;from&amp;#39; field throws NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15482&quot;&gt;&lt;del&gt;SOLR-15482&lt;/del&gt;&lt;/a&gt;: correct CHANGES.txt entry erroneously refering to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15531&quot; title=&quot;IllegalArgumentException while executing streaming expression with significantTerms on an empty collection &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15531&quot;&gt;&lt;del&gt;SOLR-15531&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17389992" author="jira-bot" created="Thu, 29 Jul 2021 15:52:34 +0000"  >&lt;p&gt;Commit 7305a0deca941d539b71c417a9d82b8a08b32227 in lucene-solr&apos;s branch refs/heads/branch_8x from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7305a0d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7305a0d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15482&quot; title=&quot;Cross-collection join when document is missing &amp;#39;from&amp;#39; field throws NPE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15482&quot;&gt;&lt;del&gt;SOLR-15482&lt;/del&gt;&lt;/a&gt;: correct CHANGES.txt entry erroneously refering to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15531&quot; title=&quot;IllegalArgumentException while executing streaming expression with significantTerms on an empty collection &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15531&quot;&gt;&lt;del&gt;SOLR-15531&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 1925693127e81cf0125bcb55f1b05591dea8b203)&lt;/p&gt;</comment>
                            <comment id="17421756" author="thelabdude" created="Tue, 28 Sep 2021 20:23:13 +0000"  >&lt;p&gt;Closing after the 8.10.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 7 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0svao:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>