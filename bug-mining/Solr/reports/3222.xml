<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:19:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9979] Macro expansion should not be done in shard requests</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9979</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Macro expansion is done when parsing the query for the first time, it should not be re-done in shard requests.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13035948">SOLR-9979</key>
            <summary>Macro expansion should not be done in shard requests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="tflobbe">Tomas Eduardo Fernandez Lobbe</assignee>
                                    <reporter username="tflobbe">Tomas Eduardo Fernandez Lobbe</reporter>
                        <labels>
                    </labels>
                <created>Wed, 18 Jan 2017 18:17:00 +0000</created>
                <updated>Wed, 2 Oct 2019 17:30:22 +0000</updated>
                            <resolved>Wed, 18 Jan 2017 19:01:09 +0000</resolved>
                                                    <fixVersion>6.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15828552" author="jira-bot" created="Wed, 18 Jan 2017 18:53:19 +0000"  >&lt;p&gt;Commit 68d246df003278ba0c35ae5f43872340b676a02f in lucene-solr&apos;s branch refs/heads/master from Tomas Fernandez Lobbe&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=68d246d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=68d246d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9979&quot; title=&quot;Macro expansion should not be done in shard requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9979&quot;&gt;&lt;del&gt;SOLR-9979&lt;/del&gt;&lt;/a&gt;: Macro expansion should not be done in shard requests&lt;/p&gt;</comment>
                            <comment id="15828568" author="jira-bot" created="Wed, 18 Jan 2017 19:00:28 +0000"  >&lt;p&gt;Commit 0e728461e9a46d0e17d0b7a262648a6732b31cf0 in lucene-solr&apos;s branch refs/heads/branch_6x from Tomas Fernandez Lobbe&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0e72846&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=0e72846&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9979&quot; title=&quot;Macro expansion should not be done in shard requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9979&quot;&gt;&lt;del&gt;SOLR-9979&lt;/del&gt;&lt;/a&gt;: Macro expansion should not be done in shard requests&lt;/p&gt;</comment>
                            <comment id="15878515" author="jira-bot" created="Wed, 22 Feb 2017 15:49:47 +0000"  >&lt;p&gt;Commit c58eac13378f618532190348574d96a72ef413e7 in lucene-solr&apos;s branch refs/heads/branch_6x from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c58eac1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c58eac1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9977&quot; title=&quot;reproducible failures in DistribDocExpirationUpdateProcessorTest due to IndexWriterConfig randomization&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9977&quot;&gt;&lt;del&gt;SOLR-9977&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9979&quot; title=&quot;Macro expansion should not be done in shard requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9979&quot;&gt;&lt;del&gt;SOLR-9979&lt;/del&gt;&lt;/a&gt;: move CHANGES entries to correct section (Bug)&lt;/p&gt;

&lt;p&gt;Aparently these were shifted during merge/cherry-picks&lt;/p&gt;</comment>
                            <comment id="15943059" author="alessandro.benedetti" created="Mon, 27 Mar 2017 11:10:47 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tflobbe&quot; class=&quot;user-hover&quot; rel=&quot;tflobbe&quot;&gt;tflobbe&lt;/a&gt;,&lt;br/&gt;
what happens now in this scenario :&lt;/p&gt;

&lt;p&gt;1) Manual Distributed Search with not uniform data model across shards.&lt;/p&gt;

&lt;p&gt;q=${pop_query}&lt;br/&gt;
&amp;amp;pop_query=${pop_field}:[ ${low} TO ${high} ] AND inStock:true&lt;br/&gt;
&amp;amp;low=50&lt;br/&gt;
&amp;amp;high=100&lt;/p&gt;

&lt;p&gt;Each shard has a different popularity field, each shard defines this field as a parameter substitution :&lt;br/&gt;
Shard1 Request Handler&lt;br/&gt;
&amp;lt;str name=&quot;pop_field&quot;&amp;gt;popularity&amp;lt;/str&amp;gt;&lt;/p&gt;

&lt;p&gt;Shard 2 Request Handler&lt;br/&gt;
&amp;lt;str name=&quot;pop_field&quot;&amp;gt;clicks&amp;lt;/str&amp;gt;&lt;/p&gt;

&lt;p&gt;2) SolrCloud inter collection search&lt;br/&gt;
Same scenario, but each collection may define  a different mapping.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;</comment>
                            <comment id="15943060" author="alessandro.benedetti" created="Mon, 27 Mar 2017 11:12:18 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tflobbe&quot; class=&quot;user-hover&quot; rel=&quot;tflobbe&quot;&gt;tflobbe&lt;/a&gt;,&lt;br/&gt;
what happens now in this scenario :&lt;/p&gt;

&lt;p&gt;1) Manual Distributed Search with not uniform data model across shards.&lt;/p&gt;

&lt;p&gt;q=${pop_query}&lt;br/&gt;
&amp;amp;pop_query=${pop_field}:[ ${low} TO ${high} ] AND inStock:true&lt;br/&gt;
&amp;amp;low=50&lt;br/&gt;
&amp;amp;high=100&lt;/p&gt;

&lt;p&gt;Each shard has a different popularity field, each shard defines this field as a parameter substitution :&lt;br/&gt;
Shard1 Request Handler&lt;br/&gt;
&amp;lt;str name=&quot;pop_field&quot;&amp;gt;popularity&amp;lt;/str&amp;gt;&lt;/p&gt;

&lt;p&gt;Shard 2 Request Handler&lt;br/&gt;
&amp;lt;str name=&quot;pop_field&quot;&amp;gt;clicks&amp;lt;/str&amp;gt;&lt;/p&gt;

&lt;p&gt;2) SolrCloud inter collection search&lt;br/&gt;
Same scenario, but each collection may define  a different mapping.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;</comment>
                            <comment id="15943703" author="tomasflobbe" created="Mon, 27 Mar 2017 17:40:09 +0000"  >&lt;p&gt;Hi &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=alessandro.benedetti&quot; class=&quot;user-hover&quot; rel=&quot;alessandro.benedetti&quot;&gt;alessandro.benedetti&lt;/a&gt;, &lt;br/&gt;
Those use cases are not supported after this change, some of it could be achieved by using parameter dereferencing with Local Params. I would argue that in general searching across collections with different configs is not supported (as there are no tests!), but feel free to open a new Jira to improve this change.&lt;/p&gt;</comment>
                            <comment id="15947216" author="alessandro.benedetti" created="Wed, 29 Mar 2017 14:20:48 +0000"  >&lt;p&gt;Uhm, so this patch breaks that feature, but you say that that was not a feature at all but a side effect ?&lt;br/&gt;
I am still a little bit confuse, what are the benefits of this patch ?&lt;br/&gt;
In my opinion the feature I mentioned was quite useful and it has been supported for a while &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="15947425" author="tomasflobbe" created="Wed, 29 Mar 2017 16:17:37 +0000"  >&lt;blockquote&gt;&lt;p&gt;you say that that was not a feature at all but a side effect ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;Not sure if that was intentional or not. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yseeley%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yseeley@gmail.com&quot;&gt;yseeley@gmail.com&lt;/a&gt;, were you thinking in this use case?&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;I am still a little bit confuse, what are the benefits of this patch ?&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;The issue I saw is that internal requests can add parameter that are not intended for macro expansion (for example in facet refinement), and treating them as macros can cause exceptions or incorrect results (see the test case I added).&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;In my opinion the feature I mentioned was quite useful and it has been supported for a while &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;We can&apos;t reopen this Jira, since it was already released, but feel free to create a new one to support your use case&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12848109" name="SOLR-9979.patch" size="6969" author="tflobbe" created="Wed, 18 Jan 2017 18:31:21 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 33 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i38vy7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>