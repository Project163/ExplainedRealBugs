<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:34:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4373] In multicore, lib directives in solrconfig.xml cause conflict and clobber directives from earlier cores</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4373</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Having lib directives in the solrconfig.xml files of multiple cores can cause problems when using multi-threaded core initialization &amp;#8211; which is the default starting with Solr 4.1.&lt;/p&gt;

&lt;p&gt;The problem manifests itself as init errors in the logs related to not being able to find classes located in plugin jars, even though earlier log messages indicated that those jars had been added to the classpath.&lt;/p&gt;

&lt;p&gt;One work around is to set &lt;tt&gt;coreLoadThreads=&quot;1&quot;&lt;/tt&gt; in your solr.xml file &amp;#8211; forcing single threaded core initialization.  For example...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;utf-8&quot;&lt;/span&gt; ?&amp;gt;
&amp;lt;solr coreLoadThreads=&lt;span class=&quot;code-quote&quot;&gt;&quot;1&quot;&lt;/span&gt;&amp;gt;
  &amp;lt;cores adminPath=&lt;span class=&quot;code-quote&quot;&gt;&quot;/admin/cores&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;core name=&lt;span class=&quot;code-quote&quot;&gt;&quot;core1&quot;&lt;/span&gt; instanceDir=&lt;span class=&quot;code-quote&quot;&gt;&quot;core1&quot;&lt;/span&gt; /&amp;gt;
    &amp;lt;core name=&lt;span class=&quot;code-quote&quot;&gt;&quot;core2&quot;&lt;/span&gt; instanceDir=&lt;span class=&quot;code-quote&quot;&gt;&quot;core2&quot;&lt;/span&gt; /&amp;gt;
  &amp;lt;/cores&amp;gt;
&amp;lt;/solr&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;(Similar problems may occur if multiple cores are initialized concurrently using the /admin/cores handler)&lt;/p&gt;</description>
                <environment></environment>
        <key id="12629612">SOLR-4373</key>
            <summary>In multicore, lib directives in solrconfig.xml cause conflict and clobber directives from earlier cores</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="arafalov">Alexandre Rafalovitch</reporter>
                        <labels>
                            <label>lib</label>
                            <label>multicore</label>
                    </labels>
                <created>Tue, 29 Jan 2013 01:07:42 +0000</created>
                <updated>Fri, 10 May 2013 10:34:37 +0000</updated>
                            <resolved>Mon, 11 Mar 2013 21:17:51 +0000</resolved>
                                    <version>4.1</version>
                    <version>4.2</version>
                                    <fixVersion>4.2</fixVersion>
                                    <component>multicore</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13564937" author="arafalov" created="Tue, 29 Jan 2013 01:09:16 +0000"  >&lt;p&gt;Full Solr setup with two cores showing the problem. Disable the second core in solr.xml to make the problem go away. Log files for both scenarios are included.&lt;/p&gt;</comment>
                            <comment id="13565053" author="hossman" created="Tue, 29 Jan 2013 03:58:31 +0000"  >&lt;p&gt;Damn.....&lt;/p&gt;

&lt;p&gt;I can reproduce this problem in 4.1, but not with 4.0, leading me to suspect that it is probably caused by the changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4063&quot; title=&quot;CoreContainer should be able to load multiple SolrCore&amp;#39;s in parallel rather than just serially.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4063&quot;&gt;&lt;del&gt;SOLR-4063&lt;/del&gt;&lt;/a&gt; to initialize SolrCore&apos;s in parallel.&lt;/p&gt;

&lt;p&gt;adding &lt;tt&gt;coreLoadThreads=&quot;1&quot;&lt;/tt&gt; to the &lt;tt&gt;&amp;lt;solr/&amp;gt;&lt;/tt&gt; element in solr.xml &lt;em&gt;seems&lt;/em&gt; to be work around for this problem, (reinforcing my suspicion) but it may not be a complete work around since that should just make the order of operations deterministic &amp;#8211; any impacts of later cores on earlier cores should still be evident, but even if i re-order the cores in your test case, i see no problem using &lt;tt&gt;coreLoadThreads=&quot;1&quot;&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;I attempted to create a more trivial example of this problem by having multiple cores refer to lib paths with different dir names containing different stopword files with the same name (my motivation being to create something that could be used in a junit test w/o needing to build special jars) and could &lt;b&gt;not&lt;/b&gt; reproduce the problem ... which confuses me.&lt;/p&gt;

&lt;p&gt;my current best guess is that maybe the problem is caused by a combination of concurrent SolrCore/SolrResourceLoader init and the &quot;reloadLuceneSPI()&quot; hook in SolrResourceLoader ... i&apos;m looking at NamedSPILoader.reload and thinking that doesn&apos;t look thread safe &amp;#8211; but i&apos;m not sure if it&apos;s expected to be?&lt;/p&gt;

&lt;p&gt;...Hmm...&lt;/p&gt;

&lt;p&gt;I tried a quick experiment of modifying  NamedSPILoader.reload to be synchronized, on the theory that the cause of this problem was interleaved requests to that method from multiple threads that where reading &quot;this.services&quot;, processing it, and then writing a new &quot;this.services&quot; in a &quot;last thread wins&quot; fashion... but that didn&apos;t seem to solve the problem.&lt;/p&gt;

&lt;p&gt;The more i look at NamedSPILoader, the less i understand it and how it&apos;s used in the context of Solr ... because it&apos;s not clear to me how classes using NamedSPILoader, which are themselves loaded by the &quot;webapp classloader&quot; (ie: in the solr.war) ensure that the &lt;em&gt;correct&lt;/em&gt; SPI Service is returned in the context of a child classloader in situations where there are multiple child classloaders (ie: SolrCores) that might have conflicting SPI classes.  From what i can see, if classloaderA and classloaerB each load their own (possibly differnet) copy ICUFoldingFilterFactory, they&apos;re both going to collide in the LinkedHashMap that NamedSPILoader maintains ... right?  Is this related to the current bug, or is this perhaps a diff bug?&lt;/p&gt;

&lt;p&gt;(or maybe i just understand SPI even less then i think .. which is not much)&lt;/p&gt;</comment>
                            <comment id="13565744" author="arafalov" created="Tue, 29 Jan 2013 20:12:35 +0000"  >&lt;p&gt;I am unable to get the problem go away by using coreLoadThreads=&quot;1&quot;:&lt;br/&gt;
  &amp;lt;cores adminPath=&quot;/admin/cores&quot; coreLoadThreads=&quot;1&quot;&amp;gt;&lt;/p&gt;

&lt;p&gt;Where do the cores store their libraries? Why should core2 see the core1&apos;s structure for the library at all? Do they get ClassLoaders mixed up somehow? Is there a way to catch the modifications to whatever that structure is and dump the stack trace at modification time? Just thinking aloud. &lt;/p&gt;</comment>
                            <comment id="13586085" author="hossman" created="Mon, 25 Feb 2013 18:20:25 +0000"  >&lt;p&gt;Mark: i really don&apos;t have anything to offer on this issue beyond the comments i already posted ... based on my testing it really &lt;em&gt;seems&lt;/em&gt; like this is caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4063&quot; title=&quot;CoreContainer should be able to load multiple SolrCore&amp;#39;s in parallel rather than just serially.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4063&quot;&gt;&lt;del&gt;SOLR-4063&lt;/del&gt;&lt;/a&gt;, but that may be totally off base since aledandre couldn&apos;t make the problem go away using hte workarround i thought i found (ie: forcing single threaded core init)&lt;/p&gt;

&lt;p&gt;since i couldn&apos;t reproduce a similar collision between multicores with a simple stopwords file loaded from the classpath, it also seems likeley that this relates to SPI loading: but since i don&apos;t really understand at all how NamedSPILoader works in a multiclassloader application (and since my experiements in forcing synchronization on it didn&apos;t solve the problem for me) i&apos;m at a dead in there as well&lt;/p&gt;
</comment>
                            <comment id="13586097" author="markrmiller@gmail.com" created="Mon, 25 Feb 2013 18:29:58 +0000"  >&lt;p&gt;Oh, I don&apos;t plan on looking into it. Just assigned it to so that it wasn&apos;t forgotten and you seemed to have some knowledge in this area. I don&apos;t really have a need for more than a single lib dir ever pretty much.&lt;/p&gt;</comment>
                            <comment id="13586122" author="arafalov" created="Mon, 25 Feb 2013 18:48:27 +0000"  >&lt;p&gt;I have just rechecked and I still have the problem with coreLoadThreads=1 setting under Solr 4.1. Every time I start Solr a different subset of cores fails. I think reloading a core triggers this as well, though it is harder to check.&lt;/p&gt;

&lt;p&gt;I have the whole set of examples structured around getting this to work (each example is a separate core). Is there something I can do to help troubleshooting this? I haven&apos;t tried working with Solr source yet, but I am a Java developer and can dig around if there is some sort of information at where library references are stored.&lt;/p&gt;</comment>
                            <comment id="13586128" author="thetaphi" created="Mon, 25 Feb 2013 18:53:24 +0000"  >&lt;p&gt;Hoss: The concurrency issue in NamedSPILoader can indeed be solved by making the reload method synchonized. The services field is volatile, so readers will in any case see the correct value. The thread safety problem is &lt;b&gt;inside&lt;/b&gt; this method.&lt;/p&gt;</comment>
                            <comment id="13586175" author="arafalov" created="Mon, 25 Feb 2013 19:24:06 +0000"  >&lt;p&gt;Isn&apos;t that for SPIs only? Does that cover TokenFactories, etc? I think the libraries actually use SolrResourceLoader#reloadLuceneSPI instead.&lt;/p&gt;

&lt;p&gt;I wonder if the problem is related to SolrResourceLoader#createClassLoader:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; ( &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; == parent ) {
      parent = &lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.currentThread().getContextClassLoader();
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;How does this work with multiple threads?&lt;/p&gt;</comment>
                            <comment id="13586180" author="hossman" created="Mon, 25 Feb 2013 19:25:15 +0000"  >&lt;p&gt;There appear to be a few things going on here...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-4796&quot; title=&quot;NamedSPILoader.reload needs to be synchronized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-4796&quot;&gt;&lt;del&gt;LUCENE-4796&lt;/del&gt;&lt;/a&gt;: there is at least one confirmed thread safety issue here with NamedSPILoader which i&apos;ve spun off into it&apos;s own Jira.  combined with concurrent loading of SolrCore&apos;s this could definitely cause a problem.  Note however that while working on this issue i previously experimented with &quot;fixing&quot; the synchronization problem in NamedSPILoader but it didn&apos;t seem to resolve this issue &amp;#8211; i may have just botched my fix or testing, or there may be a secondary compounding issue.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Even if &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-4796&quot; title=&quot;NamedSPILoader.reload needs to be synchronized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-4796&quot;&gt;&lt;del&gt;LUCENE-4796&lt;/del&gt;&lt;/a&gt; is the root cause of this issue, that doens&apos;t explain why my previous suggested work around doens&apos;t work for alex, since forcing single threaded SolrCore initalization should make the synchroniztaion of that method moot.&lt;/li&gt;
&lt;/ul&gt;


&lt;ul&gt;
	&lt;li&gt;Based on my IRC discussion with Uwe, it seems like my overall understanding of NamedSPILoader is correct.   Which means, if i&apos;m understanidng things correctly: now that lucene uses this class (and SPI loadin in general) at a low level, Solr fundementally won&apos;t be able to support individual SolrCores loading plugins with the same name, but different implementaions &amp;#8211; ie: different versions of a plugin in different solrcores.   I may be wrong about this, and it may not even remotely related to the problem at hand, but i wanted to point it out for the record since prior to using SPI in Lucene this is something that worked in Solr.  (Honestly: it&apos;s not even clear to me in the new world order if it&apos;s safe for two different SolrClore&apos;s to load the same plugin in their individual class loaders &amp;#8211; needs more careful testing ... we may need to start encouraging people to move away from leading plugins at the SolrCore level and instead load them using the sharedLib)&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="13586182" author="hossman" created="Mon, 25 Feb 2013 19:29:22 +0000"  >&lt;p&gt;Alex:&lt;/p&gt;

&lt;p&gt;I just noticed something in one of your earlier comments...&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I am unable to get the problem go away by using coreLoadThreads=&quot;1&quot;: &amp;lt;cores adminPath=&quot;/admin/cores&quot; coreLoadThreads=&quot;1&quot;&amp;gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;...the &quot;coreLoadThreads&quot; option should be on the &lt;tt&gt;&amp;lt;solr/&amp;gt;&lt;/tt&gt; element, not the &lt;tt&gt;&amp;lt;cores/&amp;gt;&lt;/tt&gt; element, can you please test that again?&lt;/p&gt;

&lt;p&gt;Other comments..&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is there something I can do to help troubleshooting this? I haven&apos;t tried working with Solr source yet, but I am a Java developer and can dig around if there is some sort of information at where library references are stored.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;primarily we build up a ClassLoader per SolrCore in SOlrResourceLoader, each of which hangs off of the parent classloader for the webapp &amp;#8211; but the use of SPI in lucene complicates things in ways i still don&apos;t fully understand.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Isn&apos;t that for SPIs only? Does that cover TokenFactories&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, many of the various factories in Solr are handled using SPI now (take a look at SolrResourceLoader.reloadLuceneSPI())&lt;/p&gt;</comment>
                            <comment id="13586217" author="arafalov" created="Mon, 25 Feb 2013 19:56:27 +0000"  >&lt;p&gt;Ok, adding the flag on solr element seems to have fixed the problem. My bad. Does it mean we know where the problem is?&lt;/p&gt;

&lt;p&gt;However, on the other point, I don&apos;t see NamedSPILoader being called from SolrResourceLoader.reloadLuceneSPI(). Rather, I see AnalysisSPILoader. Not sure if the difference is significant.&lt;/p&gt;</comment>
                            <comment id="13586239" author="thetaphi" created="Mon, 25 Feb 2013 20:11:55 +0000"  >&lt;p&gt;This is how it is called, just indirect.&lt;/p&gt;</comment>
                            <comment id="13586491" author="hossman" created="Tue, 26 Feb 2013 00:01:31 +0000"  >
&lt;blockquote&gt;&lt;p&gt;My bad. Does it mean we know where the problem is?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;it means a few things...&lt;/p&gt;

&lt;p&gt;1) it confirms the problem you were seeing realted to multi-thread core reloading&lt;br/&gt;
2) it means we&apos;re seeing consistent results, which narrows down the possible causes (before it looked like there may be two causes of a single symptom: one related to multi-threaded loading that i could reproduce, and one unknown that you could reproduce, now it seems more likeley that they are the same&lt;br/&gt;
3) it means we have a config based work arround for users who encounter this problem w/o requiring a code patch.&lt;/p&gt;

&lt;p&gt;Can you try out the patch Uwe posted to &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-4796&quot; title=&quot;NamedSPILoader.reload needs to be synchronized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-4796&quot;&gt;&lt;del&gt;LUCENE-4796&lt;/del&gt;&lt;/a&gt;?  his comments there helped me realize why my earlier attempts at fixing this bug didn&apos;t work for me, and with his most recent patch i can&apos;t reproduce this problem.  would be good to have your feedback.&lt;/p&gt;</comment>
                            <comment id="13587126" author="thetaphi" created="Tue, 26 Feb 2013 13:49:10 +0000"  >&lt;p&gt;The problem is in AnalysisSPILoader (not NamedSPILoader). The thread safetly issue is not really the problem (it might be problem). The bug is in incorrect copypasted code in AnalysisSPILoader: The reload() method throws away all already loaded SPIs and starts with an empty list. I fixed it in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-4796&quot; title=&quot;NamedSPILoader.reload needs to be synchronized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-4796&quot;&gt;&lt;del&gt;LUCENE-4796&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;Uwe&lt;/p&gt;</comment>
                            <comment id="13587132" author="arafalov" created="Tue, 26 Feb 2013 13:56:23 +0000"  >&lt;p&gt;I am trying to build the distribution to confirm, but - since it is my first time - not sure what sequence of ant commands to run to get fully functioning example directory with all the dist and contrib libraries in place. *&lt;b&gt;run-example&lt;/b&gt;* does not seem to generate the dist/contrib libraries and I am not using subversion for *&lt;b&gt;distrib&lt;/b&gt;* command.&lt;/p&gt;

&lt;p&gt;Wiki seems to be silent on that as well. Is there a new developer guide somewhere?&lt;/p&gt;</comment>
                            <comment id="13587152" author="nederhrj" created="Tue, 26 Feb 2013 14:14:11 +0000"  >&lt;p&gt;You have to do an &quot;ant example&quot; in the solr directory.&lt;/p&gt;

&lt;p&gt;Glad this problem seems to be solved. This bug already cost me a lot of&lt;br/&gt;
hours...&lt;/p&gt;



&lt;p&gt;On Tue, Feb 26, 2013 at 2:58 PM, Alexandre Rafalovitch (JIRA) &amp;lt;&lt;/p&gt;
</comment>
                            <comment id="13587159" author="arafalov" created="Tue, 26 Feb 2013 14:23:41 +0000"  >&lt;p&gt;&quot;ant example&quot; does not build additional libraries in dist and contrib directories. And that&apos;s what I am using for the test. &lt;/p&gt;

&lt;p&gt;I guess I can change the path in the test to use pre-built libraries from downloaded distribution, but would still be useful to know how to build the whole lot.&lt;/p&gt;</comment>
                            <comment id="13587162" author="nederhrj" created="Tue, 26 Feb 2013 14:32:12 +0000"  >&lt;p&gt;Sorry, I thought this would be clear from the readme. This is what I do (in&lt;br/&gt;
Linux):&lt;/p&gt;

&lt;p&gt;svn co &lt;a href=&quot;http://svn.apache.org/repos/asf/lucene/dev/trunk/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/repos/asf/lucene/dev/trunk/&lt;/a&gt;&lt;br/&gt;
lucene-trunkcd lucene_trunk*# Apply patches (e.g. patch -p0 &amp;lt;&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3808&quot; title=&quot;Extraction contrib to utilize Boilerpipe&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3808&quot;&gt;SOLR-3808&lt;/a&gt;-4.1-1.patch)*# It might be necessary to to a &quot;ant&lt;br/&gt;
ivy-bootstrap&quot; first# Based on ant 1.8.4&lt;br/&gt;
ant compilecd solr&lt;br/&gt;
ant example&lt;br/&gt;
ant dist&lt;/p&gt;


&lt;p&gt;On Tue, Feb 26, 2013 at 3:24 PM, Alexandre Rafalovitch (JIRA) &amp;lt;&lt;/p&gt;
</comment>
                            <comment id="13587255" author="commit-tag-bot" created="Tue, 26 Feb 2013 16:56:30 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Uwe Schindler&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1450275&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1450275&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-4796&quot; title=&quot;NamedSPILoader.reload needs to be synchronized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-4796&quot;&gt;&lt;del&gt;LUCENE-4796&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4373&quot; title=&quot;In multicore, lib directives in solrconfig.xml cause conflict and clobber directives from earlier cores&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4373&quot;&gt;&lt;del&gt;SOLR-4373&lt;/del&gt;&lt;/a&gt;: Fix concurrency issue in NamedSPILoader and AnalysisSPILoader when doing concurrent core loads in multicore Solr configs&lt;/p&gt;
</comment>
                            <comment id="13587258" author="thetaphi" created="Tue, 26 Feb 2013 16:58:22 +0000"  >&lt;p&gt;I think this should be solved by &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-4796&quot; title=&quot;NamedSPILoader.reload needs to be synchronized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-4796&quot;&gt;&lt;del&gt;LUCENE-4796&lt;/del&gt;&lt;/a&gt;, which is committed now. I keep this issue open until somebody confirms, that the fix is working for Solr.&lt;/p&gt;</comment>
                            <comment id="13587264" author="commit-tag-bot" created="Tue, 26 Feb 2013 17:04:28 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Uwe Schindler&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1450276&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1450276&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Merged revision(s) 1450275 from lucene/dev/trunk:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-4796&quot; title=&quot;NamedSPILoader.reload needs to be synchronized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-4796&quot;&gt;&lt;del&gt;LUCENE-4796&lt;/del&gt;&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4373&quot; title=&quot;In multicore, lib directives in solrconfig.xml cause conflict and clobber directives from earlier cores&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4373&quot;&gt;&lt;del&gt;SOLR-4373&lt;/del&gt;&lt;/a&gt;: Fix concurrency issue in NamedSPILoader and AnalysisSPILoader when doing concurrent core loads in multicore Solr configs&lt;/p&gt;</comment>
                            <comment id="13590908" author="nederhrj" created="Fri, 1 Mar 2013 20:33:32 +0000"  >&lt;p&gt;I&apos;m still experiencing the same problems (rev 1450937): Libraries cannot be found. &lt;/p&gt;

&lt;p&gt;Moreover, the workaround by adding &lt;tt&gt;coreLoadThreads=&quot;1&quot;&lt;/tt&gt; to solr.xml does not work in SolrCloud. I get: &quot;SolrCloud requires a value of at least 2 in solr.xml for coreLoadThreads&quot;.&lt;/p&gt;

&lt;p&gt;One additional observation: The first time I create a core it fails, however the second time it succeeds. Does anyone knows why it happens? FYI: I am attaching the test script I am using to upload, link the config and create the cores.&lt;/p&gt;</comment>
                            <comment id="13590910" author="nederhrj" created="Fri, 1 Mar 2013 20:35:46 +0000"  >&lt;p&gt;Test script to create a collection, upload/link a config and create two cores.&lt;/p&gt;</comment>
                            <comment id="13591071" author="hossman" created="Fri, 1 Mar 2013 23:07:15 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;m still experiencing the same problems (rev 1450937): Libraries cannot be found. &lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;...&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;The first time I create a core it fails, however the second time it succeeds.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;On the same instance? or do you mean you get an error creating shard1 on port 8080, but when you create shard2 on 8081 that works?&lt;/p&gt;

&lt;p&gt;That sounds like it is a probably a distinct, semi-related, bug.&lt;/p&gt;

&lt;p&gt;can you please file a new jira, and include: both the svn rev &lt;em&gt;and&lt;/em&gt; branch you are using (trunk vs 4x), the details of the configs you are using, the details of the errors you get (full logs would be nice so we can see the core startup info), and when/where you get those errors in the process of your script (ie: is it when creating the collection? linking the config to the collection? creating the cores?)&lt;/p&gt;</comment>
                            <comment id="13599224" author="arafalov" created="Mon, 11 Mar 2013 20:26:00 +0000"  >&lt;p&gt;I thought this one was fixed?&lt;/p&gt;</comment>
                            <comment id="13599235" author="markrmiller@gmail.com" created="Mon, 11 Mar 2013 20:31:13 +0000"  >&lt;p&gt;Dunno - no one has resolved it yet.&lt;/p&gt;</comment>
                            <comment id="13599244" author="arafalov" created="Mon, 11 Mar 2013 20:34:56 +0000"  >&lt;p&gt;I think it was fixed in span-off &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-4796&quot; title=&quot;NamedSPILoader.reload needs to be synchronized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-4796&quot;&gt;&lt;del&gt;LUCENE-4796&lt;/del&gt;&lt;/a&gt; by Uwe and Hoss. But they are not watching this one.&lt;/p&gt;</comment>
                            <comment id="13599256" author="thetaphi" created="Mon, 11 Mar 2013 20:42:15 +0000"  >&lt;p&gt;I left this one open, because I wanted a confirmation that the spun off issue resolved this one, too. But there was no clear confirmation on this. So it might be fixed in 4.2 ore not until somebody confirms. &lt;/p&gt;</comment>
                            <comment id="13599323" author="hossman" created="Mon, 11 Mar 2013 21:17:51 +0000"  >&lt;p&gt;I&apos;m calling this resolved.&lt;/p&gt;

&lt;p&gt;we had one comment about a possible related issue, but the symptoms didn&apos;t match, and as far as i can tell the request for additional details to reproduce (in a new issue) was never responded to.&lt;/p&gt;</comment>
                            <comment id="13599346" author="nederhrj" created="Mon, 11 Mar 2013 21:34:52 +0000"  >&lt;p&gt;I was the one reporting an issue with the fix, but as it seems I must have made an error somewhere as I tried really hard to reproduce the error in a brand new SolrCloud installation, but wasn&apos;t able to. Let&apos;s call this resolved.&lt;/p&gt;</comment>
                            <comment id="13600623" author="arafalov" created="Tue, 12 Mar 2013 23:43:55 +0000"  >&lt;p&gt;I confirm that this is fixed in 4.2 with my original test case setup.&lt;/p&gt;</comment>
                            <comment id="13654275" author="thetaphi" created="Fri, 10 May 2013 10:34:37 +0000"  >&lt;p&gt;Closed after release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12633971">LUCENE-4796</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12615649">SOLR-4063</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12566867" name="multicore-bug.zip" size="15981" author="arafalov" created="Tue, 29 Jan 2013 01:09:16 +0000"/>
                            <attachment id="12571642" name="testscript.sh" size="1508" author="nederhrj" created="Fri, 1 Mar 2013 20:35:46 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>310108</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1hiov:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>310453</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>