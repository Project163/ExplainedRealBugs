<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:12:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-8082] can&apos;t query against negative float or double values when indexed=&quot;false&quot; docValues=&quot;true&quot; multiValued=&quot;false&quot;</title>
                <link>https://issues.apache.org/jira/browse/SOLR-8082</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Haven&apos;t dug into this yet, but something is evidently wrong in how the DocValues based queries get build for single valued float or double fields when negative numbers are involved.&lt;/p&gt;

&lt;p&gt;Steps to reproduce...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ bin/solr -e schemaless -noprompt
...
$ curl -X POST -H &apos;Content-type:application/json&apos; --data-binary &apos;{ &quot;add-field&quot;:{ &quot;name&quot;:&quot;f_dv_multi&quot;, &quot;type&quot;:&quot;tfloat&quot;, &quot;stored&quot;:&quot;true&quot;, &quot;indexed&quot;:&quot;false&quot;, &quot;docValues&quot;:&quot;true&quot;, &quot;multiValued&quot;:&quot;true&quot; }, &quot;add-field&quot;:{ &quot;name&quot;:&quot;f_dv_single&quot;, &quot;type&quot;:&quot;tfloat&quot;, &quot;stored&quot;:&quot;true&quot;, &quot;indexed&quot;:&quot;false&quot;, &quot;docValues&quot;:&quot;true&quot;, &quot;multiValued&quot;:&quot;false&quot; } }&apos; http://localhost:8983/solr/gettingstarted/schema
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:84}}
$ curl -X POST -H &apos;Content-type:application/json&apos; --data-binary &apos;[{&quot;id&quot;:&quot;test&quot;, &quot;f_dv_multi&quot;:-4.3, &quot;f_dv_single&quot;:-4.3}]&apos; &apos;http://localhost:8983/solr/gettingstarted/update/json/docs?commit=true&apos;
{&quot;responseHeader&quot;:{&quot;status&quot;:0,&quot;QTime&quot;:57}}
$ curl &apos;http://localhost:8983/solr/gettingstarted/query?q=f_dv_multi:&quot;-4.3&quot;&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:5,
    &quot;params&quot;:{
      &quot;q&quot;:&quot;f_dv_multi:\&quot;-4.3\&quot;&quot;}},
  &quot;response&quot;:{&quot;numFound&quot;:1,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;test&quot;,
        &quot;f_dv_multi&quot;:[-4.3],
        &quot;f_dv_single&quot;:-4.3,
        &quot;_version_&quot;:1512962117004689408}]
  }}
$ curl &apos;http://localhost:8983/solr/gettingstarted/query?q=f_dv_single:&quot;-4.3&quot;&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:5,
    &quot;params&quot;:{
      &quot;q&quot;:&quot;f_dv_single:\&quot;-4.3\&quot;&quot;}},
  &quot;response&quot;:{&quot;numFound&quot;:0,&quot;start&quot;:0,&quot;docs&quot;:[]
  }}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Explicit range queries (which is how numeric &quot;field&quot; queries are implemented under the cover) are equally problematic...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;$ curl &apos;http://localhost:8983/solr/gettingstarted/query?q=f_dv_multi:%5B-4.3+TO+-4.3%5D&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:0,
    &quot;params&quot;:{
      &quot;q&quot;:&quot;f_dv_multi:[-4.3 TO -4.3]&quot;}},
  &quot;response&quot;:{&quot;numFound&quot;:1,&quot;start&quot;:0,&quot;docs&quot;:[
      {
        &quot;id&quot;:&quot;test&quot;,
        &quot;f_dv_multi&quot;:[-4.3],
        &quot;f_dv_single&quot;:-4.3,
        &quot;_version_&quot;:1512962117004689408}]
  }}
$ curl &apos;http://localhost:8983/solr/gettingstarted/query?q=f_dv_single:%5B-4.3+TO+-4.3%5D&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:0,
    &quot;params&quot;:{
      &quot;q&quot;:&quot;f_dv_single:[-4.3 TO -4.3]&quot;}},
  &quot;response&quot;:{&quot;numFound&quot;:0,&quot;start&quot;:0,&quot;docs&quot;:[]
  }}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12895270">SOLR-8082</key>
            <summary>can&apos;t query against negative float or double values when indexed=&quot;false&quot; docValues=&quot;true&quot; multiValued=&quot;false&quot;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sarowe">Steven Rowe</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Sep 2015 22:13:57 +0000</created>
                <updated>Fri, 17 Jun 2016 13:11:40 +0000</updated>
                            <resolved>Wed, 27 Apr 2016 23:54:08 +0000</resolved>
                                                    <fixVersion>5.5.1</fixVersion>
                    <fixVersion>5.6</fixVersion>
                    <fixVersion>6.0</fixVersion>
                    <fixVersion>6.1</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="14903674" author="hossman" created="Tue, 22 Sep 2015 23:46:49 +0000"  >&lt;p&gt;the attached patch demonstrates the breadth of the problems i&apos;ve found with queries against &lt;em&gt;negative&lt;/em&gt; values in both float and double based docvalues (only) fields &amp;#8211; ie: queries in which DocValuesRangeQuery is used instead of the inverted index (via NumericRangeQuery)&lt;/p&gt;

&lt;p&gt;I&apos;m still not really clear what the root bug / fix is, but best i can tell this is ultimately about a disconnect between how the DocValuesRangeQuery objects are built at query time (using NumericUtils.floatToSortableInt and NumericUtils.doubleToSortableLong) vs how the NumericDocValuesField objects are build at index time (using Float.floatToIntBits and Double.doubleToLongBits)&lt;/p&gt;

&lt;p&gt;My bare bones understanding is that both places should be using NumericUtils.floatToSortableInt and NumericUtils.doubleToSortableLong &amp;#8211; but (besides being a back compat break on how the values are written to disk) if that&apos;s the case then why does sorting work for negative float values today? (see DocValuesTest.testDocValuesSorting2, which &amp;#8211; in addition to many faceting tests &amp;#8211; broke when i experimented with using NumericUtils.floatToSortableInt and NumericUtils.doubleToSortableLong to build the NumericDocValuesField in TrieField.createFields)&lt;/p&gt;

&lt;p&gt;Can anyone explain to me:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;when/why floatToIntBits &amp;amp; doubleToLongBits should be used instead of floatToSortableInt &amp;amp; doubleToSortableLong&lt;/li&gt;
	&lt;li&gt;how to fix these tests so they pass and queries against negative float / double values will work?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="14903676" author="hossman" created="Tue, 22 Sep 2015 23:48:26 +0000"  >&lt;p&gt;updated summary &amp;amp; description to capture new info (affects doubles, only seems to affect negative values)&lt;/p&gt;</comment>
                            <comment id="15193588" author="ichattopadhyaya" created="Mon, 14 Mar 2016 16:34:27 +0000"  >&lt;p&gt;Probably related to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8838&quot; title=&quot;Returning non-stored docValues is incorrect for floats and doubles&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8838&quot;&gt;&lt;del&gt;SOLR-8838&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15195456" author="ichattopadhyaya" created="Tue, 15 Mar 2016 15:11:34 +0000"  >&lt;p&gt;Here&apos;s a summary of my understanding / observations:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Floats and doubles need to be converted to longs before writing them to NumericDocValues.&lt;/li&gt;
	&lt;li&gt;We have two options, Double.doubleToLongBits() and NumericUtils.doubleToSortableLong(). For positive doubles, both these methods return the same long value, but different ones for negative doubles.&lt;/li&gt;
	&lt;li&gt;Currently, we use Double.doubleToLongBits() to write these doubles/floats. Hence, to use term query against such docValues, we should use the same method with the query value, but current code uses NumericUtils.doubleToSortableLong() during querying and hence term queries against negative values fail. Similarly, range queries also fail when min is negative.&lt;/li&gt;
	&lt;li&gt;I tried changing initial writing logic to use NumericUtils.doubleToSortableLong(). With this change, both term queries and range queries work, but sorting fails (when there are negative values). That is counter intuitive, since the individual long values themselves are in sorted order. Since this is an intrusive change that breaks backcompat, I didn&apos;t investigate deeper to understand why this is happening.&lt;/li&gt;
	&lt;li&gt;To arrive at a least intrusive fix, I tried changing the range query logic to split out the queries into two distinct ranges (negatives and positives) using a boolean query. I had to do this since the Double.doubleToLongBits() values are not monotonically increasing (they are decreasing for Double.MIN_VALUE to 0, but increasing for 0 to Double.MAX_VALUE).&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Attached the patch for the last point, which I think is the least intrusive way to pull things together so that they work. When the range query crosses the 0 boundary, there are two dv range queries which is less efficient, but better than not working at all (which is the case today). The patch passes the tests, but it might benefit from some neater refactoring.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman&quot; class=&quot;user-hover&quot; rel=&quot;hossman&quot;&gt;hossman&lt;/a&gt; Can you please review? Do you think there&apos;s a cleaner way to do this?&lt;/p&gt;</comment>
                            <comment id="15195459" author="ichattopadhyaya" created="Tue, 15 Mar 2016 15:14:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;if that&apos;s the case then why does sorting work for negative float values today?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It is something even I was unable to figure out and surprises me, since the converted long values currently written to disk (as a result of Double.doubleToLongBits()) are not monotonic.&lt;/p&gt;</comment>
                            <comment id="15197467" author="ichattopadhyaya" created="Wed, 16 Mar 2016 15:09:19 +0000"  >&lt;p&gt;Tackling some boundary cases, added another test (testFloatRangeQuery). This is still WIP, I&apos;m working on:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;A randomized test for ranges&lt;/li&gt;
	&lt;li&gt;Cleanup / refactor&lt;/li&gt;
	&lt;li&gt;Better handling and testing around inclusion operators&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;This approach looks clumsy, but might be the least intrusive way of getting this to work? Once done with this patch, I&apos;ll take a shot at evaluating, once again, as to possibly rewriting the logic for writing floats/doubles as longs into docValues.&lt;/p&gt;</comment>
                            <comment id="15197578" author="ichattopadhyaya" created="Wed, 16 Mar 2016 16:07:15 +0000"  >&lt;p&gt;Updated the patch, refactored the fix and a test. Still WIP and the above TODO items are not here.&lt;/p&gt;</comment>
                            <comment id="15199455" author="ichattopadhyaya" created="Thu, 17 Mar 2016 12:59:41 +0000"  >&lt;p&gt;Updating the patch. This contains a randomized test, which I am currently beasting now.&lt;br/&gt;
This depends on a patch for a bug I found during testing this, &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-7111&quot; title=&quot;DocValuesRangeQuery.newLongRange behaves incorrectly for Long.MAX_VALUE and Long.MIN_VALUE&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-7111&quot;&gt;&lt;del&gt;LUCENE-7111&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;If the beasting goes fine, I think this is a fix that behaves correctly. But, still not sure if this is the best fix to have, since there possibly exists another alternative (which I&apos;ll look into after this) to write the longs in sortable order itself.&lt;/p&gt;</comment>
                            <comment id="15199538" author="yseeley@gmail.com" created="Thu, 17 Mar 2016 13:47:16 +0000"  >&lt;p&gt;Building a boolean query is the slowest option of all (will look up all the values twice and has overhead)... coverting to a float/double would be faster (that should actually be a no-op... so it would be down to how fast the floating point comparisons are vs long comparisons).  If we did want to keep things in &quot;long&quot; space rather than converting, then perhaps just create our own version that does an additional comparison when needed.&lt;/p&gt;

&lt;p&gt;I was going to suggest that we could also just try the built-in range support in valuesource &lt;br/&gt;
FunctionValues.getRangeScorer()... but I forgot to bring back the &quot;only match docs with a value&quot; patch from heliosearch.&lt;/p&gt;</comment>
                            <comment id="15199598" author="ichattopadhyaya" created="Thu, 17 Mar 2016 14:22:27 +0000"  >&lt;blockquote&gt;&lt;p&gt;Building a boolean query is the slowest option of all (will look up all the values twice and has overhead)... coverting to a float/double would be faster &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Do you mean that instead of using the DocValuesRangeQuery.newLongRange(), we write something on our own which converts the longs back to floats/doubles and then compares those floats/doubles?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If we did want to keep things in &quot;long&quot; space rather than converting, then perhaps just create our own version that does an additional comparison when needed.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Do you think the NumericUtils.doubleToSortableLong() is a good choice for converting float/double to longs, instead of Double.doubleToLongBits() which is currently used? I think this would ensure that the range queries would just work out of the box without such handling of special cases. Also, is it okay to change the way we convert floats/doubles to longs in terms of backward compatibility?&lt;/p&gt;</comment>
                            <comment id="15199673" author="yseeley@gmail.com" created="Thu, 17 Mar 2016 15:06:31 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do you mean that instead of using the DocValuesRangeQuery.newLongRange(), we write something on our own which converts the longs back to floats/doubles and then compares those floats/doubles?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, that&apos;s one way.&lt;br/&gt;
But maybe we should go ahead and fix ValueSourceRangeFilter to not match documents w/o a value in the field.  It&apos;s arguably a bug (and only existed historically because we didn&apos;t have info about what fields had a value for numerics, and didn&apos;t have exists()) and 6.0 is the perfect time to make the change.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Do you think the NumericUtils.doubleToSortableLong() is a good choice for converting float/double to longs, instead of Double.doubleToLongBits() which is currently used?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Both have their advantages... while sortable longs might be convenient when operating in the &quot;long&quot; space, it would slow things down when converting back to a double.  &lt;/p&gt;</comment>
                            <comment id="15199978" author="hossman" created="Thu, 17 Mar 2016 17:22:10 +0000"  >&lt;blockquote&gt;&lt;p&gt;Building a boolean query is the slowest option of all (will look up all the values twice and has overhead)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&quot;A patch in jira ready to be committed is worth two hypothetical patches no one has contributed yet.&quot;&lt;/p&gt;

&lt;p&gt;As things stand today, a query where either end point is less then 0  is completely broken &amp;#8211; a &quot;slow&quot; boolean query that is correct sounds better to me then the broken behavior &amp;#8211; even if it&apos;s just a short term gap for 6.0 and we have plans for a better solution down the road.  Particularly since (unless i&apos;m missing something) any existing situation where the code works correctly today will continue to work correctly with the same performance after this patch (ie: purely positive ranges will continue to be implemented w/o a BQ using a purely positive range query.)&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;But maybe we should go ahead and fix ValueSourceRangeFilter to not match documents w/o a value in the field. It&apos;s arguably a bug&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That seems like it should be broken out into a distinct $new_jira since it has larger implications/impacts.  (if we want to make this issue blocked by $new_jira then so be it, but they should still be distinct issues)&lt;/p&gt;</comment>
                            <comment id="15200232" author="yseeley@gmail.com" created="Thu, 17 Mar 2016 19:45:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;a &quot;slow&quot; boolean query that is correct sounds better to me then the broken behavior&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hopefully no one is suggesting that we not fix this (somehow) for 6.0&lt;br/&gt;
I was just using the opportunity to fix another bug that would also help with this one.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;That seems like it should be broken out&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s what  &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8867&quot; title=&quot;frange / ValueSourceRangeFilter / FunctionValues.getRangeScorer should not match documents w/o a value&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8867&quot;&gt;&lt;del&gt;SOLR-8867&lt;/del&gt;&lt;/a&gt; is about.&lt;/p&gt;</comment>
                            <comment id="15200248" author="ichattopadhyaya" created="Thu, 17 Mar 2016 19:53:54 +0000"  >&lt;blockquote&gt;&lt;p&gt;Hopefully no one is suggesting that we not fix this (somehow) for 6.0&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;I think seems this like a bad enough bug for us to fix right away, also given our latest push for using all fields with docvalues and also given the push for having some of them unstored. With range queries completely broken, I think we should push for it for 6.0, or a 6.0.1 if not ready right away. I think it is safe to do so, as long as a targeted fix doesn&apos;t make things worse than what it already is. What do you think? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman&quot; class=&quot;user-hover&quot; rel=&quot;hossman&quot;&gt;hossman&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15200800" author="yseeley@gmail.com" created="Fri, 18 Mar 2016 01:48:44 +0000"  >&lt;p&gt;Here&apos;s an updated patch that uses the same method as &lt;/p&gt;
{!frange}
&lt;p&gt; for a range query.  I took the conservative approach and just replaced the boolean query in the previous patch, leaving the previous non-negative ranges untouched.&lt;/p&gt;

&lt;p&gt;Thanks to the excellent tests in the previous patches,  it helped uncover a limitation in ValueSourceRangeFilter that prevented including infinite endpoints.&lt;/p&gt;

&lt;p&gt;I had to make one change to the tests: I removed -0 as a special value in testFloatAndDoubleRangeQueryRandom.  Since -0 == +0, any range including one should include the other.  I don&apos;t think we should support or guarantee behavior of &quot;different zeros&quot; in any case - way to many potential bugs, and it limits us from an implementation standpoint (different bit patterns for equivalent values).&lt;/p&gt;</comment>
                            <comment id="15201502" author="ichattopadhyaya" created="Fri, 18 Mar 2016 14:05:59 +0000"  >&lt;p&gt;Thanks Yonik, the patch looks good. The test is passing for me.&lt;br/&gt;
Do you think we should rely on FunctionRangeQuery for the entire number line, or should we just use this for the negative range? To me, both looked similar in terms of performance.&lt;/p&gt;</comment>
                            <comment id="15201515" author="yseeley@gmail.com" created="Fri, 18 Mar 2016 14:12:10 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do you think we should rely on FunctionRangeQuery for the entire number line&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Perhaps eventually?  I was trying to be conservative and not create any performance regressions for the stuff that does work.&lt;br/&gt;
I don&apos;t have time for performance tests right now (and I know from looking that the frange stuff can be sped up as well in a lot of places... we no longer need to wrap a filter, exists() looks slow in many function value implementations, etc.)  May be better to tackle that stuff after 6.0&lt;/p&gt;</comment>
                            <comment id="15201529" author="ichattopadhyaya" created="Fri, 18 Mar 2016 14:19:46 +0000"  >&lt;p&gt;Indeed! +1 to fixing the issue for 6.0 with the current patch (except for the stale comment &lt;tt&gt;If min is negative (or -0d) and max is positive (or +0d), then issue two range queries&lt;/tt&gt;, which was left over an older patch).&lt;/p&gt;</comment>
                            <comment id="15202927" author="steve_rowe" created="Sat, 19 Mar 2016 19:17:13 +0000"  >&lt;p&gt;Patch with a few minor cleanups:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;In &lt;tt&gt;TrieField.getRangeQueryForFloatDoubleDocValues()&lt;/tt&gt;:
	&lt;ul&gt;
		&lt;li&gt;Made constants for invariants (bits for infinities and zeros), in case the compiler isn&apos;t smart enough to do that.&lt;/li&gt;
		&lt;li&gt;Added parens in a couple of expressions to improve legibility.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;In &lt;tt&gt;DocValuesTest&lt;/tt&gt;:
	&lt;ul&gt;
		&lt;li&gt;In &lt;tt&gt;testFloatAndDoubleRangeQueryRandom()&lt;/tt&gt;:
		&lt;ul&gt;
			&lt;li&gt;Converted several &lt;tt&gt;fieldName[i].equals(&quot;floatdv&quot;) ? ... : ...&lt;/tt&gt; trinary operators to use (float,double) tuples (like the other values in this test), using lambdas.&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
		&lt;li&gt;In &lt;tt&gt;testFloatAndDoubleRangeQuery()&lt;/tt&gt;:
		&lt;ul&gt;
			&lt;li&gt;&lt;tt&gt;negativeInfinity[1]&lt;/tt&gt; fixed: Float-&amp;gt;Double&lt;/li&gt;
		&lt;/ul&gt;
		&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;&lt;blockquote&gt;&lt;p&gt;+1 to fixing the issue for 6.0 with the current patch (except for the stale comment &lt;tt&gt;If min is negative (or -0d) and max is positive (or +0d), then issue two range queries&lt;/tt&gt;, which was left over an older patch).&lt;/p&gt;&lt;/blockquote&gt;
	&lt;ul&gt;
		&lt;li&gt;The patch fixes this too: &lt;tt&gt;s/two range queries/FunctionRangeQuery/&lt;/tt&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;ll commit tomorrow if no objections and nobody else gets to it first.&lt;/p&gt;</comment>
                            <comment id="15203103" author="ichattopadhyaya" created="Sun, 20 Mar 2016 04:42:07 +0000"  >&lt;p&gt;+1, LGTM.&lt;/p&gt;</comment>
                            <comment id="15203521" author="jira-bot" created="Sun, 20 Mar 2016 20:56:01 +0000"  >&lt;p&gt;Commit 49d5ec02a2015ddd80059d46788b723b25cb5491 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=49d5ec0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=49d5ec0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8082&quot; title=&quot;can&amp;#39;t query against negative float or double values when indexed=&amp;quot;false&amp;quot; docValues=&amp;quot;true&amp;quot; multiValued=&amp;quot;false&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8082&quot;&gt;&lt;del&gt;SOLR-8082&lt;/del&gt;&lt;/a&gt;: Can&apos;t query against negative float or double values when indexed=&apos;false&apos; docValues=&apos;true&apos; multiValued=&apos;false&apos;&lt;/p&gt;</comment>
                            <comment id="15203523" author="jira-bot" created="Sun, 20 Mar 2016 20:57:09 +0000"  >&lt;p&gt;Commit 2668ff5abb16e867f9f770d1da65457161b52cda in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2668ff5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2668ff5&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8082&quot; title=&quot;can&amp;#39;t query against negative float or double values when indexed=&amp;quot;false&amp;quot; docValues=&amp;quot;true&amp;quot; multiValued=&amp;quot;false&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8082&quot;&gt;&lt;del&gt;SOLR-8082&lt;/del&gt;&lt;/a&gt;: Can&apos;t query against negative float or double values when indexed=&apos;false&apos; docValues=&apos;true&apos; multiValued=&apos;false&apos;&lt;/p&gt;</comment>
                            <comment id="15203525" author="jira-bot" created="Sun, 20 Mar 2016 20:57:44 +0000"  >&lt;p&gt;Commit c3d0276b2f50ca6c1b8dd1298fc2e214c4020dbf in lucene-solr&apos;s branch refs/heads/branch_6_0 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c3d0276&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c3d0276&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8082&quot; title=&quot;can&amp;#39;t query against negative float or double values when indexed=&amp;quot;false&amp;quot; docValues=&amp;quot;true&amp;quot; multiValued=&amp;quot;false&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8082&quot;&gt;&lt;del&gt;SOLR-8082&lt;/del&gt;&lt;/a&gt;: Can&apos;t query against negative float or double values when indexed=&apos;false&apos; docValues=&apos;true&apos; multiValued=&apos;false&apos;&lt;/p&gt;</comment>
                            <comment id="15203561" author="jira-bot" created="Sun, 20 Mar 2016 23:09:28 +0000"  >&lt;p&gt;Commit b2a4003d4c91d2e7e8f46b546bf1ac988b95ad3f in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;thetaphi&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b2a4003&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b2a4003&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8082&quot; title=&quot;can&amp;#39;t query against negative float or double values when indexed=&amp;quot;false&amp;quot; docValues=&amp;quot;true&amp;quot; multiValued=&amp;quot;false&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8082&quot;&gt;&lt;del&gt;SOLR-8082&lt;/del&gt;&lt;/a&gt;: Fix forbidden APIs&lt;/p&gt;</comment>
                            <comment id="15203562" author="jira-bot" created="Sun, 20 Mar 2016 23:10:20 +0000"  >&lt;p&gt;Commit 1d98753e2e3b4a30b799c4a15dcbea25c279979e in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;thetaphi&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1d98753&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1d98753&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8082&quot; title=&quot;can&amp;#39;t query against negative float or double values when indexed=&amp;quot;false&amp;quot; docValues=&amp;quot;true&amp;quot; multiValued=&amp;quot;false&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8082&quot;&gt;&lt;del&gt;SOLR-8082&lt;/del&gt;&lt;/a&gt;: Fix forbidden APIs&lt;/p&gt;</comment>
                            <comment id="15203563" author="jira-bot" created="Sun, 20 Mar 2016 23:11:21 +0000"  >&lt;p&gt;Commit 8c0271cbb8ff82dd3c218bcbad5834905e489273 in lucene-solr&apos;s branch refs/heads/branch_6_0 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;thetaphi&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8c0271c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8c0271c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8082&quot; title=&quot;can&amp;#39;t query against negative float or double values when indexed=&amp;quot;false&amp;quot; docValues=&amp;quot;true&amp;quot; multiValued=&amp;quot;false&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8082&quot;&gt;&lt;del&gt;SOLR-8082&lt;/del&gt;&lt;/a&gt;: Fix forbidden APIs&lt;/p&gt;</comment>
                            <comment id="15256553" author="anshumg" created="Mon, 25 Apr 2016 16:36:00 +0000"  >&lt;p&gt;Is this something that should make it&apos;s way to 5x too? &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yseeley%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yseeley@gmail.com&quot;&gt;yseeley@gmail.com&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ichattopadhyaya&quot; class=&quot;user-hover&quot; rel=&quot;ichattopadhyaya&quot;&gt;ichattopadhyaya&lt;/a&gt;, and others who were involved here ?&lt;/p&gt;</comment>
                            <comment id="15256763" author="steve_rowe" created="Mon, 25 Apr 2016 18:40:24 +0000"  >&lt;p&gt;Yes &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anshumg&quot; class=&quot;user-hover&quot; rel=&quot;anshumg&quot;&gt;anshumg&lt;/a&gt;, I think it would make sense for 5x too.&lt;/p&gt;</comment>
                            <comment id="15256871" author="ichattopadhyaya" created="Mon, 25 Apr 2016 19:34:53 +0000"  >&lt;p&gt;Yes, Anshum. I think this should be backported to 5x, and also released as part of 5.5.1.&lt;/p&gt;</comment>
                            <comment id="15260729" author="steve_rowe" created="Wed, 27 Apr 2016 18:45:20 +0000"  >&lt;p&gt;Reopening to backport to branch_5x and branch_5_5. &lt;/p&gt;</comment>
                            <comment id="15261186" author="jira-bot" created="Wed, 27 Apr 2016 23:28:28 +0000"  >&lt;p&gt;Commit 79636a73fc1543fa69bdc5081f3fb20e108fce75 in lucene-solr&apos;s branch refs/heads/branch_5x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=79636a7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=79636a7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8082&quot; title=&quot;can&amp;#39;t query against negative float or double values when indexed=&amp;quot;false&amp;quot; docValues=&amp;quot;true&amp;quot; multiValued=&amp;quot;false&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8082&quot;&gt;&lt;del&gt;SOLR-8082&lt;/del&gt;&lt;/a&gt;: Can&apos;t query against negative float or double values when indexed=&apos;false&apos; docValues=&apos;true&apos; multiValued=&apos;false&apos;&lt;/p&gt;</comment>
                            <comment id="15261233" author="jira-bot" created="Wed, 27 Apr 2016 23:53:18 +0000"  >&lt;p&gt;Commit f0f9081e345030dd8946fb0141b4315c193a88ce in lucene-solr&apos;s branch refs/heads/branch_5_5 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=f0f9081&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=f0f9081&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8082&quot; title=&quot;can&amp;#39;t query against negative float or double values when indexed=&amp;quot;false&amp;quot; docValues=&amp;quot;true&amp;quot; multiValued=&amp;quot;false&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8082&quot;&gt;&lt;del&gt;SOLR-8082&lt;/del&gt;&lt;/a&gt;: Can&apos;t query against negative float or double values when indexed=&apos;false&apos; docValues=&apos;true&apos; multiValued=&apos;false&apos;&lt;/p&gt;</comment>
                            <comment id="15261235" author="steve_rowe" created="Wed, 27 Apr 2016 23:54:08 +0000"  >&lt;p&gt;In backporting to branch_5x I had to convert some lambdas to functors (for Java7), and was all ready to push, but when I pulled and got Yonik&#8217;s &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8886&quot; title=&quot;TrieField.toObject(IndexableField) can&amp;#39;t handle docValues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8886&quot;&gt;&lt;del&gt;SOLR-8886&lt;/del&gt;&lt;/a&gt; changes, there were conflicts, and attempts at merging brought in a shitload of extraneous crap, so I changed strategies: I applied the commit diffs from the two master commits on this issue with &lt;tt&gt;patch&lt;/tt&gt; and fixed up the rejects manually.&lt;/p&gt;</comment>
                            <comment id="15277177" author="hossman" created="Mon, 9 May 2016 22:15:36 +0000"  >
&lt;p&gt;Manually correcting fixVersion per Step #S5 of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-7271&quot; title=&quot;Cleanup jira&amp;#39;s concept of &amp;#39;master&amp;#39; and &amp;#39;6.0&amp;#39;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-7271&quot;&gt;&lt;del&gt;LUCENE-7271&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12721235">SOLR-6168</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is blocked by">
                                        <issuelink>
            <issuekey id="12951075">LUCENE-7111</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12949751">SOLR-8838</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12951240">SOLR-8867</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12794376" name="SOLR-8082.patch" size="35012" author="sarowe" created="Sat, 19 Mar 2016 19:17:13 +0000"/>
                            <attachment id="12794104" name="SOLR-8082.patch" size="34585" author="yseeley@gmail.com" created="Fri, 18 Mar 2016 01:48:44 +0000"/>
                            <attachment id="12793973" name="SOLR-8082.patch" size="33394" author="ichattopadhyaya" created="Thu, 17 Mar 2016 12:59:41 +0000"/>
                            <attachment id="12793773" name="SOLR-8082.patch" size="20766" author="ichattopadhyaya" created="Wed, 16 Mar 2016 16:20:42 +0000"/>
                            <attachment id="12793768" name="SOLR-8082.patch" size="19573" author="ichattopadhyaya" created="Wed, 16 Mar 2016 16:07:15 +0000"/>
                            <attachment id="12793759" name="SOLR-8082.patch" size="19079" author="ichattopadhyaya" created="Wed, 16 Mar 2016 15:09:19 +0000"/>
                            <attachment id="12793552" name="SOLR-8082.patch" size="16488" author="ichattopadhyaya" created="Tue, 15 Mar 2016 15:11:34 +0000"/>
                            <attachment id="12761761" name="SOLR-8082.patch" size="9890" author="hossman" created="Tue, 22 Sep 2015 23:46:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>8.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 28 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2ldd3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>