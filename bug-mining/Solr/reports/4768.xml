<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:49:05 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-15849] Incorrect use Zookeeper 4LW </title>
                <link>https://issues.apache.org/jira/browse/SOLR-15849</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;&lt;b&gt;Error code location&lt;/b&gt;:&lt;/p&gt;

&lt;p&gt;org.apache.solr.handler.admin.ZookeeperStatusHandler&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
getZkRawResponse()

&#160;    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (
        Socket socket = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Socket(host, port);
        Writer writer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; OutputStreamWriter(socket.getOutputStream(), &lt;span class=&quot;code-quote&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;);
        PrintWriter out = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PrintWriter(writer, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        BufferedReader in = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BufferedReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InputStreamReader(socket.getInputStream(), &lt;span class=&quot;code-quote&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;));) {
      out.println(fourLetterWordCommand);
      List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; response = in.lines().collect(Collectors.toList());
      log.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Got response from ZK on host {} and port {}: {}&quot;&lt;/span&gt;, host, port, response);

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Zookeeper only accepts 4LW, but solr socket sends 4LW with \n.&lt;br/&gt;
After reading 4LW, ZooKeeper will call the close method to close the socket. At this time, there will be \n unread in the cache, which will cause the connection that should send FIN to release will be changed to RST, and the solr socket client will throw it out in some cases. The exception (java.net.SocketException: Connection reset) which causes the Solr Admin UI interface zkStatus to be yellow.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;H&lt;/b&gt;&lt;b&gt;ere is some amendments by myself&#65306;&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;getZkRawResponse()

&#160;    &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (
        Socket socket = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Socket(host, port);
        Writer writer = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; OutputStreamWriter(socket.getOutputStream(), &lt;span class=&quot;code-quote&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;);
        PrintWriter out = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; PrintWriter(writer, &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
        BufferedReader in = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BufferedReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InputStreamReader(socket.getInputStream(), &lt;span class=&quot;code-quote&quot;&gt;&quot;utf-8&quot;&lt;/span&gt;));) {
      out.print(fourLetterWordCommand);
      out.flush();
      List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; response = in.lines().collect(Collectors.toList());
      log.debug(&lt;span class=&quot;code-quote&quot;&gt;&quot;Got response from ZK on host {} and port {}: {}&quot;&lt;/span&gt;, host, port, response);

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13417465">SOLR-15849</key>
            <summary>Incorrect use Zookeeper 4LW </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="janhoy">Jan H&#248;ydahl</assignee>
                                    <reporter username="q6364325">Fa Ming</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Dec 2021 14:40:23 +0000</created>
                <updated>Fri, 13 May 2022 11:41:21 +0000</updated>
                            <resolved>Wed, 15 Dec 2021 10:14:23 +0000</resolved>
                                    <version>7.5</version>
                    <version>8.10.1</version>
                                    <fixVersion>9.0</fixVersion>
                    <fixVersion>8.11.2</fixVersion>
                                    <component>Admin UI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="17459204" author="janhoy" created="Tue, 14 Dec 2021 14:44:12 +0000"  >&lt;p&gt;Thanks for this. Are&#160; you able to submit this as a GitHub Pull Request?&lt;/p&gt;</comment>
                            <comment id="17459263" author="JIRAUSER281711" created="Tue, 14 Dec 2021 15:48:31 +0000"  >&lt;p&gt;Okay&lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17459804" author="jira-bot" created="Wed, 15 Dec 2021 10:13:41 +0000"  >&lt;p&gt;Commit 48ffa68aecc98b5ff0489705520d0cd1e81a1a09 in solr&apos;s branch refs/heads/main from Fa Ming&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=48ffa68&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=48ffa68&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15849&quot; title=&quot;Incorrect use Zookeeper 4LW &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15849&quot;&gt;&lt;del&gt;SOLR-15849&lt;/del&gt;&lt;/a&gt; Incorrect use Zookeeper 4LW (#458)&lt;/p&gt;
</comment>
                            <comment id="17459806" author="janhoy" created="Wed, 15 Dec 2021 10:14:23 +0000"  >&lt;p&gt;Thanks for the contribution! We may backport this to next 8.x bugfix release if necessary. In that case we&apos;ll re-open.&lt;/p&gt;</comment>
                            <comment id="17535364" author="janhoy" created="Thu, 12 May 2022 00:26:21 +0000"  >&lt;p&gt;Closing after the 9.0.0 release&lt;/p&gt;</comment>
                            <comment id="17536149" author="jira-bot" created="Thu, 12 May 2022 14:33:49 +0000"  >&lt;p&gt;Commit b1779a63bdb4f49a8448621e407eaff82187f052 in lucene-solr&apos;s branch refs/heads/branch_8_11 from Fa Ming&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=b1779a63bdb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=b1779a63bdb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15849&quot; title=&quot;Incorrect use Zookeeper 4LW &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15849&quot;&gt;&lt;del&gt;SOLR-15849&lt;/del&gt;&lt;/a&gt; Incorrect use Zookeeper 4LW (#458)&lt;/p&gt;

&lt;p&gt;Back-ported from &lt;a href=&quot;https://github.com/apache/solr/commit/48ffa68aecc98b5ff0489705520d0cd1e81a1a09&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/commit/48ffa68aecc98b5ff0489705520d0cd1e81a1a09&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 26 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0xp28:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>