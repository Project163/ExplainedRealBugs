<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:38:32 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5144] IllegalArgumentException when splitting shard</title>
                <link>https://issues.apache.org/jira/browse/SOLR-5144</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I&apos;m hitting an IllegalArgumentException reproducibly when doing the following steps:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;curl &apos;http://localhost:8983/solr/admin/cores?action=CREATE&amp;amp;collection=sockmonkey&amp;amp;name=sockmonkeycore1&amp;amp;numShards=1&amp;amp;shard=shard1&amp;amp;replicationFactor=1&apos;&lt;/li&gt;
	&lt;li&gt;curl &apos;http://localhost:8983/solr/admin/cores?action=CREATE&amp;amp;collection=sockmonkey&amp;amp;name=sockmonkeycore2&amp;amp;shard=shard2&apos;&lt;/li&gt;
	&lt;li&gt;curl &apos;http://localhost:8983/solr/admin/cores?action=CREATE&amp;amp;collection=sockmonkey&amp;amp;name=sockmonkeycore3&amp;amp;shard=shard3&apos;&lt;/li&gt;
	&lt;li&gt;cd exampledocs/&lt;/li&gt;
	&lt;li&gt;java -Durl=&lt;a href=&quot;http://localhost:8983/solr/sockmonkey/update&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/sockmonkey/update&lt;/a&gt; -jar post.jar ipod_video.xml&lt;/li&gt;
	&lt;li&gt;java -Durl=&lt;a href=&quot;http://localhost:8983/solr/sockmonkey/update&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/sockmonkey/update&lt;/a&gt; -jar post.jar monitor.xml&lt;/li&gt;
	&lt;li&gt;java -Durl=&lt;a href=&quot;http://localhost:8983/solr/sockmonkey/update&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/sockmonkey/update&lt;/a&gt; -jar post.jar mem.xml&lt;/li&gt;
	&lt;li&gt;cd ..&lt;/li&gt;
	&lt;li&gt;curl &apos;http://localhost:8983/solr/admin/cores?core=sockmonkeycore1&amp;amp;action=SPLIT&amp;amp;targetCore=sockmonkeycore2&amp;amp;targetCore=sockmonkeycore3&apos;&lt;/li&gt;
&lt;/ol&gt;



&lt;p&gt;ERROR org.apache.solr.servlet.SolrDispatchFilter &lt;br/&gt;
 &#8211; null:java.lang.RuntimeException: java.lang.IllegalArgumentException: &lt;br/&gt;
maxValue must be non-negative (got: -1) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.solr.handler.admin.CoreAdminHandler.handleSplitAction(CoreAdminHandler.java:290) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.solr.handler.admin.CoreAdminHandler.handleRequestBody(CoreAdminHandler.java:186) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:135) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.solr.servlet.SolrDispatchFilter.handleAdminRequest(SolrDispatchFilter.java:611) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:209) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:158) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1419) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:455) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:557) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1075) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:384) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1009) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116) &lt;br/&gt;
        at org.eclipse.jetty.server.Server.handle(Server.java:368) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:489) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.AbstractHttpConnection.content(AbstractHttpConnection.java:953) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.content(AbstractHttpConnection.java:1014) &lt;br/&gt;
        at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:861) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:240) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608) &lt;br/&gt;
        at &lt;br/&gt;
org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543) &lt;br/&gt;
        at java.lang.Thread.run(Thread.java:662) &lt;br/&gt;
Caused by: java.lang.IllegalArgumentException: maxValue must be &lt;br/&gt;
non-negative (got: -1) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.lucene.util.packed.PackedInts.bitsRequired(PackedInts.java:1184) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.lucene.codecs.lucene42.Lucene42DocValuesConsumer.addNumericField(Lucene42DocValuesConsumer.java:140) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.lucene.codecs.lucene42.Lucene42DocValuesConsumer.addNumericField(Lucene42DocValuesConsumer.java:92) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.lucene.codecs.DocValuesConsumer.mergeNumericField(DocValuesConsumer.java:112) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.lucene.index.SegmentMerger.mergeNorms(SegmentMerger.java:221) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.lucene.index.SegmentMerger.merge(SegmentMerger.java:119) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.lucene.index.IndexWriter.addIndexes(IndexWriter.java:2488) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.solr.update.SolrIndexSplitter.split(SolrIndexSplitter.java:125) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.solr.update.DirectUpdateHandler2.split(DirectUpdateHandler2.java:766) &lt;br/&gt;
        at &lt;br/&gt;
org.apache.solr.handler.admin.CoreAdminHandler.handleSplitAction(CoreAdminHandler.java:284) &lt;br/&gt;
        ... 30 more &lt;/p&gt;</description>
                <environment></environment>
        <key id="12663537">SOLR-5144</key>
            <summary>IllegalArgumentException when splitting shard</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="3">Duplicate</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mewmewball">Jessica Cheng Mallet</reporter>
                        <labels>
                            <label>admin</label>
                            <label>split</label>
                            <label>update</label>
                    </labels>
                <created>Tue, 13 Aug 2013 23:42:49 +0000</created>
                <updated>Wed, 14 Aug 2013 17:18:14 +0000</updated>
                            <resolved>Wed, 14 Aug 2013 17:04:02 +0000</resolved>
                                    <version>4.3</version>
                    <version>4.4</version>
                                                    <component>update</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13739130" author="rcmuir" created="Wed, 14 Aug 2013 01:26:36 +0000"  >&lt;p&gt;I think the patch on &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-5116&quot; title=&quot;IW.addIndexes doesn&amp;#39;t prune all deleted segments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-5116&quot;&gt;&lt;del&gt;LUCENE-5116&lt;/del&gt;&lt;/a&gt; should fix this? (or you can svn up to current branch_4x)&lt;/p&gt;</comment>
                            <comment id="13739775" author="rcmuir" created="Wed, 14 Aug 2013 15:34:20 +0000"  >&lt;p&gt;Heres a test that fails on 4.4 release, but patches with current branch_4x.&lt;/p&gt;

&lt;p&gt;So I think this confirms its fixed by &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-5116&quot; title=&quot;IW.addIndexes doesn&amp;#39;t prune all deleted segments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-5116&quot;&gt;&lt;del&gt;LUCENE-5116&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13739871" author="jira-bot" created="Wed, 14 Aug 2013 16:56:56 +0000"  >&lt;p&gt;Commit 1513962 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rcmuir&quot; class=&quot;user-hover&quot; rel=&quot;rcmuir&quot;&gt;rcmuir&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1513962&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1513962&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5144&quot; title=&quot;IllegalArgumentException when splitting shard&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5144&quot;&gt;&lt;del&gt;SOLR-5144&lt;/del&gt;&lt;/a&gt;: add test that failed on 4.4&lt;/p&gt;</comment>
                            <comment id="13739876" author="jira-bot" created="Wed, 14 Aug 2013 17:01:14 +0000"  >&lt;p&gt;Commit 1513965 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rcmuir&quot; class=&quot;user-hover&quot; rel=&quot;rcmuir&quot;&gt;rcmuir&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1513965&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1513965&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5144&quot; title=&quot;IllegalArgumentException when splitting shard&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5144&quot;&gt;&lt;del&gt;SOLR-5144&lt;/del&gt;&lt;/a&gt;: add test that failed on 4.4&lt;/p&gt;</comment>
                            <comment id="13739881" author="rcmuir" created="Wed, 14 Aug 2013 17:04:02 +0000"  >&lt;p&gt;This issue is already fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-5116&quot; title=&quot;IW.addIndexes doesn&amp;#39;t prune all deleted segments&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-5116&quot;&gt;&lt;del&gt;LUCENE-5116&lt;/del&gt;&lt;/a&gt; (unfortunately that did not quite make into the 4.4 release, we didnt know it caused actual problems just &apos;smelled funny&apos;)&lt;/p&gt;

&lt;p&gt;I committed this test (which would fail depending upon codec, as some codecs arent really prepared to write 0 document segments).&lt;/p&gt;

&lt;p&gt;Furthermore as of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-5173&quot; title=&quot;Add checkindex piece of LUCENE-5116&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-5173&quot;&gt;&lt;del&gt;LUCENE-5173&lt;/del&gt;&lt;/a&gt;, additional checks/paranoia are added to ensure lucene never writes 0 document segments anymore.&lt;/p&gt;</comment>
                            <comment id="13739895" author="mewmewball" created="Wed, 14 Aug 2013 17:18:14 +0000"  >&lt;p&gt;Thanks Robert! I&apos;ll try it out.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12597985" name="SOLR-5144_test.patch" size="2479" author="rcmuir" created="Wed, 14 Aug 2013 15:34:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343538</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 14 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1n8tj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>343842</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>