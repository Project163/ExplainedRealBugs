<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:11:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-17361] OpenJ9 can&apos;t compile solr: No method HotSpotDiagnosticMXBean.dumpHeap</title>
                <link>https://issues.apache.org/jira/browse/SOLR-17361</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Every jenkins build (of both main and 9x) using openJ9 fails during compilation due to..&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;gt; Task :solr:benchmark:compileJava
/home/jenkins/workspace/Solr-main-Linux/solr/benchmark/src/java/org/apache/solr/bench/BaseBenchState.java:153: error: cannot find symbol
        mxBean.dumpHeap(dumpFile.toAbsolutePath().toString(), true);
              ^
  symbol:   method dumpHeap(String,boolean)
  location: variable mxBean of type HotSpotDiagnosticMXBean
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13584873">SOLR-17361</key>
            <summary>OpenJ9 can&apos;t compile solr: No method HotSpotDiagnosticMXBean.dumpHeap</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="stillalex">Alex Deparvu</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 5 Jul 2024 22:43:11 +0000</created>
                <updated>Fri, 17 Oct 2025 20:05:00 +0000</updated>
                            <resolved>Fri, 9 May 2025 12:25:16 +0000</resolved>
                                                    <fixVersion>10.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="2400">40m</timespent>
                                <comments>
                            <comment id="17863421" author="hossman" created="Fri, 5 Jul 2024 23:01:01 +0000"  >&lt;p&gt;The code in question has existed since &lt;b&gt;2021&lt;/b&gt;, and I know we&apos;ve had several had other Jira&apos;s fix problems running solr in OpenJ9 since then, so i can&apos;t imagine this compilation failure has existed since 2021 &#8211; my best guess is that this code &lt;em&gt;use&lt;/em&gt; to compile with OpenJ9, but at some point OpenJ9 removed methods from their definition/implementation of &lt;tt&gt;com.sun.management.HotSpotDiagnosticMXBean&lt;/tt&gt; (since it was never meant for direct consumption) and they started offering their own MBeans for accessing JVM internals...&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;https://eclipse.dev/openj9/docs/api/jdk11/jdk.management/com/sun/management/HotSpotDiagnosticMXBean.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://eclipse.dev/openj9/docs/api/jdk11/jdk.management/com/sun/management/HotSpotDiagnosticMXBean.html&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://eclipse.dev/openj9/docs/api/jdk11/jdk.management/openj9/lang/management/package-summary.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://eclipse.dev/openj9/docs/api/jdk11/jdk.management/openj9/lang/management/package-summary.html&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://eclipse.dev/openj9/docs/api/jdk11/jdk.management/com/ibm/lang/management/package-summary.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://eclipse.dev/openj9/docs/api/jdk11/jdk.management/com/ibm/lang/management/package-summary.html&lt;/a&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;While it may be possible to write some more complex code to introspect the JVM to figure out what MBean to use and how to use it to take a heapdump, i would suggest that first and foremost we stop trying to use &lt;tt&gt;com.sun.management.HotSpotDiagnosticMXBean&lt;/tt&gt; directly, and instead use the &lt;tt&gt;MBeanServer.invoke&lt;/tt&gt; abstraction &#8211; something like...&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; mbeanName = &lt;span class=&quot;code-quote&quot;&gt;&quot;com.sun.management:type=HotSpotDiagnostic&quot;&lt;/span&gt;;
&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
  MBeanServer server = ManagementFactory.getPlatformMBeanServer();
  ObjectName hotSpot = ObjectName.getInstance(mbeanName);
  server.invoke(
    hotSpot,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;dumpHeap&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt;[] { dumpFile.toAbsolutePath().toString(), &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; }, 
    &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[]{ &lt;span class=&quot;code-quote&quot;&gt;&quot;java.lang.&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt;&quot;&lt;/span&gt; });
} &lt;span class=&quot;code-keyword&quot;&gt;catch&lt;/span&gt; (Exception e) {
  &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; RuntimeException(&lt;span class=&quot;code-quote&quot;&gt;&quot;Your JVM&apos;s imple of &quot;&lt;/span&gt; + mbeanName + &lt;span class=&quot;code-quote&quot;&gt;&quot; does not support dumpHeap&quot;&lt;/span&gt;, e)
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;...but i don&apos;t really understand &lt;tt&gt;solr/benchmark&lt;/tt&gt; enough to even know how i would go about testing this.&lt;/p&gt;

&lt;p&gt;/ping &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=krisden&quot; class=&quot;user-hover&quot; rel=&quot;krisden&quot;&gt;krisden&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stillalex&quot; class=&quot;user-hover&quot; rel=&quot;stillalex&quot;&gt;stillalex&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17908706" author="alex.parvulescu" created="Sun, 29 Dec 2024 14:19:32 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman&quot; class=&quot;user-hover&quot; rel=&quot;hossman&quot;&gt;hossman&lt;/a&gt; I put togther a PR to remove the problematic dependency, as per your suggestion &lt;a href=&quot;https://github.com/apache/solr/pull/2929&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/pull/2929&lt;/a&gt; &lt;br/&gt;
could you take a look?&lt;/p&gt;</comment>
                            <comment id="17950503" author="jira-bot" created="Fri, 9 May 2025 12:24:13 +0000"  >&lt;p&gt;Commit ee5063915bdcf481d137fa5480fd1877cb740c7e in solr&apos;s branch refs/heads/main from Alex Deparvu&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=ee5063915bd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=ee5063915bd&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17361&quot; title=&quot;OpenJ9 can&amp;#39;t compile solr: No method HotSpotDiagnosticMXBean.dumpHeap&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17361&quot;&gt;&lt;del&gt;SOLR-17361&lt;/del&gt;&lt;/a&gt; OpenJ9 can&apos;t compile solr: No method HotSpotDiagnosticMXBean.dumpHeap (#2929)&lt;/p&gt;
</comment>
                            <comment id="17950504" author="alex.parvulescu" created="Fri, 9 May 2025 12:25:02 +0000"  >&lt;p&gt;I merged the PR to main branch only. I don&apos;t plan on backporting unless there is a specific ask to do so.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            26 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1q6i0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>