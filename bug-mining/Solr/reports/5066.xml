<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:01:46 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16877] solr backup via collections api fails with NPE when config contains an empty zookeeper node</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16877</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The root cause for the backup to fail is an empty node in zookeeper (E.g. the querqy request handler in solr creates an empty .data node when starting up).&lt;/p&gt;

&lt;p&gt;To reproduce the issue, create a new (empty) node in zk (via zkCli.sh session and &quot;create&quot; command) under a configset of your collection and back up this collection via the collections API with action=BACKUP command.&lt;/p&gt;

&lt;p&gt;The reason is that the byte array provided to java.io.OutputStream.write is null in the case of an empty zookeeper node.&lt;/p&gt;

&lt;p&gt;Error:&lt;br/&gt;
2023-07-07 12:33:52.121 DEBUG (OverseerThreadFactory-17-thread-3) &lt;span class=&quot;error&quot;&gt;&amp;#91;c:gettingstarted_20230707&amp;#93;&lt;/span&gt; o.a.s.c.b.BackupManager&#160;&lt;b&gt;Writing file querqy/rewriters/.data&lt;/b&gt;&lt;br/&gt;
2023-07-07 12:33:52.123 ERROR (OverseerThreadFactory-17-thread-3) &lt;span class=&quot;error&quot;&gt;&amp;#91;c:gettingstarted_20230707&amp;#93;&lt;/span&gt; o.a.s.c.a.c.OverseerCollectionMessageHandler Collection: gettingstarted_20230707 operation: backup failed =&amp;gt; java.lang.NullPointerException: Cannot read the array length because &quot;&amp;lt;parameter1&amp;gt;&quot; is null&lt;br/&gt;
at java.base/java.io.OutputStream.write(Unknown Source)&lt;br/&gt;
java.lang.NullPointerException: Cannot read the array length because &quot;&amp;lt;parameter1&amp;gt;&quot; is null&lt;br/&gt;
at java.io.OutputStream.write(Unknown Source) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
at org.apache.solr.core.backup.BackupManager.downloadConfigToRepo(BackupManager.java:349) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
at org.apache.solr.core.backup.BackupManager.downloadConfigDir(BackupManager.java:276) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
at org.apache.solr.cloud.api.collections.BackupCmd.call(BackupCmd.java:149) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
at org.apache.solr.cloud.api.collections.OverseerCollectionMessageHandler.processMessage(OverseerCollectionMessageHandler.java:126) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
at org.apache.solr.cloud.OverseerTaskProcessor$Runner.run(OverseerTaskProcessor.java:566) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
at org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:289) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
at java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) ~&lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;br/&gt;
at java.lang.Thread.run(Unknown Source) &lt;span class=&quot;error&quot;&gt;&amp;#91;?:?&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Note:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;when you create an empty file (with touch) and copy it in zookeeper (with &quot;solr zk cp&quot;), the backup doesn&apos;t raise the error (and backup succeeds).&lt;/li&gt;
	&lt;li&gt;when you create an empty node in zookeeper (via zkCli.sh session and &quot;create&quot; command), the backup raises the same error.&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13542810">SOLR-16877</key>
            <summary>solr backup via collections api fails with NPE when config contains an empty zookeeper node</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="houston">Houston Putman</assignee>
                                    <reporter username="paul@search-solutions.net">Paul Blanchaert</reporter>
                        <labels>
                            <label>backup</label>
                            <label>collection-api</label>
                    </labels>
                <created>Fri, 7 Jul 2023 13:17:25 +0000</created>
                <updated>Fri, 21 Jul 2023 20:42:12 +0000</updated>
                            <resolved>Mon, 10 Jul 2023 15:26:24 +0000</resolved>
                                    <version>9.2.1</version>
                                    <fixVersion>9.3</fixVersion>
                                    <component>Backup/Restore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="17741107" author="paul@search-solutions.net" created="Fri, 7 Jul 2023 15:57:48 +0000"  >&lt;p&gt;PR created &lt;a href=&quot;https://github.com/apache/solr/pull/1764&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;#1764&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17741644" author="jira-bot" created="Mon, 10 Jul 2023 14:46:41 +0000"  >&lt;p&gt;Commit 6350eb53955639da1d1da60cf77d0ef440d9094d in solr&apos;s branch refs/heads/main from paulb&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=6350eb53955&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=6350eb53955&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16877&quot; title=&quot;solr backup via collections api fails with NPE when config contains an empty zookeeper node&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16877&quot;&gt;&lt;del&gt;SOLR-16877&lt;/del&gt;&lt;/a&gt;: Allow empty ZK data in Backup (#1764)&lt;/p&gt;

&lt;p&gt;Fixes #1764&lt;/p&gt;</comment>
                            <comment id="17741646" author="jira-bot" created="Mon, 10 Jul 2023 14:52:16 +0000"  >&lt;p&gt;Commit f9510c0fdaeb9147bc731498ec4132791fc1246c in solr&apos;s branch refs/heads/branch_9x from paulb&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=f9510c0fdae&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=f9510c0fdae&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16877&quot; title=&quot;solr backup via collections api fails with NPE when config contains an empty zookeeper node&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16877&quot;&gt;&lt;del&gt;SOLR-16877&lt;/del&gt;&lt;/a&gt;: Allow empty ZK data in Backup (#1764)&lt;/p&gt;

&lt;p&gt;Fixes #1764&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 6350eb53955639da1d1da60cf77d0ef440d9094d)&lt;/p&gt;</comment>
                            <comment id="17741649" author="jira-bot" created="Mon, 10 Jul 2023 14:53:40 +0000"  >&lt;p&gt;Commit a7011d5758d97bf84c58dcba3492cbb1c1406b68 in solr&apos;s branch refs/heads/branch_9_3 from paulb&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=a7011d5758d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=a7011d5758d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16877&quot; title=&quot;solr backup via collections api fails with NPE when config contains an empty zookeeper node&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16877&quot;&gt;&lt;del&gt;SOLR-16877&lt;/del&gt;&lt;/a&gt;: Allow empty ZK data in Backup (#1764)&lt;/p&gt;

&lt;p&gt;Fixes #1764&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 6350eb53955639da1d1da60cf77d0ef440d9094d)&lt;/p&gt;</comment>
                            <comment id="17745812" author="houston" created="Fri, 21 Jul 2023 20:40:41 +0000"  >&lt;p&gt;Closing after the 9.3.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1j0s8:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>