<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:45:25 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-14700] CloudSolrClient cannot be used without setting an explicit streamContext</title>
                <link>https://issues.apache.org/jira/browse/SOLR-14700</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;A naive approach to using CloudSolrClient, such as on this page: &lt;a href=&quot;http://joelsolr.blogspot.com/2015/04/the-streaming-api-solrjio-basics.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://joelsolr.blogspot.com/2015/04/the-streaming-api-solrjio-basics.html&lt;/a&gt; - will not work: opening the stream will throw an IOException with an embedded NullPointerException.&lt;/p&gt;

&lt;p&gt;This took me a while to figure out, and I think it would be good to either update the documentation or &quot;fix&quot; the constructor to set the needed streamContext as appropriate.&lt;/p&gt;

&lt;p&gt;I found this snippet of code in TuppleStream.java, that seems to &quot;almost&quot; work without a streamContext:&lt;/p&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-comment&quot;&gt;// line 127 in the sources to TuppleStream.java:
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; getShards(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; zkHost,
                                       &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; collection,
                                       StreamContext streamContext,
                                       SolrParams requestParams)
...

&lt;span class=&quot;code-comment&quot;&gt;// line 135
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;(streamContext != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
      shardsMap = (Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, List&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt;&amp;gt;)streamContext.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;shards&quot;&lt;/span&gt;);
    }
...
&lt;span class=&quot;code-comment&quot;&gt;// line 144
&lt;/span&gt;CloudSolrClient cloudSolrClient =
          Optional.ofNullable(streamContext.getSolrClientCache()).orElseGet(SolrClientCache::&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;).getCloudSolrClient(zkHost);

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;if streamContext is null in the last statement, a NullPointerException will be thrown and open&apos;ening the stream will fail.&lt;/p&gt;

&lt;p&gt;This took me way too long time to figure out.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13320499">SOLR-14700</key>
            <summary>CloudSolrClient cannot be used without setting an explicit streamContext</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="mabd">Mads Bondo Dydensborg</reporter>
                        <labels>
                    </labels>
                <created>Sat, 1 Aug 2020 13:52:19 +0000</created>
                <updated>Wed, 27 Jan 2021 11:20:18 +0000</updated>
                            <resolved>Mon, 24 Aug 2020 12:25:44 +0000</resolved>
                                    <version>8.6</version>
                                    <fixVersion>8.7</fixVersion>
                    <fixVersion>9.0</fixVersion>
                                    <component>clients - java</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4200">1h 10m</timespent>
                                <comments>
                            <comment id="17169295" author="mabd" created="Sat, 1 Aug 2020 13:54:17 +0000"  >&lt;p&gt;Workaround is to set a default streamContext:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

&lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (CloudSolrStream cstream = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; CloudSolrStream(zkHost, collection, params)) {
            StreamContext streamContext = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StreamContext();
            cstream.setStreamContext(streamContext);     
            cstream.open();
 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;still think this should be clearer though.&lt;/p&gt;</comment>
                            <comment id="17177868" author="cpoerschke" created="Fri, 14 Aug 2020 16:38:14 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mabd&quot; class=&quot;user-hover&quot; rel=&quot;mabd&quot;&gt;mabd&lt;/a&gt; for reporting and diagnosing this issue!&lt;/p&gt;

&lt;p&gt;I&apos;ve just opened &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/1754&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/1754&lt;/a&gt; to explore fixing the &lt;tt&gt;NullPointerException&lt;/tt&gt; itself so that &lt;tt&gt;CloudSolrStream&lt;/tt&gt; could then be used without a &lt;tt&gt;StreamContext&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jbernste&quot; class=&quot;user-hover&quot; rel=&quot;jbernste&quot;&gt;jbernste&lt;/a&gt;, would you have any thoughts on this?&lt;/p&gt;</comment>
                            <comment id="17178827" author="mabd" created="Mon, 17 Aug 2020 08:08:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cpoerschke&quot; class=&quot;user-hover&quot; rel=&quot;cpoerschke&quot;&gt;cpoerschke&lt;/a&gt; you are most welcome - thanks for looking into fixing / improving this part of the code.&lt;/p&gt;</comment>
                            <comment id="17183183" author="jira-bot" created="Mon, 24 Aug 2020 12:00:55 +0000"  >&lt;p&gt;Commit 4761dbabd9be5b34d902563afee350c2d17db66b in lucene-solr&apos;s branch refs/heads/master from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=4761dba&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=4761dba&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14700&quot; title=&quot;CloudSolrClient cannot be used without setting an explicit streamContext&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14700&quot;&gt;&lt;del&gt;SOLR-14700&lt;/del&gt;&lt;/a&gt;: avoid NPEs in TupleStream.getShards() when streamContext is null. (#1754)&lt;/p&gt;
</comment>
                            <comment id="17183201" author="jira-bot" created="Mon, 24 Aug 2020 12:24:24 +0000"  >&lt;p&gt;Commit dd76373ef089eecb9c2db175fa2dca35eb4a09c7 in lucene-solr&apos;s branch refs/heads/branch_8x from Christine Poerschke&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=dd76373&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=dd76373&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14700&quot; title=&quot;CloudSolrClient cannot be used without setting an explicit streamContext&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14700&quot;&gt;&lt;del&gt;SOLR-14700&lt;/del&gt;&lt;/a&gt;: avoid NPEs in TupleStream.getShards() when streamContext is null. (#1754)&lt;/p&gt;

&lt;p&gt;Resolved Conflicts:&lt;br/&gt;
	solr/solrj/src/java/org/apache/solr/client/solrj/io/stream/TupleStream.java&lt;/p&gt;</comment>
                            <comment id="17226113" author="atri" created="Wed, 4 Nov 2020 15:21:30 +0000"  >&lt;p&gt;Closing after the 8.7.0 release&lt;/p&gt;</comment>
                            <comment id="17272306" author="joel.bernstein" created="Tue, 26 Jan 2021 18:18:44 +0000"  >&lt;p&gt;I just wanted to comment on this. &lt;/p&gt;

&lt;p&gt;At this point Streaming Expressions are really designed to be run by passing a String expression to the Stream handler. I should probably just remove the blogs that show the classes being used as they a very out of date.&lt;/p&gt;</comment>
                            <comment id="17272780" author="mabd" created="Wed, 27 Jan 2021 11:20:18 +0000"  >&lt;p&gt;Admittedly, I am not a very competent user of the SOLR api, but it &quot;seems to work&quot; (TM) for us now.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;A new blog on the proper way to use it would be awesome though &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 years, 41 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0he8w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>