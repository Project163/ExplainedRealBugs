<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:01:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7038] If no configset exists, CREATE leads to a 500 error with never-ending logging and 100% CPU usage</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7038</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Here&apos;s what I did:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt; bin/solr start -e cloud -noprompt

&amp;gt; curl http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/admin/collections?action=CREATE&amp;amp;name=thisshouldfail&amp;amp;numShards=1&amp;amp;configset=thisisaninvalidconfigset&amp;amp;wt=json&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The above led to a new collection named thisshouldfail, with the config-set as gettingstarted. This call should have failed as there was no configset by that name. Instead, it picked up the only config set it found and used it.&lt;/p&gt;

&lt;p&gt;There&apos;s more to this. I&apos;m not sure how related this is but looks like it to me.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;gt; bin/solr start -c

&amp;gt; curl http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/admin/collections?action=CREATE&amp;amp;name=thisshouldfail&amp;amp;numShards=1&amp;amp;configset=thisisaninvalidconfigset&amp;amp;wt=json&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This led to a 900M (and growing) log file in addition to 100% CPU until I killed Solr.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12770158">SOLR-7038</key>
            <summary>If no configset exists, CREATE leads to a 500 error with never-ending logging and 100% CPU usage</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="anshum">Anshum Gupta</assignee>
                                    <reporter username="anshum">Anshum Gupta</reporter>
                        <labels>
                    </labels>
                <created>Mon, 26 Jan 2015 19:29:03 +0000</created>
                <updated>Mon, 9 May 2016 18:55:11 +0000</updated>
                            <resolved>Thu, 26 Feb 2015 23:08:22 +0000</resolved>
                                    <version>5.0</version>
                                    <fixVersion>4.10.4</fixVersion>
                    <fixVersion>5.0</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="14292418" author="sarowe@syr.edu" created="Mon, 26 Jan 2015 21:11:10 +0000"  >&lt;p&gt;I can repro both conditions on trunk from the source after running &lt;tt&gt;ant server&lt;/tt&gt;.&lt;/p&gt;
</comment>
                            <comment id="14292467" author="anshumg" created="Mon, 26 Jan 2015 21:48:35 +0000"  >&lt;p&gt;rookie error... while trying to create the collection, for some reason I passed the collection name as &apos;configset=&apos; instead of &apos;collection.configName=&apos;  &lt;/p&gt;

&lt;p&gt;The first use case is pretty much invalid but anything taking up 100% CPU and logs that grow to a few GBs in no time is bad so I&apos;m looking at that now.&lt;/p&gt;</comment>
                            <comment id="14292479" author="anshumg" created="Mon, 26 Jan 2015 21:58:34 +0000"  >&lt;p&gt;CREATE call without any configset in SolrCloud:&lt;br/&gt;
&lt;a href=&quot;http://localhost:8983/solr/admin/collections?action=CREATE&amp;amp;name=thisshouldfail&amp;amp;numShards=1&amp;amp;collection.configName=thisisaninvalidconfigset&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/admin/collections?action=CREATE&amp;amp;name=thisshouldfail&amp;amp;numShards=1&amp;amp;collection.configName=thisisaninvalidconfigset&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Here&apos;s the exception that get&apos;s logged over and over again:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;INFO  - 2015-01-26 21:54:16.536; org.apache.solr.cloud.overseer.ClusterStateMutator; building a &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; cName: c1
INFO  - 2015-01-26 21:54:16.536; org.apache.solr.cloud.overseer.ZkStateWriter; going to create_collection /collections/c1/state.json
ERROR - 2015-01-26 21:54:16.537; org.apache.solr.cloud.Overseer$ClusterStateUpdater; Exception in Overseer main queue loop
org.apache.zookeeper.KeeperException$NoNodeException: KeeperErrorCode = NoNode &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; /collections/c1/state.json
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:111)
	at org.apache.zookeeper.KeeperException.create(KeeperException.java:51)
	at org.apache.zookeeper.ZooKeeper.create(ZooKeeper.java:783)
	at org.apache.solr.common.cloud.SolrZkClient$9.execute(SolrZkClient.java:379)
	at org.apache.solr.common.cloud.SolrZkClient$9.execute(SolrZkClient.java:376)
	at org.apache.solr.common.cloud.ZkCmdExecutor.retryOperation(ZkCmdExecutor.java:61)
	at org.apache.solr.common.cloud.SolrZkClient.create(SolrZkClient.java:376)
	at org.apache.solr.cloud.overseer.ZkStateWriter.writePendingUpdates(ZkStateWriter.java:163)
	at org.apache.solr.cloud.overseer.ZkStateWriter.enqueueUpdate(ZkStateWriter.java:91)
	at org.apache.solr.cloud.Overseer$ClusterStateUpdater.processQueueItem(Overseer.java:337)
	at org.apache.solr.cloud.Overseer$ClusterStateUpdater.run(Overseer.java:247)
	at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;and the trace from the response:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;trace&lt;span class=&quot;code-quote&quot;&gt;&quot;: &quot;&lt;/span&gt;org.apache.solr.common.SolrException\n\tat org.apache.solr.handler.admin.CollectionsHandler.handleResponse(CollectionsHandler.java:737)\n\tat org.apache.solr.handler.admin.CollectionsHandler.handleResponse(CollectionsHandler.java:693)\n\tat org.apache.solr.handler.admin.CollectionsHandler.handleCreateAction(CollectionsHandler.java:870)\n\tat org.apache.solr.handler.admin.CollectionsHandler.handleRequestBody(CollectionsHandler.java:188)\n\tat org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:144)\n\tat org.apache.solr.servlet.SolrDispatchFilter.handleAdminRequest(SolrDispatchFilter.java:736)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:261)\n\tat org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:204)\n\tat org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1652)\n\tat org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:585)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)\n\tat org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:577)\n\tat org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:223)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1125)\n\tat org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:515)\n\tat org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)\n\tat org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1059)\n\tat org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)\n\tat org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:215)\n\tat org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:110)\n\tat org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:97)\n\tat org.eclipse.jetty.server.Server.handle(Server.java:497)\n\tat org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:313)\n\tat org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:248)\n\tat org.eclipse.jetty.io.AbstractConnection$2.run(AbstractConnection.java:540)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:626)\n\tat org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:546)\n\tat java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)\n&quot;,
&lt;span class=&quot;code-quote&quot;&gt;&quot;code&quot;&lt;/span&gt;: 500
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14292589" author="anshumg" created="Mon, 26 Jan 2015 23:07:56 +0000"  >&lt;p&gt;I&apos;ve manually tested this patch using the scripts. Currently running the tests.&lt;/p&gt;

&lt;p&gt;This validates the config set (presence of one) and returns and exception if there&apos;s no config with the specified/derived name.&lt;/p&gt;</comment>
                            <comment id="14292661" author="anshumg" created="Mon, 26 Jan 2015 23:51:50 +0000"  >&lt;p&gt;I have the friendly (thanks to EZMock) OCPTest failing because of this one. Any help on this would be great. &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; ?&lt;/p&gt;</comment>
                            <comment id="14292714" author="markrmiller@gmail.com" created="Tue, 27 Jan 2015 00:27:01 +0000"  >&lt;p&gt;Patch that cleans up some formatting and files the OCP test to pass.&lt;/p&gt;</comment>
                            <comment id="14292736" author="anshumg" created="Tue, 27 Jan 2015 00:39:18 +0000"  >&lt;p&gt;Thanks Mark.&lt;/p&gt;</comment>
                            <comment id="14292849" author="jira-bot" created="Tue, 27 Jan 2015 02:10:07 +0000"  >&lt;p&gt;Commit 1654942 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anshumg&quot; class=&quot;user-hover&quot; rel=&quot;anshumg&quot;&gt;anshumg&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1654942&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1654942&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7038&quot; title=&quot;If no configset exists, CREATE leads to a 500 error with never-ending logging and 100% CPU usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7038&quot;&gt;&lt;del&gt;SOLR-7038&lt;/del&gt;&lt;/a&gt;: Validate config set presence before trying to create a collection&lt;/p&gt;</comment>
                            <comment id="14292851" author="jira-bot" created="Tue, 27 Jan 2015 02:11:43 +0000"  >&lt;p&gt;Commit 1654943 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anshumg&quot; class=&quot;user-hover&quot; rel=&quot;anshumg&quot;&gt;anshumg&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1654943&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1654943&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7038&quot; title=&quot;If no configset exists, CREATE leads to a 500 error with never-ending logging and 100% CPU usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7038&quot;&gt;&lt;del&gt;SOLR-7038&lt;/del&gt;&lt;/a&gt;: Validate config set presence before trying to create a collection (merge from trunk)&lt;/p&gt;</comment>
                            <comment id="14292852" author="jira-bot" created="Tue, 27 Jan 2015 02:13:07 +0000"  >&lt;p&gt;Commit 1654946 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anshumg&quot; class=&quot;user-hover&quot; rel=&quot;anshumg&quot;&gt;anshumg&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_5_0&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1654946&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1654946&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7038&quot; title=&quot;If no configset exists, CREATE leads to a 500 error with never-ending logging and 100% CPU usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7038&quot;&gt;&lt;del&gt;SOLR-7038&lt;/del&gt;&lt;/a&gt;: Validate config set presence before trying to create a collection (merge from branch_5x)&lt;/p&gt;</comment>
                            <comment id="14332609" author="anshumg" created="Mon, 23 Feb 2015 05:00:56 +0000"  >&lt;p&gt;Bulk close after 5.0 release.&lt;/p&gt;</comment>
                            <comment id="14339126" author="anshumg" created="Thu, 26 Feb 2015 20:41:36 +0000"  >&lt;p&gt;Reopening for backporting to 4.10.4.&lt;/p&gt;</comment>
                            <comment id="14339303" author="jira-bot" created="Thu, 26 Feb 2015 22:21:46 +0000"  >&lt;p&gt;Commit 1662589 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=anshumg&quot; class=&quot;user-hover&quot; rel=&quot;anshumg&quot;&gt;anshumg&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_4_10&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1662589&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1662589&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7038&quot; title=&quot;If no configset exists, CREATE leads to a 500 error with never-ending logging and 100% CPU usage&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7038&quot;&gt;&lt;del&gt;SOLR-7038&lt;/del&gt;&lt;/a&gt;: Validate config set presence before trying to create a collection (merge from branch_5x)&lt;/p&gt;</comment>
                            <comment id="14348900" author="mikemccand" created="Thu, 5 Mar 2015 15:36:25 +0000"  >&lt;p&gt;Bulk close for 4.10.4 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12694664" name="SOLR-7038.patch" size="3915" author="markrmiller@gmail.com" created="Tue, 27 Jan 2015 00:27:01 +0000"/>
                            <attachment id="12694644" name="SOLR-7038.patch" size="3407" author="anshum" created="Mon, 26 Jan 2015 23:07:56 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 37 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i24t73:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>