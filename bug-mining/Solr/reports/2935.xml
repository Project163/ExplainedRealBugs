<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:13:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9040] bin/solr SSL support for client-&gt;server communcation (as well as default SSL behavior in &apos;new HttpSolrClient(String)&apos;) broken on master</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9040</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Working on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9028&quot; title=&quot;fix bugs in (add sanity checks for) SSL clientAuth testing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9028&quot;&gt;&lt;del&gt;SOLR-9028&lt;/del&gt;&lt;/a&gt; lead me to realize that &lt;tt&gt;bin/solr&lt;/tt&gt; actions which require communicating with solr over HTTP are broken on master when SSL is enabled.  My testing suggests that this doesn&apos;t affect branch 6x or 6.0.&lt;/p&gt;

&lt;p&gt;(Long) detailed steps to reproduce to follow in first  comment&lt;/p&gt;

&lt;p&gt;Further investigation indicates this is a general problem with HTTP based SolrClient initialization when standard &lt;tt&gt;javax.net.ssl.*&lt;/tt&gt; sys properties are expected to be used for initializing the underlying HTTP client code.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12962427">SOLR-9040</key>
            <summary>bin/solr SSL support for client-&gt;server communcation (as well as default SSL behavior in &apos;new HttpSolrClient(String)&apos;) broken on master</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Mon, 25 Apr 2016 23:50:24 +0000</created>
                <updated>Wed, 18 May 2016 20:56:36 +0000</updated>
                            <resolved>Wed, 27 Apr 2016 22:44:06 +0000</resolved>
                                                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="15257275" author="hossman" created="Mon, 25 Apr 2016 23:52:54 +0000"  >
&lt;ol&gt;
	&lt;li&gt;Run the following commands (typing in &lt;tt&gt;secret&lt;/tt&gt; everytime you are asked for a password/pass phrase) to create the certificate files...
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;mkdir /tmp/keystore \
 &amp;amp;&amp;amp; cd /tmp/keystore \
 &amp;amp;&amp;amp; keytool -genkeypair -alias solr-ssl -keyalg RSA -keysize 2048 -keypass secret -storepass secret -validity 9999 -keystore solr-ssl.keystore.jks -ext SAN=DNS:localhost,IP:192.168.1.3,IP:127.0.0.1 -dname &quot;CN=localhost, OU=Organizational Unit, O=Organization, L=Location, ST=State, C=Country&quot; \
 &amp;amp;&amp;amp; keytool -importkeystore -srckeystore solr-ssl.keystore.jks -destkeystore solr-ssl.keystore.p12 -srcstoretype jks -deststoretype pkcs12 \
 &amp;amp;&amp;amp; openssl pkcs12 -in solr-ssl.keystore.p12 -out solr-ssl.pem \
 &amp;amp;&amp;amp; openssl pkcs12 -nokeys -in solr-ssl.keystore.p12 -out solr-ssl.cacert.pem
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;Add the following to &lt;tt&gt;solr/bin/solr.in.sh&lt;/tt&gt; ... 
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SOLR_SSL_KEY_STORE=/tmp/keystore/solr-ssl.keystore.jks
SOLR_SSL_KEY_STORE_PASSWORD=secret
SOLR_SSL_TRUST_STORE=/tmp/keystore/solr-ssl.keystore.jks
SOLR_SSL_TRUST_STORE_PASSWORD=secret
SOLR_SSL_NEED_CLIENT_AUTH=false
SOLR_SSL_WANT_CLIENT_AUTH=false
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;&lt;/li&gt;
	&lt;li&gt;Run: &lt;tt&gt;ant clean &amp;amp;&amp;amp; cd solr &amp;amp;&amp;amp; ant server&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Run: &lt;tt&gt;bin/solr -e techproducts&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Run: &lt;tt&gt;bin/solr status&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;Run: &lt;tt&gt;curl --cacert /tmp/keystore/solr-ssl.cacert.pem &lt;a href=&quot;https://localhost:8983/solr/admin/cores&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://localhost:8983/solr/admin/cores&lt;/a&gt;&lt;/tt&gt;
	&lt;ul&gt;
		&lt;li&gt;Compare output to: &lt;tt&gt;curl &lt;a href=&quot;https://localhost:8983/solr/admin/cores&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://localhost:8983/solr/admin/cores&lt;/a&gt;&lt;/tt&gt;&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;On branch_6x (or in the 6.0 release) this all works fine, and bin/solr not only starts Solr but can also create the techproduct core &amp;amp; the subsequent command to get status info works.  The &lt;tt&gt;curl&lt;/tt&gt; commands demonstrate that Solr is in fact using the specified self-signed cert, and w/o that cert clients like curl won&apos;t communicate with it.  (Likewise: if you &lt;tt&gt;rm -r /tmp/keystore&lt;/tt&gt; while solr is already running, re-run the commands to re-create the certificates, and then run &lt;tt&gt;bin/solr status&lt;/tt&gt; you&apos;ll see that with the (new) incorrect certificates &lt;tt&gt;bin/solr status&lt;/tt&gt; will return an error)&lt;/p&gt;

&lt;p&gt;On master however, things don&apos;t work.  &lt;tt&gt;bin/solr -e techproducts&lt;/tt&gt; can startup solr &amp;#8211; but it can&apos;t create the core becuase the HTTP client code it tries to use says it doesn&apos;t support https &amp;#8211; curl meanwhile still can communicate with Solr using the specified cacert, indicating that the server itself is running SSL fine, it&apos;s the lcient code that&apos;s having issues...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@tray:~/lucene/dev/solr [master] $ bin/solr -e techproducts
Creating Solr home directory /home/hossman/lucene/dev/solr/example/techproducts/solr

Starting up Solr on port 8983 using command:
bin/solr start -p 8983 -s &quot;example/techproducts/solr&quot;

Waiting up to 30 seconds to see Solr running on port 8983 [/]  
Started Solr server on port 8983 (pid=9925). Happy searching!

INFO  - 2016-04-25 16:43:29.823; org.apache.http.impl.execchain.RetryExec; I/O exception (org.apache.http.conn.UnsupportedSchemeException) caught when processing request to {s}-&amp;gt;https://localhost:8983: https protocol is not supported
INFO  - 2016-04-25 16:43:29.827; org.apache.http.impl.execchain.RetryExec; Retrying request to {s}-&amp;gt;https://localhost:8983
INFO  - 2016-04-25 16:43:29.828; org.apache.http.impl.execchain.RetryExec; I/O exception (org.apache.http.conn.UnsupportedSchemeException) caught when processing request to {s}-&amp;gt;https://localhost:8983: https protocol is not supported
...
INFO  - 2016-04-25 16:43:57.887; org.apache.http.impl.execchain.RetryExec; I/O exception (org.apache.http.conn.UnsupportedSchemeException) caught when processing request to {s}-&amp;gt;https://localhost:8983: https protocol is not supported
INFO  - 2016-04-25 16:43:57.887; org.apache.http.impl.execchain.RetryExec; Retrying request to {s}-&amp;gt;https://localhost:8983

ERROR: Did not see Solr at https://localhost:8983/solr come online within 30

hossman@tray:~/lucene/dev/solr [master] $ bin/solr status

Found 1 Solr nodes: 

Solr process 9925 running on port 8983
INFO  - 2016-04-25 16:44:33.437; org.apache.http.impl.execchain.RetryExec; I/O exception (org.apache.http.conn.UnsupportedSchemeException) caught when processing request to {s}-&amp;gt;https://localhost:8983: https protocol is not supported
INFO  - 2016-04-25 16:44:33.440; org.apache.http.impl.execchain.RetryExec; Retrying request to {s}-&amp;gt;https://localhost:8983
INFO  - 2016-04-25 16:44:33.443; org.apache.http.impl.execchain.RetryExec; I/O exception (org.apache.http.conn.UnsupportedSchemeException) caught when processing request to {s}-&amp;gt;https://localhost:8983: https protocol is not supported
INFO  - 2016-04-25 16:44:33.443; org.apache.http.impl.execchain.RetryExec; Retrying request to {s}-&amp;gt;https://localhost:8983
INFO  - 2016-04-25 16:44:33.443; org.apache.http.impl.execchain.RetryExec; I/O exception (org.apache.http.conn.UnsupportedSchemeException) caught when processing request to {s}-&amp;gt;https://localhost:8983: https protocol is not supported
INFO  - 2016-04-25 16:44:33.444; org.apache.http.impl.execchain.RetryExec; Retrying request to {s}-&amp;gt;https://localhost:8983

ERROR: Failed to get system information from https://localhost:8983/solr due to: org.apache.http.conn.UnsupportedSchemeException: https protocol is not supported

hossman@tray:~/lucene/dev/solr [master] $ curl --cacert /tmp/keystore/solr-ssl.cacert.pem https://localhost:8983/solr/admin/cores
&amp;lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&amp;gt;
&amp;lt;response&amp;gt;
&amp;lt;lst name=&quot;responseHeader&quot;&amp;gt;&amp;lt;int name=&quot;status&quot;&amp;gt;0&amp;lt;/int&amp;gt;&amp;lt;int name=&quot;QTime&quot;&amp;gt;22&amp;lt;/int&amp;gt;&amp;lt;/lst&amp;gt;&amp;lt;lst name=&quot;initFailures&quot;/&amp;gt;&amp;lt;lst name=&quot;status&quot;/&amp;gt;
&amp;lt;/response&amp;gt;

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
</comment>
                            <comment id="15257320" author="hossman" created="Tue, 26 Apr 2016 00:20:01 +0000"  >
&lt;p&gt;When comparing the differences in SolrCLI.java between branch_6x and master, GIT commit ce172acb from &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4509&quot; title=&quot;Move to non deprecated HttpClient impl classes to remove stale connection check on every request and move connection lifecycle management towards the client.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4509&quot;&gt;&lt;del&gt;SOLR-4509&lt;/del&gt;&lt;/a&gt; jumpted out at me as beingsuspiciously relevant.&lt;/p&gt;

&lt;p&gt;If you check out the commit prior to ce172acb (via &lt;tt&gt;git co ce172acb8fec6c3bbb18837a4d640da6c5aad649~1&lt;/tt&gt;) then the steps described above (to reproduce the problem) seem to work flawlessly.&lt;/p&gt;

&lt;p&gt;If you instead do &lt;tt&gt;git co ce172acb8fec6c3bbb18837a4d640da6c5aad649&lt;/tt&gt; then the steps to reproduce fail exactly as described above.&lt;/p&gt;
</comment>
                            <comment id="15257421" author="hossman" created="Tue, 26 Apr 2016 01:59:57 +0000"  >&lt;p&gt;Here&apos;s a really hacked together patch that gets things working again.&lt;/p&gt;

&lt;p&gt;The root problem is that the (default) SchemaRegistryProvider in HttpClientUtil is hardcoded to only know about http.  With the older style HttpClientConfigurer code in SolrCLI pre-&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4509&quot; title=&quot;Move to non deprecated HttpClient impl classes to remove stale connection check on every request and move connection lifecycle management towards the client.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4509&quot;&gt;&lt;del&gt;SOLR-4509&lt;/del&gt;&lt;/a&gt;, the default behavior of HttpClientUtil came from DefaultHttpClient and automatically included http &amp;amp; https protocols, using the various javax system properties (for things like keystore &amp;amp; truststore)&lt;/p&gt;

&lt;p&gt;In this patch, i eliminate the hardcoded default behavior of only supporting &quot;http&quot; in HttpClientUtil and instead changed the Registry returned by the default SchemaRegistryProvider to &quot;null&quot;, with caller coded updated to know that if/when the result is null, they should use the no-arg &lt;tt&gt;new PoolingHttpClientConnectionManager()&lt;/tt&gt; constructor, instead of &lt;tt&gt;new PoolingHttpClientConnectionManager(reg)&lt;/tt&gt; &amp;#8211; because unfortunately PoolingHttpClientConnectionManager doesn&apos;t provide public access to it&apos;s default registry.&lt;/p&gt;

&lt;p&gt;This seems to work in my manual testing - still running full test suite, but because of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9028&quot; title=&quot;fix bugs in (add sanity checks for) SSL clientAuth testing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9028&quot;&gt;&lt;del&gt;SOLR-9028&lt;/del&gt;&lt;/a&gt; I don&apos;t have a whole lot of confidence even if the tests do all pass.  i have some ideas of how to write an explicit test for this bug, but it will probably require most of the changes in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9028&quot; title=&quot;fix bugs in (add sanity checks for) SSL clientAuth testing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9028&quot;&gt;&lt;del&gt;SOLR-9028&lt;/del&gt;&lt;/a&gt; as well, so we may just want to roll these bugs together?&lt;/p&gt;

&lt;p&gt;The big question is what the final API should look like &amp;#8211; whether &lt;tt&gt;HttpClientUtil.getSchemaRegisteryProvider().getSchemaRegistry()&lt;/tt&gt; should return null when this default behavior is desired, or if &lt;tt&gt;HttpClientUtil.getSchemaRegisteryProvider()&lt;/tt&gt; should return null directly ... also: should the conditional instantiation of PoolingHttpClientConnectionManager be rolled into a public method in HttpClientUtil so it isn&apos;t duplicated in UpdateShardHandler (and any other client that wantsSchemaRegistryProvider to customize the connection manager) ... and more generally: WTF is up with the &lt;tt&gt;SchemaRegistryProvider&lt;/tt&gt; API anyway? why is it a distinct class with distinct setters in HttpClientUtil, instead of being part of SolrHttpClientBuilder ?&lt;/p&gt;

&lt;p&gt;&amp;#8212;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; - i&apos;d really appreciate your thoughts on all of this.&lt;/p&gt;</comment>
                            <comment id="15258168" author="markrmiller@gmail.com" created="Tue, 26 Apr 2016 14:28:55 +0000"  >&lt;blockquote&gt;&lt;p&gt;why is it a distinct class with distinct setters in HttpClientUtil, instead of being part of SolrHttpClientBuilder ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I probably felt that the builder for the httpclient and setting this for the pooling connection manager where somewhat distinct. I&apos;m sure you could move it to the builder. As it is, you could have some code somewhere that configures the httpclient builder and then some code that turns on SSL somewhere else, and the SSL code would not have to rebuild the same httpclient builder and add the schema registry so that it could change schema registry and not any other httpclient builder settings.&lt;/p&gt;</comment>
                            <comment id="15258650" author="hossman" created="Tue, 26 Apr 2016 18:29:55 +0000"  >
&lt;blockquote&gt;&lt;p&gt;I probably felt that the builder for the httpclient and setting this for the pooling connection manager where somewhat distinct. ..&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hmm, ok well &amp;#8211; my point is really just that it seems weird to me that there is this special SchemaRegistryProvider API that people have to write impls of just to implement one method that returns the registry &amp;#8211; and to use their SchemaRegistryProvider they have to call HttpClientUtil.setSchemeRegistryProvider &amp;#8211; but meanwhile in SolrCLI it&apos;s setup that a simple system property (&quot;solr.authentication.httpclient.builder&quot;) can be used to to override the SolrHttpClientBuilder, but nothing can be used to easily override the default SchemaRegistryProvider from the command line like that (and as is, the default SchemaRegistryProvider is ignorant of the standard javax.net.ssl.* sys props that SolrHttpClient use to pay attention to implicitly).&lt;/p&gt;

&lt;p&gt;I mean - i suppose your custom SolrHttpClientBuilder that you specify with &lt;tt&gt;-Dsolr.authentication.httpclient.builder&lt;/tt&gt; could, in it&apos;s constructor call &lt;tt&gt;HttpClientUtil.setSchemeRegistryProvider(...)&lt;/tt&gt; ... it just seems weird that &lt;tt&gt;SchemaRegistryProvider getSchemaRegisteryProvider()&lt;/tt&gt; isn&apos;t a method in the SolrHttpClientBuilder API (or that it isn&apos;t just refactored down to putting &lt;tt&gt;Registry&amp;lt;ConnectionSocketFactory&amp;gt; getSchemaRegistry()&lt;/tt&gt; directly in SolrHttpClientBuilder   (especially since &lt;tt&gt;HttpClientUtil.resetHttpClientBuilder&lt;/tt&gt; also automatically resets schemaRegistryProvider as well &amp;#8211; making them very closely bound to each other)&lt;/p&gt;

&lt;p&gt;In any case...  I&apos;ve updated the patch in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9028&quot; title=&quot;fix bugs in (add sanity checks for) SSL clientAuth testing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9028&quot;&gt;&lt;del&gt;SOLR-9028&lt;/del&gt;&lt;/a&gt; to demonstrate this bug (it already had most of the plumbing needed) and with the current &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9040&quot; title=&quot;bin/solr SSL support for client-&amp;gt;server communcation (as well as default SSL behavior in &amp;#39;new HttpSolrClient(String)&amp;#39;) broken on master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9040&quot;&gt;&lt;del&gt;SOLR-9040&lt;/del&gt;&lt;/a&gt;.patch 1/2 failures is resolved &amp;#8211; but something is still wrong with clientAuth using the system properties, so i guess maybe the no arg PoolingHttpClientConnectionManager doesn&apos;t pick up &lt;b&gt;all&lt;/b&gt; the javax.* system properties like i thought? ... i&apos;m going to try to get to the bottom of that before i worry too much about what the final HttpClientUtil API should be for dealing with the scheme registry.&lt;/p&gt;
</comment>
                            <comment id="15258774" author="markrmiller@gmail.com" created="Tue, 26 Apr 2016 19:41:26 +0000"  >&lt;p&gt;Feel free to make improvements to the APIs. It&apos;s only in trunk I mainly spent time just getting it all to work. &lt;/p&gt;</comment>
                            <comment id="15260959" author="hossman" created="Wed, 27 Apr 2016 21:15:59 +0000"  >&lt;p&gt;updating summary to note this isn&apos;t just a bin/solr problem, it affects any solrj code that expects standard &lt;tt&gt;javax.net.ssl.*&lt;/tt&gt; properties to be used when SolrClient impls take responsibility for creating HttpClient instances.&lt;/p&gt;</comment>
                            <comment id="15260967" author="hossman" created="Wed, 27 Apr 2016 21:17:52 +0000"  >
&lt;p&gt;Ok, so the underlying problem with the old patch was that PoolingHttpClientConnectionManager&apos;s default behavior is to use &lt;tt&gt;SSLConnectionSocketFactory.getSocketFactory()&lt;/tt&gt; which uses &lt;tt&gt;SSLContexts.createDefault()&lt;/tt&gt; under the hood.  &lt;tt&gt;SSLContexts.createDefault()&lt;/tt&gt; constructs an explicit SSLCOntext that ignores any system properties.&lt;/p&gt;

&lt;p&gt;Instead we want &lt;tt&gt;SSLConnectionSocketFactory.getSystemSocketFactory()&lt;/tt&gt;, which does pay attention to some sys properties directly, and usees the standard &lt;tt&gt;SSLSocketFactory.getDefault()&lt;/tt&gt; under the hood &amp;#8211; ensuring that the &lt;tt&gt;javax.net.ssl.*&lt;/tt&gt; system properties are also respected.&lt;/p&gt;

&lt;p&gt;The only problem is that the way &lt;tt&gt;SSLSocketFactory.getDefault()&lt;/tt&gt; works involves using &lt;tt&gt;SSLContext.getDefault()&lt;/tt&gt;, which loads the deafault SSLContext (and reads the system properties) only once and then treats it as a singleton &amp;#8211; making it a bit tricky to actually unit test diff sys prop options after the JVM has already started.&lt;/p&gt;

&lt;p&gt;I&apos;ll comment more on this in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9028&quot; title=&quot;fix bugs in (add sanity checks for) SSL clientAuth testing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9028&quot;&gt;&lt;del&gt;SOLR-9028&lt;/del&gt;&lt;/a&gt; where it makes more sense.&lt;/p&gt;

&lt;p&gt;in any case, here&apos;s a patch that seems to fix &lt;tt&gt;bin/solr&lt;/tt&gt; (and any &lt;tt&gt;new HttpSolrClient(String)&lt;/tt&gt; usage that expects the various SSL sys props to affect the keystore/truststore).&lt;/p&gt;

&lt;p&gt;I&apos;ve punted on the earlier questions i raised about the &lt;tt&gt;SchemaRegistryProvider&lt;/tt&gt; API &amp;#8211; I&apos;ll leave it to mark to decide if he thinks it&apos;s worth opening an issue to improve this.&lt;/p&gt;</comment>
                            <comment id="15261100" author="jira-bot" created="Wed, 27 Apr 2016 22:41:13 +0000"  >&lt;p&gt;Commit 9ab76a1e41d7019fd07b16a79a587653cf6d76a4 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman_lucene%40fucit.org&quot; class=&quot;user-hover&quot; rel=&quot;hossman_lucene@fucit.org&quot;&gt;hossman_lucene@fucit.org&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9ab76a1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9ab76a1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9040&quot; title=&quot;bin/solr SSL support for client-&amp;gt;server communcation (as well as default SSL behavior in &amp;#39;new HttpSolrClient(String)&amp;#39;) broken on master&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9040&quot;&gt;&lt;del&gt;SOLR-9040&lt;/del&gt;&lt;/a&gt; / &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4509&quot; title=&quot;Move to non deprecated HttpClient impl classes to remove stale connection check on every request and move connection lifecycle management towards the client.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4509&quot;&gt;&lt;del&gt;SOLR-4509&lt;/del&gt;&lt;/a&gt;: Fix default SchemaRegistryProvider so javax.net.ssl.* system properties are respected by default&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10032">
                    <name>Blocker</name>
                                            <outwardlinks description="blocks">
                                        <issuelink>
            <issuekey id="12961299">SOLR-9028</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12634451">SOLR-4509</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12801115" name="SOLR-9040.patch" size="3104" author="hossman" created="Wed, 27 Apr 2016 21:17:52 +0000"/>
                            <attachment id="12800692" name="SOLR-9040.patch" size="4496" author="hossman" created="Tue, 26 Apr 2016 01:59:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 29 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2wpzz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>