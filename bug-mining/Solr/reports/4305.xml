<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:40:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-13159] Autoscaling not distributing collection evenly</title>
                <link>https://issues.apache.org/jira/browse/SOLR-13159</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I recently ran into a very strange behavior described in detail in the mail linked at the bottom of this description. In short:&#160;&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Default settings didn&apos;t distribute nodes evenly on brand new 50 node cluster&lt;/li&gt;
	&lt;li&gt;Can&apos;t seem to write rules producing suggestions to distribute them evenly&#160;&lt;/li&gt;
	&lt;li&gt;Suggestions are made that then fail despite quiet cluster, no changes.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;Also of note was diagnostic output containing this seemingly impossible result with 2 cores counted and no replicas listed:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
            {
                &lt;span class=&quot;code-quote&quot;&gt;&quot;node&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;solr-2.customer.redacted.com:8983_solr&quot;&lt;/span&gt;,
                &lt;span class=&quot;code-quote&quot;&gt;&quot;isLive&quot;&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,
                &lt;span class=&quot;code-quote&quot;&gt;&quot;cores&quot;&lt;/span&gt;: 2,
                &lt;span class=&quot;code-quote&quot;&gt;&quot;freedisk&quot;&lt;/span&gt;: 140.03918838500977,
                &lt;span class=&quot;code-quote&quot;&gt;&quot;totaldisk&quot;&lt;/span&gt;: 147.5209503173828,
                &lt;span class=&quot;code-quote&quot;&gt;&quot;replicas&quot;&lt;/span&gt;: {}
            },&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;I will attach anonymized cluster status output and autoscaling.json shortly&#160;&lt;/p&gt;

&lt;p&gt;This issue may be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13142&quot; title=&quot;Create Collection will put two replicas in same node&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13142&quot;&gt;&lt;del&gt;SOLR-13142&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://mail-archives.apache.org/mod_mbox/lucene-dev/201901.mbox/%3CCAEUNc48HRZA7qo-uKtJQEtZnO9VG9OErQZGzoOmCTBe7C9zvNw%40mail.gmail.com%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://mail-archives.apache.org/mod_mbox/lucene-dev/201901.mbox/%3CCAEUNc48HRZA7qo-uKtJQEtZnO9VG9OErQZGzoOmCTBe7C9zvNw%40mail.gmail.com%3E&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13210837">SOLR-13159</key>
            <summary>Autoscaling not distributing collection evenly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ab">Andrzej Bialecki</assignee>
                                    <reporter username="gus">Gus Heck</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Jan 2019 21:11:49 +0000</created>
                <updated>Mon, 16 Sep 2019 16:51:21 +0000</updated>
                            <resolved>Mon, 16 Sep 2019 16:51:21 +0000</resolved>
                                    <version>8.0</version>
                                    <fixVersion>8.3</fixVersion>
                                    <component>AutoScaling</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="16748230" author="gus_heck" created="Mon, 21 Jan 2019 21:30:21 +0000"  >&lt;p&gt;I should note that the autoscaling.json I&apos;m attaching has been fiddled with repeatedly (using the API) trying to find settings that would get the cluster to balance out. It&apos;s not the state that was active when the cluster was created. (that would have been whatever the distribution default is).&lt;/p&gt;</comment>
                            <comment id="16754243" author="ab" created="Mon, 28 Jan 2019 18:40:22 +0000"  >&lt;p&gt;FWIW I couldn&apos;t reproduce this on a local cluster, or using a simulator. I&apos;m leaving this issue open for now, maybe more data will become available.&lt;/p&gt;</comment>
                            <comment id="16754353" author="gus_heck" created="Mon, 28 Jan 2019 21:04:04 +0000"  >&lt;p&gt;One additional bit of info that I&apos;ve begun to suspect may be relevant is that this cluster is built (and rebuilt) on spot instances. I&apos;ve begun to wonder if anywhere in auto-scaling is caching ip addresses instead of domain names (looked briefly, but didn&apos;t see it).&lt;/p&gt;</comment>
                            <comment id="16756732" author="gus_heck" created="Thu, 31 Jan 2019 00:32:15 +0000"  >&lt;p&gt;DNS resolution issues have been confirmed in this case. /etc/hosts had been manipulated but the machines were not preserving their identity across shut-down &amp;amp; startup. The fix was to set the preserve_hostname: true in /etc/cloud/cloud.cfg (AWS feature). So /etc/hosts is where the false memory of old ip addresses was. Not a fault in solr, but very confusing. Perhaps if there seems to be a relevant segment of the ref guide or wiki a caution note could be added, but only if there seems to be somewhere appropriate. &lt;/p&gt;

&lt;p&gt;One tiny tidbit left here might be to track down how the DNS issue allowed for the misaligned core count vs replica list. Sounds like we have two sources for the same info (that then disagreed when DNS was a mess).&lt;/p&gt;</comment>
                            <comment id="16757077" author="ab" created="Thu, 31 Jan 2019 09:53:36 +0000"  >&lt;p&gt;Thank you Gus for confirming this!&lt;/p&gt;

&lt;p&gt;Indeed, there should be a warning in the Ref Guide about this. I&apos;ll look into adding it.&lt;/p&gt;</comment>
                            <comment id="16757087" author="ab" created="Thu, 31 Jan 2019 10:06:25 +0000"  >&lt;p&gt;This patch adds a warning in the section &quot;How SolrCloud works&quot;.&lt;/p&gt;</comment>
                            <comment id="16930692" author="jira-bot" created="Mon, 16 Sep 2019 16:50:20 +0000"  >&lt;p&gt;Commit d3671fd0d2bfda4ded0b905be5955b5ccfafff79 in lucene-solr&apos;s branch refs/heads/branch_8x from Andrzej Bialecki&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=d3671fd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=d3671fd&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13159&quot; title=&quot;Autoscaling not distributing collection evenly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13159&quot;&gt;&lt;del&gt;SOLR-13159&lt;/del&gt;&lt;/a&gt;: Add a warning about DNS resolution in SolrCloud clusters.&lt;/p&gt;</comment>
                            <comment id="16930693" author="jira-bot" created="Mon, 16 Sep 2019 16:50:49 +0000"  >&lt;p&gt;Commit 30aad175e072ee5c8bb68d8309145819355160bb in lucene-solr&apos;s branch refs/heads/master from Andrzej Bialecki&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=30aad17&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=30aad17&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13159&quot; title=&quot;Autoscaling not distributing collection evenly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13159&quot;&gt;&lt;del&gt;SOLR-13159&lt;/del&gt;&lt;/a&gt;: Add a warning about DNS resolution in SolrCloud clusters.&lt;/p&gt;</comment>
                            <comment id="16930694" author="ab" created="Mon, 16 Sep 2019 16:51:21 +0000"  >&lt;p&gt;Added a note to the RefGuide. Thanks Gus for investigating this!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310010">
                    <name>Incorporates</name>
                                                                <inwardlinks description="is part of">
                                        <issuelink>
            <issuekey id="13215730">SOLR-13248</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12957063" name="SOLR-13159.patch" size="956" author="ab" created="Thu, 31 Jan 2019 10:05:34 +0000"/>
                            <attachment id="12955694" name="autoscaling.json" size="1795" author="gus" created="Mon, 21 Jan 2019 21:31:29 +0000"/>
                            <attachment id="12955693" name="clstat.json" size="55642" author="gus" created="Mon, 21 Jan 2019 21:24:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 9 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|yi058g:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>