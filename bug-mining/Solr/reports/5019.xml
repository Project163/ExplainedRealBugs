<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:57:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16721] Java version detection fails when `_JAVA_OPTIONS` is set</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16721</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When the environment variable &lt;tt&gt;_JAVA_OPTIONS&lt;/tt&gt; is set, &lt;tt&gt;solr&lt;/tt&gt; fails with the following error:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ solr -i
Your current version of Java is too old to run &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt; version of Solr.
We found major version , using command &lt;span class=&quot;code-quote&quot;&gt;&apos;/opt/homebrew/opt/openjdk/libexec/openjdk.jdk/Contents/Home/bin/java -version&apos;&lt;/span&gt;, with response:
Picked up _JAVA_OPTIONS: -Duser.home=/Users/brew/Library/Caches/Homebrew/java_cache -Djava.io.tmpdir=/&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;/tmp
openjdk version &lt;span class=&quot;code-quote&quot;&gt;&quot;19.0.2&quot;&lt;/span&gt; 2023-01-17
OpenJDK &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment Homebrew (build 19.0.2)
OpenJDK 64-Bit Server VM Homebrew (build 19.0.2, mixed mode, sharing)

Please install latest version of Java 11 or set JAVA_HOME properly. &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is because in the following version check logic (taken from &lt;a href=&quot;https://github.com/apache/solr/blob/a2f6565415663908163f9490856cf0fcfda88b41/solr/bin/solr#L166&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;), only first line of &lt;tt&gt;java -version&lt;/tt&gt; output is examined:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
JAVA_VER_NUM=$(echo &lt;span class=&quot;code-quote&quot;&gt;&quot;$JAVA_VER&quot;&lt;/span&gt; | head -1 | awk -F &lt;span class=&quot;code-quote&quot;&gt;&apos;&quot;&apos;&lt;/span&gt; &lt;span class=&quot;code-quote&quot;&gt;&apos;/version/ {print $2}&apos;&lt;/span&gt; | sed -e&lt;span class=&quot;code-quote&quot;&gt;&apos;s/^1\.&lt;span class=&quot;code-comment&quot;&gt;//&apos;&lt;/span&gt; | sed -e&lt;span class=&quot;code-quote&quot;&gt;&apos;s/[._-].*$//&apos;&lt;/span&gt;) &lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;But as indicated in the output above, &lt;tt&gt;java&lt;/tt&gt; outputs &quot;&lt;tt&gt;Picked up _JAVA_OPTIONS&lt;/tt&gt;&quot; on the first line instead, if &lt;tt&gt;_JAVA_OPTIONS&lt;/tt&gt; is set. So, the version on the second line is not picked up.&lt;/p&gt;

&lt;p&gt;I believe that it&apos;s &lt;a href=&quot;https://github.com/apache/solr/commit/025c0305fa829baa770f62c81654af8a708753d9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;this recent change&lt;/a&gt; (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9509&quot; title=&quot;Fix problems in shell scripts reported by &amp;quot;shellcheck&amp;quot;&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9509&quot;&gt;&lt;del&gt;SOLR-9509&lt;/del&gt;&lt;/a&gt;), which added a pair of quotes around &lt;tt&gt;$JAVA_VER&lt;/tt&gt;, that introduced this regression. This used to work in an unintended way, because Bash treated the unquoted &lt;tt&gt;$JAVA_VER&lt;/tt&gt; variable as an array of separate arguments and output that in a single line. But after introducing the double quotes, the newlines in &lt;tt&gt;$JAVA_VER&lt;/tt&gt; are now preserved.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
$ JAVA_VER=&lt;span class=&quot;code-quote&quot;&gt;&quot;$(java -version 2&amp;gt;&amp;amp;1)&quot;&lt;/span&gt;
$ echo $JAVA_VER
Picked up _JAVA_OPTIONS: -Duser.home=/Users/ruoyu/Library/Caches/Homebrew/java_cache -Djava.io.tmpdir=/&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;/tmp openjdk version &lt;span class=&quot;code-quote&quot;&gt;&quot;19.0.2&quot;&lt;/span&gt; 2023-01-17 OpenJDK &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment Homebrew (build 19.0.2) OpenJDK 64-Bit Server VM Homebrew (build 19.0.2, mixed mode, sharing)
$ echo &lt;span class=&quot;code-quote&quot;&gt;&quot;$JAVA_VER&quot;&lt;/span&gt;
Picked up _JAVA_OPTIONS: -Duser.home=/Users/ruoyu/Library/Caches/Homebrew/java_cache -Djava.io.tmpdir=/&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt;/tmp
openjdk version &lt;span class=&quot;code-quote&quot;&gt;&quot;19.0.2&quot;&lt;/span&gt; 2023-01-17
OpenJDK &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment Homebrew (build 19.0.2)
OpenJDK 64-Bit Server VM Homebrew (build 19.0.2, mixed mode, sharing) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment>&lt;p&gt;JDK version:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
openjdk version &lt;span class=&quot;code-quote&quot;&gt;&quot;19.0.2&quot;&lt;/span&gt; 2023-01-17
OpenJDK &lt;span class=&quot;code-object&quot;&gt;Runtime&lt;/span&gt; Environment Homebrew (build 19.0.2)
OpenJDK 64-Bit Server VM Homebrew (build 19.0.2, mixed mode, sharing) &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;OS version: macOS 11, 12, 13 (x86_64 and arm64); Ubuntu 22.04 (x86_64)&lt;/p&gt;</environment>
        <key id="13530297">SOLR-16721</key>
            <summary>Java version detection fails when `_JAVA_OPTIONS` is set</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="janhoy">Jan H&#248;ydahl</assignee>
                                    <reporter username="zhongruoyu">Ruoyu Zhong</reporter>
                        <labels>
                    </labels>
                <created>Mon, 27 Mar 2023 22:58:16 +0000</created>
                <updated>Mon, 1 May 2023 15:27:40 +0000</updated>
                            <resolved>Fri, 31 Mar 2023 20:50:29 +0000</resolved>
                                    <version>9.2</version>
                                    <fixVersion>9.3</fixVersion>
                    <fixVersion>9.2.1</fixVersion>
                                    <component>SolrCLI</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="7200">2h</timespent>
                                <comments>
                            <comment id="17706133" author="janhoy" created="Tue, 28 Mar 2023 19:58:28 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=zhongruoyu&quot; class=&quot;user-hover&quot; rel=&quot;zhongruoyu&quot;&gt;zhongruoyu&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I reproduced the issue by setting the _JAVA_OPTIONS var, and just removing the head pipe fixed it, at least for openjdk temurin. Hopefully other java flavours will also behave the same. Do you want to test with this patch?&#160;&lt;/p&gt;</comment>
                            <comment id="17706297" author="JIRAUSER299560" created="Wed, 29 Mar 2023 09:34:08 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=janhoy&quot; class=&quot;user-hover&quot; rel=&quot;janhoy&quot;&gt;janhoy&lt;/a&gt;! I can confirm that this patch works: &lt;a href=&quot;https://github.com/Homebrew/homebrew-core/pull/126571&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/Homebrew/homebrew-core/pull/126571&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17707420" author="jira-bot" created="Fri, 31 Mar 2023 20:50:18 +0000"  >&lt;p&gt;Commit f7fe594cdadeadd1e0061075a55a529793e72462 in solr&apos;s branch refs/heads/main from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=f7fe594cdad&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=f7fe594cdad&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16721&quot; title=&quot;Java version detection fails when `_JAVA_OPTIONS` is set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16721&quot;&gt;&lt;del&gt;SOLR-16721&lt;/del&gt;&lt;/a&gt; Java version detection fails when `_JAVA_OPTIONS` is set (#1502)&lt;/p&gt;
</comment>
                            <comment id="17707422" author="jira-bot" created="Fri, 31 Mar 2023 20:51:53 +0000"  >&lt;p&gt;Commit efab25bd4c94a08b83f74bb2a55711f81100835f in solr&apos;s branch refs/heads/branch_9x from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=efab25bd4c9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=efab25bd4c9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16721&quot; title=&quot;Java version detection fails when `_JAVA_OPTIONS` is set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16721&quot;&gt;&lt;del&gt;SOLR-16721&lt;/del&gt;&lt;/a&gt; Java version detection fails when `_JAVA_OPTIONS` is set (#1502)&lt;/p&gt;
</comment>
                            <comment id="17710217" author="jira-bot" created="Mon, 10 Apr 2023 16:32:26 +0000"  >&lt;p&gt;Commit 7e61b558a3c60cb46b3f01c6ca80200bf8848421 in solr&apos;s branch refs/heads/branch_9_2 from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=7e61b558a3c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=7e61b558a3c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16721&quot; title=&quot;Java version detection fails when `_JAVA_OPTIONS` is set&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16721&quot;&gt;&lt;del&gt;SOLR-16721&lt;/del&gt;&lt;/a&gt; Java version detection fails when `_JAVA_OPTIONS` is set (#1502)&lt;/p&gt;

&lt;p&gt;Signed-off-by: Jan H&#248;ydahl &amp;lt;janhoy@users.noreply.github.com&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17718240" author="jsweeney" created="Mon, 1 May 2023 15:26:03 +0000"  >&lt;p&gt;Closing after the 9.2.1 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 28 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1gw0w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>