<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:49:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16019] UTF-8 parsing errors for parameters should cause a HTTP 400 status code, not 500</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16019</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When I make a request to an URI like &lt;tt&gt;/solr/my_core/query?q=%C0&lt;/tt&gt;, I get a HTTP 500 status code with a stack trace originating at&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;org.apache.solr.common.SolrException: URLDecoder: Invalid character encoding detected after position 2 of query string / form data (while parsing as UTF-8)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;at org.apache.solr.servlet.SolrRequestParsers.decodeChars(SolrRequestParsers.java:421)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#8230;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;The obvious reason is that the &lt;tt&gt;q&lt;/tt&gt; parameter value looks like the first byte in a multibyte utf-8 sequence, but that sequence is incomplete/invalid. &lt;del&gt;I have seen a few more instances of this in our monitoring, also with different places where the problem surfaces.&lt;/del&gt; &lt;span class=&quot;error&quot;&gt;&amp;#91;Other issues unrelated, will file separate issues.&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;Instead of the HTTP 500 status code, something like e. g. HTTP 400 (Bad Request) would be more appropriate. It would also make processing in downstream systems (that have to deal with Solr&#8217;s response) much easier if this class of errors could be recognized.&lt;/p&gt;

&lt;p&gt;Also, if I look at the place where the exception is being thrown (&lt;a href=&quot;https://github.com/apache/solr/blob/releases/lucene-solr/7.7.3/solr/core/src/java/org/apache/solr/servlet/SolrRequestParsers.java#L419-L422&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/blob/releases/lucene-solr/7.7.3/solr/core/src/java/org/apache/solr/servlet/SolrRequestParsers.java#L419-L422&lt;/a&gt;), care was taken to use the `ErrorCode.BAD_REQUEST` status. This information, however, seems to be lost along the way.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13429225">SOLR-16019</key>
            <summary>UTF-8 parsing errors for parameters should cause a HTTP 400 status code, not 500</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="janhoy">Jan H&#248;ydahl</assignee>
                                    <reporter username="mpdude">Matthias Pigulla</reporter>
                        <labels>
                    </labels>
                <created>Thu, 17 Feb 2022 22:33:05 +0000</created>
                <updated>Wed, 18 May 2022 11:24:08 +0000</updated>
                            <resolved>Mon, 21 Feb 2022 12:49:58 +0000</resolved>
                                                    <fixVersion>9.0</fixVersion>
                    <fixVersion>8.11.2</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="14400">4h</timespent>
                                <comments>
                            <comment id="17494277" author="mpdude" created="Thu, 17 Feb 2022 22:34:40 +0000"  >&lt;p&gt;Draft PR by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=janhoy&quot; class=&quot;user-hover&quot; rel=&quot;janhoy&quot;&gt;janhoy&lt;/a&gt; at &lt;a href=&quot;https://github.com/apache/solr/pull/648&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/pull/648&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17495500" author="jira-bot" created="Mon, 21 Feb 2022 12:27:22 +0000"  >&lt;p&gt;Commit cb49a7d855e222dfebe373a0c0dfa7c95989ea8e in solr&apos;s branch refs/heads/main from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=cb49a7d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=cb49a7d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16019&quot; title=&quot;UTF-8 parsing errors for parameters should cause a HTTP 400 status code, not 500&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16019&quot;&gt;&lt;del&gt;SOLR-16019&lt;/del&gt;&lt;/a&gt; Query parsing exception return HTTP 400 instead of 500 (#648)&lt;/p&gt;
</comment>
                            <comment id="17495505" author="jira-bot" created="Mon, 21 Feb 2022 12:41:49 +0000"  >&lt;p&gt;Commit 9f5379dc861c3fffbf1532d563ae01a0945a96d0 in solr&apos;s branch refs/heads/branch_9x from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=9f5379d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=9f5379d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16019&quot; title=&quot;UTF-8 parsing errors for parameters should cause a HTTP 400 status code, not 500&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16019&quot;&gt;&lt;del&gt;SOLR-16019&lt;/del&gt;&lt;/a&gt; Query parsing exception return HTTP 400 instead of 500 (#648)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit cb49a7d855e222dfebe373a0c0dfa7c95989ea8e)&lt;/p&gt;</comment>
                            <comment id="17495507" author="jira-bot" created="Mon, 21 Feb 2022 12:49:22 +0000"  >&lt;p&gt;Commit 04530868534d2da8431522a9b85d496eda64ae0c in solr&apos;s branch refs/heads/branch_9_0 from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=0453086&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=0453086&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16019&quot; title=&quot;UTF-8 parsing errors for parameters should cause a HTTP 400 status code, not 500&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16019&quot;&gt;&lt;del&gt;SOLR-16019&lt;/del&gt;&lt;/a&gt; Query parsing exception return HTTP 400 instead of 500 (#648)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit cb49a7d855e222dfebe373a0c0dfa7c95989ea8e)&lt;/p&gt;</comment>
                            <comment id="17495582" author="jira-bot" created="Mon, 21 Feb 2022 15:27:17 +0000"  >&lt;p&gt;Commit 2e3ae7a138e3683447517e4860d668c633ea9fc5 in solr&apos;s branch refs/heads/main from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=2e3ae7a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=2e3ae7a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16019&quot; title=&quot;UTF-8 parsing errors for parameters should cause a HTTP 400 status code, not 500&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16019&quot;&gt;&lt;del&gt;SOLR-16019&lt;/del&gt;&lt;/a&gt; Supress SSL for test, fix V2ApiIntegrationTest test failure (#676)&lt;/p&gt;
</comment>
                            <comment id="17495588" author="jira-bot" created="Mon, 21 Feb 2022 15:35:09 +0000"  >&lt;p&gt;Commit 361329028691de499ee0d8cd96f426cb80d8517e in solr&apos;s branch refs/heads/branch_9x from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=3613290&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=3613290&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16019&quot; title=&quot;UTF-8 parsing errors for parameters should cause a HTTP 400 status code, not 500&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16019&quot;&gt;&lt;del&gt;SOLR-16019&lt;/del&gt;&lt;/a&gt; Supress SSL for test, fix V2ApiIntegrationTest test failure (#676)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 2e3ae7a138e3683447517e4860d668c633ea9fc5)&lt;/p&gt;</comment>
                            <comment id="17495593" author="jira-bot" created="Mon, 21 Feb 2022 15:42:29 +0000"  >&lt;p&gt;Commit cdfa66191befb8456a77bc21717d986b0cad94a7 in solr&apos;s branch refs/heads/branch_9_0 from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=cdfa661&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=cdfa661&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16019&quot; title=&quot;UTF-8 parsing errors for parameters should cause a HTTP 400 status code, not 500&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16019&quot;&gt;&lt;del&gt;SOLR-16019&lt;/del&gt;&lt;/a&gt; Supress SSL for test, fix V2ApiIntegrationTest test failure (#676)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 2e3ae7a138e3683447517e4860d668c633ea9fc5)&lt;/p&gt;</comment>
                            <comment id="17535185" author="janhoy" created="Thu, 12 May 2022 00:26:02 +0000"  >&lt;p&gt;Closing after the 9.0.0 release&lt;/p&gt;</comment>
                            <comment id="17538275" author="mdrob" created="Tue, 17 May 2022 15:14:01 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=janhoy&quot; class=&quot;user-hover&quot; rel=&quot;janhoy&quot;&gt;janhoy&lt;/a&gt; - do you still intend to backport this to 8.11? &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/2642&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/2642&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17538741" author="janhoy" created="Wed, 18 May 2022 11:03:23 +0000"  >&lt;p&gt;Thanks, I&apos;ll complete the backport&lt;/p&gt;</comment>
                            <comment id="17538756" author="jira-bot" created="Wed, 18 May 2022 11:24:06 +0000"  >&lt;p&gt;Commit fda43baea953727b3b813b81a6a8da518ec4fdff in lucene-solr&apos;s branch refs/heads/branch_8_11 from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=fda43baea95&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=fda43baea95&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16019&quot; title=&quot;UTF-8 parsing errors for parameters should cause a HTTP 400 status code, not 500&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16019&quot;&gt;&lt;del&gt;SOLR-16019&lt;/del&gt;&lt;/a&gt; Query parsing exception return HTTP 400 instead of 500 (#2642)&lt;/p&gt;

&lt;p&gt;Back-port from &lt;a href=&quot;https://github.com/apache/solr/commit/cb49a7d855e222dfebe373a0c0dfa7c95989ea8e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/commit/cb49a7d855e222dfebe373a0c0dfa7c95989ea8e&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 25 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0zpcw:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>