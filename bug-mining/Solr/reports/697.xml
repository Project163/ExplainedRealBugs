<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:23:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2657] All fields returned if only psuedo fields are requested</title>
                <link>https://issues.apache.org/jira/browse/SOLR-2657</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Koji mentioned this in a comment in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1298&quot; title=&quot;FunctionQuery results as pseudo-fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-1298&quot;&gt;&lt;del&gt;SOLR-1298&lt;/del&gt;&lt;/a&gt;...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;&lt;tt&gt;fl=&lt;/tt&gt; .. returns all stored fields (expected, backcompat)&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;fl=*&lt;/tt&gt; .. returns all stored fields (expected, backcompat)&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;fl=score,*&lt;/tt&gt; .. returns the score psuedo field and all stored fields (expected, backcompat)&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;fl=score&lt;/tt&gt; .. returns the score psuedo field and all stored fields (expected, backcompat)&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;fl=score,price&lt;/tt&gt; .. returns the score psuedo field and the stored price field (expected, backcompat)&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;fl=log(price)&lt;/tt&gt; .. returns the log(price) psuedo field (expected)&lt;/li&gt;
	&lt;li&gt;&lt;tt&gt;fl=score,log(price)&lt;/tt&gt; .. returns the score and log(price) psuedo fields as well as &lt;b&gt;all&lt;/b&gt; of the stored fields (&lt;b&gt;NOT EXPECTED&lt;/b&gt;)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The problem seems to be that when the entire fl is made up of psuedo fields, and one of them is score, the legacy behavior for an fl of only score is used (instead of recognizing that other &quot;fields&quot; were requested, so we should not output all stored fields&lt;/p&gt;</description>
                <environment></environment>
        <key id="12514299">SOLR-2657</key>
            <summary>All fields returned if only psuedo fields are requested</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ryantxu">Ryan McKinley</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Fri, 15 Jul 2011 23:29:50 +0000</created>
                <updated>Fri, 10 May 2013 10:39:33 +0000</updated>
                            <resolved>Mon, 15 Aug 2011 00:52:07 +0000</resolved>
                                    <version>4.0-ALPHA</version>
                                    <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13081987" author="hossman" created="Tue, 9 Aug 2011 23:01:03 +0000"  >&lt;p&gt;Patch with test demonstrating the problem&lt;/p&gt;</comment>
                            <comment id="13082018" author="hossman" created="Wed, 10 Aug 2011 00:20:51 +0000"  >&lt;p&gt;Updated tests showing that the problem affects both functions and globs when used with &quot;score&quot; w/o real fields &amp;#8211; but not transformers.&lt;/p&gt;

&lt;p&gt;I think the crux of the problem is this logic in ReturnFields...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-comment&quot;&gt;// Legacy behavior? &lt;span class=&quot;code-quote&quot;&gt;&quot;score&quot;&lt;/span&gt; == &lt;span class=&quot;code-quote&quot;&gt;&quot;*,score&quot;&lt;/span&gt;  Distributed tests &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;
&lt;/span&gt;&lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( fields.size() == 1 &amp;amp;&amp;amp; _wantsScore ) {
  _wantsAllFields = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...that situation isn&apos;t the only one where that if will evaluated to &quot;true&quot;, because the code paths for globs and functions don&apos;t modify the &quot;fields&quot; list at all.&lt;/p&gt;

&lt;p&gt;I&apos;m not really sure if this is a symptom of a larger problem or not &amp;#8211; the class maintains both a &quot;Set&amp;lt;String&amp;gt; fields&quot; and a &quot;Set&amp;lt;String&amp;gt; okFieldNames&quot; &lt;br/&gt;
I haven&apos;t yet fully grasped why we have both, and what they are used for but I do know that some code paths add to both, and other code paths only add to one or the other &amp;#8211; &quot;addField&quot; adds to both, so code paths that use it (like in the transfomer case) work fine.&lt;/p&gt;
</comment>
                            <comment id="13084918" author="ryantxu" created="Mon, 15 Aug 2011 00:17:36 +0000"  >&lt;p&gt;Thanks for looking into this hoss.  Yes, i the crux of this is the support for: score==*,score&lt;/p&gt;

&lt;p&gt;I can get your tests to pass with:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( fields.size() == 1 &amp;amp;&amp;amp; _wantsScore &amp;amp;&amp;amp; augmenters.size() == 1 &amp;amp;&amp;amp; globs.isEmpty() ) {
      _wantsAllFields = &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;but i think the better solution is to not deprecate score==*,score&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;- - - -&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;re okFieldNames vs fields.  The differece is that fields are the lucene field names that get returned from the SolrIndexSearcher &amp;#8211; okFieldNames is the set of things that the ResponseWriters check before returning a field.&lt;/p&gt;

&lt;p&gt;I&apos;ll go ahead and commit this, and we can discuss deprecating the score syntax in a new issue.&lt;/p&gt;

&lt;p&gt;I&apos;ll also take a quick pass at adding comments and cleaning things up a bit in ReturnFields.&lt;/p&gt;



</comment>
                            <comment id="13084926" author="ryantxu" created="Mon, 15 Aug 2011 00:52:07 +0000"  >&lt;p&gt;Added in rev 1157687&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1157687&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1157687&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;See &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2712&quot; title=&quot;Deprecate fl=score behavior.  &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2712&quot;&gt;&lt;del&gt;SOLR-2712&lt;/del&gt;&lt;/a&gt; about removing this behavior&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12518842">SOLR-2712</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12489919" name="SOLR-2657-test.patch" size="16418" author="hossman" created="Wed, 10 Aug 2011 00:20:51 +0000"/>
                            <attachment id="12489909" name="SOLR-2657-test.patch" size="6788" author="hossman" created="Tue, 9 Aug 2011 23:01:03 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4893</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 15 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03jfz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18583</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>