<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:25:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-10826] CloudSolrClient using unsplit collection list when expanding aliases</title>
                <link>https://issues.apache.org/jira/browse/SOLR-10826</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Some recent refactoring seems to have introduced a bug in SolrJ&apos;s CloudSolrClient, when it&apos;s expanding a collection list and resolving aliases, it&apos;s using the wrong local variable for the alias lookup. This leads to an exception because the value is not an alias.&lt;/p&gt;

&lt;p&gt;E.g. suppose you made a request with &lt;tt&gt;&amp;amp;collection=x,y&lt;/tt&gt; where either or both of &lt;tt&gt;x&lt;/tt&gt; and &lt;tt&gt;y&lt;/tt&gt; are not real collection names but valid aliases. This will fail, incorrectly, because the lookup is using &lt;tt&gt;x,y&lt;/tt&gt; as a potential alias name lookup.&lt;/p&gt;

&lt;p&gt;Patch to fix this attached, which was tested locally and fixed the issue.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13077685">SOLR-10826</key>
            <summary>CloudSolrClient using unsplit collection list when expanding aliases</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="varun">Varun Thacker</assignee>
                                    <reporter username="TimOwen">Tim Owen</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Jun 2017 14:16:34 +0000</created>
                <updated>Thu, 21 Nov 2019 00:42:01 +0000</updated>
                            <resolved>Thu, 6 Jul 2017 20:33:04 +0000</resolved>
                                    <version>6.4</version>
                    <version>6.5.1</version>
                    <version>6.6</version>
                                    <fixVersion>7.0</fixVersion>
                                    <component>SolrJ</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16061074" author="varunthacker" created="Fri, 23 Jun 2017 14:57:33 +0000"  >&lt;p&gt;Hi Tim,&lt;/p&gt;

&lt;p&gt;good catch! seems like a bug introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9784&quot; title=&quot;Refactor CloudSolrClient to eliminate direct dependency on ZK&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9784&quot;&gt;&lt;del&gt;SOLR-9784&lt;/del&gt;&lt;/a&gt; . &lt;/p&gt;

&lt;p&gt;I think we should add a test case for this as well? We could write some additional tests in AliasIntegrationTest ?&lt;/p&gt;</comment>
                            <comment id="16061084" author="timowen" created="Fri, 23 Jun 2017 15:05:29 +0000"  >&lt;p&gt;Hi Varun, yes good point I will add some more tests for this code, next week.&lt;/p&gt;

&lt;p&gt;Do you think it doesn&apos;t affect the master branch, as you&apos;ve removed that from the Affects field? The code is the same in master too, still.&lt;/p&gt;</comment>
                            <comment id="16061111" author="varunthacker" created="Fri, 23 Jun 2017 15:21:39 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do you think it doesn&apos;t affect the master branch, as you&apos;ve removed that from the Affects field?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I try not to put master(7.0) there as it&apos;s not released yet. It makes it easier for someone looking at the Jira to know which versions of Solr that have been shipped that has this bug.&lt;/p&gt;

&lt;p&gt;The Fix Version/s should have master&lt;/p&gt;

&lt;p&gt;Atleast that&apos;s my reasoning &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16066740" author="timowen" created="Wed, 28 Jun 2017 15:46:20 +0000"  >&lt;p&gt;Updated patch with some extra assertions. Without the code fix, those extra lines fail the test as expected, but pass with the fix.&lt;/p&gt;

&lt;p&gt;I had a look at the AliasIntegrationTest but it essential does the same kind of thing the CloudSolrClientTest is doing.&lt;/p&gt;</comment>
                            <comment id="16066772" author="varunthacker" created="Wed, 28 Jun 2017 16:00:15 +0000"  >&lt;p&gt;Hi Tim,&lt;/p&gt;

&lt;p&gt;Patch looks good to me and &lt;tt&gt;CloudSolrClient#testAliasHandling&lt;/tt&gt; seems like a good place for the test.&lt;/p&gt;



&lt;blockquote&gt;&lt;p&gt;E.g. suppose you made a request with &amp;amp;collection=x,y where either or both of x and y are not real collection names but valid aliases.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Can we add another collection ( the test case already creates a 3 node cluster so creating another collection and indexing a couple of docs should be cheap ) and test this specific thing as well. Should be a few more asserts.&lt;/p&gt;

&lt;p&gt;What do you think? I&apos;d be more happy to have that test and get it committed soon&lt;/p&gt;</comment>
                            <comment id="16068446" author="timowen" created="Thu, 29 Jun 2017 15:03:04 +0000"  >&lt;p&gt;OK I&apos;ve expanded the test a bit, it now creates a second collection, and alias for it, and a combined alias spanning both. Then it tests the various combinations of &lt;tt&gt;collection=...&lt;/tt&gt; values work as expected. Again, these tests do fail without the code fix.&lt;/p&gt;</comment>
                            <comment id="16077159" author="jira-bot" created="Thu, 6 Jul 2017 20:30:35 +0000"  >&lt;p&gt;Commit 74b609cf884d8a545b90d2e0293182a86e5b778d in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=74b609c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=74b609c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10826&quot; title=&quot;CloudSolrClient using unsplit collection list when expanding aliases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10826&quot;&gt;&lt;del&gt;SOLR-10826&lt;/del&gt;&lt;/a&gt;: Fix CloudSolrClient to expand the collection parameter correctly&lt;/p&gt;</comment>
                            <comment id="16077161" author="jira-bot" created="Thu, 6 Jul 2017 20:31:32 +0000"  >&lt;p&gt;Commit b0f7087f8443f3ce588e31fbeb5fcdd2a803daec in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b0f7087&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=b0f7087&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10826&quot; title=&quot;CloudSolrClient using unsplit collection list when expanding aliases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10826&quot;&gt;&lt;del&gt;SOLR-10826&lt;/del&gt;&lt;/a&gt;: Fix CloudSolrClient to expand the collection parameter correctly&lt;/p&gt;</comment>
                            <comment id="16077162" author="jira-bot" created="Thu, 6 Jul 2017 20:32:10 +0000"  >&lt;p&gt;Commit c976664916d74f838349f93a9411cf9ad6a9e47a in lucene-solr&apos;s branch refs/heads/branch_7_0 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c976664&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c976664&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10826&quot; title=&quot;CloudSolrClient using unsplit collection list when expanding aliases&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10826&quot;&gt;&lt;del&gt;SOLR-10826&lt;/del&gt;&lt;/a&gt;: Fix CloudSolrClient to expand the collection parameter correctly&lt;/p&gt;</comment>
                            <comment id="16077164" author="varunthacker" created="Thu, 6 Jul 2017 20:33:04 +0000"  >&lt;p&gt;Thanks Tim !&lt;/p&gt;</comment>
                            <comment id="16168150" author="timowen" created="Fri, 15 Sep 2017 16:37:45 +0000"  >&lt;p&gt;Hi - can this be backported to the 6.x branch? We&apos;re using it built locally on top of 6.6 in the meantime. I thought it might be included in 6.6.1 but didn&apos;t notice it.&lt;/p&gt;</comment>
                            <comment id="16168383" author="varunthacker" created="Fri, 15 Sep 2017 19:16:56 +0000"  >&lt;p&gt;Hi Tim,&lt;/p&gt;

&lt;p&gt;Looks like we didn&apos;t end up backporting this to 6.6.1 &lt;/p&gt;

&lt;p&gt;I could backport it to the branch but I haven&apos;t seen anyone raising a request for a 6.6.2 &lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12875063" name="SOLR-10826.patch" size="4536" author="TimOwen" created="Thu, 29 Jun 2017 15:01:20 +0000"/>
                            <attachment id="12874903" name="SOLR-10826.patch" size="1910" author="TimOwen" created="Wed, 28 Jun 2017 15:44:07 +0000"/>
                            <attachment id="12871607" name="SOLR-10826.patch" size="850" author="TimOwen" created="Tue, 6 Jun 2017 14:17:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 9 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3fxhr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>