<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:23:37 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2780] Facet count problem : Multi-Select Faceting After grouping results </title>
                <link>https://issues.apache.org/jira/browse/SOLR-2780</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Dear All ,&lt;br/&gt;
Kindly note that I am using Solr 4.0 and Kindly note that group.truncate=true calculates facet counts that based on the most relevant document of each group matching the query.&lt;/p&gt;

&lt;p&gt;But when I used Multi-Select Faceting &lt;span class=&quot;error&quot;&gt;&amp;#91;Tagging and excluding Filters&amp;#93;&lt;/span&gt; , the solr can&apos;t calculate the facet after grouping the results and select multi facet.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://127.0.0.1:8983/solr/select/?facet=true&amp;amp;sort=score+desc,+rate+desc,total_of_reviews+desc&amp;amp;facet.limit=-1&amp;amp;bf=sum%28product%28atan%28total_of_reviews%29,50%29,product%28rate,10%29%29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://127.0.0.1:8983/solr/select/?facet=true&amp;amp;sort=score+desc,+rate+desc,total_of_reviews+desc&amp;amp;facet.limit=-1&amp;amp;bf=sum%28product%28atan%28total_of_reviews%29,50%29,product%28rate,10%29%29&lt;/a&gt;^4&amp;amp;group.field=place_id&amp;amp;facet.field=&lt;/p&gt;
{!ex%3Dce}cat_en&amp;amp;facet.field={!ex%3Dce}
&lt;p&gt;cat_ar&amp;amp;facet.field=&lt;/p&gt;
{!ex%3Dir}iregion&amp;amp;facet.field={!ex%3Dir}
&lt;p&gt;region_en&amp;amp;facet.field=&lt;/p&gt;
{!ex%3Dir}
&lt;p&gt;region_ar&amp;amp;facet.field=&lt;/p&gt;
{!ex%3Drr}
&lt;p&gt;rrate&amp;amp;facet.field=place_status&amp;amp;facet.field=theme_en&amp;amp;facet.field=icity&amp;amp;facet.field=&lt;/p&gt;
{!ex%3Dce}
&lt;p&gt;icat&amp;amp;facet.field=&lt;/p&gt;
{!ex%3Dsce}isubcat&amp;amp;facet.field={!ex%3Dsce}
&lt;p&gt;subcat_en&amp;amp;facet.field=&lt;/p&gt;
{!ex%3Dsce}
&lt;p&gt;subcat_ar&amp;amp;qt=/spell&amp;amp;fq=place_status:1&amp;amp;fq=icity:1&amp;amp;fq=cat_en:%28%22Restaurants%22%29&amp;amp;group.format=simple&amp;amp;group.ngroups=true&amp;amp;facet.mincount=1&amp;amp;qf=title_ar^24+title_en^24+cat_ar^10+cat_en^10++review^20&amp;amp;hl.fl=review&amp;amp;json.nl=map&amp;amp;wt=json&amp;amp;defType=edismax&amp;amp;rows=10&amp;amp;spellcheck.accuracy=0.6&amp;amp;start=0&amp;amp;q=smart&amp;amp;group.truncate=true&amp;amp;group=true&amp;amp;indent=on &lt;/p&gt;</description>
                <environment></environment>
        <key id="12523481">SOLR-2780</key>
            <summary>Facet count problem : Multi-Select Faceting After grouping results </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="ramzialqrainy">Ramzi Alqrainy</reporter>
                        <labels>
                    </labels>
                <created>Sun, 18 Sep 2011 15:24:04 +0000</created>
                <updated>Sun, 27 Nov 2011 12:36:08 +0000</updated>
                            <resolved>Thu, 22 Sep 2011 11:38:39 +0000</resolved>
                                    <version>3.3</version>
                    <version>3.4</version>
                    <version>4.0-ALPHA</version>
                                    <fixVersion>3.5</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13107461" author="ramzialqrainy" created="Sun, 18 Sep 2011 15:26:16 +0000"  >&lt;p&gt;&lt;a href=&quot;http://lucene.472066.n3.nabble.com/Facet-count-problem-Multi-Select-Faceting-After-grouping-results-tc3346267.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://lucene.472066.n3.nabble.com/Facet-count-problem-Multi-Select-Faceting-After-grouping-results-tc3346267.html&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13107471" author="martijn.v.groningen" created="Sun, 18 Sep 2011 17:05:43 +0000"  >&lt;p&gt;When excluding facets the search is re-executed (inside SimpleFacets) during the facet phase to get a DocSet for the search without some excluding filters. The problem is that for that search the group.truncate parameter isn&apos;t checked. This doesn&apos;t happen for normal facets, since the search isn&apos;t re-executed.&lt;/p&gt;

&lt;p&gt;I think to fix this, the SimpleFacets should re-execute the search with a AllGroupHeadsCollector when group.truncate=true at line 167.&lt;/p&gt;</comment>
                            <comment id="13107475" author="martijn.v.groningen" created="Sun, 18 Sep 2011 17:14:50 +0000"  >&lt;p&gt;Attached a patch that should fix this issue with the proposed solution. &lt;/p&gt;

&lt;p&gt;BTW only supports this when grouping by field . See todo in patch.&lt;/p&gt;</comment>
                            <comment id="13109545" author="ramzialqrainy" created="Wed, 21 Sep 2011 14:54:44 +0000"  >&lt;p&gt;Hi Groningen,&lt;br/&gt;
I have used your patch and I made FunctionAllGroupHeadsCollector public and when I execute this command &lt;br/&gt;
ant dist to build , the below errors are displayed&lt;/p&gt;

&lt;p&gt;  &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; 77 errors&lt;br/&gt;
  &lt;span class=&quot;error&quot;&gt;&amp;#91;javac&amp;#93;&lt;/span&gt; 100 warnings&lt;/p&gt;

&lt;p&gt;Please advise &lt;br/&gt;
Kindly note that I am using fedora 15 and solr 4.0 that released 13-09&lt;/p&gt;</comment>
                            <comment id="13109826" author="martijn.v.groningen" created="Wed, 21 Sep 2011 19:56:30 +0000"  >&lt;p&gt;Hi Ramzi, So you have 77 errors &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; Can you send me what errors you have? &lt;/p&gt;

&lt;p&gt;BTW if you just want to use the patch you can just apply it and build Solr (ant clean dist). The patch should work when using group.field parameter.&lt;/p&gt;</comment>
                            <comment id="13112160" author="martijn.v.groningen" created="Wed, 21 Sep 2011 22:10:04 +0000"  >&lt;p&gt;Updated patch. Both support multi select facets with group.truncate=true for group.field and group.func. Also added test cases for this issue in the grouping tests.&lt;/p&gt;</comment>
                            <comment id="13112379" author="ramzi alqrainy" created="Thu, 22 Sep 2011 07:18:20 +0000"  >&lt;p&gt;Hi Martjin,&lt;br/&gt;
Kindly note that I have used #1626 (20-Sep-2011) instead of #1622 (13-Sep-2011) and every thing is working very well , thank you very much Martjin , I am happy to deal with you &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt; &lt;/p&gt;</comment>
                            <comment id="13112487" author="martijn.v.groningen" created="Thu, 22 Sep 2011 11:38:29 +0000"  >&lt;p&gt;Thanks for testing the patch out!&lt;br/&gt;
I&apos;ve committed the fix for this issue.&lt;br/&gt;
Trunk: 1174072&lt;br/&gt;
Branch 3x: 1174055&lt;/p&gt;</comment>
                            <comment id="13157868" author="thetaphi" created="Sun, 27 Nov 2011 12:36:08 +0000"  >&lt;p&gt;Bulk close after 3.5 is released&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12496035" name="SOLR-2780.patch" size="5787" author="martijn.v.groningen" created="Wed, 21 Sep 2011 22:10:04 +0000"/>
                            <attachment id="12494975" name="SOLR-2780.patch" size="2101" author="martijn.v.groningen" created="Sun, 18 Sep 2011 17:14:50 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3076</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03imf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18450</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>