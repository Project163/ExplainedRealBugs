<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:37:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4877] SolrIndexSearcher#getDocSetNC should check for null return in AtomicReader#fields()</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4877</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-5023&quot; title=&quot;Only reader that contains fields can be added into readerContext&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-5023&quot;&gt;&lt;del&gt;LUCENE-5023&lt;/del&gt;&lt;/a&gt; it was reported that composite reader contexts should not contain null fields() readers. But this is wrong, as a null-fields() reader may contain documents, just no fields.&lt;/p&gt;

&lt;p&gt;fields() and terms() is documented to return null, so DocSets should check for null (like all queries do in Lucene). It seems that DocSetNC does not correctly check for null.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12650092">SOLR-4877</key>
            <summary>SolrIndexSearcher#getDocSetNC should check for null return in AtomicReader#fields()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="uschindler">Uwe Schindler</assignee>
                                    <reporter username="uschindler">Uwe Schindler</reporter>
                        <labels>
                    </labels>
                <created>Thu, 30 May 2013 06:04:49 +0000</created>
                <updated>Mon, 9 May 2016 18:50:17 +0000</updated>
                            <resolved>Thu, 30 May 2013 16:25:01 +0000</resolved>
                                    <version>4.2</version>
                    <version>4.3</version>
                                    <fixVersion>4.3.1</fixVersion>
                    <fixVersion>4.4</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13670094" author="thetaphi" created="Thu, 30 May 2013 06:16:32 +0000"  >&lt;p&gt;Simple patch for getDocSetNC().&lt;/p&gt;

&lt;p&gt;I am not sure why there is this special handling of TermQuery, in my opinion, the if colause should go away and Solr should call the default TermScorer#collect(). There is nbo reason to have a special handling here (and no performance impact as TermScorer#collect is implemented the same way).&lt;/p&gt;

&lt;p&gt;We should remove the special case here, any comments?!&lt;/p&gt;</comment>
                            <comment id="13670095" author="thetaphi" created="Thu, 30 May 2013 06:16:56 +0000"  >&lt;p&gt;Does anybody has an idea, how to test this bug?&lt;/p&gt;</comment>
                            <comment id="13670106" author="thetaphi" created="Thu, 30 May 2013 06:34:57 +0000"  >&lt;p&gt;Patch removing the special case for TermQuery.&lt;/p&gt;

&lt;p&gt;The reson why this was here may be from older times: In Lucene 2.x, the collect method calculated the score of the Query, too. But since 3.x this is no longer the case, so there is no speed improvement by short-circuiting TermQuery. The original TermScorer/Collector code is identical.&lt;/p&gt;</comment>
                            <comment id="13670273" author="thetaphi" created="Thu, 30 May 2013 12:04:51 +0000"  >&lt;p&gt;I will commit the &quot;nospecialcase&quot; patch if nobody objects.&lt;/p&gt;</comment>
                            <comment id="13670437" author="rcmuir" created="Thu, 30 May 2013 16:00:24 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="13686934" author="shalinmangar" created="Tue, 18 Jun 2013 16:52:41 +0000"  >&lt;p&gt;Bulk close after 4.3.1 release&lt;/p&gt;</comment>
                            <comment id="13752047" author="ainihong001" created="Wed, 28 Aug 2013 03:05:06 +0000"  >&lt;p&gt;hi, Uwe, &lt;br/&gt;
I think the special handling of TermQuery just because of  performance impact. &lt;br/&gt;
If we use the default search function in lucene such as &quot;super.search(query,null,collector)&quot;, &lt;br/&gt;
it will create TermWeight for TermQuery to calculate  queryNorm(q)  and idf(t)2 * t.getBoost()  and so on.&lt;/p&gt;

&lt;p&gt;Therefore, i think the special handling of TermQuery is useful. Any comments?&lt;/p&gt;</comment>
                            <comment id="13752158" author="thetaphi" created="Wed, 28 Aug 2013 06:41:36 +0000"  >&lt;p&gt;Hi the &lt;b&gt;calculation&lt;/b&gt; is not a problem at all, it is done one time in TermWeight. The statistics for the term have to be fetched in any case (as it is part of the term dictionary). If this would be a problem here, a lot of queries in Lucene like MultiTermQuery (NumericRangeQuery, TermRangeQuery, FuzzyQuery) would need to be optimized, too, because they don&apos;t calculate scores.  The reason why this special case was here is caused by older Lucene versions where the actual score &lt;b&gt;per document&lt;/b&gt; was calculated by TermScorer although not requested. This was the performance impact, not the term statistics.&lt;/p&gt;

&lt;p&gt;If you don&apos;t have a benchmark showing that fetching the term statistics for this case is affecting performance I would prefer the simplier code.&lt;/p&gt;</comment>
                            <comment id="13752179" author="ainihong001" created="Wed, 28 Aug 2013 07:22:13 +0000"  >&lt;p&gt;Thanks for comments and it make sense.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12650084">LUCENE-5023</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12585373" name="SOLR-4877-nospecialcase.patch" size="1772" author="uschindler" created="Thu, 30 May 2013 06:34:57 +0000"/>
                            <attachment id="12585370" name="SOLR-4877.patch" size="714" author="uschindler" created="Thu, 30 May 2013 06:16:32 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>330419</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 12 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1l06f:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>330753</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>