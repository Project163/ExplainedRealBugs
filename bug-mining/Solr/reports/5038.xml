<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:59:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16773] UI: Cloud&gt;NOdes screen can&apos;t display disk usage from replicas using non-standard core names (ie: implicit router)</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16773</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Consider the following cluster w/three collections (including the &lt;tt&gt;gettingstarted&lt;/tt&gt; collection created by the example)...&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;./solr/packaging/build/dev/bin/solr -e cloud -noprompt
curl -sS &apos;http://localhost:8983/solr/admin/collections?action=CREATE&amp;amp;name=named_shards&amp;amp;router.name=compositeId&amp;amp;numShards=2&amp;amp;shards=shardX,shardY&apos;
curl -sS &apos;http://localhost:8983/solr/admin/collections?action=CREATE&amp;amp;name=implicit_named_shards&amp;amp;router.name=implicit&amp;amp;shards=shardA,shardB&apos;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;If you look at the Cloud&amp;gt;Nodes screen for this cluster, the &quot;Disk Usage&quot; (and other metrics) for the cores from the &lt;tt&gt;implicit_named_shards&lt;/tt&gt; collection wound show up. (see screenshot)&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;The problem is that &lt;tt&gt;cloud.js&lt;/tt&gt; expects core names to follow a very specific format, but implicit router names it&apos;s cores directly after the shard names specified.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13534236">SOLR-16773</key>
            <summary>UI: Cloud&gt;NOdes screen can&apos;t display disk usage from replicas using non-standard core names (ie: implicit router)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="janhoy">Jan H&#248;ydahl</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Wed, 26 Apr 2023 23:29:08 +0000</created>
                <updated>Fri, 21 Jul 2023 20:40:36 +0000</updated>
                            <resolved>Sun, 30 Apr 2023 22:05:28 +0000</resolved>
                                                    <fixVersion>9.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="5400">1.5h</timespent>
                                <comments>
                            <comment id="17717038" author="janhoy" created="Thu, 27 Apr 2023 07:45:53 +0000"  >&lt;p&gt;Good catch. Also the &quot;&lt;tt&gt;&amp;lt;collname&amp;gt;&lt;em&gt;shard2_replica_n1&lt;/tt&gt;&quot; -&amp;gt; &quot;&lt;tt&gt;&amp;lt;collname&amp;gt;_s2r1&lt;/tt&gt;&quot; core display-name abbreviation logic fails for the same reason. The JS should use a more flexible matching pattern like splitting on &quot;&lt;/em&gt;&quot; - that would only fail if shard-names contain &quot;_&quot; in them &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17717047" author="janhoy" created="Thu, 27 Apr 2023 07:57:53 +0000"  >&lt;p&gt;This is the line that fails to construct the core metric key to pull metrics:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/solr/blob/a557776ba196d5adb7cd689a6ceffa9084440407/solr/webapp/web/js/angular/controllers/cloud.js#L436&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/blob/a557776ba196d5adb7cd689a6ceffa9084440407/solr/webapp/web/js/angular/controllers/cloud.js#L436&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-javascript&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;var&lt;/span&gt; coreMetricName = &lt;span class=&quot;code-quote&quot;&gt;&quot;solr.core.&quot;&lt;/span&gt; + core[&lt;span class=&quot;code-quote&quot;&gt;&apos;core&apos;&lt;/span&gt;].replace(/(.*?)_(shard(\d+_?)+)_(replica.*?)/, &lt;span class=&quot;code-quote&quot;&gt;&apos;\$1.\$2.\$4&apos;&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="17717148" author="janhoy" created="Thu, 27 Apr 2023 11:55:14 +0000"  >&lt;p&gt;PR ready, please review&lt;/p&gt;</comment>
                            <comment id="17717326" author="hossman" created="Thu, 27 Apr 2023 18:10:52 +0000"  >&lt;p&gt;From reading the diff, it looks like it should work &#8211; but frankly i feel like the &quot;real&quot; bug is the fact that we&apos;re using a regex at all.&lt;/p&gt;

&lt;p&gt;The current logic loops over the &lt;tt&gt;cores&lt;/tt&gt; from &lt;tt&gt;CLUSTERSTATUS&lt;/tt&gt; and applying a regex to &lt;tt&gt;core&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;#39;core&amp;#39;&amp;#93;&lt;/span&gt;&lt;/tt&gt; to munge it into a &lt;tt&gt;coreMetricName&lt;/tt&gt; key we can lookup in &lt;tt&gt;m.metrics&lt;/tt&gt; to find &lt;tt&gt;coreMetric = m.metrics&lt;span class=&quot;error&quot;&gt;&amp;#91;coreMetricName&amp;#93;&lt;/span&gt;;&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;But all of those &lt;tt&gt;coreMetric&lt;/tt&gt; entries in &lt;tt&gt;m.metrics&lt;/tt&gt; have a &lt;tt&gt;&quot;CORE.coreName&quot;&lt;/tt&gt; property.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;So why don&apos;t we instead do a single loop over &lt;tt&gt;m.metrics&lt;/tt&gt; to build a new Map of the entries, keyed off of &lt;tt&gt;coreName&lt;/tt&gt;, and do our lookups against that - no regex needed.&lt;/p&gt;

&lt;p&gt;?&lt;/p&gt;</comment>
                            <comment id="17717327" author="janhoy" created="Thu, 27 Apr 2023 18:16:45 +0000"  >&lt;p&gt;The PR gets away with the regex, now we simply construct the metric key from collection, shard and replica.&lt;/p&gt;

&lt;p&gt;I&apos;m sure larger refactorings could be done in this area as well, but that would be a separate Jira and probably a much larger effort than this simple bug fix. Also we don&apos;t know how fast the newest react UI initiative will move along with a brand new solution...&lt;/p&gt;</comment>
                            <comment id="17718128" author="jira-bot" created="Sun, 30 Apr 2023 22:00:37 +0000"  >&lt;p&gt;Commit 538145f5567ddc04079f9cf51dacf1ffc09f0162 in solr&apos;s branch refs/heads/main from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=538145f5567&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=538145f5567&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16773&quot; title=&quot;UI: Cloud&amp;gt;NOdes screen can&amp;#39;t display disk usage from replicas using non-standard core names (ie: implicit router)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16773&quot;&gt;&lt;del&gt;SOLR-16773&lt;/del&gt;&lt;/a&gt;: UI: Cloud&amp;gt;Nodes screen fix display of cores with non-standard shard names (#1593)&lt;/p&gt;
</comment>
                            <comment id="17718129" author="jira-bot" created="Sun, 30 Apr 2023 22:05:12 +0000"  >&lt;p&gt;Commit 0ee1188434280877aab76698e92b7d027d6e16c8 in solr&apos;s branch refs/heads/branch_9x from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=0ee11884342&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=0ee11884342&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16773&quot; title=&quot;UI: Cloud&amp;gt;NOdes screen can&amp;#39;t display disk usage from replicas using non-standard core names (ie: implicit router)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16773&quot;&gt;&lt;del&gt;SOLR-16773&lt;/del&gt;&lt;/a&gt;: UI: Cloud&amp;gt;Nodes screen fix display of cores with non-standard shard names (#1593)&lt;/p&gt;
</comment>
                            <comment id="17745763" author="houston" created="Fri, 21 Jul 2023 20:40:36 +0000"  >&lt;p&gt;Closing after the 9.3.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13432706">SOLR-16089</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13057622" name="implict_router_ui_metrics_bug.png" size="416855" author="hossman" created="Wed, 26 Apr 2023 23:29:04 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 16 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1hk88:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>