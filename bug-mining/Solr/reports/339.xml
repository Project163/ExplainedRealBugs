<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:09:30 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-1286] DIH: The commit parameter is always defaulting to &quot;true&quot; even if &quot;false&quot; is explicitly passed in.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1286</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I&apos;ve tried running full and delta imports with commit=false so that the autoCommit will manage all commits to the index. However setting commit=false doesn&apos;t have any effect: &lt;br/&gt;
curl &apos;http://localhost:8080/solr/dataimporter?command=full-import&amp;amp;commit=false&apos;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12430615">SOLR-1286</key>
            <summary>DIH: The commit parameter is always defaulting to &quot;true&quot; even if &quot;false&quot; is explicitly passed in.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ehatcher">Erik Hatcher</assignee>
                                    <reporter username="jayallenhill@gmail.com">Jay Hill</reporter>
                        <labels>
                    </labels>
                <created>Thu, 16 Jul 2009 01:21:52 +0000</created>
                <updated>Tue, 10 Nov 2009 15:52:10 +0000</updated>
                            <resolved>Tue, 21 Jul 2009 15:10:06 +0000</resolved>
                                                    <fixVersion>1.4</fixVersion>
                                    <component>contrib - DataImportHandler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12731761" author="jayallenhill@gmail.com" created="Thu, 16 Jul 2009 01:24:26 +0000"  >&lt;p&gt;In DocBuilder.java added a check in two places to see if the commit para is false before doing the commit.&lt;/p&gt;</comment>
                            <comment id="12731790" author="ehatcher" created="Thu, 16 Jul 2009 03:53:05 +0000"  >&lt;p&gt;I was about to commit this Jay - looks reasonable.  But, the DocBuilder#commit method sets the status of indexing completion, which won&apos;t get called as you&apos;ve patched.  Looks like some slight refactoring of when that status is logged is warranted.  Also the message &quot;Full Import completed successfully&quot; probably should just say &quot;Import completed successfully&quot; since this could be either delta or full import.&lt;/p&gt;

&lt;p&gt;Wanna take another round of tinkering, Jay?&lt;/p&gt;

&lt;p&gt;A unit test that tests whether commit is called or executed would be nice, to show the bug and the fix working - but this is straightforward enough that I&apos;d commit as-is.  But unit tests: +1 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12731800" author="ehatcher" created="Thu, 16 Jul 2009 04:53:34 +0000"  >&lt;p&gt;Wow, you&apos;re fast Noble!   Looks better.  But the patch looks like optimize won&apos;t occur unless commit=true is set.  What if only optimize=true?   Granted, a commit occurs implicitly during an optimize, but seems like that should be outside of the if on commit=true.&lt;/p&gt;</comment>
                            <comment id="12731804" author="noble.paul" created="Thu, 16 Jul 2009 04:59:40 +0000"  >&lt;p&gt;if somebody sets optimize=true. It should implicitly set commit=true . makes sense?&lt;/p&gt;</comment>
                            <comment id="12731806" author="ehatcher" created="Thu, 16 Jul 2009 05:06:40 +0000"  >&lt;p&gt;Noble - looks good!&lt;/p&gt;

&lt;p&gt;Jay - give it a try and comment back.  When you say it&apos;s good, I&apos;ll commit.&lt;/p&gt;

&lt;p&gt;unit tests, anyone?  &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="12731821" author="noble.paul" created="Thu, 16 Jul 2009 05:53:47 +0000"  >&lt;p&gt;with JUnit&lt;/p&gt;</comment>
                            <comment id="12731892" author="noble.paul" created="Thu, 16 Jul 2009 10:36:17 +0000"  >&lt;p&gt;the last patch did not have the tests&lt;/p&gt;</comment>
                            <comment id="12731955" author="jayallenhill@gmail.com" created="Thu, 16 Jul 2009 14:15:26 +0000"  >&lt;p&gt;Noble and Erik, thanks for the quick response. I just applied the patch and rebuilt. It doesn&apos;t matter what I enter as a param for commit, when the finish method executes requestParameters.commit always equals true:&lt;/p&gt;

&lt;p&gt;Using: curl &apos;http://localhost:8080/solr/indexer/books?command=full-import&amp;amp;commit=false&apos;&lt;/p&gt;

&lt;p&gt;The commit is still occurring. I just woke up and tested, so I&apos;ll dig in a little more to try to find out what&apos;s up.&lt;/p&gt;</comment>
                            <comment id="12731966" author="jayallenhill@gmail.com" created="Thu, 16 Jul 2009 14:44:50 +0000"  >&lt;p&gt;Looking at the handleRequestBody method of DataImportHandler, it looks like it is getting the correct value for &quot;commit&quot; from the request, but during the mapping to create the DataImporter.RequestParams object commit is always getting set as &quot;true&quot;:&lt;/p&gt;

&lt;p&gt;SolrParams params = req.getParams();&lt;br/&gt;
System.out.println(&quot; -------------------From request : &quot; + params.get(&quot;commit&quot;));&lt;br/&gt;
DataImporter.RequestParams requestParams = new DataImporter.RequestParams(getParamsMap(params));&lt;br/&gt;
System.out.println(&quot; -------------------RequestParams: &quot; + requestParams.commit);&lt;/p&gt;

&lt;p&gt;the output:&lt;br/&gt;
-------------------From request : false&lt;br/&gt;
-------------------RequestParams: true&lt;/p&gt;

&lt;p&gt;still digging.&lt;/p&gt;</comment>
                            <comment id="12732081" author="jayallenhill@gmail.com" created="Thu, 16 Jul 2009 18:53:31 +0000"  >&lt;p&gt;Found the problem. There was a test to see if there was a value set for &quot;optimize&quot;, if so, no matter what it was, &quot;commit&quot; was set to &quot;true&quot;:&lt;br/&gt;
      if (requestParams.containsKey(&quot;optimize&quot;)) &lt;/p&gt;
{
        optimize = Boolean.parseBoolean((String) requestParams.get(&quot;optimize&quot;));
        commit = true;
      }

&lt;p&gt;But we had optimize=false set as an invariant so the simple presence of a value (false) caused a commit to happen. Changed it to this:&lt;br/&gt;
      if (requestParams.containsKey(&quot;optimize&quot;)) &lt;/p&gt;
{
        optimize = Boolean.parseBoolean((String) requestParams.get(&quot;optimize&quot;));
        if (optimize)
          commit = true;
      }

&lt;p&gt;I think that should do it.&lt;/p&gt;</comment>
                            <comment id="12733654" author="ehatcher" created="Tue, 21 Jul 2009 15:10:06 +0000"  >&lt;p&gt;Committed as r796334.  Thanks Noble and Jay! &lt;/p&gt;</comment>
                            <comment id="12775810" author="gsingers" created="Tue, 10 Nov 2009 15:52:10 +0000"  >&lt;p&gt;Bulk close for Solr 1.4&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12413721" name="SOLR-1286.patch" size="5581" author="jayallenhill@gmail.com" created="Thu, 16 Jul 2009 18:53:31 +0000"/>
                            <attachment id="12413673" name="SOLR-1286.patch" size="5612" author="noble.paul" created="Thu, 16 Jul 2009 10:36:17 +0000"/>
                            <attachment id="12413647" name="SOLR-1286.patch" size="2883" author="noble.paul" created="Thu, 16 Jul 2009 05:53:47 +0000"/>
                            <attachment id="12413631" name="SOLR-1286.patch" size="2883" author="noble.paul" created="Thu, 16 Jul 2009 04:59:40 +0000"/>
                            <attachment id="12413627" name="SOLR-1286.patch" size="1992" author="noble.paul" created="Thu, 16 Jul 2009 04:36:50 +0000"/>
                            <attachment id="12413620" name="SOLR-1286.patch" size="1151" author="jayallenhill@gmail.com" created="Thu, 16 Jul 2009 01:24:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>6361</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            16 years, 3 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03rn3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19911</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>