<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:19:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9114] NPE using TermVectorComponent, MoreLikeThisComponent in combination with ExactStatsCache</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9114</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Hello,&lt;/p&gt;

&lt;p&gt;I am getting a NPE when using the TermVectorComponent in combinition with ExactStatsCache.&lt;br/&gt;
I am using SOLR 6.0.0 with 4 shards in total.&lt;/p&gt;

&lt;p&gt;This Bug is a duplicate of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8459&quot; title=&quot;NPE using TermVectorComponent in combinition with ExactStatsCache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8459&quot;&gt;&lt;del&gt;SOLR-8459&lt;/del&gt;&lt;/a&gt;&lt;br/&gt;
It was already fixed in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8459&quot; title=&quot;NPE using TermVectorComponent in combinition with ExactStatsCache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8459&quot;&gt;&lt;del&gt;SOLR-8459&lt;/del&gt;&lt;/a&gt; for SOLR 5.x but it is still open in the new SOLR 6.0.0&lt;br/&gt;
Can you please fix it for the nes SOLR 6.0.0 as well? I already tried the patch of the 5.x bugfix on the SOLR 6.0.0 but the bug is still present.&lt;/p&gt;

&lt;p&gt;I set up my solrconfig.xml as described in these 2 links:&lt;br/&gt;
TermVectorComponent:&lt;br/&gt;
&lt;a href=&quot;https://cwiki.apache.org/confluence/display/solr/The+Term+Vector+Component&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/solr/The+Term+Vector+Component&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;ExactStatsCache:&lt;br/&gt;
&lt;a href=&quot;https://cwiki.apache.org/confluence/display/solr/Distributed+Requests#Configuring+statsCache+implementation&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://cwiki.apache.org/confluence/display/solr/Distributed+Requests#Configuring+statsCache+implementation&lt;/a&gt;&lt;/p&gt;


&lt;p&gt;My snippets from solrconfig.xml:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;...
  &amp;lt;!--
    Stats Cache
    https:&lt;span class=&quot;code-comment&quot;&gt;//cwiki.apache.org/confluence/display/solr/Distributed+Requests#Configuring+statsCache+implementation
&lt;/span&gt;  --&amp;gt;
  &amp;lt;statsCache class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.solr.search.stats.ExactStatsCache&quot;&lt;/span&gt;/&amp;gt;
  &amp;lt;!-- 
    Term Vector Component
    https:&lt;span class=&quot;code-comment&quot;&gt;//cwiki.apache.org/confluence/display/solr/The+Term+Vector+Component
&lt;/span&gt;    --&amp;gt;
  &amp;lt;searchComponent name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tvComponent&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.solr.handler.component.TermVectorComponent&quot;&lt;/span&gt;/&amp;gt;
  &amp;lt;requestHandler name=&lt;span class=&quot;code-quote&quot;&gt;&quot;/tvrh&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.solr.handler.component.SearchHandler&quot;&lt;/span&gt;&amp;gt;
    &amp;lt;lst name=&lt;span class=&quot;code-quote&quot;&gt;&quot;defaults&quot;&lt;/span&gt;&amp;gt;
      &amp;lt;bool name=&lt;span class=&quot;code-quote&quot;&gt;&quot;tv&quot;&lt;/span&gt;&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;lt;/bool&amp;gt;
    &amp;lt;/lst&amp;gt;
    &amp;lt;arr name=&lt;span class=&quot;code-quote&quot;&gt;&quot;last-components&quot;&lt;/span&gt;&amp;gt;
      &amp;lt;str&amp;gt;tvComponent&amp;lt;/str&amp;gt;
    &amp;lt;/arr&amp;gt;
  &amp;lt;/requestHandler&amp;gt;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


&lt;p&gt;Unfortunately a request to SOLR like &quot;http://host/solr/corename/tvrh?q=site_url_id:74&quot; ends up with this NPE:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;69730 ERROR (qtp110456297-14) [c:SingleDomainSite_28 s:shard1 r:core_node1 x:SingleDomainSite_28_shard1_replica1] o.a.s.s.HttpSolrCall &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:java.lang.NullPointerException
        at org.apache.solr.handler.component.TermVectorComponent.finishStage(TermVectorComponent.java:451)
        at org.apache.solr.handler.component.SearchHandler.handleRequestBody(SearchHandler.java:426)
        at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:155)
        at org.apache.solr.core.SolrCore.execute(SolrCore.java:2033)
        at org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:652)
        at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:460)
        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:229)
        at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:184)
        at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1668)
        at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:581)
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
        at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:548)
        at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:226)
        at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1160)
        at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:511)
        at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:185)
        at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1092)
        at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
        at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:213)
        at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:119)
        at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:134)
        at org.eclipse.jetty.server.Server.handle(Server.java:518)
        at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:308)
        at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:244)
        at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:273)
        at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:95)
        at org.eclipse.jetty.io.SelectChannelEndPoint$2.run(SelectChannelEndPoint.java:93)
        at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.produceAndRun(ExecuteProduceConsume.java:246)
        at org.eclipse.jetty.util.thread.strategy.ExecuteProduceConsume.run(ExecuteProduceConsume.java:156)
        at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:654)
        at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:572)
        at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:745)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;According to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7756&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-7756&lt;/a&gt; this Bug should be fixed with SOLR 5.3.0, but obviously this NPE is still present.&lt;br/&gt;
Can you please help me here?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12969984">SOLR-9114</key>
            <summary>NPE using TermVectorComponent, MoreLikeThisComponent in combination with ExactStatsCache</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="caomanhdat">Cao Manh Dat</assignee>
                                    <reporter username="adaffner">Andreas Daffner</reporter>
                        <labels>
                    </labels>
                <created>Mon, 16 May 2016 12:20:33 +0000</created>
                <updated>Thu, 21 Nov 2019 00:42:26 +0000</updated>
                            <resolved>Mon, 23 Jan 2017 13:27:30 +0000</resolved>
                                    <version>5.0</version>
                    <version>6.0</version>
                    <version>6.1</version>
                    <version>6.2</version>
                    <version>6.3</version>
                    <version>6.4</version>
                                    <fixVersion>6.5</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="15635779" author="caomanhdat" created="Fri, 4 Nov 2016 09:26:54 +0000"  >&lt;p&gt;Updated path for this issue against lastest source.&lt;/p&gt;

&lt;p&gt;In this patch, I just set &lt;tt&gt;solr.StatsCache&lt;/tt&gt; for TermVectorComponentDistributedTest, DistributedMLTComponentTest individually, because &lt;tt&gt;BaseDistributedSearchTestCase&lt;/tt&gt; is too general for this tests.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; This issue has been sneaked in Solr source for a long time. We definitely should take an action soon.&lt;/p&gt;</comment>
                            <comment id="15824853" author="caomanhdat" created="Tue, 17 Jan 2017 02:33:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; Hi Varun, I would like to commit the patch soon, unless you have a down vote for the patch.&lt;/p&gt;</comment>
                            <comment id="15827787" author="varunthacker" created="Wed, 18 Jan 2017 10:23:11 +0000"  >&lt;p&gt;Patch looks good!&lt;/p&gt;

&lt;p&gt;I think we need to modify MLTC#modifyStage with similar checks under MLTC#finishStage&lt;/p&gt;

&lt;p&gt;Also maybe lets move the choosing of stats cache to a utility method? Several test cases now do the same thing to pick the stats cache:&lt;br/&gt;
TestDistribIDF&lt;br/&gt;
TestExactStatsCache&lt;br/&gt;
DistributedMLTComponentTest&lt;br/&gt;
TermVectorComponentDistributedTest&lt;/p&gt;


&lt;p&gt;We&apos;ll need to remove unused imports before committing.&lt;/p&gt;</comment>
                            <comment id="15831464" author="caomanhdat" created="Fri, 20 Jan 2017 09:40:12 +0000"  >&lt;p&gt;Updated patch for this issue, MLTC#modifyRequest() will make MLTC ignore all shardRequest, which&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;purpose != PURPOSE_GET_MLT_RESULTS &amp;amp;&amp;amp; purpose != PURPOSE_GET_TOP_IDS
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt; I think we can create an utility method later.&lt;/p&gt;</comment>
                            <comment id="15834060" author="varunthacker" created="Mon, 23 Jan 2017 08:29:20 +0000"  >&lt;p&gt;+1 for the patch to commit. Test fails without the fix &lt;/p&gt;</comment>
                            <comment id="15834248" author="jira-bot" created="Mon, 23 Jan 2017 10:42:55 +0000"  >&lt;p&gt;Commit d34f549df6cee0db7cbff1ec2639262c2f7e21e2 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d34f549&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d34f549&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9114&quot; title=&quot;NPE using TermVectorComponent, MoreLikeThisComponent in combination with ExactStatsCache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9114&quot;&gt;&lt;del&gt;SOLR-9114&lt;/del&gt;&lt;/a&gt;: NPE using TermVectorComponent, MoreLikeThisComponent in combination with ExactStatsCache&lt;/p&gt;</comment>
                            <comment id="15834325" author="jira-bot" created="Mon, 23 Jan 2017 11:52:40 +0000"  >&lt;p&gt;Commit 7852b20cd6951bb945a1faea73a888369098baf7 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=7852b20&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=7852b20&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9114&quot; title=&quot;NPE using TermVectorComponent, MoreLikeThisComponent in combination with ExactStatsCache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9114&quot;&gt;&lt;del&gt;SOLR-9114&lt;/del&gt;&lt;/a&gt;: NPE using TermVectorComponent, MoreLikeThisComponent in combination with ExactStatsCache&lt;/p&gt;

&lt;p&gt;(cherry picked from commit d34f549df6cee0db7cbff1ec2639262c2f7e21e2)&lt;/p&gt;</comment>
                            <comment id="15834334" author="caomanhdat" created="Mon, 23 Jan 2017 11:56:54 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adaffner&quot; class=&quot;user-hover&quot; rel=&quot;adaffner&quot;&gt;adaffner&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="15835872" author="jira-bot" created="Tue, 24 Jan 2017 08:58:13 +0000"  >&lt;p&gt;Commit d34f549df6cee0db7cbff1ec2639262c2f7e21e2 in lucene-solr&apos;s branch refs/heads/apiv2 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=caomanhdat&quot; class=&quot;user-hover&quot; rel=&quot;caomanhdat&quot;&gt;caomanhdat&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d34f549&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d34f549&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9114&quot; title=&quot;NPE using TermVectorComponent, MoreLikeThisComponent in combination with ExactStatsCache&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9114&quot;&gt;&lt;del&gt;SOLR-9114&lt;/del&gt;&lt;/a&gt;: NPE using TermVectorComponent, MoreLikeThisComponent in combination with ExactStatsCache&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10020">
                    <name>Cloners</name>
                                            <outwardlinks description="is a clone of">
                                        <issuelink>
            <issuekey id="12923999">SOLR-8459</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12837079" name="SOLR-9114.patch" size="5950" author="caomanhdat" created="Fri, 4 Nov 2016 09:26:54 +0000"/>
                            <attachment id="12848497" name="SOLR-9914.patch" size="5507" author="caomanhdat" created="Fri, 20 Jan 2017 09:40:12 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 43 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2y0h3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>