<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:34:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-12674] RollupStream should not use the HashQueryParser for 1 worker</title>
                <link>https://issues.apache.org/jira/browse/SOLR-12674</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Let&apos;s say I have a dataset of a 100M document&lt;/p&gt;

&lt;p&gt;After applying a filter the number of documents found would be 5k so it&apos;s tiny.&lt;/p&gt;

&lt;p&gt;If I do a search and a rollup stream the query returns in the 200ms range.&lt;/p&gt;

&lt;p&gt;But if by mistake I add the &quot;partitionKeys&quot;&#160;param to the search stream the hash query parser is invoked which runs on the entire document set and the query time spikes up to 7 seconds.&#160;&lt;/p&gt;

&lt;p&gt;If we aren&apos;t providing a parallel stream we should ignore the&#160;partitionKeys param&lt;/p&gt;

&lt;p&gt;Sample Query:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
rollup(search(gettingstarted,q=&lt;span class=&quot;code-quote&quot;&gt;&quot;*:*&quot;&lt;/span&gt;,fl=&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;,sort=&lt;span class=&quot;code-quote&quot;&gt;&quot;id desc&quot;&lt;/span&gt;,partitionKeys=&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;),over=&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;)&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Because of the&#160;partitionKeys the underlying query formed is:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
params={q=*:*&amp;amp;distrib=&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;amp;fl=id&amp;amp;sort=id+desc&amp;amp;partitionKeys=id&amp;amp;fq={!hash+workers%3D1+worker%3D0}&amp;amp;wt=json&amp;amp;version=2.2} hits=2 status=0 QTime=30&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This is a dummy dataset so don&apos;t see the the hits and QTime but this query certainly doesn&apos;t need to add the hash query parser filter clause for workers=1&lt;/p&gt;</description>
                <environment></environment>
        <key id="13179479">SOLR-12674</key>
            <summary>RollupStream should not use the HashQueryParser for 1 worker</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="varun">Varun Thacker</reporter>
                        <labels>
                    </labels>
                <created>Fri, 17 Aug 2018 00:02:39 +0000</created>
                <updated>Thu, 21 Nov 2019 00:42:18 +0000</updated>
                            <resolved>Sun, 19 Aug 2018 19:30:24 +0000</resolved>
                                                    <fixVersion>7.5</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16585170" author="varunthacker" created="Sun, 19 Aug 2018 15:05:01 +0000"  >&lt;p&gt;After this patch the hash query parser is only used when parallel stream is has &amp;gt;=2 workers.&lt;/p&gt;

&lt;p&gt;This also addresses the problem described on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12624&quot; title=&quot;Better validation for HashQParserPlugin&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12624&quot;&gt;&lt;del&gt;SOLR-12624&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="16585249" author="jira-bot" created="Sun, 19 Aug 2018 19:15:33 +0000"  >&lt;p&gt;Commit 3e4545219ef72e89d227b46a26a951f621989d40 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=3e45452&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=3e45452&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12674&quot; title=&quot;RollupStream should not use the HashQueryParser for 1 worker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12674&quot;&gt;&lt;del&gt;SOLR-12674&lt;/del&gt;&lt;/a&gt;: RollupStream should not use the HashQueryParser for 1 worker&lt;/p&gt;</comment>
                            <comment id="16585254" author="jira-bot" created="Sun, 19 Aug 2018 19:30:00 +0000"  >&lt;p&gt;Commit d1fdc4d63dcc8d51cc64316acbb879d83b02ef4b in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d1fdc4d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d1fdc4d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12674&quot; title=&quot;RollupStream should not use the HashQueryParser for 1 worker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12674&quot;&gt;&lt;del&gt;SOLR-12674&lt;/del&gt;&lt;/a&gt;: RollupStream should not use the HashQueryParser for 1 worker&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 3e45452)&lt;/p&gt;</comment>
                            <comment id="16586757" author="jira-bot" created="Tue, 21 Aug 2018 01:30:30 +0000"  >&lt;p&gt;Commit 3e4545219ef72e89d227b46a26a951f621989d40 in lucene-solr&apos;s branch refs/heads/jira/http2 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=varun&quot; class=&quot;user-hover&quot; rel=&quot;varun&quot;&gt;varun&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=3e45452&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=3e45452&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12674&quot; title=&quot;RollupStream should not use the HashQueryParser for 1 worker&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12674&quot;&gt;&lt;del&gt;SOLR-12674&lt;/del&gt;&lt;/a&gt;: RollupStream should not use the HashQueryParser for 1 worker&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="13176849">SOLR-12624</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12936193" name="SOLR-12674.patch" size="6764" author="varun" created="Sun, 19 Aug 2018 14:52:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 13 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3x4yv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>