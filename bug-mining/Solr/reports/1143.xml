<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:32:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4127] Atomic updates used w/o updateLog should throw an error</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4127</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The atomic update feature described in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-139&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;SOLR-139&lt;/a&gt; seems to depend on having an &lt;tt&gt;&amp;lt;updateLog /&amp;gt;&lt;/tt&gt; configured in &lt;tt&gt;solrconfig.xml&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;When used without an update log, the update commands like &lt;tt&gt;set&lt;/tt&gt; or &lt;tt&gt;add&lt;/tt&gt; don&apos;t result in an error and the transaction being aborted, but produce garbled documents instead. This is the case for both the XML and JSON formats for the update message.&lt;/p&gt;

&lt;p&gt;Example:&lt;/p&gt;

&lt;p&gt;I initially created some content like this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ curl &lt;span class=&quot;code-quote&quot;&gt;&apos;localhost:8983/solr/update?commit=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Content-type:application/json&apos;&lt;/span&gt; -d &apos;
[{&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;7cb8a43c&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Title&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;My original Title&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;Creator&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;John Doe&quot;&lt;/span&gt;}]&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which resulted in this document:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;doc&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;str name=&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;7cb8a43c&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/str&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;str name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Title&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;My original Title&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/str&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;str name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Creator&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;John Doe&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/str&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/doc&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Then I attempted to update that document with this statement:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;$ curl &lt;span class=&quot;code-quote&quot;&gt;&apos;localhost:8983/solr/update?commit=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt; -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Content-type:application/json&apos;&lt;/span&gt; -d &apos;
[{&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;7cb8a43c&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Title&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;set&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;My &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; title&quot;&lt;/span&gt;}}]&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Which resulted in this garbled document, with the fields that weren&apos;t updated missing:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;doc&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;str name=&lt;span class=&quot;code-quote&quot;&gt;&quot;id&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;7cb8a43c&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/str&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;str name=&lt;span class=&quot;code-quote&quot;&gt;&quot;Title&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;{set=My new title}&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/str&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/doc&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12618249">SOLR-4127</key>
            <summary>Atomic updates used w/o updateLog should throw an error</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="lukasgraf">Lukas Graf</reporter>
                        <labels>
                    </labels>
                <created>Thu, 29 Nov 2012 23:32:00 +0000</created>
                <updated>Mon, 9 May 2016 18:54:17 +0000</updated>
                            <resolved>Tue, 11 Dec 2012 17:58:00 +0000</resolved>
                                    <version>4.0</version>
                                    <fixVersion>4.1</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>update</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13528554" author="hossman" created="Tue, 11 Dec 2012 01:13:41 +0000"  >&lt;p&gt;Patch that adds tests for two scenerios:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;updateLog is not in use, but distrib processor is in the chain&lt;/li&gt;
	&lt;li&gt;distrib processor is not in the chainat all&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In both cases we assert that a useful error is thrown if the document contains atomic update instructions, via three modifications:&lt;/p&gt;

&lt;p&gt;1) refactored &quot;isAtomicUpdate(AddUpdateCommand)&quot; (ie: a field value is a map) into existences&lt;br/&gt;
2) distrib processor throws an error if updateLog is not configured but the command isAtomicUpdate&lt;br/&gt;
3) run processor throws an error if it is given a command that isAtomicUpdate&lt;/p&gt;

&lt;p&gt;(this way even if someone really wants to use their own distrib processor, they can still use atomic updates as long as they implement it and process the maps before the docs make it to the run processor)&lt;/p&gt;</comment>
                            <comment id="13528822" author="markus17" created="Tue, 11 Dec 2012 08:54:38 +0000"  >&lt;p&gt;We have seen this too on a very recent trunk cluster. It has updateLog enabled and the distributed processor is in the chain. I could not successfully reproduce it when i disabled the langid processor in the chain, nor could i reliably reproduce this problem with the langid enabled.&lt;/p&gt;</comment>
                            <comment id="13529127" author="hossman" created="Tue, 11 Dec 2012 17:06:20 +0000"  >&lt;p&gt;marjus...&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;We have seen this too on a very recent trunk cluster. It has updateLog enabled and the distributed processor is in the chain...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;that sounds like it must be a differnet bug with similar symptoms &amp;#8211; the next time you reproduce, can you please file a bug with your configs and the specifics of hte document you tried to updated (ie: it&apos;s current state, and what atomic update you attempted)&lt;/p&gt;</comment>
                            <comment id="13529134" author="lukasgraf" created="Tue, 11 Dec 2012 17:14:15 +0000"  >&lt;p&gt;In my experience, the same symptoms could possibly be caused by either&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;using the wrong syntax for the atomic update instructions&lt;/li&gt;
	&lt;li&gt;or using the atomic &quot;add&quot; update instruction in an XML update message, which apparently isn&apos;t implemented (only in JSON).&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;If nobody beats me to it, I will add two separate issues for those.&lt;/p&gt;</comment>
                            <comment id="13529143" author="commit-tag-bot" created="Tue, 11 Dec 2012 17:26:09 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Chris M. Hostetter&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1420297&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1420297&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4127&quot; title=&quot;Atomic updates used w/o updateLog should throw an error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4127&quot;&gt;&lt;del&gt;SOLR-4127&lt;/del&gt;&lt;/a&gt;: Added explicit error message if users attempt Atomic document updates with either updateLog or DistribUpdateProcessor&lt;/p&gt;</comment>
                            <comment id="13529172" author="hossman" created="Tue, 11 Dec 2012 17:58:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;If nobody beats me to it, I will add two separate issues for those.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes please, with as many details as you can provide&lt;/p&gt;

&lt;p&gt;As for this particular fix...&lt;/p&gt;

&lt;p&gt;Committed revision 1420297. - trunk&lt;br/&gt;
Committed revision 1420305. - 5x&lt;/p&gt;</comment>
                            <comment id="13529174" author="commit-tag-bot" created="Tue, 11 Dec 2012 18:02:19 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Chris M. Hostetter&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1420305&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1420305&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4127&quot; title=&quot;Atomic updates used w/o updateLog should throw an error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4127&quot;&gt;&lt;del&gt;SOLR-4127&lt;/del&gt;&lt;/a&gt;: Added explicit error message if users attempt Atomic document updates with either updateLog or DistribUpdateProcessor (merge r1420297)&lt;/p&gt;</comment>
                            <comment id="13531217" author="lukasgraf" created="Thu, 13 Dec 2012 17:28:25 +0000"  >&lt;p&gt;Gave this a test with current trunk (r1421381) - works like a charm.&lt;br/&gt;
Thanks for fixing this so quickly Chris!&lt;/p&gt;</comment>
                            <comment id="13552414" author="commit-tag-bot" created="Mon, 14 Jan 2013 03:34:38 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Erik Hatcher&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1432794&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1432794&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4127&quot; title=&quot;Atomic updates used w/o updateLog should throw an error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4127&quot;&gt;&lt;del&gt;SOLR-4127&lt;/del&gt;&lt;/a&gt;: post.jar ignores -Dparams when -Durl is used&lt;/p&gt;</comment>
                            <comment id="13552415" author="commit-tag-bot" created="Mon, 14 Jan 2013 03:40:10 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Erik Hatcher&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1432795&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1432795&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4127&quot; title=&quot;Atomic updates used w/o updateLog should throw an error&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4127&quot;&gt;&lt;del&gt;SOLR-4127&lt;/del&gt;&lt;/a&gt;: post.jar ignores -Dparams when -Durl is used (merged from trunk)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12707522">SOLR-5977</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12560326" name="SOLR-4127.patch" size="9091" author="hossman" created="Tue, 11 Dec 2012 01:13:41 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>292878</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 45 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i0sg5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>164093</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>