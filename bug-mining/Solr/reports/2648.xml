<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:07:58 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7746] Ping requests stopped working with distrib=true in Solr 5.2.1</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7746</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;&quot;steps to reproduce&quot;&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;# start 1 node SolrCloud cluster
sh&amp;gt; ./bin/solr -c -p 8888
# create a test collection (we won&#8217;t use it, but I just want to it to load solr configs to Zk)
./bin/solr create_collection -c test -d sample_techproducts_configs -p 8888
# create another test collection with 2 shards
curl &apos;http://localhost:8888/solr/admin/collections?action=CREATE&amp;amp;name=test2&amp;amp;numShards=2&amp;amp;replicationFactor=1&amp;amp;maxShardsPerNode=2&amp;amp;collection.configName=test&apos;
# try distrib ping request
curl &apos;http://localhost:8888/solr/test2/admin/ping?wt=json&amp;amp;distrib=true&amp;amp;indent=true&apos;
...
  &quot;error&quot;:{
    &quot;msg&quot;:&quot;Ping query caused exception: Error from server at http://192.168.59.3:8888/solr/test2_shard2_replica1: Cannot execute the PingRequestHandler recursively&quot;
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedHeader panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;&quot;Exception&quot;&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;2116962 [qtp599601600-13] ERROR org.apache.solr.core.SolrCore  [test2 shard2 core_node1 test2_shard2_replica1] &#8211; org.apache.solr.common.SolrException: Cannot execute the PingRequestHandler recursively
	at org.apache.solr.handler.PingRequestHandler.handlePing(PingRequestHandler.java:246)
	at org.apache.solr.handler.PingRequestHandler.handleRequestBody(PingRequestHandler.java:211)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:143)
	at org.apache.solr.core.SolrCore.execute(SolrCore.java:2064)
	at org.apache.solr.servlet.HttpSolrCall.execute(HttpSolrCall.java:654)
	at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:450)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:227)
	at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:196)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12842001">SOLR-7746</key>
            <summary>Ping requests stopped working with distrib=true in Solr 5.2.1</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gchanan">Gregory Chanan</assignee>
                                    <reporter username="alexey.serba">Alexey Serba</reporter>
                        <labels>
                    </labels>
                <created>Wed, 1 Jul 2015 14:00:59 +0000</created>
                <updated>Mon, 9 May 2016 18:48:00 +0000</updated>
                            <resolved>Sat, 12 Sep 2015 01:20:27 +0000</resolved>
                                    <version>5.2.1</version>
                                    <fixVersion>5.4</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="14697353" author="michael.sun" created="Fri, 14 Aug 2015 16:47:45 +0000"  >&lt;p&gt;This issue can be reproduced in trunk build too.&lt;/p&gt;</comment>
                            <comment id="14699905" author="michael.sun" created="Mon, 17 Aug 2015 17:40:31 +0000"  >&lt;p&gt;Attach a fix. For the ping request particular, there is a requirement that qt parameter either be a meaningful handler or be null. The fix address this requirement when requests are sent to shards.&lt;/p&gt;</comment>
                            <comment id="14702234" author="gchanan" created="Wed, 19 Aug 2015 00:33:34 +0000"  >&lt;p&gt;Can we put the complexity in the PingRequestHandler instead of the SearchHandler?  Localizing the complexity seems like the best long term approach here.&lt;/p&gt;</comment>
                            <comment id="14703885" author="michael.sun" created="Wed, 19 Aug 2015 22:56:44 +0000"  >&lt;p&gt;Yeah, that makes sense. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gchanan&quot; class=&quot;user-hover&quot; rel=&quot;gchanan&quot;&gt;gchanan&lt;/a&gt; for suggestion.&lt;/p&gt;</comment>
                            <comment id="14705757" author="michael.sun" created="Thu, 20 Aug 2015 21:11:35 +0000"  >&lt;p&gt;Upload the patch to handle sharded ping requests inside PingRequestHandler. There are two changes.&lt;/p&gt;

&lt;p&gt;1. If the qt=/admin/ping for ping requests to shard, it delegates the request to the default handler, &quot;/select&quot;.&lt;br/&gt;
2. For ping requests to shard, PingRequestHandler returns what the delegated handler returns. Therefore the result can be aggregated later. (Originally PingRequestHandler removes most part from results that delegated handler returns. It works fine with non-distributed requests but can break the aggregation logic for distributed requests.)&lt;/p&gt;</comment>
                            <comment id="14706065" author="gchanan" created="Fri, 21 Aug 2015 01:29:14 +0000"  >&lt;p&gt;Looks good Michael, a few questions/comments:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;(params.getBool(ShardParams.IS_SHARD,&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;))
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Convention is to put a space after &quot;,&quot;.  Also, are you using tabs? please remove them.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    handler = core.getRequestHandler( &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; );
        ModifiableSolrParams wparams = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; ModifiableSolrParams(params);
        wparams.remove(CommonParams.QT);
        req.setParams(wparams);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Is it correct ot remove the QT or replace the QT with the default handler you are calling?&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt; &lt;span class=&quot;code-comment&quot;&gt;// In &lt;span class=&quot;code-keyword&quot;&gt;case&lt;/span&gt; it&apos;s a query &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; shard, &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; the result from delegated handler &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; distributed query to merge result
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (params.getBool(ShardParams.IS_SHARD,&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)) {
        core.execute(handler, req, rsp );
        ex = rsp.getException(); 
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
       core.execute(handler, req, pingrsp );
        ex = pingrsp.getException(); 
      }
...
 &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (!params.getBool(ShardParams.IS_SHARD,&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;)) {
    rsp.add( &lt;span class=&quot;code-quote&quot;&gt;&quot;status&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;OK&quot;&lt;/span&gt; );
 }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Is all the if-elsing necessary?  What happens if you use pingrsp for whether IS_SHARD is true or not and then remove the if around the status check?  What you have now doesn&apos;t look correct to me, the non-IS_SHARD case won&apos;t have OK status, right?&lt;/p&gt;</comment>
                            <comment id="14707039" author="michael.sun" created="Fri, 21 Aug 2015 17:03:28 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gchanan&quot; class=&quot;user-hover&quot; rel=&quot;gchanan&quot;&gt;gchanan&lt;/a&gt; for reviewing. Here is my answers.&lt;/p&gt;

&lt;p&gt;1. Will add space and other formatting.&lt;br/&gt;
2. qt parameter is no longer used at that point since delegation is completed. It doesn&apos;t matter if qt is removed or set to default handler.&lt;br/&gt;
3. The logic is correct for non-IS_SHARD use case and it adds OK status to rsp with the ! in last if condition.&lt;/p&gt;

</comment>
                            <comment id="14707066" author="gchanan" created="Fri, 21 Aug 2015 17:19:27 +0000"  >&lt;p&gt;on #3, sorry I didn&apos;t write that correctly.  Let me try to put it another way &amp;#8211; why not just simplify the code I listed above and get rid of the if/else handling.  Does anything break if you do that?&lt;/p&gt;

&lt;p&gt;Also, it would be great to add a test to demonstrate the problem you are fixing so it doesn&apos;t show up again.  Ideally the test should demonstrate IS_SHARD and non-IS_SHARD cases and the IS_SHARD test case should fail without your patch applied.&lt;/p&gt;</comment>
                            <comment id="14712297" author="michael.sun" created="Wed, 26 Aug 2015 01:06:22 +0000"  >&lt;p&gt;Attach patch with test. I tested that the test is gonna fail without change in PingRequestHandler. Also the code path in PingRequestHandler() is modified to separate the handling in case isShard is true or not to reduce if-else block.&lt;/p&gt;

&lt;p&gt;There is behavior change for PingRequestHandler in case isShard=true. In this case, it simply returns what the delegated handler returns. Javadoc is updated. Here is how new PingRequestHandler process ping request with distrib=true. This behavior change is required to aggregate results from shards (Step 7).&lt;/p&gt;

&lt;p&gt;1. PingRequestHandler receives ping request with distrib=true.&lt;br/&gt;
2. Find the delegated handler, for example SearchHandler by default.&lt;br/&gt;
3. Call SearchHandler to handle request.&lt;br/&gt;
4. SearchHandler send requests to shards with distrib=false and isShard=true. &lt;br/&gt;
5. &lt;span class=&quot;error&quot;&gt;&amp;#91;Shard&amp;#93;&lt;/span&gt; PingHandler of each shard receives the request and delegate to SearchHandler.&lt;br/&gt;
6. &lt;span class=&quot;error&quot;&gt;&amp;#91;Shard&amp;#93;&lt;/span&gt; SearchHandler of shards process and return the result.&lt;br/&gt;
7. SearchHandler in Step3 aggregate the result of all shards.&lt;br/&gt;
8. Return the result to PingRequestHandler.&lt;br/&gt;
9. PingRequestHandler returns either success or HTTP Error code.&lt;/p&gt;
</comment>
                            <comment id="14715804" author="gchanan" created="Thu, 27 Aug 2015 00:23:05 +0000"  >&lt;p&gt;1. You should not modify TestMiniSolrCloudCluster.  That&apos;s for testing whether the MiniSolrCloudCluster itself works.  Write a test that uses the MiniSolrCloudCluster, there should be a number of examples.  Or maybe you don&apos;t even need it &amp;#8211; can SolrPingTest satisfy what you need?&lt;/p&gt;

&lt;p&gt;2. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+      &lt;span class=&quot;code-comment&quot;&gt;// Send distributed and non-distributed ping query
&lt;/span&gt;+      cloudSolrClient.setDefaultCollection(collectionName);
+      SolrPing req = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SolrPing();
+      req.setDistrib(&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;);
+      SolrPingResponse rsp = req.process(cloudSolrClient, collectionName);
+      assertEquals(0, rsp.getStatus()); 
+      
+      cloudSolrClient.setDefaultCollection(collectionName);
+      req = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SolrPing();
+      req.setDistrib(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
+      rsp = req.process(cloudSolrClient, collectionName);
+      assertEquals(0, rsp.getStatus());   
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Most of this code is unnecessary, you set the default collection multiple times, you pass the collectionName even though it&apos;s set, you create a new request when it would just suffice to set distrib.&lt;/p&gt;

&lt;p&gt;3. &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+  &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; SolrPing setDistrib(&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; distrib) {   
+    params.add(&lt;span class=&quot;code-quote&quot;&gt;&quot;distrib&quot;&lt;/span&gt;, distrib ? &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt; : &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;);
+    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;;    
+  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You shouldn&apos;t modify SolrPing just to test it.  Just extend getParams on SolrPing for your distrib example.&lt;/p&gt;

&lt;p&gt;4. Can you just have a single one of these instead of putting it in each clause?&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &lt;span class=&quot;code-comment&quot;&gt;// Send an error or &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt;
&lt;/span&gt;+      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt;( ex != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ) {
+        &lt;span class=&quot;code-keyword&quot;&gt;throw&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SolrException(SolrException.ErrorCode.SERVER_ERROR, 
+            &lt;span class=&quot;code-quote&quot;&gt;&quot;Ping query caused exception: &quot;&lt;/span&gt;+ex.getMessage(), ex );
+      }
+    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14715882" author="gchanan" created="Thu, 27 Aug 2015 01:29:33 +0000"  >&lt;p&gt;I compared what happens in 5.1 vs your version of trunk for the commands listed in the description:&lt;br/&gt;
5.1:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;curl &apos;http://localhost:8889/solr/test2/admin/ping?wt=json&amp;amp;distrib=true&amp;amp;indent=true&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:26,
    &quot;params&quot;:{
      &quot;df&quot;:&quot;text&quot;,
      &quot;echoParams&quot;:&quot;all&quot;,
      &quot;indent&quot;:&quot;true&quot;,
      &quot;q&quot;:&quot;solrpingquery&quot;,
      &quot;distrib&quot;:&quot;true&quot;,
      &quot;wt&quot;:&quot;json&quot;,
      &quot;preferLocalShards&quot;:&quot;false&quot;,
      &quot;rows&quot;:&quot;10&quot;}},
  &quot;status&quot;:&quot;OK&quot;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Trunk:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;curl &apos;http://localhost:8885/solr/test2/admin/ping?wt=json&amp;amp;distrib=true&amp;amp;indent=true&apos;
{
  &quot;responseHeader&quot;:{
    &quot;status&quot;:0,
    &quot;QTime&quot;:28,
    &quot;params&quot;:{
      &quot;q&quot;:&quot;{!lucene}*:*&quot;,
      &quot;distrib&quot;:&quot;true&quot;,
      &quot;df&quot;:&quot;text&quot;,
      &quot;preferLocalShards&quot;:&quot;false&quot;,
      &quot;indent&quot;:&quot;true&quot;,
      &quot;echoParams&quot;:&quot;all&quot;,
      &quot;rows&quot;:&quot;10&quot;,
      &quot;wt&quot;:&quot;json&quot;}},
  &quot;status&quot;:&quot;OK&quot;}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Looks good, the change in the q parameter looks like it&apos;s that way because the solrconfig.xml being used is different.&lt;/p&gt;</comment>
                            <comment id="14717605" author="michael.sun" created="Thu, 27 Aug 2015 21:56:21 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gchanan&quot; class=&quot;user-hover&quot; rel=&quot;gchanan&quot;&gt;gchanan&lt;/a&gt; for your comments. The updated patch is uploaded.&lt;/p&gt;</comment>
                            <comment id="14720887" author="gchanan" created="Sat, 29 Aug 2015 01:27:09 +0000"  >&lt;p&gt;Looks good, two minor comments:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+      req = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; SolrPingWithDistrib();
+      req.setDistrib(&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Just use a SolrPing here, if you can.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;+      Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;, &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; collectionProperties = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; HashMap&amp;lt;&amp;gt;();
+      collectionProperties.put(CoreDescriptor.CORE_CONFIG, &lt;span class=&quot;code-quote&quot;&gt;&quot;solrconfig-tlog.xml&quot;&lt;/span&gt;);
+      collectionProperties.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.tests.maxBufferedDocs&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;100000&quot;&lt;/span&gt;);
+      collectionProperties.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.tests.ramBufferSizeMB&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;100&quot;&lt;/span&gt;);
+      &lt;span class=&quot;code-comment&quot;&gt;// use non-test classes so RandomizedRunner isn&apos;t necessary
&lt;/span&gt;+      collectionProperties.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.tests.mergePolicy&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.lucene.index.TieredMergePolicy&quot;&lt;/span&gt;);
+      collectionProperties.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.tests.mergeScheduler&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.lucene.index.ConcurrentMergeScheduler&quot;&lt;/span&gt;);
+      collectionProperties.put(&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.directoryFactory&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;solr.RAMDirectoryFactory&quot;&lt;/span&gt;);
+      miniCluster.createCollection(collectionName, NUM_SHARDS, REPLICATION_FACTOR, configName, collectionProperties);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I think all this complexity is necessary because of the configuration you are using.  Look at ConcurrentDeleteAndCreateCollectionTest &amp;#8211; that uses the MiniSolrCloudCluster and creates a collection without this complexity.&lt;/p&gt;</comment>
                            <comment id="14723848" author="michael.sun" created="Mon, 31 Aug 2015 18:45:12 +0000"  >&lt;p&gt;That makes sense. The updated patch is uploaded. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gchanan&quot; class=&quot;user-hover&quot; rel=&quot;gchanan&quot;&gt;gchanan&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14726269" author="gchanan" created="Tue, 1 Sep 2015 21:50:24 +0000"  >&lt;p&gt;+1 lgtm.&lt;/p&gt;</comment>
                            <comment id="14730038" author="gchanan" created="Thu, 3 Sep 2015 23:34:00 +0000"  >&lt;p&gt;Actually I found a problem with the test.  It looks like&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Builder jettyConfig = JettyConfig.builder();
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;doesn&apos;t set up the JettyConfig properly for SSL tests.  You need to use buildJettyConfig instead.  Not sure if we can enforce that in tests automatically.&lt;/p&gt;</comment>
                            <comment id="14731661" author="michael.sun" created="Sat, 5 Sep 2015 00:39:01 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gchanan&quot; class=&quot;user-hover&quot; rel=&quot;gchanan&quot;&gt;gchanan&lt;/a&gt; for pointing it out. I updated the patch and uploaded it.&lt;/p&gt;</comment>
                            <comment id="14741829" author="jira-bot" created="Sat, 12 Sep 2015 01:17:47 +0000"  >&lt;p&gt;Commit 1702581 from gchanan@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1702581&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1702581&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7746&quot; title=&quot;Ping requests stopped working with distrib=true in Solr 5.2.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7746&quot;&gt;&lt;del&gt;SOLR-7746&lt;/del&gt;&lt;/a&gt;: Ping requests stopped working with distrib=true in Solr 5.2.1&lt;/p&gt;</comment>
                            <comment id="14741831" author="jira-bot" created="Sat, 12 Sep 2015 01:19:40 +0000"  >&lt;p&gt;Commit 1702582 from gchanan@apache.org in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1702582&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1702582&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7746&quot; title=&quot;Ping requests stopped working with distrib=true in Solr 5.2.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7746&quot;&gt;&lt;del&gt;SOLR-7746&lt;/del&gt;&lt;/a&gt;: Ping requests stopped working with distrib=true in Solr 5.2.1&lt;/p&gt;</comment>
                            <comment id="14741832" author="gchanan" created="Sat, 12 Sep 2015 01:20:27 +0000"  >&lt;p&gt;Committed to trunk and 5.4, thanks for the patch &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=michael.sun&quot; class=&quot;user-hover&quot; rel=&quot;michael.sun&quot;&gt;michael.sun&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="14941316" author="markrmiller@gmail.com" created="Fri, 2 Oct 2015 16:11:01 +0000"  >&lt;p&gt;FY on the CHANGES.txt entry for this one:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SOLR-7746: Ping requests stopped working with distrib=true in Solr 5.2.1.  (Michael Sun)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;It should read:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;SOLR-7746: Ping requests stopped working with distrib=true in Solr 5.2.1.  (Alexey Serba, Michael Sun via Greg Chanan)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Reporter always gets credit and if committer didn&apos;t really contribute we use the via credit.&lt;/p&gt;</comment>
                            <comment id="14941394" author="gchanan" created="Fri, 2 Oct 2015 17:01:31 +0000"  >&lt;p&gt;Thanks Mark, both the &quot;via&quot; and reporter points make sense.  Should I go back and update the CHANGES.txt?&lt;/p&gt;</comment>
                            <comment id="14941458" author="markrmiller@gmail.com" created="Fri, 2 Oct 2015 17:35:59 +0000"  >&lt;p&gt;Yeah, personally I think it&apos;s worth it for the reporter credit.&lt;/p&gt;</comment>
                            <comment id="14941896" author="jira-bot" created="Fri, 2 Oct 2015 22:31:13 +0000"  >&lt;p&gt;Commit 1706499 from gchanan@apache.org in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1706499&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1706499&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7746&quot; title=&quot;Ping requests stopped working with distrib=true in Solr 5.2.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7746&quot;&gt;&lt;del&gt;SOLR-7746&lt;/del&gt;&lt;/a&gt;: Update credit in CHANGES.txt&lt;/p&gt;</comment>
                            <comment id="14941908" author="jira-bot" created="Fri, 2 Oct 2015 22:41:43 +0000"  >&lt;p&gt;Commit 1706502 from gchanan@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1706502&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1706502&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7746&quot; title=&quot;Ping requests stopped working with distrib=true in Solr 5.2.1&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7746&quot;&gt;&lt;del&gt;SOLR-7746&lt;/del&gt;&lt;/a&gt;: Update credit in CHANGES.txt&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12754303" name="SOLR-7746.patch" size="8298" author="michael.sun" created="Sat, 5 Sep 2015 00:38:06 +0000"/>
                            <attachment id="12753346" name="SOLR-7746.patch" size="8520" author="michael.sun" created="Mon, 31 Aug 2015 18:42:21 +0000"/>
                            <attachment id="12752865" name="SOLR-7746.patch" size="9349" author="michael.sun" created="Thu, 27 Aug 2015 21:55:33 +0000"/>
                            <attachment id="12752369" name="SOLR-7746.patch" size="12246" author="michael.sun" created="Wed, 26 Aug 2015 00:48:02 +0000"/>
                            <attachment id="12751582" name="SOLR-7746.patch" size="3042" author="michael.sun" created="Thu, 20 Aug 2015 20:59:09 +0000"/>
                            <attachment id="12751581" name="SOLR-7746.patch" size="3042" author="michael.sun" created="Thu, 20 Aug 2015 20:58:02 +0000"/>
                            <attachment id="12750863" name="SOLR-7746.patch" size="1198" author="michael.sun" created="Mon, 17 Aug 2015 17:37:31 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>7.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 7 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2gqmn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>