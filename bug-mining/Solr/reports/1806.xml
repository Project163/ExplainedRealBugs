<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:47:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5734] We should use System.nanoTime rather than System.currentTimeMillis when calculating elapsed time. </title>
                <link>https://issues.apache.org/jira/browse/SOLR-5734</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;As brought up by &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=andyetitmoves&quot; class=&quot;user-hover&quot; rel=&quot;andyetitmoves&quot;&gt;andyetitmoves&lt;/a&gt; in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5721&quot; title=&quot;ConnectionManager can become stuck in likeExpired&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5721&quot;&gt;&lt;del&gt;SOLR-5721&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12695414">SOLR-5734</key>
            <summary>We should use System.nanoTime rather than System.currentTimeMillis when calculating elapsed time. </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="markrmiller@gmail.com">Mark Miller</reporter>
                        <labels>
                    </labels>
                <created>Sun, 16 Feb 2014 17:58:38 +0000</created>
                <updated>Mon, 9 May 2016 18:51:21 +0000</updated>
                            <resolved>Wed, 2 Apr 2014 15:12:23 +0000</resolved>
                                                    <fixVersion>4.7.1</fixVersion>
                    <fixVersion>4.8</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13917111" author="markrmiller@gmail.com" created="Sat, 1 Mar 2014 16:23:58 +0000"  >&lt;p&gt;I&apos;ll try and knock this off this weekend before we lose it.&lt;/p&gt;</comment>
                            <comment id="13917527" author="markrmiller@gmail.com" created="Sun, 2 Mar 2014 19:02:27 +0000"  >&lt;p&gt;I&apos;ve done some initial work on this, but I&apos;m still trying to track down an issue or two with it. I&apos;ll put up a patch later today if Eclipse starts cooperating.&lt;/p&gt;</comment>
                            <comment id="13917554" author="markrmiller@gmail.com" created="Sun, 2 Mar 2014 20:48:51 +0000"  >&lt;p&gt;Here is a pass that covers all the low hanging fruit in non test code.&lt;/p&gt;</comment>
                            <comment id="13917687" author="jira-bot" created="Mon, 3 Mar 2014 02:08:46 +0000"  >&lt;p&gt;Commit 1573425 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1573425&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1573425&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5734&quot; title=&quot;We should use System.nanoTime rather than System.currentTimeMillis when calculating elapsed time. &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5734&quot;&gt;&lt;del&gt;SOLR-5734&lt;/del&gt;&lt;/a&gt;: We should use System.nanoTime rather than System.currentTimeMillis when calculating elapsed time.&lt;/p&gt;</comment>
                            <comment id="13917689" author="jira-bot" created="Mon, 3 Mar 2014 02:11:37 +0000"  >&lt;p&gt;Commit 1573426 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1573426&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1573426&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5734&quot; title=&quot;We should use System.nanoTime rather than System.currentTimeMillis when calculating elapsed time. &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5734&quot;&gt;&lt;del&gt;SOLR-5734&lt;/del&gt;&lt;/a&gt;: We should use System.nanoTime rather than System.currentTimeMillis when calculating elapsed time.&lt;/p&gt;</comment>
                            <comment id="13921312" author="noble.paul" created="Wed, 5 Mar 2014 19:53:12 +0000"  >&lt;p&gt;Any reason why System.currentTimeMillis is bad ?&lt;/p&gt;</comment>
                            <comment id="13921317" author="markrmiller@gmail.com" created="Wed, 5 Mar 2014 19:56:27 +0000"  >&lt;p&gt;Please see &quot;As brought up by Ramkumar Aiyengar in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5721&quot; title=&quot;ConnectionManager can become stuck in likeExpired&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5721&quot;&gt;&lt;del&gt;SOLR-5721&lt;/del&gt;&lt;/a&gt;&quot; or google search the difference of currentTimeMillis and nano.&lt;/p&gt;</comment>
                            <comment id="13945237" author="steve_rowe" created="Mon, 24 Mar 2014 15:45:35 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt;, should this be backported to 4.7.1?  (It&apos;s marked as a bug here but you called it an improvement over on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5721&quot; title=&quot;ConnectionManager can become stuck in likeExpired&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5721&quot;&gt;&lt;del&gt;SOLR-5721&lt;/del&gt;&lt;/a&gt;.)&lt;/p&gt;</comment>
                            <comment id="13945247" author="markrmiller@gmail.com" created="Mon, 24 Mar 2014 15:48:37 +0000"  >&lt;p&gt;It could go back - it&apos;s a bug really, but nothing that hasn&apos;t always existed for the most part. Though I suppose it wouldn&apos;t have existed in the  &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5721&quot; title=&quot;ConnectionManager can become stuck in likeExpired&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5721&quot;&gt;&lt;del&gt;SOLR-5721&lt;/del&gt;&lt;/a&gt; code yet.&lt;/p&gt;</comment>
                            <comment id="13945928" author="jira-bot" created="Tue, 25 Mar 2014 00:42:18 +0000"  >&lt;p&gt;Commit 1581162 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_4_7&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1581162&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1581162&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5734&quot; title=&quot;We should use System.nanoTime rather than System.currentTimeMillis when calculating elapsed time. &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5734&quot;&gt;&lt;del&gt;SOLR-5734&lt;/del&gt;&lt;/a&gt;: We should use System.nanoTime rather than System.currentTimeMillis when calculating elapsed time. (merged branch_4x r1573426)&lt;/p&gt;</comment>
                            <comment id="13945932" author="jira-bot" created="Tue, 25 Mar 2014 00:45:44 +0000"  >&lt;p&gt;Commit 1581163 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1581163&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1581163&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5734&quot; title=&quot;We should use System.nanoTime rather than System.currentTimeMillis when calculating elapsed time. &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5734&quot;&gt;&lt;del&gt;SOLR-5734&lt;/del&gt;&lt;/a&gt;: move CHANGES.txt entry to 4.7.1 section&lt;/p&gt;</comment>
                            <comment id="13945934" author="jira-bot" created="Tue, 25 Mar 2014 00:46:44 +0000"  >&lt;p&gt;Commit 1581164 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1581164&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1581164&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5734&quot; title=&quot;We should use System.nanoTime rather than System.currentTimeMillis when calculating elapsed time. &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5734&quot;&gt;&lt;del&gt;SOLR-5734&lt;/del&gt;&lt;/a&gt;: move CHANGES.txt entry to 4.7.1 section (merged trunk r1581163)&lt;/p&gt;</comment>
                            <comment id="13946153" author="steve_rowe" created="Tue, 25 Mar 2014 04:41:13 +0000"  >&lt;p&gt;Mark, I think this issue can be resolved?&lt;/p&gt;</comment>
                            <comment id="13957779" author="steve_rowe" created="Wed, 2 Apr 2014 15:13:35 +0000"  >&lt;p&gt;Bulk close 4.7.1 issues&lt;/p&gt;</comment>
                            <comment id="13958710" author="pacoge36" created="Thu, 3 Apr 2014 10:50:02 +0000"  >&lt;p&gt;Hi, with this change our dataimport process is around 15% longer than with 4.7.0 Release. &lt;br/&gt;
From the logs it seems that the connection is closed and reopen in every sql.&lt;/p&gt;

&lt;p&gt;After the change to nanoTime the method getConnection in JdbcDataSource.java is comparing nanos with millis. &lt;/p&gt;

&lt;p&gt;The constant CONN_TIME_OUT must be changed to nanos too. &lt;/p&gt;

&lt;p&gt;  private Connection getConnection() throws Exception {&lt;br/&gt;
    long currTime = System.nanoTime();&lt;br/&gt;
    if (currTime - connLastUsed &amp;gt; CONN_TIME_OUT) {&lt;br/&gt;
      synchronized (this) &lt;/p&gt;
{
        Connection tmpConn = factory.call();
        closeConnection();
        connLastUsed = System.nanoTime();
        return conn = tmpConn;
      }

&lt;p&gt;    } else &lt;/p&gt;
{
      connLastUsed = currTime;
      return conn;
    }
&lt;p&gt;  }&lt;/p&gt;

&lt;p&gt;private static final long CONN_TIME_OUT = 10 * 1000; // 10 seconds&lt;/p&gt;


&lt;p&gt;Regards&lt;/p&gt;</comment>
                            <comment id="13958737" author="markrmiller@gmail.com" created="Thu, 3 Apr 2014 11:47:35 +0000"  >&lt;p&gt;Can you file a new JIRA issue so we can fix this for a possible 4.7.2 and 4.8?&lt;/p&gt;</comment>
                            <comment id="13958744" author="pacoge36" created="Thu, 3 Apr 2014 12:00:18 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5954&quot; title=&quot;Slower dataimport process caused by not reusing jdbc connections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5954&quot;&gt;&lt;del&gt;SOLR-5954&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12632073" name="SOLR-5734.patch" size="61545" author="markrmiller@gmail.com" created="Sun, 2 Mar 2014 20:48:51 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>373922</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 33 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1sfrb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>374222</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>