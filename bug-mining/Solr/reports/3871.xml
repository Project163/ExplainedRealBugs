<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:32:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-12199] TestReplicationHandler.doTestRepeater(): TEST_PORT interpolation failure: Server refused connection at: http://127.0.0.1:TEST_PORT/solr </title>
                <link>https://issues.apache.org/jira/browse/SOLR-12199</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;From &lt;a href=&quot;https://jenkins.thetaphi.de/job/Lucene-Solr-7.x-MacOSX/551/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://jenkins.thetaphi.de/job/Lucene-Solr-7.x-MacOSX/551/&lt;/a&gt;:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; 750759 INFO  (TEST-TestReplicationHandler.doTestRepeater-seed#[7078A21248E0962E]) [    ] o.a.s.h.TestReplicationHandler Waited for 0ms and found 3 docs
   [junit4]   2&amp;gt; 750760 INFO  (qtp351238853-8844) [    x:collection1] o.a.s.c.S.Request [collection1]  webapp=/solr path=/replication params={_trace=getDetails&amp;amp;qt=/replication&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;command=details} status=0 QTime=1
   [junit4]   2&amp;gt; 750761 INFO  (qtp351238853-8846) [    x:collection1] o.a.s.c.S.Request [collection1]  webapp=/solr path=/replication params={_trace=getDetails&amp;amp;qt=/replication&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;command=details} status=0 QTime=0
   [junit4]   2&amp;gt; 750769 WARN  (qtp738580099-8901) [    x:collection1] o.a.s.h.ReplicationHandler Exception while invoking &apos;details&apos; method for replication on master 
   [junit4]   2&amp;gt; org.apache.solr.client.solrj.SolrServerException: Server refused connection at: http://127.0.0.1:TEST_PORT/solr
   [junit4]   2&amp;gt; 	at org.apache.solr.client.solrj.impl.HttpSolrClient.executeMethod(HttpSolrClient.java:650) ~[java/:?]
   [junit4]   2&amp;gt; 	at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:255) ~[java/:?]
   [junit4]   2&amp;gt; 	at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:244) ~[java/:?]
   [junit4]   2&amp;gt; 	at org.apache.solr.client.solrj.SolrClient.request(SolrClient.java:1219) ~[java/:?]
   [junit4]   2&amp;gt; 	at org.apache.solr.handler.IndexFetcher.getDetails(IndexFetcher.java:1852) ~[java/:?]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I looked at &lt;tt&gt;TestReplicationHandler&lt;/tt&gt; Jenkins failure logs from the last couple days, and every single one has the same pattern: a WARN message from &lt;tt&gt;doTestRepeater()&lt;/tt&gt; about failure to connect with a URL containing port &lt;tt&gt;TEST_PORT&lt;/tt&gt; (rather than a numeric value).&lt;/p&gt;

&lt;p&gt;On the dev list Dawid Weiss &lt;a href=&quot;https://lists.apache.org/thread.html/b9606be4ae70e58b4be8c3438e92f69361d59b4de566ec707dda3f24@%3Cdev.lucene.apache.org%3E&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;wrote&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;I see this in TestReplicationHandler:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 /**
  * character copy of file using UTF-8. If port is non-&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;, will be
substituted any time &lt;span class=&quot;code-quote&quot;&gt;&quot;TEST_PORT&quot;&lt;/span&gt; is found.
  */
 &lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; void copyFile(File src, File dst, &lt;span class=&quot;code-object&quot;&gt;Integer&lt;/span&gt; port,
&lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; internalCompression) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
   BufferedReader in = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; BufferedReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InputStreamReader(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt;
FileInputStream(src), StandardCharsets.UTF_8));
   Writer out = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; OutputStreamWriter(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FileOutputStream(dst),
StandardCharsets.UTF_8);

   &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; line = in.readLine(); &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; != line; line = in.readLine()) {

     &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; != port)
       line = line.replace(&lt;span class=&quot;code-quote&quot;&gt;&quot;TEST_PORT&quot;&lt;/span&gt;, port.toString());
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So it seems port is allowed to be null and then won&apos;t be substituted.&lt;br/&gt;
This looks like a bug in the test scaffolding: this situation&lt;br/&gt;
shouldn&apos;t be allowed; if a port cannot be acquired the test should&lt;br/&gt;
fail much sooner?&lt;/p&gt;&lt;/blockquote&gt;</description>
                <environment></environment>
        <key id="13150672">SOLR-12199</key>
            <summary>TestReplicationHandler.doTestRepeater(): TEST_PORT interpolation failure: Server refused connection at: http://127.0.0.1:TEST_PORT/solr </summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sarowe">Steven Rowe</assignee>
                                    <reporter username="sarowe">Steven Rowe</reporter>
                        <labels>
                    </labels>
                <created>Fri, 6 Apr 2018 18:36:20 +0000</created>
                <updated>Sat, 8 Jun 2019 15:14:48 +0000</updated>
                            <resolved>Fri, 6 Apr 2018 18:55:48 +0000</resolved>
                                                    <fixVersion>7.4</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="16428766" author="steve_rowe" created="Fri, 6 Apr 2018 18:42:56 +0000"  >&lt;p&gt;I attached a patch that includes the test port on the repeater &lt;tt&gt;SolrInstance&lt;/tt&gt; constructor (previously was specified as null), and also insures that the master port is set as the test port prior to copying all non-master config files (this was already done in a few places, but not all).&lt;/p&gt;

&lt;p&gt;I beasted 100 iterations of &lt;tt&gt;TestReplicationHandler&lt;/tt&gt; with the patch, 31 of which failed for various reasons, and the WARN log entries about &lt;tt&gt;TEST_PORT&lt;/tt&gt; did not occur in any of the logs.&lt;/p&gt;

&lt;p&gt;Committing shortly.&lt;/p&gt;</comment>
                            <comment id="16428791" author="jira-bot" created="Fri, 6 Apr 2018 18:55:31 +0000"  >&lt;p&gt;Commit 1d8313ca8de2b9f5297b337f3156079be270dc6d in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1d8313c&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=1d8313c&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12199&quot; title=&quot;TestReplicationHandler.doTestRepeater(): TEST_PORT interpolation failure: Server refused connection at: http://127.0.0.1:TEST_PORT/solr &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12199&quot;&gt;&lt;del&gt;SOLR-12199&lt;/del&gt;&lt;/a&gt;: TestReplicationHandler.doTestRepeater(): TEST_PORT interpolation failure: Server refused connection at: &lt;a href=&quot;http://127.0.0.1:TEST_PORT/solr&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://127.0.0.1:TEST_PORT/solr&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16428792" author="jira-bot" created="Fri, 6 Apr 2018 18:55:32 +0000"  >&lt;p&gt;Commit 5c37b07a3d53e64c2f0cebd33eb7024d693d62f5 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5c37b07&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5c37b07&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12199&quot; title=&quot;TestReplicationHandler.doTestRepeater(): TEST_PORT interpolation failure: Server refused connection at: http://127.0.0.1:TEST_PORT/solr &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12199&quot;&gt;&lt;del&gt;SOLR-12199&lt;/del&gt;&lt;/a&gt;: TestReplicationHandler.doTestRepeater(): TEST_PORT interpolation failure: Server refused connection at: &lt;a href=&quot;http://127.0.0.1:TEST_PORT/solr&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://127.0.0.1:TEST_PORT/solr&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12917886" name="SOLR-12199.patch" size="2331" author="sarowe" created="Fri, 6 Apr 2018 18:37:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 32 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3s8zj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>