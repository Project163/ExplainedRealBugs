<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:36:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4813] Unavoidable IllegalArgumentException occurs when SynonymFilterFactory&apos;s setting has tokenizer factory&apos;s parameter.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4813</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When I write SynonymFilterFactory&apos; setting in schema.xml as follows, ...&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;analyzer&amp;gt;&lt;/span&gt;
  &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;tokenizer class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.NGramTokenizerFactory&quot;&lt;/span&gt; maxGramSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt; minGramSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
  &amp;lt;filter class=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.SynonymFilterFactory&quot;&lt;/span&gt; synonyms=&lt;span class=&quot;code-quote&quot;&gt;&quot;synonyms.txt&quot;&lt;/span&gt; ignoreCase=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt; expand=&lt;span class=&quot;code-quote&quot;&gt;&quot;true&quot;&lt;/span&gt;
   tokenizerFactory=&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.NGramTokenizerFactory&quot;&lt;/span&gt; maxGramSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt; minGramSize=&lt;span class=&quot;code-quote&quot;&gt;&quot;2&quot;&lt;/span&gt;/&amp;gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/analyzer&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;IllegalArgumentException (&quot;Unknown parameters&quot;) occurs.&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Caused by: java.lang.IllegalArgumentException: Unknown parameters: {maxGramSize=2, minGramSize=2}
	at org.apache.lucene.analysis.synonym.FSTSynonymFilterFactory.&amp;lt;init&amp;gt;(FSTSynonymFilterFactory.java:71)
	at org.apache.lucene.analysis.synonym.SynonymFilterFactory.&amp;lt;init&amp;gt;(SynonymFilterFactory.java:50)
	... 28 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;However TokenizerFactory&apos;s params should be set to loadTokenizerFactory method in &lt;span class=&quot;error&quot;&gt;&amp;#91;FST|Slow&amp;#93;&lt;/span&gt;SynonymFilterFactory. (ref. &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2909&quot; title=&quot;Add support for ResourceLoaderAware tokenizerFactories in synonym filter factories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2909&quot;&gt;&lt;del&gt;SOLR-2909&lt;/del&gt;&lt;/a&gt;)&lt;/p&gt;

&lt;p&gt;I think, the problem was caused by &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-4877&quot; title=&quot;Fix analyzer factories to throw exception when arguments are invalid&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-4877&quot;&gt;&lt;del&gt;LUCENE-4877&lt;/del&gt;&lt;/a&gt; (&quot;Fix analyzer factories to throw exception when arguments are invalid&quot;) and &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3402&quot; title=&quot;Parse Version outside of Analysis Factories&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3402&quot;&gt;&lt;del&gt;SOLR-3402&lt;/del&gt;&lt;/a&gt; (&quot;Parse Version outside of Analysis Factories&quot;).&lt;/p&gt;</description>
                <environment></environment>
        <key id="12647241">SOLR-4813</key>
            <summary>Unavoidable IllegalArgumentException occurs when SynonymFilterFactory&apos;s setting has tokenizer factory&apos;s parameter.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="sasashin">Shingo Sasaki</reporter>
                        <labels>
                            <label>SynonymFilterFactory</label>
                    </labels>
                <created>Mon, 13 May 2013 03:43:42 +0000</created>
                <updated>Mon, 9 May 2016 18:55:03 +0000</updated>
                            <resolved>Tue, 14 May 2013 22:13:58 +0000</resolved>
                                    <version>4.3</version>
                                    <fixVersion>4.3.1</fixVersion>
                    <fixVersion>4.4</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>Schema and Analysis</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13655749" author="jkrupan" created="Mon, 13 May 2013 04:32:02 +0000"  >&lt;p&gt;The problem is not that you have a tokenizerFactory attribute, but that you are trying to use a tokenizer that has attributes. Solr is simply complaining that you have two attributes, maxGramSize and minGramSize that are not defined for the SynonymFilterFactory. Yes, that is a new feature in Solr! If your code was working in a previous release, you were lucky - it would have been using the default min and max of 1 and 1.&lt;/p&gt;

&lt;p&gt;The synonym tokenizerFactory attribute has no provision for passing attributes to the synonym tokenizer. For now, you&apos;ll have to create a custom ngram tokenizer factor with the desired settings.&lt;/p&gt;</comment>
                            <comment id="13655772" author="sasashin" created="Mon, 13 May 2013 05:38:05 +0000"  >&lt;p&gt;Hi, Jack. Thank you for your comment.&lt;br/&gt;
Do you mean that backward compatibility was lost? &lt;/p&gt;

&lt;p&gt;On samples of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-319&quot; title=&quot;changes SynonymFilterFactory to &amp;quot;Analyze&amp;quot; synonyms file&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-319&quot;&gt;&lt;del&gt;SOLR-319&lt;/del&gt;&lt;/a&gt;, the filter tag of SynonymFilterFactory has attributes, minGramSize and maxGramSize,&lt;br/&gt;
and TokenizerFactory&apos;s instance is inited by args in FSTSynonymFilterFactory.loadTokenizerFactory of Lucene 4.2.1&apos;s.&lt;/p&gt;</comment>
                            <comment id="13655897" author="sasashin" created="Mon, 13 May 2013 10:42:59 +0000"  >&lt;p&gt;I posted the patch of bug fix and improvement. Please review it. &lt;/p&gt;

&lt;p&gt;The improvement is following.&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;If TokenizerFactory&apos;s parameter name is the same as SynonymFilterFactory&apos;s parameter name, you must add prefix &quot;tokenizerFactory.&quot; to TokenizerFactory&apos;s parameter name.&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="13655951" author="jkrupan" created="Mon, 13 May 2013 13:15:43 +0000"  >&lt;p&gt;Yes, you are right, this is a regression - I checked 4.2 - all the original &quot;args&quot; get passed to the tokenizer factory. And your suggested improvement makes sense.&lt;/p&gt;

&lt;p&gt;You should lobby to have this fix in 4.3.1.&lt;/p&gt;

&lt;p&gt;Some enhancement to the synonym filter factory Javadoc is also needed - to explain how tokenizer factory args are passed.&lt;/p&gt;</comment>
                            <comment id="13656565" author="hossman" created="Tue, 14 May 2013 00:07:10 +0000"  >&lt;p&gt;Thanks for the bug report, and especially for the patch with test case!&lt;/p&gt;

&lt;p&gt;your patch looks correct to me at first glance, but i&apos;ll review more closely and try to get in for 4.3.1&lt;/p&gt;</comment>
                            <comment id="13656619" author="hossman" created="Tue, 14 May 2013 01:21:51 +0000"  >&lt;p&gt;Shingo: a flaw in your test was that &quot;inform&quot; was never called on the SynonymFilterFactory you were manually constructing, so it never attempted to instantiate your &quot;TestTokenizerFactory&quot;, so all of the checks you had in it&apos;s constructor were being ignored.&lt;/p&gt;

&lt;p&gt;I simplified the test to use tokenFilterFactory() to try and deal with this, but that exposed another problem: since your TestTokenizerFactory class isn&apos;t registered with SPI, &quot;lookupClass()&quot; fails on it.&lt;/p&gt;

&lt;p&gt;To simplify all of this, I changed the test to us a real tokenizer factory with mandatory init arg (PatternTokenizerFactory), so we can check both the positive and negative cases &amp;#8211; this includes an explicit check that specifying params which neither the SynonymFilterFactor nor the tokenizerFactory are expecting causes an error.&lt;/p&gt;

&lt;p&gt;I also tweaked your javadocs to try and clarify that the param prefix could be used even if the param names don&apos;t conflict, and re-ordered the param parsing code to group of of the tokenizerFactory stuff together.&lt;/p&gt;

&lt;p&gt;still running full tests.&lt;/p&gt;
</comment>
                            <comment id="13656650" author="sasashin" created="Tue, 14 May 2013 02:26:48 +0000"  >&lt;p&gt;Jack: Thanks for your check and advice.&lt;/p&gt;

&lt;p&gt;Hoss: Thank you for compensating for the shortcomings of my patch.&lt;/p&gt;

&lt;p&gt;By the way, the patch is applied to SynonymFilterFactory of trunk, but SynonymFilterFactory of branch_4x is  delegatee of &lt;span class=&quot;error&quot;&gt;&amp;#91;FST|Slow&amp;#93;&lt;/span&gt;SynonymFilterFactory.&lt;/p&gt;

&lt;p&gt;Is branch_4x&apos;s patch required for committing to 4.3.1?&lt;/p&gt;</comment>
                            <comment id="13657230" author="hossman" created="Tue, 14 May 2013 17:23:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;Hoss: Thank you for compensating for the shortcomings of my patch.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Hey man, you did the hard part &amp;#8211; i just gave it a second pair of eyes and noticed the test glitch.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Is branch_4x&apos;s patch required for committing to 4.3.1?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Nope, i&apos;ll take care of the backport &amp;#8211; but thanks forthe reminder about FST vs Slow on 4x, i might have missed one.&lt;/p&gt;

&lt;p&gt;Committed revision 1482474. - trunk ... backporting now.&lt;/p&gt;</comment>
                            <comment id="13657257" author="rcmuir" created="Tue, 14 May 2013 17:38:58 +0000"  >&lt;p&gt;Thanks to both of you especially for still preserving the checking!!!&lt;/p&gt;</comment>
                            <comment id="13657336" author="hossman" created="Tue, 14 May 2013 18:30:17 +0000"  >&lt;p&gt;patch showing what the backport looks like.&lt;/p&gt;

&lt;p&gt;it&apos;s unfortunate there isn&apos;t more code reuse between Slow &amp;amp; FST SynonymFactories, but that that can be refactored another day.&lt;/p&gt;

&lt;p&gt;the patch includes some additional test permutations to ensure the param checking works right regardless of which delegate is picked.&lt;/p&gt;

&lt;p&gt;i&apos;m still running full tests &amp;amp; precommit&lt;/p&gt;</comment>
                            <comment id="13657361" author="rcmuir" created="Tue, 14 May 2013 18:46:42 +0000"  >&lt;p&gt;backport looks great!&lt;/p&gt;</comment>
                            <comment id="13657402" author="hossman" created="Tue, 14 May 2013 19:19:10 +0000"  >&lt;p&gt;Thanks rmuir,&lt;/p&gt;

&lt;p&gt;Committed revision 1482527 - 4x&lt;/p&gt;

&lt;p&gt;Backport to 4.3.1 was clean, i&apos;ll commit there when the tests are done&lt;/p&gt;</comment>
                            <comment id="13657586" author="hossman" created="Tue, 14 May 2013 22:12:20 +0000"  >&lt;p&gt;the 4.3.1 backport wasn&apos;t as clean as i originally thought, apparently i was depending on some test improvements that were committed to 4x as part of an improvement (&lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-3907&quot; title=&quot;Improve the Edge/NGramTokenizer/Filters&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-3907&quot;&gt;&lt;del&gt;LUCENE-3907&lt;/del&gt;&lt;/a&gt;) so i also merged back just the BaseTokenStreamFactoryTestCase changes from r1479892...&lt;/p&gt;

&lt;p&gt;Committed revision 1482619. - branch 4_3&lt;/p&gt;</comment>
                            <comment id="13657937" author="cm" created="Wed, 15 May 2013 05:15:49 +0000"  >&lt;p&gt;Good work. Thanks!&lt;/p&gt;</comment>
                            <comment id="13686935" author="shalinmangar" created="Tue, 18 Jun 2013 16:52:41 +0000"  >&lt;p&gt;Bulk close after 4.3.1 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12638770">LUCENE-4877</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12583055" name="SOLR-4813.patch" size="6897" author="hossman" created="Tue, 14 May 2013 01:21:51 +0000"/>
                            <attachment id="12582915" name="SOLR-4813.patch" size="6389" author="sasashin" created="Mon, 13 May 2013 10:42:59 +0000"/>
                            <attachment id="12583179" name="SOLR-4813__4x.patch" size="27752" author="hossman" created="Tue, 14 May 2013 18:30:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>327597</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1kiuf:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>327941</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>