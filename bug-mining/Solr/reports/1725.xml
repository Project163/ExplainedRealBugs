<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:45:11 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5650] When mixing adds and deletes, it appears there is a corner case where peersync can bring back a deleted update.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-5650</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description></description>
                <environment></environment>
        <key id="12689946">SOLR-5650</key>
            <summary>When mixing adds and deletes, it appears there is a corner case where peersync can bring back a deleted update.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="markrmiller@gmail.com">Mark Miller</reporter>
                        <labels>
                    </labels>
                <created>Tue, 21 Jan 2014 04:36:56 +0000</created>
                <updated>Mon, 9 May 2016 18:45:54 +0000</updated>
                            <resolved>Mon, 24 Feb 2014 16:21:43 +0000</resolved>
                                                    <fixVersion>4.7</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13877179" author="markrmiller@gmail.com" created="Tue, 21 Jan 2014 04:37:19 +0000"  >&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; 67110 T26 C64 P38462 oasup.LogUpdateProcessor.processAdd DEBUG PRE_UPDATE add{,id=0-221} {version=2&amp;amp;wt=javabin&amp;amp;CONTROL=TRUE}
   [junit4]   2&amp;gt; 67111 T26 C64 P38462 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={version=2&amp;amp;wt=javabin&amp;amp;CONTROL=TRUE} {add=[0-221 (1457809507133423616)]} 0 2
   [junit4]   2&amp;gt; 67114 T67 C65 P58989 oasup.LogUpdateProcessor.processAdd DEBUG PRE_UPDATE add{,id=0-221} {version=2&amp;amp;wt=javabin}
   [junit4]   2&amp;gt; 67115 T67 C65 P58989 oasu.SolrCmdDistributor.submit DEBUG sending update to http://127.0.0.1:58081/collection1/ retry:0 add{_version_=1457809507137617920,id=0-221} params:update.distrib=FROMLEADER&amp;amp;distrib.from=http%3A%2F%2F127.0.0.1%3A58989%2Fcollection1%2F
   [junit4]   2&amp;gt; 67117 T141 C66 P58081 oasup.LogUpdateProcessor.processAdd DEBUG PRE_UPDATE add{,id=0-221} {version=2&amp;amp;wt=javabin&amp;amp;distrib.from=http://127.0.0.1:58989/collection1/&amp;amp;update.distrib=FROMLEADER}
   [junit4]   2&amp;gt; 67119 T141 C66 P58081 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={version=2&amp;amp;wt=javabin&amp;amp;distrib.from=http://127.0.0.1:58989/collection1/&amp;amp;update.distrib=FROMLEADER} {add=[0-221 (1457809507137617920)]} 0 2
   [junit4]   2&amp;gt; 67119 T67 C65 P58989 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={version=2&amp;amp;wt=javabin} {add=[0-221 (1457809507137617920)]} 0 5
   [junit4]   2&amp;gt; 71842 T26 C83 P38462 oasup.LogUpdateProcessor.processDelete DEBUG PRE_UPDATE delete{,id=0-221,commitWithin=-1} {version=2&amp;amp;wt=javabin&amp;amp;CONTROL=TRUE}
   [junit4]   2&amp;gt; 71843 T26 C83 P38462 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={version=2&amp;amp;wt=javabin&amp;amp;CONTROL=TRUE} {delete=[0-221 (-1457809512096333824)]} 0 1
   [junit4]   2&amp;gt; 71847 T141 C82 P58081 oasup.LogUpdateProcessor.processDelete DEBUG PRE_UPDATE delete{,id=0-221,commitWithin=-1} {version=2&amp;amp;wt=javabin}
   [junit4]   2&amp;gt; 71848 T141 C82 P58081 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={version=2&amp;amp;wt=javabin} {delete=[0-221 (-1457809512100528128)]} 0 2
   [junit4]   2&amp;gt; 92831 T241 C393 P53946 oasup.LogUpdateProcessor.processAdd DEBUG PRE_UPDATE add{flags=c,_version_=1457809507137617920,id=0-221} LocalSolrQueryRequest{update.distrib=FROMLEADER&amp;amp;peersync=true}
   [junit4]   2&amp;gt; 98890 T356 C441 P58081 oasup.LogUpdateProcessor.processAdd DEBUG PRE_UPDATE add{flags=c,_version_=1457809507137617920,id=0-221} LocalSolrQueryRequest{update.distrib=FROMLEADER&amp;amp;peersync=true}
   [junit4]   2&amp;gt; 98901 T356 C441 P58081 oasup.LogUpdateProcessor.finish [collection1] {add=[0-209 (1457809502219796480), 0-217 (1457809503008325632), 0-219 (1457809503204409344), 0-221 (1457809507137617920), 0-223 (1457809507365158912), 0-225 (1457809507605282816), 0-410 (1457809535876988928), 0-414 (1457809536131792896), 0-416 (1457809536277544960), 0-418 (1457809536412811264), ... (14 adds)],delete=[0-194 (-1457809502331994112), ft1-107 (-1457809502356111360), ft1-108 (-1457809502633984000), 0-196 (-1457809502648664064), 0-206 (-1457809502995742720), ft1-112 (-1457809503185534976), 0-209 (-1457809507200532480), 0-217 (-1457809507535028224), 0-219 (-1457809507773054976), 0-408 (-1457809535916834816), ... (14 deletes)]} 0 19
   [junit4]   2&amp;gt; ###### Only in http://127.0.0.1:53946/collection1: [{_version_=1457809507137617920, id=0-221}, {_version_=1457809507605282816, id=0-225}, {_version_=1457809507365158912, id=0-223}]

&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13877182" author="markrmiller@gmail.com" created="Tue, 21 Jan 2014 04:39:37 +0000"  >&lt;p&gt;Got this fail after running the chaosmonkey tests for about 2 days on a continuous loop. The doc is brought back by peersync, but not too all of the replicas in the shard either.&lt;/p&gt;</comment>
                            <comment id="13877743" author="markrmiller@gmail.com" created="Tue, 21 Jan 2014 19:04:03 +0000"  >&lt;p&gt;One good improvement:&lt;/p&gt;

&lt;p&gt;For the case were the leader is a replacement, only peer sync with those nodes that have last published ACTIVE.&lt;/p&gt;</comment>
                            <comment id="13877975" author="markrmiller@gmail.com" created="Tue, 21 Jan 2014 23:05:21 +0000"  >&lt;p&gt;You will still have the possibility of bringing back documents on startup by syncing with a replica that is out of date by less than 100 updates on cluster startup. The number of recent docs that would come back is fairly small though, and the chances of it happening pretty slim. We may be able to do more around that as well.&lt;/p&gt;</comment>
                            <comment id="13878030" author="jira-bot" created="Tue, 21 Jan 2014 23:52:24 +0000"  >&lt;p&gt;Commit 1560221 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1560221&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1560221&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5650&quot; title=&quot;When mixing adds and deletes, it appears there is a corner case where peersync can bring back a deleted update.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5650&quot;&gt;&lt;del&gt;SOLR-5650&lt;/del&gt;&lt;/a&gt;: When a replica becomes a leader, only peer sync with other replicas that last published an ACTIVE state.&lt;/p&gt;</comment>
                            <comment id="13878037" author="jira-bot" created="Tue, 21 Jan 2014 23:57:15 +0000"  >&lt;p&gt;Commit 1560223 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1560223&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1560223&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5650&quot; title=&quot;When mixing adds and deletes, it appears there is a corner case where peersync can bring back a deleted update.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5650&quot;&gt;&lt;del&gt;SOLR-5650&lt;/del&gt;&lt;/a&gt;: When a replica becomes a leader, only peer sync with other replicas that last published an ACTIVE state.&lt;/p&gt;</comment>
                            <comment id="13878217" author="markrmiller@gmail.com" created="Wed, 22 Jan 2014 03:40:07 +0000"  >&lt;p&gt;Just saw another fail where the control had a doc the cluster did not. This issue may have helped hide it previously, don&apos;t remember seeing it before. Actually looks like a legit fail. Looks like a single leader in a shard accepted an update and was killed. The update is gone, and so the loss makes sense in the current system. You need support for the param that tells how many replicas to the update must get to for success to protect against this.&lt;/p&gt;</comment>
                            <comment id="14000891" author="jira-bot" created="Sat, 17 May 2014 21:47:14 +0000"  >&lt;p&gt;Commit 1595547 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rjernst&quot; class=&quot;user-hover&quot; rel=&quot;rjernst&quot;&gt;rjernst&lt;/a&gt; in branch &apos;dev/branches/lucene5650&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1595547&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1595547&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5650&quot; title=&quot;When mixing adds and deletes, it appears there is a corner case where peersync can bring back a deleted update.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5650&quot;&gt;&lt;del&gt;SOLR-5650&lt;/del&gt;&lt;/a&gt;: add changes entries&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12681631">SOLR-5509</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12624219" name="SOLR-5650.patch" size="8204" author="markrmiller@gmail.com" created="Tue, 21 Jan 2014 23:06:08 +0000"/>
                            <attachment id="12624206" name="SOLR-5650.patch" size="4787" author="markrmiller@gmail.com" created="Tue, 21 Jan 2014 22:42:57 +0000"/>
                            <attachment id="12624068" name="solr.log.tar.gz" size="231303" author="markrmiller@gmail.com" created="Tue, 21 Jan 2014 04:46:49 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>368912</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 27 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1rl33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>369216</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>