<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:07:53 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16701] Fetching PRS enabled collection might throw SolrException: Error fetching per-replica-states if the collection is deleted during the fetch</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16701</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;It&apos;s found that a race condition could arise and trigger SolrException, if:&lt;br/&gt;
1. `fetchCollectionState` is called, and the state.json is fetched&lt;br/&gt;
2. But before the `fetchCollectionState` fetches the PRS entries, the collection state.json/PRS are deleted by someone else&lt;br/&gt;
3. `fetchCollectionState` would throw below exception when it reaches the PRS fetching logic&lt;/p&gt;

&lt;p&gt;&lt;tt&gt;org.apache.solr.common.SolrException: Error fetching per-replica states&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at __randomizedtesting.SeedInfo.seed(&lt;span class=&quot;error&quot;&gt;&amp;#91;C2BFFBF8FE49C1E1:F1C8D9E308D2745&amp;#93;&lt;/span&gt;:0)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at app//org.apache.solr.common.cloud.PerReplicaStatesFetcher.fetch(PerReplicaStatesFetcher.java:49)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at app//org.apache.solr.common.cloud.PerReplicaStatesFetcher$LazyPrsSupplier.lambda$new$0(PerReplicaStatesFetcher.java:62)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at app//org.apache.solr.common.cloud.DocCollection$PrsSupplier.get(DocCollection.java:515)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at app//org.apache.solr.common.cloud.Replica.isLeader(Replica.java:314)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at app//org.apache.solr.common.cloud.Slice.findLeader(Slice.java:242)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at app//org.apache.solr.common.cloud.Slice.setPrsSupplier(Slice.java:56)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at app//org.apache.solr.common.cloud.DocCollection.&amp;lt;init&amp;gt;(DocCollection.java:123)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at app//org.apache.solr.common.cloud.ClusterState.collectionFromObjects(ClusterState.java:305)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at app//org.apache.solr.common.cloud.ClusterState.createFromCollectionMap(ClusterState.java:254)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at app//org.apache.solr.client.solrj.impl.ZkClientClusterStateProvider.createFromJsonSupportingLegacyConfigName(ZkClientClusterStateProvider.java:117)&lt;/tt&gt;&lt;br/&gt;
&lt;tt&gt;&#160; &#160; at app//org.apache.solr.common.cloud.ZkStateReader.fetchCollectionState(ZkStateReader.java:1695)&lt;/tt&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13528507">SOLR-16701</key>
            <summary>Fetching PRS enabled collection might throw SolrException: Error fetching per-replica-states if the collection is deleted during the fetch</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="1" iconUrl="https://issues.apache.org/jira/images/icons/statuses/open.png" description="The issue is open and ready for the assignee to start work on it.">Open</status>
                    <statusCategory id="2" key="new" colorName="blue-gray"/>
                                    <resolution id="-1">Unresolved</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="patson">Patson Luk</reporter>
                        <labels>
                    </labels>
                <created>Tue, 14 Mar 2023 21:03:04 +0000</created>
                <updated>Fri, 17 Oct 2025 20:05:05 +0000</updated>
                                            <version>10.0</version>
                                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="3600">1h</timespent>
                                <comments>
                            <comment id="17768188" author="jira-bot" created="Sat, 23 Sep 2023 00:21:54 +0000"  >&lt;p&gt;Commit f22a51cc64f83f7b1268d9f3a4c50e36249bdd87 in solr&apos;s branch refs/heads/main from patsonluk&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=f22a51cc64f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=f22a51cc64f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16701&quot; title=&quot;Fetching PRS enabled collection might throw SolrException: Error fetching per-replica-states if the collection is deleted during the fetch&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16701&quot;&gt;SOLR-16701&lt;/a&gt;: Race condition on PRS enabled collection deletion (#1460)&lt;/p&gt;
</comment>
                            <comment id="17768189" author="jira-bot" created="Sat, 23 Sep 2023 00:46:59 +0000"  >&lt;p&gt;Commit f1ba2c2cb8050ad958326141d86e573a28ab0516 in solr&apos;s branch refs/heads/branch_9x from patsonluk&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=f1ba2c2cb80&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=f1ba2c2cb80&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16701&quot; title=&quot;Fetching PRS enabled collection might throw SolrException: Error fetching per-replica-states if the collection is deleted during the fetch&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16701&quot;&gt;SOLR-16701&lt;/a&gt;: Race condition on PRS enabled collection deletion (#1460)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit f22a51cc64f83f7b1268d9f3a4c50e36249bdd87)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 7 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1gkzc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>