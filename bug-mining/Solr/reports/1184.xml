<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:33:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4223] jetty8 with solr4.0: In jetty.xml maxFormContentSize configuration needs Fixing</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4223</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;In jetty.xml, the cofiguration to set the maximum form content size does not work, because jetty contextHandler reads System property org.eclipse.jetty.server.Request.maxFormContentSize.&lt;/p&gt;

&lt;p&gt;In CotextHandler.java line 137, the method call &quot;Integer.getInteger(&quot;org.eclipse.jetty.server.Request.maxFormContentSize&quot;,200000).intValue();&quot; returns always the default value 200000 regardless what is set below.&lt;/p&gt;

&lt;p&gt;So instead of:&lt;br/&gt;
&amp;lt;Call name=&quot;setAttribute&quot;&amp;gt;&lt;br/&gt;
   &amp;lt;Arg&amp;gt;org.eclipse.jetty.server.Request.maxFormContentSize&amp;lt;/Arg&amp;gt;&lt;br/&gt;
   &amp;lt;Arg&amp;gt;400000&amp;lt;/Arg&amp;gt;&lt;br/&gt;
&amp;lt;/Call&amp;gt;&lt;/p&gt;

&lt;p&gt;Replace with: &lt;br/&gt;
&amp;lt;Call class=&quot;java.lang.System&quot; name=&quot;setProperty&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;Arg&amp;gt;org.eclipse.jetty.server.Request.maxFormContentSize&amp;lt;/Arg&amp;gt;&lt;br/&gt;
    &amp;lt;Arg&amp;gt;400000&amp;lt;/Arg&amp;gt;&lt;br/&gt;
&amp;lt;/Call&amp;gt;&lt;/p&gt;

&lt;p&gt;PS:&lt;br/&gt;
There are other ways to set this config limit in commandline like -Dorg.eclipse.jetty.server.Request.maxFormContentSize=700000 or in web-jetty.xml which works fine.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12624808">SOLR-4223</key>
            <summary>jetty8 with solr4.0: In jetty.xml maxFormContentSize configuration needs Fixing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="vnathan">Nathan Visagan</reporter>
                        <labels>
                            <label>configuration</label>
                    </labels>
                <created>Thu, 20 Dec 2012 12:42:17 +0000</created>
                <updated>Mon, 9 May 2016 18:46:29 +0000</updated>
                            <resolved>Mon, 24 Dec 2012 21:27:49 +0000</resolved>
                                    <version>4.0</version>
                                    <fixVersion>4.1</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>search</component>
                    <component>Tests</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13537002" author="vnathan" created="Thu, 20 Dec 2012 12:50:39 +0000"  >&lt;p&gt;This has been already raised in the comments of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3159&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-3159&lt;/a&gt;&lt;br/&gt;
 But still unresolved.&lt;/p&gt;</comment>
                            <comment id="13537019" author="shalinmangar" created="Thu, 20 Dec 2012 13:42:39 +0000"  >&lt;p&gt;This should also work.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;Call name=&lt;span class=&quot;code-quote&quot;&gt;&quot;setMaxFormContentSize&quot;&lt;/span&gt;&amp;gt;
&amp;lt;Arg&amp;gt;400000&amp;lt;/Arg&amp;gt;
&amp;lt;/Call&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can you verify?&lt;/p&gt;</comment>
                            <comment id="13537025" author="vnathan" created="Thu, 20 Dec 2012 13:59:08 +0000"  >&lt;p&gt;It does not work in jetty.xml.&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;Call name=&lt;span class=&quot;code-quote&quot;&gt;&quot;setMaxFormContentSize&quot;&lt;/span&gt;&amp;gt;
&amp;lt;Arg&amp;gt;400000&amp;lt;/Arg&amp;gt;
&amp;lt;/Call&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;No method called setMaxFormContentSize is found in class org.eclipse.jetty.server.Server&lt;br/&gt;
But you can do &lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;Configure class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.eclipse.jetty.webapp.WebAppContext&quot;&lt;/span&gt;&amp;gt;
  &amp;lt;Set name=&lt;span class=&quot;code-quote&quot;&gt;&quot;maxFormContentSize&quot;&lt;/span&gt;&amp;gt;400000&amp;lt;/Set&amp;gt;
&amp;lt;/Configure&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt; 
&lt;p&gt;in web-jetty.xml. But this is a setting file in WEB-INF folder which can override the settings mentioned in jetty.xml.&lt;/p&gt;</comment>
                            <comment id="13537243" author="thetaphi" created="Thu, 20 Dec 2012 18:38:48 +0000"  >&lt;p&gt;Why do we need to set this at all?&lt;br/&gt;
We read POST content by an InputStream, but we are never interested in the contents interpreted as form-content at all?&lt;/p&gt;</comment>
                            <comment id="13537264" author="vnathan" created="Thu, 20 Dec 2012 19:02:00 +0000"  >&lt;p&gt;This happens when I submit a query&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;curl -X POST -d @query.txt http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8787/solr/select&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;query.txt is the file containg the query&lt;/p&gt;</comment>
                            <comment id="13537765" author="dancollins" created="Fri, 21 Dec 2012 09:10:29 +0000"  >&lt;p&gt;As nathan says we are seeing errors in Solr, such as:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;05:53:44 newssolr:ERROR o.a.solr.servlet.SolrDispatchFilter - &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;:java.lang.IllegalStateException: Form too large348594&amp;gt;200000
05:53:44 newssolr:~at org.eclipse.jetty.server.Request.extractParameters(Request.java:285)
05:53:44 newssolr:~at org.eclipse.jetty.server.Request.getParameterMap(Request.java:711)
05:53:44 newssolr:~at org.apache.solr.request.ServletSolrParams.&amp;lt;init&amp;gt;(ServletSolrParams.java:29)
05:53:44 newssolr:~at org.apache.solr.servlet.StandardRequestParser.parseParamsAndFillStreams(SolrRequestParsers.java:394)
05:53:44 newssolr:~at org.apache.solr.servlet.SolrRequestParsers.parse(SolrRequestParsers.java:115)
05:53:44 newssolr:~at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:260)
05:53:44 newssolr:~at org.eclipse.jetty.servlet.ServletHandler$CachedChain.doFilter(ServletHandler.java:1307)
05:53:44 newssolr:~at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:453)
05:53:44 newssolr:~at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:137)
05:53:44 newssolr:~at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:559)
05:53:44 newssolr:~at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:231)
05:53:44 newssolr:~at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1072)
05:53:44 newssolr:~at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:382)
05:53:44 newssolr:~at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:193)
05:53:44 newssolr:~at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1006)
05:53:44 newssolr:~at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:135)
05:53:44 newssolr:~at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:255)
05:53:44 newssolr:~at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:154)
05:53:44 newssolr:~at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:116)
05:53:44 newssolr:~at org.eclipse.jetty.server.Server.handle(Server.java:365)
05:53:44 newssolr:~at org.eclipse.jetty.server.AbstractHttpConnection.handleRequest(AbstractHttpConnection.java:485)
05:53:44 newssolr:~at org.eclipse.jetty.server.BlockingHttpConnection.handleRequest(BlockingHttpConnection.java:53)
05:53:44 newssolr:~at org.eclipse.jetty.server.AbstractHttpConnection.headerComplete(AbstractHttpConnection.java:926)
05:53:44 newssolr:~at org.eclipse.jetty.server.AbstractHttpConnection$RequestHandler.headerComplete(AbstractHttpConnection.java:988)
05:53:44 newssolr:~at org.eclipse.jetty.http.HttpParser.parseNext(HttpParser.java:642)
05:53:44 newssolr:~at org.eclipse.jetty.http.HttpParser.parseAvailable(HttpParser.java:235)
05:53:44 newssolr:~at org.eclipse.jetty.server.BlockingHttpConnection.handle(BlockingHttpConnection.java:72)
05:53:44 newssolr:~at org.eclipse.jetty.server.bio.SocketConnector$ConnectorEndPoint.run(SocketConnector.java:264)
05:53:44 newssolr:~at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:608)
05:53:44 newssolr:~at org.eclipse.jetty.util.thread.QueuedThreadPool$3.run(QueuedThreadPool.java:543)
05:53:44 newssolr:~at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:619)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;We have very long queries (we are testing the XML parser) so we POST data instead of GET.&lt;/p&gt;</comment>
                            <comment id="13537773" author="elyograg" created="Fri, 21 Dec 2012 09:34:40 +0000"  >&lt;p&gt;Running a very recent branch_4x.  I have this in jetty.xml:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;&amp;lt;Configure id=&quot;Server&quot; class=&quot;org.eclipse.jetty.server.Server&quot;&amp;gt;

    &amp;lt;!-- Increase the maximum POST size to 1 MB to be able to handle large shard requests --&amp;gt;
    &amp;lt;Call name=&quot;setAttribute&quot;&amp;gt;
      &amp;lt;Arg&amp;gt;org.eclipse.jetty.server.Request.maxFormContentSize&amp;lt;/Arg&amp;gt;
      &amp;lt;Arg&amp;gt;1048576&amp;lt;/Arg&amp;gt;
    &amp;lt;/Call&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;By artificially making my code add 200000 spaces to a deleteByQuery, I duplicated this issue:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR - 2012-12-21 02:29:00.108; org.apache.solr.common.SolrException; null:java.lang.IllegalStateException: Form too large200077&amp;gt;200000
        at org.eclipse.jetty.server.Request.extractParameters(Request.java:326)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13538648" author="hossman" created="Sat, 22 Dec 2012 02:23:40 +0000"  >&lt;p&gt;As noted in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3159&quot; title=&quot;Upgrade to Jetty 8&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3159&quot;&gt;&lt;del&gt;SOLR-3159&lt;/del&gt;&lt;/a&gt;, we&apos;re already using hte jetty recommended method for &quot;Changing the Maximum Form Size for All Apps on a Server&quot; &amp;#8211; except that apparently that doesn&apos;t actually work.&lt;/p&gt;

&lt;p&gt;The attached patch seems to fix this by setting it in the solr context file &amp;#8211; i was hoping to write a junit test to sanity check it moving forward, but all the solr example tests use the &quot;JettySolrRunner&quot; to test out hte &lt;em&gt;solr&lt;/em&gt; example configs in a jetty instance wired via java &amp;#8211; they weren&apos;t designed to test the example &lt;em&gt;jetty&lt;/em&gt; configs.&lt;/p&gt;</comment>
                            <comment id="13539079" author="elyograg" created="Sun, 23 Dec 2012 19:45:02 +0000"  >&lt;p&gt;I filed a matching bug against the jetty project.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://bugs.eclipse.org/bugs/show_bug.cgi?id=397130&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://bugs.eclipse.org/bugs/show_bug.cgi?id=397130&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13539322" author="commit-tag-bot" created="Mon, 24 Dec 2012 21:10:34 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;trunk commit&amp;#93;&lt;/span&gt; Shalin Shekhar Mangar&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1425683&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1425683&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4223&quot; title=&quot;jetty8 with solr4.0: In jetty.xml maxFormContentSize configuration needs Fixing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4223&quot;&gt;&lt;del&gt;SOLR-4223&lt;/del&gt;&lt;/a&gt;: &quot;maxFormContentSize&quot; in jetty.xml is not picked up by jetty 8&lt;br/&gt;
  so set it via solr webapp context file&lt;/p&gt;</comment>
                            <comment id="13539323" author="shalinmangar" created="Mon, 24 Dec 2012 21:27:49 +0000"  >&lt;p&gt;Committed Hoss&apos;s patch in trunk and branch_4x.&lt;/p&gt;</comment>
                            <comment id="13539324" author="commit-tag-bot" created="Mon, 24 Dec 2012 21:28:18 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Shalin Shekhar Mangar&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1425684&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1425684&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4223&quot; title=&quot;jetty8 with solr4.0: In jetty.xml maxFormContentSize configuration needs Fixing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4223&quot;&gt;&lt;del&gt;SOLR-4223&lt;/del&gt;&lt;/a&gt;: &quot;maxFormContentSize&quot; in jetty.xml is not picked up by jetty 8&lt;br/&gt;
  so set it via solr webapp context file&lt;/p&gt;</comment>
                            <comment id="13545905" author="elyograg" created="Mon, 7 Jan 2013 14:14:19 +0000"  >&lt;p&gt;Just received an email from eclipse bugzilla - a fix for the jetty bug will be in 8.1.9.&lt;/p&gt;</comment>
                            <comment id="13545920" author="thetaphi" created="Mon, 7 Jan 2013 14:36:21 +0000"  >&lt;p&gt;Hi,&lt;br/&gt;
I am not sure, but this problem was fixed in Solr by my commit yesterday: &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4265&quot; title=&quot;Fix decoding of GET/POST parameters for servlet containers with non-UTF-8 URL parsing (Tomcat)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4265&quot;&gt;&lt;del&gt;SOLR-4265&lt;/del&gt;&lt;/a&gt; (solr no longer uses ServletRequest.getParameter*() at all, it parses the POST contents by itsself using an own UTF-8 compatible parser). The above settings are affecting POST, right? Because GET URLs are still limited to maximum URL length, right?&lt;/p&gt;

&lt;p&gt;The maximum length inside the default Solr config file for formdata sent through POST is now 2048 KiB ! You can raise it easily using solrconfig.xml. There is no config needed anymore in Solr&apos;s web.xml/jetty config, I did not know there were changes in Solr&apos;s web.xml about this. We should remove them now.&lt;/p&gt;

&lt;p&gt;See also CHANGES.txt and Solr Wiki about Tomcat configuration.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                                                <inwardlinks description="is superceded by">
                                        <issuelink>
            <issuekey id="12626085">SOLR-4265</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12562203" name="SOLR-4223.patch" size="1643" author="hossman" created="Sat, 22 Dec 2012 02:23:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>301316</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 46 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i16rmv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>247609</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>