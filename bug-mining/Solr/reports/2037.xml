<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:55:23 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-6381] TIKA Language Processor tests does not work with Java 9</title>
                <link>https://issues.apache.org/jira/browse/SOLR-6381</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I am currently doing tests with Java 9 build 26. It looks like everything works, but the TIKA Language Processor Test Suite throws a SecurityException because of:&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://hg.openjdk.java.net/jdk9/jdk9/jdk/rev/48af79ee59bb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://hg.openjdk.java.net/jdk9/jdk9/jdk/rev/48af79ee59bb&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;This was added to Java 9 to prevent reflective access to some fields in java.lang.Class.&lt;/p&gt;

&lt;p&gt;I have no idea why TIKA or this Solr contrib wants to access the &quot;classLoader&quot; private field with reflective access. Maybe it has something to do with the test framework and RAM accounting, maybe &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dweiss&quot; class=&quot;user-hover&quot; rel=&quot;dweiss&quot;&gt;dweiss&lt;/a&gt; knows more. The stack trace says nothing to me, looks like a separate thread outside the test runner.&lt;/p&gt;

&lt;p&gt;Maybe some class in LaguageProcessor has a static field referring to a class, so it is used for RAM accounting...:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;-test:
   [junit4] &amp;lt;JUnit4&amp;gt; says salut! Master seed: A9C182BC3E2868C4
   [junit4] Your default console&apos;s encoding may not display certain unicode glyphs: windows-1252
   [junit4] Executing 2 suites with 2 JVMs.
   [junit4] 
   [junit4] Started J0 PID(9336@VEGA).
   [junit4] Started J1 PID(2092@VEGA).
   [junit4] Suite: org.apache.solr.update.processor.LangDetectLanguageIdentifierUpdateProcessorFactoryTest
   [junit4]   2&amp;gt; Creating dataDir: C:\Users\Uwe Schindler\Projects\lucene\trunk-lusolr1\solr\build\contrib\solr-langid\test\J1\.\temp\solr.update.processor.LangDetectLanguageIdentifierUpdateProcessorFactoryTest-A9C182BC3E2868C4-001\init-core-data-001
   [junit4]   2&amp;gt; log4j:WARN No appenders could be found for logger (org.apache.solr.SolrTestCaseJ4).
   [junit4]   2&amp;gt; log4j:WARN Please initialize the log4j system properly.
   [junit4]   2&amp;gt; log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
   [junit4]   2&amp;gt; NOTE: test params are: codec=Lucene41, sim=RandomSimilarityProvider(queryNorm=false,coord=crazy): {}, locale=en_NZ, timezone=Etc/GMT+6
   [junit4]   2&amp;gt; NOTE: Windows 7 6.1 amd64/Oracle Corporation 1.9.0-ea (64-bit)/cpus=8,threads=1,free=134364528,total=199753728
   [junit4]   2&amp;gt; NOTE: All tests run in this JVM: [LangDetectLanguageIdentifierUpdateProcessorFactoryTest]
   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=LangDetectLanguageIdentifierUpdateProcessorFactoryTest -Dtests.seed=A9C182BC3E2868C4 -Dtests.locale=en_NZ -Dtests.timezone=Etc/GMT+6 -Dtests.file.encoding=UTF-8
   [junit4] ERROR   0.00s J1 | LangDetectLanguageIdentifierUpdateProcessorFactoryTest (suite) &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.SecurityException: Cannot make java.lang.Class.classLoader accessible
   [junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([A9C182BC3E2868C4]:0)
   [junit4]    &amp;gt; 	at java.lang.reflect.AccessibleObject.setAccessible0(AccessibleObject.java:147)
   [junit4]    &amp;gt; 	at java.lang.reflect.AccessibleObject.setAccessible(AccessibleObject.java:129)
   [junit4]    &amp;gt; 	at java.lang.Thread.run(Thread.java:745)
   [junit4] Completed on J1 in 7.35s, 9 tests, 1 error &amp;lt;&amp;lt;&amp;lt; FAILURES!
   [junit4] 
   [junit4] Suite: org.apache.solr.update.processor.TikaLanguageIdentifierUpdateProcessorFactoryTest
   [junit4]   2&amp;gt; Creating dataDir: C:\Users\Uwe Schindler\Projects\lucene\trunk-lusolr1\solr\build\contrib\solr-langid\test\J0\.\temp\solr.update.processor.TikaLanguageIdentifierUpdateProcessorFactoryTest-A9C182BC3E2868C4-001\init-core-data-001
   [junit4]   2&amp;gt; log4j:WARN No appenders could be found for logger (org.apache.solr.SolrTestCaseJ4).
   [junit4]   2&amp;gt; log4j:WARN Please initialize the log4j system properly.
   [junit4]   2&amp;gt; log4j:WARN See http://logging.apache.org/log4j/1.2/faq.html#noconfig for more info.
   [junit4]   2&amp;gt; NOTE: test params are: codec=FastCompressingStoredFields(storedFieldsFormat=CompressingStoredFieldsFormat(compressionMode=FAST, chunkSize=185), termVectorsFormat=CompressingTermVectorsFormat(compressionMode=FAST, chunkSize=185)), sim=RandomSimilarityProvider(queryNorm=true,coord=no): {}, locale=hu, timezone=Australia/ACT
   [junit4]   2&amp;gt; NOTE: Windows 7 6.1 amd64/Oracle Corporation 1.9.0-ea (64-bit)/cpus=8,threads=1,free=90090688,total=200278016
   [junit4]   2&amp;gt; NOTE: All tests run in this JVM: [TikaLanguageIdentifierUpdateProcessorFactoryTest]
   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=TikaLanguageIdentifierUpdateProcessorFactoryTest -Dtests.seed=A9C182BC3E2868C4 -Dtests.locale=hu -Dtests.timezone=Australia/ACT -Dtests.file.encoding=UTF-8
   [junit4] ERROR   0.00s J0 | TikaLanguageIdentifierUpdateProcessorFactoryTest (suite) &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.SecurityException: Cannot make java.lang.Class.classLoader accessible
   [junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([A9C182BC3E2868C4]:0)
   [junit4]    &amp;gt; 	at java.lang.reflect.AccessibleObject.setAccessible0(AccessibleObject.java:147)
   [junit4]    &amp;gt; 	at java.lang.reflect.AccessibleObject.setAccessible(AccessibleObject.java:129)
   [junit4]    &amp;gt; 	at java.lang.Thread.run(Thread.java:745)
   [junit4] Completed on J0 in 7.63s, 9 tests, 1 error &amp;lt;&amp;lt;&amp;lt; FAILURES!
   [junit4] 
   [junit4] 
   [junit4] Tests with failures:
   [junit4]   - org.apache.solr.update.processor.LangDetectLanguageIdentifierUpdateProcessorFactoryTest (suite)
   [junit4]   - org.apache.solr.update.processor.TikaLanguageIdentifierUpdateProcessorFactoryTest (suite)
   [junit4] 
   [junit4] 
   [junit4] JVM J0:     0.74 ..     9.37 =     8.63s
   [junit4] JVM J1:     0.74 ..     9.32 =     8.58s
   [junit4] Execution time total: 9.38 sec.
   [junit4] Tests summary: 2 suites, 18 tests, 2 suite-level errors
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12734466">SOLR-6381</key>
            <summary>TIKA Language Processor tests does not work with Java 9</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="uschindler">Uwe Schindler</assignee>
                                    <reporter username="uschindler">Uwe Schindler</reporter>
                        <labels>
                            <label>Java9</label>
                    </labels>
                <created>Fri, 15 Aug 2014 17:38:01 +0000</created>
                <updated>Mon, 9 May 2016 18:43:50 +0000</updated>
                            <resolved>Fri, 15 Aug 2014 21:17:53 +0000</resolved>
                                                    <fixVersion>4.10</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>contrib - LangId</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                                                            <comments>
                            <comment id="14098806" author="thetaphi" created="Fri, 15 Aug 2014 17:42:05 +0000"  >&lt;p&gt;This must be the RAM accounting, because the classLoader private field is new in Java 9 (added for speed). So its for sure the RAM accounting that enumerates all fields of Class to measure them. And this fails with SecurityException. I think &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dweiss&quot; class=&quot;user-hover&quot; rel=&quot;dweiss&quot;&gt;dweiss&lt;/a&gt; should maybe not follow &quot;Class&quot; objects.&lt;/p&gt;</comment>
                            <comment id="14098863" author="jira-bot" created="Fri, 15 Aug 2014 18:12:28 +0000"  >&lt;p&gt;Commit 1618252 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;thetaphi&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1618252&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1618252&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6381&quot; title=&quot;TIKA Language Processor tests does not work with Java 9&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6381&quot;&gt;&lt;del&gt;SOLR-6381&lt;/del&gt;&lt;/a&gt;: Fix brokenness with RAM accounting in Java 9 (this is just a workaround for the bug in test framework, but it makes the test behave correct - using static fields here is a bug!)&lt;/p&gt;</comment>
                            <comment id="14098867" author="thetaphi" created="Fri, 15 Aug 2014 18:15:15 +0000"  >&lt;p&gt;I fixed the problem in the test (remove the static fields, which were not needed to be static and removen some other fields). The test was clearly invalid.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dweiss&quot; class=&quot;user-hover&quot; rel=&quot;dweiss&quot;&gt;dweiss&lt;/a&gt;: Should I open another issue to fix the RAM accounting for tests?&lt;/p&gt;</comment>
                            <comment id="14098868" author="jira-bot" created="Fri, 15 Aug 2014 18:15:44 +0000"  >&lt;p&gt;Commit 1618253 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thetaphi&quot; class=&quot;user-hover&quot; rel=&quot;thetaphi&quot;&gt;thetaphi&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1618253&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1618253&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Merged revision(s) 1618252 from lucene/dev/trunk:&lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6381&quot; title=&quot;TIKA Language Processor tests does not work with Java 9&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6381&quot;&gt;&lt;del&gt;SOLR-6381&lt;/del&gt;&lt;/a&gt;: Fix brokenness with RAM accounting in Java 9 (this is just a workaround for the bug in test framework, but it makes the test behave correct - using static fields here is a bug!)&lt;/p&gt;</comment>
                            <comment id="14098998" author="dweiss" created="Fri, 15 Aug 2014 19:41:32 +0000"  >&lt;p&gt;Added a sub-task, thanks for letting me know about it, Uwe!&lt;/p&gt;</comment>
                            <comment id="14099153" author="thetaphi" created="Fri, 15 Aug 2014 21:17:53 +0000"  >&lt;p&gt;I resolve the parent issue.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                            <subtask id="12734503">SOLR-6382</subtask>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>412406</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 14 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1yy33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>412393</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>