<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:44:19 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5580] SOLR-5311 was done without full understanding of the system and must be reverted.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-5580</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;In class org.apache.solr.cloud.Overseer the Line 360:&lt;br/&gt;
---------------------------------------------------------------------&lt;br/&gt;
          if (sliceName !=null &amp;amp;&amp;amp; collectionExists &amp;amp;&amp;amp;  !&quot;true&quot;.equals(state.getCollection(collection).getStr(&quot;autoCreated&quot;))) {&lt;br/&gt;
            Slice slice = state.getSlice(collection, sliceName);&lt;br/&gt;
            if (slice.getReplica(coreNodeName) == null) &lt;/p&gt;
{
              log.info(&quot;core_deleted . Just return&quot;);
              return state;
            }&lt;br/&gt;
          }&lt;br/&gt;
---------------------------------------------------------------------&lt;br/&gt;
the slice needs to be checked null .because when create a new core with both explicite shard and coreNodeName, the state.getSlice(collection, sliceName)  may return a null.So it needs to be checked ,or there will be an NullpointException&lt;br/&gt;
---------------------------------------------------------------------&lt;br/&gt;
          if (sliceName !=null &amp;amp;&amp;amp; collectionExists &amp;amp;&amp;amp;  !&quot;true&quot;.equals(state.getCollection(collection).getStr(&quot;autoCreated&quot;))) {&lt;br/&gt;
            Slice slice = state.getSlice(collection, sliceName);&lt;br/&gt;
            if (slice != null &amp;amp;&amp;amp; slice.getReplica(coreNodeName) == null) {              log.info(&quot;core_deleted . Just return&quot;);              return state;            }
&lt;p&gt;          }&lt;br/&gt;
---------------------------------------------------------------------&lt;/p&gt;</description>
                <environment>&lt;p&gt;OS:Red Hat Enterprise Linux Server release 6.4 (Santiago)&lt;br/&gt;
Software:solr 4.6,&lt;br/&gt;
               jdk:OpenJDK Runtime Environment (rhel-2.3.4.1.el6_3-x86_64)&lt;br/&gt;
                    OpenJDK 64-Bit Server VM (build 23.2-b09, mixed mode)&lt;/p&gt;</environment>
        <key id="12686506">SOLR-5580</key>
            <summary>SOLR-5311 was done without full understanding of the system and must be reverted.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="stanleyyang">YouPeng Yang</reporter>
                        <labels>
                            <label>core</label>
                    </labels>
                <created>Fri, 27 Dec 2013 07:29:16 +0000</created>
                <updated>Mon, 9 May 2016 18:47:29 +0000</updated>
                            <resolved>Mon, 30 Dec 2013 14:55:38 +0000</resolved>
                                    <version>4.6</version>
                                    <fixVersion>4.6.1</fixVersion>
                    <fixVersion>4.7</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="1800">0.5h</timeoriginalestimate>
                            <timeestimate seconds="1800">0.5h</timeestimate>
                                        <comments>
                            <comment id="13858090" author="billnbell" created="Sat, 28 Dec 2013 18:16:52 +0000"  >&lt;p&gt;This looks good to me. I also like the log.info()&lt;/p&gt;</comment>
                            <comment id="13858162" author="markrmiller@gmail.com" created="Sat, 28 Dec 2013 23:13:07 +0000"  >&lt;p&gt;This was introduced by &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="13858163" author="markrmiller@gmail.com" created="Sat, 28 Dec 2013 23:16:28 +0000"  >&lt;p&gt;That whole bit looks silly and dangerous to me. I&apos;m not sure this is the right way to do this check and it seems we should just remove that whole attempt to skip publishing. I don&apos;t think it&apos;s well tested.&lt;/p&gt;</comment>
                            <comment id="13858164" author="jira-bot" created="Sat, 28 Dec 2013 23:19:18 +0000"  >&lt;p&gt;Commit 1553967 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1553967&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1553967&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5580&quot; title=&quot;SOLR-5311 was done without full understanding of the system and must be reverted.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5580&quot;&gt;&lt;del&gt;SOLR-5580&lt;/del&gt;&lt;/a&gt;: NPE when creating a core with both explicit shard and coreNodeName.&lt;/p&gt;</comment>
                            <comment id="13858165" author="jira-bot" created="Sat, 28 Dec 2013 23:20:16 +0000"  >&lt;p&gt;Commit 1553968 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1553968&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1553968&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5580&quot; title=&quot;SOLR-5311 was done without full understanding of the system and must be reverted.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5580&quot;&gt;&lt;del&gt;SOLR-5580&lt;/del&gt;&lt;/a&gt;: NPE when creating a core with both explicit shard and coreNodeName.&lt;/p&gt;</comment>
                            <comment id="13858166" author="jira-bot" created="Sat, 28 Dec 2013 23:21:42 +0000"  >&lt;p&gt;Commit 1553969 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_4_6&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1553969&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1553969&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5580&quot; title=&quot;SOLR-5311 was done without full understanding of the system and must be reverted.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5580&quot;&gt;&lt;del&gt;SOLR-5580&lt;/del&gt;&lt;/a&gt;: NPE when creating a core with both explicit shard and coreNodeName.&lt;/p&gt;</comment>
                            <comment id="13858167" author="markrmiller@gmail.com" created="Sat, 28 Dec 2013 23:22:20 +0000"  >&lt;p&gt;Thanks YouPeng!&lt;/p&gt;</comment>
                            <comment id="13858556" author="jira-bot" created="Mon, 30 Dec 2013 04:28:50 +0000"  >&lt;p&gt;Commit 1554138 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1554138&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1554138&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5580&quot; title=&quot;SOLR-5311 was done without full understanding of the system and must be reverted.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5580&quot;&gt;&lt;del&gt;SOLR-5580&lt;/del&gt;&lt;/a&gt;: Remove more code that is not legal for determining if a core is new or not.&lt;/p&gt;</comment>
                            <comment id="13858557" author="jira-bot" created="Mon, 30 Dec 2013 04:30:55 +0000"  >&lt;p&gt;Commit 1554139 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1554139&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1554139&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5580&quot; title=&quot;SOLR-5311 was done without full understanding of the system and must be reverted.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5580&quot;&gt;&lt;del&gt;SOLR-5580&lt;/del&gt;&lt;/a&gt;: Remove more code that is not legal for determining if a core is new or not.&lt;/p&gt;</comment>
                            <comment id="13858558" author="jira-bot" created="Mon, 30 Dec 2013 04:35:08 +0000"  >&lt;p&gt;Commit 1554140 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_4_6&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1554140&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1554140&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5580&quot; title=&quot;SOLR-5311 was done without full understanding of the system and must be reverted.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5580&quot;&gt;&lt;del&gt;SOLR-5580&lt;/del&gt;&lt;/a&gt;: Remove more code that is not legal for determining if a core is new or not.&lt;/p&gt;</comment>
                            <comment id="13858841" author="noble.paul" created="Mon, 30 Dec 2013 14:49:39 +0000"  >&lt;p&gt;Yes , this is expected to fail. &lt;br/&gt;
But why would anyone create a core with explicit coreNodeName. I wanted that case to be eliminated. &lt;br/&gt;
The idea is to only create the coreNodeName at the Overseer&lt;/p&gt;</comment>
                            <comment id="13858844" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 14:52:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;But why would anyone create a core with explicit coreNodeName&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s a supported feature and you can&apos;t just eliminate it.&lt;/p&gt;</comment>
                            <comment id="13858850" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 14:56:31 +0000"  >&lt;p&gt;If you want to try and introduce this feature go back to the original issue. But please don&apos;t break this yet again. You can&apos;t do what you did, not even close.&lt;/p&gt;</comment>
                            <comment id="13858852" author="noble.paul" created="Mon, 30 Dec 2013 14:57:41 +0000"  >&lt;p&gt;We need to eliminate this. Otherwise there is no other way to implement SLR-5311 . Why do we need this particular usecase?&lt;/p&gt;</comment>
                            <comment id="13858854" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 15:00:42 +0000"  >&lt;p&gt;1. Even if we need to eliminate this, you cannot just eliminate a large feature by introducing buggy code that doesn&apos;t work with it!&lt;/p&gt;

&lt;p&gt;2. -1 on eliminating this! Custom coreNodeName is an explicit and important feature! This is how users can have a SolrCore take over for a replica that has gone away, or move it to a new machine.&lt;/p&gt;

&lt;p&gt;The feature you added does not make sense with the current system. I suggest trying to implement something else correctly in another issue, but as it is, it&apos;s just one big bug with the current system design.&lt;/p&gt;</comment>
                            <comment id="13858857" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 15:03:41 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt; is the one to reopen.&lt;/p&gt;</comment>
                            <comment id="13858858" author="noble.paul" created="Mon, 30 Dec 2013 15:05:12 +0000"  >&lt;p&gt;I don&apos;t understand where is coreNodeName used? If a new core is created with same collection/slice it will join that slice.  the corNodeName is not used internally&lt;/p&gt;</comment>
                            <comment id="13858863" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 15:12:26 +0000"  >&lt;p&gt;If you have 2 replicas and one machine blows up, you now have two replicas registered and one running. If you buy a new machine, you can now tell it to take over for the machine that blew up rather than having a replica in the state that will never come back or having to remove it manually. This is a feature that cannot simply be removed unceremoniously in a point release.&lt;/p&gt;

&lt;p&gt;User coreNodeNames is a current, supported feature...&lt;/p&gt;</comment>
                            <comment id="13858864" author="noble.paul" created="Mon, 30 Dec 2013 15:13:24 +0000"  >&lt;p&gt;Mark, can you explain the difference between creating a core with the combination of collection/slice and collection/slice/coreNodeName ? what is the difference in the behavior ? &lt;/p&gt;</comment>
                            <comment id="13858868" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 15:25:11 +0000"  >&lt;p&gt;You can currently accomplish two things with this feature:&lt;/p&gt;

&lt;p&gt;1. coreNodeNames that suit your taste rather than the generic ones we make up. Not very important, but something users can already be doing.&lt;br/&gt;
2. coreNodeName is the identity in the clusterstate - so you can make a new SolrCore take over for an existing state. Like I described above.&lt;/p&gt;

&lt;p&gt;If we need to do something that conflicts with this feature, we either need to write code to let both things coexist, or we need to deprecate and wait till 5 to remove it or something.&lt;/p&gt;</comment>
                            <comment id="13858877" author="noble.paul" created="Mon, 30 Dec 2013 15:39:53 +0000"  >&lt;p&gt;I didn&apos;t know people were hacking the system this way. I thought nobody used it&lt;/p&gt;

&lt;p&gt;Having said that, let us see what is the solution &lt;/p&gt;


&lt;ul&gt;
	&lt;li&gt;Do we need a way to &apos;replace&apos; a replica. it is just not replacing anything and just creating a new node. It was a hack for not having an ability to delete replicas from clusterstate&lt;/li&gt;
	&lt;li&gt;I think the proper way should be to create new replicas and they can choose to clean up old ones using the API&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5310&quot; title=&quot;Add a collection admin command to remove a replica&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5310&quot;&gt;&lt;del&gt;SOLR-5310&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt; both must be removed together. you can&apos;t remove one and leave the other one&lt;/li&gt;
	&lt;li&gt;I don&apos;t see a clean way to implement &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5310&quot; title=&quot;Add a collection admin command to remove a replica&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5310&quot;&gt;&lt;del&gt;SOLR-5310&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt; without making the clusterstate ugly&lt;/li&gt;
	&lt;li&gt;The coreNodeName is not used anywhere , so is it important (or even desirable ) to have custom coreNodeName ?&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="13858881" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 15:52:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;Do we need a way to &apos;replace&apos; a replica. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It&apos;s just a matter of opinion on whether it&apos;s a hack to have to remove a replica and then add it or let something take over for it. Either method seems like it should reasonably work if you want it to.&lt;/p&gt;

&lt;p&gt;In the longer term, the Collections API should be reasonable for all of this stuff, and eventually we won&apos;t necessarily support manual core manipulation. Until we do, I think this is a good feature.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5310&quot; title=&quot;Add a collection admin command to remove a replica&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5310&quot;&gt;&lt;del&gt;SOLR-5310&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt; both must be removed together. you can&apos;t remove one and leave the other one&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t believe that - it should be fine to still have a command that removes a replica from the clusterstate.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I don&apos;t see a clean way to implement &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5310&quot; title=&quot;Add a collection admin command to remove a replica&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5310&quot;&gt;&lt;del&gt;SOLR-5310&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt; without making the clusterstate ugly&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Then perhaps they should not be implemented and this energy is better spent working towards a fully functional Collections API.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The coreNodeName is not used anywhere , so is it important (or even desirable ) to have custom coreNodeName ?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;uh...yes it is used...&lt;/p&gt;</comment>
                            <comment id="13858888" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 15:59:33 +0000"  >&lt;p&gt;I also thing the approach is not correct in general - even if you didn&apos;t allow a user to specify the coreNodeName, you can&apos;t 100% safely use that information to determine if a core should exist or not.&lt;/p&gt;

&lt;p&gt;The correct approach is to finish the Collections API, which can know if a collection should exist or not.&lt;/p&gt;</comment>
                            <comment id="13858900" author="noble.paul" created="Mon, 30 Dec 2013 16:15:51 +0000"  >&lt;blockquote&gt;&lt;p&gt;It&apos;s just a matter of opinion ....&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, you are right. the point is , I think people don&apos;t really have to think that replicas have a name , they just need to have enough replicas for a given slice. &lt;/p&gt;


&lt;blockquote&gt;&lt;p&gt;I don&apos;t believe that - it should be fine to still have a command that removes a replica from the clusterstate.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The problem is that, If I removed a replica from clusterstate and then the core came up, What is the desired behavior? register the core or unload the core?&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;Then perhaps they should not be implemented and this energy is better spent working towards a fully functional Collections API.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5310&quot; title=&quot;Add a collection admin command to remove a replica&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5310&quot;&gt;&lt;del&gt;SOLR-5310&lt;/del&gt;&lt;/a&gt; is a step towards a fully functional collections API. The use case is, A node went down and I don&apos;t need to replace it with another node because I have enough replicas.  Now I need to clean up the clusterstate .Currently there is no way to achieve it&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;uh...yes it is used...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;,m sorry, I meant it is not used anywhere BY THE USER&lt;/p&gt;

&lt;p&gt;My intent was not to break backcompat . But it happened because I didn&apos;t know this particular usecase. Let us see what is the best solution for this? Let us answer a few questions to ourselves&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;If we are designing the system today which way would you choose? a deletereplica API or a create core API to &apos;replace&apos; a core. So what is the way forward?&lt;/li&gt;
	&lt;li&gt;implement deletereplica API , but make the clusterstate slightly ugly for backcompat&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="13858901" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 16:18:23 +0000"  >&lt;p&gt;If you do want to create some marker that gets saved out so that a SolrCore can track if it had been removed or not, you would need to do it to a spot that is not a user editable param...&lt;/p&gt;

&lt;p&gt;The only reason the previous scheme worked at all is because the coreNodeName is user editable and is saved out to solr.xml - into a user overrideable field. &lt;/p&gt;

&lt;p&gt;You would need to save that information to a system only storage location.&lt;/p&gt;</comment>
                            <comment id="13858902" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 16:20:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;The problem is that, If I removed a replica from clusterstate and then the core came up, What is the desired behavior? register the core or unload the core?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Register the core. If you don&apos;t use the Collections API, the behavior is simple and straightforward. For a much better experience, we should finish the collections api, so we can deprecate dealing with individual cores.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The use case is, A node went down and I don&apos;t need to replace it with another node because I have enough replicas. Now I need to clean up the clusterstate .Currently there is no way to achieve it&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That&apos;s why &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5310&quot; title=&quot;Add a collection admin command to remove a replica&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5310&quot;&gt;&lt;del&gt;SOLR-5310&lt;/del&gt;&lt;/a&gt; still makes sense and should still work fine for this case...&lt;/p&gt;</comment>
                            <comment id="13858906" author="noble.paul" created="Mon, 30 Dec 2013 16:29:30 +0000"  >&lt;blockquote&gt;&lt;p&gt;Register the core. If you don&apos;t use the Collections API, the behavior is simple and straightforward. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The problem is , the deletereplica did not help. The collections api should get importance than cores going up and down. The  reason why I called the deletereplica when the core was down was to avoid having another replica (and to clean up clusterstate) . One of my purpose is defeated&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;For a much better experience, we should finish the collections api&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I completely agree with you. We are pursuing them one by one. One day I want collections API to be the definitive way to achieve almost anything on SolrCloud. So I want collection API&apos;s to take precedence over others&lt;/p&gt;

&lt;p&gt;I think the user has a problem because we didn&apos;t document this new behavior , mea culpa&lt;/p&gt;</comment>
                            <comment id="13858937" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 17:22:26 +0000"  >&lt;blockquote&gt;&lt;p&gt;was down was to avoid having another replica &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, I know why you did it, I&apos;m saying there are many problems with how you went about it. The entire reliance on the coreNodeName is incorrect. Like I said, even if you had said users can&apos;t specify it and ignored back compat, it can&apos;t be in solr.xml then. Your code only worked because it is a user setting that is persisted in solr.xml.&lt;/p&gt;

&lt;p&gt;Your goal is fine, the implementation is all wrong. While it could be corrected, I think it&apos;s much better to push on the collections api, rather than complicate what is now a simple mode that will eventually either become second class or be removed. We should not spend a lot of time making it do what it was not designed for from the start. The plan has always been the Collections API for this type of behavior.&lt;/p&gt;</comment>
                            <comment id="13858945" author="noble.paul" created="Mon, 30 Dec 2013 17:30:32 +0000"  >&lt;p&gt;I didn&apos;t quite get the solr.xml part. It is persisted , right?&lt;/p&gt;

&lt;p&gt;I was essentially trying to have to modes, one is a collection which got &apos;autoCreated&apos; and the other is one which got created thru API ? are you saying se need a 3rd mode?&lt;/p&gt;</comment>
                            <comment id="13858947" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 17:32:47 +0000"  >&lt;p&gt;A setting in solr.xml is user configurable by definition.&lt;/p&gt;</comment>
                            <comment id="13858956" author="noble.paul" created="Mon, 30 Dec 2013 17:51:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;A setting in solr.xml is user configurable by definition.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes, but that is same for every other property like, collection, shard etc . Isn&apos;t this same? anyone editing those properties would end up screwing the cluster itself. But we would expect the data in ZK to be the truth , right?&lt;/p&gt;</comment>
                            <comment id="13858965" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 18:11:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;Isn&apos;t this same?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No...those are user configurable and should be...a user can always enter bad settings...&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;But we would expect the data in ZK to be the truth , right?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No. That is the goal of finishing the Collections API. For the non Collections API, the truth is not currently ZK and it&apos;s not easy to make it so 100% - which is why I keep mentioning the collections API ...&lt;/p&gt;</comment>
                            <comment id="13858968" author="noble.paul" created="Mon, 30 Dec 2013 18:20:43 +0000"  >&lt;blockquote&gt;&lt;p&gt;No...those are user configurable and should be...a user can always enter bad settings...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I agree with you . But what is the harm in making the coreNodeName editable? If he is sure about what he is doing , it will work. If he is fiddling with stuff any of those properties can screw up his system. I really can&apos;t see the difference between someone editing collection, shard, or coreNodeName&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;No. That is the goal of finishing the Collections API.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;If and when we are ready , how do you plan to make the switch? Can we introduce the switch right away, so that the users who want the new way can go that way. &lt;/p&gt;</comment>
                            <comment id="13858970" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 18:26:35 +0000"  >&lt;blockquote&gt;&lt;p&gt;I agree with you . But what is the harm in making the coreNodeName editable? If he is sure about what he is doing , it will work. If he is fiddling with stuff any of those properties can screw up his system. I really can&apos;t see the difference between someone editing collection, shard, or coreNodeName&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;It &lt;b&gt;is&lt;/b&gt; currently editable. The way you did things, you would need it to not be editable. So no way it should be in solr.xml. You can configure a new core in solr.xml and set a shard id and a collection - but now you are going to say you can&apos;t set some of those settings (coreNodeName), we are just storing them there internally and it&apos;s not for you to preconfigure or edit? Now we have some special config in solr.xml that is not for users when everything else is? No way, -1.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;If and when we are ready , how do you plan to make the switch? Can we introduce the switch right away, so that the users who want the new way can go that way.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We will need to support non Collections API for some time. For the Collections API, its just going to become more capable - if it requires it, some of those capabilities will require turning on new options if you are using old config. It will all be pretty easy, other than when and if we drop the non Collections API support entirely. &lt;/p&gt;</comment>
                            <comment id="13858986" author="noble.paul" created="Mon, 30 Dec 2013 18:47:53 +0000"  >&lt;p&gt;I guess you missed something.&lt;/p&gt;

&lt;p&gt;If you added the core through solr.xml it is for a collection that is &apos;autoCreated&apos; . So I enabled this feature only for collections created through collections API. For others the legacy behavior is not altered .So , they are not really editable if the cores are created through API. &lt;/p&gt;

</comment>
                            <comment id="13858992" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 19:01:29 +0000"  >&lt;p&gt;The collections API is not ready for that functionality - you still have to use the collections API in concert with the core admin API to do many things. Until the Collections API can do everything without the core admin API, this feature is a problem.&lt;/p&gt;</comment>
                            <comment id="13858996" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 19:03:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;this feature is a problem.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Or at least the way it was implemented.&lt;/p&gt;</comment>
                            <comment id="13858999" author="noble.paul" created="Mon, 30 Dec 2013 19:07:30 +0000"  >&lt;p&gt;It is OK to use the cor admin API sometimes . It is fine. But editing solr.xml or adding system properties at node startup is something we should actively strive to avoid.&lt;/p&gt;

&lt;p&gt;But here the question is not whether we should use core admin or not. I feel that the API to add a replica on a particular node would be pretty ugly on collections API and it looks more elegant on core admin API. &lt;/p&gt;

&lt;p&gt;I really didn&apos;t want to have a half broken deletereplica API&lt;/p&gt;</comment>
                            <comment id="13859008" author="markrmiller@gmail.com" created="Mon, 30 Dec 2013 19:26:12 +0000"  >&lt;p&gt;The Core Admin also lets you set an initial coreNodeName! And it has the same use case.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;But here the question is not whether we should use core admin or not. I feel that the API to add a replica on a particular node would be pretty ugly on collections API and it looks more elegant on core admin API.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;That needs a discussion in it&apos;s own issue. A lot of things make more sense from a collection perspective (eg, I want to change the replicationFactor). And we need a way to easily distinguish between a operations meant for a Collections API collection and those that are not. How we implement that is still open, but I would initially lean towards making the collections api powerful enough not to need the core admin and then ban it on collection api collections.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I really didn&apos;t want to have a half broken deletereplica API&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;We both want the same functionality - the problem is that it is ahead of it&apos;s time. The way it has been implemented does not jive with the current system. Yes, we need this - but we have to do it right.&lt;/p&gt;</comment>
                            <comment id="13859012" author="noble.paul" created="Mon, 30 Dec 2013 19:31:47 +0000"  >&lt;blockquote&gt;&lt;p&gt;the problem is that it is ahead of it&apos;s time&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;What needs to be done before I can get this in?&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Yes, we need this - but we have to do it right.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;If we do it right how should it look like? We can&apos;t keep it an open item &lt;/p&gt;</comment>
                            <comment id="13859285" author="noble.paul" created="Tue, 31 Dec 2013 03:23:10 +0000"  >&lt;p&gt;My take on this. &lt;/p&gt;

&lt;p&gt;Let&apos;s fix this in a backcompat way so that deletereplica is implemented consistently&lt;/p&gt;</comment>
                            <comment id="13859287" author="markrmiller@gmail.com" created="Tue, 31 Dec 2013 03:26:56 +0000"  >&lt;p&gt;Make another issue please. This is a bug that is assigned to me that I have fixed. Either work on the reopened original issue or make a new one.&lt;/p&gt;

&lt;p&gt;The work necessary to do this feature properly is fairly substantial, and I&apos;ll be releasing this in 4.6.1 any time now.&lt;/p&gt;</comment>
                            <comment id="13859288" author="markrmiller@gmail.com" created="Tue, 31 Dec 2013 03:27:56 +0000"  >&lt;blockquote&gt;&lt;p&gt;What needs to be done before I can get this in?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;m happy to discuss that in the reopen JIRA issue around this feature.&lt;/p&gt;</comment>
                            <comment id="13859338" author="noble.paul" created="Tue, 31 Dec 2013 05:12:09 +0000"  >&lt;p&gt;Mark,&lt;br/&gt;
This issue is about an NPE . If we fix this NPE we should be good to go. The wholesale reverting of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt; is beyond the scope of this issue. &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt; has already been released in 4.6 and reverting that code would be a regression in 4.6.1. &lt;br/&gt;
We can fix the NPE right away and make the core admin API work and this can be closed. I can take care of that right away. If we need a discussion over how the implementation of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt; should be, it can be done after reopening &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13859703" author="markrmiller@gmail.com" created="Tue, 31 Dec 2013 21:23:34 +0000"  >&lt;p&gt;No dude, the description of this issue is just not correct.&lt;/p&gt;

&lt;p&gt;You broke SolrCloud and I won&apos;t allow that code back in. -1, it&apos;s broken. In 4.6.1 we need to remove it.&lt;/p&gt;</comment>
                            <comment id="13859727" author="markrmiller@gmail.com" created="Tue, 31 Dec 2013 21:50:44 +0000"  >&lt;p&gt;The NPE was just a surface bug that a user hit.&lt;/p&gt;

&lt;p&gt;The actual bug here is:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;You cannot count on coreNodeName like &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt; - totally illegal.&lt;/li&gt;
	&lt;li&gt;You cannot use this autoCreated property. Totally illegal in the current system.&lt;/li&gt;
	&lt;li&gt;Cores can stick around, and simply don&apos;t get updates into the cluster state? A lot of ugliness around this...and...&lt;/li&gt;
	&lt;li&gt;In general, this is a hack, half hearted attempt at making ZooKeeper the truth.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;All these issues lead to many bugs.&lt;/p&gt;

&lt;p&gt;There are non buggy, full solutions to making ZooKeeper the truth, and if that is what you are after, we have to do it in a way that is consistent with the current system.&lt;/p&gt;</comment>
                            <comment id="13859828" author="noble.paul" created="Wed, 1 Jan 2014 04:36:25 +0000"  >&lt;p&gt;I think, the core of the issue is whether to have an option of removing a core from the cluster without touching to the node itself?&lt;/p&gt;

&lt;p&gt;If that option can be provided can it be implemented without introducing backward compatibility issues? &lt;/p&gt;

&lt;p&gt;I believe , in a reasonably big cluster,  nobody would want to deal with individual nodes to manage the cluster . So , they would like to go through the API to achieve almost everything.  Do we wish to introduce a new mode for these things?  Or do we want it to be the default mode?              &lt;/p&gt;


&lt;p&gt;If we can implement the new mode without breaking existing features , do we need to introduce a new mode? the reason I&apos;m asking these questions is because users tend to use the default mode assuming that is the best. a new mode is always a problem because that is kind of forking the system. That will be a support nightmare&lt;/p&gt;

&lt;p&gt;Before getting into Implementation details , we need to build consensus on these things first .&lt;/p&gt;</comment>
                            <comment id="13859883" author="noble.paul" created="Wed, 1 Jan 2014 14:33:42 +0000"  >&lt;blockquote&gt;&lt;p&gt;Cores can stick around, and simply don&apos;t get updates into the cluster state?...&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;What do you mean? Cores are removed if they were removed explicitly from clusterstate and they come up again&lt;/p&gt;</comment>
                            <comment id="13859884" author="noble.paul" created="Wed, 1 Jan 2014 14:40:01 +0000"  >&lt;p&gt;I would like to know the what the user was trying to do in this case &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stanleyyang&quot; class=&quot;user-hover&quot; rel=&quot;stanleyyang&quot;&gt;stanleyyang&lt;/a&gt; ? where you trying to create a new core for a coreNodeName that didn&apos;t exist? was the slice present? or were you trying to create that too?&lt;/p&gt;</comment>
                            <comment id="13859885" author="noble.paul" created="Wed, 1 Jan 2014 14:46:10 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I wish to know where all coreNodeName is used by end user&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Replace an existing core with another . It should be working with &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;create a completely new core with a user-specified coreNodeName . It would fail with &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;Is there any other case I am missing?&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="13860123" author="stanleyyang" created="Thu, 2 Jan 2014 10:48:14 +0000"  >&lt;p&gt;Hi&lt;br/&gt;
   The auto created corenodename can not be easy distinguished. We create many cores whose datadir is on hdfs. We need the clear corenodename to make failover quickly when a core was down. . &lt;/p&gt;


&lt;p&gt;&#21457;&#33258;&#25105;&#30340; iPhone&lt;/p&gt;

&lt;p&gt;&#22312; 2014-1-1&#65292;22:40&#65292;&quot;Noble Paul (JIRA)&quot; &amp;lt;jira@apache.org&amp;gt; &#20889;&#36947;&#65306;&lt;/p&gt;
</comment>
                            <comment id="13860127" author="stanleyyang" created="Thu, 2 Jan 2014 10:55:54 +0000"  >&lt;p&gt;By the way. We use the corenodename since the solr 4.4. However things go wrong when we decide to upgrade to 4.6.  &lt;br/&gt;
   It troubles me for a long time. No one gives any help,neither the reference doc nor the CHANGES of solr 4.6 do no make any announcement about the change ,which is bad for users. &lt;/p&gt;

&lt;p&gt;   I even am not clear about what your autocreated check aim at.&lt;/p&gt;


&lt;p&gt;&#21457;&#33258;&#25105;&#30340; iPhone&lt;/p&gt;

&lt;p&gt;&#22312; 2014-1-1&#65292;22:40&#65292;&quot;Noble Paul (JIRA)&quot; &amp;lt;jira@apache.org&amp;gt; &#20889;&#36947;&#65306;&lt;/p&gt;
</comment>
                            <comment id="13860134" author="noble.paul" created="Thu, 2 Jan 2014 11:05:25 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=stanleyyang&quot; class=&quot;user-hover&quot; rel=&quot;stanleyyang&quot;&gt;stanleyyang&lt;/a&gt; what is your normal workflow?&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;how do you create  your collection? I mean what is a typical command to create a collection?&lt;/li&gt;
	&lt;li&gt;what is your typical coreNodeName? How does your specific coreNodeName help you failover quickly?&lt;/li&gt;
	&lt;li&gt;What will happen if a core comes up after you replace it with another? it should be replacing your new core with the old core in that case. How do you deal with that?&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;How about just creating a new core w/o a coreNodeName (only collection name and slice name) ? In that case you never need to worry about coreNodeName at all&lt;/p&gt;</comment>
                            <comment id="13860148" author="stanleyyang" created="Thu, 2 Jan 2014 11:43:50 +0000"  >&lt;p&gt;Hi&lt;/p&gt;

&lt;p&gt;   The create core URL:&lt;br/&gt;
&lt;a href=&quot;http://10.7.23.122:8080/solr/admin/cores?action=CREATE&amp;amp;name=Test1&amp;amp;shard=Test&amp;amp;collection.configName=myconf&amp;amp;schema=schema.xml&amp;amp;config=solrconfigLocal_default.xml&amp;amp;collection=defaultcol&amp;amp;coreNodeName=Test1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://10.7.23.122:8080/solr/admin/cores?action=CREATE&amp;amp;name=Test1&amp;amp;shard=Test&amp;amp;collection.configName=myconf&amp;amp;schema=schema.xml&amp;amp;config=solrconfigLocal_default.xml&amp;amp;collection=defaultcol&amp;amp;coreNodeName=Test1&lt;/a&gt;&lt;br/&gt;
    We do not have the collection created first. Just create a new collection when create the first core of  a collection.&lt;br/&gt;
    We use the corecodename to make distinguish the cores. As I said,the auto created corenodename make it hard to identify which core the datadir belongs to . Especially ,there are a lot of cores.&lt;/p&gt;

&lt;p&gt;      When a core crashed,as only as the data still exists, we can create a new core use the same datadir. It is important when you have a shared storage,such as NSF,even hdfs.&lt;/p&gt;

&lt;p&gt;     The failover we suppose that we can force multi core to share the same data directory. At last , we give up after the some tests . Also, Mr mark miller suggests we should not do that.&lt;/p&gt;


&lt;p&gt;&#21457;&#33258;&#25105;&#30340; iPhone&lt;/p&gt;

&lt;p&gt;&#22312; 2014-1-2&#65292;19:05&#65292;&quot;Noble Paul (JIRA)&quot; &amp;lt;jira@apache.org&amp;gt; &#20889;&#36947;&#65306;&lt;/p&gt;
</comment>
                            <comment id="13860162" author="noble.paul" created="Thu, 2 Jan 2014 12:03:54 +0000"  >&lt;p&gt;OK, Now I see it. &lt;br/&gt;
(Not the solution , but the diagnosis)&lt;br/&gt;
For your usecase,  the collection was created with an older version of Solr. So the , property &apos;autoCreated&apos; is absent from the collection. &lt;/p&gt;

&lt;p&gt;slice would have never been null in a normal case. if you created the system with numShards=x the system would have created shard1 to shardx right away. If it was a custom collection it would have expected you to create the slice first&lt;/p&gt;

&lt;p&gt;Do you have multiple replicas or do you just keep one copy of the index? &lt;br/&gt;
How did naming the coreNodeName &quot;Test1&quot; help you instead of &quot;core_node1&quot; ?  I&apos;m assuming you somehow encode the data dir in the coreNodeName&lt;/p&gt;

&lt;p&gt;If you could encode the data location in coreName itself , it would still work , right?&lt;/p&gt;</comment>
                            <comment id="13860188" author="stanleyyang" created="Thu, 2 Jan 2014 12:51:51 +0000"  >&lt;p&gt;It needs to make clear that ,I create a collection with the new solr 4.6. &lt;br/&gt;
We deploy the new solr 4.6 in tomcat, and just create a new collection and a new core with the same request URL. &lt;br/&gt;
Collections can created when we create a new with no explicit corenodename , I can not find the autocreated property in the collection information on zookeeper.&lt;/p&gt;

&lt;p&gt;    Convenient to manage the core,we would like to identify core with explicit custom shard name, core name ,collection and corecodename.&lt;/p&gt;

&lt;p&gt;  You said that I need to create a slice first which I think is not convenient. As all things go well in the old version. I think with no defend your work maybe make the lose of solr flexibility and the smooth. &lt;/p&gt;

&lt;p&gt; Anyway , we do hope your work keeps the good feature of solr. &lt;br/&gt;
  Another suggestion ,if you make any change about the good charecter of solr ,please give some hints in the reference doc or CHANGES.&lt;/p&gt;

&lt;p&gt;  The last thing ,what is the purpose of the autocreated check . The autocreated property can not be find in solr. I have checked the data in zookeeper.  &lt;/p&gt;



&lt;p&gt;Oh, even there are no any information about the change. &lt;/p&gt;


&lt;p&gt;&#21457;&#33258;&#25105;&#30340; iPhone&lt;/p&gt;

&lt;p&gt;&#22312; 2014-1-2&#65292;20:04&#65292;&quot;Noble Paul (JIRA)&quot; &amp;lt;jira@apache.org&amp;gt; &#20889;&#36947;&#65306;&lt;/p&gt;
</comment>
                            <comment id="13860191" author="noble.paul" created="Thu, 2 Jan 2014 13:01:07 +0000"  >&lt;blockquote&gt;&lt;p&gt;You said that I need to create a slice first which I think is not convenient&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No I didn&apos;t say that. Not creating the slice was fine. I&apos;m saying if you used the collection create api it would create the slices upfront.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;The last thing ,what is the purpose of the autocreated check &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The autoCreated flag was added to differentiate between a collection created using collections API and another one created automatically as a part of a core creation&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Oh, even there are no any information about the change.&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;It was designed to work for your usecases . This is a regression . I need to test it with your usecase before I can comment further&lt;/p&gt;
</comment>
                            <comment id="13860266" author="noble.paul" created="Thu, 2 Jan 2014 15:27:57 +0000"  >&lt;p&gt;The &apos;autoCreated&apos; attribute was missing .&lt;/p&gt;</comment>
                            <comment id="13860276" author="markrmiller@gmail.com" created="Thu, 2 Jan 2014 15:43:46 +0000"  >&lt;p&gt;Like I&apos;ve said in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5311&quot; title=&quot;Avoid registering replicas which are removed &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5311&quot;&gt;&lt;del&gt;SOLR-5311&lt;/del&gt;&lt;/a&gt;, autoCreated is illegal in the current system. Cores created by the Collections API must currently be the same as those created by the Core Admin API or preconfigured.&lt;/p&gt;

&lt;p&gt;autoCreated cannot exist yet, and when it can, it can&apos;t be used by default, it must be a new mode. &lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12687490">SOLR-5609</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12672789">SOLR-5311</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12621085" name="SOLR-5580.patch" size="1315" author="noble.paul" created="Thu, 2 Jan 2014 15:27:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>365497</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 46 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1qzy7:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>365798</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>