<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:16:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9494] CollapseQParserPlugin doesn&apos;t propagate needsScores() correctly</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9494</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;CollapseQParserPlugin internally has a number of Lucene Collector implementations, all of which extend Solr DelegatingCollector which provides a default implementation of the method needsScores() based on what it&apos;s delegating too.  But Collapsing&apos;s collectors fail to consider that these collectors &lt;em&gt;themselves&lt;/em&gt; sometimes need the score, irrespective of wether or not a delegate might.&lt;/p&gt;

&lt;p&gt;In most cases nobody would notice this bug because most queries don&apos;t seem to care.  However, SpanQueries are cranky about this, which will either throw an AssertionError or NPE if you ask for a score without saying in advance you wanted them.&lt;/p&gt;

&lt;p&gt;I have a patch forthcoming, but am having trouble ATM reproducing to create a test.  The most straight-forward test doesn&apos;t trip it.  I have a failing test in a client environment, and a patch that fixes it.  Reproducing seems to involve a cached query somehow.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13003966">SOLR-9494</key>
            <summary>CollapseQParserPlugin doesn&apos;t propagate needsScores() correctly</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dsmiley">David Smiley</assignee>
                                    <reporter username="dsmiley">David Smiley</reporter>
                        <labels>
                    </labels>
                <created>Fri, 9 Sep 2016 20:38:02 +0000</created>
                <updated>Sat, 8 Jun 2019 15:31:46 +0000</updated>
                            <resolved>Sun, 11 Sep 2016 19:02:06 +0000</resolved>
                                                    <fixVersion>6.2.1</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15482176" author="dsmiley" created="Sun, 11 Sep 2016 18:13:40 +0000"  >&lt;p&gt;Attached is the patch with a test.&lt;/p&gt;

&lt;p&gt;In addition to the SpanQuery, the test needed to incorporate facets (to thus need a DocSet), have caches, and to execute the query twice to execute a different code path the 2nd go around for a successful cache retrieval.&lt;/p&gt;

&lt;p&gt;I also removed the boolean field cscore which is redundant with boolean needsScore.  if cscore is true, needsScore certainly is too since the existence of cscore is one of the reasons needsScore can be set to true.&lt;/p&gt;

&lt;p&gt;I plan to commit this once tests pass; it takes awhile.&lt;/p&gt;</comment>
                            <comment id="15482199" author="jira-bot" created="Sun, 11 Sep 2016 18:29:35 +0000"  >&lt;p&gt;Commit d2fcc3dd7102dca1c4161488a34523df8df9880b in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d2fcc3d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d2fcc3d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9494&quot; title=&quot;CollapseQParserPlugin doesn&amp;#39;t propagate needsScores() correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9494&quot;&gt;&lt;del&gt;SOLR-9494&lt;/del&gt;&lt;/a&gt;: CollapseQParser&apos;s collectors should override needsScores(); can trigger exceptions&lt;br/&gt;
Also, field cscore was not needed.&lt;/p&gt;</comment>
                            <comment id="15482202" author="jira-bot" created="Sun, 11 Sep 2016 18:30:46 +0000"  >&lt;p&gt;Commit a029c8ede6ae625932a87c38ca7fca1c4402c48f in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=a029c8e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=a029c8e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9494&quot; title=&quot;CollapseQParserPlugin doesn&amp;#39;t propagate needsScores() correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9494&quot;&gt;&lt;del&gt;SOLR-9494&lt;/del&gt;&lt;/a&gt;: CollapseQParser&apos;s collectors should override needsScores(); can trigger exceptions&lt;br/&gt;
Also, field cscore was not needed.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit d2fcc3d)&lt;/p&gt;</comment>
                            <comment id="15482230" author="jira-bot" created="Sun, 11 Sep 2016 18:55:58 +0000"  >&lt;p&gt;Commit 272ceb7c03618b5343ac974e7d54673c8e658121 in lucene-solr&apos;s branch refs/heads/branch_6_2 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=272ceb7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=272ceb7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9494&quot; title=&quot;CollapseQParserPlugin doesn&amp;#39;t propagate needsScores() correctly&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9494&quot;&gt;&lt;del&gt;SOLR-9494&lt;/del&gt;&lt;/a&gt;: CollapseQParser&apos;s collectors should override needsScores(); can trigger exceptions&lt;br/&gt;
Also, field cscore was not needed.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit a029c8e)&lt;/p&gt;</comment>
                            <comment id="15508536" author="shalinmangar" created="Wed, 21 Sep 2016 03:03:18 +0000"  >&lt;p&gt;Closing after 6.2.1 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13004174">SOLR-9501</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12827932" name="SOLR_9494__CollapseQParser_s_collectors_should_override_needsScores__.patch" size="4132" author="dsmiley" created="Sun, 11 Sep 2016 18:13:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 9 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i33gmv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>