<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:39:56 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-13674] NodeAddedTrigger does not support configuration of replica type hint</title>
                <link>https://issues.apache.org/jira/browse/SOLR-13674</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The current code org.apache.solr.cloud.autoscaling.ComputePlanAction#getNodeAddedSuggester only sets COLL_SHARD hint, as a result any added replica will be NRT one.&lt;/p&gt;

&lt;p&gt;Our current setup has TLOG nodes on physical hardware and PULL nodes on k8s that are recycled periodically. An attempt to add those will bring the nodes in the cluster as NRT one.&lt;/p&gt;

&lt;p&gt;The root cause is org.apache.solr.client.solrj.cloud.autoscaling.AddReplicaSuggester#tryEachNode that expects to find the hint REPLICATYPE and defaults to NRT one.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13248424">SOLR-13674</key>
            <summary>NodeAddedTrigger does not support configuration of replica type hint</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="ishaigor">Irena Shaigorodsky</reporter>
                        <labels>
                    </labels>
                <created>Thu, 1 Aug 2019 19:56:11 +0000</created>
                <updated>Thu, 12 May 2022 00:27:02 +0000</updated>
                            <resolved>Thu, 8 Aug 2019 09:52:28 +0000</resolved>
                                    <version>7.6</version>
                                    <fixVersion>8.3</fixVersion>
                    <fixVersion>9.0</fixVersion>
                                    <component>AutoScaling</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16899345" author="ishaigor" created="Sat, 3 Aug 2019 03:40:40 +0000"  >&lt;p&gt;&lt;a href=&quot;https://github.com/apache/lucene-solr/pull/821&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/821&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="16899877" author="shalinmangar" created="Mon, 5 Aug 2019 08:09:20 +0000"  >&lt;p&gt;Thank you &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ishaigor&quot; class=&quot;user-hover&quot; rel=&quot;ishaigor&quot;&gt;ishaigor&lt;/a&gt; for the PR. The changes look good except that the new test fails with:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
82359 ERROR (OverseerThreadFactory-437-thread-4-processing-n:127.0.0.1:43511_solr) [n:127.0.0.1:43511_solr     ] o.a.s.c.a.c.OverseerCollectionMessageHandler Collection: testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0 operation: create failed:org.apache.solr.common.SolrException: Error getting replica locations :  No node can satisfy the rules &lt;span class=&quot;code-quote&quot;&gt;&quot;[{replica=#ALL, type=PULL, sysprop.solrNodeType=PULL, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {replica=#ALL, type=TLOG, sysprop.solrNodeType=TLOG, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {replica=#ALL, type=NRT, sysprop.solrNodeType=NRT, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {nodeRole=overseer, replica=0, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {cores=&amp;lt;6, node=#ANY}, {replica=&amp;lt;2, shard=#EACH, node=#ANY, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}] More details from logs in node : 127.0.0.1:43511_solr, errorId : AutoScaling.error.diagnostics.14915037535846&quot;&lt;/span&gt;
	at org.apache.solr.cloud.api.collections.CreateCollectionCmd.call(CreateCollectionCmd.java:195)
	at org.apache.solr.cloud.api.collections.OverseerCollectionMessageHandler.processMessage(OverseerCollectionMessageHandler.java:263)
	at org.apache.solr.cloud.OverseerTaskProcessor$Runner.run(OverseerTaskProcessor.java:505)
	at org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:209)
	at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)
	at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)
	at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834)
Caused by: org.apache.solr.common.SolrException:  No node can satisfy the rules &lt;span class=&quot;code-quote&quot;&gt;&quot;[{replica=#ALL, type=PULL, sysprop.solrNodeType=PULL, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {replica=#ALL, type=TLOG, sysprop.solrNodeType=TLOG, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {replica=#ALL, type=NRT, sysprop.solrNodeType=NRT, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {nodeRole=overseer, replica=0, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {cores=&amp;lt;6, node=#ANY}, {replica=&amp;lt;2, shard=#EACH, node=#ANY, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}] More details from logs in node : 127.0.0.1:43511_solr, errorId : AutoScaling.error.diagnostics.14915037535846&quot;&lt;/span&gt;
	at org.apache.solr.client.solrj.cloud.autoscaling.PolicyHelper.getReplicaLocations(PolicyHelper.java:185)
	at org.apache.solr.cloud.api.collections.Assign.getPositionsUsingPolicy(Assign.java:382)
	at org.apache.solr.cloud.api.collections.Assign$PolicyBasedAssignStrategy.assign(Assign.java:630)
	at org.apache.solr.cloud.api.collections.CreateCollectionCmd.buildReplicaPositions(CreateCollectionCmd.java:410)
	at org.apache.solr.cloud.api.collections.CreateCollectionCmd.call(CreateCollectionCmd.java:190)
	... 6 more
....
NOTE: reproduce with: ant test  -Dtestcase=ComputePlanActionTest -Dtests.method=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard -Dtests.seed=1363057E7AA562F7 -Dtests.slow=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; -Dtests.badapples=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; -Dtests.locale=brx-IN -Dtests.timezone=Antarctica/Rothera -Dtests.asserts=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; -Dtests.file.encoding=UTF-8


org.apache.solr.client.solrj.impl.HttpSolrClient$RemoteSolrException: Error from server at http:&lt;span class=&quot;code-comment&quot;&gt;//127.0.0.1:43511/solr: Error getting replica locations :  No node can satisfy the rules &lt;span class=&quot;code-quote&quot;&gt;&quot;[{replica=#ALL, type=PULL, sysprop.solrNodeType=PULL, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {replica=#ALL, type=TLOG, sysprop.solrNodeType=TLOG, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {replica=#ALL, type=NRT, sysprop.solrNodeType=NRT, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {nodeRole=overseer, replica=0, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}, {cores=&amp;lt;6, node=#ANY}, {replica=&amp;lt;2, shard=#EACH, node=#ANY, collection=testNodeAddedTriggerWithAddReplicaPreferredOpReplicaType_1Shard_0}] More details from logs in node : 127.0.0.1:43511_solr, errorId : AutoScaling.error.diagnostics.14915037535846&quot;&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Can you please fix?&lt;/p&gt;</comment>
                            <comment id="16900414" author="ishaigor" created="Mon, 5 Aug 2019 21:15:53 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;, I fixed the test case.&lt;/p&gt;</comment>
                            <comment id="16902834" author="jira-bot" created="Thu, 8 Aug 2019 09:48:14 +0000"  >&lt;p&gt;Commit ed137dbe281cfb314af340673a7b646922a2e7d1 in lucene-solr&apos;s branch refs/heads/master from Shalin Shekhar Mangar&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=ed137db&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=ed137db&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13674&quot; title=&quot;NodeAddedTrigger does not support configuration of replica type hint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13674&quot;&gt;&lt;del&gt;SOLR-13674&lt;/del&gt;&lt;/a&gt;: NodeAddedTrigger does not support configuration of replica type hint.&lt;/p&gt;

&lt;p&gt;A new replicaType property has been added to NodeAddTrigger so that new replicas of the given type are added when the preferredOp is addreplica. The default value of replicaType is `NRT`.&lt;/p&gt;

&lt;p&gt;This closes #821.&lt;/p&gt;</comment>
                            <comment id="16902837" author="jira-bot" created="Thu, 8 Aug 2019 09:50:15 +0000"  >&lt;p&gt;Commit de522052c8b113a90613055585c864aa7bcdb300 in lucene-solr&apos;s branch refs/heads/branch_8x from Shalin Shekhar Mangar&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=de52205&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=de52205&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13674&quot; title=&quot;NodeAddedTrigger does not support configuration of replica type hint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13674&quot;&gt;&lt;del&gt;SOLR-13674&lt;/del&gt;&lt;/a&gt;: NodeAddedTrigger does not support configuration of replica type hint.&lt;/p&gt;

&lt;p&gt;A new replicaType property has been added to NodeAddTrigger so that new replicas of the given type are added when the preferredOp is addreplica. The default value of replicaType is `NRT`.&lt;/p&gt;

&lt;p&gt;This closes #821.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit ed137dbe281cfb314af340673a7b646922a2e7d1)&lt;/p&gt;</comment>
                            <comment id="16902839" author="shalinmangar" created="Thu, 8 Aug 2019 09:52:28 +0000"  >&lt;p&gt;This is merged into master and branch_8x. Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ishaigor&quot; class=&quot;user-hover&quot; rel=&quot;ishaigor&quot;&gt;ishaigor&lt;/a&gt;!&lt;/p&gt;</comment>
                            <comment id="16902864" author="ishaigor" created="Thu, 8 Aug 2019 10:28:29 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;, will it be possible to merge the change in branch_7x as well? This is the version that is currently in use for me.&lt;/p&gt;</comment>
                            <comment id="16902874" author="shalinmangar" created="Thu, 8 Aug 2019 10:53:20 +0000"  >&lt;p&gt;The 7x branch has been made protected to reject any commits. See &lt;a href=&quot;https://issues.apache.org/jira/browse/INFRA-18192&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/INFRA-18192&lt;/a&gt;. This is due to back-compat issues that make it almost impossible to release a new minor version from the 7x branch.&lt;/p&gt;

&lt;p&gt;This change can be back-ported to branch_7_7 (and to branch_8_2) in case a new bug fix release (7.7.3 or 8.2.1) is required but none of them are in plans today.&lt;/p&gt;

&lt;p&gt;Would it be okay if you cherry-picked the commit to 7x on your private repos instead?&lt;/p&gt;</comment>
                            <comment id="17535765" author="janhoy" created="Thu, 12 May 2022 00:27:02 +0000"  >&lt;p&gt;Closing after the 9.0.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            3 years, 26 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0597s:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>