<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:13:38 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9116] Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9116</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Fix a leak of SolrIndexSearcher when a SolrCore is reloaded. Added a test to expose this leak when run in many iterations (pretty reliable failure with iters=1K), which passes with the fix (ran iters=10K twice).&lt;/p&gt;

&lt;p&gt;The fundamental issue is that when an invocation of SolrCore#openNewSearcher is racing with SolrCore#close, if this synchronized block (&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/master/solr/core/src/java/org/apache/solr/core/SolrCore.java#L1611&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/master/solr/core/src/java/org/apache/solr/core/SolrCore.java#L1611&lt;/a&gt;) in openNewSearcher doesn&apos;t check for whether or not the core is closed, it can possibly run after the core runs closeSearcher and assign the newly constructed searcher to realtimeSearcher again, which will never be cleaned up. The fix is to check if the SolrCore is closed inside the synchronized block, and if so, clean up the newly constructed searcher and throw an Exception.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12970063">SOLR-9116</key>
            <summary>Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="mewmewball">Jessica Cheng Mallet</reporter>
                        <labels>
                            <label>leak</label>
                            <label>searcher</label>
                    </labels>
                <created>Mon, 16 May 2016 16:54:15 +0000</created>
                <updated>Wed, 2 Oct 2019 17:24:09 +0000</updated>
                            <resolved>Fri, 17 Jun 2016 21:44:47 +0000</resolved>
                                                    <fixVersion>5.5.2</fixVersion>
                    <fixVersion>5.6</fixVersion>
                    <fixVersion>6.0.1</fixVersion>
                    <fixVersion>6.1</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>9</watches>
                                                                                                                <comments>
                            <comment id="15285105" author="shalinmangar" created="Mon, 16 May 2016 19:07:35 +0000"  >&lt;p&gt;Nice catch!&lt;/p&gt;

&lt;p&gt;+1 LGTM&lt;/p&gt;</comment>
                            <comment id="15286904" author="erickerickson" created="Tue, 17 May 2016 16:00:19 +0000"  >&lt;p&gt;I&apos;ll commit this in a day or two unless someone beats me to it. I&apos;m traveling so can&apos;t quite promise when so if someone really wants to take it please do.&lt;/p&gt;

&lt;p&gt;I confirmed this on 6.x both with and without the actual fix.&lt;/p&gt;</comment>
                            <comment id="15289080" author="shalinmangar" created="Wed, 18 May 2016 14:43:36 +0000"  >&lt;p&gt;I ran the tests with and without the fix with a 1000 iterations and I encountered failures without the patch but none with the patch. I&apos;ll commit this now.&lt;/p&gt;</comment>
                            <comment id="15289084" author="jira-bot" created="Wed, 18 May 2016 14:46:06 +0000"  >&lt;p&gt;Commit d6a5c5a539384ba89456de9bbc50ff90ff4fd6ac in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d6a5c5a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d6a5c5a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9116&quot; title=&quot;Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9116&quot;&gt;&lt;del&gt;SOLR-9116&lt;/del&gt;&lt;/a&gt;: Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded&lt;/p&gt;</comment>
                            <comment id="15289088" author="jira-bot" created="Wed, 18 May 2016 14:47:49 +0000"  >&lt;p&gt;Commit 2dff2b8070ae83e45410b20558ae7820653ffefb in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2dff2b8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2dff2b8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9116&quot; title=&quot;Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9116&quot;&gt;&lt;del&gt;SOLR-9116&lt;/del&gt;&lt;/a&gt;: Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded&lt;br/&gt;
(cherry picked from commit d6a5c5a)&lt;/p&gt;</comment>
                            <comment id="15289099" author="shalinmangar" created="Wed, 18 May 2016 14:52:17 +0000"  >&lt;p&gt;Thanks Erick, I took care of this one. Happy travels!&lt;/p&gt;

&lt;p&gt;Thanks Jessica for the fix!&lt;/p&gt;</comment>
                            <comment id="15294451" author="steve_rowe" created="Fri, 20 May 2016 22:57:06 +0000"  >&lt;p&gt;Reopening to backport to 6.0.1.&lt;/p&gt;</comment>
                            <comment id="15294452" author="jira-bot" created="Fri, 20 May 2016 22:57:18 +0000"  >&lt;p&gt;Commit 5c859404289bfb0c9a5d7d1df2c07aabf61865c4 in lucene-solr&apos;s branch refs/heads/branch_6_0 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5c85940&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5c85940&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9116&quot; title=&quot;Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9116&quot;&gt;&lt;del&gt;SOLR-9116&lt;/del&gt;&lt;/a&gt;: Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded&lt;br/&gt;
(cherry picked from commit d6a5c5a)&lt;/p&gt;</comment>
                            <comment id="15305358" author="steve_rowe" created="Sat, 28 May 2016 13:38:23 +0000"  >&lt;p&gt;Bulk close issues included in the 6.0.1 release.&lt;/p&gt;</comment>
                            <comment id="15337035" author="steve_rowe" created="Fri, 17 Jun 2016 21:43:56 +0000"  >&lt;p&gt;Reopening to backport to 5.6 and 5.5.2.&lt;/p&gt;</comment>
                            <comment id="15337037" author="jira-bot" created="Fri, 17 Jun 2016 21:44:37 +0000"  >&lt;p&gt;Commit e86eb9d1ecd6f63b15068b368819e31c4c3e1203 in lucene-solr&apos;s branch refs/heads/branch_5_5 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e86eb9d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e86eb9d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9116&quot; title=&quot;Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9116&quot;&gt;&lt;del&gt;SOLR-9116&lt;/del&gt;&lt;/a&gt;: Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded&lt;br/&gt;
(cherry picked from commit d6a5c5a)&lt;/p&gt;</comment>
                            <comment id="15337038" author="jira-bot" created="Fri, 17 Jun 2016 21:44:39 +0000"  >&lt;p&gt;Commit d58bff079cca06fa7d54ced6d73fa7ffb8e0df7f in lucene-solr&apos;s branch refs/heads/branch_5x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d58bff0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d58bff0&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9116&quot; title=&quot;Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9116&quot;&gt;&lt;del&gt;SOLR-9116&lt;/del&gt;&lt;/a&gt;: Race condition causing occasional SolrIndexSearcher leak when SolrCore is reloaded&lt;br/&gt;
(cherry picked from commit d6a5c5a)&lt;/p&gt;</comment>
                            <comment id="15349798" author="steve_rowe" created="Sat, 25 Jun 2016 20:33:51 +0000"  >&lt;p&gt;Bulk close issues released with 5.5.2.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12775169">SOLR-7115</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12804204" name="SOLR-9116.patch" size="5065" author="mewmewball" created="Mon, 16 May 2016 16:55:34 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 21 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2y0yn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>