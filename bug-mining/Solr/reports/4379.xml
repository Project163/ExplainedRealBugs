<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:41:54 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-13563] SPLITSHARD - Using LINK method fails on disk usage checks</title>
                <link>https://issues.apache.org/jira/browse/SOLR-13563</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Raised this on the mailing list and was told to open an issue, copy/pasting the context here:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Using Solr 7.7.2 Docker image, testing some of the new autoscale features, huge fan so far. Tested with the link method on a 2GB core and found that it took less than 1MB of additional space. Filled the core quite a bit larger, 12GB of a 20GB PVC, and now splitting the shard fails with the following error message on my overseer:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2019-06-18 16:27:41.754 ERROR 
(OverseerThreadFactory-49-thread-5-processing-n:10.0.192.74:8983_solr) 
[c:test_autoscale s:shard1&#160; ] 
o.a.s.c.a.c.OverseerCollectionMessageHandler Collection: test_autoscale 
operation: splitshard
failed:org.apache.solr.common.SolrException: not enough free disk space 
to perform index split on node 10.0.193.23:8983_solr, required: 
23.35038321465254, available: 7.811378479003906


&#160;&#160;&#160; at org.apache.solr.cloud.api.collections.SplitShardCmd.checkDiskSpace(SplitShardCmd.java:567)


&#160;&#160;&#160; at org.apache.solr.cloud.api.collections.SplitShardCmd.split(SplitShardCmd.java:138)


&#160;&#160;&#160; at org.apache.solr.cloud.api.collections.SplitShardCmd.call(SplitShardCmd.java:94)


&#160;&#160;&#160; at 
org.apache.solr.cloud.api.collections.OverseerCollectionMessageHandler.processMessage(OverseerCollectionMessageHandler.java:294)


&#160;&#160;&#160; at org.apache.solr.cloud.OverseerTaskProcessor$Runner.run(OverseerTaskProcessor.java:505)


&#160;&#160;&#160; at org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:209)


&#160;&#160;&#160; at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1128)


&#160;&#160;&#160; at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:628)


&#160;&#160;&#160; at java.base/java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:834)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;I attempted sending the request to the node itself to see if it did anything different, but no luck. My parameters are (Note Python formatting as that is my language of choice):&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
splitparams = {&lt;span class=&quot;code-quote&quot;&gt;&apos;action&apos;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&apos;SPLITSHARD&apos;&lt;/span&gt;,
               &lt;span class=&quot;code-quote&quot;&gt;&apos;collection&apos;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&apos;test_autoscale&apos;&lt;/span&gt;,
               &lt;span class=&quot;code-quote&quot;&gt;&apos;shard&apos;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&apos;shard1&apos;&lt;/span&gt;,
               &lt;span class=&quot;code-quote&quot;&gt;&apos;splitMethod&apos;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&apos;link&apos;&lt;/span&gt;,
               &lt;span class=&quot;code-quote&quot;&gt;&apos;timing&apos;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&apos;&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&apos;&lt;/span&gt;,
               &lt;span class=&quot;code-quote&quot;&gt;&apos;async&apos;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&apos;shardsplitasync&apos;&lt;/span&gt;}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;And this is confirmed by the log message from the node itself:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
2019-06-18 16:27:41.730 INFO&#160; 
(qtp1107530534-16) [c:test_autoscale&#160;&#160; ] o.a.s.s.HttpSolrCall [admin] 
webapp=&lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; path=/admin/collections 
params={async=shardsplitasync&amp;amp;timing=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&amp;amp;action=SPLITSHARD&amp;amp;collection=test_autoscale&amp;amp;shard=shard1&amp;amp;splitMethod=link}
status=0 QTime=20&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;While it is true I do not have enough space if I were using the rewrite method, the link method on a 2GB core used an additional less than 1MB of space. Is there something I am missing here? is there an option to disable the disk space check that I need to pass? I can&apos;t find anything in the documentation at this point.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&amp;#8211;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;After this initial email, I found the issue and compiled with the attached patch and running the modification on the overseer only resolved the issue, as the overseer is what runs the check.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13240449">SOLR-13563</key>
            <summary>SPLITSHARD - Using LINK method fails on disk usage checks</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ab">Andrzej Bialecki</assignee>
                                    <reporter username="akettmann">Andrew Kettmann</reporter>
                        <labels>
                    </labels>
                <created>Wed, 19 Jun 2019 15:50:59 +0000</created>
                <updated>Sun, 29 Dec 2019 20:50:24 +0000</updated>
                            <resolved>Tue, 10 Dec 2019 16:38:16 +0000</resolved>
                                    <version>7.7.2</version>
                                    <fixVersion>8.4</fixVersion>
                                    <component>AutoScaling</component>
                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16992534" author="jira-bot" created="Tue, 10 Dec 2019 13:21:49 +0000"  >&lt;p&gt;Commit fed199df7b3370b27f173d221e52c4c6983e8020 in lucene-solr&apos;s branch refs/heads/master from Andrzej Bialecki&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=fed199d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=fed199d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13563&quot; title=&quot;SPLITSHARD - Using LINK method fails on disk usage checks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13563&quot;&gt;&lt;del&gt;SOLR-13563&lt;/del&gt;&lt;/a&gt;: SPLITSHARD using LINK method fails on disk usage checks.&lt;/p&gt;</comment>
                            <comment id="16992538" author="jira-bot" created="Tue, 10 Dec 2019 13:31:33 +0000"  >&lt;p&gt;Commit c9a156e1d81dffa9c6badb01733791bfe5acac7b in lucene-solr&apos;s branch refs/heads/branch_8x from Andrzej Bialecki&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=c9a156e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=c9a156e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13563&quot; title=&quot;SPLITSHARD - Using LINK method fails on disk usage checks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13563&quot;&gt;&lt;del&gt;SOLR-13563&lt;/del&gt;&lt;/a&gt;: SPLITSHARD using LINK method fails on disk usage checks.&lt;/p&gt;</comment>
                            <comment id="16992566" author="jira-bot" created="Tue, 10 Dec 2019 13:53:01 +0000"  >&lt;p&gt;Commit fed199df7b3370b27f173d221e52c4c6983e8020 in lucene-solr&apos;s branch refs/heads/gradle-master from Andrzej Bialecki&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=fed199d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=fed199d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13563&quot; title=&quot;SPLITSHARD - Using LINK method fails on disk usage checks&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13563&quot;&gt;&lt;del&gt;SOLR-13563&lt;/del&gt;&lt;/a&gt;: SPLITSHARD using LINK method fails on disk usage checks.&lt;/p&gt;</comment>
                            <comment id="17004958" author="jpountz" created="Sun, 29 Dec 2019 20:50:24 +0000"  >&lt;p&gt;Closing after the 8.4.0 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12972223" name="disk_check.patch" size="816" author="akettmann" created="Wed, 19 Jun 2019 15:49:57 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 46 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z03wn4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>