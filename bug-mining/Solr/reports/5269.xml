<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:11:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5386] firstSearcher warming can deadlock on queries that use LocalSolrQueryRequest internally -- notably spellcheck.maxCollationTries</title>
                <link>https://issues.apache.org/jira/browse/SOLR-5386</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;&#160;&lt;br/&gt;
Any Solr search related code that uses &lt;tt&gt;LocalSolrQueryRequest&lt;/tt&gt; to create a &quot;sub request&quot; (notably spellcheck with &lt;tt&gt;maxCollationTries&lt;/tt&gt;) can cause deadlock on core load if it is used in a &lt;tt&gt;firstSearcher&lt;/tt&gt; warming query, because &lt;tt&gt;LocalSolrQueryRequest&lt;/tt&gt; (via inheritance from &lt;tt&gt;SolrQueryRequestBase&lt;/tt&gt; ) attempts to get the latest registered searcher from the &lt;tt&gt;SolrCore&lt;/tt&gt; &amp;#8211; but this will block until the &lt;tt&gt;firstSearcher&lt;/tt&gt; is registered, creating a deadlock loop.&lt;/p&gt;

&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;Original Bug Report&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;When spellcheck.maxCollationTries is set (&amp;gt;0) Solr hangs in combination with that requestHandler set to default=&quot;true&quot;.&lt;/p&gt;

&lt;p&gt;When I make another requestHandler default, one without the maxCollationTries, all requestHandlers work just fine.&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="12675479">SOLR-5386</key>
            <summary>firstSearcher warming can deadlock on queries that use LocalSolrQueryRequest internally -- notably spellcheck.maxCollationTries</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="jeroens">Jeroen Steggink</reporter>
                        <labels>
                            <label>collate</label>
                            <label>maxCollationTries</label>
                            <label>spellcheck</label>
                    </labels>
                <created>Thu, 24 Oct 2013 12:50:17 +0000</created>
                <updated>Fri, 17 Oct 2025 20:05:03 +0000</updated>
                            <resolved>Thu, 10 Apr 2025 23:40:06 +0000</resolved>
                                    <version>4.4</version>
                    <version>4.5</version>
                                    <fixVersion>9.9</fixVersion>
                    <fixVersion>10.0</fixVersion>
                                    <component>spellchecker</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>10</watches>
                                                                                                                <comments>
                            <comment id="13804249" author="jdyer" created="Thu, 24 Oct 2013 14:30:45 +0000"  >&lt;p&gt;Jeroen,  Thanks for the bug report.  Can you include the snippets from solrconfig.xml where you are defining the request handler and spellcheckers?  Also, give an example of a query that fails.  Is this happening because the queries are included with warming queries? (the &amp;lt;firstsearcher&amp;gt;/&amp;lt;newsearcher&amp;gt; sections)&lt;/p&gt;</comment>
                            <comment id="13813888" author="jeroens" created="Tue, 5 Nov 2013 12:28:40 +0000"  >&lt;p&gt;James, it&apos;s very weird. I&apos;m not able to recreate the problem with the same settings. I duplicated the core with a clean index. Now I don&apos;t have any problems at all. I guess something in the index is causing the problem. Do you have any tips on how to find out what is causing this strange behaviour?&lt;br/&gt;
Edit: After a re-index I no longer have the problem.&lt;/p&gt;</comment>
                            <comment id="13984747" author="jdyer" created="Tue, 29 Apr 2014 20:32:12 +0000"  >&lt;p&gt;user said this is not a problem anymore, so closing&lt;/p&gt;</comment>
                            <comment id="14028331" author="vincet" created="Wed, 11 Jun 2014 20:17:07 +0000"  >&lt;p&gt;Having this exact issue on:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;solr-spec 4.8.1&lt;br/&gt;
solr-impl 4.8.1 1594670 - rmuir - 2014-05-14 19:38:41&lt;br/&gt;
lucene-spec 4.8.1&lt;br/&gt;
lucene-impl 4.8.1 1594670 - rmuir - 2014-05-14 19:22:52&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;When setting my default query handler with a spellcheck and this value is set I get this exact problem.  If I remove the setting, set collation to false or set spellcheck to false, I can get the solr core to come up.  I can pass the setting on the query string, but that&apos;s a bit of a hack.&lt;/p&gt;

&lt;p&gt;I start seeing this as my only error:&lt;/p&gt;

&lt;p&gt;ERROR - 2014-06-11 13:32:26.832; org.apache.solr.common.SolrException; org.apache.solr.common.SolrException: Error opening new searcher. exceeded limit of maxWarmingSearchers=2, try again later.&lt;/p&gt;</comment>
                            <comment id="14028335" author="jdyer" created="Wed, 11 Jun 2014 20:21:08 +0000"  >&lt;p&gt;Vince,&lt;/p&gt;

&lt;p&gt;Can you post your default handler configuration from solrconfig.xml and also explain &lt;em&gt;when&lt;/em&gt; you get it to lock up?&lt;/p&gt;</comment>
                            <comment id="14028344" author="vincet" created="Wed, 11 Jun 2014 20:29:26 +0000"  >&lt;p&gt;I can post the whole file, but this is all I added to cause the issue on a working system.&lt;/p&gt;

&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;Default Settings&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;      &amp;lt;!-- return suggested results --&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;spellcheck&quot;&amp;gt;false&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;spellcheck.dictionary&quot;&amp;gt;suggest&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;spellcheck.extendedResults&quot;&amp;gt;true&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;spellcheck.count&quot;&amp;gt;15&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;spellcheck.alternativeTermCount&quot;&amp;gt;15&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;spellcheck.maxResultsForSuggest&quot;&amp;gt;15&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;spellcheck.collate&quot;&amp;gt;true&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;spellcheck.collateExtendedResults&quot;&amp;gt;true&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;spellcheck.maxCollationTries&quot;&amp;gt;10&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;spellcheck.maxCollations&quot;&amp;gt;15&amp;lt;/str&amp;gt;&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;Add my component&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;    &amp;lt;arr name=&quot;last-components&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;str&amp;gt;suggest&amp;lt;/str&amp;gt;&lt;br/&gt;
    &amp;lt;/arr&amp;gt;&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;panelHeader&quot; style=&quot;border-bottom-width: 1px;&quot;&gt;&lt;b&gt;Spellchecker&lt;/b&gt;&lt;/div&gt;&lt;div class=&quot;panelContent&quot;&gt;
&lt;p&gt;  &amp;lt;searchComponent class=&quot;solr.SpellCheckComponent&quot; name=&quot;suggest&quot;&amp;gt;&lt;br/&gt;
    &amp;lt;str name=&quot;queryAnalyzerFieldType&quot;&amp;gt;alphaOnlySort&amp;lt;/str&amp;gt;&lt;br/&gt;
    &amp;lt;lst name=&quot;spellchecker&quot;&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;name&quot;&amp;gt;suggest&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;field&quot;&amp;gt;document_text&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;classname&quot;&amp;gt;solr.DirectSolrSpellChecker&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;lookupImpl&quot;&amp;gt;org.apache.solr.spelling.suggest.fst.AnalyzingLookupFactory&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;str name=&quot;distanceMeasure&quot;&amp;gt;internal&amp;lt;/str&amp;gt;&lt;br/&gt;
      &amp;lt;float name=&quot;accuracy&quot;&amp;gt;0.5&amp;lt;/float&amp;gt;&lt;br/&gt;
      &amp;lt;int name=&quot;maxEdits&quot;&amp;gt;2&amp;lt;/int&amp;gt;&lt;br/&gt;
      &amp;lt;int name=&quot;minPrefix&quot;&amp;gt;1&amp;lt;/int&amp;gt;&lt;br/&gt;
      &amp;lt;int name=&quot;maxInspections&quot;&amp;gt;5&amp;lt;/int&amp;gt;&lt;br/&gt;
      &amp;lt;int name=&quot;minQueryLength&quot;&amp;gt;0&amp;lt;/int&amp;gt;&lt;br/&gt;
      &amp;lt;float name=&quot;maxQueryFrequency&quot;&amp;gt;0.01&amp;lt;/float&amp;gt;&lt;br/&gt;
    &amp;lt;/lst&amp;gt;&lt;br/&gt;
  &amp;lt;/searchComponent&amp;gt;&lt;/p&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="14028346" author="vincet" created="Wed, 11 Jun 2014 20:30:38 +0000"  >&lt;p&gt;oops.. forgot I changed spellcheck to false, just revert that to true.&lt;/p&gt;</comment>
                            <comment id="14028402" author="vincet" created="Wed, 11 Jun 2014 21:10:41 +0000"  >&lt;p&gt;Oh and it happens on start.  System core never comes online.  I&apos;m guessing the warming process dies and restarts itself.&lt;/p&gt;</comment>
                            <comment id="14028656" author="hossman" created="Thu, 12 Jun 2014 00:34:29 +0000"  >&lt;p&gt;Vince: can you please try triggering a thread dump (on any system: jps to find pid, jstack to produce dump) of your running system when it&apos;s hung and post that here as an attachment?&lt;/p&gt;

&lt;p&gt;(I suspect this is the same as &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4408&quot; title=&quot;Server hanging on startup&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4408&quot;&gt;&lt;del&gt;SOLR-4408&lt;/del&gt;&lt;/a&gt;, which i thought was fixed a while ago but based on the recent comments in that issue may still be a problem)&lt;/p&gt;</comment>
                            <comment id="14029160" author="vincet" created="Thu, 12 Jun 2014 13:58:17 +0000"  >&lt;p&gt;I can access the SOLR admin page, but not core admin nor does any core selection work.&lt;/p&gt;</comment>
                            <comment id="14077537" author="rossjones" created="Tue, 29 Jul 2014 09:09:20 +0000"  >&lt;p&gt;I have exactly the same problem on 4.6.1&lt;/p&gt;

&lt;p&gt;I create a new core from my service, which includes a schema.xml the same as Vince&apos;s.  Everything carries on fine until jetty gets restarted.  Then the same thing.  Core admin/selector not accessible, and my app just hangs trying to connect to that specific core.  Other cores without this setting appear to be unaffected. Changing maxCollationTries to 0 fixes the problem.&lt;/p&gt;

&lt;p&gt;Nothing in logs that appears helpful though &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="14077863" author="vincet" created="Tue, 29 Jul 2014 15:51:29 +0000"  >&lt;p&gt;My WAG for this is that collate waits for the core to load, but since it&apos;s waiting on collate to complete the core never loads and they stay stuck in an infinite wait.  My assumption for this WAG is that disabling collate allows the core to load or having another query that does not have spell check in the XML allows the core to load.&lt;/p&gt;</comment>
                            <comment id="14106762" author="hrzafer" created="Fri, 22 Aug 2014 12:18:27 +0000"  >&lt;p&gt;Can this be related with this: &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6366&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-6366&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14314145" author="okkeklein" created="Tue, 10 Feb 2015 13:06:59 +0000"  >&lt;p&gt;This problem still occurs (Solr 4.10.3) &lt;a href=&quot;http://stackoverflow.com/questions/18791031/solr-spellcheck-causing-core-reload-to-hang&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://stackoverflow.com/questions/18791031/solr-spellcheck-causing-core-reload-to-hang&lt;/a&gt; led me to sollution.&lt;/p&gt;</comment>
                            <comment id="14561035" author="hastingsr" created="Wed, 27 May 2015 14:10:32 +0000"  >&lt;p&gt;I am having the same problem with Solr 4.6.0.  The lock is occurring in SolrCore.getSearcher().  For me at startup both the &lt;span class=&quot;error&quot;&gt;&amp;#91;coreLoadExecutor-3-thread-1&amp;#93;&lt;/span&gt; and &lt;span class=&quot;error&quot;&gt;&amp;#91;searcherExecutor-4-thread-1&amp;#93;&lt;/span&gt; are blocked on the searhcerLock.wait() call line 1546 for SolrCore for release 4.6.0.  My guess is the synchronized block needs review.  I&apos;ll to more checking and let you know what I find.&lt;/p&gt;

&lt;p&gt;BTW this happens every time this line is added to the /select RequestHandler:&lt;/p&gt;

&lt;p&gt;&amp;lt;str name=&quot;spellcheck.maxCollationTries&quot;&amp;gt;5&amp;lt;/str&amp;gt;&lt;/p&gt;

&lt;p&gt;Whenever the value is greater than zero.&lt;/p&gt;</comment>
                            <comment id="14563032" author="hastingsr" created="Thu, 28 May 2015 14:59:17 +0000"  >&lt;p&gt;Here is another thread dump.  If the MaxCollationRetries is greater than zero and the SpellChecker component is added to the RequestHandler for /select.  Then the FirstSearcherListener will call getSearcher() and hang because the first searcher is not registered yet.&lt;/p&gt;</comment>
                            <comment id="17940132" author="hossman" created="Tue, 1 Apr 2025 17:06:19 +0000"  >&lt;p&gt;12 years later and this bug bites me in the ass &#8211; and the more i look at it, the more embarrassed I am that we didn&apos;t fix this problem 10 years ago when the root cause was clearly identified:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Using &lt;tt&gt;maxCollationTries&lt;/tt&gt; causes spellchecker to create sub requests
	&lt;ul&gt;
		&lt;li&gt;these use &lt;tt&gt;LocalSolrQueryRequest&lt;/tt&gt; which asks the &lt;tt&gt;SolrCore&lt;/tt&gt; for the latest register searcher (as well as the latest schema if it&apos;s mutable)&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;asking &lt;tt&gt;SolrCore&lt;/tt&gt; for the latest registered searcher block until at least one registered searcher is available
	&lt;ul&gt;
		&lt;li&gt;if a spellcheck query with &lt;tt&gt;maxCollationTries&lt;/tt&gt; is invoked as part of &lt;tt&gt;firstSearcher&lt;/tt&gt; warming query, then a deadlock loop is introduced: registering the first searcher is waiting on the spellcheck query, which is waiting on the collation validation query which is waiting for the first searcher to be registered&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;In the case of the original bug report: &lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;the default &lt;tt&gt;solrconfig.xml&lt;/tt&gt; at the time had simple query (using the default request handler) configured&lt;/li&gt;
	&lt;li&gt;if/when you modified the default request handler to use spellchecking with &lt;tt&gt;maxCollationTries&lt;/tt&gt; you &lt;b&gt;might&lt;/b&gt; (depending on the data in your index) get suggested spellcheck collations for that warming query, and then you&apos;d get deadlock.&lt;/li&gt;
&lt;/ul&gt;


&lt;hr /&gt;

&lt;p&gt;The fix seems really straight forward: spellcheck should not be using a &quot;stock&quot; &lt;tt&gt;LocalSolrQueryRequest&lt;/tt&gt; which asks the &lt;tt&gt;SolrCore&lt;/tt&gt; for the latest register searcher &amp;#8211; it should be using a &quot;sub request&quot; implementation of &lt;tt&gt;SolrQueryRequest&lt;/tt&gt; that is initialized with the same searcher (and current schema) as the original request.  (which in the case of warming is already explicitly set to be the searcher being warmed)&lt;/p&gt;

&lt;p&gt;I&apos;m attaching a really straight forward patch that implements this by adding a new &lt;tt&gt;subRequest()&lt;/tt&gt; method to &lt;tt&gt;SolrQueryRequest&lt;/tt&gt; for initializing a request using the same core/schema/searcher as an existing request &amp;#8211; but with it&apos;s own state.  The patch also includes a new spellcheck test showing how attempting to configured a &lt;tt&gt;firstSearcher&lt;/tt&gt; warming query using &lt;tt&gt;maxCollationTries&lt;/tt&gt; can cause core reloading to deadlock the test &amp;#8211; but it passes with this change.&lt;/p&gt;

&lt;p&gt;If there are no objections to this approach, i plan to flesh out the javadocs, and audit other uses of &lt;tt&gt;LocalSolrQueryRequest&lt;/tt&gt; to see where else in the code base we should use this &lt;tt&gt;subRequest()&lt;/tt&gt; method&lt;/p&gt;
</comment>
                            <comment id="17940406" author="hossman" created="Wed, 2 Apr 2025 16:05:18 +0000"  >
&lt;p&gt;I audited all of the usages of &lt;tt&gt;LocalSolrQueryRequest&lt;/tt&gt;...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;several i switched to use the new &lt;tt&gt;subRequest&lt;/tt&gt; helper&lt;/li&gt;
	&lt;li&gt;many are situations that don&apos;t have an &quot;original&quot; request (recovery or other background admin actions) or apply to &quot;cross core&quot; situations&lt;/li&gt;
	&lt;li&gt;in one case &amp;#8211; &lt;tt&gt;CollapsingQParserPlugin&lt;/tt&gt; i &lt;em&gt;wanted&lt;/em&gt; to use &lt;tt&gt;subRequest&lt;/tt&gt;, but the way the code is organized, the place that the &lt;tt&gt;LocalSolrQueryRequest&lt;/tt&gt; is created doesn&apos;t have access to the original request &amp;#8211; but it does have access to the original &lt;tt&gt;SolrIndexSearcher&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;I also realized that the &quot;make an anonymous subclass of &lt;tt&gt;LocalSolrQueryRequest&lt;/tt&gt; using an explicitly known &lt;tt&gt;SolrIndexSearcher&lt;/tt&gt;&quot; pattern that exists in &lt;tt&gt;QuerySenderListener&lt;/tt&gt; was copy pasted in &lt;tt&gt;SolrIndexSearcher&lt;/tt&gt;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;So I:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;added another (static) helper to &lt;tt&gt;SolrQueryRequest&lt;/tt&gt; that can create a new &lt;tt&gt;SolrQueryRequest&lt;/tt&gt; from an existing &lt;tt&gt;SolrIndexSearcher&lt;/tt&gt;
	&lt;ul&gt;
		&lt;li&gt;used this in &lt;tt&gt;CollapsingQParserPlugin&lt;/tt&gt; as well&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;fleshed out all the (nocommit) javadocs&lt;/li&gt;
&lt;/ul&gt;




&lt;p&gt;I think this is good to go&lt;/p&gt;

</comment>
                            <comment id="17943341" author="jira-bot" created="Thu, 10 Apr 2025 19:57:42 +0000"  >&lt;p&gt;Commit 17510244b214036ad9365019c5053c1711140da8 in solr&apos;s branch refs/heads/main from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=17510244b21&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=17510244b21&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5386&quot; title=&quot;firstSearcher warming can deadlock on queries that use LocalSolrQueryRequest internally -- notably spellcheck.maxCollationTries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5386&quot;&gt;&lt;del&gt;SOLR-5386&lt;/del&gt;&lt;/a&gt;: Fix various methods of invoking &quot;local&quot; solr requests to re-use the same searcher as the original request.&lt;/p&gt;

&lt;p&gt;This notably fixes the use of spellcheck.maxCollationTries in firstSearcher warming queries to prevent deadlock&lt;/p&gt;</comment>
                            <comment id="17943384" author="dsmiley" created="Thu, 10 Apr 2025 22:46:24 +0000"  >&lt;p&gt;Nice fix! &#160;Better late than never. &#160;I&apos;m also glad it reduces use of LocalSolrQueryRequest.&lt;/p&gt;</comment>
                            <comment id="17943385" author="hossman" created="Thu, 10 Apr 2025 22:49:29 +0000"  >&lt;p&gt;yup.&lt;/p&gt;

&lt;p&gt;(and FWIW: I&apos;m still in the process of running 9x tests before pushing the backport)&lt;/p&gt;</comment>
                            <comment id="17943392" author="jira-bot" created="Thu, 10 Apr 2025 23:38:00 +0000"  >&lt;p&gt;Commit 0897e7ed0bf8fb5504a7066527980d32c57c644a in solr&apos;s branch refs/heads/branch_9x from Chris M. Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=0897e7ed0bf&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=0897e7ed0bf&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5386&quot; title=&quot;firstSearcher warming can deadlock on queries that use LocalSolrQueryRequest internally -- notably spellcheck.maxCollationTries&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5386&quot;&gt;&lt;del&gt;SOLR-5386&lt;/del&gt;&lt;/a&gt;: Fix various methods of invoking &quot;local&quot; solr requests to re-use the same searcher as the original request.&lt;/p&gt;

&lt;p&gt;This notably fixes the use of spellcheck.maxCollationTries in firstSearcher warming queries to prevent deadlock&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 17510244b214036ad9365019c5053c1711140da8)&lt;/p&gt;</comment>
                            <comment id="18009752" author="houston" created="Thu, 24 Jul 2025 22:50:53 +0000"  >&lt;p&gt;Closing after the 9.9.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12733412">SOLR-6366</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13075771" name="SOLR-5386-1.patch" size="14535" author="hossman" created="Wed, 2 Apr 2025 16:05:16 +0000"/>
                            <attachment id="13075746" name="SOLR-5386.patch" size="5432" author="hossman" created="Tue, 1 Apr 2025 17:06:16 +0000"/>
                            <attachment id="12735882" name="Solr5386SpellCheckerHangThreadDump.txt" size="2954" author="hastingsr" created="Thu, 28 May 2015 14:59:17 +0000"/>
                            <attachment id="12650053" name="threaddump.log" size="38161" author="VinceT" created="Thu, 12 Jun 2014 13:58:17 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>4.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>355056</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            15 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1p7lz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>355344</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>