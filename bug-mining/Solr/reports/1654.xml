<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:43:50 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5509] ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-5509</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; 41386 T28 C21 P57194 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={wt=javabin&amp;amp;CONTROL=TRUE&amp;amp;version=2} {add=[50086 (1452880907553734656)]} 0 142

   [junit4]   2&amp;gt; 42009 T133 C27 P60411 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={wt=javabin&amp;amp;version=2} {add=[50086 (1452880908206997504)]} 0 254

   [junit4]   2&amp;gt; 42323 T27 C21 P57194 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={wt=javabin&amp;amp;CONTROL=TRUE&amp;amp;version=2} {delete=[50086 (-1452880908537298944)]} 0 2

   [junit4]   2&amp;gt; 42327 T131 C27 P60411 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={wt=javabin&amp;amp;version=2} {delete=[50086 (-1452880908542541824)]} 0 1

   [junit4]   2&amp;gt; 42622 T132 C27 P60411 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={update.distrib=TOLEADER&amp;amp;wt=javabin&amp;amp;version=2} {add=[50086 (1452880908850823168)]} 0 1

   [junit4]   2&amp;gt; 42623 T48 C22 P57136 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={wt=javabin&amp;amp;version=2} {add=[50086]} 0 1223

   [junit4]   2&amp;gt; ###### Only in cloudDocList: [{id=50086}]

   [junit4]   2&amp;gt; 		cloudClient :{numFound=1,start=0,docs=[SolrDocument{id=50086, _version_=1452880908850823168}]}

h
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12681631">SOLR-5509</key>
            <summary>ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="markrmiller@gmail.com">Mark Miller</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Nov 2013 18:41:01 +0000</created>
                <updated>Mon, 9 May 2016 18:44:31 +0000</updated>
                            <resolved>Mon, 24 Feb 2014 16:22:16 +0000</resolved>
                                                    <fixVersion>4.7</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="13834021" author="markrmiller@gmail.com" created="Wed, 27 Nov 2013 18:43:32 +0000"  >&lt;p&gt;This involves an add, a delete and then an add. An add may be an update on every fail I&apos;ve seen - any id over 50000 might be also be added by another thread.&lt;/p&gt;

&lt;p&gt;The first add hits the control and the cloud shard. The delete does the same.&lt;/p&gt;

&lt;p&gt;Then a TOLEADER add pops back up - nothing went to control, so this came out of nowhere.&lt;/p&gt;</comment>
                            <comment id="13834055" author="jira-bot" created="Wed, 27 Nov 2013 19:24:23 +0000"  >&lt;p&gt;Commit 1546164 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546164&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546164&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: Beef up retry logging&lt;/p&gt;</comment>
                            <comment id="13834061" author="jira-bot" created="Wed, 27 Nov 2013 19:28:59 +0000"  >&lt;p&gt;Commit 1546166 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546166&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546166&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: Beef up retry logging&lt;/p&gt;</comment>
                            <comment id="13834063" author="markrmiller@gmail.com" created="Wed, 27 Nov 2013 19:31:02 +0000"  >&lt;p&gt;Who sent you version 1452880908850823168?&lt;/p&gt;</comment>
                            <comment id="13834109" author="markrmiller@gmail.com" created="Wed, 27 Nov 2013 20:21:56 +0000"  >&lt;p&gt;Better retry logging:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; 67370 T27 C26 P44590 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={CONTROL=TRUE&amp;amp;wt=javabin&amp;amp;version=2} {add=[50060 (1452887946460921856)]} 0 172

   [junit4]   2&amp;gt; 67695 T80 C29 P36244 oasc.SolrException.log ERROR forwarding update to http://127.0.0.1:50810/collection1/ failed - retrying ... retries: 1 add{,id=50060}:org.apache.solr.common.SolrException: Can not find: /collection1/update

   [junit4]   2&amp;gt; 68200 T80 C29 P36244 oasc.SolrException.log ERROR forwarding update to http://127.0.0.1:50810/collection1/ failed - retrying ... retries: 2 add{,id=50060}:org.apache.solr.common.SolrException: Can not find: /collection1/update

   [junit4]   2&amp;gt; 69877 T112 C30 P40511 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={distrib.from=http://127.0.0.1:36244/collection1/&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;update.distrib=FROMLEADER} {add=[50060 (1452887949111721984)]} 0 3

   [junit4]   2&amp;gt; 69878 T80 C29 P36244 oasc.SolrException.log ERROR forwarding update to http://127.0.0.1:50810/collection1/ failed - retrying ... retries: 3 add{,id=50060}:org.apache.http.conn.HttpHostConnectException: Connection to http://127.0.0.1:50810 refused

   [junit4]   2&amp;gt; 69978 T152 C28 P34789 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={distrib.from=http://127.0.0.1:36244/collection1/&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;update.distrib=FROMLEADER} {add=[50060 (1452887949111721984)]} 0 104

   [junit4]   2&amp;gt; 69978 T81 C29 P36244 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={wt=javabin&amp;amp;version=2} {add=[50060 (1452887949111721984)]} 0 1610

   [junit4]   2&amp;gt; 70106 T26 C26 P44590 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={CONTROL=TRUE&amp;amp;wt=javabin&amp;amp;version=2} {delete=[50060 (-1452887949358137344)]} 0 1

   [junit4]   2&amp;gt; 70112 T151 C28 P34789 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={distrib.from=http://127.0.0.1:36244/collection1/&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;update.distrib=FROMLEADER} {delete=[50060 (-1452887949361283072)]} 0 1

   [junit4]   2&amp;gt; 70112 T114 C30 P40511 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={distrib.from=http://127.0.0.1:36244/collection1/&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;update.distrib=FROMLEADER} {delete=[50060 (-1452887949361283072)]} 0 1

   [junit4]   2&amp;gt; 70113 T81 C29 P36244 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={wt=javabin&amp;amp;version=2} {delete=[50060 (-1452887949361283072)]} 0 5

   [junit4]   2&amp;gt; 70386 T116 C30 P40511 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={distrib.from=http://127.0.0.1:36244/collection1/&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;update.distrib=FROMLEADER} {add=[50060 (1452887949646495744)]} 0 2

   [junit4]   2&amp;gt; 70386 T150 C28 P34789 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={distrib.from=http://127.0.0.1:36244/collection1/&amp;amp;wt=javabin&amp;amp;version=2&amp;amp;update.distrib=FROMLEADER} {add=[50060 (1452887949646495744)]} 0 2

   [junit4]   2&amp;gt; 70387 T78 C29 P36244 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={wt=javabin&amp;amp;version=2&amp;amp;update.distrib=TOLEADER} {add=[50060 (1452887949646495744)]} 0 7

   [junit4]   2&amp;gt; 70388 T80 C29 P36244 oasup.LogUpdateProcessor.finish [collection1] webapp= path=/update params={wt=javabin&amp;amp;version=2} {add=[50060]} 0 3001

   [junit4]   2&amp;gt; ###### Only in cloudDocList: [{id=50060}]

   [junit4]   2&amp;gt; 		cloudClient :{numFound=1,start=0,docs=[SolrDocument{id=50060, _version_=1452887949646495744}]}


&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13834122" author="jira-bot" created="Wed, 27 Nov 2013 20:40:03 +0000"  >&lt;p&gt;Commit 1546186 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546186&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546186&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: better debug logging&lt;/p&gt;</comment>
                            <comment id="13834123" author="jira-bot" created="Wed, 27 Nov 2013 20:41:02 +0000"  >&lt;p&gt;Commit 1546187 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546187&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546187&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: better debug logging&lt;/p&gt;</comment>
                            <comment id="13834124" author="jira-bot" created="Wed, 27 Nov 2013 20:43:36 +0000"  >&lt;p&gt;Commit 1546189 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546189&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546189&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: fix possible npe&lt;/p&gt;</comment>
                            <comment id="13834125" author="jira-bot" created="Wed, 27 Nov 2013 20:44:29 +0000"  >&lt;p&gt;Commit 1546190 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546190&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546190&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: fix possible npe&lt;/p&gt;</comment>
                            <comment id="13834499" author="jira-bot" created="Thu, 28 Nov 2013 04:09:04 +0000"  >&lt;p&gt;Commit 1546278 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546278&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546278&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: Always add a param for &apos;from&apos; node.&lt;/p&gt;</comment>
                            <comment id="13834500" author="jira-bot" created="Thu, 28 Nov 2013 04:10:58 +0000"  >&lt;p&gt;Commit 1546279 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546279&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546279&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: Always add a param for &apos;from&apos; node.&lt;/p&gt;</comment>
                            <comment id="13834501" author="markrmiller@gmail.com" created="Thu, 28 Nov 2013 04:13:55 +0000"  >&lt;p&gt;Bah - this bug all but disappeared when I started sending the from node param on all requests - that is pretty odd, it wouldn&apos;t affect any defensive checks here that I can see. Might be rolling 100 heads in a row though.&lt;/p&gt;

&lt;p&gt;Anyway, better to not hide adding the param behind the log level - always adding and seeing if I can find this fail again. &lt;/p&gt;</comment>
                            <comment id="13834514" author="markrmiller@gmail.com" created="Thu, 28 Nov 2013 04:45:13 +0000"  >&lt;p&gt;Interesting - as soon as I did that, I caught a fail.&lt;/p&gt;

&lt;p&gt;Need to think about it a bit. The phantom add is coming from the leader to itself and then getting distributed.&lt;/p&gt;</comment>
                            <comment id="13834527" author="jira-bot" created="Thu, 28 Nov 2013 05:15:18 +0000"  >&lt;p&gt;Commit 1546286 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546286&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546286&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: Do not retry to yourself.&lt;/p&gt;</comment>
                            <comment id="13834528" author="jira-bot" created="Thu, 28 Nov 2013 05:16:34 +0000"  >&lt;p&gt;Commit 1546287 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546287&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546287&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: Do not retry to yourself.&lt;/p&gt;</comment>
                            <comment id="13835581" author="jira-bot" created="Sat, 30 Nov 2013 01:04:29 +0000"  >&lt;p&gt;Commit 1546670 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546670&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546670&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: allow retry updates to self again, don&apos;t retry on remote solrserver exceptions&lt;/p&gt;</comment>
                            <comment id="13835582" author="jira-bot" created="Sat, 30 Nov 2013 01:15:32 +0000"  >&lt;p&gt;Commit 1546672 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546672&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546672&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: allow retry updates to self again, don&apos;t retry on remote solrserver exceptions&lt;/p&gt;</comment>
                            <comment id="13835605" author="markrmiller@gmail.com" created="Sat, 30 Nov 2013 03:20:41 +0000"  >&lt;p&gt;This is a hard nut to crack. I&apos;ve been going over the retry code a lot. Another interesting fail:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; 119996 T28 C115 P55124 oasup.LogUpdateProcessor.finish [collection1] webapp=/_umo/h path=/update params={CONTROL=TRUE&amp;amp;version=2&amp;amp;wt=javabin} {add=[50678 (1453094753545486336)]} 0 1

   [junit4]   2&amp;gt; 120040 T151 C117 P59797 oasc.SolrException.log ERROR forwarding update to http://127.0.0.1:47574/_umo/h/collection1/ failed - retrying ... retries: 1 add{,id=50678} rsp:404:org.apache.solr.common.SolrException: Can not find: /_umo/h/collection1/update

   [junit4]   2&amp;gt; 120544 T151 C117 P59797 oasc.SolrException.log ERROR forwarding update to http://127.0.0.1:47574/_umo/h/collection1/ failed - retrying ... retries: 2 add{,id=50678} rsp:404:org.apache.solr.common.SolrException: Can not find: /_umo/h/collection1/update

   [junit4]   2&amp;gt; 121246 T151 C117 P59797 oasc.SolrException.log ERROR forwarding update to http://127.0.0.1:47574/_umo/h/collection1/ failed - retrying ... retries: 3 add{,id=50678} rsp:-1:org.apache.http.conn.HttpHostConnectException: Connection to http://127.0.0.1:47574 refused

   [junit4]   2&amp;gt; 121246 T150 C117 P59797 oasup.LogUpdateProcessor.finish [collection1] webapp=/_umo/h path=/update params={version=2&amp;amp;wt=javabin} {add=[50678 (1453094754828943360)]} 0 579

   [junit4]   2&amp;gt; 121252 T26 C115 P55124 oasup.LogUpdateProcessor.finish [collection1] webapp=/_umo/h path=/update params={CONTROL=TRUE&amp;amp;version=2&amp;amp;wt=javabin} {delete=[50678 (-1453094754863546368)]} 0 1

   [junit4]   2&amp;gt; 121254 T152 C117 P59797 oasup.LogUpdateProcessor.finish [collection1] webapp=/_umo/h path=/update params={version=2&amp;amp;wt=javabin} {delete=[50678 (-1453094754865643520)]} 0 0

   [junit4]   2&amp;gt; 121841 T149 C117 P59797 oasup.LogUpdateProcessor.finish [collection1] webapp=/_umo/h path=/update params={update.distrib=TOLEADER&amp;amp;version=2&amp;amp;wt=javabin&amp;amp;distrib.from=http://127.0.0.1:59797/_umo/h/collection1/} {add=[50678 (1453094755480109056)]} 0 93

   [junit4]   2&amp;gt; 121841 T151 C117 P59797 oasup.LogUpdateProcessor.finish [collection1] webapp=/_umo/h path=/update params={version=2&amp;amp;wt=javabin} {add=[50678]} 0 1842

   [junit4]   2&amp;gt; ###### Only in cloudDocList: [{id=50678}]

   [junit4]   2&amp;gt; 		cloudClient :{numFound=1,start=0,docs=[SolrDocument{id=50678, _version_=1453094755480109056}]}


&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13835607" author="jira-bot" created="Sat, 30 Nov 2013 03:34:28 +0000"  >&lt;p&gt;Commit 1546685 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546685&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546685&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: More logging&lt;/p&gt;</comment>
                            <comment id="13835608" author="jira-bot" created="Sat, 30 Nov 2013 03:40:50 +0000"  >&lt;p&gt;Commit 1546686 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546686&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546686&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: More logging&lt;/p&gt;</comment>
                            <comment id="13835615" author="markrmiller@gmail.com" created="Sat, 30 Nov 2013 05:02:23 +0000"  >&lt;p&gt;This may actually be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5516&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare inconsistency fails.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5516&quot;&gt;SOLR-5516&lt;/a&gt;...&lt;/p&gt;</comment>
                            <comment id="13835952" author="markrmiller@gmail.com" created="Sun, 1 Dec 2013 04:43:28 +0000"  >&lt;p&gt;I mentioned that because I was seeing it less - no real evidence though.&lt;/p&gt;

&lt;p&gt;Anyway, what seems to be happening...&lt;/p&gt;

&lt;p&gt;Document id&apos;s from two different threads can overlap over 50000. I never really figured this was a big problem - at worst we would test having some updates. But...&lt;/p&gt;

&lt;p&gt;Thread one adds a document with id &amp;gt; 50000 - it fails being forwarded to the leader and a retry starts. Thread two then adds the same document with id &amp;gt; 50000 and it succeeds. Thread two then deletes it&apos;s add, which happens on control and in the cloud. Finally, thread one&apos;s retry works and adds the doc back to the cloud while it&apos;s not in control.&lt;/p&gt;

&lt;p&gt;Not a great test I think - I&apos;ll try and ensure unique id&apos;s are used per thread for the test.&lt;/p&gt;</comment>
                            <comment id="13835962" author="jira-bot" created="Sun, 1 Dec 2013 05:09:32 +0000"  >&lt;p&gt;Commit 1546779 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546779&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546779&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: Raise id&apos;s per thread so they won&apos;t overlap&lt;/p&gt;</comment>
                            <comment id="13835964" author="jira-bot" created="Sun, 1 Dec 2013 05:19:27 +0000"  >&lt;p&gt;Commit 1546780 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546780&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546780&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: Raise id&apos;s per thread so they won&apos;t overlap&lt;/p&gt;</comment>
                            <comment id="13836051" author="jira-bot" created="Sun, 1 Dec 2013 15:52:10 +0000"  >&lt;p&gt;Commit 1546821 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546821&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546821&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: Better string ids for these tests&lt;/p&gt;</comment>
                            <comment id="13836054" author="jira-bot" created="Sun, 1 Dec 2013 15:58:20 +0000"  >&lt;p&gt;Commit 1546822 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1546822&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1546822&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5509&quot; title=&quot;ChaosMonkeyNothingIsSafeTest rare fails due to TOLEADER retries.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5509&quot;&gt;&lt;del&gt;SOLR-5509&lt;/del&gt;&lt;/a&gt;: Better string ids for these tests&lt;/p&gt;</comment>
                            <comment id="13876478" author="markrmiller@gmail.com" created="Mon, 20 Jan 2014 14:44:41 +0000"  >&lt;p&gt;This may actually be related to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5643&quot; title=&quot;ConcurrentUpdateSolrServer will sometimes not spawn a new Runner thread even though there are updates in the queue.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5643&quot;&gt;&lt;del&gt;SOLR-5643&lt;/del&gt;&lt;/a&gt;. My fullmetaljenkins server is doing very well with the chaosmonkey tests since this issue was resolved - before that, the nothing is safe test would hit this every 10 or 20 runs.&lt;/p&gt;</comment>
                            <comment id="13878069" author="markrmiller@gmail.com" created="Wed, 22 Jan 2014 00:25:33 +0000"  >&lt;p&gt;It wasn&apos;t, I&apos;ve seen it since. But now I&apos;m thinking it&apos;s probably a variation of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5650&quot; title=&quot;When mixing adds and deletes, it appears there is a corner case where peersync can bring back a deleted update.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5650&quot;&gt;&lt;del&gt;SOLR-5650&lt;/del&gt;&lt;/a&gt;, but all the replicas just happen to be in sync.&lt;/p&gt;</comment>
                            <comment id="13910445" author="markrmiller@gmail.com" created="Mon, 24 Feb 2014 16:22:16 +0000"  >&lt;p&gt;This was due to the retries that CloudSolrServer was doing on update fails.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12689946">SOLR-5650</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12681091">SOLR-5503</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12681113">SOLR-5504</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12765808">SOLR-6931</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12767566">SOLR-6983</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12695125">SOLR-5727</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12616091" name="cmns-test-cloud-off-by1-control-2.log" size="766164" author="markrmiller@gmail.com" created="Wed, 27 Nov 2013 18:44:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>360895</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 39 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1q7nb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>361194</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>