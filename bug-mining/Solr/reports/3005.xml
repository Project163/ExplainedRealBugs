<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:14:24 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9191] OverseerTaskQueue.peekTopN() fatally flawed</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9191</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;We rewrote DistributedQueue in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6760&quot; title=&quot;New optimized DistributedQueue implementation for overseer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6760&quot;&gt;&lt;del&gt;SOLR-6760&lt;/del&gt;&lt;/a&gt;, to optimize its obvious use case as a FIFO.  But in doing so, we broke the assumptions in OverseerTaskQueue.peekTopN()..&lt;/p&gt;

&lt;p&gt;OverseerTaskQueue.peekTopN() involves filtering out items you&apos;re already working on, it&apos;s trying to peek for new items in the queue beyond what you already know about.  But DistributedQueue (being designed as a FIFO) doesn&apos;t know about the filtering; as long as it has any items in-memory it just keeps returning those over and over without ever pulling new data from ZK.  This is true even if the watcher has fired and marked the state as dirty.  So OverseerTaskQueue gets into a state where it can never read new items in ZK because DQ keeps returning the same items that it has marked as in-progress.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12976326">SOLR-9191</key>
            <summary>OverseerTaskQueue.peekTopN() fatally flawed</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dragonsinth">Scott Blum</assignee>
                                    <reporter username="dragonsinth">Scott Blum</reporter>
                        <labels>
                    </labels>
                <created>Tue, 7 Jun 2016 07:22:04 +0000</created>
                <updated>Wed, 2 Oct 2019 17:23:30 +0000</updated>
                            <resolved>Thu, 9 Jun 2016 20:26:48 +0000</resolved>
                                    <version>5.4</version>
                    <version>5.4.1</version>
                    <version>5.5</version>
                    <version>5.5.1</version>
                    <version>6.0</version>
                    <version>6.0.1</version>
                                    <fixVersion>5.5.2</fixVersion>
                    <fixVersion>5.6</fixVersion>
                    <fixVersion>6.0.2</fixVersion>
                    <fixVersion>6.1</fixVersion>
                    <fixVersion>6.2</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="86400">24h</timeoriginalestimate>
                            <timeestimate seconds="86400">24h</timeestimate>
                                        <comments>
                            <comment id="15318363" author="noble.paul" created="Tue, 7 Jun 2016 12:08:22 +0000"  >&lt;p&gt;does ZK have any way to read items &apos;newer&apos; than some id ?&lt;/p&gt;</comment>
                            <comment id="15318782" author="noble.paul" created="Tue, 7 Jun 2016 16:15:51 +0000"  >&lt;p&gt;Is there a way we can avoid reading the &quot;already read&quot;  items from ZK?&lt;/p&gt;</comment>
                            <comment id="15318785" author="dragonsinth" created="Tue, 7 Jun 2016 16:18:32 +0000"  >&lt;p&gt;No, you can only &apos;getChildren&apos; en masse&lt;/p&gt;</comment>
                            <comment id="15319419" author="jira-bot" created="Tue, 7 Jun 2016 21:02:38 +0000"  >&lt;p&gt;Commit 34e30860488ebf08bdf0e3cb36fddcb67991b800 in lucene-solr&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=34e3086&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=34e3086&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: OverseerTaskQueue.peekTopN() fatally flawed&lt;/p&gt;</comment>
                            <comment id="15319425" author="githubbot" created="Tue, 7 Jun 2016 21:03:43 +0000"  >&lt;p&gt;GitHub user dragonsinth opened a pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/41&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/41&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: OverseerTaskQueue.peekTopN() fatally flawed&lt;/p&gt;

&lt;p&gt;    @noblepaul &lt;br/&gt;
    CC: @shalinmangar &lt;/p&gt;

&lt;p&gt;You can merge this pull request into a Git repository by running:&lt;/p&gt;

&lt;p&gt;    $ git pull &lt;a href=&quot;https://github.com/apache/lucene-solr&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr&lt;/a&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Alternatively you can review and apply these changes as the patch at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/41.patch&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/41.patch&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;To close this pull request, make a commit to your master/trunk branch&lt;br/&gt;
with (at least) the following in the commit message:&lt;/p&gt;

&lt;p&gt;    This closes #41&lt;/p&gt;

&lt;hr /&gt;
&lt;p&gt;commit 34e30860488ebf08bdf0e3cb36fddcb67991b800&lt;br/&gt;
Author: Scott Blum &amp;lt;dragonsinth@gmail.com&amp;gt;&lt;br/&gt;
Date:   2016-06-07T05:52:16Z&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: OverseerTaskQueue.peekTopN() fatally flawed&lt;/p&gt;

&lt;hr /&gt;</comment>
                            <comment id="15319429" author="dragonsinth" created="Tue, 7 Jun 2016 21:05:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt; some rework from the inital patch: Java 8isms for master, a little more refactoring to make it much more seamless.&lt;/p&gt;</comment>
                            <comment id="15319445" author="dragonsinth" created="Tue, 7 Jun 2016 21:14:31 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt; you might be interested in this one&lt;/p&gt;</comment>
                            <comment id="15319508" author="markrmiller@gmail.com" created="Tue, 7 Jun 2016 21:49:41 +0000"  >&lt;p&gt;Can we expand a test to catch this more easily?&lt;/p&gt;</comment>
                            <comment id="15319546" author="jira-bot" created="Tue, 7 Jun 2016 22:03:01 +0000"  >&lt;p&gt;Commit 23c0edb154630259209ecd7f54109cb4d28ca861 in lucene-solr&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=23c0edb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=23c0edb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: monitor exception fix&lt;/p&gt;</comment>
                            <comment id="15319554" author="dragonsinth" created="Tue, 7 Jun 2016 22:08:09 +0000"  >&lt;p&gt;Good idea, will do.  Working on getting tests to pass globally atm.&lt;/p&gt;</comment>
                            <comment id="15319597" author="jira-bot" created="Tue, 7 Jun 2016 22:35:34 +0000"  >&lt;p&gt;Commit 024a733b7f561cfbc1b3e557fd0ab9d69aa6a9c9 in lucene-solr&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=024a733&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=024a733&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: Add test for DistributedQueue.peekElements()&lt;/p&gt;</comment>
                            <comment id="15319700" author="jira-bot" created="Tue, 7 Jun 2016 23:45:14 +0000"  >&lt;p&gt;Commit caba9d528be7a221523909e25847e3d8476f6275 in lucene-solr&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=caba9d5&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=caba9d5&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: Fix for DeleteStatusTest; remove things from queue immediately on completion.&lt;/p&gt;</comment>
                            <comment id="15319701" author="jira-bot" created="Tue, 7 Jun 2016 23:45:16 +0000"  >&lt;p&gt;Commit 8465ed2119dd0634b2acf72f3dedca5914bac845 in lucene-solr&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8465ed2&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=8465ed2&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: Fix for DeleteStatusTest part 2; remove things from queue immediately on completion.&lt;/p&gt;</comment>
                            <comment id="15319716" author="githubbot" created="Tue, 7 Jun 2016 23:51:52 +0000"  >&lt;p&gt;Github user dragonsinth commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/41#discussion_r66172805&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/41#discussion_r66172805&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: solr/core/src/java/org/apache/solr/cloud/OverseerTaskProcessor.java &amp;#8212;&lt;br/&gt;
    @@ -466,6 +466,8 @@ private void markTaskComplete(String id, String asyncId)&lt;br/&gt;
               log.warn(&quot;Could not find and remove async call &lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot; + asyncId + &amp;quot;&amp;#93;&lt;/span&gt; from the running map.&quot;);&lt;br/&gt;
             }&lt;br/&gt;
           }&lt;br/&gt;
    +&lt;br/&gt;
    +      workQueue.remove(head);&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    @markrmiller can you think of any reason not to do this?  I don&apos;t understand why currently getting things out of the queue takes an extra iteration.  I think my fix unmasked a latent problem exposed by DeleteStatusTest; to get that test to pass I have to eagerly remove completed items from the work queue, which seems correct to me.  Not sure why we&apos;d want to wait for a loop-around to `cleanUpWorkQueue()` &lt;/p&gt;</comment>
                            <comment id="15319717" author="githubbot" created="Tue, 7 Jun 2016 23:52:28 +0000"  >&lt;p&gt;Github user dragonsinth commented on a diff in the pull request:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/41#discussion_r66172870&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/41#discussion_r66172870&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    &amp;#8212; Diff: solr/core/src/test/org/apache/solr/cloud/DistributedQueueTest.java &amp;#8212;&lt;br/&gt;
    @@ -137,6 +136,49 @@ public void testDistributedQueueBlocking() throws Exception &lt;/p&gt;
{
         assertNull(dq.poll());
       }

&lt;p&gt;    +  @Test&lt;br/&gt;
    +  public void testPeekElements() throws Exception {&lt;br/&gt;
    +    String dqZNode = &quot;/distqueue/test&quot;;&lt;br/&gt;
    +    byte[] data = &quot;hello world&quot;.getBytes(UTF8);&lt;br/&gt;
    +&lt;br/&gt;
    +    DistributedQueue dq = makeDistributedQueue(dqZNode);&lt;br/&gt;
    +&lt;br/&gt;
    +    // Populate with data.&lt;br/&gt;
    +    dq.offer(data);&lt;br/&gt;
    +    dq.offer(data);&lt;br/&gt;
    +    dq.offer(data);&lt;br/&gt;
    +&lt;br/&gt;
    +    // Should be able to get 0, 1, 2, or 3 instantly&lt;br/&gt;
    +    for (int i = 0; i &amp;lt;= 3; ++i) &lt;/p&gt;
{
    +      assertEquals(i, dq.peekElements(i, 0, child -&amp;gt; true).size());
    +    }
&lt;p&gt;    +&lt;br/&gt;
    +    // Asking for more should return only 3.&lt;br/&gt;
    +    assertEquals(3, dq.peekElements(4, 0, child -&amp;gt; true).size());&lt;br/&gt;
    +&lt;br/&gt;
    +    // If we filter everything out, we should block for the full time.&lt;br/&gt;
    +    long start = System.nanoTime();&lt;br/&gt;
    +    assertEquals(0, dq.peekElements(4, 1000, child -&amp;gt; false).size());&lt;br/&gt;
    +    assertTrue(System.nanoTime() - start &amp;gt;= TimeUnit.MILLISECONDS.toNanos(500));&lt;br/&gt;
    +&lt;br/&gt;
    +    // If someone adds a new matching element while we&apos;re waiting, we should return immediately.&lt;br/&gt;
    +    executor.submit(() -&amp;gt; {&lt;br/&gt;
    +      try &lt;/p&gt;
{
    +        Thread.sleep(500);
    +        dq.offer(data);
    +      }
&lt;p&gt; catch (Exception e) &lt;/p&gt;
{
    +        // ignore
    +      }
&lt;p&gt;    +    });&lt;br/&gt;
    +    start = System.nanoTime();&lt;br/&gt;
    +    assertEquals(1, dq.peekElements(4, 2000, child -&amp;gt; &lt;/p&gt;
{
    +      // The 4th element in the queue will end with a &quot;3&quot;.
    +      return child.endsWith(&quot;3&quot;);
    +    }
&lt;p&gt;).size());&lt;br/&gt;
    +    assertTrue(System.nanoTime() - start &amp;lt; TimeUnit.MILLISECONDS.toNanos(1000));&lt;br/&gt;
    +    assertTrue(System.nanoTime() - start &amp;gt;= TimeUnit.MILLISECONDS.toNanos(250));&lt;br/&gt;
    +  }&lt;br/&gt;
    +&lt;br/&gt;
    &amp;#8212; End diff &amp;#8211;&lt;/p&gt;

&lt;p&gt;    @markrmiller the new test you suggested&lt;/p&gt;</comment>
                            <comment id="15319896" author="githubbot" created="Wed, 8 Jun 2016 03:00:57 +0000"  >&lt;p&gt;Github user dragonsinth commented on the issue:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/41&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/41&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;    This passes `ant test`.&lt;/p&gt;</comment>
                            <comment id="15320017" author="noble.paul" created="Wed, 8 Jun 2016 05:16:03 +0000"  >&lt;p&gt;&lt;tt&gt;DistributedQueue.peekElements(int n, long waitMillis, Function&amp;lt;String, Boolean&amp;gt; acceptFilter)&lt;/tt&gt;&lt;/p&gt;

&lt;p&gt;can use a Predicate as third param&lt;/p&gt;</comment>
                            <comment id="15320027" author="dragonsinth" created="Wed, 8 Jun 2016 05:23:55 +0000"  >&lt;p&gt;Yeah, I was going to use Predicate, but wanted to be compatible with your patch for 8744.  If you&apos;re fine with Predicate, I&apos;ll use that.&lt;/p&gt;</comment>
                            <comment id="15320029" author="noble.paul" created="Wed, 8 Jun 2016 05:25:00 +0000"  >&lt;p&gt;I&apos;m changing it as well&lt;/p&gt;</comment>
                            <comment id="15321114" author="dragonsinth" created="Wed, 8 Jun 2016 18:13:19 +0000"  >&lt;p&gt;Cool.  Any other feedback beyond the Predicate change?  &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt; or &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=markrmiller%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;markrmiller@gmail.com&quot;&gt;markrmiller@gmail.com&lt;/a&gt;?  Otherwise going to commit to master today and start backporting.&lt;/p&gt;

&lt;p&gt;I want to backport this to any branches we might make a release on... 5.5.2, 5.6, 6.0.2, 6.1.1, 6.2&lt;/p&gt;</comment>
                            <comment id="15321888" author="jira-bot" created="Thu, 9 Jun 2016 04:59:32 +0000"  >&lt;p&gt;Commit ed2621de8402154440e3e1e1979eb620bd23b926 in lucene-solr&apos;s branch refs/heads/&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt; from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ed2621d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ed2621d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: OverseerTaskQueue.peekTopN() fatally flawed&lt;/p&gt;</comment>
                            <comment id="15321889" author="jira-bot" created="Thu, 9 Jun 2016 04:59:44 +0000"  >&lt;p&gt;Commit ed2621de8402154440e3e1e1979eb620bd23b926 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ed2621d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ed2621d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: OverseerTaskQueue.peekTopN() fatally flawed&lt;/p&gt;</comment>
                            <comment id="15321890" author="dragonsinth" created="Thu, 9 Jun 2016 05:00:16 +0000"  >&lt;p&gt;I went ahead and committed to master to unblock &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="15321891" author="githubbot" created="Thu, 9 Jun 2016 05:00:45 +0000"  >&lt;p&gt;Github user asfgit closed the pull request at:&lt;/p&gt;

&lt;p&gt;    &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/41&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/41&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15321898" author="dsmiley" created="Thu, 9 Jun 2016 05:08:59 +0000"  >&lt;p&gt;FYI the ASF git/jira commit bot sends updates to all JIRA issues referenced by commits occurring on this branch (e.g. &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8859&quot; title=&quot;AbstractSpatialFieldType can use ShapeContext to read/write shapes (WKT, GeoJSON)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8859&quot;&gt;&lt;del&gt;SOLR-8859&lt;/del&gt;&lt;/a&gt;) even though it has nothing to do with this issue.  I got the ASF to add a filter for branches following the pattern &lt;tt&gt;(lucene|solr).*&lt;/tt&gt; (case sensitive) as that was the most common branch naming pattern.  Please next time make a branch named like solr9199 and then this won&apos;t happen.  I could ask for case insensitive but I figured it would be nice to encourage more branch naming consistency.&lt;/p&gt;</comment>
                            <comment id="15322010" author="dragonsinth" created="Thu, 9 Jun 2016 06:34:02 +0000"  >&lt;p&gt;Oh, sorry!  I think it&apos;s because I force-pushed my branch after rebasing it.&lt;/p&gt;</comment>
                            <comment id="15322987" author="jira-bot" created="Thu, 9 Jun 2016 17:57:18 +0000"  >&lt;p&gt;Commit 7e86ba8c7327f99ca8708494b6d402af4cd0b4ec in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=7e86ba8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=7e86ba8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: use a Predicate instead of a Function&lt;/p&gt;</comment>
                            <comment id="15323149" author="jira-bot" created="Thu, 9 Jun 2016 19:16:38 +0000"  >&lt;p&gt;Commit cde57ab64a6f4082b2dfab515397a242600a1df7 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=cde57ab&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=cde57ab&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: OverseerTaskQueue.peekTopN() fatally flawed&lt;/p&gt;</comment>
                            <comment id="15323211" author="jira-bot" created="Thu, 9 Jun 2016 19:57:45 +0000"  >&lt;p&gt;Commit 5955712ab1e3a37537929c3050b42aed243d3b4b in lucene-solr&apos;s branch refs/heads/branch_5x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5955712&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5955712&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: OverseerTaskQueue.peekTopN() fatally flawed&lt;/p&gt;</comment>
                            <comment id="15323222" author="jira-bot" created="Thu, 9 Jun 2016 20:05:55 +0000"  >&lt;p&gt;Commit 9f5fae7ed82cd565d991ed92f9af4ca23eb7bac2 in lucene-solr&apos;s branch refs/heads/branch_5_5 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9f5fae7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9f5fae7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: OverseerTaskQueue.peekTopN() fatally flawed&lt;/p&gt;</comment>
                            <comment id="15323244" author="jira-bot" created="Thu, 9 Jun 2016 20:13:37 +0000"  >&lt;p&gt;Commit c6b04886244e90f4e0f83d1f3fa330e6ccf1a062 in lucene-solr&apos;s branch refs/heads/branch_6_0 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c6b0488&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c6b0488&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: OverseerTaskQueue.peekTopN() fatally flawed&lt;/p&gt;</comment>
                            <comment id="15323263" author="jira-bot" created="Thu, 9 Jun 2016 20:20:34 +0000"  >&lt;p&gt;Commit 80d6d26cc7b5d6bf3eca434cded5179d717bb378 in lucene-solr&apos;s branch refs/heads/branch_6_1 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dragonsinth&quot; class=&quot;user-hover&quot; rel=&quot;dragonsinth&quot;&gt;dragonsinth&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=80d6d26&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=80d6d26&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;: OverseerTaskQueue.peekTopN() fatally flawed&lt;/p&gt;</comment>
                            <comment id="15355191" author="jira-bot" created="Wed, 29 Jun 2016 12:59:25 +0000"  >&lt;p&gt;Commit 7a8be182784bf26935435ac51839e70a1c045f1b in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=7a8be18&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=7a8be18&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Put back 6.2 bugfix released in 5.5.2: &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15355192" author="jira-bot" created="Wed, 29 Jun 2016 13:00:41 +0000"  >&lt;p&gt;Commit 455e041c68106a9fc7d395a6a327aee6f221d1db in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=455e041&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=455e041&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Put back 6.2 bugfixes released in 5.5.2: &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9191&quot; title=&quot;OverseerTaskQueue.peekTopN() fatally flawed&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9191&quot;&gt;&lt;del&gt;SOLR-9191&lt;/del&gt;&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9234&quot; title=&quot;srcField works only when all fields are captured in the /update/json/docs endpoint&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9234&quot;&gt;&lt;del&gt;SOLR-9234&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                    <customfield id="customfield_12310250" key="com.atlassian.jira.plugin.system.customfieldtypes:multicheckboxes">
                        <customfieldname>Flags</customfieldname>
                        <customfieldvalues>
                                <customfieldvalue key="10430"><![CDATA[Patch]]></customfieldvalue>
    
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 20 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2z2h3:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>