<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:12:13 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-17721] RouteException with the message Cannot invoke &quot;java.util.Collection.size()&quot; because &quot;original&quot; is null in solr while doing atomic update using add-distinct from java based application</title>
                <link>https://issues.apache.org/jira/browse/SOLR-17721</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I am Getting RouteException with the message Cannot invoke &quot;java.util.Collection.size()&quot; because &quot;original&quot; is null in solrj&#160;&lt;/p&gt;

&lt;p&gt;This issue is happening in my production environment when my java application was trying to update it with document [SolrInputDocument(fields: [id=10001, activePromos=&lt;/p&gt;

{add-distinct=FREE_GIFT}

&lt;p&gt;, lastUpdatedTime=&lt;/p&gt;

{set=1742963501505}

&lt;p&gt;])], where I am using solr 9.6.1 in the production environment, I am not able to reproduce this in my local, it&apos;s working as expected Can someone help here what can be the possible reason for this Error?&lt;/p&gt;

&lt;p&gt;Definition of this field &quot;activePromos&quot; in my managed-schema { &quot;name&quot;:&quot;activePromos&quot;, &quot;type&quot;:&quot;string&quot;, &quot;docValues&quot;:true, &quot;multiValued&quot;:true, &quot;indexed&quot;:false, &quot;stored&quot;:true }&lt;/p&gt;

&lt;p&gt;Also, the document was present with id: 10001&lt;/p&gt;

&lt;p&gt;I tried replicating my local with the same SOLR version 9.6.1, but it was updating properly, in a few instances, it was failing in production&lt;/p&gt;

&lt;p&gt;Environment difference between local and production, in production, we have millions of data and it multi sharded whereas, my local has limited data and single sharded application&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Solr Version: 9.6.1&lt;/p&gt;

&lt;p&gt;Solrj maven dependency Version: 8.11.3&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Complete Stack Trace&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;org.apache.solr.client.solrj.impl.CloudSolrClient$RouteException: Error from server at &lt;a href=&quot;http://&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://&lt;/a&gt;&lt;/p&gt;
{host}:8983/solr/Collection_shard2_replica_t17: Cannot invoke &quot;java.util.Collection.size()&quot; because &quot;original&quot; is null at org.apache.solr.client.solrj.impl.CloudSolrClient.getRouteException(CloudSolrClient.java:125) at org.apache.solr.client.solrj.impl.CloudSolrClient.getRouteException(CloudSolrClient.java:46) at org.apache.solr.client.solrj.impl.BaseCloudSolrClient.directUpdate(BaseCloudSolrClient.java:579) at org.apache.solr.client.solrj.impl.BaseCloudSolrClient.sendRequest(BaseCloudSolrClient.java:1076) at org.apache.solr.client.solrj.impl.BaseCloudSolrClient.requestWithRetryOnStaleState(BaseCloudSolrClient.java:934) at org.apache.solr.client.solrj.impl.BaseCloudSolrClient.request(BaseCloudSolrClient.java:866) at org.apache.solr.client.solrj.SolrRequest.process(SolrRequest.java:225) at org.apache.solr.client.solrj.SolrClient.add(SolrClient.java:106) at org.apache.solr.client.solrj.SolrClient.add(SolrClient.java:71) at org.apache.solr.client.solrj.SolrClient.add(SolrClient.java:85) at com.gdn.x.search.service.impl.SolrDataServiceV2Impl.updateRequestToSolr(SolrDataServiceV2Impl.java:654) at com.gdn.x.search.service.impl.SolrDataServiceV2Impl.redirectUpdateRequest(SolrDataServiceV2Impl.java:681) at com.gdn.x.search.service.impl.SolrDataServiceV2Impl.updateAndHandleException(SolrDataServiceV2Impl.java:776) at com.gdn.x.search.service.impl.SolrDataServiceV2Impl.updateThrottler(SolrDataServiceV2Impl.java:727) at com.gdn.x.search.service.impl.SolrDataServiceV2Impl.update(SolrDataServiceV2Impl.java:850) at com.gdn.x.search.service.impl.SolrDataServiceV2Impl.lambda$atomicUpdateList$61(SolrDataServiceV2Impl.java:1937) at java.base/java.util.concurrent.FutureTask.run(Unknown Source) at com.gdn.x.search.other.service.helper.wrapper.ContextAwarePoolExecutor.lambda$wrap$0(ContextAwarePoolExecutor.java:35) at datadog.trace.bootstrap.instrumentation.java.concurrent.Wrapper.run(Wrapper.java:46) at java.base/java.util.concurrent.ThreadPoolExecutor.runWorker(Unknown Source) at java.base/java.util.concurrent.ThreadPoolExecutor$Worker.run(Unknown Source) at java.base/java.lang.Thread.run(Unknown Source) Caused by: org.apache.solr.client.solrj.impl.HttpSolrClient$RemoteSolrException: Error from server at &lt;a href=&quot;http://&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://&lt;/a&gt;{host}
&lt;p&gt;:8983/solr/Collection_shard2_replica_t17: Cannot invoke &quot;java.util.Collection.size()&quot; because &quot;original&quot; is null at org.apache.solr.client.solrj.impl.HttpSolrClient.executeMethod(HttpSolrClient.java:681) at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:266) at org.apache.solr.client.solrj.impl.HttpSolrClient.request(HttpSolrClient.java:248) at org.apache.solr.client.solrj.impl.LBSolrClient.doRequest(LBSolrClient.java:369) at org.apache.solr.client.solrj.impl.LBSolrClient.request(LBSolrClient.java:297) at org.apache.solr.client.solrj.impl.BaseCloudSolrClient.lambda$directUpdate$0(BaseCloudSolrClient.java:555) at java.base/java.util.concurrent.FutureTask.run(Unknown Source) at org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:218) ... 4 common frames omitted&lt;/p&gt;</description>
                <environment></environment>
        <key id="13613252">SOLR-17721</key>
            <summary>RouteException with the message Cannot invoke &quot;java.util.Collection.size()&quot; because &quot;original&quot; is null in solr while doing atomic update using add-distinct from java based application</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="epugh">Eric Pugh</assignee>
                                    <reporter username="puneet.sharma">Puneet Sharma</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 27 Mar 2025 06:52:33 +0000</created>
                <updated>Fri, 7 Nov 2025 08:38:07 +0000</updated>
                            <resolved>Tue, 29 Jul 2025 20:12:47 +0000</resolved>
                                    <version>9.6.1</version>
                                    <fixVersion>9.10</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="7200">2h</timespent>
                                <comments>
                            <comment id="18010734" author="jira-bot" created="Tue, 29 Jul 2025 20:10:04 +0000"  >&lt;p&gt;Commit a1ebd0433c71a5527429d6671c901452f0e8bdb5 in solr&apos;s branch refs/heads/main from Puneet Sharma&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=a1ebd0433c7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=a1ebd0433c7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17721&quot; title=&quot;RouteException with the message Cannot invoke &amp;quot;java.util.Collection.size()&amp;quot; because &amp;quot;original&amp;quot; is null in solr while doing atomic update using add-distinct from java based application&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17721&quot;&gt;&lt;del&gt;SOLR-17721&lt;/del&gt;&lt;/a&gt; - null pointer fix in the doAddDistinct method (#3436)&lt;/p&gt;



&lt;p&gt;Co-authored-by: Puneet Sharma &amp;lt;puneet.sharma@gdn-commerce.com&amp;gt;&lt;br/&gt;
Co-authored-by: Eric Pugh &amp;lt;epugh@opensourceconnections.com&amp;gt;&lt;/p&gt;</comment>
                            <comment id="18010735" author="jira-bot" created="Tue, 29 Jul 2025 20:10:45 +0000"  >&lt;p&gt;Commit 9f8c0dc32241c8d67f6f546d20eaee3e21a8430b in solr&apos;s branch refs/heads/branch_9x from Puneet Sharma&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=9f8c0dc3224&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=9f8c0dc3224&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17721&quot; title=&quot;RouteException with the message Cannot invoke &amp;quot;java.util.Collection.size()&amp;quot; because &amp;quot;original&amp;quot; is null in solr while doing atomic update using add-distinct from java based application&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17721&quot;&gt;&lt;del&gt;SOLR-17721&lt;/del&gt;&lt;/a&gt; - null pointer fix in the doAddDistinct method (#3436)&lt;/p&gt;



&lt;p&gt;Co-authored-by: Puneet Sharma &amp;lt;puneet.sharma@gdn-commerce.com&amp;gt;&lt;br/&gt;
Co-authored-by: Eric Pugh &amp;lt;epugh@opensourceconnections.com&amp;gt;&lt;/p&gt;</comment>
                            <comment id="18036133" author="janhoy" created="Fri, 7 Nov 2025 08:38:07 +0000"  >&lt;p&gt;Closing after the 9.10.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1v0p4:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>