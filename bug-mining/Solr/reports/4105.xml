<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:36:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-11774] langid.map.individual won&apos;t work with langid.map.keepOrig</title>
                <link>https://issues.apache.org/jira/browse/SOLR-11774</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Tried to get language detection to work.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Setting:&lt;/b&gt;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;processor class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.solr.update.processor.LangDetectLanguageIdentifierUpdateProcessorFactory&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;str name=&lt;span class=&quot;code-quote&quot;&gt;&quot;langid.fl&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;title,author&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/str&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;str name=&lt;span class=&quot;code-quote&quot;&gt;&quot;langid.langsField&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;detected_languages&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/str&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;str name=&lt;span class=&quot;code-quote&quot;&gt;&quot;langid.whitelist&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;de,en&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/str&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;str name=&lt;span class=&quot;code-quote&quot;&gt;&quot;langid.fallback&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;txt&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/str&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;bool name=&lt;span class=&quot;code-quote&quot;&gt;&quot;langid.map&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/bool&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;bool name=&lt;span class=&quot;code-quote&quot;&gt;&quot;langid.map.individual&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/bool&amp;gt;&lt;/span&gt;
      &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;bool name=&lt;span class=&quot;code-quote&quot;&gt;&quot;langid.map.keepOrig&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;true&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/bool&amp;gt;&lt;/span&gt;
    &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/processor&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Main purpose&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Map fields individually&lt;/li&gt;
	&lt;li&gt;Keep the original field&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;But the fields won&apos;t be mapped individually. They are mapped to a single detected language. After some hours of investigation i finally found the reason: &lt;b&gt;The option langid.map.keepOrig breaks the individual mapping function.&lt;/b&gt; Only if it is disabled the fields will be mapped as expected.&lt;/p&gt;

&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;Regards&lt;/li&gt;
&lt;/ul&gt;
</description>
                <environment></environment>
        <key id="13125674">SOLR-11774</key>
            <summary>langid.map.individual won&apos;t work with langid.map.keepOrig</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="janhoy">Jan H&#248;ydahl</assignee>
                                    <reporter username="toshokanin">Marco Remy</reporter>
                        <labels>
                            <label>backward-incompatible</label>
                    </labels>
                <created>Mon, 18 Dec 2017 17:27:17 +0000</created>
                <updated>Wed, 2 Oct 2019 17:30:38 +0000</updated>
                            <resolved>Thu, 3 Jan 2019 17:31:26 +0000</resolved>
                                    <version>5.0</version>
                                    <fixVersion>8.0</fixVersion>
                                    <component>contrib - LangId</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16296643" author="toshokanin" created="Tue, 19 Dec 2017 11:21:27 +0000"  >&lt;p&gt;I found a workaround for this:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;copyField source=&lt;span class=&quot;code-quote&quot;&gt;&quot;title_*&quot;&lt;/span&gt; dest=&lt;span class=&quot;code-quote&quot;&gt;&quot;title&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;copyField source=&lt;span class=&quot;code-quote&quot;&gt;&quot;author_*&quot;&lt;/span&gt; dest=&lt;span class=&quot;code-quote&quot;&gt;&quot;author&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Added copyField configuration to the schema, which copies the data back to the original field.&lt;/p&gt;</comment>
                            <comment id="16400096" author="janhoy" created="Thu, 15 Mar 2018 08:50:55 +0000"  >&lt;p&gt;This is broken by &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3881&quot; title=&quot;frequent OOM in LanguageIdentifierUpdateProcessor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3881&quot;&gt;&lt;del&gt;SOLR-3881&lt;/del&gt;&lt;/a&gt; which was introduced in Solr 5.0.&#160;The problem is that method &lt;tt&gt;detectLanguage(String text)&lt;/tt&gt; was replaced with &lt;tt&gt;detectLanguage(SolrInputDocument doc)&lt;/tt&gt;&#160;but the one place where detection per&#160;individual field happened was&#160;modified from detecting on the text of one field to detecting the whole document (&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/03095ce4d20060a1c63570d8a5214e9858693080/solr/contrib/langid/src/java/org/apache/solr/update/processor/LanguageIdentifierUpdateProcessor.java#L243)&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/03095ce4d20060a1c63570d8a5214e9858693080/solr/contrib/langid/src/java/org/apache/solr/update/processor/LanguageIdentifierUpdateProcessor.java#L243)&lt;/a&gt;&#160;which means that&#160;all fields get the same treatment.&lt;/p&gt;</comment>
                            <comment id="16400111" author="janhoy" created="Thu, 15 Mar 2018 09:09:40 +0000"  >&lt;p&gt;See &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/336&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR 336&lt;/a&gt; for failing test.&lt;/p&gt;

&lt;p&gt;My plan for fixing this is:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Change&lt;br/&gt;
&lt;tt&gt;protected abstract List&amp;lt;DetectedLanguage&amp;gt; detectLanguage(SolrInputDocument content);&lt;/tt&gt; &lt;br/&gt;
...to...&#160;&lt;br/&gt;
 &lt;tt&gt;protected abstract List&amp;lt;DetectedLanguage&amp;gt; detectLanguage(Reader content);&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;New method in &lt;tt&gt;LanguageIdentifierUpdateProcessor&lt;/tt&gt;&#160;&lt;br/&gt;
 &lt;tt&gt;protected Reader&#160;solrDocReader(SolrInputDocument doc, String[] fields)&lt;/tt&gt;&lt;br/&gt;
 This will replace &lt;tt&gt;concatFields()&lt;/tt&gt;&#160;and retrieve just enough field data to satisfy the reader&lt;/li&gt;
	&lt;li&gt;To detect language for one field only, return a reader for one field only&lt;br/&gt;
 &lt;tt&gt;detectLanguage(solrDocReader(doc, fieldName))&lt;/tt&gt;&lt;/li&gt;
	&lt;li&gt;The implementations become simpler, and the default LangDetectLIURP can take advantage of using the &lt;tt&gt;public void append(Reader reader)&lt;/tt&gt; method&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;This is a breaking API change, but since the class is still tagged as &lt;tt&gt;@lucene.experimental&lt;/tt&gt; we are allowed to do that, not?&lt;/p&gt;</comment>
                            <comment id="16401774" author="janhoy" created="Fri, 16 Mar 2018 11:32:00 +0000"  >&lt;p&gt;Here is the first attempt: &lt;a href=&quot;https://github.com/apache/lucene-solr/pull/336/files&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/pull/336/files&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;All tests pass, including new ones for map.individual and keepOrig. I have not done any benchmarks but I hope it saves some memory.&lt;/p&gt;</comment>
                            <comment id="16578072" author="janhoy" created="Mon, 13 Aug 2018 10:23:38 +0000"  >&lt;p&gt;Picking up this again. Appreciate another pair of eyes on the Reader approach taken&lt;/p&gt;</comment>
                            <comment id="16580965" author="janhoy" created="Wed, 15 Aug 2018 11:47:37 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=toshokanin&quot; class=&quot;user-hover&quot; rel=&quot;toshokanin&quot;&gt;toshokanin&lt;/a&gt; are you able to test my fix if I create a custom build for you?&lt;/p&gt;</comment>
                            <comment id="16583801" author="janhoy" created="Fri, 17 Aug 2018 11:35:25 +0000"  >&lt;p&gt;Comments, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tflobbe&quot; class=&quot;user-hover&quot; rel=&quot;tflobbe&quot;&gt;tflobbe&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=vzhovtiuk&quot; class=&quot;user-hover&quot; rel=&quot;vzhovtiuk&quot;&gt;vzhovtiuk&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="16584483" author="tomasflobbe" created="Fri, 17 Aug 2018 23:02:41 +0000"  >&lt;p&gt;LGTM &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=janhoy&quot; class=&quot;user-hover&quot; rel=&quot;janhoy&quot;&gt;janhoy&lt;/a&gt;. Your changes do seem to add a new method to the base class (which is supposed to be an extension point). I&apos;m not too worried about that, but maybe we should include a note in the Upgrade Notes of the CHANGES.txt?&lt;/p&gt;</comment>
                            <comment id="16584728" author="janhoy" created="Sat, 18 Aug 2018 09:48:58 +0000"  >&lt;p&gt;Sure, can do. Should we also remove the &#8220;lucene.experimental&#8221; annotation on this from 8.0?&lt;/p&gt;</comment>
                            <comment id="16584988" author="tomasflobbe" created="Sun, 19 Aug 2018 03:16:27 +0000"  >&lt;p&gt;+1&lt;/p&gt;</comment>
                            <comment id="16585899" author="janhoy" created="Mon, 20 Aug 2018 13:01:20 +0000"  >&lt;p&gt;Added the following upgrade notes to CHANGES:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;* SOLR-11774: In &apos;langid&apos; contrib, the LanguageIdentifierUpdateProcessor base class changed some method signatures. 
  If you have a custom language identifier implementation you will need to adapt your code. This class is annotated
  with @lucene.experimental which means its API can change in-between major versions. 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Think we&apos;re done. Will commit soon&lt;/p&gt;</comment>
                            <comment id="16733256" author="jira-bot" created="Thu, 3 Jan 2019 17:29:54 +0000"  >&lt;p&gt;Commit 00f8f3a13acd3c4da491e7169afdfbdc0f38e26d in lucene-solr&apos;s branch refs/heads/master from Jan H&#248;ydahl&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=00f8f3a&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=00f8f3a&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11774&quot; title=&quot;langid.map.individual won&amp;#39;t work with langid.map.keepOrig&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11774&quot;&gt;&lt;del&gt;SOLR-11774&lt;/del&gt;&lt;/a&gt;: langid.map.individual now works together with langid.map.keepOrig&lt;/p&gt;</comment>
                            <comment id="16733258" author="janhoy" created="Thu, 3 Jan 2019 17:31:26 +0000"  >&lt;p&gt;Finally this gets in for 8.0.0 &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;Probably not too many users of &lt;tt&gt;langid.map.individual&lt;/tt&gt; since this has been open so long. But the more important change here is to get a streaming API for detection to reduce memory pressure.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="12608913">SOLR-3881</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 45 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3o0zr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>