<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:10:52 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-14985] Slow indexing and search performance when using HttpClusterStateProvider</title>
                <link>https://issues.apache.org/jira/browse/SOLR-14985</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;HttpClusterStateProvider fetches and caches Aliases and Live Nodes for 5 seconds.&lt;/p&gt;

&lt;p&gt;The BaseSolrCloudClient caches DocCollection for 60 seconds but only if the DocCollection is not lazy and all collections returned by HttpClusterStateProvider are not lazy which means they are never cached.&lt;/p&gt;

&lt;p&gt;The BaseSolrCloudClient has a method for resolving aliases which fetches DocCollection for each input collection. This is an HTTP call with no caching when using HttpClusterStateProvider. This resolveAliases method is called twice for each update.&lt;/p&gt;

&lt;p&gt;So overall, at least 3 HTTP calls are made to fetch cluster state for each update request when using HttpClusterStateProvider. There may be more if aliases are involved or if more than one collection is specified in the request. Similar problems exist on the query path as well.&lt;/p&gt;

&lt;p&gt;Due to these reasons, using HttpClusterStateProvider causes horrible latencies and throughput for update and search requests.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13339044">SOLR-14985</key>
            <summary>Slow indexing and search performance when using HttpClusterStateProvider</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="shalin">Shalin Shekhar Mangar</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 5 Nov 2020 15:53:19 +0000</created>
                <updated>Tue, 28 Jan 2025 22:17:45 +0000</updated>
                            <resolved>Thu, 8 Aug 2024 18:09:22 +0000</resolved>
                                                    <fixVersion>9.8</fixVersion>
                                    <component>SolrJ</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>11</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="37200">10h 20m</timespent>
                                <comments>
                            <comment id="17226782" author="shalinmangar" created="Thu, 5 Nov 2020 15:54:07 +0000"  >&lt;p&gt;Linking to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14966&quot; title=&quot;Solr should use cache collection state to validate _stateVer_ sent by SolrJ&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14966&quot;&gt;SOLR-14966&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14967&quot; title=&quot;CloudSolrClient does not pass _stateVer_ if ModifiableSolrParams isn&amp;#39;t used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14967&quot;&gt;SOLR-14967&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17227873" author="noble.paul" created="Sat, 7 Nov 2020 22:48:50 +0000"  >&lt;p&gt;We need to cache the data longer. There is no reason why we should not cache the data longer. (both alias and state.json)&lt;/p&gt;</comment>
                            <comment id="17867350" author="JIRAUSER302780" created="Fri, 19 Jul 2024 13:59:02 +0000"  >&lt;p&gt;I have created a &lt;a href=&quot;https://github.com/apache/solr/pull/2571&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;PR&lt;/a&gt; to address the performance issues. Since we do not use aliases, this PR does not address any performance issues related to the HTTP-based CSP attempting to resolve aliases.The original PR is 4 years old, and the codebase has evolved since then, which is why a new PR has been raised.&lt;/p&gt;</comment>
                            <comment id="17870090" author="jira-bot" created="Thu, 1 Aug 2024 05:48:28 +0000"  >&lt;p&gt;Commit 88fa6208c0f2b8cf4b936295940bbe4b39cb778c in solr&apos;s branch refs/heads/main from aparnasuresh85&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=88fa6208c0f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=88fa6208c0f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14985&quot; title=&quot;Slow indexing and search performance when using HttpClusterStateProvider&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14985&quot;&gt;&lt;del&gt;SOLR-14985&lt;/del&gt;&lt;/a&gt;: CloudSolrClient with Solr URLs wasn&apos;t caching state (#2571)&lt;/p&gt;

&lt;p&gt;Solrj CloudSolrClient with Solr URLs had serious performance regressions (since the beginning?) in which its collection state cache was not being used, resulting in many extra requests to Solr for cluster information. (Aparna Suresh, shalin, David Smiley)&lt;/p&gt;


&lt;p&gt;Co-authored-by: Shalin Shekhar Mangar &amp;lt;shalin@apache.org&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17871209" author="jira-bot" created="Tue, 6 Aug 2024 03:16:36 +0000"  >&lt;p&gt;Commit 90531946281a8ae63b6292f1412059a2063d2279 in solr&apos;s branch refs/heads/branch_9x from aparnasuresh85&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=90531946281&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=90531946281&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14985&quot; title=&quot;Slow indexing and search performance when using HttpClusterStateProvider&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14985&quot;&gt;&lt;del&gt;SOLR-14985&lt;/del&gt;&lt;/a&gt;: CloudSolrClient with Solr URLs wasn&apos;t caching state (#2571)&lt;/p&gt;

&lt;p&gt;Solrj CloudSolrClient with Solr URLs had serious performance regressions (since the beginning?) in which its collection state cache was not being used, resulting in many extra requests to Solr for cluster information. (Aparna Suresh, shalin, David Smiley)&lt;/p&gt;

&lt;p&gt;Co-authored-by: Shalin Shekhar Mangar &amp;lt;shalin@apache.org&amp;gt;&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 88fa6208c0f2b8cf4b936295940bbe4b39cb778c)&lt;/p&gt;</comment>
                            <comment id="17872092" author="dsmiley" created="Thu, 8 Aug 2024 18:09:22 +0000"  >&lt;p&gt;Thanks Aparna, &amp;amp; Shalin!&lt;/p&gt;

&lt;p&gt;Note that there are other linked JIRAs to address additional performance concerns. &#160;This is not the only one.&lt;/p&gt;</comment>
                            <comment id="17921876" author="anshumg" created="Tue, 28 Jan 2025 22:17:45 +0000"  >&lt;p&gt;Closing after the 9.8.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13337518">SOLR-14966</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13337520">SOLR-14967</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13587052">SOLR-17381</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            41 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z0kbig:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>