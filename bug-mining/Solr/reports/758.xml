<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:25:07 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-1520] QueryElevationComponent does not work when unique key is of type &apos;sint&apos;</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1520</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;QueryElevationComponent does not work when unique key of the documents is of type &apos;sint&apos;. I did not try any other combination, but when I looking at the source in QueryElevationComponent.java I doubt it will work with any other type than string.&lt;/p&gt;

&lt;p&gt;I propose to either make it work with other data types or at least to post a warning.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Gentoo Linux, Apache Tomcat 6.0.20, Java 1.6.0_15-b03&lt;/p&gt;</environment>
        <key id="12438782">SOLR-1520</key>
            <summary>QueryElevationComponent does not work when unique key is of type &apos;sint&apos;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="gsingers">Grant Ingersoll</assignee>
                                    <reporter username="slachinger">Simon Lachinger</reporter>
                        <labels>
                    </labels>
                <created>Thu, 22 Oct 2009 06:56:32 +0000</created>
                <updated>Fri, 10 May 2013 10:38:36 +0000</updated>
                            <resolved>Mon, 19 Dec 2011 21:57:30 +0000</resolved>
                                    <version>1.3</version>
                                    <fixVersion>3.6</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                    <component>Rules</component>
                    <component>search</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                    <workratio workratioPercent="0"/>
                                    <progress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="0">
                                    <originalProgress>
                                                    <row percentage="100" backgroundColor="#89afd7"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="0" backgroundColor="#51a825"/>
                                                    <row percentage="100" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                    <timeoriginalestimate seconds="3600">1h</timeoriginalestimate>
                            <timeestimate seconds="3600">1h</timeestimate>
                                        <comments>
                            <comment id="12768800" author="hossman" created="Thu, 22 Oct 2009 18:18:03 +0000"  >&lt;p&gt;At first glance, this seems like it could be fixed by changing the two &quot;new TermQuery&quot; lines to use FIeldType.readableToIndexed() ... but there&apos;s also some funky stuff going on in ElevationComparatorSource that makes me think it&apos;s probably not that easy ... particularly the use of getStringIndex which suggests that the Trie Fields definitely won&apos;t work.&lt;/p&gt;

&lt;p&gt;Anyone have any suggestions on a true fix for this, or at least a way to make it fail cleanly with a good error message about the uniqueKey field type expectations that it has?&lt;/p&gt;</comment>
                            <comment id="12884053" author="gsingers" created="Wed, 30 Jun 2010 20:30:20 +0000"  >&lt;p&gt;Seems like this should work for any non-analyzed field that is the id field, right?&lt;/p&gt;</comment>
                            <comment id="12884076" author="gsingers" created="Wed, 30 Jun 2010 22:15:09 +0000"  >&lt;p&gt;Here&apos;s a start on this, but I&apos;m at a loss as to the best way to test it works b/c I&apos;m not up on how to deal with needing multiple schema files (b/c I need to change unique keys)&lt;/p&gt;</comment>
                            <comment id="12884814" author="gsingers" created="Fri, 2 Jul 2010 21:28:12 +0000"  >&lt;p&gt;IRC log:&lt;/p&gt;
&lt;blockquote&gt;
&lt;p&gt;gsingers: I need to test solr w/ multiple unique keys&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;16:48&amp;#93;&lt;/span&gt; gsingers: of different field types&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;16:48&amp;#93;&lt;/span&gt; gsingers: &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-1520&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;https://issues.apache.org/jira/browse/SOLR-1520&lt;/a&gt;&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;16:48&amp;#93;&lt;/span&gt; gsingers: any suggestions?&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;16:49&amp;#93;&lt;/span&gt; gsingers: seems like the Solr test case is pretty much one schema per&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;16:49&amp;#93;&lt;/span&gt; gsingers: test class&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:18&amp;#93;&lt;/span&gt; ThetaPh1: gsingers: is getStringIndex otherwise used in this, as Hoss mentioned?&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:18&amp;#93;&lt;/span&gt; ThetaPh1: because lese it should work also with numeric fields and also sint, tint,...&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:21&amp;#93;&lt;/span&gt; gsingers: ThetaPh1: I don&apos;t think getStringIndex is used anymore&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:22&amp;#93;&lt;/span&gt; hossman: grant: there&apos;s a new JUnit4-esque base class that makes it easier to use differnet configs in each test method ... you just call initCore(...) as needed in each test method&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:22&amp;#93;&lt;/span&gt; ThetaPh1: or in trunk the replacement...&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:22&amp;#93;&lt;/span&gt; yonik__: getStringIndex is gone in trunk&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:22&amp;#93;&lt;/span&gt; gsingers: it does still do FieldCache stuff&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:22&amp;#93;&lt;/span&gt; ThetaPh1: yonik__: but the bytesref one?&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:22&amp;#93;&lt;/span&gt; gsingers: but it is just BytesRef&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:22&amp;#93;&lt;/span&gt; ThetaPh1: that is what i meant&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:22&amp;#93;&lt;/span&gt; yonik__: gsingers: for schemas, just use schema11.xml - it has a float (actually sfloat) unique key&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:23&amp;#93;&lt;/span&gt; gsingers: yonik: OK, I can do that.  This should work for any field that is not tokenized, right?&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:23&amp;#93;&lt;/span&gt; gsingers: as long as it is indexed&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:23&amp;#93;&lt;/span&gt; yonik__: other code paths test the transformation from indexed to readable and back... it&apos;s enough to test a single key that has a readable that is not identical to indexed&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:24&amp;#93;&lt;/span&gt; yonik__: strictly speaking, tokenized should be fine too&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:24&amp;#93;&lt;/span&gt; yonik__: or &lt;b&gt;can&lt;/b&gt; be fine I should say&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:24&amp;#93;&lt;/span&gt; gsingers: but what if you get multiple docs back?&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:24&amp;#93;&lt;/span&gt; markrmiller left the chat room. (Quit: Commit this!)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:24&amp;#93;&lt;/span&gt; gsingers: I was debating that&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:24&amp;#93;&lt;/span&gt; hossman: (FWIW: test like this are also possible with AbstractSolrTestCase &amp;#8211; you just change the value getSchemaFile() returns before calling super.setUp(), but it&apos;s more explicit in the new base class)&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:25&amp;#93;&lt;/span&gt; gsingers: maybe it simply means elevate all those files&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:25&amp;#93;&lt;/span&gt; yonik__: it&apos;s just like sorting&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:25&amp;#93;&lt;/span&gt; gsingers: but, it is the unique key&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:25&amp;#93;&lt;/span&gt; yonik__: if you&apos;re using the field cache, you won&apos;t get more than one doc per value&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:25&amp;#93;&lt;/span&gt; gsingers: so, there shouldn&apos;t be more than one doc anyway&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:25&amp;#93;&lt;/span&gt; yonik__: right&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:25&amp;#93;&lt;/span&gt; yonik__: it actually could be tokenized, but should only result in one token&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:26&amp;#93;&lt;/span&gt; gsingers: true, but that&apos;s a bit harder to enforce&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:26&amp;#93;&lt;/span&gt; ThetaPh1: even when using getstringindex, trunk and 3.x should no longer throw exceptrion&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:26&amp;#93;&lt;/span&gt; ThetaPh1: 3.0 does, but this was incorrectly fixed &lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:26&amp;#93;&lt;/span&gt; gsingers: and seems like it could cause weird errors for people&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:26&amp;#93;&lt;/span&gt; yonik__: gsingers: we don&apos;t enforce it for the unique key&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:26&amp;#93;&lt;/span&gt; gsingers: OK&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:26&amp;#93;&lt;/span&gt; yonik__: I don&apos;t believe&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:26&amp;#93;&lt;/span&gt; ThetaPh1: and if you use tint as unique key, it should also work with stringindex ahm termsindex&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:26&amp;#93;&lt;/span&gt; yonik__: anyway, if it&apos;s enforced anywhere, that would be the place&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:26&amp;#93;&lt;/span&gt; gsingers: I&apos;m working on a diff. issue, anyone object to me c&amp;amp;p this onto the issue?&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:26&amp;#93;&lt;/span&gt; gsingers: so that I don&apos;t forget it&lt;br/&gt;
&lt;span class=&quot;error&quot;&gt;&amp;#91;17:27&amp;#93;&lt;/span&gt; yonik__: ?&lt;/p&gt;&lt;/blockquote&gt;</comment>
                            <comment id="13164817" author="gsingers" created="Wed, 7 Dec 2011 23:08:35 +0000"  >&lt;p&gt;Adds in tests for this against schema11.xml.  Should be close to ready to go.  For now, it requires a non-tokenized field for the id.&lt;/p&gt;</comment>
                            <comment id="13168655" author="gsingers" created="Tue, 13 Dec 2011 19:51:13 +0000"  >&lt;p&gt;Committed to trunk and branch&lt;/p&gt;</comment>
                            <comment id="13170422" author="gsingers" created="Thu, 15 Dec 2011 19:12:38 +0000"  >&lt;p&gt;This really should work with TrieFields too.&lt;/p&gt;</comment>
                            <comment id="13170430" author="gsingers" created="Thu, 15 Dec 2011 19:24:05 +0000"  >&lt;p&gt;The only issue is TrieField returns true for isTokenized() which causes the current approach to fail, but I guess we can just drop the isTokenized() requirement since it&apos;s somewhat undefined anyway what an multi-token id field means anyway.  So, I&apos;m just going to drop it and commit it w/ the only requirement being that the unique key exists.&lt;/p&gt;</comment>
                            <comment id="13170607" author="hossman" created="Fri, 16 Dec 2011 00:03:46 +0000"  >&lt;p&gt;Grant: i had to revert r1214937 as it was breaking several tests. example...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;java.lang.RuntimeException: org.apache.solr.common.SolrException
	at org.apache.solr.util.TestHarness.&amp;lt;init&amp;gt;(TestHarness.java:152)
	at org.apache.solr.util.TestHarness.&amp;lt;init&amp;gt;(TestHarness.java:135)
	at org.apache.solr.util.TestHarness.&amp;lt;init&amp;gt;(TestHarness.java:125)
	at org.apache.solr.SolrTestCaseJ4.initCore(SolrTestCaseJ4.java:245)
	at org.apache.solr.SolrTestCaseJ4.initCore(SolrTestCaseJ4.java:103)
	at org.apache.solr.SolrTestCaseJ4.initCore(SolrTestCaseJ4.java:92)
	at org.apache.solr.MinimalSchemaTest.beforeClass(MinimalSchemaTest.java:40)
Caused by: org.apache.solr.common.SolrException
	at org.apache.solr.core.SolrCore.&amp;lt;init&amp;gt;(SolrCore.java:619)
	at org.apache.solr.core.SolrCore.&amp;lt;init&amp;gt;(SolrCore.java:504)
	at org.apache.solr.util.TestHarness$Initializer.initialize(TestHarness.java:216)
	at org.apache.solr.util.TestHarness.&amp;lt;init&amp;gt;(TestHarness.java:140)
Caused by: org.apache.solr.common.SolrException: QueryElevationComponent requires the schema to have a uniqueKeyField.
	at org.apache.solr.handler.component.QueryElevationComponent.inform(QueryElevationComponent.java:161)
	at org.apache.solr.core.SolrResourceLoader.inform(SolrResourceLoader.java:542)
	at org.apache.solr.core.SolrCore.&amp;lt;init&amp;gt;(SolrCore.java:614)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;As i mentioned in email...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Grant: at quick skim suggests that your change to 
solr/core/src/test-files/solr/conf/solrconfig.xml in r1214937 broke 
several tests that use that config w/o a uniqueKey field.

At first glance, it&apos;s not even clear why you added that to the (heavily 
overused) solrconfig.xml anyway, since there is already a 
solrconfig-elevate.xml that is also used already.  (if the problem is 
wanting to use different based types in diff test methods, you could just 
instantiate multiple instances of QueryElevationComponent in 
solrconfig-elevate.xml and refer to them by name.
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13171110" author="gsingers" created="Fri, 16 Dec 2011 18:07:56 +0000"  >&lt;p&gt;Thanks, Hoss.  Forgot to run the full suite of tests.  The main reason I put it in the main config is that I wanted a trie field unique key and also b/c I want to leverage the existing Solr distributed tests for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2949&quot; title=&quot;QueryElevationComponent does not fully support distributed search&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2949&quot;&gt;&lt;del&gt;SOLR-2949&lt;/del&gt;&lt;/a&gt; (instead of writing another distributed test that requires spin up/tear down of shards and thus slows down the tests significantly)&lt;/p&gt;</comment>
                            <comment id="13171134" author="yseeley@gmail.com" created="Fri, 16 Dec 2011 18:58:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;I want to leverage the existing Solr distributed tests for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2949&quot; title=&quot;QueryElevationComponent does not fully support distributed search&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2949&quot;&gt;&lt;del&gt;SOLR-2949&lt;/del&gt;&lt;/a&gt; (instead of writing another distributed test that requires spin up/tear down of shards and thus slows down the tests significantly)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;+1 to that part.&lt;/p&gt;

&lt;p&gt;The &quot;test if a trie field works&quot; doesn&apos;t need to be distributed and can go somewhere else.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12509592">SOLR-2580</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12440539">SOLR-1558</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12506538" name="SOLR-1520.patch" size="26042" author="gsingers" created="Wed, 7 Dec 2011 23:08:35 +0000"/>
                            <attachment id="12448453" name="SOLR-1520.patch" size="2181" author="gsingers" created="Wed, 30 Jun 2010 22:15:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>517</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 49 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03q8v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19685</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>