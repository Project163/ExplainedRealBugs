<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:10:45 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-17340] Call to /solr/admin/info/system is abnormally slow</title>
                <link>https://issues.apache.org/jira/browse/SOLR-17340</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Solr endpoint &lt;tt&gt;/solr/admin/info/system&lt;/tt&gt; is used to return some generic system metrics (memory, JVM...)&lt;/p&gt;

&lt;p&gt;This endpoint is also used by &lt;tt&gt;solr-operator&lt;/tt&gt; by default for start-up probe and liveness probe. (details &lt;a href=&quot;https://github.com/apache/solr-operator/blob/5fec11f8ef181a58b1f72123b44ae6532c49b62d/controllers/util/solr_security_util.go#L44&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;here&lt;/a&gt;). Very long runtime can cause failures of the probes.&lt;/p&gt;

&lt;p&gt;Runtime is abnormally slow because of the time spent in introspecting beans to create &lt;tt&gt;BeanInfo&lt;/tt&gt; instances. Most of the time is spent here:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
java.lang.Exception: Stack trace
	at java.desktop/java.beans.Introspector.getBeanInfo(Introspector.java:279)
	at org.apache.solr.util.stats.MetricUtils.addMXBeanMetrics(MetricUtils.java:777)
	at org.apache.solr.util.stats.MetricUtils.addMXBeanMetrics(MetricUtils.java:841)
	at org.apache.solr.handler.admin.SystemInfoHandler.getSystemInfo(SystemInfoHandler.java:223)
	at org.apache.solr.handler.admin.SystemInfoHandler.handleRequestBody(SystemInfoHandler.java:156)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:248)
	at org.apache.solr.handler.admin.InfoHandler.handle(InfoHandler.java:96)
	at org.apache.solr.handler.admin.InfoHandler.handleRequestBody(InfoHandler.java:84)
	at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:248)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;There is no need to execute the bean introspection at each call. We could lazily instantiate them and keep them in memory for efficiency.&lt;/p&gt;

&lt;p&gt;Note: I haven&apos;t been able to figure out the exact cause, but the runtime can exponentially increase under heady querying load.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13583359">SOLR-17340</key>
            <summary>Call to /solr/admin/info/system is abnormally slow</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="pierre.salagnac">Pierre Salagnac</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Thu, 20 Jun 2024 16:50:17 +0000</created>
                <updated>Fri, 25 Oct 2024 17:18:55 +0000</updated>
                            <resolved>Mon, 22 Jul 2024 18:23:56 +0000</resolved>
                                    <version>9.6</version>
                                    <fixVersion>9.7</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="17860407" author="pierre.salagnac" created="Thu, 27 Jun 2024 09:57:07 +0000"  >&lt;p&gt;I&apos;m opening a pull request for this.&lt;/p&gt;

&lt;p&gt;I also ran a very naive benchmark on my laptop, with and without the fix, to validate there is a real improvement. After a warmup, it sequentially sends 10K requests to &lt;tt&gt;/info/system&lt;/tt&gt; endpoint and check runtimes.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
*** WITHOUT THE FIX ***
QTime &#160;: avg:1.022 max:13&#160;
Elapsed: avg:1.1593 max:51&#160;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
***  WITH THE FIX ***
QTime  : avg:0.0128 max:3 
Elapsed: avg:0.237 max:16 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Max times are not very relevant since there are lot of variations between runs. But I always see significant improvements in returned QTimes !&lt;/p&gt;</comment>
                            <comment id="17860641" author="ichattopadhyaya" created="Thu, 27 Jun 2024 20:26:28 +0000"  >&lt;p&gt;+1, sweet!&lt;/p&gt;</comment>
                            <comment id="17867833" author="jira-bot" created="Mon, 22 Jul 2024 18:12:13 +0000"  >&lt;p&gt;Commit 0da7a784353eefa9b37832bb6f557be81b7c03cf in solr&apos;s branch refs/heads/main from Pierre Salagnac&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=0da7a784353&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=0da7a784353&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17340&quot; title=&quot;Call to /solr/admin/info/system is abnormally slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17340&quot;&gt;&lt;del&gt;SOLR-17340&lt;/del&gt;&lt;/a&gt;: /admin/info/system optimization by caching BeanInfo (#2538)&lt;/p&gt;

&lt;p&gt;Note the prefix arg was always null, thus this one-line change is just a refactoring for correctness.&lt;/p&gt;</comment>
                            <comment id="17867836" author="jira-bot" created="Mon, 22 Jul 2024 18:15:51 +0000"  >&lt;p&gt;Commit c9da608800e7bd76a6aa7dbd0a753621232cd30d in solr&apos;s branch refs/heads/branch_9x from Pierre Salagnac&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=c9da608800e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=c9da608800e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17340&quot; title=&quot;Call to /solr/admin/info/system is abnormally slow&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17340&quot;&gt;&lt;del&gt;SOLR-17340&lt;/del&gt;&lt;/a&gt;: /admin/info/system optimization by caching BeanInfo (#2538)&lt;/p&gt;

&lt;p&gt;Note the prefix arg was always null, thus this one-line change is just a refactoring for correctness.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 0da7a784353eefa9b37832bb6f557be81b7c03cf)&lt;/p&gt;</comment>
                            <comment id="17867841" author="dsmiley" created="Mon, 22 Jul 2024 18:23:56 +0000"  >&lt;p&gt;Thanks; well done.&lt;/p&gt;</comment>
                            <comment id="17892936" author="anshumg" created="Fri, 25 Oct 2024 17:18:55 +0000"  >&lt;p&gt;Closing after the 9.7.0 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1px74:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>