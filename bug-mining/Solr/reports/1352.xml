<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:35:41 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4653] Solr configuration should log inaccessible/ non-existent relative paths &lt;lib dir=&quot;...&quot;&gt;</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4653</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Currently the dir path is resolved relative to core&apos;s instanceDir but if you don&apos;t know it nothing happens (no warning, no nothing). This is very frustrating.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12639780">SOLR-4653</key>
            <summary>Solr configuration should log inaccessible/ non-existent relative paths &lt;lib dir=&quot;...&quot;&gt;</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dweiss">Dawid Weiss</assignee>
                                    <reporter username="dweiss">Dawid Weiss</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Mar 2013 09:49:43 +0000</created>
                <updated>Mon, 9 May 2016 18:58:12 +0000</updated>
                            <resolved>Wed, 3 Apr 2013 06:42:41 +0000</resolved>
                                                    <fixVersion>4.3</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13617203" author="dweiss" created="Fri, 29 Mar 2013 09:51:36 +0000"  >&lt;p&gt;Correcting to just logging non-existing relative paths. Absolute paths work, my bad.&lt;/p&gt;</comment>
                            <comment id="13617242" author="rcmuir" created="Fri, 29 Mar 2013 10:55:06 +0000"  >&lt;p&gt;+1 to doing something other than silently not working. &lt;/p&gt;

&lt;p&gt;exception seems ideal to me, but logging would at least be something.&lt;/p&gt;</comment>
                            <comment id="13617253" author="erickerickson" created="Fri, 29 Mar 2013 11:21:01 +0000"  >&lt;p&gt;What! And take the sensitive, appropriate-for-your-aged-grandmother notes out of solrconfig.xml? To whit:&lt;/p&gt;

&lt;p&gt; &amp;lt;!-- If a &apos;dir&apos; option (with or without a regex) is used and nothing&lt;br/&gt;
       is found that matches, it will be ignored&lt;br/&gt;
    --&amp;gt;&lt;br/&gt;
  &amp;lt;lib dir=&quot;/total/crap/dir/ignored&quot; /&amp;gt; &lt;/p&gt;

&lt;p&gt;&amp;lt;G&amp;gt;....&lt;/p&gt;

&lt;p&gt;Which is more than a little inconsistent with what follows:&lt;/p&gt;


&lt;p&gt;  &amp;lt;!-- an exact &apos;path&apos; can be used instead of a &apos;dir&apos; to specify a &lt;br/&gt;
       specific jar file.  This will cause a serious error to be logged &lt;br/&gt;
       if it can&apos;t be loaded.&lt;br/&gt;
    --&amp;gt;&lt;br/&gt;
  &amp;lt;!--&lt;br/&gt;
     &amp;lt;lib path=&quot;../a-jar-that-does-not-exist.jar&quot; /&amp;gt; &lt;br/&gt;
  --&amp;gt;&lt;/p&gt;

&lt;p&gt;Why should failing to find a specific jar log a serious error but a directory be ignored?&lt;/p&gt;

&lt;p&gt;Seriously, let&apos;s complain if the dir isn&apos;t found, at least log a warning if not an error/exception. Fail early, fail often.&lt;/p&gt;</comment>
                            <comment id="13617256" author="thetaphi" created="Fri, 29 Mar 2013 11:28:42 +0000"  >&lt;p&gt;+1, fail early and often &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="13617275" author="yseeley@gmail.com" created="Fri, 29 Mar 2013 11:59:08 +0000"  >&lt;p&gt;+1 to logging.&lt;/p&gt;

&lt;p&gt;IIRC, it&apos;s not a hard fail so that lazy handlers like solr-cell can be supported, but you can still copy &quot;example&quot; to somewhere else and still have all the core stuff work.&lt;/p&gt;

&lt;p&gt;IMO, the larger issue is that we should come up with a better plugin mechanism and not have the stock server referencing outside jars.  Or if we have to, do it relative to some kind of $SOLR_INSTALL_DIR or something...&lt;/p&gt;</comment>
                            <comment id="13617278" author="dweiss" created="Fri, 29 Mar 2013 12:04:15 +0000"  >&lt;p&gt;I am leaning towards throwing an exception too. A warning should be emitted if the lib doesn&apos;t collect any jars (because that&apos;s odd too) but if it points at void it looks like an error and in most cases (experienced on my own) what follows is a class-not-found exception because something is referenced that should be loaded and wasn&apos;t.&lt;/p&gt;

&lt;p&gt;I agree with Yonik though that it&apos;d be nice to be able to reference based from solr&apos;s install dir. But then this may be problematic  if people deploy the war in other containers (I know, I know, it&apos;s a boo-hoo, but many people do it anyway).&lt;/p&gt;</comment>
                            <comment id="13618973" author="hossman" created="Mon, 1 Apr 2013 17:54:30 +0000"  >
&lt;p&gt;The original intent was:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;If users want solr to be very strict and fail loudly if your any of your plugin jars can&apos;t be found, then you should know what plugin jars you car about and use an explicit &quot;path&quot; option for each of them.&lt;/li&gt;
	&lt;li&gt;for the purposes of the example configs, we wanted something less strict so that (combined with the lazy load option on plugins) the example configs could refer to contrib jars and the bulk of the example configs would still work even if you didn&apos;t build any of those contribs, or moved/copied the example configs &amp;#8211; if you do either of those things, and then try to use any of those lazy loaded plugins, the lazy loading feature will give you a loud error.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;At this point, i don&apos;t have any strong opinions about changing any of this behavior to be a hard failure if the &quot;dir&quot; doesn&apos;t exist, or if the regex doesn&apos;t match anything &amp;#8211; the way the current build system works &quot;ant example&quot; already builds all of the contribs anyway regardless of wether you care about them, so the key concern is really just what would happen when people move/copy the example configs.&lt;/p&gt;

&lt;p&gt;I suspect that if we change this to cause a hard failure the number of users who might be confused/anoyed about why they are getting those errors when they move/copy the example configs (and need to remove those &amp;lt;lib/&amp;gt; directives) will probably be roughly the same as the number of users who (with the existing configs) are confused by the lazy loading errors they get trying to use DIH, or solr-cell, or /browse after they move/copy the configs today and have to go update where the &amp;lt;lib/&amp;gt; directives point at.&lt;/p&gt;</comment>
                            <comment id="13619009" author="yseeley@gmail.com" created="Mon, 1 Apr 2013 18:24:48 +0000"  >&lt;blockquote&gt;&lt;p&gt;for the purposes of the example configs, we wanted something less strict so that (combined with the lazy load option on plugins) the example configs could refer to contrib jars &lt;span class=&quot;error&quot;&gt;&amp;#91;...&amp;#93;&lt;/span&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Right.  This is really more a change in behavior than a bug fix, and it seems like we should be comprehensive and also deal with the reasons why it was added in the first place (i.e. we need to figure out what to do with the lazy loaded plugins like solr-cell).  Docs like the README under example, and &lt;a href=&quot;http://wiki.apache.org/solr/ExtractingRequestHandler&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/solr/ExtractingRequestHandler&lt;/a&gt; would also need to change.&lt;/p&gt;

&lt;p&gt;Changing to a hard fail has back compat issues too.  We have often recommended copying the &quot;example&quot; directory as a starting point, and most of those will be pointing to directores that don&apos;t exist.&lt;/p&gt;

&lt;p&gt;On balance it feels like not failing hard (i.e. keeping the current behavior, but adding logging) is the best middle ground right now.  If one does get a class-not-found exception, we&apos;ll have the better logging to help track it down.&lt;/p&gt;</comment>
                            <comment id="13619777" author="dweiss" created="Tue, 2 Apr 2013 13:08:16 +0000"  >&lt;p&gt;Thanks for clarification, Hoss. What you say makes sense but the common practice seems to be that:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;people modify the example&apos;s configuration files and overwrite them just because all the paths are relative from those directories and pointing at contribs,&lt;/li&gt;
	&lt;li&gt;when you want to create an isolate configuration and pass it to somebody to, say, run with -Dsolr.solr.home it&apos;s hard because you need to know absolute installation paths or make the user install that configuration in an exact folder under solr&apos;s unpacked structure. If they change anything &amp;#8211; boom, things don&apos;t work and nobody knows what&apos;s going on.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I think the middle ground here is to at least log a warning when a fileset is empty (and provide the basedir against which it was resolved). This looks suspicious and provides enough information to recover from the problem.&lt;/p&gt;</comment>
                            <comment id="13619874" author="dweiss" created="Tue, 2 Apr 2013 14:48:01 +0000"  >&lt;p&gt;This is my take at this having considered a few other alternatives. It logs this at startup currently:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Can&apos;t find (or read) directory to add to classloader: /total/crap/dir/ignored (resolved as: C:\Work\lucene-solr-svn\trunk\solr\example\solr\collection1\total\crap\dir\ignored).
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And indeed the example config contains:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;  &amp;lt;!-- If a &lt;span class=&quot;code-quote&quot;&gt;&apos;dir&apos;&lt;/span&gt; option (with or without a regex) is used and nothing
       is found that matches, it will be ignored
    --&amp;gt;
  &amp;lt;lib dir=&lt;span class=&quot;code-quote&quot;&gt;&quot;/total/crap/dir/ignored&quot;&lt;/span&gt; /&amp;gt; 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Perhaps the comment should be changed/ made more polite too.&lt;/p&gt;</comment>
                            <comment id="13619876" author="dweiss" created="Tue, 2 Apr 2013 14:48:56 +0000"  >&lt;p&gt;If no objections I&apos;ll commit this in a few hours.&lt;/p&gt;</comment>
                            <comment id="13619898" author="thetaphi" created="Tue, 2 Apr 2013 14:59:05 +0000"  >&lt;p&gt;Just one additional idea: There are comments about the regex in the current code and complexity for users. How about using ANT-style filesets for specifying the lib dirs? We dont need ANT for that, just plexus-utils-1.1.jar from Maven, which contains DirectoryScanner that is able to parse things like &lt;tt&gt;&amp;#42;&amp;#42;/&amp;#42;.jar&lt;/tt&gt;. I use that in the fobidden APIs CLI and Mojo classes: &lt;a href=&quot;https://code.google.com/p/forbidden-apis/source/browse/trunk/src/main/java/de/thetaphi/forbiddenapis/CliMain.java#257&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://code.google.com/p/forbidden-apis/source/browse/trunk/src/main/java/de/thetaphi/forbiddenapis/CliMain.java#257&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Otherwise +1 to commit!&lt;/p&gt;</comment>
                            <comment id="13619933" author="erickerickson" created="Tue, 2 Apr 2013 15:42:11 +0000"  >&lt;p&gt;+1 to making the message more polite. The rest of the patch too!&lt;/p&gt;</comment>
                            <comment id="13620093" author="dweiss" created="Tue, 2 Apr 2013 18:12:34 +0000"  >&lt;p&gt;I saw the comment about glob patterns, Uwe. I just won&apos;t have the time to do it thoroughly (with proper testing etc.) so I&apos;d rather file another issue for it. If somebody can get there sooner, fine. If not, I&apos;ll fix it in my spare cycles at some point.&lt;/p&gt;</comment>
                            <comment id="13620415" author="janhoy" created="Tue, 2 Apr 2013 23:47:52 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dweiss&quot; class=&quot;user-hover&quot; rel=&quot;dweiss&quot;&gt;dweiss&lt;/a&gt; logging proposal is ok.&lt;/p&gt;

&lt;p&gt;However, a better way would be to fail hard (can be made back-compat by checking luceneMatchVersion and log only for &amp;lt;4.3). In that case how we include contrib libs should change somehow. Perhaps something like this:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&amp;lt;lib&amp;gt;${solr.contrib.root}/extraction/lib&amp;lt;/lib&amp;gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;If user supplies -Dsolr.contrib.root=/path/to/contrib then stuff will work. If nothing is passed by opts we could default to something that would work for the shipped example config.&lt;/p&gt;

&lt;p&gt;Also see my proposal in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4495&quot; title=&quot;solr.xml sharedLib attribute should take a list of paths&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4495&quot;&gt;&lt;del&gt;SOLR-4495&lt;/del&gt;&lt;/a&gt;. For most of my multi-core deploys I don&apos;t bother adding lib entries to all cores, but use a single sharedLib=${solr.solr.home}/lib in solr.xml. Allowing multiple sharedLib dirs in solr.xml would allow for more flexible config.&lt;/p&gt;</comment>
                            <comment id="13620671" author="dweiss" created="Wed, 3 Apr 2013 06:38:27 +0000"  >&lt;p&gt;This (the variable substitution) should also work as far as I&apos;m concerned because variables are substituted globally in all text nodes. That&apos;s my understanding of the code, didn&apos;t check on a live instance. So if you passed ${solr.contrib.root} and it doesn&apos;t point anywhere you&apos;d get a warning in the logs.&lt;/p&gt;

&lt;p&gt;Since some folks expressed their concern about failing hard (and it was actually documented that it won&apos;t fail hard) I think it makes sense to preserve this behavior, at least in the same Solr line (4.x). Perhaps another issue changing this behavior should be filed for 5.x.&lt;/p&gt;</comment>
                            <comment id="13653925" author="thetaphi" created="Fri, 10 May 2013 10:33:26 +0000"  >&lt;p&gt;Closed after release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="12640449">SOLR-4665</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12646611">SOLR-4801</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="12650533">SOLR-4890</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12576585" name="SOLR-4653.patch" size="3802" author="dweiss" created="Tue, 2 Apr 2013 14:48:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320249</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1j98n:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>320590</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>