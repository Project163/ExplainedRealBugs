<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:08:15 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-8170] TestFiltering.testRandomFiltering() failures</title>
                <link>https://issues.apache.org/jira/browse/SOLR-8170</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;My Jenkins found a couple 100% reproducible failures recently on trunk:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; 6537 ERROR (TEST-TestFiltering.testRandomFiltering-seed#[7BCB61B11BC4B74E]) [    ] o.a.s.SolrTestCaseJ4 query failed JSON validation. error=mismatch: &apos;1&apos;!=&apos;2&apos; @ facet_counts/facet_queries/facetQuery
   [junit4]   2&amp;gt;  expected =/facet_counts/facet_queries/facetQuery/==1
   [junit4]   2&amp;gt;  response = {
   [junit4]   2&amp;gt;   &quot;responseHeader&quot;:{
   [junit4]   2&amp;gt;     &quot;status&quot;:0,
   [junit4]   2&amp;gt;     &quot;QTime&quot;:0},
   [junit4]   2&amp;gt;   &quot;response&quot;:{&quot;numFound&quot;:1,&quot;start&quot;:0,&quot;docs&quot;:[
   [junit4]   2&amp;gt;       {
   [junit4]   2&amp;gt;         &quot;id&quot;:&quot;8&quot;,
   [junit4]   2&amp;gt;         &quot;val_i&quot;:8,
   [junit4]   2&amp;gt;         &quot;val_s&quot;:&quot;00008&quot;}]
   [junit4]   2&amp;gt;   },
   [junit4]   2&amp;gt;   &quot;facet_counts&quot;:{
   [junit4]   2&amp;gt;     &quot;facet_queries&quot;:{
   [junit4]   2&amp;gt;       &quot;*:*&quot;:1,
   [junit4]   2&amp;gt;       &quot;multiSelect&quot;:1,
   [junit4]   2&amp;gt;       &quot;facetQuery&quot;:2},
   [junit4]   2&amp;gt;     &quot;facet_fields&quot;:{},
   [junit4]   2&amp;gt;     &quot;facet_dates&quot;:{},
   [junit4]   2&amp;gt;     &quot;facet_ranges&quot;:{},
   [junit4]   2&amp;gt;     &quot;facet_intervals&quot;:{},
   [junit4]   2&amp;gt;     &quot;facet_heatmaps&quot;:{}}}
   [junit4]   2&amp;gt; 
   [junit4]   2&amp;gt;  request = facet.query=*:*&amp;amp;facet.query={!key%3DmultiSelect+ex%3Dt}*:*&amp;amp;facet.query={!key%3DfacetQuery+cache%3Dfalse+cost%3D144}+-val_i:0+-val_i:1+-val_i:2+-val_i:7&amp;amp;q=val_s:[00008+TO+00009}&amp;amp;facet=true&amp;amp;wt=xml
   [junit4]   2&amp;gt; 6538 ERROR (TEST-TestFiltering.testRandomFiltering-seed#[7BCB61B11BC4B74E]) [    ] o.a.s.SolrTestCaseJ4 java.lang.RuntimeException: mismatch: &apos;1&apos;!=&apos;2&apos; @ facet_counts/facet_queries/facetQuery
   [junit4]   2&amp;gt;        at org.apache.solr.SolrTestCaseJ4.assertJQ(SolrTestCaseJ4.java:854)
   [junit4]   2&amp;gt;        at org.apache.solr.SolrTestCaseJ4.assertJQ(SolrTestCaseJ4.java:801)
   [junit4]   2&amp;gt;        at org.apache.solr.search.TestFiltering.testRandomFiltering(TestFiltering.java:408)
[...] 
   [junit4]   2&amp;gt; 6538 ERROR (TEST-TestFiltering.testRandomFiltering-seed#[7BCB61B11BC4B74E]) [    ] o.a.s.SolrTestCaseJ4 FAILURE: indexSize=9 iiter=1 qiter=54 request=[q, val_s:[00008 TO 00009}, facet, true, facet.query, *:*, facet.query, {!key=multiSelect ex=t}*:*, facet.query, {!key=facetQuery cache=false cost=144} -val_i:0 -val_i:1 -val_i:2 -val_i:7]
[...]
   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=TestFiltering -Dtests.method=testRandomFiltering -Dtests.seed=7BCB61B11BC4B74E -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=zh -Dtests.timezone=Pacific/Kiritimati -Dtests.asserts=true -Dtests.file.encoding=ISO-8859-1
   [junit4] FAILURE 1.36s J8  | TestFiltering.testRandomFiltering &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: FAILURE: indexSize=9 iiter=1 qiter=54 request=[q, val_s:[00008 TO 00009}, facet, true, facet.query, *:*, facet.query, {!key=multiSelect ex=t}*:*, facet.query, {!key=facetQuery cache=false cost=144} -val_i:0 -val_i:1 -val_i:2 -val_i:7]
   [junit4]    &amp;gt; 	at __randomizedtesting.SeedInfo.seed([7BCB61B11BC4B74E:64A8C274FEE3F747]:0)
   [junit4]    &amp;gt; 	at org.apache.solr.search.TestFiltering.testRandomFiltering(TestFiltering.java:419)
   [junit4]    &amp;gt; 	at java.lang.Thread.run(Thread.java:745)
[...]
   [junit4]   2&amp;gt; NOTE: leaving temporary files on disk at: /home/sarowe/svn/lucene/dev/trunk/solr/build/solr-core/test/J0/temp/solr.search.TestFiltering_7BCB61B11BC4B74E-002
   [junit4]   2&amp;gt; NOTE: test params are: codec=Asserting(Lucene53): {val_i=FST50, val_s=Lucene50(blocksize=128), id=FST50}, docValues:{}, sim=ClassicSimilarity, locale=zh, timezone=Pacific/Kiritimati
   [junit4]   2&amp;gt; NOTE: Linux 4.1.0-custom2-amd64 amd64/Oracle Corporation 1.8.0_45 (64-bit)/cpus=16,threads=1,free=240471544,total=348127232
   [junit4]   2&amp;gt; NOTE: All tests run in this JVM: [TestFiltering]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;   [junit4]   2&amp;gt; 3327 ERROR (TEST-TestFiltering.testRandomFiltering-seed#[5176E993981660E9]) [    ] o.a.s.SolrTestCaseJ4 query failed JSON validation. error=mismatch: &apos;0&apos;!=&apos;1&apos; @ facet_counts/facet_queries/facetQuery
   [junit4]   2&amp;gt;  expected =/facet_counts/facet_queries/facetQuery/==0
   [junit4]   2&amp;gt;  response = {
   [junit4]   2&amp;gt;   &quot;responseHeader&quot;:{
   [junit4]   2&amp;gt;     &quot;status&quot;:0,
   [junit4]   2&amp;gt;     &quot;QTime&quot;:0},
   [junit4]   2&amp;gt;   &quot;response&quot;:{&quot;numFound&quot;:1,&quot;start&quot;:0,&quot;docs&quot;:[
   [junit4]   2&amp;gt;       {
   [junit4]   2&amp;gt;         &quot;id&quot;:&quot;0&quot;,
   [junit4]   2&amp;gt;         &quot;val_i&quot;:0,
   [junit4]   2&amp;gt;         &quot;val_s&quot;:&quot;00000&quot;}]
   [junit4]   2&amp;gt;   },
   [junit4]   2&amp;gt;   &quot;facet_counts&quot;:{
   [junit4]   2&amp;gt;     &quot;facet_queries&quot;:{
   [junit4]   2&amp;gt;       &quot;*:*&quot;:1,
   [junit4]   2&amp;gt;       &quot;multiSelect&quot;:1,
   [junit4]   2&amp;gt;       &quot;facetQuery&quot;:1},
   [junit4]   2&amp;gt;     &quot;facet_fields&quot;:{},
   [junit4]   2&amp;gt;     &quot;facet_dates&quot;:{},
   [junit4]   2&amp;gt;     &quot;facet_ranges&quot;:{},
   [junit4]   2&amp;gt;     &quot;facet_intervals&quot;:{},
   [junit4]   2&amp;gt;     &quot;facet_heatmaps&quot;:{}}}
   [junit4]   2&amp;gt; 
   [junit4]   2&amp;gt;  request = facet.query=*:*&amp;amp;facet.query={!key%3DmultiSelect+ex%3Dt}*:*&amp;amp;facet.query={!key%3DfacetQuery}-_query_:&quot;{!frange+v%3Dval_i+l%3D0+u%3D1}&quot;&amp;amp;q={!+tag%3Dt}val_s:[00000+TO+00001}&amp;amp;facet=true&amp;amp;wt=xml
   [junit4]   2&amp;gt; 3328 ERROR (TEST-TestFiltering.testRandomFiltering-seed#[5176E993981660E9]) [    ] o.a.s.SolrTestCaseJ4 java.lang.RuntimeException: mismatch: &apos;0&apos;!=&apos;1&apos; @ facet_counts/facet_queries/facetQuery
   [junit4]   2&amp;gt;        at org.apache.solr.SolrTestCaseJ4.assertJQ(SolrTestCaseJ4.java:854)
   [junit4]   2&amp;gt;        at org.apache.solr.SolrTestCaseJ4.assertJQ(SolrTestCaseJ4.java:801)
   [junit4]   2&amp;gt;        at org.apache.solr.search.TestFiltering.testRandomFiltering(TestFiltering.java:408)
[...]
   [junit4]   2&amp;gt; 3328 ERROR (TEST-TestFiltering.testRandomFiltering-seed#[5176E993981660E9]) [    ] o.a.s.SolrTestCaseJ4 FAILURE: indexSize=1 iiter=4 qiter=164 request=[q, {! tag=t}val_s:[00000 TO 00001}, facet, true, facet.query, *:*, facet.query, {!key=multiSelect ex=t}*:*, facet.query, {!key=facetQuery}-_query_:&quot;{!frange v=val_i l=0 u=1}&quot;]
[...]
   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=TestFiltering -Dtests.method=testRandomFiltering -Dtests.seed=5176E993981660E9 -Dtests.slow=true -Dtests.linedocsfile=/home/jenkins/lucene-data/enwiki.random.lines.txt -Dtests.locale=zh -Dtests.timezone=Pacific/Kiritimati -Dtests.asserts=true -Dtests.file.encoding=ISO-8859-1
   [junit4] FAILURE 1.81s | TestFiltering.testRandomFiltering &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.AssertionError: FAILURE: indexSize=1 iiter=4 qiter=164 request=[q, {! tag=t}val_s:[00000 TO 00001}, facet, true, facet.query, *:*, facet.query, {!key=multiSelect ex=t}*:*, facet.query, {!key=facetQuery}-_query_:&quot;{!frange v=val_i l=0 u=1}&quot;]
   [junit4]    &amp;gt;        at __randomizedtesting.SeedInfo.seed([5176E993981660E9:4E154A567D3120E0]:0)
   [junit4]    &amp;gt;        at org.apache.solr.search.TestFiltering.testRandomFiltering(TestFiltering.java:419)
   [junit4]    &amp;gt;        at java.lang.Thread.run(Thread.java:745)
[...]
   [junit4]   2&amp;gt; NOTE: leaving temporary files on disk at: /home/sarowe/svn/lucene/dev/trunk/solr/build/solr-core/test/J0/temp/solr.search.TestFiltering_5176E993981660E9-001
   [junit4]   2&amp;gt; NOTE: test params are: codec=Asserting(Lucene53), sim=RandomSimilarityProvider(queryNorm=true,coord=crazy): {}, locale=zh, timezone=Pacific/Kiritimati
   [junit4]   2&amp;gt; NOTE: Linux 4.1.0-custom2-amd64 amd64/Oracle Corporation 1.8.0_45 (64-bit)/cpus=16,threads=1,free=292000448,total=382730240
   [junit4]   2&amp;gt; NOTE: All tests run in this JVM: [TestFiltering]
   [junit4] Completed [1/1] in 3.93s, 1 test, 1 failure &amp;lt;&amp;lt;&amp;lt; FAILURES!
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12906046">SOLR-8170</key>
            <summary>TestFiltering.testRandomFiltering() failures</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="sarowe">Steven Rowe</reporter>
                        <labels>
                    </labels>
                <created>Mon, 19 Oct 2015 19:31:19 +0000</created>
                <updated>Mon, 9 May 2016 18:58:17 +0000</updated>
                            <resolved>Tue, 20 Oct 2015 01:15:05 +0000</resolved>
                                                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="14963983" author="yseeley@gmail.com" created="Mon, 19 Oct 2015 20:20:23 +0000"  >&lt;p&gt;Any clues as to when this problem started?  Is it trunk only?&lt;br/&gt;
I&apos;ll start looking into it since I messed with term range queries in trunk in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8037&quot; title=&quot;speed up term range queries, use filter cache for embedded ranges&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8037&quot;&gt;&lt;del&gt;SOLR-8037&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="14963991" author="steve_rowe" created="Mon, 19 Oct 2015 20:26:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;Any clues as to when this problem started?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;The 5176E993981660E9 seed (one of the two failures in the description) was found by my Jenkins on Sept. 20th.  I can&apos;t find any currently reproducing seeds for this test any earlier than that on my, ASF or Policeman Jenkins.&lt;/p&gt;

&lt;p&gt;bqï¿½. Is it trunk only?&lt;/p&gt;

&lt;p&gt;I tried the two failing seeds with Java8 on branch_5x on my Jenkins box and neither reproduced.&lt;/p&gt;</comment>
                            <comment id="14964028" author="yseeley@gmail.com" created="Mon, 19 Oct 2015 20:49:18 +0000"  >&lt;p&gt;Hmmm, so one thing I notice is that both failures look like they involve pure negative queries... so maybe it wasn&apos;t my changes.  I&apos;ll keep digging.&lt;/p&gt;

&lt;p&gt;edit: scratch that... looks like the base doc set for faceting for the second fail you posted is of size 2, which is incorrect.  This definitely points back to this bug being my fault...&lt;/p&gt;</comment>
                            <comment id="14964348" author="jira-bot" created="Tue, 20 Oct 2015 01:12:57 +0000"  >&lt;p&gt;Commit 1709499 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yonik%40apache.org&quot; class=&quot;user-hover&quot; rel=&quot;yonik@apache.org&quot;&gt;yonik@apache.org&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1709499&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1709499&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8170&quot; title=&quot;TestFiltering.testRandomFiltering() failures&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8170&quot;&gt;&lt;del&gt;SOLR-8170&lt;/del&gt;&lt;/a&gt;: fix DocSetBuilder not removing doc 0 if it was deleted&lt;/p&gt;</comment>
                            <comment id="14964352" author="yseeley@gmail.com" created="Tue, 20 Oct 2015 01:15:05 +0000"  >&lt;p&gt;Found, fixed, committed.&lt;br/&gt;
Classic boundary bug... if document #0 was deleted, it wasn&apos;t removed from the produced DocSet.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 5 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2n7cv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>