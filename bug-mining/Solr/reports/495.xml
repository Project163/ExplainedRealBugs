<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:19:33 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-1914] phps and json outputs illegal numeric values for NaN and +/- Infinity</title>
                <link>https://issues.apache.org/jira/browse/SOLR-1914</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;(first of all Solr Rocks!)&lt;br/&gt;
iam runnig an e-comerce application with dynamic filteset, depend on selected categories.&lt;br/&gt;
everything works fine and stable but today i found out that ther is a strange case:&lt;/p&gt;

&lt;p&gt;i guess around 5000 strings in my app used as facet filter. There is one String &quot;transluzentes Acryl&quot; and even the english  translation &quot;Translucent acrylics&quot; are not working.&lt;/p&gt;

&lt;p&gt;QUERY:&lt;br/&gt;
&lt;a href=&quot;http://ff01:8983/solr/core1/select/?q=*:*&amp;amp;fq=shop_id:10&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://ff01:8983/solr/core1/select/?q=*:*&amp;amp;fq=shop_id:10&lt;/a&gt; AND language:2 AND category_1:&quot;Badewannen&quot; AND material:&quot;transluzentes Acryl&quot;&amp;amp;facet=on&amp;amp;facet.limit=400&amp;amp;facet.field=category_1&amp;amp;facet.field=category_2&amp;amp;facet.field=manu&amp;amp;facet.field=length&amp;amp;facet.field=width&amp;amp;facet.field=height&amp;amp;facet.field=color&amp;amp;facet.field=material&amp;amp;facet.field=delivery&amp;amp;facet.field=attributes&amp;amp;facet.mincount=1&amp;amp;facet.sort=lex&amp;amp;facet.method=fc&amp;amp;stats=true&amp;amp;stats.field=price&amp;amp;start=0&amp;amp;rows=50&amp;amp;sort=sort+desc&amp;amp;fl=name,model_nr,image,url,manu,delivery,in_stock,serie,price,uvp,nav_id,template,option,name,model_nr,image,url,manu,delivery,in_stock,serie,price,uvp,nav_id,template,option&amp;amp;wt=phps&amp;amp;V=1.0&amp;amp;version=2.2&lt;/p&gt;

&lt;p&gt;RESPONSE: as xml and php works fine! but json , phps ends up like this.&lt;br/&gt;
.....s:2:&quot;fq&quot;;s:79:&quot;shop_id:10 AND language:2 AND category_1:&quot;Badewannen&quot; AND material:&quot;transluzentes Acryl&quot;&quot;;......&lt;br/&gt;
see that double qoutes at the end.&lt;/p&gt;

&lt;p&gt;That happens only on this strings or Docs because even the english Docs fails. I though its may be a matter of encoding, so i added a transformer in the DIH which  replaced these strings with &quot;Hello World&quot;.&lt;br/&gt;
Faces on &quot;Hello Wolrd&quot; fails. Other Facet Strings with white spaces, special chars and so on never fail. &lt;/p&gt;

&lt;p&gt;if i add brackets on the fq &lt;br/&gt;
...q=&lt;b&gt;:&lt;/b&gt;&amp;amp;fq=shop_id:10 AND language:2 AND category_1:&quot;Badewannen&quot; AND material:&quot;transluzentes Acryl&quot;&amp;amp;facet=on&amp;amp;...&lt;br/&gt;
it ends up with a double }}&lt;br/&gt;
s:2:&quot;fq&quot;;s:79:&quot;shop_id:20 AND language:2 AND category_1:&quot;Badewannen&quot; AND material:&quot;Hallo Welt&quot;&quot;;}}&lt;/p&gt;

</description>
                <environment>&lt;p&gt;apache Solr 1.4, Jetty (out of the box).  e-comerce application UTF-8&lt;/p&gt;</environment>
        <key id="12464524">SOLR-1914</key>
            <summary>phps and json outputs illegal numeric values for NaN and +/- Infinity</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="yseeley@gmail.com">Yonik Seeley</assignee>
                                    <reporter username="sajo">Sascha Jovanoski</reporter>
                        <labels>
                    </labels>
                <created>Fri, 14 May 2010 12:19:46 +0000</created>
                <updated>Wed, 30 Mar 2011 15:45:58 +0000</updated>
                            <resolved>Fri, 7 Jan 2011 22:51:31 +0000</resolved>
                                    <version>1.4</version>
                                    <fixVersion>3.1</fixVersion>
                    <fixVersion>4.0-ALPHA</fixVersion>
                                    <component>clients - php</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="12867522" author="yseeley@gmail.com" created="Fri, 14 May 2010 15:12:53 +0000"  >&lt;p&gt;It&apos;s not clear if this is a Solr bug, or just some bug in the e-commerce app.&lt;/p&gt;

&lt;p&gt;The double quote at the end looks fine... one quote is literally part of the string, the other quote is from the phps encoding.  The first string with length (s:79) doesn&apos;t look like it matches that actual string value, but I assume maybe you edited the example by hand.&lt;/p&gt;</comment>
                            <comment id="12868128" author="sajo" created="Mon, 17 May 2010 08:24:57 +0000"  >&lt;p&gt;thx so far,&lt;/p&gt;

&lt;p&gt;i did some tests. i will  attach the full request/response at the end.&lt;/p&gt;

&lt;p&gt;i guess if i do a request and get an response including 3 hits its fine so far.&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;&amp;amp;wt=phps php(5) unserialize it&apos;s FALSE&lt;/li&gt;
	&lt;li&gt;&amp;amp;wt=json  php(5) json_decode it&apos;s FALSE&lt;/li&gt;
	&lt;li&gt;&amp;amp;wt=xml  php(5) simplexml_load_string it&apos;s TRUE&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;i cant imagine  an app bug, so i did a standalone test.&lt;br/&gt;
the doccontents should be valid UTF-8, database is complete UTF-8, indexing is by DIH mysql direct.&lt;br/&gt;
also tried some characters encodings before&lt;/p&gt;

&lt;p&gt;i also can choose wt=xml but the facet-names in the result of  simplexml_load_string ar gone only a numeric key and the count will left from the facets.&lt;/p&gt;
</comment>
                            <comment id="12868270" author="yseeley@gmail.com" created="Mon, 17 May 2010 16:25:43 +0000"  >&lt;p&gt;One issue I see is an NaN in the JSON response... unfortunately the JSON standard has no way of representing Nan, +/-Inf.  We should encode this as a string instead.&lt;br/&gt;
Anyone know if PHPS has a numeric representation for these values?&lt;/p&gt;

&lt;p&gt;Sascha, is this the only incorrect part of the JSON / PHPS output or do you see any other issues?&lt;/p&gt;</comment>
                            <comment id="12868439" author="sajo" created="Mon, 17 May 2010 23:13:53 +0000"  >&lt;p&gt;hi Yonik, &lt;/p&gt;

&lt;p&gt;yes you are right! if i replace or escape this NaN, erverthing works fine and Solr still rocks.&lt;br/&gt;
i was so focused on that strings and maybe wrong app encodings that it took me until today to see that unescaped NaN.&lt;/p&gt;

&lt;p&gt;i played around with that  stats but i cant get this error simulate on other queries, i mean my problem case include three items with the same price.&lt;br/&gt;
I did other request which response with items with the same price but i got  a stddev of 0.0. that looks strange from outside the code.&lt;/p&gt;

&lt;p&gt;so i dont see any other issues in my app, thanks a lot !!!!!&lt;/p&gt;

</comment>
                            <comment id="12874575" author="yseeley@gmail.com" created="Wed, 2 Jun 2010 13:34:08 +0000"  >&lt;p&gt;Looks like this was sort of fixed for Python &amp;amp; Ruby back in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-449&quot; title=&quot;python (and presumably ruby) writer can generate NaN&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-449&quot;&gt;&lt;del&gt;SOLR-449&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
I haven&apos;t had much luck finding a way to express them in PHP... I guess the default for all JSON subclasses should just write as a String.&lt;/p&gt;</comment>
                            <comment id="12874635" author="yseeley@gmail.com" created="Wed, 2 Jun 2010 16:15:23 +0000"  >&lt;p&gt;Here&apos;s a patch w/ test that writes the special values as a String, in the format the Java uses.&lt;br/&gt;
&quot;NaN&quot;,&quot;-Infinity&quot;,&quot;Infinity&quot;.  I plan on committing shortly to 4.0 and 3.1&lt;/p&gt;</comment>
                            <comment id="12979002" author="hossman" created="Fri, 7 Jan 2011 22:50:26 +0000"  >&lt;p&gt;Updating summary to clarify root of problem (and fix already committed)&lt;/p&gt;</comment>
                            <comment id="12979003" author="hossman" created="Fri, 7 Jan 2011 22:51:31 +0000"  >&lt;p&gt;Sascha: as Yonik already noted, he fixed this in teh 3x (and trunk) branches &amp;#8211; the fix does not exist in Solr 1.4.1, or on the (now abandoned) 1.5 branch.&lt;/p&gt;

&lt;p&gt;if you have other questions - please send them to the solr-user mailing list&lt;/p&gt;</comment>
                            <comment id="13013244" author="gsingers" created="Wed, 30 Mar 2011 15:45:58 +0000"  >&lt;p&gt;Bulk close for 3.1.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12493977">SOLR-2295</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12446150" name="SOLR-1949.patch" size="2223" author="yseeley@gmail.com" created="Wed, 2 Jun 2010 16:15:23 +0000"/>
                            <attachment id="12444647" name="ff01.xml" size="3235" author="sajo" created="Mon, 17 May 2010 08:35:47 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5563</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 34 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03nxz:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>19312</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>