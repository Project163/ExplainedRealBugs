<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:50:34 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16110] Using Schema/Config API breaks the File-Upload of Config Set File</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16110</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;After using the Schema/Config API to change the config/schema in a config set, the UPLOAD of a file to this config set does not work anymore.&lt;/p&gt;

&lt;p&gt;The Schema/Config API changes the metadata that is stored at the config set node.&lt;/p&gt;

&lt;p&gt;There is a &apos;{trusted=false}&apos; / &apos;{trusted=true} or an empty &quot;no utf8 Content&quot; but after the Schema/Config API call it is&#160; replaced by a single 0 byte. As a result the following upload of a file with Configset API throws a json parse error.&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Steps to reproduce&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;Run solr cloud example:&#160; solr -e cloud -p 8984 Create Config set from _default: &lt;a href=&quot;http://localhost:8984/solr/admin/configs?action=CREATE&amp;amp;name=test&amp;amp;baseName=_default&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8984/solr/admin/configs?action=CREATE&amp;amp;name=test&amp;amp;baseName=_default&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Create Collection with Config set &apos;test&apos;: &lt;a href=&quot;http://localhost:8984/solr/admin/collections?action=CREATE&amp;amp;name=test&amp;amp;collection.configName=test&amp;amp;numShards=1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8984/solr/admin/collections?action=CREATE&amp;amp;name=test&amp;amp;collection.configName=test&amp;amp;numShards=1&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;add field with Schema API call:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
curl -X POST -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Content-Type: application/json&apos;&lt;/span&gt; -i http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8984/solr/test/schema --data &apos;{
&lt;/span&gt;&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;add-field&quot;&lt;/span&gt;:{
&#160;&#160;&#160;&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;my-field&quot;&lt;/span&gt;,
&#160;&#160;&#160;&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;type&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;string&quot;&lt;/span&gt;,
&#160;&#160;&#160;&#160; &lt;span class=&quot;code-quote&quot;&gt;&quot;stored&quot;&lt;/span&gt;:&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt; }
}&apos;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Create a file test.json and try to upload it:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
curl -X POST --header &lt;span class=&quot;code-quote&quot;&gt;&quot;Content-Type:application/json&quot;&lt;/span&gt; --data-binary @test.json &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solr/admin/configs?action=UPLOAD&amp;amp;name=test&amp;amp;filePath=test.json&amp;amp;wt=xml&amp;amp;omitHeader=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Response:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&amp;lt;?xml version=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.0&quot;&lt;/span&gt; encoding=&lt;span class=&quot;code-quote&quot;&gt;&quot;UTF-8&quot;&lt;/span&gt;?&amp;gt;
&amp;lt;response&amp;gt;&amp;lt;lst name=&lt;span class=&quot;code-quote&quot;&gt;&quot;error&quot;&lt;/span&gt;&amp;gt;
&#160; &amp;lt;str name=&lt;span class=&quot;code-quote&quot;&gt;&quot;msg&quot;&lt;/span&gt;&amp;gt;JSON Parse Error: &lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt;=#0;,position=0 AFTER=&lt;span class=&quot;code-quote&quot;&gt;&apos;#0;&apos;&lt;/span&gt; BEFORE=&apos;&apos;&amp;lt;/str&amp;gt;
&#160; &amp;lt;str name=&lt;span class=&quot;code-quote&quot;&gt;&quot;trace&quot;&lt;/span&gt;&amp;gt;org.noggit.JSONParser$ParseException: JSON Parse Error: &lt;span class=&quot;code-object&quot;&gt;char&lt;/span&gt;=#0;,position=0 AFTER=&lt;span class=&quot;code-quote&quot;&gt;&apos;#0;&apos;&lt;/span&gt; BEFORE=&apos;&apos;
&#160; &#160; &#160; &#160; at org.noggit.JSONParser.err(JSONParser.java:452)
&#160; &#160; &#160; &#160; at org.noggit.JSONParser.handleNonDoubleQuoteString(JSONParser.java:819)
&#160; &#160; &#160; &#160; at org.noggit.JSONParser.next(JSONParser.java:1026)
&#160; &#160; &#160; &#160; at org.noggit.JSONParser.nextEvent(JSONParser.java:1073)
&#160; &#160; &#160; &#160; at org.noggit.ObjectBuilder.&amp;amp;lt;init&amp;amp;gt;(ObjectBuilder.java:84)
&#160; &#160; &#160; &#160; at org.apache.solr.common.util.Utils.lambda$&lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt;$1(Utils.java:356)
&#160; &#160; &#160; &#160; at org.apache.solr.common.util.Utils.fromJSON(Utils.java:319)
&#160; &#160; &#160; &#160; at org.apache.solr.common.util.Utils.fromJSON(Utils.java:305)
&#160; &#160; &#160; &#160; at org.apache.solr.handler.admin.ConfigSetsHandler.isCurrentlyTrusted(ConfigSetsHandler.java:328)
&#160; &#160; &#160; &#160; at org.apache.solr.handler.admin.ConfigSetsHandler.ensureOverwritingUntrustedConfigSet(ConfigSetsHandler.java:308)
&#160; &#160; &#160; &#160; at org.apache.solr.handler.admin.ConfigSetsHandler.createBaseZnode(ConfigSetsHandler.java:269)
&#160; &#160; &#160; &#160; at org.apache.solr.handler.admin.ConfigSetsHandler.handleConfigUploadRequest(ConfigSetsHandler.java:205)
&#160; &#160; &#160; &#160; at org.apache.solr.handler.admin.ConfigSetsHandler.handleRequestBody(ConfigSetsHandler.java:113)
&#160; &#160; &#160; &#160; at org.apache.solr.handler.RequestHandlerBase.handleRequest(RequestHandlerBase.java:216)
&#160; &#160; &#160; &#160; at org.apache.solr.servlet.HttpSolrCall.handleAdmin(HttpSolrCall.java:836)
&#160; &#160; &#160; &#160; at org.apache.solr.servlet.HttpSolrCall.handleAdminRequest(HttpSolrCall.java:800)
&#160; &#160; &#160; &#160; at org.apache.solr.servlet.HttpSolrCall.call(HttpSolrCall.java:545)
&#160; &#160; &#160; &#160; at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:427)
&#160; &#160; &#160; &#160; at org.apache.solr.servlet.SolrDispatchFilter.doFilter(SolrDispatchFilter.java:357)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.FilterHolder.doFilter(FilterHolder.java:201)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.ServletHandler$Chain.doFilter(ServletHandler.java:1601)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.ServletHandler.doHandle(ServletHandler.java:548)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:143)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.security.SecurityHandler.handle(SecurityHandler.java:600)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:235)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.session.SessionHandler.doHandle(SessionHandler.java:1624)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextHandle(ScopedHandler.java:233)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ContextHandler.doHandle(ContextHandler.java:1434)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:188)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.servlet.ServletHandler.doScope(ServletHandler.java:501)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.session.SessionHandler.doScope(SessionHandler.java:1594)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.nextScope(ScopedHandler.java:186)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ContextHandler.doScope(ContextHandler.java:1349)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ScopedHandler.handle(ScopedHandler.java:141)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.ContextHandlerCollection.handle(ContextHandlerCollection.java:191)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.InetAccessHandler.handle(InetAccessHandler.java:177)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.HandlerCollection.handle(HandlerCollection.java:146)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.rewrite.handler.RewriteHandler.handle(RewriteHandler.java:322)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.gzip.GzipHandler.handle(GzipHandler.java:763)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.handler.HandlerWrapper.handle(HandlerWrapper.java:127)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.Server.handle(Server.java:516)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpChannel.lambda$handle$1(HttpChannel.java:400)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpChannel.dispatch(HttpChannel.java:645)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpChannel.handle(HttpChannel.java:392)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.server.HttpConnection.onFillable(HttpConnection.java:277)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.io.AbstractConnection$ReadCallback.succeeded(AbstractConnection.java:311)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.io.FillInterest.fillable(FillInterest.java:105)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.io.ChannelEndPoint$1.run(ChannelEndPoint.java:104)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.runTask(EatWhatYouKill.java:338)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.doProduce(EatWhatYouKill.java:315)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.tryProduce(EatWhatYouKill.java:173)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.util.thread.strategy.EatWhatYouKill.run(EatWhatYouKill.java:131)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.util.thread.ReservedThreadExecutor$ReservedThread.run(ReservedThreadExecutor.java:409)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.util.thread.QueuedThreadPool.runJob(QueuedThreadPool.java:883)
&#160; &#160; &#160; &#160; at org.eclipse.jetty.util.thread.QueuedThreadPool$Runner.run(QueuedThreadPool.java:1034)
&#160; &#160; &#160; &#160; at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
&amp;lt;/str&amp;gt;
&#160; &amp;lt;&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; name=&lt;span class=&quot;code-quote&quot;&gt;&quot;code&quot;&lt;/span&gt;&amp;gt;500&amp;lt;/&lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt;&amp;gt;
&amp;lt;/lst&amp;gt;
&amp;lt;/response&amp;gt;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;&lt;b&gt;Expected Behavior&lt;/b&gt;&lt;/p&gt;

&lt;p&gt;The info at the zookeeper config set node &apos;trusted=true/false&apos; or &apos;no content &apos; is kept as it is.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13435386">SOLR-16110</key>
            <summary>Using Schema/Config API breaks the File-Upload of Config Set File</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="krisden">Kevin Risden</assignee>
                                    <reporter username="smoldenhauer">Steffen Moldenhauer</reporter>
                        <labels>
                    </labels>
                <created>Wed, 23 Mar 2022 15:19:30 +0000</created>
                <updated>Mon, 16 Oct 2023 06:39:56 +0000</updated>
                            <resolved>Thu, 5 May 2022 17:11:34 +0000</resolved>
                                    <version>8.11.1</version>
                                    <fixVersion>9.1</fixVersion>
                                    <component>SolrCloud</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="10800">3h</timespent>
                                <comments>
                            <comment id="17512433" author="smoldenhauer" created="Fri, 25 Mar 2022 15:19:19 +0000"  >&lt;p&gt;The ZkController.touchConfDir() is the place I found that is writing a&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[]{0}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;at the config set node. &lt;br/&gt;
Here&apos;s my patch suggestion &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13041613/13041613_SOLR-16110.patch&quot; title=&quot;SOLR-16110.patch attached to SOLR-16110&quot;&gt;SOLR-16110.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;br/&gt;
Reads the current content of the node and re-writes it into the node to keep the data.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17513848" author="smoldenhauer" created="Tue, 29 Mar 2022 06:44:00 +0000"  >&lt;p&gt;added a simple mock test in &lt;span class=&quot;nobr&quot;&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/attachment/13041706/13041706_SOLR-16110-1.patch&quot; title=&quot;SOLR-16110-1.patch attached to SOLR-16110&quot;&gt;SOLR-16110-1.patch&lt;sup&gt;&lt;img class=&quot;rendericon&quot; src=&quot;https://issues.apache.org/jira/images/icons/link_attachment_7.gif&quot; height=&quot;7&quot; width=&quot;7&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/sup&gt;&lt;/a&gt;&lt;/span&gt;&lt;/p&gt;</comment>
                            <comment id="17514013" author="epugh" created="Tue, 29 Mar 2022 11:14:22 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smoldenhauer&quot; class=&quot;user-hover&quot; rel=&quot;smoldenhauer&quot;&gt;smoldenhauer&lt;/a&gt; typically people open up PR&apos;s using Github against the github.com/apache/solr project to facilitate review.    Would you be open to doing this?  If not (and some people object!), then I&apos;ll happily take the patch as is &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;.   How would you like to be credited?&lt;/p&gt;</comment>
                            <comment id="17514497" author="smoldenhauer" created="Wed, 30 Mar 2022 07:49:39 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=epugh&quot; class=&quot;user-hover&quot; rel=&quot;epugh&quot;&gt;epugh&lt;/a&gt; I created the PR with the contents of the patch file. I hope I got it right. At least it showed up here automatically. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="17527185" author="epugh" created="Sun, 24 Apr 2022 14:00:19 +0000"  >&lt;p&gt;I did these steps before your patch, and things worked, which I didn&apos;t expect.  Notice, I DID have to turn on the security.   WOuld you mind retesting?   Your intuition of what the problem is makes sense to me, I just can&apos;t duplicate the error!   &lt;/p&gt;

&lt;p&gt;Test on Solr 8.11 branch&lt;br/&gt;
curl &quot;http://localhost:8983/solr/admin/configs?action=CREATE&amp;amp;name=test&amp;amp;baseName=_default&quot;&lt;br/&gt;
--&amp;gt; security alert&lt;/p&gt;

&lt;p&gt; bin/solr auth enable -type basicAuth -prompt true -z localhost:9983 -blockUnknown true&lt;br/&gt;
 --&amp;gt; admin/password&lt;/p&gt;

&lt;p&gt; curl -u admin:password &quot;http://localhost:8983/solr/admin/configs?action=CREATE&amp;amp;name=test&amp;amp;baseName=_default&quot;&lt;/p&gt;

&lt;p&gt; --&amp;gt; Works&lt;/p&gt;

&lt;p&gt; curl -u admin:password  &quot;http://localhost:8983/solr/admin/collections?action=CREATE&amp;amp;name=test&amp;amp;collection.configName=test&amp;amp;numShards=1&quot;&lt;/p&gt;

&lt;p&gt; --&amp;gt; WOrks&lt;/p&gt;

&lt;p&gt; curl -u admin:password  -X POST -H &apos;Content-Type: application/json&apos; -i &lt;a href=&quot;http://localhost:8983/solr/test/schema&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/test/schema&lt;/a&gt; --data &apos;{&lt;br/&gt;
  &quot;add-field&quot;:&lt;/p&gt;
{
     &quot;name&quot;:&quot;my-field&quot;,
     &quot;type&quot;:&quot;string&quot;,
     &quot;stored&quot;:true }
&lt;p&gt;}&apos;&lt;/p&gt;


&lt;p&gt;echo &apos;&lt;/p&gt;
{&quot;hello&quot;:&quot;world&quot;}
&lt;p&gt;&apos; &amp;gt; test.json&lt;/p&gt;

&lt;p&gt;--&amp;gt; WOrks&lt;/p&gt;

&lt;p&gt;curl -u admin:password  -X POST --header &quot;Content-Type:application/json&quot; --data-binary @test.json &quot;http://localhost:8983/solr/admin/configs?action=UPLOAD&amp;amp;name=test&amp;amp;filePath=test.json&quot;&lt;/p&gt;


</comment>
                            <comment id="17527514" author="smoldenhauer" created="Mon, 25 Apr 2022 14:00:45 +0000"  >&lt;p&gt;I re-checked your steps to repeat and have to admit that it worked for me, too.&lt;/p&gt;

&lt;p&gt;In the past I was running the server with &#160;-Dsolr.disableConfigSetsCreateAuthChecks=true so I did not get the security alert.&lt;/p&gt;

&lt;p&gt;So it runs into the parse error only with an unauthenticated (unthrusted) request which then tries to call ensureOverwritingUntrustedConfigSet&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Nevertheless I am still a bit curious about that 0-byte overwriting and wonder if the trusted info at the config set should be overwritten like that.&lt;/p&gt;</comment>
                            <comment id="17527630" author="epugh" created="Mon, 25 Apr 2022 16:46:23 +0000"  >&lt;p&gt;Okay, I just tried it with -Dsolr.disableConfigSetsCreateAuthChecks=true, and it does avoid the security check, so one issue better understood.   (I sent an email to dev mailing list about if we should be keeping this feature in the 9X line, and if we do, we ought to document it!).   &lt;/p&gt;

&lt;p&gt;I went through your steps, on branch_9_0, and I get a JSON parsing error.   Which I referenced in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16164&quot; title=&quot;ConfigSet API returns error if untrusted user creates from _default configset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16164&quot;&gt;&lt;del&gt;SOLR-16164&lt;/del&gt;&lt;/a&gt;.     I&apos;m going to try the fix I outlined in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16164&quot; title=&quot;ConfigSet API returns error if untrusted user creates from _default configset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16164&quot;&gt;&lt;del&gt;SOLR-16164&lt;/del&gt;&lt;/a&gt;, and then see what happens.&lt;/p&gt;</comment>
                            <comment id="17527727" author="epugh" created="Mon, 25 Apr 2022 19:30:49 +0000"  >&lt;p&gt;Okay, with -Dsolr.disableConfigSetsCreateAuthChecks=true and my patch, I was able to get ALL the way to the upload and then had that blow up....    &lt;/p&gt;

&lt;p&gt;In getConfigMetadata() I am now checking if the ZK data was null (which is what the patch checked for), and it&apos;s not null.  Now we get  a JSON parser error!&lt;/p&gt;

&lt;p&gt;022-04-25 19:19:42.447 ERROR (qtp1463022229-25) [] o.a.s.h.RequestHandlerBase org.noggit.JSONParser$ParseException: JSON Parse Error: char=,position=0 AFTER=&apos;&apos; BEFORE=&apos;&apos; =&amp;gt; org.noggit.JSONParser$ParseException: JSON Parse Error: char=,position=0 AFTER=&apos;&apos; BEFORE=&apos;&apos;&lt;/p&gt;</comment>
                            <comment id="17527741" author="epugh" created="Mon, 25 Apr 2022 20:02:43 +0000"  >&lt;p&gt;Okay!!!   With your patch, I now get a NICE error message.   Is this what you think you should be getting?   :&lt;/p&gt;

&lt;p&gt;{&lt;br/&gt;
  &quot;responseHeader&quot;:&lt;/p&gt;
{
    &quot;status&quot;:400,
    &quot;QTime&quot;:2}
&lt;p&gt;,&lt;br/&gt;
  &quot;error&quot;:{&lt;br/&gt;
    &quot;metadata&quot;:[&lt;br/&gt;
      &quot;error-class&quot;,&quot;org.apache.solr.common.SolrException&quot;,&lt;br/&gt;
      &quot;root-error-class&quot;,&quot;org.apache.solr.common.SolrException&quot;],&lt;br/&gt;
    &quot;msg&quot;:&quot;Trying to make an untrusted ConfigSet update on a trusted configSet&quot;,&lt;br/&gt;
    &quot;code&quot;:400}}&lt;/p&gt;


&lt;p&gt;I then enable security and it works!!!&lt;/p&gt;

&lt;p&gt;&#10140;  dev git:(branch_9_0) &#10007; curl -u admin:password -X POST --header &quot;Content-Type:application/json&quot; --data-binary @test.json &quot;http://localhost:8983/solr/admin/configs?action=UPLOAD&amp;amp;name=test2&amp;amp;filePath=test.json&quot;&lt;/p&gt;

&lt;p&gt;{&lt;br/&gt;
  &quot;responseHeader&quot;:&lt;/p&gt;
{
    &quot;status&quot;:0,
    &quot;QTime&quot;:80}
&lt;p&gt;}&lt;/p&gt;</comment>
                            <comment id="17528745" author="smoldenhauer" created="Wed, 27 Apr 2022 11:35:55 +0000"  >&lt;p&gt;Yes, that&apos;s what I would have expected to get for the untrusted request.&lt;/p&gt;

&lt;p&gt;Originally I also expected that I would be allowed to upload to the configset regardless if trusted is true or false due to the switch &#160;-Dsolr.disableConfigSetsCreateAuthChecks=true&lt;/p&gt;

&lt;p&gt;We &apos;re going to use authentication in future projects and currently worked around the upload issue. So I would not mind if the switch / untrusted upload mode is not available anymore in Solr 9&lt;/p&gt;</comment>
                            <comment id="17530972" author="risdenk" created="Mon, 2 May 2022 23:34:52 +0000"  >&lt;p&gt;I updated the PR to main: &lt;a href=&quot;https://github.com/apache/solr/pull/831&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/pull/831&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="17532419" author="jira-bot" created="Thu, 5 May 2022 17:01:15 +0000"  >&lt;p&gt;Commit 98852e5dc67e53f0f2131681c2b562264c3988af in solr&apos;s branch refs/heads/main from Kevin Risden&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=98852e5dc67&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=98852e5dc67&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16110&quot; title=&quot;Using Schema/Config API breaks the File-Upload of Config Set File&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16110&quot;&gt;&lt;del&gt;SOLR-16110&lt;/del&gt;&lt;/a&gt;: Using Schema/Config API breaks the File-Upload of Config Set File (#831)&lt;/p&gt;


&lt;p&gt;Co-authored-by: Steffen Moldenhauer &amp;lt;s.moldenhauer@intershop.de&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17532421" author="jira-bot" created="Thu, 5 May 2022 17:04:41 +0000"  >&lt;p&gt;Commit e0bf3d4a4bdea9c26e2d774529f36533a48b1411 in solr&apos;s branch refs/heads/branch_9x from Kevin Risden&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=e0bf3d4a4bd&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=e0bf3d4a4bd&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16110&quot; title=&quot;Using Schema/Config API breaks the File-Upload of Config Set File&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16110&quot;&gt;&lt;del&gt;SOLR-16110&lt;/del&gt;&lt;/a&gt;: Using Schema/Config API breaks the File-Upload of Config Set File (#831)&lt;/p&gt;


&lt;p&gt;Co-authored-by: Steffen Moldenhauer &amp;lt;s.moldenhauer@intershop.de&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17532423" author="jira-bot" created="Thu, 5 May 2022 17:10:11 +0000"  >&lt;p&gt;Commit 88adac1ae64e4e9626ff593d175fa6732a2bf79e in solr&apos;s branch refs/heads/main from Kevin Risden&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=88adac1ae64&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=88adac1ae64&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16110&quot; title=&quot;Using Schema/Config API breaks the File-Upload of Config Set File&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16110&quot;&gt;&lt;del&gt;SOLR-16110&lt;/del&gt;&lt;/a&gt;: add CHANGES.txt&lt;/p&gt;</comment>
                            <comment id="17532425" author="jira-bot" created="Thu, 5 May 2022 17:11:05 +0000"  >&lt;p&gt;Commit b9b64e16ab959e2fc25d98e8a4f8851cd3bc63a3 in solr&apos;s branch refs/heads/branch_9x from Kevin Risden&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=b9b64e16ab9&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=b9b64e16ab9&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16110&quot; title=&quot;Using Schema/Config API breaks the File-Upload of Config Set File&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16110&quot;&gt;&lt;del&gt;SOLR-16110&lt;/del&gt;&lt;/a&gt;: add CHANGES.txt&lt;/p&gt;</comment>
                            <comment id="17532426" author="risdenk" created="Thu, 5 May 2022 17:11:34 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=smoldenhauer&quot; class=&quot;user-hover&quot; rel=&quot;smoldenhauer&quot;&gt;smoldenhauer&lt;/a&gt;! You should see the commit linked to your github handle as well since I based my changes on yours.&lt;/p&gt;</comment>
                            <comment id="17656959" author="ishan" created="Tue, 10 Jan 2023 20:45:39 +0000"  >&lt;p&gt;Bulk closing 9.1 issues.&lt;/p&gt;</comment>
                            <comment id="17775553" author="jira-bot" created="Mon, 16 Oct 2023 06:39:56 +0000"  >&lt;p&gt;Commit 7bd8229f4db031f81b84e15881a483244967a8e1 in lucene-solr&apos;s branch refs/heads/branch_8_11 from Kevin Risden&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7bd8229f4db&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7bd8229f4db&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16110&quot; title=&quot;Using Schema/Config API breaks the File-Upload of Config Set File&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16110&quot;&gt;&lt;del&gt;SOLR-16110&lt;/del&gt;&lt;/a&gt;: Using Schema/Config API breaks the File-Upload of Config Set File (#831)&lt;/p&gt;

&lt;p&gt;Co-authored-by: Steffen Moldenhauer &amp;lt;s.moldenhauer@intershop.de&amp;gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13441375">SOLR-16164</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="13041706" name="SOLR-16110-1.patch" size="3089" author="smoldenhauer" created="Tue, 29 Mar 2022 06:43:13 +0000"/>
                            <attachment id="13041613" name="SOLR-16110.patch" size="933" author="smoldenhauer" created="Fri, 25 Mar 2022 15:07:45 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 4 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z10r6w:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>