<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:28:18 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3446] PatternSyntaxException Crash from Unvalidated Regular Expression Usage</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3446</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Solr sometimes crashes with an unhelpful stack trace.  If the PatternTokenizerFactory&apos;s &quot;pattern&quot; attribute is set to an invalid regular expression, a PatternSyntaxException is thrown and Solr fails to start. The PatternSyntaxException is not useful to users in diagnosing the error. I think it would be better to report a detailed error message. The attached patch makes this change.&lt;/p&gt;

&lt;p&gt;Note that the patch adds a small RegexUtil class with helper methods to determine whether a String is a valid regular expression and to generate error messages for invalid regular expressions. I feel that these helper methods are more readable than catching the PatternSyntaxException. Furthermore, they can be re-used if more bugs like this one are found.&lt;/p&gt;

&lt;p&gt;Steps to reproduce:&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Patch in bug.patch
	&lt;ul&gt;
		&lt;li&gt;Note that this sets PatternTokenizerFactory&apos;s pattern attribute to an invalid regular expression.&lt;/li&gt;
	&lt;/ul&gt;
	&lt;/li&gt;
	&lt;li&gt;Run &apos;ant run-example&apos; from the solr folder&lt;/li&gt;
	&lt;li&gt;See exception in console output on startup:&lt;/li&gt;
&lt;/ol&gt;


&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;Apr 3, 2012 2:07:29 PM org.apache.solr.common.SolrException log
SEVERE: java.util.regex.PatternSyntaxException: Unclosed group near index 1
(
 ^
       at java.util.regex.Pattern.error(Pattern.java:1713)
       at java.util.regex.Pattern.accept(Pattern.java:1571)
       at java.util.regex.Pattern.group0(Pattern.java:2533)
       at java.util.regex.Pattern.sequence(Pattern.java:1806)
       at java.util.regex.Pattern.expr(Pattern.java:1752)
       at java.util.regex.Pattern.compile(Pattern.java:1460)
       at java.util.regex.Pattern.&amp;lt;init&amp;gt;(Pattern.java:1133)
       at java.util.regex.Pattern.compile(Pattern.java:847)
       at org.apache.solr.analysis.PatternTokenizerFactory.init(PatternTokenizerFactory.java:90)
       at org.apache.solr.schema.IndexSchema$5.init(IndexSchema.java:901)
       at org.apache.solr.schema.IndexSchema$5.init(IndexSchema.java:890)
       at org.apache.solr.util.plugin.AbstractPluginLoader.load(AbstractPluginLoader.java:148)
       at org.apache.solr.schema.IndexSchema.readAnalyzer(IndexSchema.java:910)
       at org.apache.solr.schema.IndexSchema.access$100(IndexSchema.java:62)
       at org.apache.solr.schema.IndexSchema$1.create(IndexSchema.java:450)
       at org.apache.solr.schema.IndexSchema$1.create(IndexSchema.java:435)
       at org.apache.solr.util.plugin.AbstractPluginLoader.load(AbstractPluginLoader.java:140)
       at org.apache.solr.schema.IndexSchema.readSchema(IndexSchema.java:480)
       at org.apache.solr.schema.IndexSchema.&amp;lt;init&amp;gt;(IndexSchema.java:125)
       at org.apache.solr.core.CoreContainer.create(CoreContainer.java:461)
       at org.apache.solr.core.CoreContainer.load(CoreContainer.java:316)
       at org.apache.solr.core.CoreContainer.load(CoreContainer.java:207)
       at org.apache.solr.core.CoreContainer$Initializer.initialize(CoreContainer.java:130)
       at org.apache.solr.servlet.SolrDispatchFilter.init(SolrDispatchFilter.java:94)
       at org.mortbay.jetty.servlet.FilterHolder.doStart(FilterHolder.java:97)
       at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
       at org.mortbay.jetty.servlet.ServletHandler.initialize(ServletHandler.java:713)
       at org.mortbay.jetty.servlet.Context.startContext(Context.java:140)
       at org.mortbay.jetty.webapp.WebAppContext.startContext(WebAppContext.java:1282)
       at org.mortbay.jetty.handler.ContextHandler.doStart(ContextHandler.java:518)
       at org.mortbay.jetty.webapp.WebAppContext.doStart(WebAppContext.java:499)
       at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
       at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)
       at org.mortbay.jetty.handler.ContextHandlerCollection.doStart(ContextHandlerCollection.java:156)
       at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
       at org.mortbay.jetty.handler.HandlerCollection.doStart(HandlerCollection.java:152)
       at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
       at org.mortbay.jetty.handler.HandlerWrapper.doStart(HandlerWrapper.java:130)
       at org.mortbay.jetty.Server.doStart(Server.java:224)
       at org.mortbay.component.AbstractLifeCycle.start(AbstractLifeCycle.java:50)
       at org.mortbay.xml.XmlConfiguration.main(XmlConfiguration.java:985)
       at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
       at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:39)
       at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:25)
       at java.lang.reflect.Method.invoke(Method.java:597)
       at org.mortbay.start.Main.invokeMain(Main.java:194)
       at org.mortbay.start.Main.start(Main.java:534)
       at org.mortbay.start.Main.start(Main.java:441)
       at org.mortbay.start.Main.main(Main.java:119)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;4. Visit &lt;a href=&quot;http://localhost:8983/solr/admin/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/admin/&lt;/a&gt; and see a similar message:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;HTTP ERROR 500

Problem accessing /solr/admin/. Reason:

    Severe errors in solr configuration.

Check your log files &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more detailed information on what may be wrong.

If you want solr to &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt; after configuration errors, change: 

 &amp;lt;abortOnConfigurationError&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;lt;/abortOnConfigurationError&amp;gt;

in solr.xml

...

-------------------------------------------------------------
java.util.regex.PatternSyntaxException: Unclosed group near index 1
(
 ^
       at java.util.regex.Pattern.error(Pattern.java:1713)
       at java.util.regex.Pattern.accept(Pattern.java:1571)
       at java.util.regex.Pattern.group0(Pattern.java:2533)
       at java.util.regex.Pattern.sequence(Pattern.java:1806)
       at java.util.regex.Pattern.expr(Pattern.java:1752)
       at java.util.regex.Pattern.compile(Pattern.java:1460)
       at java.util.regex.Pattern.&amp;lt;init&amp;gt;(Pattern.java:1133)
       at java.util.regex.Pattern.compile(Pattern.java:847)
       at org.apache.solr.analysis.PatternTokenizerFactory.init(PatternTokenizerFactory.java:90)
       at org.apache.solr.schema.IndexSchema$5.init(IndexSchema.java:901)
       at org.apache.solr.schema.IndexSchema$5.init(IndexSchema.java:890)
       at org.apache.solr.util.plugin.AbstractPluginLoader.load(AbstractPluginLoader.java:148)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;After applying the patch, the following is printed to the console:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;SEVERE: org.apache.solr.common.SolrException: invalid &lt;span class=&quot;code-quote&quot;&gt;&quot;pattern&quot;&lt;/span&gt; regular expression &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; PatternTokenizerFactory: Unclosed group near index 1
(
 ^
    at org.apache.solr.analysis.PatternTokenizerFactory.init(PatternTokenizerFactory.java:90)
    at org.apache.solr.schema.IndexSchema$5.init(IndexSchema.java:901)
    at org.apache.solr.schema.IndexSchema$5.init(IndexSchema.java:890)
    at org.apache.solr.util.plugin.AbstractPluginLoader.load(AbstractPluginLoader.java:148)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;And the following similar message is shown when visiting &lt;a href=&quot;http://localhost:8983/solr/admin/&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/admin/&lt;/a&gt; :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;HTTP ERROR 500

Problem accessing /solr/admin/. Reason:

    Severe errors in solr configuration.

Check your log files &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; more detailed information on what may be wrong.

If you want solr to &lt;span class=&quot;code-keyword&quot;&gt;continue&lt;/span&gt; after configuration errors, change: 

 &amp;lt;abortOnConfigurationError&amp;gt;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&amp;lt;/abortOnConfigurationError&amp;gt;

in solr.xml

...

-------------------------------------------------------------
org.apache.solr.common.SolrException: invalid &lt;span class=&quot;code-quote&quot;&gt;&quot;pattern&quot;&lt;/span&gt; regular expression &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; PatternTokenizerFactory: Unclosed group near index 1
(
 ^
       at org.apache.solr.analysis.PatternTokenizerFactory.init(PatternTokenizerFactory.java:90)
       at org.apache.solr.schema.IndexSchema$5.init(IndexSchema.java:901)
       at org.apache.solr.schema.IndexSchema$5.init(IndexSchema.java:890)
       at org.apache.solr.util.plugin.AbstractPluginLoader.load(AbstractPluginLoader.java:148)
...
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12554410">SOLR-3446</key>
            <summary>PatternSyntaxException Crash from Unvalidated Regular Expression Usage</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="espishak">Eric Spishak</reporter>
                        <labels>
                    </labels>
                <created>Wed, 9 May 2012 00:37:59 +0000</created>
                <updated>Fri, 10 May 2013 10:39:07 +0000</updated>
                            <resolved>Fri, 25 May 2012 02:25:43 +0000</resolved>
                                    <version>3.5</version>
                                    <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13282988" author="hossman" created="Fri, 25 May 2012 02:25:43 +0000"  >
&lt;p&gt;Eric: I&apos;m not really a fan of the &quot;isRegex&quot; and &quot;regexError&quot; utilities you proposed in your patch, because they throw away info about the details of the exception, and require redundant calls to Pattern.compile in situations where it&apos;s known that Pattern.compile is going to fail.&lt;/p&gt;

&lt;p&gt;But the crux of your bug report is spot on &amp;#8211; PatternTokenizerFactory was dealing with the pattern init param poorly, and should have been following the model used in PatternReplaceCharFilterFactory and PatternReplaceFilterFactory &amp;#8211; however even with those, the general plugin loading mechanism wasn&apos;t doing a very good job of drawing attention to where exactly the problem was.&lt;/p&gt;

&lt;p&gt;So i&apos;ve committed a fix that:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;refactors those three factories to use a common &quot;getPattern&quot; method in the base class&lt;/li&gt;
	&lt;li&gt;improves AbstractPluginLoader to include the name of the plugin that had a problem (if known)&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;Committed revision 1342489.&lt;/p&gt;

&lt;p&gt;thanks for opening the bug and drawing attention to this!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12526082" name="SOLR-3446.patch" size="2337" author="espishak" created="Wed, 9 May 2012 00:41:14 +0000"/>
                            <attachment id="12526083" name="bug.patch" size="669" author="espishak" created="Wed, 9 May 2012 00:41:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>238652</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 26 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03emv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17804</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>