<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:41:51 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-13979] Expose separate metrics for distributed and non-distributed requests</title>
                <link>https://issues.apache.org/jira/browse/SOLR-13979</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Currently we expose metrics such as count, rate and latency on a per handler level however for search requests there is no distinction made for distrib vs non-distrib requests. This means that there is no way to find the count, rate or latency of only user-sent queries.&lt;/p&gt;

&lt;p&gt;I propose that we expose distrib vs non-distrib metrics separately.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13271315">SOLR-13979</key>
            <summary>Expose separate metrics for distributed and non-distributed requests</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ab">Andrzej Bialecki</assignee>
                                    <reporter username="shalin">Shalin Shekhar Mangar</reporter>
                        <labels>
                    </labels>
                <created>Fri, 29 Nov 2019 05:15:46 +0000</created>
                <updated>Thu, 9 Apr 2020 14:56:13 +0000</updated>
                            <resolved>Wed, 11 Dec 2019 07:08:05 +0000</resolved>
                                                    <fixVersion>8.4</fixVersion>
                                    <component>metrics</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16987458" author="dsmiley" created="Wed, 4 Dec 2019 02:39:06 +0000"  >&lt;p&gt;I agree&lt;/p&gt;</comment>
                            <comment id="16987519" author="elyograg" created="Wed, 4 Dec 2019 04:35:10 +0000"  >&lt;p&gt;My old solution for this, on systems NOT running in cloud mode, was to define an aggregation core which had the shards parameter defined in solrconfig.xml.&#160; Relevant stats were found by looking at the /search handler on that core.&#160; I also defined a special handler on every core which was used by ping health checks and other miscellaneous automated uses so that those requests would not impact stats for real queries.&lt;/p&gt;

&lt;p&gt;Does SolrCloud keep separate stats for requests sent to the collection name rather than a specific shard/core?&#160; If not, I think it should.&#160; I have no idea how to implement such a thing.&lt;/p&gt;</comment>
                            <comment id="16987539" author="shalinmangar" created="Wed, 4 Dec 2019 05:07:23 +0000"  >&lt;p&gt;Yes, I have used that method in the past but this is a common use-case and it should not be necessary to resort to such clever solutions.&lt;/p&gt;</comment>
                            <comment id="16989695" author="ab" created="Fri, 6 Dec 2019 12:24:41 +0000"  >&lt;p&gt;This patch adds a set of separate &quot;requestTimes&quot; and &quot;totalTime&quot; metrics for distributed and local requests, based on the value of &lt;tt&gt;distrib&lt;/tt&gt; parameter (defaults to true when in ZK mode).&lt;br/&gt;
These metrics are added to all handlers that inherit from &lt;tt&gt;RequestHandlerBase&lt;/tt&gt;. This may be probably a bit too many, we could&apos;ve added it to &lt;tt&gt;SearchHandler&lt;/tt&gt; only, but on the other hand there are other handlers where this info comes useful, it also ensures that these metrics are also available in other custom handlers that inherit from this class.&lt;/p&gt;</comment>
                            <comment id="16989889" author="cpoerschke" created="Fri, 6 Dec 2019 15:32:08 +0000"  >&lt;p&gt;Differentiation of timings for user-sent vs. within-Solr queries sounds a familiar scenario. +1 to provide separate metrics.&lt;/p&gt;

&lt;p&gt;How about also mentioning the differentiation in the reference guide, maybe in the &lt;a href=&quot;https://lucene.apache.org/solr/guide/8_3/performance-statistics-reference.html#commonly-used-stats-for-request-handlers&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://lucene.apache.org/solr/guide/8_3/performance-statistics-reference.html#commonly-used-stats-for-request-handlers&lt;/a&gt;&#160;section and/or elsewhere too?&lt;/p&gt;</comment>
                            <comment id="16990442" author="ab" created="Sat, 7 Dec 2019 11:14:53 +0000"  >&lt;p&gt;Good point Christine, I&apos;ll add the RefGuide changes to this patch.&lt;/p&gt;</comment>
                            <comment id="16991551" author="jira-bot" created="Mon, 9 Dec 2019 12:46:58 +0000"  >&lt;p&gt;Commit 86cab79730b7471c4764f93c5265ae429cd5a27e in lucene-solr&apos;s branch refs/heads/master from Andrzej Bialecki&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=86cab79&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=86cab79&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13979&quot; title=&quot;Expose separate metrics for distributed and non-distributed requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13979&quot;&gt;&lt;del&gt;SOLR-13979&lt;/del&gt;&lt;/a&gt;: Expose separate metrics for distributed and non-distributed requests.&lt;/p&gt;</comment>
                            <comment id="16991569" author="jira-bot" created="Mon, 9 Dec 2019 13:08:13 +0000"  >&lt;p&gt;Commit 349fe428c4888d7140372087a4ffec8647a5fa5f in lucene-solr&apos;s branch refs/heads/branch_8x from Andrzej Bialecki&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=349fe42&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=349fe42&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13979&quot; title=&quot;Expose separate metrics for distributed and non-distributed requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13979&quot;&gt;&lt;del&gt;SOLR-13979&lt;/del&gt;&lt;/a&gt;: Expose separate metrics for distributed and non-distributed requests.&lt;/p&gt;</comment>
                            <comment id="16991716" author="jira-bot" created="Mon, 9 Dec 2019 15:49:12 +0000"  >&lt;p&gt;Commit 86cab79730b7471c4764f93c5265ae429cd5a27e in lucene-solr&apos;s branch refs/heads/gradle-master from Andrzej Bialecki&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=86cab79&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=86cab79&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13979&quot; title=&quot;Expose separate metrics for distributed and non-distributed requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13979&quot;&gt;&lt;del&gt;SOLR-13979&lt;/del&gt;&lt;/a&gt;: Expose separate metrics for distributed and non-distributed requests.&lt;/p&gt;</comment>
                            <comment id="17004916" author="jpountz" created="Sun, 29 Dec 2019 20:49:33 +0000"  >&lt;p&gt;Closing after the 8.4.0 release.&lt;/p&gt;</comment>
                            <comment id="17078488" author="dsmiley" created="Wed, 8 Apr 2020 17:00:21 +0000"  >&lt;blockquote&gt;&lt;p&gt;These metrics are added to all handlers that inherit from RequestHandlerBase. This may be probably a bit too many&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yes its too many; distrib is implemented by SearchHandler.  I feel defaulting to to track distrib metrics on the vast majority of request handlers that are not SearchHandlers pollutes Solr metrics with junk.&lt;/p&gt;</comment>
                            <comment id="17078489" author="dsmiley" created="Wed, 8 Apr 2020 17:01:44 +0000"  >&lt;p&gt;Also, distributed search long predated SolrCloud so why should this be a SolrCloud dependent switch?&lt;/p&gt;</comment>
                            <comment id="17078990" author="ab" created="Thu, 9 Apr 2020 07:09:05 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&#160;please open a new Jira to discuss this improvement (I&apos;m not opposed, just to avoid confusion - this issue is closed).&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                            <outwardlinks description="causes">
                                        <issuelink>
            <issuekey id="13297411">SOLR-14401</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12987715" name="SOLR-13979.patch" size="4222" author="ab" created="Fri, 6 Dec 2019 12:20:19 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 31 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z094ko:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>