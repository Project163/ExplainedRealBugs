<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:24:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-10830] Solr needs to enforce that _root_ field has the same fieldType as the uniqueKey field</title>
                <link>https://issues.apache.org/jira/browse/SOLR-10830</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;it&apos;s pretty important for correct childDocument behavior that the &lt;tt&gt;&amp;#95;root_&lt;/tt&gt; field have the same &lt;tt&gt;&amp;lt;fieldType/&amp;gt;&lt;/tt&gt; as the uniqueKey field &amp;#8211; but nothing seems to enforce that.&lt;/p&gt;

&lt;p&gt;(I realized this while working on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10807&quot; title=&quot; Randomize PointFields in all tests unless explicit reason not to&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10807&quot;&gt;&lt;del&gt;SOLR-10807&lt;/del&gt;&lt;/a&gt; where i was forcing all fields to be Points based except for the uniqueKey field and got some weird errors in PeerSync that only related to replacing child documents &amp;#8211; because the &lt;tt&gt;schema.xml&lt;/tt&gt; has a &lt;tt&gt;TrieIntField&lt;/tt&gt; based &quot;id&quot; field, but &lt;tt&gt;&amp;#95;root_&lt;/tt&gt; was using &lt;tt&gt;IntPointField&lt;/tt&gt; &amp;#8211; but the same problem could affect any schema if folks change the &lt;tt&gt;id&lt;/tt&gt; from string to long, or int to string, and don&apos;t make the corrisponding change to the definition of &lt;tt&gt;&amp;#95;root_&lt;/tt&gt;)&lt;/p&gt;</description>
                <environment></environment>
        <key id="13077829">SOLR-10830</key>
            <summary>Solr needs to enforce that _root_ field has the same fieldType as the uniqueKey field</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Tue, 6 Jun 2017 22:26:52 +0000</created>
                <updated>Wed, 2 Oct 2019 17:30:12 +0000</updated>
                            <resolved>Tue, 13 Jun 2017 17:23:51 +0000</resolved>
                                                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>1</votes>
                                    <watches>3</watches>
                                                                                                                <comments>
                            <comment id="16043567" author="hossman" created="Thu, 8 Jun 2017 22:48:07 +0000"  >&lt;p&gt;straight forward patch with tests&lt;/p&gt;</comment>
                            <comment id="16044089" author="mkhludnev" created="Fri, 9 Jun 2017 07:36:13 +0000"  >&lt;p&gt;seems good&lt;/p&gt;</comment>
                            <comment id="16045111" author="hossman" created="Fri, 9 Jun 2017 22:10:52 +0000"  >&lt;p&gt;thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=mkhludnev&quot; class=&quot;user-hover&quot; rel=&quot;mkhludnev&quot;&gt;mkhludnev&lt;/a&gt;, unfortunately there&apos;s a problem...&lt;/p&gt;

&lt;p&gt;When i wrote that quick patch yesterday, i didn&apos;t bother trying to run all tests because I took it as a given that we probably had a bunch of test schemas with copy/pasted field definitions that violated this but weren&apos;t problematic because they didn&apos;t actaully use child docs.&lt;/p&gt;

&lt;p&gt;When i went to run test today to move forward with this issue, I realized that in addition to schemas with explicit &lt;tt&gt;&amp;#95;root_&lt;/tt&gt; fields, i was also seeing failures from tests that used &lt;tt&gt;&quot;&amp;#42;&quot;&lt;/tt&gt; dynamicFields that were matching &lt;tt&gt;&amp;#95;root_&lt;/tt&gt;.  Since it&apos;s probably more common for folks to have something like &lt;tt&gt;&amp;lt;dynamicField name=&quot;&amp;#42;&quot; type=&quot;text&quot; /&amp;gt;&lt;/tt&gt; in their schemas then it is that folks are using childDocs, i don&apos;t really think we should fail on startup in those cases.&lt;/p&gt;

&lt;p&gt;So the update patch tweaks the logic so that hard failure on IndexSchema init is only if &lt;tt&gt;&amp;#95;root_&lt;/tt&gt; is explicitly defined.  Later, in AddUpdateCommand.flatten, I added a stricter check to fail updates that involve child docs unless the &lt;tt&gt;&amp;#95;root_&lt;/tt&gt; field type matches.  I also added a test for this situation, and updated any existing schema files that were problematic.&lt;/p&gt;

&lt;p&gt;WDYT?&lt;/p&gt;</comment>
                            <comment id="16045711" author="mkhludnev" created="Sat, 10 Jun 2017 21:41:36 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=hossman&quot; class=&quot;user-hover&quot; rel=&quot;hossman&quot;&gt;hossman&lt;/a&gt;, it makes sense. &lt;/p&gt;</comment>
                            <comment id="16048125" author="jira-bot" created="Tue, 13 Jun 2017 17:17:40 +0000"  >&lt;p&gt;Commit 6396cb759f8c799f381b0730636fa412761030ce in lucene-solr&apos;s branch refs/heads/master from Chris Hostetter&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6396cb7&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=6396cb7&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10830&quot; title=&quot;Solr needs to enforce that _root_ field has the same fieldType as the uniqueKey field&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10830&quot;&gt;&lt;del&gt;SOLR-10830&lt;/del&gt;&lt;/a&gt;: Solr now correctly enforces that the &apos;&lt;em&gt;root&lt;/em&gt;&apos; field has the same fieldType as the uniqueKey field&lt;/p&gt;</comment>
                            <comment id="16048133" author="hossman" created="Tue, 13 Jun 2017 17:23:51 +0000"  >&lt;p&gt;NOTE: even though this is a &quot;bug fix&quot; i&apos;ve made the choice to only commit it to master and not backport...&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;if folks are using child docs with 6.x and their schema has a mismatch they have probably already noticed&lt;/li&gt;
	&lt;li&gt;if folks are &lt;b&gt;not&lt;/b&gt; using child docs with 6.x, they may still have a schema missmatch they don&apos;t care about (ie: at some point htye changed the &quot;id&quot; definition from the sample configs but didn&apos;t change &lt;tt&gt;&amp;#95;root&amp;#95;&lt;/tt&gt;) so i don&apos;t wnat to suddenly break things for them in a bug fix release.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I am -0 on anyone else making the choose to backport ... but I don&apos;t plan on doing it.&lt;/p&gt;</comment>
                            <comment id="16048305" author="jira-bot" created="Tue, 13 Jun 2017 19:45:06 +0000"  >&lt;p&gt;Commit 5835dcb3476b7355130e2eea2c485898232c56d0 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=tflobbe&quot; class=&quot;user-hover&quot; rel=&quot;tflobbe&quot;&gt;tflobbe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5835dcb&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5835dcb&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10833&quot; title=&quot;Numeric FooPointField classes inconsistent with TrieFooFields on malformed input: throw NumberFormatException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10833&quot;&gt;&lt;del&gt;SOLR-10833&lt;/del&gt;&lt;/a&gt;: Better exception handling of queries in numeric fields&lt;/p&gt;

&lt;p&gt;Cherry picked 6396cb759f8c799f381b0730636fa412761030ce from master and manually removed code related to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10830&quot; title=&quot;Solr needs to enforce that _root_ field has the same fieldType as the uniqueKey field&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10830&quot;&gt;&lt;del&gt;SOLR-10830&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13077824">SOLR-10829</issuekey>
        </issuelink>
            <issuelink>
            <issuekey id="13077846">SOLR-10833</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12872360" name="SOLR-10830.patch" size="17799" author="hossman" created="Fri, 9 Jun 2017 22:10:52 +0000"/>
                            <attachment id="12872165" name="SOLR-10830.patch" size="7008" author="hossman" created="Thu, 8 Jun 2017 22:48:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 23 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3fydr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>