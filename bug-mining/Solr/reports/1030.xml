<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:30:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3823] Parentheses in a boost query cause errors</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3823</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When using a boost query (bq) that contains a parentheses (like this example from the Relevancy Cookbook section of the wiki):&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt; ? defType = dismax 
    &amp;amp; q = foo bar 
    &amp;amp; bq = (*:* -xxx)^999 
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;You get the following error:&lt;/p&gt;


&lt;p&gt;org.apache.lucene.queryparser.classic.ParseException: Cannot parse &apos;&lt;del&gt;xxx)&apos;: Encountered &quot; &quot;)&quot; &quot;) &quot;&quot; at line 1, column 12. Was expecting one of: &amp;lt;EOF&amp;gt; &amp;lt;AND&amp;gt; ... &amp;lt;OR&amp;gt; ... &amp;lt;NOT&amp;gt; ... &quot;+&quot; ... &quot;&lt;/del&gt;&quot; ... &amp;lt;BAREOPER&amp;gt; ... &quot;(&quot; ... &quot;*&quot; ... &quot;^&quot; ... &amp;lt;QUOTED&amp;gt; ... &amp;lt;TERM&amp;gt; ... &amp;lt;FUZZY_SLOP&amp;gt; ... &amp;lt;PREFIXTERM&amp;gt; ... &amp;lt;WILDTERM&amp;gt; ... &amp;lt;REGEXPTERM&amp;gt; ... &quot;[&quot; ... &quot;{&quot; ... &amp;lt;NUMBER&amp;gt; ...&lt;/p&gt;</description>
                <environment>&lt;p&gt;Mac, jdk 1.6, Chrome&lt;/p&gt;</environment>
        <key id="12606977">SOLR-3823</key>
            <summary>Parentheses in a boost query cause errors</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hossman">Chris M. Hostetter</assignee>
                                    <reporter username="mathos">Mathos Marcer</reporter>
                        <labels>
                    </labels>
                <created>Tue, 11 Sep 2012 00:35:28 +0000</created>
                <updated>Mon, 9 May 2016 18:58:01 +0000</updated>
                            <resolved>Wed, 12 Sep 2012 01:11:13 +0000</resolved>
                                    <version>4.0-BETA</version>
                                    <fixVersion>4.0</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>query parsers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13453134" author="erickerickson" created="Tue, 11 Sep 2012 15:58:16 +0000"  >&lt;p&gt;The error is because of the colon character, it has meaning in a query and must be escaped. See: &lt;a href=&quot;http://lucene.apache.org/core/3_6_1/queryparsersyntax.html&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://lucene.apache.org/core/3_6_1/queryparsersyntax.html&lt;/a&gt;.&lt;/p&gt;

&lt;p&gt;So I&apos;ll close this as invalid, if you disagree please let us know.&lt;/p&gt;

&lt;p&gt;BTW, it&apos;s better to raise this kind of question on the user&apos;s list rather than open a JIRA, at least until you&apos;re sure it&apos;s really a bug.&lt;/p&gt;</comment>
                            <comment id="13453302" author="hossman" created="Tue, 11 Sep 2012 18:57:25 +0000"  >&lt;p&gt;1) editing the issue description to include &quot;noformat&quot; tags &amp;#8211; i think Erick was getting confused by the &quot;&amp;#42;:&amp;#42;&quot; showing up as just &quot;:&quot;&lt;/p&gt;

&lt;p&gt;2) i can&apos;t reproduce the described problem.  When i tried using the solr example data, this request worked just fine...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://localhost:8983/solr/select?q=ipod&amp;amp;defType=dismax&amp;amp;bq=%28*:*%20-id:IW-02%29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://localhost:8983/solr/select?q=ipod&amp;amp;defType=dismax&amp;amp;bq=%28*:*%20-id:IW-02%29&lt;/a&gt;^999&lt;/p&gt;

&lt;p&gt;Mathos: please follow up on the solr-user@lucene mailing list with more details about the problems you are you having and your actual (specific) configs/queries&lt;/p&gt;</comment>
                            <comment id="13453314" author="mathos" created="Tue, 11 Sep 2012 19:15:56 +0000"  >&lt;p&gt;The problem seems to be when I specify defType=edismax, under defType=dismax it is working like a champ.&lt;/p&gt;</comment>
                            <comment id="13453338" author="erickerickson" created="Tue, 11 Sep 2012 19:42:16 +0000"  >&lt;p&gt;Thanks, Hoss, you&apos;re right...&lt;/p&gt;

&lt;p&gt;But I can get this to fail both with BETA and today&apos;s trunk with the example data.&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;http://localhost:8983/solr/select?q=foo&amp;amp;defType=edismax&amp;amp;bq=(name:nonsense -xxx)^999
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;Interestingly this works: (note the space after &quot;bq&quot;), &lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;http://localhost:8983/solr/select?q=foo&amp;amp;defType=edismax&amp;amp;bq =(name:nonsense -xxx)^999
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;This fails (spaces around parens, there was an issue with non-space parens lately, but apparently it&apos;s unrelated.)&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;http://localhost:8983/solr/select?q=foo&amp;amp;defType=edismax&amp;amp;bq= ( name:nonsense -xxx ) ^999
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Stack trace from log:&lt;/p&gt;

&lt;p&gt;Caused by: org.apache.lucene.queryparser.classic.ParseException: Encountered &quot;&amp;lt;EOF&amp;gt;&quot; at line 1, column 1.&lt;br/&gt;
Was expecting one of:&lt;br/&gt;
    &amp;lt;NOT&amp;gt; ...&lt;br/&gt;
    &quot;+&quot; ...&lt;br/&gt;
    &quot;-&quot; ...&lt;br/&gt;
    &amp;lt;BAREOPER&amp;gt; ...&lt;br/&gt;
    &quot;(&quot; ...&lt;br/&gt;
    &quot;*&quot; ...&lt;br/&gt;
    &amp;lt;QUOTED&amp;gt; ...&lt;br/&gt;
    &amp;lt;TERM&amp;gt; ...&lt;br/&gt;
    &amp;lt;PREFIXTERM&amp;gt; ...&lt;br/&gt;
    &amp;lt;WILDTERM&amp;gt; ...&lt;br/&gt;
    &amp;lt;REGEXPTERM&amp;gt; ...&lt;br/&gt;
    &quot;[&quot; ...&lt;br/&gt;
    &quot;{&quot; ...&lt;br/&gt;
    &amp;lt;NUMBER&amp;gt; ...&lt;br/&gt;
    &amp;lt;TERM&amp;gt; ...&lt;br/&gt;
    &quot;*&quot; ...&lt;/p&gt;

&lt;p&gt;	at org.apache.lucene.queryparser.classic.QueryParser.generateParseException(QueryParser.java:708)&lt;br/&gt;
	at org.apache.lucene.queryparser.classic.QueryParser.jj_consume_token(QueryParser.java:590)&lt;br/&gt;
	at org.apache.lucene.queryparser.classic.QueryParser.Clause(QueryParser.java:275)&lt;br/&gt;
	at org.apache.lucene.queryparser.classic.QueryParser.Query(QueryParser.java:181)&lt;br/&gt;
	at org.apache.lucene.queryparser.classic.QueryParser.Clause(QueryParser.java:261)&lt;br/&gt;
	at org.apache.lucene.queryparser.classic.QueryParser.Query(QueryParser.java:181)&lt;br/&gt;
	at org.apache.lucene.queryparser.classic.QueryParser.TopLevelQuery(QueryParser.java:170)&lt;br/&gt;
	at org.apache.lucene.queryparser.classic.QueryParserBase.parse(QueryParserBase.java:120)&lt;br/&gt;
	... 35 more&lt;/p&gt;

&lt;p&gt;Sep 11, 2012 12:37:58 PM org.apache.solr.core.SolrCore execute&lt;br/&gt;
INFO: &lt;span class=&quot;error&quot;&gt;&amp;#91;collection1&amp;#93;&lt;/span&gt; webapp=/solr path=/select params=&lt;/p&gt;
{q=foo&amp;amp;defType=edismax&amp;amp;bq=+(+name:nonsense+-xxx+)+^999}
&lt;p&gt; status=400 QTime=2 &lt;/p&gt;</comment>
                            <comment id="13453349" author="mathos" created="Tue, 11 Sep 2012 20:04:36 +0000"  >&lt;p&gt;I&apos;m glad I&apos;m not just going crazy &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;p&gt;I did notice while the space before the equal sign (ie &quot;bq =(name:nonsense -xxx)^999&quot;) doesn&apos;t produce a parsing error, comparing results between 3.6 and 4.0 BETA, it doesn&apos;t appear to be applying the boost.  In fact I get the same results as if I didn&apos;t have the &quot;bq&quot; option there at all.&lt;/p&gt;</comment>
                            <comment id="13453350" author="mathos" created="Tue, 11 Sep 2012 20:06:05 +0000"  >&lt;p&gt;Actually looking at it closer, it is probably because with adding the space after bq is it doesn&apos;t register it as &quot;bq&quot; but as &quot;bq &quot; looking at the params section of the query:&lt;/p&gt;


&lt;p&gt;&amp;lt;str name=&quot;bq &quot;&amp;gt;(&amp;#42;:&amp;#42; -replacement)^99500000&amp;lt;/str&amp;gt;&lt;/p&gt;</comment>
                            <comment id="13453356" author="erickerickson" created="Tue, 11 Sep 2012 20:13:36 +0000"  >&lt;p&gt;FWIW, I&apos;m on a Mac (Lion) too, although I doubt that matters.&lt;/p&gt;</comment>
                            <comment id="13453421" author="jkrupan" created="Tue, 11 Sep 2012 21:12:25 +0000"  >&lt;p&gt;It turns out that it is the white space that causes the problem.&lt;/p&gt;

&lt;p&gt;Looking at the code, I see that edismax calls SolrPluginUtils.parseFieldBoosts to &quot;parse&quot; the &quot;bq&quot; value, which is absurd since it simply breaks up the param value based on whitespace, even in the middle of the query. Then the code calls QParser.subQuery to parse the portions of the query, which of course makes no sense unless the original query contained no whitespace or was a sequence of non-white space queries separated with whitespace.&lt;/p&gt;

&lt;p&gt;Dismax, OTOH, treats &quot;bq&quot; as an array of query strings (multiple &quot;bq&quot; params) and parses each as a separate sub-query.&lt;/p&gt;

&lt;p&gt;Edismax in 3.6/3.6.1 has the old dismax code.&lt;/p&gt;

&lt;p&gt;The culprit? &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3278&quot; title=&quot;edismax support for negative boost with &amp;quot;bq&amp;quot; parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3278&quot;&gt;&lt;del&gt;SOLR-3278&lt;/del&gt;&lt;/a&gt;: &quot;edismax support for negative boost with &quot;bq&quot; parameter&quot; introduced the error, back in March.&lt;/p&gt;</comment>
                            <comment id="13453518" author="hossman" created="Tue, 11 Sep 2012 22:54:34 +0000"  >&lt;p&gt;jack: thanks for digging in and tracking down the bug .. i&apos;ll try to get to this for 4.0&lt;/p&gt;

&lt;p&gt;(Mathos: FWIW, details really matter bug reports like &amp;#8211; i tried what you said and couldn&apos;t reproduce, if you mentioned that you were using edismax instead of dismax i probably would have been able to reproduce, and the stack trace would have helped me find the bug in the code)&lt;/p&gt;</comment>
                            <comment id="13453609" author="hossman" created="Wed, 12 Sep 2012 01:11:13 +0000"  >&lt;p&gt;Committed revision 1383708. - trunk&lt;br/&gt;
Committed revision 1383716. - 4x&lt;/p&gt;

&lt;p&gt;thanks everybody for helping track this down.&lt;/p&gt;</comment>
                            <comment id="13454028" author="jdyer" created="Wed, 12 Sep 2012 14:26:22 +0000"  >&lt;p&gt;Hoss,&lt;/p&gt;

&lt;p&gt;I appreciate you fixing this, but I would rather get a fix that preserves the negative boost support (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3278&quot; title=&quot;edismax support for negative boost with &amp;quot;bq&amp;quot; parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3278&quot;&gt;&lt;del&gt;SOLR-3278&lt;/del&gt;&lt;/a&gt;).  I guess I don&apos;t understand the bug this issue was addressing.  Is it simply that &quot;bq&quot; would fail if extra whitespace was in the query?  Could we write a failing testcase for that?  Do you see a reason why it would be difficult to fix this and retain the negative boosts?&lt;/p&gt;

&lt;p&gt;The discussion of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-4378&quot; title=&quot;QueryParsers do not support negative boosts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-4378&quot;&gt;LUCENE-4378&lt;/a&gt; is pertinent:  we have products in our index that we either do not sell or we know most of our customer do not want.  Yet they often score very high.  The only way I can reliably prevent these from becoming top hits is to use a negative boost.  I would imagine this is a frequent requirement.&lt;/p&gt;

&lt;p&gt;I&apos;m more than willing to contribute for this, but I couldn&apos;t tell that this issue was an actual problem or a case of users putting whitespace where it doesn&apos;t belong and prior versions being more forgiving.&lt;/p&gt;</comment>
                            <comment id="13454059" author="erickerickson" created="Wed, 12 Sep 2012 15:18:04 +0000"  >&lt;p&gt;James:&lt;/p&gt;

&lt;p&gt;The problem was quite the opposite. When there was NO space in the bq clause it&apos;d fail like this, i.e.&lt;br/&gt;
bq=(stuff). And when there was space, I don&apos;t think it worked at all....&lt;/p&gt;

&lt;p&gt;But yeah, it&apos;d be good to have both parens and negative boosts...&lt;/p&gt;


</comment>
                            <comment id="13454104" author="hossman" created="Wed, 12 Sep 2012 16:36:49 +0000"  >&lt;blockquote&gt;&lt;p&gt;I couldn&apos;t tell that this issue was an actual problem or a case of users putting whitespace where it doesn&apos;t belong and prior versions being more forgiving.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;James: the core of the bug was your use of SolrPluginUtils.parseFieldBoosts to try and parse the bq params.&lt;/p&gt;

&lt;p&gt;This is not safe &amp;#8211; if you look at the method it is an extremely trivial utility that is specific for parsing qf/pf style strings containing a list of field names and boosts.  it&apos;s &lt;em&gt;not&lt;/em&gt; a safe way to parse an arbitrary query string, and any non trivial query string can cause problems with it.&lt;/p&gt;

&lt;p&gt;AS you noted in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3278&quot; title=&quot;edismax support for negative boost with &amp;quot;bq&amp;quot; parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3278&quot;&gt;&lt;del&gt;SOLR-3278&lt;/del&gt;&lt;/a&gt;, parseFieldBoosts is used for parsing the &quot;bf&quot; param and that&apos;s actually a long standing unsafe bug as well (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-2014&quot; title=&quot;Allow BF parameter to accept complex nested expressions with whitespace sprinkled throughout&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-2014&quot;&gt;SOLR-2014&lt;/a&gt;) but since functions tend to be much simpler, it&apos;s historically been less problematic.  when people run into problems with it, the workarround is to use &quot;bq=&lt;/p&gt;
{!func}
&lt;p&gt;...&quot; instead.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;I would rather get a fix that preserves the negative boost support&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Since &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3278&quot; title=&quot;edismax support for negative boost with &amp;quot;bq&amp;quot; parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3278&quot;&gt;&lt;del&gt;SOLR-3278&lt;/del&gt;&lt;/a&gt; had not been released publicly outside of the ALPHA/BETA, my first priority was to fix the regression compared to 3.x where non-trivial bq queries worked fine.&lt;/p&gt;

&lt;p&gt;The documented method of dealing with &quot;negative boosting&quot; in solr is actually the type of query that was the crux of this bug report, and i updated the tests you added in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3278&quot; title=&quot;edismax support for negative boost with &amp;quot;bq&amp;quot; parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3278&quot;&gt;&lt;del&gt;SOLR-3278&lt;/del&gt;&lt;/a&gt; to use that pattern...&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://wiki.apache.org/solr/SolrRelevancyFAQ#How_do_I_give_a_negative_.28or_very_low.29_boost_to_documents_that_match_a_query.3F&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://wiki.apache.org/solr/SolrRelevancyFAQ#How_do_I_give_a_negative_.28or_very_low.29_boost_to_documents_that_match_a_query.3F&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I have no objections to supporting &quot;true&quot; negative boosts, but i think the right way to do it is in the query parsers / QParsers themselves (so that the boosts can be on any clause) and not just as a special hack for bq/bf (the fact that it works in bf is actualy just a fluke of it&apos;s buggy implementation) but as you can see in &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-4378&quot; title=&quot;QueryParsers do not support negative boosts&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-4378&quot;&gt;LUCENE-4378&lt;/a&gt; this is a contentious idea.&lt;/p&gt;
</comment>
                            <comment id="13454126" author="jdyer" created="Wed, 12 Sep 2012 17:01:44 +0000"  >&lt;p&gt;Hoss,  Thank you for working through this and opening Lucene-4378 to at least investigate changing the parser grammar.  I understand the issue with what I had done initially and appreciate your help on this.&lt;/p&gt;</comment>
                            <comment id="13455792" author="ehatcher" created="Fri, 14 Sep 2012 13:54:25 +0000"  >&lt;p&gt;Sorry to chime in after this issue has been marked as resolved, but .... it doesn&apos;t seem right to me that bq is parsed with the defType specified parser.  Rather it should, like fq&apos;s, default to the &quot;lucene&quot; query parser.  No?&lt;/p&gt;</comment>
                            <comment id="13455831" author="jkrupan" created="Fri, 14 Sep 2012 14:39:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;bq is parsed with the defType specified parser.  Rather it should, like fq&apos;s, default to the &quot;lucene&quot; query parser.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sounds reasonable for fq and bq to be parsed the same way, but it seems unrelated to this specific Jira.&lt;/p&gt;

&lt;p&gt;And this also begs the question of why bq shouldn&apos;t simply be a global query parameter like fq. I don&apos;t see any reason why a multiplicative boost shouldn&apos;t apply to a non-dismax/edismax query - but again this is outside the scope of this specific Jira.&lt;/p&gt;</comment>
                            <comment id="13457472" author="hossman" created="Mon, 17 Sep 2012 23:35:06 +0000"  >&lt;blockquote&gt;&lt;p&gt;Sorry to chime in after this issue has been marked as resolved, but .... it doesn&apos;t seem right to me that bq is parsed with the defType specified parser. &lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I don&apos;t understand this comment &amp;#8211; I see no evidence that &quot;bq&quot; is incorrectly using the defType parser in either dismax or edismax.&lt;/p&gt;

&lt;p&gt;In both cases null is passed to the subQuery() call for bq allowing it inherit the defTYpe from the &lt;em&gt;localparams&lt;/em&gt; of the main &quot;q&quot; string (which is appropriate since the bq is an implicit subquery added to the main query) but not a global defType.  ie, in the first example below, the &quot;lucene&quot; parser would be used to parse the bq, while in the second example the &quot;yyy&quot; parser would be used because of the explicit defType localparam...&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;/select?qf=name+text&amp;amp;defType=xxx&amp;amp;q={!edismax}mainquery&amp;amp;bq=myboost

/select?qf=name+text&amp;amp;defType=xxx&amp;amp;q={!edismax defType=yyy}mainquery&amp;amp;bq=myboost
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;...this is how subqueries have always worked with QParsers.  if you think this should be reconsidered, please open a specific issue.&lt;/p&gt;

&lt;p&gt;(NOTE: fq&apos;s are not subqueries of the main query, so they don&apos;t look at the &quot;q&quot; at all)&lt;/p&gt;
</comment>
                            <comment id="13457513" author="jkrupan" created="Tue, 18 Sep 2012 00:46:46 +0000"  >&lt;blockquote&gt;&lt;p&gt;...this is how subqueries have always worked with QParsers&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Is there any wiki/Javadoc that documents this behavior?&lt;/p&gt;

&lt;p&gt;I would also note that both the dismax and edismax wiki pages for &quot;bq&quot; say:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;A raw query string (in the SolrQuerySyntax)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;which is not right. We know it uses defType, but we clearly need the precise language as it is supposed to be (noting the comments by hossman.)&lt;/p&gt;

&lt;p&gt;See:&lt;br/&gt;
&lt;a href=&quot;http://wiki.apache.org/solr/DisMaxQParserPlugin#bq_.28Boost_Query.29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/solr/DisMaxQParserPlugin#bq_.28Boost_Query.29&lt;/a&gt;&lt;br/&gt;
&lt;a href=&quot;http://wiki.apache.org/solr/ExtendedDisMax#bq_.28Boost_Query.29&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://wiki.apache.org/solr/ExtendedDisMax#bq_.28Boost_Query.29&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13458013" author="ehatcher" created="Tue, 18 Sep 2012 18:09:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;I see no evidence that &quot;bq&quot; is incorrectly using the defType parser in either dismax or edismax&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ok, sorry I misinterpreted the nature of this issue apparently.&lt;/p&gt;</comment>
                            <comment id="13610875" author="commit-tag-bot" created="Fri, 22 Mar 2013 16:41:42 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Chris M. Hostetter&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1383716&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1383716&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3823&quot; title=&quot;Parentheses in a boost query cause errors&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3823&quot;&gt;&lt;del&gt;SOLR-3823&lt;/del&gt;&lt;/a&gt;: Fix &apos;bq&apos; parsing in edismax.  Please note that this required reverting the negative boost support added by &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3278&quot; title=&quot;edismax support for negative boost with &amp;quot;bq&amp;quot; parameter&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3278&quot;&gt;&lt;del&gt;SOLR-3278&lt;/del&gt;&lt;/a&gt; (merge r1383708)&lt;/p&gt;</comment>
                            <comment id="13653958" author="thetaphi" created="Fri, 10 May 2013 10:33:33 +0000"  >&lt;p&gt;Closed after release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12548187">SOLR-3278</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>243170</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03cfj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17447</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>