<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:38:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-4982] Creating a core while referencing system properties looks like it loses files.</title>
                <link>https://issues.apache.org/jira/browse/SOLR-4982</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;If you use the core admin handler to create core and reference system properties and index files without restarting Solr, your files are indexed to the wrong place.&lt;/p&gt;

&lt;p&gt;Say for instance I define a sys prop EOE=/Users/Erick/tmp and create a core with this request&lt;br/&gt;
localhost:8983/solr/admin/cores?action=CREATE&amp;amp;name=coreZ&amp;amp;instanceDir=coreZ&amp;amp;dataDir=%24%7BEOE%7D&lt;/p&gt;

&lt;p&gt;where %24%7BEOE%7D is really ${EOE} after URL escaping. What gets preserved in solr.xml is correct, dataDir is set to ${EOE}. And if I restart Solr, then index documents, they wind up in /Users/Erick/tmp. This is as it should be.&lt;/p&gt;

&lt;p&gt;HOWEVER, if rather than immediately restart Solr I index some documents to CoreZ, they go in &amp;lt;solr_home&amp;gt;/CoreZ/${EOE}. The literal path is ${EOE}, dollar sign, curly braces and all.&lt;/p&gt;

&lt;p&gt;How important is this to fix for 4.4?&lt;/p&gt;</description>
                <environment></environment>
        <key id="12655660">SOLR-4982</key>
            <summary>Creating a core while referencing system properties looks like it loses files.</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="erickerickson">Erick Erickson</assignee>
                                    <reporter username="erickerickson">Erick Erickson</reporter>
                        <labels>
                    </labels>
                <created>Mon, 1 Jul 2013 21:51:55 +0000</created>
                <updated>Mon, 9 May 2016 18:56:11 +0000</updated>
                            <resolved>Sun, 7 Jul 2013 12:52:46 +0000</resolved>
                                    <version>4.3</version>
                    <version>6.0</version>
                                    <fixVersion>4.4</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>multicore</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="13700089" author="erickerickson" created="Thu, 4 Jul 2013 14:29:07 +0000"  >&lt;p&gt;Patch with test case and fixes. All other tests pass.&lt;/p&gt;

&lt;p&gt;I&apos;ll check this in later today, I want to do a few more tests. Unless there are objections.&lt;/p&gt;</comment>
                            <comment id="13700346" author="erickerickson" created="Thu, 4 Jul 2013 21:15:03 +0000"  >&lt;p&gt;Along the way, I wondered &quot;gee, what happens if we create a core in discovery mode?&quot; Well, we don&apos;t preserve properties passed on the URL. This patch preserves any parameters passed in on the admin URL, e.g. dataDir, config etc.&lt;/p&gt;

&lt;p&gt;Oddly, you have to specify instanceDir even though it isn&apos;t a valid property for core.properties, else how do we let the user specify something not immediately below &amp;lt;solrhome&amp;gt;?&lt;/p&gt;

&lt;p&gt;But my remaining problem is that I can&apos;t exit the test gracefully, searchers are left hanging and we get the partial stack trace below.&lt;/p&gt;

&lt;p&gt;This usually means we did a CoreContainer.get and no corresponding close, but there aren&apos;t any such things. I think I even closed loading properties this time, although that would be unrelated I think.&lt;/p&gt;

&lt;p&gt;When we create cores in old-style solr.xml land, there&apos;s no need to do anything special to exit the tests. So I&apos;m hoping someone has an &quot;aha&quot; moment. Otherwise I need to dig into core creation in the discovery case and find out if it really is different.&lt;/p&gt;



&lt;p&gt;java.lang.AssertionError: ERROR: SolrIndexSearcher opens=3 closes=1&lt;br/&gt;
	at __randomizedtesting.SeedInfo.seed(&lt;span class=&quot;error&quot;&gt;&amp;#91;445018872D608FD5&amp;#93;&lt;/span&gt;:0)&lt;br/&gt;
	at org.junit.Assert.fail(Assert.java:93)&lt;br/&gt;
	at org.apache.solr.SolrTestCaseJ4.endTrackingSearchers(SolrTestCaseJ4.java:275)&lt;br/&gt;
	at org.apache.solr.SolrTestCaseJ4.afterClass(SolrTestCaseJ4.java:122)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke0(Native Method)&lt;br/&gt;
	at sun.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:57)&lt;br/&gt;
	at sun.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)&lt;br/&gt;
	at com.carrotsearch.randomizedtesting.RandomizedRunner.invoke(RandomizedRunner.java:1559)&lt;br/&gt;
	at com.carrotsearch.randomizedtesting.RandomizedRunner.access$600(RandomizedRunner.java:79)&lt;/p&gt;</comment>
                            <comment id="13700970" author="erickerickson" created="Fri, 5 Jul 2013 16:17:45 +0000"  >&lt;p&gt;Latest version. Thanks to Shalin I managed to find a way to have the test terminate.&lt;/p&gt;

&lt;p&gt;Along the way I&apos;ve added a new method to SolrTestCaseJ4 that creates a &quot;no core&quot; test harness that assumes discovery mode on the theory that it took me a while to figure out how to do that and we were going to do this a lot more in the future. Any easier ways to do this?&lt;/p&gt;

&lt;p&gt;Running tests and doing some manual inspection. If that all works out I&apos;ll probably check this in today.&lt;/p&gt;</comment>
                            <comment id="13701019" author="erickerickson" created="Fri, 5 Jul 2013 17:43:24 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=romseygeek&quot; class=&quot;user-hover&quot; rel=&quot;romseygeek&quot;&gt;romseygeek&lt;/a&gt; Your changes to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4948&quot; title=&quot;Tidy up CoreContainer construction logic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4948&quot;&gt;&lt;del&gt;SOLR-4948&lt;/del&gt;&lt;/a&gt; turned out to be something that I used (unknowingly) for this patch. When do you expect to merge 4948 with 4x? I&apos;d like to get this in to 4.4, but don&apos;t want to rush things unduly.&lt;/p&gt;

&lt;p&gt;Thanks,&lt;br/&gt;
Erick&lt;/p&gt;</comment>
                            <comment id="13701022" author="erickerickson" created="Fri, 5 Jul 2013 17:45:24 +0000"  >&lt;p&gt;Turning to a blocker so I don&apos;t lose track of it for 4.4. Need o get &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4948&quot; title=&quot;Tidy up CoreContainer construction logic&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4948&quot;&gt;&lt;del&gt;SOLR-4948&lt;/del&gt;&lt;/a&gt; checked in to untangle the test harness so I can invoke it cleanly with no cores defined in discovery mode. Maybe there&apos;s a better way?&lt;/p&gt;</comment>
                            <comment id="13701359" author="erickerickson" created="Sat, 6 Jul 2013 14:44:32 +0000"  >&lt;p&gt;Final patch, committing momentarily&lt;/p&gt;</comment>
                            <comment id="13701360" author="jira-bot" created="Sat, 6 Jul 2013 14:45:49 +0000"  >&lt;p&gt;Commit 1500284 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erickoerickson&quot; class=&quot;user-hover&quot; rel=&quot;erickoerickson&quot;&gt;erickoerickson&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1500284&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1500284&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Fix for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4982&quot; title=&quot;Creating a core while referencing system properties looks like it loses files.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4982&quot;&gt;&lt;del&gt;SOLR-4982&lt;/del&gt;&lt;/a&gt;, creating cores with sysprops does not dereference them properly&lt;/p&gt;</comment>
                            <comment id="13701361" author="erickerickson" created="Sat, 6 Jul 2013 14:46:39 +0000"  >&lt;p&gt;trunk: r - 1500284&lt;/p&gt;

&lt;p&gt;Needs to wait on a couple of other patches to be merged into 4.x to commit there.&lt;/p&gt;</comment>
                            <comment id="13701479" author="erickerickson" created="Sun, 7 Jul 2013 02:24:00 +0000"  >&lt;p&gt;An attempt to fix the broken test.&lt;/p&gt;

&lt;p&gt;Apply &lt;em&gt;after&lt;/em&gt; main patch.&lt;/p&gt;</comment>
                            <comment id="13701481" author="jira-bot" created="Sun, 7 Jul 2013 02:25:50 +0000"  >&lt;p&gt;Commit 1500354 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erickoerickson&quot; class=&quot;user-hover&quot; rel=&quot;erickoerickson&quot;&gt;erickoerickson&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1500354&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1500354&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;Fix broken test checked in with &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4982&quot; title=&quot;Creating a core while referencing system properties looks like it loses files.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4982&quot;&gt;&lt;del&gt;SOLR-4982&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="13701486" author="jira-bot" created="Sun, 7 Jul 2013 02:51:18 +0000"  >&lt;p&gt;Commit 1500359 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=erickoerickson&quot; class=&quot;user-hover&quot; rel=&quot;erickoerickson&quot;&gt;erickoerickson&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1500359&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1500359&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-4982&quot; title=&quot;Creating a core while referencing system properties looks like it loses files.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-4982&quot;&gt;&lt;del&gt;SOLR-4982&lt;/del&gt;&lt;/a&gt; 4x checkin, including the test fix (trunk r 1500354)&lt;/p&gt;</comment>
                            <comment id="13716814" author="steve_rowe" created="Tue, 23 Jul 2013 18:38:40 +0000"  >&lt;p&gt;Bulk close resolved 4.4 issues&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12654178">SOLR-4948</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12591104" name="SOLR-4982-fixtest.patch" size="1249" author="erickerickson" created="Sun, 7 Jul 2013 02:24:00 +0000"/>
                            <attachment id="12591084" name="SOLR-4982.patch" size="23396" author="erickerickson" created="Sat, 6 Jul 2013 14:44:32 +0000"/>
                            <attachment id="12591019" name="SOLR-4982.patch" size="23166" author="erickerickson" created="Fri, 5 Jul 2013 16:17:45 +0000"/>
                            <attachment id="12590941" name="SOLR-4982.patch" size="20315" author="erickerickson" created="Thu, 4 Jul 2013 21:15:03 +0000"/>
                            <attachment id="12590897" name="SOLR-4982.patch" size="8485" author="erickerickson" created="Thu, 4 Jul 2013 14:29:07 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>335935</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 18 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ly2v:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>336259</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>