<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:51:39 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-6015] managed synonyms don&apos;t gracefully handle lowercasing</title>
                <link>https://issues.apache.org/jira/browse/SOLR-6015</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;I&apos;ve been having bad luck testing new functionallity lately - the first thing I try never works &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;/opt/code/lusolr48/solr/example/solr/collection1/conf$ curl -XPUT &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//localhost:8983/solrsis/synonyms/english&quot;&lt;/span&gt;   -H &lt;span class=&quot;code-quote&quot;&gt;&apos;Content-type:application/json&apos;&lt;/span&gt;   --data-binary &lt;span class=&quot;code-quote&quot;&gt;&apos;{&lt;span class=&quot;code-quote&quot;&gt;&quot;MB&quot;&lt;/span&gt;:[&lt;span class=&quot;code-quote&quot;&gt;&quot;MiB&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;Megabyte&quot;&lt;/span&gt;]}&apos;&lt;/span&gt;
&lt;/span&gt;{
  &lt;span class=&quot;code-quote&quot;&gt;&quot;responseHeader&quot;&lt;/span&gt;:{
    &lt;span class=&quot;code-quote&quot;&gt;&quot;status&quot;&lt;/span&gt;:500,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;QTime&quot;&lt;/span&gt;:3},
  &lt;span class=&quot;code-quote&quot;&gt;&quot;error&quot;&lt;/span&gt;:{
    &lt;span class=&quot;code-quote&quot;&gt;&quot;msg&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;Bad Request&quot;&lt;/span&gt;,
    &lt;span class=&quot;code-quote&quot;&gt;&quot;trace&quot;&lt;/span&gt;:&quot;Bad Request (400) - Unsupported value &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; mb; expected single value or a JSON array!\n
[...]
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;I finally figured out that if I lowercased &quot;MB&quot; to &quot;mb&quot;, then it works as expected.&lt;br/&gt;
Also, it looks like because ignoreCase is true in the initArgs, everything is &lt;b&gt;stored&lt;/b&gt; as lower case in the managed map (losing information).  Ideally case would be preserved in the synonym file (esp if one wanted to change ignoreCase either way).  I imagine stopwords may have the same issue, but I haven&apos;t checked.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12710551">SOLR-6015</key>
            <summary>managed synonyms don&apos;t gracefully handle lowercasing</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="thelabdude">Timothy Potter</assignee>
                                    <reporter username="yseeley@gmail.com">Yonik Seeley</reporter>
                        <labels>
                    </labels>
                <created>Fri, 25 Apr 2014 13:48:10 +0000</created>
                <updated>Mon, 9 May 2016 18:45:28 +0000</updated>
                            <resolved>Mon, 16 Jun 2014 18:28:59 +0000</resolved>
                                                    <fixVersion>4.9</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="13992248" author="thelabdude" created="Wed, 7 May 2014 21:30:16 +0000"  >&lt;p&gt;Here&apos;s a patch that addresses the issue with MB vs. mb and handles ignoreCase setting better (I think). Would appreciate some feedback on this before committing.&lt;/p&gt;

&lt;p&gt;The main change here is that I&apos;m preserving case using an inner class named CasePreservingSynonymMappings regardless of the ignoreCase setting. Here&apos;s an example of how that looks at runtime:&lt;/p&gt;

&lt;p&gt;{ &lt;br/&gt;
  &quot;mb&quot; : &lt;/p&gt;
{
    &quot;MB&quot;:[&quot;Megabyte&quot;,&quot;MiB&quot;],
    &quot;mb&quot;:[&quot;megabyte&quot;]
  }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;Thus, the ignoreCase setting isn&apos;t applied on store, rather it is applied when the managed synonym mappings data is &quot;viewed&quot;. For instance, a get request for the &quot;MB&quot; child with ignoreCase==true would yield a merged list, such as:&lt;/p&gt;

&lt;p&gt;&quot;MB&quot;:&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;Megabyte&amp;quot;,&amp;quot;MiB&amp;quot;,&amp;quot;megabyte&amp;quot;&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;This brings me to my first question. Should we only return one form when mappings overlap as is the case with &quot;Megabyte&quot; and &quot;megabyte&quot;? Right now, it returns both forms but with ignoreCase==true, maybe it should return only one of those? Again this is a view and both are stored so if you switch ignoreCase, then there&apos;s no information lost.&lt;/p&gt;

&lt;p&gt;If ignoreCase is false and you request the mappings for &quot;MB&quot;, then you just get:&lt;/p&gt;

&lt;p&gt;&quot;MB&quot;:&lt;span class=&quot;error&quot;&gt;&amp;#91;&amp;quot;Megabyte&amp;quot;,&amp;quot;MiB&amp;quot;&amp;#93;&lt;/span&gt;&lt;/p&gt;

&lt;p&gt;It follows that if ignoreCase == false and the client asks for &quot;Mb&quot;, then they get a 404.&lt;/p&gt;

&lt;p&gt;The second question is about switching the ignoreCase setting, which the API allows. The previous code used to rebuild the map, but now that&apos;s not needed since we store the data as it was added and only apply the ignoreCase setting when the data is viewed. Am I overlooking something here?&lt;/p&gt;

&lt;p&gt;Lastly, you&apos;ll notice I&apos;m applying the ignoreCase setting in the ManagedSynonymParser, which is done to match the behavior of the current SynonymMap parser/builder. I&apos;ve compared the results of the text analysis performed by the existing SynonymFilterFactory and the ManagedSynonymFilterFactory and they create the same tokens.&lt;/p&gt;
</comment>
                            <comment id="13993017" author="steve_rowe" created="Thu, 8 May 2014 19:00:11 +0000"  >&lt;p&gt;Tim,&lt;/p&gt;

&lt;p&gt;The approach looks great - cool that all ignoreCase changes are now supported.&lt;/p&gt;

&lt;p&gt;Two things I noticed:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;One optimization you might consider in &lt;tt&gt;CasePreservingSynonymMappings.getMappings()&lt;/tt&gt;: in the (very likely overwhelmingly ordinary) case of only one cased version of a key, you could just return the mappings from &lt;tt&gt;CasePreservingSynonymMappings&lt;/tt&gt; rather than copying them to a new map, since no merging will be required.&lt;/li&gt;
	&lt;li&gt;You can drop the overridden &lt;tt&gt;ManagedSynonymFilterFactory.updateInitArgs()&lt;/tt&gt;, since it just calls the superclass method of the same name (after validating params, which the superclass method also does).&lt;/li&gt;
&lt;/ul&gt;

</comment>
                            <comment id="14006211" author="jira-bot" created="Thu, 22 May 2014 18:03:38 +0000"  >&lt;p&gt;Commit 1596928 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thelabdude&quot; class=&quot;user-hover&quot; rel=&quot;thelabdude&quot;&gt;thelabdude&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1596928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1596928&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6015&quot; title=&quot;managed synonyms don&amp;#39;t gracefully handle lowercasing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6015&quot;&gt;&lt;del&gt;SOLR-6015&lt;/del&gt;&lt;/a&gt;: improved strategy for handling managed synonyms when ignoreCase=true&lt;/p&gt;</comment>
                            <comment id="14032730" author="jira-bot" created="Mon, 16 Jun 2014 18:25:04 +0000"  >&lt;p&gt;Commit 1602948 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thelabdude&quot; class=&quot;user-hover&quot; rel=&quot;thelabdude&quot;&gt;thelabdude&lt;/a&gt; in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1602948&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1602948&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6015&quot; title=&quot;managed synonyms don&amp;#39;t gracefully handle lowercasing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6015&quot;&gt;&lt;del&gt;SOLR-6015&lt;/del&gt;&lt;/a&gt;: Backport fixes from trunk to branch_4x.&lt;/p&gt;</comment>
                            <comment id="14032734" author="jira-bot" created="Mon, 16 Jun 2014 18:28:09 +0000"  >&lt;p&gt;Commit 1602950 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=thelabdude&quot; class=&quot;user-hover&quot; rel=&quot;thelabdude&quot;&gt;thelabdude&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1602950&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1602950&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6015&quot; title=&quot;managed synonyms don&amp;#39;t gracefully handle lowercasing&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6015&quot;&gt;&lt;del&gt;SOLR-6015&lt;/del&gt;&lt;/a&gt;: Moving change note to 4.9 bugfix section.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12643850" name="SOLR-6015.patch" size="14389" author="thelabdude" created="Wed, 7 May 2014 21:30:16 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>388872</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 23 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1uzgn:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>389118</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>