<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:24:02 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-2895] AutoCommitTest.maxDocs fails intermittently on trunk</title>
                <link>https://issues.apache.org/jira/browse/SOLR-2895</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;ant clean test -Dtestcase=AutoCommitTest -Dtestmethod=testMaxDocs -Dtests.seed=50ccee7e682c1673:-5043acd3fdf2c09f:123d82991d063e29 -Dargs=&quot;-Dfile.encoding=MacRoman&quot;&lt;/p&gt;

&lt;p&gt;This fails for me 40% of the time or so. Also fails with -Dtests.iter.&lt;/p&gt;

&lt;p&gt;Set tests.iter=1000 on 3x and no problem.&lt;/p&gt;

&lt;p&gt;Don&apos;t quite know what the priority should be.&lt;/p&gt;</description>
                <environment>&lt;p&gt;Mac OS X&lt;/p&gt;

&lt;p&gt;java version &quot;1.6.0_26&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.6.0_26-b03-384-10M3425)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 20.1-b02-384, mixed mode)&lt;/p&gt;

&lt;p&gt;Trunk 1201462&lt;/p&gt;</environment>
        <key id="12531266">SOLR-2895</key>
            <summary>AutoCommitTest.maxDocs fails intermittently on trunk</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="simonw">Simon Willnauer</assignee>
                                    <reporter username="erickerickson">Erick Erickson</reporter>
                        <labels>
                    </labels>
                <created>Sun, 13 Nov 2011 18:25:16 +0000</created>
                <updated>Fri, 10 May 2013 10:40:51 +0000</updated>
                            <resolved>Tue, 15 Nov 2011 09:28:59 +0000</resolved>
                                    <version>4.0-ALPHA</version>
                                    <fixVersion>4.0-ALPHA</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>0</watches>
                                                                                                                <comments>
                            <comment id="13149892" author="simonw" created="Mon, 14 Nov 2011 20:42:34 +0000"  >&lt;p&gt;I don&apos;t see how this test can ever be reliable. We call commitTracker.addedDocument( cmd.commitWithin ); before the document is passed to the IndexWriter... no surprise this fails all the time. Its kind of weird that we call addedDocument (past tense) before it actually happened. I think we should do that once we added the document not before. then this test should work just fine&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
Index: solr/core/src/java/org/apache/solr/update/DirectUpdateHandler2.java
===================================================================
--- solr/core/src/java/org/apache/solr/update/DirectUpdateHandler2.java	(revision 1201867)
+++ solr/core/src/java/org/apache/solr/update/DirectUpdateHandler2.java	(working copy)
@@ -143,7 +143,6 @@
 
 
     &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; {
-      commitTracker.addedDocument( cmd.commitWithin );
       softCommitTracker.addedDocument( -1 ); &lt;span class=&quot;code-comment&quot;&gt;// TODO: support commitWithin with soft update
&lt;/span&gt; 
       &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (cmd.overwrite) {
@@ -172,7 +171,7 @@
         &lt;span class=&quot;code-comment&quot;&gt;// allow duplicates
&lt;/span&gt;         writer.addDocument(cmd.getLuceneDocument());
       }
-
+      commitTracker.addedDocument( cmd.commitWithin );
       &lt;span class=&quot;code-comment&quot;&gt;// Add to the transaction log *after* successfully adding to the index, &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; there was no error.
&lt;/span&gt;       &lt;span class=&quot;code-comment&quot;&gt;// This ordering ensures that &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; we log it, it&apos;s definitely been added to the the index.
&lt;/span&gt;       &lt;span class=&quot;code-comment&quot;&gt;// This also ensures that &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; a commit sneaks in-between, that we know everything in a particular&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;btw. this could fail on 3.x as well we do the same thing there basically.&lt;/p&gt;</comment>
                            <comment id="13150121" author="erickerickson" created="Tue, 15 Nov 2011 00:45:32 +0000"  >&lt;p&gt;Splendid, are you going to apply this or should I? Gotta admin my time is a bit tight right now, but I can probably squeeze it in.&lt;/p&gt;</comment>
                            <comment id="13150248" author="yseeley@gmail.com" created="Tue, 15 Nov 2011 05:35:22 +0000"  >&lt;blockquote&gt;&lt;p&gt;I don&apos;t see how this test can ever be reliable. We call commitTracker.addedDocument( cmd.commitWithin ); before the document is passed to the IndexWriter... no surprise this fails all the time.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ah, nice catch!  It didn&apos;t matter in the past, but it became a bug with the recent removal of Solr&apos;s synchronization (i.e. so adds and commits aren&apos;t mutually exclusive anymore).  So at least this isn&apos;t a bug in 3x or before.&lt;/p&gt;</comment>
                            <comment id="13150301" author="simonw" created="Tue, 15 Nov 2011 08:30:00 +0000"  >&lt;blockquote&gt;&lt;p&gt;Splendid, are you going to apply this or should I? Gotta admin my time is a bit tight right now, but I can probably squeeze it in.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I take it...&lt;/p&gt;</comment>
                            <comment id="13150321" author="simonw" created="Tue, 15 Nov 2011 09:15:18 +0000"  >&lt;p&gt;patch - for the record.... &lt;/p&gt;</comment>
                            <comment id="13150322" author="simonw" created="Tue, 15 Nov 2011 09:16:24 +0000"  >&lt;blockquote&gt;&lt;p&gt;Ah, nice catch! It didn&apos;t matter in the past, but it became a bug with the recent removal of Solr&apos;s synchronization (i.e. so adds and commits aren&apos;t mutually exclusive anymore). So at least this isn&apos;t a bug in 3x or before.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;ah right, I didn&apos;t look at the big picture there... that makes sense so no need to fix this in 3.x (still looks weird since we call it addedDocument)&lt;/p&gt;</comment>
                            <comment id="13150460" author="erickerickson" created="Tue, 15 Nov 2011 13:06:49 +0000"  >&lt;p&gt;Looks good. Ran it on my machine with tests.iter=1000 and no problems.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12503724" name="SOLR-2895.patch" size="1007" author="simonw" created="Tue, 15 Nov 2011 09:15:18 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>217003</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            14 years, 2 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03hxj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18338</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>