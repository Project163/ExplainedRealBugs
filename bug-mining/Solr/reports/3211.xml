<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:18:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9928] MetricsDirectoryFactory::renameWithOverwrite incorrectly calls super</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9928</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;MetricsDirectoryFactory::renameWithOverwrite should call the delegate instead of super. Trivial patch forthcoming.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13032086">SOLR-9928</key>
            <summary>MetricsDirectoryFactory::renameWithOverwrite incorrectly calls super</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ab">Andrzej Bialecki</assignee>
                                    <reporter username="mdrob">Mike Drob</reporter>
                        <labels>
                    </labels>
                <created>Wed, 4 Jan 2017 21:12:21 +0000</created>
                <updated>Sat, 8 Jun 2019 15:31:17 +0000</updated>
                            <resolved>Sat, 7 Jan 2017 18:16:40 +0000</resolved>
                                    <version>6.4</version>
                    <version>7.0</version>
                                    <fixVersion>6.4</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                    <component>metrics</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="15799368" author="mdrob" created="Wed, 4 Jan 2017 21:15:13 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ab&quot; class=&quot;user-hover&quot; rel=&quot;ab&quot;&gt;ab&lt;/a&gt; - can you take a look, since this is mostly a follow on to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9854&quot; title=&quot;Collect metrics for index merges and index store IO&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9854&quot;&gt;&lt;del&gt;SOLR-9854&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="15800186" author="mdrob" created="Thu, 5 Jan 2017 03:41:21 +0000"  >&lt;p&gt;Discovered that my original patch was incomplete - need to unwrap one layer of directories here otherwise CachingDirectory fails to find in the cache.&lt;/p&gt;</comment>
                            <comment id="15801834" author="jira-bot" created="Thu, 5 Jan 2017 16:47:56 +0000"  >&lt;p&gt;Commit e5264c48955165ac5c5b1aabba4748378d3f6fa9 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ab&quot; class=&quot;user-hover&quot; rel=&quot;ab&quot;&gt;ab&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e5264c4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e5264c4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9928&quot; title=&quot;MetricsDirectoryFactory::renameWithOverwrite incorrectly calls super&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9928&quot;&gt;&lt;del&gt;SOLR-9928&lt;/del&gt;&lt;/a&gt;: MetricsDirectoryFactory::renameWithOverwrite incorrectly calls super (Mike Drob via ab)&lt;/p&gt;</comment>
                            <comment id="15802047" author="jira-bot" created="Thu, 5 Jan 2017 17:59:01 +0000"  >&lt;p&gt;Commit 60da846b14f4d7904db2b4ee74b4cea247c6c572 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ab&quot; class=&quot;user-hover&quot; rel=&quot;ab&quot;&gt;ab&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=60da846&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=60da846&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9928&quot; title=&quot;MetricsDirectoryFactory::renameWithOverwrite incorrectly calls super&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9928&quot;&gt;&lt;del&gt;SOLR-9928&lt;/del&gt;&lt;/a&gt;: MetricsDirectoryFactory::renameWithOverwrite incorrectly calls super (Mike Drob via ab)&lt;/p&gt;</comment>
                            <comment id="15802048" author="ab" created="Thu, 5 Jan 2017 17:59:18 +0000"  >&lt;p&gt;Well spotted! Thank you for the patch - committed to master and branch_6x.&lt;/p&gt;</comment>
                            <comment id="15803205" author="markrmiller@gmail.com" created="Fri, 6 Jan 2017 01:54:38 +0000"  >&lt;p&gt;Why do we unwrap in some methods that can get overridden but not others?&lt;/p&gt;</comment>
                            <comment id="15803208" author="markrmiller@gmail.com" created="Fri, 6 Jan 2017 01:55:52 +0000"  >&lt;p&gt;Mostly I guess I&apos;m looking at move.&lt;/p&gt;</comment>
                            <comment id="15803421" author="mdrob" created="Fri, 6 Jan 2017 03:39:24 +0000"  >&lt;p&gt;We very possibly could need to unwrap for move, and haven&apos;t caught it because that only gets called in a very specific case to move specific files during a replication. I&apos;ll try to write up a test to hit this path. Note that we do already unwrap for remove, which makes me think you&apos;re on the right track.&lt;/p&gt;</comment>
                            <comment id="15803427" author="mdrob" created="Fri, 6 Jan 2017 03:42:21 +0000"  >&lt;p&gt;Also, we can safely remove MetricsDirectory.getBaseDir since all implementations bubble up to DirectoryFactory anyway.&lt;/p&gt;</comment>
                            <comment id="15803494" author="markrmiller@gmail.com" created="Fri, 6 Jan 2017 04:13:14 +0000"  >&lt;p&gt;Im not even sure the wrapping is needed. The impels should properly unwrap bow. But perhaps the Intent was to hide. In either case we should be consistent. &lt;/p&gt;</comment>
                            <comment id="15804976" author="mdrob" created="Fri, 6 Jan 2017 16:51:13 +0000"  >&lt;p&gt;Ran some tests locally and it looks like the only two specializations both unwrap properly internally, so we don&apos;t have to worry about it here. Needed to unwrap in renameWithOverwrite because the implementations there &lt;em&gt;did not&lt;/em&gt; unwrap before trying to use. I don&apos;t have strong opinions about the consistency argument here.&lt;/p&gt;

&lt;p&gt;However, while looking into this, I discovered a bug in StandardDirectoryFactory::move, filed as &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9937&quot; title=&quot;StandardDirectoryFactory::move never uses atomic implementation&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9937&quot;&gt;&lt;del&gt;SOLR-9937&lt;/del&gt;&lt;/a&gt;&lt;/p&gt;</comment>
                            <comment id="15805115" author="markrmiller@gmail.com" created="Fri, 6 Jan 2017 17:49:38 +0000"  >&lt;p&gt;Previously non of the impls unwrapped more than One layer and they only did it for nrt caching dir. I recently fixed it so they unwrap Filtered dirs multiple layers. So we should remove the unwrapping probably.  The consistency argument is that it&apos;s confusing to only do some&lt;br/&gt;
Methods. It indicates the unwrapping is unnecessary cruft where it used. Or it&apos;s intentionally trying to hide the dir and failing to in some cases. Doesn&apos;t make sense in any scenario. &lt;/p&gt;</comment>
                            <comment id="15805150" author="markrmiller@gmail.com" created="Fri, 6 Jan 2017 18:03:09 +0000"  >&lt;p&gt;The argument for hiding and doing a single unwrap everywhere seems to be that this factory tries to inject itself in an abnormal way, rather than counting on being configured. It almost looks like it hides outside the cache - and so the unwrap would pass the cache key directory that impls may expect to get passed.&lt;/p&gt;</comment>
                            <comment id="15807060" author="ab" created="Sat, 7 Jan 2017 08:00:41 +0000"  >&lt;blockquote&gt;&lt;p&gt;this factory tries to inject itself in an abnormal way, rather than counting on being configured&lt;/p&gt;&lt;/blockquote&gt;
&lt;p&gt;That&apos;s exactly the intent. The reason for this design is that I wanted consistency of adding the metrics monitoring no matter what implementation users provided, and I couldn&apos;t count on metrics being injected in every implementation (adding this functionality to base &lt;tt&gt;DirectoryFactory&lt;/tt&gt; wouldn&apos;t do it, because users would be free to create non-instrumented &lt;tt&gt;Directory&lt;/tt&gt; impls anyway).&lt;/p&gt;

&lt;p&gt;So yes, it looks like we need to be consistent and unwrap this one level in every call that takes &lt;tt&gt;Directory&lt;/tt&gt; as argument.&lt;/p&gt;</comment>
                            <comment id="15807415" author="jira-bot" created="Sat, 7 Jan 2017 12:24:33 +0000"  >&lt;p&gt;Commit e5f39f62f76677a5f500af4f323c0c31afb26228 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ab&quot; class=&quot;user-hover&quot; rel=&quot;ab&quot;&gt;ab&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e5f39f6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e5f39f6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9928&quot; title=&quot;MetricsDirectoryFactory::renameWithOverwrite incorrectly calls super&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9928&quot;&gt;&lt;del&gt;SOLR-9928&lt;/del&gt;&lt;/a&gt; Unwrap Directory consistently whenever it&apos;s passed as an argument.&lt;/p&gt;</comment>
                            <comment id="15807919" author="jira-bot" created="Sat, 7 Jan 2017 18:16:01 +0000"  >&lt;p&gt;Commit e275e91293e2ecb0356415a178c7ccd38a7182ff in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ab&quot; class=&quot;user-hover&quot; rel=&quot;ab&quot;&gt;ab&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e275e91&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=e275e91&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9928&quot; title=&quot;MetricsDirectoryFactory::renameWithOverwrite incorrectly calls super&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9928&quot;&gt;&lt;del&gt;SOLR-9928&lt;/del&gt;&lt;/a&gt; Unwrap Directory consistently whenever it&apos;s passed as an argument.&lt;/p&gt;</comment>
                            <comment id="15807920" author="ab" created="Sat, 7 Jan 2017 18:16:40 +0000"  >&lt;p&gt;I fixed the inconsistent unwrapping. Thank you Mike and Mark for your help!&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12845695" name="SOLR-9928.patch" size="786" author="mdrob" created="Thu, 5 Jan 2017 03:41:21 +0000"/>
                            <attachment id="12845622" name="SOLR-9928.patch" size="679" author="mdrob" created="Wed, 4 Jan 2017 21:15:13 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 45 weeks, 3 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i389xb:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>