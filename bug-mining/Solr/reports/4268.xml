<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:39:40 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-13472] HTTP requests to a node that does not hold a core of the collection are unauthorized</title>
                <link>https://issues.apache.org/jira/browse/SOLR-13472</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When creating collection in SolrCloud, collection is available for queries and updates through all Solr nodes, in particular nodes that does not hold one of collection&apos;s cores. This is expected behaviour that works when using SolrJ&#160;client or HTTP requests.&lt;br/&gt;
When enabling authorization rules it seems that this behaviour is broken for HTTP requests:&lt;/p&gt;
&lt;ul class=&quot;alternate&quot; type=&quot;square&quot;&gt;
	&lt;li&gt;executing request to a node that holds part of the collection (core) obey to authorization rules as expected.&lt;/li&gt;
	&lt;li&gt;other nodes respond with code 403 - unauthorized request.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;SolrJ still works as expected.&lt;br/&gt;
Tested both with BasicAuthPlugin and KerberosPlugin authentication plugins.&lt;/p&gt;

&lt;p&gt;&lt;ins&gt;Steps for reproduce:&lt;/ins&gt;&lt;br/&gt;
1. Create a cloud made of 2 nodes (node_1, node_2).&lt;br/&gt;
2. Configure authentication and authorization by uploading following security.json file to zookeeper:&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{
 &lt;span class=&quot;code-quote&quot;&gt;&quot;authentication&quot;&lt;/span&gt;: {
   &lt;span class=&quot;code-quote&quot;&gt;&quot;blockUnknown&quot;&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,
   &lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;solr.BasicAuthPlugin&quot;&lt;/span&gt;,
   &lt;span class=&quot;code-quote&quot;&gt;&quot;credentials&quot;&lt;/span&gt;: {
     &lt;span class=&quot;code-quote&quot;&gt;&quot;solr&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;solr&apos;&lt;/span&gt; user password_hash&quot;&lt;/span&gt;,
     &lt;span class=&quot;code-quote&quot;&gt;&quot;indexer_app&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;indexer_app&apos;&lt;/span&gt; password_hash&quot;&lt;/span&gt;,
     &lt;span class=&quot;code-quote&quot;&gt;&quot;read_user&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-quote&quot;&gt;&apos;read_user&apos;&lt;/span&gt; password_hash&quot;&lt;/span&gt;
   }
 },
 &lt;span class=&quot;code-quote&quot;&gt;&quot;authorization&quot;&lt;/span&gt;: {
   &lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;solr.RuleBasedAuthorizationPlugin&quot;&lt;/span&gt;,
   &lt;span class=&quot;code-quote&quot;&gt;&quot;permissions&quot;&lt;/span&gt;: [
     {
       &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;read&quot;&lt;/span&gt;,
       &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;*&quot;&lt;/span&gt;
     },
     {
       &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;update&quot;&lt;/span&gt;,
       &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;: [
         &lt;span class=&quot;code-quote&quot;&gt;&quot;indexer&quot;&lt;/span&gt;,
         &lt;span class=&quot;code-quote&quot;&gt;&quot;admin&quot;&lt;/span&gt;
       ]
     },
     {
       &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;all&quot;&lt;/span&gt;,
       &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;admin&quot;&lt;/span&gt;
     }
   ],
   &lt;span class=&quot;code-quote&quot;&gt;&quot;user-role&quot;&lt;/span&gt;: {
     &lt;span class=&quot;code-quote&quot;&gt;&quot;solr&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;admin&quot;&lt;/span&gt;,
     &lt;span class=&quot;code-quote&quot;&gt;&quot;indexer_app&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;indexer&quot;&lt;/span&gt;
   }
 }
}&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;3. create &apos;test&apos; collection with one shard on &lt;b&gt;node_1&lt;/b&gt;.&lt;/p&gt;

&lt;p&gt;--&#160;&lt;/p&gt;

&lt;p&gt;The following requests expected to succeed but return 403 status (unauthorized request):&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
curl -u read_user:read_user &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//node_2/solr/test/select?q=*:*&quot;&lt;/span&gt;
&lt;/span&gt;curl -u indexer_app:indexer_app &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//node_2/solr/test/select?q=*:*&quot;&lt;/span&gt;
&lt;/span&gt;curl -u indexer_app:indexer_app &lt;span class=&quot;code-quote&quot;&gt;&quot;http:&lt;span class=&quot;code-comment&quot;&gt;//node_2/solr/test/update?commit=&lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;&quot;&lt;/span&gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;&#160;&lt;/p&gt;

&lt;p&gt;Authenticated &apos;&lt;em&gt;solr&lt;/em&gt;&apos; user requests works as expected. My guess is due to the special &apos;&lt;em&gt;all&lt;/em&gt;&apos; role.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13233451">SOLR-13472</key>
            <summary>HTTP requests to a node that does not hold a core of the collection are unauthorized</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ichattopadhyaya">Ishan Chattopadhyaya</assignee>
                                    <reporter username="adfel70">adfel</reporter>
                        <labels>
                            <label>security</label>
                    </labels>
                <created>Wed, 15 May 2019 11:16:28 +0000</created>
                <updated>Wed, 19 Feb 2020 20:18:00 +0000</updated>
                            <resolved>Mon, 15 Jul 2019 12:43:23 +0000</resolved>
                                    <version>7.7.1</version>
                    <version>8.0</version>
                                    <fixVersion>7.7.3</fixVersion>
                    <fixVersion>8.2</fixVersion>
                                    <component>Authorization</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4200">1h 10m</timespent>
                                <comments>
                            <comment id="16840760" author="gerlowskija" created="Wed, 15 May 2019 21:06:23 +0000"  >&lt;p&gt;I haven&apos;t tried out your example yet, so I can&apos;t speak to what is causing the behavior you&apos;re seeing.  I hope to look into it soon.&lt;/p&gt;

&lt;p&gt;But I can offer one point of clarification on why the behavior might differ in SolrJ vs a curl request.  I suspect what&apos;s happening is that your SolrJ code makes use of CloudSolrClient.  CloudSolrClient is data-aware for collections, meaning that it makes requests directly to the nodes hosting your data (saving users some extra hops).  So if the behavior is only triggered when a request arrives at a node that &lt;em&gt;doesnt&lt;/em&gt; host your data, it makes sense that SolrJ (or at least CloudSolrClient) is unable to trigger it.&lt;/p&gt;</comment>
                            <comment id="16840800" author="noble.paul" created="Wed, 15 May 2019 21:38:48 +0000"  >&lt;p&gt;which is the version of Solr you are using?&lt;/p&gt;</comment>
                            <comment id="16841065" author="adfel70" created="Thu, 16 May 2019 07:37:10 +0000"  >&lt;p&gt;We tested&#160;using versions 7.7.1, 8.0.0 and a snapshot of 7.7.2 that was built about a week ago.&lt;/p&gt;</comment>
                            <comment id="16871757" author="ichattopadhyaya" created="Mon, 24 Jun 2019 20:20:19 +0000"  >&lt;p&gt;I am able to reproduce this problem and looking at possible causes.&lt;/p&gt;</comment>
                            <comment id="16877453" author="ichattopadhyaya" created="Wed, 3 Jul 2019 03:32:49 +0000"  >&lt;p&gt;The problem here was:&lt;br/&gt;
 1. node_2 doesn&apos;t have a replica for test collection.&lt;br/&gt;
 2. As a result, the permissions that have been set couldn&apos;t be validated.&lt;br/&gt;
 3. The &quot;all&quot; permission here was claimed by &quot;admin&quot;, and hence this request was falsely marked MatchStatus.FORBIDDEN.&lt;/p&gt;

&lt;p&gt;What should&apos;ve happened is:&lt;br/&gt;
 If node receiving the request doesn&apos;t host a replica, it should check if &quot;forwardCredentials&quot; (&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12799&quot; title=&quot;Allow Authentication Plugins to easily intercept internode requests&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12799&quot;&gt;&lt;del&gt;SOLR-12799&lt;/del&gt;&lt;/a&gt;) is set to true (BasicAuthPlugin supports this), and mark MatchStatus.NO_PERMISSION_FOUND, so that the request isn&apos;t rejected right away, but validated properly on a forwarded node.&lt;/p&gt;</comment>
                            <comment id="16877454" author="ichattopadhyaya" created="Wed, 3 Jul 2019 03:33:54 +0000"  >&lt;p&gt;Attached a WIP patch based on this solution. &lt;del&gt;This requires forwardCredentials=true, as follows&lt;/del&gt;:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
{
 &lt;span class=&quot;code-quote&quot;&gt;&quot;authentication&quot;&lt;/span&gt;: {
   &lt;span class=&quot;code-quote&quot;&gt;&quot;blockUnknown&quot;&lt;/span&gt;: &lt;span class=&quot;code-keyword&quot;&gt;true&lt;/span&gt;,
   &lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;solr.BasicAuthPlugin&quot;&lt;/span&gt;,
   &lt;span class=&quot;code-quote&quot;&gt;&quot;forwardCredentials&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;&lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;&quot;&lt;/span&gt;,
   &lt;span class=&quot;code-quote&quot;&gt;&quot;credentials&quot;&lt;/span&gt;: {
     &lt;span class=&quot;code-quote&quot;&gt;&quot;solr&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;IV0EHq1OnNrj6gvRCwvFwTrZ1+z1oBbnQdiVC3otuq0= Ndd7LKvVBAaZIF0QAVi1ekCfAJXr1GGfLtRUXhgrF8c=&quot;&lt;/span&gt;,
     &lt;span class=&quot;code-quote&quot;&gt;&quot;indexer_app&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;IV0EHq1OnNrj6gvRCwvFwTrZ1+z1oBbnQdiVC3otuq0= Ndd7LKvVBAaZIF0QAVi1ekCfAJXr1GGfLtRUXhgrF8c=&quot;&lt;/span&gt;,
     &lt;span class=&quot;code-quote&quot;&gt;&quot;read_user&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;IV0EHq1OnNrj6gvRCwvFwTrZ1+z1oBbnQdiVC3otuq0= Ndd7LKvVBAaZIF0QAVi1ekCfAJXr1GGfLtRUXhgrF8c=&quot;&lt;/span&gt;
   }
 },
 &lt;span class=&quot;code-quote&quot;&gt;&quot;authorization&quot;&lt;/span&gt;: {
   &lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;solr.RuleBasedAuthorizationPlugin&quot;&lt;/span&gt;,
   &lt;span class=&quot;code-quote&quot;&gt;&quot;permissions&quot;&lt;/span&gt;: [
     {
       &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;read&quot;&lt;/span&gt;,
       &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;*&quot;&lt;/span&gt;
     },
     {
       &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;update&quot;&lt;/span&gt;,
       &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;: [
         &lt;span class=&quot;code-quote&quot;&gt;&quot;indexer&quot;&lt;/span&gt;,
         &lt;span class=&quot;code-quote&quot;&gt;&quot;admin&quot;&lt;/span&gt;
       ]
     },
     {
       &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;all&quot;&lt;/span&gt;,
       &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;admin&quot;&lt;/span&gt;
     }
   ],
   &lt;span class=&quot;code-quote&quot;&gt;&quot;user-role&quot;&lt;/span&gt;: {
     &lt;span class=&quot;code-quote&quot;&gt;&quot;solr&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;admin&quot;&lt;/span&gt;,
     &lt;span class=&quot;code-quote&quot;&gt;&quot;indexer_app&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;indexer&quot;&lt;/span&gt;
   }
 }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Edit: This is no longer needed, as per the committed fix.&lt;/p&gt;</comment>
                            <comment id="16879967" author="ichattopadhyaya" created="Sun, 7 Jul 2019 23:38:06 +0000"  >&lt;p&gt;Attaching a patch. As per this, the authorization should only be performed on a node if the request is to be executed on that node. Skips authorization on a node if the request has to be forwarded to another node. Note, forwardCredentials here is not necessary with this approach as PKI will pass on the original user principal as a payload for authorization on the forwarded node.&lt;/p&gt;

&lt;p&gt;Doing this ^ should take care of the BasicAuth case here. However, for Kerberos case, the internode request is performed using Kerberos (not PKI), and hence the&#160;receiving node will not&#160;have the original user principal in order to authorize this request. I&apos;ll try to tackle this in &lt;del&gt;a&#160;separate JIRA&lt;/del&gt; &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13619&quot; title=&quot;Kerberos: 403 when node doesn&amp;#39;t host collection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13619&quot;&gt;&lt;del&gt;SOLR-13619&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16884985" author="jira-bot" created="Mon, 15 Jul 2019 09:21:31 +0000"  >&lt;p&gt;Commit 7e0af71c1e4c04a11524c3f7543f6368e28158fe in lucene-solr&apos;s branch refs/heads/master from Ishan Chattopadhyaya&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7e0af71&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7e0af71&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13472&quot; title=&quot;HTTP requests to a node that does not hold a core of the collection are unauthorized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13472&quot;&gt;&lt;del&gt;SOLR-13472&lt;/del&gt;&lt;/a&gt;: Forwarded requests should skip authorization on receiving nodes&lt;/p&gt;</comment>
                            <comment id="16885014" author="jira-bot" created="Mon, 15 Jul 2019 09:43:30 +0000"  >&lt;p&gt;Commit a7a3fab8c881a4d5ad4ab56cd544052dcb22d073 in lucene-solr&apos;s branch refs/heads/branch_8x from Ishan Chattopadhyaya&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=a7a3fab&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=a7a3fab&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13472&quot; title=&quot;HTTP requests to a node that does not hold a core of the collection are unauthorized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13472&quot;&gt;&lt;del&gt;SOLR-13472&lt;/del&gt;&lt;/a&gt;: Forwarded requests should skip authorization on receiving nodes&lt;/p&gt;</comment>
                            <comment id="16885185" author="jira-bot" created="Mon, 15 Jul 2019 12:39:33 +0000"  >&lt;p&gt;Commit 245606ddd9b843fff9fc2bd9b8572ba812cbe043 in lucene-solr&apos;s branch refs/heads/branch_8_2 from Ishan Chattopadhyaya&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=245606d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=245606d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13472&quot; title=&quot;HTTP requests to a node that does not hold a core of the collection are unauthorized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13472&quot;&gt;&lt;del&gt;SOLR-13472&lt;/del&gt;&lt;/a&gt;: Forwarded requests should skip authorization on receiving nodes&lt;/p&gt;</comment>
                            <comment id="16885193" author="ichattopadhyaya" created="Mon, 15 Jul 2019 12:43:23 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=adfel70&quot; class=&quot;user-hover&quot; rel=&quot;adfel70&quot;&gt;adfel70&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16885194" author="gerlowskija" created="Mon, 15 Jul 2019 12:43:27 +0000"  >&lt;blockquote&gt;&lt;p&gt;Attaching a patch. As per this, the authorization should only be performed on a node if the request is to be executed on that node. Skips authorization on a node if the request has to be forwarded to another node.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I like the simplicity of this approach, but have one doubt/concern.  Is it a security/performance issue to be forwarding requests around internally that we haven&apos;t validated yet?  The more file-handles, request threads, etc. Solr spends on requests that haven&apos;t been auth&apos;d yet, the easier it would be (in theory) for a malicious user to gum up the system.&lt;/p&gt;

&lt;p&gt;That said, &quot;in theory&quot; is a long way from &quot;in practice&quot;.  Maybe the additional resources spent forwarding requests on that would previously have been rejected at the receiving node are negligible and wouldn&apos;t have any sort of real world impact.  Just curious whether you considered or experimented with this at all?&lt;/p&gt;</comment>
                            <comment id="16885232" author="ichattopadhyaya" created="Mon, 15 Jul 2019 13:30:34 +0000"  >&lt;p&gt;You&apos;re right when you mentioned,&lt;/p&gt;
&lt;blockquote&gt;&lt;p&gt;the additional resources spent forwarding requests on that would previously have been rejected at the receiving node are negligible and wouldn&apos;t have any sort of real world impact.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;This was the observed case. This forwarding/deferring seemed necessary due to correctness, and the performance cost seemed inevitable. Alternative suggestion of caching authorization information of every node on every other node seemed like an overhead.&lt;/p&gt;

&lt;p&gt;With &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13619&quot; title=&quot;Kerberos: 403 when node doesn&amp;#39;t host collection&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13619&quot;&gt;&lt;del&gt;SOLR-13619&lt;/del&gt;&lt;/a&gt; and this issue, PKI and Kerberos are both cognizant of the need to authorize the request upon forwarding, so there is no security issue as well.&lt;/p&gt;</comment>
                            <comment id="16893623" author="ivera" created="Fri, 26 Jul 2019 08:56:33 +0000"  >&lt;p&gt;Closing after the 8.2.0 release&lt;/p&gt;</comment>
                            <comment id="16948570" author="gerlowskija" created="Thu, 10 Oct 2019 13:13:33 +0000"  >&lt;p&gt;For those on Solr versions without this fix, there is a (partial) workaround worth trying out.&lt;/p&gt;

&lt;p&gt;As best as I can tell, this issue only affected Rule-Based Auth&apos;s &quot;predefined&quot; permissions - custom permissions still work as expected.  So to workaround this, administrators may replace their predefined permissions with equivalent custom permissions.  For example, the &lt;tt&gt;read&lt;/tt&gt; predefined permission can be replaced with the following custom permissions:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
      {   
        &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;custom-read-all-verbs&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;: [ ... ],
        &lt;span class=&quot;code-quote&quot;&gt;&quot;collection&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;*&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt;: [&lt;span class=&quot;code-quote&quot;&gt;&quot;/analytics&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/graph&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/sql&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/stream&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/export&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/get&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/terms&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/update/extract&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/select&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/query&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/browse&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/spell&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/tvrh&quot;&lt;/span&gt;, &lt;span class=&quot;code-quote&quot;&gt;&quot;/elevate&quot;&lt;/span&gt;]
      },  
      {   
        &lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;custom-read-get-only&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;role&quot;&lt;/span&gt;: [ ... ],
        &lt;span class=&quot;code-quote&quot;&gt;&quot;collection&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;*&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;method&quot;&lt;/span&gt;: &lt;span class=&quot;code-quote&quot;&gt;&quot;GET&quot;&lt;/span&gt;,
        &lt;span class=&quot;code-quote&quot;&gt;&quot;path&quot;&lt;/span&gt;: [&lt;span class=&quot;code-quote&quot;&gt;&quot;/blob&quot;&lt;/span&gt;]
      },
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16949593" author="jira-bot" created="Fri, 11 Oct 2019 16:27:30 +0000"  >&lt;p&gt;Commit b4242a1bfb418e8b1f1cedf4cf9f97e20e4cd866 in lucene-solr&apos;s branch refs/heads/branch_7_7 from Ishan Chattopadhyaya&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=b4242a1&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=b4242a1&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13472&quot; title=&quot;HTTP requests to a node that does not hold a core of the collection are unauthorized&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13472&quot;&gt;&lt;del&gt;SOLR-13472&lt;/del&gt;&lt;/a&gt;: Forwarded requests should skip authorization on receiving nodes&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12973867" name="SOLR-13472.patch" size="4805" author="ichattopadhyaya" created="Sun, 7 Jul 2019 23:32:16 +0000"/>
                            <attachment id="12973502" name="SOLR-13472.patch" size="3869" author="ichattopadhyaya" created="Wed, 3 Jul 2019 03:33:09 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 5 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z02pkg:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>