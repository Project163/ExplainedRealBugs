<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:10:26 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-8276] Atomic updates &amp; RTG don&apos;t work with non-stored docvalues</title>
                <link>https://issues.apache.org/jira/browse/SOLR-8276</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Currently, for atomic updates, the non-stored docvalues fields are neither (a) carried forward to updated document, nor (b) do operations like &quot;inc&quot; work on them. Also, RTG of documents containing such fields doesn&apos;t return those fields if the document is fetched from the index.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12912071">SOLR-8276</key>
            <summary>Atomic updates &amp; RTG don&apos;t work with non-stored docvalues</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="ichattopadhyaya">Ishan Chattopadhyaya</reporter>
                        <labels>
                    </labels>
                <created>Wed, 11 Nov 2015 04:06:31 +0000</created>
                <updated>Wed, 2 Oct 2019 17:24:57 +0000</updated>
                            <resolved>Mon, 28 Dec 2015 21:55:43 +0000</resolved>
                                    <version>4.10.4</version>
                    <version>5.4</version>
                                    <fixVersion>5.5</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="14999922" author="ichattopadhyaya" created="Wed, 11 Nov 2015 04:13:01 +0000"  >&lt;p&gt;Adding a patch that populates the non-stored, non-multivalued docvalues fields during the atomic updates.&lt;/p&gt;

&lt;p&gt;I couldn&apos;t test for multivalued non-stored docvalues fields, since I got the following exception during the field() function query on a multivalued field: &lt;tt&gt;can not use FieldCache on multivalued field: intdvMulti&lt;/tt&gt;. Am I missing something obvious?&lt;/p&gt;

&lt;p&gt;I think doing this for non-multivalued fields itself is an improvement, and that the case of multivalued fields can be dealt with separately.&lt;/p&gt;</comment>
                            <comment id="15003776" author="ichattopadhyaya" created="Fri, 13 Nov 2015 09:40:42 +0000"  >&lt;p&gt;Better patch updated.&lt;/p&gt;</comment>
                            <comment id="15004292" author="yseeley@gmail.com" created="Fri, 13 Nov 2015 17:03:04 +0000"  >&lt;blockquote&gt;&lt;p&gt;I couldn&apos;t test for multivalued non-stored docvalues fields, since I got the following exception during the field() function query on a multivalued field: can not use FieldCache on multivalued field: intdvMulti. Am I missing something obvious?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Since function queries don&apos;t support multi-valued fields, we should go through docValues API instead?&lt;/p&gt;</comment>
                            <comment id="15005302" author="ichattopadhyaya" created="Sat, 14 Nov 2015 10:21:13 +0000"  >&lt;p&gt;I was kind of hoping not to redo all the low level conversions like &lt;tt&gt;Float.intBitsToFloat((int)arr.get(doc))&lt;/tt&gt; (this example from &lt;tt&gt;FloatFieldSource&lt;/tt&gt;) all over again and hence was hoping to use the functions and get away without doing it. However, since multivalued docValues aren&apos;t accessible that way, I have three choices:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Do the single valued fields using the function queries and the multivalued fields using the docValues API (will also require this low level conversions for non long docvalues). Or,&lt;/li&gt;
	&lt;li&gt;Do both singly and multi valued fields using docValues API and do the low level conversions for both. Or,&lt;/li&gt;
	&lt;li&gt;Do single valued fields using function queries, and extend functions queries to support multivalued docvalues and use it.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yseeley%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yseeley@gmail.com&quot;&gt;yseeley@gmail.com&lt;/a&gt; Any preference? Right now, I&apos;m thinking of going with 1 now, and when/if function queries can be made to support multivalued fields later, then switch to 3. Does that sound good? (I am fine going option 2 route as well). Also, are there any performance implications I am overlooking when using value sources as opposed to docvalues API directly?&lt;/p&gt;</comment>
                            <comment id="15005310" author="ichattopadhyaya" created="Sat, 14 Nov 2015 10:26:04 +0000"  >&lt;p&gt;Maybe however way we do it here, we might want to do it the same way for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8220&quot; title=&quot;Read field from docValues for non stored fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8220&quot;&gt;&lt;del&gt;SOLR-8220&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="15005404" author="yseeley@gmail.com" created="Sat, 14 Nov 2015 13:56:21 +0000"  >&lt;p&gt;I think doing it whatever way is easiest for now is fine... it&apos;s implementation, not interface.&lt;/p&gt;</comment>
                            <comment id="15013337" author="ichattopadhyaya" created="Thu, 19 Nov 2015 11:03:11 +0000"  >&lt;p&gt;Moved over code from here to &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8220&quot; title=&quot;Read field from docValues for non stored fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8220&quot;&gt;&lt;del&gt;SOLR-8220&lt;/del&gt;&lt;/a&gt;&apos;s patch. Now this is as simple as calling the right method in the SolrIndexSearcher.&lt;/p&gt;

&lt;p&gt;Updated the patch here, it still contains the test.&lt;/p&gt;</comment>
                            <comment id="15018797" author="ichattopadhyaya" created="Fri, 20 Nov 2015 21:09:02 +0000"  >&lt;p&gt;Adding a test for single valued non-stored docValues field, to ensure it is carried forward during atomic updates.&lt;/p&gt;</comment>
                            <comment id="15072137" author="ichattopadhyaya" created="Sun, 27 Dec 2015 12:24:46 +0000"  >&lt;p&gt;Updating the patch with latest changes introduced in &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8220&quot; title=&quot;Read field from docValues for non stored fields&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8220&quot;&gt;&lt;del&gt;SOLR-8220&lt;/del&gt;&lt;/a&gt;.&lt;br/&gt;
TODO: Add a test for pure RTG for docs with non-stored DV fields.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;, &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=yseeley%40gmail.com&quot; class=&quot;user-hover&quot; rel=&quot;yseeley@gmail.com&quot;&gt;yseeley@gmail.com&lt;/a&gt; Can you please review this? Thanks.&lt;/p&gt;</comment>
                            <comment id="15072718" author="shalinmangar" created="Mon, 28 Dec 2015 13:27:52 +0000"  >&lt;p&gt;+1 LGTM&lt;/p&gt;</comment>
                            <comment id="15073172" author="jira-bot" created="Mon, 28 Dec 2015 21:41:17 +0000"  >&lt;p&gt;Commit 1722009 from shalin@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1722009&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1722009&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8276&quot; title=&quot;Atomic updates &amp;amp; RTG don&amp;#39;t work with non-stored docvalues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8276&quot;&gt;&lt;del&gt;SOLR-8276&lt;/del&gt;&lt;/a&gt;: Atomic updates and realtime-get do not work with non-stored docvalues&lt;/p&gt;</comment>
                            <comment id="15073182" author="jira-bot" created="Mon, 28 Dec 2015 21:54:19 +0000"  >&lt;p&gt;Commit 1722011 from shalin@apache.org in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1722011&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1722011&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8276&quot; title=&quot;Atomic updates &amp;amp; RTG don&amp;#39;t work with non-stored docvalues&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8276&quot;&gt;&lt;del&gt;SOLR-8276&lt;/del&gt;&lt;/a&gt;: Atomic updates and realtime-get do not work with non-stored docvalues&lt;/p&gt;</comment>
                            <comment id="15073185" author="shalinmangar" created="Mon, 28 Dec 2015 21:55:43 +0000"  >&lt;p&gt;Thanks Yonik and Ishan!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10001">
                    <name>dependent</name>
                                            <outwardlinks description="depends upon">
                                        <issuelink>
            <issuekey id="12908420">SOLR-8220</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12779579" name="SOLR-8276.patch" size="5354" author="ichattopadhyaya" created="Sun, 27 Dec 2015 12:24:46 +0000"/>
                            <attachment id="12773595" name="SOLR-8276.patch" size="4662" author="ichattopadhyaya" created="Fri, 20 Nov 2015 21:09:02 +0000"/>
                            <attachment id="12773222" name="SOLR-8276.patch" size="4304" author="ichattopadhyaya" created="Thu, 19 Nov 2015 11:03:11 +0000"/>
                            <attachment id="12772158" name="SOLR-8276.patch" size="6594" author="ichattopadhyaya" created="Fri, 13 Nov 2015 09:40:42 +0000"/>
                            <attachment id="12771692" name="SOLR-8276.patch" size="7182" author="ichattopadhyaya" created="Wed, 11 Nov 2015 04:13:01 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>5.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 47 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2o8br:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>