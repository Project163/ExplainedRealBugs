<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:11:29 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-17221] Http2SolrClient merges case sensitive solr params</title>
                <link>https://issues.apache.org/jira/browse/SOLR-17221</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;In solr9.5.0/solrj9.5.0,&#160; the multi-shard requests are sent through Http2SolrClient, and this function composes the actual Jetty Request object:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;private&lt;/span&gt; Request fillContentStream(
      Request req,
      Collection&amp;lt;ContentStream&amp;gt; streams,
      ModifiableSolrParams wparams,
      &lt;span class=&quot;code-object&quot;&gt;boolean&lt;/span&gt; isMultipart)
      &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (isMultipart) {
      &lt;span class=&quot;code-comment&quot;&gt;// multipart/form-data
&lt;/span&gt;      &lt;span class=&quot;code-keyword&quot;&gt;try&lt;/span&gt; (MultiPartRequestContent content = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; MultiPartRequestContent()) {
        Iterator&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; iter = wparams.getParameterNamesIterator();
        &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (iter.hasNext()) {
          &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; key = iter.next();
          &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] vals = wparams.getParams(key);
          &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (vals != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; val : vals) {
              content.addFieldPart(key, &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; StringRequestContent(val), &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
            }
          }
        }
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (streams != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
          &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (ContentStream contentStream : streams) {
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; contentType = contentStream.getContentType();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (contentType == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
              contentType = &lt;span class=&quot;code-quote&quot;&gt;&quot;multipart/form-data&quot;&lt;/span&gt;; &lt;span class=&quot;code-comment&quot;&gt;// &lt;span class=&quot;code-keyword&quot;&gt;default&lt;/span&gt;
&lt;/span&gt;            }
            &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name = contentStream.getName();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (name == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
              name = &quot;&quot;;
            }
            HttpFields.Mutable fields = HttpFields.build(1);
            fields.add(HttpHeader.CONTENT_TYPE, contentType);
            content.addFilePart(
                name,
                contentStream.getName(),
                &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; InputStreamRequestContent(contentStream.getStream()),
                fields);
          }
        }
        req.body(content);
      }
    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
      &lt;span class=&quot;code-comment&quot;&gt;// application/x-www-form-urlencoded
&lt;/span&gt;      Fields fields = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Fields();
      Iterator&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;&amp;gt; iter = wparams.getParameterNamesIterator();
      &lt;span class=&quot;code-keyword&quot;&gt;while&lt;/span&gt; (iter.hasNext()) {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; key = iter.next();
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;[] vals = wparams.getParams(key);
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (vals != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
          &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; val : vals) {
            fields.add(key, val);
          }
        }
      }
      req.body(&lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; FormRequestContent(fields, FALLBACK_CHARSET));
    }

    &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; req;
  } &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The problem is the use of this class &lt;b&gt;Fields fields = new Fields();&lt;/b&gt; &#160;where caseSensitive=false by default, this leads to case sensitive solr params being merged together. For example f.case_sensitive_field.facet.limit=5 &amp;amp; f.CASE_SENSITIVE_FIELD.facet.limit=99&lt;/p&gt;

&lt;p&gt;Not sure if this is intentional for some reason?&lt;/p&gt;</description>
                <environment></environment>
        <key id="13574164">SOLR-17221</key>
            <summary>Http2SolrClient merges case sensitive solr params</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="yy147379138">Yue Yu</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Mon, 1 Apr 2024 15:41:59 +0000</created>
                <updated>Tue, 11 Mar 2025 23:42:56 +0000</updated>
                            <resolved>Thu, 16 Jan 2025 23:17:47 +0000</resolved>
                                    <version>9.5</version>
                                    <fixVersion>9.9</fixVersion>
                    <fixVersion>9.8.1</fixVersion>
                                    <component>SolrJ</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>3</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="4800">1h 20m</timespent>
                                <comments>
                            <comment id="17834127" author="dsmiley" created="Fri, 5 Apr 2024 02:47:49 +0000"  >&lt;p&gt;Yeah that&apos;s a bug!  PR welcome.&lt;/p&gt;</comment>
                            <comment id="17912281" author="JIRAUSER304732" created="Sun, 12 Jan 2025 15:14:06 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt; sure thing! here is the PR: &lt;a href=&quot;https://github.com/apache/solr/pull/3028&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/solr/pull/3028&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;I added some more unit tests to check the case sensitive solr param case&lt;/p&gt;</comment>
                            <comment id="17913585" author="jira-bot" created="Thu, 16 Jan 2025 06:55:27 +0000"  >&lt;p&gt;Commit 82083ea13ad2b2114d4311439be2f90ed868fac1 in solr&apos;s branch refs/heads/main from Yue Yu&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=82083ea13ad&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=82083ea13ad&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17221&quot; title=&quot;Http2SolrClient merges case sensitive solr params&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17221&quot;&gt;&lt;del&gt;SOLR-17221&lt;/del&gt;&lt;/a&gt;: Fix Http2SolrClient merging case sensitive solr params (#3028)&lt;/p&gt;

&lt;p&gt;If multiple query param keys are sent that only vary by case, they were wrongly merged when doing distributed search (sharded collections). This could likely occur for fielded parameters such as f.CASE_SENSITIVE_FIELD.facet.limit=50&lt;/p&gt;

&lt;p&gt;Also: compose the request content directly using SolrParams.toQueryString(). This will avoid to use Jetty Fields as an intermediary mapping&lt;/p&gt;


&lt;p&gt;---------&lt;/p&gt;

&lt;p&gt;Co-authored-by: David Smiley &amp;lt;dsmiley@apache.org&amp;gt;&lt;/p&gt;</comment>
                            <comment id="17913877" author="dsmiley" created="Thu, 16 Jan 2025 23:17:47 +0000"  >&lt;p&gt;I pushed this to branch_9x today but not seeing the bot comment on this.&lt;/p&gt;

&lt;p&gt;Thanks for contributing Yue!&lt;/p&gt;</comment>
                            <comment id="17913939" author="JIRAUSER304732" created="Fri, 17 Jan 2025 03:35:00 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&#160; Glad I can help. Thank you for the suggestions too!&lt;/p&gt;</comment>
                            <comment id="17928257" author="jira-bot" created="Wed, 19 Feb 2025 03:58:40 +0000"  >&lt;p&gt;Commit 11075f7259b00da0614eb3236a33f712303395c7 in solr&apos;s branch refs/heads/branch_9_8 from Yue Yu&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=11075f7259b&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=11075f7259b&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17221&quot; title=&quot;Http2SolrClient merges case sensitive solr params&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17221&quot;&gt;&lt;del&gt;SOLR-17221&lt;/del&gt;&lt;/a&gt;: Fix Http2SolrClient merging case sensitive solr params (#3028)&lt;/p&gt;

&lt;p&gt;If multiple query param keys are sent that only vary by case, they were wrongly merged when doing distributed search (sharded collections). This could likely occur for fielded parameters such as f.CASE_SENSITIVE_FIELD.facet.limit=50&lt;/p&gt;

&lt;p&gt;Also: compose the request content directly using SolrParams.toQueryString(). This will avoid to use Jetty Fields as an intermediary mapping&lt;/p&gt;

&lt;p&gt;---------&lt;/p&gt;

&lt;p&gt;Co-authored-by: David Smiley &amp;lt;dsmiley@apache.org&amp;gt;&lt;br/&gt;
(cherry picked from commit 82083ea13ad2b2114d4311439be2f90ed868fac1)&lt;/p&gt;</comment>
                            <comment id="17934377" author="houston" created="Tue, 11 Mar 2025 23:42:56 +0000"  >&lt;p&gt;Closing after the 9.8.1 release&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            35 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1oczc:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>