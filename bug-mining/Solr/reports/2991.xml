<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:14:08 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-9199] ZkController#publishAndWaitForDownStates logic is inefficient</title>
                <link>https://issues.apache.org/jira/browse/SOLR-9199</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The following logic introduced as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-8720&quot; title=&quot;ZkController#publishAndWaitForDownStates should use #publishNodeAsDown.&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-8720&quot;&gt;&lt;del&gt;SOLR-8720&lt;/del&gt;&lt;/a&gt; is inefficient. &lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://github.com/apache/lucene-solr/blob/6c0331b8309603eaaf14b6677afba5ffe99f16a3/solr/core/src/java/org/apache/solr/cloud/ZkController.java#L687-L712&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/6c0331b8309603eaaf14b6677afba5ffe99f16a3/solr/core/src/java/org/apache/solr/cloud/ZkController.java#L687-L712&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;Specifically,&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;foundStates flag is set to TRUE before the for loop.&lt;/li&gt;
	&lt;li&gt;In the for loop we check if any replica on this node is not in the DOWN state. If yes, then foundStates = FALSE&lt;/li&gt;
	&lt;li&gt;If foundStates == TRUE then we break out of the loop and return.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;The problem here is that once foundStates is set to FALSE, it is never reset to TRUE. Hence we end up spending the whole 60 secs iterating over the collections even though all the replicas are marked as DOWN in later iterations.&lt;/p&gt;</description>
                <environment></environment>
        <key id="12977023">SOLR-9199</key>
            <summary>ZkController#publishAndWaitForDownStates logic is inefficient</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="hgadre">Hrishikesh Gadre</assignee>
                                    <reporter username="hgadre">Hrishikesh Gadre</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Jun 2016 21:38:38 +0000</created>
                <updated>Fri, 26 Aug 2016 13:58:46 +0000</updated>
                            <resolved>Thu, 9 Jun 2016 20:27:18 +0000</resolved>
                                                    <fixVersion>6.2</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="15321584" author="hgadre" created="Wed, 8 Jun 2016 22:36:40 +0000"  >&lt;p&gt;Please find the attached patch.&lt;/p&gt;</comment>
                            <comment id="15321654" author="dragonsinth" created="Wed, 8 Jun 2016 23:29:49 +0000"  >&lt;p&gt;LGTM&lt;/p&gt;</comment>
                            <comment id="15321714" author="gchanan" created="Thu, 9 Jun 2016 00:39:33 +0000"  >&lt;p&gt;lgtm.  Could maybe quibble that the old code wouldn&apos;t print &quot;timing out&quot; if it never entered the loop (e.g. if wait time was 0), but that doesn&apos;t seem right or wrong.&lt;/p&gt;

&lt;p&gt;I&apos;ll commit to trunk and 6.x assuming the precommit and tests pass.&lt;/p&gt;</comment>
                            <comment id="15322083" author="gchanan" created="Thu, 9 Jun 2016 07:36:00 +0000"  >&lt;p&gt;Precommit succeeded for me, will commit in the morning.&lt;/p&gt;</comment>
                            <comment id="15323270" author="jira-bot" created="Thu, 9 Jun 2016 20:25:19 +0000"  >&lt;p&gt;Commit d55cc8f293aec4ccc882b1a92ed450c9ec3877dc in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gchanan&quot; class=&quot;user-hover&quot; rel=&quot;gchanan&quot;&gt;gchanan&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d55cc8f&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=d55cc8f&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9199&quot; title=&quot;ZkController#publishAndWaitForDownStates logic is inefficient&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9199&quot;&gt;&lt;del&gt;SOLR-9199&lt;/del&gt;&lt;/a&gt;: ZkController#publishAndWaitForDownStates logic is inefficient&lt;/p&gt;</comment>
                            <comment id="15323274" author="jira-bot" created="Thu, 9 Jun 2016 20:26:43 +0000"  >&lt;p&gt;Commit 360d9c40da4cc1f86f080b4f2c7410da6fbc2195 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=gchanan&quot; class=&quot;user-hover&quot; rel=&quot;gchanan&quot;&gt;gchanan&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=360d9c4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=360d9c4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-9199&quot; title=&quot;ZkController#publishAndWaitForDownStates logic is inefficient&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-9199&quot;&gt;&lt;del&gt;SOLR-9199&lt;/del&gt;&lt;/a&gt;: ZkController#publishAndWaitForDownStates logic is inefficient&lt;/p&gt;</comment>
                            <comment id="15438955" author="mikemccand" created="Fri, 26 Aug 2016 13:58:46 +0000"  >&lt;p&gt;Bulk close resolved issues after 6.2.0 release.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12809057" name="SOLR-9199.patch" size="1421" author="hgadre" created="Wed, 8 Jun 2016 22:36:40 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            9 years, 12 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2z6rr:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>