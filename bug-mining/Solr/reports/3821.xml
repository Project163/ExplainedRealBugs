<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:31:17 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-11976] TokenizerChain is overwriting, not chaining TokenFilters in normalize()</title>
                <link>https://issues.apache.org/jira/browse/SOLR-11976</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;TokenizerChain is overwriting, not chaining tokenfilters in &lt;tt&gt;normalize&lt;/tt&gt;.  &lt;/p&gt;

&lt;p&gt;This doesn&apos;t currently break search because &lt;tt&gt;normalize&lt;/tt&gt; is not being used at the Solr level (AFAICT); rather, TextField has its own &lt;tt&gt;analyzeMultiTerm()&lt;/tt&gt; that duplicates code from the newer &lt;tt&gt;normalize&lt;/tt&gt;. &lt;/p&gt;

&lt;p&gt;Code as is:&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;    TokenStream result = in;
    for (TokenFilterFactory filter : filters) {
      if (filter instanceof MultiTermAwareComponent) {
        filter = (TokenFilterFactory) ((MultiTermAwareComponent) filter).getMultiTermComponent();
        result = filter.create(in);
      }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The fix is simple:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;-        result = filter.create(in);
+        result = filter.create(result);
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13137964">SOLR-11976</key>
            <summary>TokenizerChain is overwriting, not chaining TokenFilters in normalize()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dsmiley">David Smiley</assignee>
                                    <reporter username="tallison">Tim Allison</reporter>
                        <labels>
                    </labels>
                <created>Mon, 12 Feb 2018 21:08:57 +0000</created>
                <updated>Sat, 8 Jun 2019 15:14:21 +0000</updated>
                            <resolved>Fri, 9 Mar 2018 03:35:21 +0000</resolved>
                                    <version>8.0</version>
                                    <fixVersion>7.3</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>1</votes>
                                    <watches>6</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1800">0.5h</timespent>
                                <comments>
                            <comment id="16361452" author="tallison@mitre.org" created="Mon, 12 Feb 2018 21:15:24 +0000"  >&lt;p&gt;I&apos;m happy to open a separate issue/PR to factor out &lt;tt&gt;TextField&lt;/tt&gt;&apos;s &lt;tt&gt;analyzeMultiTerm&lt;/tt&gt; in favor of &lt;tt&gt;Analyzer#normalize()&lt;/tt&gt;.&lt;/p&gt;</comment>
                            <comment id="16364010" author="tallison@mitre.org" created="Wed, 14 Feb 2018 13:24:02 +0000"  >&lt;p&gt;Better yet, swap out Solr&apos;s &lt;tt&gt;TokenizerChain&lt;/tt&gt; for Lucene&apos;s &lt;tt&gt;CustomAnalyzer&lt;/tt&gt; and deprecate &lt;tt&gt;TokenizerChain&lt;/tt&gt; in 7.x?&lt;/p&gt;

&lt;p&gt;Happy to submit PR if a committer is willing to work with me on this.&lt;/p&gt;</comment>
                            <comment id="16372022" author="tallison@mitre.org" created="Wed, 21 Feb 2018 21:18:31 +0000"  >&lt;p&gt;Ping...any committer interested in this or a larger PR to swap out &lt;tt&gt;TokenizerChain&lt;/tt&gt; for &lt;tt&gt;CustomAnalyzer&lt;/tt&gt;?&lt;/p&gt;</comment>
                            <comment id="16372388" author="dsmiley" created="Thu, 22 Feb 2018 04:18:11 +0000"  >&lt;p&gt;I am interested but waiting to get back from vacation tomorrow &lt;/p&gt;</comment>
                            <comment id="16373899" author="dsmiley" created="Fri, 23 Feb 2018 04:13:34 +0000"  >&lt;p&gt;+1 for replacing TokenizerChain with CustomAnalyzer. &#160;At a glance it seems the right choice.&lt;/p&gt;</comment>
                            <comment id="16374303" author="tallison@mitre.org" created="Fri, 23 Feb 2018 12:52:12 +0000"  >&lt;p&gt;Thank you.  I&apos;ll update the PR.  Should we also get rid of the special handling of multiterm analysis in TextField?  Or, separate issue?&lt;/p&gt;</comment>
                            <comment id="16374832" author="dsmiley" created="Fri, 23 Feb 2018 18:50:20 +0000"  >&lt;p&gt;+1 to also getting rid of special handling of multiterm analysis same issue.  Note that org.apache.solr.schema.TextField#analyzeMultiTerm is invoked from some query parsers explicitly.&lt;/p&gt;</comment>
                            <comment id="16374943" author="dsmiley" created="Fri, 23 Feb 2018 20:42:42 +0000"  >&lt;p&gt;On second thought, lets keep this issue to fixing the bug (which you did and appears simple), and create a new issue to the more extensive refactoring.  Those refactorings would remove access to TokenizerChain which I&apos;ve referenced before in custom Solr plugins.&lt;/p&gt;</comment>
                            <comment id="16376975" author="tallison@mitre.org" created="Mon, 26 Feb 2018 14:45:32 +0000"  >&lt;p&gt;Y, I started on it...uncovered at least one other bug...it is a pretty big undertaking.  Opened &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12034&quot; title=&quot;Replace TokenizerChain in Solr with Lucene&amp;#39;s CustomAnalyzer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12034&quot;&gt;&lt;del&gt;SOLR-12034&lt;/del&gt;&lt;/a&gt;.&lt;/p&gt;</comment>
                            <comment id="16390164" author="dsmiley" created="Wed, 7 Mar 2018 20:28:33 +0000"  >&lt;p&gt;I&apos;m not completely clear on the current status; there are some other issues (unlinked that perhaps ought to be) and I don&apos;t know if they block this.  Is the PR valid &amp;amp; ready for 7.3?&lt;/p&gt;</comment>
                            <comment id="16390212" author="tallison@mitre.org" created="Wed, 7 Mar 2018 20:55:26 +0000"  >&lt;p&gt;This issue will be moot after &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12034&quot; title=&quot;Replace TokenizerChain in Solr with Lucene&amp;#39;s CustomAnalyzer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12034&quot;&gt;&lt;del&gt;SOLR-12034&lt;/del&gt;&lt;/a&gt; is in place.  The other issues (linked from &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12034&quot; title=&quot;Replace TokenizerChain in Solr with Lucene&amp;#39;s CustomAnalyzer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12034&quot;&gt;&lt;del&gt;SOLR-12034&lt;/del&gt;&lt;/a&gt;) are relevant but not blockers on this nor blocked by this.&lt;/p&gt;

&lt;p&gt;So, until &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12034&quot; title=&quot;Replace TokenizerChain in Solr with Lucene&amp;#39;s CustomAnalyzer&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12034&quot;&gt;&lt;del&gt;SOLR-12034&lt;/del&gt;&lt;/a&gt; is in place, this is valid and should be ready for 7.3 (although the PR is against master, of course).&lt;/p&gt;</comment>
                            <comment id="16390290" author="dsmiley" created="Wed, 7 Mar 2018 21:43:37 +0000"  >&lt;p&gt;Can you please simplify the test to be more of a unit test &amp;#8211; create the TokenizerChain manually.  No changes to the test schema.xml.&lt;/p&gt;</comment>
                            <comment id="16391705" author="tallison@mitre.org" created="Thu, 8 Mar 2018 18:37:18 +0000"  >&lt;p&gt;Done.&#160;&lt;/p&gt;</comment>
                            <comment id="16392342" author="jira-bot" created="Fri, 9 Mar 2018 03:30:47 +0000"  >&lt;p&gt;Commit 588e19eda17f8145c820c3ba0caf951d44467883 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=588e19e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=588e19e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11976&quot; title=&quot;TokenizerChain is overwriting, not chaining TokenFilters in normalize()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11976&quot;&gt;&lt;del&gt;SOLR-11976&lt;/del&gt;&lt;/a&gt;: TokenizerChain.normalize was only considering the first MultiTermAwareComponent&lt;/p&gt;</comment>
                            <comment id="16392345" author="jira-bot" created="Fri, 9 Mar 2018 03:32:43 +0000"  >&lt;p&gt;Commit de53746880edf0271ea967bf8b561cf5bc5a7194 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=dsmiley&quot; class=&quot;user-hover&quot; rel=&quot;dsmiley&quot;&gt;dsmiley&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=de53746&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=de53746&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11976&quot; title=&quot;TokenizerChain is overwriting, not chaining TokenFilters in normalize()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11976&quot;&gt;&lt;del&gt;SOLR-11976&lt;/del&gt;&lt;/a&gt;: TokenizerChain.normalize was only considering the first MultiTermAwareComponent&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 588e19e)&lt;/p&gt;</comment>
                            <comment id="16392348" author="dsmiley" created="Fri, 9 Mar 2018 03:35:21 +0000"  >&lt;p&gt;I omitted the change to BasicFunctionalityTest.java which isn&apos;t applicable anymore now that you didn&apos;t change the schema to have that &quot;lowerascii&quot; field.&lt;/p&gt;

&lt;p&gt;Thanks for the contribution Tim &amp;#8211; even if it is dead code, someone might call it.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13140929">SOLR-12034</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            7 years, 36 weeks, 5 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3q37j:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>