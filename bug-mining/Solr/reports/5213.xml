<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 05:10:49 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-17322] Once again allow rank queries to use custom TopDocsCollectors that operate on types that extend ScoreDocs (covariant generic types)</title>
                <link>https://issues.apache.org/jira/browse/SOLR-17322</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Make RankQuery.getTopDocsCollector use covariant generic types&lt;/p&gt;

&lt;p&gt;Currently, rank queries can only use TopDocsCollectors that operate on ScoreDocs.&lt;/p&gt;

&lt;p&gt;TopDocsCollector has a class signature of:&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;TopDocsCollector&amp;lt;T &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; ScoreDoc&amp;gt; &lt;span class=&quot;code-keyword&quot;&gt;implements&lt;/span&gt; Collector &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;It contains a single covariant generic type T, which allows the collection of not only ScoreDocs, but subclasses of ScoreDocs as well (in the event additional information needs to be collected per document during the collection process).&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-15385&quot; title=&quot;Address rawtypes warnings&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-15385&quot;&gt;&lt;del&gt;SOLR-15385&lt;/del&gt;&lt;/a&gt; involved a large commit that removed raw types from much of the Solr code base. As part of that work, RankQuery was modified so that the getTopDocsCollector method no longer returns a raw TopDocsCollector but instead returns a TopDocsCollector of invariant ScoreDocs. Unfortunately, by doing so, it is no longer possible to use custom TopDocsCollectors that operate on types that extend ScoreDoc in rank queries; they &lt;em&gt;only&lt;/em&gt; work with ScoreDocs. Any attempt to use a class other than ScoreDoc will result in a compilation error.&lt;/p&gt;

&lt;p&gt;The fix for this issue is very simple: Modify the method signature from:&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&#160;&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; TopDocsCollector&amp;lt;ScoreDoc&amp;gt; getTopDocsCollector(
&#160; &#160; &#160; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; len, QueryCommand cmd, IndexSearcher searcher) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException; &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;to&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
&lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;abstract&lt;/span&gt; TopDocsCollector&amp;lt;? &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; ScoreDoc&amp;gt; getTopDocsCollector(
  &#160; &#160; &lt;span class=&quot;code-object&quot;&gt;int&lt;/span&gt; len, QueryCommand cmd, IndexSearcher searcher) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException;  &lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt;The call site for this method, within SolrIndexSearcher.buildTopDocsCollector, already uses this type signature.&lt;/p&gt;</description>
                <environment></environment>
        <key id="13581860">SOLR-17322</key>
            <summary>Once again allow rank queries to use custom TopDocsCollectors that operate on types that extend ScoreDocs (covariant generic types)</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="5" iconUrl="https://issues.apache.org/jira/images/icons/priorities/trivial.svg">Trivial</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="cpoerschke">Christine Poerschke</assignee>
                                    <reporter username="stephen-woods">Stephen Woods</reporter>
                        <labels>
                            <label>pull-request-available</label>
                    </labels>
                <created>Fri, 7 Jun 2024 02:46:34 +0000</created>
                <updated>Fri, 25 Oct 2024 17:18:50 +0000</updated>
                            <resolved>Mon, 29 Jul 2024 10:18:14 +0000</resolved>
                                    <version>9.0</version>
                    <version>9.1</version>
                    <version>9.2</version>
                    <version>9.1.1</version>
                    <version>9.3</version>
                    <version>9.2.1</version>
                    <version>9.4</version>
                    <version>9.5</version>
                    <version>9.4.1</version>
                    <version>9.6</version>
                    <version>9.6.1</version>
                                    <fixVersion>9.7</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="11400">3h 10m</timespent>
                                <comments>
                            <comment id="17853188" author="epugh" created="Fri, 7 Jun 2024 15:11:17 +0000"  >&lt;p&gt;I am hoping someone besides me with stronger opinions can review this PR.&#160; It looks &quot;fine&quot; to me, but I probably dont&apos; understand this area very well...&lt;/p&gt;</comment>
                            <comment id="17853189" author="JIRAUSER305740" created="Fri, 7 Jun 2024 15:21:15 +0000"  >&lt;p&gt;If you have any questions, I&apos;m happy to discuss...&lt;/p&gt;</comment>
                            <comment id="17853195" author="cpoerschke" created="Fri, 7 Jun 2024 15:49:53 +0000"  >&lt;p&gt;My naively running &lt;tt&gt;git grep -n TopDocsCollector.ScoreDoc&lt;/tt&gt; finds potentially similar code elsewhere too, wondering if it might be beneficial to fix those too, or maybe it&apos;s not an issue there, haven&apos;t looked.&lt;/p&gt;</comment>
                            <comment id="17853228" author="JIRAUSER305740" created="Fri, 7 Jun 2024 17:27:06 +0000"  >&lt;p&gt;Good call &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=cpoerschke&quot; class=&quot;user-hover&quot; rel=&quot;cpoerschke&quot;&gt;cpoerschke&lt;/a&gt; .&#160;I updated the PR to include fixes for other previously concrete RankQuery types. Note that collectors that extend TopDocsCollector&amp;lt;ScoreDoc&amp;gt; are ok, so I didn&apos;t touch those.&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</comment>
                            <comment id="17853249" author="JIRAUSER305740" created="Fri, 7 Jun 2024 18:23:23 +0000"  >&lt;p&gt;I saw there was a failed randomized facet test on crave.io, though I&apos;m not sure how my changes could have introduced that... I rebased the PR from main in an effort to pick up the latest changes on main (and now the failed test report disappeared.... sigh) . Feel free to kick off another run...&lt;/p&gt;

&lt;p&gt;Looks like a second run was successful&lt;/p&gt;</comment>
                            <comment id="17869300" author="jira-bot" created="Mon, 29 Jul 2024 10:09:51 +0000"  >&lt;p&gt;Commit 57287c8520e51c10531cb7e5d6c46e7a43b27a3c in solr&apos;s branch refs/heads/main from Steve Woods&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=57287c8520e&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=57287c8520e&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17322&quot; title=&quot;Once again allow rank queries to use custom TopDocsCollectors that operate on types that extend ScoreDocs (covariant generic types)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17322&quot;&gt;&lt;del&gt;SOLR-17322&lt;/del&gt;&lt;/a&gt;: Make RankQuery.getTopDocsCollector use covariant generic types (#2506)&lt;/p&gt;
</comment>
                            <comment id="17869302" author="jira-bot" created="Mon, 29 Jul 2024 10:14:22 +0000"  >&lt;p&gt;Commit 3e394080c77f205a16a28723ba5bac7199850f6f in solr&apos;s branch refs/heads/branch_9x from Steve Woods&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=3e394080c77&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=3e394080c77&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-17322&quot; title=&quot;Once again allow rank queries to use custom TopDocsCollectors that operate on types that extend ScoreDocs (covariant generic types)&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-17322&quot;&gt;&lt;del&gt;SOLR-17322&lt;/del&gt;&lt;/a&gt;: Make RankQuery.getTopDocsCollector use covariant generic types (#2506)&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 57287c8520e51c10531cb7e5d6c46e7a43b27a3c)&lt;/p&gt;</comment>
                            <comment id="17869306" author="cpoerschke" created="Mon, 29 Jul 2024 10:18:14 +0000"  >&lt;p&gt;Thanks everyone!&lt;/p&gt;</comment>
                            <comment id="17892897" author="anshumg" created="Fri, 25 Oct 2024 17:18:50 +0000"  >&lt;p&gt;Closing after the 9.7.0 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13375890">SOLR-15385</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            1 year, 2 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z1pny0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>