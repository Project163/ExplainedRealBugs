<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:41:01 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-13855] DistributedZkUpdateProcessor isn&apos;t propagating finish()</title>
                <link>https://issues.apache.org/jira/browse/SOLR-13855</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;In &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-12955&quot; title=&quot;Refactor DistributedUpdateProcessor&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-12955&quot;&gt;&lt;del&gt;SOLR-12955&lt;/del&gt;&lt;/a&gt;, DistributedUpdateProcessorFactory was split up into a subclass, DistributedZkUpdateProcessor.  This refactoring has a bug in which finish() is not propagated to the remaining URPs in the chain when DistributedZkUpdateProcessor is in play.  This is noticeable when LogUpdateProcessorFactory is later down the line.&lt;br/&gt;
CC &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=barrotsteindev&quot; class=&quot;user-hover&quot; rel=&quot;barrotsteindev&quot;&gt;barrotsteindev&lt;/a&gt;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13263659">SOLR-13855</key>
            <summary>DistributedZkUpdateProcessor isn&apos;t propagating finish()</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="dsmiley">David Smiley</assignee>
                                    <reporter username="dsmiley">David Smiley</reporter>
                        <labels>
                    </labels>
                <created>Mon, 21 Oct 2019 21:37:49 +0000</created>
                <updated>Tue, 21 Jan 2020 16:59:12 +0000</updated>
                            <resolved>Wed, 23 Oct 2019 22:07:55 +0000</resolved>
                                    <version>8.1</version>
                                    <fixVersion>8.3</fixVersion>
                                    <component>UpdateRequestProcessors</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="1200">20m</timespent>
                                <comments>
                            <comment id="16956598" author="brot" created="Tue, 22 Oct 2019 01:51:15 +0000"  >&lt;p&gt;Oh that sounds like a nasty bug.&lt;/p&gt;

&lt;p&gt;I&#8217;ll investigate further tomorrow,&lt;/p&gt;

&lt;p&gt;and hopefully have a patch ready with a test to ensure this bug will not be repeated.&lt;/p&gt;</comment>
                            <comment id="16957534" author="dsmiley" created="Wed, 23 Oct 2019 04:14:51 +0000"  >&lt;p&gt;In about 9 hours from now (when I start my next work day) if I don&apos;t see your linked PR (or patch) then I will take over fixing it immediately because it appears this is holding up Solr 8.3.  I&apos;ll probably manually check that it works by running Solr, for expediency.  If you later do a test then I&apos;ll add it whenever you provide it.&lt;/p&gt;

&lt;p&gt;BTW note RunUpdateProcessor.finish() calls &lt;tt&gt;org.apache.solr.update.UpdateLog#finish&lt;/tt&gt; and it&apos;s plausible that not doing so may mean the updateLog isn&apos;t doing its job of providing Solr fault-tolerance guarantees. &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/sad.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16958272" author="jira-bot" created="Wed, 23 Oct 2019 21:50:21 +0000"  >&lt;p&gt;Commit 3ae820424809baa4e5a85d8bbdb0294cf6fe5b9b in lucene-solr&apos;s branch refs/heads/master from David Smiley&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=3ae8204&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=3ae8204&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13855&quot; title=&quot;DistributedZkUpdateProcessor isn&amp;#39;t propagating finish()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13855&quot;&gt;&lt;del&gt;SOLR-13855&lt;/del&gt;&lt;/a&gt;: DistributedZkUpdateProcessor needs to propagate URP.finish()&lt;br/&gt;
Important since Run URP finish() propagates to updateLog to fsync()!&lt;br/&gt;
Closes #969&lt;/p&gt;</comment>
                            <comment id="16958274" author="jira-bot" created="Wed, 23 Oct 2019 21:51:42 +0000"  >&lt;p&gt;Commit 9a108996bb804fa180caecab171baafa9a5b5263 in lucene-solr&apos;s branch refs/heads/branch_8x from David Smiley&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=9a10899&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=9a10899&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13855&quot; title=&quot;DistributedZkUpdateProcessor isn&amp;#39;t propagating finish()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13855&quot;&gt;&lt;del&gt;SOLR-13855&lt;/del&gt;&lt;/a&gt;: DistributedZkUpdateProcessor needs to propagate URP.finish()&lt;br/&gt;
Important since Run URP finish() propagates to updateLog to fsync()!&lt;br/&gt;
Closes #969&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 3ae820424809baa4e5a85d8bbdb0294cf6fe5b9b)&lt;/p&gt;</comment>
                            <comment id="16958275" author="jira-bot" created="Wed, 23 Oct 2019 21:52:31 +0000"  >&lt;p&gt;Commit 79dc14078b6ccfd4844f8b7fa86e6a9023b1b68f in lucene-solr&apos;s branch refs/heads/branch_8_3 from David Smiley&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=79dc140&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=79dc140&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13855&quot; title=&quot;DistributedZkUpdateProcessor isn&amp;#39;t propagating finish()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13855&quot;&gt;&lt;del&gt;SOLR-13855&lt;/del&gt;&lt;/a&gt;: DistributedZkUpdateProcessor needs to propagate URP.finish()&lt;br/&gt;
Important since Run URP finish() propagates to updateLog to fsync()!&lt;br/&gt;
Closes #969&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 3ae820424809baa4e5a85d8bbdb0294cf6fe5b9b)&lt;/p&gt;</comment>
                            <comment id="16958291" author="dsmiley" created="Wed, 23 Oct 2019 22:07:55 +0000"  >&lt;p&gt;I feel pretty good about what I committed. &#160;Unlike pre-Solr-8.1, I simply made it always propagate finish(). &#160;It&apos;s not dependent on &quot;nodes&quot; field being null. &#160;I think this is safer and easier to reason about. &#160;I suspect nodes could be non-null and yet documents pass on through due to locally routed docs... yet we would have failed to propagate finish() then. &#160;Run URP&apos;s finish does nothing if no add/delete went through, so I think it&apos;s totally fine to always propagate.&lt;/p&gt;

&lt;p&gt;RE testing: &#160;It&apos;d indeed be nice to test everything gets propagated in the URP chain but IMO it&apos;s even more important that we have a high level test that checks Solr&apos;s integrity. &#160;Basically, test the updateLog (or &lt;em&gt;whatever mechanism&lt;/em&gt;)&#160;is there to save ourselves from failure so that the client can be assured it doesn&apos;t need to re-send documents that were accepted by Solr. &#160;I&apos;d hope we have such a test but we have so many tests that I&apos;m not sure &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/smile.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&#160; Also I suspect such a high level test would require a &quot;kill -9&quot;. &#160;It&apos;d take some effort to create such a test; I doubt we have one actually.&lt;/p&gt;</comment>
                            <comment id="16962198" author="jira-bot" created="Tue, 29 Oct 2019 16:35:44 +0000"  >&lt;p&gt;Commit 79dc14078b6ccfd4844f8b7fa86e6a9023b1b68f in lucene-solr&apos;s branch refs/heads/jira/&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13101&quot; title=&quot;Shared storage via a new SHARED replica type&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13101&quot;&gt;&lt;del&gt;SOLR-13101&lt;/del&gt;&lt;/a&gt; from David Smiley&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=79dc140&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=79dc140&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13855&quot; title=&quot;DistributedZkUpdateProcessor isn&amp;#39;t propagating finish()&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13855&quot;&gt;&lt;del&gt;SOLR-13855&lt;/del&gt;&lt;/a&gt;: DistributedZkUpdateProcessor needs to propagate URP.finish()&lt;br/&gt;
Important since Run URP finish() propagates to updateLog to fsync()!&lt;br/&gt;
Closes #969&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 3ae820424809baa4e5a85d8bbdb0294cf6fe5b9b)&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13196069">SOLR-12955</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 3 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z07tbs:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>