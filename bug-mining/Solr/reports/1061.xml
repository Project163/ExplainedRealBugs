<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:30:35 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3879] war file has javax.servlet-api jar bundled</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3879</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;This is incorrect and can lead to deployment issues:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Servlet Spec 2.5

SRV.9.7.2 Web Application Class Loader
The class loader that a container uses to load a servlet in a WAR must
allow the developer to load any resources contained in library JARs
within the WAR following normal J2SE semantics using getResource. As
described in the J2EE license agreement, servlet containers that are
not part of a J2EE product should not allow the application to
override J2SE platform classes, such as those in the java.* and
javax.* namespaces, that J2SE does not allow to be modified. Also,
servlet containers that are part of a J2EE product should not allow
the application to override J2SE or J2EE platform classes, such as
those in java.* and javax.* namespaces, that either J2SE or J2EE do
not allow to be modified. The container should not allow applications
to override or access the container&#8217;s implementation
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The fix is pretty easy and it would be nice to include it in the upcoming release of Solr 4.0&lt;/p&gt;</description>
                <environment></environment>
        <key id="12608908">SOLR-3879</key>
            <summary>war file has javax.servlet-api jar bundled</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="2" iconUrl="https://issues.apache.org/jira/images/icons/priorities/critical.svg">Critical</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="mikemccand">Michael McCandless</assignee>
                                    <reporter username="rvs">Roman Shaposhnik</reporter>
                        <labels>
                    </labels>
                <created>Mon, 24 Sep 2012 17:50:26 +0000</created>
                <updated>Wed, 23 Feb 2022 02:09:09 +0000</updated>
                            <resolved>Tue, 25 Sep 2012 21:10:03 +0000</resolved>
                                    <version>4.0</version>
                                    <fixVersion>4.0</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>Build</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                                                                                <comments>
                            <comment id="13462013" author="rcmuir" created="Mon, 24 Sep 2012 19:05:37 +0000"  >&lt;p&gt;I don&apos;t see a servlet-api.jar in the 3.6.0 war, but i do see it in 4.0.0 war.&lt;/p&gt;

&lt;p&gt;I don&apos;t know anything about servlets, and would prefer if someone who knew looked at this, I &lt;br/&gt;
just want to add my comment to please not commit any fix without a test (peek inside the war&lt;br/&gt;
in smokeTestRelease.py and ensure no servlet-api jars or java.&lt;b&gt;/javax.&lt;/b&gt; classes inside jars in the war)&lt;/p&gt;
</comment>
                            <comment id="13462021" author="thetaphi" created="Mon, 24 Sep 2012 19:13:37 +0000"  >&lt;p&gt;It is definitely a bug to include that jar file. I said it so many times, servlet-api.jar is only a compile time dependecy and may not be in the war.&lt;br/&gt;
We should fix the packaging tasks, the binary release may also only contain servlet.jar in the example folder next to jetty.&lt;/p&gt;</comment>
                            <comment id="13462022" author="yseeley@gmail.com" created="Mon, 24 Sep 2012 19:15:23 +0000"  >&lt;blockquote&gt;&lt;p&gt;I don&apos;t see a servlet-api.jar in the 3.6.0 war, but i do see it in 4.0.0 war.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Sounds like a mistake that it&apos;s in 4.0&lt;br/&gt;
AFAIK, it&apos;s only for compiling against... the actual servlet container should supply the API/implementation (but I&apos;m not a servlet expert either).&lt;/p&gt;</comment>
                            <comment id="13462117" author="rvs" created="Mon, 24 Sep 2012 20:57:35 +0000"  >&lt;p&gt;Attached is the patch against trunk. When applied to the RC tarball it takes care of the issue. Robert, can you please elaborate on how smokeTestRelease.py relates to build/release? I&apos;m pretty new to SOLR &amp;#8211; still learning.&lt;/p&gt;</comment>
                            <comment id="13462132" author="rcmuir" created="Mon, 24 Sep 2012 21:05:37 +0000"  >&lt;p&gt;Roman your patch looks good. &lt;/p&gt;

&lt;p&gt;smokeTestRelease.py (in the dev-tools/scripts directory) is a way to verify release artifacts.&lt;/p&gt;

&lt;p&gt;Its like a test for the release packaging itself, so it takes as input a URL containing a release candidate (such as &lt;a href=&quot;http://s.apache.org/lusolr40rc0&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://s.apache.org/lusolr40rc0&lt;/a&gt;),&lt;br/&gt;
and runs a bunch of tests on the files there and fails if something is wrong.&lt;/p&gt;

&lt;p&gt;It can also be run against the current code checkout by running &apos;ant nightly-smoke&apos; from the top-level.&lt;/p&gt;

&lt;p&gt;The key here is, if we don&apos;t test that the war doesn&apos;t contain stuff it shouldn&apos;t, then the bug could come back for a future release.&lt;/p&gt;</comment>
                            <comment id="13462149" author="rvs" created="Mon, 24 Sep 2012 21:17:30 +0000"  >&lt;p&gt;Thanks! I&apos;ll update the patch shortly to include a test for this.&lt;/p&gt;</comment>
                            <comment id="13462161" author="markrmiller@gmail.com" created="Mon, 24 Sep 2012 21:29:57 +0000"  >&lt;blockquote&gt;&lt;p&gt;peek inside the war in smokeTestRelease.py and ensure no servlet-api jars or java./javax. classes inside jars in the war&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Yeah, I think this would be a general useful addition - a list of regex or specific names for forbidden jars and class names.&lt;/p&gt;</comment>
                            <comment id="13462177" author="thetaphi" created="Mon, 24 Sep 2012 21:56:00 +0000"  >&lt;p&gt;+1 to fix this issue!&lt;/p&gt;</comment>
                            <comment id="13463146" author="mikemccand" created="Tue, 25 Sep 2012 19:39:53 +0000"  >&lt;p&gt;I&apos;ll fix smokeTestRelease to check for this ...&lt;/p&gt;</comment>
                            <comment id="13463151" author="mikemccand" created="Tue, 25 Sep 2012 19:51:40 +0000"  >&lt;p&gt;Patch (against 4.0.x branch) for smokeTestRelease.py.  It fails on the 4.0.0 RC with this:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;Traceback (most recent call last):
  File &quot;dev-tools/scripts/smokeTestRelease.py&quot;, line 1161, in &amp;lt;module&amp;gt;
  File &quot;dev-tools/scripts/smokeTestRelease.py&quot;, line 1109, in main
  File &quot;dev-tools/scripts/smokeTestRelease.py&quot;, line 1151, in smokeTest
  File &quot;dev-tools/scripts/smokeTestRelease.py&quot;, line 446, in unpack
  File &quot;dev-tools/scripts/smokeTestRelease.py&quot;, line 558, in verifyUnpacked
  File &quot;dev-tools/scripts/smokeTestRelease.py&quot;, line 177, in checkSolrWAR
RuntimeError: WAR file /l/40x/tmp/unpack/apache-solr-4.0.0/example/webapps/solr.war contains JAR file WEB-INF/lib/javax.servlet-api-3.0.1.jar with illegal class &quot;javax/servlet/ServletSecurityElement.class&quot;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13463155" author="markrmiller@gmail.com" created="Tue, 25 Sep 2012 19:56:18 +0000"  >&lt;p&gt;Very nice.&lt;/p&gt;</comment>
                            <comment id="13463161" author="thetaphi" created="Tue, 25 Sep 2012 20:01:43 +0000"  >&lt;p&gt;We should maybe also do the same check on all Lucene-generated jar files?&lt;/p&gt;</comment>
                            <comment id="13463163" author="mikemccand" created="Tue, 25 Sep 2012 20:04:47 +0000"  >&lt;p&gt;Uwe, good idea: I&apos;ll do that.&lt;/p&gt;</comment>
                            <comment id="13463183" author="mikemccand" created="Tue, 25 Sep 2012 20:27:16 +0000"  >&lt;p&gt;Patch, also checking all *.jar in Lucene&apos;s binary releases.&lt;/p&gt;

&lt;p&gt;I had to exclude lucene/demo/lib since it ships servlet-api-2.4.jar.  (Should we remove that demo webapp?).&lt;/p&gt;</comment>
                            <comment id="13463188" author="rcmuir" created="Tue, 25 Sep 2012 20:36:14 +0000"  >&lt;p&gt;+1 to commit mike&apos;s latest patch (the test) and Roman&apos;s patch (the fix). this should be done in 4.0 branch as well.&lt;/p&gt;</comment>
                            <comment id="13463199" author="thetaphi" created="Tue, 25 Sep 2012 20:46:58 +0000"  >&lt;p&gt;Looks good! My intention was to only check all Lucene product artifacts (not dependencies and compile time depends), but its a good idea to also find invalid artifacts from other projects. In Solr, of course the example folder must be excluded, too as it contains jetty, too.&lt;/p&gt;</comment>
                            <comment id="13463202" author="thetaphi" created="Tue, 25 Sep 2012 20:50:46 +0000"  >&lt;p&gt;Oh, we should not add the servlet API lib to the binary release. It is a compile time dependent and is provided by the webapp container where you depoly the demo.&lt;/p&gt;

&lt;p&gt;We should not ship binary with compile time dependencies.&lt;/p&gt;</comment>
                            <comment id="13463205" author="rcmuir" created="Tue, 25 Sep 2012 20:52:46 +0000"  >&lt;p&gt;I thought about this too, it seems useless to me to ship this.&lt;/p&gt;</comment>
                            <comment id="13463217" author="thetaphi" created="Tue, 25 Sep 2012 21:00:13 +0000"  >&lt;p&gt;It is not only useless, its as stupid as shipping with rt.jar... It is as wrong as shipping inside war.&lt;/p&gt;</comment>
                            <comment id="13463226" author="mikemccand" created="Tue, 25 Sep 2012 21:10:03 +0000"  >&lt;p&gt;Thanks Roman!&lt;/p&gt;</comment>
                            <comment id="13463235" author="thetaphi" created="Tue, 25 Sep 2012 21:23:43 +0000"  >&lt;p&gt;Mike: should we open another issue in LUCENE? Lucene Demo has the same packaging problem like this solr one. It&apos;s unrelated to the discussion, if the demo webapp should be removed.&lt;/p&gt;</comment>
                            <comment id="13463237" author="rcmuir" created="Tue, 25 Sep 2012 21:25:15 +0000"  >&lt;p&gt;just open another issue to not put this jar file in the binary release. lets fix that for 4.0&lt;/p&gt;</comment>
                            <comment id="13610760" author="commit-tag-bot" created="Fri, 22 Mar 2013 16:33:12 +0000"  >&lt;p&gt;&lt;span class=&quot;error&quot;&gt;&amp;#91;branch_4x commit&amp;#93;&lt;/span&gt; Michael McCandless&lt;br/&gt;
&lt;a href=&quot;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1390137&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://svn.apache.org/viewvc?view=revision&amp;amp;revision=1390137&lt;/a&gt;&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-3879&quot; title=&quot;war file has javax.servlet-api jar bundled&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-3879&quot;&gt;&lt;del&gt;SOLR-3879&lt;/del&gt;&lt;/a&gt;: don&apos;t ship servlet-api*.jar&lt;/p&gt;</comment>
                            <comment id="13654007" author="thetaphi" created="Fri, 10 May 2013 10:33:43 +0000"  >&lt;p&gt;Closed after release.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="13430061">SOLR-16048</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12546575" name="SOLR-3879.patch" size="2421" author="mikemccand" created="Tue, 25 Sep 2012 20:27:16 +0000"/>
                            <attachment id="12546570" name="SOLR-3879.patch" size="1835" author="mikemccand" created="Tue, 25 Sep 2012 19:51:40 +0000"/>
                            <attachment id="12546378" name="SOLR-3879.patch.txt" size="628" author="rvs" created="Mon, 24 Sep 2012 20:57:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>243117</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            12 years, 28 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03c3r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>17394</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>