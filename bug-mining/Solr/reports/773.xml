<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:25:20 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-3035] XML and JSON response writers don&apos;t handle short or binary field types</title>
                <link>https://issues.apache.org/jira/browse/SOLR-3035</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;The XML and JSON response writers return data from short schema fields as &quot;java.lang.Short:&amp;lt;value&amp;gt;&quot;.&lt;/p&gt;

&lt;p&gt;In addition, binary fields (for sharded requests) are returned as &quot;[B:[B@&amp;lt;hex address of array&amp;gt;&quot;, which makes them totally unusable.&lt;/p&gt;

&lt;p&gt;This appears to be due to their writeVal() methods not having cases to handle val instanceof Short and val instance of byte[]&lt;/p&gt;</description>
                <environment></environment>
        <key id="12538369">SOLR-3035</key>
            <summary>XML and JSON response writers don&apos;t handle short or binary field types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="-1">Unassigned</assignee>
                                    <reporter username="kkrugler">Kenneth William Krugler</reporter>
                        <labels>
                    </labels>
                <created>Fri, 13 Jan 2012 22:43:13 +0000</created>
                <updated>Fri, 10 May 2013 10:40:53 +0000</updated>
                            <resolved>Fri, 27 Jan 2012 21:37:16 +0000</resolved>
                                    <version>3.1</version>
                    <version>3.5</version>
                    <version>4.0-ALPHA</version>
                                    <fixVersion>4.0-ALPHA</fixVersion>
                                    <component>Response Writers</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>1</watches>
                                                                                                                <comments>
                            <comment id="13185940" author="kkrugler" created="Fri, 13 Jan 2012 22:44:41 +0000"  >&lt;p&gt;I created a class that extended JSONWriter, and implemented writeVal() as follows, which fixed the above problems for JSON:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;&lt;span class=&quot;code-keyword&quot;&gt;class &lt;/span&gt;FixedJSONWriter &lt;span class=&quot;code-keyword&quot;&gt;extends&lt;/span&gt; JSONWriter {
    
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; AdbeatJSONWriter(Writer writer, SolrQueryRequest req, SolrQueryResponse rsp) {
        &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;(writer, req, rsp);
    }
    
    @Override
    &lt;span class=&quot;code-keyword&quot;&gt;public&lt;/span&gt; void writeVal(&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; name, &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; val) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
        &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (val == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.writeVal(name, val);
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (val &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;Short&lt;/span&gt;) {
            &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.writeShort(name, (&lt;span class=&quot;code-object&quot;&gt;Short&lt;/span&gt;)val);
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (val &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[]) {
            &lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[] bytes = (&lt;span class=&quot;code-object&quot;&gt;byte&lt;/span&gt;[])val;
            &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.writeStr(name, Base64.byteArrayToBase64(bytes, 0, bytes.length), &lt;span class=&quot;code-keyword&quot;&gt;false&lt;/span&gt;);
        } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
            &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;.writeVal(name, val);
        }
    }
}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="13185942" author="kkrugler" created="Fri, 13 Jan 2012 22:46:27 +0000"  >&lt;p&gt;Attached is some test code, and the resource data I used to construct a sharded configuration for testing binary responses.&lt;/p&gt;</comment>
                            <comment id="13185972" author="yseeley@gmail.com" created="Fri, 13 Jan 2012 23:14:59 +0000"  >&lt;blockquote&gt;&lt;p&gt;a sharded configuration for testing binary responses.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Ahh... sharded - that probably explains the diff code path.&lt;/p&gt;</comment>
                            <comment id="13186003" author="yseeley@gmail.com" created="Sat, 14 Jan 2012 00:03:20 +0000"  >&lt;p&gt;Here&apos;s a completely untested patch for trunk...&lt;br/&gt;
I grouped all of the numerics under a test for instanceof Number to lower the average number of instanceof tests.&lt;/p&gt;

&lt;p&gt;At some point we should look into accelerating that with a lookup based on class (and a fallback to instanceof tests), but there hasn&apos;t been any indication that the  instanceof tests add a meaningful amount of time yet.&lt;/p&gt;</comment>
                            <comment id="13186354" author="kkrugler" created="Sat, 14 Jan 2012 22:07:21 +0000"  >&lt;p&gt;I see the change to TextResponseWriter, and JavaBinCodec, but does that then also fix the problem for XML?&lt;/p&gt;</comment>
                            <comment id="13186357" author="yseeley@gmail.com" created="Sat, 14 Jan 2012 22:34:44 +0000"  >&lt;p&gt;In trunk at least it should (XML now inherits from TextResponseWriter)&lt;/p&gt;</comment>
                            <comment id="13195111" author="yseeley@gmail.com" created="Fri, 27 Jan 2012 21:37:25 +0000"  >&lt;p&gt;Since I accidentally committed part of this patch, I went ahead and came up with a quick test and committed the rest (for trunk).&lt;/p&gt;</comment>
                            <comment id="13447765" author="michaelryan" created="Tue, 4 Sep 2012 15:49:52 +0000"  >&lt;p&gt;Shouldn&apos;t this be using writeShort and writeByte for short and byte, instead of writeInt?&lt;/p&gt;

&lt;p&gt;Looking at 3.6 code... in ByteField, it calls XMLWriter.writeByte(String, String), which writes it out in a &amp;lt;byte&amp;gt; tag. However, there are also two methods - writeByte(String, byte) and writeShort(String, short) - which are using writeInt(), which seems like another bug. On trunk, all of this code is gone, so I guess it is using writeInt for all of them?&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12510538" name="ResponseWriterTest.java" size="6649" author="kkrugler" created="Fri, 13 Jan 2012 22:46:27 +0000"/>
                            <attachment id="12510548" name="SOLR-3035.patch" size="5787" author="yseeley@gmail.com" created="Sat, 14 Jan 2012 00:03:20 +0000"/>
                            <attachment id="12510537" name="distributed-search.zip" size="45058" author="kkrugler" created="Fri, 13 Jan 2012 22:46:27 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>223875</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            13 years, 12 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i03h33:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>18201</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>