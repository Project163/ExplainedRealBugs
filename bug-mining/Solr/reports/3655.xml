<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:28:47 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-11406] Solr 7.0 cannot read indexes from 6.x versions</title>
                <link>https://issues.apache.org/jira/browse/SOLR-11406</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Reproduced a user problem from the mailing list.&lt;/p&gt;

&lt;p&gt;Steps:&lt;/p&gt;
&lt;ul&gt;
	&lt;li&gt;Start Solr 6.6.0 from an extracted download with &quot;bin/solr start&quot;&lt;/li&gt;
	&lt;li&gt;Create a core: &quot;bin/solr create -c foo&quot;&lt;/li&gt;
	&lt;li&gt;Add documents with the admin UI&lt;/li&gt;
	&lt;li&gt;Stop Solr&lt;/li&gt;
	&lt;li&gt;Copy solr-6.6.0/server/solr/foo to solr-7.0.0/server/solr in extracted Solr 7.0 download&lt;/li&gt;
	&lt;li&gt;Start Solr 7.0 with &quot;bin/solr start&quot;&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;(I was on Windows, so I used backslashes everywhere these steps have forward slashes)&lt;/p&gt;

&lt;p&gt;Solr will be unable to start the core.  Error and stacktrace:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;2017-09-27 15:13:30.050 ERROR (coreContainerWorkExecutor-2-thread-1) [   ] o.a.s.c.CoreContainer Error waiting &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; SolrCore to be created
java.util.concurrent.ExecutionException: org.apache.solr.common.SolrException: Unable to create core [foo]
    at java.util.concurrent.FutureTask.report(FutureTask.java:122)
    at java.util.concurrent.FutureTask.get(FutureTask.java:192)
    at org.apache.solr.core.CoreContainer.lambda$load$118(CoreContainer.java:647)
    at com.codahale.metrics.InstrumentedExecutorService$InstrumentedRunnable.run(InstrumentedExecutorService.java:176)
    at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
    at java.util.concurrent.FutureTask.run(FutureTask.java:266)
    at org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$128(ExecutorUtil.java:188)
    at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1149)
    at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:624)
    at java.lang.&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.run(&lt;span class=&quot;code-object&quot;&gt;Thread&lt;/span&gt;.java:748)
Caused by: org.apache.solr.common.SolrException: Unable to create core [foo]
    at org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:996)
    at org.apache.solr.core.CoreContainer.lambda$load$117(CoreContainer.java:619)
    at com.codahale.metrics.InstrumentedExecutorService$InstrumentedCallable.call(InstrumentedExecutorService.java:197)
    ... 5 more
Caused by: org.apache.solr.common.SolrException: Error opening &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; searcher
    at org.apache.solr.core.SolrCore.&amp;lt;init&amp;gt;(SolrCore.java:988)
    at org.apache.solr.core.SolrCore.&amp;lt;init&amp;gt;(SolrCore.java:843)
    at org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:980)
    ... 7 more
Caused by: org.apache.solr.common.SolrException: Error opening &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; searcher
    at org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:2066)
    at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:2186)
    at org.apache.solr.core.SolrCore.initSearcher(SolrCore.java:1071)
    at org.apache.solr.core.SolrCore.&amp;lt;init&amp;gt;(SolrCore.java:960)
    ... 9 more
Caused by: java.lang.NullPointerException
    at java.util.Objects.requireNonNull(Objects.java:203)
    at java.util.Optional.&amp;lt;init&amp;gt;(Optional.java:96)
    at java.util.Optional.of(Optional.java:108)
    at java.util.stream.ReduceOps$2ReducingSink.get(ReduceOps.java:129)
    at java.util.stream.ReduceOps$2ReducingSink.get(ReduceOps.java:107)
    at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
    at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
    at java.util.stream.ReferencePipeline.reduce(ReferencePipeline.java:479)
    at org.apache.solr.index.SlowCompositeReaderWrapper.&amp;lt;init&amp;gt;(SlowCompositeReaderWrapper.java:76)
    at org.apache.solr.index.SlowCompositeReaderWrapper.wrap(SlowCompositeReaderWrapper.java:57)
    at org.apache.solr.search.SolrIndexSearcher.&amp;lt;init&amp;gt;(SolrIndexSearcher.java:252)
    at org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:2034)
    ... 12 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment>&lt;p&gt;C:\Users\sheisey\Downloads\solr-7.0.0&amp;gt;ver&lt;/p&gt;

&lt;p&gt;Microsoft Windows &lt;span class=&quot;error&quot;&gt;&amp;#91;Version 6.1.7601&amp;#93;&lt;/span&gt;&lt;br/&gt;
C:\Users\sheisey\Downloads\solr-7.0.0&amp;gt;java -version&lt;br/&gt;
java version &quot;1.8.0_144&quot;&lt;br/&gt;
Java(TM) SE Runtime Environment (build 1.8.0_144-b01)&lt;br/&gt;
Java HotSpot(TM) 64-Bit Server VM (build 25.144-b01, mixed mode)&lt;/p&gt;</environment>
        <key id="13105492">SOLR-11406</key>
            <summary>Solr 7.0 cannot read indexes from 6.x versions</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sarowe">Steven Rowe</assignee>
                                    <reporter username="elyograg">Shawn Heisey</reporter>
                        <labels>
                    </labels>
                <created>Wed, 27 Sep 2017 16:02:31 +0000</created>
                <updated>Tue, 23 Jul 2019 15:57:30 +0000</updated>
                            <resolved>Fri, 29 Sep 2017 20:45:59 +0000</resolved>
                                    <version>7.0</version>
                                    <fixVersion>7.0.1</fixVersion>
                    <fixVersion>7.1</fixVersion>
                    <fixVersion>8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>8</watches>
                                                                                                                <comments>
                            <comment id="16182796" author="elyograg" created="Wed, 27 Sep 2017 16:06:43 +0000"  >&lt;p&gt;If I delete the foo/data directory, then Solr will start with no problem, so the actual Lucene index does appear to be involved.&lt;/p&gt;

&lt;p&gt;The user on the mailing list was trying with an index from 6.6.1, I tried 6.6.0 because that&apos;s what I already had downloaded.&lt;/p&gt;

&lt;p&gt;A quick glance at SlowCompositeReaderWrapper line 76 (the innermost &quot;caused by&quot; section references that line) leaves me with more questions and no answers.  The low-level internals are not something I understand.&lt;/p&gt;</comment>
                            <comment id="16182846" author="steve_rowe" created="Wed, 27 Sep 2017 16:28:38 +0000"  >&lt;p&gt;I too was able to reproduce using 6.6.1/7.0:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;wget http://archive.apache.org/dist/lucene/solr/6.6.1/solr-6.6.1.tgz
tar xvfz solr-6.6.1.tgz 
wget http://mirror.metrocast.net/apache/lucene/solr/7.0.0/solr-7.0.0.tgz
tar xvfz solr-7.0.0.tgz 
cd solr-6.6.1
bin/solr start -e techproducts
bin/solr stop -all
cp -r example/techproducts/ ../solr-7.0.0/example/
cd ../solr-7.0.0
bin/solr start -s example/techproducts/solr
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Although &lt;tt&gt;bin/solr start&lt;/tt&gt; under 7.0 appeared to succeed (&lt;tt&gt;Started Solr server on port 8983 (pid=16090). Happy searching!&lt;/tt&gt;), the log (and the admin UI) show differently (this is a separate problem from the upgrade issue).  My log has the same entries as in the description:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR - 2017-09-27 16:14:00.907; [   ] org.apache.solr.core.CoreContainer; Error waiting for SolrCore to be created
java.util.concurrent.ExecutionException: org.apache.solr.common.SolrException: Unable to create core [techproducts]
        at java.util.concurrent.FutureTask.report(FutureTask.java:122)
        at java.util.concurrent.FutureTask.get(FutureTask.java:192)
        at org.apache.solr.core.CoreContainer.lambda$load$118(CoreContainer.java:647)
        at com.codahale.metrics.InstrumentedExecutorService$InstrumentedRunnable.run(InstrumentedExecutorService.java:176)
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)
        at java.util.concurrent.FutureTask.run(FutureTask.java:266)
        at org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$128(ExecutorUtil.java:188)
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)
        at java.lang.Thread.run(Thread.java:745)
Caused by: org.apache.solr.common.SolrException: Unable to create core [techproducts]
        at org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:996)
        at org.apache.solr.core.CoreContainer.lambda$load$117(CoreContainer.java:619)
        at com.codahale.metrics.InstrumentedExecutorService$InstrumentedCallable.call(InstrumentedExecutorService.java:197)
        ... 5 more
Caused by: org.apache.solr.common.SolrException: Error opening new searcher
        at org.apache.solr.core.SolrCore.&amp;lt;init&amp;gt;(SolrCore.java:988)
        at org.apache.solr.core.SolrCore.&amp;lt;init&amp;gt;(SolrCore.java:843)
        at org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:980)
        ... 7 more
Caused by: org.apache.solr.common.SolrException: Error opening new searcher
        at org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:2066)
        at org.apache.solr.core.SolrCore.getSearcher(SolrCore.java:2186)
        at org.apache.solr.core.SolrCore.initSearcher(SolrCore.java:1071)
        at org.apache.solr.core.SolrCore.&amp;lt;init&amp;gt;(SolrCore.java:960)
        ... 9 more
Caused by: java.lang.NullPointerException
        at java.util.Objects.requireNonNull(Objects.java:203)
        at java.util.Optional.&amp;lt;init&amp;gt;(Optional.java:96)
        at java.util.Optional.of(Optional.java:108)
        at java.util.stream.ReduceOps$2ReducingSink.get(ReduceOps.java:129)
        at java.util.stream.ReduceOps$2ReducingSink.get(ReduceOps.java:107)
        at java.util.stream.ReduceOps$ReduceOp.evaluateSequential(ReduceOps.java:708)
        at java.util.stream.AbstractPipeline.evaluate(AbstractPipeline.java:234)
        at java.util.stream.ReferencePipeline.reduce(ReferencePipeline.java:479)
        at org.apache.solr.index.SlowCompositeReaderWrapper.&amp;lt;init&amp;gt;(SlowCompositeReaderWrapper.java:76)
        at org.apache.solr.index.SlowCompositeReaderWrapper.wrap(SlowCompositeReaderWrapper.java:57)
        at org.apache.solr.search.SolrIndexSearcher.&amp;lt;init&amp;gt;(SolrIndexSearcher.java:252)
        at org.apache.solr.core.SolrCore.openNewSearcher(SolrCore.java:2034)
        ... 12 more
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16182880" author="steve_rowe" created="Wed, 27 Sep 2017 16:51:24 +0000"  >&lt;p&gt;From &lt;tt&gt;SlowCompositeReaderWrapper&lt;/tt&gt;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;64:  SlowCompositeReaderWrapper(CompositeReader reader) &lt;span class=&quot;code-keyword&quot;&gt;throws&lt;/span&gt; IOException {
65:    &lt;span class=&quot;code-keyword&quot;&gt;super&lt;/span&gt;();
66:    in = reader;
67:    fields = MultiFields.getFields(in);
68:    in.registerParentReader(&lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;);
69:    &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (reader.leaves().isEmpty()) {
70:      metaData = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LeafMetaData(Version.LATEST.major, Version.LATEST, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
71:    } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; {
72:      Version minVersion = reader.leaves().stream()
73:          .map(LeafReaderContext::reader)
74:          .map(LeafReader::getMetaData)
75:          .map(LeafMetaData::getMinVersion)
76:          .reduce((v1, v2) -&amp;gt; v1 == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; : v2 == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; ? &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; : v2.onOrAfter(v1) ? v1 : v2)
77:          .get();
78:      metaData = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; LeafMetaData(reader.leaves().get(0).reader().getMetaData().getCreatedVersionMajor(), minVersion, &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;);
79:    }
80:  }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This version-comparison code was added in 7.0 as part of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-7756&quot; title=&quot;Only record the major that was used to create the index rather than the full version&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-7756&quot;&gt;&lt;del&gt;LUCENE-7756&lt;/del&gt;&lt;/a&gt;.  The minVersion will be null for a pre-7.0 index.  I&apos;ll see if I can repro with Lucene.  (Shouldn&apos;t back-compat tests have caught this if it&apos;s a Lucene bug though?)&lt;/p&gt;</comment>
                            <comment id="16183100" author="elyograg" created="Wed, 27 Sep 2017 19:02:16 +0000"  >&lt;p&gt;Sounds like it would be a good idea for Solr to include at least one back-compat test.&lt;/p&gt;

&lt;p&gt;Based on all available info, I think it would fail this way with an index from any 6.x version.&lt;/p&gt;

&lt;p&gt;With an index from 4.x, loading fails.  That&apos;s expected.  The message correctly refers to the index format.&lt;/p&gt;

&lt;p&gt;With an index from 6.3.0, the failure is the same as with 6.6.x.&lt;/p&gt;</comment>
                            <comment id="16183424" author="steve_rowe" created="Wed, 27 Sep 2017 23:21:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;ll see if I can repro with Lucene. (Shouldn&apos;t back-compat tests have caught this if it&apos;s a Lucene bug though?)&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;&lt;tt&gt;SlowCompositeReaderWrapper&lt;/tt&gt; is Solr-specific (as of &lt;a href=&quot;https://issues.apache.org/jira/browse/LUCENE-7283&quot; title=&quot;Move SlowCompositeReaderWrapper and uninverting package to solr sources&quot; class=&quot;issue-link&quot; data-issue-key=&quot;LUCENE-7283&quot;&gt;&lt;del&gt;LUCENE-7283&lt;/del&gt;&lt;/a&gt;), so this won&apos;t be reproducible in Lucene. &lt;/p&gt;

&lt;p&gt;The reason for the NPE is that &lt;tt&gt;Stream.reduce()&lt;/tt&gt; isn&apos;t allowed to produce nulls, which the version checking code given in a previous comment does.  From the javadocs:&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;&lt;tt&gt;@throws NullPointerException if the result of the reduction is null&lt;/tt&gt;&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;I&apos;ll try switching to a simple loop; I expect it won&apos;t have the same problem.  Here&apos;s an example from &lt;tt&gt;ParallelLeafReader&lt;/tt&gt;:&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    Version minVersion = Version.LATEST;
    &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; LeafReader reader : &lt;span class=&quot;code-keyword&quot;&gt;this&lt;/span&gt;.parallelReaders) {
      Version leafVersion = reader.getMetaData().getMinVersion();
      &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (leafVersion == &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;) {
        minVersion = &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt;;
        &lt;span class=&quot;code-keyword&quot;&gt;break&lt;/span&gt;;
      } &lt;span class=&quot;code-keyword&quot;&gt;else&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (minVersion.onOrAfter(leafVersion)) {
        minVersion = leafVersion;
      }
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16183449" author="steve_rowe" created="Wed, 27 Sep 2017 23:41:29 +0000"  >&lt;blockquote&gt;&lt;p&gt;I&apos;ll try switching to a simple loop; I expect it won&apos;t have the same problem.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Patch, fixes the issue for me.&lt;/p&gt;

&lt;p&gt;I&apos;m going to look at creating back-compat tests.&lt;/p&gt;</comment>
                            <comment id="16184187" author="steve_rowe" created="Thu, 28 Sep 2017 13:39:19 +0000"  >&lt;p&gt;All Solr tests pass with the attached patch.&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=jpountz&quot; class=&quot;user-hover&quot; rel=&quot;jpountz&quot;&gt;jpountz&lt;/a&gt; I&apos;d appreciate a review.&lt;/p&gt;</comment>
                            <comment id="16184229" author="jpountz" created="Thu, 28 Sep 2017 14:13:07 +0000"  >&lt;p&gt;The patch that was submitted yesterday looks good to me, thanks for fixing! I didn&apos;t know reduce could not deal with null results and wrongly assumed at least one test would exercise this logic. Just in case, did you forget to attach a patch with your last comment or did you want me to review yesterday&apos;s patch?&lt;/p&gt;

&lt;p&gt;As a side note, we should look into removing this slow wrapper from Solr too as a follow-up.&lt;/p&gt;</comment>
                            <comment id="16184255" author="steve_rowe" created="Thu, 28 Sep 2017 14:33:38 +0000"  >&lt;blockquote&gt;&lt;p&gt;The patch that was submitted yesterday looks good to me, thanks for fixing!&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;Thanks Adrien.&lt;/p&gt;

&lt;blockquote&gt;&lt;p&gt;Just in case, did you forget to attach a patch with your last comment or did you want me to review yesterday&apos;s patch?&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;No, I was asking for a review of yesterday&apos;s patch.&lt;/p&gt;</comment>
                            <comment id="16184333" author="elyograg" created="Thu, 28 Sep 2017 15:41:39 +0000"  >&lt;p&gt;A possible workaround I&apos;m thinking of is to run IndexUpgrader on the index before trying to use it with 7.0.  Would that avoid this problem?&lt;/p&gt;</comment>
                            <comment id="16184360" author="elyograg" created="Thu, 28 Sep 2017 15:53:47 +0000"  >&lt;p&gt;I tried to copy an index from 6.6.0 and then run the 7.0 IndexUpgrader on it.  It did rewrite the index, but I still got the exception from this issue at startup.  I wonder if I did something wrong.&lt;/p&gt;</comment>
                            <comment id="16184839" author="elyograg" created="Thu, 28 Sep 2017 20:45:26 +0000"  >&lt;p&gt;This was the command I used (shown with the prompt so you can see the directory I was in):&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;C:\Users\sheisey\Downloads\solr-7.0.0\server\solr&amp;gt;java -cp ..\solr-webapp\webapp\WEB-INF\lib\lucene-core-7.0.0.jar;..\solr-webapp\webapp\WEB-INF\lib\lucene-backward-codecs-7.0.0.jar org.apache.lucene.index.IndexUpgrader foo\data\index
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</comment>
                            <comment id="16186234" author="steve_rowe" created="Fri, 29 Sep 2017 18:52:21 +0000"  >&lt;p&gt;Patch for branch_7_0, includes previous fix-only patch, and adds a CHANGES entry and basic read/write testing of the (currently 6.x) indexes in Lucene&apos;s backward-codecs module.  The new test fails without the fix and succeeds with it.&lt;/p&gt;

&lt;p&gt;Committing shortly.&lt;/p&gt;</comment>
                            <comment id="16186388" author="jira-bot" created="Fri, 29 Sep 2017 20:42:23 +0000"  >&lt;p&gt;Commit 2916fba3b24adce7eaf0f55a36b8287e6afc6e40 in lucene-solr&apos;s branch refs/heads/branch_7_0 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2916fba&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2916fba&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11406&quot; title=&quot;Solr 7.0 cannot read indexes from 6.x versions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11406&quot;&gt;&lt;del&gt;SOLR-11406&lt;/del&gt;&lt;/a&gt;: Solr 7.0 cannot read indexes from 6.x versions&lt;/p&gt;</comment>
                            <comment id="16186389" author="jira-bot" created="Fri, 29 Sep 2017 20:42:25 +0000"  >&lt;p&gt;Commit 47ea4283d9311c1e8619dcedd262f285954120ac in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=47ea428&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=47ea428&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11406&quot; title=&quot;Solr 7.0 cannot read indexes from 6.x versions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11406&quot;&gt;&lt;del&gt;SOLR-11406&lt;/del&gt;&lt;/a&gt;: Solr 7.0 cannot read indexes from 6.x versions&lt;/p&gt;</comment>
                            <comment id="16186390" author="jira-bot" created="Fri, 29 Sep 2017 20:42:26 +0000"  >&lt;p&gt;Commit 39ba1c3da56c5ac3e9476830efe1f4c396ccf7c0 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=39ba1c3&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=39ba1c3&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11406&quot; title=&quot;Solr 7.0 cannot read indexes from 6.x versions&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11406&quot;&gt;&lt;del&gt;SOLR-11406&lt;/del&gt;&lt;/a&gt;: Solr 7.0 cannot read indexes from 6.x versions&lt;/p&gt;</comment>
                            <comment id="16195299" author="steve_rowe" created="Fri, 6 Oct 2017 21:56:46 +0000"  >&lt;p&gt;Closing after 7.0.1 release.&lt;/p&gt;</comment>
                            <comment id="16197370" author="marcello.lodi" created="Mon, 9 Oct 2017 17:43:28 +0000"  >&lt;p&gt;I have the same problem but using SolrCloud.&lt;br/&gt;
I am trying to upgrade from 6.6.1 to 7.0.1 but one installed the new version, solrCloud does not start.&lt;br/&gt;
Here is the stacktrace:017-10-09 17:28:44.815 INFO  (main) [   ] o.a.s.c.ZkController Register node as live in ZooKeeper:/live_nodes/161.72.52.153:8983_solr&lt;br/&gt;
2017-10-09 17:28:44.826 INFO  (zkCallback-4-thread-1-processing-n:161.72.52.153:8983_solr) [   ] o.a.s.c.c.ZkStateReader Updated live nodes from ZooKeeper... (2) -&amp;gt; (3)&lt;br/&gt;
2017-10-09 17:28:45.141 INFO  (main) [   ] o.a.s.c.CorePropertiesLocator Found 4 core definitions underneath /var/solr/data&lt;br/&gt;
2017-10-09 17:28:45.146 INFO  (main) [   ] o.a.s.c.CorePropertiesLocator Cores are: &lt;span class=&quot;error&quot;&gt;&amp;#91;weave_opr3plus_shard3_replica2, weave_opr3plus_shard2_replica1, weave_opr3plus_shard6_replica2, weave_opr3plus_shard5_replica1&amp;#93;&lt;/span&gt;&lt;br/&gt;
2017-10-09 17:28:45.168 INFO  (coreLoadExecutor-6-thread-3-processing-n:161.72.52.153:8983_solr) [   ] o.a.s.c.TransientSolrCoreCacheDefault Allocating transient cache for 2147483647 transient cores&lt;br/&gt;
2017-10-09 17:28:45.173 ERROR (coreContainerWorkExecutor-2-thread-1-processing-n:161.72.52.153:8983_solr) [   ] o.a.s.c.CoreContainer Error waiting for SolrCore to be created&lt;br/&gt;
java.util.concurrent.ExecutionException: org.apache.solr.common.SolrException: Unable to create core &lt;span class=&quot;error&quot;&gt;&amp;#91;weave_opr3plus_shard2_replica1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.FutureTask.report(FutureTask.java:122)&lt;br/&gt;
        at java.util.concurrent.FutureTask.get(FutureTask.java:192)&lt;br/&gt;
        at org.apache.solr.core.CoreContainer.lambda$load$12(CoreContainer.java:648)&lt;br/&gt;
        at com.codahale.metrics.InstrumentedExecutorService$InstrumentedRunnable.run(InstrumentedExecutorService.java:176)&lt;br/&gt;
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)&lt;br/&gt;
        at java.util.concurrent.FutureTask.run(FutureTask.java:266)&lt;br/&gt;
        at org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
Caused by: org.apache.solr.common.SolrException: Unable to create core &lt;span class=&quot;error&quot;&gt;&amp;#91;weave_opr3plus_shard2_replica1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:1022)&lt;br/&gt;
        at org.apache.solr.core.CoreContainer.lambda$load$11(CoreContainer.java:619)&lt;br/&gt;
        at com.codahale.metrics.InstrumentedExecutorService$InstrumentedCallable.call(InstrumentedExecutorService.java:197)&lt;br/&gt;
        ... 5 more&lt;br/&gt;
Caused by: org.apache.solr.common.SolrException: No coreNodeName for CoreDescriptor&lt;span class=&quot;error&quot;&gt;&amp;#91;name=weave_opr3plus_shard2_replica1;instanceDir=/var/solr/data/weave_opr3plus_shard2_replica1&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.solr.cloud.ZkController.checkStateInZk(ZkController.java:1514)&lt;br/&gt;
        at org.apache.solr.cloud.ZkController.preRegister(ZkController.java:1474)&lt;br/&gt;
        at org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:999)&lt;br/&gt;
        ... 7 more&lt;br/&gt;
2017-10-09 17:28:45.177 ERROR (coreContainerWorkExecutor-2-thread-1-processing-n:161.72.52.153:8983_solr) [   ] o.a.s.c.CoreContainer Error waiting for SolrCore to be created&lt;br/&gt;
java.util.concurrent.ExecutionException: org.apache.solr.common.SolrException: Unable to create core &lt;span class=&quot;error&quot;&gt;&amp;#91;weave_opr3plus_shard3_replica2&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at java.util.concurrent.FutureTask.report(FutureTask.java:122)&lt;br/&gt;
        at java.util.concurrent.FutureTask.get(FutureTask.java:192)&lt;br/&gt;
        at org.apache.solr.core.CoreContainer.lambda$load$12(CoreContainer.java:648)&lt;br/&gt;
        at com.codahale.metrics.InstrumentedExecutorService$InstrumentedRunnable.run(InstrumentedExecutorService.java:176)&lt;br/&gt;
        at java.util.concurrent.Executors$RunnableAdapter.call(Executors.java:511)&lt;br/&gt;
        at java.util.concurrent.FutureTask.run(FutureTask.java:266)&lt;br/&gt;
        at org.apache.solr.common.util.ExecutorUtil$MDCAwareThreadPoolExecutor.lambda$execute$0(ExecutorUtil.java:188)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor.runWorker(ThreadPoolExecutor.java:1142)&lt;br/&gt;
        at java.util.concurrent.ThreadPoolExecutor$Worker.run(ThreadPoolExecutor.java:617)&lt;br/&gt;
        at java.lang.Thread.run(Thread.java:745)&lt;br/&gt;
Caused by: org.apache.solr.common.SolrException: Unable to create core &lt;span class=&quot;error&quot;&gt;&amp;#91;weave_opr3plus_shard3_replica2&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:1022)&lt;br/&gt;
        at org.apache.solr.core.CoreContainer.lambda$load$11(CoreContainer.java:619)&lt;br/&gt;
        at com.codahale.metrics.InstrumentedExecutorService$InstrumentedCallable.call(InstrumentedExecutorService.java:197)&lt;br/&gt;
        ... 5 more&lt;br/&gt;
Caused by: org.apache.solr.common.SolrException: No coreNodeName for CoreDescriptor&lt;span class=&quot;error&quot;&gt;&amp;#91;name=weave_opr3plus_shard3_replica2;instanceDir=/var/solr/data/weave_opr3plus_shard3_replica2&amp;#93;&lt;/span&gt;&lt;br/&gt;
        at org.apache.solr.cloud.ZkController.checkStateInZk(ZkController.java:1514)&lt;br/&gt;
        at org.apache.solr.cloud.ZkController.preRegister(ZkController.java:1474)&lt;br/&gt;
        at org.apache.solr.core.CoreContainer.createFromDescriptor(CoreContainer.java:999)&lt;br/&gt;
        ... 7 more&lt;/p&gt;</comment>
                            <comment id="16197380" author="erickerickson" created="Mon, 9 Oct 2017 17:47:35 +0000"  >&lt;p&gt;You need to install 7.0.1 to get past this.&lt;/p&gt;</comment>
                            <comment id="16197394" author="thetaphi" created="Mon, 9 Oct 2017 17:51:13 +0000"  >&lt;p&gt;The stack trace posted here is completely unrelated. So this has nothing to do with the 7.0.0 bug described in this issue. It looks like something else went wrong. Please read the upgrade guidelines! To me it looks like you need to modify some config files.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                            <outwardlinks description="duplicates">
                                        <issuelink>
            <issuekey id="12955150">SOLR-8930</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                                                <inwardlinks description="is related to">
                                        <issuelink>
            <issuekey id="12707071">SOLR-5970</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="13059752">LUCENE-7756</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12889744" name="SOLR-11406.patch" size="13998" author="sarowe" created="Fri, 29 Sep 2017 18:47:31 +0000"/>
                            <attachment id="12889391" name="SOLR-11406.patch" size="1412" author="sarowe" created="Wed, 27 Sep 2017 23:38:26 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 6 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3kmcv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>