<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:51:10 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-16361] &apos;mod&apos; function query casts to float, returns wrong modulus for large ints</title>
                <link>https://issues.apache.org/jira/browse/SOLR-16361</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;mod function query uses DualFloatFunction. This eventualy does a conversion&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;
 (&lt;span class=&quot;code-object&quot;&gt;float&lt;/span&gt;)value&#160;&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;
&lt;p&gt; converting an integer (32bit) into a float which has a 24bit mantissa ,resulting in a loss of precision.&lt;/p&gt;

&lt;p&gt;This means that for integers &amp;gt; 2^24 this returns an incorrect modulus due to this loss of precision.&lt;/p&gt;

&lt;p&gt;Should we use integer only, or perhaps cast to double (so then create a DualDoubleFunction) which has a 52bit mantissa, so can convert int to double without loss of precision?&lt;/p&gt;

&lt;p&gt;This issue may also affect the other function queries?&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;</description>
                <environment></environment>
        <key id="13479291">SOLR-16361</key>
            <summary>&apos;mod&apos; function query casts to float, returns wrong modulus for large ints</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="epugh">Eric Pugh</assignee>
                                    <reporter username="rosher">Dan Rosher</reporter>
                        <labels>
                    </labels>
                <created>Tue, 30 Aug 2022 10:44:29 +0000</created>
                <updated>Fri, 17 Oct 2025 20:05:10 +0000</updated>
                            <resolved>Fri, 16 Sep 2022 19:49:24 +0000</resolved>
                                    <version>9.0</version>
                                    <fixVersion>9.1</fixVersion>
                    <fixVersion>10.0</fixVersion>
                                    <component>search</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>5</watches>
                                                    <progress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </progress>
                                    <aggregateprogress percentage="100">
                                    <originalProgress>
                                                    <row percentage="0" backgroundColor="#89afd7"/>
                                                    <row percentage="100" backgroundColor="transparent"/>
                                            </originalProgress>
                                                    <currentProgress>
                                                    <row percentage="100" backgroundColor="#51a825"/>
                                                    <row percentage="0" backgroundColor="#ec8e00"/>
                                            </currentProgress>
                            </aggregateprogress>
                                            <timeestimate seconds="0">0h</timeestimate>
                            <timespent seconds="5400">1.5h</timespent>
                                <comments>
                            <comment id="17605970" author="jira-bot" created="Fri, 16 Sep 2022 19:45:23 +0000"  >&lt;p&gt;Commit b480bc81ac82094bc5051ace3308a34f85d7604d in solr&apos;s branch refs/heads/main from Dan Rosher&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=b480bc81ac8&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=b480bc81ac8&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16361&quot; title=&quot;&amp;#39;mod&amp;#39; function query casts to float, returns wrong modulus for large ints&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16361&quot;&gt;&lt;del&gt;SOLR-16361&lt;/del&gt;&lt;/a&gt; &apos;mod&apos; function query casts to float, returns wrong modulus for large ints (#989)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;use double instead of float&lt;br/&gt;
Co-authored-by: Dan Rosher &amp;lt;d.rosher@cv-library.co.uk&amp;gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17605971" author="jira-bot" created="Fri, 16 Sep 2022 19:49:16 +0000"  >&lt;p&gt;Commit e384e210b21256612f3f045a2c8827e6c6df73f1 in solr&apos;s branch refs/heads/branch_9x from Dan Rosher&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=solr.git;h=e384e210b21&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=solr.git;h=e384e210b21&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-16361&quot; title=&quot;&amp;#39;mod&amp;#39; function query casts to float, returns wrong modulus for large ints&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-16361&quot;&gt;&lt;del&gt;SOLR-16361&lt;/del&gt;&lt;/a&gt; &apos;mod&apos; function query casts to float, returns wrong modulus for large ints (#989)&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;use double instead of float&lt;br/&gt;
Co-authored-by: Dan Rosher &amp;lt;d.rosher@cv-library.co.uk&amp;gt;&lt;/li&gt;
&lt;/ul&gt;
</comment>
                            <comment id="17606612" author="gerlowskija" created="Mon, 19 Sep 2022 14:03:39 +0000"  >&lt;p&gt;Hey &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=epugh&quot; class=&quot;user-hover&quot; rel=&quot;epugh&quot;&gt;epugh&lt;/a&gt; thanks for grabbing this and thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=rosher&quot; class=&quot;user-hover&quot; rel=&quot;rosher&quot;&gt;rosher&lt;/a&gt; for the PR; it&apos;d been on my review list but I stalled out trying to get to the bottom of a question I had about how func-queries work.  I never figured out the answer, so I&apos;m gonna ask here in case that gets the Q a few extra eyes:&lt;/p&gt;

&lt;p&gt;The math operations in our function queries cast to &apos;float&apos; pretty consistently: &apos;sum&apos;, &apos;sub&apos;, &apos;pow&apos; are all float-based operations.  Is there a reason we used &apos;float&apos; here?  If not, should we switch over to &apos;double&apos; more broadly, and not just for &apos;mod&apos;?&lt;/p&gt;</comment>
                            <comment id="17606619" author="epugh" created="Mon, 19 Sep 2022 14:23:32 +0000"  >&lt;p&gt;I&apos;ll be honest, I don&apos;t have an informed opinion, I was mostly focused on shepherding the contribution to completion.  Curious what others say?&lt;/p&gt;</comment>
                            <comment id="17656880" author="ishan" created="Tue, 10 Jan 2023 20:45:32 +0000"  >&lt;p&gt;Bulk closing 9.1 issues.&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            2 years, 44 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z186go:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>