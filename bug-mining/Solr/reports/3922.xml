<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:33:00 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-11880] Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search and update operations</title>
                <link>https://issues.apache.org/jira/browse/SOLR-11880</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;MDCAwareThreadPoolExecutor has this line in it&apos;s{&lt;tt&gt;execute&lt;/tt&gt; method&lt;/p&gt;

&lt;p&gt;&#160;&lt;/p&gt;
&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;

&lt;span class=&quot;code-keyword&quot;&gt;final&lt;/span&gt; Exception submitterStackTrace = &lt;span class=&quot;code-keyword&quot;&gt;new&lt;/span&gt; Exception(&lt;span class=&quot;code-quote&quot;&gt;&quot;Submitter stack trace&quot;&lt;/span&gt;);&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;This means that every call via the a thread pool will create this exception, and only when it sees an error will it be used. &lt;/p&gt;</description>
                <environment></environment>
        <key id="13132552">SOLR-11880</key>
            <summary>Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search and update operations</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="shalin">Shalin Shekhar Mangar</assignee>
                                    <reporter username="varun">Varun Thacker</reporter>
                        <labels>
                    </labels>
                <created>Mon, 22 Jan 2018 01:39:28 +0000</created>
                <updated>Sat, 11 Apr 2020 03:27:48 +0000</updated>
                            <resolved>Tue, 22 May 2018 13:59:01 +0000</resolved>
                                                    <fixVersion>7.4</fixVersion>
                    <fixVersion>8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="16334607" author="shalinmangar" created="Mon, 22 Jan 2018 17:40:45 +0000"  >&lt;p&gt;If we remove&#160;that exception then we&apos;re running blind. There would be no way to get the stack trace of the submitter when an actual exception happens inside the&#160;executor thread.&lt;/p&gt;</comment>
                            <comment id="16335396" author="noble.paul" created="Tue, 23 Jan 2018 05:27:26 +0000"  >&lt;p&gt;We should create a custom Exception which doesn&apos;t fillInStackTrace() in constructor. we can do the fillInStackTrace lazily&lt;/p&gt;</comment>
                            <comment id="16335473" author="shalinmangar" created="Tue, 23 Jan 2018 07:57:06 +0000"  >&lt;p&gt;I don&apos;t think that is possible.&#160;If we want the caller&apos;s stack trace then we either call fillInStackTrace at the point of the call or we use a cached copy from the right place. If this is indeed a bottleneck (and I am not sure that it is) then we can either eliminate the submitter stack trace with a flag or do something ugly/clever like having the caller of execute method pass down a&#160;static exception object&lt;/p&gt;</comment>
                            <comment id="16346905" author="ctargett" created="Wed, 31 Jan 2018 14:28:33 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=noble.paul&quot; class=&quot;user-hover&quot; rel=&quot;noble.paul&quot;&gt;noble.paul&lt;/a&gt; - I suspect the commits so far here were actually meant for &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11067&quot; title=&quot;REPLACENODE should make it optional to provide a target node&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11067&quot;&gt;&lt;del&gt;SOLR-11067&lt;/del&gt;&lt;/a&gt;?&lt;/p&gt;</comment>
                            <comment id="16347545" author="noble.paul" created="Wed, 31 Jan 2018 20:18:17 +0000"  >&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=ctargett&quot; class=&quot;user-hover&quot; rel=&quot;ctargett&quot;&gt;ctargett&lt;/a&gt; right. this is what happens when you work on multiple tickets at the same time &lt;img class=&quot;emoticon&quot; src=&quot;https://issues.apache.org/jira/images/icons/emoticons/wink.png&quot; height=&quot;16&quot; width=&quot;16&quot; align=&quot;absmiddle&quot; alt=&quot;&quot; border=&quot;0&quot;/&gt;&lt;/p&gt;</comment>
                            <comment id="16483820" author="shalinmangar" created="Tue, 22 May 2018 11:44:11 +0000"  >&lt;p&gt;Taking another look at this one. The distributed update and search requests are the most frequent users of this executor. Tracing each, I see that the Runnable added by HttpShardHandler.submit, SolrCmdDistributor.submit and StreamingSolrClients.ErrorReportingConcurrentUpdateSolrClient never throw any exceptions but they are tracked and logged as part of the shard response or similar classes. Therefore there is no point in creating an Exception object for these two usages. So, this patches adds another constructor for MDCAwareThreadPoolExecutor which disables the submitter stack trace for search and update use-cases.&lt;/p&gt;</comment>
                            <comment id="16483985" author="jira-bot" created="Tue, 22 May 2018 13:56:51 +0000"  >&lt;p&gt;Commit 5a47ed4209620f6ea80af00774f270a02604c966 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5a47ed4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=5a47ed4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11880&quot; title=&quot;Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search and update operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11880&quot;&gt;&lt;del&gt;SOLR-11880&lt;/del&gt;&lt;/a&gt;: Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search and update operations&lt;/p&gt;</comment>
                            <comment id="16483989" author="jira-bot" created="Tue, 22 May 2018 13:57:55 +0000"  >&lt;p&gt;Commit c4a41c4c6a368f4461f6d31cfa6647348a3f7666 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c4a41c4&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=c4a41c4&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11880&quot; title=&quot;Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search and update operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11880&quot;&gt;&lt;del&gt;SOLR-11880&lt;/del&gt;&lt;/a&gt;: Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search and update operations&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 5a47ed4)&lt;/p&gt;</comment>
                            <comment id="17081119" author="jira-bot" created="Sat, 11 Apr 2020 03:26:25 +0000"  >&lt;p&gt;Commit d52c1021e543b8cc2dd7b8d1d181e3dba160a760 in lucene-solr&apos;s branch refs/heads/master from Shalin Shekhar Mangar&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=d52c102&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=d52c102&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14402&quot; title=&quot;Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14402&quot;&gt;&lt;del&gt;SOLR-14402&lt;/del&gt;&lt;/a&gt;: Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search.&lt;/p&gt;

&lt;p&gt; This is a fix for incomplete optimization made by &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11880&quot; title=&quot;Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search and update operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11880&quot;&gt;&lt;del&gt;SOLR-11880&lt;/del&gt;&lt;/a&gt; in Solr 7.4 which fixed distributed updates but not distributed search.&lt;/p&gt;</comment>
                            <comment id="17081121" author="jira-bot" created="Sat, 11 Apr 2020 03:27:48 +0000"  >&lt;p&gt;Commit f68c498e4fb891efbd598ea2007985334c731baf in lucene-solr&apos;s branch refs/heads/branch_8x from Shalin Shekhar Mangar&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=f68c498&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=f68c498&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-14402&quot; title=&quot;Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-14402&quot;&gt;&lt;del&gt;SOLR-14402&lt;/del&gt;&lt;/a&gt;: Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search.&lt;/p&gt;

&lt;p&gt; This is a fix for incomplete optimization made by &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11880&quot; title=&quot;Avoid creating new exceptions for every request made to MDCAwareThreadPoolExecutor by distributed search and update operations&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11880&quot;&gt;&lt;del&gt;SOLR-11880&lt;/del&gt;&lt;/a&gt; in Solr 7.4 which fixed distributed updates but not distributed search.&lt;/p&gt;

&lt;p&gt;(cherry picked from commit d52c1021e543b8cc2dd7b8d1d181e3dba160a760)&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12924528" name="SOLR-11880.patch" size="6817" author="shalin" created="Tue, 22 May 2018 11:49:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            5 years, 31 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3p5vj:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>