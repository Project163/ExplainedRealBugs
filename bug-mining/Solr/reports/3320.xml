<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:20:57 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-10218] The Schema API commands &quot;add-field-type&quot; and &quot;replace-field-type&quot; improperly specify SimilarityFactory params</title>
                <link>https://issues.apache.org/jira/browse/SOLR-10218</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;When sending a JSON POST to the Schema API to replace a field type, the following JSON does not pass the SolrParameters properly to the BM25SimilarityFactory.  &lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-javascript&quot;&gt;{&lt;span class=&quot;code-quote&quot;&gt;&quot;replace-field-type&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;tint&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.TrieIntField&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;positionIncrementGap&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;0&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;precisionStep&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;8&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;similarity&quot;&lt;/span&gt;:{&lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;:&lt;span class=&quot;code-quote&quot;&gt;&quot;solr.BM25SimilarityFactory&quot;&lt;/span&gt;,&lt;span class=&quot;code-quote&quot;&gt;&quot;k1&quot;&lt;/span&gt;:1.25,&lt;span class=&quot;code-quote&quot;&gt;&quot;b&quot;&lt;/span&gt;:0.75}}}
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The `appendAttrs` function in the FieldTypeXmlAdapter parses k1 and b into attributes instead of children.  &lt;a href=&quot;https://github.com/apache/lucene-solr/blob/master/solr/core/src/java/org/apache/solr/rest/schema/FieldTypeXmlAdapter.java#L155&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://github.com/apache/lucene-solr/blob/master/solr/core/src/java/org/apache/solr/rest/schema/FieldTypeXmlAdapter.java#L155&lt;/a&gt;&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;similarity b=&lt;span class=&quot;code-quote&quot;&gt;&quot;0.75&quot;&lt;/span&gt; class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.lucene.search.similarities.BM25Similarity&quot;&lt;/span&gt; k1=&lt;span class=&quot;code-quote&quot;&gt;&quot;1.25&quot;&lt;/span&gt;/&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;Based on the XML examples for similarity, this should actually be the following :&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-xml&quot;&gt;&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;similarity class=&lt;span class=&quot;code-quote&quot;&gt;&quot;org.apache.lucene.search.similarities.BM25Similarity&quot;&lt;/span&gt;&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;float name=&#8220;k1&#8221;&amp;gt;&lt;/span&gt;0.1&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/float&amp;gt;&lt;/span&gt;
     &lt;span class=&quot;code-tag&quot;&gt;&amp;lt;float name=&#8220;b&#8221;&amp;gt;&lt;/span&gt;0.1&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/float&amp;gt;&lt;/span&gt;
&lt;span class=&quot;code-tag&quot;&gt;&amp;lt;/similarity&amp;gt;&lt;/span&gt;
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;The similarities block in JSON should be handled differently so that the XML is generated appropriately.&lt;/p&gt;

&lt;div class=&quot;code panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;codeContent panelContent&quot;&gt;
&lt;pre class=&quot;code-java&quot;&gt;    &lt;span class=&quot;code-keyword&quot;&gt;protected&lt;/span&gt; &lt;span class=&quot;code-keyword&quot;&gt;static&lt;/span&gt; Element appendSimilarityAttrs(Document doc, Element elm, Map&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,?&amp;gt; json) {
        &lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt; clazz = (&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;) json.get(&lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;);
        elm.setAttribute(&lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;, clazz);
        json.remove(&lt;span class=&quot;code-quote&quot;&gt;&quot;class&quot;&lt;/span&gt;);

        &lt;span class=&quot;code-keyword&quot;&gt;for&lt;/span&gt; (Map.Entry&amp;lt;&lt;span class=&quot;code-object&quot;&gt;String&lt;/span&gt;,?&amp;gt; entry : json.entrySet()) {
            &lt;span class=&quot;code-object&quot;&gt;Object&lt;/span&gt; val = entry.getValue();
            &lt;span class=&quot;code-keyword&quot;&gt;if&lt;/span&gt; (val != &lt;span class=&quot;code-keyword&quot;&gt;null&lt;/span&gt; &amp;amp;&amp;amp; !(val &lt;span class=&quot;code-keyword&quot;&gt;instanceof&lt;/span&gt; Map)) {
                Element element = doc.createElement(val.getClass().getSimpleName().toLowerCase());
                element.setAttribute(&lt;span class=&quot;code-quote&quot;&gt;&quot;name&quot;&lt;/span&gt;, entry.getKey());
                element.setTextContent(entry.getValue().toString());
                elm.appendChild(element);
            }
        }
        &lt;span class=&quot;code-keyword&quot;&gt;return&lt;/span&gt; elm;
    }
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;


</description>
                <environment></environment>
        <key id="13047099">SOLR-10218</key>
            <summary>The Schema API commands &quot;add-field-type&quot; and &quot;replace-field-type&quot; improperly specify SimilarityFactory params</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="4" iconUrl="https://issues.apache.org/jira/images/icons/priorities/minor.svg">Minor</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sarowe">Steven Rowe</assignee>
                                    <reporter username="bdeininger">Benjamin Deininger</reporter>
                        <labels>
                    </labels>
                <created>Tue, 28 Feb 2017 21:23:53 +0000</created>
                <updated>Sat, 8 Jun 2019 15:32:54 +0000</updated>
                            <resolved>Sat, 18 Mar 2017 04:05:51 +0000</resolved>
                                    <version>6.4.1</version>
                                    <fixVersion>6.5</fixVersion>
                    <fixVersion>7.0</fixVersion>
                                    <component>Schema and Analysis</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>7</watches>
                                                                                                                <comments>
                            <comment id="15903246" author="troymohl" created="Thu, 9 Mar 2017 15:50:24 +0000"  >&lt;p&gt;This patch updates the FieldTypeXmlAdapter to parse the similarity options into XML elements.&lt;/p&gt;</comment>
                            <comment id="15931039" author="steve_rowe" created="Sat, 18 Mar 2017 03:58:33 +0000"  >&lt;p&gt;Modified patch, I think it&apos;s ready to go.  Changes:&lt;/p&gt;

&lt;ul&gt;
	&lt;li&gt;Boolean and String params are now properly specified (the XML tags are &quot;bool&quot; and &quot;str&quot; for these, respectively).&lt;/li&gt;
	&lt;li&gt;Fixed removal of &quot;class&quot; param prior to param addition.&lt;/li&gt;
	&lt;li&gt;Added testing of replace-field-type command.&lt;/li&gt;
	&lt;li&gt;Added testing of another similarity, with Boolean and String params: DFISimilarity.&lt;/li&gt;
	&lt;li&gt;Refactored some test code to reuse an existing utility method and eliminate an added one.&lt;/li&gt;
&lt;/ul&gt;


&lt;p&gt;I&apos;ll commit this, including to the 6.5 release branch, once all tests pass for me.&lt;/p&gt;</comment>
                            <comment id="15931040" author="jira-bot" created="Sat, 18 Mar 2017 04:03:21 +0000"  >&lt;p&gt;Commit 2e4b994f71022989f7c9695a91774029261b6922 in lucene-solr&apos;s branch refs/heads/branch_6_5 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2e4b994&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=2e4b994&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10218&quot; title=&quot;The Schema API commands &amp;quot;add-field-type&amp;quot; and &amp;quot;replace-field-type&amp;quot; improperly specify SimilarityFactory params&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10218&quot;&gt;&lt;del&gt;SOLR-10218&lt;/del&gt;&lt;/a&gt;: The Schema API commands add-field-type and replace-field-type improperly specify SimilarityFactory params&lt;/p&gt;</comment>
                            <comment id="15931041" author="jira-bot" created="Sat, 18 Mar 2017 04:03:23 +0000"  >&lt;p&gt;Commit ef141de630e03a7e8725f6b4a8d11e35f14d41c2 in lucene-solr&apos;s branch refs/heads/branch_6x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ef141de&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=ef141de&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10218&quot; title=&quot;The Schema API commands &amp;quot;add-field-type&amp;quot; and &amp;quot;replace-field-type&amp;quot; improperly specify SimilarityFactory params&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10218&quot;&gt;&lt;del&gt;SOLR-10218&lt;/del&gt;&lt;/a&gt;: The Schema API commands add-field-type and replace-field-type improperly specify SimilarityFactory params&lt;/p&gt;</comment>
                            <comment id="15931042" author="jira-bot" created="Sat, 18 Mar 2017 04:03:26 +0000"  >&lt;p&gt;Commit 9b57545df01fd0f20fd473e80d4fba621a51abf9 in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9b57545&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=9b57545&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-10218&quot; title=&quot;The Schema API commands &amp;quot;add-field-type&amp;quot; and &amp;quot;replace-field-type&amp;quot; improperly specify SimilarityFactory params&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-10218&quot;&gt;&lt;del&gt;SOLR-10218&lt;/del&gt;&lt;/a&gt;: The Schema API commands add-field-type and replace-field-type improperly specify SimilarityFactory params&lt;/p&gt;</comment>
                            <comment id="15931043" author="steve_rowe" created="Sat, 18 Mar 2017 04:05:51 +0000"  >&lt;p&gt;Committed to master, branch_6x and branch_6_5 (for inclusion in Solr 6.5).&lt;/p&gt;

&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=bdeininger&quot; class=&quot;user-hover&quot; rel=&quot;bdeininger&quot;&gt;bdeininger&lt;/a&gt; and &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=troymohl&quot; class=&quot;user-hover&quot; rel=&quot;troymohl&quot;&gt;troymohl&lt;/a&gt; !&lt;/p&gt;</comment>
                    </comments>
                    <attachments>
                            <attachment id="12859403" name="SOLR-10218.patch" size="7944" author="sarowe" created="Sat, 18 Mar 2017 03:58:33 +0000"/>
                            <attachment id="12857029" name="SOLR-10218.patch" size="5261" author="troymohl" created="Thu, 9 Mar 2017 15:50:24 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 35 weeks, 4 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3ar5b:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>