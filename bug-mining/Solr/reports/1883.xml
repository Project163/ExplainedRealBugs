<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 03:50:06 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-5954] Slower dataimport process caused by not reusing jdbc connections</title>
                <link>https://issues.apache.org/jira/browse/SOLR-5954</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Hi, &lt;br/&gt;
&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5734&quot; title=&quot;We should use System.nanoTime rather than System.currentTimeMillis when calculating elapsed time. &quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5734&quot;&gt;&lt;del&gt;SOLR-5734&lt;/del&gt;&lt;/a&gt; introduced a regression that causes that the connections used in the dataimport process were closed and reopen in every sql.&lt;/p&gt;

&lt;p&gt;The change to nanoTime in the method getConnection of JdbcDataSource.java forgot to convert the timeout used to reuse the connection.&lt;/p&gt;

&lt;p&gt;The constant CONN_TIME_OUT must be changed to nanos to be compared. (*1000*1000)&lt;/p&gt;

&lt;p&gt;private Connection getConnection() throws Exception {&lt;br/&gt;
long currTime = System.nanoTime();&lt;br/&gt;
if (currTime - connLastUsed &amp;gt; CONN_TIME_OUT) &lt;/p&gt;
{&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;&amp;lt;
synchronized (this)
{ Connection tmpConn = factory.call(); closeConnection(); connLastUsed = System.nanoTime(); return conn = tmpConn; }
&lt;p&gt;} else&lt;/p&gt;
{ connLastUsed = currTime; return conn; }
&lt;p&gt;}&lt;/p&gt;

&lt;p&gt;private static final long CONN_TIME_OUT = 10 * 1000; // 10 seconds&lt;/p&gt;

&lt;p&gt;Regards&lt;/p&gt;</description>
                <environment></environment>
        <key id="12706404">SOLR-5954</key>
            <summary>Slower dataimport process caused by not reusing jdbc connections</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="markrmiller@gmail.com">Mark Miller</assignee>
                                    <reporter username="pacoge36">Paco Garcia</reporter>
                        <labels>
                    </labels>
                <created>Thu, 3 Apr 2014 11:59:59 +0000</created>
                <updated>Mon, 9 May 2016 18:45:46 +0000</updated>
                            <resolved>Wed, 16 Apr 2014 14:32:51 +0000</resolved>
                                    <version>4.7.1</version>
                                    <fixVersion>4.8</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                    <component>contrib - DataImportHandler</component>
                        <due></due>
                            <votes>0</votes>
                                    <watches>6</watches>
                                                                                                                <comments>
                            <comment id="13958826" author="nagkumar" created="Thu, 3 Apr 2014 13:51:36 +0000"  >&lt;p&gt;concise and readable change for this bug would be &lt;/p&gt;

&lt;p&gt;  private static final long CONN_TIME_OUT = TimeUnit.SECONDS.toNanos(10); // 10 seconds&lt;/p&gt;</comment>
                            <comment id="13969971" author="jira-bot" created="Tue, 15 Apr 2014 19:38:37 +0000"  >&lt;p&gt;Commit 1587706 from markrmiller@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1587706&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1587706&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5954&quot; title=&quot;Slower dataimport process caused by not reusing jdbc connections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5954&quot;&gt;&lt;del&gt;SOLR-5954&lt;/del&gt;&lt;/a&gt;: Slower DataImportHandler process caused by not reusing jdbc connections.&lt;/p&gt;</comment>
                            <comment id="13969974" author="jira-bot" created="Tue, 15 Apr 2014 19:39:29 +0000"  >&lt;p&gt;Commit 1587707 from markrmiller@apache.org in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1587707&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1587707&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5954&quot; title=&quot;Slower dataimport process caused by not reusing jdbc connections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5954&quot;&gt;&lt;del&gt;SOLR-5954&lt;/del&gt;&lt;/a&gt;: Slower DataImportHandler process caused by not reusing jdbc connections.&lt;/p&gt;</comment>
                            <comment id="13971251" author="thetaphi" created="Wed, 16 Apr 2014 12:57:34 +0000"  >&lt;p&gt;Move issue to Solr 4.9.&lt;/p&gt;</comment>
                            <comment id="13971462" author="markrmiller@gmail.com" created="Wed, 16 Apr 2014 14:27:16 +0000"  >&lt;p&gt;We should put this regression into 4.8.&lt;/p&gt;</comment>
                            <comment id="13971468" author="jira-bot" created="Wed, 16 Apr 2014 14:30:38 +0000"  >&lt;p&gt;Commit 1587924 from markrmiller@apache.org in branch &apos;dev/branches/lucene_solr_4_8&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1587924&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1587924&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5954&quot; title=&quot;Slower dataimport process caused by not reusing jdbc connections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5954&quot;&gt;&lt;del&gt;SOLR-5954&lt;/del&gt;&lt;/a&gt;: Slower DataImportHandler process caused by not reusing jdbc connections.&lt;/p&gt;</comment>
                            <comment id="13971470" author="jira-bot" created="Wed, 16 Apr 2014 14:31:34 +0000"  >&lt;p&gt;Commit 1587925 from markrmiller@apache.org in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1587925&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1587925&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5954&quot; title=&quot;Slower dataimport process caused by not reusing jdbc connections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5954&quot;&gt;&lt;del&gt;SOLR-5954&lt;/del&gt;&lt;/a&gt;: Move CHANGES entry to 4.8.&lt;/p&gt;</comment>
                            <comment id="13971473" author="jira-bot" created="Wed, 16 Apr 2014 14:32:30 +0000"  >&lt;p&gt;Commit 1587926 from markrmiller@apache.org in branch &apos;dev/branches/branch_4x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1587926&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1587926&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-5954&quot; title=&quot;Slower dataimport process caused by not reusing jdbc connections&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-5954&quot;&gt;&lt;del&gt;SOLR-5954&lt;/del&gt;&lt;/a&gt;: Move CHANGES entry to 4.8.&lt;/p&gt;</comment>
                            <comment id="13982552" author="thetaphi" created="Sun, 27 Apr 2014 23:25:42 +0000"  >&lt;p&gt;Close issue after release of 4.8.0&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310000">
                    <name>Duplicate</name>
                                                                <inwardlinks description="is duplicated by">
                                        <issuelink>
            <issuekey id="12716090">SOLR-6110</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12638472" name="SOLR-5954.patch" size="653" author="markrmiller@gmail.com" created="Thu, 3 Apr 2014 13:45:35 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>384727</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            11 years, 30 weeks, 2 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i1ua27:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>384994</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>