<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:27:14 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-11239] Deprecate maxSHardsPerNode when autoscaling policies are used</title>
                <link>https://issues.apache.org/jira/browse/SOLR-11239</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;We have found out that &lt;tt&gt;maxShardPerNode&lt;/tt&gt; is not compatible with the new auto scaling policies. So we need to deprecate that parameter when the autoscaling policies are used.&lt;/p&gt;

&lt;p&gt;the &lt;tt&gt;bin/solr&lt;/tt&gt; script passes that parameter all the time irrespective of whether the user needs it or not. &lt;/p&gt;

&lt;p&gt;We need to fix it for 7.0 itself&lt;/p&gt;</description>
                <environment></environment>
        <key id="13094710">SOLR-11239</key>
            <summary>Deprecate maxSHardsPerNode when autoscaling policies are used</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="noble.paul">Noble Paul</assignee>
                                    <reporter username="noble.paul">Noble Paul</reporter>
                        <labels>
                    </labels>
                <created>Tue, 15 Aug 2017 09:12:55 +0000</created>
                <updated>Wed, 2 Oct 2019 17:24:00 +0000</updated>
                            <resolved>Wed, 16 Aug 2017 12:06:28 +0000</resolved>
                                    <version>7.0</version>
                                    <fixVersion>7.0</fixVersion>
                    <fixVersion>8.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="16127179" author="shalinmangar" created="Tue, 15 Aug 2017 12:58:38 +0000"  >&lt;p&gt;To add some context behind this issue:&lt;/p&gt;

&lt;p&gt;Firstly, &lt;tt&gt;maxShardsPerNode&lt;/tt&gt; defaults to 1. So if anyone needs to host more than 1 replica per node then they must specify &lt;tt&gt;maxShardsPerNode&lt;/tt&gt; while creating the collection via the collection API.&lt;/p&gt;

&lt;p&gt;Secondly, when someone uses the bin/solr scripts to create a collection, the script automatically calculates numShards*repFactor and passes that value as the maxShardsPerNode. This is a workaround for the first point above. This effectively means that the script needs no maxShardsPerNode limit at all.&lt;/p&gt;

&lt;p&gt;Thirdly, the &lt;tt&gt;maxShardsPerNode&lt;/tt&gt; is not stored in collection state and therefore it is only applicable during the time of collection creation. Any future collection API invocations such as add replicas or split shards do not respect &lt;tt&gt;maxShardsPerNode&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Thirdly, the policy framework has its own way of providing constraints similar to maxShardsPerNode both globally (i.e. across all collections) and per-collection. These constraints are respected by all collection APIs such as create, addreplica, splitshard, restore etc.&lt;/p&gt;

&lt;p&gt;So maxShardsPerNode is really a half-broken solution to the problem of placing replicas on nodes and we should deprecate it in favor of the capabilities exposed by the policy framework. So how do we do this without surprising the user?&lt;/p&gt;

&lt;p&gt;Noble is working on providing a patch that:&lt;/p&gt;
&lt;ol&gt;
	&lt;li&gt;Introduces &lt;tt&gt;maxShardsPerNode=-1&lt;/tt&gt; as a way of saying that there is no limit and Solr should just go ahead and create the collection as requested&lt;/li&gt;
	&lt;li&gt;Change bin/solr to pass maxShardsPerNode=-1 by default.&lt;/li&gt;
	&lt;li&gt;If a cluster policy exists or if a collection policy is specified then specifying maxShardsPerNode will throw an exception during collection creation because otherwise it can conflict with the limits specified in the policy. If users need a constraint like this then they must modify the policy.&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;This way back compat is also preserved. The default maxShardsPerNode remains 1 as before and users who don&apos;t need the policy framework can continue to rely on the existing behavior of the maxShardsPerNode parameter.&lt;/p&gt;</comment>
                            <comment id="16127182" author="shalinmangar" created="Tue, 15 Aug 2017 13:00:30 +0000"  >&lt;p&gt;I forgot to add that since this changes important behavior w.r.t policy framework, we must do this in 7.0 to avoid shipping and having to support a broken behavior.&lt;/p&gt;</comment>
                            <comment id="16128440" author="shalinmangar" created="Wed, 16 Aug 2017 07:29:05 +0000"  >&lt;p&gt;Updated patch with fixes to the new test. This is ready. I&apos;ll run precommit and tests and then commit.&lt;/p&gt;</comment>
                            <comment id="16128458" author="noble.paul" created="Wed, 16 Aug 2017 07:43:52 +0000"  >&lt;p&gt;Thanks &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;. LGTM . +1&lt;/p&gt;</comment>
                            <comment id="16128672" author="jira-bot" created="Wed, 16 Aug 2017 11:56:41 +0000"  >&lt;p&gt;Commit 7a576ffa1b1f4b9632ff2767686fe203949c2aaf in lucene-solr&apos;s branch refs/heads/master from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=7a576ff&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=7a576ff&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11239&quot; title=&quot;Deprecate maxSHardsPerNode when autoscaling policies are used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11239&quot;&gt;&lt;del&gt;SOLR-11239&lt;/del&gt;&lt;/a&gt;: A special value of -1 can be specified for &apos;maxShardsPerNode&apos; to denote that there is no limit. The bin/solr script send maxShardsPerNode=-1 when creating collections. The use of maxShardsPerNode is not supported when a cluster policy is in effect or when a collection specific policy is specified during collection creation&lt;/p&gt;</comment>
                            <comment id="16128675" author="jira-bot" created="Wed, 16 Aug 2017 12:01:54 +0000"  >&lt;p&gt;Commit 73015a6733336733e743e45c2d467cf13cd173a0 in lucene-solr&apos;s branch refs/heads/branch_7x from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=73015a6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=73015a6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11239&quot; title=&quot;Deprecate maxSHardsPerNode when autoscaling policies are used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11239&quot;&gt;&lt;del&gt;SOLR-11239&lt;/del&gt;&lt;/a&gt;: A special value of -1 can be specified for &apos;maxShardsPerNode&apos; to denote that there is no limit. The bin/solr script send maxShardsPerNode=-1 when creating collections. The use of maxShardsPerNode is not supported when a cluster policy is in effect or when a collection specific policy is specified during collection creation&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 7a576ffa1b1f4b9632ff2767686fe203949c2aaf)&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Conflicts:&lt;/li&gt;
	&lt;li&gt;solr/CHANGES.txt&lt;/li&gt;
&lt;/ol&gt;
</comment>
                            <comment id="16128677" author="jira-bot" created="Wed, 16 Aug 2017 12:04:36 +0000"  >&lt;p&gt;Commit 057f9a63f62901fea73e03021ab319c26354b508 in lucene-solr&apos;s branch refs/heads/branch_7_0 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=shalin&quot; class=&quot;user-hover&quot; rel=&quot;shalin&quot;&gt;shalin&lt;/a&gt;&lt;br/&gt;
[ &lt;a href=&quot;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=057f9a6&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://git-wip-us.apache.org/repos/asf?p=lucene-solr.git;h=057f9a6&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-11239&quot; title=&quot;Deprecate maxSHardsPerNode when autoscaling policies are used&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-11239&quot;&gt;&lt;del&gt;SOLR-11239&lt;/del&gt;&lt;/a&gt;: A special value of -1 can be specified for &apos;maxShardsPerNode&apos; to denote that there is no limit. The bin/solr script send maxShardsPerNode=-1 when creating collections. The use of maxShardsPerNode is not supported when a cluster policy is in effect or when a collection specific policy is specified during collection creation&lt;/p&gt;

&lt;p&gt;(cherry picked from commit 7a576ffa1b1f4b9632ff2767686fe203949c2aaf)&lt;/p&gt;

&lt;ol&gt;
	&lt;li&gt;Conflicts:&lt;/li&gt;
	&lt;li&gt;solr/CHANGES.txt&lt;/li&gt;
&lt;/ol&gt;


&lt;p&gt;(cherry picked from commit 73015a6)&lt;/p&gt;</comment>
                            <comment id="16128679" author="shalinmangar" created="Wed, 16 Aug 2017 12:06:28 +0000"  >&lt;p&gt;Thanks Noble!&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="10030">
                    <name>Reference</name>
                                            <outwardlinks description="relates to">
                                        <issuelink>
            <issuekey id="13127790">SOLR-11807</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                            <issuelinktype id="12310051">
                    <name>Supercedes</name>
                                            <outwardlinks description="supercedes">
                                        <issuelink>
            <issuekey id="13084562">SOLR-11005</issuekey>
        </issuelink>
                            </outwardlinks>
                                                        </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12882092" name="SOLR-11239.patch" size="14680" author="shalin" created="Wed, 16 Aug 2017 07:28:35 +0000"/>
                            <attachment id="12881965" name="SOLR-11239.patch" size="15991" author="noble.paul" created="Tue, 15 Aug 2017 16:39:20 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>2.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            8 years, 13 weeks, 6 days ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i3isqv:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>