<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:40:04 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-13694] IndexSizeEstimator NullPointerException</title>
                <link>https://issues.apache.org/jira/browse/SOLR-13694</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>
&lt;p&gt;Jenkins found a reproducible seed for trigging an NPE in IndexSizeEstimatorTest&lt;/p&gt;

&lt;p&gt;Based on a little experimental tracing i did, this might be a real bug in IndexSizeEstimator? ... it&apos;s calling close on StoredFieldsReader instances it gets from the CodecReader &amp;#8211; but AFAICT from the docs/code i&apos;m not certain if it should be doing this.  It appears the expectation is that this is direct access to the internal state, that will automatically be closed when the CodecReader is closed.&lt;/p&gt;

&lt;p&gt;ie: IndexSizeEstimator is closing StoredFieldsReader pre-maturely, causing it to be unusbale on the next iteration.&lt;/p&gt;

&lt;p&gt;(I didn&apos;t dig in far enough to guess if there are other places in the IndexSizeEstimator code that are closing CodecReader internals prematurely as well, or just in this situation ... it&apos;s also not clear if this only causes failures because this seed uses SimpleTextCodec, and other codecs are more forgiving &amp;#8211; or if something else about the index(es) generated for this seed are what cause the problem to manifest)&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;http://fucit.org/solr-jenkins-reports/job-data/apache/Lucene-Solr-NightlyTests-master/1928&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;http://fucit.org/solr-jenkins-reports/job-data/apache/Lucene-Solr-NightlyTests-master/1928&lt;/a&gt;&lt;/p&gt;
&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;hossman@tray:~/lucene/dev/solr/core [j11] [master] $ git rev-parse HEAD
0291db44bc8e092f7cb2f577f0ac8ab6fa6a5fd7
hossman@tray:~/lucene/dev/solr/core [j11] [master] $ ant test  -Dtestcase=IndexSizeEstimatorTest -Dtests.method=testEstimator -Dtests.seed=23F60434E13D8FD4 -Dtests.multiplier=2 -Dtests.nightly=true -Dtests.slow=true  -Dtests.locale=eo -Dtests.timezone=Atlantic/Madeira -Dtests.asserts=true -Dtests.file.encoding=UTF-8
...
   [junit4]   2&amp;gt; NOTE: reproduce with: ant test  -Dtestcase=IndexSizeEstimatorTest -Dtests.method=testEstimator -Dtests.seed=23F60434E13D8FD4 -Dtests.multiplier=2 -Dtests.nightly=true -Dtests.slow=true -Dtests.badapples=true -Dtests.locale=eo -Dtests.timezone=Atlantic/Madeira -Dtests.asserts=true -Dtests.file.encoding=UTF-8
   [junit4] ERROR   0.88s | IndexSizeEstimatorTest.testEstimator &amp;lt;&amp;lt;&amp;lt;
   [junit4]    &amp;gt; Throwable #1: java.lang.NullPointerException
   [junit4]    &amp;gt;        at __randomizedtesting.SeedInfo.seed([23F60434E13D8FD4:EC2B6B666D451E64]:0)
   [junit4]    &amp;gt;        at org.apache.lucene.codecs.simpletext.SimpleTextStoredFieldsReader.visitDocument(SimpleTextStoredFieldsReader.java:109)
   [junit4]    &amp;gt;        at org.apache.solr.handler.admin.IndexSizeEstimator.estimateStoredFields(IndexSizeEstimator.java:513)
   [junit4]    &amp;gt;        at org.apache.solr.handler.admin.IndexSizeEstimator.estimate(IndexSizeEstimator.java:198)
   [junit4]    &amp;gt;        at org.apache.solr.handler.admin.IndexSizeEstimatorTest.testEstimator(IndexSizeEstimatorTest.java:117)
   [junit4]    &amp;gt;        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke0(Native Method)
   [junit4]    &amp;gt;        at java.base/jdk.internal.reflect.NativeMethodAccessorImpl.invoke(NativeMethodAccessorImpl.java:62)
   [junit4]    &amp;gt;        at java.base/jdk.internal.reflect.DelegatingMethodAccessorImpl.invoke(DelegatingMethodAccessorImpl.java:43)
   [junit4]    &amp;gt;        at java.base/java.lang.reflect.Method.invoke(Method.java:566)
   [junit4]    &amp;gt;        at java.base/java.lang.Thread.run(Thread.java:834)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="13250623">SOLR-13694</key>
            <summary>IndexSizeEstimator NullPointerException</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="3" iconUrl="https://issues.apache.org/jira/images/icons/priorities/major.svg">Major</priority>
                        <status id="5" iconUrl="https://issues.apache.org/jira/images/icons/statuses/resolved.png" description="A resolution has been taken, and it is awaiting verification by reporter. From here issues are either reopened, or are closed.">Resolved</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="ab">Andrzej Bialecki</assignee>
                                    <reporter username="hossman">Chris M. Hostetter</reporter>
                        <labels>
                    </labels>
                <created>Tue, 13 Aug 2019 18:01:14 +0000</created>
                <updated>Tue, 21 Jan 2020 16:58:05 +0000</updated>
                            <resolved>Fri, 16 Aug 2019 08:52:26 +0000</resolved>
                                                    <fixVersion>8.3</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>2</watches>
                                                                                                                <comments>
                            <comment id="16906494" author="ab" created="Tue, 13 Aug 2019 18:26:06 +0000"  >&lt;p&gt;Indeed, it&apos;s a bug in &lt;tt&gt;IndexSizeEstimator&lt;/tt&gt;&#160;- it appears that the &lt;tt&gt;StoredFieldsReader&lt;/tt&gt; is not supposed to be closed other than from within CodecReader.close().&lt;/p&gt;

&lt;p&gt;SimpleTextCodec / SimpleTextStoreFieldsReader doesn&apos;t override getMergeInstance(), which means it returns itself, unlike all other codecs which return a clone of the stream in a new instance of &lt;tt&gt;StoredFieldsReader&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;Still, I&apos;m not sure if the&#160;new instance should be closed? Closing a clone of a stream doesn&apos;t close the original stream so I &lt;em&gt;think&lt;/em&gt;&#160;that the merge instance, when different from the original, still should be closed.&lt;/p&gt;</comment>
                            <comment id="16907438" author="jira-bot" created="Wed, 14 Aug 2019 16:51:31 +0000"  >&lt;p&gt;Commit 7c2d45d53ecb2adeaccac9c81a4d195109fcb65f in lucene-solr&apos;s branch refs/heads/master from Andrzej Bialecki&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7c2d45d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7c2d45d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13694&quot; title=&quot;IndexSizeEstimator NullPointerException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13694&quot;&gt;&lt;del&gt;SOLR-13694&lt;/del&gt;&lt;/a&gt;: IndexSizeEstimator NullPointerException.&lt;/p&gt;</comment>
                            <comment id="16907478" author="jira-bot" created="Wed, 14 Aug 2019 17:34:14 +0000"  >&lt;p&gt;Commit 09bee6d57c2bc4ce2b117c5f91320ceac38ed030 in lucene-solr&apos;s branch refs/heads/branch_8x from Andrzej Bialecki&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=09bee6d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=09bee6d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13694&quot; title=&quot;IndexSizeEstimator NullPointerException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13694&quot;&gt;&lt;del&gt;SOLR-13694&lt;/del&gt;&lt;/a&gt;: IndexSizeEstimator NullPointerException.&lt;/p&gt;</comment>
                            <comment id="16910302" author="jira-bot" created="Mon, 19 Aug 2019 10:20:48 +0000"  >&lt;p&gt;Commit 7c2d45d53ecb2adeaccac9c81a4d195109fcb65f in lucene-solr&apos;s branch refs/heads/jira/&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13650&quot; title=&quot;Support for named global classloaders&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13650&quot;&gt;&lt;del&gt;SOLR-13650&lt;/del&gt;&lt;/a&gt; from Andrzej Bialecki&lt;br/&gt;
[ &lt;a href=&quot;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7c2d45d&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://gitbox.apache.org/repos/asf?p=lucene-solr.git;h=7c2d45d&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-13694&quot; title=&quot;IndexSizeEstimator NullPointerException&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-13694&quot;&gt;&lt;del&gt;SOLR-13694&lt;/del&gt;&lt;/a&gt;: IndexSizeEstimator NullPointerException.&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310560">
                    <name>Problem/Incident</name>
                                                                <inwardlinks description="is caused by">
                                        <issuelink>
            <issuekey id="13237284">SOLR-13512</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12977562" name="SOLR-13694.patch" size="1370" author="ab" created="Wed, 14 Aug 2019 07:23:29 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>1.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            6 years, 13 weeks, 1 day ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|z05ms0:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>