<!-- 
RSS generated by JIRA (8.20.10#820010-sha1:ace47f9899e9ee25d7157d59aa17ab06aee30d3d) at Wed Nov 12 04:03:43 UTC 2025

It is possible to restrict the fields that are returned in this document by specifying the 'field' parameter in your request.
For example, to request only the issue key and summary append 'field=key&field=summary' to the URL of your request.
-->
<rss version="0.92" >
<channel>
    <title>ASF JIRA</title>
    <link>https://issues.apache.org/jira</link>
    <description>This file is an XML representation of an issue</description>
    <language>en-uk</language>    <build-info>
        <version>8.20.10</version>
        <build-number>820010</build-number>
        <build-date>22-06-2022</build-date>
    </build-info>


<item>
            <title>[SOLR-7366] Can&apos;t index example XML docs into the cloud example using bin/post due to regression in ManagedIndexSchema&apos;s handling of ResourceLoaderAware objects used by field types</title>
                <link>https://issues.apache.org/jira/browse/SOLR-7366</link>
                <project id="12310230" key="SOLR">Solr</project>
                    <description>&lt;p&gt;Managed schema code has regressed &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6764&quot; title=&quot;Can&amp;#39;t index exampledocs/*.xml into collection based on the data_driven_schema_configs configset&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-6764&quot;&gt;&lt;del&gt;SOLR-6764&lt;/del&gt;&lt;/a&gt;. Need to fix the regression and implement a unit test to catch this type of regression. This is a blocker for 5.1.&lt;/p&gt;

&lt;p&gt;To reproduce:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;bin/solr -e cloud -noprompt
bin/post -c gettingstarted example/exampledocs/*.xml
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;</description>
                <environment></environment>
        <key id="12819494">SOLR-7366</key>
            <summary>Can&apos;t index example XML docs into the cloud example using bin/post due to regression in ManagedIndexSchema&apos;s handling of ResourceLoaderAware objects used by field types</summary>
                <type id="1" iconUrl="https://issues.apache.org/jira/secure/viewavatar?size=xsmall&amp;avatarId=21133&amp;avatarType=issuetype">Bug</type>
                                            <priority id="1" iconUrl="https://issues.apache.org/jira/images/icons/priorities/blocker.svg">Blocker</priority>
                        <status id="6" iconUrl="https://issues.apache.org/jira/images/icons/statuses/closed.png" description="The issue is considered finished, the resolution is correct. Issues which are not closed can be reopened.">Closed</status>
                    <statusCategory id="3" key="done" colorName="green"/>
                                    <resolution id="1">Fixed</resolution>
                                        <assignee username="sarowe">Steven Rowe</assignee>
                                    <reporter username="thelabdude">Timothy Potter</reporter>
                        <labels>
                    </labels>
                <created>Wed, 8 Apr 2015 23:17:29 +0000</created>
                <updated>Mon, 9 May 2016 18:56:09 +0000</updated>
                            <resolved>Thu, 9 Apr 2015 04:57:26 +0000</resolved>
                                    <version>5.1</version>
                                    <fixVersion>5.1</fixVersion>
                    <fixVersion>5.2</fixVersion>
                    <fixVersion>6.0</fixVersion>
                                        <due></due>
                            <votes>0</votes>
                                    <watches>4</watches>
                                                                                                                <comments>
                            <comment id="14486415" author="steve_rowe" created="Thu, 9 Apr 2015 00:30:23 +0000"  >&lt;p&gt;As I mentioned on &lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-6141?focusedCommentId=14364590&amp;amp;page=com.atlassian.jira.plugin.system.issuetabpanels:comment-tabpanel#comment-14364590&quot; class=&quot;external-link&quot; rel=&quot;nofollow&quot;&gt;SOLR-6141&lt;/a&gt;:&lt;/p&gt;

&lt;blockquote&gt;
&lt;p&gt;This version of the patch modifies ZkIndexSchemaReader.updateSchema() to fully parse the remote changed schema rather than merging the local copy with the remote copy - now that the schema is (almost) fully addressable with the schema API, we can&apos;t reliably do such merges.&lt;/p&gt;&lt;/blockquote&gt;

&lt;p&gt;But I didn&apos;t add &lt;tt&gt;ResourceLoaderAware&lt;/tt&gt; inform&apos;ing to &lt;tt&gt;IndexSchema.readSchema()&lt;/tt&gt;, so newly parsed schemas were not being properly initialized.&lt;/p&gt;</comment>
                            <comment id="14486440" author="steve_rowe" created="Thu, 9 Apr 2015 00:50:40 +0000"  >&lt;p&gt;Patch against trunk adding &lt;tt&gt;ResourceLoaderAware&lt;/tt&gt; inform&apos;ing to every place that does &lt;tt&gt;SchemaAware&lt;/tt&gt; inform&apos;ing, including in &lt;tt&gt;IndexSchema.readSchema()&lt;/tt&gt;.   I had to move &lt;tt&gt;informResourceLoaderAwareObjectsInChain()&lt;/tt&gt; and &lt;tt&gt;informResourceLoaderAwareObjectsForFieldType()&lt;/tt&gt; from &lt;tt&gt;ManagedIndexSchema&lt;/tt&gt; to &lt;tt&gt;IndexSchema&lt;/tt&gt; so that they are accessible from &lt;tt&gt;IndexSchema.readSchema()&lt;/tt&gt;.&lt;/p&gt;

&lt;p&gt;After I fixed the code, the data triggered a schemaless issue: there is a document (not the first!) in &lt;tt&gt;example/exampledocs/ipod_other.xml&lt;/tt&gt; with an integral value for the &lt;tt&gt;weight&lt;/tt&gt; field.  In standalone mode, this isn&apos;t an issue because docs are processed sequentially, but in cloud mode, some docs can be indexed on non-coordinator nodes, resulting in out-of-order schema modifications.  I ran into just that, with errors like the following in the &lt;tt&gt;solr.log&lt;/tt&gt;:&lt;/p&gt;

&lt;div class=&quot;preformatted panel&quot; style=&quot;border-width: 1px;&quot;&gt;&lt;div class=&quot;preformattedContent panelContent&quot;&gt;
&lt;pre&gt;ERROR - 2015-04-09 00:06:55.371; org.apache.solr.common.SolrException; org.apache.solr.common.SolrException: ERROR
: [doc=F8V7067-APL-KIT] Error adding field &apos;weight&apos;=&apos;4.0&apos; msg=For input string: &quot;4.0&quot;
[...]
Caused by: java.lang.NumberFormatException: For input string: &quot;4.0&quot;
        at java.lang.NumberFormatException.forInputString(NumberFormatException.java:65)
        at java.lang.Long.parseLong(Long.java:441)
&lt;/pre&gt;
&lt;/div&gt;&lt;/div&gt;

&lt;p&gt;So this patch also modifies &lt;tt&gt;example/exampledocs/ipod_other.xml&lt;/tt&gt; to convert the one integral &lt;tt&gt;weight&lt;/tt&gt; field value into a float. &lt;/p&gt;

&lt;p&gt;I tested the patch manually against trunk and lucene_solr_5_1 using the repro instructions in the description, both succeeded.&lt;/p&gt;</comment>
                            <comment id="14486507" author="thelabdude" created="Thu, 9 Apr 2015 01:35:08 +0000"  >&lt;p&gt;Patch updated with unit test that catches this problem, i.e. it passes with Steve&apos;s fix applied, but fails without.&lt;/p&gt;</comment>
                            <comment id="14486664" author="steve_rowe" created="Thu, 9 Apr 2015 04:21:17 +0000"  >&lt;p&gt;I refactored the patch, pulling out post-read inform&apos;ing into a method &lt;tt&gt;IndexSchema.postReadInform()&lt;/tt&gt;, overridden in &lt;tt&gt;ManagedIndexSchema&lt;/tt&gt; to also do the &lt;tt&gt;ResourceLoaderAware&lt;/tt&gt; inform&apos;ing so that &lt;tt&gt;IndexSchema.readSchema()&lt;/tt&gt; doesn&apos;t cause non-managed schemas to have to do unnecessary inform&apos;ing.&lt;/p&gt;

&lt;p&gt;I ran all Solr tests on trunk, including Tim&apos;s new test, and all passed.&lt;/p&gt;

&lt;p&gt;Committing shortly.&lt;/p&gt;</comment>
                            <comment id="14486680" author="jira-bot" created="Thu, 9 Apr 2015 04:42:33 +0000"  >&lt;p&gt;Commit 1672238 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/trunk&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1672238&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1672238&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7366&quot; title=&quot;Can&amp;#39;t index example XML docs into the cloud example using bin/post due to regression in ManagedIndexSchema&amp;#39;s handling of ResourceLoaderAware objects used by field types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7366&quot;&gt;&lt;del&gt;SOLR-7366&lt;/del&gt;&lt;/a&gt;: fix regression in ManagedIndexSchema&apos;s handling of ResourceLoaderAware objects used by field types, causing example XML docs to not be indexable via bin/post; add a test indexing example docs that fails without the patch and succeeds with it&lt;/p&gt;</comment>
                            <comment id="14486684" author="jira-bot" created="Thu, 9 Apr 2015 04:46:24 +0000"  >&lt;p&gt;Commit 1672239 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/branches/branch_5x&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1672239&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1672239&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7366&quot; title=&quot;Can&amp;#39;t index example XML docs into the cloud example using bin/post due to regression in ManagedIndexSchema&amp;#39;s handling of ResourceLoaderAware objects used by field types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7366&quot;&gt;&lt;del&gt;SOLR-7366&lt;/del&gt;&lt;/a&gt;: fix regression in ManagedIndexSchema&apos;s handling of ResourceLoaderAware objects used by field types, causing example XML docs to not be indexable via bin/post; add a test indexing example docs that fails without the patch and succeeds with it (merged trunk r1672238)&lt;/p&gt;</comment>
                            <comment id="14486697" author="jira-bot" created="Thu, 9 Apr 2015 04:56:42 +0000"  >&lt;p&gt;Commit 1672240 from &lt;a href=&quot;https://issues.apache.org/jira/secure/ViewProfile.jspa?name=steve_rowe&quot; class=&quot;user-hover&quot; rel=&quot;steve_rowe&quot;&gt;steve_rowe&lt;/a&gt; in branch &apos;dev/branches/lucene_solr_5_1&apos;&lt;br/&gt;
[ &lt;a href=&quot;https://svn.apache.org/r1672240&quot; class=&quot;external-link&quot; target=&quot;_blank&quot; rel=&quot;nofollow noopener&quot;&gt;https://svn.apache.org/r1672240&lt;/a&gt; ]&lt;/p&gt;

&lt;p&gt;&lt;a href=&quot;https://issues.apache.org/jira/browse/SOLR-7366&quot; title=&quot;Can&amp;#39;t index example XML docs into the cloud example using bin/post due to regression in ManagedIndexSchema&amp;#39;s handling of ResourceLoaderAware objects used by field types&quot; class=&quot;issue-link&quot; data-issue-key=&quot;SOLR-7366&quot;&gt;&lt;del&gt;SOLR-7366&lt;/del&gt;&lt;/a&gt;: fix regression in ManagedIndexSchema&apos;s handling of ResourceLoaderAware objects used by field types, causing example XML docs to not be indexable via bin/post; add a test indexing example docs that fails without the patch and succeeds with it (merged trunk r1672238)&lt;/p&gt;</comment>
                            <comment id="14486699" author="steve_rowe" created="Thu, 9 Apr 2015 04:57:26 +0000"  >&lt;p&gt;Committed to trunk, branch_5x and lucene_solr_5_1.&lt;/p&gt;</comment>
                            <comment id="14495388" author="thelabdude" created="Wed, 15 Apr 2015 00:30:55 +0000"  >&lt;p&gt;Bulk close after 5.1 release&lt;/p&gt;</comment>
                    </comments>
                <issuelinks>
                            <issuelinktype id="12310050">
                    <name>Regression</name>
                                            <outwardlinks description="breaks">
                                        <issuelink>
            <issuekey id="12823942">SOLR-7470</issuekey>
        </issuelink>
                            </outwardlinks>
                                                                <inwardlinks description="is broken by">
                                        <issuelink>
            <issuekey id="12718629">SOLR-6141</issuekey>
        </issuelink>
                            </inwardlinks>
                                    </issuelinktype>
                    </issuelinks>
                <attachments>
                            <attachment id="12724126" name="SOLR-7366.patch" size="14677" author="sarowe" created="Thu, 9 Apr 2015 04:21:17 +0000"/>
                            <attachment id="12724100" name="SOLR-7366.patch" size="21810" author="thelabdude" created="Thu, 9 Apr 2015 01:35:08 +0000"/>
                            <attachment id="12724083" name="SOLR-7366.patch" size="14926" author="sarowe" created="Thu, 9 Apr 2015 00:50:37 +0000"/>
                    </attachments>
                <subtasks>
                    </subtasks>
                <customfields>
                                                                            <customfield id="customfield_12310310" key="com.atlassian.jira.toolkit:attachments">
                        <customfieldname>Attachment count</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>3.0</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12314020" key="com.atlassian.jira.plugins.jira-development-integration-plugin:devsummary">
                        <customfieldname>Development</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                        <customfield id="customfield_12313422" key="com.atlassian.jirafisheyeplugin:jobcheckbox">
                        <customfieldname>Enable Automatic Patch Review</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue><![CDATA[false]]></customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                <customfield id="customfield_12310420" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Global Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                        <customfield id="customfield_12312521" key="com.atlassian.jira.toolkit:LastCommentDate">
                        <customfieldname>Last public comment date</customfieldname>
                        <customfieldvalues>
                            10 years, 32 weeks ago
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                <customfield id="customfield_12311820" key="com.pyxis.greenhopper.jira:gh-lexo-rank">
                        <customfieldname>Rank</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>0|i2d03r:</customfieldvalue>

                        </customfieldvalues>
                    </customfield>
                                                                <customfield id="customfield_12310920" key="com.pyxis.greenhopper.jira:gh-global-rank">
                        <customfieldname>Rank (Obsolete)</customfieldname>
                        <customfieldvalues>
                            <customfieldvalue>9223372036854775807</customfieldvalue>
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                        <customfield id="customfield_12313321" key="com.atlassian.jira.toolkit:message">
                        <customfieldname>Solr Mailing List Info</customfieldname>
                        <customfieldvalues>
                            
                        </customfieldvalues>
                    </customfield>
                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    </customfields>
    </item>
</channel>
</rss>